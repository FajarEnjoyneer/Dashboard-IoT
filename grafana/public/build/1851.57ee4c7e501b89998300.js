"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1851],{47987:(oe,O,n)=>{n.d(O,{u:()=>y});var e=n(74848),l=n(2543),o=n(43243),M=n(1749);function E(){return M.P.useListReceiverQuery({})}function s(d){const[c,P]=alertingAPI.endpoints.createReceiver.useMutation(d);return[g=>c(g),P]}function x(d){if((0,l.isEmpty)(d.spec.integrations))return"<empty contact point>";const c=(0,l.countBy)(d.spec.integrations,i=>i.type);return Object.entries(c).map(([i,g])=>g>1?`${i} (${g})`:i).join(", ")}const r=new Intl.Collator("en",{sensitivity:"accent"});function y(d){const{currentData:c,isLoading:P}=E(),i=(0,l.chain)(c?.items).toArray().map(h=>({option:{label:h.spec.title,value:h.metadata.uid??h.spec.title,description:x(h)},contactPoint:h})).value().sort((h,B)=>r.compare(h.option.label,B.option.label)),g=i.map(h=>h.option),j=h=>{if(h==null&&d.isClearable){d.onChange(null);return}if(h){const B=i.find(({option:$})=>$.value===h.value);if(!B)return;d.onChange(B.contactPoint)}};return(0,e.jsx)(o.G,{...d,loading:P,options:g,onChange:j})}},91851:(oe,O,n)=>{n.r(O),n.d(O,{default:()=>Lt});var e=n(74848),l=n(96540),o=n(74869),M=n(54148),E=n(41053),s=n(66178),x=n(83175),r=n(92745),y=n(25992),d=n(41654),c=n(45861),P=n(70958),i=n(52763),g=n(74268),j=n(36826),h=n(59935),B=n(12207),$=n(90186),u=n(22803),m=n(78685),K=n(63142),Q=n(34999),Z=n(45967),k=n(98127),A=n(52161),he=n(77256),q=n(29609);function ge(){const[a,v]=(0,l.useState)(!1),[f,V]=(0,m.A)("grafana.unifiedalerting.hideErrors",!1),T=(0,k.$)(D=>D.promRules),L=(0,k.$)(D=>D.rulerRules),S=(0,K.of)(Ke),C=(0,l.useMemo)(()=>{const[D,J]=[T,L].map(_=>(0,A.qi)().reduce((re,ne)=>{const De=_[ne.name]?.error;return _[ne.name]&&De&&!(0,q.$7)(_[ne.name])?[...re,{dataSource:ne,error:De}]:re},[])),de=T[A.hY]?.error,Re=L[A.hY]?.error,me=[],ue=(0,r.t)("alerting.rule-list-errors.unknown-error","Unknown error.");return de&&me.push((0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.x6,{i18nKey:"alerting.rule-list-errors.failed-to-load-grafana-rules-state",children:"Failed to load Grafana rules state:"})," ",de.message||ue]})),Re&&me.push((0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.x6,{i18nKey:"alerting.rule-list-errors.failed-to-load-grafana-rules-config",children:"Failed to load Grafana rules config:"})," ",Re?.message||ue]})),D.forEach(({dataSource:_,error:re})=>me.push((0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(r.x6,{i18nKey:"alerting.rule-list-errors.failed-to-load-rules-state",values:{dataSource:_.name},children:["Failed to load rules state from"," ",(0,e.jsx)("a",{href:(0,he.GD)(_.uid),className:S.dsLink,children:"{{dataSource}}"})]}),": ",re.message||ue]}))),J.forEach(({dataSource:_,error:re})=>me.push((0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(r.x6,{i18nKey:"alerting.rule-list-errors.failed-to-load-rules-config",values:{dataSource:_.name},children:["Failed to load rules config from"," ",(0,e.jsx)("a",{href:(0,he.GD)(_.uid),className:S.dsLink,children:"{{dataSource}}"})]}),": ",re.message||ue]}))),me},[T,L,S.dsLink]);return(0,e.jsxs)(e.Fragment,{children:[!!C.length&&f&&(0,e.jsx)(xe,{count:C.length,onClick:()=>V(D=>!D)}),!!C.length&&!f&&(0,e.jsxs)(Q.F,{"data-testid":"cloud-rulessource-errors",title:(0,r.t)("alerting.rule-list-errors.cloud-rulessource-errors-title-errors-loading-rules","Errors loading rules"),severity:"error",onRemove:()=>V(!0),children:[a&&C.map((D,J)=>(0,e.jsx)("div",{children:D},J)),!a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:C[0]}),C.length>=2&&(0,e.jsx)(c.$n,{className:S.moreButton,fill:"text",icon:"angle-right",size:"sm",onClick:()=>v(!0),children:(0,e.jsxs)(r.x6,{i18nKey:"alerting.rule-list-errors.more-errors",count:C.length-1,children:["{{count}}"," more errors"]})})]})]})]})}const xe=({count:a,onClick:v})=>{const f=(0,K.of)(Ke);return(0,e.jsx)("div",{className:f.floatRight,children:(0,e.jsx)(Z.m,{content:(0,r.t)("alerting.error-summary-button.content-show-all-errors","Show all errors"),placement:"bottom",children:(0,e.jsx)(c.$n,{fill:"text",variant:"destructive",icon:"exclamation-triangle",onClick:v,children:(0,e.jsxs)(r.x6,{i18nKey:"alerting.rule-list-errors.button-errors",count:a,children:["{{count}}"," errors"]})})})})},Ke=a=>({moreButton:(0,u.css)({padding:0}),floatRight:(0,u.css)({display:"flex",justifyContent:"flex-end"}),dsLink:(0,u.css)({fontWeight:a.typography.fontWeightBold,color:a.colors.text.link})});var ie=n(16692),Ve=n(24898),w=n(43173),b=n(66404),G=n(6975),z=n(68079),p=n(34213),R=n(99887),W=n(95943),F=n(74048),ee=n(18771),H=n(36200),U=n(92367),fe=n(51898),ce=n(30703),Ie=n(18404),I=n(11940),te=n(88721),ae=n(29442),se=n(12266),Fe=n(40360),X=n(8369),Ue=n(88589),Le=n(85597),pe=n(71774),ve=n(46672),Ne=n(22971);const Be=l.memo(({group:a,namespace:v,expandAll:f,viewMode:V})=>{const{rulesSource:T}=v,L=(0,A.EV)(T),S=(0,Ne.ZI)(T),C=(0,K.of)(Ge),[D,J]=(0,l.useState)(void 0),[de,Re]=(0,l.useState)(!f);(0,l.useEffect)(()=>{Re(!f)},[f]);const{hasRuler:me}=(0,I.y)(v.rulesSource),ue=a.rules[0]?.rulerRule,_=ue&&q.p.grafana.rule(ue)&&ue.grafana_alert.namespace_uid||void 0,{folder:re}=(0,Ie.a)(_),{canEditRules:ne}=(0,te.V)(),De=me&&S&&!a.rules.find(Ce=>!!Ce.rulerRule),Xe=(0,q.YN)(a),He=a.rules.some(Ce=>q.p.grafana.rule(Ce.rulerRule)&&Ce.rulerRule.grafana_alert.provenance),rt=a.rules.some(Ce=>(0,q.Tm)(Ce.rulerRule??Ce.promRule)),ke=me&&!He&&!Xe&&!rt&&ne(L),Te=V==="list",$e=V==="grouped",ye=[];if(De)ye.push((0,e.jsxs)(d.B,{children:[(0,e.jsx)(z.y,{}),(0,e.jsx)(r.x6,{i18nKey:"alerting.rules-group.deleting",children:"Deleting"})]},"is-deleting"));else if(T===A.hY){if(_){const Ce=(0,he.NH)(_);$e&&(ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.details","rule group details"),icon:"info-circle",tooltip:(0,r.t)("alerting.rule-group-action.details","rule group details"),to:ae.TN.detailsPageLink("grafana",_,a.name,{includeReturnTo:!0})},"rule-group-details")),re?.canSave&&ke&&ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.edit","edit rule group"),icon:"pen",tooltip:(0,r.t)("alerting.rule-group-action.edit","edit rule group"),to:ae.TN.editPageLink("grafana",_,a.name,{includeReturnTo:!0})},"rule-group-edit"))),re?.canSave&&Te&&(ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.go-to-folder","go to folder"),icon:"folder-open",tooltip:(0,r.t)("alerting.rule-group-action.go-to-folder","go to folder"),to:Ce,target:"__blank"},"goto")),re?.canAdmin&&ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.manage-permissions","manage permissions"),icon:"lock",tooltip:(0,r.t)("alerting.rule-group-action.manage-permissions","manage permissions"),to:Ce+"/permissions",target:"__blank"},"manage-perms"))),re&&Te&&ye.push((0,e.jsx)(Le.m,{folderUID:_},"folder-bulk-actions"))}}else ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.details","rule group details"),icon:"info-circle",tooltip:(0,r.t)("alerting.rule-group-action.details","rule group details"),to:ae.TN.detailsPageLink(T.uid,v.name,a.name,{includeReturnTo:!0})},"rule-group-details")),ke&&ye.push((0,e.jsx)(pe.M,{"aria-label":(0,r.t)("alerting.rule-group-action.edit","edit rule group"),icon:"pen",tooltip:(0,r.t)("alerting.rule-group-action.edit","edit rule group"),to:ae.TN.editPageLink(T.uid,v.name,a.name,{includeReturnTo:!0})},"rule-group-edit"));const st=Te?(0,e.jsx)(Fe.c,{namespace:(0,Ue.EL)(v).name}):(0,e.jsx)(Fe.c,{namespace:(0,Ue.EL)(v).name,group:a.name});return(0,e.jsxs)("div",{className:C.wrapper,"data-testid":"rule-group",children:[(0,e.jsxs)("div",{className:C.header,"data-testid":"rule-group-header",children:[(0,e.jsx)(se.e,{size:"sm",className:C.collapseToggle,isCollapsed:de,onToggle:Re,"data-testid":fe.Tp.components.AlertRules.groupToggle}),(0,e.jsx)(Me,{isCollapsed:de}),(0,e.jsx)(we,{rulesSource:T}),(0,e.jsxs)("div",{className:C.groupName,onClick:()=>Re(!de),children:[Xe&&(0,e.jsx)(R.E,{color:"purple",text:(0,r.t)("alerting.rules-group.text-federated","Federated")})," ",st]}),(0,e.jsx)("div",{className:C.spacer}),(0,e.jsx)("div",{className:C.headerStats,children:(0,e.jsx)(ve.j7,{group:a})}),He&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:C.actionsSeparator,children:"|"}),(0,e.jsx)("div",{className:C.actionIcons,children:(0,e.jsx)(R.E,{color:"purple",text:(0,r.t)("alerting.rules-group.text-provisioned","Provisioned")})})]}),!!ye.length&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:C.actionsSeparator,children:"|"}),(0,e.jsx)("div",{className:C.actionIcons,children:(0,e.jsx)(d.B,{gap:.5,children:ye})})]})]}),!de&&(0,e.jsx)(Ne.sF,{showSummaryColumn:!0,className:C.rulesTable,showGuidelines:!0,showNextEvaluationColumn:!!a.interval,rules:a.rules}),re&&D==="folder"&&(0,e.jsx)(X.s,{folder:re,onClose:()=>J(void 0)})]})});Be.displayName="RulesGroup";const we=l.memo(({rulesSource:a})=>{const v=(0,K.of)(Ge);return(0,A.Eb)(a)?(0,e.jsx)(Z.m,{content:a.name,placement:"top",children:(0,e.jsx)("img",{alt:a.meta.name,className:v.dataSourceIcon,src:a.meta.info.logos.small})}):null});we.displayName="CloudSourceLogo";const Me=l.memo(({isCollapsed:a})=>(0,e.jsx)(ce.I,{name:a?"folder":"folder-open"}));Me.displayName="FolderIcon";const Ge=a=>({wrapper:(0,u.css)({}),header:(0,u.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:`${a.spacing(1)} ${a.spacing(1)} ${a.spacing(1)} 0`,flexWrap:"nowrap",borderBottom:`1px solid ${a.colors.border.weak}`,"&:hover":{backgroundColor:a.components.table.rowHoverBackground}}),headerStats:(0,u.css)({flexShrink:0,span:{verticalAlign:"middle"},[a.breakpoints.down("sm")]:{order:2,width:"100%",paddingLeft:a.spacing(1)}}),groupName:(0,u.css)({marginLeft:a.spacing(1),marginBottom:0,cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),spacer:(0,u.css)({flex:1}),collapseToggle:(0,u.css)({background:"none",border:"none",marginTop:`-${a.spacing(1)}`,marginBottom:`-${a.spacing(1)}`,svg:{marginBottom:0}}),dataSourceIcon:(0,u.css)({width:a.spacing(2),height:a.spacing(2),marginLeft:a.spacing(2)}),dataSourceOrigin:(0,u.css)({marginRight:"1em",color:a.colors.text.disabled}),actionsSeparator:(0,u.css)({margin:`0 ${a.spacing(2)}`}),actionIcons:(0,u.css)({width:"120px",alignItems:"center",flexShrink:0}),rulesTable:(0,u.css)({margin:a.spacing(2,0)}),rotate90:(0,u.css)({transform:"rotate(90deg)"})});function Ye(a){return(0,l.useMemo)(()=>a.flatMap(v=>v.groups.map(f=>({namespace:v,group:f}))),[a])}const _e=({namespaces:a,expandAll:v})=>{const f=(0,K.of)(ze),V=(0,k.$)(ne=>ne.promRules),T=(0,l.useMemo)(A.qi,[]),L=Ye(a),S=(0,l.useMemo)(()=>T.filter(ne=>(0,H.ML)(V[ne.name])),[V,T]),C=T.some(ne=>!!V[ne.name]?.result?.length),D=T.length>0,J=S.length>0,de=a.length>0,{numberOfPages:Re,onPageChange:me,page:ue,pageItems:_}=(0,F.W)(L,1,W.FG),re=D&&(0,he.qc)()&&w.$.featureToggles.alertingMigrationUI;return(0,e.jsxs)("section",{className:f.wrapper,children:[(0,e.jsx)(d.B,{gap:2,direction:"column",children:(0,e.jsx)("div",{className:f.sectionHeader,children:(0,e.jsxs)("div",{className:f.headerRow,children:[(0,e.jsx)(b.E,{element:"h2",variant:"h5",children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.section.dataSourceManaged.title",children:"Data source-managed"})}),S.length?(0,e.jsx)(G._,{className:f.loader,text:(0,r.t)("alerting.list-view.section.loading-rules","Loading rules from {{count}} sources",{count:S.length})}):(0,e.jsx)("div",{}),(0,e.jsxs)(d.B,{gap:1,children:[re&&C&&(0,e.jsx)(le,{}),(0,e.jsx)(qe,{})]})]})})}),_.map(({group:ne,namespace:De})=>(0,e.jsx)(Be,{group:ne,namespace:De,expandAll:v,viewMode:"grouped"},`${(0,A.v0)(De.rulesSource)}-${De.name}-${ne.name}`)),!D&&(0,e.jsx)("p",{children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.no-prom-or-loki-rules",children:"There are no Prometheus or Loki data sources configured"})}),D&&!J&&!de&&(0,e.jsx)("p",{children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.no-rules",children:"No rules found."})}),!C&&J&&(0,e.jsx)(z.y,{size:"xl",className:f.spinner}),(0,e.jsx)(p.d,{className:f.pagination,currentPage:ue,numberOfPages:Re,onNavigate:me,hideWhenSinglePage:!0})]})},ze=a=>({loader:(0,u.css)({marginBottom:0}),sectionHeader:(0,u.css)({display:"flex",justifyContent:"space-between"}),wrapper:(0,u.css)({marginBottom:a.spacing(4)}),spinner:(0,u.css)({textAlign:"center",padding:a.spacing(2)}),pagination:(0,ee.H)(a),headerRow:(0,u.css)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:a.spacing(1)})});function qe(){const[a,v]=(0,ie.Ej)(ie.RY.CreateExternalAlertRule),f=(0,M.zy)();return a&&v?(0,e.jsx)(c.z9,{href:x.kM.renderUrl("alerting/new/recording",{returnTo:f.pathname+f.search}),icon:"plus",variant:"secondary",children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.empty.new-ds-managed-recording-rule",children:"New data source-managed recording rule"})},"new-recording-rule"):null}function le(){const a=(0,U.G)("/alerting/import-datasource-managed-rules");return(0,e.jsx)(c.z9,{variant:"secondary",href:a,icon:"arrow-up",children:(0,e.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",children:[(0,e.jsx)(r.x6,{i18nKey:"alerting.rule-list.import-to-gma.text",children:"Import to Grafana-managed rules"}),(0,e.jsx)(R.E,{text:(0,r.t)("alerting.rule-list.import-to-gma.new-badge","New!"),"aria-label":(0,r.t)("alerting.migrate-to-gmabutton.aria-label-new","new"),color:"blue",icon:"rocket"})]})})}var Pe=n(42941),We=n(23265),Ae=n(70327),je=n(77880),Ee=n(25149),Je=n(78102);function et({onClose:a}){const[v,f]=(0,l.useState)("yaml");return(0,e.jsx)(Ee.m,{activeTab:v,onTabChange:f,onClose:a,formatProviders:Object.values(Je.sl),children:(0,e.jsx)(tt,{exportFormat:v,onClose:a})})}function tt({exportFormat:a,onClose:v}){const{currentData:f="",isFetching:V}=Ae.hK.endpoints.exportRules.useQuery({format:a}),T=`alert-rules-${new Date().getTime()}`;return V?(0,e.jsx)(G._,{text:(0,r.t)("alerting.grafana-rules-export-preview.text-loading","Loading....")}):(0,e.jsx)(je.J,{format:a,textDefinition:f,downloadFileName:T,onClose:v})}const nt=({namespaces:a,expandAll:v})=>{const f=(0,K.of)(N),[V]=(0,P.s)(),{prom:T,ruler:L}=(0,k.$)($e=>({prom:$e.promRules[A.hY]||H.jA,ruler:$e.rulerRules[A.hY]||H.jA})),S=T.loading||L.loading,C=!!T.result||!!L.result,D=V.view==="list",J=D?(0,We.Jr)(a):a,de=Ye(J),{numberOfPages:Re,onPageChange:me,page:ue,pageItems:_}=(0,F.W)(de,1,W.FG),[re,ne]=(0,ie.Ej)(ie.RY.ExportGrafanaManagedRules),De=re&&ne,[Xe,He]=(0,Pe.A)(!1),rt=a.length>0,{canCreateGrafanaRules:ke}=(0,te.V)(),Te=w.$.unifiedAlerting.recordingRulesEnabled&&ke;return(0,e.jsxs)("section",{className:f.wrapper,children:[(0,e.jsx)("div",{className:f.sectionHeader,children:(0,e.jsxs)("div",{className:f.headerRow,children:[(0,e.jsx)(b.E,{element:"h2",variant:"h5",children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.section.grafanaManaged.title",children:"Grafana-managed"})}),S?(0,e.jsx)(G._,{className:f.loader,text:(0,r.t)("alerting.list-view.section.grafanaManaged.loading","Loading...")}):(0,e.jsx)("div",{}),(0,e.jsxs)(d.B,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[rt&&De&&(0,e.jsx)(c.$n,{"aria-label":(0,r.t)("alerting.grafana-rules.export-all-grafana-rules-aria-label-export-all-grafana-rules","export all grafana rules"),"data-testid":"export-all-grafana-rules",icon:"download-alt",tooltip:(0,r.t)("alerting.grafana-rules.export-all-grafana-rules-tooltip-export-all-grafanamanaged-rules","Export all Grafana-managed rules"),onClick:He,variant:"secondary",children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.section.grafanaManaged.export-rules",children:"Export rules"})}),Te&&(0,e.jsx)(c.z9,{href:(0,U.G)("/alerting/new/grafana-recording",{returnTo:"/alerting/list"+window.location.search}),icon:"plus",variant:"secondary",tooltip:(0,r.t)("alerting.grafana-rules.tooltip-create-new-grafanamanaged-recording-rule","Create new Grafana-managed recording rule"),onClick:()=>(0,g.fH)(g.le.grafanaRecording),children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.section.grafanaManaged.new-recording-rule",children:"New recording rule"})})]})]})}),_.map(({group:$e,namespace:ye})=>(0,e.jsx)(Be,{group:$e,namespace:ye,expandAll:v,viewMode:D?"list":"grouped"},`${ye.name}-${$e.name}`)),C&&J?.length===0&&(0,e.jsx)("p",{children:(0,e.jsx)(r.x6,{i18nKey:"alerting.grafana-rules.no-rules-found",children:"No rules found."})}),!C&&S&&(0,e.jsx)(z.y,{size:"xl",className:f.spinner}),(0,e.jsx)(p.d,{className:f.pagination,currentPage:ue,numberOfPages:Re,onNavigate:me,hideWhenSinglePage:!0}),De&&Xe&&(0,e.jsx)(et,{onClose:He})]})},N=a=>({loader:(0,u.css)({marginBottom:0}),sectionHeader:(0,u.css)({display:"flex",justifyContent:"space-between",marginBottom:a.spacing(1)}),wrapper:(0,u.css)({marginBottom:a.spacing(4)}),spinner:(0,u.css)({textAlign:"center",padding:a.spacing(2)}),pagination:(0,ee.H)(a),headerRow:(0,u.css)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",flexDirection:"row"})}),Qe=({namespaces:a,expandAll:v})=>{const[f,V]=(0,l.useMemo)(()=>{const T=a.map(L=>({...L,groups:L.groups.sort((S,C)=>S.name.localeCompare(C.name))})).sort((L,S)=>L.name.localeCompare(S.name));return[T.filter(L=>(0,A.z2)(L.rulesSource)),T.filter(L=>(0,A.Eb)(L.rulesSource))]},[a]);return(0,l.useEffect)(()=>{(0,g.fH)(g.le.loadedList)},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ve._,{actions:[ie.RY.ViewAlertRule],children:(0,e.jsx)(nt,{namespaces:f,expandAll:v})}),(0,e.jsx)(Ve._,{actions:[ie.RY.ViewExternalAlertRule],children:(0,e.jsx)(_e,{namespaces:V,expandAll:v})})]})};var at=n(49185),be=n(47327),lt=n(72489),Y=n(24619),ut=n(4956),gt=n(64628),mt=n(94646),ht=n(22973),xt=n(3969);const ft=({namespaces:a})=>{const[v,{width:f}]=(0,at.A)(),V=jt(),L=(0,l.useMemo)(()=>{const S=new Map([[Y.cF.Firing,[]],[Y.cF.Pending,[]],[Y.cF.Recovering,[]],[Y.cF.Inactive,[]],[Y.cF.Unknown,[]]]);return a.forEach(C=>C.groups.forEach(D=>D.rules.forEach(J=>{q.R$.alertingRule(J.promRule)&&J.promRule.state&&S.get(J.promRule.state)?.push(J)}))),S.forEach(C=>C.sort((D,J)=>D.name.localeCompare(J.name))),S},[a]).entries();return(0,e.jsxs)("ul",{role:"tree",ref:v,children:[V&&(0,e.jsx)(be.G,{width:f}),(0,e.jsx)(d.B,{direction:"column",children:Array.from(L).map(([S,C])=>(0,e.jsx)(vt,{state:S,rules:C},S))})]})},pt={[Y.cF.Firing]:"Firing",[Y.cF.Pending]:"Pending",[Y.cF.Inactive]:"Normal",[Y.cF.Recovering]:"Recovering",[Y.cF.Unknown]:"Unknown"},vt=({state:a,rules:v})=>{const{page:f,pageItems:V,numberOfPages:T,onPageChange:L}=(0,F.W)(v,1,W.FG),S=a!==Y.cF.Firing,C=v.length>0;return(0,e.jsx)(gt.i,{title:(0,e.jsxs)(d.B,{alignItems:"center",gap:0,children:[pt[a]??"Unknown",(0,e.jsx)(lt.p,{value:v.length})]}),collapsed:S||C,pagination:(0,e.jsx)(p.d,{currentPage:f,numberOfPages:T,onNavigate:L,hideWhenSinglePage:!0}),children:V.map(D=>{const{rulerRule:J,promRule:de}=D,Re=J?(0,q.Nv)(J):!1,me=q.R$.alertingRule(D.promRule)?(0,ht.rf)(D.instanceTotals):void 0;if(!de)return null;const ue=(0,q.uo)(D.promRule);return(0,e.jsx)(ut.WG,{name:D.name,href:(0,he.w$)(D.namespace.rulesSource,D),summary:D.annotations.summary,state:a,health:D.promRule?.health,error:D.promRule?.lastError,labels:D.promRule?.labels,isProvisioned:Re,instancesCount:me,namespace:D.namespace.name,group:D.group.name,actions:(0,e.jsx)(xt.l,{compact:!0,rule:D,rulesSource:D.namespace.rulesSource}),origin:ue},(0,mt.jY)(de))})})};function jt(){const a=(0,k.$)(L=>L.promRules),v=(0,l.useMemo)(A.qi,[]),f=(0,k.$)(L=>{const S=(0,H.ML)(L.promRules[A.hY]),C=(0,H.ML)(L.rulerRules[A.hY]);return S||C}),V=v.some(L=>(0,H.ML)(a[L.name]));return f||V}var ot=n(96784),Ze=n(11018),Et=n(95443),Rt=n(77833);const it={groups:Qe,state:ft},yt=$.Ys+1,ct=(0,o.wS)(),Pt=()=>{const a=(0,i.wA)(),v=(0,l.useMemo)(A.gR,[]),[f,V]=(0,l.useState)(!1),T=(0,l.useCallback)(()=>V(!1),[]),[L]=(0,P.s)(),{filterState:S,hasActiveFilters:C}=(0,ot.dI)(),D=S.labels.length>0,J=L.view,de=J==="state"||J==="groups"?J:"groups",Re=it[de]?de:"groups",me=it[Re],ue=(0,k.$)(Se=>Se.promRules),_=(0,k.$)(Se=>Se.rulerRules),re=v.some(Se=>ue[Se]?.loading||_[Se]?.loading),ne=Object.entries(ue),De=Object.entries(_),Xe=ne.every(([Se,Oe])=>Oe.dispatched&&(Oe?.result!==void 0||Oe?.error!==void 0)),He=De.every(([Se,Oe])=>Oe.dispatched&&(Oe?.result!==void 0||Oe?.error!==void 0)),rt=ne.every(([Se,Oe])=>Oe.dispatched&&Oe?.result?.length===0),ke=De.every(([Se,Oe])=>Object.entries(Oe?.result??{}).every(([Ft,Tt])=>Tt?.length===0)&&Oe.dispatched),Te=D?void 0:yt,[$e,ye]=(0,E.A)(async()=>{re||(ct?(await a((0,Ze.eB)({rulesSourceName:A.hY})),await a((0,Ze.nV)(!1,{limitAlerts:Te}))):await a((0,Ze.yo)(!1,{limitAlerts:Te})))},[re,Te,a]);(0,l.useEffect)(()=>{(0,g.Sq)().catch(()=>{})},[]),(0,l.useEffect)(()=>{ct?(a((0,Ze.eB)({rulesSourceName:A.hY})),a((0,Ze.nV)(!1,{limitAlerts:Te}))):a((0,Ze.yo)(!1,{limitAlerts:Te}))},[a,Te]),(0,s.A)(ye,Et.HH);const st=Xe&&rt&&ne.length>0&&ke&&He,Ce=!st,At=(0,We.dy)(),dt=(0,ot.i7)(At,S);return(0,e.jsx)(j.d,{navId:"alert-list",isLoading:!1,renderTitle:Se=>(0,e.jsx)(Rt.Q,{title:Se}),actions:Ce&&(0,e.jsxs)(d.B,{gap:1,children:[(0,e.jsx)(Dt,{})," ",(0,e.jsx)(Ct,{})]}),children:(0,e.jsxs)(d.B,{direction:"column",children:[(0,e.jsx)(ge,{}),(0,e.jsx)(h.A,{onClear:T}),Ce&&(0,e.jsx)(d.B,{direction:"row",alignItems:"center",children:Re==="groups"&&C&&(0,e.jsx)(c.$n,{icon:f?"angle-double-up":"angle-double-down",variant:"secondary",onClick:()=>V(!f),children:f?(0,r.t)("alerting.rule-list-v1.collapse-all","Collapse all"):(0,r.t)("alerting.rule-list-v1.expand-all","Expand all")})}),(0,e.jsx)(ve.M_,{namespaces:dt}),st&&(0,e.jsx)(B.ww,{}),Ce&&(0,e.jsx)(me,{expandAll:f,namespaces:dt})]})})};function Dt(){const[a,v]=(0,ie.Ej)(ie.RY.CreateAlertRule),[f,V]=(0,ie.Ej)(ie.RY.CreateExternalAlertRule),T=(0,M.zy)();return a&&v||f&&V?(0,e.jsx)(c.z9,{href:x.kM.renderUrl("alerting/new/alerting",{returnTo:T.pathname+T.search}),icon:"plus",onClick:()=>(0,y.fH)(g.le.alertRuleFromScratch),children:(0,e.jsx)(r.x6,{i18nKey:"alerting.rule-list.new-alert-rule",children:"New alert rule"})}):null}function Ct(){const a=window.location.pathname+window.location.search,v=(0,U.G)("/alerting/export-new-rule",{returnTo:a});return(0,e.jsx)(c.z9,{href:v,icon:"download-alt",variant:"secondary",tooltip:(0,r.t)("alerting.export-new-rule-button.tooltip-export-new-grafana-rule","Export new grafana rule"),onClick:()=>(0,y.fH)(g.le.exportNewGrafanaRule),children:(0,e.jsx)(r.x6,{i18nKey:"alerting.list-view.section.grafanaManaged.export-new-rule",children:"Export rule definition"})})}var Mt=n(88547);const Ot=(0,l.lazy)(()=>Promise.all([n.e(4162),n.e(585)]).then(n.bind(n,585))),It=()=>{const a=(0,o.sk)();return(0,e.jsx)(l.Suspense,{children:a?(0,e.jsx)(Ot,{}):(0,e.jsx)(Pt,{})})},Lt=(0,Mt.S)(It)},12266:(oe,O,n)=>{n.d(O,{e:()=>o});var e=n(74848),l=n(45861);const o=({isCollapsed:M,onToggle:E,idControlled:s,className:x,text:r,size:y="xl",...d})=>(0,e.jsx)(l.$n,{type:"button",fill:"text",variant:"secondary","aria-expanded":!M,"aria-controls":s,className:x,icon:M?"angle-right":"angle-down",onClick:()=>E(!M),...d,children:r})},8369:(oe,O,n)=>{n.d(O,{s:()=>y});var e=n(74848),l=n(96540),o=n(92745),M=n(6975),E=n(70327),s=n(77880),x=n(25149),r=n(78102);function y({folder:c,onClose:P}){const[i,g]=(0,l.useState)("yaml");return(0,e.jsx)(x.m,{title:(0,o.t)("alerting.grafana-rule-folder-exporter.title-drawer","Export {{folderName}} rules",{folderName:c.title}),activeTab:i,onTabChange:g,onClose:P,formatProviders:Object.values(r.sl),children:(0,e.jsx)(d,{folder:c,exportFormat:i,onClose:P})})}function d({folder:c,exportFormat:P,onClose:i}){const{currentData:g="",isFetching:j}=E.hK.endpoints.exportRules.useQuery({folderUid:c.uid,format:P});if(j)return(0,e.jsx)(M._,{text:(0,o.t)("alerting.grafana-rule-folder-export-preview.text-loading","Loading....")});const h=`${c.title}-${c.uid}`;return(0,e.jsx)(s.J,{format:P,textDefinition:g,downloadFileName:h,onClose:i})}},85597:(oe,O,n)=>{n.d(O,{m:()=>xe});var e=n(74848),l=n(96540),o=n(92745),M=n(43173),E=n(36490),s=n(87063),x=n(88559),r=n(52763),y=n(5709),d=n(55143),c=n(77295);const P=y.H.injectEndpoints({endpoints:w=>({pauseFolder:w.mutation({query:({namespace:b,notificationOptions:G})=>{const z=(0,o.t)("alerting.bulk-actions.pause.success","Rules evaluation successfully paused for folder"),{path:p,params:R}=(0,c.$o)(d.b).namespace(b);return{url:p,params:R,body:{is_paused:!0},method:"PATCH",notificationOptions:{successMessage:z,...G}}}}),unpauseFolder:w.mutation({query:({namespace:b,notificationOptions:G})=>{const z=(0,o.t)("alerting.bulk-actions.unpause.success","Rules successfully unpaused for this folder"),{path:p,params:R}=(0,c.$o)(d.b).namespace(b);return{url:p,params:R,body:{is_paused:!1},method:"PATCH",notificationOptions:{successMessage:z,...G}}}}),deleteGrafanaRulesFromFolder:w.mutation({query:({namespace:b,notificationOptions:G})=>{const z=(0,o.t)("alerting.bulk-actions.delete.success","Rules successfully deleted from folder"),{path:p,params:R}=(0,c.$o)(d.b).namespace(b);return{url:p,params:R,method:"DELETE",notificationOptions:{successMessage:z,...G}}}})})});var i=n(74869),g=n(16692),j=n(18404),h=n(11018),B=n(52161),$=n(77256),u=n(92367),m=n(27691),K=n(8369),Q=n(71599),Z=n(66404),k=n(35137),A=n(74268);const he=l.memo(({onConfirm:w,onDismiss:b,isOpen:G,folderName:z})=>{const[p,R]=(0,l.useState)(!1),W=async()=>{R(!0);try{await w(),(0,A.D0)(),b()}catch{(0,A.Ks)()}finally{R(!1)}};return(0,e.jsx)(Q.u,{body:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Z.E,{element:"p",children:(0,e.jsxs)(o.x6,{i18nKey:"alerting.folder-bulk-actions.delete-modal-text",values:{folderName:z},children:["This action will delete all alert rules in the ",(0,e.jsx)("code",{children:"{{folderName}}"})," folder. Nested folders will not be affected."]})}),(0,e.jsx)(k.$,{v:2})]}),confirmationText:(0,o.t)("alerting.folder-bulk-actions.delete-modal-confirmation-text","Delete"),confirmText:p?(0,o.t)("alerting.folder-bulk-actions.delete-modal-deleting","Deleting..."):(0,o.t)("alerting.folder-bulk-actions.delete-modal-delete-button","Delete"),onDismiss:b,onConfirm:W,title:(0,o.t)("alerting.folder-bulk-actions.delete-modal-title","Delete"),isOpen:G})});var q=n(64762);function ge({folderUID:w,executeAction:b,isLoading:G,action:z}){const p=(0,q._2)(),R=z==="pause"?(0,o.t)("alerting.folder-bulk-actions.pause.button.label","Pause all rules"):(0,o.t)("alerting.folder-bulk-actions.unpause.button.label","Resume all rules"),W=z==="pause"?"pause":"play",F=z==="pause"?A.QA:A.Zc,ee=z==="pause"?A.D_:A.a5,H=async()=>{try{await b(w),F()}catch(U){ee(),p.error((0,o.t)("alerting.folder-bulk-actions.error","Failed to execute action for folder: {{error}}",{error:(0,$.JZ)(U)}))}};return(0,e.jsx)(s.W.Item,{label:R,icon:W,disabled:G,onClick:H})}const xe=({folderUID:w})=>{const[b,G]=(0,l.useState)(!1),[z,p]=(0,l.useState)(!1),R=M.$.featureToggles.alertingBulkActionsInUI,W=(0,i.sk)(),[F,ee]=(0,g.Ej)(g.RY.ExportGrafanaManagedRules),H=F&&ee,[U,fe]=P.endpoints.deleteGrafanaRulesFromFolder.useMutation(),{folder:ce}=(0,j.a)(w),Ie=ce?.title||"unknown folder",I=(0,$.NH)(w),ae=Ke(W?"list":"grouped");if(!ce)return null;const se=async()=>{await U({namespace:w}).unwrap(),await ae()},Fe=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.W.Item,{url:I,icon:"eye","aria-label":(0,o.t)("alerting.list-view.folder-actions.view.aria-label","View folder"),label:(0,o.t)("alerting.list-view.folder-actions.view.label","View folder")}),(0,e.jsx)(Ve,{folderUID:w,onClickDelete:G,isLoading:fe.isLoading}),H&&(0,e.jsxs)(e.Fragment,{children:[R&&(0,e.jsx)(s.W.Divider,{}),(0,e.jsx)(ie,{onClickExport:()=>p(!0)})]})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.m,{placement:"bottom",overlay:(0,e.jsx)(s.W,{children:Fe}),children:(0,e.jsx)(m.A,{fill:"text",size:"sm","aria-label":(0,o.t)("alerting.list-view.folder-actions.button.aria-label","Folder actions"),title:(0,o.t)("alerting.list-view.folder-actions.button.title","Actions")})}),z&&(0,e.jsx)(K.s,{folder:ce,onClose:()=>p(!1)}),(0,e.jsx)(he,{isOpen:b,onConfirm:se,onDismiss:()=>G(!1),folderName:Ie})]})};function Ke(w){const b=(0,r.wA)(),G=(0,i.wS)();return async()=>{G?(await b((0,h.eB)({rulesSourceName:B.hY})),await b((0,h.nV)(!1))):await b((0,h.yo)(!1)),E.Ny.push((0,u.G)("/alerting/list",{view:w},{skipSubPath:!0}))}}function ie({onClickExport:w}){return(0,e.jsx)(s.W.Item,{"aria-label":(0,o.t)("alerting.list-view.folder-actions.export.aria-label","Export rules folder"),"data-testid":"export-folder",label:(0,o.t)("alerting.list-view.folder-actions.export.label","Export rules folder"),icon:"download-alt",onClick:w},"export-folder")}function Ve({folderUID:w,onClickDelete:b,isLoading:G}){const z=(0,i.sk)(),p=M.$.featureToggles.alertingBulkActionsInUI,[R,W]=(0,g.aw)(g.$m.Pause),[F,ee]=(0,g.aw)(g.$m.Delete),H=R&&W,U=F&&ee,[fe,ce]=P.endpoints.pauseFolder.useMutation(),[Ie,I]=P.endpoints.unpauseFolder.useMutation(),ae=Ke(z?"list":"grouped");return!p||!H&&!U?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.W.Divider,{}),H&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ge,{folderUID:w,action:"pause",executeAction:async se=>{await fe({namespace:se}).unwrap(),await ae()},isLoading:ce.isLoading}),(0,e.jsx)(ge,{folderUID:w,action:"unpause",executeAction:async se=>{await Ie({namespace:se}).unwrap(),await ae()},isLoading:I.isLoading})]}),U&&(0,e.jsx)(s.W.Item,{label:(0,o.t)("alerting.folder-bulk-actions.delete.button.label","Delete all rules"),icon:"trash-alt",onClick:()=>b(!0),disabled:G})]})}},71774:(oe,O,n)=>{n.d(O,{M:()=>M});var e=n(74848),l=n(45967),o=n(45861);const M=({tooltip:E,icon:s,to:x,target:r,onClick:y,className:d,tooltipPlacement:c="top",...P})=>{const i=typeof E=="string"?E:void 0;return(0,e.jsx)(l.m,{content:E,placement:c,children:x?(0,e.jsx)(o.z9,{variant:"secondary",fill:"text",icon:s,href:x,size:"sm",target:r,...P,"aria-label":i}):(0,e.jsx)(o.$n,{className:d,variant:"secondary",fill:"text",size:"sm",icon:s,type:"button",onClick:y,...P,"aria-label":i})})}},59935:(oe,O,n)=>{n.d(O,{A:()=>Ie});var e=n(74848),l=n(22803),o=n(96540),M=n(49785),E=n(47987),s=n(92745),x=n(63142),r=n(30703),y=n(41654),d=n(37386),c=n(72636),P=n(45967),i=n(77824),g=n(63527),j=n(45861),h=n(95506),B=n(73427),$=n(11257),u=n(24619),m=n(74268),K=n(96784),Q=n(98684),Z=n(56369),k=n(29609),A=n(38055),he=n(48480),q=n(29246),ge=n(51898),xe=n(78282),Ke=n(36580),ie=n(18857),Ve=n(63509),w=n(52161);const b=I=>{const te=(0,xe.l)(),[ae,se]=(0,o.useState)(),Fe=(le,Pe)=>{if(Pe.action==="clear"&&I.onClear){I.onClear();return}const We=le[le.length-1];let Ae,je;Pe.action==="pop-value"||Pe.action==="remove-value"?(Ae=Pe.removedValue?.value,je="remove"):(Ae=We.value,je="add");const Ee=te.getInstanceSettings(Ae);Ee&&(I.onChange(Ee,je),se({error:void 0}))},X=()=>{const{current:le,hideTextValue:Pe,noDefault:We}=I;if(!(!le&&We))return le?.map(Ae=>{const je=te.getInstanceSettings(Ae);if(je)return{label:je.name.slice(0,37),value:je.name,imgUrl:je.meta.info.logos.small,hideText:Pe,meta:je.meta};const Ee=(0,he.Iz)(Ae);return Ee===Ke.dR.uid||Ee===Ke.dR.name?{label:Ee,value:Ee,hideText:Pe}:{label:(Ee??"no name")+" - not found",value:Ee??void 0,imgUrl:"",hideText:Pe}})},Ue=()=>{const{alerting:le,tracing:Pe,metrics:We,mixed:Ae,dashboard:je,variables:Ee,annotations:Je,pluginId:et,type:tt,filter:nt,logs:N}=I,Qe=te.getList({alerting:le,tracing:Pe,metrics:We,logs:N,dashboard:je,mixed:Ae,variables:Ee,annotations:Je,pluginId:et,filter:nt,type:tt}),at=Qe.filter(w.hP).map(Y=>({value:Y.name,label:`${Y.name}${Y.isDefault?" (default)":""}`,imgUrl:Y.meta.info.logos.small,meta:Y.meta})),be=Qe.filter(Y=>!(0,w.hP)(Y)).map(Y=>({value:Y.name,label:`${Y.name}${Y.isDefault?" (default)":""}`,imgUrl:Y.meta.info.logos.small,meta:Y.meta}));return[{label:(0,s.t)("alerting.multiple-data-source-picker.get-data-source-options.grouped-options.label.data-sources-with-configured-alert-rules","Data sources with configured alert rules"),options:at,expanded:!0},{label:(0,s.t)("alerting.multiple-data-source-picker.get-data-source-options.grouped-options.label.other-data-sources","Other data sources"),options:be,expanded:!0}]},{autoFocus:Le,onBlur:pe,onClear:ve,openMenuOnFocus:Ne,placeholder:Be,width:we,inputId:Me,disabled:Ge=!1,isLoading:Ye=!1}=I,_e=Ue(),ze=X(),qe=typeof ve=="function";return(0,e.jsx)("div",{"data-testid":ge.Tp.components.DataSourcePicker.container,children:(0,e.jsx)(ie.KF,{isLoading:Ye,disabled:Ge,"data-testid":ge.Tp.components.DataSourcePicker.inputV2,inputId:Me||"data-source-picker",className:"ds-picker select-container",isClearable:qe,backspaceRemovesValue:!0,onChange:Fe,options:_e,autoFocus:Le,onBlur:pe,width:we,openMenuOnFocus:Ne,maxMenuHeight:500,placeholder:Be,noOptionsMessage:(0,s.t)("alerting.multiple-data-source-picker.noOptionsMessage-no-datasources-found","No datasources found"),value:ze??[],invalid:!!ae?.error||!!I.invalid,getOptionLabel:le=>le.meta&&(0,q.x)(le.meta.signature)&&le!==ze?(0,e.jsxs)(y.B,{alignItems:"center",justifyContent:"space-between",children:[(0,e.jsx)("span",{children:le.label})," ",(0,e.jsx)(Ve.B,{status:le.meta.signature})]}):le.label||""})})};var G=n(72984);const z=[{label:"Alert ",value:u.JS.Alerting},{label:"Recording ",value:u.JS.Recording}],p=[{label:"Ok",value:Z.Jc.Ok},{label:"No Data",value:Z.Jc.NoData},{label:"Error",value:Z.Jc.Error}],R=B.TP.hasPermission($.w.AlertingReceiversRead),W=Object.entries(u.cF).filter(([I,te])=>te!==u.cF.Unknown).map(([I,te])=>({label:(0,k.XI)(te),value:te})),F=({onClear:I=()=>{},viewMode:te,onViewModeChange:ae})=>{const se=(0,x.of)(ee),{pluginsFilterEnabled:Fe}=ce(),{filterState:X,hasActiveFilters:Ue,searchQuery:Le,setSearchQuery:pe,updateFilters:ve}=(0,K.dI)(),[Ne,Be]=(0,o.useState)(Math.floor(Math.random()*100)),we=`dataSource-${Ne}`,Me=`queryString-${Ne}`,Ge=(0,o.useRef)(null),{handleSubmit:Ye,register:_e,setValue:ze}=(0,M.mN)({defaultValues:{searchQuery:Le}}),{ref:qe,...le}=_e("searchQuery");(0,o.useEffect)(()=>{ze("searchQuery",Le)},[Le,ze]);const Pe=(N,Qe)=>{const at=Qe==="add"?[...X.dataSourceNames].concat([N.name]):X.dataSourceNames.filter(be=>be!==N.name);ve({...X,dataSourceNames:at}),Be(be=>be+1),(0,m.Sn)("dataSourceNames")},We=N=>{ve({...X,dashboardUid:N}),(0,m.Sn)("dashboardUid")},Ae=()=>{ve({...X,dataSourceNames:[]}),Be(N=>N+1)},je=N=>{(0,m.fH)(m.le.clickingAlertStateFilters),ve({...X,ruleState:N}),(0,m.Sn)("ruleState")},Ee=N=>{ve({...X,ruleType:N}),(0,m.Sn)("ruleType")},Je=N=>{ve({...X,ruleHealth:N}),(0,m.Sn)("ruleHealth")},et=()=>{pe(void 0),I(),setTimeout(()=>Be(Ne+1),100)},tt=N=>{ve({...X,contactPoint:N}),(0,m.Sn)("contactPoint")},nt=(0,e.jsx)(r.I,{name:"search"});return(0,e.jsxs)(y.B,{direction:"column",gap:0,children:[(0,e.jsxs)(y.B,{direction:"row",gap:1,wrap:"wrap",children:[(0,e.jsx)(d.D,{className:se.dsPickerContainer,label:(0,e.jsx)(c.J,{htmlFor:"data-source-picker",children:(0,e.jsxs)(y.B,{gap:.5,alignItems:"center",children:[(0,e.jsx)("span",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.search-by-data-sources",children:"Search by data sources"})}),(0,e.jsx)(P.m,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.configured-alert-rules",children:"Data sources containing configured alert rules are Mimir or Loki data sources where alert rules are stored and evaluated in the data source itself."})}),(0,e.jsx)("p",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.manage-alerts",children:"In these data sources, you can select Manage alerts via Alerting UI to be able to manage these alert rules in the Grafana UI as well as in the data source where they were configured."})})]}),children:(0,e.jsx)(r.I,{id:"data-source-picker-inline-help",name:"info-circle",size:"sm",title:(0,s.t)("alerting.rules-filter.data-source-picker-inline-help-title-search-by-data-sources-help","Search by data sources help")})})]})}),children:(0,e.jsx)(b,{alerting:!0,noDefault:!0,placeholder:(0,s.t)("alerting.rules-filter.placeholder-all-data-sources","All data sources"),current:X.dataSourceNames,onChange:Pe,onClear:Ae},we)}),(0,e.jsx)(d.D,{className:se.dashboardPickerContainer,label:(0,e.jsx)(c.J,{htmlFor:"filters-dashboard-picker",children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.dashboard",children:"Dashboard"})}),children:(0,e.jsx)(h.b,{inputId:"filters-dashboard-picker",value:X.dashboardUid,onChange:N=>We(N?.uid),isClearable:!0,cacheOptions:!0},X.dashboardUid?"dashboard-defined":"dashboard-not-defined")}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c.J,{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.state",children:"State"})}),(0,e.jsx)(i.z,{options:W,value:X.ruleState,onChange:je})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c.J,{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.rule-type",children:"Rule type"})}),(0,e.jsx)(i.z,{options:z,value:X.ruleType,onChange:Ee})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c.J,{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.health",children:"Health"})}),(0,e.jsx)(i.z,{options:p,value:X.ruleHealth,onChange:Je})]}),R&&(0,e.jsx)(y.B,{direction:"column",gap:0,children:(0,e.jsx)(d.D,{label:(0,e.jsx)(c.J,{htmlFor:"contactPointFilter",children:(0,e.jsx)(s.x6,{i18nKey:"alerting.contactPointFilter.label",children:"Contact point"})}),children:(0,e.jsx)(E.u,{id:"contactPointFilter",value:X.contactPoint??null,width:40,placeholder:(0,s.t)("alerting.notification-policies-filter.placeholder-search-by-contact-point","Choose a contact point"),isClearable:!0,onChange:N=>{tt(N?.spec.title??"")}})})}),Fe&&(0,e.jsxs)("div",{children:[(0,e.jsx)(c.J,{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.plugin-rules",children:"Plugin rules"})}),(0,e.jsx)(i.z,{options:[{label:(0,s.t)("alerting.rules-filter.label.show","Show"),value:void 0},{label:(0,s.t)("alerting.rules-filter.label.hide","Hide"),value:"hide"}],value:X.plugins,onChange:N=>ve({...X,plugins:N})})]})]}),(0,e.jsxs)(y.B,{direction:"column",gap:0,children:[(0,e.jsxs)(y.B,{direction:"row",gap:1,children:[(0,e.jsxs)("form",{className:se.searchInput,onSubmit:Ye(N=>{pe(N.searchQuery),Ge.current?.blur(),(0,m.zs)({oldQuery:Le,newQuery:N.searchQuery})}),children:[(0,e.jsx)(d.D,{label:(0,e.jsx)(c.J,{htmlFor:"rulesSearchInput",children:(0,e.jsxs)(y.B,{gap:.5,alignItems:"center",children:[(0,e.jsx)("span",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.search",children:"Search"})}),(0,e.jsx)(A.B,{content:(0,e.jsx)(H,{}),children:(0,e.jsx)(r.I,{name:"info-circle",size:"sm",tabIndex:0,title:(0,s.t)("alerting.rules-filter.title-search-help","Search help")})})]})}),children:(0,e.jsx)(g.p,{id:"rulesSearchInput",prefix:nt,ref:N=>{qe(N),Ge.current=N},...le,placeholder:(0,s.t)("alerting.rules-filter.rulesSearchInput-placeholder-search","Search"),"data-testid":"search-query-input"},Me)}),(0,e.jsx)("input",{type:"submit",hidden:!0})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c.J,{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.view-as",children:"View as"})}),(0,e.jsx)(G.b,{viewMode:te,onViewModeChange:ae})]})]}),Ue&&(0,e.jsx)("div",{children:(0,e.jsx)(j.$n,{fullWidth:!1,icon:"times",variant:"secondary",onClick:et,children:(0,e.jsx)(s.x6,{i18nKey:"alerting.rules-filter.clear-filters",children:"Clear filters"})})})]})]})},ee=I=>({dsPickerContainer:(0,l.css)({width:I.spacing(60),flexGrow:0,margin:0}),dashboardPickerContainer:(0,l.css)({minWidth:I.spacing(50)}),searchInput:(0,l.css)({flex:1,margin:0})});function H(){const I=(0,x.of)(fe);return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.search-query-help.search-syntax",children:"Search syntax allows to query alert rules by the parameters defined below."})}),(0,e.jsx)("hr",{}),(0,e.jsxs)("div",{className:I.grid,children:[(0,e.jsx)("div",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.search-query-help.filter-type",children:"Filter type"})}),(0,e.jsx)("div",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.search-query-help.expression",children:"Expression"})}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-datasources","Datasources"),expr:"datasource:mimir datasource:prometheus"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-folder-namespace","Folder/Namespace"),expr:"namespace:global"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-group","Group"),expr:"group:cpu-usage"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-rule","Rule"),expr:'rule:"cpu 80%"'}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-labels","Labels"),expr:"label:team=A label:cluster=a1"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-state","State"),expr:"state:firing|normal|pending"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-type","Type"),expr:"type:alerting|recording"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-health","Health"),expr:"health:ok|nodata|error"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-dashboard-uid","Dashboard UID"),expr:"dashboard:eadde4c7-54e6-4964-85c0-484ab852fd04"}),(0,e.jsx)(U,{title:(0,s.t)("alerting.search-query-help.title-contact-point","Contact point"),expr:"contactPoint:slack"})]})]})}function U({title:I,expr:te}){const ae=(0,x.of)(fe);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:I}),(0,e.jsx)("code",{className:ae.code,children:te})]})}const fe=I=>({grid:(0,l.css)({display:"grid",gridTemplateColumns:"max-content auto",gap:I.spacing(1),alignItems:"center"}),code:(0,l.css)({display:"block",textAlign:"center"})});function ce(){const{components:I}=(0,Q.u)();return{pluginsFilterEnabled:I.length>0}}const Ie=F},72984:(oe,O,n)=>{n.d(O,{O:()=>d,b:()=>g});var e=n(74848),l=n(96540),o=n(77824),M=n(74268),E=n(74869),s=n(96784),x=n(20962);const r=[{icon:"folder",label:"Grouped",value:"grouped"},{icon:"list-ul",label:"List",value:"list"}];function y({viewMode:j,onViewModeChange:h}){return(0,e.jsx)(o.z,{options:r,value:j,onChange:h})}function d(){const[j,h]=(0,x.l)(),{activeFilters:B}=(0,s.dI)(),$=j.get("view")==="list"?"list":"grouped",u=B.every(Z=>Z==="groupName"||Z==="namespace"),m=u===!1||$==="list",K=(0,l.useCallback)(Z=>{h(Z==="grouped"?u?{view:void 0}:{view:void 0,search:void 0}:{view:Z}),(0,M.aL)({view:Z})},[h,u]);return{viewMode:m?"list":"grouped",handleViewChange:K}}const c=[{label:"Grouped",value:"grouped"},{label:"List",value:"list"},{label:"State",value:"state"}];function P(){const[j,h]=(0,x.l)(),B=j.get("view"),$=i(B),u=m=>{h({view:m})};return(0,e.jsx)(o.z,{options:c,value:$,onChange:u})}function i(j){return j==="list"?"list":j==="state"?"state":"grouped"}function g({viewMode:j,onViewModeChange:h}){return(0,E.sk)()?(0,e.jsx)(y,{viewMode:j,onViewModeChange:h}):(0,e.jsx)(P,{})}},12207:(oe,O,n)=>{n.d(O,{$s:()=>h,ww:()=>j});var e=n(74848),l=n(22803),o=n(92745),M=n(43173),E=n(88559),s=n(87063),x=n(94535),r=n(45861),y=n(50201),d=n(41654),c=n(89640),P=n(67817),i=n(88721);const g=()=>{const{canCreateGrafanaRules:m,canCreateCloudRules:K}=(0,i.V)(),Q=M.$.unifiedAlerting.recordingRulesEnabled&&m;return m&&K&&Q?(0,e.jsx)(E.m,{overlay:(0,e.jsxs)(s.W,{children:[(0,e.jsx)(x.D,{url:"alerting/new/grafana-recording",icon:"plus",label:(0,o.t)("alerting.list-view.empty.new-grafana-recording-rule","New recording rule")}),(0,e.jsx)(x.D,{url:"alerting/new/recording",icon:"plus",label:(0,o.t)("alerting.list-view.empty.new-ds-managed-recording-rule","New data source-managed recording rule")})]}),children:(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",size:"lg",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-recording-rule",children:"New recording rule"})})}):(0,e.jsxs)(e.Fragment,{children:[m&&Q&&(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",size:"lg",href:"alerting/new/grafana-recording",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-grafana-recording-rule",children:"New recording rule"})}),K&&(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",size:"lg",href:"alerting/new/recording",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-ds-managed-recording-rule",children:"New data source-managed recording rule"})})]})},j=()=>{const{canCreateGrafanaRules:m,canCreateCloudRules:K}=(0,i.V)(),Q=m||K;return(0,e.jsx)("div",{children:(0,e.jsxs)(y.p,{message:(0,o.t)("alerting.list-view.empty.no-rules-created","You haven't created any rules yet"),variant:"call-to-action",button:Q?(0,e.jsxs)(d.B,{direction:"column",alignItems:"center",justifyContent:"center",children:[Q&&(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",size:"lg",href:"alerting/new/alerting",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-alert-rule",children:"New alert rule"})}),(0,e.jsx)(g,{})]}):null,children:[(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.provisioning",children:"You can also define rules through file provisioning or Terraform"}),(0,e.jsx)(c.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/",external:!0,children:(0,e.jsx)(o.x6,{i18nKey:"alerting.common.learn-more",children:"Learn more"})})]})})};function h(){const{canCreateGrafanaRules:m}=(0,i.V)(),K=M.$.unifiedAlerting.recordingRulesEnabled&&m;return(0,e.jsx)(y.p,{message:(0,o.t)("alerting.list-view.empty.no-rules-created","You haven't created any rules yet"),variant:"call-to-action",children:(0,e.jsxs)(d.B,{direction:"column",alignItems:"center",justifyContent:"center",gap:2,children:[(0,e.jsxs)(d.B,{direction:"row",alignItems:"center",justifyContent:"center",children:[(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.provisioning",children:"You can also define rules through file provisioning or Terraform"}),(0,e.jsx)(c.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/",external:!0,children:(0,e.jsx)(o.x6,{i18nKey:"alerting.common.learn-more",children:"Learn more"})})]}),(0,e.jsxs)(d.B,{direction:"row",alignItems:"center",justifyContent:"center",children:[m&&(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",href:"alerting/new/alerting",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-grafana-alerting-rule",children:"New alert rule"})}),m&&K&&(0,e.jsx)(r.z9,{variant:"primary",icon:"plus",href:"alerting/new/grafana-recording",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.list-view.empty.new-grafana-recording-rule",children:"New recording rule"})})]})]})})}function B({dataSourceName:m}){const K=useStyles2(u),{canCreateCloudRules:Q}=useRulesAccess(),Z=$(m,RuleFormType.cloudAlerting),k=$(m,RuleFormType.cloudRecording);return jsxs("div",{className:K.container,children:[jsx(Text,{variant:"h5",children:jsx(Trans,{i18nKey:"alerting.list-view.empty.ds-no-rules",children:"This data source has no rules configured"})}),Q&&jsxs(Stack,{direction:"row",alignItems:"center",justifyContent:"center",children:[jsx(LinkButton,{variant:"secondary",size:"sm",icon:"plus",href:Z,children:jsx(Trans,{i18nKey:"alerting.list-view.empty.new-ds-managed-alerting-rule",children:"New data source-managed alerting rule"})}),jsx(LinkButton,{variant:"secondary",size:"sm",icon:"plus",href:k,children:jsx(Trans,{i18nKey:"alerting.list-view.empty.new-ds-managed-recording-rule",children:"New data source-managed recording rule"})})]})]})}function $(m,K){const Q=K===RuleFormType.cloudAlerting?"alerting":"recording",Z={dataSourceName:m,editorSettings:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!1},type:K};return createRelativeUrl(`/alerting/new/${Q}`,{defaults:JSON.stringify(Z)})}const u=m=>({container:css({display:"flex",gap:m.spacing(1),flexDirection:"column",alignItems:"center",justifyContent:"center",padding:m.spacing(2,1)})})},98684:(oe,O,n)=>{n.d(O,{u:()=>o});var e=n(54092),l=n(33604);function o(){return(0,l.f)({extensionPointId:e.S.AlertingHomePage,limitPerPlugin:1})}},77833:(oe,O,n)=>{n.d(O,{Q:()=>y});var e=n(74848),l=n(92745),o=n(43173),M=n(27489),E=n(41654),s=n(45861),x=n(74869),r=n(1487);function y({title:d}){const c=o.$.featureToggles.alertingListViewV2PreviewToggle??!1,P=(0,x.sk)(),i=()=>{P?((0,r.J)("alertingListViewV2",!1),(0,M.rR)("alerting.list_view.v2.disabled")):((0,r.J)("alertingListViewV2",!0),(0,M.rR)("alerting.list_view.v2.enabled")),window.location.reload()},{text:g,...j}=P?{variant:"secondary",icon:void 0,text:(0,l.t)("alerting.rule-list.toggle.go-back-to-old-look","Go back to the old look"),"data-testid":"alerting-list-view-toggle-v1"}:{variant:"primary",icon:"rocket",text:(0,l.t)("alerting.rule-list.toggle.try-out-the-new-look","Try out the new look!"),"data-testid":"alerting-list-view-toggle-v2"};return(0,e.jsxs)(E.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:2,children:[(0,e.jsx)("h1",{children:d}),c&&(0,e.jsx)("div",{children:(0,e.jsx)(s.$n,{size:"sm",fill:"outline",...j,onClick:i,className:"fs-unmask",children:g})})]})}},4956:(oe,O,n)=>{n.d(O,{B3:()=>Ke,Om:()=>b,WG:()=>ge,nh:()=>xe});var e=n(74848),l=n(22803),o=n(55127),M=n.n(o),E=n(96540),s=n(92745),x=n(66404),r=n(89640),y=n(41654),d=n(63142),c=n(45967),P=n(34999),i=n(30703),g=n(24619),j=n(74268),h=n(7840),B=n(1625),$=n(1972),u=n(17305),m=n(52161),K=n(67598),Q=n(39659),Z=n(77256),k=n(51592),A=n(1148),he=n(87672),q=n(76267);const ge=p=>{const{name:R,summary:W,state:F,health:ee,error:H,href:U,isProvisioned:fe,lastEvaluation:ce,evaluationInterval:Ie,isPaused:I=!1,instancesCount:te=0,namespace:ae,group:se,rulesSource:Fe,application:X,contactPoint:Ue,labels:Le,origin:pe,actions:ve=null,operation:Ne,showLocation:Be=!0}=p,we=(0,E.useId)(),Me=[];return ae&&se&&Be&&Me.push((0,e.jsx)(x.E,{color:"secondary",variant:"bodySmall",children:(0,e.jsx)(G,{namespace:ae,group:se,rulesSource:Fe,application:X})})),I||(ce&&Ie&&Me.push((0,e.jsx)(w,{lastEvaluation:ce,evaluationInterval:Ie,state:F})),te&&Me.push((0,e.jsx)(B.P,{icon:"layers-alt",children:(0,e.jsx)(r.Y,{href:U+"?tab=instances",variant:"bodySmall",color:"primary",inline:!1,children:M()("instance",te,!0)})}))),Le&&(0,Q.rm)(Le)>0&&Me.push((0,e.jsx)(B.P,{icon:"tag-alt",children:(0,e.jsx)(Ve,{labels:Le})})),!I&&Ue&&Me.push((0,e.jsxs)(B.P,{icon:"at",children:[(0,e.jsx)(s.x6,{i18nKey:"alerting.contact-points.delivered-to",children:"Delivered to"})," ",(0,e.jsx)(r.Y,{href:(0,Z.bI)(Ue,m.hY),variant:"bodySmall",color:"primary",inline:!1,children:Ue})]})),(0,e.jsx)(k.c,{"aria-labelledby":we,title:(0,e.jsxs)(y.B,{direction:"row",alignItems:"center",children:[(0,e.jsx)(r.Y,{href:U,color:"primary",inline:!1,id:we,children:R}),pe&&(0,e.jsx)(u.T,{pluginId:pe.pluginId,size:"sm"}),fe&&!pe&&(0,e.jsx)($.rS,{})]}),description:(0,e.jsx)(ie,{content:W,error:H}),icon:(0,e.jsx)(he.c,{state:F,health:ee,isPaused:I,operation:Ne}),actions:ve,meta:Me})};function xe({name:p,namespace:R,group:W,rulesSource:F,application:ee,href:H,health:U,isProvisioned:fe,error:ce,isPaused:Ie,origin:I,actions:te,showLocation:ae=!0}){const se=[];return R&&W&&ae&&se.push((0,e.jsx)(x.E,{color:"secondary",variant:"bodySmall",children:(0,e.jsx)(G,{namespace:R,group:W,rulesSource:F,application:ee})})),(0,e.jsx)(k.c,{title:(0,e.jsxs)(y.B,{direction:"row",alignItems:"center",children:[(0,e.jsx)(r.Y,{color:"primary",href:H,inline:!1,children:p}),I&&(0,e.jsx)(u.T,{pluginId:I.pluginId,size:"sm"}),fe&&!I&&(0,e.jsx)($.rS,{})]}),description:(0,e.jsx)(ie,{error:ce}),icon:(0,e.jsx)(he.c,{recording:!0,health:U,isPaused:Ie}),actions:te,meta:se})}function Ke({name:p,namespace:R,group:W,rulesSource:F,application:ee,operation:H,showLocation:U=!0}){const fe=(0,E.useId)(),ce=[];return R&&W&&U&&ce.push((0,e.jsx)(x.E,{color:"secondary",variant:"bodySmall",children:(0,e.jsx)(G,{namespace:R,group:W,rulesSource:F,application:ee})})),(0,e.jsx)(k.c,{"aria-labelledby":fe,title:(0,e.jsx)(y.B,{direction:"row",alignItems:"center",children:(0,e.jsx)(x.E,{id:fe,children:p})}),icon:(0,e.jsx)(he.c,{operation:H}),meta:ce})}function ie({content:p,error:R}){return R?(0,e.jsx)(x.E,{variant:"bodySmall",color:"error",weight:"light",truncate:!0,element:"p",children:R}):p?(0,e.jsx)(x.E,{variant:"bodySmall",color:"secondary",truncate:!0,children:p}):null}function Ve({labels:p}){const R=(0,d.of)(z);return(0,e.jsx)(c.m,{content:(0,e.jsx)("div",{className:R.ruleLabels.tooltip,children:(0,e.jsx)(h.m,{labels:p,size:"sm"})}),placement:"right",interactive:!0,children:(0,e.jsx)("div",{children:(0,e.jsx)(x.E,{variant:"bodySmall",color:"primary",children:M()("label",(0,Q.rm)(p),!0)})})})}function w({lastEvaluation:p,evaluationInterval:R,state:W}){const F=(0,q.C)(p,R);return W===g.cF.Firing&&F?(0,e.jsxs)(B.P,{icon:"clock-nine",children:[(0,e.jsx)(s.x6,{i18nKey:"alerting.alert-rules.firing-for",children:"Firing for"})," ",(0,e.jsx)(x.E,{color:"primary",children:"2m 34s"}),F&&(0,e.jsxs)(e.Fragment,{children:["\xB7 ",(0,e.jsx)(s.x6,{i18nKey:"alerting.alert-rules.next-evaluation-in",children:"next evaluation in"})," ",F.humanized]})]}):F?(0,e.jsxs)(B.P,{icon:"clock-nine",children:[(0,e.jsx)(s.x6,{i18nKey:"alerting.alert-rules.next-evaluation",children:"Next evaluation"})," ",F.humanized]}):null}const b=({ruleName:p,groupIdentifier:R,ruleDefinition:W})=>{const F=(0,d.of)(z);return(0,E.useEffect)(()=>{const{namespace:ee,groupName:H}=R,U={name:p,groupName:H,namespace:JSON.stringify(ee),rulesSource:(0,K.rO)(R)};(0,j.vV)(new Error("unknown rule type"),U)},[p,R]),(0,e.jsx)(P.F,{title:(0,s.t)("alerting.unknown-rule-list-item.title-unknown-rule-type","Unknown rule type"),className:F.resetMargin,children:(0,e.jsxs)("details",{children:[(0,e.jsx)("summary",{children:(0,e.jsx)(s.x6,{i18nKey:"alerting.alert-rules.rule-definition",children:"Rule definition"})}),(0,e.jsx)("pre",{children:(0,e.jsx)("code",{children:JSON.stringify(W,null,2)})})]})})},G=({namespace:p,group:R,rulesSource:W,application:F})=>{const ee=F==="grafana",H=!!W&&!!F&&!ee;return(0,e.jsxs)(y.B,{direction:"row",alignItems:"center",gap:.5,children:[ee&&(0,e.jsx)(i.I,{size:"xs",name:"folder"}),H&&(0,e.jsx)(c.m,{content:W.name,children:(0,e.jsx)("span",{children:(0,e.jsx)(A.H,{application:F,size:14})})}),(0,e.jsxs)(y.B,{direction:"row",alignItems:"center",gap:0,children:[p,(0,e.jsx)(i.I,{size:"sm",name:"angle-right"}),R]})]})},z=p=>({alertListItemContainer:(0,l.css)({position:"relative",listStyle:"none",background:p.colors.background.primary,borderBottom:`solid 1px ${p.colors.border.weak}`,padding:p.spacing(1,1,1,1.5)}),resetMargin:(0,l.css)({margin:0}),ruleLabels:{tooltip:(0,l.css)({padding:p.spacing(1)}),text:(0,l.css)({cursor:"pointer"})}})},51592:(oe,O,n)=>{n.d(O,{c:()=>x});var e=n(74848),l=n(22803),o=n(96540),M=n(63142),E=n(41654),s=n(66404);const x=c=>{const P=(0,M.of)(d),{icon:i=null,title:g,description:j,meta:h,metaRight:B,actions:$,"data-testid":u,...m}=c;return(0,e.jsx)("li",{className:P.alertListItemContainer,role:"treeitem","aria-selected":"false","data-testid":u,...m,children:(0,e.jsxs)(E.B,{direction:"row",alignItems:"start",gap:1,wrap:!1,children:[(0,e.jsx)("span",{className:P.statusIcon,children:i}),(0,e.jsxs)(E.B,{direction:"column",gap:0,flex:"1",minWidth:0,children:[(0,e.jsxs)(E.B,{direction:"column",gap:0,children:[(0,e.jsx)("div",{className:P.textOverflow,children:g}),(0,e.jsx)("div",{className:P.textOverflow,children:j})]}),(0,e.jsx)(E.B,{direction:"row",gap:.5,alignItems:"center",children:h?.map((K,Q)=>(0,e.jsxs)(o.Fragment,{children:[Q>0&&(0,e.jsx)(y,{}),K]},Q))})]}),(0,e.jsxs)(E.B,{direction:"row",alignItems:"center",gap:1,wrap:!1,children:[B,$]})]})})},r=()=>jsx(x,{icon:jsx(Skeleton,{width:16,height:16,circle:!0}),title:jsx(Skeleton,{height:16,width:350}),actions:jsx(Skeleton,{height:10,width:200})}),y=()=>(0,e.jsx)(s.E,{color:"secondary",variant:"bodySmall",children:"\xB7"}),d=c=>({alertListItemContainer:(0,l.css)({position:"relative",listStyle:"none",padding:c.spacing(1),"&:hover":{background:c.colors.action.hover}}),textOverflow:(0,l.css)({overflow:"hidden",textOverflow:"ellipsis",color:"inherit"}),statusIcon:(0,l.css)({marginTop:c.spacing(.5)})})},64628:(oe,O,n)=>{n.d(O,{i:()=>c});var e=n(74848),l=n(22803),o=n(2543),M=n.n(o),E=n(42941),s=n(92745),x=n(63142),r=n(41654),y=n(76319),d=n(49779);const c=({children:i,title:g,collapsed:j=!1,actions:h=null,pagination:B=null})=>{const $=(0,x.of)(P),[u,m]=(0,E.A)(j);return(0,e.jsxs)("li",{className:$.wrapper,role:"treeitem","aria-selected":"false",children:[(0,e.jsx)("div",{className:$.sectionTitle,children:(0,e.jsxs)(r.B,{alignItems:"center",children:[(0,e.jsxs)(r.B,{alignItems:"center",gap:.5,children:[(0,e.jsx)(y.K,{name:u?"angle-right":"angle-down",onClick:m,"aria-label":(0,s.t)("common.collapse","Collapse")}),g]}),h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(d.h,{}),h]})]})}),!(0,o.isEmpty)(i)&&!u&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("ul",{role:"group",className:$.groupItemsWrapper,children:i}),B]})]})},P=i=>({groupItemsWrapper:(0,l.css)({position:"relative","li[role=treeitem]":{paddingLeft:i.spacing(6.5),"&:before":{content:"''",position:"absolute",height:"100%",marginLeft:i.spacing(-1.5),marginTop:i.spacing(-1),borderLeft:`solid 1px ${i.colors.border.weak}`}}}),wrapper:(0,l.css)({display:"flex",flexDirection:"column"}),sectionTitle:(0,l.css)({padding:i.spacing(1,1.5),"&:hover":{background:i.colors.action.hover}})})},1148:(oe,O,n)=>{n.d(O,{H:()=>d});var e=n(74848),l=n(22803),o=n(30703),M=n(86559),E=n(27323),s=n(33611),x=n(24619),r=n(2401);const y=({children:i,name:g,href:j,application:h})=>{const B=useStyles2(c);return jsxs("li",{className:B.namespaceWrapper,role:"treeitem","aria-selected":"false",children:[jsx("div",{className:B.namespaceTitle,children:jsxs(Stack,{alignItems:"center",gap:1,children:[jsx(d,{application:h}),j?jsx(WithReturnButton,{title:t("alerting.namespace.title-alert-rules","Alert rules"),component:jsx(TextLink,{href:j,inline:!1,children:g})}):g]})}),i&&jsx("ul",{role:"group",className:B.groupItemsWrapper,children:i})]})},d=({application:i,size:g=16})=>{switch(i){case x.N1.Prometheus:return(0,e.jsx)("img",{width:g,height:g,src:s,alt:"Prometheus"});case x.N1.Mimir:return(0,e.jsx)("img",{width:g,height:g,src:E,alt:"Mimir"});case"Loki":return(0,e.jsx)("img",{width:g,height:g,src:M,alt:"Loki"});case"grafana":default:return(0,e.jsx)(o.I,{name:"grafana"})}},c=i=>({groupItemsWrapper:css({position:"relative",borderRadius:i.shape.radius.default,border:`solid 1px ${i.colors.border.weak}`,borderBottom:"none",marginLeft:i.spacing(3),"&:before":{content:"''",position:"absolute",height:"100%",borderLeft:`solid 1px ${i.colors.border.weak}`,marginTop:0,marginLeft:`-${i.spacing(2.5)}`}}),namespaceWrapper:css({display:"flex",flexDirection:"column",gap:i.spacing(1)}),namespaceTitle:css({padding:`${i.spacing(1)} ${i.spacing(1.5)}`})});var P=null},87672:(oe,O,n)=>{n.d(O,{c:()=>h,s:()=>d});var e=n(74848),l=n(22803),o=n(96540),M=n(63142),E=n(45967),s=n(66404),x=n(30703),r=n(24619),y=n(22973),d=(u=>(u.Creating="Creating",u.Deleting="Deleting",u))(d||{});const c={[r.cF.Inactive]:"check-circle",[r.cF.Pending]:"circle",[r.cF.Recovering]:"exclamation-circle",[r.cF.Firing]:"exclamation-circle",[r.cF.Unknown]:"question-circle"},P={[r.cF.Inactive]:"success",[r.cF.Pending]:"warning",[r.cF.Recovering]:"warning",[r.cF.Firing]:"error",[r.cF.Unknown]:"info"},i={[r.cF.Inactive]:"Normal",[r.cF.Pending]:"Pending",[r.cF.Firing]:"Firing",[r.cF.Recovering]:"Recovering",[r.cF.Unknown]:"Unknown"},g={Creating:"plus-circle",Deleting:"minus-circle"},j=15,h=(0,o.memo)(function({state:m,health:K,recording:Q=!1,isPaused:Z=!1,operation:k}){const A=(0,M.of)($),he=(0,M.$j)();let q=m?c[m]:"circle",ge=m?P[m]:"secondary",xe=m?i[m]:"unknown";return Q&&(q="record-audio",ge="success",xe="Recording"),K==="nodata"&&(q="exclamation-triangle",ge="warning",xe="Insufficient data"),(0,y.lf)(K)&&(q="times-circle",ge="error",xe="Failed to evaluate rule"),Z&&(q="pause-circle",ge="warning",xe="Paused"),k&&(q=g[k],ge="secondary",xe=k),(0,e.jsx)(E.m,{content:xe,placement:"right",children:(0,e.jsx)("div",{children:(0,e.jsx)(s.E,{color:ge,children:(0,e.jsxs)("div",{className:A.iconsContainer,children:[(0,e.jsx)(x.I,{name:q,width:j,height:j,title:xe}),k&&(0,e.jsx)("svg",{width:j,height:j,viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:A.spinning,children:(0,e.jsx)("circle",{r:j/2,cx:"10",cy:"10",stroke:he.colors.background.primary,strokeWidth:"2",strokeLinecap:"round",fill:"transparent",strokeOpacity:.85,strokeDasharray:"20px"})})]})})})})}),B=(0,l.keyframes)({"0%":{transform:"rotate(0deg)"},"50%":{transform:"rotate(180deg)"},"100%":{transform:"rotate(360deg)"}}),$=u=>({iconsContainer:(0,l.css)({position:"relative",width:j,height:j,"> *":{position:"absolute"}}),spinning:(0,l.css)({[u.transitions.handleMotion("no-preference")]:{animationName:B,animationIterationCount:"infinite",animationDuration:"1s",animationTimingFunction:"linear"}})})},88721:(oe,O,n)=>{n.d(O,{V:()=>o});var e=n(96540),l=n(54);function o(){return(0,e.useMemo)(()=>(0,l.Q9)(),[])}},66178:(oe,O,n)=>{n.d(O,{A:()=>o});var e=n(96540),l=function(M,E){var s=(0,e.useRef)(function(){});(0,e.useEffect)(function(){s.current=M}),(0,e.useEffect)(function(){if(E!==null){var x=setInterval(function(){return s.current()},E||0);return function(){return clearInterval(x)}}},[E])};const o=l}}]);

//# sourceMappingURL=1851.57ee4c7e501b89998300.js.map