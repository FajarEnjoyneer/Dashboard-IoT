"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[20],{97369:(ze,xe,C)=>{C.d(xe,{S6:()=>ie,Jz:()=>re,oA:()=>de,Ik:()=>be});var l=C(95004),h=C(69884),oe=C(11576),v=C(62599),M=C(2543);function je(P,r){const m=ae(P);return le(m,r,"parents")}function ae(P){return P.map(r=>{if(!r.parents?.length)return r;const m={...r,children:[]},S=[{child:m,parent:r.parents[0]}];for(;S.length;){const y=S.shift(),L={...y.parent,children:y.child?[y.child]:[],parents:[]};y.child&&(L.value=y.child.value,y.child.parents=[L]),y.parent.parents?.length&&S.push({child:L,parent:y.parent.parents[0]})}return m})}function le(P,r,m="children"){const S=m==="parents"?"children":"parents",y=[],L=[{previous:void 0,items:P,level:0}];for(;L.length;){const D=L.shift(),z=D.items.flatMap(H=>H.itemIndexes),$={value:D.items.reduce((H,Ce)=>H+Ce.value,0),itemIndexes:z,children:[],parents:[],start:0,level:D.level};if(y[D.level]=y[D.level]||[],y[D.level].push($),D.previous){$[S]=[D.previous];const H=D.previous[m]?.reduce((Ce,Pe)=>Ce+Pe.value,0)||0;$.start=D.previous.start+H,D.previous[m].push($)}const ce=D.items.flatMap(H=>H[m]||[]),X=(0,M.groupBy)(ce,H=>r.getLabel(H.itemIndexes[0]));for(const H of Object.values(X))L.push({previous:$,items:H,level:D.level+1})}return m==="parents"&&(y.reverse(),y.forEach((D,z)=>{D.forEach($=>{$.level=z})})),y}function De(P,r){const m=[];let S=0,y;const L=Object.create(null);for(let z=0;z<P.data.length;z++){const $=P.getLevel(z),ce=z>0?P.getLevel(z-1):void 0;if(m[$]=m[$]||[],ce&&ce>=$){const H=m[$][m[$].length-1];S=H.start+P.getValue(H.itemIndexes[0])+P.getValueRight(H.itemIndexes[0]),y=H.parents[0]}const X={itemIndexes:[z],value:P.getValue(z)+P.getValueRight(z),valueRight:P.isDiffFlamegraph()?P.getValueRight(z):void 0,start:S,parents:y&&[y],children:[],level:$};L[P.getLabel(z)]?L[P.getLabel(z)].push(X):L[P.getLabel(z)]=[X],y&&y.children.push(X),y=X,m[$].push(X)}const D=new Re(r?.collapsingThreshold);return r?.collapsing&&D.addTree(m[0][0]),[m,L,D.getCollapsedMap()]}class ie{constructor(r){this.map=new Map,this.map=r||new Map}get(r){return this.map.get(r)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(r,m){const S=new Map(this.map),y=this.map.get(r),L={...y,collapsed:m};for(const D of y.items)S.set(D,L);return new ie(S)}setAllCollapsedStatus(r){const m=new Map(this.map);for(const S of this.map.keys()){const L={...this.map.get(S),collapsed:r};m.set(S,L)}return new ie(m)}}class Re{constructor(r){this.map=new Map,this.threshold=.99,r!==void 0&&(this.threshold=r)}addTree(r){const m=[r];for(;m.length;){const S=m.shift();S.parents?.length&&this.addItem(S,S.parents[0]),S.children.length&&m.unshift(...S.children)}}addItem(r,m){if(m&&r.value>m.value*this.threshold&&m.children.length===1)if(this.map.has(m)){const S=this.map.get(m);this.map.set(r,S),S.items.push(r)}else{const S={items:[m,r],collapsed:!0};this.map.set(m,S),this.map.set(r,S)}}getCollapsedMap(){return new ie(this.map)}}function be(P){return P.missingFields.length?`Data is missing fields: ${P.missingFields.join(", ")}`:P.wrongTypeFields.length?`Data has fields of wrong type: ${P.wrongTypeFields.map(r=>`${r.name} has type ${r.type} but should be ${r.expectedTypes.join(" or ")}`).join(", ")}`:""}function de(P){const r=[["label",[l.PU.string,l.PU.enum]],["level",[l.PU.number]],["value",[l.PU.number]],["self",[l.PU.number]]],m=[],S=[];for(const y of r){const[L,D]=y,z=P?.fields.find($=>$.name===L);if(!z){m.push(L);continue}D.includes(z.type)||S.push({name:L,expectedTypes:D,type:z.type})}if(m.length>0||S.length>0)return{wrongTypeFields:S,missingFields:m}}class re{constructor(r,m,S=(0,h.a)()){this.data=r,this.options=m;const y=de(r);if(y)throw new Error(be(y));if(this.labelField=r.fields.find(D=>D.name==="label"),this.levelField=r.fields.find(D=>D.name==="level"),this.valueField=r.fields.find(D=>D.name==="value"),this.selfField=r.fields.find(D=>D.name==="self"),this.valueRightField=r.fields.find(D=>D.name==="valueRight"),this.selfRightField=r.fields.find(D=>D.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const L=this.labelField?.config?.type?.enum;L?(this.labelDisplayProcessor=(0,oe.J)({field:this.labelField,theme:S}),this.uniqueLabels=L.text||[]):(this.labelDisplayProcessor=D=>({text:D+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,oe.J)({field:this.valueField,theme:S})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(r){return this.labelDisplayProcessor(this.labelField.values[r]).text}getLevel(r){return this.levelField.values[r]}getValue(r){return fe(this.valueField,r)}getValueRight(r){return fe(this.valueRightField,r)}getSelf(r){return fe(this.selfField,r)}getSelfRight(r){return fe(this.selfRightField,r)}getSelfDisplay(r){return this.valueDisplayProcessor(this.getSelf(r))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case v.Zk.Bytes:return"RAM";case v.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(r){const m=this.getNodesWithLabel(r);if(!m?.length)return[[],[]];const S=je(m,this),y=le(m,this);return[S,y]}getNodesWithLabel(r){return this.initLevels(),this.uniqueLabelsMap[r]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[r,m,S]=De(this,this.options);this.levels=r,this.uniqueLabelsMap=m,this.collapsedMap=S}}}function fe(P,r){return P?(typeof r=="number"?[r]:r).reduce((S,y)=>S+P.values[y],0):0}},10020:(ze,xe,C)=>{C.d(xe,{Ay:()=>Qt});var l=C(74848),h=C(22803),oe=C(84139),v=C(96540),M=C(49185),je=C(35555),ae=C(30703);const le=22*window.devicePixelRatio,De=10*window.devicePixelRatio,ie=.5*window.devicePixelRatio,Re=20*window.devicePixelRatio,be=.5*window.devicePixelRatio,de=4*window.devicePixelRatio,re=3*window.devicePixelRatio,fe=3*window.devicePixelRatio,P=4*window.devicePixelRatio,r=2*window.devicePixelRatio,m=800,S=120;var y=C(94535),L=C(30930),D=C(97375);const $=({data:e,itemData:t,onMenuItemClick:s,onItemFocus:a,onSandwich:n,collapseConfig:c,onExpandGroup:i,onCollapseGroup:u,onExpandAllGroups:o,onCollapseAllGroups:d,getExtraContextMenuButtons:g,collapsing:b,allGroupsExpanded:p,allGroupsCollapsed:x,selectedView:f,search:R})=>{function w(){const F=g?.(t,e.data,{selectedView:f,isDiff:e.isDiffFlamegraph(),search:R,collapseConfig:c})||[];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.D,{label:"Focus block",icon:"eye",onClick:()=>{a(),s()}}),(0,l.jsx)(y.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(t.label).then(()=>{s()})}}),(0,l.jsx)(y.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{n(),s()}}),F.map(({label:j,icon:T,onClick:E})=>(0,l.jsx)(y.D,{label:j,icon:T,onClick:()=>E()},j)),b&&(0,l.jsxs)(L.r,{label:"Grouping",children:[c?c.collapsed?(0,l.jsx)(y.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{i(),s()}}):(0,l.jsx)(y.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{u(),s()}}):null,!p&&(0,l.jsx)(y.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{o(),s()}}),!x&&(0,l.jsx)(y.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{d(),s()}})]})]})}return(0,l.jsx)("div",{"data-testid":"contextMenu",children:(0,l.jsx)(D.t,{renderMenuItems:w,x:t.posX+10,y:t.posY,focusOnOpen:!1})})};var ce=C(55386),X=C(63142),H=C(27594),Ce=C(15245),Pe=C(71076);const Ke=({data:e,item:t,totalTicks:s,position:a,collapseConfig:n})=>{const c=(0,X.of)(qe);if(!(t&&a))return null;let i;if(e.isDiffFlamegraph()){const u=Qe(e,t,s);i=(0,l.jsx)(H.j,{className:c.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:u,getRowId:o=>o.rowId})}else{const u=Ze(e,t,s);i=(0,l.jsxs)("p",{className:c.lastParagraph,children:[u.unitTitle,(0,l.jsx)("br",{}),"Total: ",(0,l.jsx)("b",{children:u.unitValue})," (",u.percentValue,"%)",(0,l.jsx)("br",{}),"Self: ",(0,l.jsx)("b",{children:u.unitSelf})," (",u.percentSelf,"%)",(0,l.jsx)("br",{}),"Samples: ",(0,l.jsx)("b",{children:u.samples})]})}return(0,l.jsx)(Ce.ZL,{children:(0,l.jsx)(Pe.o,{className:c.tooltipContainer,position:a,offset:{x:15,y:0},children:(0,l.jsxs)("div",{className:c.tooltipContent,children:[(0,l.jsxs)("p",{className:c.tooltipName,children:[e.getLabel(t.itemIndexes[0]),n&&n.collapsed?(0,l.jsxs)("span",{children:[(0,l.jsx)("br",{}),"and ",n.items.length," similar items"]}):""]}),i]})})})},Ze=(e,t,s)=>{const a=e.valueDisplayProcessor(t.value),n=e.getSelfDisplay(t.itemIndexes),c=Math.round(1e4*(a.numeric/s))/100,i=Math.round(1e4*(n.numeric/s))/100;let u=a.text+a.suffix,o=n.text+n.suffix;const d=e.getUnitTitle();return d==="Count"&&(a.suffix||(u=a.text),n.suffix||(o=n.text)),{percentValue:c,percentSelf:i,unitTitle:d,unitValue:u,unitSelf:o,samples:a.numeric.toLocaleString()}},Qe=(e,t,s)=>{const n=e.getLevels()[0][0].valueRight,c=s-n,i=t.value-t.valueRight,u=Math.round(1e4*i/c)/100,o=Math.round(1e4*t.valueRight/n)/100,d=(o-u)/u*100,g=Be(e,e.valueDisplayProcessor(i)),b=Be(e,e.valueDisplayProcessor(t.valueRight)),p=(0,ce.j_)("short");return[{rowId:"1",label:"% of total",baseline:u+"%",comparison:o+"%",diff:p(d).text+"%"},{rowId:"2",label:"Value",baseline:g,comparison:b,diff:Be(e,e.valueDisplayProcessor(t.valueRight-i))},{rowId:"3",label:"Samples",baseline:p(i).text,comparison:p(t.valueRight).text,diff:p(t.valueRight-i).text}]};function Be(e,t){let s=t.text+t.suffix;return e.getUnitTitle()==="Count"&&(t.suffix||(s=t.text)),s}const qe=e=>({tooltipContainer:(0,h.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,h.css)({title:"tooltipContent",fontSize:e.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,h.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,h.css)({title:"lastParagraph",marginBottom:0}),name:(0,h.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,h.css)({title:"tooltipTable",maxWidth:"400px"})}),_e=Ke;var k=C(84140),N=C(62599),et=C(55995);function tt(e,t=0){let s,a,n,c,i,u,o,d;for(s=e.length&3,a=e.length-s,n=t,i=3432918353,u=461845907,d=0;d<a;)o=e.charCodeAt(d)&255|(e.charCodeAt(++d)&255)<<8|(e.charCodeAt(++d)&255)<<16|(e.charCodeAt(++d)&255)<<24,++d,o=(o&65535)*i+(((o>>>16)*i&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(o&65535)*u+(((o>>>16)*u&65535)<<16)&4294967295,n^=o,n=n<<13|n>>>19,c=(n&65535)*5+(((n>>>16)*5&65535)<<16)&4294967295,n=(c&65535)+27492+(((c>>>16)+58964&65535)<<16);switch(o=0,s){case 3:o^=(e.charCodeAt(d+2)&255)<<16;case 2:o^=(e.charCodeAt(d+1)&255)<<8;case 1:o^=e.charCodeAt(d)&255;default:o=(o&65535)*i+(((o>>>16)*i&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(o&65535)*u+(((o>>>16)*u&65535)<<16)&4294967295,n^=o}return n^=e.length,n^=n>>>16,n=(n&65535)*2246822507+(((n>>>16)*2246822507&65535)<<16)&4294967295,n^=n>>>13,n=(n&65535)*3266489909+(((n>>>16)*3266489909&65535)<<16)&4294967295,n^=n>>>16,n>>>0}const ue=[(0,k.A)({h:24,s:69,l:60}),(0,k.A)({h:34,s:65,l:65}),(0,k.A)({h:194,s:52,l:61}),(0,k.A)({h:163,s:45,l:55}),(0,k.A)({h:211,s:48,l:60}),(0,k.A)({h:246,s:40,l:65}),(0,k.A)({h:305,s:63,l:79}),(0,k.A)({h:47,s:100,l:73}),(0,k.A)({r:183,g:219,b:171}),(0,k.A)({r:244,g:213,b:152}),(0,k.A)({r:78,g:146,b:249}),(0,k.A)({r:249,g:186,b:143}),(0,k.A)({r:242,g:145,b:145}),(0,k.A)({r:130,g:181,b:216}),(0,k.A)({r:229,g:168,b:226}),(0,k.A)({r:174,g:162,b:224}),(0,k.A)({r:154,g:196,b:138}),(0,k.A)({r:242,g:201,b:109}),(0,k.A)({r:101,g:197,b:219}),(0,k.A)({r:249,g:147,b:78}),(0,k.A)({r:234,g:100,b:96}),(0,k.A)({r:81,g:149,b:206}),(0,k.A)({r:214,g:131,b:206}),(0,k.A)({r:128,g:110,b:183})],st=ke(1,100,0,1),lt=ke(100,100,0,1),nt=`linear-gradient(90deg, ${st} 0%, ${lt} 100%)`,at=`linear-gradient(90deg, ${ue[0]} 0%, ${ue[2]} 30%, ${ue[6]} 50%, ${ue[7]} 70%, ${ue[8]} 100%)`;function ke(e,t,s,a){const n=Math.min(1,e/t/(a-s)),c=50-50*n,i=65+7*n;return(0,k.A)({h:c,s:100,l:i})}function ot(e,t){const s=dt(e),n=tt(s||"",0)%ue.length;let c=ue[n].clone();return t.isLight&&(c=c.brighten(15)),c}const he=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],it=`linear-gradient(90deg, ${he[0]} 0%, ${he[1]} 50%, ${he[2]} 100%)`,pe=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],rt=`linear-gradient(90deg, ${pe[0]} 0%, ${pe[1]} 50%, ${pe[2]} 100%)`;function ct(e,t,s,a,n){const c=n===N.yU.Default?he:pe,i=(0,et.scaleLinear)().domain([-100,0,100]).range(c),u=e-t,o=s-a;if(a===0||o===0){const x=i(0);return(0,k.A)(x)}const d=Math.round(1e4*u/o)/100,b=(Math.round(1e4*t/a)/100-d)/d*100,p=i(b);return(0,k.A)(p)}const ut=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function dt(e){for(const[t,s]of ut){const a=e.match(s);if(a)return a.groups?.packageName||""}}function ft(e){const{canvasRef:t,data:s,root:a,depth:n,direction:c,wrapperWidth:i,rangeMin:u,rangeMax:o,matchedLabels:d,textAlign:g,totalViewTicks:b,totalColorTicks:p,totalTicksRight:x,colorScheme:f,focusedItemData:R,collapsedMap:w}=e,F=vt(t,i,n),j=(0,X.$j)(),T=(0,v.useMemo)(()=>{const A=(0,k.A)(j.colors.background.secondary);return j.isLight?A.darken(10).toHexString():A.lighten(10).toHexString()},[j]),E=mt(p,x,f,j,T,u,o,d,R?R.item.level:0),B=ht(F,s,E,g,w);(0,v.useEffect)(()=>{if(!F)return;F.clearRect(0,0,F.canvas.width,F.canvas.height);const A=new Path2D;gt(a,c,s,b,u,o,i,w,(J,W,K,q,V,Y,te)=>{te?A.rect(W,K,q,V):B(J,W,K,q,V,Y)}),F.fillStyle=T,F.fill(A)},[F,s,a,i,u,o,b,c,B,w,T])}function ht(e,t,s,a,n){return(0,v.useMemo)(()=>e?(i,u,o,d,g,b)=>{e.beginPath(),e.rect(u+be,o,d,g),e.fillStyle=s(i,b,!1),e.stroke(),e.fill();const p=n.get(i);let x=b;p&&p.collapsed&&(x=`(${p.items.length}) `+b),d>=Re&&(p?(Ee(e,t,x,i,d,a==="left"?u+P+r:u,o,a),pt(e,u,o,g,i,p)):Ee(e,t,x,i,d,u,o,a))}:()=>{},[e,s,a,t,n])}function pt(e,t,s,a,n,c){const i=t+P;e.beginPath(),e.rect(t,s,i-t+re+fe,a),e.fill(),e.beginPath(),c.collapsed?e.rect(i,s+a/4,re,a/2):c.items[0]===n?e.rect(i,s+a/2,re,a/2):c.items[c.items.length-1]===n?e.rect(i,s,re,a/2):e.rect(i,s,re,a),e.fillStyle="#666",e.fill()}function gt(e,t,s,a,n,c,i,u,o){const d=[];d.push({item:e,levelOffset:0});const g=i*window.devicePixelRatio/a/(c-n);let b;for(;d.length>0;){const{item:p,levelOffset:x}=d.shift();let f=p.value;const R=f*g<=De,w=f*g-(R?0:be*2),F=le;if(w<ie)continue;let j=0,T=!1;const E=u.get(p),B=E&&E.collapsed;if(B&&b===E.items[0]?(j=t==="children"?-1:1,T=!0):b=void 0,!T){const J=Ne(p.start,a,n,g),W=(p.level+x)*le;let K=s.getLabel(p.itemIndexes[0]);B&&(b=p),o(p,J,W,w,F,K,R)}const A=t==="children"?p.children:p.parents;A&&d.unshift(...A.map(J=>({item:J,levelOffset:x+j})))}}function mt(e,t,s,a,n,c,i,u,o){return(0,v.useCallback)(function(g,b,p){if(p&&!u)return n;const x=g.valueRight!==void 0&&(s===N.yU.Default||s===N.yU.DiffColorBlind)?ct(g.value,g.valueRight,e,t,s):s===N.zM.ValueBased?ke(g.value,e,c,i):ot(b,a);return u?u.has(b)?x.toHslString():n:g.level>o-1?x.toHslString():x.lighten(15).toHslString()},[e,t,s,a,c,i,u,o,n])}function vt(e,t,s){const[a,n]=(0,v.useState)();return(0,v.useEffect)(()=>{if(!(s&&e.current))return;const c=e.current.getContext("2d"),i=le*s;e.current.width=Math.round(t*window.devicePixelRatio),e.current.height=Math.round(i),e.current.style.width=`${t}px`,e.current.style.height=`${i/window.devicePixelRatio}px`,c.textBaseline="middle",c.font=12*window.devicePixelRatio+"px monospace",c.strokeStyle="white",n(c)},[e,n,t,s]),a}function Ee(e,t,s,a,n,c,i,u){e.save(),e.clip(),e.fillStyle="#222";const o=t.valueDisplayProcessor(a.value),d=o.suffix?o.text+o.suffix:o.text,g=e.measureText(s),b=n-de;let p=`${s} (${d})`,x=Math.max(c,0)+de;g.width>b&&(e.textAlign=u,u==="right"&&(p=s,x=c+n-de)),e.fillText(p,x,i+le/2+2),e.restore()}function Ne(e,t,s,a){return(e-t*s)*a}const xt=({data:e,rangeMin:t,rangeMax:s,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:d,colorScheme:g,totalProfileTicks:b,totalProfileTicksRight:p,totalViewTicks:x,root:f,direction:R,depth:w,showFlameGraphOnly:F,collapsedMap:j,setCollapsedMap:T,collapsing:E,getExtraContextMenuButtons:B,selectedView:A,search:J})=>{const W=bt(),[K,{width:q}]=(0,M.A)(),V=(0,v.useRef)(null),[Y,te]=(0,v.useState)(),[O,_]=(0,v.useState)();ft({canvasRef:V,colorScheme:g,data:e,focusedItemData:u,root:f,direction:R,depth:w,rangeMax:s,rangeMin:t,matchedLabels:a,textAlign:o,totalViewTicks:x,totalColorTicks:e.isDiffFlamegraph()?b:x,totalTicksRight:p,wrapperWidth:q,collapsedMap:j});const U=(0,v.useCallback)(I=>{te(void 0);const Q=V.current.clientWidth/x/(s-t),se=$e({x:I.nativeEvent.offsetX,y:I.nativeEvent.offsetY},f,R,w,Q,x,t,j);_(se?{posY:I.clientY,posX:I.clientX,item:se,label:e.getLabel(se.itemIndexes[0])}:void 0)},[e,t,s,x,f,R,w,j]),[ne,ee]=(0,v.useState)(),Z=(0,v.useCallback)(I=>{if(O===void 0){te(void 0),ee(void 0);const Q=V.current.clientWidth/x/(s-t),se=$e({x:I.nativeEvent.offsetX,y:I.nativeEvent.offsetY},f,R,w,Q,x,t,j);se&&(ee({x:I.clientX,y:I.clientY}),te(se))}},[t,s,x,O,ee,f,R,w,j]),me=(0,v.useCallback)(()=>{te(void 0)},[]);return(0,v.useEffect)(()=>{const I=Q=>{Q.target instanceof HTMLElement&&Q.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&_(void 0)};return window.addEventListener("click",I),()=>window.removeEventListener("click",I)},[_]),(0,l.jsxs)("div",{className:W.graph,children:[(0,l.jsx)("div",{className:W.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:K,children:(0,l.jsx)("canvas",{ref:V,"data-testid":"flameGraph",onClick:U,onMouseMove:Z,onMouseLeave:me})}),(0,l.jsx)(_e,{position:ne,item:Y,data:e,totalTicks:x,collapseConfig:Y?j.get(Y):void 0}),!F&&O&&(0,l.jsx)($,{data:e,itemData:O,collapsing:E,collapseConfig:j.get(O.item),onMenuItemClick:()=>{_(void 0)},onItemFocus:()=>{n(O.item.start/x),c((O.item.start+O.item.value)/x),i(O)},onSandwich:()=>{d(e.getLabel(O.item.itemIndexes[0]))},onExpandGroup:()=>{T(j.setCollapsedStatus(O.item,!1))},onCollapseGroup:()=>{T(j.setCollapsedStatus(O.item,!0))},onExpandAllGroups:()=>{T(j.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{T(j.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(j.values()).every(I=>I.collapsed),allGroupsExpanded:Array.from(j.values()).every(I=>!I.collapsed),getExtraContextMenuButtons:B,selectedView:A,search:J})]})},bt=()=>({graph:(0,h.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,h.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,h.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,h.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,h.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),$e=(e,t,s,a,n,c,i,u)=>{let o=t,d=s==="children"?0:a-1;const g=Math.floor(e.y/(le/window.devicePixelRatio));let b;for(;o;){const p=o;if(o=void 0,d===g){b=p;break}const x=s==="children"?p.children:p.parents||[];for(const f of x){const R=Ne(f.start,c,i,n),w=Ne(f.start+f.value,c,i,n);if(R<=e.x&&e.x<w){o=f;const F=u.get(f);(!F||!F.collapsed||F.items[0]===f)&&(d=d+(s==="children"?1:-1));break}}}return b},Ie=xt;var We=C(45967),Fe=C(76319);const Oe=(0,v.memo)(({data:e,focusedItem:t,totalTicks:s,sandwichedLabel:a,onFocusPillClick:n,onSandwichPillClick:c})=>{const i=(0,X.of)(Ct),u=[],o=(0,ce.j_)("short")(s),d=e.valueDisplayProcessor(s);let g=d.text+d.suffix;const b=e.getUnitTitle();if(b==="Count"&&(d.suffix||(g=d.text)),u.push((0,l.jsxs)("div",{className:i.metadataPill,children:[g," | ",o.text,o.suffix," samples (",b,")"]},"default")),a&&u.push((0,l.jsx)(We.m,{content:a,placement:"top",children:(0,l.jsxs)("div",{children:[(0,l.jsx)(ae.I,{size:"sm",name:"angle-right"}),(0,l.jsxs)("div",{className:i.metadataPill,children:[(0,l.jsx)(ae.I,{size:"sm",name:"gf-show-context"})," ",(0,l.jsx)("span",{className:i.metadataPillName,children:a.substring(a.lastIndexOf("/")+1)}),(0,l.jsx)(Fe.K,{className:i.pillCloseButton,name:"times",size:"sm",onClick:c,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]})},"sandwich")),t){const p=s>0?Math.round(1e4*(t.item.value/s))/100:0,x=p>0?"eye":"exclamation-circle";u.push((0,l.jsx)(We.m,{content:t.label,placement:"top",children:(0,l.jsxs)("div",{children:[(0,l.jsx)(ae.I,{size:"sm",name:"angle-right"}),(0,l.jsxs)("div",{className:i.metadataPill,children:[(0,l.jsx)(ae.I,{size:"sm",name:x}),"\xA0",p,"% of total",(0,l.jsx)(Fe.K,{className:i.pillCloseButton,name:"times",size:"sm",onClick:n,tooltip:"Remove focus","aria-label":"Remove focus"})]})]})},"focus"))}return(0,l.jsx)("div",{className:i.metadata,children:u})});Oe.displayName="FlameGraphMetadata";const Ct=e=>({metadataPill:(0,h.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:e.colors.background.secondary,borderRadius:e.shape.borderRadius(8),padding:e.spacing(.5,1),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,lineHeight:e.typography.bodySmall.lineHeight,color:e.colors.text.secondary}),pillCloseButton:(0,h.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:e.spacing(0,.5)}),metadata:(0,h.css)({display:"flex",alignItems:"center",justifyContent:"center",margin:"8px 0"}),metadataPillName:(0,h.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:e.spacing(.5)})}),yt=Oe,St=({data:e,rangeMin:t,rangeMax:s,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:d,sandwichItem:g,onFocusPillClick:b,onSandwichPillClick:p,colorScheme:x,showFlameGraphOnly:f,getExtraContextMenuButtons:R,collapsing:w,selectedView:F,search:j,collapsedMap:T,setCollapsedMap:E})=>{const B=wt(),[A,J]=(0,v.useState)(),[W,K]=(0,v.useState)(),[q,V]=(0,v.useState)(0),[Y,te]=(0,v.useState)(),[O,_]=(0,v.useState)(0);if((0,v.useEffect)(()=>{if(e){let ee=e.getLevels(),Z=ee.length?ee[0][0].value:0,me=ee.length?ee[0][0].valueRight:void 0,I=Z,Q;if(g){const[se,ve]=e.getSandwichLevels(g);ee=ve,Q=se,I=ve[0]?.[0]?.value??0}J(ee),K(Q),V(Z),te(me),_(I)}},[e,g]),!A)return null;const U={data:e,rangeMin:t,rangeMax:s,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:d,colorScheme:x,totalProfileTicks:q,totalProfileTicksRight:Y,totalViewTicks:O,showFlameGraphOnly:f,collapsedMap:T,setCollapsedMap:E,getExtraContextMenuButtons:R,collapsing:w,search:j,selectedView:F};let ne=null;return W?.length?ne=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:B.sandwichCanvasWrapper,children:[(0,l.jsxs)("div",{className:B.sandwichMarker,children:["Callers",(0,l.jsx)(ae.I,{className:B.sandwichMarkerIcon,name:"arrow-down"})]}),(0,l.jsx)(Ie,{...U,root:W[W.length-1][0],depth:W.length,direction:"parents",collapsing:!1})]}),(0,l.jsxs)("div",{className:B.sandwichCanvasWrapper,children:[(0,l.jsxs)("div",{className:(0,h.cx)(B.sandwichMarker,B.sandwichMarkerCalees),children:[(0,l.jsx)(ae.I,{className:B.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,l.jsx)(Ie,{...U,root:A[0][0],depth:A.length,direction:"children",collapsing:!1})]})]}):A?.length&&(ne=(0,l.jsx)(Ie,{...U,root:A[0][0],depth:A.length,direction:"children"})),(0,l.jsxs)("div",{className:B.graph,children:[(0,l.jsx)(yt,{data:e,focusedItem:u,sandwichedLabel:g,totalTicks:O,onFocusPillClick:b,onSandwichPillClick:p}),ne]})},wt=()=>({graph:(0,h.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,h.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${le/window.devicePixelRatio}px`}),sandwichMarker:(0,h.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,h.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,h.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Ft=St;var He=C(97369),Tt=C(84596),jt=C(40996),ye=C(45861),Dt=C(63527),Rt=C(93256),Ve=C(77824),ge=C(87063),Pt=C(88559);const Bt=({search:e,setSearch:t,selectedView:s,setSelectedView:a,containerWidth:n,onReset:c,textAlign:i,onTextAlignChange:u,showResetButton:o,colorScheme:d,onColorSchemeChange:g,stickyHeader:b,extraHeaderElements:p,vertical:x,isDiffMode:f,setCollapsedMap:R,collapsedMap:w})=>{const F=(0,X.of)(Ue),[j,T]=Lt(e,t),E=j!==""?(0,l.jsx)(ye.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{t(""),T("")},children:"Clear"}):null;return(0,l.jsxs)("div",{className:(0,h.cx)(F.header,{[F.stickyHeader]:b}),children:[(0,l.jsx)("div",{className:F.inputContainer,children:(0,l.jsx)(Dt.p,{value:j||"",onChange:B=>{T(B.currentTarget.value)},placeholder:"Search...",suffix:E})}),(0,l.jsxs)("div",{className:F.rightContainer,children:[o&&(0,l.jsx)(ye.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{c()},className:F.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,l.jsx)(kt,{value:d,onChange:g,isDiffMode:f}),(0,l.jsxs)(Rt.e,{className:F.buttonSpacing,children:[(0,l.jsx)(ye.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{R(w.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:s===N.F8.TopTable}),(0,l.jsx)(ye.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{R(w.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:s===N.F8.TopTable})]}),(0,l.jsx)(Ve.z,{size:"sm",disabled:s===N.F8.TopTable,options:Nt,value:i,onChange:u,className:F.buttonSpacing}),(0,l.jsx)(Ve.z,{size:"sm",options:It(n,x),value:s,onChange:a}),p&&(0,l.jsx)("div",{className:F.extraElements,children:p})]})]})};function kt(e){const t=(0,X.of)(Ue);let s=(0,l.jsxs)(ge.W,{children:[(0,l.jsx)(ge.W.Item,{label:"By package name",onClick:()=>e.onChange(N.zM.PackageBased)}),(0,l.jsx)(ge.W.Item,{label:"By value",onClick:()=>e.onChange(N.zM.ValueBased)})]});const a={[N.zM.ValueBased]:t.colorDotByValue,[N.zM.PackageBased]:t.colorDotByPackage,[N.yU.DiffColorBlind]:t.colorDotDiffColorBlind,[N.yU.Default]:t.colorDotDiffDefault}[e.value]||t.colorDotByValue;let n=(0,l.jsx)("span",{className:(0,h.cx)(t.colorDot,a)});return e.isDiffMode&&(s=(0,l.jsxs)(ge.W,{children:[(0,l.jsx)(ge.W.Item,{label:"Default (green to red)",onClick:()=>e.onChange(N.yU.Default)}),(0,l.jsx)(ge.W.Item,{label:"Color blind (blue to red)",onClick:()=>e.onChange(N.yU.DiffColorBlind)})]}),n=(0,l.jsxs)("div",{className:(0,h.cx)(t.colorDotDiff,a),children:[(0,l.jsx)("div",{children:"-100% (removed)"}),(0,l.jsx)("div",{children:"0%"}),(0,l.jsx)("div",{children:"+100% (added)"})]})),(0,l.jsx)(Pt.m,{overlay:s,children:(0,l.jsx)(ye.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:t.buttonSpacing,"aria-label":"Change color scheme",children:n})})}const Nt=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function It(e,t){let s=[{value:N.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:N.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(e>=m||t)&&s.push({value:N.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),s}function Lt(e,t){const[s,a]=(0,v.useState)(e),n=(0,Tt.A)(e);return(0,jt.A)(()=>{t(s)},250,[s]),(0,v.useEffect)(()=>{n!==e&&e!==s&&a(e)},[e,n,s]),[s,a]}const Ue=e=>({header:(0,h.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:e.spacing(1),marginTop:e.spacing(1)}),stickyHeader:(0,h.css)({zIndex:e.zIndex.navbarFixed,position:"sticky",background:e.colors.background.primary}),inputContainer:(0,h.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,h.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,h.css)({label:"buttonSpacing",marginRight:e.spacing(1)}),resetButton:(0,h.css)({label:"resetButton",display:"flex",marginRight:e.spacing(2)}),resetButtonIconWrapper:(0,h.css)({label:"resetButtonIcon",padding:"0 5px",color:e.colors.text.disabled}),colorDot:(0,h.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:e.shape.radius.circle}),colorDotDiff:(0,h.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,h.css)({label:"colorDotByValue",background:nt}),colorDotByPackage:(0,h.css)({label:"colorDotByPackage",background:at}),colorDotDiffDefault:(0,h.css)({label:"colorDotDiffDefault",background:it}),colorDotDiffColorBlind:(0,h.css)({label:"colorDotDiffColorBlind",background:rt}),extraElements:(0,h.css)({label:"extraElements",marginLeft:e.spacing(1)})}),At=Bt;var Mt=C(70713),Le=C(95004),Te=C(18600),Gt=C(60519),zt=C(24343),Ae=C(739);const Xe=(0,v.memo)(({data:e,onSymbolClick:t,search:s,matchedLabels:a,onSearch:n,sandwichItem:c,onSandwich:i,onTableSort:u,colorScheme:o})=>{const d=(0,v.useMemo)(()=>{let f=Object.create(null);for(let R=0;R<e.data.length;R++){const w=e.getValue(R),F=e.getValueRight(R),j=e.getSelf(R),T=e.getLabel(R);(!a||a.has(T))&&(f[T]=f[T]||{},f[T].self=f[T].self?f[T].self+j:j,f[T].total=f[T].total?f[T].total+w:w,f[T].totalRight=f[T].totalRight?f[T].totalRight+F:F)}return f},[e,a]),g=(0,X.of)(Ot),b=(0,X.$j)(),[p,x]=(0,v.useState)([{displayName:"Self",desc:!0}]);return(0,l.jsx)("div",{className:g.topTableContainer,"data-testid":"topTable",children:(0,l.jsx)(Mt.Ay,{style:{width:"100%"},children:({width:f,height:R})=>{if(f<3||R<3)return null;const w=Et(e,d,f,t,n,i,b,o,s,c);return(0,l.jsx)(zt.X,{initialSortBy:p,onSortByChange:F=>{F&&F.length&&u?.(F[0].displayName+"_"+(F[0].desc?"desc":"asc")),x(F)},data:w,width:f,height:R})}})})});Xe.displayName="FlameGraphTopTableContainer";function Et(e,t,s,a,n,c,i,u,o,d){const g=$t(c,n,o,d),b={type:Le.PU.string,name:"Symbol",values:[],config:{custom:{width:s-Me-S*2},links:[{title:"Highlight symbol",url:"",onClick:f=>{const w=f.origin.field.values[f.origin.rowIndex];a(w)}}]}};let p;if(e.isDiffFlamegraph()){b.config.custom.width=s-Me-S*3;const f=Se("Baseline","percent"),R=Se("Comparison","percent"),w=Se("Diff","percent");w.config.custom.cellOptions.type=Ae.ob.ColorText;const[F,j]=u===N.yU.DiffColorBlind?[pe[0],pe[2]]:[he[0],he[2]];w.config.mappings=[{type:Te.d.ValueToText,options:{[1/0]:{text:"new",color:j}}},{type:Te.d.ValueToText,options:{[-100]:{text:"removed",color:F}}},{type:Te.d.RangeToText,options:{from:0,to:1/0,result:{color:j}}},{type:Te.d.RangeToText,options:{from:-1/0,to:0,result:{color:F}}}];const T=e.getLevels(),E=T.length?T[0][0].value:0,B=T.length?T[0][0].valueRight:void 0;for(let A in t){g.values.push(null),b.values.push(A);const J=t[A].total,W=t[A].totalRight,K=E-B,q=Math.round(1e4*J/K)/100,V=Math.round(1e4*W/B)/100,Y=(V-q)/q*100;w.values.push(Y),f.values.push(q),R.values.push(V)}p={fields:[g,b,f,R,w],length:b.values.length}}else{const f=Se("Self",e.selfField.config.unit),R=Se("Total",e.valueField.config.unit);for(let w in t)g.values.push(null),b.values.push(w),f.values.push(t[w].self),R.values.push(t[w].total);p={fields:[g,b,f,R],length:b.values.length}}return(0,Gt.we)({data:[p],fieldConfig:{defaults:{},overrides:[]},replaceVariables:f=>f,theme:i})[0]}function Se(e,t){const s={width:S,align:"auto",inspect:!1,cellOptions:{type:Ae.ob.Auto}};return{type:Le.PU.number,name:e,values:[],config:{unit:t,custom:s}}}const Me=61;function $t(e,t,s,a){const n={type:Ae.ob.Custom,cellComponent:i=>(0,l.jsx)(Wt,{frame:i.frame,onSandwich:e,onSearch:t,search:s,sandwichItem:a,rowIndex:i.rowIndex})},c={filterable:!1,width:Me,hideHeader:!0,inspect:!1,align:"auto",cellOptions:n};return{type:Le.PU.number,name:"actions",values:[],config:{custom:c}}}function Wt(e){const t=Ht(),s=e.frame.fields.find(c=>c.name==="Symbol")?.values[e.rowIndex],a=e.search===s,n=e.sandwichItem===s;return(0,l.jsxs)("div",{className:t.actionCellWrapper,children:[(0,l.jsx)(Fe.K,{className:t.actionCellButton,name:"search",variant:a?"primary":"secondary",tooltip:a?"Clear from search":"Search for symbol","aria-label":a?"Clear from search":"Search for symbol",onClick:()=>{e.onSearch(a?"":s)}}),(0,l.jsx)(Fe.K,{className:t.actionCellButton,name:"gf-show-context",tooltip:n?"Remove from sandwich view":"Show in sandwich view",variant:n?"primary":"secondary","aria-label":n?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{e.onSandwich(n?void 0:s)}})]})}const Ot=e=>({topTableContainer:(0,h.css)({label:"topTableContainer",padding:e.spacing(1),backgroundColor:e.colors.background.secondary,height:"100%"})}),Ht=()=>({actionCellWrapper:(0,h.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,h.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),Vt=Xe,Ut=new oe.A,Xt=({data:e,onTableSymbolClick:t,onViewSelected:s,onTextAlignSelected:a,onTableSort:n,getTheme:c,stickyHeader:i,extraHeaderElements:u,vertical:o,showFlameGraphOnly:d,disableCollapsing:g,keepFocusOnDataChange:b,getExtraContextMenuButtons:p})=>{const[x,f]=(0,v.useState)(),[R,w]=(0,v.useState)(0),[F,j]=(0,v.useState)(1),[T,E]=(0,v.useState)(""),[B,A]=(0,v.useState)(N.F8.Both),[J,{width:W}]=(0,M.A)(),[K,q]=(0,v.useState)("left"),[V,Y]=(0,v.useState)(),[te,O]=(0,v.useState)(new He.S6),_=(0,v.useMemo)(()=>c(),[c]),U=(0,v.useMemo)(()=>{if(!e)return;const G=new He.Jz(e,{collapsing:!g},_);return O(G.getCollapsedMap()),G},[e,_,g]),[ne,ee]=Yt(U),Z=Zt(_),me=Jt(T,U);(0,v.useEffect)(()=>{W>0&&W<m&&B===N.F8.Both&&!o&&A(N.F8.FlameGraph)},[B,A,W,o]);const I=(0,v.useCallback)(()=>{f(void 0),w(0),j(1)},[f,j,w]),Q=(0,v.useCallback)(()=>{Y(void 0)},[Y]);(0,v.useEffect)(()=>{if(!b){I(),Q();return}if(U&&x){const G=U.getNodesWithLabel(x.label)?.[0];if(G){f({...x,item:G});const Ye=U.getLevels(),Je=Ye.length?Ye[0][0].value:0;w(G.start/Je),j((G.start+G.value)/Je)}else f({...x,item:{start:0,value:0,itemIndexes:[],children:[],level:0}}),w(0),j(1)}},[U,b]);const se=(0,v.useCallback)(G=>{T===G?E(""):(t?.(G),E(G),I())},[E,I,t,T]);if(!U)return null;const ve=(0,l.jsx)(Ft,{data:U,rangeMin:R,rangeMax:F,matchedLabels:me,setRangeMin:w,setRangeMax:j,onItemFocused:G=>f(G),focusedItemData:x,textAlign:K,sandwichItem:V,onSandwich:G=>{I(),Y(G)},onFocusPillClick:I,onSandwichPillClick:Q,colorScheme:ne,showFlameGraphOnly:d,collapsing:!g,getExtraContextMenuButtons:p,selectedView:B,search:T,collapsedMap:te,setCollapsedMap:O}),Ge=(0,l.jsx)(Vt,{data:U,onSymbolClick:se,search:T,matchedLabels:me,sandwichItem:V,onSandwich:Y,onSearch:E,onTableSort:n,colorScheme:ne});let we;return d||B===N.F8.FlameGraph?we=ve:B===N.F8.TopTable?we=(0,l.jsx)("div",{className:Z.tableContainer,children:Ge}):B===N.F8.Both&&(o?we=(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:Z.verticalGraphContainer,children:ve}),(0,l.jsx)("div",{className:Z.verticalTableContainer,children:Ge})]}):we=(0,l.jsxs)("div",{className:Z.horizontalContainer,children:[(0,l.jsx)("div",{className:Z.horizontalTableContainer,children:Ge}),(0,l.jsx)("div",{className:Z.horizontalGraphContainer,children:ve})]})),(0,l.jsx)(je.D.Provider,{value:_,children:(0,l.jsxs)("div",{ref:J,className:Z.container,children:[!d&&(0,l.jsx)(At,{search:T,setSearch:E,selectedView:B,setSelectedView:G=>{A(G),s?.(G)},containerWidth:W,onReset:()=>{I(),Q()},textAlign:K,onTextAlignChange:G=>{q(G),a?.(G)},showResetButton:!!(x||V),colorScheme:ne,onColorSchemeChange:ee,stickyHeader:!!i,extraHeaderElements:u,vertical:o,isDiffMode:U.isDiffFlamegraph(),setCollapsedMap:O,collapsedMap:te}),(0,l.jsx)("div",{className:Z.body,children:we})]})})};function Yt(e){const t=e?.isDiffFlamegraph()?N.yU.Default:N.zM.PackageBased,[s,a]=(0,v.useState)(t);return(0,v.useEffect)(()=>{a(t)},[t]),[s,a]}function Jt(e,t){return(0,v.useMemo)(()=>{if(!(!e||!t))return Kt(e,t)},[e,t])}function Kt(e,t){const s=new Set,a=e.split(","),n=(i,u)=>{let o;try{o=new RegExp(u)}catch{return!1}let d=!1;for(let g of i)o.test(g)&&(s.add(g),d=!0);return d},c=(i,u)=>{let o=Ut.filter(i,u);if(!o)return!1;let d=!1;for(let g of o)s.add(i[g]),d=!0;return d};for(let i of a){if(!i)continue;n(t.getUniqueLabels(),i)||c(t.getUniqueLabels(),i)}return s}function Zt(e){return{container:(0,h.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:e.spacing(1)}),body:(0,h.css)({label:"body",flexGrow:1}),tableContainer:(0,h.css)({height:800}),horizontalContainer:(0,h.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:e.spacing(1),width:"100%"}),horizontalGraphContainer:(0,h.css)({flexBasis:"50%"}),horizontalTableContainer:(0,h.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,h.css)({marginBottom:e.spacing(1)}),verticalTableContainer:(0,h.css)({height:800})}}const Qt=Xt},62599:(ze,xe,C)=>{C.d(xe,{F8:()=>h,Zk:()=>l,yU:()=>v,zM:()=>oe});var l=(M=>(M.Bytes="bytes",M.Short="short",M.Nanoseconds="ns",M))(l||{}),h=(M=>(M.TopTable="topTable",M.FlameGraph="flameGraph",M.Both="both",M))(h||{}),oe=(M=>(M.ValueBased="valueBased",M.PackageBased="packageBased",M))(oe||{}),v=(M=>(M.Default="default",M.DiffColorBlind="diffColorBlind",M))(v||{})}}]);

//# sourceMappingURL=20.d39714e7a7feca91eb8d.js.map