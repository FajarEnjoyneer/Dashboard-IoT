"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4351],{54351:(_,d,t)=>{t.r(d),t.d(d,{default:()=>D,useConfirmAccessMutation:()=>A,useGetActiveUserDashboardsQuery:()=>g,useGetActiveUsersQuery:()=>y,useRequestAccessMutation:()=>T});var c=t(92745),h=t(68143),u=t(43173),o=t(6890),n=t(64762),l=t(62905),b=t(18393);function r(a){return typeof a=="object"&&a!=null&&"error"in a}function E(a){return r(a)&&(0,h.NF)(a.error)}const v=l.Sm.injectEndpoints({endpoints:a=>({requestAccess:a.mutation({query:s=>({url:"/public/dashboards/share/request-access",method:"POST",body:s})}),confirmAccess:a.mutation({query:({magicLinkToken:s,accessToken:e})=>({url:`/public/dashboards/share/${s}`,method:"POST",manageError:l.Ht}),async onQueryStarted({accessToken:s},{dispatch:e,queryFulfilled:i}){try{await i,e((0,o.dx)((0,n.tZ)((0,c.t)("public-dashboard.email-sharing.success-confirm-access","Access confirmed!")))),window.location.assign(u.$.appSubUrl+`public-dashboards/${s}`)}catch(m){if(E(m)){const{data:{messageId:p}}=m.error;p&&Object.values(b.b5).includes(p)&&window.location.assign(u.$.appSubUrl+`public-dashboards/${s}/request-access?error=${p}`)}}}}),addRecipient:a.mutation({query:({recipient:s,uid:e})=>({url:`/public-dashboards/${e}/share/recipients`,method:"POST",body:{recipient:s}}),async onQueryStarted(s,{dispatch:e,queryFulfilled:i}){await i,e((0,o.dx)((0,n.tZ)((0,c.t)("public-dashboard.email-sharing.success-send-recipient-invitation","The email invitation has been sent."))))},invalidatesTags:(s,e,{dashboardUid:i})=>[{type:"PublicDashboard",id:i}]}),deleteRecipient:a.mutation({query:({uid:s,recipientUid:e})=>({url:`/public-dashboards/${s}/share/recipients/${e}`,method:"DELETE"}),async onQueryStarted({recipientEmail:s},{dispatch:e,queryFulfilled:i}){await i,e((0,o.dx)((0,n.tZ)((0,c.t)("public-dashboard.email-sharing.success-revoke-access-title","Access Revoked"),(0,c.t)("public-dashboard.email-sharing.success-revoke-access-description","You have successfully revoked access for {{recipientEmail}}.",{recipientEmail:s}))))},invalidatesTags:(s,e,{dashboardUid:i})=>[{type:"PublicDashboard",id:i},"UsersWithActiveSessions","ActiveUserDashboards"]}),reshareAccessToRecipient:a.mutation({query:({uid:s,recipientUid:e})=>({url:`/public-dashboards/${s}/share/recipients/${e}`,method:"PATCH"}),async onQueryStarted(s,{dispatch:e,queryFulfilled:i}){await i,e((0,o.dx)((0,n.tZ)((0,c.t)("public-dashboard.email-sharing.success-resend-recipient-invitation","The email invitation has been resent."))))}}),getActiveUsers:a.query({query:()=>({url:"/public-dashboards/share/users?status=active"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:a.query({query:s=>({url:`/public-dashboards/share/users/${s}/dashboards?status=active`}),providesTags:(s,e,i)=>[{type:"ActiveUserDashboards",id:i}]}),revokeAllAccess:a.mutation({query:({email:s})=>({url:`/public-dashboards/share/users/${s}`,method:"DELETE"}),async onQueryStarted({email:s},{dispatch:e,queryFulfilled:i}){await i,e((0,o.dx)((0,n.tZ)((0,c.t)("public-dashboard.email-sharing.success-revoke-all-accesses-title","Access Revoked"),(0,c.t)("public-dashboard.email-sharing.success-revoke-all-accesses-description","{{email}}'s access to all public dashboards has been successfully removed.",{email:s}))))},invalidatesTags:["UsersWithActiveSessions"]})}),overrideExisting:!0}),{useRequestAccessMutation:T,useGetActiveUserDashboardsQuery:g,useGetActiveUsersQuery:y,useConfirmAccessMutation:A}=v,D=v},18393:(_,d,t)=>{t.d(d,{Z:()=>b,b5:()=>c});var c=(r=>(r.NOT_FOUND_MAGIC_LINK="publicdashboards.magicLinkNotFound",r.EXPIRED_MAGIC_LINK="publicdashboards.magicLinkExpired",r))(c||{}),h=(r=>(r.INTERNAL_SERVER_ERROR="publicdashboards.internalServerError",r.INVALID_SESSION="publicdashboards.invalidSession",r.EXPIRED_SESSION="publicdashboards.sessionExpired",r))(h||{});const u={title:"Request access",description:"You'll receive an email with a one-time link."},o="Something went wrong",n="To request access to the dashboard again, enter your email. You'll receive an email with a one-time link.",l={"publicdashboards.internalServerError":o,"publicdashboards.magicLinkNotFound":"This link has expired or already been used","publicdashboards.magicLinkExpired":"This magic link has expired","publicdashboards.invalidSession":"You no longer have access","publicdashboards.sessionExpired":"Your access has expired"},b=r=>r?{title:l[String(r)]||o,description:n}:u}}]);

//# sourceMappingURL=4351.327fc67cec757c97ed98.js.map