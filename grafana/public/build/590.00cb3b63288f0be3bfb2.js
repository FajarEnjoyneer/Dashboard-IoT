(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[590],{52135:(ue,he,b)=>{"use strict";b.d(he,{d$:()=>Iw,M$:()=>YE,XK:()=>Om,Aq:()=>Mw});var V={};b.r(V),b.d(V,{applyToJS:()=>Ac,cleanJSX:()=>Ps,clone:()=>Gt(),deepEqual:()=>ol,deepFreeze:()=>Dc,escapeRegExp:()=>ff,getFirstDefined:()=>hf,getLogger:()=>gf,getOpCardinality:()=>Mr,hasSafeOwnProperty:()=>Ic,isDirtyJSX:()=>Ns,isImmutable:()=>Co,isImmutableList:()=>sl,isJSX:()=>_c,isJsonCompatible:()=>Pc,isJsonLogic:()=>On,isObject:()=>Xr,isObjectOrArray:()=>df,isSafeKeyForObject:()=>il,isTypeOf:()=>Mi,logger:()=>Ms,mergeArraysSmart:()=>Vs,mergeCustomizerNoArrays:()=>pf,mergeIn:()=>g0,moment:()=>Rt(),omit:()=>Nn,opDefKeysToOmit:()=>Fo,setIn:()=>v0,shallowCopy:()=>ki,shallowEqual:()=>Ds,sleep:()=>vf,toImmutableList:()=>Ar,typeOf:()=>To,uuid:()=>Qe,widgetDefKeysToOmit:()=>Vi});var j={};b.r(j),b.d(j,{_fixImmutableValue:()=>Wc,expandTreePath:()=>Ge,expandTreeSubpath:()=>kc,fixEmptyGroupsInTree:()=>gl,fixPathsInTree:()=>ua,getAncestorRuleGroups:()=>Gc,getFlatTree:()=>Bc,getItemByPath:()=>ui,getLightTree:()=>xf,getSwitchValues:()=>Lf,getTotalReordableNodesCountInTree:()=>x0,getTotalRulesCountInTree:()=>hl,hasChildren:()=>$c,immutableToJs:()=>Ac,isEmptyTree:()=>Uc,isImmutable:()=>Co,jsToImmutable:()=>Eo,removeIsLockedInTree:()=>wf,toImmutableList:()=>Ar});var g={};b.r(g),b.d(g,{calculateValueType:()=>Af,completeFuncValue:()=>Df,completeValue:()=>Ui,formatFieldName:()=>Ga,getDefaultArgValue:()=>Sl,getFieldPathLabels:()=>Bs,getFuncPathLabels:()=>I0,getOneChildOrDescendant:()=>yl,getValueLabel:()=>A0,isEmptyGroupChildren:()=>Hc,isEmptyItem:()=>qc,isEmptyRuleGroupExtPropertiesAndChildren:()=>_f,isEmptyRuleProperties:()=>Qc,setArgValue:()=>bl,setFuncDefaultArg:()=>$s,setFuncDefaultArgs:()=>Yc,whatRulePropertiesAreCompleted:()=>Jc});var D={};b.r(D),b.d(D,{addJsonLogicOperation:()=>Uf,addRequiredJsonLogicOperations:()=>$f,applyJsonLogic:()=>Bf,customJsonLogicOperations:()=>Ws,jsonLogicFormatConcat:()=>W0,jsonLogicImportConcat:()=>z0});var z={};b.r(z),b.d(z,{LINEAR_REGRESSION:()=>eS,LOWER:()=>X0,NOW:()=>q0,RELATIVE_DATE:()=>Y0,RELATIVE_DATETIME:()=>wo,START_OF_TODAY:()=>Q0,TODAY:()=>H0,TRUNCATE_DATETIME:()=>J0,UPPER:()=>Z0});var x={};b.r(x),b.d(x,{mongoEmptyValue:()=>sd,mongoFieldEscape:()=>Ro,mongoFieldUnescape:()=>CS,mongoFormatOp1:()=>Tp,mongoFormatOp2:()=>Cp});var I={};b.r(I),b.d(I,{spelEscape:()=>$i,spelFixList:()=>cd,spelFormatConcat:()=>jp,spelImportConcat:()=>Ip});var M={};b.r(M),b.d(M,{SqlString:()=>Ua,mongoEmptyValue:()=>sd,spelEscape:()=>$i,spelFixList:()=>cd,spelFormatConcat:()=>jp,spelImportConcat:()=>Ip,sqlEmptyValue:()=>Ap,stringifyForDisplay:()=>_p,wrapWithBrackets:()=>Dp});var P={};b.r(P),b.d(P,{_mongodbFormat:()=>Lp,_spelFormat:()=>qp,_sqlFormat:()=>Mp,elasticSearchFormat:()=>fv,jsonLogicFormat:()=>bS,mongodbFormat:()=>xS,queryBuilderFormat:()=>N0,queryString:()=>av,spelFormat:()=>$S,sqlFormat:()=>VS});var Q={};b.r(Q),b.d(Q,{_getFromConfigCache:()=>dl,_getWidgetsAndSrcsForFieldOp:()=>pl,_saveToConfigCache:()=>fl,_widgetDefKeysToOmit:()=>C0,applyJsonLogic:()=>Bf,areConfigsSame:()=>sp,cleanJSX:()=>Ps,compileConfig:()=>np,compressConfig:()=>tp,configKeys:()=>Sa,createConfigMemo:()=>cp,decompressConfig:()=>rp,extendConfig:()=>Vn,filterValueSourcesForField:()=>Bi,findExtendedConfigInAllMemos:()=>lp,getCommonMemo:()=>up,getFieldConfig:()=>Ze,getFieldId:()=>cl,getFieldParts:()=>br,getFieldPartsConfigs:()=>Ef,getFieldPath:()=>ba,getFieldPathParts:()=>E0,getFieldRawConfig:()=>sa,getFieldSrc:()=>Of,getFieldWidgetConfig:()=>rn,getFirstField:()=>Ff,getFirstOperator:()=>Mc,getFuncArgConfig:()=>ll,getFuncConfig:()=>kr,getFuncSignature:()=>Vc,getOperatorConfig:()=>Mt,getOperatorsForField:()=>vl,getOperatorsForType:()=>Cf,getValueSourcesForFieldOp:()=>Tf,getWidgetForFieldOp:()=>vr,getWidgetsForFieldOp:()=>w0,isDirtyJSX:()=>Ns,isFieldDescendantOfField:()=>bf,isJSX:()=>_c,iterateFields:()=>yf,iterateFuncs:()=>ks,normalizeField:()=>Sf,selectTypes:()=>ul});var Z={};b.r(Z),b.d(Z,{getItemInListValues:()=>Js,getListValue:()=>Dl,getTitleInListValues:()=>Tg,getValueInListValues:()=>nO,listValuesToArray:()=>Rd,makeCustomListValue:()=>Ld,mapListValues:()=>jd,searchListValue:()=>aO,toListValue:()=>Wa});var k={};b.r(k),b.d(k,{_validateTree:()=>Ys,checkTree:()=>xg,getTreeBadFields:()=>wg,isValidTree:()=>Eg,sanitizeTree:()=>Rg,translateValidation:()=>Hn,validateAndFixTree:()=>jg,validateRange:()=>vi,validateTree:()=>Lg,validateValue:()=>Ta});var q={};b.r(q),b.d(q,{getCompatibleArgsOnFuncChange:()=>Vg,getDefaultArgValue:()=>Sl,setArgValue:()=>bl,setArgValueAsyncListValues:()=>Ng,setArgValueSrc:()=>Pg,setFunc:()=>Dg,setFuncDefaultArg:()=>$s,setFuncDefaultArgs:()=>Yc});var oe={};b.r(oe),b.d(oe,{createListFromArray:()=>If,createListWithOneElement:()=>L0,defaultConjunction:()=>li,defaultGroupConjunction:()=>ci,defaultGroupProperties:()=>di,defaultItemProperties:()=>kg,defaultOperatorOptions:()=>Gs,defaultRoot:()=>dO,defaultRule:()=>Gg,defaultRuleProperties:()=>Ca,emptyProperties:()=>R0,getDefaultField:()=>Rf,getDefaultFieldSrc:()=>zc,getDefaultOperator:()=>Kc,getDefaultSubField:()=>jf});var Te={};b.r(Te),b.d(Te,{fixListValuesGroupOrder:()=>CO,getListValue:()=>Dl,listValueToOption:()=>TO,mergeListValues:()=>bO,optionToListValue:()=>OO,optionsToListValues:()=>FO,simulateAsyncFetch:()=>SO});var B={};b.r(B),b.d(B,{Autocomplete:()=>Te,ConfigUtils:()=>Q,DefaultUtils:()=>oe,ExportUtils:()=>M,FuncUtils:()=>q,JsonLogicUtils:()=>D,ListUtils:()=>Z,MongoUtils:()=>x,OtherUtils:()=>V,RuleUtils:()=>g,SpelUtils:()=>I,TreeUtils:()=>j,Validation:()=>k,checkTree:()=>xg,clone:()=>Gt(),compressConfig:()=>tp,decompressConfig:()=>rp,getSwitchValues:()=>Lf,i18n:()=>eO,isValidTree:()=>Eg,moment:()=>Rt(),sanitizeTree:()=>Rg,uuid:()=>Qe,validateAndFixTree:()=>jg,validateTree:()=>Lg});var me={};b.r(me),b.d(me,{_loadFromJsonLogic:()=>Tv,_loadFromSpel:()=>gh,getTree:()=>ub,isImmutableTree:()=>pv,isJsonLogic:()=>On,isTree:()=>vv,jsToImmutable:()=>Eo,loadFromJsonLogic:()=>vb,loadFromSpel:()=>HO,loadTree:()=>hd});var Le={};b.r(Le),b.d(Le,{addCaseGroup:()=>IF,addDefaultCaseGroup:()=>jF,addGroup:()=>AF,addRule:()=>LF,moveItem:()=>DF,removeGroup:()=>_F,removeRule:()=>RF,setTree:()=>xF});var Ue={};b.r(Ue),b.d(Ue,{setConjunction:()=>PF,setLock:()=>VF,setNot:()=>NF});var Ie={};b.r(Ie),b.d(Ie,{setField:()=>MF,setFieldSrc:()=>kF,setFuncValue:()=>$F,setOperator:()=>GF,setOperatorOption:()=>WF,setValue:()=>BF,setValueSrc:()=>UF});var st={};b.r(st),b.d(st,{bindActionCreators:()=>pm,isUsingLegacyReactDomRender:()=>fm,liteShouldComponentUpdate:()=>Kl,pureShouldComponentUpdate:()=>No,useOnPropsChanged:()=>Fn});var qe={};b.r(qe),b.d(qe,{FuncWidget:()=>ef,ValueFieldWidget:()=>r0,VanillaBooleanWidget:()=>rw,VanillaButton:()=>mw,VanillaButtonGroup:()=>Sw,VanillaConjs:()=>gw,VanillaDateTimeWidget:()=>sw,VanillaDateWidget:()=>iw,VanillaFieldSelect:()=>vw,VanillaIcon:()=>yw,VanillaMultiSelectWidget:()=>lw,VanillaNumberWidget:()=>fw,VanillaProvider:()=>Tw,VanillaSelectWidget:()=>dw,VanillaSliderWidget:()=>pw,VanillaSwitch:()=>Ow,VanillaTextAreaWidget:()=>aw,VanillaTextWidget:()=>nw,VanillaTimeWidget:()=>ow,VanillaValueSources:()=>bw,vanillaConfirm:()=>Fw});var xt={};b.r(xt),b.d(xt,{ProximityOperator:()=>sf});function Ne(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(a){"@babel/helpers - typeof";return ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(a)}function rt(a,e){if(ot(a)!="object"||!a)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var n=r.call(a,e||"default");if(ot(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function We(a){var e=rt(a,"string");return ot(e)=="symbol"?e:e+""}function pt(a,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,We(n.key),n)}}function nt(a,e,r){return e&&pt(a.prototype,e),r&&pt(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}function Xt(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Re(a,e){if(e&&(ot(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xt(a)}function je(a){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},je(a)}function ft(a,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ft(a,e)}function He(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&ft(a,e)}var U=b(96540);function Ye(a){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(a)}function Zt(a,e){if(Ye(a)!="object"||!a)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var n=r.call(a,e||"default");if(Ye(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function zr(a){var e=Zt(a,"string");return Ye(e)=="symbol"?e:e+""}function Se(a,e,r){return(e=zr(e))in a?Object.defineProperty(a,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[e]=r,a}function Me(a){if(Array.isArray(a))return a}function Dt(a,e){var r=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(r!=null){var n,i,o,s,u=[],l=!0,c=!1;try{if(o=(r=r.call(a)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(d){c=!0,i=d}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return u}}function mt(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function sr(a,e){if(a){if(typeof a=="string")return mt(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(a,e):void 0}}function wr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ce(a,e){return Me(a)||Dt(a,e)||sr(a,e)||wr()}function Kr(a){if(Array.isArray(a))return mt(a)}function La(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function qr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pe(a){return Kr(a)||La(a)||sr(a)||qr()}var jn="delete",Vt=5,tr=1<<Vt,mr=tr-1,Et={};function In(){return{value:!1}}function sn(a){a&&(a.value=!0)}function yr(){}function An(a){return a.size===void 0&&(a.size=a.__iterate(hi)),a.size}function _n(a,e){if(typeof e!="number"){var r=e>>>0;if(""+r!==e||r===4294967295)return NaN;e=r}return e<0?An(a)+e:e}function hi(){return!0}function ca(a,e,r){return(a===0&&!Zi(a)||r!==void 0&&a<=-r)&&(e===void 0||r!==void 0&&e>=r)}function ea(a,e){return Ra(a,e,0)}function da(a,e){return Ra(a,e,e)}function Ra(a,e,r){return a===void 0?r:Zi(a)?e===1/0?e:Math.max(0,e+a)|0:e===void 0||e===a?a:Math.min(e,a)|0}function Zi(a){return a<0||a===0&&1/a===-1/0}var eo="@@__IMMUTABLE_ITERABLE__@@";function Dr(a){return!!(a&&a[eo])}var to="@@__IMMUTABLE_KEYED__@@";function Qt(a){return!!(a&&a[to])}var mi="@@__IMMUTABLE_INDEXED__@@";function jr(a){return!!(a&&a[mi])}function fa(a){return Qt(a)||jr(a)}var ur=function(e){return Dr(e)?e:ct(e)},un=function(a){function e(r){return Qt(r)?r:dn(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e}(ur),ta=function(a){function e(r){return jr(r)?r:Ot(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e}(ur),pa=function(a){function e(r){return Dr(r)&&!fa(r)?r:wn(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e}(ur);ur.Keyed=un,ur.Indexed=ta,ur.Set=pa;var ro="@@__IMMUTABLE_SEQ__@@";function ja(a){return!!(a&&a[ro])}var yi="@@__IMMUTABLE_RECORD__@@";function Un(a){return!!(a&&a[yi])}function tn(a){return Dr(a)||Un(a)}var ra="@@__IMMUTABLE_ORDERED__@@";function ln(a){return!!(a&&a[ra])}var En=0,Sn=1,Lt=2,cn=typeof Symbol=="function"&&Symbol.iterator,no="@@iterator",za=cn||no,At=function(e){this.next=e};At.prototype.toString=function(){return"[Iterator]"},At.KEYS=En,At.VALUES=Sn,At.ENTRIES=Lt,At.prototype.inspect=At.prototype.toSource=function(){return this.toString()},At.prototype[za]=function(){return this};function vt(a,e,r,n){var i=a===0?e:a===1?r:[e,r];return n?n.value=i:n={value:i,done:!1},n}function jt(){return{value:void 0,done:!0}}function Hr(a){return Array.isArray(a)?!0:!!Ka(a)}function $n(a){return a&&typeof a.next=="function"}function na(a){var e=Ka(a);return e&&e.call(a)}function Ka(a){var e=a&&(cn&&a[cn]||a[no]);if(typeof e=="function")return e}function va(a){var e=Ka(a);return e&&e===a.entries}function Pt(a){var e=Ka(a);return e&&e===a.keys}var at=Object.prototype.hasOwnProperty;function pr(a){return Array.isArray(a)||typeof a=="string"?!0:a&&typeof a=="object"&&Number.isInteger(a.length)&&a.length>=0&&(a.length===0?Object.keys(a).length===1:a.hasOwnProperty(a.length-1))}var ct=function(a){function e(r){return r==null?Ae():tn(r)?r.toSeq():dr(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var s=o.length,u=0;u!==s;){var l=o[i?s-++u:u++];if(n(l[1],l[0],this)===!1)break}return u}return this.__iterateUncached(n,i)},e.prototype.__iterator=function(n,i){var o=this._cache;if(o){var s=o.length,u=0;return new At(function(){if(u===s)return jt();var l=o[i?s-++u:u++];return vt(n,l[0],l[1])})}return this.__iteratorUncached(n,i)},e}(ur),dn=function(a){function e(r){return r==null?Ae().toKeyedSeq():Dr(r)?Qt(r)?r.toSeq():r.fromEntrySeq():Un(r)?r.toSeq():gt(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(ct),Ot=function(a){function e(r){return r==null?Ae():Dr(r)?Qt(r)?r.entrySeq():r.toIndexedSeq():Un(r)?r.toSeq().entrySeq():Qr(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(ct),wn=function(a){function e(r){return(Dr(r)&&!fa(r)?r:Ot(r)).toSetSeq()}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(ct);ct.isSeq=ja,ct.Keyed=dn,ct.Set=wn,ct.Indexed=Ot,ct.prototype[ro]=!0;var lt=function(a){function e(r){this._array=r,this.size=r.length}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this.has(n)?this._array[_n(this,n)]:i},e.prototype.__iterate=function(n,i){for(var o=this._array,s=o.length,u=0;u!==s;){var l=i?s-++u:u++;if(n(o[l],l,this)===!1)break}return u},e.prototype.__iterator=function(n,i){var o=this._array,s=o.length,u=0;return new At(function(){if(u===s)return jt();var l=i?s-++u:u++;return vt(n,l,o[l])})},e}(Ot),Pr=function(a){function e(r){var n=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=n,this.size=n.length}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},e.prototype.has=function(n){return at.call(this._object,n)},e.prototype.__iterate=function(n,i){for(var o=this._object,s=this._keys,u=s.length,l=0;l!==u;){var c=s[i?u-++l:l++];if(n(o[c],c,this)===!1)break}return l},e.prototype.__iterator=function(n,i){var o=this._object,s=this._keys,u=s.length,l=0;return new At(function(){if(l===u)return jt();var c=s[i?u-++l:l++];return vt(n,c,o[c])})},e}(dn);Pr.prototype[ra]=!0;var te=function(a){function e(r){this._collection=r,this.size=r.length||r.size}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,s=na(o),u=0;if($n(s))for(var l;!(l=s.next()).done&&n(l.value,u++,this)!==!1;);return u},e.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,s=na(o);if(!$n(s))return new At(jt);var u=0;return new At(function(){var l=s.next();return l.done?l:vt(n,u++,l.value)})},e}(Ot),ge;function Ae(){return ge||(ge=new lt([]))}function gt(a){var e=xn(a);if(e)return e.fromEntrySeq();if(typeof a=="object")return new Pr(a);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+a)}function Qr(a){var e=xn(a);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+a)}function dr(a){var e=xn(a);if(e)return va(a)?e.fromEntrySeq():Pt(a)?e.toSetSeq():e;if(typeof a=="object")return new Pr(a);throw new TypeError("Expected Array or collection object of values, or keyed object: "+a)}function xn(a){return pr(a)?new lt(a):Hr(a)?new te(a):void 0}var Ho="@@__IMMUTABLE_MAP__@@";function ao(a){return!!(a&&a[Ho])}function Qo(a){return ao(a)&&ln(a)}function Jo(a){return!!(a&&typeof a.equals=="function"&&typeof a.hashCode=="function")}function Ir(a,e){if(a===e||a!==a&&e!==e)return!0;if(!a||!e)return!1;if(typeof a.valueOf=="function"&&typeof e.valueOf=="function"){if(a=a.valueOf(),e=e.valueOf(),a===e||a!==a&&e!==e)return!0;if(!a||!e)return!1}return!!(Jo(a)&&Jo(e)&&a.equals(e))}var Si=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(e,r){e|=0,r|=0;var n=e&65535,i=r&65535;return n*i+((e>>>16)*i+n*(r>>>16)<<16>>>0)|0};function io(a){return a>>>1&1073741824|a&3221225471}var nc=Object.prototype.valueOf;function Nr(a){if(a==null)return Ia(a);if(typeof a.hashCode=="function")return io(a.hashCode(a));var e=Zo(a);if(e==null)return Ia(e);switch(typeof e){case"boolean":return e?1108378657:1108378656;case"number":return qa(e);case"string":return e.length>Ja?ac(e):Yo(e);case"object":case"function":return ic(e);case"symbol":return ga(e);default:if(typeof e.toString=="function")return Yo(e.toString());throw new Error("Value type "+typeof e+" cannot be hashed.")}}function Ia(a){return a===null?1108378658:1108378659}function qa(a){if(a!==a||a===1/0)return 0;var e=a|0;for(e!==a&&(e^=a*4294967295);a>4294967295;)a/=4294967295,e^=a;return io(e)}function ac(a){var e=ts[a];return e===void 0&&(e=Yo(a),Oi===bi&&(Oi=0,ts={}),Oi++,ts[a]=e),e}function Yo(a){for(var e=0,r=0;r<a.length;r++)e=31*e+a.charCodeAt(r)|0;return io(e)}function ga(a){var e=oc[a];return e!==void 0||(e=hu(),oc[a]=e),e}function ic(a){var e;if(Ha&&(e=Qa.get(a),e!==void 0)||(e=a[aa],e!==void 0)||!gu&&(e=a.propertyIsEnumerable&&a.propertyIsEnumerable[aa],e!==void 0||(e=Xo(a),e!==void 0)))return e;if(e=hu(),Ha)Qa.set(a,e);else{if(vu!==void 0&&vu(a)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(gu)Object.defineProperty(a,aa,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(a.propertyIsEnumerable!==void 0&&a.propertyIsEnumerable===a.constructor.prototype.propertyIsEnumerable)a.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},a.propertyIsEnumerable[aa]=e;else if(a.nodeType!==void 0)a[aa]=e;else throw new Error("Unable to set a non-enumerable property on object.")}return e}var vu=Object.isExtensible,gu=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function Xo(a){if(a&&a.nodeType>0)switch(a.nodeType){case 1:return a.uniqueID;case 9:return a.documentElement&&a.documentElement.uniqueID}}function Zo(a){return a.valueOf!==nc&&typeof a.valueOf=="function"?a.valueOf(a):a}function hu(){var a=++es;return es&1073741824&&(es=0),a}var Ha=typeof WeakMap=="function",Qa;Ha&&(Qa=new WeakMap);var oc=Object.create(null),es=0,aa="__immutablehash__";typeof Symbol=="function"&&(aa=Symbol(aa));var Ja=16,bi=255,Oi=0,ts={},oo=function(a){function e(r,n){this._iter=r,this._useKeys=n,this.size=r.size}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this._iter.get(n,i)},e.prototype.has=function(n){return this._iter.has(n)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var n=this,i=as(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},e.prototype.map=function(n,i){var o=this,s=ns(this,n,i);return this._useKeys||(s.valueSeq=function(){return o._iter.toSeq().map(n,i)}),s},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s,u){return n(s,u,o)},i)},e.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},e}(dn);oo.prototype[ra]=!0;var mu=function(a){function e(r){this._iter=r,this.size=r.size}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.includes=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var o=this,s=0;return i&&An(this),this._iter.__iterate(function(u){return n(u,i?o.size-++s:s++,o)},i)},e.prototype.__iterator=function(n,i){var o=this,s=this._iter.__iterator(Sn,i),u=0;return i&&An(this),new At(function(){var l=s.next();return l.done?l:vt(n,i?o.size-++u:u++,l.value,l)})},e}(Ot),yu=function(a){function e(r){this._iter=r,this.size=r.size}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.has=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){return n(s,s,o)},i)},e.prototype.__iterator=function(n,i){var o=this._iter.__iterator(Sn,i);return new At(function(){var s=o.next();return s.done?s:vt(n,s.value,s.value,s)})},e}(wn),rs=function(a){function e(r){this._iter=r,this.size=r.size}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){if(s){dc(s);var u=Dr(s);return n(u?s.get(1):s[1],u?s.get(0):s[0],o)}},i)},e.prototype.__iterator=function(n,i){var o=this._iter.__iterator(Sn,i);return new At(function(){for(;;){var s=o.next();if(s.done)return s;var u=s.value;if(u){dc(u);var l=Dr(u);return vt(n,l?u.get(0):u[0],l?u.get(1):u[1],s)}}})},e}(dn);mu.prototype.cacheResult=oo.prototype.cacheResult=yu.prototype.cacheResult=rs.prototype.cacheResult=wu;function so(a){var e=Dn(a);return e._iter=a,e.size=a.size,e.flip=function(){return a},e.reverse=function(){var r=a.reverse.apply(this);return r.flip=function(){return a.reverse()},r},e.has=function(r){return a.includes(r)},e.includes=function(r){return a.has(r)},e.cacheResult=wu,e.__iterateUncached=function(r,n){var i=this;return a.__iterate(function(o,s){return r(s,o,i)!==!1},n)},e.__iteratorUncached=function(r,n){if(r===Lt){var i=a.__iterator(r,n);return new At(function(){var o=i.next();if(!o.done){var s=o.value[0];o.value[0]=o.value[1],o.value[1]=s}return o})}return a.__iterator(r===Sn?En:Sn,n)},e}function ns(a,e,r){var n=Dn(a);return n.size=a.size,n.has=function(i){return a.has(i)},n.get=function(i,o){var s=a.get(i,Et);return s===Et?o:e.call(r,s,i,a)},n.__iterateUncached=function(i,o){var s=this;return a.__iterate(function(u,l,c){return i(e.call(r,u,l,c),l,s)!==!1},o)},n.__iteratorUncached=function(i,o){var s=a.__iterator(Lt,o);return new At(function(){var u=s.next();if(u.done)return u;var l=u.value,c=l[0];return vt(i,c,e.call(r,l[1],c,a),u)})},n}function as(a,e){var r=this,n=Dn(a);return n._iter=a,n.size=a.size,n.reverse=function(){return a},a.flip&&(n.flip=function(){var i=so(a);return i.reverse=function(){return a.flip()},i}),n.get=function(i,o){return a.get(e?i:-1-i,o)},n.has=function(i){return a.has(e?i:-1-i)},n.includes=function(i){return a.includes(i)},n.cacheResult=wu,n.__iterate=function(i,o){var s=this,u=0;return o&&An(a),a.__iterate(function(l,c){return i(l,e?c:o?s.size-++u:u++,s)},!o)},n.__iterator=function(i,o){var s=0;o&&An(a);var u=a.__iterator(Lt,!o);return new At(function(){var l=u.next();if(l.done)return l;var c=l.value;return vt(i,e?c[0]:o?r.size-++s:s++,c[1],l)})},n}function Su(a,e,r,n){var i=Dn(a);return n&&(i.has=function(o){var s=a.get(o,Et);return s!==Et&&!!e.call(r,s,o,a)},i.get=function(o,s){var u=a.get(o,Et);return u!==Et&&e.call(r,u,o,a)?u:s}),i.__iterateUncached=function(o,s){var u=this,l=0;return a.__iterate(function(c,d,f){if(e.call(r,c,d,f))return l++,o(c,n?d:l-1,u)},s),l},i.__iteratorUncached=function(o,s){var u=a.__iterator(Lt,s),l=0;return new At(function(){for(;;){var c=u.next();if(c.done)return c;var d=c.value,f=d[0],p=d[1];if(e.call(r,p,f,a))return vt(o,n?f:l++,p,c)}})},i}function sc(a,e,r){var n=Wt().asMutable();return a.__iterate(function(i,o){n.update(e.call(r,i,o,a),0,function(s){return s+1})}),n.asImmutable()}function uc(a,e,r){var n=Qt(a),i=(ln(a)?qn():Wt()).asMutable();a.__iterate(function(s,u){i.update(e.call(r,s,u,a),function(l){return l=l||[],l.push(n?[u,s]:s),l})});var o=Eu(a);return i.map(function(s){return rr(a,o(s))}).asImmutable()}function bu(a,e,r){var n=Qt(a),i=[[],[]];a.__iterate(function(s,u){i[e.call(r,s,u,a)?1:0].push(n?[u,s]:s)});var o=Eu(a);return i.map(function(s){return rr(a,o(s))})}function is(a,e,r,n){var i=a.size;if(ca(e,r,i))return a;if(typeof i>"u"&&(e<0||r<0))return is(a.toSeq().cacheResult(),e,r,n);var o=ea(e,i),s=da(r,i),u=s-o,l;u===u&&(l=u<0?0:u);var c=Dn(a);return c.size=l===0?l:a.size&&l||void 0,!n&&ja(a)&&l>=0&&(c.get=function(d,f){return d=_n(this,d),d>=0&&d<l?a.get(d+o,f):f}),c.__iterateUncached=function(d,f){var p=this;if(l===0)return 0;if(f)return this.cacheResult().__iterate(d,f);var v=0,y=!0,m=0;return a.__iterate(function(S,F){if(!(y&&(y=v++<o)))return m++,d(S,n?F:m-1,p)!==!1&&m!==l}),m},c.__iteratorUncached=function(d,f){if(l!==0&&f)return this.cacheResult().__iterator(d,f);if(l===0)return new At(jt);var p=a.__iterator(d,f),v=0,y=0;return new At(function(){for(;v++<o;)p.next();if(++y>l)return jt();var m=p.next();return n||d===Sn||m.done?m:d===En?vt(d,y-1,void 0,m):vt(d,y-1,m.value[1],m)})},c}function Ou(a,e,r){var n=Dn(a);return n.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var u=0;return a.__iterate(function(l,c,d){return e.call(r,l,c,d)&&++u&&i(l,c,s)}),u},n.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var u=a.__iterator(Lt,o),l=!0;return new At(function(){if(!l)return jt();var c=u.next();if(c.done)return c;var d=c.value,f=d[0],p=d[1];return e.call(r,p,f,s)?i===Lt?c:vt(i,f,p,c):(l=!1,jt())})},n}function Fu(a,e,r,n){var i=Dn(a);return i.__iterateUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterate(o,s);var l=!0,c=0;return a.__iterate(function(d,f,p){if(!(l&&(l=e.call(r,d,f,p))))return c++,o(d,n?f:c-1,u)}),c},i.__iteratorUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterator(o,s);var l=a.__iterator(Lt,s),c=!0,d=0;return new At(function(){var f,p,v;do{if(f=l.next(),f.done)return n||o===Sn?f:o===En?vt(o,d++,void 0,f):vt(o,d++,f.value[1],f);var y=f.value;p=y[0],v=y[1],c&&(c=e.call(r,v,p,u))}while(c);return o===Lt?f:vt(o,p,v,f)})},i}function lc(a,e){var r=Qt(a),n=[a].concat(e).map(function(s){return Dr(s)?r&&(s=un(s)):s=r?gt(s):Qr(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(n.length===0)return a;if(n.length===1){var i=n[0];if(i===a||r&&Qt(i)||jr(a)&&jr(i))return i}var o=new lt(n);return r?o=o.toKeyedSeq():jr(a)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(s,u){if(s!==void 0){var l=u.size;if(l!==void 0)return s+l}},0),o}function Tu(a,e,r){var n=Dn(a);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,u=!1;function l(c,d){c.__iterate(function(f,p){return(!e||d<e)&&Dr(f)?l(f,d+1):(s++,i(f,r?p:s-1,n)===!1&&(u=!0)),!u},o)}return l(a,0),s},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var s=a.__iterator(i,o),u=[],l=0;return new At(function(){for(;s;){var c=s.next();if(c.done!==!1){s=u.pop();continue}var d=c.value;if(i===Lt&&(d=d[1]),(!e||u.length<e)&&Dr(d))u.push(s),s=d.__iterator(i,o);else return r?c:vt(i,l++,d,c)}return jt()})},n}function cc(a,e,r){var n=Eu(a);return a.toSeq().map(function(i,o){return n(e.call(r,i,o,a))}).flatten(!0)}function lf(a,e){var r=Dn(a);return r.size=a.size&&a.size*2-1,r.__iterateUncached=function(n,i){var o=this,s=0;return a.__iterate(function(u){return(!s||n(e,s++,o)!==!1)&&n(u,s++,o)!==!1},i),s},r.__iteratorUncached=function(n,i){var o=a.__iterator(Sn,i),s=0,u;return new At(function(){return(!u||s%2)&&(u=o.next(),u.done)?u:s%2?vt(n,s++,e):vt(n,s++,u.value,u)})},r}function Fi(a,e,r){e||(e=xu);var n=Qt(a),i=0,o=a.toSeq().map(function(s,u){return[u,s,i++,r?r(s,u,a):s]}).valueSeq().toArray();return o.sort(function(s,u){return e(s[3],u[3])||s[2]-u[2]}).forEach(n?function(s,u){o[u].length=2}:function(s,u){o[u]=s[1]}),n?dn(o):jr(a)?Ot(o):wn(o)}function os(a,e,r){if(e||(e=xu),r){var n=a.toSeq().map(function(i,o){return[i,r(i,o,a)]}).reduce(function(i,o){return Cu(e,i[1],o[1])?o:i});return n&&n[0]}return a.reduce(function(i,o){return Cu(e,i,o)?o:i})}function Cu(a,e,r){var n=a(r,e);return n===0&&r!==e&&(r==null||r!==r)||n>0}function ss(a,e,r,n){var i=Dn(a),o=new lt(r).map(function(s){return s.size});return i.size=n?o.max():o.min(),i.__iterate=function(s,u){for(var l=this.__iterator(Sn,u),c,d=0;!(c=l.next()).done&&s(c.value,d++,this)!==!1;);return d},i.__iteratorUncached=function(s,u){var l=r.map(function(f){return f=ur(f),na(u?f.reverse():f)}),c=0,d=!1;return new At(function(){var f;return d||(f=l.map(function(p){return p.next()}),d=n?f.every(function(p){return p.done}):f.some(function(p){return p.done})),d?jt():vt(s,c++,e.apply(null,f.map(function(p){return p.value})))})},i}function rr(a,e){return a===e?a:ja(a)?e:a.constructor(e)}function dc(a){if(a!==Object(a))throw new TypeError("Expected [K, V] tuple: "+a)}function Eu(a){return Qt(a)?un:jr(a)?ta:pa}function Dn(a){return Object.create((Qt(a)?dn:jr(a)?Ot:wn).prototype)}function wu(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):ct.prototype.cacheResult.call(this)}function xu(a,e){return a===void 0&&e===void 0?0:a===void 0?1:e===void 0?-1:a>e?1:a<e?-1:0}function Wn(a,e){e=e||0;for(var r=Math.max(0,a.length-e),n=new Array(r),i=0;i<r;i++)n[i]=a[i+e];return n}function Lu(a,e){if(!a)throw new Error(e)}function bn(a){Lu(a!==1/0,"Cannot perform this action with an infinite size.")}function fr(a){if(pr(a)&&typeof a!="string")return a;if(ln(a))return a.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+a)}var fc=Object.prototype.toString;function us(a){if(!a||typeof a!="object"||fc.call(a)!=="[object Object]")return!1;var e=Object.getPrototypeOf(a);if(e===null)return!0;for(var r=e,n=Object.getPrototypeOf(e);n!==null;)r=n,n=Object.getPrototypeOf(r);return r===e}function ha(a){return typeof a=="object"&&(tn(a)||Array.isArray(a)||us(a))}function Ya(a){try{return typeof a=="string"?JSON.stringify(a):String(a)}catch{return JSON.stringify(a)}}function ls(a,e){return tn(a)?a.has(e):ha(a)&&at.call(a,e)}function cs(a,e,r){return tn(a)?a.get(e,r):ls(a,e)?typeof a.get=="function"?a.get(e):a[e]:r}function uo(a){if(Array.isArray(a))return Wn(a);var e={};for(var r in a)at.call(a,r)&&(e[r]=a[r]);return e}function lo(a,e){if(!ha(a))throw new TypeError("Cannot update non-data-structure value: "+a);if(tn(a)){if(!a.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+a);return a.remove(e)}if(!at.call(a,e))return a;var r=uo(a);return Array.isArray(r)?r.splice(e,1):delete r[e],r}function Ru(a,e,r){if(!ha(a))throw new TypeError("Cannot update non-data-structure value: "+a);if(tn(a)){if(!a.set)throw new TypeError("Cannot update immutable value without .set() method: "+a);return a.set(e,r)}if(at.call(a,e)&&r===a[e])return a;var n=uo(a);return n[e]=r,n}function Aa(a,e,r,n){n||(n=r,r=void 0);var i=ju(tn(a),a,fr(e),0,r,n);return i===Et?r:i}function ju(a,e,r,n,i,o){var s=e===Et;if(n===r.length){var u=s?i:e,l=o(u);return l===u?e:l}if(!s&&!ha(e))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Ya)+"]: "+e);var c=r[n],d=s?Et:cs(e,c,Et),f=ju(d===Et?a:tn(d),d,r,n+1,i,o);return f===d?e:f===Et?lo(e,c):Ru(s?a?Ln():{}:e,c,f)}function pc(a,e,r){return Aa(a,e,Et,function(){return r})}function ds(a,e){return pc(this,a,e)}function Iu(a,e){return Aa(a,e,function(){return Et})}function _a(a){return Iu(this,a)}function fs(a,e,r,n){return Aa(a,[e],r,n)}function ps(a,e,r){return arguments.length===1?a(this):fs(this,a,e,r)}function co(a,e,r){return Aa(this,a,e,r)}function Au(){for(var a=[],e=arguments.length;e--;)a[e]=arguments[e];return _u(this,a)}function fo(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(typeof a!="function")throw new TypeError("Invalid merger function: "+a);return _u(this,e,a)}function _u(a,e,r){for(var n=[],i=0;i<e.length;i++){var o=un(e[i]);o.size!==0&&n.push(o)}return n.length===0?a:a.toSeq().size===0&&!a.__ownerID&&n.length===1?a.constructor(n[0]):a.withMutations(function(s){for(var u=r?function(c,d){fs(s,d,Et,function(f){return f===Et?c:r(f,c,d)})}:function(c,d){s.set(d,c)},l=0;l<n.length;l++)n[l].forEach(u)})}function vc(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Ci(a,e)}function vs(a,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return Ci(e,r,a)}function gs(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Ti(a,e)}function gc(a,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return Ti(e,r,a)}function Ti(a,e,r){return Ci(a,e,hc(r))}function Ci(a,e,r){if(!ha(a))throw new TypeError("Cannot merge into non-data-structure value: "+a);if(tn(a))return typeof r=="function"&&a.mergeWith?a.mergeWith.apply(a,[r].concat(e)):a.merge?a.merge.apply(a,e):a.concat.apply(a,e);for(var n=Array.isArray(a),i=a,o=n?ta:un,s=n?function(l){i===a&&(i=uo(i)),i.push(l)}:function(l,c){var d=at.call(i,c),f=d&&r?r(i[c],l,c):l;(!d||f!==i[c])&&(i===a&&(i=uo(i)),i[c]=f)},u=0;u<e.length;u++)o(e[u]).forEach(s);return i}function hc(a){function e(r,n,i){return ha(r)&&ha(n)&&mc(r,n)?Ci(r,[n],e):a?a(r,n,i):n}return e}function mc(a,e){var r=ct(a),n=ct(e);return jr(r)===jr(n)&&Qt(r)===Qt(n)}function Du(){for(var a=[],e=arguments.length;e--;)a[e]=arguments[e];return Ti(this,a)}function Pu(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Ti(this,e,a)}function hs(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Aa(this,a,Ln(),function(n){return Ci(n,e)})}function ms(a){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Aa(this,a,Ln(),function(n){return Ti(n,e)})}function Xa(a){var e=this.asMutable();return a(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function Za(){return this.__ownerID?this:this.__ensureOwner(new yr)}function ei(){return this.__ensureOwner()}function ys(){return this.__altered}var Wt=function(a){function e(r){return r==null?Ln():ao(r)&&!ln(r)?r:Ln().withMutations(function(n){var i=a(r);bn(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return Ln().withMutations(function(o){for(var s=0;s<n.length;s+=2){if(s+1>=n.length)throw new Error("Missing value for key: "+n[s]);o.set(n[s],n[s+1])}})},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},e.prototype.set=function(n,i){return Os(this,n,i)},e.prototype.remove=function(n){return Os(this,n,Et)},e.prototype.deleteAll=function(n){var i=ur(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(s){return o.remove(s)})})},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Ln()},e.prototype.sort=function(n){return qn(Fi(this,n))},e.prototype.sortBy=function(n,i){return qn(Fi(this,i,n))},e.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){s.forEach(function(u,l){s.set(l,n.call(i,u,l,o))})})},e.prototype.__iterator=function(n,i){return new Ei(this,n,i)},e.prototype.__iterate=function(n,i){var o=this,s=0;return this._root&&this._root.iterate(function(u){return s++,n(u[1],u[0],o)},i),s},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?bs(this.size,this._root,n,this.__hash):this.size===0?Ln():(this.__ownerID=n,this.__altered=!1,this)},e}(un);Wt.isMap=ao;var ir=Wt.prototype;ir[Ho]=!0,ir[jn]=ir.remove,ir.removeAll=ir.deleteAll,ir.setIn=ds,ir.removeIn=ir.deleteIn=_a,ir.update=ps,ir.updateIn=co,ir.merge=ir.concat=Au,ir.mergeWith=fo,ir.mergeDeep=Du,ir.mergeDeepWith=Pu,ir.mergeIn=hs,ir.mergeDeepIn=ms,ir.withMutations=Xa,ir.wasAltered=ys,ir.asImmutable=ei,ir["@@transducer/init"]=ir.asMutable=Za,ir["@@transducer/step"]=function(a,e){return a.set(e[0],e[1])},ir["@@transducer/result"]=function(a){return a.asImmutable()};var zn=function(e,r){this.ownerID=e,this.entries=r};zn.prototype.get=function(e,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Ir(n,o[s][0]))return o[s][1];return i},zn.prototype.update=function(e,r,n,i,o,s,u){for(var l=o===Et,c=this.entries,d=0,f=c.length;d<f&&!Ir(i,c[d][0]);d++);var p=d<f;if(p?c[d][1]===o:l)return this;if(sn(u),(l||!p)&&sn(s),!(l&&c.length===1)){if(!p&&!l&&c.length>=Ts)return yc(e,c,i,o);var v=e&&e===this.ownerID,y=v?c:Wn(c);return p?l?d===f-1?y.pop():y[d]=y.pop():y[d]=[i,o]:y.push([i,o]),v?(this.entries=y,this):new zn(e,y)}};var Da=function(e,r,n){this.ownerID=e,this.bitmap=r,this.nodes=n};Da.prototype.get=function(e,r,n,i){r===void 0&&(r=Nr(n));var o=1<<((e===0?r:r>>>e)&mr),s=this.bitmap;return(s&o)===0?i:this.nodes[ku(s&o-1)].get(e+Vt,r,n,i)},Da.prototype.update=function(e,r,n,i,o,s,u){n===void 0&&(n=Nr(i));var l=(r===0?n:n>>>r)&mr,c=1<<l,d=this.bitmap,f=(d&c)!==0;if(!f&&o===Et)return this;var p=ku(d&c-1),v=this.nodes,y=f?v[p]:void 0,m=fn(y,e,r+Vt,n,i,o,s,u);if(m===y)return this;if(!f&&m&&v.length>=Oc)return Mu(e,v,d,l,m);if(f&&!m&&v.length===2&&ri(v[p^1]))return v[p^1];if(f&&m&&v.length===1&&ri(m))return m;var S=e&&e===this.ownerID,F=f?m?d:d^c:d|c,C=f?m?po(v,p,m,S):bc(v,p,S):Gu(v,p,m,S);return S?(this.bitmap=F,this.nodes=C,this):new Da(e,F,C)};var Pa=function(e,r,n){this.ownerID=e,this.count=r,this.nodes=n};Pa.prototype.get=function(e,r,n,i){r===void 0&&(r=Nr(n));var o=(e===0?r:r>>>e)&mr,s=this.nodes[o];return s?s.get(e+Vt,r,n,i):i},Pa.prototype.update=function(e,r,n,i,o,s,u){n===void 0&&(n=Nr(i));var l=(r===0?n:n>>>r)&mr,c=o===Et,d=this.nodes,f=d[l];if(c&&!f)return this;var p=fn(f,e,r+Vt,n,i,o,s,u);if(p===f)return this;var v=this.count;if(!f)v++;else if(!p&&(v--,v<Fc))return Sc(e,d,v,l);var y=e&&e===this.ownerID,m=po(d,l,p,y);return y?(this.count=v,this.nodes=m,this):new Pa(e,v,m)};var ti=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entries=n};ti.prototype.get=function(e,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Ir(n,o[s][0]))return o[s][1];return i},ti.prototype.update=function(e,r,n,i,o,s,u){n===void 0&&(n=Nr(i));var l=o===Et;if(n!==this.keyHash)return l?this:(sn(u),sn(s),Fs(this,e,r,n,[i,o]));for(var c=this.entries,d=0,f=c.length;d<f&&!Ir(i,c[d][0]);d++);var p=d<f;if(p?c[d][1]===o:l)return this;if(sn(u),(l||!p)&&sn(s),l&&f===2)return new ia(e,this.keyHash,c[d^1]);var v=e&&e===this.ownerID,y=v?c:Wn(c);return p?l?d===f-1?y.pop():y[d]=y.pop():y[d]=[i,o]:y.push([i,o]),v?(this.entries=y,this):new ti(e,this.keyHash,y)};var ia=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entry=n};ia.prototype.get=function(e,r,n,i){return Ir(n,this.entry[0])?this.entry[1]:i},ia.prototype.update=function(e,r,n,i,o,s,u){var l=o===Et,c=Ir(i,this.entry[0]);if(c?o===this.entry[1]:l)return this;if(sn(u),l){sn(s);return}return c?e&&e===this.ownerID?(this.entry[1]=o,this):new ia(e,this.keyHash,[i,o]):(sn(s),Fs(this,e,r,Nr(i),[i,o]))},zn.prototype.iterate=ti.prototype.iterate=function(a,e){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(a(r[e?i-n:n])===!1)return!1},Da.prototype.iterate=Pa.prototype.iterate=function(a,e){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[e?i-n:n];if(o&&o.iterate(a,e)===!1)return!1}},ia.prototype.iterate=function(a,e){return a(this.entry)};var Ei=function(a){function e(r,n,i){this._type=n,this._reverse=i,this._stack=r._root&&Nu(r._root)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,s=i.index++,u=void 0;if(o.entry){if(s===0)return Ss(n,o.entry)}else if(o.entries){if(u=o.entries.length-1,s<=u)return Ss(n,o.entries[this._reverse?u-s:s])}else if(u=o.nodes.length-1,s<=u){var l=o.nodes[this._reverse?u-s:s];if(l){if(l.entry)return Ss(n,l.entry);i=this._stack=Nu(l,i)}continue}i=this._stack=this._stack.__prev}return jt()},e}(At);function Ss(a,e){return vt(a,e[0],e[1])}function Nu(a,e){return{node:a,index:0,__prev:e}}function bs(a,e,r,n){var i=Object.create(ir);return i.size=a,i._root=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var Vu;function Ln(){return Vu||(Vu=bs(0))}function Os(a,e,r){var n,i;if(a._root){var o=In(),s=In();if(n=fn(a._root,a.__ownerID,0,void 0,e,r,o,s),!s.value)return a;i=a.size+(o.value?r===Et?-1:1:0)}else{if(r===Et)return a;i=1,n=new zn(a.__ownerID,[[e,r]])}return a.__ownerID?(a.size=i,a._root=n,a.__hash=void 0,a.__altered=!0,a):n?bs(i,n):Ln()}function fn(a,e,r,n,i,o,s,u){return a?a.update(e,r,n,i,o,s,u):o===Et?a:(sn(u),sn(s),new ia(e,n,[i,o]))}function ri(a){return a.constructor===ia||a.constructor===ti}function Fs(a,e,r,n,i){if(a.keyHash===n)return new ti(e,n,[a.entry,i]);var o=(r===0?a.keyHash:a.keyHash>>>r)&mr,s=(r===0?n:n>>>r)&mr,u,l=o===s?[Fs(a,e,r+Vt,n,i)]:(u=new ia(e,n,i),o<s?[a,u]:[u,a]);return new Da(e,1<<o|1<<s,l)}function yc(a,e,r,n){a||(a=new yr);for(var i=new ia(a,Nr(r),[r,n]),o=0;o<e.length;o++){var s=e[o];i=i.update(a,0,void 0,s[0],s[1])}return i}function Sc(a,e,r,n){for(var i=0,o=0,s=new Array(r),u=0,l=1,c=e.length;u<c;u++,l<<=1){var d=e[u];d!==void 0&&u!==n&&(i|=l,s[o++]=d)}return new Da(a,i,s)}function Mu(a,e,r,n,i){for(var o=0,s=new Array(tr),u=0;r!==0;u++,r>>>=1)s[u]=r&1?e[o++]:void 0;return s[n]=i,new Pa(a,o+1,s)}function ku(a){return a-=a>>1&1431655765,a=(a&858993459)+(a>>2&858993459),a=a+(a>>4)&252645135,a+=a>>8,a+=a>>16,a&127}function po(a,e,r,n){var i=n?a:Wn(a);return i[e]=r,i}function Gu(a,e,r,n){var i=a.length+1;if(n&&e+1===i)return a[e]=r,a;for(var o=new Array(i),s=0,u=0;u<i;u++)u===e?(o[u]=r,s=-1):o[u]=a[u+s];return o}function bc(a,e,r){var n=a.length-1;if(r&&e===n)return a.pop(),a;for(var i=new Array(n),o=0,s=0;s<n;s++)s===e&&(o=1),i[s]=a[s+o];return i}var Ts=tr/4,Oc=tr/2,Fc=tr/4,vo="@@__IMMUTABLE_LIST__@@";function Cs(a){return!!(a&&a[vo])}var Pn=function(a){function e(r){var n=go();if(r==null)return n;if(Cs(r))return r;var i=a(r),o=i.size;return o===0?n:(bn(o),o>0&&o<tr?wi(0,o,Vt,null,new oa(i.toArray())):n.withMutations(function(s){s.setSize(o),i.forEach(function(u,l){return s.set(l,u)})}))}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(n,i){if(n=_n(this,n),n>=0&&n<this.size){n+=this._origin;var o=xi(this,n);return o&&o.array[n&mr]}return i},e.prototype.set=function(n,i){return Tc(this,n,i)},e.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},e.prototype.insert=function(n,i){return this.splice(n,0,i)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=Vt,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):go()},e.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){ma(o,0,i+n.length);for(var s=0;s<n.length;s++)o.set(i+s,n[s])})},e.prototype.pop=function(){return ma(this,0,-1)},e.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){ma(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},e.prototype.shift=function(){return ma(this,1)},e.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var s=n[o],u=a(typeof s!="string"&&Hr(s)?s:[s]);u.size!==0&&i.push(u)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(l){i.forEach(function(c){return c.forEach(function(d){return l.push(d)})})})},e.prototype.setSize=function(n){return ma(this,0,n)},e.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){for(var u=0;u<o.size;u++)s.set(u,n.call(i,s.get(u),u,o))})},e.prototype.slice=function(n,i){var o=this.size;return ca(n,i,o)?this:ma(this,ea(n,o),da(i,o))},e.prototype.__iterator=function(n,i){var o=i?this.size:0,s=Bu(this,i);return new At(function(){var u=s();return u===ni?jt():vt(n,i?--o:o++,u)})},e.prototype.__iterate=function(n,i){for(var o=i?this.size:0,s=Bu(this,i),u;(u=s())!==ni&&n(u,i?--o:o++,this)!==!1;);return o},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?wi(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?go():(this.__ownerID=n,this.__altered=!1,this)},e}(ta);Pn.isList=Cs;var Sr=Pn.prototype;Sr[vo]=!0,Sr[jn]=Sr.remove,Sr.merge=Sr.concat,Sr.setIn=ds,Sr.deleteIn=Sr.removeIn=_a,Sr.update=ps,Sr.updateIn=co,Sr.mergeIn=hs,Sr.mergeDeepIn=ms,Sr.withMutations=Xa,Sr.wasAltered=ys,Sr.asImmutable=ei,Sr["@@transducer/init"]=Sr.asMutable=Za,Sr["@@transducer/step"]=function(a,e){return a.push(e)},Sr["@@transducer/result"]=function(a){return a.asImmutable()};var oa=function(e,r){this.array=e,this.ownerID=r};oa.prototype.removeBefore=function(e,r,n){if(n===r?1<<r:this.array.length===0)return this;var i=n>>>r&mr;if(i>=this.array.length)return new oa([],e);var o=i===0,s;if(r>0){var u=this.array[i];if(s=u&&u.removeBefore(e,r-Vt,n),s===u&&o)return this}if(o&&!s)return this;var l=ai(this,e);if(!o)for(var c=0;c<i;c++)l.array[c]=void 0;return s&&(l.array[i]=s),l},oa.prototype.removeAfter=function(e,r,n){if(n===(r?1<<r:0)||this.array.length===0)return this;var i=n-1>>>r&mr;if(i>=this.array.length)return this;var o;if(r>0){var s=this.array[i];if(o=s&&s.removeAfter(e,r-Vt,n),o===s&&i===this.array.length-1)return this}var u=ai(this,e);return u.array.splice(i+1),o&&(u.array[i]=o),u};var ni={};function Bu(a,e){var r=a._origin,n=a._capacity,i=Li(n),o=a._tail;return s(a._root,a._level,0);function s(c,d,f){return d===0?u(c,f):l(c,d,f)}function u(c,d){var f=d===i?o&&o.array:c&&c.array,p=d>r?0:r-d,v=n-d;return v>tr&&(v=tr),function(){if(p===v)return ni;var y=e?--v:p++;return f&&f[y]}}function l(c,d,f){var p,v=c&&c.array,y=f>r?0:r-f>>d,m=(n-f>>d)+1;return m>tr&&(m=tr),function(){for(;;){if(p){var S=p();if(S!==ni)return S;p=null}if(y===m)return ni;var F=e?--m:y++;p=s(v&&v[F],d-Vt,f+(F<<d))}}}}function wi(a,e,r,n,i,o,s){var u=Object.create(Sr);return u.size=e-a,u._origin=a,u._capacity=e,u._level=r,u._root=n,u._tail=i,u.__ownerID=o,u.__hash=s,u.__altered=!1,u}var Uu;function go(){return Uu||(Uu=wi(0,0,Vt))}function Tc(a,e,r){if(e=_n(a,e),e!==e)return a;if(e>=a.size||e<0)return a.withMutations(function(s){e<0?ma(s,e).set(0,r):ma(s,0,e+1).set(e,r)});e+=a._origin;var n=a._tail,i=a._root,o=In();return e>=Li(a._capacity)?n=Kn(n,a.__ownerID,0,e,r,o):i=Kn(i,a.__ownerID,a._level,e,r,o),o.value?a.__ownerID?(a._root=i,a._tail=n,a.__hash=void 0,a.__altered=!0,a):wi(a._origin,a._capacity,a._level,i,n):a}function Kn(a,e,r,n,i,o){var s=n>>>r&mr,u=a&&s<a.array.length;if(!u&&i===void 0)return a;var l;if(r>0){var c=a&&a.array[s],d=Kn(c,e,r-Vt,n,i,o);return d===c?a:(l=ai(a,e),l.array[s]=d,l)}return u&&a.array[s]===i?a:(o&&sn(o),l=ai(a,e),i===void 0&&s===l.array.length-1?l.array.pop():l.array[s]=i,l)}function ai(a,e){return e&&a&&e===a.ownerID?a:new oa(a?a.array.slice():[],e)}function xi(a,e){if(e>=Li(a._capacity))return a._tail;if(e<1<<a._level+Vt){for(var r=a._root,n=a._level;r&&n>0;)r=r.array[e>>>n&mr],n-=Vt;return r}}function ma(a,e,r){e!==void 0&&(e|=0),r!==void 0&&(r|=0);var n=a.__ownerID||new yr,i=a._origin,o=a._capacity,s=i+e,u=r===void 0?o:r<0?o+r:i+r;if(s===i&&u===o)return a;if(s>=u)return a.clear();for(var l=a._level,c=a._root,d=0;s+d<0;)c=new oa(c&&c.array.length?[void 0,c]:[],n),l+=Vt,d+=1<<l;d&&(s+=d,i+=d,u+=d,o+=d);for(var f=Li(o),p=Li(u);p>=1<<l+Vt;)c=new oa(c&&c.array.length?[c]:[],n),l+=Vt;var v=a._tail,y=p<f?xi(a,u-1):p>f?new oa([],n):v;if(v&&p>f&&s<o&&v.array.length){c=ai(c,n);for(var m=c,S=l;S>Vt;S-=Vt){var F=f>>>S&mr;m=m.array[F]=ai(m.array[F],n)}m.array[f>>>Vt&mr]=v}if(u<o&&(y=y&&y.removeAfter(n,0,u)),s>=p)s-=p,u-=p,l=Vt,c=null,y=y&&y.removeBefore(n,0,s);else if(s>i||p<f){for(d=0;c;){var C=s>>>l&mr;if(C!==p>>>l&mr)break;C&&(d+=(1<<l)*C),l-=Vt,c=c.array[C]}c&&s>i&&(c=c.removeBefore(n,l,s-d)),c&&p<f&&(c=c.removeAfter(n,l,p-d)),d&&(s-=d,u-=d)}return a.__ownerID?(a.size=u-s,a._origin=s,a._capacity=u,a._level=l,a._root=c,a._tail=y,a.__hash=void 0,a.__altered=!0,a):wi(s,u,l,c,y)}function Li(a){return a<tr?0:a-1>>>Vt<<Vt}var qn=function(a){function e(r){return r==null?Ri():Qo(r)?r:Ri().withMutations(function(n){var i=un(r);bn(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):Ri()},e.prototype.set=function(n,i){return Wu(this,n,i)},e.prototype.remove=function(n){return Wu(this,n,Et)},e.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(s){return s&&n(s[1],s[0],o)},i)},e.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?ho(i,o,n,this.__hash):this.size===0?Ri():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},e}(Wt);qn.isOrderedMap=Qo,qn.prototype[ra]=!0,qn.prototype[jn]=qn.prototype.remove;function ho(a,e,r,n){var i=Object.create(qn.prototype);return i.size=a?a.size:0,i._map=a,i._list=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var $u;function Ri(){return $u||($u=ho(Ln(),go()))}function Wu(a,e,r){var n=a._map,i=a._list,o=n.get(e),s=o!==void 0,u,l;if(r===Et){if(!s)return a;i.size>=tr&&i.size>=n.size*2?(l=i.filter(function(c,d){return c!==void 0&&o!==d}),u=l.toKeyedSeq().map(function(c){return c[0]}).flip().toMap(),a.__ownerID&&(u.__ownerID=l.__ownerID=a.__ownerID)):(u=n.remove(e),l=o===i.size-1?i.pop():i.set(o,void 0))}else if(s){if(r===i.get(o)[1])return a;u=n,l=i.set(o,[e,r])}else u=n.set(e,i.size),l=i.set(i.size,[e,r]);return a.__ownerID?(a.size=u.size,a._map=u,a._list=l,a.__hash=void 0,a.__altered=!0,a):ho(u,l)}var zu="@@__IMMUTABLE_STACK__@@";function ji(a){return!!(a&&a[zu])}var Ii=function(a){function e(r){return r==null?mo():ji(r)?r:mo().pushAll(r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(n,i){var o=this._head;for(n=_n(this,n);o&&n--;)o=o.next;return o?o.value:i},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,s=arguments.length-1;s>=0;s--)o={value:n[s],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):ii(i,o)},e.prototype.pushAll=function(n){if(n=a(n),n.size===0)return this;if(this.size===0&&ji(n))return n;bn(n.size);var i=this.size,o=this._head;return n.__iterate(function(s){i++,o={value:s,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):ii(i,o)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):mo()},e.prototype.slice=function(n,i){if(ca(n,i,this.size))return this;var o=ea(n,this.size),s=da(i,this.size);if(s!==this.size)return a.prototype.slice.call(this,n,i);for(var u=this.size-o,l=this._head;o--;)l=l.next;return this.__ownerID?(this.size=u,this._head=l,this.__hash=void 0,this.__altered=!0,this):ii(u,l)},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?ii(this.size,this._head,n,this.__hash):this.size===0?mo():(this.__ownerID=n,this.__altered=!1,this)},e.prototype.__iterate=function(n,i){var o=this;if(i)return new lt(this.toArray()).__iterate(function(l,c){return n(l,c,o)},i);for(var s=0,u=this._head;u&&n(u.value,s++,this)!==!1;)u=u.next;return s},e.prototype.__iterator=function(n,i){if(i)return new lt(this.toArray()).__iterator(n,i);var o=0,s=this._head;return new At(function(){if(s){var u=s.value;return s=s.next,vt(n,o++,u)}return jt()})},e}(ta);Ii.isStack=ji;var Jr=Ii.prototype;Jr[zu]=!0,Jr.shift=Jr.pop,Jr.unshift=Jr.push,Jr.unshiftAll=Jr.pushAll,Jr.withMutations=Xa,Jr.wasAltered=ys,Jr.asImmutable=ei,Jr["@@transducer/init"]=Jr.asMutable=Za,Jr["@@transducer/step"]=function(a,e){return a.unshift(e)},Jr["@@transducer/result"]=function(a){return a.asImmutable()};function ii(a,e,r,n){var i=Object.create(Jr);return i.size=a,i._head=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var Ku;function mo(){return Ku||(Ku=ii(0))}var qu="@@__IMMUTABLE_SET__@@";function yo(a){return!!(a&&a[qu])}function Es(a){return yo(a)&&ln(a)}function ws(a,e){if(a===e)return!0;if(!Dr(e)||a.size!==void 0&&e.size!==void 0&&a.size!==e.size||a.__hash!==void 0&&e.__hash!==void 0&&a.__hash!==e.__hash||Qt(a)!==Qt(e)||jr(a)!==jr(e)||ln(a)!==ln(e))return!1;if(a.size===0&&e.size===0)return!0;var r=!fa(a);if(ln(a)){var n=a.entries();return e.every(function(l,c){var d=n.next().value;return d&&Ir(d[1],l)&&(r||Ir(d[0],c))})&&n.next().done}var i=!1;if(a.size===void 0)if(e.size===void 0)typeof a.cacheResult=="function"&&a.cacheResult();else{i=!0;var o=a;a=e,e=o}var s=!0,u=e.__iterate(function(l,c){if(r?!a.has(l):i?!Ir(l,a.get(c,Et)):!Ir(a.get(c,Et),l))return s=!1,!1});return s&&a.size===u}function Na(a,e){var r=function(n){a.prototype[n]=e[n]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),a}function So(a){if(!a||typeof a!="object")return a;if(!Dr(a)){if(!ha(a))return a;a=ct(a)}if(Qt(a)){var e={};return a.__iterate(function(n,i){e[i]=So(n)}),e}var r=[];return a.__iterate(function(n){r.push(So(n))}),r}var Ai=function(a){function e(r){return r==null?_i():yo(r)&&!ln(r)?r:_i().withMutations(function(n){var i=a(r);bn(i.size),i.forEach(function(o){return n.add(o)})})}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(un(n).keySeq())},e.intersect=function(n){return n=ur(n).toArray(),n.length?Vr.intersect.apply(e(n.pop()),n):_i()},e.union=function(n){return n=ur(n).toArray(),n.length?Vr.union.apply(e(n.pop()),n):_i()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return bo(this,this._map.set(n,n))},e.prototype.remove=function(n){return bo(this,this._map.remove(n))},e.prototype.clear=function(){return bo(this,this._map.clear())},e.prototype.map=function(n,i){var o=this,s=!1,u=bo(this,this._map.mapEntries(function(l){var c=l[1],d=n.call(i,c,c,o);return d!==c&&(s=!0),[d,d]},i));return s?u:this},e.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var s=0;s<n.length;s++)typeof n[s]=="string"?o.add(n[s]):a(n[s]).forEach(function(u){return o.add(u)})})},e.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return a(s)});var o=[];return this.forEach(function(s){n.every(function(u){return u.includes(s)})||o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},e.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return a(s)});var o=[];return this.forEach(function(s){n.some(function(u){return u.includes(s)})&&o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},e.prototype.sort=function(n){return si(Fi(this,n))},e.prototype.sortBy=function(n,i){return si(Fi(this,i,n))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(s){return n(s,s,o)},i)},e.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},e}(pa);Ai.isSet=yo;var Vr=Ai.prototype;Vr[qu]=!0,Vr[jn]=Vr.remove,Vr.merge=Vr.concat=Vr.union,Vr.withMutations=Xa,Vr.asImmutable=ei,Vr["@@transducer/init"]=Vr.asMutable=Za,Vr["@@transducer/step"]=function(a,e){return a.add(e)},Vr["@@transducer/result"]=function(a){return a.asImmutable()},Vr.__empty=_i,Vr.__make=Hu;function bo(a,e){return a.__ownerID?(a.size=e.size,a._map=e,a):e===a._map?a:e.size===0?a.__empty():a.__make(e)}function Hu(a,e){var r=Object.create(Vr);return r.size=a?a.size:0,r._map=a,r.__ownerID=e,r}var Qu;function _i(){return Qu||(Qu=Hu(Ln()))}var Ju=function(a){function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);if(Lu(i!==0,"Cannot step a Range by 0"),r=r||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<r&&(i=-i),this._start=r,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-r)/i-1)+1),this.size===0){if(xs)return xs;xs=this}}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},e.prototype.get=function(n,i){return this.has(n)?this._start+_n(this,n)*this._step:i},e.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},e.prototype.slice=function(n,i){return ca(n,i,this.size)?this:(n=ea(n,this.size),i=da(i,this.size),i<=n?new e(0,0):new e(this.get(n,this._end),this.get(i,this._end),this._step))},e.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},e.prototype.lastIndexOf=function(n){return this.indexOf(n)},e.prototype.__iterate=function(n,i){for(var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,l=0;l!==o&&n(u,i?o-++l:l++,this)!==!1;)u+=i?-s:s;return l},e.prototype.__iterator=function(n,i){var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,l=0;return new At(function(){if(l===o)return jt();var c=u;return u+=i?-s:s,vt(n,i?o-++l:l++,c)})},e.prototype.equals=function(n){return n instanceof e?this._start===n._start&&this._end===n._end&&this._step===n._step:ws(this,n)},e}(Ot),xs;function Ls(a,e,r){for(var n=fr(e),i=0;i!==n.length;)if(a=cs(a,n[i++],Et),a===Et)return r;return a}function Yu(a,e){return Ls(this,a,e)}function Di(a,e){return Ls(a,e,Et)!==Et}function Cc(a){return Di(this,a)}function Xu(){bn(this.size);var a={};return this.__iterate(function(e,r){a[r]=e}),a}ur.isIterable=Dr,ur.isKeyed=Qt,ur.isIndexed=jr,ur.isAssociative=fa,ur.isOrdered=ln,ur.Iterator=At,Na(ur,{toArray:function(){bn(this.size);var e=new Array(this.size||0),r=Qt(this),n=0;return this.__iterate(function(i,o){e[n++]=r?[o,i]:i}),e},toIndexedSeq:function(){return new mu(this)},toJS:function(){return So(this)},toKeyedSeq:function(){return new oo(this,!0)},toMap:function(){return Wt(this.toKeyedSeq())},toObject:Xu,toOrderedMap:function(){return qn(this.toKeyedSeq())},toOrderedSet:function(){return si(Qt(this)?this.valueSeq():this)},toSet:function(){return Ai(Qt(this)?this.valueSeq():this)},toSetSeq:function(){return new yu(this)},toSeq:function(){return jr(this)?this.toIndexedSeq():Qt(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Ii(Qt(this)?this.valueSeq():this)},toList:function(){return Pn(Qt(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,r){return this.size===0?e+r:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return rr(this,lc(this,e))},includes:function(e){return this.some(function(r){return Ir(r,e)})},entries:function(){return this.__iterator(Lt)},every:function(e,r){bn(this.size);var n=!0;return this.__iterate(function(i,o,s){if(!e.call(r,i,o,s))return n=!1,!1}),n},filter:function(e,r){return rr(this,Su(this,e,r,!0))},partition:function(e,r){return bu(this,e,r)},find:function(e,r,n){var i=this.findEntry(e,r);return i?i[1]:n},forEach:function(e,r){return bn(this.size),this.__iterate(r?e.bind(r):e)},join:function(e){bn(this.size),e=e!==void 0?""+e:",";var r="",n=!0;return this.__iterate(function(i){n?n=!1:r+=e,r+=i!=null?i.toString():""}),r},keys:function(){return this.__iterator(En)},map:function(e,r){return rr(this,ns(this,e,r))},reduce:function(e,r,n){return Rs(this,e,r,n,arguments.length<2,!1)},reduceRight:function(e,r,n){return Rs(this,e,r,n,arguments.length<2,!0)},reverse:function(){return rr(this,as(this,!0))},slice:function(e,r){return rr(this,is(this,e,r,!0))},some:function(e,r){bn(this.size);var n=!1;return this.__iterate(function(i,o,s){if(e.call(r,i,o,s))return n=!0,!1}),n},sort:function(e){return rr(this,Fi(this,e))},values:function(){return this.__iterator(Sn)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(e,r){return An(e?this.toSeq().filter(e,r):this)},countBy:function(e,r){return sc(this,e,r)},equals:function(e){return ws(this,e)},entrySeq:function(){var e=this;if(e._cache)return new lt(e._cache);var r=e.toSeq().map(wc).toIndexedSeq();return r.fromEntrySeq=function(){return e.toSeq()},r},filterNot:function(e,r){return this.filter(js(e),r)},findEntry:function(e,r,n){var i=n;return this.__iterate(function(o,s,u){if(e.call(r,o,s,u))return i=[s,o],!1}),i},findKey:function(e,r){var n=this.findEntry(e,r);return n&&n[0]},findLast:function(e,r,n){return this.toKeyedSeq().reverse().find(e,r,n)},findLastEntry:function(e,r,n){return this.toKeyedSeq().reverse().findEntry(e,r,n)},findLastKey:function(e,r){return this.toKeyedSeq().reverse().findKey(e,r)},first:function(e){return this.find(hi,null,e)},flatMap:function(e,r){return rr(this,cc(this,e,r))},flatten:function(e){return rr(this,Tu(this,e,!0))},fromEntrySeq:function(){return new rs(this)},get:function(e,r){return this.find(function(n,i){return Ir(i,e)},void 0,r)},getIn:Yu,groupBy:function(e,r){return uc(this,e,r)},has:function(e){return this.get(e,Et)!==Et},hasIn:Cc,isSubset:function(e){return e=typeof e.includes=="function"?e:ur(e),this.every(function(r){return e.includes(r)})},isSuperset:function(e){return e=typeof e.isSubset=="function"?e:ur(e),e.isSubset(this)},keyOf:function(e){return this.findKey(function(r){return Ir(r,e)})},keySeq:function(){return this.toSeq().map(Ec).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return os(this,e)},maxBy:function(e,r){return os(this,r,e)},min:function(e){return os(this,e?Zu(e):Is)},minBy:function(e,r){return os(this,r?Zu(r):Is,e)},rest:function(){return this.slice(1)},skip:function(e){return e===0?this:this.slice(Math.max(0,e))},skipLast:function(e){return e===0?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,r){return rr(this,Fu(this,e,r,!0))},skipUntil:function(e,r){return this.skipWhile(js(e),r)},sortBy:function(e,r){return rr(this,Fi(this,r,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,r){return rr(this,Ou(this,e,r))},takeUntil:function(e,r){return this.takeWhile(js(e),r)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=xc(this))}});var nr=ur.prototype;nr[eo]=!0,nr[za]=nr.values,nr.toJSON=nr.toArray,nr.__toStringMapper=Ya,nr.inspect=nr.toSource=function(){return this.toString()},nr.chain=nr.flatMap,nr.contains=nr.includes,Na(un,{flip:function(){return rr(this,so(this))},mapEntries:function(e,r){var n=this,i=0;return rr(this,this.toSeq().map(function(o,s){return e.call(r,[s,o],i++,n)}).fromEntrySeq())},mapKeys:function(e,r){var n=this;return rr(this,this.toSeq().flip().map(function(i,o){return e.call(r,i,o,n)}).flip())}});var Pi=un.prototype;Pi[to]=!0,Pi[za]=nr.entries,Pi.toJSON=Xu,Pi.__toStringMapper=function(a,e){return Ya(e)+": "+Ya(a)},Na(ta,{toKeyedSeq:function(){return new oo(this,!1)},filter:function(e,r){return rr(this,Su(this,e,r,!1))},findIndex:function(e,r){var n=this.findEntry(e,r);return n?n[0]:-1},indexOf:function(e){var r=this.keyOf(e);return r===void 0?-1:r},lastIndexOf:function(e){var r=this.lastKeyOf(e);return r===void 0?-1:r},reverse:function(){return rr(this,as(this,!1))},slice:function(e,r){return rr(this,is(this,e,r,!1))},splice:function(e,r){var n=arguments.length;if(r=Math.max(r||0,0),n===0||n===2&&!r)return this;e=ea(e,e<0?this.count():this.size);var i=this.slice(0,e);return rr(this,n===1?i:i.concat(Wn(arguments,2),this.slice(e+r)))},findLastIndex:function(e,r){var n=this.findLastEntry(e,r);return n?n[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return rr(this,Tu(this,e,!1))},get:function(e,r){return e=_n(this,e),e<0||this.size===1/0||this.size!==void 0&&e>this.size?r:this.find(function(n,i){return i===e},void 0,r)},has:function(e){return e=_n(this,e),e>=0&&(this.size!==void 0?this.size===1/0||e<this.size:this.indexOf(e)!==-1)},interpose:function(e){return rr(this,lf(this,e))},interleave:function(){var e=[this].concat(Wn(arguments)),r=ss(this.toSeq(),Ot.of,e),n=r.flatten(!0);return r.size&&(n.size=r.size*e.length),rr(this,n)},keySeq:function(){return Ju(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,r){return rr(this,Fu(this,e,r,!1))},zip:function(){var e=[this].concat(Wn(arguments));return rr(this,ss(this,el,e))},zipAll:function(){var e=[this].concat(Wn(arguments));return rr(this,ss(this,el,e,!0))},zipWith:function(e){var r=Wn(arguments);return r[0]=this,rr(this,ss(this,e,r))}});var oi=ta.prototype;oi[mi]=!0,oi[ra]=!0,Na(pa,{get:function(e,r){return this.has(e)?e:r},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}});var Va=pa.prototype;Va.has=nr.includes,Va.contains=Va.includes,Va.keys=Va.values,Na(dn,Pi),Na(Ot,oi),Na(wn,Va);function Rs(a,e,r,n,i,o){return bn(a.size),a.__iterate(function(s,u,l){i?(i=!1,r=s):r=e.call(n,r,s,u,l)},o),r}function Ec(a,e){return e}function wc(a,e){return[e,a]}function js(a){return function(){return!a.apply(this,arguments)}}function Zu(a){return function(){return-a.apply(this,arguments)}}function el(){return Wn(arguments)}function Is(a,e){return a<e?1:a>e?-1:0}function xc(a){if(a.size===1/0)return 0;var e=ln(a),r=Qt(a),n=e?1:0,i=a.__iterate(r?e?function(o,s){n=31*n+rl(Nr(o),Nr(s))|0}:function(o,s){n=n+rl(Nr(o),Nr(s))|0}:e?function(o){n=31*n+Nr(o)|0}:function(o){n=n+Nr(o)|0});return tl(i,n)}function tl(a,e){return e=Si(e,3432918353),e=Si(e<<15|e>>>-15,461845907),e=Si(e<<13|e>>>-13,5),e=(e+3864292196|0)^a,e=Si(e^e>>>16,2246822507),e=Si(e^e>>>13,3266489909),e=io(e^e>>>16),e}function rl(a,e){return a^e+2654435769+(a<<6)+(a>>2)|0}var si=function(a){function e(r){return r==null?As():Es(r)?r:As().withMutations(function(n){var i=pa(r);bn(i.size),i.forEach(function(o){return n.add(o)})})}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(un(n).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(Ai);si.isOrderedSet=Es;var Ma=si.prototype;Ma[ra]=!0,Ma.zip=oi.zip,Ma.zipWith=oi.zipWith,Ma.zipAll=oi.zipAll,Ma.__empty=As,Ma.__make=Oo;function Oo(a,e){var r=Object.create(Ma);return r.size=a?a.size:0,r._map=a,r.__ownerID=e,r}var nl;function As(){return nl||(nl=Oo(Ri()))}var Lc={LeftThenRight:-1,RightThenLeft:1};function Rc(a){if(Un(a))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(tn(a))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(a===null||typeof a!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var xr=function(e,r){var n;Rc(e);var i=function(u){var l=this;if(u instanceof i)return u;if(!(this instanceof i))return new i(u);if(!n){n=!0;var c=Object.keys(e),d=o._indices={};o._name=r,o._keys=c,o._defaultValues=e;for(var f=0;f<c.length;f++){var p=c[f];d[p]=f,o[p]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+O(this)+' with property "'+p+'" since that property name is part of the Record API.'):T(o,p)}}return this.__ownerID=void 0,this._values=Pn().withMutations(function(v){v.setSize(l._keys.length),un(u).forEach(function(y,m){v.set(l._indices[m],y===l._defaultValues[m]?void 0:y)})}),this},o=i.prototype=Object.create(ar);return o.constructor=i,r&&(i.displayName=r),i};xr.prototype.toString=function(){for(var e=O(this)+" { ",r=this._keys,n,i=0,o=r.length;i!==o;i++)n=r[i],e+=(i?", ":"")+n+": "+Ya(this.get(n));return e+" }"},xr.prototype.equals=function(e){return this===e||Un(e)&&h(this).equals(h(e))},xr.prototype.hashCode=function(){return h(this).hashCode()},xr.prototype.has=function(e){return this._indices.hasOwnProperty(e)},xr.prototype.get=function(e,r){if(!this.has(e))return r;var n=this._indices[e],i=this._values.get(n);return i===void 0?this._defaultValues[e]:i},xr.prototype.set=function(e,r){if(this.has(e)){var n=this._values.set(this._indices[e],r===this._defaultValues[e]?void 0:r);if(n!==this._values&&!this.__ownerID)return _s(this,n)}return this},xr.prototype.remove=function(e){return this.set(e)},xr.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:_s(this,e)},xr.prototype.wasAltered=function(){return this._values.wasAltered()},xr.prototype.toSeq=function(){return h(this)},xr.prototype.toJS=function(){return So(this)},xr.prototype.entries=function(){return this.__iterator(Lt)},xr.prototype.__iterator=function(e,r){return h(this).__iterator(e,r)},xr.prototype.__iterate=function(e,r){return h(this).__iterate(e,r)},xr.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var r=this._values.__ensureOwner(e);return e?_s(this,r,e):(this.__ownerID=e,this._values=r,this)},xr.isRecord=Un,xr.getDescriptiveName=O;var ar=xr.prototype;ar[yi]=!0,ar[jn]=ar.remove,ar.deleteIn=ar.removeIn=_a,ar.getIn=Yu,ar.hasIn=nr.hasIn,ar.merge=Au,ar.mergeWith=fo,ar.mergeIn=hs,ar.mergeDeep=Du,ar.mergeDeepWith=Pu,ar.mergeDeepIn=ms,ar.setIn=ds,ar.update=ps,ar.updateIn=co,ar.withMutations=Xa,ar.asMutable=Za,ar.asImmutable=ei,ar[za]=ar.entries,ar.toJSON=ar.toObject=nr.toObject,ar.inspect=ar.toSource=function(){return this.toString()};function _s(a,e,r){var n=Object.create(Object.getPrototypeOf(a));return n._values=e,n.__ownerID=r,n}function O(a){return a.constructor.displayName||a.constructor.name||"Record"}function h(a){return gt(a._keys.map(function(e){return[e,a.get(e)]}))}function T(a,e){try{Object.defineProperty(a,e,{get:function(){return this.get(e)},set:function(r){Lu(this.__ownerID,"Cannot set on an immutable record."),this.set(e,r)}})}catch{}}var L=function(a){function e(r,n){if(!(this instanceof e))return new e(r,n);if(this._value=r,this.size=n===void 0?1/0:Math.max(0,n),this.size===0){if(R)return R;R=this}}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},e.prototype.get=function(n,i){return this.has(n)?this._value:i},e.prototype.includes=function(n){return Ir(this._value,n)},e.prototype.slice=function(n,i){var o=this.size;return ca(n,i,o)?this:new e(this._value,da(i,o)-ea(n,o))},e.prototype.reverse=function(){return this},e.prototype.indexOf=function(n){return Ir(this._value,n)?0:-1},e.prototype.lastIndexOf=function(n){return Ir(this._value,n)?this.size:-1},e.prototype.__iterate=function(n,i){for(var o=this.size,s=0;s!==o&&n(this._value,i?o-++s:s++,this)!==!1;);return s},e.prototype.__iterator=function(n,i){var o=this,s=this.size,u=0;return new At(function(){return u===s?jt():vt(n,i?s-++u:u++,o._value)})},e.prototype.equals=function(n){return n instanceof e?Ir(this._value,n._value):ws(this,n)},e}(Ot),R;function G(a,e){return ee([],e||ce,a,"",e&&e.length>2?[]:void 0,{"":a})}function ee(a,e,r,n,i,o){if(typeof r!="string"&&!tn(r)&&(pr(r)||Hr(r)||us(r))){if(~a.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");a.push(r),i&&n!==""&&i.push(n);var s=e.call(o,n,ct(r).map(function(u,l){return ee(a,e,u,l,i,r)}),i&&i.slice());return a.pop(),i&&i.pop(),s}return r}function ce(a,e){return jr(e)?e.toList():Qt(e)?e.toMap():e.toSet()}var pe="4.3.7",Ee={version:pe,Collection:ur,Iterable:ur,Seq:ct,Map:Wt,OrderedMap:qn,List:Pn,Stack:Ii,Set:Ai,OrderedSet:si,PairSorting:Lc,Record:xr,Range:Ju,Repeat:L,is:Ir,fromJS:G,hash:Nr,isImmutable:tn,isCollection:Dr,isKeyed:Qt,isIndexed:jr,isAssociative:fa,isOrdered:ln,isValueObject:Jo,isPlainObject:us,isSeq:ja,isList:Cs,isMap:ao,isOrderedMap:Qo,isStack:ji,isSet:yo,isOrderedSet:Es,isRecord:Un,get:cs,getIn:Ls,has:ls,hasIn:Di,merge:vc,mergeDeep:gs,mergeWith:vs,mergeDeepWith:gc,remove:lo,removeIn:Iu,set:Ru,setIn:pc,update:fs,updateIn:Aa},Be=null;const be=Ee;var Ft=0;const Qe=function(){var a=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(r){var n=r==="s"?Math.floor(Math.random()*16):Ft++&15,i=r==="x"?n:n&3|8;return i.toString(16)});return e+a};var St=b(1779),Gt=b.n(St),Tt=b(95093),Rt=b.n(Tt);function Yr(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=jc(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function jc(a,e){if(a){if(typeof a=="string")return al(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?al(a,e):void 0}}function al(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function cf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Ni(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):cf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Vi=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Fo=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],Xr=function(e){return Ye(e)==="object"&&e!==null&&Object.prototype.toString.call(e)==="[object Object]"},df=function(e){return Ye(e)==="object"&&e!==null},To=function(e){var r=Ye(e);return r&&e!==null&&Array.isArray(e)?"array":r},Mi=function(e,r){return To(e)===r||r==="number"&&!isNaN(e)},ki=function(e){if(Ye(e)==="object"&&e!==null){if(Array.isArray(e))return Pe(e);if(Xr(e))return Ni({},e)}return e},il=function(e){return!["__proto__","constructor","prototype"].includes(e)},Ic=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)&&il(r)},v0=function(e,r,n,i){var o={canCreate:!1,canIgnore:!1,canChangeType:!1};i=Ni(Ni({},o),i??{});var s=i,u=s.canCreate,l=s.canIgnore,c=s.canChangeType;if(!Array.isArray(r))throw new Error("path is not an array");if(!r.length)throw new Error("path is empty");var d=typeof r[0]=="number"?"array":"object";if(!Mi(e,d))throw new Error("obj is not of type ".concat(d));var f=ki(e),p=f,v=Pe(r),y=v.pop(),m=[],S=Yr(v),F;try{for(S.s();!(F=S.n()).done;){var C=F.value;if(!il(C))throw new Error("path contains unsafe ".concat(C));var w=r[m.length],E=typeof w=="number"?"array":"object";if(!Mi(p[C],E))if(p[C]?c:u)p[C]=E==="array"?[]:{};else if(l){p=void 0,f=e;break}else throw new Error("Value by path ".concat(m.join(".")," should have type ").concat(E," but got ").concat(To(p[C])));m.push(C),p[C]=ki(p[C]),p=p[C]}}catch(A){S.e(A)}finally{S.f()}if(p)if(n===void 0)delete p[y];else{var _=p[y];typeof n=="function"?p[y]=n(_):p[y]=n}return f},g0=function(e,r,n){var i={canCreate:!0,canChangeType:!0,deepCopyObj:!1,deepCopyMixin:!1,arrayMergeMode:"merge",circularRefs:!1,specialSymbols:!0};n=Ni(Ni({},i),n??{});var o=n,s=o.deepCopyObj,u=o.deepCopyMixin,l=o.circularRefs,c=o.specialSymbols;if(!Mi(e,"object"))throw new Error("obj is not an object");if(!Mi(r,"object"))throw new Error("mixin is not an object");var d=Symbol.for("_v"),f=Symbol.for("_type"),p=Symbol.for("_canCreate"),v=Symbol.for("_canChangeType"),y=Symbol.for("_arrayMergeMode"),m=s?Gt()(e,l):ki(e),S=!1,F=function(w,E,_){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},N=A.isMixingArray,X=A.isMixingRealArray,H=0,W=function(){if(!il(Y))throw new Error("mixin contains unsafe key ".concat(Y));if(!Ic(E,Y))return 0;var ae=N?Number(Y)+H:Y,se=c&&df(E[Y]),re=n.canCreate,ie=n.canChangeType,ne=n.arrayMergeMode,de=E[Y],le=!1,fe=To(de);if(se){var ve,ye,we,xe,Fe,ze,_e;d in E[Y]&&(le=!0,de=E[Y][d]),fe=((ve=E[Y])===null||ve===void 0?void 0:ve[f])||To(de),re=(ye=(we=E[Y])===null||we===void 0?void 0:we[p])!==null&&ye!==void 0?ye:re,ie=(xe=(Fe=E[Y])===null||Fe===void 0?void 0:Fe[v])!==null&&xe!==void 0?xe:ie,ne=(ze=(_e=E[Y])===null||_e===void 0?void 0:_e[y])!==null&&ze!==void 0?ze:ne,fe==="array"&&ne==="overwrite"&&(le=!0)}if(fe!=="array"&&(ne=void 0),!Mi(_[ae],fe))if(_[ae]?ie:re)(fe==="array"||fe==="object")&&(_[ae]=fe==="array"?[]:{},S=!0);else return 0;if(fe==="array"||fe==="object")if(le)S=!0,_[ae]=u?Gt()(de,l):ki(de);else if(ne&&["join","joinMissing","joinRespectOrder"].includes(ne)){S=!0;var Oe=s?_[ae]:Gt()(_[ae],l),Ve=u?Gt()(de,l):de;ne==="joinRespectOrder"?_[ae]=Vs(Oe,Ve):(ne==="joinMissing"&&(Ve=Ve.filter(function($e){return!Oe.includes($e)})),_[ae]=[].concat(Pe(Oe),Pe(Ve)))}else{var ke;s||(_[ae]=ki(_[ae])),F([].concat(Pe(w),[Y]),de,_[ae],{isMixingArray:fe==="array",isMixingRealArray:fe==="array"&&!((ke=E[Y])!==null&&ke!==void 0&&ke[f])})}else{var De=de===void 0&&!X&&!le,Ke=ae in _;De?Ke&&(S=!0,Array.isArray(_)?(_.splice(ae,1),H--):delete _[ae]):(S=!0,_[ae]=de)}},J;for(var Y in E)J=W()};return F([],r,m),S?m:e},Nn=function(e,r){return Object.fromEntries(Object.entries(e).filter(function(n){var i=Ce(n,1),o=i[0];return!r.includes(o)}))},Mr=function(e){var r;return(r=e?.cardinality)!==null&&r!==void 0?r:1},ol=function(e,r){return e===r?!0:Wt.isMap(e)?e.equals(r):JSON.stringify(e)==JSON.stringify(r)},Ds=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===r?!0:Array.isArray(e)?h0(e,r,n):Wt.isMap(e)?e.equals(r):Ye(e)=="object"?m0(e,r,n):e===r};function h0(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=a.length;if(e.length!==n)return!1;for(var i=0;i<n;i++){var o=r?Ds(a[i],e[i],r):a[i]===e[i];if(!o)return!1}return!0}function m0(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=Object.keys(a),i=Object.keys(e),o=n.length;if(i.length!==o)return!1;for(var s=0;s<o;s++){var u=n[s],l=r?Ds(a[u],e[u],r):a[u]===e[u];if(!l)return!1}return!0}var Co=function(e){return Ye(e)==="object"&&e!==null&&typeof e.toJS=="function"},sl=function(e){return Co(e)&&be.isList(e)};function Ar(a){return sl(a)?a:new be.List(a)}function Ac(a){return Co(a)?a.toJS():a}var ff=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},pf=function(e,r,n,i,o,s){if(Array.isArray(e))return r},Ps=function(e){var r=["$$typeof","_owner","_store","ref","key"],n=function(u){return typeof u=="string"?u:typeof u=="function"?u.name:u};if(e instanceof Array)return e.map(function(s,u){return Ps(s)});if(Ye(e)==="object"&&e!==null&&Ns(e)){var i,o=Nn(e,r);return o.type&&(o.type=n(o.type)),o!=null&&(i=o.props)!==null&&i!==void 0&&i.children&&(o.props.children=Ps(o.props.children)),o}return e},Ns=function(e){return Ye(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},_c=function(e){return Ye(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},On=function(e){var r=Ye(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return r};function vf(a){return new Promise(function(e){setTimeout(e,a)})}function Vs(a,e){return a||(a=[]),e||(e=[]),e.map(function(r){return[r,a.indexOf(r)]}).map(function(r,n,i){var o=Ce(r,2),s=o[0],u=o[1];if(u==-1){var l=i.slice(n+1),c=i.slice(0,n),d=Pe(c).reverse().find(function(m){var S=Ce(m,2),F=S[0],C=S[1];return C!=-1}),f=c[c.length-1],p=l.find(function(m){var S=Ce(m,2),F=S[0],C=S[1];return C!=-1}),v=d&&d===c[c.length-1],y=p&&l===l[0];return v?[s,"after",d[0]]:y?[s,"before",p[0]]:d?f?[s,"after",f[0]]:[s,"after",d[0]]:p?[s,"before",p[0]]:[s,"append",null]}else return null}).filter(function(r){return r!==null}).reduce(function(r,n){var i=Ce(n,3),o=i[0],s=i[1],u=i[2],l=r.indexOf(u);if(r.indexOf(o)===-1)if(l>-1){var c=s==="after"?1:0;r.splice(l+c,0,o)}else r.splice(s==="append"?1/0:0,0,o);return r},a.slice())}var Dc=function(e){Ye(e)==="object"&&e!==null&&!Ns(e)&&(Object.keys(e).forEach(function(r){r!=="__cache"&&Dc(e[r])}),Object.freeze(e))},Pc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Xr(e)){if(e.var)return n[e.var]=r,!0;if(!Xr(r))return!1;for(var o in e){var s=e[o],u=r[o];if(!Pc(s,u,n,[].concat(Pe(i),[o])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(r))return!1;for(var l=0;l<e.length;l++){var c=e[l],d=r[l];if(!Pc(c,d,n,[].concat(Pe(i),[l])))return!1}return!0}else return e===r},y0=function(){var e;return typeof process<"u"&&((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:"production")=="development"},S0=function(){var e;return typeof process<"u"&&((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:e.NODE_ENV_TEST)=="true"},gf=function(e){if(S0())return Ni(Ni({},console),{},{log:function(){},debug:function(){},info:function(){}});var r=e??y0();return r?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},hf=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r,n=0;n<e.length;n++){var i=e[n];if(i!==void 0){r=i;break}}return r},Ms=gf(),b0=b(86636),ka=b.n(b0),O0=b(44383),ya=b.n(O0);function mf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Gi(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):mf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var F0=ka().mark(ks),T0=ka().mark(yf),C0=Vi,Sa=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],ul=["select","multiselect","treeselect","treemultiselect"];function ks(a){return ka().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(Nc(a,a.funcs||{},[]),"t0",1);case 1:case"end":return r.stop()}},F0)}function yf(a){return ka().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(Nc(a,a.fields||{},[]),"t0",1);case 1:case"end":return r.stop()}},T0)}function Nc(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return ka().mark(function i(o){var s,u,l;return ka().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:s=(a==null||(o=a.settings)===null||o===void 0?void 0:o.fieldSeparator)||".",d.t0=ka().keys(e);case 2:if((d.t1=d.t0()).done){d.next=13;break}if(u=d.t1.value,l=e[u],!l[n]){d.next=9;break}return d.delegateYield(Nc(a,l[n],[].concat(Pe(r),[u]),n),"t2",7);case 7:d.next=11;break;case 9:return d.next=11,[[].concat(Pe(r),[u]).join(s),l,u];case 11:d.next=2;break;case 13:case"end":return d.stop()}},i)})()}var sa=function(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!r)return null;if(r==="!case_value"){var s;return e==null||(s=e.settings)===null||s===void 0?void 0:s.caseValueField}var u=(e==null||(n=e.settings)===null||n===void 0?void 0:n.fieldSeparator)||".",l=br(r,e),c=e[i];if(!c)return null;for(var d=c,f=null,p=[],v=0;v<l.length;v++){var y=l[v];p.push(y);var m=p.join(u);f=d[m],v<l.length-1&&(f&&f[o]?(d=f[o],p=[]):f=null)}return f},Sf=function(e,r){var n,i,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=e.settings.fieldSeparator,u=[o].concat(Pe(r.split(s))).filter(function(d){return d!=null}),l=r,c=(n=e.__fieldNames[l])===null||n===void 0||(i=n.find)===null||i===void 0||(i=i.call(n,function(d){var f=d.inGroup;return f?o?.startsWith(f):!0}))===null||i===void 0?void 0:i.fullPath;return(c||u).join(s)},Vc=function(e,r){if(!r)return null;var n=sa(e,r,"funcs","subfields");if(!n)return null;var i=n.returnType,o=n.args,s=Object.fromEntries(Object.entries(o||{}).map(function(l){var c=Ce(l,2),d=c[0],f=c[1],p=ya()(f,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"]);return[d,p]})),u={returnType:i,args:s};return u},kr=function(e,r){if(!r)return null;var n=sa(e,r,"funcs","subfields");return n||null},ll=function(e,r,n){var i=kr(e,r);if(!i)return null;var o=i.args&&i.args[n]||null;return o||null},bf=function(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!r)return!1;var o=(i==null||(n=i.settings)===null||n===void 0?void 0:n.fieldSeparator)||".",s=ba(e,i),u=ba(r,i);return s.startsWith(u+o)},ba=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var i=(n==null||(r=n.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";return br(e,n).join(i)},br=function(e){var r,n,i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var s=(o==null||(r=o.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(s);if(e!=null&&(n=e.get)!==null&&n!==void 0&&n.call(e,"func")){var u;return e==null||(u=e.get)===null||u===void 0?void 0:u.call(e,"func").split(s)}return(e==null||(i=e.split)===null||i===void 0?void 0:i.call(e,s))||[]},E0=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var i=r.settings.fieldSeparator,o=br(e,r);return n?o:o.map(function(s,u,l){return l.slice(0,u+1)}).map(function(s){return s.join(i)})},cl=function(e){var r;if(typeof e=="string"||Array.isArray(e))return"field:".concat(ba(e));if(Ye(e)==="object"&&e){if(e._funcKey&&e._argKey)return"arg:".concat(ba(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(ba(e._funcKey));if(e.func&&e.arg)return"arg:".concat(ba(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(ba(e.func));if(e.type)return null}return e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")?e!=null&&e.get("arg")?"arg:".concat(ba(e.get("func")),"__").concat(e.get("arg")):"func:".concat(ba(e.get("func"))):null},dl=function(e,r,n){var i;return(i=e.__cache)===null||i===void 0||(i=i[r])===null||i===void 0?void 0:i[n]},fl=function(e,r,n,i){!e.__cache||!n||(e.__cache[r]||(e.__cache[r]={}),e.__cache[r][n]=i)},Of=function(e){var r;if(!e)return null;if(Ye(e)==="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},Ze=function(e,r){var n;if(!r)return null;if(Ye(r)=="object"){if(!r.func&&r.type&&r.widgets)return r;if(r._isFuncArg)return ll(e,r._funcKey,r._argKey);if(r._isFunc)return kr(e,r._funcKey);if(r.func)return r.func&&r.arg?ll(e,r.func,r.arg):kr(e,r.func)}if(r!=null&&(n=r.get)!==null&&n!==void 0&&n.call(r,"func"))return r!=null&&r.get("arg")?ll(e,r.get("func"),r.get("arg")):kr(e,r.get("func"));var i=sa(e,r);return i||null},Mt=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!r)return null;var i=e.operators[r];if(n){var o,s,u=cl(n),l=u?"".concat(u,"__").concat(r):null,c=dl(e,"getOperatorConfig",l);if(c)return c;var d=Ze(e,n),f=vr(e,n,r,null),p=e.widgets[f]||{},v=(d&&d.widgets?d.widgets[f]:{})||{},y=((o=p.opProps)===null||o===void 0?void 0:o[r])||{},m=((s=v.opProps)===null||s===void 0?void 0:s[r])||{},S=Gi(Gi(Gi({},i),y),m);return fl(e,"getOperatorConfig",l,S),S}else return i},rn=function(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(!r)return null;var l=Ze(e,r),c=cl(r);o||(o=vr(e,r,i,s));var d=c?"".concat(c,"__").concat(i,"__").concat(o,"__").concat(s):null,f=dl(e,"getFieldWidgetConfig",d);if(f)return f;var p=e.widgets[o]||{},v=(l==null||(n=l.widgets)===null||n===void 0?void 0:n[o])||{},y=v.widgetProps||{},m=s==="value"||!s?l?.fieldSettings:{},S=Gi(Gi(Gi(Gi({},p),v),y),m);return fl(e,"getFieldWidgetConfig",d,S),u.forExport&&(S=Nn(S,"factory")),S},Ff=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=e.settings.fieldSeparator,i=br(r,e),o=r?sa(e,r):e,s=o,u=null,l=[];do{var c,d=s===e?e.fields:(c=s)===null||c===void 0?void 0:c.subfields;if(!d||!Object.keys(d).length){s=u=null;break}u=Object.keys(d)[0],l.push(u),s=d[u]}while(s.type=="!struct"||s.type=="!group");return(i||[]).concat(l).join(n)};function pl(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=[],o=[];if(!e)return{widgets:i,valueSrcs:o};var s=cl(e),u=s?"".concat(s,"__").concat(r,"__").concat(n):null,l=dl(a,"_getWidgetsAndSrcsForFieldOp",u);if(l)return l;var c=Ye(e)==="object"&&(!!e.func&&!!e.arg||e._isFuncArg),d=Ze(a,e),f=r?a.operators[r]:null;if(d!=null&&d.widgets){var p=function(){var F=d.widgets[v];if(!a.widgets[v])return 1;var C=a.widgets[v].valueSrc||"value",w=!0;if(v==="field"&&(w=w&&Bi(a,["field"],d,r).length>0),v==="func"&&(w=w&&Bi(a,["func"],d,r).length>0),n==="value"&&!F.operators&&!c&&e!=="!case_value"&&(w=!1),F.operators&&r&&(w=w&&F.operators.indexOf(r)!=-1),n&&n!=C&&n!=="const"&&(w=!1),f&&f.cardinality==0&&C!=="value"&&(w=!1),w){var E,_;i.push(v);var A=((E=d.valueSources)===null||E===void 0?void 0:E.indexOf(C))!=-1;(f==null||(_=f.valueSources)===null||_===void 0?void 0:_.indexOf(C))==-1&&(A=!1),A&&!o.find(function(N){return N==C})&&o.push(C)}};for(var v in d.widgets)p()}var y=function(F){var C=0;return d.preferWidgets?d.preferWidgets.includes(F)&&(C+=10-d.preferWidgets.indexOf(F)):F==d.mainWidget&&(C+=100),F==="field"&&(C-=1),F==="func"&&(C-=2),C};i.sort(function(S,F){return y(F)-y(S)});var m={widgets:i,valueSrcs:o};return fl(a,"_getWidgetsAndSrcsForFieldOp",u,m),m}var Bi=function(e,r,n){var i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!n)return r;var s=(i=n.type)!==null&&i!==void 0?i:n.returnType;s==="!group"&&(s="number");var u=!1;if(o){var l=e.operators[o];l!=null&&l.valueTypes&&(s=l.valueTypes[0],u=!0)}return r||(r=Object.keys(e.settings.valueSourcesInfo)),r.filter(function(c){var d=!0;if(c==="field"&&e.__fieldsCntByType){var f=n._isFuncArg||u?0:1;d=d&&e.__fieldsCntByType[s]>f}return c==="func"&&(n.funcs&&(d=d&&n.funcs.length>0),e.__funcsCntByType&&(d=d&&e.__funcsCntByType[s]>0)),d})},vr=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=pl(e,r,n,i),s=o.widgets,u=null;return s.length&&(u=s[0]),u},Tf=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=pl(e,r,n,null),s=o.valueSrcs,u=Bi(e,s,i,n);return u},w0=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=pl(e,r,n,i),s=o.widgets;return s},Cf=function(e,r){var n;return((n=e.types[r])===null||n===void 0?void 0:n.operators)||null},vl=function(e,r){var n=Ze(e,r),i=n?n.operators:[];return i},Mc=function(e,r){var n,i=vl(e,r);return(n=i?.[0])!==null&&n!==void 0?n:null},Ef=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var i=n&&sa(r,n)||null,o=r.settings.fieldSeparator,s=br(e,r),u=bf(e,n,r),l=u?br(n,r):[];return s.slice(l.length).map(function(c,d,f){return f.slice(0,d+1)}).map(function(c){return{part:[].concat(Pe(l),Pe(c)).join(o),key:c[c.length-1]}}).map(function(c){var d=c.part,f=c.key,p=sa(r,d);return{key:f,cnf:p}}).map(function(c,d,f){var p=c.key,v=c.cnf,y=d>0?f[d-1].cnf:i;return[p,v,y]})},Ge=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return e.interpose("children1").withMutations(function(o){return o.skip(1),o.push.apply(o,n),o})},kc=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return e.interpose("children1").withMutations(function(o){return o.push.apply(o,n),o})},ui=function(e,r){var n=new be.OrderedMap(Se({},e.get("id"),e)),i=e;return r.forEach(function(o){var s,u;i=(s=n)===null||s===void 0?void 0:s.get(o),n=(u=i)===null||u===void 0?void 0:u.get("children1")}),i},Gc=function(e,r){var n=r.map(function(i,o){return r.take(o+1)}).reverse().toJS().map(function(i){return{item:ui(e,i),path:i}}).filter(function(i){var o=i.item;return o?.get("type")==="rule_group"});return n.length?n.map(function(i){var o=i.item,s=i.path;return{path:s,field:o.get("properties").get("field")}}):[]},wf=function(e){var r=e;function n(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=o.push(i.get("id")),l=i.getIn(["properties","isLocked"]);s&&l&&(r=r.deleteIn(Ge(u,"properties","isLocked")));var c=i.get("children1");c&&c.map(function(d,f){n(d,u,l||s)})}return n(e,new be.List),r},ua=function(e){var r=e;function n(i,o,s,u){if(i){var l=i.get("path"),c=i.get("id"),d=c||u||Qe(),f=o.push(d);(!l||!l.equals(f))&&(r=r.setIn(Ge(f,"path"),f)),c||(r=r.setIn(Ge(f,"id"),d));var p=i.get("children1");p&&(p.constructor.name==="Map"&&(r=r.setIn(Ge(f,"children1"),new be.OrderedMap(p))),p.map(function(v,y){n(v,f,s+1,y)}))}}return n(e,new be.List,0),r},gl=function(e){var r=e;function n(i,o,s,u){if(!i)return!1;var l=i.get("id")||u,c=o.push(l),d=i.get("children1");if(d){var f=d.map(function(p,v){return n(p,c,s+1,v)}).reduce(function(p,v){return p&&v},!0);if((d.size==0||f)&&s>0)return r=r.deleteIn(Ge(c)),!0}return!1}return n(e,new be.List,0),r},Bc=function(e,r){var n=[],i={},o=[],s=0,u=0,l=0,c=0,d={};function f(S,F,C,w,E,_,A,N,X){var H,W,J,Y=S===e,K=S.get("type"),ae=S.get("collapsed"),se=S.get("id"),re=S.get("children1"),ie=S.getIn(["properties","isLocked"]),ne=re?re.map(function(Rr,qt){return qt}).valueSeq().toArray():null,de=K==="rule_group",le=K==="rule",fe=K==="group",ve=K==="case_group",ye=!E&&(!re||de),we=ne?.length>0,xe=F.length?F[F.length-1]:null,Fe=Pe(F).reverse().find(function(Rr){return i[Rr].type=="rule_group"}),ze=S.getIn(["properties","field"]),_e=ze&&r&&Ze(r,ze),Oe=_e?_e?.canRegroup!==!1:void 0,Ve=_e?.maxNesting,ke=i==null||(H=i[Fe])===null||H===void 0?void 0:H.canRegroup,De=i==null||(W=i[Fe])===null||W===void 0?void 0:W.maxNesting,Ke=i==null||(J=i[Fe])===null||J===void 0?void 0:J.lev,$e=ve?se:N;ve&&(o.push(se),u=0,l=0,c=0,d={});var Je=$e?o.indexOf($e):null,ut=n.length,Xe=s,et;Y||(et={},et.caseNo=Je,et.globalNoByType=ve?Je:d[K]||0,et.indexPath=[].concat(Pe(F.slice(1).map(function(Rr){return i[Rr].childNo})),[X]),le?et.globalLeafNo=u:fe&&(et.globalGroupNo=c));var Jt=E||de?A:A+1;n.push(se),i[se]={node:S,index:ut,id:se,type:K,parent:xe,children:ne,childNo:X,caseId:$e,caseNo:Je,closestRuleGroupId:Fe,closestRuleGroupLev:Ke,closestRuleGroupMaxNesting:De,closestRuleGroupCanRegroup:ke,maxNesting:Ve,canRegroup:Oe,path:F.concat(se),lev:_,atomicLev:A,nextAtomicLev:Jt,isLeaf:!re,isAtomicRule:ye,isLocked:ie||w,top:C?null:Xe,isDefaultCase:ve?!re:void 0,atomicRulesCountInCase:ve?0:void 0,position:et,collapsed:ae,_top:ut,parentType:xe?i[xe].type:null,leaf:!re};var kt=0,Kt=0;C||(s+=1,kt+=1,we&&!ae&&!de&&(Kt+=1),!Y&&!ve&&(fe&&c++,ye&&l++,le&&u++,d[K]=(d[K]||0)+1)),N&&ye&&i[N].atomicRulesCountInCase++;var Ct=0,or=0;if(we){var er=0;re.map(function(Rr,qt){if(Rr){f(Rr,F.concat(se),C||ae,w||ie,E||de,_+1,Jt,$e,er);var an=i[qt];Ct=Math.max(Ct,an.depth||0),or+=an.height,er++}})}kt+=or,Kt+=Ct;var Lr=n.length,lr=Lr-ut,Or=C?null:Xe+kt;Object.assign(i[se],{depth:re?Kt:void 0,_height:lr,height:kt,bottom:Or})}f(e,[],!1,!1,!1,0,0,null,null);for(var p=0;p<n.length;p++){var v=p>0?n[p-1]:null,y=p<n.length-1?n[p+1]:null,m=i[n[p]];m.prev=v,m.next=y}return{flat:n,items:i,cases:o}},x0=function(e){if(!e)return-1;var r=0;function n(i,o,s){var u,l,c;typeof i.get=="function"?(u=i.get("id"),l=i.get("children1"),c=i.get("type")):(u=i.id,l=i.children1,c=i.type),r++,c=="rule_group"&&s>0||l&&l.map(function(d,f){d&&n(d,o.concat(u),s+1)})}return n(e,[],0),r-1},hl=function(e){if(!e)return-1;var r=0;function n(i,o,s){var u,l,c;typeof i.get=="function"?(u=i.get("id"),l=i.get("children1"),c=i.get("type")):(u=i.id,l=i.children1,c=i.type),c=="rule"||c=="rule_group"&&s>0?r++:l&&l.map(function(d,f){d&&n(d,o.concat(u),s+1)})}return n(e,[],0),r},xf=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=e;function o(s,u){r&&s.path&&delete s.path,r&&!n&&u&&delete s.id;var l=s.properties;l&&l.operatorOptions==null&&delete l.operatorOptions;var c=s.children1;if(c){for(var d in c)c[d]&&o(c[d],d);n&&(s.children1=Object.values(c))}}return o(e,null),i},Lf=function(e){var r=[],n=e.get("children1");return n&&n.map(function(i){var o=i.getIn(["properties","value"]),s;o&&o.size==1?(s=o.get(0),Array.isArray(s)&&s.length==0&&(s=null)):s=null,r=[].concat(Pe(r),[s])}),r},Uc=function(e){return!e.get("children1")||e.get("children1").size==0},$c=function(e,r){return e.getIn(Ge(r,"children1")).size>0},Wc=function(e){if(e!=null&&e.toJS){var r,n=e==null||(r=e.toJS)===null||r===void 0?void 0:r.call(e);return n!=null&&n.func?e.toOrderedMap():n}else return e};function Eo(a){var e=G(a,function(r,n,i){var o=i&&i.length>3&&i[i.length-1]==="value"&&i[i.length-3]==="args",s=i&&i.length>3&&i[i.length-1]==="value"&&i[i.length-2]==="properties",u;if(r=="properties"){u=n.toOrderedMap();for(var l=0;l<2;l++){var c,d;((c=u.get("value"))===null||c===void 0||(d=c.get)===null||d===void 0?void 0:d.call(c,l))===null&&(u=u.setIn(["value",l],void 0))}}else o?u=Wc(n):(i?s:r=="value")&&be.Iterable.isIndexed(n)?u=n.map(Wc).toList():r=="asyncListValues"?u=n.toJS():r=="children1"&&be.Iterable.isIndexed(n)?u=new be.OrderedMap(n.map(function(f){return[f?.get("id")||Qe(),f]})):u=be.Iterable.isIndexed(n)?n.toList():n.toOrderedMap();return u});return e}var li=function(e){return ci(e)},Gs=function(e,r,n){var i=r?Mt(e,r,n):null;return i&&i.options?new be.Map(i.options&&i.options.defaults||{}):null},ci=function(e){var r,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;i=Ze(e,i);var o=((r=i)===null||r===void 0?void 0:r.conjunctions)||Object.keys(e.conjunctions);return o.length==1?o[0]:((n=i)===null||n===void 0?void 0:n.defaultConjunction)||e.settings.defaultConjunction||e.settings.defaultGroupConjunction||o[0]},di=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new be.Map({conjunction:ci(e,r),not:!1})},Rf=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=e.settings.defaultField,o=(n?jf(e,n):i)||r&&Ff(e,n)||null;return o!=null&&typeof o!="string"&&!Co(o)&&(o=Eo(o)),o},jf=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!n)return null;var i=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",o=Ze(e,n),s=o?.defaultField;return s&&(s=[].concat(Pe(br(n)),[s]).join(i)),s},zc=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n&&((r=e.settings.fieldSources)===null||r===void 0?void 0:r[0])||"field"},Kc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Ze(e,r),o=i?.operators||[],s=e.settings.defaultOperator;s&&!o.includes(s)&&(s=null);var u=i?.defaultOperator,l=i?.ownDefaultOperator,c=n?Mc(e,r):null,d=l||s||u||c;return d},L0=function(e){return sl(e)?e:If([e])},If=function(e){return sl(e)?e:new be.List(e)},R0=function(){return new be.Map},j0=b(68090),ml=b.n(j0),Af=function(e,r,n){var i=null;if(e){if(r==="field"){var o=Ze(n,e);o&&(i=o.type)}else if(r==="func"){var s=e.get("func");if(s){var u=kr(n,s);u&&(i=u.returnType||u.type)}}}return i},I0=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Bs(e,r,n,"funcs","subfields")},Bs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var s=r.settings.fieldSeparator,u=br(e,r),l=br(n,r),c=u.slice(l.length).map(function(d,f,p){return p.slice(0,f+1)}).map(function(d){return[].concat(Pe(l),Pe(d)).join(s)}).map(function(d){var f=sa(r,d,i,o);return f&&f.label||ml()(d.split(s))}).filter(function(d){return d!=null});return c},A0=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,u=rn(e,r,n,null,o)||{},l=Mt(e,n,r)||{},c=s?1:l.cardinality,d=null;if(c>1){var f=u.valueLabels||l.valueLabels;f&&(d=f[i]),d&&Ye(d)!=="object"&&(d={label:d,placeholder:d}),d||(d={label:e.settings.valueLabel+" "+(i+1),placeholder:e.settings.valuePlaceholder+" "+(i+1)})}else{var p=u.valueLabel,v=u.valuePlaceholder;d={label:p||e.settings.valueLabel,placeholder:v||e.settings.valuePlaceholder}}return d},Ga=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var s=Ze(r,e)||{},u=r.settings.fieldSeparator,l=br(e,r),c=Array.isArray(e)?e.join(u):e;if(o!=null&&o.useTableName&&s.tableName){var d=Pe(l);d[0]=s.tableName,c=d.join(u)}if(s.fieldName&&(c=s.fieldName),i){var f=Ze(r,i)||{},p=i;c.indexOf(p+u)==0?c=c.slice((p+u).length):s.fieldName||n.errors.push("Can't cut group ".concat(p," from field ").concat(c))}return c}},qc=function(e,r){var n=e.get("type"),i=e.getIn(["properties","mode"]);return n=="rule_group"&&i=="array"?_0(e,r):n=="group"||n=="rule_group"?D0(e,r):P0(e,r)},_0=function(e,r){var n=e.get("children1"),i=e.get("properties");return _f(i.toObject(),n,r)},_f=function(e,r,n){var i,o,s=e.operator,u=(i=(o=n.operators[s])===null||o===void 0?void 0:o.cardinality)!==null&&i!==void 0?i:1,l=u==0,c={group:!Qc(e,n),children:!Hc(r,n)},d=c.group&&(l?c.children:!0);return!d},D0=function(e,r){var n=e.get("children1");return Hc(n,r)},Hc=function(e,r){var n=e?.size>0&&e.filter(function(i){return!qc(i,r)}).size>0;return!n},P0=function(e,r){var n=e.get("properties");return Qc(n?.toObject()||{},r)},Qc=function(e,r){var n=!0,i=3,o=Jc(e,r,n),s=o.score>=i;return!s},Jc=function(e,r){var n,i,o,s=e.field,u=e.fieldSrc,l=e.fieldType,c=e.operator,d=e.value,f=e.valueSrc,p=e.valueType,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,y=(n=(i=r.operators[c])===null||i===void 0?void 0:i.cardinality)!==null&&n!==void 0?n:1,m=f!=null&&f.get?f.toJS():f,S={parts:{},score:0};if(S.parts.field=v?s!=null:Us(s,u,r),S.parts.operator=!!c,S.parts.value=(d==null||(o=d.filter(function(C,w){return Us(C,m?.[w],r,v)}))===null||o===void 0?void 0:o.size)>=(v?Math.min(y,1):y),S.score=Object.keys(S.parts).filter(function(C){return!!S.parts[C]}).length,v&&S.score<3){var F=!0;!S.parts.value&&u==="func"&&Us(s,u,r,!1,F)&&S.score++,S.parts.field||d?.map(function(C,w){m?.[w]==="func"&&Us(C,m?.[w],r,!1,F)&&S.score++})}return S},Us=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;if(!i&&r=="func"&&e){var s,u=(s=e.get)===null||s===void 0?void 0:s.call(e,"func"),l=kr(n,u);if(l){var c=e.get("args");for(var d in l.args){var f=l.args[d],p=c?c.get(d):void 0,v=p?p.get("value"):void 0,y=p?p.get("valueSrc"):void 0;if(v==null&&f?.defaultValue===void 0&&!(f!=null&&f.isOptional)||v!=null&&!Us(v,y,n,o?i:!0))return!1}return!0}}return e!=null},Ui=function(e,r,n){return r=="func"?Df(e,n):e},Df=function(e,r){if(e){var n=e.get("func"),i=n&&kr(r,n);if(i){var o=e,s=!1;for(var u in i.args){var l=i.args[u],c=l.valueSources,d=l.isOptional,f=l.defaultValue,p=Bi(r,c,l),v=o.get("args"),y=p.length==1?p[0]:void 0,m=v?v.get(u):void 0,S=m?m.get("value"):void 0,F=(m?m.get("valueSrc"):void 0)||y;if(S!==void 0){var C=Ui(S,F,r);if(C===void 0||(C!==S&&(o=o.setIn(["args",u,"value"],C)),s))return}else if(f!==void 0&&!Xr(f))o=o.setIn(["args",u,"value"],Sl(l)),o=o.setIn(["args",u,"valueSrc"],"value");else if(d)s=!0;else return}return o}}},yl=function(e){var r=e.get("children1");if(r?.size==1){var n=r.first(),i=n.get("type");return i==="group"?yl(n):n}return null},Sl=function(e){var r=e.defaultValue;return Xr(r)&&!be.Map.isMap(r)&&r.func?be.fromJS(r,function(n,i){return be.Iterable.isIndexed(i)?i.toList():i.toOrderedMap()}):r},bl=function(e,r,n,i,o){if(e&&e.get("func")){e=e.setIn(["args",r,"value"],n);var s=e.getIn(["args",r,"valueSrc"]),u=i.valueSources,l=Bi(o,u,i),c=l.length==1?l[0]:void 0;!c&&l.includes("value")&&(c="value"),!s&&c&&(e=e.setIn(["args",r,"valueSrc"],c))}return e},Yc=function(e,r,n){if(n)for(var i in n.args)r=$s(e,r,n,i);return r},$s=function(e,r,n,i){var o=n.args[i],s=o.valueSources,u=o.defaultValue,l=Bi(e,s,o),c=l.length?l[0]:void 0,d=u?Xr(u)&&u.func?"func":"value":void 0,f=d||c,p=r.getIn(["args",i]);return p||(u!==void 0&&(r=r.setIn(["args",i,"value"],Sl(o))),f&&(r=r.setIn(["args",i,"valueSrc"],f))),r};function Pf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Nf(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Pf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var N0=function(e,r){var n={usedFields:[]},i=Vf(e,r,n);if(i)return Nf(Nf({},i),n)},Vf=function(e,r,n){if(e){var i=e.get("type"),o=e.get("children1");if((i==="group"||i==="rule_group")&&o&&o.size)return V0(e,r,n);if(i==="rule")return M0(e,r,n)}},V0=function(e,r,n){var i=e.get("properties")||new Wt,o=e.get("children1"),s=e.get("id"),u=o.map(function(f){return Vf(f,r,n)}).filter(function(f){return typeof f<"u"});if(u.size){var l=i.get("conjunction");l||(l=li(r));var c=i.get("not"),d={id:s,rules:u.toList(),condition:l.toUpperCase(),not:c};return d}},M0=function(e,r,n){var i,o=e.get("properties")||new Wt,s=e.get("id"),u=o.get("operator"),l=o.get("operatorOptions"),c=o.get("field"),d=o.get("value"),f=o.get("valueSrc"),p=o.get("valueType"),v=d.filter(function(W){return W===void 0}).size>0;if(!(c==null||u==null||v)){var y=Ze(r,c)||{},m=Mt(r,u,c)||{},S=y.type||"undefined",F=Mr(m),C=r.types[y.type]||{},w=Ga(c,r,n);if(!(d.size<F)){n.usedFields.indexOf(c)==-1&&n.usedFields.push(c),d=d.toArray(),f=f.toArray(),p=((i=p)===null||i===void 0?void 0:i.toArray())||[];for(var E=[],_=0;_<d.length;_++){var A={type:p[_],value:d[_]};if(E.push(A),f[_]=="field"){var N=d[_];n.usedFields.indexOf(N)==-1&&n.usedFields.push(N)}}var X=l?l.toJS():null;X&&!Object.keys(X).length&&(X=null);var H={id:s,fieldName:w,type:S,input:C.mainWidget,operator:u};return X&&(H.operatorOptions=X),H.values=E,H}}},k0=b(6924),G0=b.n(k0),Mf={reverseOperatorsForNot:!1,canShortMongoQuery:!0,fixJsonLogicDateCompareOp:!1,formatField:function(e,r,n,i,o,s){return s?n:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultConjunction:"AND",defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",addSubGroupLabel:"Add sub group",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null,loadMoreLabel:"Load more...",loadingMoreLabel:"Loading more...",typeToSearchLabel:"Type to search",loadingLabel:"Loading...",notFoundLabel:"Not found"},B0=b(55364),U0=b.n(B0),$0=b(18678),Ol=b.n($0);function kf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Gf(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):kf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Bf(a,e){return Ol().apply(a,e)}function Uf(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ol();return r.add_operation(a,e)}var Ws={CALL:function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return e.call.apply(e,[r].concat(i))},JSX:function(e,r){return{type:e,props:r}},mergeObjects:function(e,r){return Gf(Gf({},e),r)},fromEntries:function(e){return Object.fromEntries(e)},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()},strlen:function(e){return e?.length||0},regexTest:function(e,r,n){return e?.match(new RegExp(r,n))!=null},"date==":function(e,r){if(e==null||r==null)return!1;var n=Rt()(e).startOf("day"),i=Rt()(r).startOf("day");return n.isSame(i)},"date!=":function(e,r){return!Ws["date=="](e,r)},"datetime==":function(e,r){if(e==null||r==null)return!1;var n=Rt()(e),i=Rt()(r);return n.isSame(i)},"datetime!=":function(e,r){return!Ws["datetime=="](e,r)},now:function(){return new Date},today:function(){var e=Rt()().startOf("day"),r=e.year(),n=e.month(),i=e.date(),o=Rt().utc([r,n,i]);return o.toDate()},start_of_today:function(){return Rt()().startOf("day").toDate()},date_add:function(e,r,n){return Rt()(e).add(r,n).toDate()},datetime_add:function(e,r,n){return Rt()(e).add(r,n).toDate()},datetime_truncate:function(e,r){return Rt()(e).startOf(r).toDate()}};function $f(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ol();for(var e in Ws)Uf(e,Ws[e],a)}var W0=function(e){if(e&&Array.isArray(e)&&e.length)return e.map(function(r){var n;return(n=r?.value)!==null&&n!==void 0?n:r}).filter(function(r){return r!=null})},z0=function(e){if(e!=null){var r=[],n=Array.isArray(e)?e:[e],i=n.filter(function(o){return o!=null}).map(function(o){return{type:"property",value:e}});if(r.length)throw new Error(r.join(`
`));return i}};function Wf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Ba(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Wf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var zf={day:"day",week:"week",month:"month",year:"year"},K0="day",Xc=Ba({hour:"hour",minute:"minute",second:"second"},zf),Kf="day",q0={label:"Now",returnType:"datetime",jsonLogicCustomOps:{now:{}},jsonLogic:function(){return{now:[]}},jsonLogicImport:function(e){if(e.now)return[]},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},sqlFunc:"NOW",mongoFormatFunc:function(){return{$toDate:"$$NOW"}},formatFunc:function(){return"NOW"}},H0={label:"Today",returnType:"date",jsonLogicCustomOps:{today:{}},jsonLogic:function(){return{today:[]}},jsonLogicImport:function(e){if(e.today)return[]},spelFunc:"T(java.time.LocalDate).now()",sqlFormatFunc:function(){return"CURDATE()"},sqlFunc:"CURDATE",mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"TODAY"}},Q0={label:"Start of today",returnType:"datetime",jsonLogicCustomOps:{start_of_today:{}},jsonLogic:function(){return{start_of_today:[]}},jsonLogicImport:function(e){if(e.start_of_today)return[]},spelFunc:"T(java.time.LocalDateTime).now().truncatedTo(T(java.time.temporal.ChronoUnit).DAYS)",spelImport:function(e){var r,n,i,o,s=e.obj,u=e.args,l=e?.type==="!func"&&e?.methodName==="truncatedTo",c=s?.methodName==="now"&&(s==null||(r=s.obj)===null||r===void 0||(r=r.cls)===null||r===void 0?void 0:r.join("."))==="java.time.LocalDateTime",d=u?.length||0,f=u?.[0],p=f==null||(n=f.children)===null||n===void 0?void 0:n[0],v=f==null||(i=f.children)===null||i===void 0?void 0:i[1],y=p?.type==="!type"&&(p==null||(o=p.cls)===null||o===void 0?void 0:o.join(".")),m=v?.type==="property"&&v?.val,S=d===1&&f.type==="compound"&&y==="java.time.temporal.ChronoUnit"&&m==="DAYS";if(c&&l&&S)return{}},sqlFormatFunc:function(){return"DATE_FORMAT(NOW(), '%Y-%m-%d 00:00:00')"},sqlImport:function(e,r,n){var i;if(e?.func==="DATE_FORMAT"&&((i=e.children)===null||i===void 0?void 0:i.length)===2){var o=Ce(e.children,2),s=o[0],u=o[1];if(u?.value=="%Y-%m-%d 00:00:00"&&s?.func=="NOW")return{args:{}}}},mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"START_OF_TODAY"}},J0={label:"Truncate",returnType:"datetime",renderBrackets:["",""],renderSeps:["to"],jsonLogicCustomOps:{datetime_truncate:{}},jsonLogic:function(e){var r=e.date,n=e.dim;return{datetime_truncate:[r,n]}},jsonLogicImport:function(e){if(e.datetime_truncate){var r=e.datetime_truncate[0],n=e.datetime_truncate[1];return[r,n]}},spelFormatFunc:function(e){var r=e.date,n=e.dim,i=(n.charAt(0).toUpperCase()+n.slice(1)+"s").toUpperCase();return"".concat(r,".truncatedTo(T(java.time.temporal.ChronoUnit).").concat(i,")")},spelImport:function(e){var r,n,i,o=e.args,s=e?.type==="!func"&&e?.methodName==="truncatedTo",u=o?.length||0,l=o?.[0],c=l==null||(r=l.children)===null||r===void 0?void 0:r[0],d=l==null||(n=l.children)===null||n===void 0?void 0:n[1],f=c?.type==="!type"&&(c==null||(i=c.cls)===null||i===void 0?void 0:i.join(".")),p=d?.type==="property"&&d?.val,v=u===1&&l.type==="compound"&&f==="java.time.temporal.ChronoUnit"&&p,y=p.toLowerCase().substring(0,p.length-1);if(s&&v)return{date:e.obj,dim:{type:"string",val:y}}},sqlFormatFunc:function(e,r){var n=e.date,i=e.dim;if(!r||r==="MySQL")switch(i=i.replace(/^'|'$/g,""),i){case"second":return"DATE_FORMAT(".concat(n,", '%Y-%m-%d %H:%i:%s')");case"minute":return"DATE_FORMAT(".concat(n,", '%Y-%m-%d %H:%i:00')");case"hour":return"DATE_FORMAT(".concat(n,", '%Y-%m-%d %H:00:00')");case"day":return"DATE_FORMAT(".concat(n,", '%Y-%m-%d 00:00:00')");case"week":return"DATE_SUB(DATE_FORMAT(".concat(n,", '%Y-%m-%d 00:00:00'), INTERVAL WEEKDAY(").concat(n,") DAY)");case"month":return"DATE_FORMAT(".concat(n,", '%Y-%m-01 00:00:00')");case"year":return"DATE_FORMAT(".concat(n,", '%Y-01-01 00:00:00')")}else if(r==="PostgreSQL")return"date_trunc(".concat(i,", ").concat(n,")")},sqlImport:function(e,r,n){if(!n||n==="MySQL"){var i,o;if(e?.func==="DATE_FORMAT"&&((i=e.children)===null||i===void 0?void 0:i.length)===2){var s=Ce(e.children,2),u=s[0],l=s[1],c;switch(l?.value){case"%Y-%m-%d %H:%i:%s":c="second";break;case"%Y-%m-%d %H:%i:00":c="minute";break;case"%Y-%m-%d %H:00:00":c="hour";break;case"%Y-%m-%d 00:00:00":c="day";break;case"%Y-%m-01 00:00:00":c="month";break;case"%Y-01-01 00:00:00":c="year"}if(c)return{args:{date:u,dim:c}}}else if(e?.func==="DATE_SUB"&&((o=e.children)===null||o===void 0?void 0:o.length)===2){var d,f=Ce(e.children,2),p=f[0],v=f[1],y=p?.func==="DATE_FORMAT"&&((d=p.children)===null||d===void 0?void 0:d.length)===2,m=v._type=="interval"&&v.unit==="day";if(y&&m){var S=Ce(p.children,2),F=S[0],C=S[1];if(C?.value==="%Y-%m-%d 00:00:00")return{args:{date:F,dim:"week"}}}}return}else if(n==="PostgreSQL"){var w;if(e?.func==="date_trunc"&&((w=e.children)===null||w===void 0?void 0:w.length)===2){var E=Ce(e.children,2),_=E[0],A=E[1];return{args:{date:A,dim:_.value}}}}},mongoFormatFunc:function(e){var r=e.date,n=e.dim;return{$dateTrunc:{date:r,unit:n}}},formatFunc:function(e){var r=e.date,n=e.dim;return"TRUNCATE ".concat(r," TO ").concat(n)},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},dim:{label:"Dimension",type:"select",defaultValue:Kf,valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:Xc},escapeForFormat:!1}}},wo={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim,s=o.charAt(0).toUpperCase()+o.slice(1)+"s",u=n+s;return"".concat(r,".").concat(u,"(").concat(i,")")},spelImport:function(e){var r,n,i,o,s,u=(r=e.methodName)===null||r===void 0?void 0:r.match(/^(minus|plus)(\w+)s$/);if(u&&(s=u[2].toLowerCase(),i=u[1],["minus","plus"].includes(i)&&Object.keys(Xc).includes(s)))return i={type:"string",val:i},s={type:"string",val:s},o=e.args[0],n=e.obj,{date:n,op:i,val:o,dim:s}},jsonLogic:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim;return{datetime_add:[r,i*(n=="minus"?-1:1),o]}},jsonLogicImport:function(e){if(e.datetime_add){var r=e.datetime_add[0],n=Math.abs(e.datetime_add[1]),i=e.datetime_add[1]>=0?"plus":"minus",o=e.datetime_add[2];return[r,i,n,o]}},jsonLogicCustomOps:{datetime_add:{}},sqlFormatFunc:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim;return"DATE_ADD(".concat(r,", INTERVAL ").concat(parseInt(i)*(n=="minus"?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},sqlImport:function(e,r,n){var i;if(["DATE_ADD","DATE_SUB"].includes(e?.func)&&((i=e.children)===null||i===void 0?void 0:i.length)===2){var o=Ce(e.children,2),s=o[0],u=o[1];if(u._type=="interval")return{args:{date:s,op:e?.func==="DATE_ADD"?"plus":"minus",val:u.value,dim:u.unit}}}},mongoFormatFunc:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim;return{$dateAdd:{startDate:r,unit:o,amount:i*(n=="minus"?-1:1)}}},formatFunc:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim;return i?"".concat(r," ").concat(n=="minus"?"-":"+"," ").concat(i," ").concat(o):r},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},escapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],escapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:Kf,valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:Xc},escapeForFormat:!1}}},Y0=Ba(Ba({},wo),{},{label:"Relative",returnType:"date",jsonLogic:function(e){var r=e.date,n=e.op,i=e.val,o=e.dim;return{date_add:[r,i*(n=="minus"?-1:1),o]}},jsonLogicImport:function(e){var r=e.date_add[0],n=Math.abs(e.date_add[1]),i=e.date_add[1]>=0?"plus":"minus",o=e.date_add[2];return[r,i,n,o]},jsonLogicCustomOps:{date_add:{}},args:{date:Ba(Ba({},wo.args.date),{},{label:"Date",type:"date",defaultValue:{func:"TODAY",args:[]}}),op:Ba({},wo.args.op),val:Ba({},wo.args.val),dim:Ba(Ba({},wo.args.dim),{},{defaultValue:K0,fieldSettings:{listValues:zf}})}}),X0={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",sqlFunc:"LOWER",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Z0={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",sqlFunc:"UPPER",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},eS={label:"Linear regression",returnType:"number",formatFunc:function(e,r){var n=e.coef,i=e.bias,o=e.val;return"(".concat(n," * ").concat(o," + ").concat(i,")")},sqlFormatFunc:function(e){var r=e.coef,n=e.bias,i=e.val;return"(".concat(r," * ").concat(i," + ").concat(n,")")},spelFormatFunc:function(e){var r=e.coef,n=e.bias,i=e.val;return"(".concat(r," * ").concat(i," + ").concat(n,")")},spelImport:function(e){var r,n,i,o;if(e.type==="op-plus"){var s=Ce(e.children,2);if(o=s[0],i=s[1],o.type==="op-multiply"){var u=Ce(o.children,2);return r=u[0],n=u[1],{coef:r,val:n,bias:i}}}},sqlImport:function(e,r,n){var i;if(["+"].includes(e?.operator)&&((i=e.children)===null||i===void 0?void 0:i.length)===2){var o,s=Ce(e.children,2),u=s[0],l=s[1];if(["*"].includes(u?.operator)&&((o=u.children)===null||o===void 0?void 0:o.length)===2){var c=Ce(u.children,2),d=c[0],f=c[1];return{args:{coef:d,val:f,bias:l}}}}},mongoFormatFunc:function(e){var r=e.coef,n=e.bias,i=e.val;return{$sum:[{$multiply:[r,i]},n]}},jsonLogic:function(e){var r=e.coef,n=e.bias,i=e.val;return{"+":[{"*":[r,i]},n]}},jsonLogicImport:function(e){var r=e["+"][0]["*"][0],n=e["+"][0]["*"][1],i=e["+"][1];return[r,n,i]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}};function Zc(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=tS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function tS(a,e){if(a){if(typeof a=="string")return qf(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qf(a,e):void 0}}function qf(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function Hf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function pn(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hf(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Hf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}$f();function Qf(a,e,r){var n;try{n=Ol().apply(a,e)}catch(i){throw i.message="".concat(r.join(".")," :: ").concat(i.message),i}return n}function Jf(a,e,r,n){var i;try{i=e.call.apply(e,[a].concat(Pe(r)))}catch(o){throw o.message="".concat(n.join(".")," :: ").concat(o.message),o}return i}var zs={asyncFetch:{type:"f",args:["searchOrValues","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},ed=pn(pn({},zs),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef","sqlDialect"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},sqlImport:{type:"f",args:["sqlObj","wgtDef","sqlDialect"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val","wgtDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Yf={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef","expectedType","settings"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},rS={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},Xf={widgetProps:ed,opProps:Yf},nS={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs","sqlDialect"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},Zf=pn(pn({},zs),{},{fieldSettings:zs}),ep=pn(pn({},zs),{},{fieldSettings:zs,widgets:{x:Xf},mainWidgetProps:ed}),aS={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:ep,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},iS={fields:{x:ep},widgets:{x:ed},conjunctions:{x:rS},operators:{x:Yf},types:{x:{widgets:{x:Xf}}},funcs:{x:pn(pn(pn({},Zf),nS),{},{args:{x:pn({},Zf)}})},settings:aS},tp=function(e,r){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var n=ya()(e,Sa);delete n.ctx;var i=function(d,f,p,v){if(Xr(d)){if(Ns(d)&&(d=Ps(d)),p[0]==="funcs"&&!f){var y=p[p.length-1];f=sa({funcs:v.BasicFuncs},y,"funcs","subfields")||void 0,f&&(d.$$key=y)}if(f!==void 0&&Xr(f))for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&(!Object.keys(d).includes(m)||d[m]===void 0&&f[m]!==void 0?d[m]="$$deleted":(d[m]=i(d[m],f[m],[].concat(Pe(p),[m]),v),d[m]===void 0&&delete d[m]));for(var S in d)if(Object.prototype.hasOwnProperty.call(d,S)){if(!f||!Object.keys(f).includes(S)){var F;d[S]=i(d[S],(F=f)===null||F===void 0?void 0:F[S],[].concat(Pe(p),[S]),v)}d[S]===void 0&&delete d[S]}Object.keys(d).length===0&&(d=void 0)}else Array.isArray(d)&&d.forEach(function(C,w){d[w]=i(d[w],void 0,[].concat(Pe(p),[w]),v)});if(!(f!==void 0&&Ds(d,f,!0))){if(typeof d=="function")throw new Error("compressConfig: function at ".concat(p.join(".")," should be converted to JsonLogic"));return d}},o=Zc(Sa),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;if(u!=="ctx")if(u==="fields")n[u]=Gt()(n[u]),i(n[u],{},[u]);else if(u==="funcs"){n[u]=Gt()(n[u]||{});for(var l in n[u])i(n[u][l],null,[u,l],{BasicFuncs:z})}else n[u]=Gt()(n[u]),i(n[u],r[u],[u])}}catch(c){o.e(c)}finally{o.f()}return n},rp=function(e,r,n){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");var i={},o=function(f,p,v){if(Xr(p)){Xr(f)||(f={});for(var y in p)Ic(p,y)&&(p[y]==="$$deleted"?delete f[y]:f[y]=o(f[y],p[y],[].concat(Pe(v),[y])))}else Array.isArray(p)?f=Gt()(p):f=p;return f},s=function(f,p,v){var y=!1;if(Xr(f)&&Object.prototype.hasOwnProperty.call(f,"$$key")&&f.$$key){var m=sa({funcs:v.BasicFuncs},f.$$key,"funcs","subfields");if(m)delete f.$$key,f=o(Gt()(m),f,p),y=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(f.$$key," at ").concat(p.join(".")))}if(!y){if(Xr(f))for(var S in f)Object.prototype.hasOwnProperty.call(f,S)&&(f[S]=s(f[S],[].concat(Pe(p),[S]),v));else if(Array.isArray(f)){var F=Zc(f),C;try{for(F.s();!(C=F.n()).done;){var w=C.value;f[w]=s(f[w],[].concat(Pe(p),[w]),v)}}catch(E){F.e(E)}finally{F.f()}}}return f},u=Zc(Sa),l;try{for(u.s();!(l=u.n()).done;){var c=l.value;c==="ctx"?i[c]=U0()({},r.ctx||{},n||{}):c==="funcs"?(i[c]=Gt()(e[c]||{}),s(i[c],[c],{BasicFuncs:z})):c==="fields"?i[c]=Gt()(e[c]||{}):(i[c]=Gt()(r[c]||{}),o(i[c],e[c]||{},[c]))}}catch(d){u.e(d)}finally{u.f()}return i},np=function(e){if(e.__compliled)return e;e=Gt()(e);var r={ctx:e.ctx},n=[];return Fl(e,e,r,iS,n),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function Fl(a,e,r,n,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var s=!o.length;for(var u in n){var l=n[u],c=u==="x"?o:[].concat(Pe(o),[u]);if(l.type==="r"){var d=e,f=d[u];if(l.isArr)for(var p in f){var v=xo(f[p],r,[].concat(Pe(c),[p]));v!==f[p]&&(i.push("Compiled ".concat(c.join("."),"[").concat(p,"]")),f[p]=v)}else{var y=xo(f,r,c,void 0);y!==f&&(i.push("Compiled R ".concat(c.join("."))),d[u]=y)}}else if(l.type==="rf"){var m=e,S=m[u],F=oS(S,r,c,l.ignore);F!==S&&(i.push("Compiled JL-RF ".concat(c.join("."))),m[u]=F)}else if(l.type==="f"){var C=e,w=C[u],E=sS(w,r,c,l.args,l.ignore);if(l.invokeWith&&E&&typeof E=="function"){var _;E=(_=E).call.apply(_,[null].concat(Pe(l.invokeWith)))}E!==w&&(i.push("Compiled JL-F ".concat(c.join("."))),C[u]=E)}else if(u==="x")for(var A in e){c=[].concat(Pe(o),[A]);var N=e[A];Fl(a,N,r,l,i,c),N.subfields&&Fl(a,N.subfields,r,n,i,c)}else{var X=e[u];Fl(a,X,r,l,i,c)}}}}function oS(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return On(a)?function(i,o){o=o||e?.ctx;var s={props:i,ctx:o},u=Qf(a,s,r);typeof u=="string"&&(u={type:u,props:i});var l=xo(u,{ctx:o},r);return l}:typeof a=="string"?function(i,o){o=o||e?.ctx;var s=a.split(".").reduce(function(c,d){return c?.[d]},o);if(s)return Jf(this,s,[i,o],r);var u={type:a,props:i},l=xo(u,{ctx:o},r);return l}:a}function sS(a,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return On(a)&&i!=="jl"?function(){for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];var l=this||e?.ctx,c=(n||[]).reduce(function(f,p,v){return pn(pn({},f),{},Se({},p,s[v]))},{args:s,ctx:l}),d=Qf(a,c,r);return d}.bind(e?.ctx):typeof a=="string"&&i!=="string"?function(){var o=this||e?.ctx,s=a.split(".").reduce(function(d,f){return d?.[f]},o);if(s){for(var u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];return Jf(this,s,l,r)}else throw new Error("".concat(r.join(".")," :: Function ").concat(a," is not found in ctx"))}.bind(e?.ctx):a}function uS(a,e){var r;return(e==null||(r=e.components)===null||r===void 0?void 0:r[a])||e.W[a]||e.O[a]}function xo(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(_c(a)){var i,o=a.type,s=a.props;if(typeof o!="string")throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var u=uS(o,e.ctx)||o.toLowerCase(),l;n!==void 0&&(s=pn(pn({},s),{},{key:n})),(i=s)!==null&&i!==void 0&&i.children&&(l=xo(s.children,e,r),s=pn(pn({},s),{},{children:l}));var c=e.ctx.RCE(u,s);return c}else if(a instanceof Array)return a.map(function(d,f){return xo(d,e,r,""+f)});return a}function td(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=lS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function lS(a,e){if(a){if(typeof a=="string")return ap(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ap(a,e):void 0}}function ap(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function ip(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function cS(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ip(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):ip(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var dS=0,op=0,Lo,Tl={},sp=function(e,r){return Sa.map(function(n){return e[n]===r[n]}).filter(function(n){return!n}).length===0},up=function(e){return Lo||(Lo=cp({reactIndex:void 0,maxSize:3,canCompile:void 0,extendConfig:e})),Lo},lp=function(e,r){var n;for(var i in Tl){var o=Tl[i].findExtendedConfig(e,r);if(o){n=o;break}}return n},cp=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0,extendConfig:void 0},r=new Map,n=e.maxSize||2,i=++dS,o,s=!0,u=function(S){return ya()(S,Sa)},l=function(S){var F=e.extendConfig(S,++op,e.canCompile);return d(S,F),F},c=function(){return r.size},d=function(S,F){r.size+1>n&&r.delete(r.keys().next().value),r.set(cS({},S),F)},f=function(S){var F=td(r.keys()),C;try{for(F.s();!(C=F.n()).done;){var w=C.value,E=r.get(w),_=sp(E,S);if(_)return w}}catch(A){F.e(A)}finally{F.f()}return S},p=function(S,F){var C=td(r.keys()),w;try{var E=function(){var J=w.value,Y=Sa.filter(function(ae){return J[ae]===S[ae]}),K=Y.length===Sa.length&&(F?J.__compliled:!0);if(K)return{v:r.get(J)}},_;for(C.s();!(w=C.n()).done;)if(_=E(),_)return _.v}catch(W){C.e(W)}finally{C.f()}var A=td(r.values()),N;try{var X=function(){var J=N.value,Y=Sa.filter(function(ae){return J[ae]===S[ae]}),K=Y.length===Sa.length&&(F?J.__compliled:!0);if(K)return{v:J}},H;for(A.s();!(N=A.n()).done;)if(H=X(),H)return H.v}catch(W){A.e(W)}finally{A.f()}return null},v=function(S){return p(S)||l(S)},y=function(){s=!1,r.clear(),delete Tl[i],Lo===o&&(Lo=void 0)};return o={getExtendedConfig:function(S){return v(u(S))},findExtendedConfig:p,getBasicConfig:f,clearConfigMemo:y,configId:op,storeConfigPair:d,getSize:c,configStore:r,memoId:i,meta:e},e.reactIndex===void 0&&(Lo=o),Tl[i]=o,o};function rd(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=fS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function fS(a,e){if(a){if(typeof a=="string")return dp(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dp(a,e):void 0}}function dp(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function fp(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function nn(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fp(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):fp(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var pS=["customProps"],vS=["options"],Vn=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(n=n&&e.settings.useConfigCompress,e.__configId)return e;var i=lp(e,n);if(i)return i;var o=e;n?e.__compliled?e=Gt()(e):e=np(e):e=Gt()(e),e.settings=G0()({},Mf,e.settings,pf),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},gS(e.types,e),pp(e.fields,e),vp(e.funcs,e);var s=e.settings.caseValueField;s&&Cl(s,e,[],!1,!0);var u=e.settings.locale.moment;u&&Rt().locale(u),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:r||Qe()}),e.__cache={},Dc(e);var l=up(Vn);return l.storeConfigPair(o,e),e};function gS(a,e){for(var r in a){var n=a[r];hS(r,n,e)}}function hS(a,e,r){var n=null,i=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(v){return v!="field"&&v!="func"})[0];var o=e.excludeOperators||[];for(var s in e.widgets){var u=e.widgets[s],l=u.defaultOperator;if(u.operators){var c=u.operators.filter(function(v){return!o.includes(v)});n=Vs(n,c)}l&&!o.includes(l)&&(!i||s===e.mainWidget)&&(i=l),s==e.mainWidget&&(u.widgetProps=nn(nn({},e.mainWidgetProps||{}),u.widgetProps||{})),e.widgets[s]=u}e.valueSources||(e.valueSources=Object.keys(r.settings.valueSourcesInfo));var d=rd(e.valueSources),f;try{for(d.s();!(f=d.n()).done;){var p=f.value;p!="value"&&!e.widgets[p]&&(e.widgets[p]={})}}catch(v){d.e(v)}finally{d.f()}!e.operators&&n&&(e.operators=Array.from(new Set(n))),!e.defaultOperator&&i&&(e.defaultOperator=i)}function pp(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var n in a){var i=[].concat(Pe(r),[n]);Cl(a[n],e,i),a[n].subfields&&pp(a[n].subfields,e,i)}}function vp(a,e){var r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(a){var i=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";for(var o in a){var s=[].concat(Pe(n),[o]),u=s.join(i),l=a[o];if(l.returnType&&(l.type=l.returnType,e.__funcsCntByType[l.returnType]||(e.__funcsCntByType[l.returnType]=0),e.__funcsCntByType[l.returnType]++),Cl(l,e,s,!1),l.args){for(var c in l.args)Cl(l.args[c],e,[].concat(Pe(s),[c]),!0);var d=Object.keys(l.args),f=!0,p=rd(d.reverse()),v;try{for(p.s();!(v=p.n()).done;){var y=v.value,m=l.args[y];!f&&m.isOptional&&(Ms.info("Arg ".concat(y," for func ").concat(u," can't be optional")),delete m.isOptional),m.isOptional||(f=!1)}}catch(S){p.e(S)}finally{p.f()}}l.subfields&&vp(l.subfields,e,[].concat(Pe(n),[o]))}}}function mS(a,e,r){for(var n,i,o=["listValues","treeValues","allowCustomValues","validateValue"],s=0,u=o;s<u.length;s++){var l=u[s];a[l]&&(a.fieldSettings||(a.fieldSettings={}),a.fieldSettings[l]=a[l],delete a[l])}(n=a.fieldSettings)!==null&&n!==void 0&&n.listValues&&e.settings.normalizeListValues&&(a.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,a.fieldSettings.listValues,r,a.fieldSettings)),(i=a.fieldSettings)!==null&&i!==void 0&&i.treeValues&&e.settings.normalizeListValues&&(a.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,a.fieldSettings.treeValues,r,a.fieldSettings))}function Cl(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,o=e.settings,s=o.showLabels,u=o.fieldSeparator;u=u??".";var l=r[r.length-1],c=n?r.slice(0,r.length-1).join(u):r.join(u),d=!!a.returnType,f=a.type||a.returnType,p=e.types[f],v=a.excludeOperators||[],y=(a.operators||p?.operators||[]).filter(function(X){return!v.includes(X)}),m=a.defaultOperator||p?.defaultOperator;v.includes(m)&&(m=void 0);var S=!!m&&m==a.defaultOperator;if(S&&(a.ownDefaultOperator=a.defaultOperator),!p){a.type!=="!struct"&&(a.disabled=!0);return}!n&&!d&&!i&&(e.__fieldsCntByType[f]||(e.__fieldsCntByType[f]=0),e.__fieldsCntByType[f]++),n&&(a._isFuncArg=!0,a._argKey=l,a._funcKey=c),d&&(a._isFunc=!0,a._funcKey=c),i&&(a._isCaseValue=!0),mS(a,e,f);var F=["widgets","operators","defaultOperator"];Object.keys(p).filter(function(X){return!F.includes(X)}).map(function(X){a[X]||(a[X]=ki(p[X]))});var C=p.excludeOperators||[];a.operators&&(C=C.filter(function(X){return!a.operators.includes(X)})),a.widgets||(a.widgets={});var w=function(){var H=nn({},a.widgets[E]||{}),W=p.widgets[E]||{};if(!n){var J=H.defaultOperator,Y=[].concat(Pe(v),Pe(C)),K=a.preferWidgets&&(E==="field"||a.preferWidgets.includes(E))||Y.length>0;if(H.operators){var ae=H.operators.filter(function(Jt){return!Y.includes(Jt)});H.operators=ae,y=Vs(y,ae)}else if(K&&W.operators){var se=W.operators.filter(function(Jt){return!Y.includes(Jt)});H.operators=se,y=Vs(y,se)}J&&!Y.includes(J)&&(!m||!S&&E===a.mainWidget)&&(m=J)}H.widgetProps=nn(nn(nn({},W.widgetProps||{}),E===a.mainWidget&&a.mainWidgetProps||{}),H.widgetProps||{});for(var re=0,ie=pS;re<ie.length;re++){var ne=ie[re];if(H.widgetProps[ne]){var de,le,fe,ve;H.widgetProps[ne]=nn(nn(nn(nn({},((de=e.widgets[E])===null||de===void 0?void 0:de[ne])||{}),((le=W.widgetProps)===null||le===void 0?void 0:le[ne])||{}),E===a.mainWidget&&((fe=a.mainWidgetProps)===null||fe===void 0?void 0:fe[ne])||{}),((ve=H.widgetProps)===null||ve===void 0?void 0:ve[ne])||{})}}var ye=Array.from(new Set([].concat(Pe(Object.keys(W.opProps||{})),Pe(Object.keys(H.opProps||{})))));if(ye.length){var we={},xe=rd(ye),Fe;try{for(xe.s();!(Fe=xe.n()).done;){var ze,_e,Oe=Fe.value;we[Oe]=nn(nn({},((ze=W.opProps)===null||ze===void 0?void 0:ze[Oe])||{}),((_e=H.opProps)===null||_e===void 0?void 0:_e[Oe])||{});for(var Ve=0,ke=vS;Ve<ke.length;Ve++){var De=ke[Ve];if(we[Oe][De]){var Ke,$e,Je;we[Oe][De]=nn(nn(nn({},((Ke=e.operators)===null||Ke===void 0||(Ke=Ke[Oe])===null||Ke===void 0?void 0:Ke[De])||{}),(($e=W.opProps)===null||$e===void 0||($e=$e[Oe])===null||$e===void 0?void 0:$e[De])||{}),((Je=H.opProps)===null||Je===void 0||(Je=Je[Oe])===null||Je===void 0?void 0:Je[De])||{})}}}}catch(Jt){xe.e(Jt)}finally{xe.f()}H.opProps=we}var ut=H,Xe=ut.valueLabel,et=ut.valuePlaceholder;n&&(Xe||(H.valueLabel=a.label||l),!et&&!s&&(H.valuePlaceholder=a.label||l)),H=nn(nn({},W),H),a.widgets[E]=H};for(var E in p.widgets)w();if(n||(a.operators||(a.operators=Array.from(new Set(y))),a.defaultOperator||(a.defaultOperator=m)),!n&&!d&&!i){var _=yS(e,r),A=_.fieldName,N=_.inGroup;A&&(a.fieldName=A,e.__fieldNames[A]||(e.__fieldNames[A]=[]),e.__fieldNames[A].push({fullPath:r,inGroup:N}))}}function yS(a,e){if(!e)return{};var r=a.settings.fieldSeparator,n=Pe(e).reduce(function(u,l,c,d){var f=u.computedPath,p=u.computed,v=u.inGroup,y=[].concat(Pe(d.slice(0,c)),[l]),m=sa(a,y);return m?.type==="!group"&&c<d.length-1?(v=y.join(r),f=[]):m!=null&&m.fieldName?(p=!0,f=[m.fieldName]):f=[].concat(Pe(f),[l]),{computedPath:f,computed:p,inGroup:v}},{computedPath:[],computed:!1,inGroup:void 0}),i=n.computedPath,o=n.computed,s=n.inGroup;return o?{fieldName:i.join(r),inGroup:s}:{}}function gp(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function hp(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gp(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):gp(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function mp(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=SS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function SS(a,e){if(a){if(typeof a=="string")return yp(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yp(a,e):void 0}}function yp(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}var bS=function(e,r){var n={usedFields:[],errors:[]},i=Vn(r,void 0,!1),o=Sp(e,i,n,!1,!0),s=n.errors,u=n.usedFields,l=i.settings.fieldSeparator,c={},d=mp(u),f;try{for(d.s();!(f=d.n()).done;)for(var p=f.value,v=br(p,r),y=Ze(i,p)||{},m=c,S=0;S<v.length;S++){var F=v[S],C=Ze(i,v.slice(0,S+1))||{};S!=v.length-1?C.type=="!group"&&C.mode!="struct"?(m[F]||(m[F]=[{}]),m=m[F][0]):(m[F]||(m[F]={}),m=m[F]):m[F]||(m[F]=null)}}catch(w){d.e(w)}finally{d.f()}return{errors:s,logic:o,data:c}},Sp=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(e){var u=e.get("type"),l=e.get("properties")||new Wt,c=l.get("isLocked"),d=r.settings.jsonLogic.lockedOp,f;return u==="group"||u==="rule_group"?f=bp(e,r,n,i,o,s):u==="rule"?f=OS(e,r,n,i,s):u=="switch_group"?f=FS(e,r,n,i):u=="case_group"&&(f=Op(e,r,n,i,s)),c&&f&&d&&(f=Se({},d,f)),f}},bp=function(e,r,n){var i,o,s,u,l,c,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,v=e.get("type"),y=e.get("properties")||new Wt,m=y.get("mode"),S=e.get("children1")||new Pn,F=y.get("field"),C=Ze(r,F),w=y.get("conjunction");w||(w=li(r));var E=r.conjunctions[w],_=E?.jsonLogicConj||w.toLowerCase(),A=!!y.get("not"),N=v==="rule_group"&&!f,X=N&&m!="struct",H=X?F:p,W=y.get("operator"),J=W&&Mt(r,W,F)||null,Y=nd(r,y,n,W,p),K=N&&(!W||((i=J)===null||i===void 0?void 0:i.cardinality)==0),ae=N&&S?.size>0,se=N&&!(S!=null&&S.size),re=A,ie=!1;ae?(ie=A,re=d):d&&(re=!re);var ne=!1,de=(o=J)===null||o===void 0?void 0:o.reversedOp,le=Mt(r,de,F),fe=!((s=J)!==null&&s!==void 0&&s.jsonLogic)&&!!((u=le)!==null&&u!==void 0&&u.jsonLogic),ve=!!((l=le)!==null&&l!==void 0&&l.jsonLogic),ye=(c=yl(e))===null||c===void 0?void 0:c.get("type"),we=!!r.settings.reverseOperatorsForNot&&(!N&&re&&ye==="rule"||ie&&S?.size===1);we&&(ae?ie=!ie:re=!re,ne=!0);var xe=re&&N&&ve&&(!!r.settings.reverseOperatorsForNot||fe);if(xe){re=!re;var Fe=[de,W];W=Fe[0],de=Fe[1];var ze=[le,J];J=ze[0],le=ze[1]}var _e=S.map(function(kt){return Sp(kt,r,n,ne,!1,H)}).filter(function(kt){return typeof kt<"u"}),Oe=!!r.settings.exportPreserveGroups;if(X&&!K){if(Y==null)return}else if(!_e.size&&!Oe)return;var Ve=f||Oe||_e.size!=1;!Ve&&A&&!ne&&(Ve=S.some(function(kt){var Kt,Ct,or,er,Lr=(Kt=kt.get("properties"))===null||Kt===void 0?void 0:Kt.get("operator"),lr=(Ct=r.operators)===null||Ct===void 0||(Ct=Ct[Lr])===null||Ct===void 0?void 0:Ct.reversedOp;return(or=(er=r.operators)===null||er===void 0||(er=er[lr])===null||er===void 0?void 0:er._jsonLogicIsExclamationOp)!==null&&or!==void 0?or:!1}));var ke={};Ve?ke[_]=_e.toList().toJS():ke=_e.first(),ie&&(ke={"!":ke});var De=ke;if(X){var Ke,$e=id(n,r,F,p),Je;if(!K){var ut=_e.size?{filter:[$e,ke]}:$e;Je={reduce:[ut,{"+":[1,{var:"accumulator"}]},0]}}var Xe=Je??$e,et=new Wt({having:ke,reduce:Je,groupField:F,groupFieldFormatted:$e});if(typeof((Ke=J)===null||Ke===void 0?void 0:Ke.jsonLogic)=="function")De=od(r,y,Xe,Y,W,et,C);else if(K){var Jt=W||"some";De=Se({},Jt,[$e,ke])}else De=od(r,y,Xe,Y,W,null,C)}return re&&(De={"!":De}),De},OS=function(e,r,n){var i,o,s,u,l,c,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,p=e.get("properties")||new Wt,v=p.get("field"),y=p.get("fieldSrc"),m=p.get("operator"),S=p.get("operatorOptions");if(S=S?S.toJS():null,S&&!Object.keys(S).length&&(S=null),!(v==null||m==null)){var F=Ze(r,v),C=Mt(r,m,v),w=(i=C)===null||i===void 0?void 0:i.reversedOp,E=Mt(r,w,v);if(!((o=C)!==null&&o!==void 0&&o.jsonLogic)&&!((s=E)!==null&&s!==void 0&&s.jsonLogic)){n.errors.push("Operator ".concat(m," is not supported"));return}var _=d,A=!((u=C)!==null&&u!==void 0&&u.jsonLogic)&&!!((l=E)!==null&&l!==void 0&&l.jsonLogic),N=!!((c=E)!==null&&c!==void 0&&c.jsonLogic),X=N&&(!!r.settings.reverseOperatorsForNot||A),H=_&&X||A;if(H){_=!_;var W=[w,m];m=W[0],w=W[1];var J=[E,C];C=J[0],E=J[1]}var Y=nd(r,p,n,m,f);if(Y!==void 0){var K=y==="func"?Fp(n,r,v,f):id(n,r,v,f);if(K!==void 0)return od(r,p,K,Y,m,S,F,_)}}},FS=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=e.get("children1");if(o){for(var s=o.map(function(A){return Op(A,r,n,i,null)}).filter(function(A){return typeof A<"u"}).valueSeq().toArray(),u=[],l=0;l<s.length;l++)l!==s.length-1&&!s[l][0]?n.errors.push("No condition for case ".concat(l)):(u.push(s[l]),l===s.length-1&&s[l][0]&&u.push([void 0,null]));if(u.length){if(u.length===1){var c=Ce(u[0],2),d=c[0],f=c[1];return f==null&&(f=null),f}for(var p={if:[]},v=p.if,y=Ce(u[u.length-1],2),m=y[0],S=y[1],F=0;F<u.length-1;F++){var C=F===u.length-2,w=Ce(u[F],2),E=w[0],_=w[1];_==null&&(_=null),E==null&&(E=!0),v.push(E),v.push(_),C?v.push(S):(v.push({if:[]}),v=v[v.length-1].if)}return p}}},Op=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=e.get("type");if(s!="case_group"){n.errors.push("Unexpected child of type ".concat(s," inside switch"));return}var u=e.get("properties")||new Wt,l=bp(e,r,n,i,o),c=nd(r,u,n,null,o,"!case_value");return[l,c]},nd=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=r.get("field"),l=r.get("valueSrc"),c=r.get("valueType");(s=="!case_value"||c&&c.get(0)=="case_value")&&(u="!case_value");var d=Ze(e,u),f=Mt(e,i,u),p=Mr(f),v=r.get("value"),y=r.get("asyncListValues");if(v!=null){var m=[],S=[],F=n.usedFields,C=v.map(function(E,_){var A=l?l.get(_):null,N=c?c.get(_):null,X=Ui(E,A,e),H=vr(e,u,i,A),W=rn(e,u,i,H,A,{forExport:!0}),J=ad(n,e,X,A,N,W,d,i,f,o,y);return J!==void 0&&(m.push(A),S.push(N)),J}),w=C.filter(function(E){return E===void 0}).size>0;if(C.size<p||w){n.usedFields=F;return}return p>1?C.toArray():p==1?C.first():null}},ad=function(e,r,n,i,o,s,u,l,c){var d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,f=arguments.length>10?arguments[10]:void 0;if(n!==void 0){var p;if(i=="field")p=id(e,r,n,d);else if(i=="func")p=Fp(e,r,n,d);else if(typeof s?.jsonLogic=="function"){var v=s.jsonLogic,y=[n,hp(hp({},u?ya()(u,["fieldSettings","listValues"]):{}),{},{asyncListValues:f}),Nn(s,Vi)];l&&(y.push(l),y.push(c)),p=v.call.apply(v,[r.ctx].concat(y))}else p=n;return p}},Fp=function(e,r,n){var i,o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=(i=n.get)===null||i===void 0?void 0:i.call(n,"func"),l=(o=n.get)===null||o===void 0?void 0:o.call(n,"args"),c=kr(r,u),d=br(u,r),f=d[d.length-1];if(!c){e.errors.push("Func ".concat(u," is not defined in config"));return}if(!(c!=null&&c.jsonLogic)){e.errors.push("Func ".concat(u," is not supported"));return}var p={},v=[],y=[];for(var m in c.args){var S,F=c.args[m],C=Ze(r,F),w=F.defaultValue,E=F.isOptional,_=w!=null&&w.func?"func":"value",A=l?l.get(m):void 0,N=A?A.get("value"):void 0,X=A?A.get("valueSrc"):void 0;X!=="func"&&(S=N)!==null&&S!==void 0&&S.toJS&&(N=N.toJS());var H=null,W=vr(r,F,H,X),J=rn(r,F,H,W,X,{forExport:!0}),Y=ad(e,r,N,X,F.type,J,C,null,null,s);if(N!=null&&Y===void 0){X!="func"&&e.errors.push("Can't format value of arg ".concat(m," for func ").concat(u));return}var K=void 0;if(Y===void 0&&!E&&w!=null){var ae=vr(r,F,H,_),se=rn(r,F,H,ae,_,{forExport:!0});if(K=ad(e,r,w,_,F.type,se,C,null,null,s),K===void 0){_!="func"&&e.errors.push("Can't format default value of arg ".concat(m," for func ").concat(u));return}}var re=Y??K;if(re!==void 0){if(v.length){var ie=mp(v),ne;try{for(ie.s();!(ne=ie.n()).done;){var de=ne.value;p[de]=void 0}}catch(_e){ie.e(_e)}finally{ie.f()}v=[]}p[m]=re}else E||y.push(m),v.push(m)}if(!y.length){var le=Object.values(p),fe;if(typeof c.jsonLogic=="function"){var ve=c.jsonLogic,ye=[p];fe=ve.call.apply(ve,[r.ctx].concat(ye))}else{var we=c.jsonLogic||f,xe=!!c.jsonLogicIsMethod;if(xe){var Fe=le[0],ze=le.slice(1);ze.length?fe={method:[Fe,we,ze]}:fe={method:[Fe,we]}}else fe=Se({},we,le)}return fe}},id=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=r.settings,s=o.fieldSeparator,u=o.jsonLogic,l;if(n){Array.isArray(n)&&(n=n.join(s));var c=Ze(r,n)||{},d=Ga(n,r,e,i),f=c.jsonLogicVar||(c.type=="!group"?u.groupVarKey:"var");l=Se({},f,d),e.usedFields.indexOf(n)==-1&&e.usedFields.push(n)}return l},TS=function(e,r,n,i,o){var s=e,u=Mr(r);typeof r.jsonLogic=="string"&&(s=r.jsonLogic);var l=["<","<=",">",">="],c=["==","!="],d=function(p,v,y,m,S){return u==0&&c.includes(s)?Se({},s,[n,null]):u==0?Se({},s,n):u==1?Se({},s,[n,i]):u==2&&l.includes(s)?Se({},s,[i[0],n,i[1]]):Se({},s,[n].concat(Pe(i)))};return d},od=function(e,r,n,i,o){var s,u,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,f=r.get("field"),p=(s=r.get("valueType"))===null||s===void 0?void 0:s.get(0),v=Mt(e,o,f)||{},y=(u=c?.type)!==null&&u!==void 0?u:p,m=typeof v.jsonLogic=="function"?v.jsonLogic:TS(o,v,n,i,y),S=[n,o,i,Nn(v,Fo),l,c,y,e.settings],F=m.call.apply(m,[e.ctx].concat(S));return d&&(F={"!":F}),F},sd=function(e){var r="",n=e?.type;return n=="number"&&(r=0),r},Tp=function(e,r,n,i,o,s,u,l,c,d,f,p,v){var y=typeof i=="string"&&!i.startsWith("$")?"$"+i:i,m=r(s,v);if(m!==void 0){var S=u^n;if(l&&e=="$nin"&&(S=!S,e="$in"),l&&e=="$regex"){var F={$regexFind:{input:y,regex:m}};return S&&(F={$not:F}),F}return S?l?{$not:Se({},e,[y,m])}:Se({},i,{$not:Se({},e,m)}):!l&&(!e||e=="$eq")?Se({},i,m):l?Se({},e,[y,m]):Se({},i,Se({},e,m))}},Cp=function(e,r,n,i,o,s,u,l,c,d,f,p){var v=typeof n=="string"&&!n.startsWith("$")?"$"+n:n;return s^r?u?{$not:{$and:[Se({},e[0],[v,o[0]]),Se({},e[1],[v,o[1]])]}}:Se({},n,{$not:Se(Se({},e[0],o[0]),e[1],o[1])}):u?{$and:[Se({},e[0],[v,o[0]]),Se({},e[1],[v,o[1]])]}:Se({},n,Se(Se({},e[0],o[0]),e[1],o[1]))},Ro=function(e){return e.replace(/\$/g,"\uFF04")},CS=function(e){return e.replace(/\uFF04/g,"$")};function ES(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=wS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function wS(a,e){if(a){if(typeof a=="string")return Ep(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ep(a,e):void 0}}function Ep(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function wp(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function xp(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wp(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):wp(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var xS=function(e,r){return Lp(e,r,!1)},Lp=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i={errors:[]},o=Vn(r,void 0,!1),s=ud([],e,o,i);return n?[s,i.errors]:(i.errors.length&&console.warn("Errors while exporting to MongoDb:",i.errors),s)},ud=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(r){var c=r.get("type");if(c==="group"||c==="rule_group")return LS(e,r,n,i,o,s,u,l);if(c==="rule")return RS(e,r,n,i,o,s,u,l)}},LS=function(e,r,n,i){var o,s,u,l,c,d,f,p,v,y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,S=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,F=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,C=r.get("type"),w=r.get("properties")||new Wt,E=!!w.get("not"),_=r.get("children1")||new Pn,A=n.settings,N=A.canShortMongoQuery,X=A.fieldSeparator,H=A.exportPreserveGroups,W=A.reverseOperatorsForNot,J=X,Y=(o=e.filter(function(Bt){return Bt.get("type")=="rule_group"}))===null||o===void 0||(o=o.slice(-1))===null||o===void 0?void 0:o.pop(),K=!!Y,ae=Y?.get("properties").get("field"),se=K&&Y.get("properties").get("mode")=="array",re=C==="rule_group",ie=re?w.get("field"):null,ne=re?w.get("operator"):null,de=ne&&Mt(n,ne,ie)||null,le=ne?(s=(u=de)===null||u===void 0?void 0:u.cardinality)!==null&&s!==void 0?s:1:void 0,fe=Ga(ie,n,i,ae),ve=Ze(n,ie)||{},ye=ve.mode,we=ie&&ye==="array"&&le>=1,xe=re&&ye!="struct",Fe=re&&_?.size>0,ze=re&&!(_!=null&&_.size),_e=!1,Oe=E,Ve=!1;Fe?(Ve=E,Oe=y):y&&(Oe=!Oe);var ke=(l=de)===null||l===void 0?void 0:l.reversedOp,De=Mt(n,ke,ie),Ke=!((c=de)!==null&&c!==void 0&&c.mongoFormatOp)&&!!((d=De)!==null&&d!==void 0&&d.mongoFormatOp),$e=!!((f=De)!==null&&f!==void 0&&f.mongoFormatOp),Je=(p=yl(r))===null||p===void 0?void 0:p.get("type"),ut=!re&&Je==="rule",Xe=(Oe&&ut||Ve&&_?.size===1)&&!H;Xe&&(ut?Oe=!Oe:Ve=!Ve,_e=!0);var et=Oe&&re&&$e&&(!!W&&!H||Ke);if(et){Oe=!Oe;var Jt=[ke,ne];ne=Jt[0],ke=Jt[1];var kt=[De,de];de=kt[0],De=kt[1]}var Kt=w.get("conjunction");Kt||(Kt=li(n));var Ct=n.conjunctions[Kt];if(Ct){var or=Ct.reversedConj,er=Oe&&((v=Kt)===null||v===void 0?void 0:v.toLowerCase())==="or"&&or&&!re&&!!W&&!H;er&&(Kt=or,Ct=n.conjunctions[Kt],Oe=!Oe,_e=!0);var Lr=Ct.mongoConj,lr=!re&&!K,Or=ye=="array"?function(Bt){return"$$el".concat(J).concat(Bt)}:S,Rr=_.map(function(Bt){return ud([].concat(Pe(e),[r]),Bt,n,i,_e,lr,Or)}).filter(function(Bt){return typeof Bt<"u"});if(!(!we&&!Rr.size)){var qt,an;if(Rr.size==1)qt=Rr.first();else if(Rr.size>1){var Jn=Rr.toList().toJS(),Nt=N&&Lr=="$and"&&!H;Nt&&(qt=Jn.reduce(function(Bt,kn){if(Bt){for(var Ut in kn){if(Ut[0]=="$"){Bt=void 0;break}if(Bt[Ut]==null)Bt[Ut]=kn[Ut];else{var yn=Bt[Ut],Gn=kn[Ut];Xr(yn)||(yn={$eq:yn}),Xr(Gn)||(Gn={$eq:Gn});var la=Object.keys(yn)[0],uu=Object.keys(Gn)[0];if(la==uu){Bt=void 0;break}Bt[Ut]=Object.assign({},yn,Gn)}}return Bt}},{})),qt?an=!0:(an=!1,qt=Se({},Lr,Jn))}if(ie)if(ye=="array"){var Fr={$size:{$ifNull:["$"+Ro(fe),[]]}};Ve&&qt&&(qt={$not:qt},Ve=!1);var Br=qt?{$size:{$ifNull:[{$filter:{input:"$"+Ro(fe),as:"el",cond:qt}},[]]}}:Fr,Mn=H?!1:Oe;qt=ud(e,r.set("type","rule"),n,i,Mn,!1,function(Bt){return Br},Fr),Mn&&(Oe=!1),qt={$expr:qt}}else qt=Se({},Ro(fe),{$elemMatch:qt});return Oe&&(se?qt={$not:qt}:qt={$nor:[qt]}),qt}}},RS=function(e,r,n,i){var o,s,u,l,c,d,f,p,v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,y=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,m=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,S=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,F=r.get("properties")||new Wt,C=(o=e.filter(function(et){return et.get("type")=="rule_group"}))===null||o===void 0||(o=o.slice(-1))===null||o===void 0?void 0:o.pop(),w=C?.get("properties").get("field"),E=F.get("operator"),_=F.get("operatorOptions"),A=F.get("field"),N=F.get("fieldSrc"),X=F.get("value"),H=F.get("valueSrc"),W=F.get("valueType"),J=F.get("asyncListValues");if(!(A==null||E==null||X===void 0)){var Y=Ze(n,A),K=Mt(n,E,A),ae=(s=K)===null||s===void 0?void 0:s.reversedOp,se=Mt(n,ae,A),re=Mr(K);if(!((u=K)!==null&&u!==void 0&&u.mongoFormatOp)&&!((l=se)!==null&&l!==void 0&&l.mongoFormatOp)){i.errors.push("Operator ".concat(E," is not supported"));return}var ie=v,ne=!((c=K)!==null&&c!==void 0&&c.mongoFormatOp)&&!!((d=se)!==null&&d!==void 0&&d.mongoFormatOp),de=!!((f=se)!==null&&f!==void 0&&f.mongoFormatOp),le=de&&(!!n.settings.reverseOperatorsForNot||ne),fe=le&&ie||ne,ve=!1;if(fe){var ye=[ae,E];E=ye[0],ae=ye[1];var we=[se,K];K=we[0],se=we[1],ie=!ie,ve=!0}var xe,Fe=!1;if(N=="func"){var ze=Rp(i,n,A,w),_e=Ce(ze,2);xe=_e[0],Fe=_e[1]}else xe=Ga(A,n,i,w),xe=Ro(xe),m&&(Fe=!0,xe=m(xe));if(xe!=null){var Oe=[],Ve=[],ke;if(X!=null){var De=X.map(function(et,Jt){var kt=H?H.get(Jt):null,Kt=W?W.get(Jt):null,Ct=Ui(et,kt,n),or=vr(n,A,E,kt),er=rn(n,A,E,or,kt,{forExport:!0}),Lr=ld(i,n,Ct,kt,Kt,er,Y,w,E,K,J),lr=Ce(Lr,2),Or=lr[0],Rr=lr[1];return Or!==void 0&&(Fe=Fe||Rr,Oe.push(kt),Ve.push(Kt)),Or}),Ke=De.filter(function(et){return et===void 0}).size>0;if(De.size<re||Ke)return;ke=re>1?De.toArray():re==1?De.first():null}var $e=Fe&&y,Je=(p=K)===null||p===void 0?void 0:p.mongoFormatOp,ut=[xe,E,S!==void 0&&ke==null?S:ke,ie,Fe,Oe.length>1?Oe:Oe[0],Ve.length>1?Ve:Ve[0],Nn(K,Fo),_,Y],Xe=Je.call.apply(Je,[n.ctx].concat(ut));return $e&&(Xe={$expr:Xe}),Xe}}},ld=function(e,r,n,i,o,s,u,l,c,d,f){if(n===void 0)return[void 0,!1];var p,v=!1;if(i=="field"){var y=jS(e,r,n,l),m=Ce(y,2);p=m[0],v=m[1]}else if(i=="func"){var S=Rp(e,r,n,l),F=Ce(S,2);p=F[0],v=F[1]}else{var C;if(typeof s?.mongoFormatValue=="function"){var w=s.mongoFormatValue,E=[n,xp(xp({},u?ya()(u,["fieldSettings","listValues"]):{}),{},{asyncListValues:f}),Nn(s,Vi)];c&&(E.push(c),E.push(d)),p=w.call.apply(w,[r.ctx].concat(E))}else p=n;(C=p)!==null&&C!==void 0&&C.$dateFromString&&(v=!0)}return[p,v]},jS=function(e,r,n,i){var o=r.settings.fieldSeparator,s,u=!0;if(n){var l=Ze(r,n)||{},c=br(n,r),d=Bs(n,r),f=d?d.join(o):null,p=r.settings.formatField,v=Ga(n,r,e,i),y=p(v,c,f,l,r,!1);s="$"+Ro(y)}return[s,u]},Rp=function(e,r,n,i){var o,s,u=!0,l,c=(o=n.get)===null||o===void 0?void 0:o.call(n,"func"),d=(s=n.get)===null||s===void 0?void 0:s.call(n,"args"),f=kr(r,c);if(!f)return e.errors.push("Func ".concat(c," is not defined in config")),[void 0,!1];var p=br(c,r),v=p[p.length-1],y=f.mongoFunc||v,m=f.mongoArgsAsObject,S={},F=0,C=void 0,w=[],E=[];for(var _ in f.args){var A;F++;var N=f.args[_],X=Ze(r,N),H=N.defaultValue,W=N.isOptional,J=H!=null&&H.func?"func":"value",Y=d?d.get(_):void 0,K=Y?Y.get("value"):void 0,ae=Y?Y.get("valueSrc"):void 0;ae!=="func"&&(A=K)!==null&&A!==void 0&&A.toJS&&(K=K.toJS());var se=Y?Y.get("asyncListValues"):void 0,re=null,ie=vr(r,N,re,ae),ne=rn(r,N,re,ie,ae,{forExport:!0}),de=ld(e,r,K,ae,N.type,ne,X,i,null,null,se),le=Ce(de,2),fe=le[0],ve=le[1];if(K!=null&&fe===void 0)return ae!="func"&&e.errors.push("Can't format value of arg ".concat(_," for func ").concat(c)),[void 0,!1];var ye=void 0;if(fe===void 0&&!W&&H!=null){var we=vr(r,N,re,J),xe=rn(r,N,re,we,J,{forExport:!0}),Fe=void 0,ze=ld(e,r,H,J,N.type,xe,X,i,null,null,se),_e=Ce(ze,2);if(ye=_e[0],Fe=_e[1],ye===void 0)return J!="func"&&e.errors.push("Can't format default value of arg ".concat(_," for func ").concat(c)),[void 0,!1]}var Oe=fe??ye;if(Oe!==void 0){if(w.length){var Ve=ES(w),ke;try{for(Ve.s();!(ke=Ve.n()).done;){var De=ke.value;S[De]=void 0}}catch(Je){Ve.e(Je)}finally{Ve.f()}w=[]}S[_]=Oe,C=Oe}else W||E.push(_),w.push(_)}if(E.length)return[void 0,!1];if(typeof f.mongoFormatFunc=="function"){var Ke=f.mongoFormatFunc,$e=[S];l=Ke.call.apply(Ke,[r.ctx].concat($e))}else{if(f.mongoFormatFunc===null)return e.errors.push("Functon ".concat(y," is not supported")),[void 0,!1];m?l=Se({},y,S):F==1&&C!==void 0?l=Se({},y,C):l=Se({},y,Object.values(S))}return[l,u]},IS=b(61526),AS=b.n(IS),_S=function(e){return"'"+e.replace(/'/g,"''")+"'"},DS=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n,i,o=["int","float"];e.map(function(l){if(l!=null){if(typeof l=="string")i="String";else if(typeof l=="number")i=Number.isInteger(l)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(l," in array"));if(!n)n=i;else if(n!=i)if(o.includes(n)&&o.includes(i))n="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(n," and ").concat(i))}}),n||(n="String");var s;n=="float"?s=e.map(function(l){return $i(l,!0)}):s=e.map(function(l){return $i(l)});var u;return r?u="new ".concat(n,"[]{").concat(s.join(", "),"}"):u="{".concat(s.join(", "),"}"),u},$i=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch(Ye(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||r?"f":"");case"object":if(Array.isArray(e))return DS(e,n);throw new Error("spelEscape: Object is not supported");default:return _S(e)}},jp=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(r){if(r.type=="const")return $i(r.value);if(r.type=="property")return""+r.value;if(r.type=="variable")return"#"+r.value}).filter(function(r){return r!=null}).join(" + "):"null"},Ip=function(e){if(e==null)return[void 0,[]];var r=[],n=e.valueType=="case_value"?e.value:e,i=Array.isArray(n)?n:[n],o=i.map(function(s){if(s.valueSrc==="value")return s.value===null?void 0:{type:"const",value:s.value};if(s.valueSrc==="field")return{type:s.isVariable?"variable":"property",value:s.value};r.push("Unsupported valueSrc ".concat(s.valueSrc," in concatenation"))}).filter(function(s){return s!=null});return[o,r]},cd=function(e){return"".concat(e,".?[true]")},Ua=AS();Ua.trim=function(a){return a?.charAt(0)=="'"?a.substring(1,a.length-1):a},Ua.unescapeLike=function(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(typeof a!="string")return a;var r=a;return e==="BigQuery"?r=r.replace(/\\\\([%_])/g,"$1"):r=r.replace(/\\([%_])/g,"$1"),r},Ua.escapeLike=function(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(typeof a!="string")return a;var i=Ua.escape(a);return i=Ua.trim(i),n==="BigQuery"?i=i.replace(/[%_\\]/g,"\\\\$&"):i=i.replace(/[%_]/g,"\\$&"),i=(e?"%":"")+i+(r?"%":""),i="'"+i+"'",i};var Ap=function(e){var r="''",n=e?.type;return n=="date"?r="'0000-00-00'":n=="datetime"?r="'0000-00-00 00:00'":n=="time"?r="'00:00'":n=="number"&&(r="0"),r},_p=function(e){return e==null?"NULL":e.toString()},Dp=function(e){return e==null||e?.[0]==="("&&e?.[e?.length-1]===")"?e:"("+e+")"};function PS(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=NS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function NS(a,e){if(a){if(typeof a=="string")return Pp(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pp(a,e):void 0}}function Pp(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function Np(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Vp(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Np(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Np(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var VS=function(e,r){return Mp(e,r,!1)},Mp=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i={errors:[]},o=Vn(r,void 0,!1),s=kp(e,o,i);return n?[s,i.errors]:(i.errors.length&&console.warn("Errors while exporting to SQL:",i.errors),s)},kp=function(e,r,n){if(e){var i=e.get("type"),o=e.get("children1");if(i==="group"||i==="rule_group")return MS(e,r,n);if(i==="rule")return GS(e,r,n)}},MS=function(e,r,n){var i=e.get("type"),o=e.get("properties")||new Wt,s=e.get("children1")||new Pn,u=i==="rule_group",l=u?o.get("field"):null,c=Ze(r,l)||{},d=c.mode;d=="array"&&n.errors.push("Aggregation is not supported for ".concat(l));var f=o.get("not"),p=!1,v=s.map(function(S){return kp(S,r,n)}).filter(function(S){return typeof S<"u"});if(!(!p&&!v.size)){var y=o.get("conjunction");y||(y=li(r));var m=r.conjunctions[y];return m.sqlFormatConj.call(r.ctx,v,y,f)}},kS=function(e,r){var n=r.sqlOp||e,i=Mr(r),o;return i==0?o=function(u,l,c,d,f,p,v,y){return"".concat(u," ").concat(n)}:i==1?o=function(u,l,c,d,f,p,v,y){return"".concat(u," ").concat(n," ").concat(c)}:i==2&&(o=function(u,l,c,d,f,p,v,y){var m,S,F=c==null||(m=c.first)===null||m===void 0?void 0:m.call(c),C=c==null||(S=c.get)===null||S===void 0?void 0:S.call(c,1);return"".concat(u," ").concat(n," ").concat(F," AND ").concat(C)}),o},GS=function(e,r,n){var i=e.get("properties")||new Wt,o=i.get("field"),s=i.get("fieldSrc"),u=i.get("operator"),l=i.get("operatorOptions"),c=i.get("valueSrc"),d=i.get("valueType"),f=i.get("value"),p=i.get("asyncListValues");if(!(o==null||u==null)){var v=Ze(r,o)||{},y=Mt(r,u,o)||{},m=y.reversedOp,S=Mt(r,m,o)||{},F=Mr(y),C=!1,w=y.sqlOp||y.sqlFormatOp,E=S.sqlOp||S.sqlFormatOp;if(!w&&!E){n.errors.push("Operator ".concat(u," is not supported"));return}if(!w&&E){C=!0;var _=[m,u];u=_[0],m=_[1];var A=[S,y];y=A[0],S=A[1]}var N=[],X=[],H;if(f!=null){var W=f.map(function(re,ie){var ne=c?c.get(ie):null,de=d?d.get(ie):null,le=Ui(re,ne,r),fe=vr(r,o,u,ne),ve=rn(r,o,u,fe,ne,{forExport:!0}),ye=dd(n,r,le,ne,de,ve,v,u,y,p);return ye!==void 0&&(N.push(ne),X.push(de)),ye}),J=W.filter(function(re){return re===void 0}).size>0;if(J||W.size<F)return;H=F==1?W.first():W}var Y=y.sqlFormatOp||kS(u,y);if(!Y){n.errors.push("Operator ".concat(u," is not supported"));return}var K=s=="func"?Bp(n,r,o):Gp(n,r,o);if(K!=null){var ae=[K,u,H,N.length>1?N:N[0],X.length>1?X:X[0],Nn(y,Fo),l,v],se;if(se=Y.call.apply(Y,[r.ctx].concat(ae)),C&&(se=r.settings.sqlFormatReverse.call(r.ctx,se)),se===void 0){n.errors.push("Operator ".concat(u," is not supported for value source ").concat(N.join(", ")));return}return se}}},dd=function(e,r,n,i,o,s,u,l,c,d){if(n!==void 0){var f;if(i=="field")f=Gp(e,r,n);else if(i=="func")f=Bp(e,r,n);else if(n==null)f=void 0;else if(typeof s?.sqlFormatValue=="function"){var p=s.sqlFormatValue,v=i=="field"&&Ze(r,n)||{},y=[n,Vp(Vp({},ya()(u,["fieldSettings","listValues"])),{},{asyncListValues:d}),Nn(s,Vi),l,c,v,r.settings.sqlDialect];f=p.call.apply(p,[r.ctx].concat(y))}else Array.isArray(n)?f=n.map(function(m){return Ua.escape(m)}):f=Ua.escape(n);return f}},Gp=function(e,r,n){if(n){var i=r.settings.fieldSeparator,o=Ze(r,n)||{},s=br(n,r),u=Bs(n,r),l=u?u.join(i):null,c=r.settings.formatField,d=Ga(n,r,e,null,{useTableName:!0}),f=c(d,s,l,o,r);return f}},Bp=function(e,r,n){var i,o,s=(i=n.get)===null||i===void 0?void 0:i.call(n,"func"),u=(o=n.get)===null||o===void 0?void 0:o.call(n,"args"),l=kr(r,s);if(!l){e.errors.push("Func ".concat(s," is not defined in config"));return}var c=br(s,r),d=c[c.length-1],f=l.sqlFunc||d,p={},v=[],y=[];for(var m in l.args){var S,F=l.args[m],C=Ze(r,F),w=F.defaultValue,E=F.isOptional,_=w!=null&&w.func?"func":"value",A=u?u.get(m):void 0,N=A?A.get("value"):void 0,X=A?A.get("valueSrc"):void 0;X!=="func"&&(S=N)!==null&&S!==void 0&&S.toJS&&(N=N.toJS());var H=A?A.get("asyncListValues"):void 0,W=dd(e,r,N,X,F.type,C,F,null,null,H);if(N!=null&&W===void 0){X!="func"&&e.errors.push("Can't format value of arg ".concat(m," for func ").concat(s));return}var J=void 0;if(W===void 0&&!E&&w!=null&&(J=dd(e,r,w,_,F.type,C,F,null,null,H),J===void 0)){_!="func"&&e.errors.push("Can't format default value of arg ".concat(m," for func ").concat(s));return}var Y=W??J;if(Y!==void 0){if(v.length){var K=PS(m),ae;try{for(K.s();!(ae=K.n()).done;){var se=ae.value;p[se]=void 0}}catch(le){K.e(le)}finally{K.f()}v=[]}p[m]=Y}else E||y.push(m),v.push(m)}if(!y.length){var re;if(typeof l.sqlFormatFunc=="function"){var ie=l.sqlFormatFunc,ne=[p,r.settings.sqlDialect];re=ie.call.apply(ie,[r.ctx].concat(ne))}else{var de=Object.entries(p).map(function(le){var fe=Ce(le,2),ve=fe[0],ye=fe[1];return ye}).join(", ");re="".concat(f,"(").concat(de,")")}return re}};function Up(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=BS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function BS(a,e){if(a){if(typeof a=="string")return $p(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$p(a,e):void 0}}function $p(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function Wp(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function zp(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wp(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Wp(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Kp="${0}.compareTo(${1})",US={datetime:!0,time:!0,date:!0},$S=function(e,r){return qp(e,r,!1)},qp=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i={errors:[]},o=Vn(r,void 0,!1),s=Hp(e,o,i,null);return n?[s,i.errors]:(i.errors.length&&console.warn("Errors while exporting to SpEL:",i.errors),s)},Hp=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type");if(o==="group"||o==="rule_group")return Jp(e,r,n,i);if(o==="rule")return KS(e,r,n,i);if(o=="switch_group")return WS(e,r,n,i);if(o=="case_group")return Qp(e,r,n,i)}},Qp=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type");if(o!="case_group"){n.errors.push("Unexpected child of type ".concat(o," inside switch"));return}var s=e.get("properties")||new Wt,u=fd(r,s,n,null,i,"!case_value"),l=u.value,c=u.valueSrc,d=u.valueType,f=Jp(e,r,n,i);return[f,l]},WS=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new Wt,s=e.get("children1");if(s){var u=s.map(function(S){return Qp(S,r,n,null)}).filter(function(S){return typeof S<"u"}).valueSeq().toArray();if(u.length){if(u.length==1&&!u[0][0])return u[0][1];for(var l=[],c=0;c<u.length;c++)c!=u.length-1&&!u[c][0]?n.errors.push("No condition for case ".concat(c)):(l.push(u[c]),c==u.length-1&&u[c][0]&&l.push([void 0,null]));for(var d="",f="",p=0;p<l.length;p++){var v=Ce(l[p],2),y=v[0],m=v[1];m==null&&(m="null"),y==null&&(y="true"),p!=l.length-1?(d+="(".concat(y," ? ").concat(m," : "),f+=")"):d+="".concat(m)}return d+f}}},Jp=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type"),s=e.get("properties")||new Wt,u=s.get("mode"),l=e.get("children1")||new Pn,c=s.get("field"),d=s.get("conjunction");d||(d=li(r));var f=r.conjunctions[d],p=s.get("not"),v=o==="rule_group"&&c,y=v&&u!="struct",m=y?c:i,S=Ze(r,m)||{},F=S.isSpelArray,C=r.settings.fieldSeparator,w=s.get("operator");!w&&(!u||u=="some")&&(w="some");var E=Xp(r,w,c),_=E!=w,A=w&&Mt(r,E,c)||null,N=v&&(!E||A.cardinality==0),X=fd(r,s,n,E,i,null),H=X.value,W=X.valueSrc,J=X.valueType,Y=l.map(function(ye){return Hp(ye,r,n,m)}).filter(function(ye){return typeof ye<"u"});if(y&&!N){if(H==null)return}else if(!Y.size)return;var K=v,ae=Y.size?f.spelFormatConj.call(r.ctx,Y,d,p,K):null,se;if(y){var re=vd(n,r,c,i),ie=re.value,ne=C||".",de=ne+(F?"length":"size()"),le="".concat(ie).concat(de),fe=ae?"".concat(ie,".?[").concat(ae,"]").concat(de):le,ve=N?le:H;se=Yp(n,r,s,fe,ve,E,W,J,_)}else se=ae;return se},zS=function(e,r,n){var i=r.spelOp;if(i){var o=i.includes("${0}"),s=US[n],u=i,l,c=Mr(r);return s?l=function(f,p,v,y,m,S,F,C){var w=Kp.replace(/\${(\w+)}/g,function(E,_){return _==0?f:c>1?v[_-1]:v});return"".concat(w," ").concat(u," 0")}:o?l=function(f,p,v,y,m,S,F,C){return i.replace(/\${(\w+)}/g,function(w,E){return E==0?f:c>1?v[E-1]:v})}:c==0?l=function(f,p,v,y,m,S,F,C){return"".concat(f," ").concat(u)}:c==1&&(l=function(f,p,v,y,m,S,F,C){return"".concat(f," ").concat(u," ").concat(v)}),l}},Yp=function(e,r,n,i,o,s,u,l){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,d=n.get("field"),f=Mt(r,s,d)||{},p=Ze(r,d)||{},v=n.get("operatorOptions"),y=f.spelFormatOp||zS(s,f,l??p.type);if(!y){e.errors.push("Operator ".concat(s," is not supported"));return}var m=[i,s,o,u,l,Nn(f,Fo),v,p],S;return S=y.call.apply(y,[r.ctx].concat(m)),c&&(S=r.settings.spelFormatReverse.call(r.ctx,S)),S===void 0&&e.errors.push("Operator ".concat(s," is not supported for value source ").concat(u)),S},Xp=function(e,r,n){if(r){var i=Mt(e,r,n)||{},o=i.reversedOp,s=Mt(e,o,n)||{},u=!1,l=i.spelOp||i.spelFormatOp,c=s.spelOp||s.spelFormatOp;if(!(!l&&!c)){if(!l&&c){u=!0;var d=[o,r];r=d[0],o=d[1];var f=[s,i];i=f[0],s=f[1]}return r}}},KS=function(e,r,n){var i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,s=e.get("properties")||new Wt,u=s.get("field"),l=s.get("fieldSrc"),c=s.get("operator");if(!(u==null||c==null)){var d=Xp(r,c,u);if(!d){n.errors.push("Operator ".concat(c," is not supported"));return}var f=d!=c,p=fd(r,s,n,d,o,null),v=p.value,y=p.valueSrc,m=p.valueType;if(v!==void 0){var S=(i=qS(n,r,u,l,o))!==null&&i!==void 0?i:{},F=S.value,C=S.valueSrc,w=S.valueType;if(F!==void 0){var E=Yp(n,r,s,F,v,d,y,m??w,f);return E}}}},qS=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return i==="func"?Zp(e,r,n,o):vd(e,r,n,o)},fd=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=r.get("field"),l=r.get("valueSrc"),c=r.get("valueType");(s=="!case_value"||c&&c.get(0)=="case_value")&&(u="!case_value");var d=Ze(e,u)||{},f=Mt(e,i,u)||{},p=Mr(f),v=r.get("value"),y=r.get("asyncListValues"),m=[],S=[],F;if(v!=null){var C=v.map(function(E,_){var A=l?l.get(_):null,N=c?c.get(_):null,X=Ui(E,A,e),H=vr(e,u,i,A),W=rn(e,u,i,H,A,{forExport:!0}),J=pd(n,e,X,A,N,W,d,i,f,o,y);return J!==void 0&&(m.push(A),S.push(N)),J}),w=C.filter(function(E){return E===void 0}).size>0;C.size<p||w||(F=p>1?C.toArray():p==1?C.first():null)}return{value:F,valueSrc:m.length>1?m:m[0],valueType:S.length>1?S:S[0]}},pd=function(e,r,n,i,o,s,u,l,c){var d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,f=arguments.length>10?arguments[10]:void 0;if(n!==void 0){var p;if(i==="field"){var v;p=(v=vd(e,r,n,d))===null||v===void 0?void 0:v.value}else if(i==="func"){var y;p=(y=Zp(e,r,n,d,o))===null||y===void 0?void 0:y.value}else if(typeof s?.spelFormatValue=="function"){var m=s.spelFormatValue,S=[n,zp(zp({},ya()(u,["fieldSettings","listValues"])),{},{asyncListValues:f}),Nn(s,Vi)];if(l&&(S.push(l),S.push(c)),i=="field"){var F=Ze(r,n)||{};S.push(F)}p=m.call.apply(m,[r.ctx].concat(S))}else p=$i(n);return p}},vd=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(n){var o=r.settings.fieldSeparator,s=Ze(r,n)||{},u=br(n,r),l=Ef(n,r,i),c=r.settings.formatSpelField,d=Ga(n,r,e,i),f=l.map(function(v){var y=Ce(v,3),m=y[0],S=y[1],F=y[2],C;F&&(F.type=="!struct"||F.type=="!group"&&F.mode=="struct"?C=S!=null&&S.isSpelMap?"map":"class":F.type=="!group"?C=S!=null&&S.isSpelItemMap?"[map]":"[class]":C="class");var w=S?.isSpelVariable;return{key:m,parent:C,isSpelVariable:w,fieldSeparator:o}}),p=c.call(r.ctx,d,i,u,f,s,r);return{value:p,valueSrc:"field",valueType:s?.type}}},Zp=function(e,r,n){var i,o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,l=(i=n.get)===null||i===void 0?void 0:i.call(n,"func"),c=(o=n.get)===null||o===void 0?void 0:o.call(n,"args"),d=kr(r,l);if(!d){e.errors.push("Func ".concat(l," is not defined in config"));return}var f={},p=[],v=[];for(var y in d.args){var m,S,F=d.args[y],C=Ze(r,F),w=F.defaultValue,E=F.isOptional,_=w!=null&&w.func?"func":"value",A=c?c.get(y):void 0,N=A?A.get("value"):void 0,X=A?A.get("valueSrc"):void 0;X!=="func"&&(m=N)!==null&&m!==void 0&&m.toJS&&(N=N.toJS());var H=A?A.get("asyncListValues"):void 0,W=(S=F.escapeForFormat)!==null&&S!==void 0?S:!0,J=null,Y=vr(r,F,J,X),K=rn(r,F,J,Y,X,{forExport:!0}),ae=pd(e,r,N,X,F.type,K,C,null,null,s,H);if(N!=null&&ae===void 0){X!="func"&&e.errors.push("Can't format value of arg ".concat(y," for func ").concat(l));return}var se=void 0;if(ae===void 0&&!E&&w!=null){var re=vr(r,F,J,_),ie=rn(r,F,J,re,_,{forExport:!0});if(se=pd(e,r,w,_,F.type,ie,C,null,null,s,H),se===void 0){_!="func"&&e.errors.push("Can't format default value of arg ".concat(y," for func ").concat(l));return}}var ne=ae??se;if(ne!==void 0){if(p.length){var de=Up(p),le;try{for(de.s();!(le=de.n()).done;){var fe=le.value;f[fe]=void 0}}catch(Oe){de.e(Oe)}finally{de.f()}p=[]}f[y]=W?ne:N??w}else E||v.push(y),p.push(y)}if(!v.length){var ve;if(typeof d.spelFormatFunc=="function"){var ye=d.spelFormatFunc,we=[f];ve=ye.call.apply(ye,[r.ctx].concat(we))}else if(d.spelFunc){ve=d.spelFunc.replace(/\${(\w+)}/g,function(Oe,Ve){var ke;return(ke=f[Ve])!==null&&ke!==void 0?ke:Oe});var xe=Object.keys(d.args||{}).reverse().filter(function(Oe){return!!d.args[Oe].isOptional}),Fe=Up(xe),ze;try{for(Fe.s();!(ze=Fe.n()).done;){var _e=ze.value;if(f[_e]!=null)break;ve=ve.replace(new RegExp("(, )?\\${"+_e+"}","g"),"")}}catch(Oe){Fe.e(Oe)}finally{Fe.f()}ve=ve.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(l," is not supported"));return{value:ve,valueSrc:"func",valueType:d.returnType}}};function ev(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=HS(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function HS(a,e){if(a){if(typeof a=="string")return tv(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tv(a,e):void 0}}function tv(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function rv(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function nv(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rv(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):rv(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var av=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o={errors:[],settings:{isForDisplay:n,isDebugMode:i}},s=Vn(r,void 0,!1),u=iv([],e,s,o,null);return o.errors.length&&console.warn("Errors while exporting to string:",o.errors),u},iv=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(r){var s=r.get("type"),u=r.get("children1");if(s==="group"||s==="rule_group")return QS(e,r,n,i,o);if(s==="rule")return ov(e,r,n,i,o)}},QS=function(e,r,n,i){var o,s,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,l=i.settings,c=l.isForDisplay,d=l.isDebugMode,f=r.get("type"),p=r.get("properties")||new Wt,v=p.get("mode"),y=r.get("children1")||new Pn,m=u,S=f==="rule_group",F=S&&v=="array"?p.get("field"):null,C=f==="rule_group"?p.get("operator"):null,w=C?(o=(s=n.operators[C])===null||s===void 0?void 0:s.cardinality)!==null&&o!==void 0?o:1:void 0,E=S&&v==="array"&&w>=1,_=p.get("not"),A=y.map(function(se){return iv([].concat(Pe(e),[r]),se,n,i,F??m)}).filter(function(se){return typeof se<"u"});if(!(!E&&!A.size&&!d)){var N=p.get("conjunction");N||(N=li(n));var X=n.conjunctions[N],H=A.size?X.formatConj.call(n.ctx,A,N,_,c):null,W;if(F){var J=ov(e,r,n,i,m,!0);if(J){var Y,K=J.pop(),ae=[H].concat(Pe(J));W=(Y=n.settings.formatAggr).call.apply(Y,[n.ctx].concat(Pe(ae))),K&&(W=n.settings.formatReverse.call(n.ctx,W,null,null,null,null,c))}}else W=H;return d&&W==null&&(W="?"),W}},JS=function(e,r,n,i,o){var s=n.settings,u=s.isForDisplay,l=s.isDebugMode,c=r.get("field"),d=r.get("valueSrc"),f=r.get("valueType"),p=Ze(e,c)||{},v=i||r.get("operator"),y=Mt(e,v,c)||{},m=Mr(y),S=r.get("value"),F=r.get("asyncListValues"),C=[],w=[],E,_;if(S!=null){_=S.map(function(X,H){var W=d?d.get(H):null,J=f?f.get(H):null,Y=l?X:Ui(X,W,e),K=vr(e,c,v,W),ae=rn(e,c,v,K,W,{forExport:!0}),se=gd(e,n,Y,W,J,ae,p,v,y,o,F);return se!==void 0&&(C.push(W),w.push(J)),se});var A=_.filter(function(X){return X===void 0}).size>0,N=!A&&_.size===m;N&&(E=m==1?_.first():_)}return l&&!E&&(E=m>1?new Pn(Array.from({length:m}).map(function(X,H){var W,J;return(W=(J=_)===null||J===void 0?void 0:J.get(H))!==null&&W!==void 0?W:"?"})):"?"),[E,C.length>1?C:C[0],w.length>1?w:w[0]]},YS=function(e,r,n){var i=n.settings.isDebugMode,o=r?.labelForFormat||e,s=Mr(r),u;return s==0?u=function(c,d,f,p,v,y,m,S){return"".concat(c," ").concat(o)}:s==1?u=function(c,d,f,p,v,y,m,S){return i&&d==="?"&&f==="?"?c&&c!=="?"?"".concat(c," ?"):"?":"".concat(c," ").concat(o," ").concat(f)}:s==2&&(u=function(c,d,f,p,v,y,m,S){var F,C,w=f==null||(F=f.first)===null||F===void 0?void 0:F.call(f),E=f==null||(C=f.get)===null||C===void 0?void 0:C.call(f,1);return"".concat(c," ").concat(o," ").concat(w," AND ").concat(E)}),u},ov=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,u=i.settings,l=u.isForDisplay,c=u.isDebugMode,d=r.get("properties")||new Wt,f=d.get("field"),p=d.get("fieldSrc"),v=d.get("operator"),y=d.get("operatorOptions");if(!((f==null||v==null)&&!c)){var m=Ze(n,f)||{},S=Mt(n,v,f)||{},F=S.reversedOp,C=Mt(n,F,f)||{},w=!1,E=S.formatOp;if(!E&&F&&(E=C.formatOp,E)){w=!0;var _=[F,v];v=_[0],F=_[1];var A=[C,S];S=A[0],C=A[1]}if(c&&!v&&(v="?"),E||(E=YS(v,S,i)),!!E){var N=p==="func"?uv(n,i,f,o):sv(n,i,f,o);if(N!=null){var X=JS(n,d,i,v,o),H=Ce(X,3),W=H[0],J=H[1],Y=H[2];if(W!==void 0){var K=[N,v,W,J,Y,Nn(S,Fo),y,l,m,w];if(s)return K;var ae,se=(ae=E).call.apply(ae,[n.ctx].concat(K));return w&&(se=n.settings.formatReverse.call(n.ctx,se,v,F,S,C,l)),se}}}}},gd=function(e,r,n,i,o,s,u,l,c){var d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,f=arguments.length>10?arguments[10]:void 0,p=r.settings,v=p.isForDisplay,y=p.isDebugMode;if(n===void 0)return y?s?.jsType==="array"?[]:"?":void 0;var m;if(i=="field")m=sv(e,r,n,d);else if(i=="func")m=uv(e,r,n,d);else if(n==null)m=void 0;else if(typeof s?.formatValue=="function"){var S,F=s.formatValue,C=[n,nv(nv({},ya()(u,["fieldSettings","listValues"])),{},{asyncListValues:f}),Nn(s,Vi),v];if(l&&(C.push(l),C.push(c)),i=="field"){var w=Ze(e,n)||{};C.push(w)}var E=(S=u?.escapeForFormat)!==null&&S!==void 0?S:!0;E?m=F.call.apply(F,[e.ctx].concat(C)):m=n}else m=n;return m},sv=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=r.settings,u=s.isForDisplay,l=s.isDebugMode,c=e.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=null;if(n){var v=Ze(e,n)||{},y=br(n,e),m=Bs(n,e,o?i:null),S=m?m.join(f):null,F=v.label2||S,C=e.settings.formatField,w=Ga(n,e,r,o?i:null,{useTableName:!0});p=C(w,y,F,v,e,u)}else l&&(p="?");return p},uv=function(e,r,n){var i,o,s,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=r.settings,c=l.isForDisplay,d=l.isDebugMode,f=n==null||(i=n.get)===null||i===void 0?void 0:i.call(n,"func");if(!f)return d?"?()":void 0;var p=(o=n.get)===null||o===void 0?void 0:o.call(n,"args"),v=kr(e,f);if(!v&&!d){r.errors.push("Func ".concat(f," is not defined in config"));return}var y=br(f,e),m=y[y.length-1],S=c&&v?.label||m,F={},C=[],w=[],E={},_=v?Object.keys(v.args||{}):(p==null||(s=p.keySeq)===null||s===void 0?void 0:s.call(p).toArray())||[],A=ev(_),N;try{for(A.s();!(N=A.n()).done;){var X,H=N.value,W=v?.args[H],J=Ze(e,W),Y=W||{},K=Y.defaultValue,ae=Y.isOptional,se=K!=null&&K.func?"func":"value",re=rn(e,W,void 0,void 0,se,{forExport:!0}),ie=c&&W?.label||H,ne=p?p.get(H):void 0,de=ne?ne.get("value"):void 0,le=ne?ne.get("valueSrc"):void 0;le!=="func"&&(X=de)!==null&&X!==void 0&&X.toJS&&(de=de.toJS());var fe=ne?ne.get("asyncListValues"):void 0,ve=gd(e,r,de,le,W?.type,re,W,null,null,u,fe);de!=null&&ve===void 0&&le!="func"&&r.errors.push("Can't format value of arg ".concat(H," for func ").concat(f));var ye=void 0;if(ve===void 0&&!ae&&K!=null&&(ye=gd(e,r,K,se,W?.type,re,W,null,null,u,fe),ye===void 0)){se!="func"&&r.errors.push("Can't format default value of arg ".concat(H," for func ").concat(f));return}var we=ve??ye;if(we!==void 0){if(C.length){var xe=ev(H),Fe;try{for(xe.s();!(Fe=xe.n()).done;){var ze=Ce(Fe.value,2),_e=ze[0],Oe=ze[1];F[_e]=void 0}}catch($e){xe.e($e)}finally{xe.f()}C=[]}F[H]=we,E[ie]=we}else ae||w.push(H),C.push([H,ie])}}catch($e){A.e($e)}finally{A.f()}if(!(w.length&&!d)){var Ve=null;if(typeof v?.formatFunc=="function"){var ke=v.formatFunc,De=[F,c];Ve=ke.call.apply(ke,[e.ctx].concat(De))}else{var Ke=Object.entries(c?E:F).map(function($e){var Je=Ce($e,2),ut=Je[0],Xe=Je[1];return c?"".concat(ut,": ").concat(Xe):"".concat(Xe)}).join(", ");Ve="".concat(S,"(").concat(Ke,")")}return Ve}};function lv(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function cv(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lv(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):lv(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function XS(a){if(a==null)return null;var e=a.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function ZS(a,e){if(a.length>1)return{gte:"".concat(a[0]),lte:"".concat(a[1])};var r=a[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}function eb(a){return{value:"*"+a+"*"}}function tb(a,e){switch(a){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function rb(a){return{value:a}}function nb(a,e){return a}function ab(a,e,r,n,i,o){var s=nb(n,i);switch(a){case"filter":return{script:i.operators[r].elasticSearchScript(n,e)};case"exists":return{field:n};case"match":return Se({},s,e[0]);case"term":return o===ob?Se({},n,{value:e[0]}):Se({},n,e[0]);case"geo_bounding_box":return Se({},n,XS(e[0]));case"range":return Se({},n,ZS(e,r));case"wildcard":return Se({},n,eb(e[0]));case"regexp":return Se({},n,rb(e[0]));default:return}}function dv(a,e,r,n,i,o){if(!(!a||!r||e==null)){var s=r,u=n.operators[s];if(u){var l=u,c=l.elasticSearchQueryType,d=!1;if(!c&&u.reversedOp){d=!0,s=u.reversedOp,u=n.operators[s];var f=u;c=f.elasticSearchQueryType}var p=vr(n,a,s,i),v=n.widgets[p];if(v){var y=v.elasticSearchFormatValue,m;if(typeof c=="function"?m=c(p):m=c,!!m){var S;return typeof y=="function"?S=y(m,e,s,a,n):S=ab(m,e,s,a,n,o),d?{bool:{must_not:Se({},m,cv({},S))}}:Se({},m,cv({},S))}}}}}function ib(a,e,r,n,i,o){if(!(!a||!a.size)){var s=a.valueSeq().toArray(),u=tb(e,r),l=s.map(function(d){return n(d,i,o)}).filter(function(d){return d!==void 0});if(l.length){var c=l.flat(1/0);return{bool:Se({},u,c)}}}}var ob="ES_7_SYNTAX",sb="ES_6_SYNTAX";function fv(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sb,n=Vn(e,void 0,!1);if(a){var i=a.get("type"),o=a.get("properties")||new Map;if(i==="rule"&&o.get("field")){var s,u,l,c=o.get("operator"),d=o.get("field"),f=o.get("fieldSrc"),p=(s=o.get("value"))===null||s===void 0?void 0:s.toJS(),v=(u=o.get("valueType"))===null||u===void 0?void 0:u.get(0),y=(l=o.get("valueSrc"))===null||l===void 0?void 0:l.get(0);return y==="func"||f=="func"?void 0:p&&Array.isArray(p[0])?p[0].map(function(C){return dv(d,[C],c,n,y,r)}):dv(d,p,c,n,y,r)}if(i==="group"||i==="rule_group"){var m=o.get("not"),S=o.get("conjunction");S||(S=li(n));var F=a.get("children1");return ib(F,S,m,fv,n,r)}}}var ub=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var i=e;return i=i.toJS(),i=xf(i,r,n),i}},hd=function(e){if(pv(e))return e;if(vv(e))return ua(Eo(e));if(typeof e=="string"&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if(typeof e=="string")return ua(Eo(JSON.parse(e)));throw new Error("Can't load tree!")},pv=function(e){return Wt.isMap(e)},vv=function(e){return Ye(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function gv(a){return Me(a)||La(a)||sr(a)||wr()}function hv(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Oa(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hv(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):hv(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function md(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=lb(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function lb(a,e){if(a){if(typeof a=="string")return mv(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mv(a,e):void 0}}function mv(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}var cb=function(e){return Array.from(new Set(e))},yv="jlField",Sv="jlRawField",bv="jlHavingMarker",yd=new Proxy({__name:"jlArgs",__test:function(e){var r,n=e==null||(r=e.match)===null||r===void 0?void 0:r.call(e,/jlArgs\[(\d+)\]/);if(n)return parseInt(n[1])}},{get:function(e,r){return isNaN(parseInt(r))?e[r]:"jlArgs["+r+"]"}}),db=["==","!=","datetime==","datetime!=","date==","date!="],fb=["<","<=",">",">="],Ov=["in","!in"],pb=["multiselect_equals","multiselect_not_equals","multiselect_contains","multiselect_not_contains"],Fv=function(e){return{errors:[],settings:e?.settings}},vb=function(e,r){return Tv(e,r,!1)},Tv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Fv();i.settings={allowUnknownFields:!1,returnErrors:n};var o=Vn(r,void 0,!1),s=gb(o),u=e?fi(e,s,o,["rule","group","switch","case_val"],i):void 0,l=u?hd(u):void 0;return i.errors=Array.from(new Set(i.errors)),n?[l,i.errors]:(i.errors.length&&console.warn("Errors while importing from JsonLogic:",i.errors),l)},gb=function(e){var r={},n={},i=function(_){var A=e.operators[_],N=Mr(A);if(typeof A.jsonLogic=="string"){var X=A.jsonLogic+"/"+N;r[X]||(r[X]=[]),r[X].push(_)}else if(typeof A.jsonLogic=="function"){var H,W,J,Y,K;try{K=A.jsonLogic(yv,_,yd,A,new be.Map({having:bv,groupField:Sv}))}catch(ne){return console.warn("Error while running JsonLogic template for op ".concat(_),ne),1}var ae=Object.keys(K)[0],se=(H=A.jsonLogic2)===null||H===void 0?void 0:H.startsWith("#"),re=(W=(J=A.jsonLogic2)===null||J===void 0?void 0:J.replace(/^#/,""))!==null&&W!==void 0?W:ae,ie=(Y=A.jsonLogicOps)!==null&&Y!==void 0?Y:[re];ie.map(function(ne){var de=ne+"/"+N;r[de]||(r[de]=[]),r[de].push(_)}),n[_]||(n[_]={}),n[_]={template:K,newOp:re,_jsonLogicIsExclamationOp:!!A._jsonLogicIsExclamationOp,isRevArgs:se}}};for(var o in e.operators)i(o);var s={};for(var u in e.conjunctions){var l=e.conjunctions[u],c=l.jsonLogicConj||u.toLowerCase();s[c]=u}var d={},f=md(ks(e)),p;try{for(f.s();!(p=f.n()).done;){var v=Ce(p.value,2),y=v[0],m=v[1],S=void 0;m.jsonLogicIsMethod?S="#"+m.jsonLogic:typeof m.jsonLogic=="string"&&(S=m.jsonLogic),S&&(d[S]||(d[S]=[]),d[S].push(y))}}catch(E){f.e(E)}finally{f.f()}var F=e.settings.jsonLogic,C=F.groupVarKey,w=F.altVarKey;return{operators:r,conjunctions:s,funcs:d,varKeys:["var",C,w],combinationOperators:n}},Sd=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o;if(r!=null&&r.combinationOperators)for(var s=0,u=Object.entries(r.combinationOperators);s<u.length;s++){var l=Ce(u[s],2),c=l[0],d=l[1];if(i==null||i.includes(c)){var f=Cv(d.template,e);f.match&&(o?n.errors.push("Operator matched against 2 templates: ".concat(o.newOp," and ").concat(c)):o=f,o.newOp=d.newOp)}}return o},Cv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{match:!0,jlField:null,jlArgs:[],jlHaving:null};if(e==null||r==null)return n.match=!1,n;var i=Object.keys(e),o=Object.keys(r);if(i.length!==o.length)return n.match=!1,n;n.vals=[];for(var s=0;s<i.length;s++){var u=i[s],l=e[u];if(n.vals.push(r[u]),u!==o[s])return n.match=!1,n;var c=yd.__test(l);if(c!==void 0)n.jlArgs[c]=r[u];else if(l===yv&&On(r[u]))n.jlField=r[u];else if(l===Sv)n.jlField={var:r[u]};else if(l===yd)n.jlArgs.push(r[u]);else if(l===bv)n.jlHaving=r[u];else if(Ye(l)==="object"&&l!==null||Array.isArray(l))n=Cv(l,r[u],n);else if(l!==r[u])return n.match=!1,n}return n},fi=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,u=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,f,p;On(e)&&(f=Object.keys(e)[0],p=e[f],Array.isArray(p)||(p=[p]));var v,y=o.errors.length,m=n.settings.jsonLogic.lockedOp,S=f=="!"&&p.length==1&&p[0]&&On(p[0])&&r.varKeys.includes(Object.keys(p[0])[0]),F=Sd(e,r,o);F&&(p=[],p[0]=F.jlField,F.jlHaving&&p.push(F.jlHaving),F.jlArgs.forEach(function(H){return p.push(H)}),f=F.newOp,Ov.includes(f)&&(p=F.vals));var C=f=="!"&&!S,w=m&&f==m,E=i.includes("switch"),_=E;if(w)v=fi(p[0],r,n,i,o,s,u,l,c,!0);else if(C)v=fi(p[0],r,n,i,o,!s,u,l,c);else if(i.includes("val"))v=Ev(f,p,r,n,s,o,c)||wv(f,p,r,n,s,u,o,c)||hb(e,u,l,n,o);else{var A=Pe(o.errors);i.includes("switch")&&(v=Cb(f,p,r,n,s,o,c)),v==null&&i.includes("group")&&(v=xv(f,p,r,n,s,o,c,!1)),v==null&&i.includes("rule")&&(v=Lv(f,p,r,n,s,o,c));var N=Pe(o.errors);v==null&&i.includes("case_val")&&(o.errors=A,v=Tb(f,p,r,n,s,o,c),v==null&&(o.errors=N)),v&&_&&!["group","switch_group"].includes(v.type)&&(v=Ks(v,n))}var X=o.errors.length;return f!="!"&&v===void 0&&X==y&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),w&&(v.properties.isLocked=!0),v},hb=function(e,r,n,i,o){var s;if(e===void 0&&(e=r?.defaultValue),e!==void 0){n=n||r?.mainWidget;var u=i.widgets[n],l=r?.type;if(l&&!u){o.errors.push("No widget for type ".concat(l));return}if(On(e)){o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(u!=null&&u.jsonLogicImport)try{var c;e=u.jsonLogicImport.call(i.ctx,e,Oa(Oa({},u),(c=r?.fieldSettings)!==null&&c!==void 0?c:{}))}catch(A){var d;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(n,": ").concat((d=A?.message)!==null&&d!==void 0?d:A)),e=void 0}else{if(l==="time"&&typeof e=="number"){var f=Math.floor(e/60/60)%24,p=Math.floor(e/60)%60,v=e%60,y=u.valueFormat;if(y){var m=new Date(e);m.setMilliseconds(0),m.setHours(f),m.setMinutes(p),m.setSeconds(v),e=Rt()(m).format(y)}else e="".concat(f,":").concat(p,":").concat(v)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var S=typeof e=="number"||typeof e=="string"&&!isNaN(e),F=S&&typeof e=="string"?parseInt(e):e,C=new Date(S?F:e);if(C instanceof Date&&(e=C),isNaN(C))throw new Error("Invalid date")}catch{o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}}if(e instanceof Date&&r){var w=u.valueFormat;w&&(e=Rt()(e).format(w))}var E;if(e&&r!==null&&r!==void 0&&(s=r.fieldSettings)!==null&&s!==void 0&&s.asyncFetch){var _=Array.isArray(e)?e:[e];E=_}return{valueSrc:"value",value:e,valueType:u?.type,asyncListValues:E}}},Ev=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(n.varKeys.includes(e)&&typeof r[0]=="string"){var l,c=Sf(i,r[0],u),d=Ze(i,c);if(!d&&!((l=s.settings)!==null&&l!==void 0&&l.allowUnknownFields)){s.errors.push("No config for field ".concat(c));return}return{valueSrc:"field",value:c,valueType:d?.type}}},mb=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,d=o.operators[e],f=!!d,p=Object.keys(r)[0],v=Object.values(r)[0],y=function(ie,ne){return yb(ie,ne,i,o,s,l,c)||Sb(ie,ne,i,o,s,u,l,c)},m=l.errors.length,S,F,C,w=y(p,v);if(w&&(S=w.field,F=w.fieldSrc),f&&(C=n[0],n=n.splice(1)),p=="reduce"&&Array.isArray(v)&&v.length==3){var E=v,_=Ce(E,3),A=_[0],N=_[1],X=_[2];if(On(A)&&X==0&&On(N)&&Array.isArray(N["+"])&&N["+"][0]==1&&On(N["+"][1])&&N["+"][1].var=="accumulator")if(p=Object.keys(A)[0],v=Object.values(A)[0],p=="filter"){var H=v,W=Ce(H,2),J=W[0],Y=W[1];if(On(J)){p=Object.keys(J)[0],v=Object.values(J)[0];var K=y(p,v);K&&(S=K.field,F=K.fieldSrc,C=Y,f=!0)}}else{var ae=y(p,v);ae&&(S=ae.field,F=ae.fieldSrc,f=!0)}}var se=l.errors.length;if(!S&&se==m&&l.errors.push("Unknown LHS ".concat(JSON.stringify(r))),!!S)return{field:S,fieldSrc:F,having:C,isGroup:f,args:n}},yb=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(r)||(r=[r]);var l=Ev(e,r,n,i,o,s,u);if(l)return{fieldSrc:"field",field:l.value}},Sb=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=wv(e,r,n,i,o,s,u,l);if(c)return{fieldSrc:"func",field:c.value}},wv=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var c,d,f,p=e=="method";if(p){var v,y,m=gv(r);v=m[0],c=m[1],y=m.slice(2),d=[v].concat(Pe(y))}else c=e,d=r;var S=(p?"#":"")+c,F=s?.type||s?.returnType,C=(n.funcs[S]||[]).filter(function(ie){return s?kr(i,ie).returnType==F:!0});if(C.length)f=C[0];else{var w=Se({},e,r),E=md(ks(i)),_;try{for(E.s();!(_=E.n()).done;){var A=Ce(_.value,2),N=A[0],X=A[1];if(X.jsonLogicImport&&(!F||X.returnType==F)){var H=void 0;try{H=X.jsonLogicImport.call(i.ctx,w)}catch{}H&&(f=N,d=H)}}}catch(ie){E.e(ie)}finally{E.f()}}if(f&&f){var W=kr(i,f),J=Object.keys(W.args||{}),Y=d.reduce(function(ie,ne,de){var le=J[de],fe=W.args[le],ve;return fe&&(ve=fi(ne,n,i,["val"],u,!1,fe,null,l)),ve!==void 0?Oa(Oa({},ie),{},Se({},le,ve)):ie},{});for(var K in W.args){var ae=W.args[K],se=Y[K];if(se===void 0){if(se=ae?.defaultValue,se!==void 0){var re;se={value:se,valueSrc:(re=se)!==null&&re!==void 0&&re.func?"func":"value",valueType:ae.type}}if(se===void 0){if(!(ae!=null&&ae.isOptional)){u.errors.push("No value for arg ".concat(K," of func ").concat(f));return}}else Y[K]=se}}return{valueSrc:"func",value:{func:f,args:Y},valueType:W.returnType}}}},xv=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,c=n.conjunctions[e],d=i.settings.fieldSeparator;if(c){var f="group",p=r.map(function(w){return fi(w,n,i,["rule","group"],s,!1,null,null,u)}).filter(function(w){return w!==void 0}).reduce(function(w,E){return Oa(Oa({},w),{},Se({},E.id,E))},{}),v=Object.values(p).map(function(w){var E,_;return(w==null||(E=w.properties)===null||E===void 0?void 0:E.fieldSrc)=="field"&&(w==null||(_=w.properties)===null||_===void 0?void 0:_.field)}).filter(function(w){var E;return w==null||(E=w.includes)===null||E===void 0?void 0:E.call(w,d)}),y=Object.fromEntries(cb(v).map(function(w){var E=w.split(d),_=Object.fromEntries(E.slice(0,-1).map(function(A,N,X){return[].concat(Pe(X.slice(0,N)),[A])}).map(function(A){return[A.join(d),Ze(i,A)]}).filter(function(A){var N=Ce(A,2),X=N[0],H=N[1];return H?.type=="!group"}));return[w,Object.keys(_)]})),m={conjunction:c,not:o},S=Qe(),F={},C={};return Object.entries(p).map(function(w){var E=Ce(w,2),_=E[0],A=E[1];if(A?.type=="group"||A?.type=="rule_group")F[_]=A;else{var N,X=A==null||(N=A.properties)===null||N===void 0?void 0:N.field,H=y[X]||[],W=H[H.length-1];if(!W)A&&(F[_]=A);else{var J=F,Y=br(u,i),K=br(W,i),ae=Ds(Y,K.slice(0,Y.length));ae||(Y=[]);var se=W.split(d).slice(Y.length).map(function(re,ie,ne){return[].concat(Pe(Y),Pe(ne.slice(0,ie)),[re]).join(d)}).map(function(re){return{f:re,fc:Ze(i,re)||{}}}).filter(function(re){var ie=re.fc;return ie.type!="!struct"});se.map(function(re,ie){var ne=re.f,de=re.fc,le=C[ne];le||(le=Qe(),C[ne]=le,J[le]={type:"rule_group",id:le,children1:{},properties:{conjunction:c,not:!1,field:ne,fieldSrc:"field",mode:de.mode}}),J=J[le].children1}),J[_]=A}}}),{type:f,id:S,children1:F,properties:m}}},bb=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(e)return{type:"rule_group",id:Qe(),children1:Se({},e.id,e),properties:{conjunction:o||ci(i,n),not:s,field:r}}},Ks=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:Qe(),children1:Se({},e.id,e),properties:{conjunction:ci(r),not:n}}},Ob=function(e,r,n,i,o,s,u){var l=Fv(u),c=Fb(e,r,n,i,o,s,l);if(!c){u.errors.push(Array.from(new Set(l.errors)).join("; ")||"Unknown op ".concat(e,"/").concat(r));return}return c},Fb=function(e,r,n,i,o,s,u){var l,c=pb.map(function(ne){var de;return(de=s.operators[ne])===null||de===void 0?void 0:de.jsonLogic2}).includes(e),d=s.settings.groupOperators.find(function(ne){var de=s.operators[ne];return[ne,typeof de.jsonLogic=="string"&&de.jsonLogic,de.jsonLogic2].includes(e)}),f=s.operators[d],p=d&&f?.cardinality==0&&!c,v=(l=f?.cardinality)!==null&&l!==void 0?l:r-1;!p&&db.includes(e)&&v==1&&n[1]===null&&(r=1,v=0,n=[n[0]]);var y=e+"/"+v,m=o.operators[y];if(m){var S=[],F=md(m),C;try{for(F.s();!(C=F.n()).done;){var w,E,_=C.value,A=void 0,N=[];if(fb.includes(e)&&r==3)A=n[1],N=[n[0],n[2]];else{var X=n,H=gv(X);A=H[0],N=H.slice(1)}if((w=o.combinationOperators[_])!==null&&w!==void 0&&w.isRevArgs&&(A=n[n.length-1],N=n.slice(0,n.length-1)),!!On(A)){var W=mb(d,A,N,o,s,null,null,u,i);if(W){var J=W.field,Y=W.fieldSrc,K=W.having,ae=W.isGroup,se=W.args,re=Ze(s,J);if(!re&&!((E=u.settings)!==null&&E!==void 0&&E.allowUnknownFields)){u.errors.push("No config for LHS ".concat(J));return}var ie=re?.operators&&re.operators.includes(_);S.push({field:J,fieldSrc:Y,fieldConfig:re,opKey:_,args:se,having:K,isValidOp:ie})}}}}catch(ne){F.e(ne)}finally{F.f()}return S.sort(function(ne){var de=ne.isValidOp;return de?-1:1}),S[0]}},Lv=function(e,r,n,i,o,s){var u,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;if(e){var d=Object.values(i.conjunctions).map(function(Fe){var ze=Fe.jsonLogicConj;return ze}),f=r.length,p=Ob(e,f,r,l,n,i,s);if(p){var v=p.field,y=p.fieldSrc,m=p.fieldConfig,S=p.opKey,F=p.args,C=p.having,w=Ze(i,l),E=i.operators[S],_=i.operators[(u=E)===null||u===void 0?void 0:u.reversedOp],A=!1,N=!!_,X=m.type=="!group",H=w?.type=="!group",W=N&&(!!i.settings.reverseOperatorsForNot||A||X&&!C||!X&&H&&!c),J=o&&W||A,Y,K,ae=!1,se=!!i.settings.reverseOperatorsForNot;if(m?.type=="!group"&&C){Y=Object.keys(C)[0],K=C[Y],Array.isArray(K)||(K=[K]);for(var re=Sd(C,n,s);Y=="!"&&!re;){var ie=Y=="!"&&K.length==1&&K[0]&&On(K[0])&&n.varKeys.includes(Object.keys(K[0])[0]);if(ie)break;ae=!ae,C=C["!"],Y=Object.keys(C)[0],K=C[Y],se&&d.includes(Y)&&K.length==1&&(C=C[Y][0],Y=Object.keys(C)[0],K=C[Y]);var ne=Sd(C,n,s);re=ne||re}Array.isArray(K)||(K=[K]),re&&(K=[],K[0]=re.jlField,re.jlArgs.forEach(function(Fe){return K.push(Fe)}),Y=re.newOp,Ov.includes(re.newOp)&&(K=re.vals))}J&&(o=!o,S=E.reversedOp,E=i.operators[S]);var de=vr(i,v,S,null),le=F.map(function(Fe){return fi(Fe,n,i,["val"],s,!1,m,de,l)});if(!le.filter(function(Fe){return Fe===void 0}).length){var fe,ve=m?.type;if((ve==="!group"||ve==="!struct")&&(ve=null),m?.type=="!group"&&C){if(n.conjunctions[Y]!==void 0)fe=xv(Y,K,n,i,ae,s,v,!0);else if(fe=Lv(Y,K,n,i,ae,s,v,!0),fe){var ye;fe.type==="rule_group"&&((ye=fe.properties)===null||ye===void 0?void 0:ye.field)!==v&&(fe=bb(fe,v,m,i)),Object.assign(fe.properties,{conjunction:ci(i,m)})}if(!fe)return;fe.type="rule_group",Object.assign(fe.properties,{field:v,mode:m.mode,operator:S}),m.mode=="array"&&Object.assign(fe.properties,{value:le.map(function(Fe){return Fe.value}),valueSrc:le.map(function(Fe){return Fe.valueSrc}),valueType:le.map(function(Fe){return Fe.valueType})}),o&&(fe=Ks(fe,i,o))}else if(m?.type=="!group"&&!C)fe={type:"rule_group",id:Qe(),children1:{},properties:{conjunction:ci(i,m),not:!1,mode:m.mode,field:v,operator:S}},m.mode==="array"&&Object.assign(fe.properties,{value:le.map(function(Fe){return Fe.value}),valueSrc:le.map(function(Fe){return Fe.valueSrc}),valueType:le.map(function(Fe){return Fe.valueType})}),o&&(fe=Ks(fe,i,o));else{var we=le.map(function(Fe){return Fe.asyncListValues}).filter(function(Fe){return Fe!=null}),xe=we.length?we[0]:void 0;fe={type:"rule",id:Qe(),properties:Oa({field:v,fieldSrc:y,operator:S,value:le.map(function(Fe){return Fe.value}),valueSrc:le.map(function(Fe){return Fe.valueSrc}),valueType:le.map(function(Fe){return Fe.valueType})},xe?{asyncListValues:xe}:{})},(o||c)&&(fe=Ks(fe,i,o))}return fe}}}},Tb=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=Se({},e,r),c=jv(i,s,n,l);if(c!==void 0){var d=Rv(null,c,i,s),f=[d],p={type:"switch_group",id:Qe(),children1:f,properties:{}};return p}},Cb=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e?.toLowerCase()==="if"){var l=Eb(r),c=l.map(function(p){var v=Ce(p,2),y=v[0],m=v[1];return[y?fi(y,n,i,["rule","group"],s,!1,null,null,u):null,jv(i,s,n,m)]}),d=c.map(function(p){var v=Ce(p,2),y=v[0],m=v[1];return Rv(y,m,i,s)}),f={type:"switch_group",id:Qe(),children1:d,properties:{}};return f}},Eb=function(e){var r=[];function n(i){var o=Ce(i,3),s=o[0],u=o[1],l=o[2];r.push([s,u]);var c=On(l)?Object.keys(l)[0]:null;c?.toLowerCase()==="if"?n(l[c]):r.push([void 0,l])}return n(e),r},Rv=function(e,r,n,i){var o;return e?(o=Oa({},e),o.type?(o.type!="group"&&(o=Ks(o,n)),o.type="case_group"):(i.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0)):o={id:Qe(),type:"case_group",properties:{}},o&&(o.properties=Oa(Oa({},o.properties),r)),o},jv=function(e,r,n,i){var o=Ze(e,"!case_value");if(!o){r.errors.push("Missing caseValueField in settings");return}var s=o.mainWidget,u=e.widgets[s];if(!u){r.errors.push("No widget ".concat(s," for case value"));return}var l=fi(i,n,e,["val","case_val"],r,!1,o,s);if(l!=null){var c=l.value,d=l.valueSrc,f=l.valueType,p={value:[c],valueSrc:[d??"value"],valueType:[f??u?.type],field:"!case_value"};return p}},wb=b(21450),xb=b(90179),El=b.n(xb);const wt=a=>typeof a=="string",qs=()=>{let a,e;const r=new Promise((n,i)=>{a=n,e=i});return r.resolve=a,r.reject=e,r},Iv=a=>a==null?"":""+a,Lb=(a,e,r)=>{a.forEach(n=>{e[n]&&(r[n]=e[n])})},Rb=/###/g,Av=a=>a&&a.indexOf("###")>-1?a.replace(Rb,"."):a,_v=a=>!a||wt(a),Hs=(a,e,r)=>{const n=wt(e)?e.split("."):e;let i=0;for(;i<n.length-1;){if(_v(a))return{};const o=Av(n[i]);!a[o]&&r&&(a[o]=new r),Object.prototype.hasOwnProperty.call(a,o)?a=a[o]:a={},++i}return _v(a)?{}:{obj:a,k:Av(n[i])}},Dv=(a,e,r)=>{const{obj:n,k:i}=Hs(a,e,Object);if(n!==void 0||e.length===1){n[i]=r;return}let o=e[e.length-1],s=e.slice(0,e.length-1),u=Hs(a,s,Object);for(;u.obj===void 0&&s.length;)o=`${s[s.length-1]}.${o}`,s=s.slice(0,s.length-1),u=Hs(a,s,Object),u&&u.obj&&typeof u.obj[`${u.k}.${o}`]<"u"&&(u.obj=void 0);u.obj[`${u.k}.${o}`]=r},jb=(a,e,r,n)=>{const{obj:i,k:o}=Hs(a,e,Object);i[o]=i[o]||[],i[o].push(r)},wl=(a,e)=>{const{obj:r,k:n}=Hs(a,e);if(r)return r[n]},Ib=(a,e,r)=>{const n=wl(a,r);return n!==void 0?n:wl(e,r)},Pv=(a,e,r)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in a?wt(a[n])||a[n]instanceof String||wt(e[n])||e[n]instanceof String?r&&(a[n]=e[n]):Pv(a[n],e[n],r):a[n]=e[n]);return a},jo=a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Ab={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const _b=a=>wt(a)?a.replace(/[&<>"'\/]/g,e=>Ab[e]):a;class Db{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const r=this.regExpMap.get(e);if(r!==void 0)return r;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const Pb=[" ",",","?","!",";"],Nb=new Db(20),Vb=(a,e,r)=>{e=e||"",r=r||"";const n=Pb.filter(s=>e.indexOf(s)<0&&r.indexOf(s)<0);if(n.length===0)return!0;const i=Nb.getRegExp(`(${n.map(s=>s==="?"?"\\?":s).join("|")})`);let o=!i.test(a);if(!o){const s=a.indexOf(r);s>0&&!i.test(a.substring(0,s))&&(o=!0)}return o},bd=function(a,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!a)return;if(a[e])return a[e];const n=e.split(r);let i=a;for(let o=0;o<n.length;){if(!i||typeof i!="object")return;let s,u="";for(let l=o;l<n.length;++l)if(l!==o&&(u+=r),u+=n[l],s=i[u],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&l<n.length-1)continue;o+=l-o+1;break}i=s}return i},xl=a=>a&&a.replace("_","-"),Mb={type:"logger",log(a){this.output("log",a)},warn(a){this.output("warn",a)},error(a){this.output("error",a)},output(a,e){console&&console[a]&&console[a].apply(console,e)}};class Ll{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,r)}init(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=e||Mb,this.options=r,this.debug=r.debug}log(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.forward(r,"log","",!0)}warn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.forward(r,"warn","",!0)}error(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.forward(r,"error","")}deprecate(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(e,r,n,i){return i&&!this.debug?null:(wt(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[r](e))}create(e){return new Ll(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Ll(this.logger,e)}}var Fa=new Ll;class Rl{constructor(){this.observers={}}on(e,r){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const i=this.observers[n].get(r)||0;this.observers[n].set(r,i+1)}),this}off(e,r){if(this.observers[e]){if(!r){delete this.observers[e];return}this.observers[e].delete(r)}}emit(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(s=>{let[u,l]=s;for(let c=0;c<l;c++)u(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(s=>{let[u,l]=s;for(let c=0;c<l;c++)u.apply(u,[e,...n])})}}class Nv extends Rl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const r=this.options.ns.indexOf(e);r>-1&&this.options.ns.splice(r,1)}getResource(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,s=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let u;e.indexOf(".")>-1?u=e.split("."):(u=[e,r],n&&(Array.isArray(n)?u.push(...n):wt(n)&&o?u.push(...n.split(o)):u.push(n)));const l=wl(this.data,u);return!l&&!r&&!n&&e.indexOf(".")>-1&&(e=u[0],r=u[1],n=u.slice(2).join(".")),l||!s||!wt(n)?l:bd(this.data&&this.data[e]&&this.data[e][r],n,o)}addResource(e,r,n,i){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let u=[e,r];n&&(u=u.concat(s?n.split(s):n)),e.indexOf(".")>-1&&(u=e.split("."),i=r,r=u[1]),this.addNamespaces(r),Dv(this.data,u,i),o.silent||this.emit("added",e,r,n,i)}addResources(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const o in n)(wt(n[o])||Array.isArray(n[o]))&&this.addResource(e,r,o,n[o],{silent:!0});i.silent||this.emit("added",e,r,n)}addResourceBundle(e,r,n,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},u=[e,r];e.indexOf(".")>-1&&(u=e.split("."),i=n,n=r,r=u[1]),this.addNamespaces(r);let l=wl(this.data,u)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?Pv(l,n,o):l={...l,...n},Dv(this.data,u,l),s.silent||this.emit("added",e,r,n)}removeResourceBundle(e,r){this.hasResourceBundle(e,r)&&delete this.data[e][r],this.removeNamespaces(r),this.emit("removed",e,r)}hasResourceBundle(e,r){return this.getResource(e,r)!==void 0}getResourceBundle(e,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,r)}:this.getResource(e,r)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const r=this.getDataByLanguage(e);return!!(r&&Object.keys(r)||[]).find(i=>r[i]&&Object.keys(r[i]).length>0)}toJSON(){return this.data}}var Vv={processors:{},addPostProcessor(a){this.processors[a.name]=a},handle(a,e,r,n,i){return a.forEach(o=>{this.processors[o]&&(e=this.processors[o].process(e,r,n,i))}),e}};const Mv={};class jl extends Rl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Lb(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Fa.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const n=this.resolve(e,r);return n&&n.res!==void 0}extractFromKey(e,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let o=r.ns||this.options.defaultNS||[];const s=n&&e.indexOf(n)>-1,u=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Vb(e,n,i);if(s&&!u){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:wt(o)?[o]:o};const c=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(i)}return{key:e,namespaces:wt(o)?[o]:o}}translate(e,r,n){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const i=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:s,namespaces:u}=this.extractFromKey(e[e.length-1],r),l=u[u.length-1],c=r.lng||this.language,d=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(c&&c.toLowerCase()==="cimode"){if(d){const E=r.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${E}${s}`,usedKey:s,exactUsedKey:s,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:`${l}${E}${s}`}return i?{res:s,usedKey:s,exactUsedKey:s,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:s}const f=this.resolve(e,r);let p=f&&f.res;const v=f&&f.usedKey||s,y=f&&f.exactUsedKey||s,m=Object.prototype.toString.apply(p),S=["[object Number]","[object Function]","[object RegExp]"],F=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,C=!this.i18nFormat||this.i18nFormat.handleAsObject,w=!wt(p)&&typeof p!="boolean"&&typeof p!="number";if(C&&p&&w&&S.indexOf(m)<0&&!(wt(F)&&Array.isArray(p))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const E=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,p,{...r,ns:u}):`key '${s} (${this.language})' returned an object instead of string.`;return i?(f.res=E,f.usedParams=this.getUsedParamsDetails(r),f):E}if(o){const E=Array.isArray(p),_=E?[]:{},A=E?y:v;for(const N in p)if(Object.prototype.hasOwnProperty.call(p,N)){const X=`${A}${o}${N}`;_[N]=this.translate(X,{...r,joinArrays:!1,ns:u}),_[N]===X&&(_[N]=p[N])}p=_}}else if(C&&wt(F)&&Array.isArray(p))p=p.join(F),p&&(p=this.extendTranslation(p,e,r,n));else{let E=!1,_=!1;const A=r.count!==void 0&&!wt(r.count),N=jl.hasDefaultValue(r),X=A?this.pluralResolver.getSuffix(c,r.count,r):"",H=r.ordinal&&A?this.pluralResolver.getSuffix(c,r.count,{ordinal:!1}):"",W=A&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),J=W&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${X}`]||r[`defaultValue${H}`]||r.defaultValue;!this.isValidLookup(p)&&N&&(E=!0,p=J),this.isValidLookup(p)||(_=!0,p=s);const K=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&_?void 0:p,ae=N&&J!==p&&this.options.updateMissing;if(_||E||ae){if(this.logger.log(ae?"updateKey":"missingKey",c,l,s,ae?J:p),o){const ne=this.resolve(s,{...r,keySeparator:!1});ne&&ne.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let se=[];const re=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&re&&re[0])for(let ne=0;ne<re.length;ne++)se.push(re[ne]);else this.options.saveMissingTo==="all"?se=this.languageUtils.toResolveHierarchy(r.lng||this.language):se.push(r.lng||this.language);const ie=(ne,de,le)=>{const fe=N&&le!==p?le:K;this.options.missingKeyHandler?this.options.missingKeyHandler(ne,l,de,fe,ae,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(ne,l,de,fe,ae,r),this.emit("missingKey",ne,l,de,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&A?se.forEach(ne=>{const de=this.pluralResolver.getSuffixes(ne,r);W&&r[`defaultValue${this.options.pluralSeparator}zero`]&&de.indexOf(`${this.options.pluralSeparator}zero`)<0&&de.push(`${this.options.pluralSeparator}zero`),de.forEach(le=>{ie([ne],s+le,r[`defaultValue${le}`]||J)})}):ie(se,s,J))}p=this.extendTranslation(p,e,r,f,n),_&&p===s&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${s}`),(_||E)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${s}`:s,E?p:void 0):p=this.options.parseMissingKeyHandler(p))}return i?(f.res=p,f.usedParams=this.getUsedParamsDetails(r),f):p}extendTranslation(e,r,n,i,o){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const c=wt(e)&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(c){const p=e.match(this.interpolator.nestingRegexp);d=p&&p.length}let f=n.replace&&!wt(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,n.lng||this.language||i.usedLng,n),c){const p=e.match(this.interpolator.nestingRegexp),v=p&&p.length;d<v&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var p=arguments.length,v=new Array(p),y=0;y<p;y++)v[y]=arguments[y];return o&&o[0]===v[0]&&!n.context?(s.logger.warn(`It seems you are nesting recursively key: ${v[0]} in key: ${r[0]}`),null):s.translate(...v,r)},n)),n.interpolation&&this.interpolator.reset()}const u=n.postProcess||this.options.postProcess,l=wt(u)?[u]:u;return e!=null&&l&&l.length&&n.applyPostProcessor!==!1&&(e=Vv.handle(l,e,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,o,s,u;return wt(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(n))return;const c=this.extractFromKey(l,r),d=c.key;i=d;let f=c.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=r.count!==void 0&&!wt(r.count),v=p&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),y=r.context!==void 0&&(wt(r.context)||typeof r.context=="number")&&r.context!=="",m=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);f.forEach(S=>{this.isValidLookup(n)||(u=S,!Mv[`${m[0]}-${S}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(u)&&(Mv[`${m[0]}-${S}`]=!0,this.logger.warn(`key "${i}" for languages "${m.join(", ")}" won't get resolved as namespace "${u}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(F=>{if(this.isValidLookup(n))return;s=F;const C=[d];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(C,d,F,S,r);else{let E;p&&(E=this.pluralResolver.getSuffix(F,r.count,r));const _=`${this.options.pluralSeparator}zero`,A=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(C.push(d+E),r.ordinal&&E.indexOf(A)===0&&C.push(d+E.replace(A,this.options.pluralSeparator)),v&&C.push(d+_)),y){const N=`${d}${this.options.contextSeparator}${r.context}`;C.push(N),p&&(C.push(N+E),r.ordinal&&E.indexOf(A)===0&&C.push(N+E.replace(A,this.options.pluralSeparator)),v&&C.push(N+_))}}let w;for(;w=C.pop();)this.isValidLookup(n)||(o=w,n=this.getResource(F,S,w,r))}))})}),{res:n,usedKey:i,exactUsedKey:o,usedLng:s,usedNS:u}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,r,n,i):this.resourceStore.getResource(e,r,n,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!wt(e.replace);let i=n?e.replace:e;if(n&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(const o of r)delete i[o]}return i}static hasDefaultValue(e){const r="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&r===n.substring(0,r.length)&&e[n]!==void 0)return!0;return!1}}const Od=a=>a.charAt(0).toUpperCase()+a.slice(1);class kv{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Fa.create("languageUtils")}getScriptPartFromCode(e){if(e=xl(e),!e||e.indexOf("-")<0)return null;const r=e.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(e){if(e=xl(e),!e||e.indexOf("-")<0)return e;const r=e.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(e){if(wt(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let i=Intl.getCanonicalLocales(e)[0];if(i&&this.options.lowerCaseLng&&(i=i.toLowerCase()),i)return i}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let n=e.split("-");return this.options.lowerCaseLng?n=n.map(i=>i.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Od(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Od(n[1].toLowerCase())),r.indexOf(n[2].toLowerCase())>-1&&(n[2]=Od(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let r;return e.forEach(n=>{if(r)return;const i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(r=i)}),!r&&this.options.supportedLngs&&e.forEach(n=>{if(r)return;const i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(e,r){if(!e)return[];if(typeof e=="function"&&(e=e(r)),wt(e)&&(e=[e]),Array.isArray(e))return e;if(!r)return e.default||[];let n=e[r];return n||(n=e[this.getScriptPartFromCode(r)]),n||(n=e[this.formatLanguageCode(r)]),n||(n=e[this.getLanguagePartFromCode(r)]),n||(n=e.default),n||[]}toResolveHierarchy(e,r){const n=this.getFallbackCodes(r||this.options.fallbackLng||[],e),i=[],o=s=>{s&&(this.isSupportedCode(s)?i.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return wt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):wt(e)&&o(this.formatLanguageCode(e)),n.forEach(s=>{i.indexOf(s)<0&&o(this.formatLanguageCode(s))}),i}}let kb=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Gb={1:a=>+(a>1),2:a=>+(a!=1),3:a=>0,4:a=>a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2,5:a=>a==0?0:a==1?1:a==2?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5,6:a=>a==1?0:a>=2&&a<=4?1:2,7:a=>a==1?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2,8:a=>a==1?0:a==2?1:a!=8&&a!=11?2:3,9:a=>+(a>=2),10:a=>a==1?0:a==2?1:a<7?2:a<11?3:4,11:a=>a==1||a==11?0:a==2||a==12?1:a>2&&a<20?2:3,12:a=>+(a%10!=1||a%100==11),13:a=>+(a!==0),14:a=>a==1?0:a==2?1:a==3?2:3,15:a=>a%10==1&&a%100!=11?0:a%10>=2&&(a%100<10||a%100>=20)?1:2,16:a=>a%10==1&&a%100!=11?0:a!==0?1:2,17:a=>a==1||a%10==1&&a%100!=11?0:1,18:a=>a==0?0:a==1?1:2,19:a=>a==1?0:a==0||a%100>1&&a%100<11?1:a%100>10&&a%100<20?2:3,20:a=>a==1?0:a==0||a%100>0&&a%100<20?1:2,21:a=>a%100==1?1:a%100==2?2:a%100==3||a%100==4?3:0,22:a=>a==1?0:a==2?1:(a<0||a>10)&&a%10==0?2:3};const Bb=["v1","v2","v3"],Ub=["v4"],Gv={zero:0,one:1,two:2,few:3,many:4,other:5},$b=()=>{const a={};return kb.forEach(e=>{e.lngs.forEach(r=>{a[r]={numbers:e.nr,plurals:Gb[e.fc]}})}),a};class Wb{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=r,this.logger=Fa.create("pluralResolver"),(!this.options.compatibilityJSON||Ub.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=$b(),this.pluralRulesCache={}}addRule(e,r){this.rules[e]=r}clearCache(){this.pluralRulesCache={}}getRule(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const n=xl(e==="dev"?"en":e),i=r.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:i});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let s;try{s=new Intl.PluralRules(n,{type:i})}catch{if(!e.match(/-|_/))return;const l=this.languageUtils.getLanguagePartFromCode(e);s=this.getRule(l,r)}return this.pluralRulesCache[o]=s,s}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(e,r);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,n).map(i=>`${r}${i}`)}getSuffixes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(e,r);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((i,o)=>Gv[i]-Gv[o]).map(i=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i}`):n.numbers.map(i=>this.getSuffix(e,i,r)):[]}getSuffix(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.getRule(e,n);return i?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(r)}`:this.getSuffixRetroCompatible(i,r):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,r){const n=e.noAbs?e.plurals(r):e.plurals(Math.abs(r));let i=e.numbers[n];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));const o=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?`_plural_${i.toString()}`:o():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?o():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!Bb.includes(this.options.compatibilityJSON)}}const Bv=function(a,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=Ib(a,e,r);return!o&&i&&wt(r)&&(o=bd(a,r,n),o===void 0&&(o=bd(e,r,n))),o},Fd=a=>a.replace(/\$/g,"$$$$");class zb{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Fa.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(r=>r),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:i,prefix:o,prefixEscaped:s,suffix:u,suffixEscaped:l,formatSeparator:c,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:v,nestingSuffix:y,nestingSuffixEscaped:m,nestingOptionsSeparator:S,maxReplaces:F,alwaysFormat:C}=e.interpolation;this.escape=r!==void 0?r:_b,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=o?jo(o):s||"{{",this.suffix=u?jo(u):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?jo(p):v||jo("$t("),this.nestingSuffix=y?jo(y):m||jo(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=F||1e3,this.alwaysFormat=C!==void 0?C:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(r,n)=>r&&r.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,r,n,i){let o,s,u;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=v=>{if(v.indexOf(this.formatSeparator)<0){const F=Bv(r,l,v,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(F,void 0,n,{...i,...r,interpolationkey:v}):F}const y=v.split(this.formatSeparator),m=y.shift().trim(),S=y.join(this.formatSeparator).trim();return this.format(Bv(r,l,m,this.options.keySeparator,this.options.ignoreJSONStructure),S,n,{...i,...r,interpolationkey:m})};this.resetRegExp();const d=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,f=i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:v=>Fd(v)},{regex:this.regexp,safeValue:v=>this.escapeValue?Fd(this.escape(v)):Fd(v)}].forEach(v=>{for(u=0;o=v.regex.exec(e);){const y=o[1].trim();if(s=c(y),s===void 0)if(typeof d=="function"){const S=d(e,o,i);s=wt(S)?S:""}else if(i&&Object.prototype.hasOwnProperty.call(i,y))s="";else if(f){s=o[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),s="";else!wt(s)&&!this.useRawValueToEscape&&(s=Iv(s));const m=v.safeValue(s);if(e=e.replace(o[0],m),f?(v.regex.lastIndex+=s.length,v.regex.lastIndex-=o[0].length):v.regex.lastIndex=0,u++,u>=this.maxReplaces)break}}),e}nest(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,o,s;const u=(l,c)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let p=`{${f[1]}`;l=f[0],p=this.interpolate(p,s);const v=p.match(/'/g),y=p.match(/"/g);(v&&v.length%2===0&&!y||y.length%2!==0)&&(p=p.replace(/'/g,'"'));try{s=JSON.parse(p),c&&(s={...c,...s})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,m),`${l}${d}${p}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,l};for(;i=this.nestingRegexp.exec(e);){let l=[];s={...n},s=s.replace&&!wt(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let c=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){const d=i[1].split(this.formatSeparator).map(f=>f.trim());i[1]=d.shift(),l=d,c=!0}if(o=r(u.call(this,i[1].trim(),s),s),o&&i[0]===e&&!wt(o))return o;wt(o)||(o=Iv(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),o=""),c&&(o=l.reduce((d,f)=>this.format(d,f,n.lng,{...n,interpolationkey:i[1].trim()}),o.trim())),e=e.replace(i[0],o),this.regexp.lastIndex=0}return e}}const Kb=a=>{let e=a.toLowerCase().trim();const r={};if(a.indexOf("(")>-1){const n=a.split("(");e=n[0].toLowerCase().trim();const i=n[1].substring(0,n[1].length-1);e==="currency"&&i.indexOf(":")<0?r.currency||(r.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?r.range||(r.range=i.trim()):i.split(";").forEach(s=>{if(s){const[u,...l]=s.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),d=u.trim();r[d]||(r[d]=c),c==="false"&&(r[d]=!1),c==="true"&&(r[d]=!0),isNaN(c)||(r[d]=parseInt(c,10))}})}return{formatName:e,formatOptions:r}},Io=a=>{const e={};return(r,n,i)=>{let o=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(o={...o,[i.interpolationkey]:void 0});const s=n+JSON.stringify(o);let u=e[s];return u||(u=a(xl(n),i),e[s]=u),u(r)}};class qb{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Fa.create("formatter"),this.options=e,this.formats={number:Io((r,n)=>{const i=new Intl.NumberFormat(r,{...n});return o=>i.format(o)}),currency:Io((r,n)=>{const i=new Intl.NumberFormat(r,{...n,style:"currency"});return o=>i.format(o)}),datetime:Io((r,n)=>{const i=new Intl.DateTimeFormat(r,{...n});return o=>i.format(o)}),relativetime:Io((r,n)=>{const i=new Intl.RelativeTimeFormat(r,{...n});return o=>i.format(o,n.range||"day")}),list:Io((r,n)=>{const i=new Intl.ListFormat(r,{...n});return o=>i.format(o)})},this.init(e)}init(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(e,r){this.formats[e.toLowerCase().trim()]=r}addCached(e,r){this.formats[e.toLowerCase().trim()]=Io(r)}format(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const o=r.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(u=>u.indexOf(")")>-1)){const u=o.findIndex(l=>l.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,u)].join(this.formatSeparator)}return o.reduce((u,l)=>{const{formatName:c,formatOptions:d}=Kb(l);if(this.formats[c]){let f=u;try{const p=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},v=p.locale||p.lng||i.locale||i.lng||n;f=this.formats[c](u,v,{...d,...i,...p})}catch(p){this.logger.warn(p)}return f}else this.logger.warn(`there was no format function for ${c}`);return u},e)}}const Hb=(a,e)=>{a.pending[e]!==void 0&&(delete a.pending[e],a.pendingCount--)};class Qb extends Rl{constructor(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=Fa.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,i.backend,i)}queueLoad(e,r,n,i){const o={},s={},u={},l={};return e.forEach(c=>{let d=!0;r.forEach(f=>{const p=`${c}|${f}`;!n.reload&&this.store.hasResourceBundle(c,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?s[p]===void 0&&(s[p]=!0):(this.state[p]=1,d=!1,s[p]===void 0&&(s[p]=!0),o[p]===void 0&&(o[p]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(u[c]=!0)}),(Object.keys(o).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(s),toLoadLanguages:Object.keys(u),toLoadNamespaces:Object.keys(l)}}loaded(e,r,n){const i=e.split("|"),o=i[0],s=i[1];r&&this.emit("failedLoading",o,s,r),!r&&n&&this.store.addResourceBundle(o,s,n,void 0,void 0,{skipCopy:!0}),this.state[e]=r?-1:2,r&&n&&(this.state[e]=0);const u={};this.queue.forEach(l=>{jb(l.loaded,[o],s),Hb(l,e),r&&l.errors.push(r),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{u[c]||(u[c]={});const d=l.loaded[c];d.length&&d.forEach(f=>{u[c][f]===void 0&&(u[c][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",u),this.queue=this.queue.filter(l=>!l.done)}read(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:r,fcName:n,tried:i,wait:o,callback:s});return}this.readingCalls++;const u=(c,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(c&&d&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,r,n,i+1,o*2,s)},o);return}s(c,d)},l=this.backend[n].bind(this.backend);if(l.length===2){try{const c=l(e,r);c&&typeof c.then=="function"?c.then(d=>u(null,d)).catch(u):u(null,c)}catch(c){u(c)}return}return l(e,r,u)}prepareLoading(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();wt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),wt(r)&&(r=[r]);const o=this.queueLoad(e,r,n,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach(s=>{this.loadOne(s)})}load(e,r,n){this.prepareLoading(e,r,{},n)}reload(e,r,n){this.prepareLoading(e,r,{reload:!0},n)}loadOne(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e.split("|"),i=n[0],o=n[1];this.read(i,o,"read",void 0,void 0,(s,u)=>{s&&this.logger.warn(`${r}loading namespace ${o} for language ${i} failed`,s),!s&&u&&this.logger.log(`${r}loaded namespace ${o} for language ${i}`,u),this.loaded(e,s,u)})}saveMissing(e,r,n,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){const l={...s,isUpdate:o},c=this.backend.create.bind(this.backend);if(c.length<6)try{let d;c.length===5?d=c(e,r,n,i,l):d=c(e,r,n,i),d&&typeof d.then=="function"?d.then(f=>u(null,f)).catch(u):u(null,d)}catch(d){u(d)}else c(e,r,n,i,u,l)}!e||!e[0]||this.store.addResource(e[0],r,n,i)}}}const Uv=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:a=>{let e={};if(typeof a[1]=="object"&&(e=a[1]),wt(a[1])&&(e.defaultValue=a[1]),wt(a[2])&&(e.tDescription=a[2]),typeof a[2]=="object"||typeof a[3]=="object"){const r=a[3]||a[2];Object.keys(r).forEach(n=>{e[n]=r[n]})}return e},interpolation:{escapeValue:!0,format:a=>a,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),$v=a=>(wt(a.ns)&&(a.ns=[a.ns]),wt(a.fallbackLng)&&(a.fallbackLng=[a.fallbackLng]),wt(a.fallbackNS)&&(a.fallbackNS=[a.fallbackNS]),a.supportedLngs&&a.supportedLngs.indexOf("cimode")<0&&(a.supportedLngs=a.supportedLngs.concat(["cimode"])),a),Il=()=>{},Jb=a=>{Object.getOwnPropertyNames(Object.getPrototypeOf(a)).forEach(r=>{typeof a[r]=="function"&&(a[r]=a[r].bind(a))})};class Qs extends Rl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=$v(e),this.services={},this.logger=Fa,this.modules={external:[]},Jb(this),r&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,r),this;setTimeout(()=>{this.init(e,r)},0)}}init(){var e=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(n=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(wt(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const i=Uv();this.options={...i,...this.options,...$v(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const o=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?Fa.init(o(this.modules.logger),this.options):Fa.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:typeof Intl<"u"&&(d=qb);const f=new kv(this.options);this.store=new Nv(this.options.resources,this.options);const p=this.services;p.logger=Fa,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new Wb(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(p.formatter=o(d),p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new zb(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new Qb(o(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",function(v){for(var y=arguments.length,m=new Array(y>1?y-1:0),S=1;S<y;S++)m[S-1]=arguments[S];e.emit(v,...m)}),this.modules.languageDetector&&(p.languageDetector=o(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=o(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new jl(this.services,this.options),this.translator.on("*",function(v){for(var y=arguments.length,m=new Array(y>1?y-1:0),S=1;S<y;S++)m[S-1]=arguments[S];e.emit(v,...m)}),this.modules.external.forEach(v=>{v.init&&v.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Il),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return e.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return e.store[d](...arguments),e}});const l=qs(),c=()=>{const d=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),n(f,p)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initImmediate?c():setTimeout(c,0),l}loadResources(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Il;const i=wt(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i&&i.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const o=[],s=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(c=>{c!=="cimode"&&o.indexOf(c)<0&&o.push(c)})};i?s(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>s(l)),this.options.preload&&this.options.preload.forEach(u=>s(u)),this.services.backendConnector.load(o,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(u)})}else n(null)}reloadResources(e,r,n){const i=qs();return typeof e=="function"&&(n=e,e=void 0),typeof r=="function"&&(n=r,r=void 0),e||(e=this.languages),r||(r=this.options.ns),n||(n=Il),this.services.backendConnector.reload(e,r,o=>{i.resolve(),n(o)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Vv.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(e,r){var n=this;this.isLanguageChangingTo=e;const i=qs();this.emit("languageChanging",e);const o=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},s=(l,c)=>{c?(o(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),r&&r(l,function(){return n.t(...arguments)})},u=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const c=wt(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);c&&(this.language||o(c),this.translator.language||this.translator.changeLanguage(c),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(c)),this.loadResources(c,d=>{s(d,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?u(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(u):this.services.languageDetector.detect(u):u(e),i}getFixedT(e,r,n){var i=this;const o=function(s,u){let l;if(typeof u!="object"){for(var c=arguments.length,d=new Array(c>2?c-2:0),f=2;f<c;f++)d[f-2]=arguments[f];l=i.options.overloadTranslationOptionHandler([s,u].concat(d))}else l={...u};l.lng=l.lng||o.lng,l.lngs=l.lngs||o.lngs,l.ns=l.ns||o.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||o.keyPrefix);const p=i.options.keySeparator||".";let v;return l.keyPrefix&&Array.isArray(s)?v=s.map(y=>`${l.keyPrefix}${p}${y}`):v=l.keyPrefix?`${l.keyPrefix}${p}${s}`:s,i.t(v,l)};return wt(e)?o.lng=e:o.lngs=e,o.ns=r,o.keyPrefix=n,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const s=(u,l)=>{const c=this.services.backendConnector.state[`${u}|${l}`];return c===-1||c===0||c===2};if(r.precheck){const u=r.precheck(this,s);if(u!==void 0)return u}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(n,e)&&(!i||s(o,e)))}loadNamespaces(e,r){const n=qs();return this.options.ns?(wt(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}loadLanguages(e,r){const n=qs();wt(e)&&(e=[e]);const i=this.options.preload||[],o=e.filter(s=>i.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return o.length?(this.options.preload=i.concat(o),this.loadResources(s=>{n.resolve(),r&&r(s)}),n):(r&&r(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new kv(Uv());return r.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new Qs(e,r)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Il;const n=e.forkResourceStore;n&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},o=new Qs(i);return(e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(u=>{o[u]=this[u]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n&&(o.store=new Nv(this.store.data,i),o.services.resourceStore=o.store),o.translator=new jl(o.services,i),o.translator.on("*",function(u){for(var l=arguments.length,c=new Array(l>1?l-1:0),d=1;d<l;d++)c[d-1]=arguments[d];o.emit(u,...c)}),o.init(i,r),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const vn=Qs.createInstance();vn.createInstance=Qs.createInstance;const Gw=vn.createInstance,Bw=vn.dir,Uw=vn.init,$w=vn.loadResources,Ww=vn.reloadResources,zw=vn.use,Kw=vn.changeLanguage,qw=vn.getFixedT,Hw=vn.t,Qw=vn.exists,Jw=vn.setDefaultNamespace,Yw=vn.hasLoadedNamespace,Xw=vn.loadNamespaces,Zw=vn.loadLanguages;var Wv="EMPTY_GROUP",zv="EMPTY_RULE_GROUP",Kv="EMPTY_QUERY",qv="EMPTY_CASE",Hv="NO_CONFIG_FOR_FIELD",Qv="NO_CONFIG_FOR_OPERATOR",Yb="FIXED_OPERATOR",Jv="NO_CONFIG_FOR_FUNCTION",Yv="INVALID_VALUE",Xv="INVALID_FUNC_ARG_VALUE",Zv="UNSUPPORTED_FIELD_TYPE",eg="UNSUPPORTED_OPERATOR_FOR_FIELD",tg="INVALID_VALUE_SRC",Td="INCOMPLETE_RULE",rg="INCOMPLETE_LHS",ng="INCOMPLETE_RHS",Cd="BAD_MULTISELECT_VALUES",ag="BAD_SELECT_VALUE",ig="INCORRECT_VALUE_TYPE",og="INCORRECT_VALUE_JS_TYPE",sg="VALUE_LENGTH_CONSTRAINT_FAIL",Ed="VALUE_MIN_CONSTRAINT_FAIL",wd="VALUE_MAX_CONSTRAINT_FAIL",ug="NO_CONFIG_FOR_FIELD_VALUE",lg="CANT_COMPARE_FIELD_WITH_ITSELF",cg="CANT_COMPARE_FIELD_WITH_FIELD",dg="INCORRECT_FIELD_TYPE",fg="UNSUPPORTED_FUNCTION_FOR_FIELD",pg="REQUIRED_FUNCTION_ARG",vg="INCORRECT_FUNCTION_RETURN_TYPE",gg="INVALID_RANGE",$a="ITEM_POSITION",hg="ITEM_POSITION_ROOT",mg="ITEM_POSITION_WITH_INDEX_PATH",yg="ITEM_POSITION_IN_CASE",xd="range",Ao,Xb=(Ao={},Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Ao,Wv,"Empty group"),zv,"No conditions for group field {{field}}"),Kv,"Empty query"),qv,"Empty case"),Hv,"No config for field {{field}}"),Yb,"Fixed operator {{from}} to {{to}} for field {{field}}"),Qv,"No config for operator {{operator}}"),Jv,"No config for function {{funcKey}}"),Yv,"Invalid value"),Xv,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Ao,Zv,"Type of field {{field}} is not supported"),eg,"Operator {{operator}} is not supported for field {{field}}"),Td,"Incomplete rule"),rg,"Incomplete LHS"),ng,"Incomplete RHS"),tg,"Invalid value src {{valueSrcs, list}}"),Cd+"_one","Value {{badValues, list}} is not in the list of allowed values"),Cd+"_other","Values {{badValues, list}} are not in the list of allowed values"),ag,"Value {{value}} is not in the list of allowed values"),ig,"Value should have type {{wType}}, but got value of type {{valueType}}"),Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Ao,og,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),sg,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),Ed,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),Ed+"_"+xd,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),wd,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),wd+"_"+xd,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),ug,"No config for field {{field}}"),lg,"Can't compare field {{field}} with itself"),cg,"Can't compare field {{leftField}} with {{rightField}}"),dg,"Field {{field}} is of type {{type}}, but expected {{expected}}"),Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Ao,fg,"Unsupported function {{funcKey}} for field {{field}}"),pg,"Value of arg {{argName}} for func {{funcName}} is required"),vg,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),gg,"Invalid range"),hg,"Root"),$a+"__rule","Leaf #{{globalLeafNo}}"),$a+"__group","Group #{{globalGroupNo}}"),$a+"__rule_group","Rule-group #{{globalNoByType}}"),$a+"__case_group","Case #{{globalNoByType}}"),$a+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),Se(Se(Se(Se(Se(Ao,$a+"__group__deleted","Deleted group #{{globalGroupNo}}"),$a+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),$a+"__case_group__deleted","Deleted case #{{globalNoByType}}"),yg,"{{str}} in case #{{caseNo}}"),mg,"{{str}} (index path: {{indexPath, list}})")),Sg="raqbvalidation",Zb="".concat(Sg,":"),Al=vn.createInstance();Al.init({fallbackLng:"en"}),Al.addResources("en",Sg,Xb);var Hn=function(e,r){return e!=null&&e.str?e.str:e!=null&&e.key?Hn(e.key,e.args):r===null?e:Al.t(e.includes(":")?e:Zb+e,r)};const eO=Al;function bg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function _o(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):bg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Do=function(e,r){var n,i,o,s,u=e.validateValue,l=e.validateRange,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0,p=arguments.length>5?arguments[5]:void 0,v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,m=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,S=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1;c||(c=r);var F=r.settings,C=F.keepInputOnChangeFieldSrc,w=F.convertableWidgets,E=F.clearValueOnChangeField,_=F.clearValueOnChangeOp,A=f=="!case_value",N=d.get("field");!N&&A&&(N=f);var X=d.get("fieldType"),H=d.get("fieldSrc"),W=d.get("operator"),J=d.get("value"),Y=d.get("valueSrc",new be.List),K=d.get("valueType",new be.List),ae=d.get("valueError",new be.List),se=d.get("asyncListValues"),re=A,ie=Mt(c,W),ne=Mt(r,p,f),de=A?1:W?Mr(ie):null,le=A?1:p?Mr(ne):null,fe=Ze(c,N),ve=Ze(r,f),ye=!N&&X&&C,we=fe?.type||X,xe=ve?.type||!f&&ye&&we,Fe=fe?.listValuesType,ze=ve?.listValuesType,_e=((n=N)===null||n===void 0||(i=n.get)===null||i===void 0?void 0:i.call(n,"func"))||N,Oe=((o=f)===null||o===void 0||(s=o.get)===null||s===void 0?void 0:s.call(o,"func"))||f,Ve=Oe!=_e,ke=[],De=(N||ye)&&(W&&p||re)&&J!=null;(!(we&&xe&&we==xe)||v==="field"&&Ve&&E||v==="operator"&&_)&&(De=!1),Ve&&ul.includes(xe)&&(ze&&ze===Fe||(De=!1)),!re&&(!(J!=null&&J.size)&&le||J!=null&&J.size&&!le)&&(De=!1);var Ke;if(H==="func"&&f){var $e=u(r,null,null,p,f,xe,H,se,y,m,S),Je=Ce($e,2),ut=Je[0],Xe=Je[1],et=!(Xe!=null&&Xe.length),Jt=ut!==f,kt=!et&&Jt&&!Xe.find(function(Tr){return!Tr.fixed}),Kt=y&&!et&&!kt&&!!v&&f!==N,Ct=!1;if(Ct?f=null:Kt?f=N:Jt&&(f=ut),!et){var or=!et&&!kt&&!Ct&&!Kt,er=Xe.find(function(Tr){return!Tr.fixed&&!Tr.ignore});or&&er&&(Ke=Hn(er)),Xe.map(function(Tr){return ke.push(_o(_o({side:"lhs"},Tr),{},{fixed:Tr.fixed||Kt||Ct}))})}}for(var Lr=0;Lr<le;Lr++){var lr=Y.get(Lr)||null,Or=vr(c,N,W,lr),Rr=vr(r,f,p,lr),qt=lr==="value"?Or:vr(c,N,W,"value"),an=lr==="value"?Rr:vr(r,f,p,"value"),Jn=an==qt||(w[qt]||[]).includes(an)||!qt&&ye;Jn||(De=!1)}W!=p&&[W,p].includes("proximity")&&(De=!1);var Nt=Y.first(),Fr=rn(r,f,p,null,Nt),Br=Tf(r,f,p,null);!f&&ye&&(Br=Object.keys(r.settings.valueSourcesInfo));var Mn=Br[0],Bt;le===1&&Fr&&Fr.type!==void 0?Bt=Fr.type:le===1&&ve&&ve.type!==void 0&&(Bt=ve.type==="!group"?"number":ve.type);var kn=De&&v==="operator"&&de===1&&le===2,Ut=[],yn=[],Gn=[],la=Array.from({length:le},function(){return null});if(De)for(var uu=function(Yt){var Cr=J.get(Yt),Xi=K.get(Yt)||null,on=Y.get(Yt)||null;kn&&Yt===1&&(Cr=Ut[0]!==void 0?Ut[0]:J.get(0),Ut[Yt]=Cr,Xi=K.get(0)||null,on=Y.get(0)||null);var tc=on?Br.find(function(Zn){return Zn==on})!==void 0:!0,rc=u(r,f,f,p,Cr,Xi,on,se,y,m,S),Ko=Ce(rc,2),fu=Ko[0],en=Ko[1],qo=!(en!=null&&en.length),Er=fu!==Cr,Xn=!qo&&Er&&!(en!=null&&en.find(function(Zn){return!Zn.fixed})),pu=!(en!=null&&en.find(function(Zn){return!Zn.fixed&&!Zn.ignore})),f0=!tc||y&&!qo&&!Xn&&(!pu||Ve);qo||en?.map(function(Zn){return ke.push(_o(_o({side:"rhs",delta:Yt},Zn),{},{fixed:Zn.fixed||f0}))}),f0&&(Ut[Yt]=null,Yt===0&&delete Ut[1]);var kw=!qo&&!Er,p0=en?.find(function(Zn){return!Zn.fixed&&!Zn.ignore});kw&&p0&&(la[Yt]=Hn(p0)),Er&&(Ut[Yt]=fu),kn&&Yt===0&&!qo&&!Er&&(kn=!1),kn&&Yt===0&&["func","field"].includes(on)&&(kn=!1)},Yi=0;Yi<le;Yi++)uu(Yi);if(!De){for(var zo=0;zo<le;zo++)if(le===1){var lu,cu,xa=hf([ve?.defaultValue,ve==null||(lu=ve.fieldSettings)===null||lu===void 0?void 0:lu.defaultValue,Fr?.defaultValue]);Ut[zo]=xa,(xa!=null&&xa.func||xa!=null&&(cu=xa.get)!==null&&cu!==void 0&&cu.call(xa,"func"))&&(yn[zo]="func")}}for(var Zr=0;Zr<le;Zr++){var du=De&&Y.get(Zr)||null,Ht=De&&K.get(Zr)||null,it=Ut[Zr]!==void 0?Ut[Zr]:De?J.get(Zr):void 0;if(De&&kn&&Zr===1){var tt,dt;du=(tt=yn[Zr])!==null&&tt!==void 0?tt:Y.get(0),Ht=(dt=Gn[Zr])!==null&&dt!==void 0?dt:K.get(0),yn[Zr]=du,Gn[Zr]=Ht}var yt=Br.includes(du);yt||(yn[Zr]=Mn),Ht||(Gn[Zr]=Bt),it!=null&&it.func&&(Ut[Zr]=Eo(it),yn[Zr]="func")}var _t=J;(Ut.length>0||!De||le<de)&&(_t=new be.List(Array.from({length:le},function(Tr,Yt){return Ut[Yt]!==void 0?Ut[Yt]:De?J.get(Yt):void 0})));var hr=Y;(yn.length>0||!De||le<de)&&(hr=new be.List(Array.from({length:le},function(Tr,Yt){var Cr;return(Cr=yn[Yt])!==null&&Cr!==void 0?Cr:De&&Y.get(Yt)||null})));var cr=K;(Gn.length>0||!De||le<de)&&(cr=new be.List(Array.from({length:le},function(Tr,Yt){var Cr;return(Cr=Gn[Yt])!==null&&Cr!==void 0?Cr:De&&K.get(Yt)||null})));var Ur=l(r,f,p,_t,hr);if(Ur){var $r=Hn(Ur),Wr=y&&le>=2,Bn=_t;Wr&&(Ut[1]=_t.get(0),_t=_t.set(1,Ut[1]),la[1]=la[0]);var $t=!Wr;$t&&la.push($r),ke.push(_o(_o({side:"rhs",delta:-1},Ur),{},{fixed:Wr,fixedFrom:Wr?[Bn.get(0),Bn.get(1)]:void 0,fixedTo:Wr?[_t.get(0),_t.get(1)]:void 0}))}var Yn=ae,Rn=ae?.size!==la.length||la.filter(function(Tr,Yt){return Tr!=ae.get(Yt)}).length>0;return Rn&&(Yn=new be.List(la)),{canReuseValue:De,newValue:_t,newValueSrc:hr,newValueType:cr,operatorCardinality:le,fixedField:f,newValueError:Yn,newFieldError:Ke,validationErrors:ke}};function tO(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=rO(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function rO(a,e){if(a){if(typeof a=="string")return Og(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Og(a,e):void 0}}function Og(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function Fg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function _l(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Fg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Wa=function(e,r){if(!(e==null||e==""))return Xr(e)?_l(_l({},e),{},{title:e.title||e.value}):{value:e,title:r!==void 0?r:""+e}},Ld=function(e){var r=Wa(e);return Xr(r)?_l(_l({},Wa(e)),{},{isCustom:!0}):r},Rd=function(e){if(Array.isArray(e))return e.map(function(o){return Wa(o)});if(!Xr(e))return e;var r=[];for(var n in e){var i=e[n];r.push(Wa(n,i))}return r},Js=function(e,r){if(Array.isArray(e)){var n=e.map(function(i){return Wa(i)});return n.find(function(i){return""+i.value==""+r})}else return e[r]!==void 0?Wa(r,e[r]):void 0},Tg=function(e,r){if(e==null)return r;var n=Js(e,r);return n!==void 0?n.title:r},nO=function(e,r){if(e==null)return r;var n=Js(e,r);return n!==void 0?n.value:r},jd=function(e,r){var n=[];if(Array.isArray(e)){var i=tO(e),o;try{for(i.s();!(o=i.n()).done;){var s=o.value,u=r(Wa(s));u!=null&&n.push(u)}}catch(d){i.e(d)}finally{i.f()}}else for(var l in e){var c=r(Wa(l,e[l]));c!=null&&n.push(c)}return n},aO=function(e,r){return jd(r,function(n){return"".concat(n.value).indexOf(e)!=-1||n.title.indexOf(e)!=-1?n:null}).filter(function(n){return n!==null}).shift()},Dl=function(e,r){return jd(r,function(n){return""+n.value==""+e?n:null}).filter(function(n){return n!==null}).shift()};function Cg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Gr(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Cg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Eg=function(e,r){return wg(e,r).length===0},wg=function(e,r){var n=r.settings.showErrorMessage,i=[];function o(s,u,l){var c,d,f=s.get("id"),p=s.get("children1"),v=s.getIn(["properties","valueError"]),y=s.getIn(["properties","fieldError"]),m=s.getIn(["properties","field"]),S=(c=m==null||(d=m.get)===null||d===void 0?void 0:d.call(m,"func"))!==null&&c!==void 0?c:m,F=v?.size>0&&v.filter(function(w){return w!=null}).size>0,C=F||!!y;C&&n&&i.push(S),p&&p.map(function(w,E){w&&o(w,u.concat(f),l+1)})}return e&&o(e,[],0),Array.from(new Set(i))},xg=function(e,r){var n=Vn(r,void 0,!0),i={removeEmptyGroups:r.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:r.settings.removeIncompleteRulesOnLoad,removeEmptyRules:r.settings.removeEmptyRulesOnLoad,forceFix:!1},o=Ys(e,null,n,n,i),s=o.fixedTree,u=o.allErrors,l=o.isSanitized;return l&&u.length&&console.warn("Tree check errors: ",u),s},Lg=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Vn(r,void 0,!0),o=Gr(Gr({},n),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1}),s=Ys(e,null,i,i,o),u=s.allErrors;return u},Rg=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Vn(r,void 0,!0),o=Gr({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},n),s=Ys(e,null,i,i,o),u=s.fixedTree,l=s.fixedErrors,c=s.nonFixedErrors,d=s.allErrors;return{fixedTree:u,fixedErrors:l,nonFixedErrors:c,allErrors:d}},jg=function(e,r,n,i,o,s,u){o===void 0&&(o=n.settings.removeEmptyGroupsOnLoad),s===void 0&&(s=n.settings.removeEmptyRulesOnLoad),u===void 0&&(u=n.settings.removeIncompleteRulesOnLoad);var l={removeEmptyGroups:o,removeEmptyRules:s,removeIncompleteRules:u,forceFix:!1},c=Ys(e,r,n,i,l),d=c.fixedTree,f=c.allErrors,p=c.fixedErrors,v=c.nonFixedErrors,y=c.isSanitized;return y&&p.length&&console.warn("Fixed tree errors: ",p),d=ua(d),d},Ys=function(e,r,n,i,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var s=o||{},u=s.removeEmptyGroups,l=s.removeEmptyRules,c=s.removeIncompleteRules,d=s.forceFix,f=s.translateErrors,p=f===void 0?!0:f,v=s.includeStringifiedItems,y=v===void 0?!0:v,m=s.stringifyFixedItems,S=m===void 0?!1:m,F=s.stringifyItemsUserFriendly,C=F===void 0?!0:F,w=s.includeItemsPositions,E=w===void 0?!0:w,_={config:n,oldConfig:i,removeEmptyGroups:u,removeEmptyRules:l,removeIncompleteRules:c,forceFix:d},A={errors:{}},N=Ag(e,[],null,A,_),X=A.sanitized,H=[],W,J;E&&(W=Bc(N,n).items);for(var Y in A.errors){var K=A.errors[Y],ae=K.path,se=K.errors;p&&(se=se.map(function(et){return Gr(Gr({},et),{},{str:Hn(et)})}));var re={path:ae,errors:se};if(y){var ie=ui(S?N:e,ae),ne=ae.length===1;if(!ne&&ie.get("type")!=="group"){var de=!0,le=C,fe=av(ie,n,le,de);re.itemStr=fe}}if(E){var ve=W[Y],ye=!ve;if(ye&&(J||(J=Bc(e,n).items),ve=J[Y]),ve){var we=Gr(Gr({},ve.position),{},{index:ve.index,type:ve.type,isDeleted:ye});re.itemPosition=we;var xe=ve.index?$a+"__"+ve.type+(ye?"__deleted":""):hg,Fe=Gr({},we);if(C){for(var ze,_e=0,Oe=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];_e<Oe.length;_e++){var Ve=Oe[_e];Fe[Ve]!=null&&(Fe[Ve]=Fe[Ve]+1)}Fe.indexPath=(ze=we.indexPath)===null||ze===void 0?void 0:ze.map(function(et){return et+1})}re.itemPositionStr=Hn(xe,Fe),ve.index&&(ve.caseId&&ve.type!=="case_group"&&(re.itemPositionStr=Hn(yg,Gr(Gr({},Fe),{},{str:re.itemPositionStr}))),ve.type!=="case_group"&&(re.itemPositionStr=Hn(mg,Gr(Gr({},Fe),{},{str:re.itemPositionStr}))))}}H.push(re)}for(var ke=[],De=[],Ke=0,$e=H;Ke<$e.length;Ke++){var Je=$e[Ke],ut=Je.errors.filter(function(et){return!!et.fixed}),Xe=Je.errors.filter(function(et){return!et.fixed&&et.key!=="EMPTY_QUERY"});ut.length&&ke.push(Gr(Gr({},Je),{},{errors:ut})),Xe.length&&De.push(Gr(Gr({},Je),{},{errors:Xe}))}return{fixedTree:N,allErrors:H,fixedErrors:ke,nonFixedErrors:De,isSanitized:X}};function pi(a,e,r,n){var i=e.get("id");a.errors[i]||(a.errors[i]={path:[].concat(Pe(r),[i]),errors:[]}),a.errors[i].errors.push(n)}function Ig(a,e){var r=e.get("id");a.errors[r]&&a.errors[r].errors.map(function(n){n.fixed=!0})}function Ag(a,e,r,n,i){var o=a?.get("type");return o==="group"||o==="rule_group"||o=="case_group"||o=="switch_group"?iO(a,e,r,n,i):o==="rule"?_g(a,e,r,n,i):a}function iO(a,e,r,n,i){var o,s,u,l,c,d,f=i.removeEmptyGroups,p=i.removeIncompleteRules,v=i.forceFix,y=i.config,m=y.settings.showErrorMessage,S=!m||v,F=a.get("id"),C=a.get("children1"),w=!e.length,E=C,_=a.get("type"),A=a.get("properties"),N=A?.get("field"),X=A?.get("mode"),H=A==null||(o=A.get)===null||o===void 0?void 0:o.call(A,"operator"),W=_==="rule_group"&&X==="array",J=_==="case_group",Y=J&&C==null,K=H?(s=(u=y.operators[H])===null||u===void 0?void 0:u.cardinality)!==null&&s!==void 0?s:1:void 0,ae=J?!Y:W?K==0:f,se=W||J;!F&&r&&(F=r,a=a.set("id",F),n.sanitized=!0),se&&(a=_g(a,e,r,n,i));var re={errors:{}};C=(l=C)===null||l===void 0?void 0:l.map(function(fe,ve){return Ag(fe,e.concat(F),ve,re,i)});var ie=(c=C)===null||c===void 0?void 0:c.filter(function(fe){return fe!=null});f&&(C=ie);var ne=re.sanitized||E?.size!=((d=C)===null||d===void 0?void 0:d.size),de=!(ie!=null&&ie.size),le=f&&!w;return W&&N&&(le=p),de&&ae&&(pi(n,a,e,{key:w?Kv:J?qv:W?zv:Wv,args:{field:N},fixed:le}),le&&(Ig(n,a),a=void 0)),ne&&(n.sanitized=!0),ne&&a&&(a=a.set("children1",C)),n.errors=Gr(Gr({},n.errors),re?.errors||{}),a}function _g(a,e,r,n,i){var o=i.removeIncompleteRules,s=i.removeEmptyRules,u=i.forceFix,l=i.config,c=i.oldConfig,d=l.settings.showErrorMessage,f=!d||u,p=a,v=a.get("id"),y=a.get("type"),m=y==="case_group",S=a.get("properties");if(!S)if(m)S=new be.Map;else{var F={key:Td,args:{},fixed:o||s};pi(n,a,e,F);return}var C=S.get("field")||null;m&&(C="!case_value");var w=S.get("fieldSrc")||null,E=S.get("operator")||null,_=S.get("operatorOptions"),A=S.get("valueSrc"),N=S.get("value"),X=S.get("valueError"),H=S.get("fieldError"),W=function(){var $e,Je;return{field:(($e=C)===null||$e===void 0||(Je=$e.toJS)===null||Je===void 0?void 0:Je.call($e))||C,fieldSrc:w,operator:E,operatorOptions:_?_.toJS():{},valueSrc:A?A.toJS():null,value:N?N.toJS():null,valueError:X?X.toJS():null,fieldError:H||null}},J=W();!v&&r&&(v=r,a=a.set("id",v),n.sanitized=!0);var Y=C?Ze(l,C):null;C&&!Y&&(pi(n,a,e,{key:Hv,args:{field:C},side:"lhs",fixed:o||s}),C=null),C==null&&!m&&(S=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce(function(Ke,$e){return Ke.delete($e)},S),E=null),!w&&C&&!m&&(w=Of(C),S=S.set("fieldSrc",w)),(E==="range_between"||E==="range_not_between")&&(E=E==="range_between"?"between":"not_between",S=S.set("operator",E));var K=E?Mt(l,E,C):null;E&&!K&&(pi(n,a,e,{key:Qv,args:{operator:E},side:"op",fixed:o||s}),E=null);var ae=C?vl(l,C):[];C&&!m&&(ae!=null&&ae.length?E&&ae.indexOf(E)==-1&&(E==="is_empty"||E==="is_not_empty"?(E=E==="is_empty"?"is_null":"is_not_null",S=S.set("operator",E)):(pi(n,a,e,{key:eg,args:{operator:E,field:C},side:"lhs",fixed:o||s}),E=null)):(pi(n,a,e,{key:Zv,args:{field:C},side:"lhs",fixed:o||s}),E=null)),E==null&&!m&&(S=["operatorOptions","valueSrc","value","valueError"].reduce(function(Ke,$e){return Ke.delete($e)},S)),_=S.get("operatorOptions"),!E||_&&!K.options?(_=null,S=S.delete("operatorOptions")):E&&!_&&K.options&&(_=Gs(l,E,C),S=S.set("operatorOptions",_)),A=S.get("valueSrc"),N=S.get("value");var se=!0,re=Do({validateValue:Ta,validateRange:vi},l,c,S,C,E,null,f,se),ie=re.newValue,ne=re.newValueSrc,de=re.newValueError,le=re.validationErrors,fe=re.newFieldError,ve=re.fixedField;N=ie,A=ne,X=de,H=fe,C=ve,S=S.set("field",C),S=S.set("value",N),S=S.set("valueSrc",A),d?S=S.set("valueError",X).set("fieldError",H):S=S.delete("valueError").delete("fieldError");var ye=W(),we=!ol(J,ye),xe=Jc(S.toObject(),l),Fe=m?xe.parts.value:xe.score>=3;if(we&&(n.sanitized=!0,a=a.set("properties",S)),le?.map(function(Ke){return pi(n,a,e,Ke)}),!Fe&&!m){var ze=xe.score?o:s,_e={key:Td,args:{}};if(!xe.parts.field)_e.key=rg,_e.side="lhs";else if(!xe.parts.value){var Oe,Ve,ke,De;_e.key=ng,_e.side="rhs",(Oe=ye.valueSrc)!==null&&Oe!==void 0&&Oe[0]&&((Ve=ye.valueSrc)===null||Ve===void 0?void 0:Ve[0])!=((ke=J.valueSrc)===null||ke===void 0?void 0:ke[0])&&((De=ye.value)===null||De===void 0?void 0:De[0])!=null&&(_e.key=tg,_e.args={valueSrcs:ye.valueSrc})}_e.fixed=ze,pi(n,a,e,_e),ze&&(Ig(n,a),a=void 0)}return a}var Ta=function(e,r,n,i,o,s,u,l){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,f=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,p=[],v=o;if(o!=null){var y,m,S,F;if(u==="field"){var C=uO(r,n,o,u,s,l,e,i,c,d),w=Ce(C,2);v=w[0],p=w[1]}else if(u==="func"){var E=lO(r,n,o,u,s,l,e,i,c,d,f),_=Ce(E,2);v=_[0],p=_[1]}else if(u==="value"||!u){var A=sO(n,o,u,s,l,e,i,c,d),N=Ce(A,2);v=N[0],p=N[1]}var X=!((y=p)!==null&&y!==void 0&&y.find(function(we){return!we.fixed})),H=!!n&&!["field","func"].includes(u)&&(!((m=p)!==null&&m!==void 0&&m.length)||X);if(H){var W=vr(e,n,i,u),J=i?Mt(e,i,n):null,Y=rn(e,n,i,W,u,{forExport:!0}),K=u==="field"?Ze(e,o):null,ae=Y,se=Y.validateValue;if(typeof se=="function"){var re=[v,ae,i,J];u==="field"&&re.push(K);var ie=se.call.apply(se,[e.ctx].concat(re));if(Ye(ie)==="object"&&ie!==null&&!Array.isArray(ie)){var ne,de;(ne=ie.error)!==null&&ne!==void 0&&ne.key?de=Gr({},ie.error):de={key:ie.error,args:null},ie.fixedValue!==void 0&&c&&(de.fixed=!0,de.fixedFrom=v,de.fixedTo=ie.fixedValue,v=ie.fixedValue),p.push(de)}else typeof ie=="boolean"?ie==!1&&p.push({key:Yv,args:{}}):typeof ie=="string"&&p.push({key:ie,args:null})}}if(X=!((S=p)!==null&&S!==void 0&&S.find(function(we){return!we.fixed})),(F=p)!==null&&F!==void 0&&F.length&&!X&&c){var le=Ze(e,n),fe=le?.fieldSettings,ve=fe?.defaultValue;if(ve!==void 0){var ye=p[p.length-1];ye.fixed=!0,ye.fixedFrom=v,ye.fixedTo=ve,v=ve,p.map(function(we){we.fixed=!0})}}}return[v,p]},oO=function(e,r,n,i,o){var s=be.List.isList(e)?e.toJS():e instanceof Array?Pe(e):void 0,u=e,l=[];if(s){var c=s.reduce(function(S,F){var C=Ce(S,2),w=C[0],E=C[1],_=Js(r,F);return _==null?[w,[].concat(Pe(E),[F])]:[[].concat(Pe(w),[_.value]),E]},[[],[]]),d=Ce(c,2),f=d[0],p=d[1],v=p.length>0;if(n=n||o===!0,u=n&&v?f:e,p.length){var y=n&&v;l.push({key:Cd,args:{badValues:p,count:p.length},fixed:y,fixedFrom:y?s:void 0,fixedTo:y?u:void 0})}return[u,l]}else{var m=Js(r,e);return m==null?(u=n?null:e,l.push({key:ag,args:{value:e},fixed:n,fixedFrom:n?e:void 0,fixedTo:n?u:void 0})):u=m.value,[u,l]}},sO=function(e,r,n,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,d=[],f=r;if(e){var p=Ze(s,e),v=vr(s,e,u,n),y=s.widgets[v],m=y?.type,S=y?.jsType,F=p?.fieldSettings,C=F?.treeValues||F?.listValues,w=!!(F!=null&&F.asyncFetch),E=C||w;if(i&&m&&i!=m)return d.push({key:ig,args:{wType:m,valueType:i}}),[r,d];if(S&&!Mi(r,S)&&!E)return d.push({key:og,args:{jsType:S,valueTypeof:To(r)}}),[r,d];if(F){var _=o||C;if(_&&!F.allowCustomValues&&v!=="case_value"){var A=oO(r,_,l,c,s.settings.removeInvalidMultiSelectValuesOnLoad),N=Ce(A,2);f=N[0],d=N[1]}F.maxLength>0&&r!=null&&String(r).length>F.maxLength&&(f=l?String(r).substring(0,F.maxLength):r,d.push({key:sg,args:{value:r,length:String(r).length,fieldSettings:F},fixed:l,fixedFrom:l?r:void 0,fixedTo:l?f:void 0}));var X=F.min!=null&&F.max!=null?xd:void 0;F.min!=null&&r<F.min&&(f=l?F.min:r,d.push({key:Ed,args:{value:r,fieldSettings:F,context:X},fixed:l,fixedFrom:l?r:void 0,fixedTo:l?f:void 0})),F.max!=null&&r>F.max&&(f=l?F.max:r,d.push({key:wd,args:{value:r,fieldSettings:F,context:X},fixed:l,fixedFrom:l?r:void 0,fixedTo:l?f:void 0}))}}return[f,d]},uO=function(e,r,n,i,o,s,u){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,f=[],p=u.settings,v=p.fieldSeparator,y=p.canCompareFieldWithField,m=Ye(r)=="object"&&r?._isFuncArg,S=Array.isArray(e)?e.join(v):e,F=Ze(u,e),C=Array.isArray(n)?n.join(v):n,w=Ze(u,n);if(!w)return f.push({key:ug,args:{field:C}}),[n,f];if(e&&C===S&&!m)return f.push({key:lg,args:{field:S}}),[n,f];if(o&&o!=w.type)return f.push({key:dg,args:{field:C,type:w.type,expected:o}}),[n,f];if(e&&!m&&y){var E=y(S,F,C,w,l);if(!E)return f.push({key:cg,args:{leftField:S,rightField:C}}),[n,f]}return[n]},lO=function(e,r,n,i,o,s,u){var l,c,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,f=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,p=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,v=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,y=n,m=[];if(!n)return[n];var S=(l=n.get)===null||l===void 0?void 0:l.call(n,"func");if(!S)return[n];var F=Ze(u,r);if(F!=null&&F.funcs&&!F.funcs.includes(S))return m.push({key:fg,args:{funcKey:S,field:r}}),[n,m];var C=kr(u,S);if(!C)return m.push({key:Jv,args:{funcKey:S}}),[n,m];var w=(c=C.label)!==null&&c!==void 0?c:S;if(o&&C.returnType!=o)return m.push({key:vg,args:{funcKey:S,funcName:w,returnType:C.returnType,valueType:o}}),[n,m];f=f||v;for(var E in C.args){var _,A=C.args[E],N=y.get("args"),X=N?N.get(E):void 0,H=Ze(u,A),W=(_=H?.label)!==null&&_!==void 0?_:E,J=X?X.get("value"):void 0,Y=X?X.get("valueSrc"):void 0;if(J!==void 0){var K=Ta(u,e,H,d,J,A.type,Y,s,f,p,v),ae=Ce(K,2),se=ae[0],re=ae[1],ie=!(re!=null&&re.length),ne=f&&se!==J,de=f&&!ie&&!ne&&(p||v);if(ne&&(y=y.setIn(["args",E,"value"],se)),de&&(y=y.deleteIn(["args",E]),y=$s(u,y,C,E)),!ie){var le,fe,ve=(le=(fe=re.find(function(_e){return!_e.fixed&&!_e.ignore}))!==null&&fe!==void 0?fe:re.find(function(_e){return!_e.fixed}))!==null&&le!==void 0?le:re[0],ye=ne||de,we=re.filter(function(_e){return!_e.ignore}).length===0;if(ve){var xe=Hn(ve);m.push({key:Xv,args:{funcKey:S,funcName:w,argKey:E,argName:W,argValidationError:xe,argErrors:re},ignore:we,fixed:ye,fixedFrom:ye?J:void 0,fixedTo:ye?ne?se:A.defaultValue:void 0})}}}else if(!A.isOptional&&(p||v)){var Fe=f&&A.defaultValue!==void 0&&(p||v),ze=p;ze&&m.push({key:pg,args:{funcKey:S,funcName:w,argKey:E,argName:W},fixed:Fe,fixedTo:Fe?A.defaultValue:void 0,ignore:!Fe}),Fe&&(y=y.deleteIn(["args",E]),y=$s(u,y,C,E))}}return[y,m]},vi=function(e,r,n,i,o){var s=Mt(e,n,r),u=n?Mr(s):null,l=o.toJS?o.toJS():o,c=i.toJS?i.toJS():i,d=l.filter(function(F){return F=="value"||F==null}).length==u,f;if(s!=null&&s.validateValues&&d){var p=l[0],v=vr(e,r,n,p),y=rn(e,r,n,v,p),m=y!=null&&y.toJS?c.map(function(F){var C=y.toJS.call(e.ctx,F,y);return C instanceof Date&&(C=C.getTime()),C}):c,S=s.validateValues(m);typeof S=="boolean"&&S==!1&&(f={key:gg,args:{jsValues:m,values:c}})}return f},Dg=function(e,r,n,i){var o=n.settings.fieldSeparator;e=e||new be.Map,Array.isArray(r)&&(r=r.join(o));var s=e.get("func"),u=e.get("args");e=e.set("func",r);var l=r&&kr(n,r),c=r&&Vc(n,r),d=s&&Vc(n,s),f=Vg(d,c,u,n,i);if(f.length){var p=Object.keys(c.args),v=p.filter(function(y){return!f.includes(y)});e=v.reduce(function(y,m){return y.deleteIn(["args",m])},e)}else e=e.set("args",new be.Map);return e=Yc(n,e,l),e},Pg=function(e,r,n,i,o){return e&&e.get("func")&&(e=e.setIn(["args",r],new be.Map({valueSrc:n}))),e},Ng=function(e,r,n,i,o){return e&&e.get("func")&&(e=e.setIn(["args",r,"asyncListValues"],n)),e},Vg=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e?.returnType!=r?.returnType)return[];var s=!1,u=Object.keys(r.args),l=u.filter(function(c,d){var f=r.args[c],p=e.args[c],v=Object.keys(e.args).indexOf(c);if(!p&&(f.defaultValue!==void 0||f.isOptional))return!0;if(s&&d!==v||p?.type!=f.type||ul.includes(f.type)&&(!p.listValuesType||p.listValuesType!==f.listValuesType))return!1;if(n){var y,m=n.get(c),S=m?.get("value"),F=m?.get("valueSrc");if(F&&f.valueSources&&!f.valueSources.includes(F))return!1;var C=null,w=null,E=f,_=null,A=!0,N=Ta(i,C,E,w,S,E.type,F,_,o,A),X=Ce(N,2),H=X[0],W=X[1];if(W!=null&&(y=W.filter(function(J){return!J.fixed}))!==null&&y!==void 0&&y.length)return!1}return!0});return l};function Mg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function cO(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Mg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Ca=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=null,u=null,l=null,c=e.settings.showErrorMessage;if(n){var d,f,p;l=n==null||(d=n.properties)===null||d===void 0?void 0:d.fieldSrc,s=n==null||(f=n.properties)===null||f===void 0?void 0:f.field,u=n==null||(p=n.properties)===null||p===void 0?void 0:p.operator}else i?(s=Rf(e,o,r),s?l=Co(s)?"func":"field":l=zc(e),u=Kc(e,s,!0)):l=zc(e);var v=new be.Map({fieldSrc:l,field:s,operator:u,value:new be.List,valueSrc:new be.List,operatorOptions:Gs(e,u,s)});if(c&&(v=v.set("valueError",new be.List)),s&&u){var y=!1,m=Do({validateValue:Ta,validateRange:vi},e,e,v,s,u,"operator",y),S=m.newValue,F=m.newValueSrc,C=m.newValueType,w=m.newValueError,E=m.newFieldError;v=v.set("value",S).set("valueSrc",F).set("valueType",C),c&&(v=v.set("valueError",w).set("fieldError",E))}var _=Ze(e,s);if(_?.type==="!group"){var A=ci(e,_);v=v.set("conjunction",A)}return v},kg=function(e,r){return r?.type=="group"?di(e):Ca(e,null,r)},Gg=function(e,r){return Se({},e,new be.Map({type:"rule",id:e,properties:Ca(r)}))},dO=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new be.Map({type:"group",id:Qe(),children1:new be.OrderedMap(r?cO({},Gg(Qe(),e)):{}),properties:di(e)})};function fO(a,e){if(a==null)return{};var r={};for(var n in a)if({}.hasOwnProperty.call(a,n)){if(e.indexOf(n)!==-1)continue;r[n]=a[n]}return r}function pO(a,e){if(a==null)return{};var r,n,i=fO(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(a,r)&&(i[r]=a[r])}return i}function Bg(a,e,r,n,i,o,s){try{var u=a[o](s),l=u.value}catch(c){return void r(c)}u.done?e(l):Promise.resolve(l).then(n,i)}function vO(a){return function(){var e=this,r=arguments;return new Promise(function(n,i){var o=a.apply(e,r);function s(l){Bg(o,n,i,s,u,"next",l)}function u(l){Bg(o,n,i,s,u,"throw",l)}s(void 0)})}}var gO=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function hO(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=mO(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function mO(a,e){if(a){if(typeof a=="string")return Ug(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ug(a,e):void 0}}function Ug(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function $g(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function gi(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$g(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):$g(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var yO=function(e,r){if(e.findLastIndex)return e.findLastIndex(r);var n=Pe(e).reverse().findIndex(r);return n==-1?-1:e.length-1-n},SO=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var i=vO(ka().mark(function o(s,u,l){var c,d,f,p,v,y,m,S,F,C;return ka().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!n){E.next=3;break}return E.next=3,vf(n);case 3:if(c=!!(l!=null&&l.fetchSelectedValues)&&Array.isArray(s),!c){E.next=7;break}return d=Rd(e).filter(function(_){var A=_.value;return s.includes(A)}),E.abrupt("return",{values:d});case 7:return f=l?.pageSize!=null?l.pageSize:r,p=Rd(e).filter(function(_){var A=_.title,N=_.value;return s==null?!0:A.toUpperCase().indexOf(s.toUpperCase())!=-1||"".concat(N).toUpperCase().indexOf(s.toUpperCase())!=-1}),v=f?Math.ceil(p.length/f):0,y=u||0,m=f?Math.ceil(y/f):null,S=f?p.slice(y,y+f):p,F=f?y+S.length:null,C=f?F<p.length:!1,E.abrupt("return",{values:S,hasMore:C});case 16:case"end":return E.stop()}},o)}));return function(o,s,u){return i.apply(this,arguments)}}()},bO=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!r)return e;var o=e||[],s=r.filter(function(l){return o.find(function(c){return""+c.value==""+l.value})==null}).map(function(l){return i?gi(gi({},l),{},{isHidden:!0}):l}),u=n?[].concat(Pe(s),Pe(o)):[].concat(Pe(o),Pe(s));return u},OO=function(e,r,n){var i,o=e==null||e==""?void 0:(i=e?.value)!==null&&i!==void 0?i:e,s=Dl(o,r),u=n&&!s?Ld(o):void 0,l=s||u,c=l?[l]:void 0;return[o,c]},FO=function(e,r,n){var i=e.map(function(s,u){var l,c=s==null||s==""?void 0:(l=s?.value)!==null&&l!==void 0?l:s,d=Dl(c,r),f=n&&!d?Ld(c):void 0,p=d||f;return p}).filter(function(s){return s!=null}),o=i.map(function(s){var u;return(u=s?.value)!==null&&u!==void 0?u:s});return o.length||(o=void 0),[o,i]},TO=function(e){if(e==null)return null;var r=e.title,n=e.value,i=e.disabled,o=e.groupTitle,s=e.grouplabel,u=e.renderTitle,l=e.children,c=e.label,d=e.isCustom,f=e.isHidden,p=pO(e,gO),v={value:n,title:r||c||l};return i&&(v.disabled=i),d&&(v.isCustom=d),f&&(v.isHidden=f),(o||s)&&(v.groupTitle=o||s),u&&(v.renderTitle=u),v=gi(gi({},v),p),v},CO=function(e){var r=[],n=[],i=hO(e),o;try{var s=function(){var l=o.value,c=yO(r,function(d){var f,p;return((f=d.groupTitle)!==null&&f!==void 0?f:"")==((p=l.groupTitle)!==null&&p!==void 0?p:"")});l.groupTitle!=null&&!n.includes(l.groupTitle)&&(n.push(l.groupTitle),n.length===1&&(r=r.map(function(d){return gi(gi({},d),{},{groupTitle:""})}))),l.groupTitle==null&&n.length&&(l=gi(gi({},l),{},{groupTitle:""})),c!=-1?r.splice(c+1,0,l):r.push(l)};for(i.s();!(o=i.n()).done;)s()}catch(u){i.e(u)}finally{i.f()}return r};function Wg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Pl(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Wg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Nl(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=EO(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function EO(a,e){if(a){if(typeof a=="string")return zg(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zg(a,e):void 0}}function zg(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}var wO=ks,xO=Ms,LO=function(e){return["length"].includes(e)},Kg=["between","not_between","is_empty","is_not_empty","is_null","is_not_null","some","all","none"],RO=["proximity"],jO=function(e){var r={},n=function(J){var Y=e.operators[J],K=Y.spelOps?Y.spelOps:Y.spelOp?[Y.spelOp]:void 0;if(K)K.forEach(function(ne){var de=ne;r[de]||(r[de]=[]),r[de].push(J)});else{var ae,se=(ae=e.operators)===null||ae===void 0?void 0:ae[Y.reversedOp],re=se?.spelOp||se?.spelOps,ie=re||Kg.includes(J)||Kg.includes(Y.reversedOp)||RO.includes(J);ie||xO.warn("[spel] No spelOp for operator ".concat(J))}};for(var i in e.operators)n(i);var o={};for(var s in e.conjunctions){var u=e.conjunctions[s],l=u.spelConj||s.toLowerCase();o[l]=s}var c={},d=Nl(wO(e)),f;try{var p=function(){var J=Ce(f.value,2),Y=J[0],K=J[1],ae=[],se=K.spelFunc;if(typeof se=="string"){var re=Object.keys(K.args||{}).reverse().filter(function(ve){return!!K.args[ve].isOptional||K.args[ve].defaultValue!=null}),ie=se.replace(/\?\./g,".").replace(/\${(\w+)}/g,function(ve,ye){return"?"}),ne=re.reduce(function(ve,ye){return[].concat(Pe(ve),[[ye].concat(Pe(ve[ve.length-1]||[]))])},[]).map(function(ve){return se.replace(/(?:, )?\${(\w+)}/g,function(ye,we){return ve.includes(we)?"":ye}).replace(/\?\./g,".").replace(/\${(\w+)}/g,function(ye,we){return"?"})});ae=[ie].concat(Pe(ne))}var de=Nl(ae),le;try{for(de.s();!(le=de.n()).done;){var fe=le.value;c[fe]||(c[fe]=[]),c[fe].push(Y)}}catch(ve){de.e(ve)}finally{de.f()}};for(d.s();!(f=d.n()).done;)p()}catch(W){d.e(W)}finally{d.f()}var v={};for(var y in e.widgets){var m=e.widgets[y],S=m.spelImportFuncs;if(S){var F=Nl(S),C;try{for(F.s();!(C=F.n()).done;){var w=C.value;if(typeof w=="string"){var E=w.replace(/\?\./g,".").replace(/\${(\w+)}/g,function(W,J){return"?"}),_=Pe(w.matchAll(/\${(\w+)}/g)).map(function(W){var J=Ce(W,2),Y=J[0],K=J[1];return K});v[E]||(v[E]=[]),v[E].push({w:y,argsOrder:_})}}}catch(W){F.e(W)}finally{F.f()}}}var A={},N=function(J){var Y=e.operators[J],K=Y.spelOps?Y.spelOps:Y.spelOp?[Y.spelOp]:void 0;K?.forEach(function(ae){if(ae!=null&&ae.includes("${0}")){var se=ae.replace(/\?\./g,".").replace(/\${(\w+)}/g,function(ie,ne){return"?"}),re=Pe(ae.matchAll(/\${(\w+)}/g)).map(function(ie){var ne=Ce(ie,2),de=ne[0],le=ne[1];return le});A[se]||(A[se]=[]),A[se].push({op:J,argsOrder:re})}})};for(var X in e.operators)N(X);var H=Kp.replace(/\?\./g,".").replace(/\${(\w+)}/g,function(W,J){return"?"});return A[H]=[{op:"!compare",argsOrder:["0","1"]}],{operators:r,conjunctions:o,funcs:c,valueFuncs:v,opFuncs:A}},IO=function(e){var r=[{s:"",params:[],objs:[]}];return Id(e,r),r.map(function(n){var i=n.s,o=n.params;return{s:i,params:o}}).reverse().filter(function(n){var i=n.s;return i!==""&&i!=="?"})},Id=function(e,r){var n=[],i="",o=e.type,s=e.methodName,u=e.val,l=e.obj,c=e.args,d=e.isVar,f=e.cls,p=e.children,v=p?.[p.length-1],y=r[r.length-1];if(o==="!func"){for(var m=l;m;){var S,F=Id(Pl(Pl({},m),{},{obj:null}),[{}]),C=Ce(F,2),w=C[0],E=C[1];if(w!=="?"){var _={s:y.s,params:Pe(y.params),objs:Pe(y.objs)};y.objs.unshift("?"),y.params.unshift(m),r.push(_),y=r[r.length-1]}y.objs.unshift(w),(S=y.params).unshift.apply(S,Pe(E)),m=m.type==="!func"?m.obj:null}var A=Nl(r),N;try{for(A.s();!(N=A.n()).done;){var X,H=N.value;n=[].concat(Pe(H?.params||[]),Pe(c||[])),i="",H!=null&&(X=H.objs)!==null&&X!==void 0&&X.length&&(i+=H.objs.join(".")+"."),i+=(d?"#":"")+s,i+="("+(c||[]).map(function(W){return"?"}).join(", ")+")",H.s=i,H.params=n}}catch(W){A.e(W)}finally{A.f()}}else o==="!new"?(n=c||[],i="new ".concat(f.join("."),"(").concat(n.map(function(W){return"?"}).join(", "),")")):o==="!type"?i="T(".concat(f.join("."),")"):o==="compound"&&v.type==="property"&&LO(v.val)?i=p.map(function(W){var J;if(W===v)return W.val;var Y=Id(Pl(Pl({},W),{},{obj:null}),[{}]),K=Ce(Y,2),ae=K[0],se=K[1];return(J=n).push.apply(J,Pe(se)),ae}).join("."):(n=[e],i="?");return y&&(y.s=i,y.params=n),[i,n]};function qg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function gn(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):qg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Hg=V,AO=Hg.isObject,Xs=Hg.uuid,Qg=oe,_O=Qg.defaultConjunction,ex=Qg.defaultGroupConjunction,Jg=Q,Vl=Jg.getFieldConfig,DO=Jg.getWidgetForFieldOp,Zs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:Xs(),children1:Se({},e.id,e),properties:{conjunction:_O(r),not:n||!1}}},Yg=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,u=NO(i,o,n,r,s),l;return e?(l=e,l.type?(l.type!="group"&&l.type!="case_group"&&(l=Zs(l,i)),l.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0)):l={id:Xs(),type:"case_group",properties:{}},l&&(l.properties=gn(gn({},l.properties),u)),l},Xg=function(e,r,n,i){var o={},s=Yg(null,e,r,n,i);s&&(o[s.id]=s);var u={type:"switch_group",id:Xs(),children1:o,properties:{}};return u},PO=function(e,r,n,i,o){var s=e.groupFilter,u=e.groupFieldValue;if(u.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(u));var l=u.value,c=Ad(i,o,l,r,n);if(c){var d=Vl(i,l),f=d?.mode,p;return s?.type==="group"?p=gn(gn({},s||{}),{},{type:"rule_group",properties:gn(gn(gn({},c.properties),s?.properties||{}),{},{mode:f})}):s?p=gn(gn({},c||{}),{},{type:"rule_group",children1:[s],properties:gn(gn({},c.properties),{},{mode:f})}):p=gn(gn({},c||{}),{},{type:"rule_group",properties:gn(gn({},c.properties),{},{mode:f})}),p.id||(p.id=Xs()),p}},NO=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s={},u,l,c=Vl(e,"!case_value");if(i?.valueType==="case_value")u="case_value";else if(u=c?.mainWidget,l=e.widgets[u],i&&i.valueSrc==="value"){var d;i.valueType=((d=l)===null||d===void 0?void 0:d.type)||c?.type||i.valueType}var f=e.widgets[u];if(u==="case_value"){var p=f?.spelImportValue;if(p){var v=p.call(e.ctx,i),y=Ce(v,2),m=y[0],S=y[1];if(S.map(function(C){return r.errors.push(C)}),m!=null){var F;s={value:[m],valueSrc:["value"],valueType:[(F=f?.type)!==null&&F!==void 0?F:"case_value"],field:"!case_value"}}}}else i!=null&&i?.value!=null&&(s={value:[i.value],valueSrc:[i.valueSrc],valueType:[i.valueType],field:"!case_value"});return s},Ad=function(e,r,n,i,o,s){var u,l;if(!o.filter(function(J){return J===void 0}).length){var c=(u=n)!==null&&u!==void 0&&u.func?"func":"field";AO(n)&&n.valueSrc&&(c=n.valueSrc,n=n.value);var d=Vl(e,n);if(!d){r.errors.push("No config for field ".concat(n));return}var f=Vl(e,s?._groupField),p=d.type=="!group",v=p&&d.mode=="array",y=f?.type=="!group",m=e.operators[i],S=e.operators[(l=m)===null||l===void 0?void 0:l.reversedOp],F=s?.not&&["between"].includes(i),C=!!S,w=C&&(!!e.settings.reverseOperatorsForNot||F||!p&&y),E=s?.not&&w||F;E&&(i=m.reversedOp,m=e.operators[i],s.not=!s.not);var _=!!(s!=null&&s.not),A=DO(e,n,i),N=e.widgets[A||d.mainWidget],X=o.map(function(J){return J.asyncListValues}).filter(function(J){return J!=null}),H=X.length?X[0]:void 0,W={type:"rule",id:Xs(),properties:gn({field:n,fieldSrc:c,operator:i,value:o.map(function(J){return J.value}),valueSrc:o.map(function(J){return J.valueSrc}),valueType:o.map(function(J){return J.valueSrc=="value"&&(N?.type||d?.type)||J.valueType})},H?{asyncListValues:H}:{})};return _&&(W=Zs(W,e,s.not)),W}};function Zg(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function eh(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zg(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Zg(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var VO=Ms,Ml=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=e.getType(),o=e.getChildren().map(function(K){return Ml(K,r,e)});if((i=="op-or"||i=="op-and")&&(o=o.reduce(function(K,ae){var se=ae.type=="op-and"&&ae.children.length==2&&ae.children[0].type=="op-ge"&&ae.children[1].type=="op-le",re=ae.type=="op-or"&&ae.children.length==2&&ae.children[0].type=="op-lt"&&ae.children[1].type=="op-gt",ie=se||re,ne=ae.type==i&&!ae.not&&!ie,de=ne?ae.children:[ae];return[].concat(Pe(K),Pe(de))},[])),i=="op-not")return o.length!=1&&r.errors.push("Operator NOT should have 1 child, but got ".concat(o.length,"}")),eh(eh({},o[0]),{},{not:!o[0].not});if(i=="compound"){o=o.filter(function(K){var ae=K.type=="selection"&&K.children.length==1&&K.children[0].type=="boolean"&&K.children[0].val==!0;return!ae});var s=o.find(function(K){return K.type=="selection"});s&&s.children.length!=1&&r.errors.push("Selection should have 1 child, but got ".concat(s.children.length));var u=s?s.children[0]:null,l=o[o.length-1],c=l.type=="method"&&l.val.methodName=="size"||l.type=="!func"&&l.methodName=="size",d=l.type=="property"&&l.val=="length",f=o.filter(function(K){return K!==s&&K!==l}),p={type:"compound",children:f},v=(c||d)&&th(f)!=null;if(v)return{type:"!aggr",filter:u,source:p};if(o=o.filter(function(K){var ae=K.type=="variable"&&K.val=="this",se=K.type=="variable"&&K.val=="root";return!(ae||se)}),o=o.map(function(K){return K.type=="indexer"&&K.children.length==1?{type:"indexer",val:K.children[0].val,itype:K.children[0].type}:K}),l.type=="!func"){var y={},m=y;do{var S,F;Object.assign(m,l),o=o.filter(function(K){return K!==l}),l=o[o.length-1],((S=l)===null||S===void 0?void 0:S.type)=="!func"?(m.obj={},m=m.obj):o.length>1?m.obj={type:"compound",children:o}:m.obj=l}while(((F=l)===null||F===void 0?void 0:F.type)=="!func");return y}}var C;try{e.getRaw?C=e.getRaw():e.getValue.length==0&&(C=e.getValue())}catch(K){VO.error("[spel2js] Error in getValue()",K)}if(i=="ternary"&&(C=MO(o)),Ye(C)==="object"&&C!==null&&(C.methodName||C.functionName)&&(C.args=C.args.map(function(K){return Ml(K,r,e)})),i=="list"&&(C=C.map(function(K){return Ml(K,r,e)}),!n&&C.length==1))return C[0];if(i=="constructorref"){var w=o.find(function(K){return K.type=="qualifiedidentifier"}),E=w?.val;if(!E){r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(o)));return}var _=o.filter(function(K){return K.type!="qualifiedidentifier"});return{type:"!new",cls:E,args:_}}if(i=="typeref"){var A=o.find(function(K){return K.type=="qualifiedidentifier"}),N=A?.val;if(!N){r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(o)));return}var X=o.filter(function(K){return K.type!="qualifiedidentifier"});return{type:"!type",cls:N}}if(i=="function"||i=="method"){var H=C,W=H.functionName,J=H.methodName,Y=H.args;return{type:"!func",methodName:W||J,isVar:i=="function",args:Y}}return{type:i,children:o,val:C}},MO=function(e){var r=[];function n(i){var o=Ce(i,3),s=o[0],u=o[1],l=o[2];r.push([s,u]),l?.type=="ternary"?n(l.children):r.push([void 0,l])}return n(e),r},th=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=e.map(function(s){if(s.type=="variable"||s.type=="property"||s.type=="indexer"&&s.itype=="string")return s.val;var u,l;i=!0,n&&(r==null||(u=r.errors)===null||u===void 0||(l=u.push)===null||l===void 0||l.call(u,"Unexpected item in field path compound: ".concat(JSON.stringify(s))))});return i?void 0:o};function Wi(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=kO(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function kO(a,e){if(a){if(typeof a=="string")return rh(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rh(a,e):void 0}}function rh(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function nh(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function ah(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nh(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):nh(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var kl=V,ih=kl.isJsonCompatible,oh=kl.isObject,_d=kl.uuid,Dd=kl.logger,eu=Q,sh=eu.getFieldConfig,uh=eu.getFuncConfig,lh=eu.normalizeField,GO=eu.iterateFuncs,BO=eu.getWidgetForFieldOp,ch={number:"number",string:"text",boolean:"boolean",null:"null"},dh={String:"text"},UO="multiselect",zi=function(e,r,n,i){var o,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){e._groupField=(o=e._groupField)!==null&&o!==void 0?o:s?._groupField;var u,l=!0;if(e.type.indexOf("op-")===0||e.type==="matches")u=fh(e,r,n,i,s);else if(e.type=="!aggr"){var c,d=zi(e.source,r,n,i,e);e._groupField=d?.value;var f=zi(e.filter,r,n,i,e);((c=f)===null||c===void 0?void 0:c.type)=="rule"&&(f=Zs(f,n,e.filter.not)),u={groupFilter:f,groupFieldValue:d},s||(u=void 0,i.errors.push("Unexpected !aggr in root"),l=!1)}else if(e.type=="ternary"){var p={};e.val.forEach(function(m){var S=Ce(m,2),F=S[0],C=S[1],w=zi(F,r,n,i,e),E=Pd(C,r,n,i,e),_=Yg(w,E,r,n,i,e);_&&(p[_.id]=_)}),u={type:"switch_group",id:_d(),children1:p,properties:{}}}if(!u&&l&&(u=Ki(e,r,n,i,s)),u&&!u.type&&!s){var v=Pd(e,r,n,i),y=Xg(v,r,n,i);y?u=y:(u=void 0,i.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return u}},fh=function(e,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s,u=e.type.startsWith("op-")?e.type.slice(3):e.type,l=(u=="minus"||u=="plus")&&e.children.length==1;if(l){var c=e.negative;return u=="minus"&&(c=!c),e.children[0].negative=c,zi(e.children[0],r,n,i,o)}var d=u=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",f=u=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",p=d||f;if(p){var v=Ce(e.children[0].children,2),y=v[0],m=v[1],S=Ce(e.children[1].children,2),F=S[0],C=S[1],w=KO(y,F,e,r,n,i,o);if(w){var E=m.val,_=C.val,A={type:"op-between",children:[y,m,C],not:f};return A._groupField=o?._groupField,fh(A,r,n,i,o)}}var N=r.operators[u];u=="eq"&&e.children[1].type=="null"?N=["is_null"]:u=="ne"&&e.children[1].type=="null"?N=["is_not_null"]:u=="le"&&e.children[1].type=="string"&&e.children[1].val==""?N=["is_empty"]:u=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?N=["is_not_empty"]:u=="between"&&(N=["between"]);var X=function(){var ut,Xe=e.children.map(function(et){return zi(et,r,n,i,e)});return Xe.length>=2&&((ut=Xe)===null||ut===void 0||(ut=ut[0])===null||ut===void 0?void 0:ut.type)=="!compare"&&(Xe=Xe[0].children),Xe};if(u=="and"||u=="or"){var H={},W=X();W.forEach(function(Je){if(Je){var ut=_d();Je.id=ut,Je.type!=null?H[ut]=Je:i.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(Je)))}}),s={type:"group",id:_d(),children1:H,properties:{conjunction:r.conjunctions[u],not:e.not}}}else if(N){var J,Y,K,ae=X(),se=ae[0],re=ae.slice(1),ie=se==null||(J=se.groupFieldValue)===null||J===void 0?void 0:J.value,ne=(Y=re)===null||Y===void 0?void 0:Y[0],de=N[0];if(N.length>1){var le,fe,ve=((le=ae[0])===null||le===void 0?void 0:le.valueType)||((fe=ae[1])===null||fe===void 0?void 0:fe.valueType),ye=se?.value,we=N.map(function(Je){return{op:Je,widget:BO(n,ye,Je)}});if(u=="eq"||u=="ne"){var xe=we.find(function(Je){var ut=Je.op,Xe=Je.widget;return Xe&&Xe!="field"});xe&&(de=xe.op)}else Dd.warn("[spel] Spel operator ".concat(u," can be mapped to ").concat(N,"."),"widgets:",we,"vals:",ae,"valueType=",ve)}se!=null&&se.groupFieldValue&&(ne&&ne.groupFieldValue&&ne.groupFieldValue.valueSrc=="field"&&ne.groupFieldValue.value==ie?(de="all",re=[]):de=="equal"&&ne.valueSrc=="value"&&ne.valueType=="number"&&ne.value==0?(de="none",re=[]):de=="greater"&&ne.valueSrc=="value"&&ne.valueType=="number"&&ne.value==0&&(de="some",re=[]));var Fe=n.operators[de],ze=n.operators[(K=Fe)===null||K===void 0?void 0:K.reversedOp],_e=e.not&&["between"].includes(de),Oe=!!ze,Ve=Oe&&(!!n.settings.reverseOperatorsForNot||_e),ke=e.not&&Ve||_e;ke&&(de=Fe.reversedOp,Fe=n.operators[de],e.not=!e.not);var De=!!e.not;if(e.not=!1,se)if(se.groupFieldValue)se.groupFieldValue.valueSrc!="field"&&i.errors.push("Expected group field ".concat(JSON.stringify(se))),s=PO(se,de,re,n,i);else{se.valueSrc!="field"&&se.valueSrc!="func"&&i.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(se)));var Ke=se.value;s=Ad(n,i,Ke,de,re,e)}De&&(s.type!=="group"?s=Zs(s,n,!0):s.properties.not=!s.properties.not)}else if(!o){var $e=Pd(e,r,n,i);s=Xg($e,r,n,i)}return s},Ki=function(e,r,n,i){var o,s,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e!=null){var l=n.settings.fieldSeparator;if(e._groupField=(o=e._groupField)!==null&&o!==void 0?o:u?._groupField,e.type=="variable"||e.type=="property"){var c=lh(n,e.val,e._groupField),d=sh(n,c),f=e.type=="variable";return{valueSrc:"field",valueType:d?.type,isVariable:f,value:c}}else if(e.type=="compound"){var p=th(e.children,i);if(p){var v,y=lh(n,p.join(l),e._groupField),m=sh(n,y),S=((v=e.children)===null||v===void 0||(v=v[0])===null||v===void 0?void 0:v.type)=="variable";return{valueSrc:"field",valueType:m?.type,isVariable:S,value:y}}}else if(ch[e.type]){var F=e.val,C=ch[e.type];return e.negative&&(F=-F),{valueSrc:"value",valueType:C,value:F}}else if(e.type=="!new"&&dh[e.cls.at(-1)]){var w=e.args.map(function(Y){return Ki(Y,r,n,i,e)}),E=w?.[0],_=dh[e.cls.at(-1)];return ah(ah({},E),{},{valueType:_})}else if(e.type=="list"){var A,N=e.val.map(function(Y){return Ki(Y,r,n,i,e)}),X=N.length?(A=N[0])===null||A===void 0?void 0:A.valueType:null,H=N.map(function(Y){return Y?.value}),W=UO;return{valueSrc:"value",valueType:W,value:H}}else if(e.type==="op-plus"&&u?.type==="ternary"&&((s=n.settings.caseValueField)===null||s===void 0?void 0:s.type)==="case_value")return ph(e,r,n,i);var J=$O(e,r,n,i,u);if(J!==void 0)return J;i.errors.push("Can't convert arg of type ".concat(e.type))}},$O=function(e,r,n,i){var o,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=function(_e){return zi(_e,r,n,i,e)},l=IO(e),c=l==null||(o=l[0])===null||o===void 0?void 0:o.s;l.length&&Dd.debug("Signatures for ",e,":",c,l);var d=WO(e,r,n,i,s,l,u);if(d!==void 0)return d;var f=zO(e,r,n,i,s,l,u);if(f!==void 0)return f;var p,v,y,m=Wi(l),S;try{var F=function(){var _e=S.value,Oe=_e.s,Ve=_e.params,ke=r.funcs[Oe];if(ke){p=ke[0],v=uh(n,p);var De=v,Ke=De.spelFunc,$e=Ve.map(u),Je=Pe(Ke.matchAll(/\${(\w+)}/g)).map(function(ut){var Xe=Ce(ut,2),et=Xe[0],Jt=Xe[1];return Jt});return y=Object.fromEntries(Je.map(function(ut,Xe){return[ut,$e[Xe]]})),1}};for(m.s();!(S=m.n()).done&&!F(););}catch(ze){m.e(ze)}finally{m.f()}if(!p){var C=Wi(GO(n)),w;try{for(C.s();!(w=C.n()).done;){var E=Ce(w.value,2),_=E[0],A=E[1];if(A.spelImport){var N=void 0;try{N=A.spelImport.call(n.ctx,e)}catch(ze){Dd.debug("Error while using spelImport for ".concat(_),ze)}if(N){var X;p=_,v=uh(n,p),y={};for(var H in N)y[H]=u(N[H]);var W=!0,J=(X=v)===null||X===void 0?void 0:X.returnType;if(["date","datetime"].includes(J)){var Y,K=Object.keys((Y=v.args)!==null&&Y!==void 0?Y:[]).filter(function(ze){return["date","datetime"].includes(v.args[ze].type)}),ae=Wi(K),se;try{for(ae.s();!(se=ae.n()).done;){var re,ie=se.value,ne=v.args[ie],de=ne.type,le=(re=y[ie])===null||re===void 0?void 0:re.valueType;le&&le!=de&&(W=!1)}}catch(ze){ae.e(ze)}finally{ae.f()}}if(W)break}}}}catch(ze){C.e(ze)}finally{C.f()}}if(p){var fe={};for(var ve in v.args){var ye=v.args[ve],we=y[ve];if(we===void 0)if(we=ye?.defaultValue,we===void 0){if(!(ye!=null&&ye.isOptional)){i.errors.push("No value for arg ".concat(ve," of func ").concat(p));return}}else{var xe;we={value:we,valueSrc:(xe=we)!==null&&xe!==void 0&&xe.func?"func":"value",valueType:ye.type}}we&&(fe[ve]=we)}return{valueSrc:"func",value:{func:p,args:fe},valueType:v.returnType}}var Fe=e.methodName;Fe&&i.errors.push("Signature ".concat(c," - failed to convert"))},WO=function(e,r,n,i,o,s,u){var l,c,d,f=[];for(var p in n.widgets){var v=n.widgets[p],y=v.spelImportFuncs;if(y)for(var m=0;m<y.length;m++){var S=y[m];if(oh(S)){var F={};if(ih(S,e,F)){for(var C in F)F[C]=u(F[C]);f.push({s:"widgets.".concat(p,".spelImportFuncs[").concat(m,"]"),w:p,argsObj:F})}}}}var w=Wi(s),E;try{for(w.s();!(E=w.n()).done;){var _=E.value,A=_.s,N=_.params,X=r.valueFuncs[A]||[],H=Wi(X),W;try{var J=function(){var Fe=W.value,ze=Fe.w,_e=Fe.argsOrder,Oe=N.map(u),Ve=Object.fromEntries(_e.map(function(ke,De){return[ke,Oe[De]]}));f.push({s:A,w:ze,argsObj:Ve})};for(H.s();!(W=H.n()).done;)J()}catch(xe){H.e(xe)}finally{H.f()}}}catch(xe){w.e(xe)}finally{w.f()}for(var Y=0,K=f;Y<K.length;Y++){var ae=K[Y],se=ae.s,re=ae.w,ie=ae.argsObj,ne=n.widgets[re],de=ne.spelImportValue,le=ne.type;d=re,c=se,l=[];for(var fe in ie)["value"].includes(ie[fe].valueSrc)||l.push("".concat(fe," has unsupported value src ").concat(ie[fe].valueSrc));var ve=ie.v.value;if(de&&!l.length){var ye=de.call(n.ctx,ie.v,ne,ie),we=Ce(ye,2);ve=we[0],l=we[1],l&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:le,value:ve}}d&&l.length&&i.errors.push("Signature ".concat(c," - looks like convertable to ").concat(d,", but: ").concat(l.join("; ")))},zO=function(e,r,n,i,o,s,u){var l=[],c=Wi(s),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=f.s,v=f.params,y=r.opFuncs[p]||[],m=Wi(y),S;try{var F=function(){var ie,ne=S.value,de=ne.op,le=ne.argsOrder,fe=v.map(u),ve=[];if(de==="!compare"){if(o.type.startsWith("op-")&&o.children.length==2&&o.children[1].type=="number"&&o.children[1].val===0)return{v:{type:"!compare",children:fe}};ve.push("Result of compareTo() should be compared to 0")}var ye=n.operators[de],we=ye.valueTypes,xe=Object.fromEntries(le.map(function(Oe,Ve){return[Oe,fe[Ve]]})),Fe=xe[0],ze=Object.keys(xe).filter(function(Oe){return parseInt(Oe)>0}).map(function(Oe){return xe[Oe]}),_e=(ie=fe.filter(function(Oe){return!!Oe&&Oe!==Fe}))===null||ie===void 0||(ie=ie[0])===null||ie===void 0?void 0:ie.valueType;we&&_e&&!we.includes(_e)&&ve.push("Op supports types ".concat(we,", but got ").concat(_e)),l.push({opKey:de,foundSign:p,field:Fe,convertedArgs:ze,errs:ve})},C;for(m.s();!(S=m.n()).done;)if(C=F(),C)return C.v}catch(re){m.e(re)}finally{m.f()}}}catch(re){c.e(re)}finally{c.f()}for(var w in n.operators){var E=n.operators[w],_=E.spelImportFuncs,A=E.valueTypes;if(_)for(var N=function(){var ie=_[X];if(oh(ie)){var ne={};if(ih(ie,e,ne)){var de,le=[];for(var fe in ne)ne[fe]=u(ne[fe]);var ve=ne[0],ye=Object.keys(ne).filter(function(xe){return parseInt(xe)>0}).map(function(xe){return ne[xe]}),we=(de=ne[1])===null||de===void 0?void 0:de.valueType;A&&we&&!A.includes(we)&&le.push("Op supports types ".concat(A,", but got ").concat(we)),l.push({opKey:w,foundSign:"spelImportFuncs[".concat(X,"]"),field:ve,convertedArgs:ye,errs:le})}}},X=0;X<_.length;X++)N()}var H=l.find(function(re){var ie=re.errs;return!ie.length});if(H){var W=H.opKey,J=H.foundSign,Y=H.field,K=H.convertedArgs,ae=H.errs;return Ad(n,i,Y,W,K,e)}else if(l.length){var se=l.map(function(re){var ie=re.foundSign,ne=re.opKey,de=re.errs;return"Looks like convertable to ".concat(ne," with signature ").concat(ie,", but: ").concat(de.join("; "))}).join(".  ");i.errors.push(se)}},KO=function(e,r,n,i,o,s){if(e.type==r.type)if(e.type=="!aggr"){var u=[e.source,r.source].map(function(m){return Ki(m,i,o,s,n)}),l=Ce(u,2),c=l[0],d=l[1];return c.value==d.value}else{var f=[e,r].map(function(m){return Ki(m,i,o,s,n)}),p=Ce(f,2),v=p[0],y=p[1];return v.value==y.value}return!1},Pd=function(e,r,n,i){var o,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u;return e?.type==="op-plus"&&((o=n.settings.caseValueField)===null||o===void 0?void 0:o.type)==="case_value"?u=ph(e,r,n,i):u=Ki(e,r,n,i,s),u},ph=function(e,r,n,i){var o=[];function s(u){u.map(function(l){if(l.type==="op-plus")s(l.children);else{var c=Ki(l,r,n,i,e);c?o.push(c):i.errors.push("Can't convert ".concat(l.type," in concatenation"))}})}return s(e.children),{valueSrc:"value",valueType:"case_value",value:o}},vh=Ms,qO=Vn,HO=function(e,r){return gh(e,r,!0)},gh=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i={errors:[]},o=qO(r,void 0,!1),s=jO(o),u,l,c=void 0;try{var d=wb.SpelExpressionEvaluator.compile(e);u=d._compiledExpression}catch(p){i.errors.push(p)}u&&(l=Ml(u,i),vh.debug("convertedObj:",l,i),c=zi(l,s,o,i),c&&c.type!="group"&&c.type!="switch_group"&&(c=Zs(c,o,l.not)),vh.debug("jsTree:",c));var f=c?hd(c):void 0;return n?[f,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),f)},QO={utils:{SqlString:Ua,moment:Rt(),mongoFormatOp1:Tp,mongoFormatOp2:Cp,mongoEmptyValue:sd,escapeRegExp:ff,sqlEmptyValue:Ap,stringifyForDisplay:_p,getTitleInListValues:Tg,spelEscape:$i,spelFixList:cd,wrapWithBrackets:Dp}};const JO=QO;function YO(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=XO(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function XO(a,e){if(a){if(typeof a=="string")return hh(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hh(a,e):void 0}}function hh(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function mh(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function zt(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mh(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):mh(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var ZO={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,r,n,i){var o=e.size>1?e.join(" "+(i?"AND":"&&")+" "):e.first();return(e.size>1||n)&&(o=this.utils.wrapWithBrackets(o)),n&&(o="NOT "+o),o},sqlFormatConj:function(e,r,n){var i=e.size>1?e.join(" AND "):e.first();return(e.size>1||n)&&(i=this.utils.wrapWithBrackets(i)),n&&(i="NOT "+i),i},spelFormatConj:function(e,r,n,i){n&&(i=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||n)&&!i&&(o=this.utils.wrapWithBrackets(o)),n&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,r,n,i){return e.size>1?(n?"NOT ":"")+"("+e.join(" "+(i?"OR":"||")+" ")+")":(n?"NOT (":"")+e.first()+(n?")":"")},sqlFormatConj:function(e,r,n){var i=e.size>1?e.join(" OR "):e.first();return(e.size>1||n)&&(i=this.utils.wrapWithBrackets(i)),n&&(i="NOT "+i),i},spelFormatConj:function(e,r,n,i){return n&&(i=!1),e.size>1?(n?"!":"")+(i?"":"(")+e.join(" || ")+(i?"":")"):(n?"!(":"")+e.first()+(n?")":"")}}},eF={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,r,n,i,o,s,u,l,c){var d=l?"=":s.label;return o=="boolean"&&l?n=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(d," ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(n))},jsonLogic2:"==",jsonLogicOps:["==","datetime==","date=="],jsonLogic:function(e,r,n,i,o,s,u,l){return l!=null&&l.fixJsonLogicDateCompareOp&&["date","datetime"].includes(u)?Se({},"".concat(u,"=="),[e,n]):{"==":[e,n]}},elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,r,n,i,o,s,u,l,c){return o=="boolean"&&l?n=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(s.label," ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(n))},jsonLogic2:"!=",jsonLogicOps:["!=","datetime!=","date!="],jsonLogic:function(e,r,n,i,o,s,u,l){return l!=null&&l.fixJsonLogicDateCompareOp&&["date","datetime"].includes(u)?Se({},"".concat(u,"!="),[e,n]):{"!=":[e,n]}}},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(o){return o},!1].concat(n))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(o){return o},!1].concat(n))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return o},!1].concat(n))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(o){return o},!1].concat(n))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",sqlImport:function(e,r,n){if(e?.operator=="LIKE"||e?.operator=="NOT LIKE"){var i,o=e?.operator=="NOT LIKE",s=e.children||[],u=Ce(s,2),l=u[0],c=u[1];if(c!=null&&(i=c.valueType)!==null&&i!==void 0&&i.endsWith("_quote_string")){if(c!=null&&c.value.startsWith("%")&&c!==null&&c!==void 0&&c.value.endsWith("%"))return c.value=this.utils.SqlString.unescapeLike(c.value.substring(1,c.value.length-1),n),e.operator=o?"not_like":"like",e;if(c!=null&&c.value.startsWith("%"))return c.value=this.utils.SqlString.unescapeLike(c.value.substring(1),n),e.operator="ends_with",e;if(c!=null&&c.value.endsWith("%"))return c.value=this.utils.SqlString.unescapeLike(c.value.substring(0,c.value.length-1),n),e.operator="starts_with",e}}},spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(s){return typeof s=="string"?r.utils.escapeRegExp(s):void 0},!1].concat(i))},jsonLogic:function(e,r,n){return{in:[n,e]}},jsonLogic2:"#in",valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(s){return typeof s=="string"?r.utils.escapeRegExp(s):void 0},!0].concat(i))},jsonLogic:function(e,r,n){return{"!":{in:[n,e]}}},jsonLogic2:"#!in",_jsonLogicIsExclamationOp:!0,valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(s){return typeof s=="string"?"^"+r.utils.escapeRegExp(s):void 0},!1].concat(i))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(s){return typeof s=="string"?r.utils.escapeRegExp(s)+"$":void 0},!1].concat(i))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,r,n,i,o,s,u,l){var c=n.first(),d=n.get(1);return l?"".concat(e," BETWEEN ").concat(c," AND ").concat(d):"".concat(e," >= ").concat(c," && ").concat(e," <= ").concat(d)},spelFormatOp:function(e,r,n,i,o,s,u,l){var c=n[0],d=n[1];return"(".concat(e," >= ").concat(c," && ").concat(e," <= ").concat(d,")")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(n))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,r,n,i,o,s,u,l){var c=n.first(),d=n.get(1);return l?"".concat(e," NOT BETWEEN ").concat(c," AND ").concat(d):"(".concat(e," < ").concat(c," || ").concat(e," > ").concat(d,")")},spelFormatOp:function(e,r,n,i,o,s,u,l){var c=n[0],d=n[1];return"(".concat(e," < ").concat(c," || ").concat(e," > ").concat(d,")")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(n))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",jsonLogic:function(e,r,n){return{"!":{"<=":[Array.isArray(n)?n[0]:n,e,Array.isArray(n)?n[1]:n]}}},jsonLogic2:"!<=",_jsonLogicIsExclamationOp:!0,validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,r,n,i,o,s,u,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,r,n,i,o,s,u,l){var c=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(c,") = ").concat(c)},sqlImport:function(e,r,n){if(e?.operator==="="||e?.operator==="<>"){var i,o=e.children||[],s=Ce(o,2),u=s[0],l=s[1];if(l?.value===""&&u?.func==="COALESCE"&&(u==null||(i=u.children)===null||i===void 0||(i=i[1])===null||i===void 0?void 0:i.value)==="")return e.operator=e?.operator==="="?"is_empty":"is_not_empty",e.children=[u.children[0]],e}},spelFormatOp:function(e,r,n,i,o,s,u,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(s,u){return[r.utils.mongoEmptyValue(u),null]},!1].concat(i))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,r,n,i,o,s,u,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,r,n,i,o,s,u,l){var c=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(c,") <> ").concat(c)},spelFormatOp:function(e,r,n,i,o,s,u,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(s,u){return[r.utils.mongoEmptyValue(u),null]},!1].concat(i))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",sqlImport:function(e,r,n){if(e?.operator==="IS"||e?.operator==="IS NOT"){var i=e.children||[],o=Ce(i,2),s=o[0],u=o[1];if(u?.valueType=="null")return e.operator=e?.operator==="IS"?"is_null":"is_not_null",e.value=s,e}},cardinality:0,reversedOp:"is_not_null",formatOp:function(e,r,n,i,o,s,u,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,r,n,i,o,s,u,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return null},!1].concat(n))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,r,n,i,o,s,u,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,r,n,i,o,s,u,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return null},!1].concat(n))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,r,n,i,o,s,u,l){var c=l?"=":"==";return"".concat(e," ").concat(c," ").concat(n)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(n))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],formatOp:function(e,r,n,i,o,s,u,l){return"".concat(e," != ").concat(n)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(n))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,r,n,i,o,s,u,l){return i=="value"?"".concat(e," IN (").concat(n.join(", "),")"):"".concat(e," IN (").concat(n,")")},sqlFormatOp:function(e,r,n,i,o,s,u,l){if(i=="value")return"".concat(e," IN (").concat(n.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(n))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,r,n,i,o,s,u,l){return i=="value"?"".concat(e," NOT IN (").concat(n.join(", "),")"):"".concat(e," NOT IN (").concat(n,")")},sqlFormatOp:function(e,r,n,i,o,s,u,l){if(i=="value")return"".concat(e," NOT IN (").concat(n.join(", "),")")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(o){return o},!1].concat(n))},reversedOp:"select_any_in",jsonLogic:function(e,r,n){return{"!":{in:[e,n]}}},jsonLogic2:"!in",_jsonLogicIsExclamationOp:!0},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",valueTypes:["multiselect"],formatOp:function(e,r,n,i,o,s,u,l){return i=="value"?"".concat(e," CONTAINS [").concat(n.join(", "),"]"):"".concat(e," CONTAINS ").concat(n)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,r,n){return{some:[e,{in:[{var:""},n]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",spelImportFuncs:[{obj:{type:"property",val:"CollectionUtils"},methodName:"containsAny",args:[{var:"0"},{var:"1"}]}],elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(n))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",valueTypes:["multiselect"],formatOp:function(e,r,n,i,o,s,u,l){return i=="value"?"".concat(e," NOT CONTAINS [").concat(n.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(n)},reversedOp:"multiselect_contains",jsonLogic2:"!some-in",jsonLogic:function(e,r,n){return{"!":{some:[e,{in:[{var:""},n]}]}}},_jsonLogicIsExclamationOp:!0},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",valueTypes:["multiselect"],formatOp:function(e,r,n,i,o,s,u,l){var c=l?"=":"==";return i=="value"?"".concat(e," ").concat(c," [").concat(n.join(", "),"]"):"".concat(e," ").concat(c," ").concat(n)},sqlFormatOp:function(e,r,n,i,o,s,u,l){var c=this;if(i=="value")return"".concat(e," = '").concat(n.map(function(d){return c.utils.SqlString.trim(d)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(n))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,r,n){return{all:[e,{in:[{var:""},n]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],valueTypes:["multiselect"],formatOp:function(e,r,n,i,o,s,u,l){return i=="value"?"".concat(e," != [").concat(n.join(", "),"]"):"".concat(e," != ").concat(n)},sqlFormatOp:function(e,r,n,i,o,s,u,l){var c=this;if(i=="value")return"".concat(e," != '").concat(n.map(function(d){return c.utils.SqlString.trim(d)}).join(","),"'")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(n))},reversedOp:"multiselect_equals",jsonLogic2:"!all-in",jsonLogic:function(e,r,n){return{"!":{all:[e,{in:[{var:""},n]}]}}},_jsonLogicIsExclamationOp:!0},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,r,n,i,o,s,u,l){var c=n.first(),d=n.get(1),f=u?.get("proximity");return"".concat(e," ").concat(c," NEAR/").concat(f," ").concat(d)},sqlFormatOp:function(e,r,n,i,o,s,u,l){var c=n.first(),d=n.get(1),f=this.utils.SqlString.trim(c),p=this.utils.SqlString.trim(d),v=u?.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(f,", ").concat(p,"), ").concat(v,")')")},sqlImport:function(e,r,n){if(e?.func==="CONTAINS"){var i,o=e.children||[],s=Ce(o,2),u=s[0],l=s[1];if(l!=null&&(i=l.value)!==null&&i!==void 0&&i.includes("NEAR(")){var c=l.value.match(/NEAR\(\((\w+), (\w+)\), (\d+)\)/);if(c)return delete e.func,e.operator="proximity",e.children=[u,{value:c[1]},{value:c[2]}],e.operatorOptions={proximity:parseInt(c[3])},e}}},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return 0},!1].concat(n))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,r,n){return"".concat(e," == ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(n))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return 0},!1].concat(n))}}},tF={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,r,n,i){return i?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,r,n,i,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,r,n,i,o,s,u){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,i!="starts_with",i!="ends_with",u):this.utils.SqlString.escape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,r,n,i){return i?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,i!="starts_with",i!="ends_with",u):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,r,n,i){return i?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,r,n){var i=n.step&&!Number.isInteger(n.step);return this.utils.spelEscape(e,i)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,r,n,i){return i?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,r,n,i){var o=this.utils.getTitleInListValues(r.fieldSettings.listValues||r.asyncListValues,e);return i?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,r,n,i){var o=this,s=e.map(function(u){return o.utils.getTitleInListValues(r.fieldSettings.listValues||r.asyncListValues,u)});return i?s.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,r,n,i,o,s,u){var l=this;return e.map(function(c){return l.utils.SqlString.escape(c)})},spelFormatValue:function(e,r,n,i,o){var s=o&&o.spelOp&&o.spelOp.startsWith("${1}"),u=this.utils.spelEscape(e);return s&&(u=this.utils.spelFixList(u)),u},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,r,n,i){var o=this.utils.moment(e,n.valueFormat);return i?o.format(n.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){var l=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(l.format("YYYY-MM-DD"))},spelFormatValue:function(e,r,n,i,o){var s=this.utils.moment(e,n.valueFormat),u=s.format("YYYY-MM-DD"),l="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(u,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,r,n){var i,o,s,u;if(!r)return[void 0,"No widget def to get value format"];if(n!=null&&(i=n.fmt)!==null&&i!==void 0&&(i=i.value)!==null&&i!==void 0&&(o=i.includes)!==null&&o!==void 0&&o.call(i," ")||(s=n.fmt)!==null&&s!==void 0&&(s=s.value)!==null&&s!==void 0&&(u=s.toLowerCase)!==null&&u!==void 0&&u.call(s).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(n.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){return this.utils.moment.utc(e,n.valueFormat).toDate()},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0},mongoFormatValue:function(e,r,n){var i=this.utils.moment(e,n.valueFormat);if(i.isValid())return{$dateFromString:{dateString:i.format("YYYY-MM-DD"),format:"%Y-%m-%d"}}}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,r,n,i){var o=this.utils.moment(e,n.valueFormat);return i?o.format(n.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){var l=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(l.format("HH:mm:ss"))},spelFormatValue:function(e,r,n,i,o){var s=this.utils.moment(e,n.valueFormat),u="HH:mm:ss",l=s.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,r,n){var i,o,s;if(!r)return[void 0,"No widget def to get value format"];if(n!=null&&n.fmt&&(!((i=n.fmt)!==null&&i!==void 0&&(i=i.value)!==null&&i!==void 0&&(o=i.toLowerCase)!==null&&o!==void 0&&o.call(i).includes("hh:mm"))||(s=n.fmt)!==null&&s!==void 0&&(s=s.value)!==null&&s!==void 0&&s.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(n.fmt))];var u=this.utils.moment(e.value,"HH:mm:ss");return u.isValid()?[u.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){var i=this.utils.moment(e,n.valueFormat);return i.get("hour")*60*60+i.get("minute")*60+i.get("second")},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.get("hour")*60*60+n.get("minute")*60+n.get("second"):void 0},mongoFormatValue:function(e,r,n){var i=this.utils.moment(e,n.valueFormat);return i.get("hour")*60*60+i.get("minute")*60+i.get("second")},elasticSearchFormatValue:function(e,r,n,i){return{script:{script:{source:"doc[".concat(i,"][0].getHour() >== params.min && doc[").concat(i,"][0].getHour() <== params.max"),params:{min:r[0],max:r[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,r,n,i){var o=this.utils.moment(e,n.valueFormat);return i?o.format(n.dateFormat+" "+n.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,i,o,s,u){var l=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(l.toDate())},spelFormatValue:function(e,r,n,i,o){var s=this.utils.moment(e,n.valueFormat),u=s.format("YYYY-MM-DD HH:mm:ss"),l="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(u,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,r,n){var i,o;if(!r)return[void 0,"No widget def to get value format"];if(!(n!=null&&(i=n.fmt)!==null&&i!==void 0&&(i=i.value)!==null&&i!==void 0&&(o=i.includes)!==null&&o!==void 0&&o.call(i," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(n.fmt))];var s=this.utils.moment(e.value,this.utils.moment.ISO_8601);return s.isValid()?[s.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){return this.utils.moment(e,n.valueFormat).toDate()},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0},mongoFormatValue:function(e,r,n){var i=this.utils.moment(e,n.valueFormat);if(i.isValid())return{$dateFromString:{dateString:i.format("YYYY-MM-DD HH:mm:ss"),format:"%Y-%m-%d %H:%M:%S"}}}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,r,n,i){return i?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,r,n,i,o,s,u){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,r,n,i,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},field:{valueSrc:"field",formatValue:function(e,r,n,i,o,s,u){return i&&u.label||e},sqlFormatValue:function(e,r,n,i,o,s,u){return e},spelFormatValue:function(e,r,n,i,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return e===""?null:e}}},rF={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},nF=zt(zt({},Mf),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,r,n,i,o,s){var u=this,l=i.map(function(c,d){var f=c.key,p=c.parent,v=c.fieldSeparator;return d==0?p=="[map]"?"#this[".concat(u.utils.spelEscape(f),"]"):(p=="[class]",f):p=="map"||p=="[map]"?"[".concat(u.utils.spelEscape(f),"]"):(p=="class"||p=="[class]","".concat(v).concat(f))}).join("");return o.fieldName&&(l=e),o.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(e!=null)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(e!=null)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,r,n,i,o,s){if(e!=null)return s?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,r,n,i,o,s,u,l,c,d){var f=u.labelForFormat,p=u.cardinality;if(p==0){var v=e?" HAVE ".concat(e):"";return"".concat(f," OF ").concat(r).concat(v)}else if(p==null||p==1){var y=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(r).concat(y," ").concat(f," ").concat(i)}else if(p==2){var m=e?" WHERE ".concat(e):"",S=i.first(),F=i.get(1);return"COUNT OF ".concat(r).concat(m," ").concat(f," ").concat(S," AND ").concat(F)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,r,n,i){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),yh=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i={rangeslider:oF,treeselect:sF,treemultiselect:uF,rangeable__date:iF("date","date")},o=YO(r),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=i[u];if(l)e=l(e,n);else throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(u))}}catch(c){o.e(c)}finally{o.f()}return e},Sh=function(e,r){return yh(e,r,!0)},aF=function(e,r){return yh(e,r,!1)},iF=function(e,r){return function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.types;return o=zt(zt({},o),{},Se({},e,zt(zt({},o[e]),{},{widgets:zt({},o[e].widgets)}))),i?o[e].widgets[r]=zt({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[r]):delete o[e].widgets[r],zt(zt({},n),{},{types:o})}},oF=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,i=e.types;return n=zt({},n),r?n.rangeslider=zt({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(s,u,l,c){return c?this.utils.stringifyForDisplay(s):JSON.stringify(s)},sqlFormatValue:function(s,u,l,c,d,f,p){return this.utils.SqlString.escape(s)},spelFormatValue:function(s){return this.utils.spelEscape(s)},singleWidget:"slider",toJS:function(s,u){return s}},n.rangeslider):delete n.rangeslider,i=zt(zt({},i),{},{number:zt(zt({},i.number),{},{widgets:zt({},i.number.widgets)})}),r?i.number.widgets.rangeslider=zt({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},i.number.widgets.rangeslider):delete i.number.widgets.rangeslider,zt(zt({},e),{},{widgets:n,types:i})},sF=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,i=e.types;return n=zt({},n),r?n.treeselect=zt({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(s,u,l,c){var d=u.fieldSettings.treeValues||u.fieldSettings.listValues||u.asyncListValues,f=this.utils.getTitleInListValues(d,s);return c?this.utils.stringifyForDisplay(f):JSON.stringify(s)},sqlFormatValue:function(s,u,l,c,d,f,p){return this.utils.SqlString.escape(s)},spelFormatValue:function(s){return this.utils.spelEscape(s)},toJS:function(s,u){return s}},n.treeselect):delete n.treeselect,i=zt({},i),r?i.treeselect=zt({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},i.treeselect):delete i.treeselect,zt(zt({},e),{},{widgets:n,types:i})},uF=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,i=e.types;return n=zt({},n),r?n.treemultiselect=zt({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(s,u,l,c){var d=this,f=u.fieldSettings.treeValues||u.fieldSettings.listValues||u.asyncListValues,p=s.map(function(v){return d.utils.getTitleInListValues(f,v)});return c?p.map(this.utils.stringifyForDisplay):s.map(JSON.stringify)},sqlFormatValue:function(s,u,l,c,d,f,p){var v=this;return s.map(function(y){return v.utils.SqlString.escape(y)})},spelFormatValue:function(s){return this.utils.spelEscape(s)},toJS:function(s,u){return s}},n.treemultiselect):delete n.treemultiselect,i=zt({},i),r?i.treemultiselect=zt({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},i.treemultiselect):delete i.treemultiselect,zt(zt({},e),{},{widgets:n,types:i})},lF={addMixins:Sh,removeMixins:aF},Nd={conjunctions:ZO,operators:eF,widgets:tF,types:rF,settings:nF,ctx:JO};Nd=Sh(Nd,["rangeslider","treeselect","treemultiselect"]);const gr=Nd;var bh="ADD_GROUP",Vd="ADD_CASE_GROUP",Oh="REMOVE_GROUP",Fh="SET_CONJUNCTION",Th="SET_NOT",Ch="ADD_RULE",Eh="REMOVE_RULE",wh="SET_FIELD",xh="SET_FIELD_SRC",Lh="SET_OPERATOR",Rh="SET_VALUE",jh="SET_VALUE_SRC",Ih="SET_FUNC_VALUE",Ah="SET_OPERATOR_OPTION",_h="SET_LOCK",Md="SET_TREE",Dh="MOVE_ITEM",Ph="after",Nh="before",kd="append",Gd="prepend",Vh="SET_DRAG_PROGRESS",Mh="SET_DRAG_START",kh="SET_DRAG_END",cF=b(73916),Gl=b.n(cF);function Gh(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Ea(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gh(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Gh(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Bd(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=dF(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function dF(a,e){if(a){if(typeof a=="string")return Bh(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bh(a,e):void 0}}function Bh(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}var Uh=function(e,r,n,i,o,s){var u,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},d=e.getIn(Ge(r));if(!d)return e;var f=(o==null||(u=o.get)===null||u===void 0?void 0:u.call(o,"id"))||i,p=s.settings.shouldCreateEmptyGroup,v=r.push(f),y=!p,m=!!(c!=null&&c.isDefaultCase),S=e;return e=qi(e,r,n,f,di(s).merge(G(o)||{}),s,l),e!==S&&(!l&&!m&&(e=e.setIn(Ge(v,"children1"),new be.OrderedMap),y&&(e=qi(e,v,"rule",Qe(),Ca(s,c?.parentRuleGroupField),s))),e=ua(e)),e},fF=function(e,r,n){var i=e.getIn(Ge(r));if(!i)return e;e=Ud(e,r);var o=n.settings.canLeaveEmptyGroup,s=r.slice(0,-1),u=!$c(e,s);if(u&&!o&&(e=gl(e),Uc(e)&&!o)){var l=!1,c=!1;e=qi(e,new be.List,"rule",Qe(),Ca(n,void 0,void 0,l,c),n)}return e=ua(e),e},pF=function(e,r,n){var i=e.getIn(Ge(r));if(!i)return e;e=Ud(e,r);var o=n.settings.canLeaveEmptyGroup,s=r.pop(),u=e.getIn(Ge(s)),l=u.getIn(["properties","field"]),c=u.getIn(["properties","operator"]),d=l?Ze(n,l):null,f=c?Mt(n,c,l):null,p=l&&c&&f.cardinality!=0,v=u.get("type")=="rule_group",y=!$c(e,s),m=v?p&&d.initialEmptyWhere:o;if(y&&!m&&(v&&(e=e.deleteIn(Ge(s))),e=gl(e),Uc(e)&&!o)){var S=!1,F=!1;e=qi(e,new be.List,"rule",Qe(),Ca(n,void 0,void 0,S,F),n)}return e=ua(e),e},vF=function(e,r,n){var i=e.getIn(Ge(r));return i&&(e=e.setIn(Ge(r,"properties","not"),n)),e},gF=function(e,r,n){var i=e.getIn(Ge(r));return i&&(e=wf(e.setIn(Ge(r,"properties","isLocked"),n))),e},hF=function(e,r,n){var i=e.getIn(Ge(r));return i&&(e=e.setIn(Ge(r,"properties","conjunction"),n)),e},qi=function(e,r,n,i,o,s){var u,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(n==="switch_group")throw new Error("Can't add switch_group programmatically");var c=e.getIn(Ge(r));if(!c)return e;var d=(o==null||(u=o.get)===null||u===void 0?void 0:u.call(o,"id"))||i,f=s.settings,p=f.maxNumberOfCases,v=f.maxNumberOfRules,y=f.maxNesting,m=e.get("type"),S=m==="switch_group",F=S?e.getIn(Ge(r.take(2))):null,C=Ge(r,"children1"),w=e.getIn(C),E=!!w&&w.size,_=E?w.size:null,A,N;if(n==="case_group")A=_,N=p;else if(n==="group"){var X=Gc(e,r);if(X.length){var H=X[0],W=H.path,J=H.field,Y=Ze(s,J);A=r.size-W.length,N=Y?.maxNesting}else A=r.size,N=y}else{var K=Gc(e,r);if(K.length){var ae=K[0],se=ae.path,re=ae.field,ie=Ze(s,re),ne=ui(e,se);N=ie?.maxNumberOfRules,A=hl(ne)}else A=hl(S?F:e),N=v}var de=N&&A?A<N:!0,le={type:n,id:d,properties:o};Kh(s,le,l);var fe=n==="case_group"&&E&&w.last().get("children1")==null;if(de){var ve=new be.OrderedMap(Se({},d,new be.Map(le)));if(!E)e=e.setIn(C,ve);else if(fe){var ye=w.last(),we=new be.OrderedMap(Se(Se({},d,new be.Map(le)),ye.get("id"),ye));e=e.deleteIn(Ge(C,"children1",ye.get("id"))),e=e.mergeIn(C,we)}else e=e.mergeIn(C,ve);e=ua(e)}return e},Ud=function(e,r){return e=e.deleteIn(Ge(r)),e=ua(e),e},mF=function(e,r,n,i,o){var s=ui(e,r),u=r.pop(),l=r.size>1?ui(e,u):null,c=l?l.get("children1"):null,d=ui(e,n),f=i==kd||i==Gd?n:n.pop(),p=i==kd||i==Gd?d:n.size>1?ui(e,f):null,v=p?p.get("children1"):null;if(!l||!p||!s)return e;var y=l.get("id")==p.get("id"),m=f.size<u.size&&ol(f.toArray(),u.toArray().slice(0,f.size)),S=f.size>u.size&&ol(u.toArray(),f.toArray().slice(0,u.size)),F=null,C=null;m?F=be.List(u.toArray().slice(f.size)):S&&(C=be.List(f.toArray().slice(u.size)));var w=v,E=c;return S||(E=E.delete(s.get("id"))),y?w=E:m&&(w=w.updateIn(kc(F,"children1"),function(_){return E})),i==Nh||i==Ph?w=be.OrderedMap().withMutations(function(_){var A=Bd(w.entries()),N;try{for(A.s();!(N=A.n()).done;){var X=Ce(N.value,2),H=X[0],W=X[1];H==d?.get("id")&&i==Nh&&_.set(s.get("id"),s),_.set(H,W),H==d?.get("id")&&i==Ph&&_.set(s.get("id"),s)}}catch(J){A.e(J)}finally{A.f()}}):i==kd?w=w.merge(be.OrderedMap(Se({},s.get("id"),s))):i==Gd&&(w=be.OrderedMap(Se({},s.get("id"),s)).merge(w)),S&&(E=E.updateIn(kc(C,"children1"),function(_){return w}),E=E.delete(s.get("id"))),!y&&!m&&(e=e.updateIn(Ge(u,"children1"),function(_){return E})),S||(e=e.updateIn(Ge(f,"children1"),function(_){return w})),e=ua(e),e},yF=function(e,r,n,i){var o=e.getIn(Ge(r));if(!o)return e;var s=i.settings.keepInputOnChangeFieldSrc,u=o.get("properties"),l=u?.get("field"),c=u?.get("fieldType"),d=Ze(i,l),f=d?.type||c;(!f||f==="!group"||f==="!struct")&&(f=null);var p=!ul.includes(f),v=s&&!qc(o,i)&&p;return v?(e=e.setIn(Ge(r,"properties","field"),null),e=e.deleteIn(Ge(r,"properties","fieldError")),e=e.setIn(Ge(r,"properties","fieldType"),f)):e=e.setIn(Ge(r,"properties"),Ca(i,null,null,!1)),e=e.setIn(Ge(r,"properties","fieldSrc"),n),e},SF=function(e,r,n,i,o,s,u,l,c){var d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:{},f=r.getIn(Ge(n));if(!f)return r;var p=i===-1,v=f.get("properties"),y=v.get("field"),m=v.get("value"),S=p?y:m.getIn([i]),F=[],C=S,w=Bd(o||[]),E;try{for(w.s();!(E=w.n()).done;){var _=Ce(E.value,2),A=_[0],N=_[1];if(F.push([A,N,C]),A!==C.get("func")){var X=F.map(function(we){var xe=Ce(we,2),Fe=xe[0],ze=xe[1];return"".concat(Fe,"(").concat(ze,")")}).join("/")||"root";throw new Error("In ".concat(p?"LHS":"RHS"," for path ").concat(X," expected func key ").concat(A," but got ").concat(C.get("func")))}C=C.getIn(["args",N,"value"])}}catch(we){w.e(we)}finally{w.f()}if(s){var J=C.get("func"),Y=kr(e,J),K=Y.args,ae=K[s];l==="!valueSrc"?C=Pg(C,s,u,ae,e):(C=bl(C,s,u,ae,e),c&&(C=Ng(C,s,c,ae,e)))}else{var H=u,W=!0;C=Dg(C,H,e,W),d.canDropArgs=!0}for(var se=C;F.length;){var re=F.pop(),ie=Ce(re,3),ne=ie[0],de=ie[1],le=ie[2],fe=kr(e,ne),ve=fe.args,ye=ve[de];se=bl(le,de,se,ye,e)}return p?$h(r,n,se,e,void 0,d):Wh(r,n,i,se,void 0,e,void 0,d)},$h=function(e,r,n,i,o){var s,u,l,c,d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},f=e.getIn(Ge(r));if(!f)return{state:e};var p=d.isEndValue,v=d.canDropArgs;if(!n)return e=Ud(e,r),{state:e};var y=i.settings,m=y.fieldSeparator,S=y.setOpOnChangeField,F=y.showErrorMessage;Array.isArray(n)&&(n=n.join(m));var C=f.get("type"),w=f.get("properties"),E=C=="rule_group",_=w?.get("fieldSrc"),A=Ze(i,n);if(!A)return console.warn("No config for LHS ".concat(n)),{state:e};var N=A.type;(N==="!group"||N==="!struct")&&(N=null);var X=w?.get("operator"),H=w?.get("operatorOptions"),W=w?.get("field"),J=A.type=="!group",Y=J&&A.mode=="array",K=E!=J,ae=A&&((s=A.operators)===null||s===void 0?void 0:s.indexOf(X))!==-1?X:null,se=_==="func"&&(W==null||(u=W.get)===null||u===void 0?void 0:u.call(W,"func"))===((l=n)===null||l===void 0||(c=l.get)===null||c===void 0?void 0:c.call(l,"func")),re=se&&!!ae,ie=null,ne=_==="func"?Cf(i,N):vl(i,n);if(ne&&ne.length==1)ie=ne[0];else if(re)ie=ae;else if(ne&&ne.length>1){var de=Bd(S),le;try{for(de.s();!(le=de.n()).done;){var fe=le.value;if(fe=="keep"&&!K?ie=ae:fe=="default"?ie=Kc(i,n,!1):fe=="first"&&(ie=Mc(i,n)),ie)break}}catch(Ve){de.e(Ve)}finally{de.f()}}if(!J&&!A.operators)return console.warn("Type ".concat(A.type," is not supported")),{state:e};E&&!J&&(e=e.setIn(Ge(r,"type"),"rule"),e=e.deleteIn(Ge(r,"children1")),e=e.setIn(Ge(r,"properties"),new be.OrderedMap)),w||(e=e.setIn(Ge(r,"properties"),new be.OrderedMap));var ve=!F;if(J){e=e.setIn(Ge(r,"type"),"rule_group");var ye=Do({validateValue:Ta,validateRange:vi},i,i,w,n,ie,"field",ve,p,v),we=ye.canReuseValue,xe=ye.newValue,Fe=ye.newValueSrc,ze=ye.newValueType,_e=ye.operatorCardinality,Oe=di(i,A,n).merge({field:n,fieldSrc:"field",mode:A.mode});Y&&(Oe=Oe.merge({operator:ie,value:xe,valueSrc:Fe,valueType:ze})),e=e.setIn(Ge(r,"children1"),new be.OrderedMap),e=e.setIn(Ge(r,"properties"),Oe),A.initialEmptyWhere&&_e==1||(e=qi(e,r,"rule",Qe(),Ca(i,n),i)),e=ua(e)}else e=e.updateIn(Ge(r,"properties"),function(Ve){return Ve.withMutations(function(ke){var De=Do({validateValue:Ta,validateRange:vi},i,i,ke,n,ie,"field",ve,p,v),Ke=De.canReuseValue,$e=De.newValue,Je=De.newValueSrc,ut=De.newValueType,Xe=De.newValueError,et=De.newFieldError,Jt=De.fixedField,kt=n,Kt=Jt!==n;Kt&&(kt=Jt),F&&(ke=ke.set("fieldError",et),ke=ke.set("valueError",Xe));var Ct=Ke?H:Gs(i,ie,kt);return ke=ke.set("field",kt).delete("fieldType").set("fieldSrc",_).set("operator",ie).set("operatorOptions",Ct).set("value",$e).set("valueSrc",Je).set("valueType",ut),Ke||(ke=ke.delete("asyncListValues")),ke})});return{state:e}},bF=function(e,r,n,i){var o=e.getIn(Ge(r));if(!o)return e;var s=i.settings.showErrorMessage,u=o.get("properties"),l=o.get("children1"),c=u.get("field"),d=u.get("fieldSrc"),f=Ze(i,c),p=f?.type=="!group",v=Mt(i,n,c),y=v?Mr(v):null,m=!0;return e=e.updateIn(Ge(r,"properties"),function(S){return S.withMutations(function(F){var C=F.get("field"),w=F.get("operatorOptions"),E=F.get("value",new be.List),_=F.get("valueSrc",new be.List),A=F.get("operator"),N=Do({validateValue:Ta,validateRange:vi},i,i,F,C,n,"operator",m),X=N.canReuseValue,H=N.newValue,W=N.newValueSrc,J=N.newValueType,Y=N.newValueError;s&&(F=F.set("valueError",Y));var K=X?w:Gs(i,n,C);return X||(F=F.delete("asyncListValues")),F.set("operator",n).set("operatorOptions",K).set("value",H).set("valueSrc",W).set("valueType",J)})}),p&&y==0&&l.size==0&&(e=qi(e,r,"rule",Qe(),Ca(i,c),i)),e},Wh=function(e,r,n,i,o,s,u){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=e.getIn(Ge(r));if(!c)return{state:e};var d=l.canDropArgs,f=l.isEndValue,p=s.settings,v=p.fieldSeparator,y=p.showErrorMessage,m=e.getIn(Ge(r,"properties","valueSrc",n+""))||null;m==="field"&&Array.isArray(i)&&(i=i.join(v));var S=e.getIn(Ge(r,"properties","field"))||null,F=e.getIn(Ge(r,"properties","operator"))||null,C=Mt(s,F,S),w=F?Mr(C):null,E=o||Af(i,m,s),_=!y,A=Ta(s,S,S,F,i,E,m,u,_,f,d),N=Ce(A,2),X=N[0],H=N[1],W=H?.find(function(le){return!le.fixed&&!le.ignore}),J=W?Hn(W):null,Y=X!==i;Y&&(i=X),e=zh(e,r,s,w);var K=Array.from({length:w},function(le,fe){return fe==n?i:e.getIn(Ge(r,"properties","value",fe+""))||null}),ae=Array.from({length:w},function(le,fe){return e.getIn(Ge(r,"properties","valueSrc",fe+""))||null}),se=vi(s,S,F,K,ae),re=se?Hn(se):null,ie=!J&&!re,ne=y?!0:ie||Y;if(ne&&(e=e.deleteIn(Ge(r,"properties","asyncListValues")),typeof i>"u"?(e=e.setIn(Ge(r,"properties","value",n),void 0),e=e.setIn(Ge(r,"properties","valueType",n),null)):(u&&(e=e.setIn(Ge(r,"properties","asyncListValues"),u)),e=e.setIn(Ge(r,"properties","value",n),i),e=e.setIn(Ge(r,"properties","valueType",n),E))),y){var de=e.getIn(Ge(r,"properties","valueError"));de||(e=e.setIn(Ge(r,"properties","valueError"),new be.List(new Array(w)))),e=e.setIn(Ge(r,"properties","valueError",n),J),w>=2&&(e=e.setIn(Ge(r,"properties","valueError",w),re))}return{state:e}},OF=function(e,r,n,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},u=e.getIn(Ge(r));if(!u)return e;var l=o.settings.showErrorMessage,c=e.getIn(Ge(r,"properties","field"))||null,d=e.getIn(Ge(r,"properties","operator"))||null,f=Mt(o,d,c),p=d?Mr(f):null;if(e=zh(e,r,o,p),e=e.setIn(Ge(r,"properties","value",n+""),void 0),e=e.setIn(Ge(r,"properties","valueType",n+""),null),e=e.deleteIn(Ge(r,"properties","asyncListValues")),l&&(e=e.setIn(Ge(r,"properties","valueError",n),null),f!=null&&f.validateValues&&(e=e.setIn(Ge(r,"properties","valueError",p),null))),typeof i>"u"?e=e.setIn(Ge(r,"properties","valueSrc",n+""),null):e=e.setIn(Ge(r,"properties","valueSrc",n+""),i),i){var v=e.getIn(Ge(r,"properties")),y=!0,m=Do({validateValue:Ta,validateRange:vi},o,o,v,c,d,"valueSrc",y),S=m.canReuseValue,F=m.newValue,C=m.newValueSrc,w=m.newValueType,E=m.newValueError;!S&&C.get(n)==i&&(e=e.setIn(Ge(r,"properties","value",n+""),F.get(n)),e=e.setIn(Ge(r,"properties","valueType",n+""),w.get(n)))}return e},FF=function(e,r,n,i){var o=e.getIn(Ge(r));return o?e.setIn(Ge(r,"properties","operatorOptions",n),i):e},TF=function(e,r){var n=r.settings.canLeaveEmptyGroup;return n||(e=gl(e)),e},zh=function(e,r,n,i){if(!i){var o=e.getIn(Ge(r,"properties","field"))||null,s=e.getIn(Ge(r,"properties","operator"))||null,u=Mt(n,s,o);i=s?Mr(u):null}for(var l=0,c=["value","valueType","valueError","valueSrc"];l<c.length;l++){var d=c[l];e.getIn(Ge(r,"properties",d))||(e=e.setIn(Ge(r,"properties",d),new be.List(i?Array.from({length:i}):[])))}return e},Kh=function(e,r,n){n&&Array.isArray(n)&&(r.children1=new be.OrderedMap(n.reduce(function(i,o){var s,u=(s=o.id)!==null&&s!==void 0?s:Qe(),l=Ea(Ea({},o),{},{properties:kg(e,o).merge(G(o.properties)||{}),id:u});return Kh(e,l,l.children1),Ea(Ea({},i),{},Se({},u,new be.Map(l)))},{})))},CF=function(e,r){var n=e.getIn(Ge(r,"properties","field"))||null;return n},qh={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},EF=function(e,r){if(!e||!e.type)return null;var n=["config","asyncListValues"],i=[Md,Mh,Vh,kh],o=Gl()(El()(e,n),Ac),s=e.path&&CF(r.tree,e.path)||e.field;if(s){var u;(u=s)!==null&&u!==void 0&&u.toJS&&(s=s.toJS()),o.affectedField=s}return(i.includes(e.type)||e.type.indexOf("@@redux")==0)&&(o=null),o};const wF=function(a,e,r,n,i){var o=e,s=Ea({tree:o},qh);return function(){var u,l,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s,d=arguments.length>1?arguments[1]:void 0,f=(u=(l=i?.())!==null&&l!==void 0?l:d?.config)!==null&&u!==void 0?u:a,p={__lastAction:void 0},v={},y=EF(d,c);switch(d?.type){case Md:{var m=r(f,d.tree);v.tree=m;break}case Vd:{v.tree=Uh(c.tree,d.path,"case_group",d.id,d.properties,f,d.children,d.meta);break}case bh:{v.tree=Uh(c.tree,d.path,"group",d.id,d.properties,f,d.children,d.meta);break}case Oh:{v.tree=fF(c.tree,d.path,f);break}case Ch:{v.tree=qi(c.tree,d.path,d.ruleType,d.id,d.properties,f,d.children);break}case Eh:{v.tree=pF(c.tree,d.path,f);break}case Fh:{v.tree=hF(c.tree,d.path,d.conjunction);break}case Th:{v.tree=vF(c.tree,d.path,d.not);break}case wh:{var S=$h(c.tree,d.path,d.field,f,d.asyncListValues,d._meta),F=S.state;v.tree=F;break}case xh:{v.tree=yF(c.tree,d.path,d.srcKey,f);break}case _h:{v.tree=gF(c.tree,d.path,d.lock);break}case Lh:{v.tree=bF(c.tree,d.path,d.operator,f);break}case Rh:{var C=Wh(c.tree,d.path,d.delta,d.value,d.valueType,f,d.asyncListValues,d._meta),w=C.state;v.tree=w;break}case Ih:{var E=SF(f,c.tree,d.path,d.delta,d.parentFuncs,d.argKey,d.value,d.valueType,d.asyncListValues,d._meta),_=E.state;v.tree=_;break}case jh:{v.tree=OF(c.tree,d.path,d.delta,d.srcKey,f,d._meta);break}case Ah:{v.tree=FF(c.tree,d.path,d.name,d.value);break}case Dh:{v.tree=mF(c.tree,d.fromPath,d.toPath,d.placement,f);break}case Mh:{v.dragStart=d.dragStart,v.dragging=d.dragging,v.mousePos=d.mousePos;break}case Vh:{v.mousePos=d.mousePos,v.dragging=d.dragging;break}case kh:{v.tree=TF(c.tree,f),v=Ea(Ea({},v),qh);break}default:break}return y&&(v.__lastAction=y),n&&v.tree&&c.tree&&n(c.tree),Ea(Ea(Ea({},c),p),v)}};var xF=function(e,r){return{type:Md,tree:r,config:e}},LF=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:Ch,ruleType:i,children:o,path:Ar(r),id:Qe(),properties:Ca(e,s).merge(G(n)||{}),config:e,meta:{parentRuleGroupField:s}}},RF=function(e,r){return{type:Eh,path:Ar(r),config:e}},jF=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Vd,path:Ar(r),children:i,id:Qe(),properties:di(e).merge(G(n)||{}),config:e,meta:{isDefaultCase:!0}}},IF=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Vd,path:Ar(r),children:i,id:Qe(),properties:di(e).merge(G(n)||{}),config:e}},AF=function(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return{type:bh,path:Ar(r),children:i,id:Qe(),properties:di(e,o).merge(G(n)||{}),config:e,meta:{parentRuleGroupField:o}}},_F=function(e,r){return{type:Oh,path:Ar(r),config:e}},DF=function(e,r,n,i){return{type:Dh,fromPath:Ar(r),toPath:Ar(n),placement:i,config:e}},PF=function(e,r,n){return{type:Fh,path:Ar(r),conjunction:n}},NF=function(e,r,n){return{type:Th,path:Ar(r),not:n}},VF=function(e,r,n){return{type:_h,path:Ar(r),lock:n}},MF=function(e,r,n,i,o){return{type:wh,path:Ar(r),field:n,config:e,asyncListValues:i,_meta:o}},kF=function(e,r,n){return{type:xh,path:Ar(r),srcKey:n,config:e}},GF=function(e,r,n){return{type:Lh,path:Ar(r),operator:n,config:e}},BF=function(e,r,n,i,o,s,u){return{type:Rh,path:Ar(r),delta:n,value:i,valueType:o,asyncListValues:s,config:e,_meta:u}},UF=function(e,r,n,i,o){return{type:jh,path:Ar(r),delta:n,srcKey:i,config:e,_meta:o}},$F=function(e,r,n,i,o,s,u,l,c){return{type:Ih,path:Ar(r),delta:n,parentFuncs:i,argKey:o,value:s,valueType:u,asyncListValues:l,config:e,_meta:c}},WF=function(e,r,n,i){return{type:Ah,path:Ar(r),name:n,value:i,config:e}};function Hh(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function $d(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hh(Object(r),!0).forEach(function(n){Se(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Hh(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var ht=$d($d($d({},B),{},{Export:P,Import:me,ConfigMixins:lF},P),me),zF=b(5556),$=b.n(zF);const KF=wF,tu=U.createContext();var qF=b(14644),HF=b(19888),QF=b(69242),JF=b(40961);function YF(a){a()}let Qh=YF;const XF=a=>Qh=a,ZF=()=>Qh,Jh=Symbol.for("react-redux-context"),Yh=typeof globalThis<"u"?globalThis:{};function eT(){var a;if(!U.createContext)return{};const e=(a=Yh[Jh])!=null?a:Yh[Jh]=new Map;let r=e.get(U.createContext);return r||(r=U.createContext(null),e.set(U.createContext,r)),r}const Xh=eT(),tx=null;function rx(a=ReactReduxContext){return function(){return useContext(a)}}const nx=null;let Zh=null;const tT=a=>{Zh=a},rT=(a,e)=>a===e;function ax(a=ReactReduxContext){const e=a===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(a);return function(n,i={}){const{equalityFn:o=rT,stabilityCheck:s=void 0,noopCheck:u=void 0}=typeof i=="function"?{equalityFn:i}:i,{store:l,subscription:c,getServerState:d,stabilityCheck:f,noopCheck:p}=e(),v=useRef(!0),y=useCallback({[n.name](S){return n(S)}}[n.name],[n,f,s]),m=Zh(c.addNestedSub,l.getState,d||l.getState,y,o);return useDebugValue(m),m}}const ix=null;function It(){return It=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(a[n]=r[n])}return a},It.apply(null,arguments)}function Wd(a,e){if(a==null)return{};var r={};for(var n in a)if({}.hasOwnProperty.call(a,n)){if(e.indexOf(n)!==-1)continue;r[n]=a[n]}return r}var nT=b(4146),em=b.n(nT),aT=b(44363);const iT=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function oT(a,e,r,n,{areStatesEqual:i,areOwnPropsEqual:o,areStatePropsEqual:s}){let u=!1,l,c,d,f,p;function v(C,w){return l=C,c=w,d=a(l,c),f=e(n,c),p=r(d,f,c),u=!0,p}function y(){return d=a(l,c),e.dependsOnOwnProps&&(f=e(n,c)),p=r(d,f,c),p}function m(){return a.dependsOnOwnProps&&(d=a(l,c)),e.dependsOnOwnProps&&(f=e(n,c)),p=r(d,f,c),p}function S(){const C=a(l,c),w=!s(C,d);return d=C,w&&(p=r(d,f,c)),p}function F(C,w){const E=!o(w,c),_=!i(C,l,w,c);return l=C,c=w,E&&_?y():E?m():_?S():p}return function(w,E){return u?F(w,E):v(w,E)}}function sT(a,e){let{initMapStateToProps:r,initMapDispatchToProps:n,initMergeProps:i}=e,o=Wd(e,iT);const s=r(a,o),u=n(a,o),l=i(a,o);return oT(s,u,l,a,o)}function uT(a,e){const r={};for(const n in a){const i=a[n];typeof i=="function"&&(r[n]=(...o)=>e(i(...o)))}return r}function zd(a){return function(r){const n=a(r);function i(){return n}return i.dependsOnOwnProps=!1,i}}function tm(a){return a.dependsOnOwnProps?!!a.dependsOnOwnProps:a.length!==1}function rm(a,e){return function(n,{displayName:i}){const o=function(u,l){return o.dependsOnOwnProps?o.mapToProps(u,l):o.mapToProps(u,void 0)};return o.dependsOnOwnProps=!0,o.mapToProps=function(u,l){o.mapToProps=a,o.dependsOnOwnProps=tm(a);let c=o(u,l);return typeof c=="function"&&(o.mapToProps=c,o.dependsOnOwnProps=tm(c),c=o(u,l)),c},o}}function Kd(a,e){return(r,n)=>{throw new Error(`Invalid value of type ${typeof a} for ${e} argument when connecting component ${n.wrappedComponentName}.`)}}function lT(a){return a&&typeof a=="object"?zd(e=>uT(a,e)):a?typeof a=="function"?rm(a,"mapDispatchToProps"):Kd(a,"mapDispatchToProps"):zd(e=>({dispatch:e}))}function cT(a){return a?typeof a=="function"?rm(a,"mapStateToProps"):Kd(a,"mapStateToProps"):zd(()=>({}))}function dT(a,e,r){return It({},r,a,e)}function fT(a){return function(r,{displayName:n,areMergedPropsEqual:i}){let o=!1,s;return function(l,c,d){const f=a(l,c,d);return o?i(f,s)||(s=f):(o=!0,s=f),s}}}function pT(a){return a?typeof a=="function"?fT(a):Kd(a,"mergeProps"):()=>dT}function vT(){const a=ZF();let e=null,r=null;return{clear(){e=null,r=null},notify(){a(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){let n=[],i=e;for(;i;)n.push(i),i=i.next;return n},subscribe(n){let i=!0,o=r={callback:n,next:null,prev:r};return o.prev?o.prev.next=o:e=o,function(){!i||e===null||(i=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}const nm={notify(){},get:()=>[]};function am(a,e){let r,n=nm,i=0,o=!1;function s(m){d();const S=n.subscribe(m);let F=!1;return()=>{F||(F=!0,S(),f())}}function u(){n.notify()}function l(){y.onStateChange&&y.onStateChange()}function c(){return o}function d(){i++,r||(r=e?e.addNestedSub(l):a.subscribe(l),n=vT())}function f(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=nm)}function p(){o||(o=!0,d())}function v(){o&&(o=!1,f())}const y={addNestedSub:s,notifyNestedSubs:u,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:v,getListeners:()=>n};return y}const Bl=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?U.useLayoutEffect:U.useEffect;function im(a,e){return a===e?a!==0||e!==0||1/a===1/e:a!==a&&e!==e}function qd(a,e){if(im(a,e))return!0;if(typeof a!="object"||a===null||typeof e!="object"||e===null)return!1;const r=Object.keys(a),n=Object.keys(e);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(e,r[i])||!im(a[r[i]],e[r[i]]))return!1;return!0}const gT=()=>{throw new Error("uSES not initialized!")},hT=["reactReduxForwardedRef"];let om=gT;const mT=a=>{om=a},yT=null,ST=[null,null],sx=a=>{try{return JSON.stringify(a)}catch{return String(a)}};function bT(a,e,r){Bl(()=>a(...e),r)}function OT(a,e,r,n,i,o){a.current=n,r.current=!1,i.current&&(i.current=null,o())}function FT(a,e,r,n,i,o,s,u,l,c,d){if(!a)return()=>{};let f=!1,p=null;const v=()=>{if(f||!u.current)return;const m=e.getState();let S,F;try{S=n(m,i.current)}catch(C){F=C,p=C}F||(p=null),S===o.current?s.current||c():(o.current=S,l.current=S,s.current=!0,d())};return r.onStateChange=v,r.trySubscribe(),v(),()=>{if(f=!0,r.tryUnsubscribe(),r.onStateChange=null,p)throw p}}const ux=()=>yT;function TT(a,e){return a===e}let lx=!1;function CT(a,e,r,{pure:n,areStatesEqual:i=TT,areOwnPropsEqual:o=qd,areStatePropsEqual:s=qd,areMergedPropsEqual:u=qd,forwardRef:l=!1,context:c=Xh}={}){const d=c,f=cT(a),p=lT(e),v=pT(r),y=!!a;return S=>{const F=S.displayName||S.name||"Component",C=`Connect(${F})`,w={shouldHandleStateChanges:y,displayName:C,wrappedComponentName:F,WrappedComponent:S,initMapStateToProps:f,initMapDispatchToProps:p,initMergeProps:v,areStatesEqual:i,areStatePropsEqual:s,areOwnPropsEqual:o,areMergedPropsEqual:u};function E(N){const[X,H,W]=U.useMemo(()=>{const{reactReduxForwardedRef:Ke}=N,$e=Wd(N,hT);return[N.context,Ke,$e]},[N]),J=U.useMemo(()=>X&&X.Consumer&&(0,aT.isContextConsumer)(U.createElement(X.Consumer,null))?X:d,[X,d]),Y=U.useContext(J),K=!!N.store&&!!N.store.getState&&!!N.store.dispatch,ae=!!Y&&!!Y.store,se=K?N.store:Y.store,re=ae?Y.getServerState:se.getState,ie=U.useMemo(()=>sT(se.dispatch,w),[se]),[ne,de]=U.useMemo(()=>{if(!y)return ST;const Ke=am(se,K?void 0:Y.subscription),$e=Ke.notifyNestedSubs.bind(Ke);return[Ke,$e]},[se,K,Y]),le=U.useMemo(()=>K?Y:It({},Y,{subscription:ne}),[K,Y,ne]),fe=U.useRef(),ve=U.useRef(W),ye=U.useRef(),we=U.useRef(!1),xe=U.useRef(!1),Fe=U.useRef(!1),ze=U.useRef();Bl(()=>(Fe.current=!0,()=>{Fe.current=!1}),[]);const _e=U.useMemo(()=>()=>ye.current&&W===ve.current?ye.current:ie(se.getState(),W),[se,W]),Oe=U.useMemo(()=>$e=>ne?FT(y,se,ne,ie,ve,fe,we,Fe,ye,de,$e):()=>{},[ne]);bT(OT,[ve,fe,we,W,ye,de]);let Ve;try{Ve=om(Oe,_e,re?()=>ie(re(),W):_e)}catch(Ke){throw ze.current&&(Ke.message+=`
The error may be correlated with this previous error:
${ze.current.stack}

`),Ke}Bl(()=>{ze.current=void 0,ye.current=void 0,fe.current=Ve});const ke=U.useMemo(()=>U.createElement(S,It({},Ve,{ref:H})),[H,S,Ve]);return U.useMemo(()=>y?U.createElement(J.Provider,{value:le},ke):ke,[J,ke,le])}const A=U.memo(E);if(A.WrappedComponent=S,A.displayName=E.displayName=C,l){const X=U.forwardRef(function(W,J){return U.createElement(A,It({},W,{reactReduxForwardedRef:J}))});return X.displayName=C,X.WrappedComponent=S,em()(X,S)}return em()(A,S)}}const Ul=CT;function ET({store:a,context:e,children:r,serverState:n,stabilityCheck:i="once",noopCheck:o="once"}){const s=U.useMemo(()=>{const c=am(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0,stabilityCheck:i,noopCheck:o}},[a,n,i,o]),u=U.useMemo(()=>a.getState(),[a]);Bl(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),u!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,u]);const l=e||Xh;return U.createElement(l.Provider,{value:s},r)}const wT=ET;function cx(a=ReactReduxContext){const e=a===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(a);return function(){const{store:n}=e();return n}}const dx=null;function fx(a=ReactReduxContext){const e=a===ReactReduxContext?useDefaultStore:createStoreHook(a);return function(){return e().dispatch}}const px=null;tT(QF.useSyncExternalStoreWithSelector),mT(HF.useSyncExternalStore),XF(JF.unstable_batchedUpdates);var vx="ADD_GROUP",gx="ADD_CASE_GROUP",hx="REMOVE_GROUP",mx="SET_CONJUNCTION",yx="SET_NOT",Sx="ADD_RULE",bx="REMOVE_RULE",Ox="SET_FIELD",Fx="SET_FIELD_SRC",Tx="SET_OPERATOR",Cx="SET_VALUE",Ex="SET_VALUE_SRC",wx="SET_OPERATOR_OPTION",xx="SET_LOCK",Lx="SET_TREE",Rx="MOVE_ITEM",$l="after",Wl="before",Hi="append",Po="prepend",xT="SET_DRAG_PROGRESS",LT="SET_DRAG_START",RT="SET_DRAG_END",jT=function(e,r){return{type:xT,mousePos:e,dragging:r}},IT=function(e,r,n){return{type:LT,dragStart:e,dragging:r,mousePos:n}},AT=function(){return{type:RT}},sm=Le,_T=Ue,DT=Ie;function hn(a,e,r){return(e=We(e))in a?Object.defineProperty(a,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[e]=r,a}function um(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function lm(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?um(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):um(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var PT=function(e){var r;return(r=e?.cardinality)!==null&&r!==void 0?r:1},zl=function(e,r,n){if(!r||!e||e.length<=r)return e;var i=e.substr(0,r-1);return(n?i.substr(0,i.lastIndexOf(" ")):i)+"..."},Qi=function(e,r){return e===r?!0:e?.equals(r)},Ji=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===r?!0:Array.isArray(e)?NT(e,r,n):e&&typeof e.equals=="function"?e.equals(r):ot(e)==="object"?VT(e,r,n):e===r};function NT(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=a.length;if(e.length!==n)return!1;for(var i=0;i<n;i++){var o=r?Ji(a[i],e[i],r):a[i]===e[i];if(!o)return!1}return!0}function VT(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=Object.keys(a),i=Object.keys(e),o=n.length;if(i.length!==o)return!1;for(var s=0;s<o;s++){var u=n[s],l=r?Ji(a[u],e[u],r):a[u]===e[u];if(!l)return!1}return!0}var MT=function(){var e;return typeof process<"u"&&((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:"production")=="development"},kT=function(){var e;return typeof process<"u"&&((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:e.NODE_ENV_TEST)=="true"},GT=function(e){if(kT())return lm(lm({},console),{},{log:function(){},debug:function(){},info:function(){}});var r=e??MT();return r?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},BT=GT(),cm=ht.Validation.validateAndFixTree,UT=function(){var e,r,n;return function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return o?(i.__configId===n&&(Qi(o,e)||Qi(o,r))||(n=i.__configId,e=o,u===!1?r=cm(o,null,i,s||i,!1,!1,!1):r=cm(o,null,i,s||i)),r):null}},$T=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(r){return r.startsWith("__reactContainer")}).length>0)return"container"},dm=function(e){if(e){var r=$T(e);return r!==void 0?r:dm(e.parentNode)}},fm=function(e){return dm(e)==="root"},Kl=function(e,r){return function(n,i){var o=e.props,s=e.state,u=n!=o||i!=s;if(u&&s==i&&o!=n){var l=[];for(var c in n){var d=n[c]!=o[c];d&&(r[c]=="ignore"?d=!1:r[c]=="shallow_deep"?d=!Ji(n[c],o[c],!0):r[c]=="shallow"?d=!Ji(n[c],o[c]):typeof r[c]=="function"&&(d=r[c](n[c],o[c],n,o))),d&&l.push(c)}l.length||(u=!1)}return u}},No=function(e){return function(r,n){return!Ji(e.props,r)||!Ji(e.state,n)}},WT=function(){var e=U.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},Fn=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=No(e)),WT())e.componentWillReceiveProps=function(i){e.onPropsChanged(i)};else{var r=e.shouldComponentUpdate,n=function(o,s){var u=!Ji(e.props,o);u&&e.onPropsChanged(o);var l=r.call(e,o,s);return l};e.shouldComponentUpdate=n.bind(e)}},pm=function(e,r,n){return Gl()(e,function(i){return function(){for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return n(i.apply(void 0,[r].concat(s)))}})};function vm(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Hd(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vm(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):vm(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function zT(a,e,r){return e=je(e),Re(a,gm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function gm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gm=function(){return!!a})()}var hm=function(a){function e(r){var n;Ne(this,e),n=zT(this,e,[r]),n.shouldComponentUpdate=Kl(n,{tree:function(s){return!(s===n.oldValidatedTree&&n.oldValidatedTree===n.validatedTree)}}),Fn(n),n._updateActions(r),n.validatedTree=r.getMemoizedTree(r.config,r.tree,void 0,r.sanitizeTree),n.oldValidatedTree=n.validatedTree;var i=r.getBasicConfig(r.config);return r.onInit&&r.onInit(n.validatedTree,i,void 0,n.actions),n}return He(e,a),nt(e,[{key:"_updateActions",value:function(n){var i=n.config,o=n.dispatch;this.actions=pm(Hd(Hd(Hd({},sm),_T),DT),i,o)}},{key:"onPropsChanged",value:function(n){var i=n.onChange,o=this.props.config,s=n.tree,u=this.props.tree,l=n.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=s,o!==l&&(this._updateActions(n),this.validatedTree=n.getMemoizedTree(l,s,o));var c=!Qi(this.validatedTree,this.oldValidatedTree);if(c){var d=n.getBasicConfig(l);i&&i(this.validatedTree,d,n.__lastAction,this.actions)}}},{key:"render",value:function(){var n=this.props,i=n.config,o=n.renderBuilder,s=n.dispatch,u={tree:this.validatedTree,actions:this.actions,config:i,dispatch:s};return o(u)}}])}(U.Component);hm.propTypes={config:$().object.isRequired,onChange:$().func,onInit:$().func,renderBuilder:$().func,tree:$().any};var mm=Ul(function(a){return{tree:a.tree,__lastAction:a.__lastAction}},null,null,{context:tu})(hm);mm.displayName="ConnectedQuery";const KT=mm;function qT(a,e,r){return e=je(e),Re(a,ym()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function ym(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ym=function(){return!!a})()}var Sm=ht.DefaultUtils.defaultRoot,bm=ht.ConfigUtils,HT=bm.createConfigMemo,QT=bm.extendConfig,Om=function(a){function e(r,n){var i,o,s;Ne(this,e),s=qT(this,e,[r,n]),s.setLastTree=function(E){s.prevTree&&(s.prevprevTree=s.prevTree),s.prevTree=E},s.getConfig=function(){return s.config},s.shouldComponentUpdate=Kl(s,{value:function(_,A){return!1}}),Fn(s);var u=HT({reactIndex:(i=(o=s._reactInternals)===null||o===void 0?void 0:o.index)!==null&&i!==void 0?i:-1,maxSize:2,canCompile:!0,extendConfig:QT}),l=u.getExtendedConfig,c=u.getBasicConfig,d=u.clearConfigMemo;s.getMemoizedConfig=l,s.getBasicConfig=c,s.clearConfigMemo=d,s.getMemoizedTree=UT();var f=s.getMemoizedConfig(r),p=f.settings.shouldCreateEmptyGroup,v=!p,y=Sm(f,v),m=!!r.value,S=r.value||y,F=s.getMemoizedTree(f,S,void 0,m),C=KF(f,F,s.getMemoizedTree,s.setLastTree,s.getConfig),w=(0,qF.createStore)(C);return s.config=f,s.state={store:w},s.QueryWrapper=function(E){return f.settings.renderProvider(E,f.ctx)},s}return He(e,a),nt(e,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(n){var i=this.props,o=this.config,s=this.getMemoizedConfig(n),u=o!==s,l=this.state.store.getState().tree,c=!Qi(n.value,this.props.value)&&!Qi(n.value,l),d=c?n.value||Sm(n):l,f=c&&!Qi(n.value,this.prevTree)&&!Qi(n.value,this.prevprevTree);this.sanitizeTree=f||u;var p=u&&!c;if(u&&(i.settings.renderProvider!==n.settings.renderProvider&&(this.QueryWrapper=function(y){return s.settings.renderProvider(y,s.ctx)}),this.config=s),c||u){var v=this.getMemoizedTree(s,d,p?o:void 0,this.sanitizeTree);this.state.store.dispatch(sm.setTree(s,v))}}},{key:"render",value:function(){var n=this.props,i=n.renderBuilder,o=n.get_children,s=n.onChange,u=n.onInit,l=this.state.store,c=this.config,d=this.QueryWrapper;return U.createElement(d,{config:c},U.createElement(wT,{store:l,context:tu},U.createElement(KT,{config:c,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:s,onInit:u,renderBuilder:i||o})))}}])}(U.Component);Om.propTypes={conjunctions:$().object.isRequired,fields:$().object.isRequired,types:$().object.isRequired,operators:$().object.isRequired,widgets:$().object.isRequired,settings:$().object.isRequired,ctx:$().object.isRequired,onChange:$().func,onInit:$().func,renderBuilder:$().func,value:$().any};function Vo(a,e){if(a==null)return{};var r,n,i=Wd(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(a,r)&&(i[r]=a[r])}return i}function Qd(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function JT(a){if(Array.isArray(a))return Qd(a)}function YT(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Fm(a,e){if(a){if(typeof a=="string")return Qd(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qd(a,e):void 0}}function XT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mn(a){return JT(a)||YT(a)||Fm(a)||XT()}var ZT=b(46942),Qn=b.n(ZT);function eC(a,e,r){return e=je(e),Re(a,Tm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Tm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tm=function(){return!!a})()}var tC=ht.ConfigUtils.getFieldConfig,rC=function(e){var r;return r=function(n){function i(o){var s;return Ne(this,i),s=eC(this,i,[o]),s.dummyFn=function(){},s.removeSelf=function(){s.props.actions.removeRule(s.props.path)},s.setLock=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;s.props.actions.setLock(s.props.path,u)},s.setField=function(u,l,c){s.props.actions.setField(s.props.path,u,l,c)},s.setFieldSrc=function(u){s.props.actions.setFieldSrc(s.props.path,u)},s.setOperator=function(u){s.props.actions.setOperator(s.props.path,u)},s.setOperatorOption=function(u,l){s.props.actions.setOperatorOption(s.props.path,u,l)},s.setValue=function(u,l,c,d,f){s.props.actions.setValue(s.props.path,u,l,c,d,f)},s.setValueSrc=function(u,l,c){s.props.actions.setValueSrc(s.props.path,u,l,c)},s.setFuncValue=function(u,l,c,d,f,p,v){s.props.actions.setFuncValue(s.props.path,u,l,c,d,f,p,v)},s.pureShouldComponentUpdate=No(s),s.dummyFn.isDummyFn=!0,s}return He(i,n),nt(i,[{key:"shouldComponentUpdate",value:function(s,u){var l=this.props,c=this.state,d=this.pureShouldComponentUpdate(s,u);if(d&&c==u&&l!=s){var f=s.dragging.id||l.dragging.id,p=f==s.id,v=[];for(var y in s){var m=s[y]!=l[y];y=="dragging"&&!p&&(m=!1),m&&v.push(y)}v.length||(d=!1)}return d}},{key:"render",value:function(){var s=this.props.dragging.id==this.props.id,u=tC(this.props.config,this.props.field),l=this.props.fieldType||u?.type||null,c=this.props.config.settings.showErrorMessage,d=u&&u.type=="!struct",f=!s&&this.props.isDraggingTempo,p=this.props,v=p.valueError,y=p.fieldError,m=[y].concat(mn(v?.toArray()||[])).filter(function(F){return!!F}).shift()||null,S=m!=null&&c;return U.createElement("div",{className:Qn()("group-or-rule-container","rule-container",S?"rule-with-error":null),"data-id":this.props.id},[s?U.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,U.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:s,isDraggingTempo:f,onDragStart:this.props.onDragStart,setLock:f?this.dummyFn:this.setLock,removeSelf:f?this.dummyFn:this.removeSelf,setField:f?this.dummyFn:this.setField,setFieldSrc:f?this.dummyFn:this.setFieldSrc,setFuncValue:f?this.dummyFn:this.setFuncValue,setOperator:f?this.dummyFn:this.setOperator,setOperatorOption:f?this.dummyFn:this.setOperatorOption,setValue:f?this.dummyFn:this.setValue,setValueSrc:f?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(U.Component),r.propTypes={id:$().string.isRequired,groupId:$().string,config:$().object.isRequired,path:$().any.isRequired,operator:$().string,field:$().any,fieldSrc:$().string,fieldType:$().string,actions:$().object.isRequired,onDragStart:$().func,value:$().any,valueSrc:$().any,asyncListValues:$().array,valueError:$().any,fieldError:$().string,operatorOptions:$().object,reordableNodesCnt:$().number,parentField:$().string,isLocked:$().bool,isTrueLocked:$().bool,dragging:$().object,isDraggingTempo:$().bool},r};const nC=function(a){var e=Ul(function(r){return{dragging:r.dragging}},null,null,{context:tu})(rC(a));return e.displayName="ConnectedRuleContainer",e};function aC(a,e,r){return e=je(e),Re(a,Cm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Cm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Cm=function(){return!!a})()}var Em=ht.OtherUtils.clone,iC=ht.TreeUtils.getFlatTree,Jd=!1,oC=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return r=function(i){function o(s){var u;return Ne(this,o),u=aC(this,o,[s]),u._getEventTarget=function(l,c){return l&&l.__mocked_window||document.body||window},u.onDragStart=function(l,c,d){var f=c.closest(".query-builder");if(!f){console.error("Please change renderBuilder implementation of <Query>: wrap <Builder> with div.query-builder for drag-n-drop support");return}u._isUsingLegacyReactDomRender===void 0&&(u._isUsingLegacyReactDomRender=fm(f)),document.body.classList.add("qb-dragging"),f.classList.add("qb-dragging");var p=f.closest(".query-builder-container")||f;p=u._getScrollParent(p)||document.body;var v=p.scrollTop,y=u._getDraggableNodeEl(f),m=u._getPlaceholderNodeEl(f),S=f.querySelectorAll(".group--children"),F=S.length?S[0]:null,C;F&&(C=window.getComputedStyle(F,null).getPropertyValue("padding-left"),C=parseInt(C));var w={id:l,x:c.offsetLeft,y:c.offsetTop,w:c.offsetWidth,h:c.offsetHeight,itemInfo:u.tree.items[l],paddingLeft:C},E={id:l,x:c.offsetLeft,y:c.offsetTop,scrollTop:v,clientX:d.clientX,clientY:d.clientY,itemInfo:Em(u.tree.items[l]),treeEl:f,treeElContainer:p},_={clientX:d.clientX,clientY:d.clientY},A=u._getEventTarget(d,E);u.eventTarget=A,A.addEventListener("mousemove",u.onDrag),A.addEventListener("mouseup",u.onDragEnd),u.props.setDragStart(E,w,_)},u.onDrag=function(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,d=Object.assign({},u.props.dragging),f=u.props.dragStart,p=d.paddingLeft,v=f.treeElContainer,y=v.scrollTop;if(d.itemInfo=u.tree.items[d.id],!!d.itemInfo){var m={clientX:l.clientX,clientY:l.clientY},S={clientX:f.clientX,clientY:f.clientY};if(l.__mock_dom){var F=f.treeEl,C=u._getDraggableNodeEl(F),w=u._getPlaceholderNodeEl(F);l.__mock_dom({treeEl:F,dragEl:C,plhEl:w})}if(!f.plX){var E=f.treeEl,_=u._getPlaceholderNodeEl(E);_&&(f.plX=_.getBoundingClientRect().left+window.scrollX,f.plY=_.getBoundingClientRect().top+window.scrollY)}var A=f.x,N=f.y,X=f.clientX,H=f.clientY,W=f.scrollTop,J={x:A+(l.clientX-X),y:N+(l.clientY-H)+(y-W)};d.x=J.x,d.y=J.y,d.paddingLeft=p,d.mousePos=m,d.startMousePos=S,u.props.setDragProgress(m,d);var Y=c?u.handleDrag(d,l,n):!1;Y||l.preventDefault&&l.preventDefault()}},u.onDragEnd=function(){var l=u.props.dragStart.treeEl;u.props.setDragEnd(),l.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),u._cacheEls={};var c=u.eventTarget||u._getEventTarget();c.removeEventListener("mousemove",u.onDrag),c.removeEventListener("mouseup",u.onDragEnd)},u.pureShouldComponentUpdate=No(u),Fn(u),u.onPropsChanged(s),u}return He(o,i),nt(o,[{key:"onPropsChanged",value:function(u){this.tree=iC(u.tree,u.config)}},{key:"shouldComponentUpdate",value:function(u,l){var c=this.props,d=this.state,f=this.pureShouldComponentUpdate(u,l);if(f&&d==l&&c!=u){var p=[];for(var v in u){var y=u[v]!=c[v];y&&v!="dragging"&&v!="mousePos"&&p.push(v)}p.length||(f=!1)}return f}},{key:"componentDidUpdate",value:function(u,l){var c=this.props.dragging,d=this.props.dragStart;if(Jd=!1,d&&d.id&&(c.itemInfo=this.tree.items[c.id],c.itemInfo&&(c.itemInfo.index!=d.itemInfo.index||c.itemInfo.parent!=d.itemInfo.parent))){var f=d.treeEl,p=d.treeElContainer,v=this._getPlaceholderNodeEl(f,!0);if(v){var y=v.getBoundingClientRect().left+window.scrollX,m=v.getBoundingClientRect().top+window.scrollY,S=d.plX,F=d.plY,C=p.scrollTop;d.plX=y,d.plY=m,d.itemInfo=Em(c.itemInfo),d.y=v.offsetTop,d.x=v.offsetLeft,d.clientY+=m-F,d.clientX+=y-S,p!=document.body&&(d.scrollTop=C),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(u,l){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(l==null)return null;this._cacheEls||(this._cacheEls={});var d=this._cacheEls[l];return d&&document.contains(d)&&!c||(d=u.querySelector('.group-or-rule-container[data-id="'+l+'"]'),this._cacheEls[l]=d),d}},{key:"_getDraggableNodeEl",value:function(u){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var c=this._cacheEls.draggable;if(c&&document.contains(c)&&!l)return c;var d=u.getElementsByClassName("qb-draggable");return c=d.length?d[0]:null,this._cacheEls.draggable=c,c}},{key:"_getPlaceholderNodeEl",value:function(u){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var c=this._cacheEls.placeholder;if(c&&document.contains(c)&&!l)return c;var d=u.getElementsByClassName("qb-placeholder");return c=d.length?d[0]:null,this._cacheEls.placeholder=c,c}},{key:"_isScrollable",value:function(u){var l=window.getComputedStyle(u)["overflow-y"];return(l==="scroll"||l==="auto")&&u.scrollHeight>u.offsetHeight}},{key:"_getScrollParent",value:function(u){return u==null?null:u===document.body||this._isScrollable(u)?u:this._getScrollParent(u.parentNode)}},{key:"handleDrag",value:function(u,l,c){var d=this,f=!0,p=u.itemInfo,v=u.paddingLeft,y=null,m=this.props.dragStart.treeEl,S=u.id,F=this._getDraggableNodeEl(m),C=this._getPlaceholderNodeEl(m),w,E,_,A;if(F&&C){if(w=F.getBoundingClientRect(),E=C.getBoundingClientRect(),!E.width)return;var N={hrz:0,vrt:0};w.top<E.top?N.vrt=-1:w.bottom>E.bottom&&(N.vrt=1),w.left>E.left?N.hrz=1:w.left<E.left&&(N.hrz=-1),A=m.getBoundingClientRect();var X={x:A.left+(A.right-A.left)/2,y:N.vrt>=0?w.bottom:w.top},H;if(l.__mocked_hov_container)H=l.__mocked_hov_container;else{var W=document.elementFromPoint(X.x,X.y-1);if(H=W?W.closest(".group-or-rule-container"):null,!H&&W&&W.classList.contains("query-builder-container")){var J,Y=W==null||(J=W.firstChild)===null||J===void 0?void 0:J.firstChild;Y&&Y.classList.contains("group-or-rule-container")&&(H=Y)}}if(!H)BT.log("out of tree bounds!");else{var K=H.classList.contains("group-container"),ae=H.getAttribute("data-id"),se=H,re=!1,ie=!1;if(se){_=se.getBoundingClientRect();var ne=_.bottom-_.top,de=this.tree.items[ae];if(!de)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var le=null,fe=null,ve=null,ye=null;if(N.vrt==0)ve=p,fe=C,fe&&(le=fe.getBoundingClientRect());else if(K){if(N.vrt>0){var we=H.getElementsByClassName("group--header"),xe=we.length?we[0]:null;if(xe){var Fe=xe.getBoundingClientRect(),ze=Fe.bottom-Fe.top,_e=w.bottom-Fe.top>ze*3/4;_e&&de.top>u.itemInfo.top&&(ve=de,le=Fe,fe=xe,ie=!0)}}else if(N.vrt<0&&de.lev>=p.lev){var Oe=_.bottom-w.top>=2;Oe&&de.top<u.itemInfo.top&&(ve=de,le=_,fe=se,re=!0)}if(!ie&&!re||f){var Ve=N.vrt<0?_.bottom-w.top>ne-5:w.bottom-_.top>ne-5;Ve&&(!ie&&!re&&(ve=de,le=_,fe=se),f&&(ye=de))}}else{var ke=N.vrt<0?_.bottom-w.top>ne/2:w.bottom-_.top>ne/2;ke&&(ve=de,le=_,fe=se)}var De=ve&&ve.id==S;if(le){var Ke=w.left-A.left,$e=le.left-A.left,Je=$e/v,ut=Math.max(0,Math.round(Ke/v)),Xe=[],et=[];if(!De){if(K&&(re?Xe.push([Hi,ve,ve.lev+1]):ie&&Xe.push([Po,ve,ve.lev+1]),f&&ye)){var Jt=ye.lev==0,kt=ye.type=="case_group"&&p.type!="case_group",Kt=ye.prev&&this.tree.items[ye.prev].caseId,Ct=ye.next&&this.tree.items[ye.next].caseId;p.caseId==Kt&&(Kt=null),p.caseId==Ct&&(Ct=null);var or=Kt&&this.tree.items[Kt],er=Ct&&this.tree.items[Ct];N.vrt>0?Jt?et.push([Hi,ye,ye.lev+1]):kt&&er?et.push([Po,er,er.lev+1]):et.push([$l,ye,ye.lev]):N.vrt<0&&(Jt?et.push([Po,ye,ye.lev+1]):kt&&or?et.push([Hi,or,or.lev+1]):et.push([Wl,ye,ye.lev]))}!re&&!ie&&(N.vrt<0?Xe.push([Wl,ve,ve.lev]):N.vrt>0&&Xe.push([$l,ve,ve.lev]))}var Lr=function(Fr){var Br=Fr[1],Mn=p.caseId?d.tree.items[p.caseId]:null,Bt=Br.caseId?d.tree.items[Br.caseId]:null;return[].concat(mn(Fr),[Mn,Bt])};Xe=Xe.map(Lr),et=et.map(Lr),Xe=Xe.filter(function(Nt){var Fr=Nt[0],Br=Nt[1];if((Fr==Wl||Fr==$l)&&Br.parent==null||Br.collapsed&&(Fr==Hi||Fr==Po))return!1;var Mn=Br.id==p.id;if(!Mn){for(var Bt=Br;Bt.parent;)if(Bt=d.tree.items[Bt.parent],Bt.id==p.id){Mn=!0;break}}return!Mn}).map(function(Nt){var Fr=Nt[0],Br=Nt[1],Mn=Nt[2],Bt=Nt[3],kn=Nt[4],Ut=null;return Fr==Hi||Fr==Po?Ut=Br:Ut=d.tree.items[Br.parent],Ut&&Ut.parent==null&&(Ut=null),Nt[5]=Ut,Nt});var lr=null,Or=Xe.filter(function(Nt){return d.canMove(p,Nt[1],Nt[0],Nt[3],Nt[4],Nt[5],c)});f&&Or.length==0&&et.length>0&&(Or=et.filter(function(Nt){return d.canMove(p,Nt[1],Nt[0],Nt[3],Nt[4],Nt[5],c)}));var Rr=Or.map(function(Nt){return Nt[2]}),qt=p.lev,an=Rr.concat(qt),Jn=null;an.indexOf(ut)!=-1?Jn=ut:ut>Math.max.apply(Math,mn(an))?Jn=Math.max.apply(Math,mn(an)):ut<Math.min.apply(Math,mn(an))&&(Jn=Math.min.apply(Math,mn(an))),lr=Or.find(function(Nt){return Nt[2]==Jn}),!De&&!lr&&Or.length&&(lr=Or[0]),y=lr}}}}return y?(this.move(p,y[1],y[0],y[3]),!0):!1}},{key:"canMove",value:function(u,l,c,d,f,p,v){if(!u||!l||u.id===l.id)return!1;var y=this.props.config.settings,m=y.canRegroup,S=y.canRegroupCases,F=y.maxNesting,C=y.maxNumberOfRules,w=y.canLeaveEmptyCase,E=p?p.nextAtomicLev:l.atomicLev,_=E+(u.closestRuleGroupId?0:u.depth||(u.type=="group"?1:0)),A=c==Wl||c==$l,N=c==Po||c==Hi,X=A&&l.lev==1||N&&l.lev==0,H=u.parent!=l.parent,W=N||H,J=u.type=="rule_group"||!!u.closestRuleGroupId||l.type=="rule_group"||!!l.closestRuleGroupId,Y=N&&l.type=="rule_group"?l.id:l.closestRuleGroupId,K=N&&l.type=="rule_group"?l.maxNesting:l.closestRuleGroupMaxNesting,ae=(N&&l.type=="rule_group"?l.canRegroup:l.closestRuleGroupCanRegroup)!=!1,se=N&&l.type=="rule_group"?l.lev:l.closestRuleGroupLev,re=(p?p.lev+1:l.lev)+(u.depth||(u.type=="group"?1:0))-(se||0),ie=J&&u.closestRuleGroupId!=Y,ne=u.type=="case_group"&&!X||u.type!="case_group"&&l.type=="case_group"&&A||u.type!="case_group"&&l.type=="switch_group"||!S&&u.caseId!=l.caseId,de=ne||ie,le=l.isLocked||u.isLocked||p&&p.isLocked;if(F&&_>F||K&&re>K||W&&(!m||de||le)||J&&W&&!ae)return!1;if(u.type!="case_group"&&u.caseId!=l.caseId){var fe=d?d._height==2:!1,ve=f?f.atomicRulesCountInCase+1:0;if(C&&ve>C||fe&&!w)return!1}if(u.type=="case_group"&&(u.isDefaultCase||l.isDefaultCase||l.type=="switch_group"&&c==Hi))return!1;var ye=!0;return v&&(ye=v(u.node.toJS(),l.node.toJS(),c,p?p.node.toJS():null)),ye}},{key:"move",value:function(u,l,c,d){this._isUsingLegacyReactDomRender||(Jd=!0),this.props.actions.moveItem(u.path,l.path,c)}},{key:"render",value:function(){return U.createElement(e,It({},this.props,{onDragStart:this.onDragStart}))}}])}(U.Component),r.propTypes={tree:$().any.isRequired,actions:$().object.isRequired},r};const sC=function(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=Ul(function(n){return{dragging:n.dragging,dragStart:n.dragStart,mousePos:n.mousePos}},{setDragStart:IT,setDragProgress:jT,setDragEnd:AT},null,{context:tu})(oC(a,e));return r.displayName="ConnectedSortableContainer",r};var uC=["isDraggingTempo","isDraggingMe","dragging"];function lC(a,e,r){return e=je(e),Re(a,wm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function wm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wm=function(){return!!a})()}const Mo=function(a){return function(e){var r;return r=function(n){function i(o){var s;return Ne(this,i),s=lC(this,i,[o]),s.handleDraggerMouseDown=function(u){var l=s.props.id,c=s.wrapper.current;s.props.onDragStart&&s.props.onDragStart(l,c,u)},s.wrapper=U.createRef(),s}return He(i,n),nt(i,[{key:"render",value:function(){var s=this.props,u=s.isDraggingTempo,l=s.isDraggingMe,c=s.dragging,d=Vo(s,uC),f=d.isTrueLocked,p={};l&&u&&(Jd||(p={top:c.y,left:c.x,width:c.w}));var v=Qn()(a,"group-or-rule",l&&u?"qb-draggable":null,l&&!u?"qb-placeholder":null,f?"locked":null);return U.createElement("div",{className:v,style:p,ref:this.wrapper,"data-id":this.props.id},U.createElement(e,It({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:l,isDraggingTempo:u},d)))}}])}(U.PureComponent),r.propTypes={isDraggingTempo:$().bool,isDraggingMe:$().bool,onDragStart:$().func,dragging:$().object,isLocked:$().bool,isTrueLocked:$().bool},r}};var cC=b(95950),ko=b.n(cC),dC=b(71086),fC=b.n(dC);function xm(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function pC(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xm(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):xm(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function vC(a,e,r){return e=je(e),Re(a,Lm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Lm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lm=function(){return!!a})()}var Rm=ht.ConfigUtils,gC=Rm.getFieldConfig,hC=Rm.getOperatorConfig,jm=function(a){function e(r){var n;return Ne(this,e),n=vC(this,e,[r]),n.shouldComponentUpdate=Kl(n,{selectedField:function(o,s){return!1}}),Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],s=!this.meta||o.map(function(u){return n[u]!==i[u]}).filter(function(u){return u}).length>0;s&&(this.meta=this.getMeta(n))}},{key:"getMeta",value:function(n){var i,o=n.config,s=n.selectedField,u=n.selectedFieldType,l=n.selectedOperator,c=gC(o,s),d=mn(c?.operators||((i=o.types[u])===null||i===void 0?void 0:i.operators)||[]);!s&&!d.includes(l)&&d.push(l);var f=Gl()(fC()(o.operators,function(E,_){return d?.indexOf(_)!==-1}),function(E,_){return hC(o,_,s)}),p=this.buildOptions(o,f,d),v=f[l]||{},y=this.props.config.settings.operatorPlaceholder,m=l,S=m?[m]:null,F=S,C=v.label,w=v.label2||v.tooltip;return{placeholder:y,items:p,selectedKey:m,selectedKeys:S,selectedPath:F,selectedLabel:C,selectedAltLabel:w,selectedOpts:v,fieldConfig:c}}},{key:"buildOptions",value:function(n,i,o){return!i||!o?null:ko()(i).sort(function(s,u){return o.indexOf(s)-o.indexOf(u)}).map(function(s){var u=i[s],l=u.label,c=u.label2,d=u.tooltip;return{key:s,path:s,label:l,altLabel:c,tooltip:d}})}},{key:"render",value:function(){var n=this.props,i=n.config,o=n.customProps,s=n.setOperator,u=n.readonly,l=n.id,c=n.groupId,d=i.settings.renderOperator,f=pC({id:l,groupId:c,config:i,customProps:o,readonly:u,setField:s},this.meta);return f.items?d(f,i.ctx):null}}])}(U.Component);jm.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,selectedField:$().any,selectedFieldId:$().string,selectedFieldType:$().string,selectedFieldSrc:$().string,selectedOperator:$().string,readonly:$().bool,customProps:$().object,setOperator:$().func.isRequired};function mC(a){if(Array.isArray(a))return a}function yC(a,e){var r=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(r!=null){var n,i,o,s,u=[],l=!0,c=!1;try{if(o=(r=r.call(a)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(d){c=!0,i=d}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return u}}function SC(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ql(a,e){return mC(a)||yC(a,e)||Fm(a,e)||SC()}var bC=["children"],_r=function(e){var r=e.children,n=Vo(e,bC);return U.createElement("div",n,r)},Tn=function(){},Im=function(){return U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},U.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),U.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},Go=function(e){return function(r){var n=r.config.settings.useConfirm,i=n?n.call(r.config.ctx,r.config.ctx):null;return U.createElement(e,It({},r,{confirmFn:i}))}},Am=function(e){var r=e.id,n=e.isLHS,i=e.delta,o=e.parentFuncs;return[r,n?"L":"R",n?-1:i||0,(o||[]).map(function(s){var u=ql(s,2),l=u[0],c=u[1];return"".concat(l,"(").concat(c,")")}).join("/")].join(":")},Cn=function(e,r){var n;return typeof r=="function"?(n=function(o){return r?.(o,e.ctx)},n.displayName=r.name):n=r,n};function OC(a,e,r){return e=je(e),Re(a,_m()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function _m(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_m=function(){return!!a})()}var Dm=function(a){function e(){return Ne(this,e),OC(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=n.selectedFieldSrc,u=n.selectedFieldType,l=n.selectedOperator,c=n.setOperator,d=n.selectedFieldId,f=n.showOperator,p=n.showOperatorLabel,v=n.selectedFieldWidgetConfig,y=n.readonly,m=n.id,S=n.groupId,F=f&&U.createElement(_r,{key:"operators-for-"+d,className:"rule--operator"},i.settings.showLabels&&U.createElement("label",{className:"rule--label"},i.settings.operatorLabel),U.createElement(jm,{key:"operator",config:i,selectedField:o,selectedFieldSrc:s,selectedFieldType:u,selectedFieldId:d,selectedOperator:l,setOperator:c,customProps:i.settings.customOperatorSelectProps,readonly:y,id:m,groupId:S})),C=p&&U.createElement(_r,{key:"operators-for-"+d,className:"rule--operator"},U.createElement("div",{className:"rule--operator-wrapper"},i.settings.showLabels?U.createElement("label",{className:"rule--label"},"\xA0"):null,U.createElement("div",{className:"rule--operator-text-wrapper"},U.createElement("span",{className:"rule--operator-text"},v.operatorInlineLabel))));return[F,C]}}])}(U.PureComponent);function Pm(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function FC(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pm(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Pm(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function TC(a,e,r){return e=je(e),Re(a,Nm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Nm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nm=function(){return!!a})()}var Vm=ht.RuleUtils.getFieldPathLabels,Yd=ht.ConfigUtils,Mm=Yd.getFieldConfig,km=Yd.getFieldParts,Gm=Yd.getFieldPathParts,Bm=function(a){function e(r){var n;return Ne(this,e),n=TC(this,e,[r]),n.setField=function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=n.props.id;if(!s.widgetId){var l=[u,"L",-1].join(":");s.widgetId=l}n.props.setField(i,o,s)},Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],s=!this.meta||o.map(function(u){return n[u]!==i[u]}).filter(function(u){return u}).length>0;s&&(this.meta=this.getMeta(n))}},{key:"getMeta",value:function(n){var i=n.selectedField,o=n.selectedFieldType,s=n.config,u=n.parentField,l=i,c=s.settings,d=c.maxLabelsLength,f=c.fieldSeparatorDisplay,p=c.fieldPlaceholder,v=c.fieldSeparator,y=!!i,m=y?null:zl(p,d),S=y?Mm(s,l):null,F=S||{},C=Gm(l,s),w=Gm(l,s,!0),E=this.getFieldLabel(S,l,s),_=Vm(l,s),A=_?_.join(f):null;(A==E||u)&&(A=null);var N=F.label2||F.tooltip,X=km(u,s),H=u?Mm(s,u):null,W=u?H&&H.subfields:s.fields,J=!y&&o,Y=this.buildOptions(X,s,W,J,X),K=J?"Please select field":null;return l&&ot(l)==="object"&&(l=void 0),{placeholder:m,items:Y,parentField:u,selectedKey:l,selectedKeys:C,selectedPath:w,selectedLabel:E,selectedOpts:F,selectedAltLabel:N,selectedFullLabel:A,errorText:K}}},{key:"getFieldLabel",value:function(n,i,o){if(!i)return null;var s=o.settings.maxLabelsLength,u=km(i,o),l=n?.label||ml()(u);return l=zl(l,s),l}},{key:"buildOptions",value:function(n,i,o){var s=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!o)return null;var d=i.settings,f=d.fieldSeparator,p=d.fieldSeparatorDisplay,v=l!=null&&l.length?l.join(f)+f:"",y=function(S){return Object.keys(S||{}).reduce(function(F,C){var w=S[C];return w.type==="!struct"?F+y(w.subfields):F+(w.type===u?1:0)},0)};return ko()(o).map(function(m){var S=[].concat(mn(l??[]),[m]),F=o[m],C=s.getFieldLabel(F,S,i),w=Vm(S,i),E=w.join(p);(E==C||n!=null&&n.length)&&(E=null);var _=F.label2,A=F.tooltip,N=F.disabled;if(!F.hideForSelect)if(F.type=="!struct"){var X=s.buildOptions(n,i,F.subfields,u,S,{label:C,tooltip:A}),H=y(F.subfields)>0;return{disabled:N,key:m,path:v+m,label:C,fullLabel:E,altLabel:_,tooltip:A,items:X,matchesType:H}}else{var W=u!==void 0?F.type===u:void 0;return{disabled:N,key:m,path:v+m,label:C,fullLabel:E,altLabel:_,tooltip:A,grouplabel:c?.label,group:c,matchesType:W}}}).filter(function(m){return!!m})}},{key:"render",value:function(){var n=this.props,i=n.config,o=n.customProps,s=n.setFieldSrc,u=n.readonly,l=n.id,c=n.groupId,d=i.settings.renderField;if(!this.meta.items)return null;var f=FC({id:l,groupId:c,config:i,customProps:o,readonly:u,setField:this.setField,setFieldSrc:s},this.meta);return d(f,i.ctx)}}])}(U.Component);Bm.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,selectedField:$().any,selectedFieldSrc:$().string,selectedFieldType:$().string,parentField:$().string,customProps:$().object,readonly:$().bool,setField:$().func.isRequired,setFieldSrc:$().func};function Um(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function CC(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Um(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function EC(a,e,r){return e=je(e),Re(a,$m()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function $m(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($m=function(){return!!a})()}var wC=ht.clone,ru=ht.ConfigUtils,xC=ru.getFieldConfig,Wm=ru.getFuncConfig,LC=ru.getFieldParts,zm=ru.getFieldPathParts,RC=ru.getWidgetForFieldOp,Km=ht.RuleUtils.getFuncPathLabels,jC=ht.OtherUtils.shallowEqual,qm=function(a){function e(r){var n;return Ne(this,e),n=EC(this,e,[r]),Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"],s=["config","field","fieldType","fieldSrc","value","isLHS"],u=!this.items||o.map(function(c){return c==="parentFuncs"?!jC(n[c],i[c],!0):n[c]!==i[c]}).filter(function(c){return c}).length>0,l=!this.meta||s.map(function(c){return n[c]!==i[c]}).filter(function(c){return c}).length>0;l&&(this.meta=this.getMeta(n)),u&&(this.items=this.getItems(n,this.meta))}},{key:"getItems",value:function(n,i){var o=n.config,s=n.field,u=n.fieldType,l=n.isLHS,c=n.operator,d=n.parentFuncs,f=n.fieldDefinition,p=n.isFuncArg,v=i.lookingForFieldType,y=o.settings.canUseFuncForField,m=this.filterFuncs(o,o.funcs,s,u,l,c,y,d,p,f),S=this.buildOptions(o,m,v);return S}},{key:"getMeta",value:function(n){var i=n.config,o=n._field,s=n.fieldType,u=n.value,l=n.isLHS,c=n.isFuncArg,d=i.settings,f=d.funcPlaceholder,p=d.fieldSeparatorDisplay,v=u,y=!!u,m=y?null:f,S=y?Wm(i,v):null,F=S||{},C=zm(v,i),w=zm(v,i,!0),E=this.getFuncLabel(S,v,i),_=Km(v,i),A=_?_.join(p):null;A==E&&(A=null);var N=l&&!c,X=N&&!y&&s,H=X?"Please select function":null;return{placeholder:m,selectedKey:v,selectedKeys:C,selectedPath:w,selectedLabel:E,selectedOpts:F,selectedFullLabel:A,errorText:H,lookingForFieldType:X}}},{key:"filterFuncs",value:function(n,i,o,s,u,l,c,d,f,p){i=wC(i);var v=n.settings.fieldSeparator,y=xC(n,o),m=!1,S,F=y,C=RC(n,o,l,"value"),w=C&&n.widgets[C];f?(F=p,S=p?.type):m&&w?S=w.type:y?S=y.type:u||(S=s);function E(_,A){for(var N in _){var X=_[N].subfields,H=(A||[]).concat(N),W=H.join(v),J=Wm(n,W);if(J.type=="!struct")E(X,H)==0&&delete _[N];else{var Y,K=!S||J.returnType==S;(Y=F)!==null&&Y!==void 0&&Y.funcs&&(K=K&&F.funcs.includes(W)),c&&(K=K&&c(o,y,W,J,l)),!J.allowSelfNesting&&d&&d.map(function(ae){var se=ql(ae,2),re=se[0],ie=se[1];return re}).includes(W)&&(K=!1),K||delete _[N]}}return ko()(_).length}return E(i,[]),i}},{key:"buildOptions",value:function(n,i){var o=this,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!i)return null;var c=n.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=u!=null&&u.length?u.join(d)+d:"",v=function(m){return Object.keys(m||{}).reduce(function(S,F){var C=m[F];return C.type==="!struct"?S+v(C.subfields):S+(C.type===s?1:0)},0)};return ko()(i).map(function(y){var m=[].concat(mn(u??[]),[y]),S=i[y],F=o.getFuncLabel(S,m,n),C=Km(m,n),w=C.join(f);w==F&&(w=null);var E=S.tooltip;if(S.type=="!struct"){var _=o.buildOptions(n,S.subfields,s,m,{label:F,tooltip:E}),A=v(S.subfields)>0;return{key:y,path:p+y,label:F,fullLabel:w,tooltip:E,items:_,matchesType:A}}else{var N=s!==void 0?S.returnType===s:void 0;return{key:y,path:p+y,label:F,fullLabel:w,tooltip:E,grouplabel:l?.label,group:l,matchesType:N}}})}},{key:"getFuncLabel",value:function(n,i,o){if(!i)return null;var s=o.settings.maxLabelsLength,u=LC(i,o),l=n?.label||ml()(u);return l=zl(l,s),l}},{key:"render",value:function(){var n=this.props,i=n.config,o=n.customProps,s=n.setValue,u=n.readonly,l=n.id,c=n.groupId,d=i.settings.renderFunc,f=CC({config:i,customProps:o,readonly:u,setField:s,items:this.items,id:l,groupId:c},this.meta);return d(f,i.ctx)}}])}(U.Component);qm.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,field:$().any,fieldType:$().string,fieldSrc:$().string,operator:$().string,customProps:$().object,value:$().string,setValue:$().func.isRequired,readonly:$().bool,parentFuncs:$().array,fieldDefinition:$().object,isFuncArg:$().bool,isLHS:$().bool};var IC=b(23181),Xd=b.n(IC),AC=["widgetFactory"],_C=["factory"];function Hm(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Zd(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hm(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Hm(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Qm=ht.ListUtils.getTitleInListValues,DC=ht.ConfigUtils._widgetDefKeysToOmit,Jm=ht.TreeUtils,PC=Jm._fixImmutableValue,NC=Jm.isImmutable,Ym=(0,U.memo)(function(a){var e=a.widgetFactory,r=Vo(a,AC),n=r.config,i=r.isFuncArg,o=r.fieldDefinition,s=o||{},u=s.fieldSettings,l=s.defaultValue,c=s.valueSources,d=i&&c?.length==1&&c?.[0]==="const",f=u?.treeValues||u?.listValues;return d&&l?typeof l=="boolean"?l?r.labelYes||"YES":r.labelNo||"NO":f?Array.isArray(l)?l.map(function(p){return Qm(f,p)||p}).join(", "):Qm(f,l)||l:""+l:e?e(r,n.ctx):"?"});Ym.displayName="WidgetFactoryMemo";var Xm=function(e){var r=e.delta,n=e.parentDelta,i=e.isFuncArg,o=e.valueSrc,s=e.value,u=e.valueError,l=e.fieldError,c=e.asyncListValues,d=e.isSpecialRange,f=e.fieldDefinition,p=e.widget,v=e.widgetDefinition,y=e.widgetValueLabel,m=e.valueLabels,S=e.textSeparators,F=e.setValue,C=e.setFuncValue,w=e.config,E=e.field,_=e.fieldSrc,A=e.fieldPath,N=e.fieldType,X=e.isLHS,H=e.operator,W=e.readonly,J=e.parentField,Y=e.parentFuncs,K=e.id,ae=e.groupId,se=e.widgetId,re=v.factory,ie=Vo(v,_C),ne=s?s.map(function(Oe){return PC(Oe)}):void 0,de=(0,U.useMemo)(function(){if(d){var Oe=[ne?.get(0),ne?.get(1)];return Oe[0]===void 0&&Oe[1]===void 0&&(Oe=void 0),Oe}return ne?.get(r)},[d,s]),le=(0,U.useMemo)(function(){var Oe;return u?d?[u.get(0),u.get(1),u.get(2)]:u==null||(Oe=u.get)===null||Oe===void 0?void 0:Oe.call(u,r):null},[d,s]),fe=X?l:le,ve=f||{},ye=ve.fieldSettings,we=y.label,xe=y.placeholder,Fe=m?m.placeholder:null,ze=NC(E)?null:E,_e=El()(Zd(Zd(Zd({},ie),ye),{},{config:w,field:ze,fieldPath:A,fieldSrc:_,fieldType:N,isLHS:X,parentField:J,parentFuncs:Y,fieldDefinition:f,operator:H,delta:r,parentDelta:n,isSpecialRange:d,isFuncArg:i,value:de,valueSrc:o,valueError:le,fieldError:l,errorMessage:fe,label:we,placeholder:xe,placeholders:Fe,textSeparators:S,setValue:F,setFuncValue:C,readonly:W,asyncListValues:c,id:K,groupId:ae,widgetId:se,widgetFactory:re,widget:p}),[].concat(mn(DC),["toJS"]));return U.createElement(Ym,It({widgetFactory:re},_e))};Xm.displayName="WidgetFactory";const VC=Xm;function MC(a,e,r){return e=je(e),Re(a,Zm()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Zm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zm=function(){return!!a})()}var nu=ht.ConfigUtils,kC=nu.getFieldConfig,GC=nu.getOperatorConfig,ey=nu.getFieldWidgetConfig,ty=nu.getWidgetForFieldOp,BC=nu.getValueSourcesForFieldOp,Hl=ht.RuleUtils.getValueLabel,ry=ht.DefaultUtils.createListWithOneElement,UC=ht.OtherUtils.shallowEqual,jx=ht.TreeUtils.isImmutable,$C={cardinality:1},au=function(a){function e(r){var n;return Ne(this,e),n=MC(this,e,[r]),n._setValue=function(i,o,s,u,l,c){var d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};if(d.widgetId||(d.widgetId=u),i&&Array.isArray(l)){var f=[n.props.value.get(0),n.props.value.get(1)];f[0]!=l[0]&&n.props.setValue(0,l[0],s,c,d),f[1]!=l[1]&&n.props.setValue(1,l[1],s,c,d)}else n.props.setValue(o,l,s,c,d)},n._setValueSrc=function(i,o,s){var u={widgetId:o};n.props.setValueSrc(i,s,u)},n.renderWidget=function(i,o,s){var u=s.config,l=s.isFuncArg,c=s.leftField,d=s.operator,f=s.value,p=s.valueError,v=s.fieldError,y=s.readonly,m=s.parentField,S=s.parentFuncs,F=s.id,C=s.groupId,w=s.fieldSrc,E=s.fieldType,_=s.isLHS,A=s.setFuncValue,N=s.parentDelta,X=u.settings,H=o.widgets,W=o.iValues,J=o.aField,Y=o.valueSources,K=l?W:f,ae=l?c:J,se=H[i],re=se.valueSrc,ie=se.valueLabel,ne=se.widgetId,de=Y.length>1&&!y,le=X.showLabels?U.createElement("label",{key:"label-"+ne,className:"rule--label"},ie.label):null;return U.createElement("div",{key:"wrapper-"+ne,className:Qn()(re==="func"?"widget--func":"widget--widget",de?"widget--has-valuesrcs":"widget--has-no-valuesrcs")},re==="func"?null:le,U.createElement(VC,It({key:ne,id:F,groupId:C,widgetId:ne,valueSrc:re,delta:i,value:K,valueError:p,fieldError:v,isFuncArg:l,isLHS:_},ya()(o,["isSpecialRange","fieldDefinition","asyncListValues"]),ya()(H[i],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:A,config:u,field:ae,fieldSrc:w,fieldType:E,parentField:m,parentFuncs:S,parentDelta:N??i,operator:d,readonly:y})))},n.renderValueSources=function(i,o,s){var u=s.config,l=s.isFuncArg,c=s.leftField,d=s.operator,f=s.readonly,p=u.settings,v=o.valueSources,y=o.widgets,m=o.aField,S=o.valueSourcesOptions,F=l?c:m,C=y[i],w=C.valueSrc,E=C.setValueSrc,_=n.ValueSources,A=p.showLabels?U.createElement("label",{className:"rule--label"},"\xA0"):null;return v.length>1&&!f&&U.createElement("div",{key:"wrapper-valuesrc-"+i,className:"widget--valuesrc"},A,U.createElement(_,{key:"valuesrc-"+i,delta:i,valueSources:S,valueSrc:w,config:u,field:F,operator:d,setValueSrc:E,readonly:f,title:p.valueSourcesPopupTitle}))},n.renderSep=function(i,o,s){var u=s.config,l=o.widgets,c=u.settings,d=l[i].sepText,f=c.showLabels?U.createElement("label",{className:"rule--label"},"\xA0"):null;return d&&U.createElement("div",{key:"widget-separators-"+i,className:Qn()("widget--sep",i==0&&"widget--sep-first")},f,U.createElement("span",null,d))},n.renderWidgetDelta=function(i){var o=n.renderSep(i,n.meta,n.props),s=n.renderValueSources(i,n.meta,n.props),u=n.renderWidget(i,n.meta,n.props);return[o,s,u]},Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=!this.ValueSources||i?.config!==n?.config,s=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value","parentDelta"],u=s.filter(function(f){return f==="parentFuncs"?!UC(n[f],i[f],!0):f==="field"?n.fieldId!==i.fieldId:n[f]!==i[f]}),l=!this.meta||u.length>0;if(l&&(this.meta=this.getMeta(n,u)),o){var c=n.config,d=c.settings.renderValueSources;this.ValueSources=Cn(c,d)}}},{key:"getMeta",value:function(n){var i,o,s,u,l=this,c=n.config,d=n.field,f=n.fieldSrc,p=n.fieldType,v=n.fieldFunc,y=n.fieldArg,m=n.operator,S=n.valueSrc,F=n.value,C=n.isForRuleGroup,w=n.isCaseValue,E=n.isFuncArg,_=n.leftField,A=n.asyncListValues,N=n.parentFuncs,X=n.isLHS,H=n.id,W=n.parentDelta,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Y=c.settings.valueSourcesInfo,K=E?{func:v,arg:y}:d,ae=!d&&p,se=S,re=F;(E||C||w)&&(se=ry(S),re=ry(F));var ie=kC(c,K);!ie&&ae&&(ie=c.types[p]);var ne=ty(c,K,m);if(!ne&&ae){var de;ne=(de=c.types[p])===null||de===void 0?void 0:de.mainWidget}var le=E?$C:GC(c,m,K);if((ie==null||le==null)&&!w)return null;var fe=le?.isSpecialRange,ve=fe&&(((i=se)===null||i===void 0?void 0:i.get(0))==="field"||((o=se)===null||o===void 0?void 0:o.get(1))==="field"),ye=fe&&!ve,we=ye?1:PT(le);if(we===0)return null;var xe=(s=this.meta)===null||s===void 0?void 0:s.valueSources,Fe=(u=this.meta)===null||u===void 0?void 0:u.valueSourcesOptions,ze={value:"Value",field:"Field",func:"Function"};(!xe||["field","operator","config","fieldDefinition","isForRuleGroup"].filter(function(Oe){return J.includes(Oe)}).length)&&(xe=BC(c,K,m,ie),C&&(xe=["value"]),K||(xe=Object.keys(Y)),Fe=xe.map(function(Oe){var Ve,ke,De;return[Oe,{label:(Ve=(ke=(De=Y[Oe])===null||De===void 0?void 0:De.label)!==null&&ke!==void 0?ke:ze[Oe])!==null&&Ve!==void 0?Ve:Oe}]}));var _e=(E?[0]:Xd()(0,we)).map(function(Oe){var Ve,ke,De,Ke,$e=(Ve=l.meta)===null||Ve===void 0||(Ve=Ve.widgets)===null||Ve===void 0?void 0:Ve[Oe],Je=((ke=se)===null||ke===void 0?void 0:ke.get(Oe))||null,ut=ty(c,K,m,Je),Xe=ey(c,K,m,ut,Je);ve&&(ut=Xe.singleWidget,Xe=ey(c,K,m,ut,Je)),!Xe&&ae&&(ut=["func","field"].includes(Je)?Je:ne,Xe=c.widgets[ut]);var et=(De=Xe)===null||De===void 0?void 0:De.type,Jt=Hl(c,K,m,Oe,Je,ye),kt=Hl(c,K,m,Oe,null,ye),Kt=le!=null&&le.textSeparators?le?.textSeparators[Oe]:null,Ct=null,or=null;fe&&(Ct=[Hl(c,K,m,0),Hl(c,K,m,1)],Ct={placeholder:[Ct[0].placeholder,Ct[1].placeholder],label:[Ct[0].label,Ct[1].label]},or=le?.textSeparators);var er=Am({id:H,isLHS:X,delta:W??Oe,parentFuncs:N}),Lr=er+":VS",lr=$e?.setValueSrc;(!lr||$e?.widgetId!==er)&&(lr=l._setValueSrc.bind(l,Oe,Lr));var Or=$e?.setValue;return(!Or||$e?.widgetId!==er||$e?.widgetType!==et||((Ke=l.meta)===null||Ke===void 0?void 0:Ke.isSpecialRange)!==fe)&&(Or=l._setValue.bind(l,fe,Oe,et,er)),{valueSrc:Je,valueLabel:Jt,widget:ut,sepText:Kt,widgetDefinition:Xe,widgetValueLabel:kt,valueLabels:Ct,textSeparators:or,setValueSrc:lr,setValue:Or,widgetId:er,widgetType:et}});return{defaultWidget:ne,fieldDefinition:ie,operatorDefinition:le,isSpecialRange:ye,cardinality:we,valueSources:xe,valueSourcesOptions:Fe,widgets:_e,iValues:re,aField:K,asyncListValues:A}}},{key:"render",value:function(){if(!this.meta)return null;var n=this.meta,i=n.defaultWidget,o=n.cardinality,s=this.meta.isFuncArg;if(!i)return null;var u=i;return U.createElement(_r,{className:"rule--widget rule--widget--".concat(u.toUpperCase()),key:"widget-col-"+u},(s?[0]:Xd()(0,o)).map(this.renderWidgetDelta))}}])}(U.Component);au.propTypes={config:$().object.isRequired,value:$().any,valueSrc:$().any,valueError:$().any,fieldError:$().string,field:$().any,fieldSrc:$().string,fieldType:$().string,fieldId:$().string,operator:$().string,readonly:$().bool,asyncListValues:$().array,id:$().string,groupId:$().string,setValue:$().func,setValueSrc:$().func,setFuncValue:$().func,isFuncArg:$().bool,fieldFunc:$().string,fieldArg:$().string,leftField:$().any,isForRuleGroup:$().bool,parentField:$().string,parentFuncs:$().array,isLHS:$().bool,parentDelta:$().number,isCaseValue:$().bool};function ny(a,e,r){return e=je(e),Re(a,ay()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function ay(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ay=function(){return!!a})()}var WC=ht.ConfigUtils.getFuncConfig,iy=ht.OtherUtils.shallowEqual,ef=function(a){function e(r){var n;return Ne(this,e),n=ny(this,e,[r]),n.setFunc=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.props,u=s.isLHS,l=s.parentDelta,c=s.parentFuncs,d=s.id;if(!o.widgetId){var f=Am({id:d,isLHS:u,delta:l,parentFuncs:c});o.widgetId=f}n.props.setFuncValue(u?-1:l||0,c,null,i,"!func",void 0,o)},n.setArgValue=function(i,o,s,u,l){var c=n.props,d=c.config,f=c.parentDelta,p=c.isLHS,v=c.parentFuncs;n.props.setFuncValue(p?-1:f||0,v,i,o,s,u,l)},n.setArgValueSrc=function(i,o,s){var u=n.props,l=u.config,c=u.parentDelta,d=u.isLHS,f=u.parentFuncs;n.props.setFuncValue(d?-1:c||0,f,i,o,"!valueSrc",void 0,s)},n.renderFuncSelect=function(){var i,o,s=n.props,u=s.config,l=s.field,c=s.fieldType,d=s.fieldSrc,f=s.isLHS,p=s.operator,v=s.customProps,y=s.value,m=s.readonly,S=s.parentFuncs,F=s.id,C=s.groupId,w=s.isFuncArg,E=s.fieldDefinition,_=s.parentDelta,A=(i=y==null||(o=y.get)===null||o===void 0?void 0:o.call(y,"func"))!==null&&i!==void 0?i:null,N={value:A,setValue:n.setFunc,config:u,field:l,fieldType:c,fieldSrc:d,isLHS:f,operator:p,customProps:v,readonly:m,parentFuncs:S,isFuncArg:w,fieldDefinition:E,id:F,groupId:C},X=u.settings,H=X.showLabels,W=X.funcLabel,J=H?U.createElement("label",{className:"rule--label"},W):null;return U.createElement(_r,{key:"func",className:"rule--func"},J,U.createElement(qm,N))},n.renderArgLabel=function(i,o){var s=o.valueSources,u=o.type,l=o.showPrefix,c=o.label,d=n.props.config,f=s&&s.length==1&&s[0]=="const",p=!d.settings.showLabels&&(u=="boolean"||f)&&l;return p?U.createElement(_r,{className:"rule--func--arg-label"},c||i):null},n.renderArgLabelSep=function(i,o){var s=o.valueSources,u=o.type,l=o.showPrefix,c=n.props.config,d=s&&s.length==1&&s[0]=="const",f=!c.settings.showLabels&&(u=="boolean"||d)&&l;return f?U.createElement(_r,{className:"rule--func--arg-label-sep"},":"):null},n.renderArgVal=function(i,o,s){var u=n.props,l=u.config,c=u.field,d=u.fieldType,f=u.fieldSrc,p=u.isLHS,v=u.operator,y=u.value,m=u.readonly,S=u.parentFuncs,F=u.id,C=u.groupId,w=u.fieldError,E=u.valueError,_=u.setFuncValue,A=u.parentDelta,N=y?y.getIn(["args",o]):null,X=N?N.get("value"):void 0,H=s.valueSources.length==1?s.valueSources[0]:void 0,W=N?N.get("valueSrc")||H||"value":H,J=N?.get("asyncListValues"),Y={config:l,fieldFunc:i,fieldArg:o,leftField:c,fieldType:d,fieldSrc:f,fieldError:w,valueError:E,isLHS:p,operator:null,value:X,valueSrc:W,asyncListValues:J,setValue:n.setArgValue,setValueSrc:n.setArgValueSrc,setFuncValue:_,funcKey:i,argKey:o,argDefinition:s,readonly:m,parentFuncs:S,id:F,groupId:C,parentDelta:A};return U.createElement(_r,{className:"rule--func--arg-value"},U.createElement(oy,Y))},n.renderArgSep=function(i,o,s,u){var l=u.renderSeps;return s?U.createElement(_r,{className:"rule--func--arg-sep"},l?l[s-1]:", "):null},n.renderBracketBefore=function(i){var o=i.renderBrackets;return U.createElement(_r,{key:"before_args",className:"rule--func--bracket-before"},o?o[0]:"(")},n.renderBracketAfter=function(i){var o=i.renderBrackets;return U.createElement(_r,{key:"after_args",className:"rule--func--bracket-after"},o?o[1]:")")},n.renderFuncArgs=function(){var i=n.meta,o=i.funcDefinition,s=i.funcKey;if(!s)return null;var u=o||{},l=u.args;return l?U.createElement(U.Fragment,null,n.renderBracketBefore(o),U.createElement(_r,{key:"args-".concat(s),className:"rule--func--args rule--func--".concat(s,"--args")},Object.keys(l).map(function(c,d){return U.createElement(_r,{key:"arg-".concat(c,"-").concat(d),className:"rule--func--arg rule--func--".concat(s,"--arg--").concat(c)},n.renderArgSep(c,l[c],d,o),n.renderArgLabel(c,l[c]),n.renderArgLabelSep(c,l[c]),n.renderArgVal(s,c,l[c]))})),n.renderBracketAfter(o)):null},Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["config","field","operator","value","fieldSrc","fieldType","isLHS"],s=!this.meta||o.map(function(u){return u==="parentFuncs"?!iy(n[u],i[u],!0):n[u]!==i[u]}).filter(function(u){return u}).length>0;s&&(this.meta=this.getMeta(n))}},{key:"getMeta",value:function(n){var i,o,s=n.config,u=n.field,l=n.operator,c=n.value,d=(i=c==null||(o=c.get)===null||o===void 0?void 0:o.call(c,"func"))!==null&&i!==void 0?i:null,f=d?WC(s,d):null;return{funcDefinition:f,funcKey:d}}},{key:"render",value:function(){var n=this.props.parentFuncs,i=n?n.map(function(s){var u=ql(s,2),l=u[0],c=u[1];return"".concat(l,"_").concat(c)}).join("-"):"root",o=n?.length||0;return U.createElement(_r,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(i," rule--func--wrapper--lev-").concat(o)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(U.Component);ef.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,field:$().any,fieldSrc:$().string,fieldType:$().string,fieldError:$().string,operator:$().string,customProps:$().object,value:$().object,setValue:$().func.isRequired,setFuncValue:$().func,readonly:$().bool,parentFuncs:$().array,parentDelta:$().number,fieldDefinition:$().object,isFuncArg:$().bool,isLHS:$().bool,valueError:$().string};var oy=function(a){function e(r){var n;return Ne(this,e),n=ny(this,e,[r]),n.setValue=function(i,o,s,u,l){var c=n.props,d=c.setValue,f=c.argKey;d(f,o,s,u,l)},n.setValueSrc=function(i,o,s){var u=n.props,l=u.setValueSrc,c=u.argKey;l(c,o,s)},Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["parentFuncs","funcKey","argKey"],s=!this.meta||o.map(function(u){return u==="parentFuncs"?!iy(n[u],i[u],!0):n[u]!==i[u]}).filter(function(u){return u}).length>0;s&&(this.meta=this.getMeta(n))}},{key:"getMeta",value:function(n){var i=n.parentFuncs,o=n.funcKey,s=n.argKey,u=[].concat(mn(i||[]),[[o,s]]);return{parentFuncs:u}}},{key:"render",value:function(){var n=this.meta.parentFuncs;return U.createElement(au,It({},this.props,{parentDelta:this.props.parentDelta,setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:n}))}}])}(U.Component);oy.propTypes={funcKey:$().string.isRequired,argKey:$().string.isRequired,setValue:$().func.isRequired,setValueSrc:$().func.isRequired,readonly:$().bool,isLHS:$().bool,parentFuncs:$().array,id:$().string,groupId:$().string};function zC(a,e,r){return e=je(e),Re(a,sy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function sy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sy=function(){return!!a})()}var tf=function(a){function e(r){var n;return Ne(this,e),n=zC(this,e,[r]),n.renderField=function(){var i=n.props,o=i.config,s=i.classname,u=i.selectedField,l=i.selectedFieldSrc,c=i.selectedFieldType,d=i.setField,f=i.setFuncValue,p=i.parentField,v=i.readonly,y=i.id,m=i.groupId,S=i.fieldError,F=i.valueError,C=["func","field"];if(!C.includes(l))return"?";var w=l==="func"?U.createElement(ef,{isLHS:!0,config:o,value:u,fieldSrc:l,fieldType:c,fieldError:S,valueError:F,parentField:p,setValue:d,setFuncValue:f,readonly:v,id:y,groupId:m,key:"field-func-"+y}):U.createElement(Bm,{config:o,selectedField:u,selectedFieldSrc:l,selectedFieldType:c,parentField:p,setField:d,customProps:o.settings.customFieldSelectProps,readonly:v,id:y,groupId:m,key:"field-"+y}),E=l==="func"?o.settings.funcLabel:o.settings.fieldLabel,_=o.settings.showLabels&&l!=="func"&&U.createElement("label",{className:"rule--label"},E);return U.createElement("div",{key:l,className:s},_,w)},n.renderFieldSources=function(){if(!n.meta)return null;var i=n.props,o=i.config,s=i.readonly,u=i.selectedFieldSrc,l=i.setFieldSrc,c=i.id,d=n.meta.fieldSourcesOptions,f=o.settings,p=n.ValueSources,v=f.showLabels?U.createElement("label",{className:"rule--label"},"\xA0"):null;return d.length>1&&!s&&U.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},v,U.createElement(p,{key:"fieldsrc-"+c,valueSources:d,valueSrc:u,config:o,setValueSrc:l,readonly:s,title:f.fieldSourcesPopupTitle}))},Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=!this.ValueSources||i?.config!==n?.config,s=["config"],u=!this.meta||s.map(function(d){return n[d]!==i[d]}).filter(function(d){return d}).length>0;if(u&&(this.meta=this.getMeta(n)),o){var l=n.config,c=l.settings.renderValueSources;this.ValueSources=function(d){return c(d,l.ctx)}}}},{key:"getMeta",value:function(n){var i=n.config,o={value:"Value",field:"Field",func:"Function"},s=i.settings,u=s.valueSourcesInfo,l=s.fieldSources,c=l.map(function(d){var f,p,v;return[d,{label:(f=(p=(v=u[d])===null||v===void 0?void 0:v.label)!==null&&p!==void 0?p:o[d])!==null&&f!==void 0?f:d}]});return{fieldSourcesOptions:c}}},{key:"render",value:function(){var n=this.props,i=n.classname,o=n.canSelectFieldSource,s=o&&this.renderFieldSources(),u=this.renderField();return o?U.createElement(_r,{className:"rule--field-wrapper"},s,u):u}}])}(U.Component),KC=["factory"];function qC(a,e,r){return e=je(e),Re(a,uy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function uy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uy=function(){return!!a})()}var HC=ht.ConfigUtils.getOperatorConfig,ly=function(a){function e(){return Ne(this,e),qC(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var n=HC(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof n.options>"u")return null;var i=n.options,o=i.factory,s=Vo(i,KC),u=Object.assign({},s,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),l=o(u,this.props.config.ctx),c=this.props.selectedOperator;return U.createElement("div",{className:"rule--operator rule--operator--".concat(c.toUpperCase())},l)}}])}(U.PureComponent);ly.propTypes={config:$().object.isRequired,operatorOptions:$().any.isRequired,selectedField:$().any,selectedFieldSrc:$().string,selectedOperator:$().string.isRequired,readonly:$().bool,setOperatorOption:$().func.isRequired};function cy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function dy(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):cy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function QC(a,e,r){return e=je(e),Re(a,fy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function fy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fy=function(){return!!a})()}var Ql=ht.ConfigUtils,JC=Ql.getFieldConfig,YC=Ql.getOperatorConfig,XC=Ql.getFieldWidgetConfig,ZC=Ql.getFieldId,eE=ht.RuleUtils.isEmptyRuleProperties,py=function(a){function e(r){var n;return Ne(this,e),n=QC(this,e,[r]),Fn(n),n.removeSelf=n.removeSelf.bind(n),n.setLock=n.setLock.bind(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this,o=this.props,s=!this.Icon||o?.config!==n?.config,u=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked","parentField","parentFieldCanReorder"],l=!this.meta||u.map(function(C){return n[C]!==o[C]}).filter(function(C){return C}).length>0;if(l&&(this.meta=this.getMeta(n)),s){var c=n.config,d=c.settings,f=d.renderIcon,p=d.renderButton,v=d.renderButtonGroup,y=d.renderSwitch,m=d.renderBeforeWidget,S=d.renderAfterWidget,F=d.renderRuleError;this.Icon=Cn(c,f),this.Btn=Cn(c,p),this.BtnGrp=Cn(c,v),this.Switch=Cn(c,y),this.BeforeWidget=Cn(c,m),this.AfterWidget=Cn(c,S),this.RuleError=Cn(c,F)}this.doRemove=function(){i.props.removeSelf()}}},{key:"getMeta",value:function(n){var i=n.selectedField,o=n.selectedFieldType,s=n.selectedOperator,u=n.config,l=n.reordableNodesCnt,c=n.isLocked,d=n.parentField,f=n.parentFieldCanReorder,p=u.settings.keepInputOnChangeFieldSrc,v=ZC(i,u),y=JC(u,i),m=y&&y.type==="!struct",S=p&&o,F=!!i||S,C=F&&s,w=YC(u,s,i),E=w&&w.options!=null,_=XC(u,i,s,null,null)||{},A=_.hideOperator,N=u.settings.canReorder&&l>1&&!c;d&&(N=N&&f);var X=F&&!A,H=F&&A&&_.operatorInlineLabel,W=C&&!m,J=C&&E;return{selectedFieldId:v,selectedFieldWidgetConfig:_,showDragIcon:N,showOperator:X,showOperatorLabel:H,showWidget:W,showOperatorOptions:J}}},{key:"setLock",value:function(n){this.props.setLock(n)}},{key:"removeSelf",value:function(){var n=this.props,i=n.confirmFn,o=n.config,s=o.settings,u=s.renderConfirm,l=s.removeRuleConfirmOptions;l&&!this.isEmptyCurrentRule()?u.call(o.ctx,dy(dy({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:i}),o.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(n,i){var o=n.selectedField,s=n.selectedFieldSrc,u=n.selectedFieldType,l=n.selectedOperator,c=n.operatorOptions,d=n.value,f=n.valueType,p=n.valueSrc,v=n.asyncListValues,y=n.valueError,m=n.fieldError,S=n.parentField,F=i.selectedFieldId;return{field:o,fieldSrc:s,fieldType:u,fieldId:F,operator:l,operatorOptions:c,value:d,valueType:f,valueSrc:p,asyncListValues:v,valueError:y,fieldError:m,parentField:S}}},{key:"isEmptyCurrentRule",value:function(){var n=this.props.config,i=this._buildWidgetProps(this.props,this.meta);return eE(i,n)}},{key:"renderField",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=n.parentField,u=n.groupId,l=n.id,c=n.selectedFieldSrc,d=n.selectedField,f=n.selectedFieldType,p=n.setField,v=n.setFuncValue,y=n.setFieldSrc,m=n.fieldError,S=i.settings.immutableFieldsMode,F=this.meta.selectedFieldId;return U.createElement(tf,{key:"field",classname:Qn()(c=="func"?"rule--field--func":"rule--field"),config:i,canSelectFieldSource:!s,selectedField:d,selectedFieldSrc:c,selectedFieldType:f,selectedFieldId:F,fieldError:m,setField:S?Tn:p,setFuncValue:S?Tn:v,setFieldSrc:S?Tn:y,parentField:s,readonly:S||o,id:l,groupId:u})}},{key:"renderOperator",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=this.meta,u=s.selectedFieldId,l=s.selectedFieldWidgetConfig,c=s.showOperator,d=s.showOperatorLabel,f=i.settings.immutableOpsMode;return U.createElement(Dm,{key:"operator",config:i,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:u,selectedOperator:this.props.selectedOperator,setOperator:f?Tn:this.props.setOperator,showOperator:c,showOperatorLabel:d,selectedFieldWidgetConfig:l,readonly:f||o,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=this.meta.showWidget,u=i.settings.immutableValuesMode;if(!s)return null;var l=U.createElement(au,It({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:i,setValue:u?Tn:this.props.setValue,setValueSrc:u?Tn:this.props.setValueSrc,setFuncValue:u?Tn:this.props.setFuncValue,readonly:u||o,id:this.props.id,groupId:this.props.groupId}));return U.createElement(_r,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var n=this.props.config,i=this.meta.showOperatorOptions,o=n.settings,s=o.immutableOpsMode,u=o.immutableValuesMode;if(!i)return null;var l=U.createElement(ly,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:s?Tn:this.props.setOperatorOption,config:n,readonly:u});return U.createElement(_r,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var n=this.BeforeWidget;return n?U.createElement(_r,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},U.createElement(n,this.props)):null}},{key:"renderAfterWidget",value:function(){var n=this.AfterWidget;return n?U.createElement(_r,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},U.createElement(n,this.props)):null}},{key:"renderError",value:function(){var n=this.props,i=n.config,o=n.valueError,s=n.fieldError,u=i.settings.showErrorMessage,l=this.RuleError,c=[s].concat(mn(o?.toArray()||[])).filter(function(d){return!!d}).shift()||null;return u&&c&&U.createElement("div",{className:"rule--error"},l?U.createElement(l,{error:c}):c)}},{key:"renderDrag",value:function(){var n=this.props.handleDraggerMouseDown,i=this.meta.showDragIcon,o=this.Icon,s=U.createElement(o,{type:"drag"});return i&&U.createElement("div",{key:"rule-drag-icon",onMouseDown:n,className:"qb-drag-handler rule--drag-handler"},s)}},{key:"renderDel",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=i.settings,u=s.deleteLabel,l=s.immutableGroupsMode,c=s.canDeleteLocked,d=this.Icon,f=this.Btn;return!l&&(!o||o&&c)&&U.createElement(f,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:u,config:i,renderIcon:d})}},{key:"renderLock",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=n.isTrueLocked,u=n.id,l=i.settings,c=l.lockLabel,d=l.lockedLabel,f=l.showLock,p=this.Switch;return f&&!(o&&!s)&&U.createElement(p,{key:"rule-lock",type:"lock",id:u,value:o,setValue:this.setLock,label:c,checkedLabel:d,hideLabel:!0,config:i})}},{key:"render",value:function(){var n=this.meta,i=n.showOperatorOptions,o=n.selectedFieldWidgetConfig,s=this.props,u=s.valueSrc,l=s.value,c=s.config,d=u?.first()=="value"&&!i&&l.size==1&&o.fullWidth,f=this.BtnGrp,p=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],v=U.createElement("div",{key:"rule-body",className:Qn()("rule--body",d&&"can--shrink--value")},p),y=this.renderError(),m=this.renderDrag(),S=this.renderLock(),F=this.renderDel();return U.createElement(U.Fragment,null,m,U.createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},v,y),U.createElement("div",{key:"rule-header-wrapper",className:"rule--header"},U.createElement(f,{key:"rule-header-group",config:c},S,F)))}}])}(U.Component);py.propTypes={id:$().string.isRequired,groupId:$().string,selectedField:$().any,selectedFieldSrc:$().string,selectedFieldType:$().string,selectedOperator:$().string,operatorOptions:$().object,config:$().object.isRequired,value:$().any,valueSrc:$().any,valueType:$().any,asyncListValues:$().array,isDraggingMe:$().bool,isDraggingTempo:$().bool,parentField:$().string,valueError:$().any,fieldError:$().string,isLocked:$().bool,isTrueLocked:$().bool,handleDraggerMouseDown:$().func,setField:$().func,setFieldSrc:$().func,setOperator:$().func,setOperatorOption:$().func,setLock:$().func,removeSelf:$().func,setValue:$().func,setValueSrc:$().func,setFuncValue:$().func,reordableNodesCnt:$().number,totalRulesCnt:$().number,parentReordableNodesCnt:$().number,parentFieldCanReorder:$().bool};const tE=nC(Mo("rule")(Go(py)));var rE=b(22331),nE=b.n(rE);function aE(a,e,r){return e=je(e),Re(a,vy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function vy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vy=function(){return!!a})()}var iE=ht.DefaultUtils.defaultGroupConjunction,gy=ht.ConfigUtils.getFieldConfig,oE=function(e,r){var n;return n=function(i){function o(s){var u;return Ne(this,o),u=aE(this,o,[s]),u._selectedConjunction=function(l){return l=l||u.props,l.conjunction||iE(l.config,l.field)},u.setConjunction=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setConjunction(u.props.path,l)},u.setNot=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setNot(u.props.path,l)},u.setLock=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setLock(u.props.path,l)},u.dummyFn=function(){},u.removeSelf=function(){u.props.actions.removeGroup(u.props.path)},u.addGroup=function(){var l=r=="rule_group"?u.props.field:u.props.parentField;u.props.actions.addGroup(u.props.path,void 0,void 0,l)},u.addCaseGroup=function(){u.props.actions.addCaseGroup(u.props.path)},u.addDefaultCaseGroup=function(){u.props.actions.addDefaultCaseGroup(u.props.path)},u.addRule=function(){var l=r=="rule_group"?u.props.field:u.props.parentField;u.props.actions.addRule(u.props.path,void 0,void 0,void 0,l)},u.setField=function(l,c,d){u.props.actions.setField(u.props.path,l,c,d)},u.setOperator=function(l){u.props.actions.setOperator(u.props.path,l)},u.setValue=function(l,c,d,f,p){u.props.actions.setValue(u.props.path,l,c,d,f,p)},u.setValueSrc=function(l,c,d){u.props.actions.setValueSrc(u.props.path,l,c,d)},u.setFuncValue=function(l,c,d,f,p,v,y){u.props.actions.setFuncValue(u.props.path,l,c,d,f,p,v,y)},u.pureShouldComponentUpdate=No(u),Fn(u),u.selectedConjunction=u._selectedConjunction(s),u.conjunctionOptions=u._getConjunctionOptions(s),u.dummyFn.isDummyFn=!0,u}return He(o,i),nt(o,[{key:"shouldComponentUpdate",value:function(u,l){var c=this.props,d=this.state,f=this.pureShouldComponentUpdate(u,l);if(f&&d==l&&c!=u){var p=u.dragging.id||c.dragging.id,v=p==u.id,y=[];for(var m in u){var S=u[m]!=c[m];m=="dragging"&&!v&&(S=!1),S&&y.push(m)}y.length||(f=!1)}return f}},{key:"onPropsChanged",value:function(u){var l=u.config,c=u.id,d=u.conjunction,f=this.props.config,p=this.props.conjunction;(f!=l||p!=d)&&(this.selectedConjunction=this._selectedConjunction(u),this.conjunctionOptions=this._getConjunctionOptions(u))}},{key:"_getConjunctionOptions",value:function(u){var l=this;return Gl()(u.config.conjunctions,function(c,d){return{id:"conjunction-".concat(u.id,"-").concat(d),name:"conjunction[".concat(u.id,"]"),key:d,label:c.label,checked:d===l._selectedConjunction(u)}})}},{key:"render",value:function(){var u=this.props.config.settings.showErrorMessage,l=this.props.dragging.id==this.props.id,c=this.props.path.size,d=this.props.config.settings.maxNesting,f=c==1;if(this.props.parentField&&this.props.parentFieldPathSize){var p=gy(this.props.config,this.props.parentField);c=this.props.path.size-this.props.parentFieldPathSize+1,d=p?.maxNesting,f=!1}else if(this.props.field){var v=gy(this.props.config,this.props.field);c=1,d=v?.maxNesting,f=!1}var y=!l&&this.props.isDraggingTempo,m=this.props.fieldType||null,S=this.props.valueError,F=mn(S?.toArray()||[]).filter(function(_){return!!_}).shift()||null,C=F!=null&&u,w=typeof d>"u"||c<d,E=d&&c>d;return U.createElement("div",{className:Qn()("group-or-rule-container","group-container",C?"group-with-error":null),"data-id":this.props.id},[l?U.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:f,lev:this.props.path.size-1,allowFurtherNesting:w,isMaxNestingExceeded:E,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:m,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,U.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:l,isDraggingTempo:y,onDragStart:this.props.onDragStart,isRoot:f,lev:this.props.path.size-1,allowFurtherNesting:w,isMaxNestingExceeded:E,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:y?this.dummyFn:this.setConjunction,setNot:y?this.dummyFn:this.setNot,setLock:y?this.dummyFn:this.setLock,removeSelf:y?this.dummyFn:this.removeSelf,addGroup:y?this.dummyFn:this.addGroup,addCaseGroup:y?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:y?this.dummyFn:this.addDefaultCaseGroup,addRule:y?this.dummyFn:this.addRule,setField:y?this.dummyFn:this.setField,setFuncValue:y?this.dummyFn:this.setFuncValue,setOperator:y?this.dummyFn:this.setOperator,setValue:y?this.dummyFn:this.setValue,setValueSrc:y?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:m,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(U.Component),n.propTypes={config:$().object.isRequired,actions:$().object.isRequired,path:$().any.isRequired,id:$().string.isRequired,groupId:$().string,not:$().bool,conjunction:$().string,children1:$().any,onDragStart:$().func,reordableNodesCnt:$().number,field:$().any,fieldSrc:$().string,fieldType:$().string,parentField:$().string,value:$().any,valueSrc:$().any,valueError:$().any,isLocked:$().bool,isTrueLocked:$().bool,dragging:$().object,isDraggingTempo:$().bool},n};const iu=function(a,e){var r=Ul(function(n){return{dragging:n.dragging}},null,null,{context:tu})(oE(a,e));return r.displayName="ConnectedGroupContainer",r};function sE(a,e,r){return e=je(e),Re(a,hy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function hy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hy=function(){return!!a})()}var uE={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},lE="topRight",my=function(a){function e(){return Ne(this,e),sE(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.addGroup,u=n.removeSelf,l=n.setLock,c=n.isLocked,d=n.isTrueLocked,f=n.id,p=n.parentField,v=n.canAddGroup,y=n.canAddRule,m=n.canDeleteGroup,S=i.settings,F=S.immutableGroupsMode,C=S.addRuleLabel,w=S.addGroupLabel,E=S.addSubRuleLabel,_=S.addSubGroupLabel,A=S.delGroupLabel,N=S.groupActionsPosition,X=S.renderButton,H=S.renderIcon,W=S.renderSwitch,J=S.renderButtonGroup,Y=S.lockLabel,K=S.lockedLabel,ae=S.showLock,se=S.canDeleteLocked,re=function(Fe){return H(Fe,i.ctx)},ie=function(Fe){return X(Fe,i.ctx)},ne=function(Fe){return W(Fe,i.ctx)},de=function(Fe){return J(Fe,i.ctx)},le=uE[N||lE],fe=ae&&!(c&&!d)&&U.createElement(ne,{type:"lock",id:f,value:c,setValue:l,label:Y,checkedLabel:K,config:i}),ve=!F&&y&&!c&&U.createElement(ie,{type:p?"addSubRule":"addRule",onClick:o,label:p?E:C,readonly:c,config:i,renderIcon:re}),ye=!F&&v&&!c&&U.createElement(ie,{type:p?"addSubGroup":"addGroup",onClick:s,label:p?_:w,readonly:c,config:i,renderIcon:re}),we=!F&&m&&(!c||c&&se)&&U.createElement(ie,{type:"delGroup",onClick:u,label:A,config:i,renderIcon:re});return U.createElement("div",{className:"group--actions ".concat(le)},U.createElement(de,{config:i},fe,ve,ye,we))}}])}(U.PureComponent);function cE(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=dE(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,i=function(){};return{s:i,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,u=!1;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return s=c.done,c},e:function(c){u=!0,o=c},f:function(){try{s||r.return==null||r.return()}finally{if(u)throw o}}}}function dE(a,e){if(a){if(typeof a=="string")return yy(a,e);var r={}.toString.call(a).slice(8,-1);return r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set"?Array.from(a):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yy(a,e):void 0}}function yy(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=Array(e);r<e;r++)n[r]=a[r];return n}function Sy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function by(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Sy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function fE(a,e,r){return e=je(e),Re(a,Oy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Oy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oy=function(){return!!a})()}var rf=ht.ConfigUtils.getFieldConfig,pE=ht.RuleUtils.isEmptyGroupChildren,Fy=ht.TreeUtils,Ix=Fy.getTotalReordableNodesCountInTree,vE=Fy.getTotalRulesCountInTree,gE="topRight",wa=function(a){function e(r){var n;return Ne(this,e),n=fE(this,e,[r]),n.childrenClassName=function(){return""},n.renderBeforeActions=function(){var i=n.BeforeActions;return i==null?null:U.createElement(i,It({key:"group-actions-before"},n.props))},n.renderAfterActions=function(){var i=n.AfterActions;return i==null?null:U.createElement(i,It({key:"group-actions-after"},n.props))},Fn(n),n.onPropsChanged(r),n.removeSelf=n.removeSelf.bind(n),n.setLock=n.setLock.bind(n),n.renderItem=n.renderItem.bind(n),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this,o=this.props,s=!this.Icon||o?.config!==n?.config;if(s){var u=n.config,l=u.settings,c=l.renderIcon,d=l.renderConjs,f=l.renderBeforeActions,p=l.renderAfterActions;this.Icon=Cn(u,c),this.Conjs=Cn(u,d),this.BeforeActions=Cn(u,f),this.AfterActions=Cn(u,p)}this.doRemove=function(){i.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return nE()(this.props.config.settings.groupActionsPosition||gE,"top")}},{key:"setLock",value:function(n){this.props.setLock(n)}},{key:"removeSelf",value:function(){var n=this.props,i=n.confirmFn,o=n.config,s=o.settings,u=s.renderConfirm,l=s.removeGroupConfirmOptions;l&&!this.isEmptyCurrentGroup()?u.call(o.ctx,by(by({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:i}),o.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var n=this.props,i=n.children1,o=n.config;return pE(i,o)}},{key:"showNot",value:function(){var n=this.props,i=n.config,o=n.parentField,s=i.settings.showNot;if(o){var u,l=rf(i,o);s=s&&((u=l?.showNot)!==null&&u!==void 0?u:!0)}return s}},{key:"showConjs",value:function(){var n=this.props.config,i=n.settings.forceShowConj,o=this.conjunctionOptions(),s=Object.keys(o).length;return s>1&&!this.isOneChild()||this.showNot()||i}},{key:"isNoChildren",value:function(){var n=this.props.children1;return n?n.size==0:!0}},{key:"isOneChild",value:function(){var n=this.props.children1;return n?n.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var n=this.props.children1;return n&&U.createElement("div",{key:"group-children",className:Qn()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var n=this.isGroupTopPosition();return U.createElement("div",{key:"group-header",className:Qn()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),n&&this.renderBeforeActions(),n&&this.renderActions(),n&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var n=this.isGroupTopPosition();return!n&&U.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.addGroup,u=n.isLocked,l=n.isTrueLocked,c=n.id,d=n.parentField;return U.createElement(my,{key:"group-actions",config:i,addRule:o,addGroup:s,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:l,id:c,parentField:d})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var n=this.props,i=n.totalRulesCnt,o=n.isMaxNestingExceeded,s=n.parentField,u=this.props.config.settings.maxNumberOfRules;if(s){var l=rf(this.props.config,s);u=l.maxNumberOfRules}return o?!1:u?i<u:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var n=this.props.children1;return n?n.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(n){if(n){var i=this.props,o=i.config,s=i.actions,u=i.onDragStart,l=i.isLocked,c=i.parentField,d=i.parentFieldPathSize,f=i.parentFieldCanReorder,p=n.get("type")=="group"&&n.getIn(["properties","field"])!=null,v=p?"rule_group":n.get("type");return U.createElement(of,It({key:n.get("id"),id:n.get("id"),groupId:i.id,path:n.get("path"),type:v,properties:n.get("properties"),config:o,actions:s,children1:n.get("children1"),parentField:c,parentFieldPathSize:d,parentFieldCanReorder:f,reordableNodesCnt:this.reordableNodesCntForItem(n),totalRulesCnt:this.totalRulesCntForItem(n),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:u,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l},this.extraPropsForItem(n)))}}},{key:"extraPropsForItem",value:function(n){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(n){return n.get("type")==="rule_group"?vE(n):this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(n){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var n=this.props,i=n.config,o=n.isRoot,s=n.isLocked,u=n.parentField,l=n.parentFieldCanReorder,c=this.reordableNodesCnt(),d=i.settings.canReorder&&!o&&c>1&&!s;return u&&(d=d&&l),d}},{key:"renderDrag",value:function(){var n=this.props.handleDraggerMouseDown,i=this.Icon,o=U.createElement(i,{type:"drag"});return this.showDragIcon()&&U.createElement("div",{key:"group-drag-icon",onMouseDown:n,className:"qb-drag-handler group--drag-handler"},o)}},{key:"conjunctionOptions",value:function(){var n=this.props,i=n.parentField,o=n.conjunctionOptions;return i?this.conjunctionOptionsForGroupField(i):o}},{key:"conjunctionOptionsForGroupField",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.props,o=i.config,s=i.conjunctionOptions,u=rf(o,n);if(u!=null&&u.conjunctions){var l={},c=cE(u.conjunctions),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=s[f];p&&(l[f]=p)}}catch(v){c.e(v)}finally{c.f()}return l}return s}},{key:"renderConjs",value:function(){var n=this.props,i=n.config,o=n.children1,s=n.id,u=n.selectedConjunction,l=n.setConjunction,c=n.not,d=n.setNot,f=n.isLocked,p=i.settings,v=p.immutableGroupsMode,y=p.notLabel,m=this.conjunctionOptions();if(!this.showConjs()||!o||!o.size)return null;var S={disabled:this.isOneChild(),readonly:v||f,selectedConjunction:u,setConjunction:v?Tn:l,conjunctionOptions:m,config:i,not:c||!1,id:s,setNot:v?Tn:d,notLabel:y,showNot:this.showNot(),isLocked:f},F=this.Conjs;return U.createElement(F,It({key:"group-conjs"},S))}},{key:"renderHeader",value:function(){return U.createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return U.createElement(U.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(U.Component);wa.propTypes={reordableNodesCnt:$().number,conjunctionOptions:$().object.isRequired,allowFurtherNesting:$().bool.isRequired,isMaxNestingExceeded:$().bool,isRoot:$().bool.isRequired,not:$().bool,selectedConjunction:$().string,config:$().object.isRequired,id:$().string.isRequired,groupId:$().string,path:$().any,children1:$().any,isDraggingMe:$().bool,isDraggingTempo:$().bool,isLocked:$().bool,isTrueLocked:$().bool,parentField:$().string,handleDraggerMouseDown:$().func,onDragStart:$().func,addRule:$().func.isRequired,addGroup:$().func.isRequired,removeSelf:$().func.isRequired,setConjunction:$().func.isRequired,setNot:$().func.isRequired,setLock:$().func.isRequired,actions:$().object.isRequired};const hE=iu(Mo("group")(Go(wa)),"group");function mE(a,e){for(;!{}.hasOwnProperty.call(a,e)&&(a=je(a))!==null;);return a}function Bo(){return Bo=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(a,e,r){var n=mE(a,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?a:r):i.value}},Bo.apply(null,arguments)}function yE(a,e,r){return e=je(e),Re(a,Ty()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Ty(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ty=function(){return!!a})()}var SE=function(a){function e(){return Ne(this,e),yE(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.canAddRule,u=n.canDeleteGroup,l=n.removeSelf,c=n.setLock,d=n.isLocked,f=n.isTrueLocked,p=n.id,v=i.settings,y=v.immutableGroupsMode,m=v.addRuleLabel,S=v.delGroupLabel,F=v.renderButton,C=v.renderIcon,w=v.renderSwitch,E=v.renderButtonGroup,_=v.lockLabel,A=v.lockedLabel,N=v.showLock,X=v.canDeleteLocked,H=function(ie){return C(ie,i.ctx)},W=function(ie){return F(ie,i.ctx)},J=function(ie){return w(ie,i.ctx)},Y=function(ie){return E(ie,i.ctx)},K=N&&!(d&&!f)&&U.createElement(J,{type:"lock",id:p,value:d,setValue:c,label:_,checkedLabel:A,hideLabel:!0,config:i}),ae=!y&&s&&!d&&U.createElement(W,{type:"addSubRuleSimple",onClick:o,label:m,readonly:d,config:i,renderIcon:H}),se=!y&&u&&(!d||d&&X)&&U.createElement(W,{type:"delRuleGroup",onClick:l,label:S,config:i,renderIcon:H});return U.createElement("div",{className:"group--actions"},U.createElement(Y,{config:i},K,ae,se))}}])}(U.PureComponent);function Cy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Ey(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Cy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function bE(a,e,r){return e=je(e),Re(a,wy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function wy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wy=function(){return!!a})()}function xy(a,e,r,n){var i=Bo(je(1&n?a.prototype:a),e,r);return 2&n&&typeof i=="function"?function(o){return i.apply(r,o)}:i}var OE=ht.ConfigUtils.getFieldConfig,Ly=function(a){function e(r){var n;return Ne(this,e),n=bE(this,e,[r]),n.childrenClassName=function(){return"rule_group--children"},n.renderHeaderWrapper=function(){return null},n.renderFooterWrapper=function(){return null},n.renderConjs=function(){return null},n.canAddGroup=function(){return!1},n.canAddRule=function(){return!0},n.canDeleteGroup=function(){return!1},n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){xy(e,"onPropsChanged",this,3)([n])}},{key:"reordableNodesCntForItem",value:function(n){if(this.props.isLocked)return 0;var i=this.props.children1;return i?.size||0}},{key:"renderChildrenWrapper",value:function(){return U.createElement(U.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),xy(e,"renderChildrenWrapper",this,3)([]))}},{key:"renderField",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=n.selectedFieldSrc,u=n.selectedFieldType,l=n.setField,c=n.setFuncValue,d=n.setFieldSrc,f=n.parentField,p=n.id,v=n.groupId,y=n.isLocked,m=i.settings.immutableFieldsMode;return U.createElement(tf,{key:"field",classname:"group--field",config:i,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:s,selectedFieldType:u,setField:l,setFuncValue:c,setFieldSrc:d,parentField:f,readonly:m||y,id:p,groupId:v})}},{key:"renderActions",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.isLocked,u=n.isTrueLocked,l=n.id;return U.createElement(SE,{config:i,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:s,isTrueLocked:u,id:l})}},{key:"extraPropsForItem",value:function(n){var i,o=this.props,s=o.selectedField,u=o.lev,l=o.config,c=OE(l,s);return{parentField:s,parentFieldPathSize:u+1,parentFieldCanReorder:(i=c?.canReorder)!==null&&i!==void 0?i:l.settings.canReorder}}}])}(wa);Ly.propTypes=Ey(Ey({},wa.propTypes),{},{selectedField:$().any,selectedFieldSrc:$().string,parentField:$().string,setField:$().func,setFieldSrc:$().func,lev:$().number});const FE=iu(Mo("group rule_group")(Go(Ly)),"rule_group");function TE(a,e,r){return e=je(e),Re(a,Ry()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Ry(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ry=function(){return!!a})()}var CE=function(a){function e(){return Ne(this,e),TE(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.addGroup,u=n.canAddRule,l=n.canAddGroup,c=n.canDeleteGroup,d=n.removeSelf,f=n.setLock,p=n.isLocked,v=n.isTrueLocked,y=n.id,m=i.settings,S=m.immutableGroupsMode,F=m.addSubRuleLabel,C=m.addSubGroupLabel,w=m.delGroupLabel,E=m.renderButton,_=m.renderIcon,A=m.renderSwitch,N=m.renderButtonGroup,X=m.lockLabel,H=m.lockedLabel,W=m.showLock,J=m.canDeleteLocked,Y=function(fe){return _(fe,i.ctx)},K=function(fe){return E(fe,i.ctx)},ae=function(fe){return A(fe,i.ctx)},se=function(fe){return N(fe,i.ctx)},re=W&&!(p&&!v)&&U.createElement(ae,{type:"lock",id:y,value:p,setValue:f,label:X,checkedLabel:H,config:i}),ie=!S&&u&&!p&&U.createElement(K,{type:"addSubRule",onClick:o,label:F,readonly:p,config:i,renderIcon:Y}),ne=!S&&l&&!p&&U.createElement(K,{type:"addSubGroup",onClick:s,label:C,readonly:p,config:i,renderIcon:Y}),de=!S&&c&&(!p||p&&J)&&U.createElement(K,{type:"delRuleGroup",onClick:d,label:w,config:i,renderIcon:Y});return U.createElement("div",{className:"group--actions group--actions--tr"},U.createElement(se,{config:i},re,ie,ne,de))}}])}(U.PureComponent);function jy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Iy(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):jy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function EE(a,e,r){return e=je(e),Re(a,Ay()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Ay(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ay=function(){return!!a})()}function wE(a,e,r,n){var i=Bo(je(1&n?a.prototype:a),e,r);return 2&n&&typeof i=="function"?function(o){return i.apply(r,o)}:i}var _y=ht.ConfigUtils,nf=_y.getFieldConfig,xE=_y.getFieldWidgetConfig,LE=ht.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,RE=ht.TreeUtils.getTotalReordableNodesCountInTree,Dy=function(a){function e(r){var n;return Ne(this,e),n=EE(this,e,[r]),n.childrenClassName=function(){return"rule_group_ext--children"},n.renderFooterWrapper=function(){return null},n.canDeleteGroup=function(){return!0},n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){wE(e,"onPropsChanged",this,3)([n])}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=nf(i,o),u=s?.maxNumberOfRules,l=this.props.totalRulesCnt;return u?l<u:!0}},{key:"renderHeaderWrapper",value:function(){return U.createElement("div",{key:"group-header",className:Qn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return U.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return U.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var n=this.props,i=n.config,o=n.valueError,s=i.settings,u=s.renderRuleError,l=s.showErrorMessage,c=mn(o?.toArray()||[]).filter(function(d){return!!d}).shift()||null;return l&&c&&U.createElement("div",{className:"rule_group--error"},u?u({error:c},i.ctx):c)}},{key:"showNot",value:function(){var n,i=this.props,o=i.config,s=i.selectedField,u=nf(o,s);return(n=u?.showNot)!==null&&n!==void 0?n:o.settings.showNot}},{key:"conjunctionOptions",value:function(){var n=this.props.selectedField;return this.conjunctionOptionsForGroupField(n)}},{key:"renderField",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=n.selectedFieldSrc,u=n.selectedFieldType,l=n.setField,c=n.setFieldSrc,d=n.setFuncValue,f=n.parentField,p=n.id,v=n.groupId,y=n.isLocked,m=i.settings.immutableFieldsMode;return U.createElement(tf,{key:"field",classname:"rule--field",config:i,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:s,selectedFieldType:u,setField:l,setFuncValue:d,setFieldSrc:c,parentField:f,readonly:m||y,id:p,groupId:v})}},{key:"renderOperator",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=n.selectedFieldSrc,u=n.selectedOperator,l=n.setField,c=n.setOperator,d=n.isLocked,f=i.settings.immutableFieldsMode,p=xE(i,o,u)||{},v=p.hideOperator,y=o&&v&&p.operatorInlineLabel,m=o&&!v;return U.createElement(Dm,{key:"operator",classname:"group--operator",config:i,selectedField:o,selectedFieldSrc:s,selectedOperator:u,setOperator:c,showOperator:m,showOperatorLabel:y,selectedFieldWidgetConfig:p,readonly:f||d,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var n=this.props,i=n.children1,o=n.config,s=this._buildWidgetProps(this.props);return LE(s,i,o)}},{key:"_buildWidgetProps",value:function(n){var i=n.selectedField,o=n.selectedFieldSrc,s=n.selectedFieldType,u=n.selectedOperator,l=n.operatorOptions,c=n.value,d=n.valueType,f=n.valueSrc,p=n.asyncListValues,v=n.valueError,y=n.fieldError,m=n.parentField;return{field:i,fieldSrc:o,fieldType:s,operator:u,operatorOptions:l,value:c,valueType:d,valueSrc:["value"],valueError:v,fieldError:null,parentField:m}}},{key:"renderWidget",value:function(){var n=this.props,i=n.config,o=n.selectedField,s=n.selectedOperator,u=n.isLocked,l=i.settings.immutableValuesMode,c=o&&s,d=c;if(!d)return null;var f=U.createElement(au,It({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:i,setValue:l?Tn:this.props.setValue,setValueSrc:Tn,readonly:l||u,id:this.props.id,groupId:this.props.groupId}));return U.createElement(_r,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},f)}},{key:"renderActions",value:function(){var n=this.props,i=n.config,o=n.addRule,s=n.addGroup,u=n.isLocked,l=n.isTrueLocked,c=n.id;return U.createElement(CE,{config:i,addRule:o,addGroup:s,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:l,id:c})}},{key:"reordableNodesCntForItem",value:function(n){if(this.props.isLocked)return 0;var i=this.props,o=i.children1,s=i.id;return RE({id:s,type:"rule_group",children1:o})}},{key:"extraPropsForItem",value:function(n){var i,o=this.props,s=o.selectedField,u=o.lev,l=o.config,c=nf(l,s);return{parentField:s,parentFieldPathSize:u+1,parentFieldCanReorder:(i=c?.canReorder)!==null&&i!==void 0?i:l.settings.canReorder}}}])}(wa);Dy.propTypes=Iy(Iy({},wa.propTypes),{},{selectedField:$().any,selectedFieldSrc:$().string,selectedOperator:$().string,value:$().any,parentField:$().string,setField:$().func,setFieldSrc:$().func,setOperator:$().func,setValue:$().func,valueError:$().any,lev:$().number});const jE=iu(Mo("group rule_group_ext")(Go(Dy)),"rule_group");function IE(a,e,r){return e=je(e),Re(a,Py()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Py(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Py=function(){return!!a})()}var AE={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},_E="topRight",DE=function(a){function e(){return Ne(this,e),IE(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.config,o=n.addCaseGroup,s=n.addDefaultCaseGroup,u=n.setLock,l=n.isLocked,c=n.isTrueLocked,d=n.id,f=n.canAddGroup,p=n.canAddDefault,v=i.settings,y=v.immutableGroupsMode,m=v.addCaseLabel,S=v.addDefaultCaseLabel,F=v.groupActionsPosition,C=v.renderButton,w=v.renderIcon,E=v.renderSwitch,_=v.renderButtonGroup,A=v.lockLabel,N=v.lockedLabel,X=v.showLock,H=function(ne){return w(ne,i.ctx)},W=function(ne){return C(ne,i.ctx)},J=function(ne){return E(ne,i.ctx)},Y=function(ne){return _(ne,i.ctx)},K=AE[F||_E],ae=X&&!(l&&!c)&&U.createElement(J,{type:"lock",id:d,value:l,setValue:u,label:A,checkedLabel:N,config:i}),se=!y&&f&&!l&&U.createElement(W,{type:"addCaseGroup",onClick:o,label:m,readonly:l,config:i,renderIcon:H}),re=!y&&p&&!l&&U.createElement(W,{type:"addDefaultCaseGroup",onClick:s,label:S,readonly:l,config:i,renderIcon:H});return U.createElement("div",{className:"group--actions ".concat(K)},U.createElement(Y,{config:i},ae,se,re))}}])}(U.PureComponent);function Ny(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function PE(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ny(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Ny(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function NE(a,e,r){return e=je(e),Re(a,Vy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Vy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vy=function(){return!!a})()}function VE(a,e,r,n){var i=Bo(je(1&n?a.prototype:a),e,r);return 2&n&&typeof i=="function"?function(o){return i.apply(r,o)}:i}var My=ht.TreeUtils,ME=My.getTotalReordableNodesCountInTree,kE=My.getTotalRulesCountInTree,ky=function(a){function e(r){var n;return Ne(this,e),n=NE(this,e,[r]),n.childrenClassName=function(){return"switch_group--children"},n.renderFooterWrapper=function(){return null},n.hasDefaultCase=function(){var i;return((i=n.props.children1)===null||i===void 0?void 0:i.size)&&n.props.children1.filter(function(o){return o.get("children1")==null}).size>0},n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){VE(e,"onPropsChanged",this,3)([n])}},{key:"canAddGroup",value:function(){var n,i=this.props.config.settings.maxNumberOfCases,o=((n=this.props.children1)===null||n===void 0?void 0:n.size)||0;return i?o<i:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var n,i=((n=this.props.children1)===null||n===void 0?void 0:n.size)||0,o=i;return this.hasDefaultCase()&&o--,o}},{key:"totalRulesCntForItem",value:function(n){return kE(n)}},{key:"reordableNodesCntForItem",value:function(n){var i;if(this.props.isLocked)return 0;var o=this.props.config.settings,s=o.canLeaveEmptyCase,u=o.canRegroupCases,l=((i=this.props.children1)===null||i===void 0?void 0:i.size)||0,c=l;this.hasDefaultCase()&&c--;var d=ME(n),f=d;return f==1&&u&&s&&c>1&&(f=111),f}},{key:"showConjs",value:function(){return!0}},{key:"renderHeaderWrapper",value:function(){return U.createElement("div",{key:"group-header",className:Qn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return U.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var n=this.props.config,i=n.settings.renderSwitchPrefix;return i||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var n=this.props,i=n.config,o=n.addCaseGroup,s=n.addDefaultCaseGroup,u=n.isLocked,l=n.isTrueLocked,c=n.id;return U.createElement(DE,{config:i,addCaseGroup:o,addDefaultCaseGroup:s,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:u,isTrueLocked:l,id:c})}}])}(wa);ky.propTypes=PE({},wa.propTypes);const GE=iu(Mo("group switch_group")(Go(ky)),"switch_group");function Gy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function By(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Gy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function BE(a,e,r){return e=je(e),Re(a,Uy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Uy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uy=function(){return!!a})()}function Uo(a,e,r,n){var i=Bo(je(1&n?a.prototype:a),e,r);return 2&n&&typeof i=="function"?function(o){return i.apply(r,o)}:i}var $y=function(a){function e(r){var n;return Ne(this,e),n=BE(this,e,[r]),n.childrenClassName=function(){return"case_group--children"},n.renderFooterWrapper=function(){return null},n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=!this.renderBeforeCaseValue||i?.config!==n?.config;if(Uo(e,"onPropsChanged",this,3)([n]),o){var s=n.config,u=s.settings,l=u.renderBeforeCaseValue,c=u.renderAfterCaseValue,d=u.renderRuleError;this.BeforeCaseValue=Cn(s,l),this.AfterCaseValue=Cn(s,c),this.RuleError=Cn(s,d)}}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(n){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(n){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:Uo(e,"showDragIcon",this,3)([])}},{key:"renderHeaderWrapper",value:function(){return U.createElement("div",{key:"group-header",className:Qn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:U.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var n=this.props.config.settings.defaultCaseLabel;return n||""}return U.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:Uo(e,"renderChildrenWrapper",this,3)([])}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?U.createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:Uo(e,"canAddGroup",this,3)([])}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:Uo(e,"canAddRule",this,3)([])}},{key:"renderBeforeValue",value:function(){var n=this.BeforeCaseValue;return n==null?null:U.createElement(n,It({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var n=this.AfterCaseValue;return n==null?null:U.createElement(n,It({key:"values-after"},this.props))}},{key:"renderError",value:function(){var n=this.props,i=n.config,o=n.valueError,s=i.settings.showErrorMessage,u=this.RuleError,l=mn(o?.toArray()||[]).filter(function(c){return!!c}).shift()||null;return s&&l&&U.createElement("div",{className:"rule--error"},u?U.createElement(u,{error:l}):l)}},{key:"renderValue",value:function(){var n=this.props,i=n.config,o=n.isLocked,s=n.value,u=n.valueSrc,l=n.valueError,c=n.setValue,d=n.setValueSrc,f=n.setFuncValue,p=n.id,v=i.settings.immutableValuesMode,y=U.createElement(au,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:s,valueSrc:u??"value",valueError:l,fieldError:null,config:i,setValue:v?Tn:c,setValueSrc:v?Tn:d,setFuncValue:v?Tn:f,readonly:v||o,id:p,groupId:null});return U.createElement(_r,{className:"case_group--value"},y)}},{key:"renderActions",value:function(){var n=this.props,i=n.config,o=n.addGroup,s=n.addRule,u=n.isLocked,l=n.isTrueLocked,c=n.id;return U.createElement(my,{config:i,addGroup:o,addRule:s,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:l,id:c})}},{key:"isEmptyCurrentGroup",value:function(){var n=this.props.value,i=n&&n.size?n.get(0):null,o=i!=null&&(Array.isArray(i)?i.length>0:!0);return Uo(e,"isEmptyCurrentGroup",this,3)([])&&!o}}])}(wa);$y.propTypes=By(By({},wa.propTypes),{},{parentReordableNodesCnt:$().number,value:$().any,setValue:$().func});const UE=iu(Mo("group case_group")(Go($y)),"case_group");var $E=["type"];function WE(a,e,r){return e=je(e),Re(a,Wy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Wy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wy=function(){return!!a})()}function zy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function af(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):zy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var zE=["rule","group","rule_group","switch_group","case_group"],$o=function(e){var r,n=((r=e.properties)===null||r===void 0?void 0:r.toObject())||{},i=af({},n);return e.isParentLocked&&(i.isLocked=!0),n.isLocked&&(i.isTrueLocked=!0),i},KE={rule:function(e){return U.createElement(tE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},group:function(e){return U.createElement(hE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group:function(e){return U.createElement(FE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group_ext:function(e){return U.createElement(jE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},switch_group:function(e){return U.createElement(GE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return U.createElement(UE,It({},$o(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},of=function(a){function e(){return Ne(this,e),WE(this,e,arguments)}return He(e,a),nt(e,[{key:"render",value:function(){var n,i=this.props,o=i.type,s=Vo(i,$E),u=(n=s.properties)===null||n===void 0?void 0:n.get("mode"),l=u=="array"?"_ext":"",c=s.config.settings.renderItem,d=KE[o+l];return c?c(af(af({},s),{},{type:o,itemComponent:d}),s.config.ctx):d?d(s):null}}])}(U.PureComponent);of.propTypes={config:$().object.isRequired,id:$().string.isRequired,groupId:$().string,type:$().oneOf(zE).isRequired,path:$().any.isRequired,properties:$().any,children1:$().any,actions:$().object.isRequired,reordableNodesCnt:$().number,onDragStart:$().func,parentField:$().string,isDraggingTempo:$().bool,isParentLocked:$().bool};function qE(a,e,r){return e=je(e),Re(a,Ky()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Ky(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ky=function(){return!!a})()}var qy=ht.TreeUtils,HE=qy.getTotalReordableNodesCountInTree,QE=qy.getTotalRulesCountInTree,Hy=ht.DefaultUtils,JE=Hy.createListWithOneElement,Qy=Hy.emptyProperties,Jy=function(a){function e(r){var n;return Ne(this,e),n=qE(this,e,[r]),n.pureShouldComponentUpdate=No(n),n._updPath(r),n}return He(e,a),nt(e,[{key:"shouldComponentUpdate",value:function(n,i){var o=this.pureShouldComponentUpdate(n,i);return o}},{key:"_updPath",value:function(n){var i=n.tree.get("id");this.path=JE(i)}},{key:"render",value:function(){var n=this.props,i=n.tree,o=n.config,s=n.actions,u=n.onDragStart,l=i.get("type"),c=l=="switch_group",d=c?null:HE(i),f=c?null:QE(i),p=i.get("id");return U.createElement(of,{key:p,id:p,path:this.path,type:l,properties:i.get("properties")||Qy(),config:o,actions:s,children1:i.get("children1")||Qy(),reordableNodesCnt:d,totalRulesCnt:f,parentReordableNodesCnt:0,onDragStart:u})}}])}(U.Component);Jy.propTypes={tree:$().any.isRequired,config:$().object.isRequired,actions:$().object.isRequired,onDragStart:$().func};const YE=sC(Jy);function Yy(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function XE(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yy(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Yy(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function ZE(a,e,r){return e=je(e),Re(a,Xy()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function Xy(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xy=function(){return!!a})()}var ew=ht.OtherUtils.clone,Jl=ht.ConfigUtils,ou=Jl.getFieldConfig,Zy=Jl.getFieldParts,e0=Jl.getFieldPathParts,tw=Jl.getWidgetForFieldOp,t0=ht.RuleUtils.getFieldPathLabels,r0=function(a){function e(r){var n;return Ne(this,e),n=ZE(this,e,[r]),Fn(n),n.onPropsChanged(r),n}return He(e,a),nt(e,[{key:"onPropsChanged",value:function(n){var i=this.props,o=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],s=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],u=!this.items||o.map(function(c){return n[c]!==i[c]}).filter(function(c){return c}).length>0,l=!this.meta||s.map(function(c){return n[c]!==i[c]}).filter(function(c){return c}).length>0;u&&(this.items=this.getItems(n)),l&&(this.meta=this.getMeta(n))}},{key:"getItems",value:function(n){var i=n.config,o=n.field,s=n.fieldType,u=n.operator,l=n.parentField,c=n.isFuncArg,d=n.fieldDefinition,f=i.settings.canCompareFieldWithField,p=Zy(l,i),v=l?ou(i,l):null,y=l?v?.subfields:i.fields,m=this.filterFields(i,y,o,l,p,u,f,c,d,s),S=this.buildOptions(p,i,m,p);return S}},{key:"getMeta",value:function(n){var i,o=n.config,s=n.field,u=n.fieldType,l=n.operator,c=n.value,d=n.placeholder,f=n.isFuncArg,p=n.parentField,v=o.settings,y=v.fieldPlaceholder,m=v.fieldSeparatorDisplay,S=c,F=!!c,C=s?ou(o,s):{},w=C==null||(i=C.widgets)===null||i===void 0?void 0:i.field,E=w?.widgetProps||{},_=F?null:f&&d||E.valuePlaceholder||y,A=F?ou(o,S):null,N=A||{},X=e0(S,o),H=e0(S,o,!0),W=this.getFieldLabel(A,S,o),J=t0(S,o),Y=J?J.join(m):null;(Y==W||p)&&(Y=null);var K=N.label2||N.tooltip;return{placeholder:_,selectedKey:S,selectedKeys:X,selectedPath:H,selectedLabel:W,selectedOpts:N,selectedAltLabel:K,selectedFullLabel:Y}}},{key:"filterFields",value:function(n,i,o,s,u,l,c,d,f,p){i=ew(i);var v=n.settings.fieldSeparator,y=ou(n,o),m=!1,S=tw(n,o,l,"value"),F=n.widgets[S],C=n.operators[l],w;d?w=f?.type:C!=null&&C.valueTypes?w=C?.valueTypes[0]:m&&F?w=F.type:y?w=y.type:w=p;function E(_,A){for(var N in _){var X=_[N].subfields,H=(A||[]).concat(N),W=H.join(v),J=ou(n,W);if(!J)delete _[N];else if(J.type=="!struct"||J.type=="!group")E(X,H)==0&&delete _[N];else{var Y=(!w||J.type==w)&&(d?!0:W!=o),K=c||n.settings.canCompareFieldWithField;K&&(Y=Y&&K(o,y,W,J,l)),Y||delete _[N]}}return ko()(_).length}return E(i,u||[]),i}},{key:"buildOptions",value:function(n,i,o){var s=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!o)return null;var c=i.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=u!=null&&u.length?u.join(d)+d:"";return ko()(o).map(function(v){var y=[].concat(mn(u??[]),[v]),m=o[v],S=s.getFieldLabel(m,y,i),F=t0(y,i),C=F.join(f);(C==S||n)&&(C=null);var w=m.label2,E=m.tooltip;if(!m.hideForCompare)return m.type=="!struct"||m.type=="!group"?{key:v,path:p+v,label:S,fullLabel:C,altLabel:w,tooltip:E,items:s.buildOptions(n,i,m.subfields,y,{label:S,tooltip:E})}:{key:v,path:p+v,label:S,fullLabel:C,altLabel:w,tooltip:E,grouplabel:l?.label,group:l}}).filter(function(v){return!!v})}},{key:"getFieldLabel",value:function(n,i,o){if(!i)return null;var s=o.settings.maxLabelsLength,u=Zy(i,o),l=n?.label||ml()(u);return l=zl(l,s),l}},{key:"render",value:function(){var n=this.props,i=n.config,o=n.customProps,s=n.setValue,u=n.readonly,l=n.id,c=n.groupId,d=i.settings.renderField,f=XE({isValueField:!0,config:i,customProps:o,setField:s,readonly:u,items:this.items,id:l,groupId:c},this.meta);return d(f,i.ctx)}}])}(U.Component);r0.propTypes={id:$().string,groupId:$().string,setValue:$().func.isRequired,config:$().object.isRequired,field:$().any,fieldSrc:$().string,fieldType:$().string,value:$().string,operator:$().string,customProps:$().object,readonly:$().bool,parentField:$().string,fieldDefinition:$().object,isFuncArg:$().bool};const rw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.labelYes,o=a.labelNo,s=a.readonly,u=a.widgetId,l=a.customProps,c=l===void 0?{}:l,d=c.radioYes||{},f=c.radioNo||{},p=function(m){return r(m.target.checked)},v=function(m){return r(m.target.value=="true")};return U.createElement(U.Fragment,null,U.createElement("input",It({type:"radio",value:!0,checked:!!e,disabled:s,onChange:v},d))," ",i,U.createElement("input",It({type:"radio",value:!1,checked:!e,disabled:s,onChange:v},f))," ",o)},nw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.readonly,o=a.placeholder,s=a.maxLength,u=a.customProps,l=function(f){var p=f.target.value;p===""&&(p=void 0),r(p)},c=e||"";return U.createElement("input",It({type:"text",value:c,placeholder:o,disabled:i,onChange:l,maxLength:s},u))},aw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.readonly,o=a.placeholder,s=a.maxLength,u=a.maxRows,l=a.fullWidth,c=a.customProps,d=function(v){var y=v.target.value;y===""&&(y=void 0),r(y)},f=e||"";return U.createElement("textarea",It({value:f,placeholder:o,disabled:i,onChange:d,maxLength:s,style:{width:l?"100%":void 0}},c))};var Ax=ht.moment;const iw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.valueFormat,o=a.readonly,s=a.customProps,u=function(c){var d=c.target.value;d==""&&(d=void 0),r(d)};return U.createElement("input",It({type:"date",value:e||"",disabled:o,onChange:u},s))},ow=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.valueFormat,o=a.use12Hours,s=a.readonly,u=a.customProps,l=function(d){var f=d.target.value;f==""&&(f=void 0),r(f)};return U.createElement("input",It({type:"time",value:e||"",disabled:s,onChange:l},u))};var n0=ht.moment;const sw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.valueFormat,o=a.use12Hours,s=a.readonly,u=a.customProps,l=function(f){var p=f.target.value;p==""?p=void 0:p=n0(new Date(p)).format(i),r(p)},c=e;return e?c=n0(e).format("YYYY-MM-DDTHH:mm"):c="",U.createElement("input",It({type:"datetime-local",value:c,disabled:s,onChange:l},u))};var uw=ht.ListUtils.mapListValues;const lw=function(a){var e=a.listValues,r=a.value,n=a.setValue,i=a.allowCustomValues,o=a.readonly,s=a.customProps,u=function(){return uw(e,function(f){var p=f.title,v=f.value;return U.createElement("option",{key:v,value:v},p)})},l=function(f){for(var p=[],v=f.options,y=0;y<v.length;y++){var m=v[y];m.selected&&p.push(m.value)}return p.length||(p=void 0),p},c=function(f){return n(l(f.target))};return U.createElement("select",It({multiple:!0,onChange:c,value:r,disabled:o},El()(s,["showSearch","input","showCheckboxes"])),u())};var cw=ht.ListUtils.mapListValues;const dw=function(a){var e=a.listValues,r=a.value,n=a.setValue,i=a.allowCustomValues,o=a.readonly,s=a.customProps,u=function(){return cw(e,function(f){var p=f.title,v=f.value;return U.createElement("option",{key:v,value:v},p)})},l=function(f){return n(f.target.value)},c=r!=null;return U.createElement("select",It({onChange:l,value:c?r:"",disabled:o},El()(s,["showSearch","input"])),!c&&U.createElement("option",{disabled:!0,value:""}),u())},fw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.readonly,o=a.min,s=a.max,u=a.step,l=a.placeholder,c=a.customProps,d=function(v){var y=v.target.value;y===""||y===null?y=void 0:y=Number(y),r(y)},f=e??"";return U.createElement("input",It({type:"number",value:f,placeholder:l,disabled:i,min:o,max:s,step:u,onChange:d},c))},pw=function(a){var e=a.value,r=a.setValue,n=a.config,i=a.readonly,o=a.min,s=a.max,u=a.step,l=a.placeholder,c=a.customProps,d=c===void 0?{}:c,f=d.input||{},p=d.slider||d,v=function(S){var F=S.target.value;F===""||F===null?F=void 0:F=Number(F),r(F)},y=e??"";return U.createElement("div",{style:{display:"inline-flex"}},U.createElement("input",It({key:"number",type:"number",value:y,placeholder:l,disabled:i,min:o,max:s,step:u,onChange:v},f)),U.createElement("input",It({key:"range",type:"range",value:y,disabled:i,min:o,max:s,step:u,onChange:v},p)))},vw=function(a){var e=a.items,r=a.setField,n=a.selectedKey,i=a.readonly,o=a.errorText,s=function(d){return d.map(function(f){var p=f.items,v=f.path,y=f.label,m=f.disabled,S=f.matchesType;if(p)return U.createElement("optgroup",{disabled:m,key:v,label:y},s(p));var F=S?{fontWeight:"bold"}:{};return U.createElement("option",{disabled:m,key:v,value:v,style:F},y)})},u=function(d){return r(d.target.value)},l=n!=null;return U.createElement("select",{onChange:u,value:l?n:"",disabled:i,style:{color:o?"red":null}},!l&&U.createElement("option",{disabled:!0,value:""}),s(e))},gw=function(a){var e=a.id,r=a.not,n=a.setNot,i=a.conjunctionOptions,o=a.setConjunction,s=a.disabled,u=a.readonly,l=a.config,c=a.showNot,d=a.notLabel,f=Object.keys(i).length,p=s,v=l.settings.forceShowConj,y=v||f>1&&!p,m=function(){return Object.keys(i).map(function(E){var _=i[E],A=_.id,N=_.name,X=_.label,H=_.checked,W=o.isDummyFn?"__dummy":"";return(u||s)&&!H?null:[U.createElement("input",{key:A+W,type:"radio",id:A+W,name:N+W,checked:H,disabled:u||s,value:E,onChange:F}),U.createElement("label",{key:A+W+"label",htmlFor:A+W},X)]})},S=function(){var E="not";return[U.createElement("input",{key:e+E,type:"checkbox",id:e+E,checked:r,disabled:u,onChange:C}),U.createElement("label",{key:e+E+"label",htmlFor:e+E},d||"NOT")]},F=function(E){return o(E.target.value)},C=function(E){return n(E.target.checked)};return[c&&S(),y&&m()]};var hw={addSubRuleSimple:"+",addSubRule:"+",addSubGroup:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const mw=function(a){var e=a.type,r=a.label,n=a.onClick,i=a.readonly,o=r||hw[e];return U.createElement("button",{onClick:n,type:"button",disabled:i},o)},yw=function(a){var e=a.type,r={},n=r[e]||null;return!n&&e==="drag"&&(n=U.createElement(Im,null)),n},Sw=function(a){var e=a.children,r=a.config;return U.createElement(U.Fragment,null,e)},bw=function(a){var e=a.config,r=a.valueSources,n=a.valueSrc,i=a.title,o=a.setValueSrc,s=a.readonly,u=function(d){return d.map(function(f){var p=ql(f,2),v=p[0],y=p[1];return U.createElement("option",{key:v,value:v},y.label)})},l=function(d){return o(d.target.value)};return U.createElement("select",{onChange:l,value:n||"",disabled:s},u(r))},Ow=function(a){var e=a.value,r=a.setValue,n=a.label,i=a.id,o=a.config,s=a.type,u=function(d){return r(d.target.checked)},l=s;return[U.createElement("input",{key:i+l,type:"checkbox",id:i+l,checked:!!e,onChange:u}),U.createElement("label",{key:i+l+"label",htmlFor:i+l},n)]},Fw=function(a){var e=a.onOk,r=a.okText,n=a.cancelText,i=a.title;confirm(i)&&e()};var Tw=function(e){var r=e.config,n=e.children;return n};function Cw(a,e,r){return e=je(e),Re(a,a0()?Reflect.construct(e,r||[],je(a).constructor):e.apply(a,r))}function a0(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a0=function(){return!!a})()}var sf=function(a){function e(){var r;Ne(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=Cw(this,e,[].concat(i)),r.handleChange=function(s){r.props.setOption("proximity",parseInt(s))},r}return He(e,a),nt(e,[{key:"render",value:function(){var n=this.props,i=n.defaults,o=n.options,s=n.config,u=n.optionLabel,l=n.optionPlaceholder,c=n.customProps,d=n.minProximity,f=n.maxProximity,p=n.optionTextBefore,v=n.readonly,y=s.settings,m=s.widgets,S=s.ctx,F=i?i.proximity:void 0,C=y.showLabels,w=o.get("proximity",F),E=Xd()(d,f+1).map(function(N){return{title:N,value:N}}),_=m.select.factory,A=function(X){return _(X,S)};return U.createElement("div",{className:"operator--PROXIMITY"},U.createElement("div",{className:"operator--options"},C&&U.createElement("label",{className:"rule--label"},u),!C&&p&&U.createElement("div",{className:"operator--options--sep"},U.createElement("span",null,p)),U.createElement(A,It({config:s,value:w,listValues:E,setValue:this.handleChange,readonly:v,placeholder:l},c))),U.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(U.PureComponent);sf.propTypes={config:$().object.isRequired,setOption:$().func.isRequired,options:$().any.isRequired,minProximity:$().number,maxProximity:$().number,optionPlaceholder:$().string,optionTextBefore:$().string,optionLabel:$().string,customProps:$().object,readonly:$().bool},sf.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function i0(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function bt(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?i0(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):i0(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Ew=bt({},gr.conjunctions),ww=bt(bt({},gr.operators),{},{proximity:bt(bt({},gr.operators.proximity),{},{options:bt(bt({},gr.operators.proximity.options),{},{factory:function(e,r){var n=r.RCE,i=r.O.ProximityOperator;return n(i,e)}})})}),xw={text:bt(bt({},gr.widgets.text),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaTextWidget;return n(i,e)}}),textarea:bt(bt({},gr.widgets.textarea),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaTextAreaWidget;return n(i,e)}}),number:bt(bt({},gr.widgets.number),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaNumberWidget;return n(i,e)}}),slider:bt(bt({},gr.widgets.slider),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaSliderWidget;return n(i,e)}}),select:bt(bt({},gr.widgets.select),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaSelectWidget;return n(i,e)}}),multiselect:bt(bt({},gr.widgets.multiselect),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaMultiSelectWidget;return n(i,e)}}),date:bt(bt({},gr.widgets.date),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaDateWidget;return n(i,e)}}),time:bt(bt({},gr.widgets.time),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaTimeWidget;return n(i,e)}}),datetime:bt(bt({},gr.widgets.datetime),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaDateTimeWidget;return n(i,e)}}),boolean:bt(bt({},gr.widgets.boolean),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaBooleanWidget;return n(i,e)}}),field:bt(bt({},gr.widgets.field),{},{factory:function(e,r){var n=r.RCE,i=r.W.ValueFieldWidget;return n(i,e)},customProps:{showSearch:!0}}),func:bt(bt({},gr.widgets.func),{},{factory:function(e,r){var n=r.RCE,i=r.W.FuncWidget;return n(i,e)},customProps:{}}),case_value:bt(bt({},gr.widgets.case_value),{},{factory:function(e,r){var n=r.RCE,i=r.W.VanillaTextWidget;return n(i,e)}})},Lw=bt(bt({},gr.types),{},{select:bt(bt({},gr.types.select),{},{widgets:bt(bt({},gr.types.select.widgets),{},{select:bt(bt({},gr.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),Rw=bt(bt({},gr.settings),{},{renderField:function(e,r){var n=r.RCE,i=r.W.VanillaFieldSelect;return n(i,e)},renderOperator:function(e,r){var n=r.RCE,i=r.W.VanillaFieldSelect;return n(i,e)},renderFunc:function(e,r){var n=r.RCE,i=r.W.VanillaFieldSelect;return n(i,e)},renderConjs:function(e,r){var n=r.RCE,i=r.W.VanillaConjs;return n(i,e)},renderSwitch:function(e,r){var n=r.RCE,i=r.W.VanillaSwitch;return n(i,e)},renderButton:function(e,r){var n=r.RCE,i=r.W.VanillaButton;return n(i,e)},renderIcon:function(e,r){var n=r.RCE,i=r.W.VanillaIcon;return n(i,e)},renderButtonGroup:function(e,r){var n=r.RCE,i=r.W.VanillaButtonGroup;return n(i,e)},renderProvider:function(e,r){var n=r.RCE,i=r.W.VanillaProvider;return n(i,e)},renderValueSources:function(e,r){var n=r.RCE,i=r.W.VanillaValueSources;return n(i,e)},renderFieldSources:function(e,r){var n=r.RCE,i=r.W.VanillaValueSources;return n(i,e)},renderConfirm:function(e,r){var n=r.W.vanillaConfirm;return n(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,r){var n=r.RCE;return n("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},customOperatorSelectProps:{},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),jw=bt(bt({},gr.ctx),{},{W:bt({},qe),O:bt({},xt),RCE:function(e,r){return U.createElement(e,r)}}),uf={conjunctions:Ew,operators:ww,widgets:xw,types:Lw,settings:Rw,ctx:jw};uf=ht.ConfigMixins.removeMixins(uf,["rangeslider","treeselect","treemultiselect"]);const Iw=uf;var _x=b(15413),Dx=b(60602);function o0(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function Yl(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?o0(Object(r),!0).forEach(function(n){_defineProperty(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):o0(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var su=ht.Autocomplete,Xl=su.mergeListValues,s0=su.listValueToOption,Aw=su.optionToListValue,_w=su.optionsToListValues,Dw=su.fixListValuesGroupOrder,Wo=ht.ListUtils,Pw=Wo.mapListValues,Zl=Wo.listValuesToArray,ec=Wo.getListValue,u0=Wo.makeCustomListValue,Nw=Wo.searchListValue,Vw=Wo.getItemInListValues;function l0(a){return new Promise(function(e){setTimeout(e,a)})}var Px=function(e,r){var n,i,o,s=e.asyncFetch,u=e.useLoadMore,l=e.useAsyncSearch,c=e.forceAsyncSearch,d=e.fetchSelectedValuesOnInit,f=e.asyncListValues,p=e.listValues,v=e.allowCustomValues,y=e.value,m=e.setValue,S=e.placeholder,F=e.config,C=e.field,w=r.debounceTimeout,E=r.multiple,_=r.uif,A=r.isFieldAutocomplete,N=["LOAD_MORE","LOADING_MORE"],X=(n=F.settings.loadMoreLabel)!==null&&n!==void 0?n:"Load more...",H=(i=F.settings.loadingMoreLabel)!==null&&i!==void 0?i:"Loading more...",W=c?(o=F.settings.typeToSearchLabel)!==null&&o!==void 0?o:"Type to search":S;s&&d&&!f&&y!=null&&(f=Array.isArray(y)?y:[y]);var J=React.useState(!1),Y=_slicedToArray(J,2),K=Y[0],ae=Y[1],se=React.useState(void 0),re=_slicedToArray(se,2),ie=re[0],ne=re[1],de=React.useState(0),le=_slicedToArray(de,2),fe=le[0],ve=le[1],ye=React.useState(!1),we=_slicedToArray(ye,2),xe=we[0],Fe=we[1],ze=React.useState(""),_e=_slicedToArray(ze,2),Oe=_e[0],Ve=_e[1],ke=React.useState(void 0),De=_slicedToArray(ke,2),Ke=De[0],$e=De[1],Je=React.useRef(0),ut=React.useRef(0),Xe=React.useRef(!1),et=React.useRef();et.current=y;var Jt=React.useRef();Jt.current=Oe;var kt=React.useMemo(function(){return Zl(f)},[f]),Kt=f&&Array.isArray(f)&&f.filter(function(Ht){return Ht!==null&&_typeof(Ht)!=="object"}).length>0,Ct=React.useMemo(function(){return s?f?Xl(Ke,kt,!0):Ke:Zl(p)},[s,f,Ke,p]),or=s?Ke:Zl(p);v&&Oe&&!Nw(Oe,Ke)&&(or=Xl(or,[u0(Oe)],!0)),s&&!Ke&&f&&!Oe&&!K&&_==="antd"&&(or=Ct),s&&!v&&f&&_==="mui"&&(or=Xl(or,kt,!0,!0));var er=fe>0,Lr=d&&!K&&s&&Kt&&y!=null,lr=K&&s&&Ke===void 0&&(c?Oe:!0),Or=(lr||Lr)&&er,Rr=!Or&&Ct&&Ct.length>0&&ie&&ie.hasMore&&(ie.filter||"")===Oe,qt=!er&&Rr,an=Pw(or,s0),Jn=y!=null,Nt=!E&&Jn?ec(y,Ct):null,Fr=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(){var tt,dt,yt,_t,hr,cr,Ur,$r,Wr,Bn,$t,Yn,Rn,Tr,Yt,Cr=arguments;return _regeneratorRuntime.wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return tt=Cr.length>0&&Cr[0]!==void 0?Cr[0]:null,dt=Cr.length>1&&Cr[1]!==void 0?Cr[1]:!1,!dt&&ie&&ne(void 0),yt=dt&&Ke?Ke.length:0,_t=dt&&ie||!u&&{pageSize:0},hr=++Je.current,on.next=8,s.call(F?.ctx,tt,yt,_t);case 8:if(cr=on.sent,Ur=Je.current!=hr,!(Ur||!ut.current)){on.next=12;break}return on.abrupt("return",null);case 12:return $r=cr!=null&&cr.values?cr:{values:cr},Wr=$r.values,Bn=$r.hasMore,$t=$r.meta,Yn=Zl(Wr),dt?(Tr=Xl(Ke,Yn,!1),Rn=Tr.length>Ke.length):(Tr=Yn,u&&(Rn=Tr.length>0)),Yt=Bn!=null||$t!=null||Rn!=null?Yl(Yl(Yl(Yl({},Rn!=null?{hasMore:Rn}:{}),Bn!=null?{hasMore:Bn}:{}),$t??{}),{},{filter:tt}):void 0,Yt&&ne(Yt),on.abrupt("return",Tr);case 18:case"end":return on.stop()}},it)}));return function(){return Ht.apply(this,arguments)}}(),Br=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(){var tt,dt,yt,_t,hr,cr,Ur,$r,Wr;return _regeneratorRuntime.wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:if(tt=et.current==null?[]:E?et.current:[et.current],tt.length){$t.next=3;break}return $t.abrupt("return",null);case 3:return dt={fetchSelectedValues:!0},yt=++Je.current,$t.next=7,s.call(F?.ctx,tt,-1,dt);case 7:if(_t=$t.sent,hr=Je.current!=yt,!(hr||!ut.current)){$t.next=11;break}return $t.abrupt("return",null);case 11:return cr=_t!=null&&_t.values?_t:{values:_t},Ur=cr.values,$r=et.current==null?[]:E?et.current:[et.current],Wr=$r.map(function(Yn){var Rn;return(Rn=Vw(Ur,Yn))!==null&&Rn!==void 0?Rn:u0(Yn)}),$t.abrupt("return",Wr.length?Wr:null);case 15:case"end":return $t.stop()}},it)}));return function(){return Ht.apply(this,arguments)}}(),Mn=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(){var tt;return _regeneratorRuntime.wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return ve(function(_t){return _t+1}),yt.next=3,Br();case 3:if(tt=yt.sent,ut.current){yt.next=6;break}return yt.abrupt("return");case 6:tt!=null&&m(et.current,tt),ve(function(_t){return _t-1});case 8:case"end":return yt.stop()}},it)}));return function(){return Ht.apply(this,arguments)}}(),Bt=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(){var tt,dt,yt,_t=arguments;return _regeneratorRuntime.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return tt=_t.length>0&&_t[0]!==void 0?_t[0]:null,dt=_t.length>1&&_t[1]!==void 0?_t[1]:!1,ve(function(Ur){return Ur+1}),Fe(dt),cr.next=6,Fr(tt,dt);case 6:if(yt=cr.sent,ut.current){cr.next=9;break}return cr.abrupt("return");case 9:yt!=null&&$e(yt),ve(function(Ur){return Ur-1}),Fe(!1);case 12:case"end":return cr.stop()}},it)}));return function(){return Ht.apply(this,arguments)}}(),kn=React.useCallback(debounce(Bt,w),[]);React.useEffect(function(){return ut.current++,function(){ut.current--}},[]),React.useEffect(function(){lr&&fe==0&&_asyncToGenerator(_regeneratorRuntime.mark(function Ht(){return _regeneratorRuntime.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:return tt.next=2,Bt();case 2:case"end":return tt.stop()}},Ht)}))(),Lr&&fe==0&&_asyncToGenerator(_regeneratorRuntime.mark(function Ht(){return _regeneratorRuntime.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:return tt.next=2,Mn();case 2:case"end":return tt.stop()}},Ht)}))()},[lr,Lr,fe]);var Ut=function(){ae(!0)},yn=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(tt){var dt,yt;return _regeneratorRuntime.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(dt=Xe.current,dt?(Xe.current=!1,E&&ae(!1)):ae(!1),!(_==="mui"&&!dt)){hr.next=6;break}return yt="",hr.next=6,Yi(null,yt,"my-reset");case 6:case"end":return hr.stop()}},it)}));return function(tt){return Ht.apply(this,arguments)}}(),Gn=function(it){it?Ut():yn()},la=function(it){var tt=it?.specialValue||it?.value;return N.includes(tt)},uu=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(tt,dt,yt){var _t,hr,cr,Ur,$r,Wr,Bn,$t,Yn,Rn,Tr,Yt,Cr,Xi,on,tc,rc,Ko,fu,en;return _regeneratorRuntime.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(cr=E&&_==="mui"&&yt==="clear",Ur=!E&&_==="mui"&&yt==="clear"&&tt?.type==="change",$r=!E&&_==="mui"&&yt==="clear"&&tt?.type!=="change",_==="mui"&&(yt=dt,E?dt=yt.map(function(Xn){var pu;return(pu=Xn?.value)!==null&&pu!==void 0?pu:Xn}):dt=(Wr=(Bn=yt)===null||Bn===void 0?void 0:Bn.value)!==null&&Wr!==void 0?Wr:yt),$t=E&&Array.isArray(yt)&&yt.map(function(Xn){return Xn?.specialValue}).find(function(Xn){return!!Xn})||((_t=yt)===null||_t===void 0?void 0:_t.specialValue),E&&dt&&!Array.isArray(dt)&&(dt=[].concat(_toConsumableArray(y||[]),[dt]),yt=null),Yn=E&&((hr=dt)===null||hr===void 0?void 0:hr.length)&&new Set(dt).size!==dt.length,Rn=E&&_==="antd"&&tt===null&&yt===null&&Yn,Tr=cr&&dt.length===0&&Oe&&K||Ur||Rn,!Tr){Er.next=11;break}return Er.abrupt("return");case 11:if(Yt=E&&dt.length&&dt.length>(y||[]).length&&dt[dt.length-1]==Oe&&!ec(Oe,Ke),$t!="LOAD_MORE"){Er.next=19;break}return Ve(Oe),Xe.current=!0,Er.next=17,Bt(Oe,!0);case 17:Er.next=39;break;case 19:if($t!="LOADING_MORE"){Er.next=23;break}Xe.current=!0,Er.next=39;break;case 23:if(!E){Er.next=33;break}if(Cr=_w(dt,Ct,v),Xi=_slicedToArray(Cr,2),on=Xi[0],tc=Xi[1],m(on,s?tc:void 0),!Yt){Er.next=31;break}return Er.next=29,l0(0);case 29:return Er.next=31,Yi(null,"","my-reset");case 31:Er.next=39;break;case 33:if(rc=Aw(dt,Ct,v),Ko=_slicedToArray(rc,2),fu=Ko[0],en=Ko[1],m(fu,s?en:void 0),!($r&&A)){Er.next=39;break}return Er.next=38,l0(0);case 38:ae(!1);case 39:case"end":return Er.stop()}},it)}));return function(tt,dt,yt){return Ht.apply(this,arguments)}}(),Yi=function(){var Ht=_asyncToGenerator(_regeneratorRuntime.mark(function it(tt,dt,yt){var _t,hr,cr,Ur,$r,Wr;return _regeneratorRuntime.wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:if(_t=_==="mui"&&yt==="removeOption"&&dt===""&&E,hr=_==="mui"&&yt==="selectOption"&&dt===""&&E,cr=_==="mui"&&!E&&yt==="blur"&&dt===Nt?.title,Ur=_==="mui"&&yt==="reset"||hr||_t||cr,$r=dt,!($r===X||$r===H||Ur)){$t.next=7;break}return $t.abrupt("return");case 7:if(!(_==="mui"&&!E&&yt==="selectOption"&&dt!=="")){$t.next=9;break}return $t.abrupt("return");case 9:if(dt==Oe){$t.next=18;break}if(Ve($r),Wr=l&&(c?!!$r:!0),!Wr){$t.next=17;break}return $t.next=15,kn($r);case 15:$t.next=18;break;case 17:l&&c&&$e([]);case 18:case"end":return $t.stop()}},it)}));return function(tt,dt,yt){return Ht.apply(this,arguments)}}(),zo=function(it){var tt=_toConsumableArray(it);return u&&(qt?tt.push({specialValue:"LOAD_MORE",title:X}):xe&&tt.push({specialValue:"LOADING_MORE",title:H,disabled:!0})),tt},lu=function(it,tt){if(tt==null)return null;var dt=tt.value!=null?tt.value:tt;return it.value===dt},cu=function(it){return it&&it.disabled},xa=function(it){var tt;if(it!=null&&it.isCustom)return!0;var dt=(tt=it?.value)!==null&&tt!==void 0?tt:it,yt=ec(dt,Ct);return yt?.isCustom||yt==null},Zr=function(it){if(it==null)return null;var tt=it.value!=null?it:s0(ec(it,Ct));return!tt&&it.specialValue?it.title:!tt&&v||!tt?it.toString():tt.title||tt.label||tt.value.toString()},du=_==="mui"?Dw(an):an;return{options:du,listValues:Ct,hasValue:Jn,selectedListValue:Nt,open:K,onOpen:Ut,onClose:yn,onDropdownVisibleChange:Gn,onChange:uu,inputValue:Oe,onInputChange:Yi,canShowLoadMore:qt,isInitialLoading:Or,isLoading:er,isLoadingMore:xe,isSpecialValue:la,extendOptions:zo,getOptionSelected:lu,getOptionDisabled:cu,getOptionIsCustom:xa,getOptionLabel:Zr,aPlaceholder:W}};const Nx=null;function c0(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),r.push.apply(r,n)}return r}function d0(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c0(Object(r),!0).forEach(function(n){hn(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):c0(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}const Mw=d0(d0({},ht),{},{ReactUtils:st,DragIcon:Im})},1779:(ue,he,b)=>{var V=b(48287).Buffer,j=function(){"use strict";function g(q,oe){return oe!=null&&q instanceof oe}var D;try{D=Map}catch{D=function(){}}var z;try{z=Set}catch{z=function(){}}var x;try{x=Promise}catch{x=function(){}}function I(q,oe,Te,B,me){typeof oe=="object"&&(Te=oe.depth,B=oe.prototype,me=oe.includeNonEnumerable,oe=oe.circular);var Le=[],Ue=[],Ie=typeof V<"u";typeof oe>"u"&&(oe=!0),typeof Te>"u"&&(Te=1/0);function st(qe,xt){if(qe===null)return null;if(xt===0)return qe;var Ne,ot;if(typeof qe!="object")return qe;if(g(qe,D))Ne=new D;else if(g(qe,z))Ne=new z;else if(g(qe,x))Ne=new x(function(He,U){qe.then(function(Ye){He(st(Ye,xt-1))},function(Ye){U(st(Ye,xt-1))})});else if(I.__isArray(qe))Ne=[];else if(I.__isRegExp(qe))Ne=new RegExp(qe.source,k(qe)),qe.lastIndex&&(Ne.lastIndex=qe.lastIndex);else if(I.__isDate(qe))Ne=new Date(qe.getTime());else{if(Ie&&V.isBuffer(qe))return V.allocUnsafe?Ne=V.allocUnsafe(qe.length):Ne=new V(qe.length),qe.copy(Ne),Ne;g(qe,Error)?Ne=Object.create(qe):typeof B>"u"?(ot=Object.getPrototypeOf(qe),Ne=Object.create(ot)):(Ne=Object.create(B),ot=B)}if(oe){var rt=Le.indexOf(qe);if(rt!=-1)return Ue[rt];Le.push(qe),Ue.push(Ne)}g(qe,D)&&qe.forEach(function(He,U){var Ye=st(U,xt-1),Zt=st(He,xt-1);Ne.set(Ye,Zt)}),g(qe,z)&&qe.forEach(function(He){var U=st(He,xt-1);Ne.add(U)});for(var We in qe){var pt;ot&&(pt=Object.getOwnPropertyDescriptor(ot,We)),!(pt&&pt.set==null)&&(Ne[We]=st(qe[We],xt-1))}if(Object.getOwnPropertySymbols)for(var nt=Object.getOwnPropertySymbols(qe),We=0;We<nt.length;We++){var Xt=nt[We],Re=Object.getOwnPropertyDescriptor(qe,Xt);Re&&!Re.enumerable&&!me||(Ne[Xt]=st(qe[Xt],xt-1),Re.enumerable||Object.defineProperty(Ne,Xt,{enumerable:!1}))}if(me)for(var je=Object.getOwnPropertyNames(qe),We=0;We<je.length;We++){var ft=je[We],Re=Object.getOwnPropertyDescriptor(qe,ft);Re&&Re.enumerable||(Ne[ft]=st(qe[ft],xt-1),Object.defineProperty(Ne,ft,{enumerable:!1}))}return Ne}return st(q,Te)}I.clonePrototype=function(oe){if(oe===null)return null;var Te=function(){};return Te.prototype=oe,new Te};function M(q){return Object.prototype.toString.call(q)}I.__objToStr=M;function P(q){return typeof q=="object"&&M(q)==="[object Date]"}I.__isDate=P;function Q(q){return typeof q=="object"&&M(q)==="[object Array]"}I.__isArray=Q;function Z(q){return typeof q=="object"&&M(q)==="[object RegExp]"}I.__isRegExp=Z;function k(q){var oe="";return q.global&&(oe+="g"),q.ignoreCase&&(oe+="i"),q.multiline&&(oe+="m"),oe}return I.__getRegExpFlags=k,I}();ue.exports&&(ue.exports=j)},97890:(ue,he,b)=>{"use strict";b.d(he,{C:()=>j});var V=b(43173);const j=()=>!!V.$.featureToggles.sqlDatasourceDatabaseSelection},81045:(ue,he,b)=>{"use strict";b.d(he,{T:()=>D});var V=b(41778),j=b(11194),g=b(25274);function D(z){let x=z?.editorMode||V.lX.Builder;return z?.editorMode===void 0&&z?.rawSql!==void 0&&(x=V.lX.Code),{...z,refId:z?.refId||"A",format:z?.format!==void 0?z.format:j.gv.Table,rawSql:z?.rawSql||"",editorMode:x,sql:z?.sql??{columns:[(0,g.JD)()],groupBy:[(0,g.xG)()],limit:50}}}},36656:(ue,he,b)=>{"use strict";b.d(he,{D:()=>V,_:()=>j});var V=(g=>(g.String="string",g))(V||{}),j=(g=>(g.Property="property",g.Operator="operator",g.Or="or",g.And="and",g.GroupBy="groupBy",g.Function="function",g.FunctionParameter="functionParameter",g))(j||{})},11194:(ue,he,b)=>{"use strict";b.d(he,{cO:()=>g,gv:()=>j,zL:()=>z});var V=b(47184),j=(x=>(x.Timeseries="time_series",x.Table="table",x))(j||{});const g=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],D=x=>({label:x,value:x}),z=V.z??D},25274:(ue,he,b)=>{"use strict";b.d(he,{JD:()=>I,Kj:()=>x,YW:()=>D,oF:()=>g,oG:()=>M,xG:()=>z});var V=b(47184),j=b(36656);function g(P){return`SELECT ${P.map(Z=>{let k="";return Z.name&&Z.alias?k+=`${Z.name}(${Z.parameters?.map(q=>`${q.name}`)}) AS ${Z.alias}`:Z.name?k+=`${Z.name}(${Z.parameters?.map(q=>`${q.name}`)})`:Z.alias?k+=`${Z.parameters?.map(q=>`${q.name}`)} AS ${Z.alias}`:k+=`${Z.parameters?.map(q=>`${q.name}`)}`,k}).join(", ")} `}const D=P=>{if(!P)return!1;const Q=P.some(k=>k.parameters?.length||k.parameters?.some(q=>q.name)),Z=P.some(k=>k.name);return Q||Z};function z(P){return{type:j._.GroupBy,property:{type:j.D.String,name:P}}}function x(P){return{type:j._.Property,property:{type:j.D.String,name:P}}}function I(P){return{type:j._.Function,name:P,parameters:[]}}function M(P){return P?.name?(0,V.z)(P.name):null}},40590:(ue,he,b)=>{"use strict";b.r(he),b.d(he,{plugin:()=>_s});var V=b(94644),j=b(43173),g=b(74848),D=b(2543),z=b(96540),x=b(48480),I=b(16780),M=b(37386),P=b(18857),Q=b(34999),Z=b(96004),k=b(18027),q=b(63527);const oe="Direct browser access in the InfluxDB datasource is no longer available. Switch to server access mode.",Te="default";var B=(O=>(O.InfluxQL="InfluxQL",O.Flux="Flux",O.SQL="SQL",O))(B||{}),me=b(97095),Le=b(48767);const Ue=20;var Ie=b(27489);const st=O=>{(0,Ie.rR)("influxdb-configv1-query-language-dropdown",O)},qe=()=>{(0,Ie.rR)("influxdb-configv1-flux-dbdetails-organization-input-field")},xt=()=>{(0,Ie.rR)("influxdb-configv1-flux-dbdetails-token-input-field")},Ne=()=>{(0,Ie.rR)("influxdb-configv1-flux-dbdetails-default-bucket-input-field")},ot=()=>{(0,Ie.rR)("influxdb-configv1-influxql-dbdetails-database-input-field")},rt=()=>{(0,Ie.rR)("influxdb-configv1-influxql-dbdetails-user-input-field")},We=()=>{(0,Ie.rR)("influxdb-configv1-influxql-dbdetails-password-input-field")},pt=()=>{(0,Ie.rR)("influxdb-configv1-sql-dbdetails-database-input-field")},nt=()=>{(0,Ie.rR)("influxdb-configv1-sql-dbdetails-token-input-field")},Xt=O=>{const{options:{jsonData:h,secureJsonData:T,secureJsonFields:L}}=O,R=(0,D.uniqueId)("influxdb-flux-config");return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:Ue,label:"Organization",htmlFor:`${R}-org`,children:(0,g.jsx)(q.p,{id:`${R}-org`,className:"width-20",value:h.organization||"",onChange:(0,x.PG)(O,"organization"),onBlur:qe})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:Ue,label:"Token",children:(0,g.jsx)(Le.L4,{isConfigured:!!(L&&L.token),value:T?.token||"",label:"Token","aria-label":"Token",className:"width-20",onReset:()=>(0,x.QP)(O,"token"),onChange:(0,x.mn)(O,"token"),onBlur:xt})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:Ue,label:"Default Bucket",children:(0,g.jsx)(q.p,{className:"width-20",placeholder:"default bucket",value:h.defaultBucket||"",onChange:(0,x.PG)(O,"defaultBucket"),onBlur:Ne})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:Ue,label:"Min time interval",tooltip:`A lower limit for the auto group by time interval. Recommended to be set to write frequency,
				for example 1m if your data is written every minute.`,children:(0,g.jsx)(q.p,{className:"width-20",placeholder:"10s",value:h.timeInterval||"",onChange:(0,x.PG)(O,"timeInterval")})})})]})};var Re=b(22803),je=b(63142),ft=b(79233);const He=[{label:"GET",value:"GET"},{label:"POST",value:"POST"}],U=O=>{const{options:h,onOptionsChange:T}=O,{database:L,jsonData:R,secureJsonData:G,secureJsonFields:ee}=h,ce=(0,je.of)(Ye),pe=(0,D.uniqueId)("influxdb-influxql-config");return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Q.F,{severity:"info",title:"Database Access",children:(0,g.jsxs)("p",{children:["Setting the database for this datasource does not deny access to other databases. The InfluxDB query syntax allows switching the database in the query. For example:",(0,g.jsx)("code",{children:"SHOW MEASUREMENTS ON _internal"})," or",(0,g.jsx)("code",{children:'SELECT * FROM "_internal".."database" LIMIT 10'}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),"To support data isolation and security, make sure appropriate permissions are configured in InfluxDB."]})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"Database"}),className:ce.horizontalField,htmlFor:`${pe}-db`,noMargin:!0,children:(0,g.jsx)(q.p,{id:`${pe}-db`,className:"width-20",value:R.dbName??L,onChange:Ee=>{T({...h,database:"",jsonData:{...R,dbName:Ee.currentTarget.value}})},onBlur:ot})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"User"}),className:ce.horizontalField,htmlFor:`${pe}-user`,noMargin:!0,children:(0,g.jsx)(q.p,{id:`${pe}-user`,className:"width-20",value:h.user||"",onChange:(0,x.zX)(O,"user"),onBlur:rt})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"Password"}),className:ce.horizontalField,noMargin:!0,children:(0,g.jsx)(Le.L4,{isConfigured:!!(ee&&ee.password),value:G?.password||"",label:"Password","aria-label":"Password",className:"width-20",onReset:()=>(0,x.QP)(O,"password"),onChange:(0,x.mn)(O,"password"),onBlur:We})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,tooltip:`You can use either GET or POST HTTP method to query your InfluxDB database. The POST
          method allows you to perform heavy requests (with a lots of WHERE clause) while the GET method
          will restrict you and return an error if the query is too large.`,children:"HTTP Method"}),htmlFor:`${pe}-http-method`,className:ce.horizontalField,noMargin:!0,children:(0,g.jsx)(P.l6,{inputId:`${pe}-http-method`,className:"width-20",value:He.find(Ee=>Ee.value===h.jsonData.httpMode),options:He,defaultValue:h.jsonData.httpMode,onChange:(0,x.BD)(O,"httpMode")})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,tooltip:"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example 1m if your data is written every minute.",children:"Min time interval"}),className:ce.horizontalField,noMargin:!0,children:(0,g.jsx)(q.p,{className:"width-20",placeholder:"10s",value:h.jsonData.timeInterval||"",onChange:(0,x.PG)(O,"timeInterval")})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,tooltip:"This time range is used in the query editor's autocomplete to reduce the execution time of tag filter queries.",children:"Autocomplete range"}),className:ce.horizontalField,noMargin:!0,children:(0,g.jsx)(q.p,{className:"width-20",placeholder:"12h",value:h.jsonData.showTagTime||"",onChange:(0,x.PG)(O,"showTagTime")})})]})},Ye=O=>({horizontalField:(0,Re.css)({justifyContent:"initial",margin:`0 ${O.spacing(.5)} ${O.spacing(.5)} 0`})});var Zt=b(21285);const zr=O=>{const{options:h,onOptionsChange:T}=O,{jsonData:L,secureJsonData:R,secureJsonFields:G}=h,ee=(0,je.of)(Se),ce=(0,D.uniqueId)("influxdb-sql-config");return(0,g.jsxs)("div",{children:[(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"Database"}),className:ee.horizontalField,htmlFor:`${ce}-dbName`,children:(0,g.jsx)(q.p,{id:`${ce}-dbName`,className:"width-20","aria-label":"Database or bucket name",value:L.dbName,onChange:pe=>{T({...h,jsonData:{...L,dbName:pe.currentTarget.value}})},onBlur:pt})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"Token"}),className:ee.horizontalField,children:(0,g.jsx)(Le.L4,{label:"Token","aria-label":"Token",className:"width-20",value:R?.token||"",onReset:()=>(0,x.QP)(O,"token"),onChange:(0,x.mn)(O,"token"),isConfigured:!!(G&&G.token),onBlur:nt})}),(0,g.jsx)(M.D,{horizontal:!0,label:(0,g.jsx)(ft.c,{width:Ue,children:"Insecure Connection"}),className:ee.horizontalField,children:(0,g.jsx)(Zt.K,{id:`${ce}-insecure-grpc`,value:L.insecureGrpc??!1,onChange:pe=>{T({...h,jsonData:{...L,insecureGrpc:pe.currentTarget.checked}})}})})]})},Se=O=>({horizontalField:(0,Re.css)({justifyContent:"initial",margin:`0 ${O.spacing(.5)} ${O.spacing(.5)} 0`})}),Me={[B.InfluxQL]:{label:"InfluxQL",value:B.InfluxQL,description:"The InfluxDB SQL-like query language."},[B.SQL]:{label:"SQL",value:B.SQL,description:"Native SQL language. Supported in InfluxDB 3.0"},[B.Flux]:{label:"Flux",value:B.Flux,description:"Supported in InfluxDB 2.x and 1.8+"}},Dt=[Me[B.InfluxQL],Me[B.SQL],Me[B.Flux]];class mt extends z.PureComponent{constructor(h){super(h),this.state={maxSeries:""},this.versionNotice={Flux:"Support for Flux in Grafana is currently in beta",SQL:"Support for SQL in Grafana is currently in alpha"},this.onVersionChanged=T=>{const{options:L,onOptionsChange:R}=this.props;T.value&&st({version:T.value});const G={...L,jsonData:{...L.jsonData,version:T.value}};if(T.value===B.Flux){G.access="proxy",G.basicAuth=!0,G.jsonData.httpMode="POST";const{user:ee,database:ce,...pe}=G;R(pe)}else R(G)},this.state.maxSeries=h.options.jsonData.maxSeries?.toString()||"",this.htmlPrefix=(0,D.uniqueId)("influxdb-config")}renderJsonDataOptions(){switch(this.props.options.jsonData.version){case B.InfluxQL:return(0,g.jsx)(U,{...this.props});case B.Flux:return(0,g.jsx)(Xt,{...this.props});case B.SQL:return(0,g.jsx)(zr,{...this.props});default:return(0,g.jsx)(U,{...this.props})}}render(){const{options:h,onOptionsChange:T}=this.props,L=h.access==="direct";return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(I.n,{children:[(0,g.jsx)("h3",{className:"page-heading",children:"Query language"}),(0,g.jsx)(M.D,{children:(0,g.jsx)(P.l6,{"aria-label":"Query language",className:"width-30",value:Me[h.jsonData.version??B.InfluxQL],options:Dt,defaultValue:Me[B.InfluxQL],onChange:this.onVersionChanged})})]}),h.jsonData.version!==B.InfluxQL&&(0,g.jsx)(Q.F,{severity:"info",title:this.versionNotice[h.jsonData.version],children:(0,g.jsxs)("p",{children:["Please report any issues to: ",(0,g.jsx)("br",{}),(0,g.jsx)("a",{href:"https://github.com/grafana/grafana/issues/new/choose",children:"https://github.com/grafana/grafana/issues"})]})}),L&&(0,g.jsx)(Q.F,{title:"Error",severity:"error",children:oe}),(0,g.jsx)(Z.t,{showAccessOptions:L,dataSourceConfig:h,defaultUrl:"http://localhost:8086",onChange:T,secureSocksDSProxyEnabled:j.$.secureSocksDSProxyEnabled}),(0,g.jsxs)(I.n,{children:[(0,g.jsx)("h3",{className:"page-heading",children:"InfluxDB Details"}),this.renderJsonDataOptions(),(0,g.jsx)(k.I,{labelWidth:20,label:"Max series",tooltip:"Limit the number of series/tables that Grafana will process. Lower this number to prevent abuse, and increase it if you have lots of small time series and not all are shown. Defaults to 1000.",children:(0,g.jsx)(q.p,{placeholder:"1000",type:"number",className:"width-20",value:this.state.maxSeries,onChange:R=>{this.setState({maxSeries:R.currentTarget.value});const G=parseInt(R.currentTarget.value,10);(0,x.lO)(this.props,"maxSeries",Number.isFinite(G)?G:void 0)}})})]})]})}}const sr=null;var wr=b(41654),Ce=b(31286),Kr=b(89640),La=b(74475),qr=b(66404),Pe=b(35137),jn=b(43243),Vt=b(51898),tr=b(70985);const mr=[{label:"Enabled",value:!0},{label:"Disabled",value:!1}],Et=[{label:"No Authentication",value:tr.q.NoAuth},{label:"Basic Authentication",value:tr.q.BasicAuth},{label:"Forward OAuth Identity",value:tr.q.OAuthForward}],In=[{label:"URL and authentication",id:"url",isOpen:!0},{label:"Database settings",id:"tls",isOpen:!0},{label:"Save & test",id:`${Vt.Tp.pages.DataSource.saveAndTest}`,isOpen:!0}],sn=[{label:"URL and authentication",id:"url",isOpen:!0},{label:"Database settings",id:"tls",isOpen:!0},{label:"Private data source connect",id:"pdc",isOpen:!0},{label:"Save & test",id:`${Vt.Tp.pages.DataSource.saveAndTest}`,isOpen:!0}],yr=[{label:"POST",value:"POST"},{label:"GET",value:"GET"}],An=(O,h=!1,T)=>({label:(0,Re.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:O.spacing(0,1),fontWeight:O.typography.fontWeightMedium,fontSize:O.typography.size.md,backgroundColor:h?"transparent":O.colors.background.secondary,height:O.spacing(O.components.height.md),lineHeight:O.spacing(O.components.height.md),marginRight:O.spacing(.5),borderRadius:O.shape.radius.default,border:"none",width:"240px",color:O.colors.text.primary})}),_n=()=>{(0,Ie.rR)("influxdb-config-v2-feedback-button-clicked")},hi=()=>{(0,Ie.rR)("influxdb-config-v2-url-input-field")},ca=O=>{(0,Ie.rR)("influxdb-config-v2-query-language-dropdown",O)},ea=O=>{(0,Ie.rR)("influxdb-config-v2-product-selection-dropdown",O)},da=()=>{(0,Ie.rR)("influxdb-config-v2-flux-dbdetails-org-input-field")},Ra=()=>{(0,Ie.rR)("influxdb-config-v2-flux-dbdetails-default-bucket-input-field")},Zi=()=>{(0,Ie.rR)("influxdb-config-v2-flux-dbdetails-token-input-field")},eo=()=>{(0,Ie.rR)("influxdb-config-v2-influxql-dbdetails-database-input-field")},Dr=()=>{(0,Ie.rR)("influxdb-config-v2-influxql-dbdetails-user-input-field")},to=()=>{(0,Ie.rR)("influxdb-config-v2-influxql-dbdetails-password-input-field")},Qt=()=>{(0,Ie.rR)("influxdb-config-v2-sql-dbdetails-database-input-field")},mi=()=>{(0,Ie.rR)("influxdb-config-v2-sql-dbdetails-token-input-field")},jr=()=>{(0,Ie.rR)("influxdb-config-v2-advanceddb-settings-toggle-clicked")},fa=()=>{(0,Ie.rR)("influxdb-config-v2-advanceddb-settings-http-method-clicked")},ur=()=>{(0,Ie.rR)("influxdb-config-v2-advanceddb-settings-insecure-connection-clicked")},un=()=>{(0,Ie.rR)("influxdb-config-v2-advanceddb-settings-min-time-clicked")},ta=()=>{(0,Ie.rR)("influxdb-config-v2-advanced-http-settings-toggle-clicked")},pa=()=>{(0,Ie.rR)("influxdb-config-v2-advanced-http-settings-timeout-field")},ro=()=>{(0,Ie.rR)("influxdb-config-v2-auth-settings-toggle-clicked")},ja=O=>{(0,Ie.rR)("influxdb-config-v2-advanced-http-settings-timeout-field",O)},yi=O=>{const{options:h}=O,T=(0,je.of)(An),[L,R]=(0,z.useState)(()=>!!h.jsonData.timeInterval||!!h.jsonData.insecureGrpc);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Pe.$,{v:2}),(0,g.jsx)(k.I,{label:(0,g.jsx)("div",{className:(0,Re.cx)(T.label),children:"Advanced Database Settings"}),labelWidth:40,children:(0,g.jsx)(Zt.K,{"data-testid":"influxdb-v2-config-toggle-switch",value:L,onChange:()=>R(!L),onBlur:jr})}),L&&(0,g.jsxs)(g.Fragment,{children:[h.jsonData.version===B.InfluxQL&&(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"HTTP Method",labelWidth:30,tooltip:`You can use either GET or POST HTTP method to query your InfluxDB database. The POST
                        method allows you to perform heavy requests (with a lots of WHERE clause) while the GET method
                        will restrict you and return an error if the query is too large.`,children:(0,g.jsx)(jn.G,{width:30,value:yr.find(G=>G.value===h.jsonData.httpMode),options:yr,onChange:(0,x.BD)(O,"httpMode"),onBlur:fa,"data-testid":"influxdb-v2-config-http-method-select"})})}),h.jsonData.version===B.SQL&&(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Insecure Connection",labelWidth:30,children:(0,g.jsx)(Zt.K,{"data-testid":"influxdb-v2-config-insecure-switch",value:h.jsonData.insecureGrpc??!1,onChange:(0,x.EX)(O,"insecureGrpc"),onBlur:ur})})}),(h.jsonData.version===B.InfluxQL||h.jsonData.version===B.Flux)&&(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Min time interval",labelWidth:30,tooltip:"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example 1m if your data is written every minute.",children:(0,g.jsx)(q.p,{className:"width-15","data-testid":"influxdb-v2-config-time-interval",onBlur:un,onChange:(0,x.PG)(O,"timeInterval"),placeholder:"10s",value:h.jsonData.timeInterval||""})})})]})]})},Un=O=>{const{options:{jsonData:h,secureJsonData:T,secureJsonFields:L}}=O;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Organization",labelWidth:30,grow:!0,children:(0,g.jsx)(q.p,{id:"organization",placeholder:"myorg",onBlur:da,onChange:(0,x.PG)(O,"organization"),value:h.organization||""})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:30,label:"Default Bucket",grow:!0,children:(0,g.jsx)(q.p,{id:"default-bucket",onBlur:Ra,onChange:(0,x.PG)(O,"defaultBucket"),placeholder:"mybucket",value:h.defaultBucket||""})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:30,label:"Token",grow:!0,children:(0,g.jsx)(Le.L4,{id:"token",isConfigured:!!(L&&L.token),onBlur:Zi,onChange:(0,x.mn)(O,"token"),onReset:()=>(0,x.QP)(O,"token"),value:T?.token||""})})})]})},tn=O=>{const{options:h}=O;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Database",labelWidth:30,grow:!0,children:(0,g.jsx)(q.p,{id:"database",placeholder:"mydb",value:h.jsonData.dbName,onChange:(0,x.PG)(O,"dbName"),onBlur:eo})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"User",labelWidth:30,grow:!0,children:(0,g.jsx)(q.p,{id:"user",placeholder:"myuser",value:h.user||"",onChange:(0,x.zX)(O,"user"),onBlur:Dr})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Password",labelWidth:30,grow:!0,children:(0,g.jsx)(Le.L4,{id:"password",isConfigured:!!(h.secureJsonFields&&h.secureJsonFields.password),value:h.secureJsonData?.password||"",onReset:()=>(0,x.QP)(O,"password"),onChange:(0,x.mn)(O,"password"),onBlur:to})})})]})},ra=O=>{const{options:h}=O,{secureJsonData:T,secureJsonFields:L}=h;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Database",labelWidth:30,grow:!0,children:(0,g.jsx)(q.p,{id:"database",placeholder:"mydb",value:h.jsonData.dbName,onChange:(0,x.PG)(O,"dbName"),onBlur:Qt})})}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{labelWidth:30,label:"Token",grow:!0,children:(0,g.jsx)(Le.L4,{id:"token",isConfigured:!!(L&&L.token),onBlur:mi,onChange:(0,x.mn)(O,"token"),onReset:()=>(0,x.QP)(O,"token"),value:T?.token||""})})})]})},ln=({options:O,onOptionsChange:h})=>(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(Ce.a,{borderStyle:"solid",borderColor:"weak",padding:2,marginBottom:4,id:`${In[1].id}`,children:(0,g.jsxs)(La.M,{label:(0,g.jsxs)(qr.E,{element:"h3",children:["2. ",In[1].label]}),isOpen:In[1].isOpen,children:[!O.jsonData.version&&(0,g.jsx)(Q.F,{severity:"info",title:"Query language required",children:(0,g.jsx)("p",{children:"To view connection settings, first choose a query language in the URL and Connection section."})}),O.jsonData.version===B.InfluxQL&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(Q.F,{severity:"info",title:"Database Access",children:(0,g.jsxs)("p",{children:["Setting the database for this datasource does not deny access to other databases. The InfluxDB query syntax allows switching the database in the query. For example:",(0,g.jsx)("code",{children:"SHOW MEASUREMENTS ON _internal"})," or",(0,g.jsx)("code",{children:'SELECT * FROM "_internal".."database" LIMIT 10'}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),"To support data isolation and security, make sure appropriate permissions are configured in InfluxDB."]})})}),O.jsonData.version&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(qr.E,{color:"secondary",children:"Provide the necessary database connection details based on your selected InfluxDB product and query language."}),(0,g.jsx)(Pe.$,{v:2})]}),(0,g.jsxs)(g.Fragment,{children:[O.jsonData.version===B.InfluxQL&&(0,g.jsx)(tn,{options:O,onOptionsChange:h}),O.jsonData.version===B.Flux&&(0,g.jsx)(Un,{options:O,onOptionsChange:h}),O.jsonData.version===B.SQL&&(0,g.jsx)(ra,{options:O,onOptionsChange:h}),O.jsonData.version&&(0,g.jsx)(yi,{options:O,onOptionsChange:h})]})]})})});var En=b(45861);const Sn=({pdcInjected:O})=>{const h=O?sn:In;return(0,g.jsx)(wr.B,{children:(0,g.jsxs)(Ce.a,{flex:1,marginY:5,children:[(0,g.jsx)(qr.E,{element:"h4",children:"InfluxDB"}),(0,g.jsx)(Ce.a,{paddingTop:2,children:h.map((T,L)=>(0,g.jsxs)("div",{"data-testid":`${T.label}-sidebar`,children:[(0,g.jsx)(k.I,{label:`${L+1}`,style:{display:"flex",alignItems:"center"},grow:!0,children:(0,g.jsx)(En.z9,{variant:"secondary",fill:"text",onClick:R=>{R.preventDefault();const G=document.getElementById(T.id);G&&G.scrollIntoView({behavior:"smooth",block:"start"})},children:T.label})}),(0,g.jsx)(Pe.$,{v:1})]},L))})]})})};var Lt=b(10928),cn=b(55803);const no=({options:O,onOptionsChange:h})=>{const T=(0,je.of)(An),[L,R]=(0,z.useState)(()=>"keepCookies"in O.jsonData||"timeout"in O.jsonData);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Ce.a,{display:"flex",alignItems:"center",children:(0,g.jsx)(k.I,{label:(0,g.jsx)("div",{className:(0,Re.cx)(T.label),children:"Advanced HTTP Settings"}),labelWidth:40,children:(0,g.jsx)(Zt.K,{"data-testid":"influxdb-v2-config-advanced-http-settings-toggle",value:L,onChange:()=>R(!L),onBlur:ta})})}),L&&O.access==="proxy"&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(Ce.a,{paddingLeft:1,marginY:1,children:[(0,g.jsx)(Ce.a,{width:"50%",marginBottom:2,children:(0,g.jsx)(M.D,{label:"Allowed cookies",description:`Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should
                be forwarded to the data source.`,disabled:O.readOnly,noMargin:!0,children:(0,g.jsx)(Lt.u,{id:"advanced-http-cookies",placeholder:"New cookie (hit enter to add)",tags:"keepCookies"in O.jsonData&&Array.isArray(O.jsonData.keepCookies)?O.jsonData.keepCookies:[],onChange:G=>{h({...O,jsonData:{...O.jsonData,keepCookies:G}})}})})}),(0,g.jsx)(Ce.a,{width:"50%",marginBottom:2,children:(0,g.jsx)(M.D,{htmlFor:"advanced-http-timeout",label:"Timeout",description:"HTTP request timeout in seconds.",disabled:O.readOnly,noMargin:!0,children:(0,g.jsx)(q.p,{id:"advanced-http-timeout",type:"number",min:0,placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:"timeout"in O.jsonData&&typeof O.jsonData.timeout=="number"?O.jsonData.timeout.toString():"",onChange:G=>{const ee=parseInt(G.currentTarget.value,10);h({...O,jsonData:{...O.jsonData,timeout:ee}})},onBlur:pa})})}),L&&(0,g.jsx)(cn.P,{dataSourceConfig:O,onChange:h})]})})]})};var za=b(76229),At=b(77824),vt=b(72636),jt=b(45558);const Hr=O=>{const{options:h,onOptionsChange:T}=O,L=(0,je.of)(An),R=(0,z.useMemo)(()=>(0,za.pe)({config:h,onChange:T}),[h,T]),G=St=>St===tr.q.NoAuth||St===tr.q.BasicAuth||St===tr.q.OAuthForward,ee=(0,z.useMemo)(()=>G(R.selectedMethod)?R.selectedMethod:G(R.mostCommonMethod)?R.mostCommonMethod:void 0,[R.selectedMethod,R.mostCommonMethod]),[ce,pe]=(0,z.useState)({basicAuth:ee===tr.q.BasicAuth,tlsClientAuth:R.TLS?.TLSClientAuth.enabled??!1,caCert:R.TLS?.selfSignedCertificate.enabled??!1,skipTLS:R.TLS?.skipTLSVerification.enabled??!1,oAuthForward:ee===tr.q.OAuthForward,withCredentials:h.withCredentials??!1}),[Ee,Be]=(0,z.useState)(Object.values(ce).some(Boolean)),be=(0,z.useCallback)(()=>{Be(St=>(ro(),!St))},[]),Ft=(0,z.useCallback)(St=>{R.onAuthMethodSelect(St),pe(Gt=>({...Gt,basicAuth:St===tr.q.BasicAuth,oAuthForward:St===tr.q.OAuthForward})),ja({authMethod:St})},[R]),Qe=(0,z.useCallback)((St,Gt)=>{pe(Tt=>{const Rt=!Tt[St],Yr={...Tt,[St]:Rt};return Gt(Rt),Yr})},[]);return(0,g.jsxs)(wr.B,{direction:"column",children:[(0,g.jsx)(Ce.a,{alignItems:"center",children:(0,g.jsx)(k.I,{label:(0,g.jsx)("div",{className:(0,Re.cx)(L.label),children:"Auth and TLS/SSL Settings"}),labelWidth:35,children:(0,g.jsx)(Zt.K,{"data-testid":"influxdb-v2-config-auth-settings-toggle",value:Ee,onChange:be})})}),Ee&&(0,g.jsxs)(Ce.a,{paddingLeft:1,children:[(0,g.jsx)(Ce.a,{marginBottom:2,children:(0,g.jsx)(M.D,{label:(0,g.jsx)(qr.E,{element:"h5",children:"Authentication Method"}),noMargin:!0,children:(0,g.jsx)(Ce.a,{width:"50%",marginY:2,children:(0,g.jsx)(At.z,{options:Et,value:ee,onChange:Ft})})})}),(0,g.jsx)(Ce.a,{marginBottom:2,children:ce.basicAuth&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(Ce.a,{display:"flex",direction:"column",width:"60%",marginBottom:2,children:[(0,g.jsx)(k.I,{label:"User",labelWidth:14,grow:!0,children:(0,g.jsx)(q.p,{placeholder:"User",onChange:(0,x.zX)(O,"basicAuthUser"),value:h.basicAuthUser||""})}),(0,g.jsx)(k.I,{label:"Password",labelWidth:14,grow:!0,children:(0,g.jsx)(Le.L4,{placeholder:"Password",isConfigured:h.secureJsonFields.basicAuthPassword||!1,onChange:(0,x.mn)(O,"basicAuthPassword"),onReset:()=>(0,x.QP)(O,"basicAuthPassword"),value:h.secureJsonData?.basicAuthPassword||""})})]})})}),(0,g.jsx)(Ce.a,{marginBottom:2,children:(0,g.jsx)(M.D,{noMargin:!0,children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(qr.E,{element:"h5",children:"TLS Settings"}),(0,g.jsxs)(Ce.a,{display:"flex",alignItems:"center","data-testid":"influxdb-v2-config-auth-settings-tls-client-auth-toggle",marginTop:2,children:[(0,g.jsx)(vt.J,{style:{width:"125px"},children:"TLS Client Auth"}),(0,g.jsx)(At.z,{options:mr,value:ce.tlsClientAuth,onChange:()=>Qe("tlsClientAuth",R.TLS.TLSClientAuth.onToggle),size:"sm"})]}),ce.tlsClientAuth&&(0,g.jsxs)(Ce.a,{marginTop:2,children:[(0,g.jsx)(k.I,{label:"Server Name",labelWidth:14,grow:!0,children:(0,g.jsx)(q.p,{placeholder:"domain.example.com",onChange:St=>R.TLS?.TLSClientAuth.onServerNameChange(St.currentTarget.value),value:R.TLS?.TLSClientAuth.serverName||""})}),(0,g.jsx)(jt.K,{label:"Client Cert",placeholder:"Begins with -----BEGIN CERTIFICATE-----",onChange:St=>R.TLS?.TLSClientAuth.onClientCertificateChange(St.currentTarget.value),hasCert:!!R.TLS?.TLSClientAuth.clientCertificateConfigured,onClick:()=>R.TLS?.TLSClientAuth.onClientCertificateReset()}),(0,g.jsx)(jt.K,{label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:St=>R.TLS?.TLSClientAuth.onClientKeyChange(St.currentTarget.value),hasCert:!!R.TLS?.TLSClientAuth.clientKeyConfigured,onClick:()=>R.TLS?.TLSClientAuth.onClientKeyReset()})]})]})})}),(0,g.jsx)(Ce.a,{marginBottom:2,children:(0,g.jsx)(M.D,{noMargin:!0,children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(Ce.a,{display:"flex",alignItems:"center","data-testid":"influxdb-v2-config-auth-settings-ca-cert-toggle",children:[(0,g.jsx)(vt.J,{style:{width:"125px"},children:"CA Cert"}),(0,g.jsx)(At.z,{options:mr,value:ce.caCert,onChange:()=>Qe("caCert",R.TLS.selfSignedCertificate.onToggle),size:"sm"})]}),ce.caCert&&(0,g.jsx)(Ce.a,{marginTop:3,children:(0,g.jsx)(jt.K,{label:"CA Cert",placeholder:"Begins with -----BEGIN CERTIFICATE-----",onChange:St=>R.TLS?.selfSignedCertificate.onCertificateChange(St.currentTarget.value),hasCert:!!R.TLS?.selfSignedCertificate.certificateConfigured,onClick:()=>R.TLS?.selfSignedCertificate.onCertificateReset()})})]})})}),(0,g.jsxs)(Ce.a,{display:"flex",direction:"row",alignItems:"center",children:[(0,g.jsx)(vt.J,{style:{width:"125px"},children:"Skip TLS Verify"}),(0,g.jsx)(Zt.K,{"data-testid":"influxdb-v2-config-auth-settings-skip-tls-verify",value:ce.skipTLS,onChange:()=>Qe("skipTLS",R.TLS.skipTLSVerification.onToggle)})]})]})]})},$n=[{name:"InfluxDB Cloud Dedicated",queryLanguages:[{name:B.SQL,fields:["Host","Database","Token"]},{name:B.InfluxQL,fields:["Host","Database","Token"]}],detectionMethod:{urlContains:["influxdb.io"]}},{name:"InfluxDB Cloud Serverless",queryLanguages:[{name:B.SQL,fields:["Host","Bucket","Token"]},{name:B.InfluxQL,fields:["Host","Bucket","Token"]},{name:B.Flux,fields:["Host","Organization","Token","Default bucket"]}],detectionMethod:{urlContains:["us-east-1-1.aws.cloud2.influxdata.com","eu-central-1-1.aws.cloud2.influxdata.com"]}},{name:"InfluxDB Clustered",queryLanguages:[{name:B.SQL,fields:["Host","Database","Token"]},{name:B.InfluxQL,fields:["URL","Database","Token"]}],detectionMethod:{pingHeaderResponse:{"x-influxdb-version":"\\s*influxqlbridged-development"}}},{name:"InfluxDB Enterprise 1.x",queryLanguages:[{name:B.InfluxQL,fields:["URL","Database","User","Password"]},{name:B.Flux,fields:["URL","User","Password","Default database"]}],detectionMethod:{pingHeaderResponse:{"x-influxdb-build":"Enterprise (needs confirmation)"}}},{name:"InfluxDB Enterprise 3.x",queryLanguages:[{name:B.SQL,fields:["URL","Token"]},{name:B.InfluxQL,fields:["URL","Token"]}],detectionMethod:{pingHeaderResponse:{"x-influxdb-build":"TBD"}}},{name:"InfluxDB Cloud (TSM)",queryLanguages:[{name:B.InfluxQL,fields:["URL","Database","Token"]},{name:B.Flux,fields:["URL","Organization","Token","Default bucket"]}],detectionMethod:{urlContains:["us-west-2-1.aws.cloud2.influxdata.com","us-west-2-2.aws.cloud2.influxdata.com","us-east-1-1.aws.cloud2.influxdata.com","eu-central-1-1.aws.cloud2.influxdata.com","us-central1-1.gcp.cloud2.influxdata.com","westeurope-1.azure.cloud2.influxdata.com","eastus-1.azure.cloud2.influxdata.com"]}},{name:"InfluxDB Cloud 1",queryLanguages:[{name:B.InfluxQL,fields:["URL","Database","Username","Password"]}],detectionMethod:{urlContains:["influxcloud.net"]}},{name:"InfluxDB OSS 1.x",queryLanguages:[{name:B.InfluxQL,fields:["URL","Database","Username","Password"]},{name:B.Flux,fields:["URL","Username","Password","Default database"]}],detectionMethod:{pingHeaderResponse:{"x-influxdb-build":"OSS","x-influxdb-version":"^1\\."}}},{name:"InfluxDB OSS 2.x",queryLanguages:[{name:B.InfluxQL,fields:["URL","Database",{type:"Basic",fields:["Username","Password"]},{type:"Token",fields:["Token"]}]},{name:B.Flux,fields:["URL","Token","Default bucket"]}],detectionMethod:{pingHeaderResponse:{"x-influxdb-build":"OSS","x-influxdb-version":"^2\\."}}}],na=O=>$n.find(({name:T})=>T===O)?.queryLanguages?.map(({name:T})=>({value:T}))??[],Ka=O=>{const{options:h,onOptionsChange:T}=O,L=pe=>typeof pe=="string"&&(pe===B.Flux||pe===B.InfluxQL||pe===B.SQL),R=h.jsonData.product&&h.jsonData.version===B.InfluxQL&&["InfluxDB OSS 1.x","InfluxDB OSS 2.x","InfluxDB Enterprise 1.x","InfluxDB Cloud (TSM)","InfluxDB Cloud Serverless"].includes(h.jsonData.product),G=({value:pe})=>{ea({product:pe}),T({...h,jsonData:{...h.jsonData,product:pe,version:void 0}})},ee=pe=>{const{value:Ee}=pe;ca({version:Ee}),L(Ee)&&(0,x.BD)(O,"version")(pe)},ce=pe=>(0,x.zX)(O,"url")(pe);return(0,g.jsx)(Ce.a,{borderStyle:"solid",borderColor:"weak",padding:2,marginBottom:4,id:`${In[0].id}`,children:(0,g.jsxs)(La.M,{label:(0,g.jsxs)(qr.E,{element:"h3",children:["1. ",In[0].label]}),isOpen:In[0].isOpen,children:[(0,g.jsxs)(qr.E,{color:"secondary",children:["Enter the URL of your InfluxDB instance, then select your product and query language. This will determine the available settings and authentication methods in the next steps. If you are unsure what product you are using, view the"," ",(0,g.jsx)(Kr.Y,{href:"https://docs.influxdata.com/",external:!0,children:"InfluxDB Docs."}),"."]}),(0,g.jsxs)(Ce.a,{direction:"column",gap:2,marginTop:3,children:[(0,g.jsx)(M.D,{label:(0,g.jsx)("div",{style:{marginBottom:"5px"},children:"URL"}),noMargin:!0,children:(0,g.jsx)(q.p,{"data-testid":"influxdb-v2-config-url-input",placeholder:"http://localhost:3000/",onChange:ce,value:h.url||"",onBlur:hi})}),(0,g.jsx)(Ce.a,{marginTop:2,children:(0,g.jsxs)(wr.B,{direction:"row",gap:2,children:[(0,g.jsx)(Ce.a,{flex:1,children:(0,g.jsx)(M.D,{label:(0,g.jsx)("div",{style:{marginBottom:"5px"},children:"Product"}),noMargin:!0,children:(0,g.jsx)(jn.G,{"data-testid":"influxdb-v2-config-product-select",value:h.jsonData.product,options:$n.map(({name:pe})=>({value:pe})),onChange:G})})}),(0,g.jsx)(Ce.a,{flex:1,children:(0,g.jsx)(M.D,{label:(0,g.jsx)("div",{style:{marginBottom:"5px"},children:"Query language"}),noMargin:!0,children:(0,g.jsx)(jn.G,{"data-testid":"influxdb-v2-config-query-language-select",value:h.jsonData.product!==""?h.jsonData.version:"",options:na(h.jsonData.product||""),onChange:ee})})})]})}),(0,g.jsx)(Pe.$,{v:2}),R&&(0,g.jsxs)(Q.F,{severity:"warning",title:"InfluxQL requires DBRP mapping",children:["InfluxDB OSS 1.x and 2.x users must configure a Database + Retention Policy (DBRP) mapping via the CLI or API before data can be queried."," ",(0,g.jsx)(Kr.Y,{href:"https://docs.influxdata.com/influxdb/cloud/query-data/influxql/dbrp/",external:!0,children:"Learn how to set this up"})]}),(0,g.jsx)(no,{options:h,onOptionsChange:T}),(0,g.jsx)(Hr,{options:h,onOptionsChange:T})]})]})})},va=({onOptionsChange:O,options:h})=>(0,g.jsxs)(wr.B,{justifyContent:"space-between",children:[(0,g.jsx)(Ce.a,{width:"250px",flex:"0 0 250px",children:(0,g.jsx)(Sn,{pdcInjected:h?.jsonData?.pdcInjected})}),(0,g.jsx)(Ce.a,{width:"60%",flex:"1 1 auto",children:(0,g.jsxs)(wr.B,{direction:"column",children:[(0,g.jsx)(Q.F,{severity:"info",title:"You are viewing a new design for the InfluxDB configuration settings.",children:(0,g.jsxs)(g.Fragment,{children:["If something isn't working correctly, you can revert to the original configuration page design by disabling the ",(0,g.jsx)("code",{children:"newInfluxDSConfigPageDesign"})," feature flag."," ",(0,g.jsx)(Kr.Y,{href:"https://docs.google.com/forms/d/e/1FAIpQLSdi-zyX3c51vh937UKhNYYxhljUnFi6dQSlZv50mES9NrK-ig/viewform",external:!0,onClick:_n,children:"Submit feedback."})]})}),(0,g.jsx)(Ka,{options:h,onOptionsChange:O}),(0,g.jsx)(ln,{options:h,onOptionsChange:O})]})}),(0,g.jsx)(Ce.a,{width:"20%",flex:"0 0 20%"})]});var Pt=b(8934),at=b(56355);const pr=[],ct={Aggregations:[],Selectors:[],Transformations:[],Predictors:[],Math:[],Aliasing:[],Fields:[]};function dn(O){const h=pr[O.type];if(!h)throw{message:"Could not find query part "+O.type};return new at.kW(O,h)}function Ot(O){pr[O.type]=new at.tI(O),O.category.push(pr[O.type])}const wn=[];function lt(O,h){return h+' AS "'+O.params[0]+'"'}function Pr(O){const h=O.params[0];if(h==="*")return"*";let T=`"${h}"`;return h.endsWith("::tag")&&(T=`"${h.slice(0,-5)}"::tag`),h.endsWith("::field")&&(T=`"${h.slice(0,-7)}"::field`),T}function te(O,h){for(let T=0;T<O.length;T++){const L=O[T];if(L.def.category===ct.Aggregations){if(L.def.type===h.def.type)return;if(L.def.type==="count"&&h.def.type==="distinct")break;if(L.def.type==="distinct"){const R=O.length>=T+2;if(h.def.type!=="count"&&R)O[T+1].def.category===ct.Aggregations&&O.splice(T+1,1);else if(h.def.type==="count"){(!R||O[T+1].def.type!=="count")&&O.splice(T+1,0,h);return}}O[T]=h;return}if(L.def.category===ct.Selectors){O[T]=h;return}}O.splice(1,0,h)}function ge(O,h){let T;for(T=0;T<O.length;T++){const L=O[T];if(L.def.category===ct.Math||L.def.category===ct.Aliasing)break}O.splice(T,0,h)}function Ae(O,h){const T=O.length;if(T>0){if(O[T-1].def.type==="math"){O[T-1]=h;return}if(T>1&&O[T-2].def.type==="math"){O[T-2]=h;return}else if(O[T-1].def.type==="alias"){O.splice(T-1,0,h);return}}O.push(h)}function gt(O,h){const T=O.length;if(T>0&&O[T-1].def.type==="alias"){O[T-1]=h;return}O.push(h)}function Qr(O,h,T){const L=(0,D.map)(O,R=>dn({type:R.def.type,params:(0,D.clone)(R.params)}));T.selectModels.push(L)}Ot({type:"field",addStrategy:Qr,category:ct.Fields,params:[{type:"field",dynamicLookup:!0}],defaultParams:["value"],renderer:Pr}),Ot({type:"count",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"distinct",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"integral",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"mean",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"median",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"mode",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"sum",addStrategy:te,category:ct.Aggregations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"derivative",addStrategy:ge,category:ct.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:at.Wn}),Ot({type:"spread",addStrategy:ge,category:ct.Transformations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"non_negative_derivative",addStrategy:ge,category:ct.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:at.Wn}),Ot({type:"difference",addStrategy:ge,category:ct.Transformations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"non_negative_difference",addStrategy:ge,category:ct.Transformations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"moving_average",addStrategy:ge,category:ct.Transformations,params:[{name:"window",type:"int",options:[5,10,20,30,40]}],defaultParams:[10],renderer:at.Wn}),Ot({type:"cumulative_sum",addStrategy:ge,category:ct.Transformations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"stddev",addStrategy:ge,category:ct.Transformations,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"time",category:wn,params:[{name:"interval",type:"time",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["$__interval"],renderer:at.Wn}),Ot({type:"fill",category:wn,params:[{name:"fill",type:"string",options:["none","null","0","previous","linear"]}],defaultParams:["null"],renderer:at.Wn}),Ot({type:"elapsed",addStrategy:ge,category:ct.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:at.Wn}),Ot({type:"holt_winters",addStrategy:ge,category:ct.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:at.Wn}),Ot({type:"holt_winters_with_fit",addStrategy:ge,category:ct.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:at.Wn}),Ot({type:"bottom",addStrategy:te,category:ct.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:at.Wn}),Ot({type:"first",addStrategy:te,category:ct.Selectors,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"last",addStrategy:te,category:ct.Selectors,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"max",addStrategy:te,category:ct.Selectors,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"min",addStrategy:te,category:ct.Selectors,params:[],defaultParams:[],renderer:at.Wn}),Ot({type:"percentile",addStrategy:te,category:ct.Selectors,params:[{name:"nth",type:"int"}],defaultParams:[95],renderer:at.Wn}),Ot({type:"top",addStrategy:te,category:ct.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:at.Wn}),Ot({type:"tag",category:wn,params:[{name:"tag",type:"string",dynamicLookup:!0}],defaultParams:["tag"],renderer:Pr}),Ot({type:"math",addStrategy:Ae,category:ct.Math,params:[{name:"expr",type:"string"}],defaultParams:[" / 100"],renderer:at.Dw}),Ot({type:"alias",addStrategy:gt,category:ct.Aliasing,params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"],renderMode:"suffix",renderer:lt});const dr={create:dn,getCategories:()=>ct,replaceAggregationAdd:te};class xn{constructor(h,T,L){this.selectModels=[],this.groupByParts=[],this.target=h,this.templateSrv=T,this.scopedVars=L,h.policy=h.policy||Te,h.resultFormat=h.resultFormat||"time_series",h.orderByTime=h.orderByTime||"ASC",h.tags=h.tags||[],h.groupBy=h.groupBy||[{type:"time",params:["$__interval"]},{type:"fill",params:["null"]}],h.select=h.select||[[{type:"field",params:["value"]},{type:"mean",params:[]}]],this.updateProjection()}updateProjection(){this.selectModels=(0,D.map)(this.target.select,h=>(0,D.map)(h,dr.create)),this.groupByParts=(0,D.map)(this.target.groupBy,dr.create)}updatePersistedParts(){this.target.select=(0,D.map)(this.selectModels,h=>(0,D.map)(h,T=>({type:T.def.type,params:T.params})))}hasGroupByTime(){return(0,D.find)(this.target.groupBy,h=>h.type==="time")}hasFill(){return(0,D.find)(this.target.groupBy,h=>h.type==="fill")}addGroupBy(h){let T=h.match(/^(\w+)\((.*)\)$/);if(!T||!this.target.groupBy)return;const L=T[1],R=T[2],G=dr.create({type:L,params:[R]}),ee=this.target.groupBy.length;ee===0?this.target.groupBy.push(G.part):L==="time"?this.target.groupBy.splice(0,0,G.part):L==="tag"?this.target.groupBy[ee-1].type==="fill"?this.target.groupBy.splice(ee-1,0,G.part):this.target.groupBy.push(G.part):this.target.groupBy.push(G.part),this.updateProjection()}removeGroupByPart(h,T){const L=dr.getCategories();h.def.type==="time"&&(this.target.groupBy=(0,D.filter)(this.target.groupBy,R=>R.type!=="fill"),this.target.select=(0,D.map)(this.target.select,R=>(0,D.filter)(R,G=>{const ee=dr.create(G);return!(ee.def.category===L.Aggregations||ee.def.category===L.Selectors)}))),this.target.groupBy.splice(T,1),this.updateProjection()}removeSelect(h){this.target.select.splice(h,1),this.updateProjection()}removeSelectPart(h,T){if(T.def.type==="field"){if(this.selectModels.length>1){const L=(0,D.indexOf)(this.selectModels,h);this.selectModels.splice(L,1)}}else{const L=(0,D.indexOf)(h,T);h.splice(L,1)}this.updatePersistedParts()}addSelectPart(h,T){const L=dr.create({type:T});L.def.addStrategy(h,L,this),this.updatePersistedParts()}isOperatorTypeHandler(h,T,L){let R;if(h==="Is Not"?h="!=":h="=",L.endsWith("::tag"))return R="'"+Nr(T.replace(/\\/g,"\\\\").replace(/\'/g,"\\'"))+"'",{operator:h,value:R};let G=T.toLowerCase();return isNaN(parseFloat(T))?["true","false"].includes(G)?R=G:R="'"+Nr(T.replace(/\\/g,"\\\\").replace(/\'/g,"\\'"))+"'":R=T,{operator:h,value:R}}renderTagCondition(h,T,L){let R="",G=h.operator,ee=h.value;if(T>0&&(R=(h.condition||"AND")+" "),G||(/^\/.*\/$/.test(ee)?G="=~":G="="),G!=="=~"&&G!=="!~")if(L&&(ee=this.templateSrv.replace(ee,this.scopedVars)),ee=Nr(ee),G.startsWith("Is")){let pe=this.isOperatorTypeHandler(G,ee,h.key);G=pe.operator,ee=pe.value}else(!G.startsWith(">")&&!G.startsWith("<")||G==="<>")&&(ee="'"+ee.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")+"'");else L&&(ee=this.templateSrv.replace(ee,this.scopedVars,"regex"));let ce=`"${h.key}"`;return h.key.endsWith("::tag")&&(ce=`"${h.key.slice(0,-5)}"::tag`),h.key.endsWith("::field")&&(ce=`"${h.key.slice(0,-7)}"::field`),R+ce+" "+G+" "+ee}getMeasurementAndPolicy(h){let T=this.target.policy,L=this.target.measurement||"measurement";return L.match("^/.*/$")?h&&(L=this.templateSrv.replace(L,this.scopedVars,"regex")):L='"'+L+'"',T!==Te?T='"'+this.target.policy+'".':T="",T+L}interpolateQueryStr(h,T){return!T.multi&&!T.includeAll?h:typeof h=="string"?(0,Pt.$f)(h):"("+(0,D.map)(h,Pt.$f).join("|")+")"}render(h){const T=this.target;if(T.rawQuery)return h?this.templateSrv.replace(T.query,this.scopedVars,this.interpolateQueryStr):T.query;let L="SELECT ",R,G;for(R=0;R<this.selectModels.length;R++){const pe=this.selectModels[R];let Ee="";for(G=0;G<pe.length;G++)Ee=pe[G].render(Ee);R>0&&(L+=", "),L+=Ee}L+=" FROM "+this.getMeasurementAndPolicy(h)+" WHERE ";const ee=(0,D.map)(T.tags,(pe,Ee)=>this.renderTagCondition(pe,Ee,h));ee.length>0&&(L+="("+ee.join(" ")+") AND "),L+="$timeFilter";let ce="";for(R=0;R<this.groupByParts.length;R++){const pe=this.groupByParts[R];R>0&&(ce+=pe.def.type==="fill"?" ":", "),ce+=pe.render("")}return ce.length&&(L+=" GROUP BY "+ce),T.fill&&(L+=" fill("+T.fill+")"),T.orderByTime==="DESC"&&(L+=" ORDER BY time DESC"),T.limit&&(L+=" LIMIT "+T.limit),T.slimit&&(L+=" SLIMIT "+T.slimit),T.tz&&(L+=" tz('"+T.tz+"')"),L}renderAdhocFilters(h){return(0,D.map)(h,(L,R)=>this.renderTagCondition(L,R,!0)).join(" ")}}function Ho(O){const h=(0,D.cloneDeep)(O);return new xn(h).render(!1)}function ao(O){if(O.policy!==void 0&&O.resultFormat!==void 0&&O.orderByTime!==void 0&&O.tags!==void 0&&O.groupBy!==void 0&&O.select!==void 0)return O;const h=(0,D.cloneDeep)(O);return new xn(h).target}function Qo(O,h,T){const L=(0,D.cloneDeep)(O),R=new xn(L);return R.addSelectPart(R.selectModels[T],h),R.target}function Jo(O,h,T){const L=(0,D.cloneDeep)(O),R=new xn(L),G=R.selectModels[T];return R.removeSelectPart(G,G[h]),R.target}function Ir(O,h,T,L){const R=[...O.select??[]];return R[h]=[...R[h]],R[h][T]={...R[h][T],params:L},{...O,select:R}}function Si(O,h){const T=(0,D.cloneDeep)(O),L=new xn(T);return L.addGroupBy(h),L.target}function io(O,h){const T=(0,D.cloneDeep)(O),L=new xn(T);return L.removeGroupByPart(L.groupByParts[h],h),L.target}function nc(O,h,T){const L=[...O.groupBy??[]];return L[h]={...L[h],params:T},{...O,groupBy:L}}function Nr(O){const h=/\/\^(.*?)\$\//,T=O.match(h);return T&&T.length>1?T[1]:O}var Ia=b(2863),qa=b(78193),ac=b(50992),Yo=b(61875),ga=b(51115);const ic=[{label:"Show buckets",description:"List the available buckets (table)",value:"buckets()"},{label:"Simple query",description:"filter by measurement and field",value:`from(bucket: "db/rp")
  |> range(start: v.timeRangeStart, stop:v.timeRangeStop)
  |> filter(fn: (r) =>
    r._measurement == "example-measurement" and
    r._field == "example-field"
  )`},{label:"Grouped Query",description:"Group by (min/max/sum/median)",value:`// v.windowPeriod is a variable referring to the current optimized window period (currently: $interval)
from(bucket: v.bucket)
  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)
  |> filter(fn: (r) => r["_measurement"] == "measurement1" or r["_measurement"] =~ /^.*?regex.*$/)
  |> filter(fn: (r) => r["_field"] == "field2" or r["_field"] =~ /^.*?regex.*$/)
  |> aggregateWindow(every: v.windowPeriod, fn: mean|median|max|count|derivative|sum)
  |> yield(name: "some-name")`},{label:"Filter by value",description:"Results between a min/max",value:`// v.bucket, v.timeRangeStart, and v.timeRange stop are all variables supported by the flux plugin and influxdb
from(bucket: v.bucket)
  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)
  |> filter(fn: (r) => r["_value"] >= 10 and r["_value"] <= 20)`},{label:"Schema Exploration: (measurements)",description:"Get a list of measurement using flux",value:`import "influxdata/influxdb/v1"
v1.measurements(bucket: v.bucket)`},{label:"Schema Exploration: (fields)",description:"Return every possible key in a single table",value:`from(bucket: v.bucket)
  |> range(start: v.timeRangeStart, stop:v.timeRangeStop)
  |> keys()
  |> keep(columns: ["_value"])
  |> group()
  |> distinct()`},{label:"Schema Exploration: (tag keys)",description:"Get a list of tag keys using flux",value:`import "influxdata/influxdb/v1"
v1.tagKeys(bucket: v.bucket)`},{label:"Schema Exploration: (tag values)",description:"Get a list of tag values using flux",value:`import "influxdata/influxdb/v1"
v1.tagValues(
    bucket: v.bucket,
    tag: "host",
    predicate: (r) => true,
    start: -1d
)`}];class vu extends z.PureComponent{constructor(){super(...arguments),this.onFluxQueryChange=h=>{this.props.onChange({...this.props.query,query:h})},this.onSampleChange=h=>{this.props.onChange({...this.props.query,query:h.value}),this.forceUpdate()},this.getSuggestions=()=>{const h=[{label:"v.timeRangeStart",kind:qa.q.Property,detail:"The start time"},{label:"v.timeRangeStop",kind:qa.q.Property,detail:"The stop time"},{label:"v.windowPeriod",kind:qa.q.Property,detail:"based on max data points"},{label:"v.defaultBucket",kind:qa.q.Property,detail:"bucket configured in the datsource"},{label:"v.organization",kind:qa.q.Property,detail:"org configured for the datsource"}],T=(0,Ia.w)();return T.getVariables().forEach(L=>{const R="${"+L.name+"}";let G=T.replace(R);G===R&&(G=""),h.push({label:R,kind:qa.q.Text,detail:`(Template Variable) ${G}`})}),h},this.editorDidMountCallbackHack=h=>{setTimeout(()=>h.layout(),100)}}render(){const{query:h,theme:T}=this.props,L=gu(T),R=(0,g.jsxs)("div",{children:["Type: ",(0,g.jsx)("i",{children:"ctrl+space"})," to show template variable suggestions ",(0,g.jsx)("br",{}),"Many queries can be copied from Chronograf"]});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ac.B,{height:"100%",containerStyles:L.editorContainerStyles,language:"sql",value:h.query||"",onBlur:this.onFluxQueryChange,onSave:this.onFluxQueryChange,showMiniMap:!1,showLineNumbers:!0,getSuggestions:this.getSuggestions,onEditorDidMount:this.editorDidMountCallbackHack}),(0,g.jsxs)("div",{className:(0,Re.cx)("gf-form-inline",L.editorActions),children:[(0,g.jsx)(En.z9,{icon:"external-link-alt",variant:"secondary",target:"blank",href:"https://docs.influxdata.com/influxdb/latest/query-data/get-started/",children:"Flux language syntax"}),(0,g.jsx)(Yo.Y,{options:ic,value:"Sample query",onChange:this.onSampleChange,className:(0,Re.css)({marginTop:T.spacing(-.5),marginLeft:T.spacing(.5)})}),(0,g.jsx)("div",{className:"gf-form gf-form--grow",children:(0,g.jsx)("div",{className:"gf-form-label gf-form-label--grow"})}),(0,g.jsx)(ga.I,{width:5,tooltip:R,children:"Help"})]})]})}}const gu=O=>({editorContainerStyles:(0,Re.css)({height:"200px",maxWidth:"100%",resize:"vertical",overflow:"auto",backgroundColor:O.isDark?O.colors.background.canvas:O.colors.background.primary,paddingBottom:O.spacing(1)}),editorActions:(0,Re.css)({marginTop:"6px"})}),Xo=(0,je.cV)(vu);var Zo=b(11194);const hu=[{name:"AVG"},{name:"COUNT"},{name:"MAX"},{name:"MIN"},{name:"SUM"}],Ha={name:"Interval",required:!0,options:()=>Promise.resolve([{label:"$__interval",value:"$__interval"}])},Qa={name:"Fill",required:!1,options:()=>Promise.resolve([{label:"0",value:"0"},{label:"NULL",value:"NULL"},{label:"previous",value:"previous"}])},oc=O=>[{name:"$__timeGroup",description:"Time grouping function",parameters:[O,Ha,Qa]},{name:"$__timeGroupAlias",description:"Time grouping function with time as alias",parameters:[O,Ha,Qa]},{name:"$__time",description:"An expression to rename the column to time",parameters:[O]},{name:"$__timeEpoch",parameters:[O]},{name:"$__unixEpochGroup",parameters:[O,Ha,Qa]},{name:"$__unixEpochGroupAlias",parameters:[O,Ha,Qa]}],es=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var aa=b(13288),Ja=b(75505),bi=b(81160),Oi=b(1906),ts=b(94452),oo=b(22592),mu=b(88673),yu=b(41778),rs=b(36580),so=b(68143),ns=b(38866);class as{transformMetricFindResponse(h){const T=[],L=h.fields.find(G=>G.name==="__text"),R=h.fields.find(G=>G.name==="__value");if(L&&R)for(let G=0;G<L.values.length;G++)T.push({text:""+L.values[G],value:""+R.values[G]});else for(const G of h.fields)for(const ee of G.values)T.push({text:ee});return(0,D.uniqBy)(T,"text")}}var Su=b(92745),sc=b(6975);const uc=(0,z.lazy)(()=>b.e(168).then(b.bind(b,47805)));function bu(O){const h=(0,je.of)(is);return(0,g.jsx)(z.Suspense,{fallback:(0,g.jsx)(sc._,{text:(0,Su.t)("grafana-sql.components.sql-query-editor-lazy.text-loading-editor","Loading editor"),className:h.container}),children:(0,g.jsx)(uc,{...O})})}const is=O=>({container:(0,Re.css)({marginBottom:"unset",marginLeft:O.spacing(1)})});var Ou=b(81045);function Fu(O){const h=typeof O.rawQuery=="string"?O.rawQuery:null;if(!h)return O;const T=(0,Ou.T)({refId:"Annotation",...O.target??{},rawSql:h});return{...O,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:T}}var lc=b(97890);class Tu extends rs.iy{constructor(h,T=(0,Ia.w)()){super(h),this.templateSrv=T,this.interpolateVariable=(R,G)=>typeof R=="string"?G.multi||G.includeAll?this.getQueryModel().quoteLiteral(R):String(R).replace(/'/g,"''"):typeof R=="number"?R:Array.isArray(R)?R.map(ce=>this.getQueryModel().quoteLiteral(ce)).join(","):R,this.name=h.name,this.responseParser=new as,this.id=h.id;const L=h.jsonData||{};this.interval=L.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=L.database??"",this.annotations={prepareAnnotation:Fu,QueryEditor:bu}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(h,T){let L=h;return h&&h.length>0&&(L=h.map(R=>({...R,datasource:this.getRef(),rawSql:this.templateSrv.replace(R.rawSql,T,this.interpolateVariable),rawQuery:!0}))),L}filterQuery(h){return!h.hide}applyTemplateVariables(h,T){return{refId:h.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(h.rawSql,T,this.interpolateVariable),format:h.format}}query(h){if((0,lc.C)()){const T=this.checkForDatabaseIssue(h);if(T){const L=new Error(T);return(0,aa.$)(()=>L)}}return h.targets.forEach(T=>{h.app===Oi.Jk.Dashboard||h.app===Oi.Jk.PanelViewer||(0,Ie.rR)("grafana_sql_query_executed",{datasource:T.datasource?.type,editorMode:T.editorMode,format:T.format,app:h.app})}),super.query(h)}checkForDatabaseIssue(h){if(this.type==="grafana-postgresql-datasource"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(h.app!==Oi.Jk.Explore&&this.preconfiguredDatabase){for(const T of h.targets)if(T.editorMode===yu.lX.Builder&&T.dataset&&T.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(h,T){const L=T?.range;if(L==null)return[];let R="tempvar";T&&T.variable&&T.variable.name&&(R=T.variable.name);const G={...T?.scopedVars,...(0,ts.c)({query:h,wildcardChar:"%",options:T})},ee=this.templateSrv.replace(h,G,this.interpolateVariable),ce={refId:R,datasource:this.getRef(),rawSql:ee,format:Zo.gv.Table};let pe;try{pe=await this.runMetaQuery(ce,L)}catch(Ee){throw console.error(Ee),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(pe)}async runSql(h,T){const L=(0,oo.E2)(),R=await this.runMetaQuery({rawSql:h,format:Zo.gv.Table,refId:T?.refId},L);return new mu.R(R)}runMetaQuery(h,T){const L=h.refId||"meta",R=[{...h,datasource:h.datasource||this.getRef(),refId:L}];return(0,Ja.s)((0,so.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:T.from.valueOf().toString(),to:T.to.valueOf().toString(),queries:R},requestId:L}).pipe((0,bi.T)(G=>(0,ns.bE)(G,R).data[0]??{fields:[]})))}targetContainsTemplate(h){let T=h.rawSql;return es.forEach(L=>{T=T?.replace(L,"")||""}),this.templateSrv.containsTemplate(T)}}var cc=b(52308);function lf({value:O,defaultValue:h,onChange:T,width:L}){const[R,G]=useState(!1);return jsx(Input,{type:"number",placeholder:String(h),value:R?"":O,onChange:ee=>{if(ee.currentTarget.value?.trim()==="")G(!0),T(h);else{G(!1);const ce=Number(ee.currentTarget.value);Number.isNaN(ce)||T(ce)}},width:L})}const Fi=O=>{const{onOptionsChange:h,options:T}=O,L=T.jsonData,R=L.maxIdleConnsAuto!==void 0?L.maxIdleConnsAuto:!1,G=Be=>{const be={...T,jsonData:{...L,...Be}};return h(be)},ee=Be=>be=>{G({[Be]:be})},ce=Be=>{G(R&&Be?{maxOpenConns:Be,maxIdleConns:Be}:{maxOpenConns:Be})},pe=()=>{let Be,be;R?(be=L.maxOpenConns,Be=L.maxIdleConns):L.maxOpenConns!==void 0&&(be=L.maxOpenConns,Be=L.maxOpenConns),G({maxIdleConnsAuto:!R,maxIdleConns:Be,maxOpenConns:be})},Ee=40;return jsxs(ConfigSubSection,{title:t("grafana-sql.components.connection-limits.title-connection-limits","Connection limits"),children:[jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.connection-limits.max-open",children:"Max open"})}),jsx(Tooltip,{content:jsx("span",{children:jsxs(Trans,{i18nKey:"grafana-sql.components.connection-limits.content-max-open",children:["The maximum number of open connections to the database. If ",jsx("i",{children:"Max idle connections"})," is greater than 0 and the ",jsx("i",{children:"Max open connections"})," is less than ",jsx("i",{children:"Max idle connections"}),", then",jsx("i",{children:"Max idle connections"})," will be reduced to match the ",jsx("i",{children:"Max open connections"})," limit. If set to 0, there is no limit on the number of open connections."]})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(NumberInput,{value:L.maxOpenConns,defaultValue:config.sqlConnectionLimits.maxOpenConns,onChange:Be=>{ce(Be)},width:Ee})}),jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.connection-limits.auto-max-idle",children:"Auto max idle"})}),jsx(Tooltip,{content:jsx("span",{children:jsxs(Trans,{i18nKey:"grafana-sql.components.connection-limits.content-auto-max-idle",values:{defaultMaxIdle:config.sqlConnectionLimits.maxIdleConns},children:["If enabled, automatically set the number of ",jsx("i",{children:"Maximum idle connections"})," to the same value as",jsx("i",{children:" Max open connections"}),". If the number of maximum open connections is not set it will be set to the default (","{{defaultMaxIdle}}",")."]})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(Switch,{value:R,onChange:pe})}),jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.connection-limits.max-idle",children:"Max idle"})}),jsx(Tooltip,{content:jsx("span",{children:jsxs(Trans,{i18nKey:"grafana-sql.components.connection-limits.content-max-idle",children:["The maximum number of connections in the idle connection pool.If ",jsx("i",{children:"Max open connections"})," is greater than 0 but less than the ",jsx("i",{children:"Max idle connections"}),", then the ",jsx("i",{children:"Max idle connections"})," ","will be reduced to match the ",jsx("i",{children:"Max open connections"})," limit. If set to 0, no idle connections are retained."]})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:R?jsx(InlineLabel,{width:Ee,children:T.jsonData.maxIdleConns}):jsx(NumberInput,{value:L.maxIdleConns,defaultValue:config.sqlConnectionLimits.maxIdleConns,onChange:Be=>{ee("maxIdleConns")(Be)},width:Ee})}),jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.connection-limits.max-lifetime",children:"Max lifetime"})}),jsx(Tooltip,{content:jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.connection-limits.content-max-lifetime",children:"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever."})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(NumberInput,{value:L.connMaxLifetime,defaultValue:config.sqlConnectionLimits.connMaxLifetime,onChange:Be=>{ee("connMaxLifetime")(Be)},width:Ee})})]})},os=()=>{const O=useStyles2(Cu);return jsx("hr",{className:O.horizontalDivider})},Cu=O=>({horizontalDivider:css({borderTop:`1px solid ${O.colors.border.weak}`,margin:O.spacing(2,0),width:"100%"})}),ss=O=>{const{editorProps:h,showCACert:T,showKeyPair:L=!0}=O,{secureJsonFields:R}=h.options;return jsxs(Fragment,{children:[L?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-client-certificate",children:"TLS/SSL Client Certificate"})}),jsx(Tooltip,{content:jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-client-certificate",children:"To authenticate with an TLS/SSL client certificate, provide the client certificate here."})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:R&&R.tlsClientCert,onChange:onUpdateDatasourceSecureJsonDataOption(h,"tlsClientCert"),onReset:()=>{updateDatasourcePluginResetOption(h,"tlsClientCert")}})}):null,T?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-root-certificate",children:"TLS/SSL Root Certificate"})}),jsx(Tooltip,{content:jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-root-certificate",children:"If the selected TLS/SSL mode requires a server root certificate, provide it here"})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:R&&R.tlsCACert,onChange:onUpdateDatasourceSecureJsonDataOption(h,"tlsCACert"),onReset:()=>{updateDatasourcePluginResetOption(h,"tlsCACert")}})}):null,L?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-client-key",children:"TLS/SSL Client Key"})}),jsx(Tooltip,{content:jsx("span",{children:jsx(Trans,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-client-key",children:"To authenticate with a client TLS/SSL certificate, provide the key here."})}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:R&&R.tlsClientKey,onChange:onUpdateDatasourceSecureJsonDataOption(h,"tlsClientKey"),onReset:()=>{updateDatasourcePluginResetOption(h,"tlsClientKey")}})}):null]})};var rr=b(25992);const dc=(0,rr.DW)("features.plugins.sql");function Eu({onOptionsChange:O,options:h}){useEffect(()=>{const T=h.jsonData;let L={...h},R=!1;if(h.database&&(sqlPluginLogger.logDebug(`Migrating from options.database with value ${h.database} for ${h.name}`),L.database="",L.jsonData={...T,database:h.database},R=!0),T.maxOpenConns===void 0&&T.maxIdleConns===void 0&&T.maxIdleConnsAuto===void 0){const{maxOpenConns:G,maxIdleConns:ee}=config.sqlConnectionLimits;sqlPluginLogger.logDebug(`Setting default max open connections to ${G} and setting max idle connection to ${ee}`),L.jsonData={...L.jsonData,maxOpenConns:G,maxIdleConns:ee,maxIdleConnsAuto:!0},R=!0}if(T.connMaxLifetime===void 0){const{connMaxLifetime:G}=config.sqlConnectionLimits;L.jsonData={...L.jsonData,connMaxLifetime:G},R=!0}R&&O(L)},[O,h])}var Dn=b(25274),wu=b(36656),xu=b(22480);const Wn=xu.Y.reduce((O,h)=>(O[h.code]=async()=>await b(55644)(`./${h.code}/grafana-sql.json`),O),{}),Lu=async O=>(await Wn[O]()).default;var bn=b(24726),fr=b(1578);function fc(O){const h=[];for(const T of O){let L="text";switch(T.type?.toUpperCase()){case"BOOLEAN":case"BOOL":{L="boolean";break}case"BYTES":case"VARCHAR":{L="text";break}case"FLOAT":case"FLOAT64":case"INT":case"INTEGER":case"INT64":case"NUMERIC":case"BIGNUMERIC":{L="number";break}case"DATE":{L="date";break}case"TIMESTAMP(NANOSECOND, NONE)":case"DATETIME":{L="datetime";break}case"TIME":{L="time";break}case"TIMESTAMP":{L="datetime";break}case"GEOGRAPHY":{L="text";break}default:break}h.push({...T,raqbFieldType:L,icon:us(T.type.toUpperCase())})}return h}function us(O){switch(O){case"TIME":case"DATETIME":case"TIMESTAMP":return"clock-nine";case"BOOLEAN":return"toggle-off";case"INTEGER":case"FLOAT":case"FLOAT64":case"INT":case"SMALLINT":case"BIGINT":case"TINYINT":case"BYTEINT":case"INT64":case"NUMERIC":case"DECIMAL":return"calculator-alt";case"CHAR":case"VARCHAR":case"STRING":case"BYTES":case"TEXT":case"TINYTEXT":case"MEDIUMTEXT":case"LONGTEXT":return"text";case"GEOGRAPHY":return"map";default:return}}function ha(O){return O[0]==='"'&&O[O.length-1]==='"'?O.substring(1,O.length-1).replace(/""/g,'"'):O[0]==="`"&&O[O.length-1]==="`"?O.substring(1,O.length-1):O}function Ya(O){return"'"+O.replace(/'/g,"''")+"'"}function ls({sql:O,table:h}){let T="";if(!O||!(0,Dn.YW)(O.columns))return T;const L=O.columns.map(R=>({...R,parameters:R.parameters?.map(G=>({...G,name:cs(G.name)}))}));if(T+=(0,Dn.oF)(L),h&&(T+=`FROM "${h}" `),T+='WHERE "time" >= $__timeFrom AND "time" <= $__timeTo ',O.whereString){const R=new RegExp("(\\s?)([^\\(]\\S+)(\\s?=)","g"),ee=O.whereString.replace(R,'$1"$2"$3');T+=`AND ${ee} `}if(O.groupBy?.[0]?.property.name){const R=O.groupBy.map(G=>`"${G.property.name}"`).filter(G=>!(0,D.isEmpty)(G));T+=`GROUP BY ${R.join(", ")} `}return O.orderBy?.property.name&&(T+=`ORDER BY "${O.orderBy.property.name}" `),O.orderBy?.property.name&&O.orderByDirection&&(T+=`${O.orderByDirection} `),uo(O.limit)&&(T+=`LIMIT ${O.limit}`),T}function cs(O){return O==="*"?O:`"${O}"`}const uo=O=>O!==void 0&&O>=0;function lo(O){return Ru(O)?O:`"${O}"`}function Ru(O){const h=/^[a-zA-Z_][a-zA-Z0-9_$]*$/g.test(O);return!Aa.includes(O.toUpperCase())&&h}const Aa=["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CUBE","CUME_DIST","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DENSE_RANK","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","EMPTY","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FIRST_VALUE","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","FUNCTION","GENERATED","GET","GRANT","GROUP","GROUPING","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERSECT","INTERVAL","INTO","IO_AFTER_GTIDS","IO_BEFORE_GTIDS","IS","ITERATE","JOIN","JSON_TABLE","KEY","KEYS","KILL","LAG","LAST_VALUE","LATERAL","LEAD","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MASTER_BIND","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NTH_VALUE","NTILE","NULL","NUMERIC","OF","ON","OPTIMIZE","OPTIMIZER_COSTS","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PERCENT_RANK","PRECISION","PRIMARY","PROCEDURE","PURGE","RANGE","RANK","READ","READS","READ_WRITE","REAL","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","ROW","ROWS","ROW_NUMBER","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SMALLINT","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STORED","STRAIGHT_JOIN","SYSTEM","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"];function ju(O){return`SELECT table_name FROM information_schema.tables WHERE table_schema = ${O!==void 0?_a(O):"database()"} ORDER BY table_name`}function pc(){return"SELECT DISTINCT TABLE_SCHEMA from information_schema.TABLES where TABLE_TYPE != 'SYSTEM VIEW' ORDER BY TABLE_SCHEMA"}function ds(O,h){let T="SELECT column_name, data_type FROM information_schema.columns WHERE ";return T+=Iu(O,h),T+=" ORDER BY column_name",T}function Iu(O,h){let T="";if(O.includes(".")){const L=O.split(".");return T="table_schema = "+_a(L[0]),T+=" AND table_name = "+_a(L[1]),T}else return T=`table_schema = ${h!==void 0?_a(h):"database()"} AND table_name = `+_a(O),T}function _a(O){return Ya(ha(O))}var fs=b(64237);const ps=({getMeta:O})=>(h,T)=>({...T&&(0,fs.N)(h,T),customStatementPlacement:_u,customSuggestionKinds:vc(O)}),co={afterDatabase:"afterDatabase"},Au={tablesWithinDatabase:"tablesWithinDatabase"},fo="FROM",_u=()=>[{id:co.afterDatabase,resolve:(O,h,T)=>!!(O?.is(fr.ks.Delimiter,".")&&h?.value===fo&&(T?.is(fr.ks.IdentifierQuote)||T?.isIdentifier())&&O?.getPreviousUntil(fr.ks.Keyword,[fr.ks.IdentifierQuote],fo)?.filter(L=>L.isIdentifier()).length===1)}],vc=O=>()=>[{id:fr.ng.Tables,overrideDefault:!0,suggestionsResolver:async h=>{const T=gs(h.currentToken);return(await O({schema:T})).map(vs(h))}},{id:fr.ng.Columns,overrideDefault:!0,suggestionsResolver:async h=>{const T=Ci(h.currentToken),L=gs(T),R=gc(T);return!L||!R?[]:(await O({schema:L,table:R})).map(vs(h))}},{id:Au.tablesWithinDatabase,applyTo:[co.afterDatabase],suggestionsResolver:async h=>{const T=gs(h.currentToken);return(await O({schema:T})).map(vs(h))}}];function vs(O){return function(h){return{label:h.name,insertText:h.completion??h.name,command:{id:"editor.action.triggerSuggest",title:""},kind:fr.Io.Field,sortText:fr.mY.High,range:{...O.range,startColumn:O.range.endColumn,endColumn:O.range.endColumn}}}}function gs(O){if(O?.isIdentifier()&&O.value[O.value.length-1]!==".")return O.value;if(O?.is(fr.ks.Delimiter,"."))return O.getPreviousOfType(fr.ks.Identifier)?.value;if(O?.is(fr.ks.IdentifierQuote))return O.getPreviousOfType(fr.ks.Identifier)?.value||O.getNextOfType(fr.ks.Identifier)?.value}function gc(O){return O?.getNextOfType(fr.ks.Identifier)?.value}const Ti=O=>(O?.getPreviousOfType(fr.ks.Keyword,"SELECT")??null)?.getNextOfType(fr.ks.Keyword,fo),Ci=O=>{const T=Ti(O)?.getNextOfType(fr.ks.Identifier);return T?.isKeyword()&&T.next?.is(fr.ks.Parenthesis,"(")?null:T};class hc extends Tu{constructor(h,T=(0,Ia.w)()){super(h),this.instanceSettings=h,this.templateSrv=T,this.getFunctions=()=>{const L=[...hu,{name:"VARIANCE"},{name:"STDDEV"}],R={name:"Column",required:!0,options:ee=>this.fetchFields(ee)},G={name:"Interval",required:!0,options:()=>Promise.resolve([{label:"$__interval",value:"$__interval"}])};return[...L.map(ee=>({...ee,parameters:[R]})),{name:"$__timeGroup",description:"Time grouping function",parameters:[R,G]},{name:"$__timeGroupAlias",description:"Time grouping function with time as alias",parameters:[R,G]}]}}getQueryModel(){return{quoteLiteral:Ya}}getSqlLanguageDefinition(){if(this.sqlLanguageDefinition!==void 0)return this.sqlLanguageDefinition;const h={getMeta:T=>this.fetchMeta(T)};return this.sqlLanguageDefinition={id:"sql",completionProvider:ps(h),formatter:cc.s},this.sqlLanguageDefinition}async fetchDatasets(){return Promise.resolve(["iox"])}async fetchTables(h){const T=ju(h),R=(await this.runSql(T,{refId:"tables"})).map(G=>lo(G[0]));return R.unshift(...this.getTemplateVariables()),R}async fetchFields(h){if(!h.dataset||!h.table)return[];const T=this.templateSrv.replace(h.table),L=ds(T,h.dataset),G=(await this.runSql(L,{refId:`fields-${bn.A}`})).map(ee=>({name:ee[0],text:ee[0],value:lo(ee[0]),type:ee[1],label:ee[0]}));return G.unshift(...this.getTemplateVariables().map(ee=>({name:ee,text:ee,value:lo(ee),type:"",label:ee}))),fc(G)}getTemplateVariables(){return this.templateSrv.getVariables().map(h=>`$${h.name}`)}async fetchMeta(h){const T=this.instanceSettings.jsonData.database;return!h?.schema&&T?(await this.fetchTables(T)).map(R=>({name:R,completion:`${T}.${R}`,kind:fr.Io.Class})):!h?.schema&&!T?(await this.fetchDatasets()).map(R=>({name:R,completion:`${R}.`,kind:fr.Io.Module})):!h?.table&&(!T||h?.schema)?(await this.fetchTables(h?.schema)).map(R=>({name:R,completion:R,kind:fr.Io.Class})):h?.table&&h.schema?(await this.fetchFields({dataset:h.schema,table:h.table})).map(R=>({name:R.name,completion:R.value,kind:fr.Io.Field})):[]}getDB(){return this.db!==void 0?this.db:{datasets:()=>this.fetchDatasets(),tables:h=>this.fetchTables(h),fields:h=>this.fetchFields(h),validateQuery:(h,T)=>Promise.resolve({query:h,error:"",isError:!1,isValid:!0}),dsID:()=>this.id,toRawSql:ls,functions:()=>this.getFunctions(),getEditorLanguageDefinition:()=>this.getSqlLanguageDefinition()}}}class mc extends z.PureComponent{constructor(h){super(h);const{datasource:T}=h;this.datasource=new hc({url:T.urls[0],access:T.access,id:T.id,jsonData:{allowCleartextPasswords:!1,tlsAuth:!1,tlsAuthWithCACert:!1,tlsSkipVerify:!1,maxIdleConns:1,maxOpenConns:1,maxIdleConnsAuto:!0,connMaxLifetime:1,timezone:"",user:"",database:"",url:T.urls[0],timeInterval:""},meta:T.meta,name:T.name,readOnly:!1,type:T.type,uid:T.uid},T.templateSrv)}transformQuery(h){const T=(0,Ou.T)(h);return{...T,dataset:"iox",sql:{...T.sql,limit:void 0}}}render(){const{query:h,theme:T,onRunQuery:L,onChange:R}=this.props,G=Du(T),ee=()=>L(),ce=Ee=>{R({...Ee})},pe=(0,g.jsxs)("div",{children:["Type: ",(0,g.jsx)("i",{children:"ctrl+space"})," to show template variable suggestions ",(0,g.jsx)("br",{}),"Many queries can be copied from Chronograf"]});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(bu,{datasource:this.datasource,query:this.transformQuery(h),onRunQuery:ee,onChange:ce,queryHeaderProps:{dialect:"influx"}}),(0,g.jsxs)("div",{className:(0,Re.cx)("gf-form-inline",G.editorActions),children:[(0,g.jsx)(En.z9,{icon:"external-link-alt",variant:"secondary",target:"blank",href:"https://docs.influxdata.com/influxdb/cloud-serverless/query-data/sql/",children:"SQL language syntax"}),(0,g.jsx)("div",{className:"gf-form gf-form--grow",children:(0,g.jsx)("div",{className:"gf-form-label gf-form-label--grow"})}),(0,g.jsx)(ga.I,{width:5,tooltip:pe,children:"Help"})]})]})}}const Du=O=>({editorContainerStyles:(0,Re.css)({height:"200px",maxWidth:"100%",resize:"vertical",overflow:"auto",backgroundColor:O.isDark?O.colors.background.canvas:O.colors.background.primary,paddingBottom:O.spacing(1)}),editorActions:(0,Re.css)({marginTop:"6px"})}),Pu=(0,je.cV)(mc);var hs=b(71599);const ms=({isRaw:O,onChange:h})=>{const[T,L]=(0,z.useState)(!1);return(0,z.useEffect)(()=>{L(!1)},[O]),O?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(En.$n,{"aria-label":"Switch to visual editor",icon:"pen",variant:"secondary",type:"button",onClick:()=>{L(!0)}}),(0,g.jsx)(hs.u,{isOpen:T,title:"Switch to visual editor mode",body:"Are you sure to switch to visual editor mode? You will lose the changes done in raw query mode.",confirmText:"Yes, switch to editor mode",dismissText:"No, stay in raw query mode",onConfirm:()=>{h(!1)},onDismiss:()=>{L(!1)}})]}):(0,g.jsx)(En.$n,{"aria-label":"Switch to text editor",icon:"pen",variant:"secondary",type:"button",onClick:()=>{h(!0)}})};var Xa=b(87105);const Za=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"},{label:"Logs",value:"logs"}],ei="time_series";var ys=b(84596);function Wt(O){const[h,T]=(0,z.useState)(O),L=(0,ys.A)(O);return(0,z.useEffect)(()=>{L!==O&&h!==O&&T(O)},[O,h,L]),[h,T]}const ir=({query:O,onChange:h,onRunQuery:T})=>{const[L,R]=Wt(O.query),[G,ee]=Wt(O.alias),ce=(0,z.useId)(),pe=(0,z.useId)(),Ee=O.resultFormat??ei,Be=()=>{h({...O,query:L,alias:G,resultFormat:Ee}),T()};return(0,g.jsxs)(wr.B,{direction:"column",children:[(0,g.jsx)(Xa.f,{"aria-label":"query",rows:3,spellCheck:!1,placeholder:"InfluxDB Query",onBlur:Be,onChange:be=>{R(be.currentTarget.value)},value:L??""}),(0,g.jsxs)(wr.B,{children:[(0,g.jsx)(k.I,{htmlFor:pe,label:"Format as",children:(0,g.jsx)(P.l6,{inputId:pe,onChange:be=>{h({...O,resultFormat:be.value}),T()},value:Ee,options:Za})}),(0,g.jsx)(k.I,{htmlFor:ce,label:"Alias by",children:(0,g.jsx)(q.p,{id:ce,type:"text",spellCheck:!1,placeholder:"Naming pattern",onBlur:Be,onChange:be=>{ee(be.currentTarget.value)},value:G??""})})]})]})};var zn=b(52042),Da=b(65642);const Pa=O=>{let h="",{type:T,templateService:L,scopedVars:R,database:G,measurement:ee,retentionPolicy:ce,tags:pe,withKey:Ee,withMeasurementFilter:Be,withTimeFilter:be}=O;switch(T){case"RETENTION_POLICIES":return'SHOW RETENTION POLICIES on "'+G+'"';case"FIELDS":return!ee||ee===""?"SHOW FIELD KEYS":(ee&&!ee.match(/^\/.*\/|^$/)&&(ee='"'+ee+'"',ce&&ce!==Te&&(ce='"'+ce+'"',ee=ce+"."+ee)),"SHOW FIELD KEYS FROM "+ee);case"TAG_KEYS":h="SHOW TAG KEYS";break;case"TAG_VALUES":h="SHOW TAG VALUES";break;case"MEASUREMENTS":h="SHOW MEASUREMENTS",Be&&(h+=" WITH MEASUREMENT =~ /(?i)"+(0,Pt.$f)(Be)+"/");break;default:return h}if(ee&&(!ee.match("^/.*/")&&!ee.match(/^merge\(.*\)/)&&(ee='"'+ee+'"'),ce&&ce!==Te&&(ce='"'+ce+'"',ee=ce+"."+ee),ee!==""&&(h+=" FROM "+ee)),Ee){let St=Ee;St.endsWith("::tag")&&(St=St.slice(0,-5)),h+=' WITH KEY = "'+St+'"'}let Ft=[];pe&&pe.length>0&&(Ft=(0,D.reduce)(pe,(St,Gt)=>(Gt.key&&Gt.key===Ee||Gt.operator===">"||Gt.operator==="<"||St.push(ia(Gt,St.length,L,R,!0)),St),[]));let Qe=ti(be)&&T!=="MEASUREMENTS";return Ft.length>0?h+=" WHERE "+Ft.join(" ")+(Qe?" AND time > now() - "+be:""):h+=Qe?" WHERE time > now() - "+be:"",T==="MEASUREMENTS"&&(h+=" LIMIT 100"),h};function ti(O){if(!O||typeof O!="string")return!1;const h=O.replace(//g,"u"),T=new Set(["ns","u","ms","s","m","h","d","w"]),L=/(\d+)(ns|u|ms|s|m|h|d|w)/g,R=new Set;let G,ee=0;for(;(G=L.exec(h))!==null;){const[ce,pe,Ee]=G;if(ee+=ce.length,!T.has(Ee)||R.has(Ee)||pe.startsWith("0"))return!1;R.add(Ee)}return ee===h.length}function ia(O,h,T,L,R){let G="",ee=O.operator,ce=O.value;h>0&&(G=(O.condition||"AND")+" "),ee||(/^\/.*\/$/.test(O.value)?ee="=~":ee="="),(ce===""||ee!=="=~"&&ee!=="!~")&&(ce="'"+ce.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")+"'"),ee!=="=~"&&ee!=="!~"?R?ce=T.replace(ce,L):ee!==">"&&ee!=="<"&&(ce="'"+ce.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")+"'"):R&&(ce=T.replace(ce,L,"regex"));let pe=`"${O.key}"`;return O.key.endsWith("::tag")&&(pe=`"${O.key.slice(0,-5)}"::tag`),O.key.endsWith("::field")&&(pe=`"${O.key.slice(0,-7)}"::field`),G+pe+" "+ee+" "+ce}const Ei=async O=>{const{type:h,datasource:T,scopedVars:L,measurement:R,retentionPolicy:G,tags:ee,withKey:ce,withMeasurementFilter:pe}=O,Ee=Pa({type:h,scopedVars:L,measurement:R,retentionPolicy:G,tags:ee,withKey:ce,withMeasurementFilter:pe,withTimeFilter:T.showTagTime,templateService:T.templateSrv,database:T.database}),Be=G?T.templateSrv.replace(G,{},"regex"):"",be={query:Ee,policy:Be,rawQuery:!0,refId:"metadataQuery"};if(Da.Ay.featureToggles.influxdbBackendMigration)return T.runMetadataQuery(be);{const Ft={policy:be.policy};return T.metricFindQuery({refId:"run-explore-query",query:Ee},Ft)}};async function Ss(O){return(await Ei({type:"RETENTION_POLICIES",datasource:O})).map(T=>T.text)}async function Nu(O,h,T){return(await Ei({type:"MEASUREMENTS",datasource:O,tags:h,withMeasurementFilter:T})).map(R=>R.text)}async function bs(O,h,T){return(await Ei({type:"TAG_KEYS",datasource:O,measurement:h,retentionPolicy:T})).map(R=>R.text)}async function Vu(O,h,T,L,R){return T.endsWith("::field")?[]:(await Ei({type:"TAG_VALUES",tags:h,withKey:T,datasource:O,measurement:L,retentionPolicy:R})).map(ee=>ee.text)}async function Ln(O,h,T){return(await Ei({type:"FIELDS",datasource:O,measurement:h,retentionPolicy:T})).map(R=>R.text)}function Os(O,h){return O.filter(T=>T.key.endsWith("::tag")||h.has(T.key+"::tag"))}function fn(O){return{label:O,value:O}}function ri(O){if(O==null)throw new Error("value must not be nullish");return O}function Fs(){const O=dr.getCategories(),h=[];return Object.keys(O).forEach(L=>{const R=O[L].map(G=>fn(G.type));h.push({label:L,options:R})}),h}async function yc(O,h){const T=await h(),L={...O},R=new xn(L),G=[];return R.hasFill()||G.push(fn("fill(null)")),R.hasGroupByTime()||G.push(fn("time($interval)")),T.forEach(ee=>{G.push(fn(`tag(${ee})`))}),G}function Sc(O,h){const T=dr.create(O).def,L=(O.params??[]).map(R=>R.toString());if(L.length!==T.params.length)throw new Error("Invalid query-segment");return L.map((R,G)=>{const ee=T.params[G];return ee.dynamicLookup?{value:R,options:ri(h.get(`${T.type}_${G}`))}:ee.options!=null?{value:R,options:()=>Promise.resolve(ee.options)}:{value:R,options:null}})}function Mu(O,h){return O.map(T=>({name:T.type,params:Sc(T,h)}))}function ku(O){return(0,Ia.w)().getVariables().map(O)}function po(O,h,T){let L=ku(h);return T&&(L=L.filter(R=>R.indexOf(T)>-1)),O.then(R=>[...L,...R])}function Gu(O){return`/^$${O.name}$/`}function bc(O){return`$${O.name}`}const Ts=(0,Re.css)({paddingRight:"4px"}),Oc=(0,Re.cx)("width-8",Ts),Fc=({format:O,inputId:h,onChange:T})=>(0,g.jsx)(P.l6,{inputId:h,className:Oc,onChange:L=>{T(ri(L.value))},value:O,options:Za});var vo=b(20301),Cs=b(76459),Pn=b.n(Cs),Sr=b(41053);const oa=(0,Re.css)({minWidth:"160px"}),ni=O=>O,Bu=({loadOptions:O,allowCustomValue:h,onChange:T,onClose:L})=>{const R=Pn()(O,1e3,{leading:!0});return(0,g.jsx)("div",{className:oa,children:(0,g.jsx)(P.DW,{formatCreateLabel:ni,defaultOptions:!0,autoFocus:!0,isOpen:!0,onCloseMenu:L,allowCustomValue:h,loadOptions:R,onChange:T,createOptionPosition:"first"})})},wi=({loadOptions:O,allowCustomValue:h,onChange:T,onClose:L})=>{const[R,G]=(0,Sr.A)(O,[O]);return(0,z.useEffect)(()=>{G("")},[G,O]),(0,g.jsx)("div",{className:oa,children:(0,g.jsx)(P.l6,{isLoading:R.loading,formatCreateLabel:ni,autoFocus:!0,isOpen:!R.loading,onCloseMenu:L,allowCustomValue:h,options:R.value??[],onChange:T,createOptionPosition:"first"})})},Uu=({loadOptions:O,filterByLoadOptions:h,allowCustomValue:T,onChange:L,onClose:R})=>h?(0,g.jsx)(Bu,{loadOptions:O,allowCustomValue:T,onChange:L,onClose:R}):(0,g.jsx)(wi,{loadOptions:O,allowCustomValue:T,onChange:L,onClose:R}),go=({initialValue:O,onChange:h,onClose:T})=>{const[L,R]=Wt(O);return(0,g.jsx)(q.p,{autoFocus:!0,type:"text",spellCheck:!1,onBlur:T,onKeyDown:G=>{G.key==="Enter"&&h(L)},onChange:G=>{R(G.currentTarget.value)},value:L})},Tc=(0,Re.css)({width:"auto",cursor:"pointer"}),Kn=({value:O,buttonClassName:h,loadOptions:T,filterByLoadOptions:L,allowCustomValue:R,onChange:G})=>{const[ee,ce]=(0,z.useState)(!1);if(ee)return T!==void 0?(0,g.jsx)(Uu,{loadOptions:T,filterByLoadOptions:L??!1,allowCustomValue:R,onChange:pe=>{ce(!1),G(pe)},onClose:()=>{ce(!1)}}):(0,g.jsx)(go,{initialValue:O,onClose:()=>{ce(!1)},onChange:pe=>{ce(!1),G({value:pe,label:pe})}});{const pe=(0,Re.cx)(Tc,h);return(0,g.jsx)(ft.c,{as:"button",className:pe,onClick:()=>{ce(!0)},children:O})}},ai=({policy:O,measurement:h,onChange:T,getPolicyOptions:L,getMeasurementOptions:R})=>{const G=async()=>{const ce=await L();return(ce.some(Ee=>Ee===Te)?ce:[Te,...ce]).map(fn)},ee=async ce=>(await R(ce)).map(fn);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Kn,{allowCustomValue:!0,value:O??"using default policy",loadOptions:G,onChange:ce=>{T(ce.value,h)}}),(0,g.jsx)(Kn,{allowCustomValue:!0,value:h??"select measurement",loadOptions:ee,filterByLoadOptions:!0,onChange:ce=>{T(O,ce.value)}}),h&&(0,g.jsx)(vo.Z,{style:{marginRight:"4px"},"aria-label":"remove",icon:"times",variant:"secondary",onClick:()=>{T(O,void 0)}})]})},xi=({value:O,onChange:h,isWide:T,placeholder:L})=>{const[R,G]=Wt(O),ee=()=>{h(R===""?void 0:R)};return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(q.p,{placeholder:L,className:(0,Re.cx)(T??!1?"width-14":"width-8",Ts),type:"text",spellCheck:!1,onBlur:ee,onChange:ce=>{G(ce.currentTarget.value)},value:R??""})})},ma=[{label:"ascending",value:"ASC"},{label:"descending",value:"DESC"}],Li=(0,Re.cx)("width-9",Ts),qn=({value:O,onChange:h,inputId:T})=>(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(P.l6,{inputId:T,className:Li,onChange:L=>{h(ri(L.value))},value:O,options:ma})}),ho=({loadOptions:O,allowCustomValue:h,onAdd:T})=>(0,g.jsx)(Kn,{value:"+",loadOptions:O,allowCustomValue:h,onChange:L=>{T(ri(L.value))}}),$u=(0,Re.css)({paddingRight:"0",marginRight:"0"}),Ri=(0,Re.css)({paddingLeft:"0",paddingRight:"0",marginLeft:"0",marginRight:"0"}),Wu=O=>(0,Re.cx)("gf-form-label",(0,Re.css)({paddingLeft:"0",lineHeight:O.typography.body.lineHeight,fontSize:O.typography.body.fontSize})),zu=({name:O,params:h,onChange:T})=>{const L=(0,je.$j)(),R=(0,z.useMemo)(()=>Wu(L),[L]),G=(ee,ce)=>{const pe=h.map(Ee=>Ee.value);pe[ce]=ee,T(pe)};return(0,g.jsxs)("div",{className:R,children:[(0,g.jsx)("button",{className:(0,Re.cx)("gf-form-label",$u),children:O}),"(",h.map((ee,ce)=>{const{value:pe,options:Ee}=ee,Be=ce===h.length-1,be=Ee!==null?()=>Ee().then(Ft=>Ft.map(fn)):void 0;return(0,g.jsxs)(z.Fragment,{children:[(0,g.jsx)(Kn,{allowCustomValue:!0,value:pe,buttonClassName:Ri,loadOptions:be,onChange:Ft=>{G(ri(Ft.value),ce)}}),!Be&&","]},ce)}),")"]})},ji=({parts:O,getNewPartOptions:h,onAddNewPart:T,onRemovePart:L,onChange:R})=>(0,g.jsxs)(g.Fragment,{children:[O.map((G,ee)=>(0,g.jsxs)(z.Fragment,{children:[(0,g.jsx)(zu,{name:G.name,params:G.params,onRemove:()=>{L(ee)},onChange:ce=>{R(ee,ce)}}),(0,g.jsx)(vo.Z,{style:{marginRight:"4px"},"aria-label":"remove",icon:"times",variant:"secondary",onClick:()=>{L(ee)}})]},ee)),(0,g.jsx)(ho,{loadOptions:h,onAdd:T})]});function Ii(O){return/^\/.*\/$/.test(O)}function Jr(O){return O.operator??(Ii(O.value)?"=~":"=")}function ii(O,h){return h?void 0:O.condition??"AND"}function Ku(O,h){const T=O==="=~"||O==="!~";return Ii(h)?T?O:"=~":T?"=":O}const mo=["=","!=","<>","<",">",">=","<=","=~","!~","Is","Is Not"],qu=["AND","OR"],yo=mo.map(fn),Es=qu.map(fn),ws=()=>Promise.resolve(Es),Na=()=>Promise.resolve(yo),So=({tag:O,isFirst:h,onRemove:T,onChange:L,getTagKeyOptions:R,getTagValueOptions:G})=>{const ee=Jr(O),ce=ii(O,h),pe=()=>R().catch(Be=>(console.error(Be),[])).then(Be=>Be.map(fn)),Ee=()=>G(O.key).then(Be=>Be.map(fn));return(0,g.jsxs)("div",{className:"gf-form",children:[ce!=null&&(0,g.jsx)(Kn,{value:ce,loadOptions:ws,onChange:Be=>{L({...O,condition:Be.value})}}),(0,g.jsx)(Kn,{allowCustomValue:!0,value:O.key,loadOptions:pe,onChange:Be=>{const{value:be}=Be;be===void 0?T():L({...O,key:be??""})}}),(0,g.jsx)(Kn,{value:ee,loadOptions:Na,onChange:Be=>{L({...O,operator:Be.value})}}),(0,g.jsx)(Kn,{allowCustomValue:!0,value:O.value,loadOptions:Ee,onChange:Be=>{const be=Be.value??"";L({...O,value:be,operator:Ku(ee,be)})}}),(0,g.jsx)(vo.Z,{style:{marginRight:"4px"},"aria-label":"remove",icon:"times",variant:"secondary",onClick:()=>{T()}})]})},Ai=({tags:O,onChange:h,getTagKeyOptions:T,getTagValueOptions:L})=>{const R=(pe,Ee)=>{const Be=O.map((be,Ft)=>Ee===Ft?pe:be);h(Be)},G=pe=>{const Ee=O.filter((Be,be)=>be!==pe);h(Ee)},ee=()=>T().then(pe=>pe.map(fn)),ce=(pe,Ee)=>{const Be={key:pe,value:"select tag value"},be={key:Be.key,value:Be.value,operator:Jr(Be),condition:ii(Be,Ee)};h([...O,be])};return(0,g.jsxs)(g.Fragment,{children:[O.map((pe,Ee)=>(0,g.jsx)(So,{tag:pe,isFirst:Ee===0,onChange:Be=>{R(Be,Ee)},onRemove:()=>{G(Ee)},getTagKeyOptions:T,getTagValueOptions:L},Ee)),(0,g.jsx)(ho,{allowCustomValue:!0,loadOptions:ee,onAdd:pe=>{ce(pe,O.length===0)}})]})},Vr=O=>{const h=(0,z.useId)(),T=`influxdb-qe-format-as-${h}`,L=`influxdb-qe-order-by${h}`,R=(0,je.of)(bo),G=ao(O.query),{datasource:ee}=O,{measurement:ce,policy:pe}=G,Ee=(0,z.useMemo)(async()=>{const Tt=(await bs(ee,ce,pe)).map(Yr=>`${Yr}::tag`),Rt=(await Ln(ee,ce||"",pe)).map(Yr=>`${Yr}::field`);return new Set([...Tt,...Rt])},[ce,pe,ee]),Be=(0,z.useMemo)(()=>{const Tt=new Map([["field_0",()=>ce!==void 0?Ln(ee,ce,pe):Promise.resolve([])]]);return(G.select??[]).map(Rt=>Mu(Rt,Tt))},[ce,pe,G.select,ee]),be=(0,z.useMemo)(()=>async()=>[...await Ee],[Ee]),Ft=(0,z.useMemo)(()=>{const Tt=new Map([["tag_0",be]]);return Mu(G.groupBy??[],Tt)},[be,G.groupBy]),Qe=Tt=>{O.onChange(Tt),O.onRunQuery()},St=(Tt,Rt)=>{Qe({...G,policy:Tt,measurement:Rt})},Gt=Tt=>{Qe({...G,tags:Tt.length===0?void 0:Tt})};return(0,g.jsxs)("div",{children:[(0,g.jsxs)(zn.L,{label:"FROM",fill:!0,children:[(0,g.jsx)(ai,{policy:pe,measurement:ce,getPolicyOptions:()=>po(Ss(ee),bc),getMeasurementOptions:Tt=>po(Ee.then(Rt=>Nu(ee,Os(G.tags??[],Rt),Tt===""?void 0:Tt)),Gu,Tt),onChange:St}),(0,g.jsx)(ft.c,{width:"auto",className:R.inlineLabel,children:"WHERE"}),(0,g.jsx)(Ai,{tags:G.tags??[],onChange:Gt,getTagKeyOptions:be,getTagValueOptions:Tt=>po(Ee.then(Rt=>Vu(ee,Os(G.tags??[],Rt),Tt,ce)),Gu)})]}),Be.map((Tt,Rt)=>(0,g.jsx)(zn.L,{label:Rt===0?"SELECT":"",fill:!0,children:(0,g.jsx)(ji,{parts:Tt,getNewPartOptions:()=>Promise.resolve(Fs()),onChange:(Yr,jc)=>{const al=Ir(G,Rt,Yr,jc);Qe(al)},onAddNewPart:Yr=>{Qe(Qo(G,Yr,Rt))},onRemovePart:Yr=>{Qe(Jo(G,Yr,Rt))}})},Rt)),(0,g.jsx)(zn.L,{label:"GROUP BY",fill:!0,children:(0,g.jsx)(ji,{parts:Ft,getNewPartOptions:()=>yc(G,be),onChange:(Tt,Rt)=>{const Yr=nc(G,Tt,Rt);Qe(Yr)},onAddNewPart:Tt=>{Qe(Si(G,Tt))},onRemovePart:Tt=>{Qe(io(G,Tt))}})}),(0,g.jsxs)(zn.L,{label:"TIMEZONE",fill:!0,children:[(0,g.jsx)(xi,{placeholder:"(optional)",value:G.tz,onChange:Tt=>{Qe({...G,tz:Tt})}}),(0,g.jsx)(ft.c,{htmlFor:L,width:"auto",className:R.inlineLabel,children:"ORDER BY TIME"}),(0,g.jsx)(qn,{inputId:L,value:G.orderByTime==="DESC"?"DESC":"ASC",onChange:Tt=>{Qe({...G,orderByTime:Tt})}})]}),(0,g.jsxs)(zn.L,{label:"LIMIT",fill:!0,children:[(0,g.jsx)(xi,{placeholder:"(optional)",value:G.limit?.toString(),onChange:Tt=>{Qe({...G,limit:Tt})}}),(0,g.jsx)(ft.c,{width:"auto",className:R.inlineLabel,children:"SLIMIT"}),(0,g.jsx)(xi,{placeholder:"(optional)",value:G.slimit?.toString(),onChange:Tt=>{Qe({...G,slimit:Tt})}})]}),(0,g.jsxs)(zn.L,{htmlFor:T,label:"FORMAT AS",fill:!0,children:[(0,g.jsx)(Fc,{inputId:T,format:G.resultFormat??ei,onChange:Tt=>{Qe({...G,resultFormat:Tt})}}),G.resultFormat!=="table"&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ft.c,{width:"auto",className:R.inlineLabel,children:"ALIAS"}),(0,g.jsx)(xi,{isWide:!0,placeholder:"Naming pattern",value:G.alias,onChange:Tt=>{Qe({...G,alias:Tt})}})]})]})]})};function bo(O){return{inlineLabel:(0,Re.css)({color:O.colors.primary.text})}}const Hu=({query:O,onChange:h,onRunQuery:T,datasource:L})=>{switch(L.version){case B.Flux:return(0,g.jsx)("div",{className:"gf-form-query-content",children:(0,g.jsx)(Xo,{query:O,onChange:h,datasource:L})});case B.SQL:return(0,g.jsx)(Pu,{datasource:L,query:O,onChange:h,onRunQuery:T});case B.InfluxQL:default:return(0,g.jsxs)("div",{className:(0,Re.css)({display:"flex"}),children:[(0,g.jsx)("div",{className:(0,Re.css)({flexGrow:1}),children:O.rawQuery?(0,g.jsx)(ir,{query:O,onChange:h,onRunQuery:T}):(0,g.jsx)(Vr,{query:O,onChange:h,onRunQuery:T,datasource:L})}),(0,g.jsx)(ms,{isRaw:O.rawQuery??!1,onChange:R=>{h({...O,query:Ho(O),rawQuery:R}),T()}})]})}},Qu=[{title:"Getting started",label:"Start by selecting a measurement and field from the dropdown above. You can then use the tag selector to further narrow your search."}],_i=()=>{const O=(0,je.of)(Ju);return(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{children:"InfluxDB Cheat Sheet"}),Qu.map(h=>(0,g.jsxs)("div",{className:O.cheatSheetItem,children:[(0,g.jsx)("div",{className:O.cheatSheetItemTitle,children:h.title}),h.label]},h.title))]})},Ju=O=>({cheatSheetItem:(0,Re.css)({margin:O.spacing(3,0)}),cheatSheetItemTitle:(0,Re.css)({fontSize:O.typography.h3.fontSize})});function xs(){return(0,g.jsx)(_i,{})}var Ls=b(88483),Yu=b(44240),Di=b(62467),Cc=b(66847),Xu=b(41119),nr=b(95004),Pi=b(33239);const oi=O=>{const{query:h,onChange:T}=O,[L,R]=(0,z.useState)(h.query??""),[G,ee]=(0,z.useState)(h.textColumn??""),[ce,pe]=(0,z.useState)(h.tagsColumn??""),[Ee,Be]=(0,z.useState)(h?.timeEndColumn??""),[be]=(0,z.useState)(h?.titleColumn??""),Ft=(Qe,St)=>{T({...h,[Qe]:St,rawQuery:!0,fromAnnotations:!0,textEditor:!0})};return(0,g.jsxs)(wr.B,{gap:5,direction:"column",children:[(0,g.jsxs)(wr.B,{gap:.5,direction:"column",children:[(0,g.jsxs)(wr.B,{gap:0,children:[(0,g.jsx)(ga.I,{width:12,children:"InfluxQL Query"}),(0,g.jsx)(q.p,{value:L,onChange:Qe=>R(Qe.currentTarget.value??""),onBlur:()=>Ft("query",L),placeholder:"select text from events where $timeFilter limit 1000"})]}),(0,g.jsx)(ga.I,{width:12,tooltip:(0,g.jsx)("div",{children:"If your influxdb query returns more than one field you need to specify the column names below. An annotation event is composed of a title, tags, and an additional text field. Optionally you can map the timeEnd column for region annotation usage."}),children:"Field mappings"}),(0,g.jsxs)(wr.B,{gap:.5,alignItems:"flex-start",wrap:"wrap",children:[(0,g.jsxs)(wr.B,{gap:0,children:[(0,g.jsx)(ga.I,{width:12,children:"Text"}),(0,g.jsx)(q.p,{value:G,onChange:Qe=>ee(Qe.currentTarget.value??""),onBlur:()=>Ft("textColumn",G)})]}),(0,g.jsxs)(wr.B,{gap:0,children:[(0,g.jsx)(ga.I,{width:12,children:"Tags"}),(0,g.jsx)(q.p,{value:ce,onChange:Qe=>pe(Qe.currentTarget.value??""),onBlur:()=>Ft("tagsColumn",ce)})]}),(0,g.jsxs)(wr.B,{gap:0,children:[(0,g.jsx)(ga.I,{width:12,children:"TimeEnd"}),(0,g.jsx)(q.p,{value:Ee,onChange:Qe=>Be(Qe.currentTarget.value??""),onBlur:()=>Ft("timeEndColumn",Ee)})]}),(0,g.jsxs)("div",{className:"gf-form ng-hide",children:[(0,g.jsx)(ga.I,{width:12,children:"Title"}),(0,g.jsx)(q.p,{defaultValue:be})]})]})]}),(0,g.jsx)("div",{})]})};var Va=b(873);class Rs{constructor(h){this.series=h.series,this.alias=h.alias,this.annotation=h.annotation,this.meta=h.meta,this.refId=h.refId}getTimeSeries(){const h=[];let T,L;return this.series.length===0||(0,D.each)(this.series,R=>{const G=R.columns.length,ee=(0,D.map)(R.tags,(ce,pe)=>pe+": "+ce);for(L=1;L<G;L++){let ce=R.name;const pe=R.columns[L];pe!=="value"&&(ce=ce+"."+pe),this.alias?ce=this._getSeriesName(R,L):R.tags&&(ce=ce+" {"+ee.join(", ")+"}");const Ee=[];if(R.values)for(T=0;T<R.values.length;T++)Ee[T]=[R.values[T][L],R.values[T][0]];h.push({title:ce,target:ce,datapoints:Ee,tags:R.tags,meta:this.meta,refId:this.refId})}}),h}_getSeriesName(h,T){const L=/\$(\w+)|\[\[([\s\S]+?)\]\]/g,R=h.name.split(".");return this.alias?.replace(L,(G,ee,ce)=>{const pe=ee||ce,Ee=parseInt(pe,10);if(pe==="m"||pe==="measurement")return h.name;if(pe==="col")return h.columns[T];if(!isNaN(Ee))return R[Ee]??G;if(pe.indexOf("tag_")!==0)return G;const Be=pe.replace("tag_","");return h.tags?h.tags[Be]:G})}getAnnotations(){const h=[];return(0,D.each)(this.series,T=>{let L=null,R=null,G=null;const ee=[];let ce=null;(0,D.each)(T.columns,(pe,Ee)=>{if(pe==="time"){R=Ee;return}if(pe!=="sequence_number"){if(pe===this.annotation?.titleColumn){L=Ee;return}if((0,D.includes)((this.annotation?.tagsColumn||"").replace(" ","").split(","),pe)){ee.push(Ee);return}if(pe===this.annotation?.textColumn){ce=Ee;return}if(pe===this.annotation?.timeEndColumn){G=Ee;return}!L&&ce!==Ee&&(L=Ee)}}),(0,D.each)(T.values,pe=>{const Ee={annotation:this.annotation,time:+new Date(pe[R]),title:pe[L],timeEnd:pe[G],tags:(0,D.flatten)(ee.filter(Be=>pe[Be]).map(Be=>pe[Be].split(","))),text:pe[ce]};h.push(Ee)})}),h}getTable(){const h=new Va.A;let T,L;return h.refId=this.refId,h.meta=this.meta,this.series.length===0||(0,D.each)(this.series,(R,G)=>{if(G===0){const ee=R.columns[0],ce=ee==="time"?{text:"Time",type:nr.PU.time}:{text:ee};for(h.columns.push(ce),(0,D.each)((0,D.keys)(R.tags),pe=>{h.columns.push({text:pe})}),L=1;L<R.columns.length;L++)h.columns.push({text:R.columns[L]})}if(R.values)for(T=0;T<R.values.length;T++){const ee=R.values[T],ce=[ee[0]];if(R.tags)for(const pe in R.tags)R.tags.hasOwnProperty(pe)&&ce.push(R.tags[pe]);for(L=1;L<ee.length;L++)ce.push(ee[L]);h.rows.push(ce)}}),h}}const Ec=O=>{const h={refId:"",query:O.query??"",queryType:"tags",fromAnnotations:!0,tagsColumn:O.tagsColumn??"",textColumn:O.textColumn??"",timeEndColumn:O.timeEndColumn??"",titleColumn:O.titleColumn??"",name:O.name??""};return O.target&&O.target.limit&&(h.limit=O.target.limit),O.target&&O.target.matchAny&&(h.matchAny=O.target.matchAny),O.target&&O.target.tags&&(h.tags=O.target.tags),O.target&&O.target.type&&(h.type=O.target.type),h},wc=O=>(O.target=O.target&&!O.target?.query?Ec(O):O.target,O);class js{parse(h,T){if(!T?.results||T.results.length===0)return[];const L=T.results[0];if(!L.series)return[];const R=h.toLowerCase(),G=R.indexOf("show retention policies")>=0,ee=R.indexOf("show field keys")>=0||G,ce=new Set;return(0,D.each)(L.series,pe=>{(0,D.each)(pe.values,Ee=>{(0,D.isArray)(Ee)?ee?ce.add(Ee[0].toString()):Ee[1]!==void 0?ce.add(Ee[1].toString()):ce.add(Ee[0].toString()):ce.add(Ee.toString())})}),Array.from(ce).map(pe=>({text:pe}))}getTable(h,T,L){let R=new Va.A;if(h.length>0)if(R.meta={...L,executedQueryString:h[0].meta?.executedQueryString},R.refId=T.refId,R=el(h,R,T),h[0].fields[1]&&h[0].fields[1].labels){let G=(0,D.groupBy)(h,pe=>pe.fields[1].labels?Object.values(pe.fields[1].labels):null);const ee=Object.keys(G),ce=Object.values(G);for(let pe=0;pe<ce.length;pe++)R=Is(ce[pe],R,[...ee[pe].split(",")])}else R=Is(h,R,[]);return R}async transformAnnotationResponse(h,T,L){const R=(0,ns.bE)(T,[L]);if(!R)return[];const G=this.getTable(R.data,L,{}),ee=[];let ce=0,pe=0,Ee=0,Be=0;const be=[];return(0,D.each)(G.columns,(Ft,Qe)=>{if(Ft.text.toLowerCase()==="time"){pe=Qe;return}if(Ft.text===h.titleColumn){ce=Qe;return}if(Zu(Ft.text,h.tagsColumn)){be.push(Qe);return}if(h.textColumn&&Ft.text.includes(h.textColumn)){Be=Qe;return}if(Ft.text===h.timeEndColumn){Ee=Qe;return}!ce&&Be!==Qe&&(ce=Qe)}),(0,D.each)(G.rows,Ft=>{const Qe={annotation:h,time:+new Date(Ft[pe]),title:Ft[ce],timeEnd:Ft[Ee],tags:(0,D.flatten)(be.filter(St=>Ft[St]).map(St=>Ft[St].split(","))),text:Ft[Be]};ee.push(Qe)}),ee}}function Zu(O,h){const T=(h||"").replace(" ","").split(",");for(const L of T)if(L!==""&&O.includes(L))return!0;return!1}function el(O,h,T){const L=xc(T);O[0].fields.forEach(R=>{R.name.toLowerCase()==="time"?h.columns.push({text:"Time",type:nr.PU.time}):R.name.toLowerCase()==="value"&&R.labels&&Object.keys(R.labels).forEach(G=>{h.columns.push({text:G})})}),O[0].refId==="metricFindQuery"&&O.forEach(R=>{R.name&&h.columns.push({text:R.name})});for(let R=0;R<L.length;R++)h.columns.push({text:L[R]});return T.rawQuery&&L.length===0&&rl(T.query,O)&&O[0].refId!=="metricFindQuery"&&O.map(R=>{R.name&&h.columns.push({text:R.name})}),h}function Is(O,h,T){const L=O[0].fields[0].values;for(let R=0;R<L.length;R++){const G=L[R],ee=O.map(ce=>ce.fields[1]?ce.fields[1].values[R]:null);ee.indexOf(null)<0&&h.rows.push([G,...T,...ee])}return h}function xc(O){let h=[];O.select?.forEach(L=>{const R=L.filter(G=>G.type!=="field");if(R.length>0){const G=R.find(ee=>ee.type==="alias");G?h.push(G.params?.[0].toString()??""):h.push(R[0].type)}else L[0]&&L[0].params&&L[0].params[0]&&h.push(L[0].params[0].toString())});let T=[];return h.forEach(L=>{T.push(tl(L,L,T,0))}),T}function tl(O,h,T,L){return T.indexOf(h)>-1?(L++,tl(O,O+"_"+L,T,L)):h}function rl(O,h){const L=h.map(ee=>ee.name).every(ee=>ee&&O?ee.split(".").every(pe=>O.toLowerCase().includes(pe.toLowerCase())):!1),G=["*","SHOW"].some(ee=>O?O.toLowerCase().includes(ee.toLowerCase()):!1);return L||G}var si=b(65474),Ma=b(48592);const Oo="InfluxVariableQueryEditor-VariableQuery",nl=({onChange:O,datasource:h,query:T})=>{const L=R=>typeof R!="string"?R:{refId:Oo,query:R,...h.version===B.Flux?{maxDataPoints:1e3}:{}};switch(h.version){case B.Flux:return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Xo,{datasource:h,query:L(T),onChange:R=>{O({...T,query:R.query??""})}}),(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Max Data Points",labelWidth:20,required:!0,grow:!0,"aria-labelledby":"flux-maxdatapoints",tooltip:(0,g.jsx)("div",{children:"Upper boundary of data points will return for the variable query."}),children:(0,g.jsx)(q.p,{id:"influx-sql-variable-maxdatapoints","aria-label":"flux-maxdatapoints",type:"number",defaultValue:T.maxDataPoints??1e3,placeholder:"Default is 1000",onBlur:R=>{O({refId:Oo,query:T.query,maxDataPoints:Number.parseInt(R.currentTarget.value,10)})}})})})]});default:return(0,g.jsx)(me.C,{children:(0,g.jsx)(k.I,{label:"Query",labelWidth:20,required:!0,grow:!0,"aria-labelledby":"influx-variable-query",children:(0,g.jsx)(Xa.f,{"aria-label":"influx-variable-query",defaultValue:L(T).query,placeholder:"metric name or tags query",rows:1,onBlur:R=>{O({refId:Oo,query:R.currentTarget.value??""})}})})})}};class As extends Ma.f5{constructor(h,T=(0,Ia.w)()){super(),this.datasource=h,this.templateSrv=T,this.editor=nl}query(h){let T;if(typeof h.targets[0]=="string"?T=h.targets[0]:T=h.targets[0].query,!T)return(0,Di.of)({data:[]});const L=this.templateSrv.replace(T,h.scopedVars,this.datasource.interpolateQueryExpr),R=this.datasource.getTimeFilter({rangeRaw:h.range.raw,timezone:h.timezone}),G=L.replace("$timeFilter",R);return(0,si.H)(this.datasource.metricFindQuery({refId:h.targets[0].refId,query:G,maxDataPoints:h.targets[0].maxDataPoints??1e3},{range:h.range})).pipe((0,bi.T)(ce=>({data:ce})))}}class Lc extends rs.iy{constructor(h,T=(0,Ia.w)()){super(h),this.templateSrv=T,this.type="influxdb",this.urls=(h.url??"").split(",").map(R=>R.trim()),this.username=h.username??"",this.password=h.password??"",this.name=h.name,this.basicAuth=h.basicAuth,this.withCredentials=h.withCredentials,this.access=h.access;const L=h.jsonData??{};this.database=L.dbName??h.database,this.interval=L.timeInterval,this.showTagTime=L.showTagTime||"",this.httpMode=L.httpMode||"GET",this.responseParser=new js,this.version=L.version??B.InfluxQL,this.isProxyAccess=h.access==="proxy",this.variables=new As(this,this.templateSrv),this.version===B.Flux?this.annotations={QueryEditor:Xo}:this.annotations={QueryEditor:oi,prepareAnnotation:wc}}query(h){if(!this.isProxyAccess){const T=new Error(oe);return(0,aa.$)(()=>T)}return this._query(h)}_query(h){const T={...h,targets:h.targets.filter(L=>L.hide!==!0)};if(T.targets.some(L=>L.fromAnnotations)){const L=[];for(const R of T.targets)R.query&&L.push(new Ls.c(G=>{this.annotationEvents(T,R).then(ee=>G.next({data:[(0,Xu.Vc)(ee)]})).catch(ee=>G.error(new Error(ee))).finally(()=>G.complete())}));return(0,Yu.h)(...L)}return this.version===B.InfluxQL&&!this.isMigrationToggleOnAndIsAccessProxy()?this.classicQuery(h):super.query(T)}getQueryDisplayText(h){switch(this.version){case B.Flux:return h.query;case B.SQL:return ls(h);case B.InfluxQL:return new xn(h).render(!1);default:return""}}filterQuery(h){return this.version===B.Flux?!!h.query:!0}applyTemplateVariables(h,T,L){const R=T||{};return R.__interval={value:"$__interval"},R.__interval_ms={value:"$__interval_ms"},this.version===B.Flux?{...h,query:this.templateSrv.replace(h.query??"",R)}:((this.version===B.SQL||this.isMigrationToggleOnAndIsAccessProxy())&&(h=this.applyVariables(h,R,L),h.adhocFilters?.length&&(h.adhocFilters=(h.adhocFilters??[]).map(G=>{const{condition:ee,...ce}=G;return ce.value=this.templateSrv.replace(ce.value??"",R),ce}),h.tags=[...h.tags??[],...h.adhocFilters])),h)}targetContainsTemplate(h){const T=this.version===B.Flux?h.query:Ho(h);return this.templateSrv.containsTemplate(T)}interpolateVariablesInQueries(h,T){return!h||h.length===0?[]:h.map(L=>this.version===B.Flux?{...L,datasource:this.getRef(),query:this.templateSrv.replace(L.query??"",T,(R=[],G)=>this.interpolateQueryExpr(R,G,L.query))}:{...L,datasource:this.getRef(),...this.applyVariables(L,T)})}applyVariables(h,T,L){const R={...h};return h.groupBy&&(R.groupBy=h.groupBy.map(G=>({...G,params:G.params?.map(ee=>this.templateSrv.replace(ee.toString(),void 0))}))),h.select&&(R.select=h.select.map(G=>G.map(ee=>({...ee,params:ee.params?.map(ce=>this.templateSrv.replace(ce.toString(),T))})))),h.tags&&(R.tags=h.tags.map(G=>(G.operator!=="=~"&&G.operator!=="!~"&&(G.value=Nr(G.value)),{...G,key:this.templateSrv.replace(G.key,T),value:this.templateSrv.replace(G.value??"",T,(ee=[],ce)=>this.interpolateQueryExpr(ee,ce,G.value))}))),{...R,adhocFilters:L??[],query:this.templateSrv.replace(h.query??"",T,(G=[],ee)=>this.interpolateQueryExpr(G,ee,h.query)),rawSql:this.templateSrv.replace(h.rawSql??"",T,(G=[],ee)=>this.interpolateQueryExpr(G,ee,h.rawSql)),alias:this.templateSrv.replace(h.alias??"",T),limit:this.templateSrv.replace(h.limit?.toString()??"",T),measurement:this.templateSrv.replace(h.measurement??"",T,(G=[],ee)=>this.interpolateQueryExpr(G,ee,h.measurement)),policy:this.templateSrv.replace(h.policy??"",T),slimit:this.templateSrv.replace(h.slimit?.toString()??"",T),tz:this.templateSrv.replace(h.tz??"",T)}}interpolateQueryExpr(h=[],T,L){if(typeof h=="string"&&!isNaN(parseFloat(h)))return h;if(T.multi)return typeof h=="string"?isNaN(parseFloat(h))?(0,Pt.$f)(h):h:`(${h.map(ce=>(0,Pt.$f)(ce)).join("|")})`;const R=new RegExp(/(\s*(=|!)~\s*)\/((?![*+?])(?:[^\r\n\[/\\]|\\.|\[(?:[^\r\n\]\\]|\\.)*\])+)\/((?:g(?:im?|mi?)?|i(?:gm?|mg?)?|m(?:gi?|ig?)?)?)/,"gm"),G=new RegExp(`\\/(?:\\^)?(.*)(\\$${T.name})(.*)(?:\\$)?\\/`,"gm");if(!L||typeof L!="string")return h;const ee=L.match(R);if(!ee)return h;for(const ce of ee)if(ce.match(G))return typeof h=="string"?(0,Pt.$f)(h):`(${h.map(pe=>(0,Pt.$f)(pe)).join("|")})`;return h}async runMetadataQuery(h){return(0,Ja.s)(super.query({targets:[h]})).then(this.toMetricFindValue)}async metricFindQuery(h,T){if(this.version===B.Flux||this.version===B.SQL||this.isMigrationToggleOnAndIsAccessProxy()){const R={refId:"metricFindQuery",query:h.query,rawQuery:!0,...this.version===B.SQL?{rawSql:h.query,format:Zo.gv.Table}:{}};return(0,Ja.s)(super.query({...T??{},maxDataPoints:h.maxDataPoints,targets:[R]})).then(this.toMetricFindValue)}const L=this.templateSrv.replace(h.query,T?.scopedVars,(R=[],G)=>this.interpolateQueryExpr(R,G,h.query));return(0,Ja.s)(this._seriesQuery(L,T)).then(R=>this.responseParser.parse(h.query,R))}toMetricFindValue(h){const T=new Map;return h?.data?.forEach(L=>{if(L&&L.length>0){let R=L.fields.find(G=>G.type===nr.PU.string);R||(R=L.fields.find(G=>G.type!==nr.PU.time)),R&&R.values.forEach(G=>{T.set(G.toString(),{text:G.toString()})})}}),Array.from(T.values())}getTagKeys(h){const T=Pa({type:"TAG_KEYS",templateService:this.templateSrv,database:this.database,withTimeFilter:this.showTagTime});return this.metricFindQuery({refId:"get-tag-keys",query:T})}getTagValues(h){const T=Pa({type:"TAG_VALUES",templateService:this.templateSrv,database:this.database,withKey:h.key,withTimeFilter:this.showTagTime});return this.metricFindQuery({refId:"get-tag-values",query:T})}_seriesQuery(h,T){if(!h)return(0,Di.of)({results:[]});if(T&&T.range){const L=this.getTimeFilter({rangeRaw:T.range,timezone:T.timezone});h=h.replace("$timeFilter",L)}return this._influxRequest(this.httpMode,"/query",{q:h,epoch:"ms"},T)}serializeParams(h){return h?(0,D.reduce)(h,(T,L,R)=>(L==null||T.push(encodeURIComponent(R)+"="+encodeURIComponent(L)),T),[]).join("&"):""}_influxRequest(h,T,L,R){const G=this.urls.shift();this.urls.push(G);const ee={};this.username&&(ee.u=this.username,ee.p=this.password),R&&R.database?ee.db=R.database:this.database&&(ee.db=this.database),R?.policy&&R.policy!==Te&&(ee.rp=R.policy);const{q:ce}=L;h==="POST"&&(0,D.has)(L,"q")?((0,D.extend)(ee,(0,D.omit)(L,["q"])),L=this.serializeParams((0,D.pick)(L,["q"]))):(h==="GET"||h==="POST")&&((0,D.extend)(ee,L),L=null);const pe={method:h,url:G+T,params:ee,data:L,precision:"ms",inspect:{type:"influxdb"},paramSerializer:this.serializeParams};return pe.headers=pe.headers||{},(this.basicAuth||this.withCredentials)&&(pe.withCredentials=!0),this.basicAuth&&(pe.headers.Authorization=this.basicAuth),h==="POST"&&(pe.headers["Content-type"]="application/x-www-form-urlencoded"),(0,so.AI)().fetch(pe).pipe((0,bi.T)(Ee=>{const{data:Be}=Ee;if(Be&&(Be.executedQueryString=ce,Be.results)){const be=Ee.data.results.filter(Ft=>Ft.error);if(be.length>0)throw{message:"InfluxDB Error: "+be[0].error,data:Be}}return Be}),(0,Cc.W)(Ee=>Ee.cancelled?(0,Di.of)(Ee):(0,aa.$)(this.handleErrors(Ee))))}handleErrors(h){const T={message:h&&h.status||h&&h.message||"Unknown error during query transaction. Please check JS console logs."};return(Number.isInteger(h.status)&&h.status!==0||h.status>=300)&&(h.data&&h.data.error?(T.message="InfluxDB Error: "+h.data.error,T.data=h.data,T.config=h.config):(T.message="Network Error: "+h.statusText+"("+h.status+")",T.data=h.data,T.config=h.config)),T}getTimeFilter(h){const T=this.getInfluxTime(h.rangeRaw.from,!1,h.timezone),L=this.getInfluxTime(h.rangeRaw.to,!0,h.timezone);return"time >= "+T+" and time <= "+L}getInfluxTime(h,T,L){let R;if((0,D.isString)(h)){if(h==="now")return"now()";const G=/^now-(\d+)([dhms])$/.exec(h);if(G){const ee=parseInt(G[1],10),ce=G[2];return"now() - "+ee+ce}if(R=Pi.parse(h,T,L),!R)throw new Error("unable to parse date");h=R}return h.valueOf()+"ms"}isMigrationToggleOnAndIsAccessProxy(){return Da.Ay.featureToggles.influxdbBackendMigration&&this.access==="proxy"}classicQuery(h){let T=this.getTimeFilter(h);const L=h.scopedVars,R=(0,D.cloneDeep)(h.targets),G=[];let ee,ce,pe=(0,D.map)(R,be=>be.hide?"":(G.push(be),L.interval=L.__interval,new xn(be,this.templateSrv,L).render(!0))).reduce((be,Ft)=>(Ft!==""&&(be+=";"+Ft),be));if(pe==="")return(0,Di.of)({data:[]});const Ee=h.filters,Be=h.targets.flatMap(be=>be.adhocFilters??[]);if(Ee?.length||Be?.length){const be=Ee?.length?Ee:Be,Ft=new xn({refId:"A"},this.templateSrv,L);T+=" AND "+Ft.renderAdhocFilters(be)}return L.timeFilter={value:T},pe=this.templateSrv.replace(pe,L),this._seriesQuery(pe,h).pipe((0,bi.T)(be=>{if(!be||!be.results)return{data:[]};const Ft=[];for(ee=0;ee<be.results.length;ee++){const Qe=be.results[ee];if(!Qe||!Qe.series)continue;const St=G[ee];let Gt=St.alias;Gt&&(Gt=this.templateSrv.replace(St.alias,h.scopedVars));const Tt={executedQueryString:be.executedQueryString},Rt=new Rs({refId:St.refId,series:be.results[ee].series,alias:Gt,meta:Tt});switch(St.resultFormat){case"logs":Tt.preferredVisualisationType="logs";case"table":{Ft.push(Rt.getTable());break}default:{const Yr=Rt.getTimeSeries();for(ce=0;ce<Yr.length;ce++)Ft.push(xr(Yr[ce]));break}}}return{data:Ft}}))}async annotationEvents(h,T){if(this.version===B.Flux)return Promise.reject({message:"Flux requires the standard annotation query"});if(!T.query)return Promise.reject({message:"Query missing in annotation definition"});if(this.isMigrationToggleOnAndIsAccessProxy()){const G={refId:"metricFindQuery",datasource:this.getRef(),query:this.templateSrv.replace(T.query,void 0,(ee=[],ce)=>this.interpolateQueryExpr(ee,ce,T.query)),rawQuery:!0};return(0,Ja.s)((0,so.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:h.range.from.valueOf().toString(),to:h.range.to.valueOf().toString(),queries:[G]},requestId:T.name}).pipe((0,bi.T)(async ee=>await this.responseParser.transformAnnotationResponse(T,ee,G))))}const L=this.getTimeFilter({rangeRaw:h.range.raw,timezone:h.timezone});let R=T.query.replace("$timeFilter",L);return R=this.templateSrv.replace(R,void 0,(G=[],ee)=>this.interpolateQueryExpr(G,ee,R)),(0,Ja.s)(this._seriesQuery(R,h)).then(G=>{if(!G||!G.results||!G.results[0])throw{message:"No results in response from InfluxDB"};return new Rs({series:G.results[0].series,annotation:T}).getAnnotations()})}}function Rc(O){const h=O.find(L=>L!==null);if(h===void 0)return nr.PU.number;const T=typeof h;switch(T){case"string":return nr.PU.string;case"boolean":return nr.PU.boolean;case"number":return nr.PU.number;default:throw new Error(`InfluxQL: invalid value type ${T}`)}}function xr(O){const h=[],T=[],L=O.datapoints;for(const ce of L)T.push(ce[0]),h.push(ce[1]);const R={name:nr.LE,type:nr.PU.time,config:{},values:h},G={name:nr.Bc,type:Rc(T),config:{displayNameFromDS:O.title},values:T,labels:O.tags},ee=[R,G];return{name:O.target,refId:O.refId,meta:O.meta,fields:ee,length:T.length}}const ar=j.$.featureToggles.newInfluxDSConfigPageDesign?va:mt,_s=new V.tD(Lc).setConfigEditor(ar).setQueryEditor(Hu).setQueryEditorHelp(xs)},18678:function(ue,he,b){var V,j;(function(g,D){V=D,j=typeof V=="function"?V.call(he,b,he,ue):V,j!==void 0&&(ue.exports=j)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"});function g(x){for(var I=[],M=0,P=x.length;M<P;M++)I.indexOf(x[M])===-1&&I.push(x[M]);return I}var D={},z={"==":function(x,I){return x==I},"===":function(x,I){return x===I},"!=":function(x,I){return x!=I},"!==":function(x,I){return x!==I},">":function(x,I){return x>I},">=":function(x,I){return x>=I},"<":function(x,I,M){return M===void 0?x<I:x<I&&I<M},"<=":function(x,I,M){return M===void 0?x<=I:x<=I&&I<=M},"!!":function(x){return D.truthy(x)},"!":function(x){return!D.truthy(x)},"%":function(x,I){return x%I},log:function(x){return console.log(x),x},in:function(x,I){return!I||typeof I.indexOf>"u"?!1:I.indexOf(x)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(x,I,M){if(M<0){var P=String(x).substr(I);return P.substr(0,P.length+M)}return String(x).substr(I,M)},"+":function(){return Array.prototype.reduce.call(arguments,function(x,I){return parseFloat(x,10)+parseFloat(I,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(x,I){return parseFloat(x,10)*parseFloat(I,10)})},"-":function(x,I){return I===void 0?-x:x-I},"/":function(x,I){return x/I},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(x,I){return x.concat(I)},[])},var:function(x,I){var M=I===void 0?null:I,P=this;if(typeof x>"u"||x===""||x===null)return P;for(var Q=String(x).split("."),Z=0;Z<Q.length;Z++)if(P==null||(P=P[Q[Z]],P===void 0))return M;return P},missing:function(){for(var x=[],I=Array.isArray(arguments[0])?arguments[0]:arguments,M=0;M<I.length;M++){var P=I[M],Q=D.apply({var:P},this);(Q===null||Q==="")&&x.push(P)}return x},missing_some:function(x,I){var M=D.apply({missing:I},this);return I.length-M.length>=x?[]:M}};return D.is_logic=function(x){return typeof x=="object"&&x!==null&&!Array.isArray(x)&&Object.keys(x).length===1},D.truthy=function(x){return Array.isArray(x)&&x.length===0?!1:!!x},D.get_operator=function(x){return Object.keys(x)[0]},D.get_values=function(x){return x[D.get_operator(x)]},D.apply=function(x,I){if(Array.isArray(x))return x.map(function(me){return D.apply(me,I)});if(!D.is_logic(x))return x;var M=D.get_operator(x),P=x[M],Q,Z,k,q,oe;if(Array.isArray(P)||(P=[P]),M==="if"||M=="?:"){for(Q=0;Q<P.length-1;Q+=2)if(D.truthy(D.apply(P[Q],I)))return D.apply(P[Q+1],I);return P.length===Q+1?D.apply(P[Q],I):null}else if(M==="and"){for(Q=0;Q<P.length;Q+=1)if(Z=D.apply(P[Q],I),!D.truthy(Z))return Z;return Z}else if(M==="or"){for(Q=0;Q<P.length;Q+=1)if(Z=D.apply(P[Q],I),D.truthy(Z))return Z;return Z}else{if(M==="filter")return q=D.apply(P[0],I),k=P[1],Array.isArray(q)?q.filter(function(me){return D.truthy(D.apply(k,me))}):[];if(M==="map")return q=D.apply(P[0],I),k=P[1],Array.isArray(q)?q.map(function(me){return D.apply(k,me)}):[];if(M==="reduce")return q=D.apply(P[0],I),k=P[1],oe=typeof P[2]<"u"?P[2]:null,Array.isArray(q)?q.reduce(function(me,Le){return D.apply(k,{current:Le,accumulator:me})},oe):oe;if(M==="all"){if(q=D.apply(P[0],I),k=P[1],!Array.isArray(q)||!q.length)return!1;for(Q=0;Q<q.length;Q+=1)if(!D.truthy(D.apply(k,q[Q])))return!1;return!0}else if(M==="none"){if(q=D.apply(P[0],I),k=P[1],!Array.isArray(q)||!q.length)return!0;for(Q=0;Q<q.length;Q+=1)if(D.truthy(D.apply(k,q[Q])))return!1;return!0}else if(M==="some"){if(q=D.apply(P[0],I),k=P[1],!Array.isArray(q)||!q.length)return!1;for(Q=0;Q<q.length;Q+=1)if(D.truthy(D.apply(k,q[Q])))return!0;return!1}}if(P=P.map(function(me){return D.apply(me,I)}),z.hasOwnProperty(M)&&typeof z[M]=="function")return z[M].apply(I,P);if(M.indexOf(".")>0){var Te=String(M).split("."),B=z;for(Q=0;Q<Te.length;Q++){if(!B.hasOwnProperty(Te[Q]))throw new Error("Unrecognized operation "+M+" (failed at "+Te.slice(0,Q+1).join(".")+")");B=B[Te[Q]]}return B.apply(I,P)}throw new Error("Unrecognized operation "+M)},D.uses_data=function(x){var I=[];if(D.is_logic(x)){var M=D.get_operator(x),P=x[M];Array.isArray(P)||(P=[P]),M==="var"?I.push(P[0]):P.forEach(function(Q){I.push.apply(I,D.uses_data(Q))})}return g(I)},D.add_operation=function(x,I){z[x]=I},D.rm_operation=function(x){delete z[x]},D.rule_like=function(x,I){if(I===x||I==="@")return!0;if(I==="number")return typeof x=="number";if(I==="string")return typeof x=="string";if(I==="array")return Array.isArray(x)&&!D.is_logic(x);if(D.is_logic(I)){if(D.is_logic(x)){var M=D.get_operator(I),P=D.get_operator(x);if(M==="@"||M===P)return D.rule_like(D.get_values(x,!1),D.get_values(I,!1))}return!1}if(Array.isArray(I))if(Array.isArray(x)){if(I.length!==x.length)return!1;for(var Q=0;Q<I.length;Q+=1)if(!D.rule_like(x[Q],I[Q]))return!1;return!0}else return!1;return!1},D})},87805:(ue,he,b)=>{var V=b(43360),j=b(75288);function g(D,z,x){(x!==void 0&&!j(D[z],x)||x===void 0&&!(z in D))&&V(D,z,x)}ue.exports=g},85250:(ue,he,b)=>{var V=b(37217),j=b(87805),g=b(86649),D=b(20443),z=b(23805),x=b(37241),I=b(14974);function M(P,Q,Z,k,q){P!==Q&&g(Q,function(oe,Te){if(q||(q=new V),z(oe))D(P,Q,Te,Z,M,k,q);else{var B=k?k(I(P,Te),oe,Te+"",P,Q,q):void 0;B===void 0&&(B=oe),j(P,Te,B)}},x)}ue.exports=M},20443:(ue,he,b)=>{var V=b(87805),j=b(93290),g=b(71961),D=b(23007),z=b(35529),x=b(72428),I=b(56449),M=b(83693),P=b(3656),Q=b(1882),Z=b(23805),k=b(11331),q=b(37167),oe=b(14974),Te=b(47503);function B(me,Le,Ue,Ie,st,qe,xt){var Ne=oe(me,Ue),ot=oe(Le,Ue),rt=xt.get(ot);if(rt){V(me,Ue,rt);return}var We=qe?qe(Ne,ot,Ue+"",me,Le,xt):void 0,pt=We===void 0;if(pt){var nt=I(ot),Xt=!nt&&P(ot),Re=!nt&&!Xt&&q(ot);We=ot,nt||Xt||Re?I(Ne)?We=Ne:M(Ne)?We=D(Ne):Xt?(pt=!1,We=j(ot,!0)):Re?(pt=!1,We=g(ot,!0)):We=[]:k(ot)||x(ot)?(We=Ne,x(Ne)?We=Te(Ne):(!Z(Ne)||Q(Ne))&&(We=z(ot))):pt=!1}pt&&(xt.set(ot,We),st(We,ot,Ie,qe,xt),xt.delete(ot)),V(me,Ue,We)}ue.exports=B},69302:(ue,he,b)=>{var V=b(83488),j=b(56757),g=b(32865);function D(z,x){return g(j(z,x,V),z+"")}ue.exports=D},20999:(ue,he,b)=>{var V=b(69302),j=b(36800);function g(D){return V(function(z,x){var I=-1,M=x.length,P=M>1?x[M-1]:void 0,Q=M>2?x[2]:void 0;for(P=D.length>3&&typeof P=="function"?(M--,P):void 0,Q&&j(x[0],x[1],Q)&&(P=M<3?void 0:P,M=1),z=Object(z);++I<M;){var Z=x[I];Z&&D(z,Z,I,P)}return z})}ue.exports=g},14974:ue=>{function he(b,V){if(!(V==="constructor"&&typeof b[V]=="function")&&V!="__proto__")return b[V]}ue.exports=he},83693:(ue,he,b)=>{var V=b(64894),j=b(40346);function g(D){return j(D)&&V(D)}ue.exports=g},73916:(ue,he,b)=>{var V=b(43360),j=b(30641),g=b(15389);function D(z,x){var I={};return x=g(x,3),j(z,function(M,P,Q){V(I,P,x(M,P,Q))}),I}ue.exports=D},55364:(ue,he,b)=>{var V=b(85250),j=b(20999),g=j(function(D,z,x){V(D,z,x)});ue.exports=g},6924:(ue,he,b)=>{var V=b(85250),j=b(20999),g=j(function(D,z,x,I){V(D,z,x,I)});ue.exports=g},71086:(ue,he,b)=>{var V=b(34932),j=b(15389),g=b(97420),D=b(83349);function z(x,I){if(x==null)return{};var M=V(D(x),function(P){return[P]});return I=j(I),g(x,M,function(P,Q){return I(P,Q[0])})}ue.exports=z},22331:(ue,he,b)=>{var V=b(9514),j=b(77556),g=b(61489),D=b(13222);function z(x,I,M){return x=D(x),M=M==null?0:V(g(M),0,x.length),I=j(I),x.slice(M,M+I.length)==I}ue.exports=z},47503:(ue,he,b)=>{var V=b(21791),j=b(37241);function g(D){return V(D,j(D))}ue.exports=g},21450:function(ue){(function(b,V){ue.exports=V()})(this,function(){return function(he){var b={};function V(j){if(b[j])return b[j].exports;var g=b[j]={i:j,l:!1,exports:{}};return he[j].call(g.exports,g,g.exports,V),g.l=!0,g.exports}return V.m=he,V.c=b,V.d=function(j,g,D){V.o(j,g)||Object.defineProperty(j,g,{configurable:!1,enumerable:!0,get:D})},V.n=function(j){var g=j&&j.__esModule?function(){return j.default}:function(){return j};return V.d(g,"a",g),g},V.o=function(j,g){return Object.prototype.hasOwnProperty.call(j,g)},V.p="",V(V.s=3)}([function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0});function j(D,z){var x={},I=D||"Abstract",M=[],P=null,Q;if(x._type=I,x.getType=function(){return I},x.setType=function(oe){I=oe},x.getChildren=function(){return M},x.addChild=function(oe){if(oe){if(!oe.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(oe)};oe.setParent(x),M.push(oe)}},x.getParent=function(){return P},x.setParent=function(oe){P=oe},x.getContext=function(oe){return Q||oe.activeContext.peek()},x.setContext=function(oe){Q=oe},x.getStartPosition=function(){return z>>16},x.getEndPosition=function(){return z&65535},x.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},x.toString=function(){var oe="Kind: "+x.getType();oe+=", Children: [";for(var Te=0,B=x.getChildren().length;Te<B;Te+=1)oe+="{"+x.getChildren()[Te]+"}, ";return oe+="]",oe},z===0)throw{name:"Error",message:"Position cannot be 0"};for(var Z=arguments.length,k=Array(Z>2?Z-2:0),q=2;q<Z;q++)k[q-2]=arguments[q];return k&&k.forEach(function(oe){x.addChild(oe)}),x}var g=b.SpelNode={create:j}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Stack=j;function j(g){this.elements=g||[]}j.prototype.push=function(g){return this.elements.push(g),g},j.prototype.pop=function(){return this.elements.pop()},j.prototype.peek=function(){return this.elements[this.elements.length-1]},j.prototype.empty=function(){return this.elements.length>0},j.prototype.search=function(g){return this.elements.length-this.elements.indexOf(g)}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var j={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function g(z){this.type=z,this.tokenChars=j[z],this._hasPayload=typeof j[z]!="string",typeof j[z]=="number"&&(this._ordinal=j[z])}for(var D in j)j.hasOwnProperty(D)&&(g[D]=new g(D));g.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},g.prototype.getLength=function(){return this.tokenChars.length},g.prototype.hasPayload=function(){return this._hasPayload},g.prototype.valueOf=function(z){for(var x in j)if(j.hasOwnProperty(x)&&j[x]===z)return g[x]},g.prototype.ordinal=function(){return this._ordinal},b.TokenKind=g},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StandardContext=b.SpelExpressionEvaluator=void 0;var j=V(4),g=V(50);b.SpelExpressionEvaluator=j.SpelExpressionEvaluator,b.StandardContext=g.StandardContext},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.SpelExpressionEvaluator=void 0;var j=V(5),g=V(1),D={};function z(x,I,M){var P=new g.Stack,Q;return I||(I={}),P.push(I),Q={rootContext:I,activeContext:P,locals:M},x.getValue(Q)}D.compile=function(x){var I=(0,j.SpelExpressionParser)().parse(x);return{eval:function(P,Q){return z(I,P,Q)},_compiledExpression:I}},D.eval=function(x,I,M){return D.compile(x).eval(I,M)},b.SpelExpressionEvaluator=D},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.SpelExpressionParser=void 0;var j=V(2),g=V(6),D=V(8),z=V(9),x=V(10),I=V(11),M=V(12),P=V(13),Q=V(14),Z=V(15),k=V(16),q=V(17),oe=V(18),Te=V(19),B=V(20),me=V(21),Le=V(22),Ue=V(23),Ie=V(24),st=V(25),qe=V(26),xt=V(27),Ne=V(28),ot=V(29),rt=V(30),We=V(31),pt=V(32),nt=V(33),Xt=V(34),Re=V(35),je=V(36),ft=V(37),He=V(38),U=V(39),Ye=V(40),Zt=V(41),zr=V(42),Se=V(43),Me=V(44),Dt=V(45),mt=V(46),sr=V(47),wr=V(48),Ce=V(49),Kr=b.SpelExpressionParser=function(){var qr=new RegExp("[\\p{L}\\p{N}_$]+"),Pe,jn=[],Vt,tr,mr,Et;function In(te){Pe=te}function sn(te,ge){try{Vt=te,tr=g.Tokenizer.tokenize(te),mr=tr.length,Et=0,jn=[];var Ae=yr();return va()&&pr(at().startPos,"MORE_INPUT",Pt().toString()),Ae}catch(gt){throw gt.message}}function yr(){var te=An();if(va()){var ge=at();if(ge.getKind()===j.TokenKind.ASSIGN){te===null&&(te=I.NullLiteral.create(Pr(ge.startPos-1,ge.endPos-1))),Pt();var Ae=An();return oe.Assign.create(lt(ge),te,Ae)}if(ge.getKind()===j.TokenKind.ELVIS){te===null&&(te=I.NullLiteral.create(Pr(ge.startPos-1,ge.endPos-2))),Pt();var gt=yr();return gt===null&&(gt=I.NullLiteral.create(Pr(ge.startPos+1,ge.endPos+1))),He.Elvis.create(lt(ge),te,gt)}if(ge.getKind()===j.TokenKind.QMARK){te===null&&(te=I.NullLiteral.create(Pr(ge.startPos-1,ge.endPos-1))),Pt();var Qr=yr();vt(j.TokenKind.COLON);var dr=yr();return ft.Ternary.create(lt(ge),te,Qr,dr)}}return te}function An(){for(var te=_n();na("or")||jt(j.TokenKind.SYMBOLIC_OR);){var ge=Pt(),Ae=_n();dn(ge,te,Ae),te=Re.OpOr.create(lt(ge),te,Ae)}return te}function _n(){for(var te=hi();na("and")||jt(j.TokenKind.SYMBOLIC_AND);){var ge=Pt(),Ae=hi();dn(ge,te,Ae),te=Xt.OpAnd.create(lt(ge),te,Ae)}return te}function hi(){var te=ca(),ge=At();if(ge!==null){var Ae=Pt(),gt=ca();dn(Ae,te,gt);var Qr=ge.kind;if(ge.isNumericRelationalOperator()){var dr=lt(Ae);return Qr===j.TokenKind.GT?Le.OpGT.create(dr,te,gt):Qr===j.TokenKind.LT?Ie.OpLT.create(dr,te,gt):Qr===j.TokenKind.LE?Ue.OpLE.create(dr,te,gt):Qr===j.TokenKind.GE?me.OpGE.create(dr,te,gt):Qr===j.TokenKind.EQ?Te.OpEQ.create(dr,te,gt):B.OpNE.create(dr,te,gt)}return Qr===j.TokenKind.INSTANCEOF?Se.OpInstanceof.create(lt(Ae),te,gt):Qr===j.TokenKind.MATCHES?je.OpMatches.create(lt(Ae),te,gt):Me.OpBetween.create(lt(Ae),te,gt)}return te}function ca(){for(var te=ea();$n(j.TokenKind.PLUS,j.TokenKind.MINUS,j.TokenKind.INC);){var ge=Pt(),Ae=ea();wn(ge,Ae),ge.getKind()===j.TokenKind.PLUS?te=st.OpPlus.create(lt(ge),te,Ae):ge.getKind()===j.TokenKind.MINUS&&(te=qe.OpMinus.create(lt(ge),te,Ae))}return te}function ea(){for(var te=da();$n(j.TokenKind.STAR,j.TokenKind.DIV,j.TokenKind.MOD);){var ge=Pt(),Ae=da();dn(ge,te,Ae),ge.getKind()===j.TokenKind.STAR?te=xt.OpMultiply.create(lt(ge),te,Ae):ge.getKind()===j.TokenKind.DIV?te=Ne.OpDivide.create(lt(ge),te,Ae):te=ot.OpModulus.create(lt(ge),te,Ae)}return te}function da(){var te=Ra(),ge;if(jt(j.TokenKind.POWER)){ge=Pt();var Ae=Ra();return wn(ge,Ae),rt.OpPower.create(lt(ge),te,Ae)}return te!==null&&$n(j.TokenKind.INC,j.TokenKind.DEC)?(ge=Pt(),ge.getKind()===j.TokenKind.INC?We.OpInc.create(lt(ge),!0,te):pt.OpDec.create(lt(ge),!0,te)):te}function Ra(){var te,ge;return $n(j.TokenKind.PLUS,j.TokenKind.MINUS,j.TokenKind.NOT)?(te=Pt(),ge=Ra(),te.getKind()===j.TokenKind.NOT?nt.OpNot.create(lt(te),ge):te.getKind()===j.TokenKind.PLUS?st.OpPlus.create(lt(te),ge):qe.OpMinus.create(lt(te),ge)):$n(j.TokenKind.INC,j.TokenKind.DEC)?(te=Pt(),ge=Ra(),te.getKind()===j.TokenKind.INC?We.OpInc.create(lt(te),!1,ge):pt.OpDec.create(lt(te),!1,ge)):Zi()}function Zi(){var te=[],ge=un();for(te.push(ge);eo();)te.push(cn());return te.length===1?te[0]:k.CompoundExpression.create(Pr(ge.getStartPosition(),te[te.length-1].getEndPosition()),te)}function eo(){var te=null;return $n(j.TokenKind.DOT,j.TokenKind.SAFE_NAVI)?te=to():te=Dr(),te===null?!1:(Lt(te),!0)}function Dr(){return jt(j.TokenKind.LSQUARE)&&Un()?cn():null}function to(){var te=Pt(),ge=te.getKind()===j.TokenKind.SAFE_NAVI;return En(ge)||Qt()||ja(ge)||tn(ge)?cn():(at()===null?pr(te.startPos,"OOD"):pr(te.startPos,"UNEXPECTED_DATA_AFTER_DOT",ct(at())),null)}function Qt(){if(!jt(j.TokenKind.HASH))return!1;var te=Pt(),ge=vt(j.TokenKind.IDENTIFIER),Ae=mi();return Ae===null?(Lt(Z.VariableReference.create(ge.data,Pr(te.startPos,ge.endPos))),!0):(Lt(M.FunctionReference.create(ge.data,Pr(te.startPos,ge.endPos),Ae)),!0)}function mi(){if(!jt(j.TokenKind.LPAREN))return null;var te=[];return fa(te),vt(j.TokenKind.RPAREN),te}function jr(te){jt(j.TokenKind.LPAREN)||pr(lt(at()),"MISSING_CONSTRUCTOR_ARGS"),fa(te),vt(j.TokenKind.RPAREN)}function fa(te){var ge=at().startPos,Ae;do{Pt();var gt=at();gt===null&&pr(ge,"RUN_OUT_OF_ARGUMENTS"),gt.getKind()!==j.TokenKind.RPAREN&&te.push(yr()),Ae=at()}while(Ae!==null&&Ae.kind===j.TokenKind.COMMA);Ae===null&&pr(ge,"RUN_OUT_OF_ARGUMENTS")}function ur(te){return te===null?Vt.length:te.startPos}function un(){return no()||za()||pa()||ro()||Sn()||En(!1)||Qt()||ta()||ja(!1)||tn(!1)||Un()||yi()?cn():null}function ta(){if(jt(j.TokenKind.BEAN_REF)){var te=Pt(),ge=null,Ae=null;jt(j.TokenKind.IDENTIFIER)?(ge=vt(j.TokenKind.IDENTIFIER),Ae=ge.data):jt(j.TokenKind.LITERAL_STRING)?(ge=vt(j.TokenKind.LITERAL_STRING),Ae=ge.stringValue(),Ae=Ae.substring(1,Ae.length()-1)):pr(te.startPos,"INVALID_BEAN_REFERENCE");var gt=mt.BeanReference.create(lt(ge),Ae);return Lt(gt),!0}return!1}function pa(){if(jt(j.TokenKind.IDENTIFIER)){var te=at();if(te.stringValue()!=="T")return!1;var ge=Pt();if(jt(j.TokenKind.RSQUARE))return Lt(Q.PropertyReference.create(ge.stringValue(),lt(ge))),!0;vt(j.TokenKind.LPAREN);for(var Ae=ra(),gt=0;Hr(j.TokenKind.LSQUARE,!0);)vt(j.TokenKind.RSQUARE),gt++;return vt(j.TokenKind.RPAREN),Lt(Dt.TypeReference.create(lt(te),Ae,gt)),!0}return!1}function ro(){if(jt(j.TokenKind.IDENTIFIER)){var te=at();return te.stringValue().toLowerCase()!=="null"?!1:(Pt(),Lt(I.NullLiteral.create(lt(te))),!0)}return!1}function ja(te){var ge=at();if(!Hr(j.TokenKind.PROJECT,!0))return!1;var Ae=yr();return vt(j.TokenKind.RSQUARE),Lt(zr.Projection.create(te,lt(ge),Ae)),!0}function yi(){var te=at(),ge=[];if(!Hr(j.TokenKind.LCURLY,!0))return!1;var Ae=null,gt=at();if(Hr(j.TokenKind.RCURLY,!0))Ae=U.InlineList.create(Pr(te.startPos,gt.endPos));else if(Hr(j.TokenKind.COLON,!0))gt=vt(j.TokenKind.RCURLY),Ae=Ye.InlineMap.create(Pr(te.startPos,gt.endPos));else{var Qr=yr();if(jt(j.TokenKind.RCURLY))ge.push(Qr),gt=vt(j.TokenKind.RCURLY),Ae=U.InlineList.create(Pr(te.startPos,gt.endPos),ge);else if(Hr(j.TokenKind.COMMA,!0)){ge.push(Qr);do ge.push(yr());while(Hr(j.TokenKind.COMMA,!0));gt=vt(j.TokenKind.RCURLY),Ae=U.InlineList.create(lt(te.startPos,gt.endPos),ge)}else if(Hr(j.TokenKind.COLON,!0)){var dr=[];for(dr.push(Qr),dr.push(yr());Hr(j.TokenKind.COMMA,!0);)dr.push(yr()),vt(j.TokenKind.COLON),dr.push(yr());gt=vt(j.TokenKind.RCURLY),Ae=Ye.InlineMap.create(Pr(te.startPos,gt.endPos),dr)}else pr(te.startPos,"OOD")}return Lt(Ae),!0}function Un(){var te=at();if(!Hr(j.TokenKind.LSQUARE,!0))return!1;var ge=yr();return vt(j.TokenKind.RSQUARE),Lt(q.Indexer.create(lt(te),ge)),!0}function tn(te){var ge=at();if(!Ka())return!1;Pt();var Ae=yr();return Ae===null&&pr(lt(ge),"MISSING_SELECTION_EXPRESSION"),vt(j.TokenKind.RSQUARE),ge.getKind()===j.TokenKind.SELECT_FIRST?Lt(Zt.Selection.create(te,Zt.Selection.FIRST,lt(ge),Ae)):ge.getKind()===j.TokenKind.SELECT_LAST?Lt(Zt.Selection.create(te,Zt.Selection.LAST,lt(ge),Ae)):Lt(Zt.Selection.create(te,Zt.Selection.ALL,lt(ge),Ae)),!0}function ra(){for(var te=[],ge=at();ln(ge);)Pt(),ge.kind!==j.TokenKind.DOT&&te.push(sr.Identifier.create(ge.stringValue(),lt(ge))),ge=at();te.length||(ge===null&&pr(Vt.length(),"OOD"),pr(ge.startPos,"NOT_EXPECTED_TOKEN","qualified ID",ge.getKind().toString().toLowerCase()));var Ae=Pr(te[0].getStartPosition(),te[te.length-1].getEndPosition());return wr.QualifiedIdentifier.create(Ae,te)}function ln(te){if(te===null||te.kind===j.TokenKind.LITERAL_STRING)return!1;if(te.kind===j.TokenKind.DOT||te.kind===j.TokenKind.IDENTIFIER)return!0;var ge=te.stringValue();return ge&&ge.length&&qr.test(ge)}function En(te){if(jt(j.TokenKind.IDENTIFIER)){var ge=Pt(),Ae=mi();return Ae===null?(Lt(Q.PropertyReference.create(te,ge.stringValue(),lt(ge))),!0):(Lt(P.MethodReference.create(te,ge.stringValue(),lt(ge),Ae)),!0)}return!1}function Sn(){if(na("new")){var te=Pt();if(jt(j.TokenKind.RSQUARE))return Lt(Q.PropertyReference.create(te.stringValue(),lt(te))),!0;var ge=ra(),Ae=[];if(Ae.push(ge),jt(j.TokenKind.LSQUARE)){for(var gt=[];Hr(j.TokenKind.LSQUARE,!0);)jt(j.TokenKind.RSQUARE)?gt.push(null):gt.push(yr()),vt(j.TokenKind.RSQUARE);yi()&&Ae.push(cn()),Lt(Ce.ConstructorReference.create(lt(te),gt,Ae))}else jr(Ae),Lt(Ce.ConstructorReference.create(lt(te),Ae));return!0}return!1}function Lt(te){jn.push(te)}function cn(){return jn.pop()}function no(){var te=at();if(te===null)return!1;if(te.getKind()===j.TokenKind.LITERAL_INT||te.getKind()===j.TokenKind.LITERAL_LONG)Lt(z.NumberLiteral.create(parseInt(te.stringValue(),10),lt(te)));else if(te.getKind()===j.TokenKind.LITERAL_REAL||te.getKind()===j.TokenKind.LITERAL_REAL_FLOAT)Lt(z.NumberLiteral.create(parseFloat(te.stringValue()),lt(te)));else if(te.getKind()===j.TokenKind.LITERAL_HEXINT||te.getKind()===j.TokenKind.LITERAL_HEXLONG)Lt(z.NumberLiteral.create(parseInt(te.stringValue(),16),lt(te)));else if(na("true"))Lt(D.BooleanLiteral.create(!0,lt(te)));else if(na("false"))Lt(D.BooleanLiteral.create(!1,lt(te)));else if(te.getKind()===j.TokenKind.LITERAL_STRING)Lt(x.StringLiteral.create(te.stringValue(),lt(te)));else return!1;return Pt(),!0}function za(){if(jt(j.TokenKind.LPAREN)){Pt();var te=yr();return vt(j.TokenKind.RPAREN),Lt(te),!0}else return!1}function At(){var te=at();if(te===null)return null;if(te.isNumericRelationalOperator())return te;if(te.isIdentifier()){var ge=te.stringValue();if(ge.toLowerCase()==="instanceof")return te.asInstanceOfToken();if(ge.toLowerCase()==="matches")return te.asMatchesToken();if(ge.toLowerCase()==="between")return te.asBetweenToken()}return null}function vt(te){var ge=Pt();return ge===null&&pr(Vt.length,"OOD"),ge.getKind()!==te&&pr(ge.startPos,"NOT_EXPECTED_TOKEN",te.toString().toLowerCase(),ge.getKind().toString().toLowerCase()),ge}function jt(te){return Hr(te,!1)}function Hr(te,ge){if(!va())return!1;var Ae=at();return Ae.getKind()===te?(ge&&Et++,!0):te===j.TokenKind.IDENTIFIER&&Ae.getKind().ordinal()>=j.TokenKind.DIV.ordinal()&&Ae.getKind().ordinal()<=j.TokenKind.NOT.ordinal()&&Ae.data!==null}function $n(){if(!va())return!1;for(var te=at(),ge=Array.prototype.slice.call(arguments),Ae=0,gt=ge.length;Ae<gt;Ae+=1)if(te.getKind()===ge[Ae])return!0;return!1}function na(te){if(!va())return!1;var ge=at();return ge.getKind()===j.TokenKind.IDENTIFIER&&ge.stringValue().toLowerCase()===te.toLowerCase()}function Ka(){if(!va())return!1;var te=at();return te.getKind()===j.TokenKind.SELECT||te.getKind()===j.TokenKind.SELECT_FIRST||te.getKind()===j.TokenKind.SELECT_LAST}function va(){return Et<tr.length}function Pt(){return Et>=mr?null:tr[Et++]}function at(){return Et>=mr?null:tr[Et]}function pr(te,ge,Ae,gt){throw Ae&&(ge+=`
Expected: `+Ae),gt&&(ge+=`
Actual: `+gt),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+Vt+"' at position "+te+". Message: "+ge}}function ct(te){return te.getKind().hasPayload()?te.stringValue():te.getKind().toString().toLowerCase()}function dn(te,ge,Ae){Ot(te,ge),wn(te,Ae)}function Ot(te,ge){ge===null&&pr(te.startPos,"LEFT_OPERAND_PROBLEM")}function wn(te,ge){ge===null&&pr(te.startPos,"RIGHT_OPERAND_PROBLEM")}function lt(te){return(te.startPos<<16)+te.endPos}function Pr(te,ge){return(te<<16)+ge}return{setConfiguration:In,parse:sn}}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Tokenizer=void 0;var j=V(7),g=V(2),D=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],z=[],x=1,I=2,M=4;function P(){var k;for(k=48;k<=57;k+=1)z[k]|=x|I;for(k=65;k<=70;k+=1)z[k]|=I;for(k=97;k<=102;k+=1)z[k]|=I;for(k=65;k<=90;k+=1)z[k]|=M;for(k=97;k<=122;k+=1)z[k]|=M}P();function Q(k){var q=k,oe=k+"\0",Te=oe.length,B=0,me=[];function Le(){for(var Me;B<Te;)if(Me=oe[B],zr(Me))qe();else switch(Me){case"+":We(g.TokenKind.INC)?nt(g.TokenKind.INC):pt(g.TokenKind.PLUS);break;case"_":qe();break;case"-":We(g.TokenKind.DEC)?nt(g.TokenKind.DEC):pt(g.TokenKind.MINUS);break;case":":pt(g.TokenKind.COLON);break;case".":pt(g.TokenKind.DOT);break;case",":pt(g.TokenKind.COMMA);break;case"*":pt(g.TokenKind.STAR);break;case"/":pt(g.TokenKind.DIV);break;case"%":pt(g.TokenKind.MOD);break;case"(":pt(g.TokenKind.LPAREN);break;case")":pt(g.TokenKind.RPAREN);break;case"[":pt(g.TokenKind.LSQUARE);break;case"#":pt(g.TokenKind.HASH);break;case"]":pt(g.TokenKind.RSQUARE);break;case"{":pt(g.TokenKind.LCURLY);break;case"}":pt(g.TokenKind.RCURLY);break;case"@":pt(g.TokenKind.BEAN_REF);break;case"^":We(g.TokenKind.SELECT_FIRST)?nt(g.TokenKind.SELECT_FIRST):pt(g.TokenKind.POWER);break;case"!":We(g.TokenKind.NE)?nt(g.TokenKind.NE):We(g.TokenKind.PROJECT)?nt(g.TokenKind.PROJECT):pt(g.TokenKind.NOT);break;case"=":We(g.TokenKind.EQ)?nt(g.TokenKind.EQ):pt(g.TokenKind.ASSIGN);break;case"&":if(!We(g.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+q+") at position "+B};nt(g.TokenKind.SYMBOLIC_AND);break;case"|":if(!We(g.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+q+") at position "+B};nt(g.TokenKind.SYMBOLIC_OR);break;case"?":We(g.TokenKind.SELECT)?nt(g.TokenKind.SELECT):We(g.TokenKind.ELVIS)?nt(g.TokenKind.ELVIS):We(g.TokenKind.SAFE_NAVI)?nt(g.TokenKind.SAFE_NAVI):pt(g.TokenKind.QMARK);break;case"$":We(g.TokenKind.SELECT_LAST)?nt(g.TokenKind.SELECT_LAST):qe();break;case">":We(g.TokenKind.GE)?nt(g.TokenKind.GE):pt(g.TokenKind.GT);break;case"<":We(g.TokenKind.LE)?nt(g.TokenKind.LE):pt(g.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":st(Me==="0");break;case" ":case"	":case"\r":case`
`:B+=1;break;case"'":Ue();break;case'"':Ie();break;case"\0":B+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+q+") at position "+B};default:throw{name:"SpelParseException",message:"Cannot handle character '"+Me+"' in expression ("+q+") at position "+B}}}function Ue(){for(var Me=B,Dt=!1,mt;!Dt;)if(B+=1,mt=oe[B],mt==="'"&&(oe[B+1]==="'"?B+=1:Dt=!0),mt.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+q+") at position "+B};B+=1,me.push(new j.Token(g.TokenKind.LITERAL_STRING,rt(Me,B),Me,B))}function Ie(){for(var Me=B,Dt=!1,mt;!Dt;)if(B+=1,mt=oe[B],mt==='"'&&(oe[B+1]==='"'?B+=1:Dt=!0),mt.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+q+") at position "+B};B+=1,me.push(new j.Token(g.TokenKind.LITERAL_STRING,rt(Me,B),Me,B))}function st(Me){var Dt=!1,mt=B,sr=oe[B+1],wr=sr==="x"||sr==="X",Ce,Kr,La,qr;if(Me&&wr){B=B+1;do B+=1;while(Se(oe[B]));je("L","l")?(Ne(rt(mt+2,B),!0,mt,B),B+=1):Ne(rt(mt+2,B),!1,mt,B);return}do B+=1;while(Zt(oe[B]));if(sr=oe[B],sr==="."){Dt=!0,Ce=B;do B+=1;while(Zt(oe[B]));if(B===Ce+1){B=Ce,xt(rt(mt,B),!1,mt,B);return}}if(Kr=B,je("L","l")){if(Dt)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+q+") at position "+B};xt(rt(mt,Kr),!0,mt,Kr),B+=1}else if(ft(oe[B])){Dt=!0,B+=1,La=oe[B],Ye(La)&&(B+=1);do B+=1;while(Zt(oe[B]));qr=!1,He(oe[B])?(qr=!0,B+=1,Kr=B):U(oe[B])&&(B+=1,Kr=B),ot(rt(mt,B),qr,mt,B)}else sr=oe[B],qr=!1,He(sr)?(Dt=!0,qr=!0,B+=1,Kr=B):U(sr)&&(Dt=!0,B+=1,Kr=B),Dt?ot(rt(mt,Kr),qr,mt,Kr):xt(rt(mt,Kr),!1,mt,Kr)}function qe(){var Me=B,Dt,mt,sr;do B+=1;while(Re(oe[B]));if(Dt=rt(Me,B),(B-Me===2||B-Me===3)&&(mt=Dt.toUpperCase(),sr=D.indexOf(mt),sr>=0)){Xt(g.TokenKind.valueOf(mt),Me,Dt);return}me.push(new j.Token(g.TokenKind.IDENTIFIER,Dt.replace("\0",""),Me,B))}function xt(Me,Dt,mt,sr){Dt?me.push(new j.Token(g.TokenKind.LITERAL_LONG,Me,mt,sr)):me.push(new j.Token(g.TokenKind.LITERAL_INT,Me,mt,sr))}function Ne(Me,Dt,mt,sr){if(Me.length===0)throw Dt?{name:"SpelParseException",message:"Not a long in expression ("+q+") at position "+B}:{name:"SpelParseException",message:"Not an int in expression ("+q+") at position "+B};Dt?me.push(new j.Token(g.TokenKind.LITERAL_HEXLONG,Me,mt,sr)):me.push(new j.Token(g.TokenKind.LITERAL_HEXINT,Me,mt,sr))}function ot(Me,Dt,mt,sr){Dt?me.push(new j.Token(g.TokenKind.LITERAL_REAL_FLOAT,Me,mt,sr)):me.push(new j.Token(g.TokenKind.LITERAL_REAL,Me,mt,sr))}function rt(Me,Dt){return oe.substring(Me,Dt)}function We(Me){return Me.tokenChars.length===2&&oe[B]===Me.tokenChars[0]?oe[B+1]===Me.tokenChars[1]:!1}function pt(Me){me.push(new j.Token(Me,null,B,B+1)),B+=1}function nt(Me){me.push(new j.Token(Me,null,B,B+2)),B+=2}function Xt(Me,Dt,mt){me.push(new j.Token(Me,mt,Dt,Dt+Me.getLength()))}function Re(Me){return zr(Me)||Zt(Me)||Me==="_"||Me==="$"}function je(Me,Dt){var mt=oe[B];return mt===Me||mt===Dt}function ft(Me){return Me==="e"||Me==="E"}function He(Me){return Me==="f"||Me==="F"}function U(Me){return Me==="d"||Me==="D"}function Ye(Me){return Me==="+"||Me==="-"}function Zt(Me){return Me.charCodeAt(0)>255?!1:(z[Me.charCodeAt(0)]&x)!==0}function zr(Me){return Me.charCodeAt(0)>255?!1:(z[Me.charCodeAt(0)]&M)!==0}function Se(Me){return Me.charCodeAt(0)>255?!1:(z[Me.charCodeAt(0)]&I)!==0}return Le(),me}var Z=b.Tokenizer={tokenize:Q}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Token=void 0;var j=V(2);function g(D,z,x,I){this.kind=D,this.startPos=x,this.endPos=I,z&&(this.data=z)}g.prototype.getKind=function(){return this.kind},g.prototype.toString=function(){var D="[";return D+=this.kind.toString(),this.kind.hasPayload()&&(D+=":"+this.data),D+="]",D+="("+this.startPos+","+this.endPos+")",D},g.prototype.isIdentifier=function(){return this.kind===j.TokenKind.IDENTIFIER},g.prototype.isNumericRelationalOperator=function(){return this.kind===j.TokenKind.GT||this.kind===j.TokenKind.GE||this.kind===j.TokenKind.LT||this.kind===j.TokenKind.LE||this.kind===j.TokenKind.EQ||this.kind===j.TokenKind.NE},g.prototype.stringValue=function(){return this.data},g.prototype.asInstanceOfToken=function(){return new g(j.TokenKind.INSTANCEOF,this.startPos,this.endPos)},g.prototype.asMatchesToken=function(){return new g(j.TokenKind.MATCHES,this.startPos,this.endPos)},g.prototype.asBetweenToken=function(){return new g(j.TokenKind.BETWEEN,this.startPos,this.endPos)},g.prototype.getStartPosition=function(){return this.startPos},g.prototype.getEndPosition=function(){return this.endPos},b.Token=g},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BooleanLiteral=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("boolean",x);return I.getValue=function(){return z},I.setValue=function(M){return z=M},I}var D=b.BooleanLiteral={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.NumberLiteral=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("number",x);return I.getValue=function(){return z},I.setValue=function(M){return z=M},I}var D=b.NumberLiteral={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StringLiteral=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("string",x);function M(P){return(P[0]==="'"&&P[P.length-1]==="'"||P[0]==='"'&&P[P.length-1]==='"')&&(P=P.substring(1,P.length-1)),P.replace(/''/g,"'").replace(/""/g,'"')}return z=M(z),I.getValue=function(){return z},I.setValue=function(P){return z=P},I}var D=b.StringLiteral={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.NullLiteral=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("null",x);return I.getValue=function(){return null},I}var D=b.NullLiteral={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.FunctionReference=void 0;var j=V(0),g=V(1);function D(x,I,M){var P=j.SpelNode.create("function",I);return P.getRaw=function(){return{functionName:x,args:M}},P.getValue=function(Q){var Z=Q.locals||{},k=Q.rootContext,q=[];if(M.forEach(function(oe){var Te=Q.activeContext;Q.activeContext=new g.Stack,Q.activeContext.push(Q.rootContext),q.push(oe.getValue(Q)),Q.activeContext=Te}),Z[x])return Z[x].apply(k,q);throw{name:"FunctionDoesNotExistException",message:"Function '"+x+"' does not exist."}},P}var z=b.FunctionReference={create:D}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.MethodReference=void 0;var j=V(0),g=V(1);function D(x,I,M,P){var Q=j.SpelNode.create("method",M);return Q.getRaw=function(){return{methodName:I,args:P}},Q.getValue=function(Z){var k=Z.activeContext.peek(),q=[],oe;if(!k)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+I+"' for an undefined context."};function Te(B){if(B==null){if(x)return null;throw{name:"NullPointerException",message:"Method "+I+" does not exist."}}return B}if(P.forEach(function(B){var me=Z.activeContext;Z.activeContext=new g.Stack,Z.activeContext.push(Z.rootContext),q.push(B.getValue(Z)),Z.activeContext=me}),I.substr(0,3)==="get"&&!k[I])return Te(k[I.charAt(3).toLowerCase()+I.substring(4)]);if(I.substr(0,3)==="set"&&!k[I])return k[I.charAt(3).toLowerCase()+I.substring(4)]=q[0];if(Array.isArray(k)){if(I==="size")return k.length;if(I==="contains")return k.includes(q[0])}return oe=Te(k[I]),oe?oe.apply(k,q):null},Q}var z=b.MethodReference={create:D}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.PropertyReference=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("property",I);return M.getRaw=function(){return x},M.getValue=function(P){var Q=P.activeContext.peek();if(!Q){if(z)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+x+"' for an undefined context."}}if(Q[x]===void 0||Q[x]===null){if(z)return null;if(x==="size"&&Array.isArray(Q))return Q.length;throw{name:"NullPointerException",message:"Property '"+x+"' does not exist."}}return Q[x]},M.setValue=function(P,Q){var Z=Q.activeContext.peek();if(!Z)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+x+"' for an undefined context."};return Z[x]=P},M.getName=function(){return x},M}var D=b.PropertyReference={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.VariableReference=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("variable",x);return I.getRaw=function(){return z},I.getValue=function(M){var P=M.activeContext.peek(),Q=M.locals;if(!P)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+z+"' for an undefined context."};return z==="this"?P:z==="root"?M.rootContext:Q[z]},I.setValue=function(M,P){var Q=P.locals;return Q[z]=M},I}var D=b.VariableReference={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CompoundExpression=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create.apply(null,["compound",z].concat(x));function M(P){var Q=I.getChildren().length,Z;for(Z=0;Z<Q;Z+=1)I.getChildren()[Z].getType()==="indexer"?P.activeContext.push(P.activeContext.peek()[I.getChildren()[Z].getValue(P)]):P.activeContext.push(I.getChildren()[Z].getValue(P));return function(){for(Z=0;Z<Q;Z+=1)P.activeContext.pop()}}return I.getValue=function(P){var Q=P.activeContext.peek(),Z;if(!Q)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var k=M(P);return Z=P.activeContext.peek(),k(),Z},I.setValue=function(P,Q){var Z=M(Q),k=I.getChildren().length;return Q.activeContext.pop(),P=I.getChildren()[k-1].setValue(P,Q),Q.activeContext.push(null),Z(),P},I}var D=b.CompoundExpression={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Indexer=void 0;var j=V(0),g=V(1);function D(x,I){var M=j.SpelNode.create.apply(null,["indexer",x].concat(I));return M.getValue=function(P){var Q=P.activeContext,Z,k=M.getChildren().length,q,oe;if(P.activeContext=new g.Stack,P.activeContext.push(P.rootContext),Z=P.activeContext.peek(),!Z)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(q=0;q<k;q+=1)P.activeContext.push(M.getChildren()[q].getValue(P));for(oe=P.activeContext.peek(),q=0;q<k;q+=1)P.activeContext.pop();return P.activeContext=Q,oe},M}var z=b.Indexer={create:D}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Assign=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("assign",z,x,I);return M.getValue=function(P){var Q=P.activeContext.peek();if(!Q)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+x.getValue(P)+"' for an undefined context."};return x.setValue(I.getValue(P),P)},M}var D=b.Assign={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpEQ=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-eq",z,x,I);return M.getValue=function(P){return x.getValue(P)===I.getValue(P)},M}var D=b.OpEQ={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpNE=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-ne",z,x,I);return M.getValue=function(P){return x.getValue(P)!==I.getValue(P)},M}var D=b.OpNE={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpGE=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-ge",z,x,I);return M.getValue=function(P){return x.getValue(P)>=I.getValue(P)},M}var D=b.OpGE={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpGT=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-gt",z,x,I);return M.getValue=function(P){return x.getValue(P)>I.getValue(P)},M}var D=b.OpGT={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpLE=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-le",z,x,I);return M.getValue=function(P){return x.getValue(P)<=I.getValue(P)},M}var D=b.OpLE={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpLT=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-lt",z,x,I);return M.getValue=function(P){return x.getValue(P)<I.getValue(P)},M}var D=b.OpLT={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpPlus=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-plus",z,x,I);return M.getValue=function(P){return I?x.getValue(P)+I.getValue(P):+x.getValue(P)},M}var D=b.OpPlus={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpMinus=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-minus",z,x,I);return M.getValue=function(P){return I?x.getValue(P)-I.getValue(P):-x.getValue(P)},M}var D=b.OpMinus={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpMultiply=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-multiply",z,x,I);return M.getValue=function(P){var Q=x.getValue(P),Z=I.getValue(P);if(typeof Q=="number"&&typeof Z=="number")return Q*Z;if(typeof Q=="string"&&typeof Z=="number"){for(var k="",q=0;q<Z;q+=1)k+=Q;return k}return null},M}var D=b.OpMultiply={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpDivide=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-divide",z,x,I);return M.getValue=function(P){return x.getValue(P)/I.getValue(P)},M}var D=b.OpDivide={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpModulus=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-modulus",z,x,I);return M.getValue=function(P){return x.getValue(P)%I.getValue(P)},M}var D=b.OpModulus={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpPower=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-power",z,x,I);return M.getValue=function(P){return Math.pow(x.getValue(P),I.getValue(P))},M}var D=b.OpPower={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpInc=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-inc",z,I);return M.getValue=function(P){var Q=I.getValue(P);return I.setValue(Q+1,P),x?Q:Q+1},M}var D=b.OpInc={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpDec=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-dec",z,I);return M.getValue=function(P){var Q=I.getValue(P);return I.setValue(Q-1,P),x?Q:Q-1},M}var D=b.OpDec={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpNot=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("op-not",z,x);return I.getValue=function(M){return!x.getValue(M)},I}var D=b.OpNot={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpAnd=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-and",z,x,I);return M.getValue=function(P){return!!x.getValue(P)&&!!I.getValue(P)},M}var D=b.OpAnd={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpOr=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("op-or",z,x,I);return M.getValue=function(P){return!!x.getValue(P)||!!I.getValue(P)},M}var D=b.OpOr={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpMatches=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("matches",z,x,I);return M.getValue=function(P){var Q=x.getValue(P),Z=I.getValue(P);try{var k=new RegExp(Z);return!!k.exec(Q)}catch(q){throw{name:"EvaluationException",message:q.toString()}}},M}var D=b.OpMatches={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Ternary=void 0;var j=V(0);function g(z,x,I,M){var P=j.SpelNode.create("ternary",z,x,I,M);return P.getValue=function(Q){return x.getValue(Q)?I.getValue(Q):M.getValue(Q)},P}var D=b.Ternary={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Elvis=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("elvis",z,x,I);return M.getValue=function(P){return x.getValue(P)!==null?x.getValue(P):I.getValue(P)},M}var D=b.Elvis={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InlineList=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("list",z),M=[].concat(x||[]);return I.getRaw=function(){return M},I.getValue=function(P){return M.map(function(Q){return Q.getValue(P)})},I}var D=b.InlineList={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InlineMap=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("map",z),M=[].concat(x||[]);return I.getValue=function(P){var Q=!0,Z=null,k={};return M.forEach(function(q){Q?q.getType()==="property"?Z=q.getName():Z=q.getValue(P):k[Z]=q.getValue(P),Q=!Q}),k},I}var D=b.InlineMap={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Selection=void 0;var j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},g=V(0);function D(P,Q,Z){var k=!1;return Z.activeContext.push(P),k=Q.getValue(Z),Z.activeContext.pop(),k}function z(P,Q,Z,k){var q=P.filter(function(oe){return D(oe,Z,k)});switch(Q){case"ALL":return q;case"FIRST":return q[0]||null;case"LAST":return q.length?q[q.length-1]:null}}function x(P,Q,Z,k){var q={},oe,Te,B=[],me={};for(Te in P)P.hasOwnProperty(Te)&&(oe={key:Te,value:P[Te]},D(oe,Z,k)&&B.push(oe));switch(Q){case"ALL":return B.forEach(function(Le){q[Le.key]=Le.value}),q;case"FIRST":return B.length?(me[B[0].key]=B[0].value,me):null;case"LAST":return B.length?(me[B[B.length-1].key]=B[B.length-1].value,me):null}B.forEach(function(Le){q[Le.key]=Le.value})}function I(P,Q,Z,k){var q=g.SpelNode.create("selection",Z,k);return q.getValue=function(oe){var Te=oe.activeContext.peek();if(Te){if(Array.isArray(Te))return z(Te,Q,k,oe);if((typeof Te>"u"?"undefined":j(Te))==="object")return x(Te,Q,k,oe)}return null},q}var M=b.Selection={create:I,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Projection=void 0;var j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},g=V(0);function D(I,M,P){return I.map(function(Q){var Z;return P.activeContext.push(Q),Z=M.getValue(P),P.activeContext.pop(),Z})}function z(I,M,P){var Q=g.SpelNode.create("projection",M,P);return Q.getValue=function(Z){var k=Z.activeContext.peek(),q=[],oe;if(Array.isArray(k))return D(k,P,Z);if((typeof k>"u"?"undefined":j(k))==="object"){for(oe in k)k.hasOwnProperty(oe)&&q.push(k[oe]);return D(q,P,Z)}return null},Q}var x=b.Projection={create:z}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpInstanceof=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("instanceof",z,x,I);return M.getValue=function(P){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},M}var D=b.OpInstanceof={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OpBetween=void 0;var j=V(0);function g(z,x,I){var M=j.SpelNode.create("between",z,x,I);return M.getValue=function(P){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},M}var D=b.OpBetween={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.TypeReference=void 0;var j=V(0);function g(z,M,I){var M=j.SpelNode.create("typeref",z,M);return M.getValue=function(P){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},M}var D=b.TypeReference={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BeanReference=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("beanref",z);return I.getValue=function(M){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},I}var D=b.BeanReference={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Identifier=void 0;var j=V(0);function g(z,x){var I=j.SpelNode.create("identifier",x);return I.getRaw=function(){return z},I.getValue=function(M){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},I}var D=b.Identifier={create:g}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.QualifiedIdentifier=void 0;var j=V(0);function g(x){if(Array.isArray(x)){for(var I=0,M=Array(x.length);I<x.length;I++)M[I]=x[I];return M}else return Array.from(x)}function D(x,I){var M=j.SpelNode.create.apply(j.SpelNode,["qualifiedidentifier",x].concat(g(I)));return M.getRaw=function(){return I.map(function(P){return P.getRaw()})},M.getValue=function(P){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},M}var z=b.QualifiedIdentifier={create:D}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ConstructorReference=void 0;var j=V(0),g=V(1);function D(M){if(Array.isArray(M)){for(var P=0,Q=Array(M.length);P<M.length;P++)Q[P]=M[P];return Q}else return Array.from(M)}function z(M){return Array.isArray(M)?M:Array.from(M)}function x(M,P,Q){var Z=Q!==void 0,k;Z?k=P.length&&P[0]&&P[0].getType()==="number"?P[0].getValue():null:(Q=P,P=void 0);var q=Q,oe=z(q),Te=oe[0],B=oe.slice(1),me=j.SpelNode.create.apply(j.SpelNode,["constructorref",M].concat(D(Q)));return me.getRaw=function(){return k},me.getValue=function(Le){if(Z&&B.length<=1){var Ue=[];return B.forEach(function(Ie){var st=Le.activeContext;Le.activeContext=new g.Stack,Le.activeContext.push(Le.rootContext),Ue.push(Ie.getValue(Le)),Le.activeContext=st}),B.length===1?Ue[0]:k?new Array(k):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},me}var I=b.ConstructorReference={create:x}},function(he,b,V){"use strict";Object.defineProperty(b,"__esModule",{value:!0});function j(D,z){var x={};return x.authentication=D||{},x.principal=z||{},x.hasRole=function(I){var M=!1;return!I||!x.authentication&&!Array.isArray(x.authentication.authorities)?!1:(x.authentication.authorities.forEach(function(P){P.authority.toLowerCase()===I.toLowerCase()&&(M=!0)}),M)},x.hasPermission=function(){var I=Array.prototype.slice.call(arguments);if(I.length===1)return x.hasRole(I[0])},x}var g=b.StandardContext={create:j}}])})},61526:(ue,he,b)=>{ue.exports=b(88319)},88319:(ue,he,b)=>{var V=b(48287).Buffer,j=he,g=/`/g,D=/\./g,z=/[\0\b\t\n\r\x1a\"\'\\]/g,x={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};j.escapeId=function(Z,k){if(Array.isArray(Z)){for(var q="",oe=0;oe<Z.length;oe++)q+=(oe===0?"":", ")+j.escapeId(Z[oe],k);return q}else return k?"`"+String(Z).replace(g,"``")+"`":"`"+String(Z).replace(g,"``").replace(D,"`.`")+"`"},j.escape=function(Z,k,q){if(Z==null)return"NULL";switch(typeof Z){case"boolean":return Z?"true":"false";case"number":return Z+"";case"object":return Object.prototype.toString.call(Z)==="[object Date]"?j.dateToString(Z,q||"local"):Array.isArray(Z)?j.arrayToList(Z,q):V.isBuffer(Z)?j.bufferToString(Z):typeof Z.toSqlString=="function"?String(Z.toSqlString()):k?I(Z.toString()):j.objectToValues(Z,q);default:return I(Z)}},j.arrayToList=function(Z,k){for(var q="",oe=0;oe<Z.length;oe++){var Te=Z[oe];Array.isArray(Te)?q+=(oe===0?"":", ")+"("+j.arrayToList(Te,k)+")":q+=(oe===0?"":", ")+j.escape(Te,!0,k)}return q},j.format=function(Z,k,q,oe){if(k==null)return Z;Array.isArray(k)||(k=[k]);for(var Te=0,B=/\?+/g,me="",Le=0,Ue;Le<k.length&&(Ue=B.exec(Z));){var Ie=Ue[0].length;if(!(Ie>2)){var st=Ie===2?j.escapeId(k[Le]):j.escape(k[Le],q,oe);me+=Z.slice(Te,Ue.index)+st,Te=B.lastIndex,Le++}}return Te===0?Z:Te<Z.length?me+Z.slice(Te):me},j.dateToString=function(Z,k){var q=new Date(Z);if(isNaN(q.getTime()))return"NULL";var oe,Te,B,me,Le,Ue,Ie;if(k==="local")oe=q.getFullYear(),Te=q.getMonth()+1,B=q.getDate(),me=q.getHours(),Le=q.getMinutes(),Ue=q.getSeconds(),Ie=q.getMilliseconds();else{var st=P(k);st!==!1&&st!==0&&q.setTime(q.getTime()+st*6e4),oe=q.getUTCFullYear(),Te=q.getUTCMonth()+1,B=q.getUTCDate(),me=q.getUTCHours(),Le=q.getUTCMinutes(),Ue=q.getUTCSeconds(),Ie=q.getUTCMilliseconds()}var qe=M(oe,4)+"-"+M(Te,2)+"-"+M(B,2)+" "+M(me,2)+":"+M(Le,2)+":"+M(Ue,2)+"."+M(Ie,3);return I(qe)},j.bufferToString=function(Z){return"X"+I(Z.toString("hex"))},j.objectToValues=function(Z,k){var q="";for(var oe in Z){var Te=Z[oe];typeof Te!="function"&&(q+=(q.length===0?"":", ")+j.escapeId(oe)+" = "+j.escape(Te,!0,k))}return q},j.raw=function(Z){if(typeof Z!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return Z}}};function I(Q){for(var Z=z.lastIndex=0,k="",q;q=z.exec(Q);)k+=Q.slice(Z,q.index)+x[q[0]],Z=z.lastIndex;return Z===0?"'"+Q+"'":Z<Q.length?"'"+k+Q.slice(Z)+"'":"'"+k+"'"}function M(Q,Z){for(Q=Q.toString();Q.length<Z;)Q="0"+Q;return Q}function P(Q){if(Q==="Z")return 0;var Z=Q.match(/([\+\-\s])(\d\d):?(\d\d)?/);return Z?(Z[1]==="-"?-1:1)*(parseInt(Z[2],10)+(Z[3]?parseInt(Z[3],10):0)/60)*60:!1}},58493:(ue,he,b)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V=b(96540);function j(k,q){return k===q&&(k!==0||1/k===1/q)||k!==k&&q!==q}var g=typeof Object.is=="function"?Object.is:j,D=V.useState,z=V.useEffect,x=V.useLayoutEffect,I=V.useDebugValue;function M(k,q){var oe=q(),Te=D({inst:{value:oe,getSnapshot:q}}),B=Te[0].inst,me=Te[1];return x(function(){B.value=oe,B.getSnapshot=q,P(B)&&me({inst:B})},[k,oe,q]),z(function(){return P(B)&&me({inst:B}),k(function(){P(B)&&me({inst:B})})},[k]),I(oe),oe}function P(k){var q=k.getSnapshot;k=k.value;try{var oe=q();return!g(k,oe)}catch{return!0}}function Q(k,q){return q()}var Z=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Q:M;he.useSyncExternalStore=V.useSyncExternalStore!==void 0?V.useSyncExternalStore:Z},22162:(ue,he,b)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V=b(96540),j=b(19888);function g(Q,Z){return Q===Z&&(Q!==0||1/Q===1/Z)||Q!==Q&&Z!==Z}var D=typeof Object.is=="function"?Object.is:g,z=j.useSyncExternalStore,x=V.useRef,I=V.useEffect,M=V.useMemo,P=V.useDebugValue;he.useSyncExternalStoreWithSelector=function(Q,Z,k,q,oe){var Te=x(null);if(Te.current===null){var B={hasValue:!1,value:null};Te.current=B}else B=Te.current;Te=M(function(){function Le(xt){if(!Ue){if(Ue=!0,Ie=xt,xt=q(xt),oe!==void 0&&B.hasValue){var Ne=B.value;if(oe(Ne,xt))return st=Ne}return st=xt}if(Ne=st,D(Ie,xt))return Ne;var ot=q(xt);return oe!==void 0&&oe(Ne,ot)?(Ie=xt,Ne):(Ie=xt,st=ot)}var Ue=!1,Ie,st,qe=k===void 0?null:k;return[function(){return Le(Z())},qe===null?void 0:function(){return Le(qe())}]},[Z,k,q,oe]);var me=z(Q,Te[0],Te[1]);return I(function(){B.hasValue=!0,B.value=me},[me]),P(me),me}},19888:(ue,he,b)=>{"use strict";ue.exports=b(58493)},69242:(ue,he,b)=>{"use strict";ue.exports=b(22162)},23212:ue=>{function he(b,V){this.v=b,this.k=V}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},94054:(ue,he,b)=>{var V=b(46834);function j(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var g,D,z=typeof Symbol=="function"?Symbol:{},x=z.iterator||"@@iterator",I=z.toStringTag||"@@toStringTag";function M(B,me,Le,Ue){var Ie=me&&me.prototype instanceof Q?me:Q,st=Object.create(Ie.prototype);return V(st,"_invoke",function(qe,xt,Ne){var ot,rt,We,pt=0,nt=Ne||[],Xt=!1,Re={p:0,n:0,v:g,a:je,f:je.bind(g,4),d:function(He,U){return ot=He,rt=0,We=g,Re.n=U,P}};function je(ft,He){for(rt=ft,We=He,D=0;!Xt&&pt&&!U&&D<nt.length;D++){var U,Ye=nt[D],Zt=Re.p,zr=Ye[2];ft>3?(U=zr===He)&&(We=Ye[(rt=Ye[4])?5:(rt=3,3)],Ye[4]=Ye[5]=g):Ye[0]<=Zt&&((U=ft<2&&Zt<Ye[1])?(rt=0,Re.v=He,Re.n=Ye[1]):Zt<zr&&(U=ft<3||Ye[0]>He||He>zr)&&(Ye[4]=ft,Ye[5]=He,Re.n=zr,rt=0))}if(U||ft>1)return P;throw Xt=!0,He}return function(ft,He,U){if(pt>1)throw TypeError("Generator is already running");for(Xt&&He===1&&je(He,U),rt=He,We=U;(D=rt<2?g:We)||!Xt;){ot||(rt?rt<3?(rt>1&&(Re.n=-1),je(rt,We)):Re.n=We:Re.v=We);try{if(pt=2,ot){if(rt||(ft="next"),D=ot[ft]){if(!(D=D.call(ot,We)))throw TypeError("iterator result is not an object");if(!D.done)return D;We=D.value,rt<2&&(rt=0)}else rt===1&&(D=ot.return)&&D.call(ot),rt<2&&(We=TypeError("The iterator does not provide a '"+ft+"' method"),rt=1);ot=g}else if((D=(Xt=Re.n<0)?We:qe.call(xt,Re))!==P)break}catch(Ye){ot=g,rt=1,We=Ye}finally{pt=1}}return{value:D,done:Xt}}}(B,Le,Ue),!0),st}var P={};function Q(){}function Z(){}function k(){}D=Object.getPrototypeOf;var q=[][x]?D(D([][x]())):(V(D={},x,function(){return this}),D),oe=k.prototype=Q.prototype=Object.create(q);function Te(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,k):(B.__proto__=k,V(B,I,"GeneratorFunction")),B.prototype=Object.create(oe),B}return Z.prototype=k,V(oe,"constructor",k),V(k,"constructor",Z),Z.displayName="GeneratorFunction",V(k,I,"GeneratorFunction"),V(oe),V(oe,I,"Generator"),V(oe,x,function(){return this}),V(oe,"toString",function(){return"[object Generator]"}),(ue.exports=j=function(){return{w:M,m:Te}},ue.exports.__esModule=!0,ue.exports.default=ue.exports)()}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},31749:(ue,he,b)=>{var V=b(37887);function j(g,D,z,x,I){var M=V(g,D,z,x,I);return M.next().then(function(P){return P.done?P.value:M.next()})}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},37887:(ue,he,b)=>{var V=b(94054),j=b(51479);function g(D,z,x,I,M){return new j(V().w(D,z,x,I),M||Promise)}ue.exports=g,ue.exports.__esModule=!0,ue.exports.default=ue.exports},51479:(ue,he,b)=>{var V=b(23212),j=b(46834);function g(D,z){function x(M,P,Q,Z){try{var k=D[M](P),q=k.value;return q instanceof V?z.resolve(q.v).then(function(oe){x("next",oe,Q,Z)},function(oe){x("throw",oe,Q,Z)}):z.resolve(q).then(function(oe){k.value=oe,Q(k)},function(oe){return x("throw",oe,Q,Z)})}catch(oe){Z(oe)}}var I;this.next||(j(g.prototype),j(g.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),j(this,"_invoke",function(M,P,Q){function Z(){return new z(function(k,q){x(M,Q,k,q)})}return I=I?I.then(Z,Z):Z()},!0)}ue.exports=g,ue.exports.__esModule=!0,ue.exports.default=ue.exports},46834:ue=>{function he(b,V,j,g){var D=Object.defineProperty;try{D({},"",{})}catch{D=0}ue.exports=he=function(x,I,M,P){if(I)D?D(x,I,{value:M,enumerable:!P,configurable:!P,writable:!P}):x[I]=M;else{var Q=function(k,q){he(x,k,function(oe){return this._invoke(k,q,oe)})};Q("next",0),Q("throw",1),Q("return",2)}},ue.exports.__esModule=!0,ue.exports.default=ue.exports,he(b,V,j,g)}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},30541:ue=>{function he(b){var V=Object(b),j=[];for(var g in V)j.unshift(g);return function D(){for(;j.length;)if((g=j.pop())in V)return D.value=g,D.done=!1,D;return D.done=!0,D}}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},21873:(ue,he,b)=>{var V=b(23212),j=b(94054),g=b(31749),D=b(37887),z=b(51479),x=b(30541),I=b(77691);function M(){"use strict";var P=j(),Q=P.m(M),Z=(Object.getPrototypeOf?Object.getPrototypeOf(Q):Q.__proto__).constructor;function k(Te){var B=typeof Te=="function"&&Te.constructor;return!!B&&(B===Z||(B.displayName||B.name)==="GeneratorFunction")}var q={throw:1,return:2,break:3,continue:3};function oe(Te){var B,me;return function(Le){B||(B={stop:function(){return me(Le.a,2)},catch:function(){return Le.v},abrupt:function(Ie,st){return me(Le.a,q[Ie],st)},delegateYield:function(Ie,st,qe){return B.resultName=st,me(Le.d,I(Ie),qe)},finish:function(Ie){return me(Le.f,Ie)}},me=function(Ie,st,qe){Le.p=B.prev,Le.n=B.next;try{return Ie(st,qe)}finally{B.next=Le.n}}),B.resultName&&(B[B.resultName]=Le.v,B.resultName=void 0),B.sent=Le.v,B.next=Le.n;try{return Te.call(this,B)}finally{Le.p=B.prev,Le.n=B.next}}}return(ue.exports=M=function(){return{wrap:function(me,Le,Ue,Ie){return P.w(oe(me),Le,Ue,Ie&&Ie.reverse())},isGeneratorFunction:k,mark:P.m,awrap:function(me,Le){return new V(me,Le)},AsyncIterator:z,async:function(me,Le,Ue,Ie,st){return(k(Le)?D:g)(oe(me),Le,Ue,Ie,st)},keys:x,values:I}},ue.exports.__esModule=!0,ue.exports.default=ue.exports)()}ue.exports=M,ue.exports.__esModule=!0,ue.exports.default=ue.exports},77691:(ue,he,b)=>{var V=b(57522).default;function j(g){if(g!=null){var D=g[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],z=0;if(D)return D.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length))return{next:function(){return g&&z>=g.length&&(g=void 0),{value:g&&g[z++],done:!g}}}}throw new TypeError(V(g)+" is not iterable")}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},57522:ue=>{function he(b){"@babel/helpers - typeof";return ue.exports=he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},ue.exports.__esModule=!0,ue.exports.default=ue.exports,he(b)}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},86636:(ue,he,b)=>{var V=b(21873)();ue.exports=V;try{regeneratorRuntime=V}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=V:Function("r","regeneratorRuntime = r")(V)}},81757:ue=>{function he(b,V){this.v=b,this.k=V}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},80344:(ue,he,b)=>{var V=b(40380);function j(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var g,D,z=typeof Symbol=="function"?Symbol:{},x=z.iterator||"@@iterator",I=z.toStringTag||"@@toStringTag";function M(B,me,Le,Ue){var Ie=me&&me.prototype instanceof Q?me:Q,st=Object.create(Ie.prototype);return V(st,"_invoke",function(qe,xt,Ne){var ot,rt,We,pt=0,nt=Ne||[],Xt=!1,Re={p:0,n:0,v:g,a:je,f:je.bind(g,4),d:function(He,U){return ot=He,rt=0,We=g,Re.n=U,P}};function je(ft,He){for(rt=ft,We=He,D=0;!Xt&&pt&&!U&&D<nt.length;D++){var U,Ye=nt[D],Zt=Re.p,zr=Ye[2];ft>3?(U=zr===He)&&(We=Ye[(rt=Ye[4])?5:(rt=3,3)],Ye[4]=Ye[5]=g):Ye[0]<=Zt&&((U=ft<2&&Zt<Ye[1])?(rt=0,Re.v=He,Re.n=Ye[1]):Zt<zr&&(U=ft<3||Ye[0]>He||He>zr)&&(Ye[4]=ft,Ye[5]=He,Re.n=zr,rt=0))}if(U||ft>1)return P;throw Xt=!0,He}return function(ft,He,U){if(pt>1)throw TypeError("Generator is already running");for(Xt&&He===1&&je(He,U),rt=He,We=U;(D=rt<2?g:We)||!Xt;){ot||(rt?rt<3?(rt>1&&(Re.n=-1),je(rt,We)):Re.n=We:Re.v=We);try{if(pt=2,ot){if(rt||(ft="next"),D=ot[ft]){if(!(D=D.call(ot,We)))throw TypeError("iterator result is not an object");if(!D.done)return D;We=D.value,rt<2&&(rt=0)}else rt===1&&(D=ot.return)&&D.call(ot),rt<2&&(We=TypeError("The iterator does not provide a '"+ft+"' method"),rt=1);ot=g}else if((D=(Xt=Re.n<0)?We:qe.call(xt,Re))!==P)break}catch(Ye){ot=g,rt=1,We=Ye}finally{pt=1}}return{value:D,done:Xt}}}(B,Le,Ue),!0),st}var P={};function Q(){}function Z(){}function k(){}D=Object.getPrototypeOf;var q=[][x]?D(D([][x]())):(V(D={},x,function(){return this}),D),oe=k.prototype=Q.prototype=Object.create(q);function Te(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,k):(B.__proto__=k,V(B,I,"GeneratorFunction")),B.prototype=Object.create(oe),B}return Z.prototype=k,V(oe,"constructor",k),V(k,"constructor",Z),Z.displayName="GeneratorFunction",V(k,I,"GeneratorFunction"),V(oe),V(oe,I,"Generator"),V(oe,x,function(){return this}),V(oe,"toString",function(){return"[object Generator]"}),(ue.exports=j=function(){return{w:M,m:Te}},ue.exports.__esModule=!0,ue.exports.default=ue.exports)()}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},30790:(ue,he,b)=>{var V=b(62886);function j(g,D,z,x,I){var M=V(g,D,z,x,I);return M.next().then(function(P){return P.done?P.value:M.next()})}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},62886:(ue,he,b)=>{var V=b(80344),j=b(91452);function g(D,z,x,I,M){return new j(V().w(D,z,x,I),M||Promise)}ue.exports=g,ue.exports.__esModule=!0,ue.exports.default=ue.exports},91452:(ue,he,b)=>{var V=b(81757),j=b(40380);function g(D,z){function x(M,P,Q,Z){try{var k=D[M](P),q=k.value;return q instanceof V?z.resolve(q.v).then(function(oe){x("next",oe,Q,Z)},function(oe){x("throw",oe,Q,Z)}):z.resolve(q).then(function(oe){k.value=oe,Q(k)},function(oe){return x("throw",oe,Q,Z)})}catch(oe){Z(oe)}}var I;this.next||(j(g.prototype),j(g.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),j(this,"_invoke",function(M,P,Q){function Z(){return new z(function(k,q){x(M,Q,k,q)})}return I=I?I.then(Z,Z):Z()},!0)}ue.exports=g,ue.exports.__esModule=!0,ue.exports.default=ue.exports},40380:ue=>{function he(b,V,j,g){var D=Object.defineProperty;try{D({},"",{})}catch{D=0}ue.exports=he=function(x,I,M,P){if(I)D?D(x,I,{value:M,enumerable:!P,configurable:!P,writable:!P}):x[I]=M;else{var Q=function(k,q){he(x,k,function(oe){return this._invoke(k,q,oe)})};Q("next",0),Q("throw",1),Q("return",2)}},ue.exports.__esModule=!0,ue.exports.default=ue.exports,he(b,V,j,g)}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},5480:ue=>{function he(b){var V=Object(b),j=[];for(var g in V)j.unshift(g);return function D(){for(;j.length;)if((g=j.pop())in V)return D.value=g,D.done=!1,D;return D.done=!0,D}}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},48422:(ue,he,b)=>{var V=b(81757),j=b(80344),g=b(30790),D=b(62886),z=b(91452),x=b(5480),I=b(75394);function M(){"use strict";var P=j(),Q=P.m(M),Z=(Object.getPrototypeOf?Object.getPrototypeOf(Q):Q.__proto__).constructor;function k(Te){var B=typeof Te=="function"&&Te.constructor;return!!B&&(B===Z||(B.displayName||B.name)==="GeneratorFunction")}var q={throw:1,return:2,break:3,continue:3};function oe(Te){var B,me;return function(Le){B||(B={stop:function(){return me(Le.a,2)},catch:function(){return Le.v},abrupt:function(Ie,st){return me(Le.a,q[Ie],st)},delegateYield:function(Ie,st,qe){return B.resultName=st,me(Le.d,I(Ie),qe)},finish:function(Ie){return me(Le.f,Ie)}},me=function(Ie,st,qe){Le.p=B.prev,Le.n=B.next;try{return Ie(st,qe)}finally{B.next=Le.n}}),B.resultName&&(B[B.resultName]=Le.v,B.resultName=void 0),B.sent=Le.v,B.next=Le.n;try{return Te.call(this,B)}finally{Le.p=B.prev,Le.n=B.next}}}return(ue.exports=M=function(){return{wrap:function(me,Le,Ue,Ie){return P.w(oe(me),Le,Ue,Ie&&Ie.reverse())},isGeneratorFunction:k,mark:P.m,awrap:function(me,Le){return new V(me,Le)},AsyncIterator:z,async:function(me,Le,Ue,Ie,st){return(k(Le)?D:g)(oe(me),Le,Ue,Ie,st)},keys:x,values:I}},ue.exports.__esModule=!0,ue.exports.default=ue.exports)()}ue.exports=M,ue.exports.__esModule=!0,ue.exports.default=ue.exports},75394:(ue,he,b)=>{var V=b(36453).default;function j(g){if(g!=null){var D=g[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],z=0;if(D)return D.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length))return{next:function(){return g&&z>=g.length&&(g=void 0),{value:g&&g[z++],done:!g}}}}throw new TypeError(V(g)+" is not iterable")}ue.exports=j,ue.exports.__esModule=!0,ue.exports.default=ue.exports},36453:ue=>{function he(b){"@babel/helpers - typeof";return ue.exports=he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},ue.exports.__esModule=!0,ue.exports.default=ue.exports,he(b)}ue.exports=he,ue.exports.__esModule=!0,ue.exports.default=ue.exports},15413:(ue,he,b)=>{var V=b(48422)();ue.exports=V;try{regeneratorRuntime=V}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=V:Function("r","regeneratorRuntime = r")(V)}},70985:(ue,he,b)=>{"use strict";b.d(he,{q:()=>j});var V=b(96540),j=(g=>(g.NoAuth="NoAuth",g.BasicAuth="BasicAuth",g.OAuthForward="OAuthForward",g.CrossSiteCredentials="CrossSiteCredentials",g))(j||{})},76229:(ue,he,b)=>{"use strict";b.d(he,{pe:()=>x});var V=b(96540),j=b(22803),g=b(70985);const D="httpHeaderName",z="httpHeaderValue";function x({config:k,onChange:q}){return{selectedMethod:I(k),onAuthMethodSelect:M(k,q),basicAuth:P(k,q),TLS:Q(k,q),customHeaders:Z(k,q),readOnly:k.readOnly}}function I(k){return k.basicAuth?g.q.BasicAuth:k.withCredentials?g.q.CrossSiteCredentials:k.jsonData.oauthPassThru?g.q.OAuthForward:g.q.NoAuth}function M(k,q){return oe=>{q({...k,basicAuth:oe===g.q.BasicAuth,withCredentials:oe===g.q.CrossSiteCredentials,jsonData:{...k.jsonData,oauthPassThru:oe===g.q.OAuthForward}})}}function P(k,q){return{user:k.basicAuthUser,passwordConfigured:k.secureJsonFields.basicAuthPassword,onUserChange:oe=>q({...k,basicAuthUser:oe}),onPasswordChange:oe=>q({...k,secureJsonData:{...k.secureJsonData,basicAuthPassword:oe}}),onPasswordReset:()=>q({...k,secureJsonData:{...k.secureJsonData,basicAuthPassword:""},secureJsonFields:{...k.secureJsonFields,basicAuthPassword:!1}})}}function Q(k,q){var oe,Te,B;return{selfSignedCertificate:{enabled:!!k.jsonData.tlsAuthWithCACert,certificateConfigured:!!((oe=k.secureJsonFields)!=null&&oe.tlsCACert),onToggle:me=>q(me?{...k,jsonData:{...k.jsonData,tlsAuthWithCACert:me}}:{...k,jsonData:{...k.jsonData,tlsAuthWithCACert:me},secureJsonData:{...k.secureJsonData,tlsCACert:""},secureJsonFields:{...k.secureJsonFields,tlsCACert:!1}}),onCertificateChange:me=>q({...k,secureJsonData:{...k.secureJsonData,tlsCACert:me}}),onCertificateReset:()=>q({...k,secureJsonData:{...k.secureJsonData,tlsCACert:""},secureJsonFields:{...k.secureJsonFields,tlsCACert:!1}})},TLSClientAuth:{enabled:k.jsonData.tlsAuth,serverName:k.jsonData.serverName,clientCertificateConfigured:!!((Te=k.secureJsonFields)!=null&&Te.tlsClientCert),clientKeyConfigured:!!((B=k.secureJsonFields)!=null&&B.tlsClientKey),onToggle:me=>q(me?{...k,jsonData:{...k.jsonData,tlsAuth:me}}:{...k,jsonData:{...k.jsonData,tlsAuth:me,serverName:""},secureJsonData:{...k.secureJsonData,tlsClientCert:"",tlsClientKey:""},secureJsonFields:{...k.secureJsonFields,tlsClientCert:!1,tlsClientKey:!1}}),onServerNameChange:me=>q({...k,jsonData:{...k.jsonData,serverName:me}}),onClientCertificateChange:me=>q({...k,secureJsonData:{...k.secureJsonData,tlsClientCert:me}}),onClientCertificateReset:()=>q({...k,secureJsonData:{...k.secureJsonData,tlsClientCert:""},secureJsonFields:{...k.secureJsonFields,tlsClientCert:!1}}),onClientKeyChange:me=>q({...k,secureJsonData:{...k.secureJsonData,tlsClientKey:me}}),onClientKeyReset:()=>q({...k,secureJsonData:{...k.secureJsonData,tlsClientKey:""},secureJsonFields:{...k.secureJsonFields,tlsClientKey:!1}})},skipTLSVerification:{enabled:k.jsonData.tlsSkipVerify,onToggle:me=>q({...k,jsonData:{...k.jsonData,tlsSkipVerify:me}})}}}function Z(k,q){return{headers:Object.keys(k.jsonData).filter(Te=>Te.startsWith(D)).sort().map(Te=>{var B;const me=Te.slice(D.length);return{name:k.jsonData[Te],configured:(B=k.secureJsonFields[`${z}${me}`])!=null?B:!1}}),onChange:Te=>{const B=Object.fromEntries(Object.entries(k.jsonData).filter(([Ue])=>!Ue.startsWith(D))),me=Object.fromEntries(Object.entries(k.secureJsonData||{}).filter(([Ue])=>!Ue.startsWith(z))),Le=Object.fromEntries(Object.entries(k.secureJsonFields).filter(([Ue])=>!Ue.startsWith(z)));Te.forEach((Ue,Ie)=>{B[`${D}${Ie+1}`]=Ue.name,Ue.configured?Le[`${z}${Ie+1}`]=!0:me[`${z}${Ie+1}`]=Ue.value}),q({...k,jsonData:B,secureJsonData:me,secureJsonFields:Le})}}}},20301:(ue,he,b)=>{"use strict";b.d(he,{Z:()=>z});var V=b(22803),j=b(96540),g=b(63142),D=b(45861);const z=({className:I,...M})=>{const P=(0,g.of)(x);return j.createElement(D.$n,{...M,className:(0,V.cx)(I,P.button)})},x=I=>({button:(0,V.css)({paddingLeft:I.spacing(3/2),paddingRight:I.spacing(3/2)})})},41778:(ue,he,b)=>{"use strict";b.d(he,{lX:()=>I});var V=b(52135),j=b(47184),g=b(2543),D=b(96540),z,x=(Z=>(Z[Z.Timeseries=0]="Timeseries",Z[Z.Table=1]="Table",Z[Z.Logs=2]="Logs",Z[Z.Trace=3]="Trace",Z[Z.OptionMulti=4]="OptionMulti",Z))(x||{}),I=(Z=>(Z.Builder="builder",Z.Code="code",Z))(I||{});const M=[{label:"Time series",value:0},{label:"Table",value:1}],P=Z=>({label:Z,value:Z}),Q=(z=j.z)!=null?z:P}}]);

//# sourceMappingURL=590.00cb3b63288f0be3bfb2.js.map