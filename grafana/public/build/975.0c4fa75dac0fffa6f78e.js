(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[975],{30975:(re,xe,P)=>{"use strict";P.r(xe),P.d(xe,{SetupSAMLPage:()=>Ir,SetupSAMLPageUnconnected:()=>Ar,default:()=>Lr});var t=P(74848),e=P(2543),h=P(96540),s=P(71468),C=P(54148),T=P(13791),d=P(86678),p=P(87049),a=P(69788),o=P(22803),E=P(49785),S=P(92745),m=P(63142),v=P(45967),A=P(30703),f=P(37386),g=P(21285),w=P(89640),n=P(63527),u=P(18857),x=P(73427),B=P(18027);const V=({value:F,label:W,placeholder:le,width:ne,id:oe,tooltip:ve,onChange:Ae})=>{const De=(0,m.of)(c),Ne=He=>{const We=He.currentTarget.value;Ae(We)};return(0,t.jsx)("div",{className:De.assertionEditorRow,children:(0,t.jsx)(B.I,{label:W,labelWidth:22,htmlFor:oe,tooltip:ve,children:(0,t.jsx)(n.p,{width:ne||30,id:oe,value:F||"",onChange:Ne,placeholder:le})})})},c=F=>({assertionEditorRow:(0,o.css)({display:"flex",marginBottom:F.spacing(1)}),inputLabel:(0,o.css)({color:F.components.input.text,background:F.components.input.background})});var y=P(45861);const N=({isConfigured:F,onReset:W,label:le,...ne})=>{const oe=(0,m.of)(r);return(0,t.jsxs)("div",{className:oe.inputWithReset,children:[(0,t.jsx)(B.I,{label:le,labelWidth:22,htmlFor:ne.id,children:(0,t.jsx)(t.Fragment,{children:F?(0,t.jsx)(n.p,{...ne,value:"configured",disabled:!0}):(0,t.jsx)(n.p,{...ne})})}),F&&(0,t.jsx)(y.$n,{className:oe.resetButton,variant:"primary",size:"md",onClick:W,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.input-with-reset.reset",children:"Reset"})})]})},r=F=>({resetButton:(0,o.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"}),inputWithReset:(0,o.css)({padding:0,display:"flex"})});var L=P(27489),K=P(16780),U=P(53487),H=P(99887),j=P(83813),z=P(34999),Y=P(21875);function X(F){return{error:F.authConfig.updateError,warning:F.authConfig.warning}}const $={resetError:Y.SH,resetWarning:Y.yk},Ee=(0,s.connect)(X,$)(({error:F,warning:W,resetError:le,resetWarning:ne})=>(0,t.jsxs)("div",{children:[F&&(0,t.jsx)(z.F,{title:F.message,onRemove:()=>le(),children:F.errors?.map((oe,ve)=>(0,t.jsx)("div",{children:oe},ve))}),W&&(0,t.jsx)(z.F,{title:W.message,onRemove:()=>ne(),severity:"warning",children:W.errors?.map((oe,ve)=>(0,t.jsx)("div",{children:oe},ve))})]}));var Se=P(61984);const ye=({error:F,onReset:W})=>(0,t.jsx)("div",{children:F&&(0,t.jsx)(z.F,{title:F.message,onRemove:W,severity:"warning",children:F.errors?.map((le,ne)=>(0,t.jsx)("div",{children:le},ne))})});var ie=P(36490),ae=P(29223);const Be=F=>{if(!F)return Ye[0];const W=Ye.findIndex(le=>le.id===F);return W===Ye.length-1?Ye[W]:Ye[W+1]},_e=F=>{if(!F||F===Ye[0].id)return;const W=Ye.findIndex(le=>le.id===F);return Ye[W-1]},Ie=F=>{const W=_e(F);W&&W.id!==F&&ie.Ny.push((0,ae.Do)(W.id))},Q=(0,h.forwardRef)(({activeStep:F,disabled:W},le)=>{const ne=(0,m.of)(l),oe=(0,h.useRef)(null),ve=_e(F),Ae=Be(F),De=Ae.id===F;(0,h.useImperativeHandle)(le,()=>({click:()=>{oe.current?.click()}}));const Ne=()=>{oe.current?.click(),Ie(F)};return(0,t.jsx)("div",{className:ne.buttonRow,children:(0,t.jsx)("div",{className:ne.buttonRowInner,children:(0,t.jsxs)("div",{children:[ve&&(0,t.jsx)(y.$n,{variant:"secondary",onClick:Ne,children:(0,S.t)("auth-config.SAML.button-row-previous","Previous: {{name}}",{name:ve.name})}),!De&&(0,t.jsx)(y.$n,{ref:oe,disabled:W,type:"submit",children:(0,S.t)("auth-config.SAML.button-row-next","Next: {{name}}",{name:Ae.name})})]})})})});Q.displayName="ButtonRow";const l=F=>({buttonRow:(0,o.css)({display:"flex",padding:F.spacing(2,0,.5,0),borderTop:`1px solid ${F.colors.border.weak}`,width:"100%",backgroundColor:F.colors.background.primary,button:{"&:first-of-type":{marginRight:F.spacing(2)},"&:last-of-type":{marginRight:0}}}),buttonRowInner:(0,o.css)({display:"flex",justifyContent:"space-between",width:"100%"})});var D=P(87063),i=P(88559),I=P(76319),O=P(71599);const G=({enabled:F,isNewConfig:W,onSave:le,onSaveAndEnable:ne,onDisable:oe,onRemove:ve})=>{const Ae=(0,m.of)(M);let De={text:(0,S.t)("auth-config.action-bar.not-enabled-badge","Not enabled"),color:"blue"};F?De={text:(0,S.t)("auth-config.action-bar.enabled-badge","Enabled"),color:"green",icon:"check"}:W||(De={text:(0,S.t)("auth-config.action-bar.not-enabled-badge","Not enabled"),color:"blue"});const[Ne,He]=(0,h.useState)(!1),We=()=>{ve(),He(!1),window.location.href="/admin/authentication"},ut=(0,t.jsx)(D.W,{children:(0,t.jsx)(D.W.Item,{label:(0,S.t)("auth-config.action-bar.delete","Delete"),icon:"trash-alt",onClick:()=>{He(!0)}})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Ae.actionBarContainer,children:[(0,t.jsxs)("div",{className:Ae.protocolContainer,children:[(0,t.jsx)("span",{className:Ae.protocolLabel,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.protocol",children:"Protocol"})}),(0,t.jsx)("span",{children:"SAML 2.0"})]}),!W&&(0,t.jsxs)("div",{className:Ae.statusContainer,children:[(0,t.jsx)("span",{className:Ae.statusLabel,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.status",children:"Status"})}),(0,t.jsx)(H.E,{...De,className:Ae.statusBadge})]}),!F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.$n,{variant:"secondary",onClick:le,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.save-button",children:"Save"})}),(0,t.jsx)(y.$n,{variant:"primary",onClick:ne,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.save-and-enable-button",children:"Save and enable"})})]}),F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.$n,{variant:"primary",onClick:le,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.save-and-apply-button",children:"Save and apply"})}),(0,t.jsx)(v.m,{content:(0,S.t)("auth-config.action-bar.content-disable-button","Disable will disable Grafana to not use SAML auth."),placement:"top",children:(0,t.jsx)(y.$n,{variant:"secondary",fill:"outline",onClick:oe,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.action-bar.disable-button",children:"Disable"})})})]}),!W&&(0,t.jsx)(i.m,{overlay:ut,placement:"bottom-start",children:(0,t.jsx)(I.K,{tooltip:(0,S.t)("auth-config.action-bar.more-actions-button","More actions"),tooltipPlacement:"top",variant:"secondary",name:"ellipsis-v"})})]}),(0,t.jsx)(O.u,{title:(0,S.t)("auth-config.config-action.confirm-modal-title","Delete SAML configuration"),body:(0,S.t)("auth-config.config-action.confirm-modal-body","Are you sure you want to permanently delete this SAML configuration? All changes made in the UI will be removed."),confirmText:(0,S.t)("auth-config.config-action.confirm-modal-confirm-text","Delete configuration"),confirmationText:F?(0,S.t)("auth-config.config-action.confirm-modal-confirmation-text","delete"):"",dismissText:(0,S.t)("auth-config.config-action.confirm-modal-dismiss-text","Back to editing"),isOpen:Ne,onDismiss:()=>He(!1),onConfirm:We})]})},M=F=>({actionBarContainer:(0,o.css)({display:"flex",flexDirection:"row",gap:F.spacing(1),alignItems:"center",justifyContent:"flex-end"}),iniFileLabel:(0,o.css)({display:"flex",color:F.colors.text.primary,justifyContent:"flex-end"}),tooltipContainer:(0,o.css)({padding:F.spacing(0,1)}),statusContainer:(0,o.css)({display:"flex",flexDirection:"column",fontSize:F.typography.bodySmall.fontSize,borderLeft:`1px solid ${F.colors.border.medium}`,padding:F.spacing(0,2)}),statusBadge:(0,o.css)({span:{fontSize:F.typography.size.xs}}),statusLabel:(0,o.css)({color:F.colors.text.secondary}),protocolContainer:(0,o.css)({display:"flex",flexDirection:"column",fontSize:F.typography.bodySmall.fontSize,paddingRight:F.spacing(1)}),protocolLabel:(0,o.css)({color:F.colors.text.secondary})});var q=P(11257),pe=P(63671),he=P(39547),Z=P.n(he);function fe(F,W,le){Oe(le,F(W))}function me(F){const W={valid:!0,errors:[]};return fe(we,F,W),fe(Ke,F,W),fe(Pe,F,W),fe(Ue,F,W),W}function be(F,W){switch(W){case SAMLStepKey.General:return!we(F).valid;case SAMLStepKey.KeyCert:return!Ke(F).valid;case SAMLStepKey.ConnectToIdP:return!Pe(F).valid;case SAMLStepKey.AssertionMapping:return!Ue(F).valid;default:return!1}}function Ce(F){const W={};return Ye.forEach(({id:le})=>{switch(le){case a.SAMLStepKey.General:W[le]=we(F);return;case a.SAMLStepKey.KeyCert:W[le]=Ke(F);return;case a.SAMLStepKey.ConnectToIdP:W[le]=Pe(F);return;case a.SAMLStepKey.AssertionMapping:W[le]=Ue(F);return}}),W}function we(F){const W={valid:!0,errors:[]},{allowIdpInitiated:le,relayState:ne}=F;return le===!0&&!ne&&ke(W,"Relay state should be configured"),ne&&ne.length>80&&ke(W,"Relay state should be 80 characters or less"),W}function Ke(F){const W={valid:!0,errors:[]},{signRequests:le,privateKey:ne,privateKeyPath:oe,certificate:ve,certificatePath:Ae}=F;return le&&!ne&&!oe&&ke(W,"Private key should be configured if sign requests is enabled"),le&&!ve&&!Ae&&ke(W,"Certificate key should be configured if sign requests is enabled"),ne&&!ne.startsWith("***")&&!ot(ne)&&ke(W,"Not valid PEM private key"),ve&&!ve.startsWith("***")&&!dt(ve)&&ke(W,"Not valid PEM certificate"),W}function Pe(F){const W={valid:!0,errors:[]},{idpMetadataUrl:le,idpMetadataPath:ne,idpMetadata:oe,metadataValueType:ve}=F;return(ve==="base64"&&!oe||ve==="url"&&!le||ve==="path"&&!ne||!le&&!ne&&!oe)&&ke(W,"IdP metadata should be configured"),W}function Ue(F){return{valid:!0,errors:[]}}function Oe(F,W){W.valid||(F.valid=!1,F.errors?.push(...W.errors))}function ke(F,W){F.valid=!1,F.errors?.push(W)}function ze(F){return/^([0-9]*(\.[0-9]*)?[smh]+)+$/.test(F)}function ot(F){try{const W=atob(F);return ct(W)}catch{return!1}}function ct(F){try{const W=he.pem.decode(F);return!(W.length>1||W[0].type!=="PRIVATE KEY")}catch{return!1}}function dt(F){try{const W=atob(F);return ht(W)}catch{return!1}}function ht(F){try{const W=he.pki.certificateFromPem(F),le=new Date;return!(W.validity.notBefore>le||W.validity.notAfter<le)}catch{return!1}}var Te=P(55742);const bt=5e3;function pt(){return async F=>{if(x.TP.hasPermission(q.w.SettingsRead))try{F((0,Te.tC)());const[W,le]=await(0,pe.rC)();F((0,Te.eO)(le)),F((0,Te.cD)(!!W.signatureAlgorithm||!!W.privateKeyPath||!!W.privateKey||!!W.certificatePath||!!W.certificate)),F((0,Te.$$)(W.privateKeyPath?"path":"base64")),F((0,Te.w4)(!!W.privateKeyPath||!!W.privateKey)),F((0,Te.XN)(!!W.certificatePath||!!W.certificate)),F((0,Te.Zt)((0,ae.H)(W))),F((0,Te.Pr)(W))}catch{F((0,Te.ZC)())}}}function Rt(F,W){return async le=>{le((0,Te.SH)());const ne=me(F);if(!ne.valid){le((0,Te.Nh)({message:(0,S.t)("auth-config.save-samlsettings.message.cannot-save-settings","Cannot save settings"),errors:ne.errors}));return}await le((0,pe.aG)(F,W))&&(le(Kt()),le(pt()))}}function Vt(){return async F=>{await F((0,pe.Bw)())&&(F(Kt()),F(pt()))}}function jt(F){return async W=>{await W((0,pe.iZ)(F))&&(W(Kt()),W(pt()))}}function zt(F){return async W=>{await W((0,pe.DC)(F))&&(W(Kt()),W(pt()))}}function Kt(){return async F=>{F((0,Te.mA)(!0)),setTimeout(()=>{F((0,Te.mA)(!1))},bt)}}const Zt=F=>{const{samlSettings:W,storedSamlSettings:le,isUpdated:ne,visitedSteps:oe,keyCertValueType:ve,keyConfigured:Ae,certConfigured:De,signRequests:Ne,metadataValueType:He,showSavedBadge:We,error:ut}=F.samlConfig;return{isUpdated:ne,samlSettings:W,storedSamlSettings:le,visitedSteps:oe,keyCertValueType:ve,keyConfigured:Ae,certConfigured:De,signRequests:Ne,metadataValueType:He,showSavedBadge:We,error:ut}},Xe={addVisitedStep:Te.wj,clearSAMLState:Te.OG,saveSAMLSettings:Rt,enableSAML:jt,disableSAML:zt,resetSAMLSettings:Vt,setError:Te.Nh,resetError:Te.SH},Ze=(0,s.connect)(Zt,Xe),$e=({samlSettings:F,storedSamlSettings:W,keyCertValueType:le,metadataValueType:ne,signRequests:oe,activeStep:ve,addVisitedStep:Ae,children:De,clearSAMLState:Ne,confirmRedirect:He,keyConfigured:We,certConfigured:ut,isUpdated:je,error:Dt,resetError:xt,visitedSteps:gt,showSavedBadge:Ct,label:ft,className:Gt,getFormData:Et,onSubmit:wt,saveSAMLSettings:st,enableSAML:At,disableSAML:Ht,resetSAMLSettings:yt})=>{const Le=(0,m.of)(qe),It=Be(ve),Mt=(0,h.useRef)(null),[qt,Ft]=(0,h.useState)(He||je),nr=(0,C.Zp)(),Pt=(0,h.useCallback)(()=>{let ue={...F,keyCertValueType:le,signRequests:oe,metadataValueType:ne,keyConfigured:We,certConfigured:ut};if(Et){const ce=Et();ue={...ue,...ce}}return ue},[F,le,oe,ne,We,ut,Et]);(0,h.useEffect)(()=>{(ce=>{const vt=Pt();(0,L.rR)("authentication_saml_step",{step:ce,enabled:vt.enabled}),ce===Ye[Ye.length-1].id?Ae(Ye.map(kt=>kt.id)):Ae([ce])})(ve)},[ve,Ae,Pt]),(0,h.useEffect)(()=>{Ft(He||je)},[He,je]);const ir=ue=>{ue.preventDefault();const ce=(0,ae.Do)(It.id);wt(),nr(ce)},Jt=async ue=>{const ce=Pt();ue&&(ce.enabled=!0),st(ce,W),(0,L.rR)("authentication_saml_saved",{enabled:ce.enabled}),Ft(!1),Ne()},er=()=>{(0,L.rR)("authentication_saml_enabled",{enabled:!0}),At(F)},sr=()=>{(0,L.rR)("authentication_saml_disabled",{enabled:!1}),Ht(F)},_t=()=>{Ne();const ue=Pt();(0,L.rR)("authentication_saml_abandoned",{enabled:ue.enabled})},tr=()=>{const ue=Pt();(0,L.rR)("authentication_saml_removed",{enabled:ue.enabled}),yt()},Wt=ue=>!Ye.map(vt=>(0,ae.Do)(vt.id)).includes(ue.pathname),Xt=()=>{const ue=Ye[Ye.length-1].id;ve!==ue&&Mt.current?.click()},rr=Ce(Pt());return(0,t.jsxs)("form",{onSubmit:ir,className:Le.container,children:[(0,t.jsx)(G,{enabled:F.enabled,isNewConfig:(0,ae.nj)(W),onSave:()=>Jt(),onSaveAndEnable:()=>Jt(!0),onEnable:er,onDisable:sr,onRemove:tr}),(0,t.jsx)(j.F,{confirmRedirect:qt,onDiscard:_t,onLocationChange:Wt}),(0,t.jsxs)("div",{className:Le.inner,children:[(0,t.jsx)(Se.C,{steps:Ye,activeStep:ve,visitedSteps:gt,onStepChange:Xt,getNextUrl:ae.Do,validationResults:rr}),(0,t.jsx)(Ee,{}),(0,t.jsx)(ye,{error:Dt,onReset:xt}),(0,t.jsxs)("div",{className:(0,o.cx)(Le.content,Gt),children:[(0,t.jsx)(K.n,{label:(0,t.jsxs)("div",{className:Le.header,children:[ft&&(0,t.jsx)(U.s,{children:ft}),(0,t.jsx)("div",{children:Ct&&(0,t.jsx)(H.E,{text:(0,S.t)("auth-config.samlform.text-saved","Saved"),color:"green",icon:"check"})})]}),children:De}),(0,t.jsx)(Q,{ref:Mt,activeStep:ve})]})]})]})},qe=F=>({container:(0,o.css)({display:"flex",flexDirection:"column",height:"100%",alignContent:"center"}),header:(0,o.css)({display:"flex",justifyContent:"space-between"}),inner:(0,o.css)({display:"flex",justifyContent:"flex-start",flexDirection:"column",flex:"1 0 auto"}),content:(0,o.css)({paddingBottom:F.spacing(3)})}),Me=Ze($e),Je=[{label:"Default",value:""},{label:"Unspecified",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{label:"Email address",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{label:"Persistent",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{label:"Transient",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}];function et(F){return{samlSettings:F.samlConfig.samlSettings,clientSecretConfigured:!0}}const tt={settingsUpdated:Te.jA},rt=(0,s.connect)(et,tt),at=({clientSecretConfigured:F,samlSettings:W,settingsUpdated:le})=>{const ne=(0,m.of)(nt),{assertionAttributeName:oe,assertionAttributeLogin:ve,assertionAttributeEmail:Ae,assertionAttributeRole:De,assertionAttributeGroups:Ne,assertionAttributeOrg:He,assertionAttributeExternalUid:We,clientId:ut,clientSecret:je,tokenUrl:Dt,forceUseGraphApi:xt,roleValuesNone:gt,roleValuesViewer:Ct,roleValuesEditor:ft,roleValuesAdmin:Gt,roleValuesGrafanaAdmin:Et,orgMapping:wt,allowedOrganizations:st,nameIdFormat:At,skipOrgRoleSync:Ht}=W,{handleSubmit:yt,control:Le,register:It,getValues:Mt,setValue:qt,formState:{isDirty:Ft}}=(0,E.mN)({defaultValues:{assertionAttributeName:oe,assertionAttributeLogin:ve,assertionAttributeEmail:Ae,assertionAttributeRole:De,assertionAttributeGroups:Ne,assertionAttributeOrg:He,assertionAttributeExternalUid:We,clientId:ut,clientSecret:je,tokenUrl:Dt,forceUseGraphApi:xt,roleValuesNone:gt,roleValuesViewer:Ct,roleValuesEditor:ft,roleValuesAdmin:Gt,roleValuesGrafanaAdmin:Et,orgMapping:wt,allowedOrganizations:st,nameIdFormat:At||"",skipOrgRoleSync:Ht}}),nr=({...ue})=>{Ft&&le({...W,...ue})},Pt=ue=>Mt(ue)!=="",ir=ue=>{qt(ue,"",{shouldDirty:!0}),er(!1)},[Jt,er]=(0,h.useState)(F&&Pt("clientSecret")),sr=()=>{er(F&&Pt("clientSecret"))},{orgRole:_t,isGrafanaAdmin:tr}=x.TP.user,Wt=tr,Xt=_t==="Admin"||Wt,rr=_t==="Editor"||Xt;return(0,t.jsxs)(Me,{activeStep:a.SAMLStepKey.AssertionMapping,onSubmit:yt(nr),confirmRedirect:Ft,getFormData:Mt,className:ne.wrapper,label:(0,S.t)("auth-config.assertion-mapping-unconnected.label-user-mapping","User mapping"),children:[(0,t.jsx)("div",{className:ne.description,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.description-assertion-attributes-mapping",children:"Map SAML assertion attributes to the Grafana user attributes. Assertion attributes support template mappings. Team sync is available if groups attribute is configured."})}),(0,t.jsxs)("div",{className:ne.mappingContainer,children:[(0,t.jsxs)("div",{className:ne.mappingSection,children:[(0,t.jsxs)("div",{className:ne.mappingHeader,children:[(0,t.jsx)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.label-assertion-attributes-mapping",children:"Assertion attributes mappings"}),(0,t.jsx)(v.m,{content:(0,S.t)("auth-config.assertion-mapping-unconnected.tooltip-assertion-attributes-mapping","Assertion attributes mapping in Grafana takes user information from a SAML response and uses it to create or update a user in its database. It reads attributes\u2014key/value pairs\u2014within the assertion, such as Name, Login handle, and email. Configurations allow for key selection modification."),placement:"top",children:(0,t.jsx)(A.I,{name:"info-circle",className:ne.icon})})]}),(0,t.jsx)(E.xI,{name:"assertionAttributeName",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeName-label-name-attribute","Name attribute"),id:"assertionAttributeName",placeholder:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeName-placeholder-display-name","displayName")})}),(0,t.jsx)(E.xI,{name:"assertionAttributeLogin",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeLogin-label-login-attribute","Login attribute"),placeholder:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeLogin-placeholder-mail","mail"),id:"assertionAttributeLogin"})}),(0,t.jsx)(E.xI,{name:"assertionAttributeEmail",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeEmail-label-email-attribute","Email attribute"),placeholder:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeEmail-placeholder-mail","mail"),id:"assertionAttributeEmail"})}),(0,t.jsx)(E.xI,{name:"assertionAttributeGroups",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeGroups-label-groups-attribute","Groups attribute"),id:"assertionAttributeGroups"})}),(0,t.jsx)(E.xI,{name:"assertionAttributeRole",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeRole-label-role-attribute","Role attribute"),id:"assertionAttributeRole"})}),Xt&&(0,t.jsx)(E.xI,{name:"assertionAttributeOrg",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeOrg-label-org-attribute","Org attribute"),id:"assertionAttributeOrg"})}),(0,t.jsx)(E.xI,{name:"assertionAttributeExternalUid",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeExternalUid-label-external-uid","External UID attribute"),tooltip:(0,S.t)("auth-config.assertion-mapping-unconnected.assertionAttributeExternalUid-tooltip-external-uid","External UID mapping is a security mechanism that prevents impersonation and it is required only when SCIM provisioning is enabled. The provisioned External UID (the identity provider generated user id) needs to be present in the SAML assertion when the user logs in. The default value for this field is userUID."),id:"assertionAttributeExternalUid"})})]}),(0,t.jsxs)("div",{className:ne.mappingSection,children:[rr&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:ne.mappingHeader,children:[(0,t.jsx)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.label-role-mapping",children:"Role mapping"}),(0,t.jsx)(v.m,{content:(0,S.t)("auth-config.assertion-mapping-unconnected.tooltip-role-mapping","Role mapping syncs user roles from your identity provider to Grafana by configuring role attributes for None, Viewer, Editor, Admin, and Grafana Admin roles. In case there is no match, the default role in Grafana is Viewer."),placement:"top",children:(0,t.jsx)(A.I,{name:"info-circle",className:ne.icon})})]}),(0,t.jsx)(E.xI,{name:"roleValuesNone",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.roleValuesNone-label-none","None"),width:60,id:"roleValuesNone"})}),(0,t.jsx)(E.xI,{name:"roleValuesViewer",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.roleValuesViewer-label-viewer","Viewer"),width:60,id:"roleValuesViewer"})}),(0,t.jsx)(E.xI,{name:"roleValuesEditor",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.roleValuesEditor-label-editor","Editor"),width:60,id:"roleValuesEditor"})})]}),Xt&&(0,t.jsx)(E.xI,{name:"roleValuesAdmin",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.roleValuesAdmin-label-admin","Admin"),width:60,id:"roleValuesAdmin"})}),Wt&&(0,t.jsx)(E.xI,{name:"roleValuesGrafanaAdmin",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.roleValuesGrafanaAdmin-label-grafana-admin","Grafana Admin"),width:60,id:"roleValuesGrafanaAdmin"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.assertion-mapping-unconnected.label-skip-organization-role-sync","Skip organization role sync"),description:(0,S.t)("auth-config.assertion-mapping-unconnected.description-prevent-synchronizing-users-organization-roles","Prevent synchronizing for SAML users organization roles from your IdP."),children:(0,t.jsx)(g.d,{...It("skipOrgRoleSync"),defaultChecked:Ht,id:"skipOrgRoleSync"})})]}),Wt&&(0,t.jsxs)("div",{className:ne.mappingSection,children:[(0,t.jsxs)("div",{className:ne.mappingHeader,children:[(0,t.jsx)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.label-org-mapping",children:"Org mapping"}),(0,t.jsx)(v.m,{content:(0,S.t)("auth-config.assertion-mapping-unconnected.tooltip-org-mapping","Organization mapping allows you to assign users to particular organization in Grafana depending on attribute value obtained from identity provider. Use the configuration to assign users from your organization to the Grafana organization."),placement:"top",children:(0,t.jsx)(A.I,{name:"info-circle",className:ne.icon})})]}),(0,t.jsx)(E.xI,{name:"orgMapping",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.orgMapping-label-org-mapping","Org mapping"),width:60,id:"orgMapping"})})]})]}),(0,t.jsx)("div",{className:ne.mappingContainer,children:(0,t.jsxs)("div",{className:ne.mappingSection,children:[(0,t.jsx)("div",{className:ne.mappingHeader,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.azure-ad-service-account-configuration",children:"Azure AD Service Account Configuration"})}),(0,t.jsx)("div",{className:ne.description,children:(0,t.jsxs)(S.x6,{i18nKey:"auth-config.assertion-mapping-unconnected.description-azure-ad-service-account-configuration",children:["If you have users that belong to more than 150 groups in your Azure AD organization, you need to setup a service account in Azure AD to get all the groups via Graph API. This service account will be used to get all the groups for the user. Read more about Azure AD service account configuration in the\xA0",(0,t.jsx)(w.Y,{style:{fontSize:"inherit"},external:!0,href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/saml/#configure-a-graph-api-application-in-azure-ad",children:"documentation"}),"."]})}),(0,t.jsx)(E.xI,{name:"clientId",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.clientId-label-client-id","Client ID"),width:60,id:"clientId"})}),(0,t.jsx)(E.xI,{name:"clientSecret",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(N,{...ce,className:ne.clientSecretInput,width:60,id:"clientSecret",isConfigured:Jt,onReset:()=>ir("clientSecret"),onBlur:sr,label:(0,S.t)("auth-config.assertion-mapping-unconnected.clientSecret-label-client-secret","Client Secret")})}),(0,t.jsx)(E.xI,{name:"tokenUrl",control:Le,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(V,{...ce,label:(0,S.t)("auth-config.assertion-mapping-unconnected.tokenUrl-label-access-token-url","Access Token URL"),width:60,id:"tokenUrl"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.assertion-mapping-unconnected.label-force-use-graph-api","Force use Graph API"),description:(0,S.t)("auth-config.assertion-mapping-unconnected.description-force-use-graph-api","Force the use of Graph API to get all the groups for the user."),children:(0,t.jsx)(g.d,{...It("forceUseGraphApi"),defaultChecked:xt,id:"forceUseGraphApi"})})]})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.assertion-mapping-unconnected.label-allowed-organizations","Allowed organizations"),description:(0,S.t)("auth-config.assertion-mapping-unconnected.description-allowed-organizations","List of comma- or space-separated SAML organization names. User should be a member of at least one organization to log in."),children:(0,t.jsx)(n.p,{...It("allowedOrganizations"),id:"allowedOrganizations",width:60})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.assertion-mapping-unconnected.label-name-identifier-format","Name identifier format"),description:(0,S.t)("auth-config.assertion-mapping-unconnected.description-name-identifier-format","Name identifier formats control how the users at identity provider are mapped to users in Grafana"),children:(0,t.jsx)(E.xI,{name:"nameIdFormat",control:Le,render:({field:{ref:ue,onChange:ce,...vt}})=>(0,t.jsx)(u.l6,{...vt,onChange:kt=>{ce(kt.value)},width:30,options:Je,"aria-label":(0,S.t)("auth-config.assertion-mapping-unconnected.aria-label-name-id-format","nameIdFormat")})})})]})},nt=F=>({wrapper:(0,o.css)({width:"100%"}),description:(0,o.css)({color:F.colors.text.secondary,fontSize:F.typography.bodySmall.fontSize,marginBottom:F.spacing(2),textAlign:"justify",width:F.spacing(76.5)}),mappingContainer:(0,o.css)({background:F.colors.background.secondary,padding:F.spacing(2),marginBottom:F.spacing(4)}),mappingSection:(0,o.css)({marginBottom:F.spacing(2)}),mappingHeader:(0,o.css)({display:"flex",marginBottom:F.spacing(2)}),assertionEditorRow:(0,o.css)({display:"flex",marginBottom:F.spacing(1)}),icon:(0,o.css)({fill:F.colors.secondary.text,marginTop:F.spacing(.5),marginLeft:F.spacing(.5)}),clientSecretInput:(0,o.css)({background:F.components.input.background,color:F.components.input.text,marginBottom:F.spacing(1),width:"480px"})}),it=rt(at);var Ge=P(47931),Ve=P(77824),Fe=P(87105),Qe=P(57688),Qt=P(86224);function ur(F){return{samlSettings:F.samlConfig.samlSettings,metadataValueType:F.samlConfig.metadataValueType}}const cr={settingsUpdated:Te.jA,setMetadataValueType:Te.Zt},fr=(0,s.connect)(ur,cr),Yt=[{label:"URL for metadata",value:"url"},{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],dr=({samlSettings:F,metadataValueType:W,settingsUpdated:le,setMetadataValueType:ne})=>{const oe=(0,m.of)(hr),{idpMetadataUrl:ve,idpMetadataPath:Ae,idpMetadata:De,singleLogout:Ne}=F,{handleSubmit:He,control:We,register:ut,watch:je,getValues:Dt,setValue:xt,formState:{errors:gt,isDirty:Ct}}=(0,E.mN)({mode:"onBlur",defaultValues:{idpMetadataUrl:ve,idpMetadataPath:Ae,idpMetadata:De,metadataValueType:W||"url"}}),[ft,Gt]=(0,h.useState)([ve,Ae,De].filter(Boolean).length!==0),Et=je("metadataValueType"),wt=()=>["idpMetadataUrl","idpMetadataPath","idpMetadata"].map(je).filter(Boolean).length===1?!0:(0,S.t)("saml-connect-to-idp.validate-idp-metadata.require-one","One metadata type should be defined"),st=({currentTarget:{value:yt}})=>{Gt(!!yt)},At=({metadataValueType:yt,...Le})=>{Ct&&(le({...F,...Le}),ne(yt))},Ht=async yt=>{if(yt?.currentTarget?.files?.length){const It=await yt.currentTarget.files[0].text(),Mt=btoa(It);xt("idpMetadata",Mt,{shouldDirty:!0})}};return(0,t.jsx)(Me,{activeStep:a.SAMLStepKey.ConnectToIdP,onSubmit:He(At),confirmRedirect:Ct,getFormData:Dt,className:oe.wrapper,label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-connect-grafana-with-identity-provider","Connect Grafana with Identity Provider"),children:(0,t.jsxs)("div",{className:oe.externalBorder,children:[(0,t.jsxs)("div",{className:oe.doubleSideContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.step-number-1",children:"1"})}),(0,t.jsx)("h4",{children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.configure-idp-using-grafana-metadata",children:"Configure IdP using Grafana metadata"})})]}),(0,t.jsxs)("div",{className:oe.internalContainerBody,children:[(0,t.jsx)("div",{className:oe.description,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.description-setup-idp",children:"To configure your identity provider (IdP) you will need the Grafana metadata URL. All below endpoints must be reachable by your Identity Provider (IdP)."})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-sp-metadata-url-entity-id","Metadata URL"),description:(0,S.t)("auth-config.connect-to-idp-unconnected.description-sp-metadata-url-entity-id","SP metadata URL / SP Entity ID"),children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(n.p,{width:50,id:"spMetadata",value:Qt.EA,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Qt.EA,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.copy",children:"Copy"})})]})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-assertion-consumer-service-url","Assertion Consumer Service URL"),description:(0,S.t)("auth-config.connect-to-idp-unconnected.description-assertion-consumer-service-url","Assertion consumer service POST binding URL"),children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(n.p,{width:50,id:"spACS",value:Qt.QH,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Qt.QH,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.copy",children:"Copy"})})]})}),Ne&&(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-slo-url","SLO URL"),description:(0,S.t)("auth-config.connect-to-idp-unconnected.description-slo-url","Logout service redirect binding URL / Logout service POST binding URL"),children:(0,t.jsxs)("div",{className:oe.inputWithCopyToClipboard,children:[(0,t.jsx)(n.p,{width:50,id:"spSLO",value:Qt.Hp,disabled:!0}),(0,t.jsx)(Ge.b,{className:oe.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Qt.Hp,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.copy",children:"Copy"})})]})})]})]}),(0,t.jsxs)("div",{className:oe.internalContainer,children:[(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.step-number-2",children:"2"})}),(0,t.jsx)("h4",{children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.finish-configuring-grafana-using-idp-data",children:"Finish configuring Grafana using IdP data"})})]}),(0,t.jsxs)("div",{className:oe.internalContainerBody,children:[(0,t.jsx)("div",{className:oe.description,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.description-setup-required",children:"Visit your IdP's configuration panel, add new app and use metadata from step one to connect with Grafana. You will need to copy your IdP's metadata and provide it below. Test connection and copy assertion labels/values."})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-idp-metadata","IdP's metadata "),description:(0,S.t)("auth-config.connect-to-idp-unconnected.description-idp-metadata","Must be the same as set-up or required by IdP."),children:(0,t.jsx)(E.xI,{name:"metadataValueType",control:We,render:({field:{ref:yt,...Le}})=>(0,t.jsx)(Ve.z,{...Le,options:Yt,disabled:ft})})}),Et==="url"&&(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-metadata-url","Metadata URL"),description:(0,S.t)("auth-config.connect-to-idp-unconnected.description-metadata-url","URL for IdP metadata"),invalid:!!gt.idpMetadataUrl,error:gt.idpMetadataUrl?.message,children:(0,t.jsx)(n.p,{...ut("idpMetadataUrl",{onChange:st,validate:wt}),id:"metadataUrl",width:60})}),Et==="base64"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-baseencoded-idp-metadata","Base64-encoded IdP metadata"),invalid:!!gt.idpMetadata,error:gt.idpMetadata?.message,children:(0,t.jsx)(E.xI,{name:"idpMetadata",control:We,rules:{validate:wt},render:({field:{onChange:yt,...Le}})=>(0,t.jsx)(Fe.f,{...Le,id:"metadataBase64",width:60,onChange:It=>{yt(It),st(It)}})})}),(0,t.jsx)(Qe.e,{showFileName:!1,onFileUpload:Ht,className:oe.uploadButton})]}),Et==="path"&&(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.connect-to-idp-unconnected.label-path-to-idp-metadata-file","Path to IdP metadata file"),invalid:!!gt.idpMetadataPath,error:gt.idpMetadataPath?.message,children:(0,t.jsx)(n.p,{...ut("idpMetadataPath",{onChange:st,validate:wt}),id:"metadataPath",width:60})}),(0,t.jsx)("div",{className:oe.description,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.description-test-connection",children:"If you want to test the connection from your IdP's panel make sure to allow IdP initiated login and provide the relay state information."})})]})]})]}),(0,t.jsxs)("div",{className:oe.internalContainerHeader,children:[(0,t.jsx)("div",{className:oe.stepNumber,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.step-number-3",children:"3"})}),(0,t.jsx)("h4",{children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.connect-to-idp-unconnected.configure-assertions-group-mappings",children:"Configure assertions, group, group and org mappings in the next step."})})]})]})})},hr=F=>({wrapper:(0,o.css)({width:"100%"}),description:(0,o.css)({color:F.colors.text.secondary,marginBottom:F.spacing(2),fontSize:F.typography.bodySmall.fontSize}),externalBorder:(0,o.css)({borderRadius:F.shape.borderRadius(1),border:`1px solid ${F.colors.border.medium}`}),doubleSideContainer:(0,o.css)({display:"flex",flexDirection:"row",justifyContent:"space-around"}),internalContainer:(0,o.css)({flex:"1 1 0",borderBottom:`1px solid ${F.colors.border.medium}`,"&:first-child":{borderRight:`1px solid ${F.colors.border.medium}`}}),internalContainerHeader:(0,o.css)({display:"flex",justifyContent:"center",borderBottom:`1px solid ${F.colors.border.medium}`,padding:F.spacing(2),textAlign:"center",h4:{marginBottom:0}}),internalContainerBody:(0,o.css)({padding:F.spacing(2)}),stepNumber:(0,o.css)({border:`1px solid ${F.colors.background.secondary}`,borderRadius:F.shape.borderRadius(4),background:F.colors.background.secondary,color:F.colors.text.secondary,width:F.spacing(3),height:F.spacing(3),marginRight:F.spacing(1),fontWeight:F.typography.fontWeightBold}),copyToClipboardButton:(0,o.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"}),inputWithCopyToClipboard:(0,o.css)({padding:0,display:"flex"}),uploadButton:(0,o.css)({marginBottom:F.spacing(2)})}),pr=fr(dr),gr=F=>{const{samlSettings:W}=F.samlConfig;return{samlSettings:W}},yr={settingsUpdated:Te.jA},vr=(0,s.connect)(gr,yr)(({samlSettings:F,settingsUpdated:W})=>{const{allowSignUp:le,entityId:ne,name:oe,autoLogin:ve,singleLogout:Ae,allowIdpInitiated:De,relayState:Ne,maxIssueDelay:He,metadataValidDuration:We}=F||{},{handleSubmit:ut,register:je,watch:Dt,getValues:xt,formState:{isDirty:gt,errors:Ct}}=(0,E.mN)({mode:"onBlur",defaultValues:{allowSignUp:le,entityId:ne,name:oe,autoLogin:ve,singleLogout:Ae,allowIdpInitiated:De,relayState:Ne,maxIssueDelay:He,metadataValidDuration:We}}),ft=Dt("allowIdpInitiated"),Gt=st=>{gt&&W({...F,...st})},Et=st=>!st||ze(st)?!0:"Not a valid duration",wt=st=>ft&&st?st.length>80?"Relay state needs to be 80 characters or less":!0:"Relay state is required";return(0,t.jsxs)(Me,{activeStep:a.SAMLStepKey.General,onSubmit:ut(Gt),confirmRedirect:gt,getFormData:xt,label:(0,S.t)("auth-config.general-unconnected.label-general-settings","General settings"),children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-display-name-for-this-saml-integration","Display name for this SAML 2.0 integration"),description:(0,S.t)("auth-config.general-unconnected.description-display-name-for-this-saml-integration","Helpful if you use more than one SSO IdP provider or protocol."),children:(0,t.jsx)(n.p,{...je("name"),id:"displayName",width:60,placeholder:(0,S.t)("auth-config.general-unconnected.displayName-placeholder-saml","SAML")})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-entity-id","Entity ID"),description:(0,S.t)("auth-config.general-unconnected.description-entity-id","The entity ID is a globally unique identifier for the service provider. It is used to identify the service provider to the identity provider. Defaults to the URL of the Grafana instance."),children:(0,t.jsx)(n.p,{...je("entityId"),id:"entityId",width:60,placeholder:""})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-allow-signup","Allow signup"),description:(0,S.t)("auth-config.general-unconnected.description-allow-signup","Whether to allow new Grafana user creation through SAML login. If not enabled, then only existing Grafana users can log in with SAML."),children:(0,t.jsx)(g.d,{...je("allowSignUp"),defaultChecked:le,id:"allowSignup"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-auto-login","Auto login"),description:(0,S.t)("auth-config.general-unconnected.description-auto-login","Attempt to log in with SAML automatically, skipping the login screen."),children:(0,t.jsx)(g.d,{...je("autoLogin"),defaultChecked:ve,id:"autoLogin"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-single-logout","Single logout"),description:(0,S.t)("auth-config.general-unconnected.description-single-logout","Allows users to log out from IdP session and applications associated with the current IdP session established via SAML."),children:(0,t.jsx)(g.d,{...je("singleLogout"),defaultChecked:Ae,id:"singleLogout"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-identity-provider-initiated-login","Identity provider initiated login"),description:(0,S.t)("auth-config.general-unconnected.description-identity-provider-initiated-login","Allows users to log in into Grafana directly from identity provider."),children:(0,t.jsx)(g.d,{...je("allowIdpInitiated"),defaultChecked:De,id:"allowIdpInitiated"})}),ft&&(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-relay-state","Relay state"),description:(0,S.t)("auth-config.general-unconnected.description-relay-state","Required. Should match relay state configured in IdP and trailing space is required."),required:ft,invalid:ft&&!!Ct.relayState,error:Ct.relayState?.message,children:(0,t.jsx)(n.p,{...je("relayState",{validate:wt}),width:60,id:"relayState",defaultValue:Ne})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-max-issue-delay","Max issue delay"),description:(0,S.t)("auth-config.general-unconnected.description-max-issue-delay","Duration, since the IdP issued a response and Grafana is allowed to process it."),invalid:!!Ct.maxIssueDelay,error:Ct.maxIssueDelay?.message,children:(0,t.jsx)(n.p,{...je("maxIssueDelay",{validate:Et}),width:24,id:"max_issue_delay",defaultValue:He,placeholder:"90s"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.general-unconnected.label-metadata-valid-duration","Metadata valid duration"),description:(0,S.t)("auth-config.general-unconnected.description-duration-grafana-metadata-valid","Duration, for how long Grafana metadata is valid."),invalid:!!Ct.metadataValidDuration,error:Ct.metadataValidDuration?.message,children:(0,t.jsx)(n.p,{...je("metadataValidDuration",{validate:Et}),defaultValue:We,width:24,id:"metadataValidDuration",placeholder:"48h"})})]})});var mr=P(32899),Bt=P(75234);const lr=({isConfigured:F,onReset:W,onFileUpload:le,...ne})=>{const oe=(0,m.of)(xr);return(0,t.jsxs)("div",{className:oe.inputWithReset,children:[(0,t.jsxs)("div",{className:oe.textAreaInput,children:[F&&(0,t.jsx)(Fe.f,{...ne,value:"configured",disabled:!0}),!F&&(0,t.jsx)(Fe.f,{...ne})]}),F&&(0,t.jsx)(y.$n,{className:oe.fileUploadButton,variant:"primary",size:"md",onClick:W,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.text-input-with-reset.reset",children:"Reset"})}),!F&&(0,t.jsx)(Qe.e,{className:oe.fileUploadButton,showFileName:!1,onFileUpload:le})]})},xr=F=>({resetButton:(0,o.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"}),fileUploadButton:(0,o.css)({marginLeft:F.spacing(1)}),inputWithReset:(0,o.css)({padding:0,display:"flex"}),textAreaInput:(0,o.css)({width:F.spacing(60)})});var Cr=P(8207),Er=P(32881);const k=(0,s.connect)(void 0,{})(({onClose:F,onGenerateCert:W})=>{const{handleSubmit:le,register:ne,formState:{errors:oe}}=(0,E.mN)({mode:"onBlur",defaultValues:{validityDays:365,organization:"",country:"",state:"",city:""}}),ve=Ne=>!Ne||Ne.length>=2&&Ne.length<=3?!0:"Country code must have a length of 2 or 3 characters.",Ae=Ne=>Ne===void 0||isNaN(Number(Ne))||Ne<1||Ne>1e4?"Validity days must be a positive integer between 1 and 10000.":!0,De=Ne=>{W(Ne)};return(0,t.jsx)(Cr._,{title:(0,S.t)("auth-config.key-cert-drawer-unconnected.title-saml-key-and-certificate","SAML key and certificate"),subtitle:(0,S.t)("auth-config.key-cert-drawer-unconnected.subtitle-saml-key-and-certificate","The following data will be included in the generated certificate"),size:"md",onClose:F,children:(0,t.jsxs)("form",{onSubmit:Ne=>(Ne.stopPropagation(),le(De)(Ne)),children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-drawer-unconnected.label-your-organization","Your organization"),htmlFor:"organization",children:(0,t.jsx)(n.p,{...ne("organization"),width:48,id:"organization"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-drawer-unconnected.label-country-code","Country code"),invalid:!!oe.country,error:oe.country?.message,htmlFor:"country",children:(0,t.jsx)(n.p,{...ne("country",{validate:ve}),width:48,id:"country"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-drawer-unconnected.label-state","State"),htmlFor:"state",children:(0,t.jsx)(n.p,{...ne("state"),width:48,id:"state"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-drawer-unconnected.label-city","City"),htmlFor:"city",children:(0,t.jsx)(n.p,{...ne("city"),width:48,id:"city"})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-drawer-unconnected.label-validity-days","Validity days"),description:(0,S.t)("auth-config.key-cert-drawer-unconnected.description-number-generated-certificate-valid","Number of days the generated certificate is valid for."),invalid:!!oe.validityDays,error:oe.validityDays?.message,htmlFor:"validityDays",children:(0,t.jsx)(n.p,{...ne("validityDays",{validate:Ae}),width:48,id:"validityDays"})}),(0,t.jsxs)(Er.Gy,{children:[(0,t.jsx)(y.$n,{type:"submit",size:"md",variant:"primary",tooltip:(0,S.t)("auth-config.key-cert-drawer-unconnected.tooltip-generate-the-certificate-and-private-key","Generate the certificate and private key"),children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.key-cert-drawer-unconnected.generate",children:"Generate"})}),(0,t.jsx)(y.$n,{type:"button",size:"md",variant:"secondary",onClick:F,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.key-cert-drawer-unconnected.close",children:"Close"})})]})]})})});function _(F){const{samlSettings:W,storedSamlSettings:le,signRequests:ne,keyCertValueType:oe,keyConfigured:ve,certConfigured:Ae}=F.samlConfig;return{samlSettings:W,storedSettings:le,signRequests:ne,keyCertValueType:oe,keyConfigured:ve,certConfigured:Ae}}const J={settingsUpdated:Te.jA,setSignRequests:Te.cD,setKeyCertValueType:Te.$$,setKeyConfigured:Te.w4,setCertConfigured:Te.XN},ee=(0,s.connect)(_,J),de=[{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],se=[{label:"RSA-SHA256",value:"rsa-sha256"},{label:"RSA-SHA512",value:"rsa-sha512"},{label:"RSA-SHA1",value:"rsa-sha1"}],Re={signRequests:!1,privateKey:"",privateKeyPath:"",certificate:"",certificatePath:"",signatureAlgorithm:"",keyConfigured:!1,certConfigured:!1,keyCertValueType:"base64"},Tt=ee(({samlSettings:F,storedSettings:W,signRequests:le,keyCertValueType:ne,keyConfigured:oe,certConfigured:ve,setKeyCertValueType:Ae,setSignRequests:De,setKeyConfigured:Ne,setCertConfigured:He,settingsUpdated:We})=>{const{privateKey:ut,privateKeyPath:je,certificate:Dt,certificatePath:xt,signatureAlgorithm:gt}=F||{},{handleSubmit:Ct,control:ft,register:Gt,watch:Et,getValues:wt,setValue:st,formState:{errors:At,isDirty:Ht}}=(0,E.mN)({mode:"onBlur",defaultValues:{privateKey:ut||"",privateKeyPath:je||"",certificate:Dt||"",certificatePath:xt||"",signatureAlgorithm:gt||"rsa-sha256",keyCertValueType:ne,signRequests:le||!!ut||!!je||!!Dt||!!xt||!!gt,keyConfigured:!1,certConfigured:!1}}),yt=(0,Bt.J7)(),[Le,It]=(0,h.useState)(!1),Mt=Et("signRequests"),qt=Et("keyCertValueType"),Ft=wt(),nr=oe&&(0,ae.A8)("privateKey",Ft,W),Pt=oe&&(0,ae.A8)("privateKeyPath",Ft,W),ir=ve&&(0,ae.A8)("certificate",Ft,W),Jt=ve&&(0,ae.A8)("certificatePath",Ft,W),er=ue=>{if(Ht){const{signRequests:ce,keyCertValueType:vt,certConfigured:kt,keyConfigured:St,...or}=ue;ce?(We({...F,...or}),Ae(vt)):(We({...F,...or,...Re}),Ae(Re.keyCertValueType)),De(ce)}},sr=()=>{let{...ue}=wt();return Mt||(ue={...ue,...Re}),{...ue,keyConfigured:oe,certConfigured:ve}},_t=ue=>()=>{st(ue,"",{shouldDirty:!0}),["privateKey","privateKeyPath"].includes(ue)?Ne(!1):He(!1)},tr=ue=>async ce=>{if(ce?.currentTarget?.files?.length){const kt=await ce.currentTarget.files[0].text(),St=btoa(kt);st(ue,St,{shouldDirty:!0})}};function Wt(ue){const ce="0123456789abcdef",vt=new Uint32Array(ue);crypto.getRandomValues(vt);let kt="";for(let St=0;St<ue;St++)kt+=ce[Math.floor(vt[St]/2**32*ce.length)];return kt}const Xt=ue=>{It(!1);const ce=Z().pki.rsa.generateKeyPair(2048),vt=Z().pki.privateKeyToAsn1(ce.privateKey),kt=Z().pki.wrapRsaPrivateKey(vt),St=Z().pki.createCertificate();St.publicKey=ce.publicKey,St.serialNumber="01"+Wt(16),St.validity.notBefore=new Date,St.validity.notAfter=new Date(new Date().getTime()+1e3*60*60*24*ue.validityDays);const or=[{name:"organizationName",value:ue.organization},{name:"countryName",value:ue.country},{shortName:"ST",value:ue.state},{name:"localityName",value:ue.city}];St.setSubject(or),St.setIssuer(or),St.sign(ce.privateKey);const Dr=Z().pki.certificateToPem(St),wr=Z().pki.privateKeyInfoToPem(kt);st("privateKey",btoa(wr),{shouldDirty:!0}),st("certificate",btoa(Dr),{shouldDirty:!0}),yt.publish({type:mr.r1.alertSuccess.name,payload:["The SAML certificate and key have been successfully generated."]})},rr=(ue,ce,vt)=>ce?!0:ne==="base64"&&vt==="privateKey"&&ue&&!ot(ue)?"Not valid PEM key":ne==="base64"&&vt==="certificate"&&ue&&!dt(ue)?"Not valid PEM certificate":!0;return(0,t.jsxs)(Me,{activeStep:a.SAMLStepKey.KeyCert,onSubmit:Ct(er),confirmRedirect:Ht,getFormData:sr,label:(0,S.t)("auth-config.key-cert-unconnected.label-sign-requests","Sign requests"),children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-sign-requests","Sign requests"),description:(0,S.t)("auth-config.key-cert-unconnected.description-sign-outgoing-requests-to-id-p","Sign outgoing requests to IdP"),children:(0,t.jsx)(g.d,{...Gt("signRequests"),id:"signRequests"})}),Mt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-signing-and-encryption-key-certificate","Signing and encryption key and certificate"),htmlFor:"certOptions",description:(0,S.t)("auth-config.key-cert-unconnected.description-signing-and-encryption-key-certificate","Certificate and private key for exchanging information between the Grafana and the IdP. The private key needs to be issued in a PKCS#8 format. Certificate should be valid X.509 certificate."),children:(0,t.jsx)(E.xI,{name:"keyCertValueType",control:ft,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(Ve.z,{...ce,options:de,id:"certOptions"})})}),qt==="base64"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-private-key","Private key"),htmlFor:"privateKey",description:(0,S.t)("auth-config.key-cert-unconnected.description-baseencoded-private-key","Base64-encoded private key"),invalid:!!At.privateKey,error:At.privateKey?.message,children:(0,t.jsx)(E.xI,{name:"privateKey",control:ft,rules:{validate:ue=>rr(ue,oe,"privateKey")},render:({field:{ref:ue,...ce}})=>(0,t.jsx)(lr,{...ce,id:"privateKey",required:!0,isConfigured:nr,onReset:_t("privateKey"),onFileUpload:tr("privateKey")})})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-certificate","Certificate"),htmlFor:"certificate",description:(0,S.t)("auth-config.key-cert-unconnected.description-baseencoded-grafana-x-certificate","Base64-encoded Grafana X.509 certificate"),invalid:!!At.certificate,error:At.certificate?.message,children:(0,t.jsx)(E.xI,{name:"certificate",control:ft,rules:{validate:ue=>rr(ue,ve,"certificate")},render:({field:{ref:ue,...ce}})=>(0,t.jsx)(lr,{...ce,id:"certificate",required:!0,isConfigured:ir,onReset:_t("certificate"),onFileUpload:tr("certificate")})})}),(0,t.jsx)(f.D,{children:(0,t.jsx)(y.$n,{variant:"secondary",onClick:()=>It(!0),children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.key-cert-unconnected.generate-key-and-certificate",children:"Generate key and certificate"})})}),Le&&(0,t.jsx)(k,{onClose:()=>It(!1),onGenerateCert:Xt})]}),qt==="path"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-private-key","Private key"),description:(0,S.t)("auth-config.key-cert-unconnected.description-path-to-the-grafana-private-key","Path to the Grafana private key"),invalid:!!At.privateKey,error:At.privateKey?.message,children:(0,t.jsx)(E.xI,{name:"privateKeyPath",control:ft,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(N,{...ce,width:60,id:"privateKeyPath",isConfigured:Pt,onReset:_t("privateKeyPath")})})}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-certificate","Certificate"),description:(0,S.t)("auth-config.key-cert-unconnected.description-path-to-the-grafana-x-certificate","Path to the Grafana X.509 certificate"),invalid:!!At.certificate,error:At.certificate?.message,children:(0,t.jsx)(E.xI,{name:"certificatePath",control:ft,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(N,{...ce,width:60,id:"certificatePath",isConfigured:Jt,onReset:_t("certificatePath")})})})]}),(0,t.jsx)(f.D,{label:(0,S.t)("auth-config.key-cert-unconnected.label-signature-algorithm","Signature algorithm"),htmlFor:"signatureAlgorithm",description:(0,S.t)("auth-config.key-cert-unconnected.description-signature-algorithm","Signature algorithm used for signing requests to the IdP. Must be the same as set-up or required by IdP."),children:(0,t.jsx)(E.xI,{name:"signatureAlgorithm",control:ft,render:({field:{ref:ue,...ce}})=>(0,t.jsx)(Ve.z,{...ce,options:se,id:"signatureAlgorithm"})})})]})]})});var mt=P(41654),Ut=P(66404);function $t(F){const{samlSettings:W,storedSamlSettings:le,keyCertValueType:ne,metadataValueType:oe,signRequests:ve,keyConfigured:Ae,certConfigured:De}=F.samlConfig;return{samlSettings:W,storedSamlSettings:le,keyCertValueType:ne,metadataValueType:oe,signRequests:ve,keyConfigured:Ae,certConfigured:De}}const Nt={settingsUpdated:Te.jA,saveSAMLSettings:Rt},Ot=(0,s.connect)($t,Nt)(({samlSettings:F,storedSamlSettings:W,keyCertValueType:le,metadataValueType:ne,signRequests:oe,keyConfigured:ve,certConfigured:Ae,settingsUpdated:De,saveSAMLSettings:Ne})=>{const{handleSubmit:He,getValues:We,formState:{isDirty:ut}}=(0,E.mN)(),je=({enabled:xt})=>{ut&&De({...F,enabled:xt})},Dt=async()=>{let xt={...F,keyCertValueType:le,keyConfigured:ve,certConfigured:Ae,signRequests:oe,metadataValueType:ne,enabled:!0};Ne(xt,W),(0,L.rR)("authentication_saml_saved"),(0,Te.OG)()};return(0,t.jsx)(Me,{activeStep:a.SAMLStepKey.SaveAndTest,onSubmit:He(je),confirmRedirect:ut,getFormData:We,label:(0,S.t)("auth-config.save-and-test-unconnected.label-test-and-enable","Test and enable"),children:(0,t.jsxs)(mt.B,{direction:"column",alignItems:"flex-start",gap:2,children:[(0,t.jsx)(Ut.E,{children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.save-and-test-unconnected.text-save-and-enable",children:"If you are ready to apply your SAML configuration use the \u201CSave and enable\u201D button. You will be able to disable the configuration."})}),(0,t.jsx)(y.$n,{variant:"primary",onClick:Dt,children:(0,t.jsx)(S.x6,{i18nKey:"auth-config.save-and-test-unconnected.button-save-and-enable",children:"Save and enable"})})]})})}),Ye=[{id:a.SAMLStepKey.General,name:"General settings",component:vr},{id:a.SAMLStepKey.KeyCert,name:"Sign requests",component:Tt},{id:a.SAMLStepKey.ConnectToIdP,name:"Connect Grafana with Identity Provider",component:pr},{id:a.SAMLStepKey.AssertionMapping,name:"User mapping",component:it},{id:a.SAMLStepKey.SaveAndTest,name:"Test and enable",component:Ot}];function br(F){const{isLoading:W,samlSettings:le}=F.samlConfig;return{isLoading:W,samlSettings:le}}const Br={loadSAMLSettings:pt},Nr=(0,s.connect)(br,Br),Rr={text:"Setup SAML single sign on",subTitle:`This guided application will guide you through the configuration
  process of SAML. You will need to follow steps and visit your Identity
  Provider's application to connect it with Grafana (The Service provider).
  This guided application will help you keep track of your progress.`,icon:"shield",id:"SAML"},Ar=({loadSAMLSettings:F,isLoading:W,samlSettings:le})=>{const{step:ne="general"}=(0,C.g)();(0,h.useEffect)(()=>{F()},[F]);const ve=(0,h.useCallback)(()=>{const Ae=Ye.find(({id:De})=>De===ne)?.component;return Ae?(0,t.jsx)(Ae,{}):null},[ne])();return ve?(0,t.jsx)(T.Y,{navId:"authentication",pageNav:Rr,children:(0,t.jsx)(T.Y.Contents,{children:W||(0,e.isEmpty)(le)?(0,t.jsx)(p.a,{}):ve})}):(0,t.jsx)(d.H,{})},Ir=Nr(Ar),Lr=Ir},87049:(re,xe,P)=>{"use strict";P.d(xe,{a:()=>s});var t=P(74848),e=P(31286),h=P(6975);const s=({text:C="Loading..."})=>(0,t.jsx)(e.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(h._,{text:C})})},39504:(re,xe,P)=>{var t=P(50276);P(93900),P(56370),P(7619),re.exports=t.aes=t.aes||{},t.aes.startEncrypting=function(v,A,f,g){var w=m({key:v,output:f,decrypt:!1,mode:g});return w.start(A),w},t.aes.createEncryptionCipher=function(v,A){return m({key:v,output:null,decrypt:!1,mode:A})},t.aes.startDecrypting=function(v,A,f,g){var w=m({key:v,output:f,decrypt:!0,mode:g});return w.start(A),w},t.aes.createDecryptionCipher=function(v,A){return m({key:v,output:null,decrypt:!0,mode:A})},t.aes.Algorithm=function(v,A){h||o();var f=this;f.name=v,f.mode=new A({blockSize:16,cipher:{encrypt:function(g,w){return S(f._w,g,w,!1)},decrypt:function(g,w){return S(f._w,g,w,!0)}}}),f._init=!1},t.aes.Algorithm.prototype.initialize=function(v){if(!this._init){var A=v.key,f;if(typeof A=="string"&&(A.length===16||A.length===24||A.length===32))A=t.util.createBuffer(A);else if(t.util.isArray(A)&&(A.length===16||A.length===24||A.length===32)){f=A,A=t.util.createBuffer();for(var g=0;g<f.length;++g)A.putByte(f[g])}if(!t.util.isArray(A)){f=A,A=[];var w=f.length();if(w===16||w===24||w===32){w=w>>>2;for(var g=0;g<w;++g)A.push(f.getInt32())}}if(!t.util.isArray(A)||!(A.length===4||A.length===6||A.length===8))throw new Error("Invalid key parameter.");var n=this.mode.name,u=["CFB","OFB","CTR","GCM"].indexOf(n)!==-1;this._w=E(A,v.decrypt&&!u),this._init=!0}},t.aes._expandKey=function(v,A){return h||o(),E(v,A)},t.aes._updateBlock=S,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(v,A){var f=function(){return new t.aes.Algorithm(v,A)};t.cipher.registerAlgorithm(v,f)}var h=!1,s=4,C,T,d,p,a;function o(){h=!0,d=[0,1,2,4,8,16,32,64,128,27,54];for(var v=new Array(256),A=0;A<128;++A)v[A]=A<<1,v[A+128]=A+128<<1^283;C=new Array(256),T=new Array(256),p=new Array(4),a=new Array(4);for(var A=0;A<4;++A)p[A]=new Array(256),a[A]=new Array(256);for(var f=0,g=0,w,n,u,x,B,V,c,A=0;A<256;++A){x=g^g<<1^g<<2^g<<3^g<<4,x=x>>8^x&255^99,C[f]=x,T[x]=f,B=v[x],w=v[f],n=v[w],u=v[n],V=B<<24^x<<16^x<<8^(x^B),c=(w^n^u)<<24^(f^u)<<16^(f^n^u)<<8^(f^w^u);for(var y=0;y<4;++y)p[y][f]=V,a[y][x]=c,V=V<<24|V>>>8,c=c<<24|c>>>8;f===0?f=g=1:(f=w^v[v[v[w^u]]],g^=v[v[g]])}}function E(v,A){for(var f=v.slice(0),g,w=1,n=f.length,u=n+6+1,x=s*u,B=n;B<x;++B)g=f[B-1],B%n===0?(g=C[g>>>16&255]<<24^C[g>>>8&255]<<16^C[g&255]<<8^C[g>>>24]^d[w]<<24,w++):n>6&&B%n===4&&(g=C[g>>>24]<<24^C[g>>>16&255]<<16^C[g>>>8&255]<<8^C[g&255]),f[B]=f[B-n]^g;if(A){var V,c=a[0],y=a[1],N=a[2],r=a[3],L=f.slice(0);x=f.length;for(var B=0,K=x-s;B<x;B+=s,K-=s)if(B===0||B===x-s)L[B]=f[K],L[B+1]=f[K+3],L[B+2]=f[K+2],L[B+3]=f[K+1];else for(var U=0;U<s;++U)V=f[K+U],L[B+(3&-U)]=c[C[V>>>24]]^y[C[V>>>16&255]]^N[C[V>>>8&255]]^r[C[V&255]];f=L}return f}function S(v,A,f,g){var w=v.length/4-1,n,u,x,B,V;g?(n=a[0],u=a[1],x=a[2],B=a[3],V=T):(n=p[0],u=p[1],x=p[2],B=p[3],V=C);var c,y,N,r,L,K,U;c=A[0]^v[0],y=A[g?3:1]^v[1],N=A[2]^v[2],r=A[g?1:3]^v[3];for(var H=3,j=1;j<w;++j)L=n[c>>>24]^u[y>>>16&255]^x[N>>>8&255]^B[r&255]^v[++H],K=n[y>>>24]^u[N>>>16&255]^x[r>>>8&255]^B[c&255]^v[++H],U=n[N>>>24]^u[r>>>16&255]^x[c>>>8&255]^B[y&255]^v[++H],r=n[r>>>24]^u[c>>>16&255]^x[y>>>8&255]^B[N&255]^v[++H],c=L,y=K,N=U;f[0]=V[c>>>24]<<24^V[y>>>16&255]<<16^V[N>>>8&255]<<8^V[r&255]^v[++H],f[g?3:1]=V[y>>>24]<<24^V[N>>>16&255]<<16^V[r>>>8&255]<<8^V[c&255]^v[++H],f[2]=V[N>>>24]<<24^V[r>>>16&255]<<16^V[c>>>8&255]<<8^V[y&255]^v[++H],f[g?1:3]=V[r>>>24]<<24^V[c>>>16&255]<<16^V[y>>>8&255]<<8^V[N&255]^v[++H]}function m(v){v=v||{};var A=(v.mode||"CBC").toUpperCase(),f="AES-"+A,g;v.decrypt?g=t.cipher.createDecipher(f,v.key):g=t.cipher.createCipher(f,v.key);var w=g.start;return g.start=function(n,u){var x=null;u instanceof t.util.ByteBuffer&&(x=u,u={}),u=u||{},u.output=x,u.iv=n,w.call(g,u)},g}},38678:(re,xe,P)=>{var t=P(50276);P(39504),P(43986);var e=re.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,a.cipher_type=e.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=e.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:h},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,a.cipher_type=e.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=e.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:h};function h(a,o,E){var S=o.entity===t.tls.ConnectionEnd.client;a.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",S?E.keys.server_write_key:E.keys.client_write_key),iv:S?E.keys.server_write_IV:E.keys.client_write_IV},a.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",S?E.keys.client_write_key:E.keys.server_write_key),iv:S?E.keys.client_write_IV:E.keys.server_write_IV},a.read.cipherFunction=d,a.write.cipherFunction=s,a.read.macLength=a.write.macLength=E.mac_length,a.read.macFunction=a.write.macFunction=e.hmac_sha1}function s(a,o){var E=!1,S=o.macFunction(o.macKey,o.sequenceNumber,a);a.fragment.putBytes(S),o.updateSequenceNumber();var m;a.version.minor===e.Versions.TLS_1_0.minor?m=o.cipherState.init?null:o.cipherState.iv:m=t.random.getBytesSync(16),o.cipherState.init=!0;var v=o.cipherState.cipher;return v.start({iv:m}),a.version.minor>=e.Versions.TLS_1_1.minor&&v.output.putBytes(m),v.update(a.fragment),v.finish(C)&&(a.fragment=v.output,a.length=a.fragment.length(),E=!0),E}function C(a,o,E){if(!E){var S=a-o.length()%a;o.fillWithByte(S-1,S)}return!0}function T(a,o,E){var S=!0;if(E){for(var m=o.length(),v=o.last(),A=m-1-v;A<m-1;++A)S=S&&o.at(A)==v;S&&o.truncate(v+1)}return S}function d(a,o){var E=!1,S;a.version.minor===e.Versions.TLS_1_0.minor?S=o.cipherState.init?null:o.cipherState.iv:S=a.fragment.getBytes(16),o.cipherState.init=!0;var m=o.cipherState.cipher;m.start({iv:S}),m.update(a.fragment),E=m.finish(T);var v=o.macLength,A=t.random.getBytesSync(v),f=m.output.length();f>=v?(a.fragment=m.output.getBytes(f-v),A=m.output.getBytes(v)):a.fragment=m.output.getBytes(),a.fragment=t.util.createBuffer(a.fragment),a.length=a.fragment.length();var g=o.macFunction(o.macKey,o.sequenceNumber,a);return o.updateSequenceNumber(),E=p(o.macKey,A,g)&&E,E}function p(a,o,E){var S=t.hmac.create();return S.start("SHA1",a),S.update(o),o=S.digest().getBytes(),S.start(null,null),S.update(E),E=S.digest().getBytes(),o===E}},24309:(re,xe,P)=>{var t=P(50276);P(12746);var e=t.asn1;xe.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},xe.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},12746:(re,xe,P)=>{var t=P(50276);P(7619),P(94037);var e=re.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(d,p,a,o,E){if(t.util.isArray(o)){for(var S=[],m=0;m<o.length;++m)o[m]!==void 0&&S.push(o[m]);o=S}var v={tagClass:d,type:p,constructed:a,composed:a||t.util.isArray(o),value:o};return E&&"bitStringContents"in E&&(v.bitStringContents=E.bitStringContents,v.original=e.copy(v)),v},e.copy=function(d,p){var a;if(t.util.isArray(d)){a=[];for(var o=0;o<d.length;++o)a.push(e.copy(d[o],p));return a}return typeof d=="string"?d:(a={tagClass:d.tagClass,type:d.type,constructed:d.constructed,composed:d.composed,value:e.copy(d.value,p)},p&&!p.excludeBitStringContents&&(a.bitStringContents=d.bitStringContents),a)},e.equals=function(d,p,a){if(t.util.isArray(d)){if(!t.util.isArray(p)||d.length!==p.length)return!1;for(var o=0;o<d.length;++o)if(!e.equals(d[o],p[o]))return!1;return!0}if(typeof d!=typeof p)return!1;if(typeof d=="string")return d===p;var E=d.tagClass===p.tagClass&&d.type===p.type&&d.constructed===p.constructed&&d.composed===p.composed&&e.equals(d.value,p.value);return a&&a.includeBitStringContents&&(E=E&&d.bitStringContents===p.bitStringContents),E},e.getBerValueLength=function(d){var p=d.getByte();if(p!==128){var a,o=p&128;return o?a=d.getInt((p&127)<<3):a=p,a}};function h(d,p,a){if(a>p){var o=new Error("Too few bytes to parse DER.");throw o.available=d.length(),o.remaining=p,o.requested=a,o}}var s=function(d,p){var a=d.getByte();if(p--,a!==128){var o,E=a&128;if(!E)o=a;else{var S=a&127;h(d,p,S),o=d.getInt(S<<3)}if(o<0)throw new Error("Negative length: "+o);return o}};e.fromDer=function(d,p){p===void 0&&(p={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof p=="boolean"&&(p={strict:p,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in p||(p.strict=!0),"parseAllBytes"in p||(p.parseAllBytes=!0),"decodeBitStrings"in p||(p.decodeBitStrings=!0),typeof d=="string"&&(d=t.util.createBuffer(d));var a=d.length(),o=C(d,d.length(),0,p);if(p.parseAllBytes&&d.length()!==0){var E=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw E.byteCount=a,E.remaining=d.length(),E}return o};function C(d,p,a,o){var E;h(d,p,2);var S=d.getByte();p--;var m=S&192,v=S&31;E=d.length();var A=s(d,p);if(p-=E-d.length(),A!==void 0&&A>p){if(o.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=d.length(),f.remaining=p,f.requested=A,f}A=p}var g,w,n=(S&32)===32;if(n)if(g=[],A===void 0)for(;;){if(h(d,p,2),d.bytes(2)==="\0\0"){d.getBytes(2),p-=2;break}E=d.length(),g.push(C(d,p,a+1,o)),p-=E-d.length()}else for(;A>0;)E=d.length(),g.push(C(d,A,a+1,o)),p-=E-d.length(),A-=E-d.length();if(g===void 0&&m===e.Class.UNIVERSAL&&v===e.Type.BITSTRING&&(w=d.bytes(A)),g===void 0&&o.decodeBitStrings&&m===e.Class.UNIVERSAL&&v===e.Type.BITSTRING&&A>1){var u=d.read,x=p,B=0;if(v===e.Type.BITSTRING&&(h(d,p,1),B=d.getByte(),p--),B===0)try{E=d.length();var V={strict:!0,decodeBitStrings:!0},c=C(d,p,a+1,V),y=E-d.length();p-=y,v==e.Type.BITSTRING&&y++;var N=c.tagClass;y===A&&(N===e.Class.UNIVERSAL||N===e.Class.CONTEXT_SPECIFIC)&&(g=[c])}catch{}g===void 0&&(d.read=u,p=x)}if(g===void 0){if(A===void 0){if(o.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");A=p}if(v===e.Type.BMPSTRING)for(g="";A>0;A-=2)h(d,p,2),g+=String.fromCharCode(d.getInt16()),p-=2;else g=d.getBytes(A),p-=A}var r=w===void 0?null:{bitStringContents:w};return e.create(m,v,n,g,r)}e.toDer=function(d){var p=t.util.createBuffer(),a=d.tagClass|d.type,o=t.util.createBuffer(),E=!1;if("bitStringContents"in d&&(E=!0,d.original&&(E=e.equals(d,d.original))),E)o.putBytes(d.bitStringContents);else if(d.composed){d.constructed?a|=32:o.putByte(0);for(var S=0;S<d.value.length;++S)d.value[S]!==void 0&&o.putBuffer(e.toDer(d.value[S]))}else if(d.type===e.Type.BMPSTRING)for(var S=0;S<d.value.length;++S)o.putInt16(d.value.charCodeAt(S));else d.type===e.Type.INTEGER&&d.value.length>1&&(d.value.charCodeAt(0)===0&&(d.value.charCodeAt(1)&128)===0||d.value.charCodeAt(0)===255&&(d.value.charCodeAt(1)&128)===128)?o.putBytes(d.value.substr(1)):o.putBytes(d.value);if(p.putByte(a),o.length()<=127)p.putByte(o.length()&127);else{var m=o.length(),v="";do v+=String.fromCharCode(m&255),m=m>>>8;while(m>0);p.putByte(v.length|128);for(var S=v.length-1;S>=0;--S)p.putByte(v.charCodeAt(S))}return p.putBuffer(o),p},e.oidToDer=function(d){var p=d.split("."),a=t.util.createBuffer();a.putByte(40*parseInt(p[0],10)+parseInt(p[1],10));for(var o,E,S,m,v=2;v<p.length;++v){o=!0,E=[],S=parseInt(p[v],10);do m=S&127,S=S>>>7,o||(m|=128),E.push(m),o=!1;while(S>0);for(var A=E.length-1;A>=0;--A)a.putByte(E[A])}return a},e.derToOid=function(d){var p;typeof d=="string"&&(d=t.util.createBuffer(d));var a=d.getByte();p=Math.floor(a/40)+"."+a%40;for(var o=0;d.length()>0;)a=d.getByte(),o=o<<7,a&128?o+=a&127:(p+="."+(o+a),o=0);return p},e.utcTimeToDate=function(d){var p=new Date,a=parseInt(d.substr(0,2),10);a=a>=50?1900+a:2e3+a;var o=parseInt(d.substr(2,2),10)-1,E=parseInt(d.substr(4,2),10),S=parseInt(d.substr(6,2),10),m=parseInt(d.substr(8,2),10),v=0;if(d.length>11){var A=d.charAt(10),f=10;A!=="+"&&A!=="-"&&(v=parseInt(d.substr(10,2),10),f+=2)}if(p.setUTCFullYear(a,o,E),p.setUTCHours(S,m,v,0),f&&(A=d.charAt(f),A==="+"||A==="-")){var g=parseInt(d.substr(f+1,2),10),w=parseInt(d.substr(f+4,2),10),n=g*60+w;n*=6e4,A==="+"?p.setTime(+p-n):p.setTime(+p+n)}return p},e.generalizedTimeToDate=function(d){var p=new Date,a=parseInt(d.substr(0,4),10),o=parseInt(d.substr(4,2),10)-1,E=parseInt(d.substr(6,2),10),S=parseInt(d.substr(8,2),10),m=parseInt(d.substr(10,2),10),v=parseInt(d.substr(12,2),10),A=0,f=0,g=!1;d.charAt(d.length-1)==="Z"&&(g=!0);var w=d.length-5,n=d.charAt(w);if(n==="+"||n==="-"){var u=parseInt(d.substr(w+1,2),10),x=parseInt(d.substr(w+4,2),10);f=u*60+x,f*=6e4,n==="+"&&(f*=-1),g=!0}return d.charAt(14)==="."&&(A=parseFloat(d.substr(14),10)*1e3),g?(p.setUTCFullYear(a,o,E),p.setUTCHours(S,m,v,A),p.setTime(+p+f)):(p.setFullYear(a,o,E),p.setHours(S,m,v,A)),p},e.dateToUtcTime=function(d){if(typeof d=="string")return d;var p="",a=[];a.push((""+d.getUTCFullYear()).substr(2)),a.push(""+(d.getUTCMonth()+1)),a.push(""+d.getUTCDate()),a.push(""+d.getUTCHours()),a.push(""+d.getUTCMinutes()),a.push(""+d.getUTCSeconds());for(var o=0;o<a.length;++o)a[o].length<2&&(p+="0"),p+=a[o];return p+="Z",p},e.dateToGeneralizedTime=function(d){if(typeof d=="string")return d;var p="",a=[];a.push(""+d.getUTCFullYear()),a.push(""+(d.getUTCMonth()+1)),a.push(""+d.getUTCDate()),a.push(""+d.getUTCHours()),a.push(""+d.getUTCMinutes()),a.push(""+d.getUTCSeconds());for(var o=0;o<a.length;++o)a[o].length<2&&(p+="0"),p+=a[o];return p+="Z",p},e.integerToDer=function(d){var p=t.util.createBuffer();if(d>=-128&&d<128)return p.putSignedInt(d,8);if(d>=-32768&&d<32768)return p.putSignedInt(d,16);if(d>=-8388608&&d<8388608)return p.putSignedInt(d,24);if(d>=-2147483648&&d<2147483648)return p.putSignedInt(d,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=d,a},e.derToInteger=function(d){typeof d=="string"&&(d=t.util.createBuffer(d));var p=d.length()*8;if(p>32)throw new Error("Integer too large; max is 32-bits.");return d.getSignedInt(p)},e.validate=function(d,p,a,o){var E=!1;if((d.tagClass===p.tagClass||typeof p.tagClass>"u")&&(d.type===p.type||typeof p.type>"u"))if(d.constructed===p.constructed||typeof p.constructed>"u"){if(E=!0,p.value&&t.util.isArray(p.value))for(var S=0,m=0;E&&m<p.value.length;++m)E=p.value[m].optional||!1,d.value[S]&&(E=e.validate(d.value[S],p.value[m],a,o),E?++S:p.value[m].optional&&(E=!0)),!E&&o&&o.push("["+p.name+'] Tag class "'+p.tagClass+'", type "'+p.type+'" expected value length "'+p.value.length+'", got "'+d.value.length+'"');if(E&&a&&(p.capture&&(a[p.capture]=d.value),p.captureAsn1&&(a[p.captureAsn1]=d),p.captureBitStringContents&&"bitStringContents"in d&&(a[p.captureBitStringContents]=d.bitStringContents),p.captureBitStringValue&&"bitStringContents"in d)){var v;if(d.bitStringContents.length<2)a[p.captureBitStringValue]="";else{var A=d.bitStringContents.charCodeAt(0);if(A!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[p.captureBitStringValue]=d.bitStringContents.slice(1)}}}else o&&o.push("["+p.name+'] Expected constructed "'+p.constructed+'", got "'+d.constructed+'"');else o&&(d.tagClass!==p.tagClass&&o.push("["+p.name+'] Expected tag class "'+p.tagClass+'", got "'+d.tagClass+'"'),d.type!==p.type&&o.push("["+p.name+'] Expected type "'+p.type+'", got "'+d.type+'"'));return E};var T=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(d,p,a){var o="";p=p||0,a=a||2,p>0&&(o+=`
`);for(var E="",S=0;S<p*a;++S)E+=" ";switch(o+=E+"Tag: ",d.tagClass){case e.Class.UNIVERSAL:o+="Universal:";break;case e.Class.APPLICATION:o+="Application:";break;case e.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case e.Class.PRIVATE:o+="Private:";break}if(d.tagClass===e.Class.UNIVERSAL)switch(o+=d.type,d.type){case e.Type.NONE:o+=" (None)";break;case e.Type.BOOLEAN:o+=" (Boolean)";break;case e.Type.INTEGER:o+=" (Integer)";break;case e.Type.BITSTRING:o+=" (Bit string)";break;case e.Type.OCTETSTRING:o+=" (Octet string)";break;case e.Type.NULL:o+=" (Null)";break;case e.Type.OID:o+=" (Object Identifier)";break;case e.Type.ODESC:o+=" (Object Descriptor)";break;case e.Type.EXTERNAL:o+=" (External or Instance of)";break;case e.Type.REAL:o+=" (Real)";break;case e.Type.ENUMERATED:o+=" (Enumerated)";break;case e.Type.EMBEDDED:o+=" (Embedded PDV)";break;case e.Type.UTF8:o+=" (UTF8)";break;case e.Type.ROID:o+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:o+=" (Sequence)";break;case e.Type.SET:o+=" (Set)";break;case e.Type.PRINTABLESTRING:o+=" (Printable String)";break;case e.Type.IA5String:o+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:o+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case e.Type.BMPSTRING:o+=" (BMP String)";break}else o+=d.type;if(o+=`
`,o+=E+"Constructed: "+d.constructed+`
`,d.composed){for(var m=0,v="",S=0;S<d.value.length;++S)d.value[S]!==void 0&&(m+=1,v+=e.prettyPrint(d.value[S],p+1,a),S+1<d.value.length&&(v+=","));o+=E+"Sub values: "+m+v}else{if(o+=E+"Value: ",d.type===e.Type.OID){var A=e.derToOid(d.value);o+=A,t.pki&&t.pki.oids&&A in t.pki.oids&&(o+=" ("+t.pki.oids[A]+") ")}if(d.type===e.Type.INTEGER)try{o+=e.derToInteger(d.value)}catch{o+="0x"+t.util.bytesToHex(d.value)}else if(d.type===e.Type.BITSTRING){if(d.value.length>1?o+="0x"+t.util.bytesToHex(d.value.slice(1)):o+="(none)",d.value.length>0){var f=d.value.charCodeAt(0);f==1?o+=" (1 unused bit shown)":f>1&&(o+=" ("+f+" unused bits shown)")}}else if(d.type===e.Type.OCTETSTRING)T.test(d.value)||(o+="("+d.value+") "),o+="0x"+t.util.bytesToHex(d.value);else if(d.type===e.Type.UTF8)try{o+=t.util.decodeUtf8(d.value)}catch(g){if(g.message==="URI malformed")o+="0x"+t.util.bytesToHex(d.value)+" (malformed UTF8)";else throw g}else d.type===e.Type.PRINTABLESTRING||d.type===e.Type.IA5String?o+=d.value:T.test(d.value)?o+="0x"+t.util.bytesToHex(d.value):d.value.length===0?o+="[null]":o+=d.value}return o}},44058:(re,xe,P)=>{var t=P(42363).Buffer,e={};re.exports=e;var h={};e.encode=function(C,T,d){if(typeof T!="string")throw new TypeError('"alphabet" must be a string.');if(d!==void 0&&typeof d!="number")throw new TypeError('"maxline" must be a number.');var p="";if(!(C instanceof Uint8Array))p=s(C,T);else{var a=0,o=T.length,E=T.charAt(0),S=[0];for(a=0;a<C.length;++a){for(var m=0,v=C[a];m<S.length;++m)v+=S[m]<<8,S[m]=v%o,v=v/o|0;for(;v>0;)S.push(v%o),v=v/o|0}for(a=0;C[a]===0&&a<C.length-1;++a)p+=E;for(a=S.length-1;a>=0;--a)p+=T[S[a]]}if(d){var A=new RegExp(".{1,"+d+"}","g");p=p.match(A).join(`\r
`)}return p},e.decode=function(C,T){if(typeof C!="string")throw new TypeError('"input" must be a string.');if(typeof T!="string")throw new TypeError('"alphabet" must be a string.');var d=h[T];if(!d){d=h[T]=[];for(var p=0;p<T.length;++p)d[T.charCodeAt(p)]=p}C=C.replace(/\s/g,"");for(var a=T.length,o=T.charAt(0),E=[0],p=0;p<C.length;p++){var S=d[C.charCodeAt(p)];if(S===void 0)return;for(var m=0,v=S;m<E.length;++m)v+=E[m]*a,E[m]=v&255,v>>=8;for(;v>0;)E.push(v&255),v>>=8}for(var A=0;C[A]===o&&A<C.length-1;++A)E.push(0);return typeof t<"u"?t.from(E.reverse()):new Uint8Array(E.reverse())};function s(C,T){var d=0,p=T.length,a=T.charAt(0),o=[0];for(d=0;d<C.length();++d){for(var E=0,S=C.at(d);E<o.length;++E)S+=o[E]<<8,o[E]=S%p,S=S/p|0;for(;S>0;)o.push(S%p),S=S/p|0}var m="";for(d=0;C.at(d)===0&&d<C.length()-1;++d)m+=a;for(d=o.length-1;d>=0;--d)m+=T[o[d]];return m}},93900:(re,xe,P)=>{var t=P(50276);P(7619),re.exports=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(h,s){var C=h;if(typeof C=="string"&&(C=t.cipher.getAlgorithm(C),C&&(C=C())),!C)throw new Error("Unsupported algorithm: "+h);return new t.cipher.BlockCipher({algorithm:C,key:s,decrypt:!1})},t.cipher.createDecipher=function(h,s){var C=h;if(typeof C=="string"&&(C=t.cipher.getAlgorithm(C),C&&(C=C())),!C)throw new Error("Unsupported algorithm: "+h);return new t.cipher.BlockCipher({algorithm:C,key:s,decrypt:!0})},t.cipher.registerAlgorithm=function(h,s){h=h.toUpperCase(),t.cipher.algorithms[h]=s},t.cipher.getAlgorithm=function(h){return h=h.toUpperCase(),h in t.cipher.algorithms?t.cipher.algorithms[h]:null};var e=t.cipher.BlockCipher=function(h){this.algorithm=h.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=h.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=h.decrypt,this.algorithm.initialize(h)};e.prototype.start=function(h){h=h||{};var s={};for(var C in h)s[C]=h[C];s.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=h.output||t.util.createBuffer(),this.mode.start(s)},e.prototype.update=function(h){for(h&&this._input.putBuffer(h);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(h){h&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(C){return h(this.blockSize,C,!1)},this.mode.unpad=function(C){return h(this.blockSize,C,!0)});var s={};return s.decrypt=this._decrypt,s.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,s)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,s))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,s))}},56370:(re,xe,P)=>{var t=P(50276);P(7619),t.cipher=t.cipher||{};var e=re.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(T){T=T||{},this.name="ECB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(T){},e.ecb.prototype.encrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a])},e.ecb.prototype.decrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a])},e.ecb.prototype.pad=function(T,d){var p=T.length()===this.blockSize?this.blockSize:this.blockSize-T.length();return T.fillWithByte(p,p),!0},e.ecb.prototype.unpad=function(T,d){if(d.overflow>0)return!1;var p=T.length(),a=T.at(p-1);return a>this.blockSize<<2?!1:(T.truncate(a),!0)},e.cbc=function(T){T=T||{},this.name="CBC",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(T){if(T.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in T)this._iv=h(T.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=this._prev[a]^T.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._outBlock[a]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(T,d,p){if(T.length()<this.blockSize&&!(p&&T.length()>0))return!0;for(var a=0;a<this._ints;++a)this._inBlock[a]=T.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a)d.putInt32(this._prev[a]^this._outBlock[a]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(T,d){var p=T.length()===this.blockSize?this.blockSize:this.blockSize-T.length();return T.fillWithByte(p,p),!0},e.cbc.prototype.unpad=function(T,d){if(d.overflow>0)return!1;var p=T.length(),a=T.at(p-1);return a>this.blockSize<<2?!1:(T.truncate(a),!0)},e.cfb=function(T){T=T||{},this.name="CFB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=T.getInt32()^this._outBlock[o],d.putInt32(this._inBlock[o]);return}var E=(this.blockSize-a)%this.blockSize;E>0&&(E=this.blockSize-E),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=T.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(E>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),E>0&&!p)return d.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=E,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=T.getInt32(),d.putInt32(this._inBlock[o]^this._outBlock[o]);return}var E=(this.blockSize-a)%this.blockSize;E>0&&(E=this.blockSize-E),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=T.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(E>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),E>0&&!p)return d.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=E,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.ofb=function(T){T=T||{},this.name="OFB",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(T,d,p){var a=T.length();if(T.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)d.putInt32(T.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var E=(this.blockSize-a)%this.blockSize;E>0&&(E=this.blockSize-E),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(E>0)T.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),E>0&&!p)return d.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=E,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(T){T=T||{},this.name="CTR",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");this._iv=h(T.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize)for(var o=0;o<this._ints;++o)d.putInt32(T.getInt32()^this._outBlock[o]);else{var E=(this.blockSize-a)%this.blockSize;E>0&&(E=this.blockSize-E),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(E>0&&(T.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),E>0&&!p)return d.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=E,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(T){T=T||{},this.name="GCM",this.cipher=T.cipher,this.blockSize=T.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(T){if(!("iv"in T))throw new Error("Invalid IV parameter.");var d=t.util.createBuffer(T.iv);this._cipherLength=0;var p;if("additionalData"in T?p=t.util.createBuffer(T.additionalData):p=t.util.createBuffer(),"tagLength"in T?this._tagLength=T.tagLength:this._tagLength=128,this._tag=null,T.decrypt&&(this._tag=t.util.createBuffer(T.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var a=d.length();if(a===12)this._j0=[d.getInt32(),d.getInt32(),d.getInt32(),1];else{for(this._j0=[0,0,0,0];d.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[d.getInt32(),d.getInt32(),d.getInt32(),d.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(C(a*8)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,p=t.util.createBuffer(p),this._aDataLength=C(p.length()*8);var o=p.length()%this.blockSize;for(o&&p.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];p.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[p.getInt32(),p.getInt32(),p.getInt32(),p.getInt32()])},e.gcm.prototype.encrypt=function(T,d,p){var a=T.length();if(a===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&a>=this.blockSize){for(var o=0;o<this._ints;++o)d.putInt32(this._outBlock[o]^=T.getInt32());this._cipherLength+=this.blockSize}else{var E=(this.blockSize-a)%this.blockSize;E>0&&(E=this.blockSize-E),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(T.getInt32()^this._outBlock[o]);if(E<=0||p){if(p){var S=a%this.blockSize;this._cipherLength+=S,this._partialOutput.truncate(this.blockSize-S)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),E>0&&!p)return T.read-=this.blockSize,d.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=E,!0;d.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},e.gcm.prototype.decrypt=function(T,d,p){var a=T.length();if(a<this.blockSize&&!(p&&a>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=T.getInt32(),this._hashBlock[1]=T.getInt32(),this._hashBlock[2]=T.getInt32(),this._hashBlock[3]=T.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)d.putInt32(this._outBlock[o]^this._hashBlock[o]);a<this.blockSize?this._cipherLength+=a%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(T,d){var p=!0;d.decrypt&&d.overflow&&T.truncate(this.blockSize-d.overflow),this.tag=t.util.createBuffer();var a=this._aDataLength.concat(C(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,a);var o=[];this.cipher.encrypt(this._j0,o);for(var E=0;E<this._ints;++E)this.tag.putInt32(this._s[E]^o[E]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),d.decrypt&&this.tag.bytes()!==this._tag&&(p=!1),p},e.gcm.prototype.multiply=function(T,d){for(var p=[0,0,0,0],a=d.slice(0),o=0;o<128;++o){var E=T[o/32|0]&1<<31-o%32;E&&(p[0]^=a[0],p[1]^=a[1],p[2]^=a[2],p[3]^=a[3]),this.pow(a,a)}return p},e.gcm.prototype.pow=function(T,d){for(var p=T[3]&1,a=3;a>0;--a)d[a]=T[a]>>>1|(T[a-1]&1)<<31;d[0]=T[0]>>>1,p&&(d[0]^=this._R)},e.gcm.prototype.tableMultiply=function(T){for(var d=[0,0,0,0],p=0;p<32;++p){var a=p/8|0,o=T[a]>>>(7-p%8)*4&15,E=this._m[p][o];d[0]^=E[0],d[1]^=E[1],d[2]^=E[2],d[3]^=E[3]}return d},e.gcm.prototype.ghash=function(T,d,p){return d[0]^=p[0],d[1]^=p[1],d[2]^=p[2],d[3]^=p[3],this.tableMultiply(d)},e.gcm.prototype.generateHashTable=function(T,d){for(var p=8/d,a=4*p,o=16*p,E=new Array(o),S=0;S<o;++S){var m=[0,0,0,0],v=S/a|0,A=(a-1-S%a)*d;m[v]=1<<d-1<<A,E[S]=this.generateSubHashTable(this.multiply(m,T),d)}return E},e.gcm.prototype.generateSubHashTable=function(T,d){var p=1<<d,a=p>>>1,o=new Array(p);o[a]=T.slice(0);for(var E=a>>>1;E>0;)this.pow(o[2*E],o[E]=[]),E>>=1;for(E=2;E<a;){for(var S=1;S<E;++S){var m=o[E],v=o[S];o[E+S]=[m[0]^v[0],m[1]^v[1],m[2]^v[2],m[3]^v[3]]}E*=2}for(o[0]=[0,0,0,0],E=a+1;E<p;++E){var A=o[E^a];o[E]=[T[0]^A[0],T[1]^A[1],T[2]^A[2],T[3]^A[3]]}return o};function h(T,d){if(typeof T=="string"&&(T=t.util.createBuffer(T)),t.util.isArray(T)&&T.length>4){var p=T;T=t.util.createBuffer();for(var a=0;a<p.length;++a)T.putByte(p[a])}if(T.length()<d)throw new Error("Invalid IV length; got "+T.length()+" bytes and expected "+d+" bytes.");if(!t.util.isArray(T)){for(var o=[],E=d/4,a=0;a<E;++a)o.push(T.getInt32());T=o}return T}function s(T){T[T.length-1]=T[T.length-1]+1&4294967295}function C(T){return[T/4294967296|0,T&4294967295]}},19095:(re,xe,P)=>{var t=P(50276);P(93900),P(56370),P(7619),re.exports=t.des=t.des||{},t.des.startEncrypting=function(v,A,f,g){var w=m({key:v,output:f,decrypt:!1,mode:g||(A===null?"ECB":"CBC")});return w.start(A),w},t.des.createEncryptionCipher=function(v,A){return m({key:v,output:null,decrypt:!1,mode:A})},t.des.startDecrypting=function(v,A,f,g){var w=m({key:v,output:f,decrypt:!0,mode:g||(A===null?"ECB":"CBC")});return w.start(A),w},t.des.createDecryptionCipher=function(v,A){return m({key:v,output:null,decrypt:!0,mode:A})},t.des.Algorithm=function(v,A){var f=this;f.name=v,f.mode=new A({blockSize:8,cipher:{encrypt:function(g,w){return S(f._keys,g,w,!1)},decrypt:function(g,w){return S(f._keys,g,w,!0)}}}),f._init=!1},t.des.Algorithm.prototype.initialize=function(v){if(!this._init){var A=t.util.createBuffer(v.key);if(this.name.indexOf("3DES")===0&&A.length()!==24)throw new Error("Invalid Triple-DES key size: "+A.length()*8);this._keys=E(A),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(v,A){var f=function(){return new t.des.Algorithm(v,A)};t.cipher.registerAlgorithm(v,f)}var h=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],C=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],T=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],d=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],p=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],a=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],o=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function E(v){for(var A=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],f=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],g=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],w=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],u=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],x=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],B=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],V=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],y=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],N=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],r=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],L=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],K=v.length()>8?3:1,U=[],H=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],j=0,z,Y=0;Y<K;Y++){var X=v.getInt32(),$=v.getInt32();z=(X>>>4^$)&252645135,$^=z,X^=z<<4,z=($>>>-16^X)&65535,X^=z,$^=z<<-16,z=(X>>>2^$)&858993459,$^=z,X^=z<<2,z=($>>>-16^X)&65535,X^=z,$^=z<<-16,z=(X>>>1^$)&1431655765,$^=z,X^=z<<1,z=($>>>8^X)&16711935,X^=z,$^=z<<8,z=(X>>>1^$)&1431655765,$^=z,X^=z<<1,z=X<<8|$>>>20&240,X=$<<24|$<<8&16711680|$>>>8&65280|$>>>24&240,$=z;for(var te=0;te<H.length;++te){H[te]?(X=X<<2|X>>>26,$=$<<2|$>>>26):(X=X<<1|X>>>27,$=$<<1|$>>>27),X&=-15,$&=-15;var ge=A[X>>>28]|f[X>>>24&15]|g[X>>>20&15]|w[X>>>16&15]|n[X>>>12&15]|u[X>>>8&15]|x[X>>>4&15],Ee=B[$>>>28]|V[$>>>24&15]|c[$>>>20&15]|y[$>>>16&15]|N[$>>>12&15]|r[$>>>8&15]|L[$>>>4&15];z=(Ee>>>16^ge)&65535,U[j++]=ge^z,U[j++]=Ee^z<<16}}return U}function S(v,A,f,g){var w=v.length===32?3:9,n;w===3?n=g?[30,-2,-2]:[0,32,2]:n=g?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var u,x=A[0],B=A[1];u=(x>>>4^B)&252645135,B^=u,x^=u<<4,u=(x>>>16^B)&65535,B^=u,x^=u<<16,u=(B>>>2^x)&858993459,x^=u,B^=u<<2,u=(B>>>8^x)&16711935,x^=u,B^=u<<8,u=(x>>>1^B)&1431655765,B^=u,x^=u<<1,x=x<<1|x>>>31,B=B<<1|B>>>31;for(var V=0;V<w;V+=3){for(var c=n[V+1],y=n[V+2],N=n[V];N!=c;N+=y){var r=B^v[N],L=(B>>>4|B<<28)^v[N+1];u=x,x=B,B=u^(s[r>>>24&63]|T[r>>>16&63]|p[r>>>8&63]|o[r&63]|h[L>>>24&63]|C[L>>>16&63]|d[L>>>8&63]|a[L&63])}u=x,x=B,B=u}x=x>>>1|x<<31,B=B>>>1|B<<31,u=(x>>>1^B)&1431655765,B^=u,x^=u<<1,u=(B>>>8^x)&16711935,x^=u,B^=u<<8,u=(B>>>2^x)&858993459,x^=u,B^=u<<2,u=(x>>>16^B)&65535,B^=u,x^=u<<16,u=(x>>>4^B)&252645135,B^=u,x^=u<<4,f[0]=x,f[1]=B}function m(v){v=v||{};var A=(v.mode||"CBC").toUpperCase(),f="DES-"+A,g;v.decrypt?g=t.cipher.createDecipher(f,v.key):g=t.cipher.createCipher(f,v.key);var w=g.start;return g.start=function(n,u){var x=null;u instanceof t.util.ByteBuffer&&(x=u,u={}),u=u||{},u.output=x,u.iv=n,w.call(g,u)},g}},62926:(re,xe,P)=>{var t=P(42363).Buffer,e=P(50276);P(43736),P(89356),P(72313),P(7619);var h=P(24309),s=h.publicKeyValidator,C=h.privateKeyValidator;if(typeof T>"u")var T=e.jsbn.BigInteger;var d=e.util.ByteBuffer,p=typeof t>"u"?Uint8Array:t;e.pki=e.pki||{},re.exports=e.pki.ed25519=e.ed25519=e.ed25519||{};var a=e.ed25519;a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(Q){Q=Q||{};var l=Q.seed;if(l===void 0)l=e.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if(typeof l=="string"){if(l.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(l instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');l=o({message:l,encoding:"binary"});for(var D=new p(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=new p(a.constants.PRIVATE_KEY_BYTE_LENGTH),I=0;I<32;++I)i[I]=l[I];return u(D,i),{publicKey:D,privateKey:i}},a.privateKeyFromAsn1=function(Q){var l={},D=[],i=e.asn1.validate(Q,C,l,D);if(!i){var I=new Error("Invalid Key.");throw I.errors=D,I}var O=e.asn1.derToOid(l.privateKeyOid),G=e.oids.EdDSA25519;if(O!==G)throw new Error('Invalid OID "'+O+'"; OID must be "'+G+'".');var M=l.privateKey,q=o({message:e.asn1.fromDer(M).value,encoding:"binary"});return{privateKeyBytes:q}},a.publicKeyFromAsn1=function(Q){var l={},D=[],i=e.asn1.validate(Q,s,l,D);if(!i){var I=new Error("Invalid Key.");throw I.errors=D,I}var O=e.asn1.derToOid(l.publicKeyOid),G=e.oids.EdDSA25519;if(O!==G)throw new Error('Invalid OID "'+O+'"; OID must be "'+G+'".');var M=l.ed25519PublicKey;if(M.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return o({message:M,encoding:"binary"})},a.publicKeyFromPrivateKey=function(Q){Q=Q||{};var l=o({message:Q.privateKey,encoding:"binary"});if(l.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var D=new p(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<D.length;++i)D[i]=l[32+i];return D},a.sign=function(Q){Q=Q||{};var l=o(Q),D=o({message:Q.privateKey,encoding:"binary"});if(D.length===a.constants.SEED_BYTE_LENGTH){var i=a.generateKeyPair({seed:D});D=i.privateKey}else if(D.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.SEED_BYTE_LENGTH+" or "+a.constants.PRIVATE_KEY_BYTE_LENGTH);var I=new p(a.constants.SIGN_BYTE_LENGTH+l.length);x(I,l,l.length,D);for(var O=new p(a.constants.SIGN_BYTE_LENGTH),G=0;G<O.length;++G)O[G]=I[G];return O},a.verify=function(Q){Q=Q||{};var l=o(Q);if(Q.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var D=o({message:Q.signature,encoding:"binary"});if(D.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var i=o({message:Q.publicKey,encoding:"binary"});if(i.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var I=new p(a.constants.SIGN_BYTE_LENGTH+l.length),O=new p(a.constants.SIGN_BYTE_LENGTH+l.length),G;for(G=0;G<a.constants.SIGN_BYTE_LENGTH;++G)I[G]=D[G];for(G=0;G<l.length;++G)I[G+a.constants.SIGN_BYTE_LENGTH]=l[G];return B(O,I,I.length,i)>=0};function o(Q){var l=Q.message;if(l instanceof Uint8Array||l instanceof p)return l;var D=Q.encoding;if(l===void 0)if(Q.md)l=Q.md.digest().getBytes(),D="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof l=="string"&&!D)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof l=="string"){if(typeof t<"u")return t.from(l,D);l=new d(l,D)}else if(!(l instanceof d))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new p(l.length()),I=0;I<i.length;++I)i[I]=l.at(I);return i}var E=ie(),S=ie([1]),m=ie([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=ie([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),A=ie([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=ie([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),w=ie([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(Q,l){var D=e.md.sha512.create(),i=new d(Q);D.update(i.getBytes(l),"binary");var I=D.digest().getBytes();if(typeof t<"u")return t.from(I,"binary");for(var O=new p(a.constants.HASH_BYTE_LENGTH),G=0;G<64;++G)O[G]=I.charCodeAt(G);return O}function u(Q,l){var D=[ie(),ie(),ie(),ie()],i,I=n(l,32);for(I[0]&=248,I[31]&=127,I[31]|=64,te(D,I),r(Q,D),i=0;i<32;++i)l[i+32]=Q[i];return 0}function x(Q,l,D,i){var I,O,G=new Float64Array(64),M=[ie(),ie(),ie(),ie()],q=n(i,32);q[0]&=248,q[31]&=127,q[31]|=64;var pe=D+64;for(I=0;I<D;++I)Q[64+I]=l[I];for(I=0;I<32;++I)Q[32+I]=q[32+I];var he=n(Q.subarray(32),D+32);for(c(he),te(M,he),r(Q,M),I=32;I<64;++I)Q[I]=i[I];var Z=n(Q,D+64);for(c(Z),I=32;I<64;++I)G[I]=0;for(I=0;I<32;++I)G[I]=he[I];for(I=0;I<32;++I)for(O=0;O<32;O++)G[I+O]+=Z[I]*q[O];return V(Q.subarray(32),G),pe}function B(Q,l,D,i){var I,O,G=new p(32),M=[ie(),ie(),ie(),ie()],q=[ie(),ie(),ie(),ie()];if(O=-1,D<64||K(q,i))return-1;for(I=0;I<D;++I)Q[I]=l[I];for(I=0;I<32;++I)Q[I+32]=i[I];var pe=n(Q,D);if(c(pe),$(M,q,pe),te(q,l.subarray(32)),y(M,q),r(G,M),D-=64,z(l,0,G,0)){for(I=0;I<D;++I)Q[I]=0;return-1}for(I=0;I<D;++I)Q[I]=l[I+64];return O=D,O}function V(Q,l){var D,i,I,O;for(i=63;i>=32;--i){for(D=0,I=i-32,O=i-12;I<O;++I)l[I]+=D-16*l[i]*g[I-(i-32)],D=l[I]+128>>8,l[I]-=D*256;l[I]+=D,l[i]=0}for(D=0,I=0;I<32;++I)l[I]+=D-(l[31]>>4)*g[I],D=l[I]>>8,l[I]&=255;for(I=0;I<32;++I)l[I]-=D*g[I];for(i=0;i<32;++i)l[i+1]+=l[i]>>8,Q[i]=l[i]&255}function c(Q){for(var l=new Float64Array(64),D=0;D<64;++D)l[D]=Q[D],Q[D]=0;V(Q,l)}function y(Q,l){var D=ie(),i=ie(),I=ie(),O=ie(),G=ie(),M=ie(),q=ie(),pe=ie(),he=ie();Be(D,Q[1],Q[0]),Be(he,l[1],l[0]),Ie(D,D,he),ae(i,Q[0],Q[1]),ae(he,l[0],l[1]),Ie(i,i,he),Ie(I,Q[3],l[3]),Ie(I,I,v),Ie(O,Q[2],l[2]),ae(O,O,O),Be(G,i,D),Be(M,O,I),ae(q,O,I),ae(pe,i,D),Ie(Q[0],G,M),Ie(Q[1],pe,q),Ie(Q[2],q,M),Ie(Q[3],G,pe)}function N(Q,l,D){for(var i=0;i<4;++i)ye(Q[i],l[i],D)}function r(Q,l){var D=ie(),i=ie(),I=ie();Ee(I,l[2]),Ie(D,l[0],I),Ie(i,l[1],I),L(Q,i),Q[31]^=X(D)<<7}function L(Q,l){var D,i,I,O=ie(),G=ie();for(D=0;D<16;++D)G[D]=l[D];for(Se(G),Se(G),Se(G),i=0;i<2;++i){for(O[0]=G[0]-65517,D=1;D<15;++D)O[D]=G[D]-65535-(O[D-1]>>16&1),O[D-1]&=65535;O[15]=G[15]-32767-(O[14]>>16&1),I=O[15]>>16&1,O[14]&=65535,ye(G,O,1-I)}for(D=0;D<16;D++)Q[2*D]=G[D]&255,Q[2*D+1]=G[D]>>8}function K(Q,l){var D=ie(),i=ie(),I=ie(),O=ie(),G=ie(),M=ie(),q=ie();return ge(Q[2],S),U(Q[1],l),_e(I,Q[1]),Ie(O,I,m),Be(I,I,Q[2]),ae(O,Q[2],O),_e(G,O),_e(M,G),Ie(q,M,G),Ie(D,q,I),Ie(D,D,O),H(D,D),Ie(D,D,I),Ie(D,D,O),Ie(D,D,O),Ie(Q[0],D,O),_e(i,Q[0]),Ie(i,i,O),j(i,I)&&Ie(Q[0],Q[0],w),_e(i,Q[0]),Ie(i,i,O),j(i,I)?-1:(X(Q[0])===l[31]>>7&&Be(Q[0],E,Q[0]),Ie(Q[3],Q[0],Q[1]),0)}function U(Q,l){var D;for(D=0;D<16;++D)Q[D]=l[2*D]+(l[2*D+1]<<8);Q[15]&=32767}function H(Q,l){var D=ie(),i;for(i=0;i<16;++i)D[i]=l[i];for(i=250;i>=0;--i)_e(D,D),i!==1&&Ie(D,D,l);for(i=0;i<16;++i)Q[i]=D[i]}function j(Q,l){var D=new p(32),i=new p(32);return L(D,Q),L(i,l),z(D,0,i,0)}function z(Q,l,D,i){return Y(Q,l,D,i,32)}function Y(Q,l,D,i,I){var O,G=0;for(O=0;O<I;++O)G|=Q[l+O]^D[i+O];return(1&G-1>>>8)-1}function X(Q){var l=new p(32);return L(l,Q),l[0]&1}function $(Q,l,D){var i,I;for(ge(Q[0],E),ge(Q[1],S),ge(Q[2],S),ge(Q[3],E),I=255;I>=0;--I)i=D[I/8|0]>>(I&7)&1,N(Q,l,i),y(l,Q),y(Q,Q),N(Q,l,i)}function te(Q,l){var D=[ie(),ie(),ie(),ie()];ge(D[0],A),ge(D[1],f),ge(D[2],S),Ie(D[3],A,f),$(Q,D,l)}function ge(Q,l){var D;for(D=0;D<16;D++)Q[D]=l[D]|0}function Ee(Q,l){var D=ie(),i;for(i=0;i<16;++i)D[i]=l[i];for(i=253;i>=0;--i)_e(D,D),i!==2&&i!==4&&Ie(D,D,l);for(i=0;i<16;++i)Q[i]=D[i]}function Se(Q){var l,D,i=1;for(l=0;l<16;++l)D=Q[l]+i+65535,i=Math.floor(D/65536),Q[l]=D-i*65536;Q[0]+=i-1+37*(i-1)}function ye(Q,l,D){for(var i,I=~(D-1),O=0;O<16;++O)i=I&(Q[O]^l[O]),Q[O]^=i,l[O]^=i}function ie(Q){var l,D=new Float64Array(16);if(Q)for(l=0;l<Q.length;++l)D[l]=Q[l];return D}function ae(Q,l,D){for(var i=0;i<16;++i)Q[i]=l[i]+D[i]}function Be(Q,l,D){for(var i=0;i<16;++i)Q[i]=l[i]-D[i]}function _e(Q,l){Ie(Q,l,l)}function Ie(Q,l,D){var i,I,O=0,G=0,M=0,q=0,pe=0,he=0,Z=0,fe=0,me=0,be=0,Ce=0,we=0,Ke=0,Pe=0,Ue=0,Oe=0,ke=0,ze=0,ot=0,ct=0,dt=0,ht=0,Te=0,bt=0,pt=0,Rt=0,Vt=0,jt=0,zt=0,Kt=0,Zt=0,Xe=D[0],Ze=D[1],$e=D[2],qe=D[3],Me=D[4],Je=D[5],et=D[6],tt=D[7],rt=D[8],at=D[9],nt=D[10],it=D[11],Ge=D[12],Ve=D[13],Fe=D[14],Qe=D[15];i=l[0],O+=i*Xe,G+=i*Ze,M+=i*$e,q+=i*qe,pe+=i*Me,he+=i*Je,Z+=i*et,fe+=i*tt,me+=i*rt,be+=i*at,Ce+=i*nt,we+=i*it,Ke+=i*Ge,Pe+=i*Ve,Ue+=i*Fe,Oe+=i*Qe,i=l[1],G+=i*Xe,M+=i*Ze,q+=i*$e,pe+=i*qe,he+=i*Me,Z+=i*Je,fe+=i*et,me+=i*tt,be+=i*rt,Ce+=i*at,we+=i*nt,Ke+=i*it,Pe+=i*Ge,Ue+=i*Ve,Oe+=i*Fe,ke+=i*Qe,i=l[2],M+=i*Xe,q+=i*Ze,pe+=i*$e,he+=i*qe,Z+=i*Me,fe+=i*Je,me+=i*et,be+=i*tt,Ce+=i*rt,we+=i*at,Ke+=i*nt,Pe+=i*it,Ue+=i*Ge,Oe+=i*Ve,ke+=i*Fe,ze+=i*Qe,i=l[3],q+=i*Xe,pe+=i*Ze,he+=i*$e,Z+=i*qe,fe+=i*Me,me+=i*Je,be+=i*et,Ce+=i*tt,we+=i*rt,Ke+=i*at,Pe+=i*nt,Ue+=i*it,Oe+=i*Ge,ke+=i*Ve,ze+=i*Fe,ot+=i*Qe,i=l[4],pe+=i*Xe,he+=i*Ze,Z+=i*$e,fe+=i*qe,me+=i*Me,be+=i*Je,Ce+=i*et,we+=i*tt,Ke+=i*rt,Pe+=i*at,Ue+=i*nt,Oe+=i*it,ke+=i*Ge,ze+=i*Ve,ot+=i*Fe,ct+=i*Qe,i=l[5],he+=i*Xe,Z+=i*Ze,fe+=i*$e,me+=i*qe,be+=i*Me,Ce+=i*Je,we+=i*et,Ke+=i*tt,Pe+=i*rt,Ue+=i*at,Oe+=i*nt,ke+=i*it,ze+=i*Ge,ot+=i*Ve,ct+=i*Fe,dt+=i*Qe,i=l[6],Z+=i*Xe,fe+=i*Ze,me+=i*$e,be+=i*qe,Ce+=i*Me,we+=i*Je,Ke+=i*et,Pe+=i*tt,Ue+=i*rt,Oe+=i*at,ke+=i*nt,ze+=i*it,ot+=i*Ge,ct+=i*Ve,dt+=i*Fe,ht+=i*Qe,i=l[7],fe+=i*Xe,me+=i*Ze,be+=i*$e,Ce+=i*qe,we+=i*Me,Ke+=i*Je,Pe+=i*et,Ue+=i*tt,Oe+=i*rt,ke+=i*at,ze+=i*nt,ot+=i*it,ct+=i*Ge,dt+=i*Ve,ht+=i*Fe,Te+=i*Qe,i=l[8],me+=i*Xe,be+=i*Ze,Ce+=i*$e,we+=i*qe,Ke+=i*Me,Pe+=i*Je,Ue+=i*et,Oe+=i*tt,ke+=i*rt,ze+=i*at,ot+=i*nt,ct+=i*it,dt+=i*Ge,ht+=i*Ve,Te+=i*Fe,bt+=i*Qe,i=l[9],be+=i*Xe,Ce+=i*Ze,we+=i*$e,Ke+=i*qe,Pe+=i*Me,Ue+=i*Je,Oe+=i*et,ke+=i*tt,ze+=i*rt,ot+=i*at,ct+=i*nt,dt+=i*it,ht+=i*Ge,Te+=i*Ve,bt+=i*Fe,pt+=i*Qe,i=l[10],Ce+=i*Xe,we+=i*Ze,Ke+=i*$e,Pe+=i*qe,Ue+=i*Me,Oe+=i*Je,ke+=i*et,ze+=i*tt,ot+=i*rt,ct+=i*at,dt+=i*nt,ht+=i*it,Te+=i*Ge,bt+=i*Ve,pt+=i*Fe,Rt+=i*Qe,i=l[11],we+=i*Xe,Ke+=i*Ze,Pe+=i*$e,Ue+=i*qe,Oe+=i*Me,ke+=i*Je,ze+=i*et,ot+=i*tt,ct+=i*rt,dt+=i*at,ht+=i*nt,Te+=i*it,bt+=i*Ge,pt+=i*Ve,Rt+=i*Fe,Vt+=i*Qe,i=l[12],Ke+=i*Xe,Pe+=i*Ze,Ue+=i*$e,Oe+=i*qe,ke+=i*Me,ze+=i*Je,ot+=i*et,ct+=i*tt,dt+=i*rt,ht+=i*at,Te+=i*nt,bt+=i*it,pt+=i*Ge,Rt+=i*Ve,Vt+=i*Fe,jt+=i*Qe,i=l[13],Pe+=i*Xe,Ue+=i*Ze,Oe+=i*$e,ke+=i*qe,ze+=i*Me,ot+=i*Je,ct+=i*et,dt+=i*tt,ht+=i*rt,Te+=i*at,bt+=i*nt,pt+=i*it,Rt+=i*Ge,Vt+=i*Ve,jt+=i*Fe,zt+=i*Qe,i=l[14],Ue+=i*Xe,Oe+=i*Ze,ke+=i*$e,ze+=i*qe,ot+=i*Me,ct+=i*Je,dt+=i*et,ht+=i*tt,Te+=i*rt,bt+=i*at,pt+=i*nt,Rt+=i*it,Vt+=i*Ge,jt+=i*Ve,zt+=i*Fe,Kt+=i*Qe,i=l[15],Oe+=i*Xe,ke+=i*Ze,ze+=i*$e,ot+=i*qe,ct+=i*Me,dt+=i*Je,ht+=i*et,Te+=i*tt,bt+=i*rt,pt+=i*at,Rt+=i*nt,Vt+=i*it,jt+=i*Ge,zt+=i*Ve,Kt+=i*Fe,Zt+=i*Qe,O+=38*ke,G+=38*ze,M+=38*ot,q+=38*ct,pe+=38*dt,he+=38*ht,Z+=38*Te,fe+=38*bt,me+=38*pt,be+=38*Rt,Ce+=38*Vt,we+=38*jt,Ke+=38*zt,Pe+=38*Kt,Ue+=38*Zt,I=1,i=O+I+65535,I=Math.floor(i/65536),O=i-I*65536,i=G+I+65535,I=Math.floor(i/65536),G=i-I*65536,i=M+I+65535,I=Math.floor(i/65536),M=i-I*65536,i=q+I+65535,I=Math.floor(i/65536),q=i-I*65536,i=pe+I+65535,I=Math.floor(i/65536),pe=i-I*65536,i=he+I+65535,I=Math.floor(i/65536),he=i-I*65536,i=Z+I+65535,I=Math.floor(i/65536),Z=i-I*65536,i=fe+I+65535,I=Math.floor(i/65536),fe=i-I*65536,i=me+I+65535,I=Math.floor(i/65536),me=i-I*65536,i=be+I+65535,I=Math.floor(i/65536),be=i-I*65536,i=Ce+I+65535,I=Math.floor(i/65536),Ce=i-I*65536,i=we+I+65535,I=Math.floor(i/65536),we=i-I*65536,i=Ke+I+65535,I=Math.floor(i/65536),Ke=i-I*65536,i=Pe+I+65535,I=Math.floor(i/65536),Pe=i-I*65536,i=Ue+I+65535,I=Math.floor(i/65536),Ue=i-I*65536,i=Oe+I+65535,I=Math.floor(i/65536),Oe=i-I*65536,O+=I-1+37*(I-1),I=1,i=O+I+65535,I=Math.floor(i/65536),O=i-I*65536,i=G+I+65535,I=Math.floor(i/65536),G=i-I*65536,i=M+I+65535,I=Math.floor(i/65536),M=i-I*65536,i=q+I+65535,I=Math.floor(i/65536),q=i-I*65536,i=pe+I+65535,I=Math.floor(i/65536),pe=i-I*65536,i=he+I+65535,I=Math.floor(i/65536),he=i-I*65536,i=Z+I+65535,I=Math.floor(i/65536),Z=i-I*65536,i=fe+I+65535,I=Math.floor(i/65536),fe=i-I*65536,i=me+I+65535,I=Math.floor(i/65536),me=i-I*65536,i=be+I+65535,I=Math.floor(i/65536),be=i-I*65536,i=Ce+I+65535,I=Math.floor(i/65536),Ce=i-I*65536,i=we+I+65535,I=Math.floor(i/65536),we=i-I*65536,i=Ke+I+65535,I=Math.floor(i/65536),Ke=i-I*65536,i=Pe+I+65535,I=Math.floor(i/65536),Pe=i-I*65536,i=Ue+I+65535,I=Math.floor(i/65536),Ue=i-I*65536,i=Oe+I+65535,I=Math.floor(i/65536),Oe=i-I*65536,O+=I-1+37*(I-1),Q[0]=O,Q[1]=G,Q[2]=M,Q[3]=q,Q[4]=pe,Q[5]=he,Q[6]=Z,Q[7]=fe,Q[8]=me,Q[9]=be,Q[10]=Ce,Q[11]=we,Q[12]=Ke,Q[13]=Pe,Q[14]=Ue,Q[15]=Oe}},50276:re=>{re.exports={options:{usePureJavaScript:!1}}},71696:(re,xe,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.hmac=t.hmac||{};e.create=function(){var h=null,s=null,C=null,T=null,d={};return d.start=function(p,a){if(p!==null)if(typeof p=="string")if(p=p.toLowerCase(),p in t.md.algorithms)s=t.md.algorithms[p].create();else throw new Error('Unknown hash algorithm "'+p+'"');else s=p;if(a===null)a=h;else{if(typeof a=="string")a=t.util.createBuffer(a);else if(t.util.isArray(a)){var o=a;a=t.util.createBuffer();for(var E=0;E<o.length;++E)a.putByte(o[E])}var S=a.length();S>s.blockLength&&(s.start(),s.update(a.bytes()),a=s.digest()),C=t.util.createBuffer(),T=t.util.createBuffer(),S=a.length();for(var E=0;E<S;++E){var o=a.at(E);C.putByte(54^o),T.putByte(92^o)}if(S<s.blockLength)for(var o=s.blockLength-S,E=0;E<o;++E)C.putByte(54),T.putByte(92);h=a,C=C.bytes(),T=T.bytes()}s.start(),s.update(C)},d.update=function(p){s.update(p)},d.getMac=function(){var p=s.digest().bytes();return s.start(),s.update(T),s.update(p),s.digest()},d.digest=d.getMac,d}},39547:(re,xe,P)=>{re.exports=P(50276),P(39504),P(38678),P(12746),P(93900),P(19095),P(62926),P(71696),P(83432),P(74426),P(61355),P(45250),P(3254),P(2385),P(47501),P(55071),P(59343),P(29255),P(10268),P(73878),P(51417),P(89356),P(55124),P(50149),P(43986),P(7619)},43736:(re,xe,P)=>{var t=P(50276);re.exports=t.jsbn=t.jsbn||{};var e,h=0xdeadbeefcafe,s=(h&16777215)==15715070;function C(b,R,k){this.data=[],b!=null&&(typeof b=="number"?this.fromNumber(b,R,k):R==null&&typeof b!="string"?this.fromString(b,256):this.fromString(b,R))}t.jsbn.BigInteger=C;function T(){return new C(null)}function d(b,R,k,_,J,ee){for(;--ee>=0;){var de=R*this.data[b++]+k.data[_]+J;J=Math.floor(de/67108864),k.data[_++]=de&67108863}return J}function p(b,R,k,_,J,ee){for(var de=R&32767,se=R>>15;--ee>=0;){var Re=this.data[b]&32767,lt=this.data[b++]>>15,Tt=se*Re+lt*de;Re=de*Re+((Tt&32767)<<15)+k.data[_]+(J&1073741823),J=(Re>>>30)+(Tt>>>15)+se*lt+(J>>>30),k.data[_++]=Re&1073741823}return J}function a(b,R,k,_,J,ee){for(var de=R&16383,se=R>>14;--ee>=0;){var Re=this.data[b]&16383,lt=this.data[b++]>>14,Tt=se*Re+lt*de;Re=de*Re+((Tt&16383)<<14)+k.data[_]+J,J=(Re>>28)+(Tt>>14)+se*lt,k.data[_++]=Re&268435455}return J}typeof navigator>"u"?(C.prototype.am=a,e=28):s&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=p,e=30):s&&navigator.appName!="Netscape"?(C.prototype.am=d,e=26):(C.prototype.am=a,e=28),C.prototype.DB=e,C.prototype.DM=(1<<e)-1,C.prototype.DV=1<<e;var o=52;C.prototype.FV=Math.pow(2,o),C.prototype.F1=o-e,C.prototype.F2=2*e-o;var E="0123456789abcdefghijklmnopqrstuvwxyz",S=new Array,m,v;for(m=48,v=0;v<=9;++v)S[m++]=v;for(m=97,v=10;v<36;++v)S[m++]=v;for(m=65,v=10;v<36;++v)S[m++]=v;function A(b){return E.charAt(b)}function f(b,R){var k=S[b.charCodeAt(R)];return k??-1}function g(b){for(var R=this.t-1;R>=0;--R)b.data[R]=this.data[R];b.t=this.t,b.s=this.s}function w(b){this.t=1,this.s=b<0?-1:0,b>0?this.data[0]=b:b<-1?this.data[0]=b+this.DV:this.t=0}function n(b){var R=T();return R.fromInt(b),R}function u(b,R){var k;if(R==16)k=4;else if(R==8)k=3;else if(R==256)k=8;else if(R==2)k=1;else if(R==32)k=5;else if(R==4)k=2;else{this.fromRadix(b,R);return}this.t=0,this.s=0;for(var _=b.length,J=!1,ee=0;--_>=0;){var de=k==8?b[_]&255:f(b,_);if(de<0){b.charAt(_)=="-"&&(J=!0);continue}J=!1,ee==0?this.data[this.t++]=de:ee+k>this.DB?(this.data[this.t-1]|=(de&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=de>>this.DB-ee):this.data[this.t-1]|=de<<ee,ee+=k,ee>=this.DB&&(ee-=this.DB)}k==8&&(b[0]&128)!=0&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),J&&C.ZERO.subTo(this,this)}function x(){for(var b=this.s&this.DM;this.t>0&&this.data[this.t-1]==b;)--this.t}function B(b){if(this.s<0)return"-"+this.negate().toString(b);var R;if(b==16)R=4;else if(b==8)R=3;else if(b==2)R=1;else if(b==32)R=5;else if(b==4)R=2;else return this.toRadix(b);var k=(1<<R)-1,_,J=!1,ee="",de=this.t,se=this.DB-de*this.DB%R;if(de-- >0)for(se<this.DB&&(_=this.data[de]>>se)>0&&(J=!0,ee=A(_));de>=0;)se<R?(_=(this.data[de]&(1<<se)-1)<<R-se,_|=this.data[--de]>>(se+=this.DB-R)):(_=this.data[de]>>(se-=R)&k,se<=0&&(se+=this.DB,--de)),_>0&&(J=!0),J&&(ee+=A(_));return J?ee:"0"}function V(){var b=T();return C.ZERO.subTo(this,b),b}function c(){return this.s<0?this.negate():this}function y(b){var R=this.s-b.s;if(R!=0)return R;var k=this.t;if(R=k-b.t,R!=0)return this.s<0?-R:R;for(;--k>=0;)if((R=this.data[k]-b.data[k])!=0)return R;return 0}function N(b){var R=1,k;return(k=b>>>16)!=0&&(b=k,R+=16),(k=b>>8)!=0&&(b=k,R+=8),(k=b>>4)!=0&&(b=k,R+=4),(k=b>>2)!=0&&(b=k,R+=2),(k=b>>1)!=0&&(b=k,R+=1),R}function r(){return this.t<=0?0:this.DB*(this.t-1)+N(this.data[this.t-1]^this.s&this.DM)}function L(b,R){var k;for(k=this.t-1;k>=0;--k)R.data[k+b]=this.data[k];for(k=b-1;k>=0;--k)R.data[k]=0;R.t=this.t+b,R.s=this.s}function K(b,R){for(var k=b;k<this.t;++k)R.data[k-b]=this.data[k];R.t=Math.max(this.t-b,0),R.s=this.s}function U(b,R){var k=b%this.DB,_=this.DB-k,J=(1<<_)-1,ee=Math.floor(b/this.DB),de=this.s<<k&this.DM,se;for(se=this.t-1;se>=0;--se)R.data[se+ee+1]=this.data[se]>>_|de,de=(this.data[se]&J)<<k;for(se=ee-1;se>=0;--se)R.data[se]=0;R.data[ee]=de,R.t=this.t+ee+1,R.s=this.s,R.clamp()}function H(b,R){R.s=this.s;var k=Math.floor(b/this.DB);if(k>=this.t){R.t=0;return}var _=b%this.DB,J=this.DB-_,ee=(1<<_)-1;R.data[0]=this.data[k]>>_;for(var de=k+1;de<this.t;++de)R.data[de-k-1]|=(this.data[de]&ee)<<J,R.data[de-k]=this.data[de]>>_;_>0&&(R.data[this.t-k-1]|=(this.s&ee)<<J),R.t=this.t-k,R.clamp()}function j(b,R){for(var k=0,_=0,J=Math.min(b.t,this.t);k<J;)_+=this.data[k]-b.data[k],R.data[k++]=_&this.DM,_>>=this.DB;if(b.t<this.t){for(_-=b.s;k<this.t;)_+=this.data[k],R.data[k++]=_&this.DM,_>>=this.DB;_+=this.s}else{for(_+=this.s;k<b.t;)_-=b.data[k],R.data[k++]=_&this.DM,_>>=this.DB;_-=b.s}R.s=_<0?-1:0,_<-1?R.data[k++]=this.DV+_:_>0&&(R.data[k++]=_),R.t=k,R.clamp()}function z(b,R){var k=this.abs(),_=b.abs(),J=k.t;for(R.t=J+_.t;--J>=0;)R.data[J]=0;for(J=0;J<_.t;++J)R.data[J+k.t]=k.am(0,_.data[J],R,J,0,k.t);R.s=0,R.clamp(),this.s!=b.s&&C.ZERO.subTo(R,R)}function Y(b){for(var R=this.abs(),k=b.t=2*R.t;--k>=0;)b.data[k]=0;for(k=0;k<R.t-1;++k){var _=R.am(k,R.data[k],b,2*k,0,1);(b.data[k+R.t]+=R.am(k+1,2*R.data[k],b,2*k+1,_,R.t-k-1))>=R.DV&&(b.data[k+R.t]-=R.DV,b.data[k+R.t+1]=1)}b.t>0&&(b.data[b.t-1]+=R.am(k,R.data[k],b,2*k,0,1)),b.s=0,b.clamp()}function X(b,R,k){var _=b.abs();if(!(_.t<=0)){var J=this.abs();if(J.t<_.t){R?.fromInt(0),k!=null&&this.copyTo(k);return}k==null&&(k=T());var ee=T(),de=this.s,se=b.s,Re=this.DB-N(_.data[_.t-1]);Re>0?(_.lShiftTo(Re,ee),J.lShiftTo(Re,k)):(_.copyTo(ee),J.copyTo(k));var lt=ee.t,Tt=ee.data[lt-1];if(Tt!=0){var mt=Tt*(1<<this.F1)+(lt>1?ee.data[lt-2]>>this.F2:0),Ut=this.FV/mt,$t=(1<<this.F1)/mt,Nt=1<<this.F2,Lt=k.t,ar=Lt-lt,Ot=R??T();for(ee.dlShiftTo(ar,Ot),k.compareTo(Ot)>=0&&(k.data[k.t++]=1,k.subTo(Ot,k)),C.ONE.dlShiftTo(lt,Ot),Ot.subTo(ee,ee);ee.t<lt;)ee.data[ee.t++]=0;for(;--ar>=0;){var Ye=k.data[--Lt]==Tt?this.DM:Math.floor(k.data[Lt]*Ut+(k.data[Lt-1]+Nt)*$t);if((k.data[Lt]+=ee.am(0,Ye,k,ar,0,lt))<Ye)for(ee.dlShiftTo(ar,Ot),k.subTo(Ot,k);k.data[Lt]<--Ye;)k.subTo(Ot,k)}R!=null&&(k.drShiftTo(lt,R),de!=se&&C.ZERO.subTo(R,R)),k.t=lt,k.clamp(),Re>0&&k.rShiftTo(Re,k),de<0&&C.ZERO.subTo(k,k)}}}function $(b){var R=T();return this.abs().divRemTo(b,null,R),this.s<0&&R.compareTo(C.ZERO)>0&&b.subTo(R,R),R}function te(b){this.m=b}function ge(b){return b.s<0||b.compareTo(this.m)>=0?b.mod(this.m):b}function Ee(b){return b}function Se(b){b.divRemTo(this.m,null,b)}function ye(b,R,k){b.multiplyTo(R,k),this.reduce(k)}function ie(b,R){b.squareTo(R),this.reduce(R)}te.prototype.convert=ge,te.prototype.revert=Ee,te.prototype.reduce=Se,te.prototype.mulTo=ye,te.prototype.sqrTo=ie;function ae(){if(this.t<1)return 0;var b=this.data[0];if((b&1)==0)return 0;var R=b&3;return R=R*(2-(b&15)*R)&15,R=R*(2-(b&255)*R)&255,R=R*(2-((b&65535)*R&65535))&65535,R=R*(2-b*R%this.DV)%this.DV,R>0?this.DV-R:-R}function Be(b){this.m=b,this.mp=b.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<b.DB-15)-1,this.mt2=2*b.t}function _e(b){var R=T();return b.abs().dlShiftTo(this.m.t,R),R.divRemTo(this.m,null,R),b.s<0&&R.compareTo(C.ZERO)>0&&this.m.subTo(R,R),R}function Ie(b){var R=T();return b.copyTo(R),this.reduce(R),R}function Q(b){for(;b.t<=this.mt2;)b.data[b.t++]=0;for(var R=0;R<this.m.t;++R){var k=b.data[R]&32767,_=k*this.mpl+((k*this.mph+(b.data[R]>>15)*this.mpl&this.um)<<15)&b.DM;for(k=R+this.m.t,b.data[k]+=this.m.am(0,_,b,R,0,this.m.t);b.data[k]>=b.DV;)b.data[k]-=b.DV,b.data[++k]++}b.clamp(),b.drShiftTo(this.m.t,b),b.compareTo(this.m)>=0&&b.subTo(this.m,b)}function l(b,R){b.squareTo(R),this.reduce(R)}function D(b,R,k){b.multiplyTo(R,k),this.reduce(k)}Be.prototype.convert=_e,Be.prototype.revert=Ie,Be.prototype.reduce=Q,Be.prototype.mulTo=D,Be.prototype.sqrTo=l;function i(){return(this.t>0?this.data[0]&1:this.s)==0}function I(b,R){if(b>4294967295||b<1)return C.ONE;var k=T(),_=T(),J=R.convert(this),ee=N(b)-1;for(J.copyTo(k);--ee>=0;)if(R.sqrTo(k,_),(b&1<<ee)>0)R.mulTo(_,J,k);else{var de=k;k=_,_=de}return R.revert(k)}function O(b,R){var k;return b<256||R.isEven()?k=new te(R):k=new Be(R),this.exp(b,k)}C.prototype.copyTo=g,C.prototype.fromInt=w,C.prototype.fromString=u,C.prototype.clamp=x,C.prototype.dlShiftTo=L,C.prototype.drShiftTo=K,C.prototype.lShiftTo=U,C.prototype.rShiftTo=H,C.prototype.subTo=j,C.prototype.multiplyTo=z,C.prototype.squareTo=Y,C.prototype.divRemTo=X,C.prototype.invDigit=ae,C.prototype.isEven=i,C.prototype.exp=I,C.prototype.toString=B,C.prototype.negate=V,C.prototype.abs=c,C.prototype.compareTo=y,C.prototype.bitLength=r,C.prototype.mod=$,C.prototype.modPowInt=O,C.ZERO=n(0),C.ONE=n(1);function G(){var b=T();return this.copyTo(b),b}function M(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function q(){return this.t==0?this.s:this.data[0]<<24>>24}function pe(){return this.t==0?this.s:this.data[0]<<16>>16}function he(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function Z(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function fe(b){if(b==null&&(b=10),this.signum()==0||b<2||b>36)return"0";var R=this.chunkSize(b),k=Math.pow(b,R),_=n(k),J=T(),ee=T(),de="";for(this.divRemTo(_,J,ee);J.signum()>0;)de=(k+ee.intValue()).toString(b).substr(1)+de,J.divRemTo(_,J,ee);return ee.intValue().toString(b)+de}function me(b,R){this.fromInt(0),R==null&&(R=10);for(var k=this.chunkSize(R),_=Math.pow(R,k),J=!1,ee=0,de=0,se=0;se<b.length;++se){var Re=f(b,se);if(Re<0){b.charAt(se)=="-"&&this.signum()==0&&(J=!0);continue}de=R*de+Re,++ee>=k&&(this.dMultiply(_),this.dAddOffset(de,0),ee=0,de=0)}ee>0&&(this.dMultiply(Math.pow(R,ee)),this.dAddOffset(de,0)),J&&C.ZERO.subTo(this,this)}function be(b,R,k){if(typeof R=="number")if(b<2)this.fromInt(1);else for(this.fromNumber(b,k),this.testBit(b-1)||this.bitwiseTo(C.ONE.shiftLeft(b-1),ze,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(R);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(C.ONE.shiftLeft(b-1),this);else{var _=new Array,J=b&7;_.length=(b>>3)+1,R.nextBytes(_),J>0?_[0]&=(1<<J)-1:_[0]=0,this.fromString(_,256)}}function Ce(){var b=this.t,R=new Array;R[0]=this.s;var k=this.DB-b*this.DB%8,_,J=0;if(b-- >0)for(k<this.DB&&(_=this.data[b]>>k)!=(this.s&this.DM)>>k&&(R[J++]=_|this.s<<this.DB-k);b>=0;)k<8?(_=(this.data[b]&(1<<k)-1)<<8-k,_|=this.data[--b]>>(k+=this.DB-8)):(_=this.data[b]>>(k-=8)&255,k<=0&&(k+=this.DB,--b)),(_&128)!=0&&(_|=-256),J==0&&(this.s&128)!=(_&128)&&++J,(J>0||_!=this.s)&&(R[J++]=_);return R}function we(b){return this.compareTo(b)==0}function Ke(b){return this.compareTo(b)<0?this:b}function Pe(b){return this.compareTo(b)>0?this:b}function Ue(b,R,k){var _,J,ee=Math.min(b.t,this.t);for(_=0;_<ee;++_)k.data[_]=R(this.data[_],b.data[_]);if(b.t<this.t){for(J=b.s&this.DM,_=ee;_<this.t;++_)k.data[_]=R(this.data[_],J);k.t=this.t}else{for(J=this.s&this.DM,_=ee;_<b.t;++_)k.data[_]=R(J,b.data[_]);k.t=b.t}k.s=R(this.s,b.s),k.clamp()}function Oe(b,R){return b&R}function ke(b){var R=T();return this.bitwiseTo(b,Oe,R),R}function ze(b,R){return b|R}function ot(b){var R=T();return this.bitwiseTo(b,ze,R),R}function ct(b,R){return b^R}function dt(b){var R=T();return this.bitwiseTo(b,ct,R),R}function ht(b,R){return b&~R}function Te(b){var R=T();return this.bitwiseTo(b,ht,R),R}function bt(){for(var b=T(),R=0;R<this.t;++R)b.data[R]=this.DM&~this.data[R];return b.t=this.t,b.s=~this.s,b}function pt(b){var R=T();return b<0?this.rShiftTo(-b,R):this.lShiftTo(b,R),R}function Rt(b){var R=T();return b<0?this.lShiftTo(-b,R):this.rShiftTo(b,R),R}function Vt(b){if(b==0)return-1;var R=0;return(b&65535)==0&&(b>>=16,R+=16),(b&255)==0&&(b>>=8,R+=8),(b&15)==0&&(b>>=4,R+=4),(b&3)==0&&(b>>=2,R+=2),(b&1)==0&&++R,R}function jt(){for(var b=0;b<this.t;++b)if(this.data[b]!=0)return b*this.DB+Vt(this.data[b]);return this.s<0?this.t*this.DB:-1}function zt(b){for(var R=0;b!=0;)b&=b-1,++R;return R}function Kt(){for(var b=0,R=this.s&this.DM,k=0;k<this.t;++k)b+=zt(this.data[k]^R);return b}function Zt(b){var R=Math.floor(b/this.DB);return R>=this.t?this.s!=0:(this.data[R]&1<<b%this.DB)!=0}function Xe(b,R){var k=C.ONE.shiftLeft(b);return this.bitwiseTo(k,R,k),k}function Ze(b){return this.changeBit(b,ze)}function $e(b){return this.changeBit(b,ht)}function qe(b){return this.changeBit(b,ct)}function Me(b,R){for(var k=0,_=0,J=Math.min(b.t,this.t);k<J;)_+=this.data[k]+b.data[k],R.data[k++]=_&this.DM,_>>=this.DB;if(b.t<this.t){for(_+=b.s;k<this.t;)_+=this.data[k],R.data[k++]=_&this.DM,_>>=this.DB;_+=this.s}else{for(_+=this.s;k<b.t;)_+=b.data[k],R.data[k++]=_&this.DM,_>>=this.DB;_+=b.s}R.s=_<0?-1:0,_>0?R.data[k++]=_:_<-1&&(R.data[k++]=this.DV+_),R.t=k,R.clamp()}function Je(b){var R=T();return this.addTo(b,R),R}function et(b){var R=T();return this.subTo(b,R),R}function tt(b){var R=T();return this.multiplyTo(b,R),R}function rt(b){var R=T();return this.divRemTo(b,R,null),R}function at(b){var R=T();return this.divRemTo(b,null,R),R}function nt(b){var R=T(),k=T();return this.divRemTo(b,R,k),new Array(R,k)}function it(b){this.data[this.t]=this.am(0,b-1,this,0,0,this.t),++this.t,this.clamp()}function Ge(b,R){if(b!=0){for(;this.t<=R;)this.data[this.t++]=0;for(this.data[R]+=b;this.data[R]>=this.DV;)this.data[R]-=this.DV,++R>=this.t&&(this.data[this.t++]=0),++this.data[R]}}function Ve(){}function Fe(b){return b}function Qe(b,R,k){b.multiplyTo(R,k)}function Qt(b,R){b.squareTo(R)}Ve.prototype.convert=Fe,Ve.prototype.revert=Fe,Ve.prototype.mulTo=Qe,Ve.prototype.sqrTo=Qt;function ur(b){return this.exp(b,new Ve)}function cr(b,R,k){var _=Math.min(this.t+b.t,R);for(k.s=0,k.t=_;_>0;)k.data[--_]=0;var J;for(J=k.t-this.t;_<J;++_)k.data[_+this.t]=this.am(0,b.data[_],k,_,0,this.t);for(J=Math.min(b.t,R);_<J;++_)this.am(0,b.data[_],k,_,0,R-_);k.clamp()}function fr(b,R,k){--R;var _=k.t=this.t+b.t-R;for(k.s=0;--_>=0;)k.data[_]=0;for(_=Math.max(R-this.t,0);_<b.t;++_)k.data[this.t+_-R]=this.am(R-_,b.data[_],k,0,0,this.t+_-R);k.clamp(),k.drShiftTo(1,k)}function Yt(b){this.r2=T(),this.q3=T(),C.ONE.dlShiftTo(2*b.t,this.r2),this.mu=this.r2.divide(b),this.m=b}function dr(b){if(b.s<0||b.t>2*this.m.t)return b.mod(this.m);if(b.compareTo(this.m)<0)return b;var R=T();return b.copyTo(R),this.reduce(R),R}function hr(b){return b}function pr(b){for(b.drShiftTo(this.m.t-1,this.r2),b.t>this.m.t+1&&(b.t=this.m.t+1,b.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);b.compareTo(this.r2)<0;)b.dAddOffset(1,this.m.t+1);for(b.subTo(this.r2,b);b.compareTo(this.m)>=0;)b.subTo(this.m,b)}function gr(b,R){b.squareTo(R),this.reduce(R)}function yr(b,R,k){b.multiplyTo(R,k),this.reduce(k)}Yt.prototype.convert=dr,Yt.prototype.revert=hr,Yt.prototype.reduce=pr,Yt.prototype.mulTo=yr,Yt.prototype.sqrTo=gr;function Sr(b,R){var k=b.bitLength(),_,J=n(1),ee;if(k<=0)return J;k<18?_=1:k<48?_=3:k<144?_=4:k<768?_=5:_=6,k<8?ee=new te(R):R.isEven()?ee=new Yt(R):ee=new Be(R);var de=new Array,se=3,Re=_-1,lt=(1<<_)-1;if(de[1]=ee.convert(this),_>1){var Tt=T();for(ee.sqrTo(de[1],Tt);se<=lt;)de[se]=T(),ee.mulTo(Tt,de[se-2],de[se]),se+=2}var mt=b.t-1,Ut,$t=!0,Nt=T(),Lt;for(k=N(b.data[mt])-1;mt>=0;){for(k>=Re?Ut=b.data[mt]>>k-Re&lt:(Ut=(b.data[mt]&(1<<k+1)-1)<<Re-k,mt>0&&(Ut|=b.data[mt-1]>>this.DB+k-Re)),se=_;(Ut&1)==0;)Ut>>=1,--se;if((k-=se)<0&&(k+=this.DB,--mt),$t)de[Ut].copyTo(J),$t=!1;else{for(;se>1;)ee.sqrTo(J,Nt),ee.sqrTo(Nt,J),se-=2;se>0?ee.sqrTo(J,Nt):(Lt=J,J=Nt,Nt=Lt),ee.mulTo(Nt,de[Ut],J)}for(;mt>=0&&(b.data[mt]&1<<k)==0;)ee.sqrTo(J,Nt),Lt=J,J=Nt,Nt=Lt,--k<0&&(k=this.DB-1,--mt)}return ee.revert(J)}function Tr(b){var R=this.s<0?this.negate():this.clone(),k=b.s<0?b.negate():b.clone();if(R.compareTo(k)<0){var _=R;R=k,k=_}var J=R.getLowestSetBit(),ee=k.getLowestSetBit();if(ee<0)return R;for(J<ee&&(ee=J),ee>0&&(R.rShiftTo(ee,R),k.rShiftTo(ee,k));R.signum()>0;)(J=R.getLowestSetBit())>0&&R.rShiftTo(J,R),(J=k.getLowestSetBit())>0&&k.rShiftTo(J,k),R.compareTo(k)>=0?(R.subTo(k,R),R.rShiftTo(1,R)):(k.subTo(R,k),k.rShiftTo(1,k));return ee>0&&k.lShiftTo(ee,k),k}function vr(b){if(b<=0)return 0;var R=this.DV%b,k=this.s<0?b-1:0;if(this.t>0)if(R==0)k=this.data[0]%b;else for(var _=this.t-1;_>=0;--_)k=(R*k+this.data[_])%b;return k}function mr(b){var R=b.isEven();if(this.isEven()&&R||b.signum()==0)return C.ZERO;for(var k=b.clone(),_=this.clone(),J=n(1),ee=n(0),de=n(0),se=n(1);k.signum()!=0;){for(;k.isEven();)k.rShiftTo(1,k),R?((!J.isEven()||!ee.isEven())&&(J.addTo(this,J),ee.subTo(b,ee)),J.rShiftTo(1,J)):ee.isEven()||ee.subTo(b,ee),ee.rShiftTo(1,ee);for(;_.isEven();)_.rShiftTo(1,_),R?((!de.isEven()||!se.isEven())&&(de.addTo(this,de),se.subTo(b,se)),de.rShiftTo(1,de)):se.isEven()||se.subTo(b,se),se.rShiftTo(1,se);k.compareTo(_)>=0?(k.subTo(_,k),R&&J.subTo(de,J),ee.subTo(se,ee)):(_.subTo(k,_),R&&de.subTo(J,de),se.subTo(ee,se))}if(_.compareTo(C.ONE)!=0)return C.ZERO;if(se.compareTo(b)>=0)return se.subtract(b);if(se.signum()<0)se.addTo(b,se);else return se;return se.signum()<0?se.add(b):se}var Bt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lr=(1<<26)/Bt[Bt.length-1];function xr(b){var R,k=this.abs();if(k.t==1&&k.data[0]<=Bt[Bt.length-1]){for(R=0;R<Bt.length;++R)if(k.data[0]==Bt[R])return!0;return!1}if(k.isEven())return!1;for(R=1;R<Bt.length;){for(var _=Bt[R],J=R+1;J<Bt.length&&_<lr;)_*=Bt[J++];for(_=k.modInt(_);R<J;)if(_%Bt[R++]==0)return!1}return k.millerRabin(b)}function Cr(b){var R=this.subtract(C.ONE),k=R.getLowestSetBit();if(k<=0)return!1;for(var _=R.shiftRight(k),J=Er(),ee,de=0;de<b;++de){do ee=new C(this.bitLength(),J);while(ee.compareTo(C.ONE)<=0||ee.compareTo(R)>=0);var se=ee.modPow(_,this);if(se.compareTo(C.ONE)!=0&&se.compareTo(R)!=0){for(var Re=1;Re++<k&&se.compareTo(R)!=0;)if(se=se.modPowInt(2,this),se.compareTo(C.ONE)==0)return!1;if(se.compareTo(R)!=0)return!1}}return!0}function Er(){return{nextBytes:function(b){for(var R=0;R<b.length;++R)b[R]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=he,C.prototype.toRadix=fe,C.prototype.fromRadix=me,C.prototype.fromNumber=be,C.prototype.bitwiseTo=Ue,C.prototype.changeBit=Xe,C.prototype.addTo=Me,C.prototype.dMultiply=it,C.prototype.dAddOffset=Ge,C.prototype.multiplyLowerTo=cr,C.prototype.multiplyUpperTo=fr,C.prototype.modInt=vr,C.prototype.millerRabin=Cr,C.prototype.clone=G,C.prototype.intValue=M,C.prototype.byteValue=q,C.prototype.shortValue=pe,C.prototype.signum=Z,C.prototype.toByteArray=Ce,C.prototype.equals=we,C.prototype.min=Ke,C.prototype.max=Pe,C.prototype.and=ke,C.prototype.or=ot,C.prototype.xor=dt,C.prototype.andNot=Te,C.prototype.not=bt,C.prototype.shiftLeft=pt,C.prototype.shiftRight=Rt,C.prototype.getLowestSetBit=jt,C.prototype.bitCount=Kt,C.prototype.testBit=Zt,C.prototype.setBit=Ze,C.prototype.clearBit=$e,C.prototype.flipBit=qe,C.prototype.add=Je,C.prototype.subtract=et,C.prototype.multiply=tt,C.prototype.divide=rt,C.prototype.remainder=at,C.prototype.divideAndRemainder=nt,C.prototype.modPow=Sr,C.prototype.modInverse=mr,C.prototype.pow=ur,C.prototype.gcd=Tr,C.prototype.isProbablePrime=xr},83432:(re,xe,P)=>{var t=P(50276);P(7619),P(89356),P(43736),re.exports=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(s,C){C=C||{};var T=C.prng||t.random,d={};return d.encrypt=function(p,a){var o=Math.ceil(p.n.bitLength()/8),E;do E=new e(t.util.bytesToHex(T.getBytesSync(o)),16).mod(p.n);while(E.compareTo(e.ONE)<=0);E=t.util.hexToBytes(E.toString(16));var S=o-E.length;S>0&&(E=t.util.fillString("\0",S)+E);var m=p.encrypt(E,"NONE"),v=s.generate(E,a);return{encapsulation:m,key:v}},d.decrypt=function(p,a,o){var E=p.decrypt(a,"NONE");return s.generate(E,o)},d},t.kem.kdf1=function(s,C){h(this,s,0,C||s.digestLength)},t.kem.kdf2=function(s,C){h(this,s,1,C||s.digestLength)};function h(s,C,T,d){s.generate=function(p,a){for(var o=new t.util.ByteBuffer,E=Math.ceil(a/d)+T,S=new t.util.ByteBuffer,m=T;m<E;++m){S.putInt32(m),C.start(),C.update(p+S.getBytes());var v=C.digest();o.putBytes(v.getBytes(d))}return o.truncate(o.length()-a),o.getBytes()}}},74426:(re,xe,P)=>{var t=P(50276);P(7619),re.exports=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},h=[],s=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var C=0;C<t.log.levels.length;++C){var T=t.log.levels[C];e[T]={index:C,name:T.toUpperCase()}}t.log.logMessage=function(m){for(var v=e[m.level].index,A=0;A<h.length;++A){var f=h[A];if(f.flags&t.log.NO_LEVEL_CHECK)f.f(m);else{var g=e[f.level].index;v<=g&&f.f(f,m)}}},t.log.prepareStandard=function(m){"standard"in m||(m.standard=e[m.level].name+" ["+m.category+"] "+m.message)},t.log.prepareFull=function(m){if(!("full"in m)){var v=[m.message];v=v.concat([]),m.full=t.util.format.apply(this,v)}},t.log.prepareStandardFull=function(m){"standardFull"in m||(t.log.prepareStandard(m),m.standardFull=m.standard)};for(var d=["error","warning","info","debug","verbose"],C=0;C<d.length;++C)(function(v){t.log[v]=function(A,f){var g=Array.prototype.slice.call(arguments).slice(2),w={timestamp:new Date,level:v,category:A,message:f,arguments:g};t.log.logMessage(w)}})(d[C]);if(t.log.makeLogger=function(m){var v={flags:0,f:m};return t.log.setLevel(v,"none"),v},t.log.setLevel=function(m,v){var A=!1;if(m&&!(m.flags&t.log.LEVEL_LOCKED))for(var f=0;f<t.log.levels.length;++f){var g=t.log.levels[f];if(v==g){m.level=v,A=!0;break}}return A},t.log.lock=function(m,v){typeof v>"u"||v?m.flags|=t.log.LEVEL_LOCKED:m.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(m){h.push(m)},typeof console<"u"&&"log"in console){var p;if(console.error&&console.warn&&console.info&&console.debug){var a={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},o=function(m,v){t.log.prepareStandard(v);var A=a[v.level],f=[v.standard];f=f.concat(v.arguments.slice()),A.apply(console,f)};p=t.log.makeLogger(o)}else{var o=function(v,A){t.log.prepareStandardFull(A),console.log(A.standardFull)};p=t.log.makeLogger(o)}t.log.setLevel(p,"debug"),t.log.addLogger(p),s=p}else console={log:function(){}};if(s!==null&&typeof window<"u"&&window.location){var E=new URL(window.location.href).searchParams;if(E.has("console.level")&&t.log.setLevel(s,E.get("console.level").slice(-1)[0]),E.has("console.lock")){var S=E.get("console.lock").slice(-1)[0];S=="true"&&t.log.lock(s)}}t.log.consoleLogger=s},61355:(re,xe,P)=>{re.exports=P(8106),P(1267),P(21598),P(30172),P(72313)},8106:(re,xe,P)=>{var t=P(50276);re.exports=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{}},1267:(re,xe,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){d||p();var o=null,E=t.util.createBuffer(),S=new Array(16),m={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength64=[];for(var v=m.messageLengthSize/4,A=0;A<v;++A)m.fullMessageLength.push(0);return E=t.util.createBuffer(),o={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},m},m.start(),m.update=function(v,A){A==="utf8"&&(v=t.util.encodeUtf8(v));var f=v.length;m.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var g=m.fullMessageLength.length-1;g>=0;--g)m.fullMessageLength[g]+=f[1],f[1]=f[0]+(m.fullMessageLength[g]/4294967296>>>0),m.fullMessageLength[g]=m.fullMessageLength[g]>>>0,f[0]=f[1]/4294967296>>>0;return E.putBytes(v),a(o,S,E),(E.read>2048||E.length()===0)&&E.compact(),m},m.digest=function(){var v=t.util.createBuffer();v.putBytes(E.bytes());var A=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,f=A&m.blockLength-1;v.putBytes(h.substr(0,m.blockLength-f));for(var g,w=0,n=m.fullMessageLength.length-1;n>=0;--n)g=m.fullMessageLength[n]*8+w,w=g/4294967296>>>0,v.putInt32Le(g>>>0);var u={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3};a(u,S,v);var x=t.util.createBuffer();return x.putInt32Le(u.h0),x.putInt32Le(u.h1),x.putInt32Le(u.h2),x.putInt32Le(u.h3),x},m};var h=null,s=null,C=null,T=null,d=!1;function p(){h="\x80",h+=t.util.fillString("\0",64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],C=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],T=new Array(64);for(var o=0;o<64;++o)T[o]=Math.floor(Math.abs(Math.sin(o+1))*4294967296);d=!0}function a(o,E,S){for(var m,v,A,f,g,w,n,u,x=S.length();x>=64;){for(v=o.h0,A=o.h1,f=o.h2,g=o.h3,u=0;u<16;++u)E[u]=S.getInt32Le(),w=g^A&(f^g),m=v+w+T[u]+E[u],n=C[u],v=g,g=f,f=A,A+=m<<n|m>>>32-n;for(;u<32;++u)w=f^g&(A^f),m=v+w+T[u]+E[s[u]],n=C[u],v=g,g=f,f=A,A+=m<<n|m>>>32-n;for(;u<48;++u)w=A^f^g,m=v+w+T[u]+E[s[u]],n=C[u],v=g,g=f,f=A,A+=m<<n|m>>>32-n;for(;u<64;++u)w=f^(A|~g),m=v+w+T[u]+E[s[u]],n=C[u],v=g,g=f,f=A,A+=m<<n|m>>>32-n;o.h0=o.h0+v|0,o.h1=o.h1+A|0,o.h2=o.h2+f|0,o.h3=o.h3+g|0,x-=64}}},41373:(re,xe,P)=>{var t=P(50276);P(45250),re.exports=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1},45250:(re,xe,P)=>{var t=P(50276);P(7619),t.mgf=t.mgf||{};var e=re.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};e.create=function(h){var s={generate:function(C,T){for(var d=new t.util.ByteBuffer,p=Math.ceil(T/h.digestLength),a=0;a<p;a++){var o=new t.util.ByteBuffer;o.putInt32(a),h.start(),h.update(C+o.getBytes()),d.putBuffer(h.digest())}return d.truncate(d.length()-T),d.getBytes()}};return s}},94037:(re,xe,P)=>{var t=P(50276);t.pki=t.pki||{};var e=re.exports=t.pki.oids=t.oids=t.oids||{};function h(C,T){e[C]=T,e[T]=C}function s(C,T){e[C]=T}h("1.2.840.113549.1.1.1","rsaEncryption"),h("1.2.840.113549.1.1.4","md5WithRSAEncryption"),h("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),h("1.2.840.113549.1.1.7","RSAES-OAEP"),h("1.2.840.113549.1.1.8","mgf1"),h("1.2.840.113549.1.1.9","pSpecified"),h("1.2.840.113549.1.1.10","RSASSA-PSS"),h("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),h("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),h("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),h("1.3.101.112","EdDSA25519"),h("1.2.840.10040.4.3","dsa-with-sha1"),h("1.3.14.3.2.7","desCBC"),h("1.3.14.3.2.26","sha1"),h("1.3.14.3.2.29","sha1WithRSASignature"),h("2.16.840.1.101.3.4.2.1","sha256"),h("2.16.840.1.101.3.4.2.2","sha384"),h("2.16.840.1.101.3.4.2.3","sha512"),h("2.16.840.1.101.3.4.2.4","sha224"),h("2.16.840.1.101.3.4.2.5","sha512-224"),h("2.16.840.1.101.3.4.2.6","sha512-256"),h("1.2.840.113549.2.2","md2"),h("1.2.840.113549.2.5","md5"),h("1.2.840.113549.1.7.1","data"),h("1.2.840.113549.1.7.2","signedData"),h("1.2.840.113549.1.7.3","envelopedData"),h("1.2.840.113549.1.7.4","signedAndEnvelopedData"),h("1.2.840.113549.1.7.5","digestedData"),h("1.2.840.113549.1.7.6","encryptedData"),h("1.2.840.113549.1.9.1","emailAddress"),h("1.2.840.113549.1.9.2","unstructuredName"),h("1.2.840.113549.1.9.3","contentType"),h("1.2.840.113549.1.9.4","messageDigest"),h("1.2.840.113549.1.9.5","signingTime"),h("1.2.840.113549.1.9.6","counterSignature"),h("1.2.840.113549.1.9.7","challengePassword"),h("1.2.840.113549.1.9.8","unstructuredAddress"),h("1.2.840.113549.1.9.14","extensionRequest"),h("1.2.840.113549.1.9.20","friendlyName"),h("1.2.840.113549.1.9.21","localKeyId"),h("1.2.840.113549.1.9.22.1","x509Certificate"),h("1.2.840.113549.1.12.10.1.1","keyBag"),h("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),h("1.2.840.113549.1.12.10.1.3","certBag"),h("1.2.840.113549.1.12.10.1.4","crlBag"),h("1.2.840.113549.1.12.10.1.5","secretBag"),h("1.2.840.113549.1.12.10.1.6","safeContentsBag"),h("1.2.840.113549.1.5.13","pkcs5PBES2"),h("1.2.840.113549.1.5.12","pkcs5PBKDF2"),h("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),h("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),h("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),h("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),h("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),h("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),h("1.2.840.113549.2.7","hmacWithSHA1"),h("1.2.840.113549.2.8","hmacWithSHA224"),h("1.2.840.113549.2.9","hmacWithSHA256"),h("1.2.840.113549.2.10","hmacWithSHA384"),h("1.2.840.113549.2.11","hmacWithSHA512"),h("1.2.840.113549.3.7","des-EDE3-CBC"),h("2.16.840.1.101.3.4.1.2","aes128-CBC"),h("2.16.840.1.101.3.4.1.22","aes192-CBC"),h("2.16.840.1.101.3.4.1.42","aes256-CBC"),h("2.5.4.3","commonName"),h("2.5.4.4","surname"),h("2.5.4.5","serialNumber"),h("2.5.4.6","countryName"),h("2.5.4.7","localityName"),h("2.5.4.8","stateOrProvinceName"),h("2.5.4.9","streetAddress"),h("2.5.4.10","organizationName"),h("2.5.4.11","organizationalUnitName"),h("2.5.4.12","title"),h("2.5.4.13","description"),h("2.5.4.15","businessCategory"),h("2.5.4.17","postalCode"),h("2.5.4.42","givenName"),h("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),h("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),h("2.16.840.1.113730.1.1","nsCertType"),h("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),h("2.5.29.14","subjectKeyIdentifier"),h("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),h("2.5.29.17","subjectAltName"),h("2.5.29.18","issuerAltName"),h("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),h("2.5.29.31","cRLDistributionPoints"),h("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),h("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),h("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),h("1.3.6.1.4.1.11129.2.4.2","timestampList"),h("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),h("1.3.6.1.5.5.7.3.1","serverAuth"),h("1.3.6.1.5.5.7.3.2","clientAuth"),h("1.3.6.1.5.5.7.3.3","codeSigning"),h("1.3.6.1.5.5.7.3.4","emailProtection"),h("1.3.6.1.5.5.7.3.8","timeStamping")},90317:(re,xe,P)=>{var t=P(50276);if(P(39504),P(12746),P(19095),P(8106),P(94037),P(3254),P(2385),P(89356),P(55124),P(15805),P(7619),typeof e>"u")var e=t.jsbn.BigInteger;var h=t.asn1,s=t.pki=t.pki||{};re.exports=s.pbe=t.pbe=t.pbe||{};var C=s.oids,T={name:"EncryptedPrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},d={name:"PBES2Algorithms",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},p={name:"pkcs-12PbeParams",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(m,v,A){A=A||{},A.saltSize=A.saltSize||8,A.count=A.count||2048,A.algorithm=A.algorithm||"aes128",A.prfAlgorithm=A.prfAlgorithm||"sha1";var f=t.random.getBytesSync(A.saltSize),g=A.count,w=h.integerToDer(g),n,u,x;if(A.algorithm.indexOf("aes")===0||A.algorithm==="des"){var B,V,c;switch(A.algorithm){case"aes128":n=16,B=16,V=C["aes128-CBC"],c=t.aes.createEncryptionCipher;break;case"aes192":n=24,B=16,V=C["aes192-CBC"],c=t.aes.createEncryptionCipher;break;case"aes256":n=32,B=16,V=C["aes256-CBC"],c=t.aes.createEncryptionCipher;break;case"des":n=8,B=8,V=C.desCBC,c=t.des.createEncryptionCipher;break;default:var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=A.algorithm,y}var N="hmacWith"+A.prfAlgorithm.toUpperCase(),r=E(N),L=t.pkcs5.pbkdf2(v,f,g,n,r),K=t.random.getBytesSync(B),U=c(L);U.start(K),U.update(h.toDer(m)),U.finish(),x=U.output.getBytes();var H=S(f,w,n,N);u=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(C.pkcs5PBES2).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(C.pkcs5PBKDF2).getBytes()),H]),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(V).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,K)])])])}else if(A.algorithm==="3des"){n=24;var j=new t.util.ByteBuffer(f),L=s.pbe.generatePkcs12Key(v,j,1,g,n),K=s.pbe.generatePkcs12Key(v,j,2,g,n),U=t.des.createEncryptionCipher(L);U.start(K),U.update(h.toDer(m)),U.finish(),x=U.output.getBytes(),u=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(C["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,f),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,w.getBytes())])])}else{var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=A.algorithm,y}var z=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[u,h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,x)]);return z},s.decryptPrivateKeyInfo=function(m,v){var A=null,f={},g=[];if(!h.validate(m,T,f,g)){var w=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw w.errors=g,w}var n=h.derToOid(f.encryptionOid),u=s.pbe.getCipher(n,f.encryptionParams,v),x=t.util.createBuffer(f.encryptedData);return u.update(x),u.finish()&&(A=h.fromDer(u.output)),A},s.encryptedPrivateKeyToPem=function(m,v){var A={type:"ENCRYPTED PRIVATE KEY",body:h.toDer(m).getBytes()};return t.pem.encode(A,{maxline:v})},s.encryptedPrivateKeyFromPem=function(m){var v=t.pem.decode(m)[0];if(v.type!=="ENCRYPTED PRIVATE KEY"){var A=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw A.headerType=v.type,A}if(v.procType&&v.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return h.fromDer(v.body)},s.encryptRsaPrivateKey=function(m,v,A){if(A=A||{},!A.legacy){var f=s.wrapRsaPrivateKey(s.privateKeyToAsn1(m));return f=s.encryptPrivateKeyInfo(f,v,A),s.encryptedPrivateKeyToPem(f)}var g,w,n,u;switch(A.algorithm){case"aes128":g="AES-128-CBC",n=16,w=t.random.getBytesSync(16),u=t.aes.createEncryptionCipher;break;case"aes192":g="AES-192-CBC",n=24,w=t.random.getBytesSync(16),u=t.aes.createEncryptionCipher;break;case"aes256":g="AES-256-CBC",n=32,w=t.random.getBytesSync(16),u=t.aes.createEncryptionCipher;break;case"3des":g="DES-EDE3-CBC",n=24,w=t.random.getBytesSync(8),u=t.des.createEncryptionCipher;break;case"des":g="DES-CBC",n=8,w=t.random.getBytesSync(8),u=t.des.createEncryptionCipher;break;default:var x=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+A.algorithm+'".');throw x.algorithm=A.algorithm,x}var B=t.pbe.opensslDeriveBytes(v,w.substr(0,8),n),V=u(B);V.start(w),V.update(h.toDer(s.privateKeyToAsn1(m))),V.finish();var c={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:g,parameters:t.util.bytesToHex(w).toUpperCase()},body:V.output.getBytes()};return t.pem.encode(c)},s.decryptRsaPrivateKey=function(m,v){var A=null,f=t.pem.decode(m)[0];if(f.type!=="ENCRYPTED PRIVATE KEY"&&f.type!=="PRIVATE KEY"&&f.type!=="RSA PRIVATE KEY"){var g=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw g.headerType=g,g}if(f.procType&&f.procType.type==="ENCRYPTED"){var w,n;switch(f.dekInfo.algorithm){case"DES-CBC":w=8,n=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":w=24,n=t.des.createDecryptionCipher;break;case"AES-128-CBC":w=16,n=t.aes.createDecryptionCipher;break;case"AES-192-CBC":w=24,n=t.aes.createDecryptionCipher;break;case"AES-256-CBC":w=32,n=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":w=5,n=function(c){return t.rc2.createDecryptionCipher(c,40)};break;case"RC2-64-CBC":w=8,n=function(c){return t.rc2.createDecryptionCipher(c,64)};break;case"RC2-128-CBC":w=16,n=function(c){return t.rc2.createDecryptionCipher(c,128)};break;default:var g=new Error('Could not decrypt private key; unsupported encryption algorithm "'+f.dekInfo.algorithm+'".');throw g.algorithm=f.dekInfo.algorithm,g}var u=t.util.hexToBytes(f.dekInfo.parameters),x=t.pbe.opensslDeriveBytes(v,u.substr(0,8),w),B=n(x);if(B.start(u),B.update(t.util.createBuffer(f.body)),B.finish())A=B.output.getBytes();else return A}else A=f.body;return f.type==="ENCRYPTED PRIVATE KEY"?A=s.decryptPrivateKeyInfo(h.fromDer(A),v):A=h.fromDer(A),A!==null&&(A=s.privateKeyFromAsn1(A)),A},s.pbe.generatePkcs12Key=function(m,v,A,f,g,w){var n,u;if(typeof w>"u"||w===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');w=t.md.sha1.create()}var x=w.digestLength,B=w.blockLength,V=new t.util.ByteBuffer,c=new t.util.ByteBuffer;if(m!=null){for(u=0;u<m.length;u++)c.putInt16(m.charCodeAt(u));c.putInt16(0)}var y=c.length(),N=v.length(),r=new t.util.ByteBuffer;r.fillWithByte(A,B);var L=B*Math.ceil(N/B),K=new t.util.ByteBuffer;for(u=0;u<L;u++)K.putByte(v.at(u%N));var U=B*Math.ceil(y/B),H=new t.util.ByteBuffer;for(u=0;u<U;u++)H.putByte(c.at(u%y));var j=K;j.putBuffer(H);for(var z=Math.ceil(g/x),Y=1;Y<=z;Y++){var X=new t.util.ByteBuffer;X.putBytes(r.bytes()),X.putBytes(j.bytes());for(var $=0;$<f;$++)w.start(),w.update(X.getBytes()),X=w.digest();var te=new t.util.ByteBuffer;for(u=0;u<B;u++)te.putByte(X.at(u%x));var ge=Math.ceil(N/B)+Math.ceil(y/B),Ee=new t.util.ByteBuffer;for(n=0;n<ge;n++){var Se=new t.util.ByteBuffer(j.getBytes(B)),ye=511;for(u=te.length()-1;u>=0;u--)ye=ye>>8,ye+=te.at(u)+Se.at(u),Se.setAt(u,ye&255);Ee.putBuffer(Se)}j=Ee,V.putBuffer(X)}return V.truncate(V.length()-g),V},s.pbe.getCipher=function(m,v,A){switch(m){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(m,v,A);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(m,v,A);default:var f=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw f.oid=m,f.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],f}},s.pbe.getCipherForPBES2=function(m,v,A){var f={},g=[];if(!h.validate(v,d,f,g)){var w=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw w.errors=g,w}if(m=h.derToOid(f.kdfOid),m!==s.oids.pkcs5PBKDF2){var w=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw w.oid=m,w.supportedOids=["pkcs5PBKDF2"],w}if(m=h.derToOid(f.encOid),m!==s.oids["aes128-CBC"]&&m!==s.oids["aes192-CBC"]&&m!==s.oids["aes256-CBC"]&&m!==s.oids["des-EDE3-CBC"]&&m!==s.oids.desCBC){var w=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw w.oid=m,w.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],w}var n=f.kdfSalt,u=t.util.createBuffer(f.kdfIterationCount);u=u.getInt(u.length()<<3);var x,B;switch(s.oids[m]){case"aes128-CBC":x=16,B=t.aes.createDecryptionCipher;break;case"aes192-CBC":x=24,B=t.aes.createDecryptionCipher;break;case"aes256-CBC":x=32,B=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":x=24,B=t.des.createDecryptionCipher;break;case"desCBC":x=8,B=t.des.createDecryptionCipher;break}var V=o(f.prfOid),c=t.pkcs5.pbkdf2(A,n,u,x,V),y=f.encIv,N=B(c);return N.start(y),N},s.pbe.getCipherForPKCS12PBE=function(m,v,A){var f={},g=[];if(!h.validate(v,p,f,g)){var w=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw w.errors=g,w}var n=t.util.createBuffer(f.salt),u=t.util.createBuffer(f.iterations);u=u.getInt(u.length()<<3);var x,B,V;switch(m){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:x=24,B=8,V=t.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:x=5,B=8,V=function(L,K){var U=t.rc2.createDecryptionCipher(L,40);return U.start(K,null),U};break;default:var w=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw w.oid=m,w}var c=o(f.prfOid),y=s.pbe.generatePkcs12Key(A,n,1,u,x,c);c.start();var N=s.pbe.generatePkcs12Key(A,n,2,u,B,c);return V(y,N)},s.pbe.opensslDeriveBytes=function(m,v,A,f){if(typeof f>"u"||f===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');f=t.md.md5.create()}v===null&&(v="");for(var g=[a(f,m+v)],w=16,n=1;w<A;++n,w+=16)g.push(a(f,g[n-1]+m+v));return g.join("").substr(0,A)};function a(m,v){return m.start().update(v).digest().getBytes()}function o(m){var v;if(!m)v="hmacWithSHA1";else if(v=s.oids[h.derToOid(m)],!v){var A=new Error("Unsupported PRF OID.");throw A.oid=m,A.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],A}return E(v)}function E(m){var v=t.md;switch(m){case"hmacWithSHA224":v=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":m=m.substr(8).toLowerCase();break;default:var A=new Error("Unsupported PRF algorithm.");throw A.algorithm=m,A.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],A}if(!v||!(m in v))throw new Error("Unknown hash algorithm: "+m);return v[m].create()}function S(m,v,A,f){var g=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,m),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,v.getBytes())]);return f!=="hmacWithSHA1"&&g.value.push(h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,t.util.hexToBytes(A.toString(16))),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(s.oids[f]).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])),g}},3254:(re,xe,P)=>{var t=P(42363).Buffer,e=P(50276);P(71696),P(8106),P(7619);var h=e.pkcs5=e.pkcs5||{},s;e.util.isNodejs&&!e.options.usePureJavaScript&&(s=P(50310)),re.exports=e.pbkdf2=h.pbkdf2=function(C,T,d,p,a,o){if(typeof a=="function"&&(o=a,a=null),e.util.isNodejs&&!e.options.usePureJavaScript&&s.pbkdf2&&(a===null||typeof a!="object")&&(s.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),C=t.from(C,"binary"),T=t.from(T,"binary"),o?s.pbkdf2Sync.length===4?s.pbkdf2(C,T,d,p,function(c,y){if(c)return o(c);o(null,y.toString("binary"))}):s.pbkdf2(C,T,d,p,a,function(c,y){if(c)return o(c);o(null,y.toString("binary"))}):s.pbkdf2Sync.length===4?s.pbkdf2Sync(C,T,d,p).toString("binary"):s.pbkdf2Sync(C,T,d,p,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in e.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=e.md[a].create()}var E=a.digestLength;if(p>4294967295*E){var S=new Error("Derived key is too long.");if(o)return o(S);throw S}var m=Math.ceil(p/E),v=p-(m-1)*E,A=e.hmac.create();A.start(a,C);var f="",g,w,n;if(!o){for(var u=1;u<=m;++u){A.start(null,null),A.update(T),A.update(e.util.int32ToBytes(u)),g=n=A.digest().getBytes();for(var x=2;x<=d;++x)A.start(null,null),A.update(n),w=A.digest().getBytes(),g=e.util.xorBytes(g,w,E),n=w;f+=u<m?g:g.substr(0,v)}return f}var u=1,x;function B(){if(u>m)return o(null,f);A.start(null,null),A.update(T),A.update(e.util.int32ToBytes(u)),g=n=A.digest().getBytes(),x=2,V()}function V(){if(x<=d)return A.start(null,null),A.update(n),w=A.digest().getBytes(),g=e.util.xorBytes(g,w,E),n=w,++x,e.util.setImmediate(V);f+=u<m?g:g.substr(0,v),++u,B()}B()}},2385:(re,xe,P)=>{var t=P(50276);P(7619);var e=re.exports=t.pem=t.pem||{};e.encode=function(C,T){T=T||{};var d="-----BEGIN "+C.type+`-----\r
`,p;if(C.procType&&(p={name:"Proc-Type",values:[String(C.procType.version),C.procType.type]},d+=h(p)),C.contentDomain&&(p={name:"Content-Domain",values:[C.contentDomain]},d+=h(p)),C.dekInfo&&(p={name:"DEK-Info",values:[C.dekInfo.algorithm]},C.dekInfo.parameters&&p.values.push(C.dekInfo.parameters),d+=h(p)),C.headers)for(var a=0;a<C.headers.length;++a)d+=h(C.headers[a]);return C.procType&&(d+=`\r
`),d+=t.util.encode64(C.body,T.maxline||64)+`\r
`,d+="-----END "+C.type+`-----\r
`,d},e.decode=function(C){for(var T=[],d=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,p=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/,o;o=d.exec(C),!!o;){var E=o[1];E==="NEW CERTIFICATE REQUEST"&&(E="CERTIFICATE REQUEST");var S={type:E,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(o[3])};if(T.push(S),!!o[2]){for(var m=o[2].split(a),v=0;o&&v<m.length;){for(var A=m[v].replace(/\s+$/,""),f=v+1;f<m.length;++f){var g=m[f];if(!/\s/.test(g[0]))break;A+=g,v=f}if(o=A.match(p),o){for(var w={name:o[1],values:[]},n=o[2].split(","),u=0;u<n.length;++u)w.values.push(s(n[u]));if(S.procType)if(!S.contentDomain&&w.name==="Content-Domain")S.contentDomain=n[0]||"";else if(!S.dekInfo&&w.name==="DEK-Info"){if(w.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');S.dekInfo={algorithm:n[0],parameters:n[1]||null}}else S.headers.push(w);else{if(w.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(w.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');S.procType={version:n[0],type:n[1]}}}++v}if(S.procType==="ENCRYPTED"&&!S.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(T.length===0)throw new Error("Invalid PEM formatted message.");return T};function h(C){for(var T=C.name+": ",d=[],p=function(m,v){return" "+v},a=0;a<C.values.length;++a)d.push(C.values[a].replace(/^(\S+\r\n)/,p));T+=d.join(",")+`\r
`;for(var o=0,E=-1,a=0;a<T.length;++a,++o)if(o>65&&E!==-1){var S=T[E];S===","?(++E,T=T.substr(0,E)+`\r
 `+T.substr(E)):T=T.substr(0,E)+`\r
`+S+T.substr(E+1),o=a-E-1,E=-1,++a}else(T[a]===" "||T[a]==="	"||T[a]===",")&&(E=a);return T}function s(C){return C.replace(/^\s+/,"")}},47501:(re,xe,P)=>{var t=P(50276);P(7619),P(89356),P(21598);var e=re.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(s,C,T){var d,p,a,o;typeof T=="string"?(d=T,p=arguments[3]||void 0,a=arguments[4]||void 0):T&&(d=T.label||void 0,p=T.seed||void 0,a=T.md||void 0,T.mgf1&&T.mgf1.md&&(o=T.mgf1.md)),a?a.start():a=t.md.sha1.create(),o||(o=a);var E=Math.ceil(s.n.bitLength()/8),S=E-2*a.digestLength-2;if(C.length>S){var m=new Error("RSAES-OAEP input message length is too long.");throw m.length=C.length,m.maxLength=S,m}d||(d=""),a.update(d,"raw");for(var v=a.digest(),A="",f=S-C.length,g=0;g<f;g++)A+="\0";var w=v.getBytes()+A+""+C;if(!p)p=t.random.getBytes(a.digestLength);else if(p.length!==a.digestLength){var m=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw m.seedLength=p.length,m.digestLength=a.digestLength,m}var n=h(p,E-a.digestLength-1,o),u=t.util.xorBytes(w,n,w.length),x=h(u,a.digestLength,o),B=t.util.xorBytes(p,x,p.length);return"\0"+B+u},e.decode_rsa_oaep=function(s,C,T){var d,p,a;typeof T=="string"?(d=T,p=arguments[3]||void 0):T&&(d=T.label||void 0,p=T.md||void 0,T.mgf1&&T.mgf1.md&&(a=T.mgf1.md));var o=Math.ceil(s.n.bitLength()/8);if(C.length!==o){var u=new Error("RSAES-OAEP encoded message length is invalid.");throw u.length=C.length,u.expectedLength=o,u}if(p===void 0?p=t.md.sha1.create():p.start(),a||(a=p),o<2*p.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");d||(d=""),p.update(d,"raw");for(var E=p.digest().getBytes(),S=C.charAt(0),m=C.substring(1,p.digestLength+1),v=C.substring(1+p.digestLength),A=h(v,p.digestLength,a),f=t.util.xorBytes(m,A,m.length),g=h(f,o-p.digestLength-1,a),w=t.util.xorBytes(v,g,v.length),n=w.substring(0,p.digestLength),u=S!=="\0",x=0;x<p.digestLength;++x)u|=E.charAt(x)!==n.charAt(x);for(var B=1,V=p.digestLength,c=p.digestLength;c<w.length;c++){var y=w.charCodeAt(c),N=y&1^1,r=B?65534:0;u|=y&r,B=B&N,V+=B}if(u||w.charCodeAt(V)!==1)throw new Error("Invalid RSAES-OAEP padding.");return w.substring(V+1)};function h(s,C,T){T||(T=t.md.sha1.create());for(var d="",p=Math.ceil(C/T.digestLength),a=0;a<p;++a){var o=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);T.start(),T.update(s+o),d+=T.digest().getBytes()}return d.substring(0,C)}},55071:(re,xe,P)=>{var t=P(50276);P(12746),P(71696),P(94037),P(39954),P(90317),P(89356),P(15805),P(21598),P(7619),P(66011);var e=t.asn1,h=t.pki,s=re.exports=t.pkcs12=t.pkcs12||{},C={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},T={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},C,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},d={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},p={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},a={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function o(f,g,w,n){for(var u=[],x=0;x<f.length;x++)for(var B=0;B<f[x].safeBags.length;B++){var V=f[x].safeBags[B];if(!(n!==void 0&&V.type!==n)){if(g===null){u.push(V);continue}V.attributes[g]!==void 0&&V.attributes[g].indexOf(w)>=0&&u.push(V)}}return u}s.pkcs12FromAsn1=function(f,g,w){typeof g=="string"?(w=g,g=!0):g===void 0&&(g=!0);var n={},u=[];if(!e.validate(f,T,n,u)){var x=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw x.errors=x,x}var B={version:n.version.charCodeAt(0),safeContents:[],getBags:function(j){var z={},Y;return"localKeyId"in j?Y=j.localKeyId:"localKeyIdHex"in j&&(Y=t.util.hexToBytes(j.localKeyIdHex)),Y===void 0&&!("friendlyName"in j)&&"bagType"in j&&(z[j.bagType]=o(B.safeContents,null,null,j.bagType)),Y!==void 0&&(z.localKeyId=o(B.safeContents,"localKeyId",Y,j.bagType)),"friendlyName"in j&&(z.friendlyName=o(B.safeContents,"friendlyName",j.friendlyName,j.bagType)),z},getBagsByFriendlyName:function(j,z){return o(B.safeContents,"friendlyName",j,z)},getBagsByLocalKeyId:function(j,z){return o(B.safeContents,"localKeyId",j,z)}};if(n.version.charCodeAt(0)!==3){var x=new Error("PKCS#12 PFX of version other than 3 not supported.");throw x.version=n.version.charCodeAt(0),x}if(e.derToOid(n.contentType)!==h.oids.data){var x=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw x.oid=e.derToOid(n.contentType),x}var V=n.content.value[0];if(V.tagClass!==e.Class.UNIVERSAL||V.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(V=E(V),n.mac){var c=null,y=0,N=e.derToOid(n.macAlgorithm);switch(N){case h.oids.sha1:c=t.md.sha1.create(),y=20;break;case h.oids.sha256:c=t.md.sha256.create(),y=32;break;case h.oids.sha384:c=t.md.sha384.create(),y=48;break;case h.oids.sha512:c=t.md.sha512.create(),y=64;break;case h.oids.md5:c=t.md.md5.create(),y=16;break}if(c===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+N);var r=new t.util.ByteBuffer(n.macSalt),L="macIterations"in n?parseInt(t.util.bytesToHex(n.macIterations),16):1,K=s.generateKey(w,r,3,L,y,c),U=t.hmac.create();U.start(c,K),U.update(V.value);var H=U.getMac();if(H.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return S(B,V.value,g,w),B};function E(f){if(f.composed||f.constructed){for(var g=t.util.createBuffer(),w=0;w<f.value.length;++w)g.putBytes(f.value[w].value);f.composed=f.constructed=!1,f.value=g.getBytes()}return f}function S(f,g,w,n){if(g=e.fromDer(g,w),g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.SEQUENCE||g.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var u=0;u<g.value.length;u++){var x=g.value[u],B={},V=[];if(!e.validate(x,C,B,V)){var c=new Error("Cannot read ContentInfo.");throw c.errors=V,c}var y={encrypted:!1},N=null,r=B.content.value[0];switch(e.derToOid(B.contentType)){case h.oids.data:if(r.tagClass!==e.Class.UNIVERSAL||r.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");N=E(r).value;break;case h.oids.encryptedData:N=m(r,n),y.encrypted=!0;break;default:var c=new Error("Unsupported PKCS#12 contentType.");throw c.contentType=e.derToOid(B.contentType),c}y.safeBags=v(N,w,n),f.safeContents.push(y)}}function m(f,g){var w={},n=[];if(!e.validate(f,t.pkcs7.asn1.encryptedDataValidator,w,n)){var u=new Error("Cannot read EncryptedContentInfo.");throw u.errors=n,u}var x=e.derToOid(w.contentType);if(x!==h.oids.data){var u=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw u.oid=x,u}x=e.derToOid(w.encAlgorithm);var B=h.pbe.getCipher(x,w.encParameter,g),V=E(w.encryptedContentAsn1),c=t.util.createBuffer(V.value);if(B.update(c),!B.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return B.output.getBytes()}function v(f,g,w){if(!g&&f.length===0)return[];if(f=e.fromDer(f,g),f.tagClass!==e.Class.UNIVERSAL||f.type!==e.Type.SEQUENCE||f.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],u=0;u<f.value.length;u++){var x=f.value[u],B={},V=[];if(!e.validate(x,d,B,V)){var c=new Error("Cannot read SafeBag.");throw c.errors=V,c}var y={type:e.derToOid(B.bagId),attributes:A(B.bagAttributes)};n.push(y);var N,r,L=B.bagValue.value[0];switch(y.type){case h.oids.pkcs8ShroudedKeyBag:if(L=h.decryptPrivateKeyInfo(L,w),L===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case h.oids.keyBag:try{y.key=h.privateKeyFromAsn1(L)}catch{y.key=null,y.asn1=L}continue;case h.oids.certBag:N=a,r=function(){if(e.derToOid(B.certId)!==h.oids.x509Certificate){var U=new Error("Unsupported certificate type, only X.509 supported.");throw U.oid=e.derToOid(B.certId),U}var H=e.fromDer(B.cert,g);try{y.cert=h.certificateFromAsn1(H,!0)}catch{y.cert=null,y.asn1=H}};break;default:var c=new Error("Unsupported PKCS#12 SafeBag type.");throw c.oid=y.type,c}if(N!==void 0&&!e.validate(L,N,B,V)){var c=new Error("Cannot read PKCS#12 "+N.name);throw c.errors=V,c}r()}return n}function A(f){var g={};if(f!==void 0)for(var w=0;w<f.length;++w){var n={},u=[];if(!e.validate(f[w],p,n,u)){var x=new Error("Cannot read PKCS#12 BagAttribute.");throw x.errors=u,x}var B=e.derToOid(n.oid);if(h.oids[B]!==void 0){g[h.oids[B]]=[];for(var V=0;V<n.values.length;++V)g[h.oids[B]].push(n.values[V].value)}}return g}s.toPkcs12Asn1=function(f,g,w,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var u=n.localKeyId,x;if(u!==null)u=t.util.hexToBytes(u);else if(n.generateLocalKeyId)if(g){var B=t.util.isArray(g)?g[0]:g;typeof B=="string"&&(B=h.certificateFromPem(B));var V=t.md.sha1.create();V.update(e.toDer(h.certificateToAsn1(B)).getBytes()),u=V.digest().getBytes()}else u=t.random.getBytes(20);var c=[];u!==null&&c.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u)])])),"friendlyName"in n&&c.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,n.friendlyName)])])),c.length>0&&(x=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c));var y=[],N=[];g!==null&&(t.util.isArray(g)?N=g:N=[g]);for(var r=[],L=0;L<N.length;++L){g=N[L],typeof g=="string"&&(g=h.certificateFromPem(g));var K=L===0?x:void 0,U=h.certificateToAsn1(g),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(U).getBytes())])])]),K]);r.push(H)}if(r.length>0){var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r),z=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(j).getBytes())])]);y.push(z)}var Y=null;if(f!==null){var X=h.wrapRsaPrivateKey(h.privateKeyToAsn1(f));w===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[X]),x]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[h.encryptPrivateKeyInfo(X,w,n)]),x]);var $=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer($).getBytes())])]);y.push(te)}var ge=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,y),Ee;if(n.useMac){var V=t.md.sha1.create(),Se=new t.util.ByteBuffer(t.random.getBytes(n.saltSize)),ye=n.count,f=s.generateKey(w,Se,3,ye,20),ie=t.hmac.create();ie.start(V,f),ie.update(e.toDer(ge).getBytes());var ae=ie.getMac();Ee=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ae.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Se.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(ye).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(ge).getBytes())])]),Ee])},s.generateKey=t.pbe.generatePkcs12Key},59343:(re,xe,P)=>{var t=P(50276);P(39504),P(12746),P(19095),P(94037),P(2385),P(39954),P(89356),P(7619),P(66011);var e=t.asn1,h=re.exports=t.pkcs7=t.pkcs7||{};h.messageFromPem=function(f){var g=t.pem.decode(f)[0];if(g.type!=="PKCS7"){var w=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw w.headerType=g.type,w}if(g.procType&&g.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=e.fromDer(g.body);return h.messageFromAsn1(n)},h.messageToPem=function(f,g){var w={type:"PKCS7",body:e.toDer(f.toAsn1()).getBytes()};return t.pem.encode(w,{maxline:g})},h.messageFromAsn1=function(f){var g={},w=[];if(!e.validate(f,h.asn1.contentInfoValidator,g,w)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=w,n}var u=e.derToOid(g.contentType),x;switch(u){case t.pki.oids.envelopedData:x=h.createEnvelopedData();break;case t.pki.oids.encryptedData:x=h.createEncryptedData();break;case t.pki.oids.signedData:x=h.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+u+" is not (yet) supported.")}return x.fromAsn1(g.content.value[0]),x},h.createSignedData=function(){var f=null;return f={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(v(f,n,h.asn1.signedDataValidator),f.certificates=[],f.crls=[],f.digestAlgorithmIdentifiers=[],f.contentInfo=null,f.signerInfos=[],f.rawCapture.certificates)for(var u=f.rawCapture.certificates.value,x=0;x<u.length;++x)f.certificates.push(t.pki.certificateFromAsn1(u[x]))},toAsn1:function(){f.contentInfo||f.sign();for(var n=[],u=0;u<f.certificates.length;++u)n.push(t.pki.certificateToAsn1(f.certificates[u]));var x=[],B=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(f.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,f.digestAlgorithmIdentifiers),f.contentInfo])]);return n.length>0&&B.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,n)),x.length>0&&B.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,x)),B.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,f.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.type).getBytes()),B])},addSigner:function(n){var u=n.issuer,x=n.serialNumber;if(n.certificate){var B=n.certificate;typeof B=="string"&&(B=t.pki.certificateFromPem(B)),u=B.issuer.attributes,x=B.serialNumber}var V=n.key;if(!V)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof V=="string"&&(V=t.pki.privateKeyFromPem(V));var c=n.digestAlgorithm||t.pki.oids.sha1;switch(c){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var y=n.authenticatedAttributes||[];if(y.length>0){for(var N=!1,r=!1,L=0;L<y.length;++L){var K=y[L];if(!N&&K.type===t.pki.oids.contentType){if(N=!0,r)break;continue}if(!r&&K.type===t.pki.oids.messageDigest){if(r=!0,N)break;continue}}if(!N||!r)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}f.signers.push({key:V,version:1,issuer:u,serialNumber:x,digestAlgorithm:c,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:y,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof f.content!="object"||f.contentInfo===null)&&(f.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in f)){var u;f.content instanceof t.util.ByteBuffer?u=f.content.bytes():typeof f.content=="string"&&(u=t.util.encodeUtf8(f.content)),n.detached?f.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u):f.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u)]))}if(f.signers.length!==0){var x=g();w(x)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=t.pki.certificateFromPem(n)),f.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},f;function g(){for(var n={},u=0;u<f.signers.length;++u){var x=f.signers[u],B=x.digestAlgorithm;B in n||(n[B]=t.md[t.pki.oids[B]].create()),x.authenticatedAttributes.length===0?x.md=n[B]:x.md=t.md[t.pki.oids[B]].create()}f.digestAlgorithmIdentifiers=[];for(var B in n)f.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(B).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return n}function w(n){var u;if(f.detachedContent?u=f.detachedContent:(u=f.contentInfo.value[1],u=u.value[0]),!u)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var x=e.derToOid(f.contentInfo.value[0].value),B=e.toDer(u);B.getByte(),e.getBerValueLength(B),B=B.getBytes();for(var V in n)n[V].start().update(B);for(var c=new Date,y=0;y<f.signers.length;++y){var N=f.signers[y];if(N.authenticatedAttributes.length===0){if(x!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{N.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),L=0;L<N.authenticatedAttributes.length;++L){var K=N.authenticatedAttributes[L];K.type===t.pki.oids.messageDigest?K.value=n[N.digestAlgorithm].digest():K.type===t.pki.oids.signingTime&&(K.value||(K.value=c)),r.value.push(S(K)),N.authenticatedAttributesAsn1.value.push(S(K))}B=e.toDer(r).getBytes(),N.md.start().update(B)}N.signature=N.key.sign(N.md,"RSASSA-PKCS1-V1_5")}f.signerInfos=E(f.signers)}},h.createEncryptedData=function(){var f=null;return f={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(g){v(f,g,h.asn1.encryptedDataValidator)},decrypt:function(g){g!==void 0&&(f.encryptedContent.key=g),A(f)}},f},h.createEnvelopedData=function(){var f=null;return f={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(g){var w=v(f,g,h.asn1.envelopedDataValidator);f.recipients=T(w.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(f.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d(f.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,m(f.encryptedContent))])])])},findRecipient:function(g){for(var w=g.issuer.attributes,n=0;n<f.recipients.length;++n){var u=f.recipients[n],x=u.issuer;if(u.serialNumber===g.serialNumber&&x.length===w.length){for(var B=!0,V=0;V<w.length;++V)if(x[V].type!==w[V].type||x[V].value!==w[V].value){B=!1;break}if(B)return u}}return null},decrypt:function(g,w){if(f.encryptedContent.key===void 0&&g!==void 0&&w!==void 0)switch(g.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var n=w.decrypt(g.encryptedContent.content);f.encryptedContent.key=t.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+g.encryptedContent.algorithm)}A(f)},addRecipient:function(g){f.recipients.push({version:0,issuer:g.issuer.attributes,serialNumber:g.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:g.publicKey}})},encrypt:function(g,w){if(f.encryptedContent.content===void 0){w=w||f.encryptedContent.algorithm,g=g||f.encryptedContent.key;var n,u,x;switch(w){case t.pki.oids["aes128-CBC"]:n=16,u=16,x=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:n=24,u=16,x=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:n=32,u=16,x=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:n=24,u=8,x=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+w)}if(g===void 0)g=t.util.createBuffer(t.random.getBytes(n));else if(g.length()!=n)throw new Error("Symmetric key has wrong length; got "+g.length()+" bytes, expected "+n+".");f.encryptedContent.algorithm=w,f.encryptedContent.key=g,f.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(u));var B=x(g);if(B.start(f.encryptedContent.parameter.copy()),B.update(f.content),!B.finish())throw new Error("Symmetric encryption failed.");f.encryptedContent.content=B.output}for(var V=0;V<f.recipients.length;++V){var c=f.recipients[V];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(f.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},f};function s(f){var g={},w=[];if(!e.validate(f,h.asn1.recipientInfoValidator,g,w)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=w,n}return{version:g.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(g.issuer),serialNumber:t.util.createBuffer(g.serial).toHex(),encryptedContent:{algorithm:e.derToOid(g.encAlgorithm),parameter:g.encParameter?g.encParameter.value:void 0,content:g.encKey}}}function C(f){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(f.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:f.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(f.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f.encryptedContent.content)])}function T(f){for(var g=[],w=0;w<f.length;++w)g.push(s(f[w]));return g}function d(f){for(var g=[],w=0;w<f.length;++w)g.push(C(f[w]));return g}function p(f){var g={},w=[];if(!e.validate(f,h.asn1.signerInfoValidator,g,w)){var n=new Error("Cannot read PKCS#7 SignerInfo. ASN.1 object is not an PKCS#7 SignerInfo.");throw n.errors=w,n}var u={version:g.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(g.issuer),serialNumber:t.util.createBuffer(g.serial).toHex(),digestAlgorithm:e.derToOid(g.digestAlgorithm),signatureAlgorithm:e.derToOid(g.signatureAlgorithm),signature:g.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]},x=g.authenticatedAttributes||[],B=g.unauthenticatedAttributes||[];return u}function a(f){var g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(f.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:f.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(f.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(f.authenticatedAttributesAsn1&&g.value.push(f.authenticatedAttributesAsn1),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),g.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f.signature)),f.unauthenticatedAttributes.length>0){for(var w=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<f.unauthenticatedAttributes.length;++n){var u=f.unauthenticatedAttributes[n];w.values.push(S(u))}g.value.push(w)}return g}function o(f){for(var g=[],w=0;w<f.length;++w)g.push(p(f[w]));return g}function E(f){for(var g=[],w=0;w<f.length;++w)g.push(a(f[w]));return g}function S(f){var g;if(f.type===t.pki.oids.contentType)g=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.value).getBytes());else if(f.type===t.pki.oids.messageDigest)g=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f.value.bytes());else if(f.type===t.pki.oids.signingTime){var w=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),u=f.value;if(typeof u=="string"){var x=Date.parse(u);isNaN(x)?u.length===13?u=e.utcTimeToDate(u):u=e.generalizedTimeToDate(u):u=new Date(x)}u>=w&&u<n?g=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(u)):g=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(u))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[g])])}function m(f){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.algorithm).getBytes()),f.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f.content.getBytes())])]}function v(f,g,w){var n={},u=[];if(!e.validate(g,w,n,u)){var x=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw x.errors=x,x}var B=e.derToOid(n.contentType);if(B!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var V="";if(t.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");V+=n.encryptedContent[c].value}else V=n.encryptedContent;f.encryptedContent={algorithm:e.derToOid(n.encAlgorithm),parameter:t.util.createBuffer(n.encParameter.value),content:t.util.createBuffer(V)}}if(n.content){var V="";if(t.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");V+=n.content[c].value}else V=n.content;f.content=t.util.createBuffer(V)}return f.version=n.version.charCodeAt(0),f.rawCapture=n,n}function A(f){if(f.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(f.content===void 0){var g;switch(f.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:g=t.aes.createDecryptionCipher(f.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:g=t.des.createDecryptionCipher(f.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+f.encryptedContent.algorithm)}if(g.start(f.encryptedContent.parameter),g.update(f.encryptedContent.content),!g.finish())throw new Error("Symmetric decryption failed.");f.content=g.output}}},39954:(re,xe,P)=>{var t=P(50276);P(12746),P(7619);var e=t.asn1,h=re.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=h;var s={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};h.contentInfoValidator=s;var C={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};h.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(C)},h.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(C)};var T={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};h.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[T]}]},h.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},29255:(re,xe,P)=>{var t=P(50276);P(12746),P(94037),P(90317),P(2385),P(3254),P(55071),P(51417),P(15805),P(7619),P(66011);var e=t.asn1,h=re.exports=t.pki=t.pki||{};h.pemToDer=function(s){var C=t.pem.decode(s)[0];if(C.procType&&C.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(C.body)},h.privateKeyFromPem=function(s){var C=t.pem.decode(s)[0];if(C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var T=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw T.headerType=C.type,T}if(C.procType&&C.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var d=e.fromDer(C.body);return h.privateKeyFromAsn1(d)},h.privateKeyToPem=function(s,C){var T={type:"RSA PRIVATE KEY",body:e.toDer(h.privateKeyToAsn1(s)).getBytes()};return t.pem.encode(T,{maxline:C})},h.privateKeyInfoToPem=function(s,C){var T={type:"PRIVATE KEY",body:e.toDer(s).getBytes()};return t.pem.encode(T,{maxline:C})}},10268:(re,xe,P)=>{var t=P(50276);P(7619),P(43736),P(89356),function(){if(t.prime){re.exports=t.prime;return}var e=re.exports=t.prime=t.prime||{},h=t.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],C=new h(null);C.fromInt(30);var T=function(m,v){return m|v};e.generateProbablePrime=function(m,v,A){typeof v=="function"&&(A=v,v={}),v=v||{};var f=v.algorithm||"PRIMEINC";typeof f=="string"&&(f={name:f}),f.options=f.options||{};var g=v.prng||t.random,w={nextBytes:function(n){for(var u=g.getBytesSync(n.length),x=0;x<n.length;++x)n[x]=u.charCodeAt(x)}};if(f.name==="PRIMEINC")return d(m,w,f.options,A);throw new Error("Invalid prime generation algorithm: "+f.name)};function d(m,v,A,f){return"workers"in A?o(m,v,A,f):p(m,v,A,f)}function p(m,v,A,f){var g=E(m,v),w=0,n=S(g.bitLength());"millerRabinTests"in A&&(n=A.millerRabinTests);var u=10;"maxBlockTime"in A&&(u=A.maxBlockTime),a(g,m,v,w,n,u,f)}function a(m,v,A,f,g,w,n){var u=+new Date;do{if(m.bitLength()>v&&(m=E(v,A)),m.isProbablePrime(g))return n(null,m);m.dAddOffset(s[f++%8],0)}while(w<0||+new Date-u<w);t.util.setImmediate(function(){a(m,v,A,f,g,w,n)})}function o(m,v,A,f){if(typeof Worker>"u")return p(m,v,A,f);var g=E(m,v),w=A.workers,n=A.workLoad||100,u=n*30/8,x=A.workerScript||"forge/prime.worker.js";if(w===-1)return t.util.estimateCores(function(V,c){V&&(c=2),w=c-1,B()});B();function B(){w=Math.max(1,w);for(var V=[],c=0;c<w;++c)V[c]=new Worker(x);for(var y=w,c=0;c<w;++c)V[c].addEventListener("message",r);var N=!1;function r(L){if(!N){--y;var K=L.data;if(K.found){for(var U=0;U<V.length;++U)V[U].terminate();return N=!0,f(null,new h(K.prime,16))}g.bitLength()>m&&(g=E(m,v));var H=g.toString(16);L.target.postMessage({hex:H,workLoad:n}),g.dAddOffset(u,0)}}}}function E(m,v){var A=new h(m,v),f=m-1;return A.testBit(f)||A.bitwiseTo(h.ONE.shiftLeft(f),T,A),A.dAddOffset(31-A.mod(C).byteValue(),0),A}function S(m){return m<=100?27:m<=150?18:m<=200?15:m<=250?12:m<=300?9:m<=350?8:m<=400?7:m<=500?6:m<=600?5:m<=800?4:m<=1250?3:2}}()},73878:(re,xe,P)=>{var t=P(50276);P(7619);var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=P(50310));var h=re.exports=t.prng=t.prng||{};h.create=function(s){for(var C={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},T=s.md,d=new Array(32),p=0;p<32;++p)d[p]=T.create();C.pools=d,C.pool=0,C.generate=function(m,v){if(!v)return C.generateSync(m);var A=C.plugin.cipher,f=C.plugin.increment,g=C.plugin.formatKey,w=C.plugin.formatSeed,n=t.util.createBuffer();C.key=null,u();function u(x){if(x)return v(x);if(n.length()>=m)return v(null,n.getBytes(m));if(C.generated>1048575&&(C.key=null),C.key===null)return t.util.nextTick(function(){a(u)});var B=A(C.key,C.seed);C.generated+=B.length,n.putBytes(B),C.key=g(A(C.key,f(C.seed))),C.seed=w(A(C.key,C.seed)),t.util.setImmediate(u)}},C.generateSync=function(m){var v=C.plugin.cipher,A=C.plugin.increment,f=C.plugin.formatKey,g=C.plugin.formatSeed;C.key=null;for(var w=t.util.createBuffer();w.length()<m;){C.generated>1048575&&(C.key=null),C.key===null&&o();var n=v(C.key,C.seed);C.generated+=n.length,w.putBytes(n),C.key=f(v(C.key,A(C.seed))),C.seed=g(v(C.key,C.seed))}return w.getBytes(m)};function a(m){if(C.pools[0].messageLength>=32)return E(),m();var v=32-C.pools[0].messageLength<<5;C.seedFile(v,function(A,f){if(A)return m(A);C.collect(f),E(),m()})}function o(){if(C.pools[0].messageLength>=32)return E();var m=32-C.pools[0].messageLength<<5;C.collect(C.seedFileSync(m)),E()}function E(){C.reseeds=C.reseeds===4294967295?0:C.reseeds+1;var m=C.plugin.md.create();m.update(C.keyBytes);for(var v=1,A=0;A<32;++A)C.reseeds%v===0&&(m.update(C.pools[A].digest().getBytes()),C.pools[A].start()),v=v<<1;C.keyBytes=m.digest().getBytes(),m.start(),m.update(C.keyBytes);var f=m.digest().getBytes();C.key=C.plugin.formatKey(C.keyBytes),C.seed=C.plugin.formatSeed(f),C.generated=0}function S(m){var v=null,A=t.util.globalScope,f=A.crypto||A.msCrypto;f&&f.getRandomValues&&(v=function(y){return f.getRandomValues(y)});var g=t.util.createBuffer();if(v)for(;g.length()<m;){var w=Math.max(1,Math.min(m-g.length(),65536)/4),n=new Uint32Array(Math.floor(w));try{v(n);for(var u=0;u<n.length;++u)g.putInt32(n[u])}catch(y){if(!(typeof QuotaExceededError<"u"&&y instanceof QuotaExceededError))throw y}}if(g.length()<m)for(var x,B,V,c=Math.floor(Math.random()*65536);g.length()<m;){B=16807*(c&65535),x=16807*(c>>16),B+=(x&32767)<<16,B+=x>>15,B=(B&2147483647)+(B>>31),c=B&4294967295;for(var u=0;u<3;++u)V=c>>>(u<<3),V^=Math.floor(Math.random()*256),g.putByte(V&255)}return g.getBytes(m)}return e?(C.seedFile=function(m,v){e.randomBytes(m,function(A,f){if(A)return v(A);v(null,f.toString())})},C.seedFileSync=function(m){return e.randomBytes(m).toString()}):(C.seedFile=function(m,v){try{v(null,S(m))}catch(A){v(A)}},C.seedFileSync=S),C.collect=function(m){for(var v=m.length,A=0;A<v;++A)C.pools[C.pool].update(m.substr(A,1)),C.pool=C.pool===31?0:C.pool+1},C.collectInt=function(m,v){for(var A="",f=0;f<v;f+=8)A+=String.fromCharCode(m>>f&255);C.collect(A)},C.registerWorker=function(m){if(m===self)C.seedFile=function(A,f){function g(w){var n=w.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",g),f(n.forge.prng.err,n.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:A}}})};else{var v=function(A){var f=A.data;f.forge&&f.forge.prng&&C.seedFile(f.forge.prng.needed,function(g,w){m.postMessage({forge:{prng:{err:g,bytes:w}}})})};m.addEventListener("message",v)}},C}},51417:(re,xe,P)=>{var t=P(50276);P(89356),P(7619);var e=re.exports=t.pss=t.pss||{};e.create=function(h){arguments.length===3&&(h={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var s=h.md,C=h.mgf,T=s.digestLength,d=h.salt||null;typeof d=="string"&&(d=t.util.createBuffer(d));var p;if("saltLength"in h)p=h.saltLength;else if(d!==null)p=d.length();else throw new Error("Salt length not specified or specific salt not given.");if(d!==null&&d.length()!==p)throw new Error("Given salt length does not match length of given salt.");var a=h.prng||t.random,o={};return o.encode=function(E,S){var m,v=S-1,A=Math.ceil(v/8),f=E.digest().getBytes();if(A<T+p+2)throw new Error("Message is too long to encrypt.");var g;d===null?g=a.getBytesSync(p):g=d.bytes();var w=new t.util.ByteBuffer;w.fillWithByte(0,8),w.putBytes(f),w.putBytes(g),s.start(),s.update(w.getBytes());var n=s.digest().getBytes(),u=new t.util.ByteBuffer;u.fillWithByte(0,A-p-T-2),u.putByte(1),u.putBytes(g);var x=u.getBytes(),B=A-T-1,V=C.generate(n,B),c="";for(m=0;m<B;m++)c+=String.fromCharCode(x.charCodeAt(m)^V.charCodeAt(m));var y=65280>>8*A-v&255;return c=String.fromCharCode(c.charCodeAt(0)&~y)+c.substr(1),c+n+"\xBC"},o.verify=function(E,S,m){var v,A=m-1,f=Math.ceil(A/8);if(S=S.substr(-f),f<T+p+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(S.charCodeAt(f-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=f-T-1,w=S.substr(0,g),n=S.substr(g,T),u=65280>>8*f-A&255;if((w.charCodeAt(0)&u)!==0)throw new Error("Bits beyond keysize not zero as expected.");var x=C.generate(n,g),B="";for(v=0;v<g;v++)B+=String.fromCharCode(w.charCodeAt(v)^x.charCodeAt(v));B=String.fromCharCode(B.charCodeAt(0)&~u)+B.substr(1);var V=f-T-p-2;for(v=0;v<V;v++)if(B.charCodeAt(v)!==0)throw new Error("Leftmost octets not zero as expected");if(B.charCodeAt(V)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var c=B.substr(-p),y=new t.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(E),y.putBytes(c),s.start(),s.update(y.getBytes());var N=s.digest().getBytes();return n===N},o}},89356:(re,xe,P)=>{var t=P(50276);P(39504),P(30172),P(73878),P(7619),function(){if(t.random&&t.random.getBytes){re.exports=t.random;return}(function(e){var h={},s=new Array(4),C=t.util.createBuffer();h.formatKey=function(m){var v=t.util.createBuffer(m);return m=new Array(4),m[0]=v.getInt32(),m[1]=v.getInt32(),m[2]=v.getInt32(),m[3]=v.getInt32(),t.aes._expandKey(m,!1)},h.formatSeed=function(m){var v=t.util.createBuffer(m);return m=new Array(4),m[0]=v.getInt32(),m[1]=v.getInt32(),m[2]=v.getInt32(),m[3]=v.getInt32(),m},h.cipher=function(m,v){return t.aes._updateBlock(m,v,s,!1),C.putInt32(s[0]),C.putInt32(s[1]),C.putInt32(s[2]),C.putInt32(s[3]),C.getBytes()},h.increment=function(m){return++m[3],m},h.md=t.md.sha256;function T(){var m=t.prng.create(h);return m.getBytes=function(v,A){return m.generate(v,A)},m.getBytesSync=function(v){return m.generate(v)},m}var d=T(),p=null,a=t.util.globalScope,o=a.crypto||a.msCrypto;if(o&&o.getRandomValues&&(p=function(m){return o.getRandomValues(m)}),t.options.usePureJavaScript||!t.util.isNodejs&&!p){if(typeof window>"u"||window.document,d.collectInt(+new Date,32),typeof navigator<"u"){var E="";for(var S in navigator)try{typeof navigator[S]=="string"&&(E+=navigator[S])}catch{}d.collect(E),E=null}e&&(e().mousemove(function(m){d.collectInt(m.clientX,16),d.collectInt(m.clientY,16)}),e().keypress(function(m){d.collectInt(m.charCode,8)}))}if(!t.random)t.random=d;else for(var S in d)t.random[S]=d[S];t.random.createInstance=T,re.exports=t.random})(typeof jQuery<"u"?jQuery:null)}()},55124:(re,xe,P)=>{var t=P(50276);P(7619);var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],h=[1,2,3,5],s=function(d,p){return d<<p&65535|(d&65535)>>16-p},C=function(d,p){return(d&65535)>>p|d<<16-p&65535};re.exports=t.rc2=t.rc2||{},t.rc2.expandKey=function(d,p){typeof d=="string"&&(d=t.util.createBuffer(d)),p=p||128;var a=d,o=d.length(),E=p,S=Math.ceil(E/8),m=255>>(E&7),v;for(v=o;v<128;v++)a.putByte(e[a.at(v-1)+a.at(v-o)&255]);for(a.setAt(128-S,e[a.at(128-S)&m]),v=127-S;v>=0;v--)a.setAt(v,e[a.at(v+1)^a.at(v+S)]);return a};var T=function(d,p,a){var o=!1,E=null,S=null,m=null,v,A,f,g,w=[];for(d=t.rc2.expandKey(d,p),f=0;f<64;f++)w.push(d.getInt16Le());a?(v=function(x){for(f=0;f<4;f++)x[f]+=w[g]+(x[(f+3)%4]&x[(f+2)%4])+(~x[(f+3)%4]&x[(f+1)%4]),x[f]=s(x[f],h[f]),g++},A=function(x){for(f=0;f<4;f++)x[f]+=w[x[(f+3)%4]&63]}):(v=function(x){for(f=3;f>=0;f--)x[f]=C(x[f],h[f]),x[f]-=w[g]+(x[(f+3)%4]&x[(f+2)%4])+(~x[(f+3)%4]&x[(f+1)%4]),g--},A=function(x){for(f=3;f>=0;f--)x[f]-=w[x[(f+3)%4]&63]});var n=function(x){var B=[];for(f=0;f<4;f++){var V=E.getInt16Le();m!==null&&(a?V^=m.getInt16Le():m.putInt16Le(V)),B.push(V&65535)}g=a?0:63;for(var c=0;c<x.length;c++)for(var y=0;y<x[c][0];y++)x[c][1](B);for(f=0;f<4;f++)m!==null&&(a?m.putInt16Le(B[f]):B[f]^=m.getInt16Le()),S.putInt16Le(B[f])},u=null;return u={start:function(x,B){x&&typeof x=="string"&&(x=t.util.createBuffer(x)),o=!1,E=t.util.createBuffer(),S=B||new t.util.createBuffer,m=x,u.output=S},update:function(x){for(o||E.putBuffer(x);E.length()>=8;)n([[5,v],[1,A],[6,v],[1,A],[5,v]])},finish:function(x){var B=!0;if(a)if(x)B=x(8,E,!a);else{var V=E.length()===8?8:8-E.length();E.fillWithByte(V,V)}if(B&&(o=!0,u.update()),!a&&(B=E.length()===0,B))if(x)B=x(8,S,!a);else{var c=S.length(),y=S.at(c-1);y>c?B=!1:S.truncate(y)}return B}},u};t.rc2.startEncrypting=function(d,p,a){var o=t.rc2.createEncryptionCipher(d,128);return o.start(p,a),o},t.rc2.createEncryptionCipher=function(d,p){return T(d,p,!0)},t.rc2.startDecrypting=function(d,p,a){var o=t.rc2.createDecryptionCipher(d,128);return o.start(p,a),o},t.rc2.createDecryptionCipher=function(d,p){return T(d,p,!1)}},15805:(re,xe,P)=>{var t=P(50276);if(P(12746),P(43736),P(94037),P(47501),P(10268),P(89356),P(7619),typeof e>"u")var e=t.jsbn.BigInteger;var h=t.util.isNodejs?P(50310):null,s=t.asn1,C=t.util;t.pki=t.pki||{},re.exports=t.pki.rsa=t.rsa=t.rsa||{};var T=t.pki,d=[6,4,2,4,2,4,6,2],p={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},a={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},o={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},E=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},S={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},m=function(r){var L;if(r.algorithm in T.oids)L=T.oids[r.algorithm];else{var K=new Error("Unknown message digest algorithm.");throw K.algorithm=r.algorithm,K}var U=s.oidToDer(L).getBytes(),H=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),j=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);j.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,U)),j.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var z=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r.digest().getBytes());return H.value.push(j),H.value.push(z),s.toDer(H).getBytes()},v=function(r,L,K){if(K)return r.modPow(L.e,L.n);if(!L.p||!L.q)return r.modPow(L.d,L.n);L.dP||(L.dP=L.d.mod(L.p.subtract(e.ONE))),L.dQ||(L.dQ=L.d.mod(L.q.subtract(e.ONE))),L.qInv||(L.qInv=L.q.modInverse(L.p));var U;do U=new e(t.util.bytesToHex(t.random.getBytes(L.n.bitLength()/8)),16);while(U.compareTo(L.n)>=0||!U.gcd(L.n).equals(e.ONE));r=r.multiply(U.modPow(L.e,L.n)).mod(L.n);for(var H=r.mod(L.p).modPow(L.dP,L.p),j=r.mod(L.q).modPow(L.dQ,L.q);H.compareTo(j)<0;)H=H.add(L.p);var z=H.subtract(j).multiply(L.qInv).mod(L.p).multiply(L.q).add(j);return z=z.multiply(U.modInverse(L.n)).mod(L.n),z};T.rsa.encrypt=function(r,L,K){var U=K,H,j=Math.ceil(L.n.bitLength()/8);K!==!1&&K!==!0?(U=K===2,H=A(r,L,K)):(H=t.util.createBuffer(),H.putBytes(r));for(var z=new e(H.toHex(),16),Y=v(z,L,U),X=Y.toString(16),$=t.util.createBuffer(),te=j-Math.ceil(X.length/2);te>0;)$.putByte(0),--te;return $.putBytes(t.util.hexToBytes(X)),$.getBytes()},T.rsa.decrypt=function(r,L,K,U){var H=Math.ceil(L.n.bitLength()/8);if(r.length!==H){var j=new Error("Encrypted message length is invalid.");throw j.length=r.length,j.expected=H,j}var z=new e(t.util.createBuffer(r).toHex(),16);if(z.compareTo(L.n)>=0)throw new Error("Encrypted message is invalid.");for(var Y=v(z,L,K),X=Y.toString(16),$=t.util.createBuffer(),te=H-Math.ceil(X.length/2);te>0;)$.putByte(0),--te;return $.putBytes(t.util.hexToBytes(X)),U!==!1?f($.getBytes(),L,K):$.getBytes()},T.rsa.createKeyPairGenerationState=function(r,L,K){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,K=K||{};var U=K.prng||t.random,H={nextBytes:function(Y){for(var X=U.getBytesSync(Y.length),$=0;$<Y.length;++$)Y[$]=X.charCodeAt($)}},j=K.algorithm||"PRIMEINC",z;if(j==="PRIMEINC")z={algorithm:j,state:0,bits:r,rng:H,eInt:L||65537,e:new e(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},z.e.fromInt(z.eInt);else throw new Error("Invalid key generation algorithm: "+j);return z},T.rsa.stepKeyPairGenerationState=function(r,L){"algorithm"in r||(r.algorithm="PRIMEINC");var K=new e(null);K.fromInt(30);for(var U=0,H=function(ge,Ee){return ge|Ee},j=+new Date,z,Y=0;r.keys===null&&(L<=0||Y<L);){if(r.state===0){var X=r.p===null?r.pBits:r.qBits,$=X-1;r.pqState===0?(r.num=new e(X,r.rng),r.num.testBit($)||r.num.bitwiseTo(e.ONE.shiftLeft($),H,r.num),r.num.dAddOffset(31-r.num.mod(K).byteValue(),0),U=0,++r.pqState):r.pqState===1?r.num.bitLength()>X?r.pqState=0:r.num.isProbablePrime(n(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(d[U++%8],0):r.pqState===2?r.pqState=r.num.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(e.ONE),r.q1=r.q.subtract(e.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(e.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var te=r.e.modInverse(r.phi);r.keys={privateKey:T.rsa.setPrivateKey(r.n,r.e,te,r.p,r.q,te.mod(r.p1),te.mod(r.q1),r.q.modInverse(r.p)),publicKey:T.rsa.setPublicKey(r.n,r.e)}}z=+new Date,Y+=z-j,j=z}return r.keys!==null},T.rsa.generateKeyPair=function(r,L,K,U){if(arguments.length===1?typeof r=="object"?(K=r,r=void 0):typeof r=="function"&&(U=r,r=void 0):arguments.length===2?typeof r=="number"?typeof L=="function"?(U=L,L=void 0):typeof L!="number"&&(K=L,L=void 0):(K=r,U=L,r=void 0,L=void 0):arguments.length===3&&(typeof L=="number"?typeof K=="function"&&(U=K,K=void 0):(U=K,K=L,L=void 0)),K=K||{},r===void 0&&(r=K.bits||2048),L===void 0&&(L=K.e||65537),!t.options.usePureJavaScript&&!K.prng&&r>=256&&r<=16384&&(L===65537||L===3)){if(U){if(u("generateKeyPair"))return h.generateKeyPair("rsa",{modulusLength:r,publicExponent:L,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(Y,X,$){if(Y)return U(Y);U(null,{privateKey:T.privateKeyFromPem($),publicKey:T.publicKeyFromPem(X)})});if(x("generateKey")&&x("exportKey"))return C.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:V(L),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(Y){return C.globalScope.crypto.subtle.exportKey("pkcs8",Y.privateKey)}).then(void 0,function(Y){U(Y)}).then(function(Y){if(Y){var X=T.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(Y)));U(null,{privateKey:X,publicKey:T.setRsaPublicKey(X.n,X.e)})}});if(B("generateKey")&&B("exportKey")){var H=C.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:V(L),hash:{name:"SHA-256"}},!0,["sign","verify"]);H.oncomplete=function(Y){var X=Y.target.result,$=C.globalScope.msCrypto.subtle.exportKey("pkcs8",X.privateKey);$.oncomplete=function(te){var ge=te.target.result,Ee=T.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(ge)));U(null,{privateKey:Ee,publicKey:T.setRsaPublicKey(Ee.n,Ee.e)})},$.onerror=function(te){U(te)}},H.onerror=function(Y){U(Y)};return}}else if(u("generateKeyPairSync")){var j=h.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:L,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:T.privateKeyFromPem(j.privateKey),publicKey:T.publicKeyFromPem(j.publicKey)}}}var z=T.rsa.createKeyPairGenerationState(r,L,K);if(!U)return T.rsa.stepKeyPairGenerationState(z,0),z.keys;g(z,K,U)},T.setRsaPublicKey=T.rsa.setPublicKey=function(r,L){var K={n:r,e:L};return K.encrypt=function(U,H,j){if(typeof H=="string"?H=H.toUpperCase():H===void 0&&(H="RSAES-PKCS1-V1_5"),H==="RSAES-PKCS1-V1_5")H={encode:function(Y,X,$){return A(Y,X,2).getBytes()}};else if(H==="RSA-OAEP"||H==="RSAES-OAEP")H={encode:function(Y,X){return t.pkcs1.encode_rsa_oaep(X,Y,j)}};else if(["RAW","NONE","NULL",null].indexOf(H)!==-1)H={encode:function(Y){return Y}};else if(typeof H=="string")throw new Error('Unsupported encryption scheme: "'+H+'".');var z=H.encode(U,K,!0);return T.rsa.encrypt(z,K,!0)},K.verify=function(U,H,j,z){typeof j=="string"?j=j.toUpperCase():j===void 0&&(j="RSASSA-PKCS1-V1_5"),z===void 0&&(z={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in z||(z._parseAllDigestBytes=!0),j==="RSASSA-PKCS1-V1_5"?j={verify:function(X,$){$=f($,K,!0);var te=s.fromDer($,{parseAllBytes:z._parseAllDigestBytes}),ge={},Ee=[];if(!s.validate(te,S,ge,Ee)){var Se=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw Se.errors=Ee,Se}var ye=s.derToOid(ge.algorithmIdentifier);if(!(ye===t.oids.md2||ye===t.oids.md5||ye===t.oids.sha1||ye===t.oids.sha224||ye===t.oids.sha256||ye===t.oids.sha384||ye===t.oids.sha512||ye===t.oids["sha512-224"]||ye===t.oids["sha512-256"])){var Se=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw Se.oid=ye,Se}if((ye===t.oids.md2||ye===t.oids.md5)&&!("parameters"in ge))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return X===ge.digest}}:(j==="NONE"||j==="NULL"||j===null)&&(j={verify:function(X,$){return $=f($,K,!0),X===$}});var Y=T.rsa.decrypt(H,K,!0,!1);return j.verify(U,Y,K.n.bitLength())},K},T.setRsaPrivateKey=T.rsa.setPrivateKey=function(r,L,K,U,H,j,z,Y){var X={n:r,e:L,d:K,p:U,q:H,dP:j,dQ:z,qInv:Y};return X.decrypt=function($,te,ge){typeof te=="string"?te=te.toUpperCase():te===void 0&&(te="RSAES-PKCS1-V1_5");var Ee=T.rsa.decrypt($,X,!1,!1);if(te==="RSAES-PKCS1-V1_5")te={decode:f};else if(te==="RSA-OAEP"||te==="RSAES-OAEP")te={decode:function(Se,ye){return t.pkcs1.decode_rsa_oaep(ye,Se,ge)}};else if(["RAW","NONE","NULL",null].indexOf(te)!==-1)te={decode:function(Se){return Se}};else throw new Error('Unsupported encryption scheme: "'+te+'".');return te.decode(Ee,X,!1)},X.sign=function($,te){var ge=!1;typeof te=="string"&&(te=te.toUpperCase()),te===void 0||te==="RSASSA-PKCS1-V1_5"?(te={encode:m},ge=1):(te==="NONE"||te==="NULL"||te===null)&&(te={encode:function(){return $}},ge=1);var Ee=te.encode($,X.n.bitLength());return T.rsa.encrypt(Ee,X,ge)},X},T.wrapRsaPrivateKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(T.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(r).getBytes())])},T.privateKeyFromAsn1=function(r){var L={},K=[];if(s.validate(r,p,L,K)&&(r=s.fromDer(t.util.createBuffer(L.privateKey))),L={},K=[],!s.validate(r,a,L,K)){var U=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw U.errors=K,U}var H,j,z,Y,X,$,te,ge;return H=t.util.createBuffer(L.privateKeyModulus).toHex(),j=t.util.createBuffer(L.privateKeyPublicExponent).toHex(),z=t.util.createBuffer(L.privateKeyPrivateExponent).toHex(),Y=t.util.createBuffer(L.privateKeyPrime1).toHex(),X=t.util.createBuffer(L.privateKeyPrime2).toHex(),$=t.util.createBuffer(L.privateKeyExponent1).toHex(),te=t.util.createBuffer(L.privateKeyExponent2).toHex(),ge=t.util.createBuffer(L.privateKeyCoefficient).toHex(),T.setRsaPrivateKey(new e(H,16),new e(j,16),new e(z,16),new e(Y,16),new e(X,16),new e($,16),new e(te,16),new e(ge,16))},T.privateKeyToAsn1=T.privateKeyToRSAPrivateKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.qInv))])},T.publicKeyFromAsn1=function(r){var L={},K=[];if(s.validate(r,E,L,K)){var U=s.derToOid(L.publicKeyOid);if(U!==T.oids.rsaEncryption){var H=new Error("Cannot read public key. Unknown OID.");throw H.oid=U,H}r=L.rsaPublicKey}if(K=[],!s.validate(r,o,L,K)){var H=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw H.errors=K,H}var j=t.util.createBuffer(L.publicKeyModulus).toHex(),z=t.util.createBuffer(L.publicKeyExponent).toHex();return T.setRsaPublicKey(new e(j,16),new e(z,16))},T.publicKeyToAsn1=T.publicKeyToSubjectPublicKeyInfo=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(T.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[T.publicKeyToRSAPublicKey(r)])])},T.publicKeyToRSAPublicKey=function(r){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,w(r.e))])};function A(r,L,K){var U=t.util.createBuffer(),H=Math.ceil(L.n.bitLength()/8);if(r.length>H-11){var j=new Error("Message is too long for PKCS#1 v1.5 padding.");throw j.length=r.length,j.max=H-11,j}U.putByte(0),U.putByte(K);var z=H-3-r.length,Y;if(K===0||K===1){Y=K===0?0:255;for(var X=0;X<z;++X)U.putByte(Y)}else for(;z>0;){for(var $=0,te=t.random.getBytes(z),X=0;X<z;++X)Y=te.charCodeAt(X),Y===0?++$:U.putByte(Y);z=$}return U.putByte(0),U.putBytes(r),U}function f(r,L,K,U){var H=Math.ceil(L.n.bitLength()/8),j=t.util.createBuffer(r),z=j.getByte(),Y=j.getByte();if(z!==0||K&&Y!==0&&Y!==1||!K&&Y!=2||K&&Y===0&&typeof U>"u")throw new Error("Encryption block is invalid.");var X=0;if(Y===0){X=H-3-U;for(var $=0;$<X;++$)if(j.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(Y===1)for(X=0;j.length()>1;){if(j.getByte()!==255){--j.read;break}++X}else if(Y===2)for(X=0;j.length()>1;){if(j.getByte()===0){--j.read;break}++X}var te=j.getByte();if(te!==0||X!==H-3-j.length())throw new Error("Encryption block is invalid.");return j.getBytes()}function g(r,L,K){typeof L=="function"&&(K=L,L={}),L=L||{};var U={algorithm:{name:L.algorithm||"PRIMEINC",options:{workers:L.workers||2,workLoad:L.workLoad||100,workerScript:L.workerScript}}};"prng"in L&&(U.prng=L.prng),H();function H(){j(r.pBits,function(Y,X){if(Y)return K(Y);if(r.p=X,r.q!==null)return z(Y,r.q);j(r.qBits,z)})}function j(Y,X){t.prime.generateProbablePrime(Y,U,X)}function z(Y,X){if(Y)return K(Y);if(r.q=X,r.p.compareTo(r.q)<0){var $=r.p;r.p=r.q,r.q=$}if(r.p.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)!==0){r.p=null,H();return}if(r.q.subtract(e.ONE).gcd(r.e).compareTo(e.ONE)!==0){r.q=null,j(r.qBits,z);return}if(r.p1=r.p.subtract(e.ONE),r.q1=r.q.subtract(e.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(e.ONE)!==0){r.p=r.q=null,H();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,j(r.qBits,z);return}var te=r.e.modInverse(r.phi);r.keys={privateKey:T.rsa.setPrivateKey(r.n,r.e,te,r.p,r.q,te.mod(r.p1),te.mod(r.q1),r.q.modInverse(r.p)),publicKey:T.rsa.setPublicKey(r.n,r.e)},K(null,r.keys)}}function w(r){var L=r.toString(16);L[0]>="8"&&(L="00"+L);var K=t.util.hexToBytes(L);return K.length>1&&(K.charCodeAt(0)===0&&(K.charCodeAt(1)&128)===0||K.charCodeAt(0)===255&&(K.charCodeAt(1)&128)===128)?K.substr(1):K}function n(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function u(r){return t.util.isNodejs&&typeof h[r]=="function"}function x(r){return typeof C.globalScope<"u"&&typeof C.globalScope.crypto=="object"&&typeof C.globalScope.crypto.subtle=="object"&&typeof C.globalScope.crypto.subtle[r]=="function"}function B(r){return typeof C.globalScope<"u"&&typeof C.globalScope.msCrypto=="object"&&typeof C.globalScope.msCrypto.subtle=="object"&&typeof C.globalScope.msCrypto.subtle[r]=="function"}function V(r){for(var L=t.util.hexToBytes(r.toString(16)),K=new Uint8Array(L.length),U=0;U<L.length;++U)K[U]=L.charCodeAt(U);return K}function c(r){if(r.kty!=="RSA")throw new Error('Unsupported key algorithm "'+r.kty+'"; algorithm must be "RSA".');return T.setRsaPrivateKey(N(r.n),N(r.e),N(r.d),N(r.p),N(r.q),N(r.dp),N(r.dq),N(r.qi))}function y(r){if(r.kty!=="RSA")throw new Error('Key algorithm must be "RSA".');return T.setRsaPublicKey(N(r.n),N(r.e))}function N(r){return new e(t.util.bytesToHex(t.util.decode64(r)),16)}},21598:(re,xe,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){s||C();var d=null,p=t.util.createBuffer(),a=new Array(80),o={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength64=[];for(var E=o.messageLengthSize/4,S=0;S<E;++S)o.fullMessageLength.push(0);return p=t.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},o},o.start(),o.update=function(E,S){S==="utf8"&&(E=t.util.encodeUtf8(E));var m=E.length;o.messageLength+=m,m=[m/4294967296>>>0,m>>>0];for(var v=o.fullMessageLength.length-1;v>=0;--v)o.fullMessageLength[v]+=m[1],m[1]=m[0]+(o.fullMessageLength[v]/4294967296>>>0),o.fullMessageLength[v]=o.fullMessageLength[v]>>>0,m[0]=m[1]/4294967296>>>0;return p.putBytes(E),T(d,a,p),(p.read>2048||p.length()===0)&&p.compact(),o},o.digest=function(){var E=t.util.createBuffer();E.putBytes(p.bytes());var S=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,m=S&o.blockLength-1;E.putBytes(h.substr(0,o.blockLength-m));for(var v,A,f=o.fullMessageLength[0]*8,g=0;g<o.fullMessageLength.length-1;++g)v=o.fullMessageLength[g+1]*8,A=v/4294967296>>>0,f+=A,E.putInt32(f>>>0),f=v>>>0;E.putInt32(f);var w={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4};T(w,a,E);var n=t.util.createBuffer();return n.putInt32(w.h0),n.putInt32(w.h1),n.putInt32(w.h2),n.putInt32(w.h3),n.putInt32(w.h4),n},o};var h=null,s=!1;function C(){h="\x80",h+=t.util.fillString("\0",64),s=!0}function T(d,p,a){for(var o,E,S,m,v,A,f,g,w=a.length();w>=64;){for(E=d.h0,S=d.h1,m=d.h2,v=d.h3,A=d.h4,g=0;g<16;++g)o=a.getInt32(),p[g]=o,f=v^S&(m^v),o=(E<<5|E>>>27)+f+A+1518500249+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;for(;g<20;++g)o=p[g-3]^p[g-8]^p[g-14]^p[g-16],o=o<<1|o>>>31,p[g]=o,f=v^S&(m^v),o=(E<<5|E>>>27)+f+A+1518500249+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;for(;g<32;++g)o=p[g-3]^p[g-8]^p[g-14]^p[g-16],o=o<<1|o>>>31,p[g]=o,f=S^m^v,o=(E<<5|E>>>27)+f+A+1859775393+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;for(;g<40;++g)o=p[g-6]^p[g-16]^p[g-28]^p[g-32],o=o<<2|o>>>30,p[g]=o,f=S^m^v,o=(E<<5|E>>>27)+f+A+1859775393+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;for(;g<60;++g)o=p[g-6]^p[g-16]^p[g-28]^p[g-32],o=o<<2|o>>>30,p[g]=o,f=S&m|v&(S^m),o=(E<<5|E>>>27)+f+A+2400959708+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;for(;g<80;++g)o=p[g-6]^p[g-16]^p[g-28]^p[g-32],o=o<<2|o>>>30,p[g]=o,f=S^m^v,o=(E<<5|E>>>27)+f+A+3395469782+o,A=v,v=m,m=(S<<30|S>>>2)>>>0,S=E,E=o;d.h0=d.h0+E|0,d.h1=d.h1+S|0,d.h2=d.h2+m|0,d.h3=d.h3+v|0,d.h4=d.h4+A|0,w-=64}}},30172:(re,xe,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){s||T();var p=null,a=t.util.createBuffer(),o=new Array(64),E={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var S=E.messageLengthSize/4,m=0;m<S;++m)E.fullMessageLength.push(0);return a=t.util.createBuffer(),p={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},E},E.start(),E.update=function(S,m){m==="utf8"&&(S=t.util.encodeUtf8(S));var v=S.length;E.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var A=E.fullMessageLength.length-1;A>=0;--A)E.fullMessageLength[A]+=v[1],v[1]=v[0]+(E.fullMessageLength[A]/4294967296>>>0),E.fullMessageLength[A]=E.fullMessageLength[A]>>>0,v[0]=v[1]/4294967296>>>0;return a.putBytes(S),d(p,o,a),(a.read>2048||a.length()===0)&&a.compact(),E},E.digest=function(){var S=t.util.createBuffer();S.putBytes(a.bytes());var m=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,v=m&E.blockLength-1;S.putBytes(h.substr(0,E.blockLength-v));for(var A,f,g=E.fullMessageLength[0]*8,w=0;w<E.fullMessageLength.length-1;++w)A=E.fullMessageLength[w+1]*8,f=A/4294967296>>>0,g+=f,S.putInt32(g>>>0),g=A>>>0;S.putInt32(g);var n={h0:p.h0,h1:p.h1,h2:p.h2,h3:p.h3,h4:p.h4,h5:p.h5,h6:p.h6,h7:p.h7};d(n,o,S);var u=t.util.createBuffer();return u.putInt32(n.h0),u.putInt32(n.h1),u.putInt32(n.h2),u.putInt32(n.h3),u.putInt32(n.h4),u.putInt32(n.h5),u.putInt32(n.h6),u.putInt32(n.h7),u},E};var h=null,s=!1,C=null;function T(){h="\x80",h+=t.util.fillString("\0",64),C=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0}function d(p,a,o){for(var E,S,m,v,A,f,g,w,n,u,x,B,V,c,y,N=o.length();N>=64;){for(g=0;g<16;++g)a[g]=o.getInt32();for(;g<64;++g)E=a[g-2],E=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10,S=a[g-15],S=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,a[g]=E+a[g-7]+S+a[g-16]|0;for(w=p.h0,n=p.h1,u=p.h2,x=p.h3,B=p.h4,V=p.h5,c=p.h6,y=p.h7,g=0;g<64;++g)v=(B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7),A=c^B&(V^c),m=(w>>>2|w<<30)^(w>>>13|w<<19)^(w>>>22|w<<10),f=w&n|u&(w^n),E=y+v+A+C[g]+a[g],S=m+f,y=c,c=V,V=B,B=x+E>>>0,x=u,u=n,n=w,w=E+S>>>0;p.h0=p.h0+w|0,p.h1=p.h1+n|0,p.h2=p.h2+u|0,p.h3=p.h3+x|0,p.h4=p.h4+B|0,p.h5=p.h5+V|0,p.h6=p.h6+c|0,p.h7=p.h7+y|0,N-=64}}},72313:(re,xe,P)=>{var t=P(50276);P(8106),P(7619);var e=re.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var h=t.sha384=t.sha512.sha384=t.sha512.sha384||{};h.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=h,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(o){if(C||p(),typeof o>"u"&&(o="SHA-512"),!(o in d))throw new Error("Invalid SHA-512 algorithm: "+o);for(var E=d[o],S=null,m=t.util.createBuffer(),v=new Array(80),A=0;A<80;++A)v[A]=new Array(2);var f=64;switch(o){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28;break}var g={algorithm:o.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength128=[];for(var w=g.messageLengthSize/4,n=0;n<w;++n)g.fullMessageLength.push(0);m=t.util.createBuffer(),S=new Array(E.length);for(var n=0;n<E.length;++n)S[n]=E[n].slice(0);return g},g.start(),g.update=function(w,n){n==="utf8"&&(w=t.util.encodeUtf8(w));var u=w.length;g.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var x=g.fullMessageLength.length-1;x>=0;--x)g.fullMessageLength[x]+=u[1],u[1]=u[0]+(g.fullMessageLength[x]/4294967296>>>0),g.fullMessageLength[x]=g.fullMessageLength[x]>>>0,u[0]=u[1]/4294967296>>>0;return m.putBytes(w),a(S,v,m),(m.read>2048||m.length()===0)&&m.compact(),g},g.digest=function(){var w=t.util.createBuffer();w.putBytes(m.bytes());var n=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,u=n&g.blockLength-1;w.putBytes(s.substr(0,g.blockLength-u));for(var x,B,V=g.fullMessageLength[0]*8,c=0;c<g.fullMessageLength.length-1;++c)x=g.fullMessageLength[c+1]*8,B=x/4294967296>>>0,V+=B,w.putInt32(V>>>0),V=x>>>0;w.putInt32(V);for(var y=new Array(S.length),c=0;c<S.length;++c)y[c]=S[c].slice(0);a(y,v,w);var N=t.util.createBuffer(),r;o==="SHA-512"?r=y.length:o==="SHA-384"?r=y.length-2:r=y.length-4;for(var c=0;c<r;++c)N.putInt32(y[c][0]),(c!==r-1||o!=="SHA-512/224")&&N.putInt32(y[c][1]);return N},g};var s=null,C=!1,T=null,d=null;function p(){s="\x80",s+=t.util.fillString("\0",128),T=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],d={},d["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],d["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],d["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],d["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],C=!0}function a(o,E,S){for(var m,v,A,f,g,w,n,u,x,B,V,c,y,N,r,L,K,U,H,j,z,Y,X,$,te,ge,Ee,Se,ye,ie,ae,Be,_e,Ie,Q,l=S.length();l>=128;){for(ye=0;ye<16;++ye)E[ye][0]=S.getInt32()>>>0,E[ye][1]=S.getInt32()>>>0;for(;ye<80;++ye)Be=E[ye-2],ie=Be[0],ae=Be[1],m=((ie>>>19|ae<<13)^(ae>>>29|ie<<3)^ie>>>6)>>>0,v=((ie<<13|ae>>>19)^(ae<<3|ie>>>29)^(ie<<26|ae>>>6))>>>0,Ie=E[ye-15],ie=Ie[0],ae=Ie[1],A=((ie>>>1|ae<<31)^(ie>>>8|ae<<24)^ie>>>7)>>>0,f=((ie<<31|ae>>>1)^(ie<<24|ae>>>8)^(ie<<25|ae>>>7))>>>0,_e=E[ye-7],Q=E[ye-16],ae=v+_e[1]+f+Q[1],E[ye][0]=m+_e[0]+A+Q[0]+(ae/4294967296>>>0)>>>0,E[ye][1]=ae>>>0;for(y=o[0][0],N=o[0][1],r=o[1][0],L=o[1][1],K=o[2][0],U=o[2][1],H=o[3][0],j=o[3][1],z=o[4][0],Y=o[4][1],X=o[5][0],$=o[5][1],te=o[6][0],ge=o[6][1],Ee=o[7][0],Se=o[7][1],ye=0;ye<80;++ye)n=((z>>>14|Y<<18)^(z>>>18|Y<<14)^(Y>>>9|z<<23))>>>0,u=((z<<18|Y>>>14)^(z<<14|Y>>>18)^(Y<<23|z>>>9))>>>0,x=(te^z&(X^te))>>>0,B=(ge^Y&($^ge))>>>0,g=((y>>>28|N<<4)^(N>>>2|y<<30)^(N>>>7|y<<25))>>>0,w=((y<<4|N>>>28)^(N<<30|y>>>2)^(N<<25|y>>>7))>>>0,V=(y&r|K&(y^r))>>>0,c=(N&L|U&(N^L))>>>0,ae=Se+u+B+T[ye][1]+E[ye][1],m=Ee+n+x+T[ye][0]+E[ye][0]+(ae/4294967296>>>0)>>>0,v=ae>>>0,ae=w+c,A=g+V+(ae/4294967296>>>0)>>>0,f=ae>>>0,Ee=te,Se=ge,te=X,ge=$,X=z,$=Y,ae=j+v,z=H+m+(ae/4294967296>>>0)>>>0,Y=ae>>>0,H=K,j=U,K=r,U=L,r=y,L=N,ae=v+f,y=m+A+(ae/4294967296>>>0)>>>0,N=ae>>>0;ae=o[0][1]+N,o[0][0]=o[0][0]+y+(ae/4294967296>>>0)>>>0,o[0][1]=ae>>>0,ae=o[1][1]+L,o[1][0]=o[1][0]+r+(ae/4294967296>>>0)>>>0,o[1][1]=ae>>>0,ae=o[2][1]+U,o[2][0]=o[2][0]+K+(ae/4294967296>>>0)>>>0,o[2][1]=ae>>>0,ae=o[3][1]+j,o[3][0]=o[3][0]+H+(ae/4294967296>>>0)>>>0,o[3][1]=ae>>>0,ae=o[4][1]+Y,o[4][0]=o[4][0]+z+(ae/4294967296>>>0)>>>0,o[4][1]=ae>>>0,ae=o[5][1]+$,o[5][0]=o[5][0]+X+(ae/4294967296>>>0)>>>0,o[5][1]=ae>>>0,ae=o[6][1]+ge,o[6][0]=o[6][0]+te+(ae/4294967296>>>0)>>>0,o[6][1]=ae>>>0,ae=o[7][1]+Se,o[7][0]=o[7][0]+Ee+(ae/4294967296>>>0)>>>0,o[7][1]=ae>>>0,l-=128}}},50149:(re,xe,P)=>{var t=P(50276);P(39504),P(71696),P(1267),P(21598),P(7619);var e=re.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(T,d,p){p=p||"",d=d||"";var a="ssh-rsa",o=d===""?"none":"aes256-cbc",E="PuTTY-User-Key-File-2: "+a+`\r
`;E+="Encryption: "+o+`\r
`,E+="Comment: "+p+`\r
`;var S=t.util.createBuffer();s(S,a),h(S,T.e),h(S,T.n);var m=t.util.encode64(S.bytes(),64),v=Math.floor(m.length/66)+1;E+="Public-Lines: "+v+`\r
`,E+=m;var A=t.util.createBuffer();h(A,T.d),h(A,T.p),h(A,T.q),h(A,T.qInv);var f;if(!d)f=t.util.encode64(A.bytes(),64);else{var g=A.length()+16-1;g-=g%16;var w=C(A.bytes());w.truncate(w.length()-g+A.length()),A.putBuffer(w);var n=t.util.createBuffer();n.putBuffer(C("\0\0\0\0",d)),n.putBuffer(C("\0\0\0",d));var u=t.aes.createEncryptionCipher(n.truncate(8),"CBC");u.start(t.util.createBuffer().fillWithByte(0,16)),u.update(A.copy()),u.finish();var x=u.output;x.truncate(16),f=t.util.encode64(x.bytes(),64)}v=Math.floor(f.length/66)+1,E+=`\r
Private-Lines: `+v+`\r
`,E+=f;var B=C("putty-private-key-file-mac-key",d),V=t.util.createBuffer();s(V,a),s(V,o),s(V,p),V.putInt32(S.length()),V.putBuffer(S),V.putInt32(A.length()),V.putBuffer(A);var c=t.hmac.create();return c.start("sha1",B),c.update(V.bytes()),E+=`\r
Private-MAC: `+c.digest().toHex()+`\r
`,E},e.publicKeyToOpenSSH=function(T,d){var p="ssh-rsa";d=d||"";var a=t.util.createBuffer();return s(a,p),h(a,T.e),h(a,T.n),p+" "+t.util.encode64(a.bytes())+" "+d},e.privateKeyToOpenSSH=function(T,d){return d?t.pki.encryptRsaPrivateKey(T,d,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(T)},e.getPublicKeyFingerprint=function(T,d){d=d||{};var p=d.md||t.md.md5.create(),a="ssh-rsa",o=t.util.createBuffer();s(o,a),h(o,T.e),h(o,T.n),p.start(),p.update(o.getBytes());var E=p.digest();if(d.encoding==="hex"){var S=E.toHex();return d.delimiter?S.match(/.{2}/g).join(d.delimiter):S}else{if(d.encoding==="binary")return E.getBytes();if(d.encoding)throw new Error('Unknown encoding "'+d.encoding+'".')}return E};function h(T,d){var p=d.toString(16);p[0]>="8"&&(p="00"+p);var a=t.util.hexToBytes(p);T.putInt32(a.length),T.putBytes(a)}function s(T,d){T.putInt32(d.length),T.putString(d)}function C(){for(var T=t.md.sha1.create(),d=arguments.length,p=0;p<d;++p)T.update(arguments[p]);return T.digest()}},43986:(re,xe,P)=>{var t=P(50276);P(12746),P(71696),P(1267),P(2385),P(29255),P(89356),P(21598),P(7619);var e=function(l,D,i,I){var O=t.util.createBuffer(),G=l.length>>1,M=G+(l.length&1),q=l.substr(0,M),pe=l.substr(G,M),he=t.util.createBuffer(),Z=t.hmac.create();i=D+i;var fe=Math.ceil(I/16),me=Math.ceil(I/20);Z.start("MD5",q);var be=t.util.createBuffer();he.putBytes(i);for(var Ce=0;Ce<fe;++Ce)Z.start(null,null),Z.update(he.getBytes()),he.putBuffer(Z.digest()),Z.start(null,null),Z.update(he.bytes()+i),be.putBuffer(Z.digest());Z.start("SHA1",pe);var we=t.util.createBuffer();he.clear(),he.putBytes(i);for(var Ce=0;Ce<me;++Ce)Z.start(null,null),Z.update(he.getBytes()),he.putBuffer(Z.digest()),Z.start(null,null),Z.update(he.bytes()+i),we.putBuffer(Z.digest());return O.putBytes(t.util.xorBytes(be.getBytes(),we.getBytes(),I)),O},h=function(l,D,i,I){},s=function(l,D,i){var I=t.hmac.create();I.start("SHA1",l);var O=t.util.createBuffer();return O.putInt32(D[0]),O.putInt32(D[1]),O.putByte(i.type),O.putByte(i.version.major),O.putByte(i.version.minor),O.putInt16(i.length),O.putBytes(i.fragment.bytes()),I.update(O.getBytes()),I.digest().getBytes()},C=function(l,D,i){var I=!1;try{var O=l.deflate(D.fragment.getBytes());D.fragment=t.util.createBuffer(O),D.length=O.length,I=!0}catch{}return I},T=function(l,D,i){var I=!1;try{var O=l.inflate(D.fragment.getBytes());D.fragment=t.util.createBuffer(O),D.length=O.length,I=!0}catch{}return I},d=function(l,D){var i=0;switch(D){case 1:i=l.getByte();break;case 2:i=l.getInt16();break;case 3:i=l.getInt24();break;case 4:i=l.getInt32();break}return t.util.createBuffer(l.getBytes(i))},p=function(l,D,i){l.putInt(i.length(),D<<3),l.putBuffer(i)},a={};a.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},a.SupportedVersions=[a.Versions.TLS_1_1,a.Versions.TLS_1_0],a.Version=a.SupportedVersions[0],a.MaxFragment=15360,a.ConnectionEnd={server:0,client:1},a.PRFAlgorithm={tls_prf_sha256:0},a.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},a.CipherType={stream:0,block:1,aead:2},a.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},a.CompressionMethod={none:0,deflate:1},a.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},a.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},a.Alert={},a.Alert.Level={warning:1,fatal:2},a.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},a.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},a.CipherSuites={},a.getCipherSuite=function(l){var D=null;for(var i in a.CipherSuites){var I=a.CipherSuites[i];if(I.id[0]===l.charCodeAt(0)&&I.id[1]===l.charCodeAt(1)){D=I;break}}return D},a.handleUnexpected=function(l,D){var i=!l.open&&l.entity===a.ConnectionEnd.client;i||l.error(l,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})},a.handleHelloRequest=function(l,D,i){!l.handshaking&&l.handshakes>0&&(a.queue(l,a.createAlert(l,{level:a.Alert.Level.warning,description:a.Alert.Description.no_renegotiation})),a.flush(l)),l.process()},a.parseHelloMessage=function(l,D,i){var I=null,O=l.entity===a.ConnectionEnd.client;if(i<38)l.error(l,{message:O?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});else{var G=D.fragment,M=G.length();if(I={version:{major:G.getByte(),minor:G.getByte()},random:t.util.createBuffer(G.getBytes(32)),session_id:d(G,1),extensions:[]},O?(I.cipher_suite=G.getBytes(2),I.compression_method=G.getByte()):(I.cipher_suites=d(G,2),I.compression_methods=d(G,1)),M=i-(M-G.length()),M>0){for(var q=d(G,2);q.length()>0;)I.extensions.push({type:[q.getByte(),q.getByte()],data:d(q,2)});if(!O)for(var pe=0;pe<I.extensions.length;++pe){var he=I.extensions[pe];if(he.type[0]===0&&he.type[1]===0)for(var Z=d(he.data,2);Z.length()>0;){var fe=Z.getByte();if(fe!==0)break;l.session.extensions.server_name.serverNameList.push(d(Z,2).getBytes())}}}if(l.session.version&&(I.version.major!==l.session.version.major||I.version.minor!==l.session.version.minor))return l.error(l,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});if(O)l.session.cipherSuite=a.getCipherSuite(I.cipher_suite);else for(var me=t.util.createBuffer(I.cipher_suites.bytes());me.length()>0&&(l.session.cipherSuite=a.getCipherSuite(me.getBytes(2)),l.session.cipherSuite===null););if(l.session.cipherSuite===null)return l.error(l,{message:"No cipher suites in common.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(I.cipher_suite)});O?l.session.compressionMethod=I.compression_method:l.session.compressionMethod=a.CompressionMethod.none}return I},a.createSecurityParameters=function(l,D){var i=l.entity===a.ConnectionEnd.client,I=D.random.bytes(),O=i?l.session.sp.client_random:I,G=i?I:a.createRandom().getBytes();l.session.sp={entity:l.entity,prf_algorithm:a.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:l.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:O,server_random:G}},a.handleServerHello=function(l,D,i){var I=a.parseHelloMessage(l,D,i);if(!l.fail){if(I.version.minor<=l.version.minor)l.version.minor=I.version.minor;else return l.error(l,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});l.session.version=l.version;var O=I.session_id.bytes();O.length>0&&O===l.session.id?(l.expect=A,l.session.resuming=!0,l.session.sp.server_random=I.random.bytes()):(l.expect=E,l.session.resuming=!1,a.createSecurityParameters(l,I)),l.session.id=O,l.process()}},a.handleClientHello=function(l,D,i){var I=a.parseHelloMessage(l,D,i);if(!l.fail){var O=I.session_id.bytes(),G=null;if(l.sessionCache&&(G=l.sessionCache.getSession(O),G===null?O="":(G.version.major!==I.version.major||G.version.minor>I.version.minor)&&(G=null,O="")),O.length===0&&(O=t.random.getBytes(32)),l.session.id=O,l.session.clientHelloVersion=I.version,l.session.sp={},G)l.version=l.session.version=G.version,l.session.sp=G.sp;else{for(var M,q=1;q<a.SupportedVersions.length&&(M=a.SupportedVersions[q],!(M.minor<=I.version.minor));++q);l.version={major:M.major,minor:M.minor},l.session.version=l.version}G!==null?(l.expect=V,l.session.resuming=!0,l.session.sp.client_random=I.random.bytes()):(l.expect=l.verifyClient!==!1?u:x,l.session.resuming=!1,a.createSecurityParameters(l,I)),l.open=!0,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerHello(l)})),l.session.resuming?(a.queue(l,a.createRecord(l,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),l.state.pending=a.createConnectionState(l),l.state.current.write=l.state.pending.write,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createFinished(l)}))):(a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificate(l)})),l.fail||(a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerKeyExchange(l)})),l.verifyClient!==!1&&a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificateRequest(l)})),a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createServerHelloDone(l)})))),a.flush(l),l.process()}},a.handleCertificate=function(l,D,i){if(i<3)return l.error(l,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var I=D.fragment,O={certificate_list:d(I,3)},G,M,q=[];try{for(;O.certificate_list.length()>0;)G=d(O.certificate_list,3),M=t.asn1.fromDer(G),G=t.pki.certificateFromAsn1(M,!0),q.push(G)}catch(he){return l.error(l,{message:"Could not parse certificate list.",cause:he,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var pe=l.entity===a.ConnectionEnd.client;(pe||l.verifyClient===!0)&&q.length===0?l.error(l,{message:pe?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}}):q.length===0?l.expect=pe?S:x:(pe?l.session.serverCertificate=q[0]:l.session.clientCertificate=q[0],a.verifyCertificateChain(l,q)&&(l.expect=pe?S:x)),l.process()},a.handleServerKeyExchange=function(l,D,i){if(i>0)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});l.expect=m,l.process()},a.handleClientKeyExchange=function(l,D,i){if(i<48)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});var I=D.fragment,O={enc_pre_master_secret:d(I,2).getBytes()},G=null;if(l.getPrivateKey)try{G=l.getPrivateKey(l,l.session.serverCertificate),G=t.pki.privateKeyFromPem(G)}catch(pe){l.error(l,{message:"Could not get private key.",cause:pe,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}if(G===null)return l.error(l,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}});try{var M=l.session.sp;M.pre_master_secret=G.decrypt(O.enc_pre_master_secret);var q=l.session.clientHelloVersion;if(q.major!==M.pre_master_secret.charCodeAt(0)||q.minor!==M.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{M.pre_master_secret=t.random.getBytes(48)}l.expect=V,l.session.clientCertificate!==null&&(l.expect=B),l.process()},a.handleCertificateRequest=function(l,D,i){if(i<3)return l.error(l,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var I=D.fragment,O={certificate_types:d(I,1),certificate_authorities:d(I,2)};l.session.certificateRequest=O,l.expect=v,l.process()},a.handleCertificateVerify=function(l,D,i){if(i<2)return l.error(l,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var I=D.fragment;I.read-=4;var O=I.bytes();I.read+=4;var G={signature:d(I,2).getBytes()},M=t.util.createBuffer();M.putBuffer(l.session.md5.digest()),M.putBuffer(l.session.sha1.digest()),M=M.getBytes();try{var q=l.session.clientCertificate;if(!q.publicKey.verify(M,G.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");l.session.md5.update(O),l.session.sha1.update(O)}catch{return l.error(l,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure}})}l.expect=V,l.process()},a.handleServerHelloDone=function(l,D,i){if(i>0)return l.error(l,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.record_overflow}});if(l.serverCertificate===null){var I={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.insufficient_security}},O=0,G=l.verify(l,I.alert.description,O,[]);if(G!==!0)return(G||G===0)&&(typeof G=="object"&&!t.util.isArray(G)?(G.message&&(I.message=G.message),G.alert&&(I.alert.description=G.alert)):typeof G=="number"&&(I.alert.description=G)),l.error(l,I)}l.session.certificateRequest!==null&&(D=a.createRecord(l,{type:a.ContentType.handshake,data:a.createCertificate(l)}),a.queue(l,D)),D=a.createRecord(l,{type:a.ContentType.handshake,data:a.createClientKeyExchange(l)}),a.queue(l,D),l.expect=w;var M=function(q,pe){q.session.certificateRequest!==null&&q.session.clientCertificate!==null&&a.queue(q,a.createRecord(q,{type:a.ContentType.handshake,data:a.createCertificateVerify(q,pe)})),a.queue(q,a.createRecord(q,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),q.state.pending=a.createConnectionState(q),q.state.current.write=q.state.pending.write,a.queue(q,a.createRecord(q,{type:a.ContentType.handshake,data:a.createFinished(q)})),q.expect=A,a.flush(q),q.process()};if(l.session.certificateRequest===null||l.session.clientCertificate===null)return M(l,null);a.getClientSignature(l,M)},a.handleChangeCipherSpec=function(l,D){if(D.fragment.getByte()!==1)return l.error(l,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var i=l.entity===a.ConnectionEnd.client;(l.session.resuming&&i||!l.session.resuming&&!i)&&(l.state.pending=a.createConnectionState(l)),l.state.current.read=l.state.pending.read,(!l.session.resuming&&i||l.session.resuming&&!i)&&(l.state.pending=null),l.expect=i?f:c,l.process()},a.handleFinished=function(l,D,i){var I=D.fragment;I.read-=4;var O=I.bytes();I.read+=4;var G=D.fragment.getBytes();I=t.util.createBuffer(),I.putBuffer(l.session.md5.digest()),I.putBuffer(l.session.sha1.digest());var M=l.entity===a.ConnectionEnd.client,q=M?"server finished":"client finished",pe=l.session.sp,he=12,Z=e;if(I=Z(pe.master_secret,q,I.getBytes(),he),I.getBytes()!==G)return l.error(l,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decrypt_error}});l.session.md5.update(O),l.session.sha1.update(O),(l.session.resuming&&M||!l.session.resuming&&!M)&&(a.queue(l,a.createRecord(l,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),l.state.current.write=l.state.pending.write,l.state.pending=null,a.queue(l,a.createRecord(l,{type:a.ContentType.handshake,data:a.createFinished(l)}))),l.expect=M?g:y,l.handshaking=!1,++l.handshakes,l.peerCertificate=M?l.session.serverCertificate:l.session.clientCertificate,a.flush(l),l.isConnected=!0,l.connected(l),l.process()},a.handleAlert=function(l,D){var i=D.fragment,I={level:i.getByte(),description:i.getByte()},O;switch(I.description){case a.Alert.Description.close_notify:O="Connection closed.";break;case a.Alert.Description.unexpected_message:O="Unexpected message.";break;case a.Alert.Description.bad_record_mac:O="Bad record MAC.";break;case a.Alert.Description.decryption_failed:O="Decryption failed.";break;case a.Alert.Description.record_overflow:O="Record overflow.";break;case a.Alert.Description.decompression_failure:O="Decompression failed.";break;case a.Alert.Description.handshake_failure:O="Handshake failure.";break;case a.Alert.Description.bad_certificate:O="Bad certificate.";break;case a.Alert.Description.unsupported_certificate:O="Unsupported certificate.";break;case a.Alert.Description.certificate_revoked:O="Certificate revoked.";break;case a.Alert.Description.certificate_expired:O="Certificate expired.";break;case a.Alert.Description.certificate_unknown:O="Certificate unknown.";break;case a.Alert.Description.illegal_parameter:O="Illegal parameter.";break;case a.Alert.Description.unknown_ca:O="Unknown certificate authority.";break;case a.Alert.Description.access_denied:O="Access denied.";break;case a.Alert.Description.decode_error:O="Decode error.";break;case a.Alert.Description.decrypt_error:O="Decrypt error.";break;case a.Alert.Description.export_restriction:O="Export restriction.";break;case a.Alert.Description.protocol_version:O="Unsupported protocol version.";break;case a.Alert.Description.insufficient_security:O="Insufficient security.";break;case a.Alert.Description.internal_error:O="Internal error.";break;case a.Alert.Description.user_canceled:O="User canceled.";break;case a.Alert.Description.no_renegotiation:O="Renegotiation not supported.";break;default:O="Unknown error.";break}if(I.description===a.Alert.Description.close_notify)return l.close();l.error(l,{message:O,send:!1,origin:l.entity===a.ConnectionEnd.client?"server":"client",alert:I}),l.process()},a.handleHandshake=function(l,D){var i=D.fragment,I=i.getByte(),O=i.getInt24();if(O>i.length())return l.fragmented=D,D.fragment=t.util.createBuffer(),i.read-=4,l.process();l.fragmented=null,i.read-=4;var G=i.bytes(O+4);i.read+=4,I in ye[l.entity][l.expect]?(l.entity===a.ConnectionEnd.server&&!l.open&&!l.fail&&(l.handshaking=!0,l.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),I!==a.HandshakeType.hello_request&&I!==a.HandshakeType.certificate_verify&&I!==a.HandshakeType.finished&&(l.session.md5.update(G),l.session.sha1.update(G)),ye[l.entity][l.expect][I](l,D,O)):a.handleUnexpected(l,D)},a.handleApplicationData=function(l,D){l.data.putBuffer(D.fragment),l.dataReady(l),l.process()},a.handleHeartbeat=function(l,D){var i=D.fragment,I=i.getByte(),O=i.getInt16(),G=i.getBytes(O);if(I===a.HeartbeatMessageType.heartbeat_request){if(l.handshaking||O>G.length)return l.process();a.queue(l,a.createRecord(l,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_response,G)})),a.flush(l)}else if(I===a.HeartbeatMessageType.heartbeat_response){if(G!==l.expectedHeartbeatPayload)return l.process();l.heartbeatReceived&&l.heartbeatReceived(l,t.util.createBuffer(G))}l.process()};var o=0,E=1,S=2,m=3,v=4,A=5,f=6,g=7,w=8,n=0,u=1,x=2,B=3,V=4,c=5,y=6,N=7,r=a.handleUnexpected,L=a.handleChangeCipherSpec,K=a.handleAlert,U=a.handleHandshake,H=a.handleApplicationData,j=a.handleHeartbeat,z=[];z[a.ConnectionEnd.client]=[[r,K,U,r,j],[r,K,U,r,j],[r,K,U,r,j],[r,K,U,r,j],[r,K,U,r,j],[L,K,r,r,j],[r,K,U,r,j],[r,K,U,H,j],[r,K,U,r,j]],z[a.ConnectionEnd.server]=[[r,K,U,r,j],[r,K,U,r,j],[r,K,U,r,j],[r,K,U,r,j],[L,K,r,r,j],[r,K,U,r,j],[r,K,U,H,j],[r,K,U,r,j]];var Y=a.handleHelloRequest,X=a.handleServerHello,$=a.handleCertificate,te=a.handleServerKeyExchange,ge=a.handleCertificateRequest,Ee=a.handleServerHelloDone,Se=a.handleFinished,ye=[];ye[a.ConnectionEnd.client]=[[r,r,X,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,$,te,ge,Ee,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,te,ge,Ee,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,r,ge,Ee,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,r,r,Ee,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,Se],[Y,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[Y,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];var ie=a.handleClientHello,ae=a.handleClientKeyExchange,Be=a.handleCertificateVerify;ye[a.ConnectionEnd.server]=[[r,ie,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,$,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ae,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,Be,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,Se],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]],a.generateKeys=function(l,D){var i=e,I=D.client_random+D.server_random;l.session.resuming||(D.master_secret=i(D.pre_master_secret,"master secret",I,48).bytes(),D.pre_master_secret=null),I=D.server_random+D.client_random;var O=2*D.mac_key_length+2*D.enc_key_length,G=l.version.major===a.Versions.TLS_1_0.major&&l.version.minor===a.Versions.TLS_1_0.minor;G&&(O+=2*D.fixed_iv_length);var M=i(D.master_secret,"key expansion",I,O),q={client_write_MAC_key:M.getBytes(D.mac_key_length),server_write_MAC_key:M.getBytes(D.mac_key_length),client_write_key:M.getBytes(D.enc_key_length),server_write_key:M.getBytes(D.enc_key_length)};return G&&(q.client_write_IV=M.getBytes(D.fixed_iv_length),q.server_write_IV=M.getBytes(D.fixed_iv_length)),q},a.createConnectionState=function(l){var D=l.entity===a.ConnectionEnd.client,i=function(){var G={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(M){return!0},compressionState:null,compressFunction:function(M){return!0},updateSequenceNumber:function(){G.sequenceNumber[1]===4294967295?(G.sequenceNumber[1]=0,++G.sequenceNumber[0]):++G.sequenceNumber[1]}};return G},I={read:i(),write:i()};if(I.read.update=function(G,M){return I.read.cipherFunction(M,I.read)?I.read.compressFunction(G,M,I.read)||G.error(G,{message:"Could not decompress record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decompression_failure}}):G.error(G,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_record_mac}}),!G.fail},I.write.update=function(G,M){return I.write.compressFunction(G,M,I.write)?I.write.cipherFunction(M,I.write)||G.error(G,{message:"Could not encrypt record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):G.error(G,{message:"Could not compress record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}),!G.fail},l.session){var O=l.session.sp;switch(l.session.cipherSuite.initSecurityParameters(O),O.keys=a.generateKeys(l,O),I.read.macKey=D?O.keys.server_write_MAC_key:O.keys.client_write_MAC_key,I.write.macKey=D?O.keys.client_write_MAC_key:O.keys.server_write_MAC_key,l.session.cipherSuite.initConnectionState(I,l,O),O.compression_algorithm){case a.CompressionMethod.none:break;case a.CompressionMethod.deflate:I.read.compressFunction=T,I.write.compressFunction=C;break;default:throw new Error("Unsupported compression algorithm.")}}return I},a.createRandom=function(){var l=new Date,D=+l+l.getTimezoneOffset()*6e4,i=t.util.createBuffer();return i.putInt32(D),i.putBytes(t.random.getBytes(28)),i},a.createRecord=function(l,D){if(!D.data)return null;var i={type:D.type,version:{major:l.version.major,minor:l.version.minor},length:D.data.length(),fragment:D.data};return i},a.createAlert=function(l,D){var i=t.util.createBuffer();return i.putByte(D.level),i.putByte(D.description),a.createRecord(l,{type:a.ContentType.alert,data:i})},a.createClientHello=function(l){l.session.clientHelloVersion={major:l.version.major,minor:l.version.minor};for(var D=t.util.createBuffer(),i=0;i<l.cipherSuites.length;++i){var I=l.cipherSuites[i];D.putByte(I.id[0]),D.putByte(I.id[1])}var O=D.length(),G=t.util.createBuffer();G.putByte(a.CompressionMethod.none);var M=G.length(),q=t.util.createBuffer();if(l.virtualHost){var pe=t.util.createBuffer();pe.putByte(0),pe.putByte(0);var he=t.util.createBuffer();he.putByte(0),p(he,2,t.util.createBuffer(l.virtualHost));var Z=t.util.createBuffer();p(Z,2,he),p(pe,2,Z),q.putBuffer(pe)}var fe=q.length();fe>0&&(fe+=2);var me=l.session.id,be=me.length+1+2+4+28+2+O+1+M+fe,Ce=t.util.createBuffer();return Ce.putByte(a.HandshakeType.client_hello),Ce.putInt24(be),Ce.putByte(l.version.major),Ce.putByte(l.version.minor),Ce.putBytes(l.session.sp.client_random),p(Ce,1,t.util.createBuffer(me)),p(Ce,2,D),p(Ce,1,G),fe>0&&p(Ce,2,q),Ce},a.createServerHello=function(l){var D=l.session.id,i=D.length+1+2+4+28+2+1,I=t.util.createBuffer();return I.putByte(a.HandshakeType.server_hello),I.putInt24(i),I.putByte(l.version.major),I.putByte(l.version.minor),I.putBytes(l.session.sp.server_random),p(I,1,t.util.createBuffer(D)),I.putByte(l.session.cipherSuite.id[0]),I.putByte(l.session.cipherSuite.id[1]),I.putByte(l.session.compressionMethod),I},a.createCertificate=function(l){var D=l.entity===a.ConnectionEnd.client,i=null;if(l.getCertificate){var I;D?I=l.session.certificateRequest:I=l.session.extensions.server_name.serverNameList,i=l.getCertificate(l,I)}var O=t.util.createBuffer();if(i!==null)try{t.util.isArray(i)||(i=[i]);for(var G=null,M=0;M<i.length;++M){var q=t.pem.decode(i[M])[0];if(q.type!=="CERTIFICATE"&&q.type!=="X509 CERTIFICATE"&&q.type!=="TRUSTED CERTIFICATE"){var pe=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw pe.headerType=q.type,pe}if(q.procType&&q.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var he=t.util.createBuffer(q.body);G===null&&(G=t.asn1.fromDer(he.bytes(),!1));var Z=t.util.createBuffer();p(Z,3,he),O.putBuffer(Z)}i=t.pki.certificateFromAsn1(G),D?l.session.clientCertificate=i:l.session.serverCertificate=i}catch(be){return l.error(l,{message:"Could not send certificate list.",cause:be,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var fe=3+O.length(),me=t.util.createBuffer();return me.putByte(a.HandshakeType.certificate),me.putInt24(fe),p(me,3,O),me},a.createClientKeyExchange=function(l){var D=t.util.createBuffer();D.putByte(l.session.clientHelloVersion.major),D.putByte(l.session.clientHelloVersion.minor),D.putBytes(t.random.getBytes(46));var i=l.session.sp;i.pre_master_secret=D.getBytes();var I=l.session.serverCertificate.publicKey;D=I.encrypt(i.pre_master_secret);var O=D.length+2,G=t.util.createBuffer();return G.putByte(a.HandshakeType.client_key_exchange),G.putInt24(O),G.putInt16(D.length),G.putBytes(D),G},a.createServerKeyExchange=function(l){var D=0,i=t.util.createBuffer();return D>0&&(i.putByte(a.HandshakeType.server_key_exchange),i.putInt24(D)),i},a.getClientSignature=function(l,D){var i=t.util.createBuffer();i.putBuffer(l.session.md5.digest()),i.putBuffer(l.session.sha1.digest()),i=i.getBytes(),l.getSignature=l.getSignature||function(I,O,G){var M=null;if(I.getPrivateKey)try{M=I.getPrivateKey(I,I.session.clientCertificate),M=t.pki.privateKeyFromPem(M)}catch(q){I.error(I,{message:"Could not get private key.",cause:q,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}M===null?I.error(I,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):O=M.sign(O,null),G(I,O)},l.getSignature(l,i,D)},a.createCertificateVerify=function(l,D){var i=D.length+2,I=t.util.createBuffer();return I.putByte(a.HandshakeType.certificate_verify),I.putInt24(i),I.putInt16(D.length),I.putBytes(D),I},a.createCertificateRequest=function(l){var D=t.util.createBuffer();D.putByte(1);var i=t.util.createBuffer();for(var I in l.caStore.certs){var O=l.caStore.certs[I],G=t.pki.distinguishedNameToAsn1(O.subject),M=t.asn1.toDer(G);i.putInt16(M.length()),i.putBuffer(M)}var q=1+D.length()+2+i.length(),pe=t.util.createBuffer();return pe.putByte(a.HandshakeType.certificate_request),pe.putInt24(q),p(pe,1,D),p(pe,2,i),pe},a.createServerHelloDone=function(l){var D=t.util.createBuffer();return D.putByte(a.HandshakeType.server_hello_done),D.putInt24(0),D},a.createChangeCipherSpec=function(){var l=t.util.createBuffer();return l.putByte(1),l},a.createFinished=function(l){var D=t.util.createBuffer();D.putBuffer(l.session.md5.digest()),D.putBuffer(l.session.sha1.digest());var i=l.entity===a.ConnectionEnd.client,I=l.session.sp,O=12,G=e,M=i?"client finished":"server finished";D=G(I.master_secret,M,D.getBytes(),O);var q=t.util.createBuffer();return q.putByte(a.HandshakeType.finished),q.putInt24(D.length()),q.putBuffer(D),q},a.createHeartbeat=function(l,D,i){typeof i>"u"&&(i=D.length);var I=t.util.createBuffer();I.putByte(l),I.putInt16(i),I.putBytes(D);var O=I.length(),G=Math.max(16,O-i-3);return I.putBytes(t.random.getBytes(G)),I},a.queue=function(l,D){if(D&&!(D.fragment.length()===0&&(D.type===a.ContentType.handshake||D.type===a.ContentType.alert||D.type===a.ContentType.change_cipher_spec))){if(D.type===a.ContentType.handshake){var i=D.fragment.bytes();l.session.md5.update(i),l.session.sha1.update(i),i=null}var I;if(D.fragment.length()<=a.MaxFragment)I=[D];else{I=[];for(var O=D.fragment.bytes();O.length>a.MaxFragment;)I.push(a.createRecord(l,{type:D.type,data:t.util.createBuffer(O.slice(0,a.MaxFragment))})),O=O.slice(a.MaxFragment);O.length>0&&I.push(a.createRecord(l,{type:D.type,data:t.util.createBuffer(O)}))}for(var G=0;G<I.length&&!l.fail;++G){var M=I[G],q=l.state.current.write;q.update(l,M)&&l.records.push(M)}}},a.flush=function(l){for(var D=0;D<l.records.length;++D){var i=l.records[D];l.tlsData.putByte(i.type),l.tlsData.putByte(i.version.major),l.tlsData.putByte(i.version.minor),l.tlsData.putInt16(i.fragment.length()),l.tlsData.putBuffer(l.records[D].fragment)}return l.records=[],l.tlsDataReady(l)};var _e=function(l){switch(l){case!0:return!0;case t.pki.certificateError.bad_certificate:return a.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return a.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return a.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return a.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return a.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return a.Alert.Description.unknown_ca;default:return a.Alert.Description.bad_certificate}},Ie=function(l){switch(l){case!0:return!0;case a.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case a.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case a.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case a.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case a.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case a.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};a.verifyCertificateChain=function(l,D){try{var i={};for(var I in l.verifyOptions)i[I]=l.verifyOptions[I];i.verify=function(G,M,q){var pe=_e(G),he=l.verify(l,G,M,q);if(he!==!0){if(typeof he=="object"&&!t.util.isArray(he)){var Z=new Error("The application rejected the certificate.");throw Z.send=!0,Z.alert={level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate},he.message&&(Z.message=he.message),he.alert&&(Z.alert.description=he.alert),Z}he!==G&&(he=Ie(he))}return he},t.pki.verifyCertificateChain(l.caStore,D,i)}catch(G){var O=G;(typeof O!="object"||t.util.isArray(O))&&(O={send:!0,alert:{level:a.Alert.Level.fatal,description:_e(G)}}),"send"in O||(O.send=!0),"alert"in O||(O.alert={level:a.Alert.Level.fatal,description:_e(O.error)}),l.error(l,O)}return!l.fail},a.createSessionCache=function(l,D){var i=null;if(l&&l.getSession&&l.setSession&&l.order)i=l;else{i={},i.cache=l||{},i.capacity=Math.max(D||100,1),i.order=[];for(var I in l)i.order.length<=D?i.order.push(I):delete l[I];i.getSession=function(O){var G=null,M=null;if(O?M=t.util.bytesToHex(O):i.order.length>0&&(M=i.order[0]),M!==null&&M in i.cache){G=i.cache[M],delete i.cache[M];for(var q in i.order)if(i.order[q]===M){i.order.splice(q,1);break}}return G},i.setSession=function(O,G){if(i.order.length===i.capacity){var M=i.order.shift();delete i.cache[M]}var M=t.util.bytesToHex(O);i.order.push(M),i.cache[M]=G}}return i},a.createConnection=function(l){var D=null;l.caStore?t.util.isArray(l.caStore)?D=t.pki.createCaStore(l.caStore):D=l.caStore:D=t.pki.createCaStore();var i=l.cipherSuites||null;if(i===null){i=[];for(var I in a.CipherSuites)i.push(a.CipherSuites[I])}var O=l.server?a.ConnectionEnd.server:a.ConnectionEnd.client,G=l.sessionCache?a.createSessionCache(l.sessionCache):null,M={version:{major:a.Version.major,minor:a.Version.minor},entity:O,sessionId:l.sessionId,caStore:D,sessionCache:G,cipherSuites:i,connected:l.connected,virtualHost:l.virtualHost||null,verifyClient:l.verifyClient||!1,verify:l.verify||function(Z,fe,me,be){return fe},verifyOptions:l.verifyOptions||{},getCertificate:l.getCertificate||null,getPrivateKey:l.getPrivateKey||null,getSignature:l.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:l.tlsDataReady,dataReady:l.dataReady,heartbeatReceived:l.heartbeatReceived,closed:l.closed,error:function(Z,fe){fe.origin=fe.origin||(Z.entity===a.ConnectionEnd.client?"client":"server"),fe.send&&(a.queue(Z,a.createAlert(Z,fe.alert)),a.flush(Z));var me=fe.fatal!==!1;me&&(Z.fail=!0),l.error(Z,fe),me&&Z.close(!1)},deflate:l.deflate||null,inflate:l.inflate||null};M.reset=function(Z){M.version={major:a.Version.major,minor:a.Version.minor},M.record=null,M.session=null,M.peerCertificate=null,M.state={pending:null,current:null},M.expect=M.entity===a.ConnectionEnd.client?o:n,M.fragmented=null,M.records=[],M.open=!1,M.handshakes=0,M.handshaking=!1,M.isConnected=!1,M.fail=!(Z||typeof Z>"u"),M.input.clear(),M.tlsData.clear(),M.data.clear(),M.state.current=a.createConnectionState(M)},M.reset();var q=function(Z,fe){var me=fe.type-a.ContentType.change_cipher_spec,be=z[Z.entity][Z.expect];me in be?be[me](Z,fe):a.handleUnexpected(Z,fe)},pe=function(Z){var fe=0,me=Z.input,be=me.length();if(be<5)fe=5-be;else{Z.record={type:me.getByte(),version:{major:me.getByte(),minor:me.getByte()},length:me.getInt16(),fragment:t.util.createBuffer(),ready:!1};var Ce=Z.record.version.major===Z.version.major;Ce&&Z.session&&Z.session.version&&(Ce=Z.record.version.minor===Z.version.minor),Ce||Z.error(Z,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}})}return fe},he=function(Z){var fe=0,me=Z.input,be=me.length();if(be<Z.record.length)fe=Z.record.length-be;else{Z.record.fragment.putBytes(me.getBytes(Z.record.length)),me.compact();var Ce=Z.state.current.read;Ce.update(Z,Z.record)&&(Z.fragmented!==null&&(Z.fragmented.type===Z.record.type?(Z.fragmented.fragment.putBuffer(Z.record.fragment),Z.record=Z.fragmented):Z.error(Z,{message:"Invalid fragmented record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})),Z.record.ready=!0)}return fe};return M.handshake=function(Z){if(M.entity!==a.ConnectionEnd.client)M.error(M,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(M.handshaking)M.error(M,{message:"Handshake already in progress.",fatal:!1});else{M.fail&&!M.open&&M.handshakes===0&&(M.fail=!1),M.handshaking=!0,Z=Z||"";var fe=null;Z.length>0&&(M.sessionCache&&(fe=M.sessionCache.getSession(Z)),fe===null&&(Z="")),Z.length===0&&M.sessionCache&&(fe=M.sessionCache.getSession(),fe!==null&&(Z=fe.id)),M.session={id:Z,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},fe&&(M.version=fe.version,M.session.sp=fe.sp),M.session.sp.client_random=a.createRandom().getBytes(),M.open=!0,a.queue(M,a.createRecord(M,{type:a.ContentType.handshake,data:a.createClientHello(M)})),a.flush(M)}},M.process=function(Z){var fe=0;return Z&&M.input.putBytes(Z),M.fail||(M.record!==null&&M.record.ready&&M.record.fragment.isEmpty()&&(M.record=null),M.record===null&&(fe=pe(M)),!M.fail&&M.record!==null&&!M.record.ready&&(fe=he(M)),!M.fail&&M.record!==null&&M.record.ready&&q(M,M.record)),fe},M.prepare=function(Z){return a.queue(M,a.createRecord(M,{type:a.ContentType.application_data,data:t.util.createBuffer(Z)})),a.flush(M)},M.prepareHeartbeatRequest=function(Z,fe){return Z instanceof t.util.ByteBuffer&&(Z=Z.bytes()),typeof fe>"u"&&(fe=Z.length),M.expectedHeartbeatPayload=Z,a.queue(M,a.createRecord(M,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_request,Z,fe)})),a.flush(M)},M.close=function(Z){if(!M.fail&&M.sessionCache&&M.session){var fe={id:M.session.id,version:M.session.version,sp:M.session.sp};fe.sp.keys=null,M.sessionCache.setSession(fe.id,fe)}M.open&&(M.open=!1,M.input.clear(),(M.isConnected||M.handshaking)&&(M.isConnected=M.handshaking=!1,a.queue(M,a.createAlert(M,{level:a.Alert.Level.warning,description:a.Alert.Description.close_notify})),a.flush(M)),M.closed(M)),M.reset(Z)},M},re.exports=t.tls=t.tls||{};for(var Q in a)typeof a[Q]!="function"&&(t.tls[Q]=a[Q]);t.tls.prf_tls1=e,t.tls.hmac_sha1=s,t.tls.createSessionCache=a.createSessionCache,t.tls.createConnection=a.createConnection},7619:(re,xe,P)=>{var t=P(42363).Buffer,e=P(50276),h=P(44058),s=re.exports=e.util=e.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){s.nextTick=process.nextTick,typeof setImmediate=="function"?s.setImmediate=setImmediate:s.setImmediate=s.nextTick;return}if(typeof setImmediate=="function"){s.setImmediate=function(){return setImmediate.apply(void 0,arguments)},s.nextTick=function(N){return setImmediate(N)};return}if(s.setImmediate=function(N){setTimeout(N,0)},typeof window<"u"&&typeof window.postMessage=="function"){let N=function(r){if(r.source===window&&r.data===n){r.stopPropagation();var L=u.slice();u.length=0,L.forEach(function(K){K()})}};var y=N,n="forge.setImmediate",u=[];s.setImmediate=function(r){u.push(r),u.length===1&&window.postMessage(n,"*")},window.addEventListener("message",N,!0)}if(typeof MutationObserver<"u"){var x=Date.now(),B=!0,V=document.createElement("div"),u=[];new MutationObserver(function(){var r=u.slice();u.length=0,r.forEach(function(L){L()})}).observe(V,{attributes:!0});var c=s.setImmediate;s.setImmediate=function(r){Date.now()-x>15?(x=Date.now(),c(r)):(u.push(r),u.length===1&&V.setAttribute("a",B=!B))}}s.nextTick=s.setImmediate})(),s.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,s.globalScope=function(){return s.isNodejs?P.g:typeof self>"u"?window:self}(),s.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},s.isArrayBuffer=function(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer},s.isArrayBufferView=function(n){return n&&s.isArrayBuffer(n.buffer)&&n.byteLength!==void 0};function C(n){if(!(n===8||n===16||n===24||n===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+n)}s.ByteBuffer=T;function T(n){if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(s.isArrayBuffer(n)||s.isArrayBufferView(n))if(typeof t<"u"&&n instanceof t)this.data=n.toString("binary");else{var u=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,u)}catch{for(var x=0;x<u.length;++x)this.putByte(u[x])}}else(n instanceof T||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}s.ByteStringBuffer=T;var d=4096;s.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n,this._constructedStringLength>d&&(this.data.substr(0,1),this._constructedStringLength=0)},s.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},s.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},s.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))},s.ByteStringBuffer.prototype.fillWithByte=function(n,u){n=String.fromCharCode(n);for(var x=this.data;u>0;)u&1&&(x+=n),u>>>=1,u>0&&(n+=n);return this.data=x,this._optimizeConstructedString(u),this},s.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this},s.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(s.encodeUtf8(n))},s.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))},s.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))},s.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))},s.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))},s.ByteStringBuffer.prototype.putInt=function(n,u){C(u);var x="";do u-=8,x+=String.fromCharCode(n>>u&255);while(u>0);return this.putBytes(x)},s.ByteStringBuffer.prototype.putSignedInt=function(n,u){return n<0&&(n+=2<<u-1),this.putInt(n,u)},s.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())},s.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},s.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n},s.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n},s.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n},s.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n},s.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n},s.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n},s.ByteStringBuffer.prototype.getInt=function(n){C(n);var u=0;do u=(u<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return u},s.ByteStringBuffer.prototype.getSignedInt=function(n){var u=this.getInt(n),x=2<<n-2;return u>=x&&(u-=x<<1),u},s.ByteStringBuffer.prototype.getBytes=function(n){var u;return n?(n=Math.min(this.length(),n),u=this.data.slice(this.read,this.read+n),this.read+=n):n===0?u="":(u=this.read===0?this.data:this.data.slice(this.read),this.clear()),u},s.ByteStringBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},s.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)},s.ByteStringBuffer.prototype.setAt=function(n,u){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(u)+this.data.substr(this.read+n+1),this},s.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},s.ByteStringBuffer.prototype.copy=function(){var n=s.createBuffer(this.data);return n.read=this.read,n},s.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},s.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},s.ByteStringBuffer.prototype.truncate=function(n){var u=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,u),this.read=0,this},s.ByteStringBuffer.prototype.toHex=function(){for(var n="",u=this.read;u<this.data.length;++u){var x=this.data.charCodeAt(u);x<16&&(n+="0"),n+=x.toString(16)}return n},s.ByteStringBuffer.prototype.toString=function(){return s.decodeUtf8(this.bytes())};function p(n,u){u=u||{},this.read=u.readOffset||0,this.growSize=u.growSize||1024;var x=s.isArrayBuffer(n),B=s.isArrayBufferView(n);if(x||B){x?this.data=new DataView(n):this.data=new DataView(n.buffer,n.byteOffset,n.byteLength),this.write="writeOffset"in u?u.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,n!=null&&this.putBytes(n),"writeOffset"in u&&(this.write=u.writeOffset)}s.DataBuffer=p,s.DataBuffer.prototype.length=function(){return this.write-this.read},s.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},s.DataBuffer.prototype.accommodate=function(n,u){if(this.length()>=n)return this;u=Math.max(u||this.growSize,n);var x=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),B=new Uint8Array(this.length()+u);return B.set(x),this.data=new DataView(B.buffer),this},s.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this},s.DataBuffer.prototype.fillWithByte=function(n,u){this.accommodate(u);for(var x=0;x<u;++x)this.data.setUint8(n);return this},s.DataBuffer.prototype.putBytes=function(n,u){if(s.isArrayBufferView(n)){var x=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),B=x.byteLength-x.byteOffset;this.accommodate(B);var V=new Uint8Array(this.data.buffer,this.write);return V.set(x),this.write+=B,this}if(s.isArrayBuffer(n)){var x=new Uint8Array(n);this.accommodate(x.byteLength);var V=new Uint8Array(this.data.buffer);return V.set(x,this.write),this.write+=x.byteLength,this}if(n instanceof s.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&s.isArrayBufferView(n.data)){var x=new Uint8Array(n.data.byteLength,n.read,n.length());this.accommodate(x.byteLength);var V=new Uint8Array(n.data.byteLength,this.write);return V.set(x),this.write+=x.byteLength,this}if(n instanceof s.ByteStringBuffer&&(n=n.data,u="binary"),u=u||"binary",typeof n=="string"){var c;if(u==="hex")return this.accommodate(Math.ceil(n.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.hex.decode(n,c,this.write),this;if(u==="base64")return this.accommodate(Math.ceil(n.length/4)*3),c=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.base64.decode(n,c,this.write),this;if(u==="utf8"&&(n=s.encodeUtf8(n),u="binary"),u==="binary"||u==="raw")return this.accommodate(n.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.raw.decode(c),this;if(u==="utf16")return this.accommodate(n.length*2),c=new Uint16Array(this.data.buffer,this.write),this.write+=s.text.utf16.encode(c),this;throw new Error("Invalid encoding: "+u)}throw Error("Invalid parameter: "+n)},s.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this},s.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")},s.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this},s.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this},s.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this},s.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this},s.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this},s.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this},s.DataBuffer.prototype.putInt=function(n,u){C(u),this.accommodate(u/8);do u-=8,this.data.setInt8(this.write++,n>>u&255);while(u>0);return this},s.DataBuffer.prototype.putSignedInt=function(n,u){return C(u),this.accommodate(u/8),n<0&&(n+=2<<u-1),this.putInt(n,u)},s.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},s.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n},s.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n},s.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n},s.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n},s.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n},s.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n},s.DataBuffer.prototype.getInt=function(n){C(n);var u=0;do u=(u<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return u},s.DataBuffer.prototype.getSignedInt=function(n){var u=this.getInt(n),x=2<<n-2;return u>=x&&(u-=x<<1),u},s.DataBuffer.prototype.getBytes=function(n){var u;return n?(n=Math.min(this.length(),n),u=this.data.slice(this.read,this.read+n),this.read+=n):n===0?u="":(u=this.read===0?this.data:this.data.slice(this.read),this.clear()),u},s.DataBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)},s.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)},s.DataBuffer.prototype.setAt=function(n,u){return this.data.setUint8(n,u),this},s.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},s.DataBuffer.prototype.copy=function(){return new s.DataBuffer(this)},s.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),u=new Uint8Array(n.byteLength);u.set(n),this.data=new DataView(u),this.write-=this.read,this.read=0}return this},s.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},s.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this},s.DataBuffer.prototype.toHex=function(){for(var n="",u=this.read;u<this.data.byteLength;++u){var x=this.data.getUint8(u);x<16&&(n+="0"),n+=x.toString(16)}return n},s.DataBuffer.prototype.toString=function(n){var u=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return s.binary.raw.encode(u);if(n==="hex")return s.binary.hex.encode(u);if(n==="base64")return s.binary.base64.encode(u);if(n==="utf8")return s.text.utf8.decode(u);if(n==="utf16")return s.text.utf16.decode(u);throw new Error("Invalid encoding: "+n)},s.createBuffer=function(n,u){return u=u||"raw",n!==void 0&&u==="utf8"&&(n=s.encodeUtf8(n)),new s.ByteBuffer(n)},s.fillString=function(n,u){for(var x="";u>0;)u&1&&(x+=n),u>>>=1,u>0&&(n+=n);return x},s.xorBytes=function(n,u,x){for(var B="",V="",c="",y=0,N=0;x>0;--x,++y)V=n.charCodeAt(y)^u.charCodeAt(y),N>=10&&(B+=c,c="",N=0),c+=String.fromCharCode(V),++N;return B+=c,B},s.hexToBytes=function(n){var u="",x=0;for(n.length&!0&&(x=1,u+=String.fromCharCode(parseInt(n[0],16)));x<n.length;x+=2)u+=String.fromCharCode(parseInt(n.substr(x,2),16));return u},s.bytesToHex=function(n){return s.createBuffer(n).toHex()},s.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],E="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";s.encode64=function(n,u){for(var x="",B="",V,c,y,N=0;N<n.length;)V=n.charCodeAt(N++),c=n.charCodeAt(N++),y=n.charCodeAt(N++),x+=a.charAt(V>>2),x+=a.charAt((V&3)<<4|c>>4),isNaN(c)?x+="==":(x+=a.charAt((c&15)<<2|y>>6),x+=isNaN(y)?"=":a.charAt(y&63)),u&&x.length>u&&(B+=x.substr(0,u)+`\r
`,x=x.substr(u));return B+=x,B},s.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u="",x,B,V,c,y=0;y<n.length;)x=o[n.charCodeAt(y++)-43],B=o[n.charCodeAt(y++)-43],V=o[n.charCodeAt(y++)-43],c=o[n.charCodeAt(y++)-43],u+=String.fromCharCode(x<<2|B>>4),V!==64&&(u+=String.fromCharCode((B&15)<<4|V>>2),c!==64&&(u+=String.fromCharCode((V&3)<<6|c)));return u},s.encodeUtf8=function(n){return unescape(encodeURIComponent(n))},s.decodeUtf8=function(n){return decodeURIComponent(escape(n))},s.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:h.encode,decode:h.decode}},s.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)},s.binary.raw.decode=function(n,u,x){var B=u;B||(B=new Uint8Array(n.length)),x=x||0;for(var V=x,c=0;c<n.length;++c)B[V++]=n.charCodeAt(c);return u?V-x:B},s.binary.hex.encode=s.bytesToHex,s.binary.hex.decode=function(n,u,x){var B=u;B||(B=new Uint8Array(Math.ceil(n.length/2))),x=x||0;var V=0,c=x;for(n.length&1&&(V=1,B[c++]=parseInt(n[0],16));V<n.length;V+=2)B[c++]=parseInt(n.substr(V,2),16);return u?c-x:B},s.binary.base64.encode=function(n,u){for(var x="",B="",V,c,y,N=0;N<n.byteLength;)V=n[N++],c=n[N++],y=n[N++],x+=a.charAt(V>>2),x+=a.charAt((V&3)<<4|c>>4),isNaN(c)?x+="==":(x+=a.charAt((c&15)<<2|y>>6),x+=isNaN(y)?"=":a.charAt(y&63)),u&&x.length>u&&(B+=x.substr(0,u)+`\r
`,x=x.substr(u));return B+=x,B},s.binary.base64.decode=function(n,u,x){var B=u;B||(B=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),x=x||0;for(var V,c,y,N,r=0,L=x;r<n.length;)V=o[n.charCodeAt(r++)-43],c=o[n.charCodeAt(r++)-43],y=o[n.charCodeAt(r++)-43],N=o[n.charCodeAt(r++)-43],B[L++]=V<<2|c>>4,y!==64&&(B[L++]=(c&15)<<4|y>>2,N!==64&&(B[L++]=(y&3)<<6|N));return u?L-x:B.subarray(0,L)},s.binary.base58.encode=function(n,u){return s.binary.baseN.encode(n,E,u)},s.binary.base58.decode=function(n,u){return s.binary.baseN.decode(n,E,u)},s.text={utf8:{},utf16:{}},s.text.utf8.encode=function(n,u,x){n=s.encodeUtf8(n);var B=u;B||(B=new Uint8Array(n.length)),x=x||0;for(var V=x,c=0;c<n.length;++c)B[V++]=n.charCodeAt(c);return u?V-x:B},s.text.utf8.decode=function(n){return s.decodeUtf8(String.fromCharCode.apply(null,n))},s.text.utf16.encode=function(n,u,x){var B=u;B||(B=new Uint8Array(n.length*2));var V=new Uint16Array(B.buffer);x=x||0;for(var c=x,y=x,N=0;N<n.length;++N)V[y++]=n.charCodeAt(N),c+=2;return u?c-x:B},s.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n.buffer))},s.deflate=function(n,u,x){if(u=s.decode64(n.deflate(s.encode64(u)).rval),x){var B=2,V=u.charCodeAt(1);V&32&&(B=6),u=u.substring(B,u.length-4)}return u},s.inflate=function(n,u,x){var B=n.inflate(s.encode64(u)).rval;return B===null?null:s.decode64(B)};var S=function(n,u,x){if(!n)throw new Error("WebStorage not available.");var B;if(x===null?B=n.removeItem(u):(x=s.encode64(JSON.stringify(x)),B=n.setItem(u,x)),typeof B<"u"&&B.rval!==!0){var V=new Error(B.error.message);throw V.id=B.error.id,V.name=B.error.name,V}},m=function(n,u){if(!n)throw new Error("WebStorage not available.");var x=n.getItem(u);if(n.init)if(x.rval===null){if(x.error){var B=new Error(x.error.message);throw B.id=x.error.id,B.name=x.error.name,B}x=null}else x=x.rval;return x!==null&&(x=JSON.parse(s.decode64(x))),x},v=function(n,u,x,B){var V=m(n,u);V===null&&(V={}),V[x]=B,S(n,u,V)},A=function(n,u,x){var B=m(n,u);return B!==null&&(B=x in B?B[x]:null),B},f=function(n,u,x){var B=m(n,u);if(B!==null&&x in B){delete B[x];var V=!0;for(var c in B){V=!1;break}V&&(B=null),S(n,u,B)}},g=function(n,u){S(n,u,null)},w=function(n,u,x){var B=null;typeof x>"u"&&(x=["web","flash"]);var V,c=!1,y=null;for(var N in x){V=x[N];try{if(V==="flash"||V==="both"){if(u[0]===null)throw new Error("Flash local storage not available.");B=n.apply(this,u),c=V==="flash"}(V==="web"||V==="both")&&(u[0]=localStorage,B=n.apply(this,u),c=!0)}catch(r){y=r}if(c)break}if(!c)throw y;return B};s.setItem=function(n,u,x,B,V){w(v,arguments,V)},s.getItem=function(n,u,x,B){return w(A,arguments,B)},s.removeItem=function(n,u,x,B){w(f,arguments,B)},s.clearItems=function(n,u,x){w(g,arguments,x)},s.isEmpty=function(n){for(var u in n)if(n.hasOwnProperty(u))return!1;return!0},s.format=function(n){for(var u=/%./g,x,B,V=0,c=[],y=0;x=u.exec(n);){B=n.substring(y,u.lastIndex-2),B.length>0&&c.push(B),y=u.lastIndex;var N=x[0][1];switch(N){case"s":case"o":V<arguments.length?c.push(arguments[V+++1]):c.push("<?>");break;case"%":c.push("%");break;default:c.push("<%"+N+"?>")}}return c.push(n.substring(y)),c.join("")},s.formatNumber=function(n,u,x,B){var V=n,c=isNaN(u=Math.abs(u))?2:u,y=x===void 0?",":x,N=B===void 0?".":B,r=V<0?"-":"",L=parseInt(V=Math.abs(+V||0).toFixed(c),10)+"",K=L.length>3?L.length%3:0;return r+(K?L.substr(0,K)+N:"")+L.substr(K).replace(/(\d{3})(?=\d)/g,"$1"+N)+(c?y+Math.abs(V-L).toFixed(c).slice(2):"")},s.formatSize=function(n){return n>=1073741824?n=s.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?n=s.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?n=s.formatNumber(n/1024,0)+" KiB":n=s.formatNumber(n,0)+" bytes",n},s.bytesFromIP=function(n){return n.indexOf(".")!==-1?s.bytesFromIPv4(n):n.indexOf(":")!==-1?s.bytesFromIPv6(n):null},s.bytesFromIPv4=function(n){if(n=n.split("."),n.length!==4)return null;for(var u=s.createBuffer(),x=0;x<n.length;++x){var B=parseInt(n[x],10);if(isNaN(B))return null;u.putByte(B)}return u.getBytes()},s.bytesFromIPv6=function(n){var u=0;n=n.split(":").filter(function(y){return y.length===0&&++u,!0});for(var x=(8-n.length+u)*2,B=s.createBuffer(),V=0;V<8;++V){if(!n[V]||n[V].length===0){B.fillWithByte(0,x),x=0;continue}var c=s.hexToBytes(n[V]);c.length<2&&B.putByte(0),B.putBytes(c)}return B.getBytes()},s.bytesToIP=function(n){return n.length===4?s.bytesToIPv4(n):n.length===16?s.bytesToIPv6(n):null},s.bytesToIPv4=function(n){if(n.length!==4)return null;for(var u=[],x=0;x<n.length;++x)u.push(n.charCodeAt(x));return u.join(".")},s.bytesToIPv6=function(n){if(n.length!==16)return null;for(var u=[],x=[],B=0,V=0;V<n.length;V+=2){for(var c=s.bytesToHex(n[V]+n[V+1]);c[0]==="0"&&c!=="0";)c=c.substr(1);if(c==="0"){var y=x[x.length-1],N=u.length;!y||N!==y.end+1?x.push({start:N,end:N}):(y.end=N,y.end-y.start>x[B].end-x[B].start&&(B=x.length-1))}u.push(c)}if(x.length>0){var r=x[B];r.end-r.start>0&&(u.splice(r.start,r.end-r.start+1,""),r.start===0&&u.unshift(""),r.end===7&&u.push(""))}return u.join(":")},s.estimateCores=function(n,u){if(typeof n=="function"&&(u=n,n={}),n=n||{},"cores"in s&&!n.update)return u(null,s.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return s.cores=navigator.hardwareConcurrency,u(null,s.cores);if(typeof Worker>"u")return s.cores=1,u(null,s.cores);if(typeof Blob>"u")return s.cores=2,u(null,s.cores);var x=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(y){for(var N=Date.now(),r=N+4;Date.now()<r;);self.postMessage({st:N,et:r})})}.toString(),")()"],{type:"application/javascript"}));B([],5,16);function B(y,N,r){if(N===0){var L=Math.floor(y.reduce(function(K,U){return K+U},0)/y.length);return s.cores=Math.max(1,L),URL.revokeObjectURL(x),u(null,s.cores)}V(r,function(K,U){y.push(c(r,U)),B(y,N-1,r)})}function V(y,N){for(var r=[],L=[],K=0;K<y;++K){var U=new Worker(x);U.addEventListener("message",function(H){if(L.push(H.data),L.length===y){for(var j=0;j<y;++j)r[j].terminate();N(null,L)}}),r.push(U)}for(var K=0;K<y;++K)r[K].postMessage(K)}function c(y,N){for(var r=[],L=0;L<y;++L)for(var K=N[L],U=r[L]=[],H=0;H<y;++H)if(L!==H){var j=N[H];(K.st>j.st&&K.st<j.et||j.st>K.st&&j.st<K.et)&&U.push(H)}return r.reduce(function(z,Y){return Math.max(z,Y.length)},0)}}},66011:(re,xe,P)=>{var t=P(50276);P(39504),P(12746),P(19095),P(8106),P(41373),P(94037),P(2385),P(51417),P(15805),P(7619);var e=t.asn1,h=re.exports=t.pki=t.pki||{},s=h.oids,C={};C.CN=s.commonName,C.commonName="CN",C.C=s.countryName,C.countryName="C",C.L=s.localityName,C.localityName="L",C.ST=s.stateOrProvinceName,C.stateOrProvinceName="ST",C.O=s.organizationName,C.organizationName="O",C.OU=s.organizationalUnitName,C.organizationalUnitName="OU",C.E=s.emailAddress,C.emailAddress="E";var T=t.pki.rsa.publicKeyValidator,d={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},T,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},p={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},a={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},T,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},o={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[a,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};h.RDNAttributesAsArray=function(c,y){for(var N=[],r,L,K,U=0;U<c.value.length;++U){r=c.value[U];for(var H=0;H<r.value.length;++H)K={},L=r.value[H],K.type=e.derToOid(L.value[0].value),K.value=L.value[1].value,K.valueTagClass=L.value[1].type,K.type in s&&(K.name=s[K.type],K.name in C&&(K.shortName=C[K.name])),y&&(y.update(K.type),y.update(K.value)),N.push(K)}return N},h.CRIAttributesAsArray=function(c){for(var y=[],N=0;N<c.length;++N)for(var r=c[N],L=e.derToOid(r.value[0].value),K=r.value[1].value,U=0;U<K.length;++U){var H={};if(H.type=L,H.value=K[U].value,H.valueTagClass=K[U].type,H.type in s&&(H.name=s[H.type],H.name in C&&(H.shortName=C[H.name])),H.type===s.extensionRequest){H.extensions=[];for(var j=0;j<H.value.length;++j)H.extensions.push(h.certificateExtensionFromAsn1(H.value[j]))}y.push(H)}return y};function E(c,y){typeof y=="string"&&(y={shortName:y});for(var N=null,r,L=0;N===null&&L<c.attributes.length;++L)r=c.attributes[L],(y.type&&y.type===r.type||y.name&&y.name===r.name||y.shortName&&y.shortName===r.shortName)&&(N=r);return N}var S=function(c,y,N){var r={};if(c!==s["RSASSA-PSS"])return r;N&&(r={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var L={},K=[];if(!e.validate(y,p,L,K)){var U=new Error("Cannot read RSASSA-PSS parameter block.");throw U.errors=K,U}return L.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=e.derToOid(L.hashOid)),L.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=e.derToOid(L.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=e.derToOid(L.maskGenHashOid)),L.saltLength!==void 0&&(r.saltLength=L.saltLength.charCodeAt(0)),r},m=function(c){switch(s[c.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var y=new Error("Could not compute "+c.type+" digest. Unknown signature OID.");throw y.signatureOid=c.signatureOid,y}},v=function(c){var y=c.certificate,N;switch(y.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var r,L;if(r=s[y.signatureParameters.mgf.hash.algorithmOid],r===void 0||t.md[r]===void 0){var K=new Error("Unsupported MGF hash function.");throw K.oid=y.signatureParameters.mgf.hash.algorithmOid,K.name=r,K}if(L=s[y.signatureParameters.mgf.algorithmOid],L===void 0||t.mgf[L]===void 0){var K=new Error("Unsupported MGF function.");throw K.oid=y.signatureParameters.mgf.algorithmOid,K.name=L,K}if(L=t.mgf[L].create(t.md[r].create()),r=s[y.signatureParameters.hash.algorithmOid],r===void 0||t.md[r]===void 0){var K=new Error("Unsupported RSASSA-PSS hash function.");throw K.oid=y.signatureParameters.hash.algorithmOid,K.name=r,K}N=t.pss.create(t.md[r].create(),L,y.signatureParameters.saltLength);break}return y.publicKey.verify(c.md.digest().getBytes(),c.signature,N)};h.certificateFromPem=function(c,y,N){var r=t.pem.decode(c)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var L=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw L.headerType=r.type,L}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var K=e.fromDer(r.body,N);return h.certificateFromAsn1(K,y)},h.certificateToPem=function(c,y){var N={type:"CERTIFICATE",body:e.toDer(h.certificateToAsn1(c)).getBytes()};return t.pem.encode(N,{maxline:y})},h.publicKeyFromPem=function(c){var y=t.pem.decode(c)[0];if(y.type!=="PUBLIC KEY"&&y.type!=="RSA PUBLIC KEY"){var N=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw N.headerType=y.type,N}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=e.fromDer(y.body);return h.publicKeyFromAsn1(r)},h.publicKeyToPem=function(c,y){var N={type:"PUBLIC KEY",body:e.toDer(h.publicKeyToAsn1(c)).getBytes()};return t.pem.encode(N,{maxline:y})},h.publicKeyToRSAPublicKeyPem=function(c,y){var N={type:"RSA PUBLIC KEY",body:e.toDer(h.publicKeyToRSAPublicKey(c)).getBytes()};return t.pem.encode(N,{maxline:y})},h.getPublicKeyFingerprint=function(c,y){y=y||{};var N=y.md||t.md.sha1.create(),r=y.type||"RSAPublicKey",L;switch(r){case"RSAPublicKey":L=e.toDer(h.publicKeyToRSAPublicKey(c)).getBytes();break;case"SubjectPublicKeyInfo":L=e.toDer(h.publicKeyToAsn1(c)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+y.type+'".')}N.start(),N.update(L);var K=N.digest();if(y.encoding==="hex"){var U=K.toHex();return y.delimiter?U.match(/.{2}/g).join(y.delimiter):U}else{if(y.encoding==="binary")return K.getBytes();if(y.encoding)throw new Error('Unknown encoding "'+y.encoding+'".')}return K},h.certificationRequestFromPem=function(c,y,N){var r=t.pem.decode(c)[0];if(r.type!=="CERTIFICATE REQUEST"){var L=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw L.headerType=r.type,L}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var K=e.fromDer(r.body,N);return h.certificationRequestFromAsn1(K,y)},h.certificationRequestToPem=function(c,y){var N={type:"CERTIFICATE REQUEST",body:e.toDer(h.certificationRequestToAsn1(c)).getBytes()};return t.pem.encode(N,{maxline:y})},h.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(y){return E(c.issuer,y)},c.issuer.addField=function(y){g([y]),c.issuer.attributes.push(y)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(y){return E(c.subject,y)},c.subject.addField=function(y){g([y]),c.subject.attributes.push(y)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(y,N){g(y),c.subject.attributes=y,delete c.subject.uniqueId,N&&(c.subject.uniqueId=N),c.subject.hash=null},c.setIssuer=function(y,N){g(y),c.issuer.attributes=y,delete c.issuer.uniqueId,N&&(c.issuer.uniqueId=N),c.issuer.hash=null},c.setExtensions=function(y){for(var N=0;N<y.length;++N)w(y[N],{cert:c});c.extensions=y},c.getExtension=function(y){typeof y=="string"&&(y={name:y});for(var N=null,r,L=0;N===null&&L<c.extensions.length;++L)r=c.extensions[L],(y.id&&r.id===y.id||y.name&&r.name===y.name)&&(N=r);return N},c.sign=function(y,N){c.md=N||t.md.sha1.create();var r=s[c.md.algorithm+"WithRSAEncryption"];if(!r){var L=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw L.algorithm=c.md.algorithm,L}c.signatureOid=c.siginfo.algorithmOid=r,c.tbsCertificate=h.getTBSCertificate(c);var K=e.toDer(c.tbsCertificate);c.md.update(K.getBytes()),c.signature=y.sign(c.md)},c.verify=function(y){var N=!1;if(!c.issued(y)){var r=y.issuer,L=c.subject,K=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw K.expectedIssuer=L.attributes,K.actualIssuer=r.attributes,K}var U=y.md;if(U===null){U=m({signatureOid:y.signatureOid,type:"certificate"});var H=y.tbsCertificate||h.getTBSCertificate(y),j=e.toDer(H);U.update(j.getBytes())}return U!==null&&(N=v({certificate:c,md:U,signature:y.signature})),N},c.isIssuer=function(y){var N=!1,r=c.issuer,L=y.subject;if(r.hash&&L.hash)N=r.hash===L.hash;else if(r.attributes.length===L.attributes.length){N=!0;for(var K,U,H=0;N&&H<r.attributes.length;++H)K=r.attributes[H],U=L.attributes[H],(K.type!==U.type||K.value!==U.value)&&(N=!1)}return N},c.issued=function(y){return y.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return h.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var y=s.subjectKeyIdentifier,N=0;N<c.extensions.length;++N){var r=c.extensions[N];if(r.id===y){var L=c.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(r.subjectKeyIdentifier)===L}}return!1},c},h.certificateFromAsn1=function(c,y){var N={},r=[];if(!e.validate(c,d,N,r)){var L=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw L.errors=r,L}var K=e.derToOid(N.publicKeyOid);if(K!==h.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var U=h.createCertificate();U.version=N.certVersion?N.certVersion.charCodeAt(0):0;var H=t.util.createBuffer(N.certSerialNumber);U.serialNumber=H.toHex(),U.signatureOid=t.asn1.derToOid(N.certSignatureOid),U.signatureParameters=S(U.signatureOid,N.certSignatureParams,!0),U.siginfo.algorithmOid=t.asn1.derToOid(N.certinfoSignatureOid),U.siginfo.parameters=S(U.siginfo.algorithmOid,N.certinfoSignatureParams,!1),U.signature=N.certSignature;var j=[];if(N.certValidity1UTCTime!==void 0&&j.push(e.utcTimeToDate(N.certValidity1UTCTime)),N.certValidity2GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(N.certValidity2GeneralizedTime)),N.certValidity3UTCTime!==void 0&&j.push(e.utcTimeToDate(N.certValidity3UTCTime)),N.certValidity4GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(N.certValidity4GeneralizedTime)),j.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(j.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(U.validity.notBefore=j[0],U.validity.notAfter=j[1],U.tbsCertificate=N.tbsCertificate,y){U.md=m({signatureOid:U.signatureOid,type:"certificate"});var z=e.toDer(U.tbsCertificate);U.md.update(z.getBytes())}var Y=t.md.sha1.create(),X=e.toDer(N.certIssuer);Y.update(X.getBytes()),U.issuer.getField=function(ge){return E(U.issuer,ge)},U.issuer.addField=function(ge){g([ge]),U.issuer.attributes.push(ge)},U.issuer.attributes=h.RDNAttributesAsArray(N.certIssuer),N.certIssuerUniqueId&&(U.issuer.uniqueId=N.certIssuerUniqueId),U.issuer.hash=Y.digest().toHex();var $=t.md.sha1.create(),te=e.toDer(N.certSubject);return $.update(te.getBytes()),U.subject.getField=function(ge){return E(U.subject,ge)},U.subject.addField=function(ge){g([ge]),U.subject.attributes.push(ge)},U.subject.attributes=h.RDNAttributesAsArray(N.certSubject),N.certSubjectUniqueId&&(U.subject.uniqueId=N.certSubjectUniqueId),U.subject.hash=$.digest().toHex(),N.certExtensions?U.extensions=h.certificateExtensionsFromAsn1(N.certExtensions):U.extensions=[],U.publicKey=h.publicKeyFromAsn1(N.subjectPublicKeyInfo),U},h.certificateExtensionsFromAsn1=function(c){for(var y=[],N=0;N<c.value.length;++N)for(var r=c.value[N],L=0;L<r.value.length;++L)y.push(h.certificateExtensionFromAsn1(r.value[L]));return y},h.certificateExtensionFromAsn1=function(c){var y={};if(y.id=e.derToOid(c.value[0].value),y.critical=!1,c.value[1].type===e.Type.BOOLEAN?(y.critical=c.value[1].value.charCodeAt(0)!==0,y.value=c.value[2].value):y.value=c.value[1].value,y.id in s){if(y.name=s[y.id],y.name==="keyUsage"){var N=e.fromDer(y.value),r=0,L=0;N.value.length>1&&(r=N.value.charCodeAt(1),L=N.value.length>2?N.value.charCodeAt(2):0),y.digitalSignature=(r&128)===128,y.nonRepudiation=(r&64)===64,y.keyEncipherment=(r&32)===32,y.dataEncipherment=(r&16)===16,y.keyAgreement=(r&8)===8,y.keyCertSign=(r&4)===4,y.cRLSign=(r&2)===2,y.encipherOnly=(r&1)===1,y.decipherOnly=(L&128)===128}else if(y.name==="basicConstraints"){var N=e.fromDer(y.value);N.value.length>0&&N.value[0].type===e.Type.BOOLEAN?y.cA=N.value[0].value.charCodeAt(0)!==0:y.cA=!1;var K=null;N.value.length>0&&N.value[0].type===e.Type.INTEGER?K=N.value[0].value:N.value.length>1&&(K=N.value[1].value),K!==null&&(y.pathLenConstraint=e.derToInteger(K))}else if(y.name==="extKeyUsage")for(var N=e.fromDer(y.value),U=0;U<N.value.length;++U){var H=e.derToOid(N.value[U].value);H in s?y[s[H]]=!0:y[H]=!0}else if(y.name==="nsCertType"){var N=e.fromDer(y.value),r=0;N.value.length>1&&(r=N.value.charCodeAt(1)),y.client=(r&128)===128,y.server=(r&64)===64,y.email=(r&32)===32,y.objsign=(r&16)===16,y.reserved=(r&8)===8,y.sslCA=(r&4)===4,y.emailCA=(r&2)===2,y.objCA=(r&1)===1}else if(y.name==="subjectAltName"||y.name==="issuerAltName"){y.altNames=[];for(var j,N=e.fromDer(y.value),z=0;z<N.value.length;++z){j=N.value[z];var Y={type:j.type,value:j.value};switch(y.altNames.push(Y),j.type){case 1:case 2:case 6:break;case 7:Y.ip=t.util.bytesToIP(j.value);break;case 8:Y.oid=e.derToOid(j.value);break;default:}}}else if(y.name==="subjectKeyIdentifier"){var N=e.fromDer(y.value);y.subjectKeyIdentifier=t.util.bytesToHex(N.value)}}return y},h.certificationRequestFromAsn1=function(c,y){var N={},r=[];if(!e.validate(c,o,N,r)){var L=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw L.errors=r,L}var K=e.derToOid(N.publicKeyOid);if(K!==h.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var U=h.createCertificationRequest();if(U.version=N.csrVersion?N.csrVersion.charCodeAt(0):0,U.signatureOid=t.asn1.derToOid(N.csrSignatureOid),U.signatureParameters=S(U.signatureOid,N.csrSignatureParams,!0),U.siginfo.algorithmOid=t.asn1.derToOid(N.csrSignatureOid),U.siginfo.parameters=S(U.siginfo.algorithmOid,N.csrSignatureParams,!1),U.signature=N.csrSignature,U.certificationRequestInfo=N.certificationRequestInfo,y){U.md=m({signatureOid:U.signatureOid,type:"certification request"});var H=e.toDer(U.certificationRequestInfo);U.md.update(H.getBytes())}var j=t.md.sha1.create();return U.subject.getField=function(z){return E(U.subject,z)},U.subject.addField=function(z){g([z]),U.subject.attributes.push(z)},U.subject.attributes=h.RDNAttributesAsArray(N.certificationRequestInfoSubject,j),U.subject.hash=j.digest().toHex(),U.publicKey=h.publicKeyFromAsn1(N.subjectPublicKeyInfo),U.getAttribute=function(z){return E(U,z)},U.addAttribute=function(z){g([z]),U.attributes.push(z)},U.attributes=h.CRIAttributesAsArray(N.certificationRequestInfoAttributes||[]),U},h.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(y){return E(c.subject,y)},c.subject.addField=function(y){g([y]),c.subject.attributes.push(y)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(y){return E(c,y)},c.addAttribute=function(y){g([y]),c.attributes.push(y)},c.md=null,c.setSubject=function(y){g(y),c.subject.attributes=y,c.subject.hash=null},c.setAttributes=function(y){g(y),c.attributes=y},c.sign=function(y,N){c.md=N||t.md.sha1.create();var r=s[c.md.algorithm+"WithRSAEncryption"];if(!r){var L=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw L.algorithm=c.md.algorithm,L}c.signatureOid=c.siginfo.algorithmOid=r,c.certificationRequestInfo=h.getCertificationRequestInfo(c);var K=e.toDer(c.certificationRequestInfo);c.md.update(K.getBytes()),c.signature=y.sign(c.md)},c.verify=function(){var y=!1,N=c.md;if(N===null){N=m({signatureOid:c.signatureOid,type:"certification request"});var r=c.certificationRequestInfo||h.getCertificationRequestInfo(c),L=e.toDer(r);N.update(L.getBytes())}return N!==null&&(y=v({certificate:c,md:N,signature:c.signature})),y},c};function A(c){for(var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),N,r,L=c.attributes,K=0;K<L.length;++K){N=L[K];var U=N.value,H=e.Type.PRINTABLESTRING;"valueTagClass"in N&&(H=N.valueTagClass,H===e.Type.UTF8&&(U=t.util.encodeUtf8(U))),r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,H,!1,U)])]),y.value.push(r)}return y}function f(c){for(var y={},N=0;N<c.length;++N){var r=c[N];if(r.shortName&&(r.valueTagClass===e.Type.UTF8||r.valueTagClass===e.Type.PRINTABLESTRING||r.valueTagClass===e.Type.IA5STRING)){var L=r.value;r.valueTagClass===e.Type.UTF8&&(L=t.util.encodeUtf8(r.value)),r.shortName in y?t.util.isArray(y[r.shortName])?y[r.shortName].push(L):y[r.shortName]=[y[r.shortName],L]:y[r.shortName]=L}}return y}function g(c){for(var y,N=0;N<c.length;++N){if(y=c[N],typeof y.name>"u"&&(y.type&&y.type in h.oids?y.name=h.oids[y.type]:y.shortName&&y.shortName in C&&(y.name=h.oids[C[y.shortName]])),typeof y.type>"u")if(y.name&&y.name in h.oids)y.type=h.oids[y.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=y,r}if(typeof y.shortName>"u"&&y.name&&y.name in C&&(y.shortName=C[y.name]),y.type===s.extensionRequest&&(y.valueConstructed=!0,y.valueTagClass=e.Type.SEQUENCE,!y.value&&y.extensions)){y.value=[];for(var L=0;L<y.extensions.length;++L)y.value.push(h.certificateExtensionToAsn1(w(y.extensions[L])))}if(typeof y.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=y,r}}}function w(c,y){if(y=y||{},typeof c.name>"u"&&c.id&&c.id in h.oids&&(c.name=h.oids[c.id]),typeof c.id>"u")if(c.name&&c.name in h.oids)c.id=h.oids[c.name];else{var N=new Error("Extension ID not specified.");throw N.extension=c,N}if(typeof c.value<"u")return c;if(c.name==="keyUsage"){var r=0,L=0,K=0;c.digitalSignature&&(L|=128,r=7),c.nonRepudiation&&(L|=64,r=6),c.keyEncipherment&&(L|=32,r=5),c.dataEncipherment&&(L|=16,r=4),c.keyAgreement&&(L|=8,r=3),c.keyCertSign&&(L|=4,r=2),c.cRLSign&&(L|=2,r=1),c.encipherOnly&&(L|=1,r=0),c.decipherOnly&&(K|=128,r=7);var U=String.fromCharCode(r);K!==0?U+=String.fromCharCode(L)+String.fromCharCode(K):L!==0&&(U+=String.fromCharCode(L)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,U)}else if(c.name==="basicConstraints")c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),c.cA&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in c&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.pathLenConstraint).getBytes()));else if(c.name==="extKeyUsage"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=c.value.value;for(var j in c)c[j]===!0&&(j in s?H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s[j]).getBytes())):j.indexOf(".")!==-1&&H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(j).getBytes())))}else if(c.name==="nsCertType"){var r=0,L=0;c.client&&(L|=128,r=7),c.server&&(L|=64,r=6),c.email&&(L|=32,r=5),c.objsign&&(L|=16,r=4),c.reserved&&(L|=8,r=3),c.sslCA&&(L|=4,r=2),c.emailCA&&(L|=2,r=1),c.objCA&&(L|=1,r=0);var U=String.fromCharCode(r);L!==0&&(U+=String.fromCharCode(L)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,U)}else if(c.name==="subjectAltName"||c.name==="issuerAltName"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var z,Y=0;Y<c.altNames.length;++Y){z=c.altNames[Y];var U=z.value;if(z.type===7&&z.ip){if(U=t.util.bytesFromIP(z.ip),U===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=c,N}}else z.type===8&&(z.oid?U=e.oidToDer(e.oidToDer(z.oid)):U=e.oidToDer(U));c.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,z.type,!1,U))}}else if(c.name==="nsComment"&&y.cert){if(!/^[\x00-\x7F]*$/.test(c.comment)||c.comment.length<1||c.comment.length>128)throw new Error('Invalid "nsComment" content.');c.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,c.comment)}else if(c.name==="subjectKeyIdentifier"&&y.cert){var X=y.cert.generateSubjectKeyIdentifier();c.subjectKeyIdentifier=X.toHex(),c.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,X.getBytes())}else if(c.name==="authorityKeyIdentifier"&&y.cert){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=c.value.value;if(c.keyIdentifier){var $=c.keyIdentifier===!0?y.cert.generateSubjectKeyIdentifier().getBytes():c.keyIdentifier;H.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,$))}if(c.authorityCertIssuer){var te=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[A(c.authorityCertIssuer===!0?y.cert.issuer:c.authorityCertIssuer)])];H.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,te))}if(c.serialNumber){var ge=t.util.hexToBytes(c.serialNumber===!0?y.cert.serialNumber:c.serialNumber);H.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ge))}}else if(c.name==="cRLDistributionPoints"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H=c.value.value,Ee=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),Se=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),z,Y=0;Y<c.altNames.length;++Y){z=c.altNames[Y];var U=z.value;if(z.type===7&&z.ip){if(U=t.util.bytesFromIP(z.ip),U===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=c,N}}else z.type===8&&(z.oid?U=e.oidToDer(e.oidToDer(z.oid)):U=e.oidToDer(U));Se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,z.type,!1,U))}Ee.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[Se])),H.push(Ee)}if(typeof c.value>"u"){var N=new Error("Extension value not specified.");throw N.extension=c,N}return c}function n(c,y){switch(c){case s["RSASSA-PSS"]:var N=[];return y.hash.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),y.mgf.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),y.saltLength!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(y.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function u(c){var y=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(c.attributes.length===0)return y;for(var N=c.attributes,r=0;r<N.length;++r){var L=N[r],K=L.value,U=e.Type.UTF8;"valueTagClass"in L&&(U=L.valueTagClass),U===e.Type.UTF8&&(K=t.util.encodeUtf8(K));var H=!1;"valueConstructed"in L&&(H=L.valueConstructed);var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(L.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,U,H,K)])]);y.value.push(j)}return y}var x=new Date("1950-01-01T00:00:00Z"),B=new Date("2050-01-01T00:00:00Z");function V(c){return c>=x&&c<B?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(c)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(c))}h.getTBSCertificate=function(c){var y=V(c.validity.notBefore),N=V(c.validity.notAfter),r=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(c.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.siginfo.algorithmOid).getBytes()),n(c.siginfo.algorithmOid,c.siginfo.parameters)]),A(c.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[y,N]),A(c.subject),h.publicKeyToAsn1(c.publicKey)]);return c.issuer.uniqueId&&r.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.issuer.uniqueId)])),c.subject.uniqueId&&r.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.subject.uniqueId)])),c.extensions.length>0&&r.value.push(h.certificateExtensionsToAsn1(c.extensions)),r},h.getCertificationRequestInfo=function(c){var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),A(c.subject),h.publicKeyToAsn1(c.publicKey),u(c)]);return y},h.distinguishedNameToAsn1=function(c){return A(c)},h.certificateToAsn1=function(c){var y=c.tbsCertificate||h.getTBSCertificate(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[y,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),n(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},h.certificateExtensionsToAsn1=function(c){var y=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),N=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);y.value.push(N);for(var r=0;r<c.length;++r)N.value.push(h.certificateExtensionToAsn1(c[r]));return y},h.certificateExtensionToAsn1=function(c){var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);y.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.id).getBytes())),c.critical&&y.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF"));var N=c.value;return typeof c.value!="string"&&(N=e.toDer(N).getBytes()),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,N)),y},h.certificationRequestToAsn1=function(c){var y=c.certificationRequestInfo||h.getCertificationRequestInfo(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[y,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),n(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},h.createCaStore=function(c){var y={certs:{}};y.getIssuer=function(U){var H=N(U.issuer);return H},y.addCertificate=function(U){if(typeof U=="string"&&(U=t.pki.certificateFromPem(U)),r(U.subject),!y.hasCertificate(U))if(U.subject.hash in y.certs){var H=y.certs[U.subject.hash];t.util.isArray(H)||(H=[H]),H.push(U),y.certs[U.subject.hash]=H}else y.certs[U.subject.hash]=U},y.hasCertificate=function(U){typeof U=="string"&&(U=t.pki.certificateFromPem(U));var H=N(U.subject);if(!H)return!1;t.util.isArray(H)||(H=[H]);for(var j=e.toDer(h.certificateToAsn1(U)).getBytes(),z=0;z<H.length;++z){var Y=e.toDer(h.certificateToAsn1(H[z])).getBytes();if(j===Y)return!0}return!1},y.listAllCertificates=function(){var U=[];for(var H in y.certs)if(y.certs.hasOwnProperty(H)){var j=y.certs[H];if(!t.util.isArray(j))U.push(j);else for(var z=0;z<j.length;++z)U.push(j[z])}return U},y.removeCertificate=function(U){var H;if(typeof U=="string"&&(U=t.pki.certificateFromPem(U)),r(U.subject),!y.hasCertificate(U))return null;var j=N(U.subject);if(!t.util.isArray(j))return H=y.certs[U.subject.hash],delete y.certs[U.subject.hash],H;for(var z=e.toDer(h.certificateToAsn1(U)).getBytes(),Y=0;Y<j.length;++Y){var X=e.toDer(h.certificateToAsn1(j[Y])).getBytes();z===X&&(H=j[Y],j.splice(Y,1))}return j.length===0&&delete y.certs[U.subject.hash],H};function N(U){return r(U),y.certs[U.hash]||null}function r(U){if(!U.hash){var H=t.md.sha1.create();U.attributes=h.RDNAttributesAsArray(A(U),H),U.hash=H.digest().toHex()}}if(c)for(var L=0;L<c.length;++L){var K=c[L];y.addCertificate(K)}return y},h.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},h.verifyCertificateChain=function(c,y,N){typeof N=="function"&&(N={verify:N}),N=N||{},y=y.slice(0);var r=y.slice(0),L=N.validityCheckDate;typeof L>"u"&&(L=new Date);var K=!0,U=null,H=0;do{var j=y.shift(),z=null,Y=!1;if(L&&(L<j.validity.notBefore||L>j.validity.notAfter)&&(U={message:"Certificate is not valid yet or has expired.",error:h.certificateError.certificate_expired,notBefore:j.validity.notBefore,notAfter:j.validity.notAfter,now:L}),U===null){if(z=y[0]||c.getIssuer(j),z===null&&j.isIssuer(j)&&(Y=!0,z=j),z){var X=z;t.util.isArray(X)||(X=[X]);for(var $=!1;!$&&X.length>0;){z=X.shift();try{$=z.verify(j)}catch{}}$||(U={message:"Certificate signature is invalid.",error:h.certificateError.bad_certificate})}U===null&&(!z||Y)&&!c.hasCertificate(j)&&(U={message:"Certificate is not trusted.",error:h.certificateError.unknown_ca})}if(U===null&&z&&!j.isIssuer(z)&&(U={message:"Certificate issuer is invalid.",error:h.certificateError.bad_certificate}),U===null)for(var te={keyUsage:!0,basicConstraints:!0},ge=0;U===null&&ge<j.extensions.length;++ge){var Ee=j.extensions[ge];Ee.critical&&!(Ee.name in te)&&(U={message:"Certificate has an unsupported critical extension.",error:h.certificateError.unsupported_certificate})}if(U===null&&(!K||y.length===0&&(!z||Y))){var Se=j.getExtension("basicConstraints"),ye=j.getExtension("keyUsage");if(ye!==null&&(!ye.keyCertSign||Se===null)&&(U={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:h.certificateError.bad_certificate}),U===null&&Se!==null&&!Se.cA&&(U={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:h.certificateError.bad_certificate}),U===null&&ye!==null&&"pathLenConstraint"in Se){var ie=H-1;ie>Se.pathLenConstraint&&(U={message:"Certificate basicConstraints pathLenConstraint violated.",error:h.certificateError.bad_certificate})}}var ae=U===null?!0:U.error,Be=N.verify?N.verify(ae,H,r):ae;if(Be===!0)U=null;else throw ae===!0&&(U={message:"The application rejected the certificate.",error:h.certificateError.bad_certificate}),(Be||Be===0)&&(typeof Be=="object"&&!t.util.isArray(Be)?(Be.message&&(U.message=Be.message),Be.error&&(U.error=Be.error)):typeof Be=="string"&&(U.error=Be)),U;K=!1,++H}while(y.length>0);return!0}}}]);

//# sourceMappingURL=975.0c4fa75dac0fffa6f78e.js.map