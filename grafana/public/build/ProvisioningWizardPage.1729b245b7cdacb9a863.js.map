{"version":3,"file":"ProvisioningWizardPage.1729b245b7cdacb9a863.js","mappings":"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","sources":["webpack://grafana/./public/app/features/provisioning/Config/defaults.ts","webpack://grafana/./public/app/features/provisioning/Job/JobSummary.tsx","webpack://grafana/./public/app/features/provisioning/Shared/TokenPermissionsInfo.tsx","webpack://grafana/./public/app/features/provisioning/utils/getFormErrors.ts","webpack://grafana/./public/app/features/provisioning/Wizard/StepStatusContext.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/actions.ts","webpack://grafana/./public/app/features/provisioning/Wizard/BootstrapStep.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/ConnectStep.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/FinishStep.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/Stepper.tsx","webpack://grafana/./public/app/features/provisioning/Repository/RepositoryLink.tsx","webpack://grafana/./public/app/features/provisioning/Shared/ProgressBar.tsx","webpack://grafana/./public/app/features/provisioning/Job/JobContent.tsx","webpack://grafana/./public/app/features/provisioning/Job/FinishedJobStatus.tsx","webpack://grafana/./public/app/features/provisioning/Job/JobStatus.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/SynchronizeStep.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/ProvisioningWizard.tsx","webpack://grafana/./public/app/features/provisioning/Wizard/ConnectPage.tsx","webpack://grafana/./public/app/features/provisioning/hooks/useCreateOrUpdateRepository.ts","webpack://grafana/./public/app/features/provisioning/utils/data.ts"],"sourcesContent":["import { t } from '@grafana/i18n';\n\nimport { RepositorySpec } from '../../../api/clients/provisioning/v0alpha1';\nimport { RepositoryFormData } from '../types';\nimport { specToData } from '../utils/data';\n\nexport function getDefaultValues(repository?: RepositorySpec): RepositoryFormData {\n  if (!repository) {\n    return {\n      type: 'github',\n      title: t('provisioning.get-default-values.title.repository', 'Repository'),\n      token: '',\n      url: '',\n      branch: 'main',\n      generateDashboardPreviews: false,\n      readOnly: false,\n      prWorkflow: true,\n      path: 'grafana/',\n      sync: {\n        enabled: false,\n        target: 'instance',\n        intervalSeconds: 60,\n      },\n    };\n  }\n  return specToData(repository);\n}\n","import { InteractiveTable, Stack } from '@grafana/ui';\nimport { JobResourceSummary } from 'app/api/clients/provisioning/v0alpha1';\n\ntype SummaryCell<T extends keyof JobResourceSummary = keyof JobResourceSummary> = {\n  row: {\n    original: JobResourceSummary;\n  };\n};\n\nconst getSummaryColumns = () => [\n  {\n    id: 'resource',\n    header: 'Resource',\n    cell: ({ row: { original: item } }: SummaryCell) => item.resource,\n  },\n  {\n    id: 'created',\n    header: 'Created',\n    cell: ({ row: { original: item } }: SummaryCell) => item.create?.toString() || '-',\n  },\n  {\n    id: 'deleted',\n    header: 'Deleted',\n    cell: ({ row: { original: item } }: SummaryCell) => item.delete?.toString() || '-',\n  },\n  {\n    id: 'updated',\n    header: 'Updated',\n    cell: ({ row: { original: item } }: SummaryCell) => item.update?.toString() || '-',\n  },\n  {\n    id: 'unchanged',\n    header: 'Unchanged',\n    cell: ({ row: { original: item } }: SummaryCell) => item.noop?.toString() || '-',\n  },\n  {\n    id: 'errors',\n    header: 'Errors',\n    cell: ({ row: { original: item } }: SummaryCell) => item.error?.toString() || '-',\n  },\n  {\n    id: 'total',\n    header: 'Total',\n    cell: ({ row: { original: item } }: SummaryCell) => {\n      const total = (item.create || 0) + (item.delete || 0) + (item.update || 0) + (item.noop || 0) + (item.error || 0);\n      return total.toString();\n    },\n  },\n];\n\ninterface Props {\n  summary: JobResourceSummary[];\n}\n\nexport function JobSummary({ summary }: Props) {\n  return (\n    <Stack direction=\"column\" gap={2}>\n      <InteractiveTable\n        data={summary}\n        columns={getSummaryColumns()}\n        getRowId={(item) => item.resource || ''}\n        pageSize={10}\n      />\n    </Stack>\n  );\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Trans } from '@grafana/i18n';\nimport { Stack, TextLink, useStyles2 } from '@grafana/ui';\n\nexport function TokenPermissionsInfo() {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.container}>\n      {/* GitHub UI is English only, so these strings are not translated */}\n      {/* eslint-disable @grafana/i18n/no-untranslated-strings */}\n      <Stack gap={0.5} wrap={'wrap'}>\n        <Trans i18nKey=\"provisioning.token-permissions-info.go-to\">Go to</Trans>\n        <TextLink external href=\"https://github.com/settings/personal-access-tokens/new\">\n          GitHub Personal Access Tokens\n        </TextLink>\n        <Trans i18nKey=\"provisioning.token-permissions-info.and-click\">and click</Trans>\n        <strong>\"Fine-grained token\".</strong>\n        <Trans i18nKey=\"provisioning.token-permissions-info.make-sure\">Make sure to include these permissions</Trans>:\n      </Stack>\n      {/* eslint-enable @grafana/i18n/no-untranslated-strings */}\n\n      <ul className={styles.permissionsList}>\n        {/* eslint-disable-next-line @grafana/i18n/no-untranslated-strings */}\n        <li>\n          Content: <span className={styles.accessLevel}>Read and write</span>\n        </li>\n        {/* eslint-disable-next-line @grafana/i18n/no-untranslated-strings */}\n        <li>\n          Metadata: <span className={styles.accessLevel}>Read only</span>\n        </li>\n        {/* eslint-disable-next-line @grafana/i18n/no-untranslated-strings */}\n        <li>\n          Pull requests: <span className={styles.accessLevel}>Read and write</span>\n        </li>\n        {/* eslint-disable-next-line @grafana/i18n/no-untranslated-strings */}\n        <li>\n          Webhooks: <span className={styles.accessLevel}>Read and write</span>\n        </li>\n      </ul>\n    </div>\n  );\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    container: css({\n      marginBottom: theme.spacing(1),\n      position: 'relative',\n      width: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      flex: '1 1 0',\n      padding: theme.spacing(theme.components.panel.padding),\n    }),\n    permissionsList: css({\n      marginTop: theme.spacing(2),\n      marginBottom: theme.spacing(1),\n      paddingLeft: theme.spacing(3),\n\n      li: css({\n        marginBottom: theme.spacing(1),\n      }),\n    }),\n    accessLevel: css({\n      fontFamily: theme.typography.fontFamilyMonospace,\n      background: theme.colors.background.secondary,\n      borderRadius: theme.shape.radius.default,\n      padding: theme.spacing(0.25, 0.5),\n    }),\n  };\n}\n","import { ErrorDetails } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { WizardFormData } from '../Wizard/types';\n\nexport type RepositoryField = keyof WizardFormData['repository'];\nexport type RepositoryFormPath = `repository.${RepositoryField}`;\nexport type FormErrorTuple = [RepositoryFormPath | null, { message: string } | null];\n\n/**\n * Maps API error details to form error fields for React Hook Form\n *\n * @param errors Array of error details from the API response\n * @returns Tuple with form field path and error message\n */\nexport const getFormErrors = (errors: ErrorDetails[]): FormErrorTuple => {\n  const fieldsToValidate = ['local.path', 'github.branch', 'github.url', 'github.token'];\n  const fieldMap: Record<string, RepositoryFormPath> = {\n    path: 'repository.path',\n    branch: 'repository.branch',\n    url: 'repository.url',\n    token: 'repository.token',\n  };\n\n  for (const error of errors) {\n    if (error.field) {\n      const cleanField = error.field.replace('spec.', '');\n      if (fieldsToValidate.includes(cleanField)) {\n        const fieldParts = cleanField.split('.');\n        const lastPart = fieldParts[fieldParts.length - 1];\n\n        if (lastPart in fieldMap) {\n          return [fieldMap[lastPart], { message: error.detail || `Invalid ${lastPart}` }];\n        }\n      }\n    }\n  }\n\n  return [null, null];\n};\n","import { createContext, useContext, useState, useCallback, PropsWithChildren } from 'react';\n\nimport { StepStatusInfo } from './types';\n\ninterface StepStatusContextData {\n  // Current status\n  stepStatusInfo: StepStatusInfo;\n\n  // Status setters\n  setStepStatusInfo: (info: StepStatusInfo) => void;\n\n  // Computed status checks\n  hasStepError: boolean;\n  isStepRunning: boolean;\n  isStepSuccess: boolean;\n  isStepIdle: boolean;\n}\n\nconst StepStatusContext = createContext<StepStatusContextData | undefined>(undefined);\n\nexport const StepStatusProvider = ({ children }: PropsWithChildren) => {\n  const [stepStatusInfo, setStepStatusInfoState] = useState<StepStatusInfo>({ status: 'idle' });\n\n  const setStepStatusInfo = useCallback((info: StepStatusInfo) => {\n    setStepStatusInfoState(info);\n  }, []);\n\n  const value: StepStatusContextData = {\n    stepStatusInfo,\n    setStepStatusInfo,\n    hasStepError: stepStatusInfo.status === 'error',\n    isStepRunning: stepStatusInfo.status === 'running',\n    isStepSuccess: stepStatusInfo.status === 'success',\n    isStepIdle: stepStatusInfo.status === 'idle',\n  };\n\n  return <StepStatusContext.Provider value={value}>{children}</StepStatusContext.Provider>;\n};\n\nexport const useStepStatus = () => {\n  const context = useContext(StepStatusContext);\n\n  if (context === undefined) {\n    throw new Error('useStepStatus must be used within a StepStatusProvider');\n  }\n\n  return context;\n};\n","import { useMemo } from 'react';\n\nimport { t } from '@grafana/i18n';\nimport {\n  GetRepositoryFilesApiResponse,\n  GetResourceStatsApiResponse,\n  RepositoryViewList,\n} from 'app/api/clients/provisioning/v0alpha1';\n\nimport { ModeOption } from './types';\n\n/**\n * Filters available mode options based on system state\n */\nfunction filterModeOptions(modeOptions: ModeOption[], repoName: string, settings?: RepositoryViewList): ModeOption[] {\n  const folderConnected = settings?.items?.some((item) => item.target === 'folder' && item.name !== repoName);\n\n  return modeOptions.filter((option) => {\n    if (settings?.legacyStorage) {\n      return option.target === 'instance';\n    }\n\n    if (option.target === 'folder') {\n      return true;\n    }\n\n    if (option.target === 'instance') {\n      return !folderConnected;\n    }\n\n    return false;\n  });\n}\n\n/**\n * Hook that provides filtered mode options\n * This needs to be a hook, so we can add translations\n */\nexport function useModeOptions(repoName: string, settings?: RepositoryViewList) {\n  return useMemo(() => {\n    const modeOptions: ModeOption[] = [\n      {\n        target: 'instance',\n        label: t('provisioning.mode-options.instance.label', 'Sync all resources with external storage'),\n        description: t(\n          'provisioning.mode-options.instance.description',\n          'Resources will be synced with external storage and provisioned into this instance. Existing Grafana resources will be migrated and merged if needed. After setup, all new resources and changes will be saved to external storage and automatically provisioned back into the instance.'\n        ),\n        subtitle: t(\n          'provisioning.mode-options.instance.subtitle',\n          'Use this option if you want to sync and manage your entire Grafana instance through external storage.'\n        ),\n      },\n      {\n        target: 'folder',\n        label: t('provisioning.mode-options.folder.label', 'Sync external storage to a new Grafana folder'),\n        description: t(\n          'provisioning.mode-options.folder.description',\n          'After setup, a new Grafana folder will be created and synced with external storage. If any resources are present in external storage, they will be provisioned to this new folder. All new resources created in this folder will be stored and versioned in external storage.'\n        ),\n        subtitle: t(\n          'provisioning.mode-options.folder.subtitle',\n          'Use this option to sync external resources into a new folder without affecting the rest of your instance. You can repeat this process for up to 10 folders.'\n        ),\n      },\n    ];\n\n    return filterModeOptions(modeOptions, repoName, settings);\n  }, [repoName, settings]);\n}\n\nexport function getResourceStats(files?: GetRepositoryFilesApiResponse, stats?: GetResourceStatsApiResponse) {\n  const fileCount =\n    files?.items?.reduce((count, file) => {\n      const path = file.path ?? '';\n      return path.endsWith('.json') || path.endsWith('.yaml') ? count + 1 : count;\n    }, 0) ?? 0;\n\n  let counts: string[] = [];\n  let resourceCount = 0;\n\n  stats?.instance?.forEach((stat) => {\n    switch (stat.group) {\n      case 'folders':\n      case 'folder.grafana.app':\n        resourceCount += stat.count;\n        counts.push(`${stat.count} ${stat.count > 1 ? 'folders' : 'folder'}`);\n        break;\n      case 'dashboard.grafana.app':\n        resourceCount += stat.count;\n        counts.push(`${stat.count} ${stat.count > 1 ? 'dashboards' : 'dashboard'}`);\n        break;\n    }\n  });\n\n  return {\n    fileCount,\n    resourceCount,\n    resourceCountString: counts.join(',\\n'),\n  };\n}\n","import { useEffect, useMemo } from 'react';\nimport { Controller, useFormContext } from 'react-hook-form';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Box, Card, Field, Input, LoadingPlaceholder, Stack, Text } from '@grafana/ui';\nimport {\n  RepositoryViewList,\n  useGetRepositoryFilesQuery,\n  useGetResourceStatsQuery,\n} from 'app/api/clients/provisioning/v0alpha1';\n\nimport { useStepStatus } from './StepStatusContext';\nimport { getResourceStats, useModeOptions } from './actions';\nimport { WizardFormData } from './types';\n\nexport interface Props {\n  onOptionSelect: (requiresMigration: boolean) => void;\n  settingsData?: RepositoryViewList;\n  repoName: string;\n}\n\nexport function BootstrapStep({ onOptionSelect, settingsData, repoName }: Props) {\n  const { setStepStatusInfo } = useStepStatus();\n  const {\n    register,\n    control,\n    setValue,\n    watch,\n    getValues,\n    formState: { errors },\n  } = useFormContext<WizardFormData>();\n\n  const resourceStats = useGetResourceStatsQuery();\n  const filesQuery = useGetRepositoryFilesQuery({ name: repoName });\n  const selectedTarget = watch('repository.sync.target');\n  const options = useModeOptions(repoName, settingsData);\n  const { target } = options[0];\n  const { resourceCount, resourceCountString, fileCount } = useMemo(\n    () => getResourceStats(filesQuery.data, resourceStats.data),\n    [filesQuery.data, resourceStats.data]\n  );\n  const requiresMigration = settingsData?.legacyStorage || resourceCount > 0;\n  const isLoading = resourceStats.isLoading || filesQuery.isLoading;\n\n  useEffect(() => {\n    // Pick a name nice name based on type+settings\n    const repository = getValues('repository');\n    switch (repository.type) {\n      case 'github':\n        const name = repository.url ?? 'github';\n        setValue('repository.title', name.replace('https://github.com/', ''));\n        break;\n      case 'local':\n        setValue('repository.title', repository.path ?? 'local');\n        break;\n    }\n  }, [getValues, setValue]);\n\n  useEffect(() => {\n    setStepStatusInfo({ status: isLoading ? 'running' : 'idle' });\n  }, [isLoading, setStepStatusInfo]);\n\n  useEffect(() => {\n    setValue('repository.sync.target', target);\n    onOptionSelect(requiresMigration);\n  }, [target, setValue, onOptionSelect, requiresMigration]);\n\n  if (isLoading) {\n    return (\n      <Box padding={4}>\n        <LoadingPlaceholder\n          text={t('provisioning.bootstrap-step.text-loading-resource-information', 'Loading resource information...')}\n        />\n      </Box>\n    );\n  }\n\n  return (\n    <Stack direction=\"column\" gap={2}>\n      <Stack direction=\"column\" gap={2}>\n        <Box alignItems=\"center\" padding={4}>\n          <Stack direction=\"row\" gap={4} alignItems=\"flex-start\" justifyContent=\"center\">\n            <Stack direction=\"column\" gap={1} alignItems=\"center\">\n              <Text color=\"secondary\">\n                <Trans i18nKey=\"provisioning.bootstrap-step.grafana\">Grafana instance</Trans>\n              </Text>\n              <Stack direction=\"row\" gap={2}>\n                <Text variant=\"h4\">\n                  {resourceCount > 0 ? resourceCountString : t('provisioning.bootstrap-step.empty', 'Empty')}\n                </Text>\n              </Stack>\n            </Stack>\n            <Stack direction=\"column\" gap={1} alignItems=\"center\">\n              <Text color=\"secondary\">\n                <Trans i18nKey=\"provisioning.bootstrap-step.ext-storage\">External storage</Trans>\n              </Text>\n              <Text variant=\"h4\">\n                {fileCount > 0\n                  ? t('provisioning.bootstrap-step.files-count', '{{count}} files', { count: fileCount })\n                  : t('provisioning.bootstrap-step.empty', 'Empty')}\n              </Text>\n            </Stack>\n          </Stack>\n        </Box>\n\n        <Controller\n          name=\"repository.sync.target\"\n          control={control}\n          render={({ field: { ref, onChange, ...field } }) => (\n            <>\n              {options.map((action) => (\n                <Card\n                  key={action.target}\n                  isSelected={action.target === selectedTarget}\n                  onClick={() => {\n                    onChange(action.target);\n                  }}\n                  noMargin\n                  {...field}\n                >\n                  <Card.Heading>{action.label}</Card.Heading>\n                  <Card.Description>\n                    <Stack direction=\"column\" gap={3}>\n                      {action.description}\n                      <Text color=\"primary\">{action.subtitle}</Text>\n                    </Stack>\n                  </Card.Description>\n                </Card>\n              ))}\n            </>\n          )}\n        />\n\n        {/* Only show title field if folder sync */}\n        {selectedTarget === 'folder' && (\n          <Field\n            label={t('provisioning.bootstrap-step.label-display-name', 'Display name')}\n            description={t(\n              'provisioning.bootstrap-step.description-clear-repository-connection',\n              'Add a clear name for this repository connection'\n            )}\n            error={errors.repository?.title?.message}\n            invalid={!!errors.repository?.title}\n            required\n            noMargin\n          >\n            <Input\n              id=\"repository-title\"\n              {...register('repository.title', {\n                required: t('provisioning.bootstrap-step.error-field-required', 'This field is required.'),\n              })}\n              placeholder={t(\n                'provisioning.bootstrap-step.placeholder-my-repository-connection',\n                'My repository connection'\n              )}\n              // Autofocus the title field if it's the only available option\n              autoFocus={options.length === 1 && options[0].target === 'folder'}\n            />\n          </Field>\n        )}\n      </Stack>\n    </Stack>\n  );\n}\n","import { useState } from 'react';\nimport { Controller, useFormContext } from 'react-hook-form';\n\nimport { t } from '@grafana/i18n';\nimport { Field, Input, SecretInput, Stack } from '@grafana/ui';\n\nimport { TokenPermissionsInfo } from '../Shared/TokenPermissionsInfo';\n\nimport { WizardFormData } from './types';\n\nexport function ConnectStep() {\n  const {\n    register,\n    control,\n    setValue,\n    formState: { errors },\n    getValues,\n  } = useFormContext<WizardFormData>();\n\n  const [tokenConfigured, setTokenConfigured] = useState(false);\n\n  const type = getValues('repository.type');\n  const isGithub = type === 'github';\n\n  return (\n    <Stack direction=\"column\">\n      {isGithub && (\n        <>\n          <TokenPermissionsInfo />\n          <Field\n            noMargin\n            label={t('provisioning.connect-step.label-access-token', 'GitHub access token')}\n            required\n            description={t(\n              'provisioning.connect-step.description-paste-your-git-hub-personal-access-token',\n              'Paste your GitHub personal access token'\n            )}\n            error={errors.repository?.token?.message}\n            invalid={!!errors.repository?.token}\n          >\n            <Controller\n              name={'repository.token'}\n              control={control}\n              rules={{ required: t('provisioning.connect-step.error-field-required', 'This field is required.') }}\n              render={({ field: { ref, ...field } }) => {\n                return (\n                  <SecretInput\n                    {...field}\n                    id={'token'}\n                    placeholder={t(\n                      'provisioning.connect-step.placeholder-github-token',\n                      'github_pat_yourTokenHere1234567890abcdEFGHijklMNOP'\n                    )}\n                    isConfigured={tokenConfigured}\n                    onReset={() => {\n                      setValue('repository.token', '');\n                      setTokenConfigured(false);\n                    }}\n                  />\n                );\n              }}\n            />\n          </Field>\n\n          <Field\n            noMargin\n            label={t('provisioning.connect-step.label-repository-url', 'GitHub repository URL')}\n            error={errors.repository?.url?.message}\n            invalid={!!errors.repository?.url}\n            description={t(\n              'provisioning.connect-step.description-repository-url',\n              'Paste the URL of your GitHub repository'\n            )}\n            required\n          >\n            <Input\n              {...register('repository.url', {\n                required: t('provisioning.connect-step.error-field-required', 'This field is required.'),\n                pattern: {\n                  // TODO: The regex is not correct when we support GHES.\n                  value: /^(?:https:\\/\\/github\\.com\\/)?[^/]+\\/[^/]+$/,\n                  message: t(\n                    'provisioning.connect-step.error-invalid-github-url',\n                    'Please enter a valid GitHub repository URL'\n                  ),\n                },\n              })}\n              id={'repository-url'}\n              placeholder={t('provisioning.connect-step.placeholder-github-url', 'https://github.com/username/repo')}\n            />\n          </Field>\n\n          <Field\n            noMargin\n            label={t('provisioning.connect-step.label-branch', 'Branch name')}\n            description={t('provisioning.connect-step.description-branch', 'Branch to use for the GitHub repository')}\n            error={errors.repository?.branch?.message}\n            invalid={!!errors.repository?.branch}\n          >\n            <Input\n              {...register('repository.branch')}\n              id={'repository-branch'}\n              placeholder={t('provisioning.connect-step.placeholder-branch', 'main')}\n            />\n          </Field>\n\n          <Field\n            noMargin\n            label={t('provisioning.connect-step.label-path', 'Path to subdirectory in repository')}\n            error={errors.repository?.path?.message}\n            invalid={!!errors.repository?.path}\n            description={t(\n              'provisioning.connect-step.description-github-path',\n              'This is the path to a subdirectory in your GitHub repository where dashboards will be stored and provisioned from'\n            )}\n          >\n            <Input {...register('repository.path')} id=\"repository-path\" />\n          </Field>\n        </>\n      )}\n\n      {type === 'local' && (\n        <Field\n          noMargin\n          label={t('provisioning.connect-step.label-local-path', 'Local path')}\n          error={errors.repository?.path?.message}\n          invalid={!!errors.repository?.path}\n        >\n          <Input\n            {...register('repository.path', {\n              required: t('provisioning.connect-step.error-field-required', 'This field is required.'),\n            })}\n            id=\"repository-local-path\"\n            placeholder={t('provisioning.connect-step.placeholder-local-path', '/path/to/repo')}\n          />\n        </Field>\n      )}\n    </Stack>\n  );\n}\n","import { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Checkbox, Field, Input, Stack, Text, TextLink } from '@grafana/ui';\n\nimport { checkPublicAccess, checkImageRenderer } from '../GettingStarted/features';\n\nimport { WizardFormData } from './types';\n\nexport function FinishStep() {\n  const { register, watch, setValue } = useFormContext<WizardFormData>();\n\n  const [type, readOnly] = watch(['repository.type', 'repository.readOnly']);\n  const isGithub = type === 'github';\n  const isPublic = checkPublicAccess();\n  const hasImageRenderer = checkImageRenderer();\n\n  // Set sync enabled by default\n  useEffect(() => {\n    setValue('repository.sync.enabled', true);\n  }, [setValue]);\n\n  return (\n    <Stack direction=\"column\">\n      {isGithub && (\n        <Field\n          label={t(\n            'provisioning.finish-step.label-update-instance-interval-seconds',\n            'Update instance interval (seconds)'\n          )}\n          description={t(\n            'provisioning.finish-step.description-often-shall-instance-updates-git-hub',\n            'How often shall the instance pull updates from GitHub?'\n          )}\n          required\n        >\n          <Input\n            {...register('repository.sync.intervalSeconds', { valueAsNumber: true })}\n            type=\"number\"\n            placeholder={t('provisioning.finish-step.placeholder', '60')}\n          />\n        </Field>\n      )}\n\n      <Field>\n        <Checkbox\n          {...register('repository.readOnly', {\n            onChange: (e) => {\n              if (e.target.checked) {\n                setValue('repository.prWorkflow', false);\n              }\n            },\n          })}\n          label={t('provisioning.finish-step.label-read-only', 'Read only')}\n          description={t(\n            'provisioning.finish-step.description-read-only',\n            \"Resources can't be modified through Grafana.\"\n          )}\n        />\n      </Field>\n\n      {isGithub && (\n        <>\n          <Field>\n            <Checkbox\n              {...register('repository.prWorkflow')}\n              disabled={readOnly}\n              label={t('provisioning.finish-step.label-pr-workflow', 'Enable pull request option when saving')}\n              description={\n                <Trans i18nKey=\"provisioning.finish-step.description-pr-enable-description\">\n                  Allows users to choose whether to open a pull request when saving changes. If the repository does not\n                  allow direct changes to the main branch, a pull request may still be required.\n                </Trans>\n              }\n            />\n          </Field>\n\n          <Stack direction=\"column\" gap={2}>\n            <Stack direction=\"column\" gap={0}>\n              <Text element=\"h4\">\n                <Trans i18nKey=\"provisioning.finish-step.title-enhance-github\">Enhance your GitHub experience</Trans>\n              </Text>\n              <Text color=\"secondary\" variant=\"bodySmall\">\n                <Trans i18nKey=\"provisioning.finish-step.text-setup-later\">You can always set this up later</Trans>\n              </Text>\n            </Stack>\n            <Field>\n              <Checkbox\n                disabled={!hasImageRenderer || !isPublic}\n                label={t(\n                  'provisioning.finish-step.label-enable-previews',\n                  'Enable dashboard previews in pull requests'\n                )}\n                description={\n                  <>\n                    <Trans i18nKey=\"provisioning.finish-step.description-enable-previews\">\n                      Adds an image preview of dashboard changes in pull requests. Images of your Grafana dashboards\n                      will be shared in your Git repository and visible to anyone with repository access.\n                    </Trans>{' '}\n                    <Text italic>\n                      <Trans i18nKey=\"provisioning.finish-step.description-image-rendering\">\n                        Requires image rendering.{' '}\n                        <TextLink\n                          variant=\"bodySmall\"\n                          external\n                          href=\"https://grafana.com/grafana/plugins/grafana-image-renderer\"\n                        >\n                          Set up image rendering\n                        </TextLink>\n                      </Trans>\n                    </Text>\n                  </>\n                }\n                {...register('repository.generateDashboardPreviews')}\n              />\n            </Field>\n          </Stack>\n        </>\n      )}\n    </Stack>\n  );\n}\n","import { css, cx } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2, Icon } from '@grafana/ui';\n\nexport interface Step<T> {\n  id: T;\n  name: string;\n  title: string;\n  submitOnNext?: boolean;\n}\n\nexport interface Props<T extends string | number> {\n  activeStep?: T;\n  reportId?: string;\n  visitedSteps?: T[];\n  steps: Array<Step<T>>;\n}\n\nexport function Stepper<T extends string | number>({ visitedSteps = [], steps, activeStep = steps[0]?.id }: Props<T>) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <ol className={styles.container}>\n      {steps.map((step, index) => {\n        const isActive = step.id === activeStep;\n        const isCompleted = visitedSteps.includes(step.id) && !isActive;\n        const isLast = index === steps.length - 1;\n\n        const stepTextClass = cx(styles.stepText, {\n          [styles.activeStepText]: isActive,\n        });\n\n        return (\n          <li key={step.id} className={styles.stepContainer}>\n            <div className={styles.stepContent}>\n              {isCompleted ? (\n                <div className={cx(styles.stepNumber, styles.completedStepNumber)}>\n                  <Icon name=\"check\" size=\"sm\" />\n                </div>\n              ) : (\n                <div className={styles.stepNumber}>{index + 1}</div>\n              )}\n              <div className={stepTextClass}>{step.name}</div>\n            </div>\n            {!isLast && <div className={styles.connector} />}\n          </li>\n        );\n      })}\n    </ol>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    container: css({\n      display: 'flex',\n      flexDirection: 'column',\n      margin: theme.spacing(2, 0),\n      padding: 0,\n      listStyle: 'none',\n      width: 200,\n    }),\n    stepContainer: css({\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'flex-start',\n      position: 'relative',\n    }),\n    stepContent: css({\n      display: 'flex',\n      alignItems: 'center',\n      padding: theme.spacing(0.5, 0),\n    }),\n    stepNumber: css({\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      height: theme.spacing(3),\n      width: theme.spacing(3),\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.size.sm,\n      fontWeight: theme.typography.fontWeightMedium,\n      marginRight: theme.spacing(1),\n    }),\n    completedStepNumber: css({\n      color: theme.colors.success.main,\n    }),\n    stepText: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.size.md,\n    }),\n    activeStepText: css({\n      color: theme.colors.text.primary,\n      fontWeight: theme.typography.fontWeightMedium,\n    }),\n    connector: css({\n      width: '1px',\n      backgroundColor: theme.colors.border.medium,\n      height: theme.spacing(2),\n      marginLeft: theme.spacing(1.5),\n      marginTop: theme.spacing(0.5),\n    }),\n  };\n};\n","import { skipToken } from '@reduxjs/toolkit/query';\n\nimport { Trans } from '@grafana/i18n';\nimport { Stack, Text, TextLink } from '@grafana/ui';\nimport { useGetRepositoryQuery } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { getRepoHref } from '../utils/git';\n\ntype RepositoryLinkProps = {\n  name?: string;\n};\n\nexport function RepositoryLink({ name }: RepositoryLinkProps) {\n  const repoQuery = useGetRepositoryQuery(name ? { name } : skipToken);\n  const repo = repoQuery.data;\n\n  if (!repo || repoQuery.isLoading) {\n    return null;\n  }\n\n  const repoHref = getRepoHref(repo.spec?.github);\n\n  return (\n    <Stack direction=\"column\" gap={1}>\n      <Text>\n        <Trans i18nKey=\"provisioning.repository-link.grafana-repository-synced\">\n          Your resources are now in your external storage and provisioned into your instance. From now on, your instance\n          and the external storage will be synchronized.\n        </Trans>\n      </Text>\n      {repoHref && (\n        <Stack direction=\"row\" gap={2}>\n          <TextLink href={repoHref} external>\n            <Trans i18nKey=\"provisioning.repository-link.view-repository\">View repository</Trans>\n          </TextLink>\n        </Stack>\n      )}\n    </Stack>\n  );\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\ninterface ProgressBarProps {\n  progress?: number;\n}\nconst ProgressBar = ({ progress }: ProgressBarProps) => {\n  const styles = useStyles2(getStyles);\n\n  if (progress === undefined) {\n    return null;\n  }\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.filler} style={{ width: `${progress}%` }}></div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css({\n    height: '10px',\n    width: '400px',\n    backgroundColor: theme.colors.background.secondary,\n    borderRadius: theme.shape.radius.pill,\n    overflow: 'hidden',\n    margin: theme.spacing(2, 0),\n  }),\n  filler: css({\n    height: '100%',\n    background: theme.colors.success.text,\n    [theme.transitions.handleMotion('no-preference', 'reduce')]: {\n      transition: 'width 0.5s ease-in-out',\n    },\n  }),\n});\n\nexport default ProgressBar;\n","import { Trans, t } from '@grafana/i18n';\nimport { Alert, ControlledCollapse, Spinner, Stack, Text } from '@grafana/ui';\nimport { Job } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { RepositoryLink } from '../Repository/RepositoryLink';\nimport ProgressBar from '../Shared/ProgressBar';\n\nimport { JobSummary } from './JobSummary';\n\nexport interface JobContentProps {\n  job?: Job;\n  isFinishedJob?: boolean;\n}\n\nexport function JobContent({ job, isFinishedJob = false }: JobContentProps) {\n  if (!job?.status) {\n    return null;\n  }\n\n  const { state, message, progress, summary, errors } = job.status;\n  const repoName = job.metadata?.labels?.['provisioning.grafana.app/repository'];\n\n  const getStatusDisplay = () => {\n    switch (state) {\n      case 'success':\n        return (\n          <Alert\n            severity=\"success\"\n            title={t('provisioning.job-status.status.title-job-completed-successfully', 'Job completed successfully')}\n          />\n        );\n      case 'error':\n        return (\n          <Alert\n            severity=\"error\"\n            title={t('provisioning.job-status.status.title-error-running-job', 'Error running job')}\n          >\n            {message ?? errors?.join('\\n')}\n          </Alert>\n        );\n    }\n    return (\n      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" gap={2}>\n        {['working', 'pending'].includes(state ?? '') && <Spinner size={24} />}\n        <Text element=\"h4\" color=\"secondary\">\n          {message ?? state ?? ''}\n        </Text>\n      </Stack>\n    );\n  };\n\n  return (\n    <Stack direction=\"column\" gap={2}>\n      <Stack direction=\"column\" gap={2}>\n        {getStatusDisplay()}\n        {state && !['success', 'error'].includes(state) && (\n          <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" gap={2}>\n            <ProgressBar progress={progress ?? 0} />\n          </Stack>\n        )}\n        {isFinishedJob && summary && (\n          <Stack direction=\"column\" gap={2}>\n            <Text variant=\"h3\">\n              <Trans i18nKey=\"provisioning.job-status.summary\">Summary</Trans>\n            </Text>\n            <JobSummary summary={summary} />\n          </Stack>\n        )}\n        {state === 'success' ? (\n          <RepositoryLink name={repoName} />\n        ) : (\n          <ControlledCollapse label={t('provisioning.job-status.label-view-details', 'View details')} isOpen={false}>\n            <pre>{JSON.stringify(job, null, 2)}</pre>\n          </ControlledCollapse>\n        )}\n      </Stack>\n    </Stack>\n  );\n}\n","import { useEffect, useRef } from 'react';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Alert, Spinner, Stack, Text } from '@grafana/ui';\nimport { useGetRepositoryJobsWithPathQuery } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { useStepStatus } from '../Wizard/StepStatusContext';\n\nimport { JobContent } from './JobContent';\n\nexport interface FinishedJobProps {\n  jobUid: string;\n  repositoryName: string;\n}\n\nexport function FinishedJobStatus({ jobUid, repositoryName }: FinishedJobProps) {\n  const hasRetried = useRef(false);\n  const { setStepStatusInfo } = useStepStatus();\n  const finishedQuery = useGetRepositoryJobsWithPathQuery({\n    name: repositoryName,\n    uid: jobUid,\n  });\n  const retryFailed = hasRetried.current && finishedQuery.isError;\n\n  const job = finishedQuery.data;\n\n  useEffect(() => {\n    const shouldRetry = !job && !hasRetried.current && !finishedQuery.isFetching;\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (shouldRetry) {\n      hasRetried.current = true;\n      timeoutId = setTimeout(() => {\n        finishedQuery.refetch();\n      }, 1000);\n    }\n\n    if (finishedQuery.isSuccess && job?.status?.state !== 'error') {\n      setStepStatusInfo({ status: 'success' });\n    }\n\n    return () => {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }, [finishedQuery, job, setStepStatusInfo]);\n\n  if (retryFailed) {\n    setStepStatusInfo({ status: 'error' });\n    return (\n      <Alert severity=\"error\" title={t('provisioning.job-status.no-job-found', 'No job found')}>\n        <Trans i18nKey=\"provisioning.job-status.no-job-found-message\">\n          The job may have been deleted or could not be retrieved. Cancel the current process and start again.\n        </Trans>\n      </Alert>\n    );\n  }\n\n  if (!job || finishedQuery.isLoading || finishedQuery.isFetching) {\n    return (\n      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" gap={2}>\n        <Spinner size={24} />\n        <Text element=\"h4\" color=\"secondary\">\n          <Trans i18nKey=\"provisioning.job-status.loading-finished-job\">Loading finished job...</Trans>\n        </Text>\n      </Stack>\n    );\n  }\n\n  return <JobContent job={job} isFinishedJob={true} />;\n}\n","import { Trans } from '@grafana/i18n';\nimport { Spinner, Stack, Text } from '@grafana/ui';\nimport { Job, useListJobQuery } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { useStepStatus } from '../Wizard/StepStatusContext';\n\nimport { FinishedJobStatus } from './FinishedJobStatus';\nimport { JobContent } from './JobContent';\n\nexport interface JobStatusProps {\n  watch: Job;\n}\n\nexport function JobStatus({ watch }: JobStatusProps) {\n  const { setStepStatusInfo } = useStepStatus();\n  const activeQuery = useListJobQuery({\n    fieldSelector: `metadata.name=${watch.metadata?.name}`,\n    watch: true,\n  });\n  const activeJob = activeQuery?.data?.items?.[0];\n  const repoLabel = watch.metadata?.labels?.['provisioning.grafana.app/repository'];\n\n  // Only initialize finished query if we've checked active jobs and found none\n  const activeQueryCompleted = !activeQuery.isUninitialized && !activeQuery.isLoading;\n  const shouldCheckFinishedJobs = activeQueryCompleted && !activeJob && !!repoLabel;\n\n  if (activeQuery.isLoading) {\n    return (\n      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" gap={2}>\n        <Spinner size={24} />\n        <Text element=\"h4\" color=\"secondary\">\n          <Trans i18nKey=\"provisioning.job-status.starting\">Starting...</Trans>\n        </Text>\n      </Stack>\n    );\n  }\n\n  if (activeQuery.isError) {\n    setStepStatusInfo({ status: 'error', error: 'Error fetching active job' });\n    return null;\n  }\n\n  if (activeJob) {\n    return <JobContent job={activeJob} isFinishedJob={false} />;\n  }\n\n  if (shouldCheckFinishedJobs) {\n    return <FinishedJobStatus jobUid={watch.metadata?.uid!} repositoryName={repoLabel} />;\n  }\n\n  return (\n    <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" gap={2}>\n      <Spinner size={24} />\n      <Text element=\"h4\" weight=\"bold\">\n        <Trans i18nKey=\"provisioning.job-status.starting\">Starting...</Trans>\n      </Text>\n    </Stack>\n  );\n}\n","import { useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, Text, Stack, Alert, TextLink, Field, Checkbox } from '@grafana/ui';\nimport { Job, useCreateRepositoryJobsMutation } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { JobStatus } from '../Job/JobStatus';\n\nimport { useStepStatus } from './StepStatusContext';\nimport { WizardFormData } from './types';\n\nexport interface SynchronizeStepProps {\n  requiresMigration: boolean;\n  isLegacyStorage?: boolean;\n}\n\nexport function SynchronizeStep({ requiresMigration, isLegacyStorage }: SynchronizeStepProps) {\n  const { setStepStatusInfo } = useStepStatus();\n  const [createJob] = useCreateRepositoryJobsMutation();\n  const { getValues, register, watch } = useFormContext<WizardFormData>();\n  const repoType = watch('repository.type');\n  const supportsHistory = repoType === 'github' && isLegacyStorage;\n  const [job, setJob] = useState<Job>();\n\n  const startSynchronization = async () => {\n    const [history, repoName] = getValues(['migrate.history', 'repositoryName']);\n    if (!repoName) {\n      setStepStatusInfo({\n        status: 'error',\n        error: t('provisioning.synchronize-step.error-no-repository-name', 'No repository name provided'),\n      });\n      return;\n    }\n\n    try {\n      setStepStatusInfo({ status: 'running' });\n      const jobSpec = requiresMigration\n        ? {\n            migrate: {\n              history: history && supportsHistory,\n            },\n          }\n        : {\n            pull: {\n              incremental: false, // will queue a full resync job\n            },\n          };\n\n      const response = await createJob({\n        name: repoName,\n        jobSpec,\n      }).unwrap();\n\n      if (!response?.metadata?.name) {\n        return setStepStatusInfo({\n          status: 'error',\n          error: t('provisioning.synchronize-step.error-no-job-id', 'Failed to start job'),\n        });\n      }\n      setJob(response);\n    } catch (error) {\n      setStepStatusInfo({\n        status: 'error',\n        error: t('provisioning.synchronize-step.error-starting-job', 'Error starting job'),\n      });\n    }\n  };\n\n  if (job) {\n    return <JobStatus watch={job} />;\n  }\n\n  return (\n    <Stack direction=\"column\" gap={3} alignItems=\"flex-start\">\n      <Text color=\"secondary\">\n        <Trans i18nKey=\"provisioning.wizard.sync-description\">\n          Sync resources with external storage. After this one-time step, all future updates will be automatically saved\n          to the repository and provisioned back into the instance.\n        </Trans>\n      </Text>\n      <Alert\n        title={t(\n          'provisioning.wizard.alert-title',\n          'Important: No data or configuration will be lost, but dashboards will be temporarily unavailable for a few minutes.'\n        )}\n        severity={'info'}\n      >\n        <ul style={{ marginLeft: '16px' }}>\n          <li>\n            <Trans i18nKey=\"provisioning.wizard.alert-point-1\">\n              Resources won't be able to be created, edited, or deleted during this process. In the last step, they will\n              disappear.\n            </Trans>\n          </li>\n          <li>\n            <Trans i18nKey=\"provisioning.wizard.alert-point-2\">\n              Once provisioning is complete, resources will reappear and be managed through external storage.\n            </Trans>\n          </li>\n          <li>\n            <Trans i18nKey=\"provisioning.wizard.alert-point-3\">\n              The duration of this process depends on the number of resources involved.\n            </Trans>\n          </li>\n          <li>\n            <Trans i18nKey=\"provisioning.wizard.alert-point-4\">\n              Enterprise instance administrators can display an announcement banner to users. See{' '}\n              <TextLink external href=\"https://grafana.com/docs/grafana/latest/administration/announcement-banner/\">\n                this guide\n              </TextLink>{' '}\n              for step-by-step instructions.\n            </Trans>\n          </li>\n        </ul>\n      </Alert>\n      {supportsHistory && (\n        <>\n          <Text element=\"h3\">\n            <Trans i18nKey=\"provisioning.synchronize-step.synchronization-options\">Synchronization options</Trans>\n          </Text>\n          <Field noMargin>\n            <Checkbox\n              {...register('migrate.history')}\n              id=\"migrate-history\"\n              label={t('provisioning.wizard.sync-option-history', 'History')}\n              description={\n                <Trans i18nKey=\"provisioning.synchronize-step.synchronization-description\">\n                  Include commits for each historical value\n                </Trans>\n              }\n            />\n          </Field>\n        </>\n      )}\n\n      <Button variant=\"primary\" onClick={startSynchronization}>\n        <Trans i18nKey=\"provisioning.wizard.button-start\">Begin synchronization</Trans>\n      </Button>\n    </Stack>\n  );\n}\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\nimport { useNavigate } from 'react-router-dom-v5-compat';\n\nimport { AppEvents, GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { getAppEvents, isFetchError } from '@grafana/runtime';\nimport { Alert, Box, Button, Stack, Text, useStyles2 } from '@grafana/ui';\nimport { useDeleteRepositoryMutation, useGetFrontendSettingsQuery } from 'app/api/clients/provisioning/v0alpha1';\nimport { FormPrompt } from 'app/core/components/FormPrompt/FormPrompt';\n\nimport { getDefaultValues } from '../Config/defaults';\nimport { PROVISIONING_URL } from '../constants';\nimport { useCreateOrUpdateRepository } from '../hooks/useCreateOrUpdateRepository';\nimport { dataToSpec } from '../utils/data';\nimport { getFormErrors } from '../utils/getFormErrors';\n\nimport { BootstrapStep } from './BootstrapStep';\nimport { ConnectStep } from './ConnectStep';\nimport { FinishStep } from './FinishStep';\nimport { useStepStatus } from './StepStatusContext';\nimport { Step, Stepper } from './Stepper';\nimport { SynchronizeStep } from './SynchronizeStep';\nimport { RepoType, WizardFormData, WizardStep } from './types';\n\nconst appEvents = getAppEvents();\n\nconst getSteps = (): Array<Step<WizardStep>> => {\n  return [\n    {\n      id: 'connection',\n      name: t('provisioning.wizard.step-connect', 'Connect'),\n      title: t('provisioning.wizard.title-connect', 'Connect to external storage'),\n      submitOnNext: true,\n    },\n    {\n      id: 'bootstrap',\n      name: t('provisioning.wizard.step-bootstrap', 'Choose what to synchronize'),\n      title: t('provisioning.wizard.title-bootstrap', 'Choose what to synchronize'),\n      submitOnNext: true,\n    },\n    {\n      id: 'synchronize',\n      name: t('provisioning.wizard.step-synchronize', 'Synchronize with external storage'),\n      title: t('provisioning.wizard.title-synchronize', 'Synchronize with external storage'),\n      submitOnNext: false,\n    },\n    {\n      id: 'finish',\n      name: t('provisioning.wizard.step-finish', 'Choose additional settings'),\n      title: t('provisioning.wizard.title-finish', 'Choose additional settings'),\n      submitOnNext: true,\n    },\n  ];\n};\n\nexport function ProvisioningWizard({ type }: { type: RepoType }) {\n  const [activeStep, setActiveStep] = useState<WizardStep>('connection');\n  const [completedSteps, setCompletedSteps] = useState<WizardStep[]>([]);\n  const [requiresMigration, setRequiresMigration] = useState(false);\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isCancelling, setIsCancelling] = useState(false);\n\n  const { stepStatusInfo, setStepStatusInfo, isStepSuccess, isStepRunning, hasStepError } = useStepStatus();\n\n  const settingsQuery = useGetFrontendSettingsQuery();\n  const navigate = useNavigate();\n\n  const steps = getSteps();\n  const styles = useStyles2(getStyles);\n\n  const values = getDefaultValues();\n  const methods = useForm<WizardFormData>({\n    defaultValues: {\n      repository: { ...values, type },\n      migrate: {\n        history: true,\n      },\n    },\n  });\n\n  const {\n    watch,\n    setValue,\n    getValues,\n    trigger,\n    setError,\n    formState: { isDirty },\n    handleSubmit,\n  } = methods;\n\n  const repoName = watch('repositoryName');\n  const [submitData] = useCreateOrUpdateRepository(repoName);\n  const [deleteRepository] = useDeleteRepositoryMutation();\n\n  const currentStepIndex = steps.findIndex((s) => s.id === activeStep);\n  const currentStepConfig = steps[currentStepIndex];\n\n  // A different repository is marked with instance target -- nothing will succeed\n  useEffect(() => {\n    if (settingsQuery.data?.items.some((item) => item.target === 'instance' && item.name !== repoName)) {\n      appEvents.publish({\n        type: AppEvents.alertError.name,\n        payload: [\n          t('provisioning.wizard-content.error-instance-repository-exists', 'Instance repository already exists'),\n        ],\n      });\n\n      navigate(PROVISIONING_URL);\n    }\n  }, [navigate, repoName, settingsQuery.data?.items]);\n\n  const handleRepositoryDeletion = async (name: string) => {\n    try {\n      await deleteRepository({ name });\n      // Wait before redirecting to ensure deletion is processed\n      setTimeout(() => {\n        navigate(PROVISIONING_URL);\n      }, 1000);\n    } catch (error) {\n      setIsCancelling(false);\n    }\n  };\n\n  const handleCancel = async () => {\n    // For the first step, do not delete anything  just go back.\n    if (activeStep === 'connection' || !repoName) {\n      navigate(PROVISIONING_URL);\n      return;\n    }\n    setIsCancelling(true);\n    handleRepositoryDeletion(repoName);\n  };\n\n  // Calculate button text based on current step position\n  const getNextButtonText = useCallback(\n    (currentStep: WizardStep) => {\n      const stepIndex = steps.findIndex((s) => s.id === currentStep);\n\n      // Guard against index out of bounds\n      if (stepIndex === -1 || stepIndex >= steps.length - 1) {\n        return t('provisioning.wizard.button-next', 'Finish');\n      }\n\n      return steps[stepIndex + 1].name;\n    },\n    [steps]\n  );\n\n  const handleNext = async () => {\n    const isLastStep = currentStepIndex === steps.length - 1;\n\n    // Only navigate to provisioning URL if we're on the actual last step\n    if (isLastStep) {\n      navigate(PROVISIONING_URL);\n    } else {\n      setActiveStep(steps[currentStepIndex + 1].id);\n      setCompletedSteps((prev) => [...new Set([...prev, activeStep])]);\n      setStepStatusInfo({ status: 'idle' });\n    }\n  };\n\n  const onSubmit = async () => {\n    if (currentStepConfig?.submitOnNext) {\n      // Validate form data before proceeding\n      if (activeStep === 'connection' || activeStep === 'bootstrap') {\n        const isValid = await trigger(['repository', 'repository.title']);\n        if (!isValid) {\n          return;\n        }\n      }\n\n      setIsSubmitting(true);\n      try {\n        const formData = getValues();\n        const spec = dataToSpec(formData.repository);\n        const rsp = await submitData(spec);\n        if (rsp.error) {\n          setStepStatusInfo({\n            status: 'error',\n            error: 'Repository request failed',\n          });\n          return;\n        }\n\n        // Fill in the k8s name from the initial POST response\n        const name = rsp.data?.metadata?.name;\n        if (name) {\n          setValue('repositoryName', name);\n          setStepStatusInfo({ status: 'success' });\n          handleNext();\n        } else {\n          console.error('Saved repository without a name:', rsp);\n        }\n      } catch (error) {\n        if (isFetchError(error)) {\n          const [field, errorMessage] = getFormErrors(error.data.errors);\n          if (field && errorMessage) {\n            setError(field, errorMessage);\n          }\n        } else {\n          setStepStatusInfo({\n            status: 'error',\n            error: 'Repository connection failed',\n          });\n        }\n      } finally {\n        setIsSubmitting(false);\n      }\n    } else {\n      // only proceed if the job was successful\n      if (isStepSuccess) {\n        handleNext();\n      }\n    }\n  };\n\n  const isNextButtonDisabled = () => {\n    // If the step is not on Connect page, we only enable it if the job was successful\n    if (activeStep !== 'connection' && hasStepError) {\n      return true;\n    }\n    // Synchronize step requires success to proceed\n    if (activeStep === 'synchronize') {\n      return !isStepSuccess; // Disable next button if the step is not successful\n    }\n    return isSubmitting || isCancelling || isStepRunning;\n  };\n\n  return (\n    <FormProvider {...methods}>\n      <Stack gap={6} direction=\"row\" alignItems=\"flex-start\">\n        <Stepper steps={steps} activeStep={activeStep} visitedSteps={completedSteps} />\n        <div className={styles.divider} />\n        <form onSubmit={handleSubmit(onSubmit)} className={styles.form}>\n          <FormPrompt onDiscard={handleCancel} confirmRedirect={isDirty && activeStep !== 'finish' && !isCancelling} />\n          <Stack direction=\"column\">\n            <Box marginBottom={2}>\n              <Text element=\"h2\">\n                {currentStepIndex + 1}. {currentStepConfig?.title}\n              </Text>\n            </Box>\n\n            {hasStepError && <Alert severity=\"error\" title={'error' in stepStatusInfo ? stepStatusInfo.error : ''} />}\n\n            <div className={styles.content}>\n              {activeStep === 'connection' && <ConnectStep />}\n              {activeStep === 'bootstrap' && (\n                <BootstrapStep\n                  onOptionSelect={setRequiresMigration}\n                  settingsData={settingsQuery.data}\n                  repoName={repoName ?? ''}\n                />\n              )}\n              {activeStep === 'synchronize' && (\n                <SynchronizeStep\n                  requiresMigration={requiresMigration}\n                  isLegacyStorage={Boolean(settingsQuery.data?.legacyStorage)}\n                />\n              )}\n              {activeStep === 'finish' && <FinishStep />}\n            </div>\n\n            <Stack gap={2} justifyContent=\"flex-end\">\n              <Button variant={'secondary'} onClick={handleCancel} disabled={isSubmitting || isCancelling}>\n                {isCancelling\n                  ? t('provisioning.wizard-content.button-cancelling', 'Cancelling...')\n                  : t('provisioning.wizard-content.button-cancel', 'Cancel')}\n              </Button>\n              <Button type={'submit'} disabled={isNextButtonDisabled()}>\n                {isSubmitting\n                  ? t('provisioning.wizard-content.button-submitting', 'Submitting...')\n                  : getNextButtonText(activeStep)}\n              </Button>\n            </Stack>\n          </Stack>\n        </form>\n      </Stack>\n    </FormProvider>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  form: css({\n    maxWidth: '900px',\n    flexGrow: 1,\n  }),\n  divider: css({\n    width: 1,\n    alignSelf: 'stretch',\n    backgroundColor: theme.colors.border.weak,\n    // align with the button row\n    marginBottom: theme.spacing(13),\n  }),\n  content: css({\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n    paddingBottom: theme.spacing(4),\n    marginBottom: theme.spacing(4),\n  }),\n});\n","import { useParams } from 'react-router-dom-v5-compat';\n\nimport { t } from '@grafana/i18n';\nimport { Page } from 'app/core/components/Page/Page';\n\nimport { ProvisioningWizard } from './ProvisioningWizard';\nimport { StepStatusProvider } from './StepStatusContext';\nimport { RepoType } from './types';\n\nexport default function ConnectPage() {\n  const { type } = useParams<{ type: RepoType }>();\n\n  if (!type) {\n    return null;\n  }\n\n  return (\n    <Page\n      navId=\"provisioning\"\n      pageNav={{\n        text: type === 'github' ? 'Configure Git Sync' : 'Configure local file path',\n        subTitle: t(\n          'provisioning.connect-page.subTitle.connect-external-storage-manage-resources',\n          'Connect to an external storage to manage your resources'\n        ),\n      }}\n    >\n      <Page.Contents>\n        <StepStatusProvider>\n          <ProvisioningWizard type={type} />\n        </StepStatusProvider>\n      </Page.Contents>\n    </Page>\n  );\n}\n","import { useCallback } from 'react';\n\nimport {\n  RepositorySpec,\n  useCreateRepositoryMutation,\n  useCreateRepositoryTestMutation,\n  useReplaceRepositoryMutation,\n} from 'app/api/clients/provisioning/v0alpha1';\n\nexport function useCreateOrUpdateRepository(name?: string) {\n  const [create, createRequest] = useCreateRepositoryMutation();\n  const [update, updateRequest] = useReplaceRepositoryMutation();\n  const [testConfig, testRequest] = useCreateRepositoryTestMutation();\n\n  const updateOrCreate = useCallback(\n    async (data: RepositorySpec) => {\n      // First test the config and wait for the result\n      // unwrap will throw an error if the test fails\n      await testConfig({\n        // HACK: we need to provide a name to the test configuration\n        name: name || 'new',\n        body: {\n          spec: data,\n        },\n      }).unwrap();\n\n      // If test passes, proceed with create/update\n      if (name) {\n        return update({\n          name,\n          repository: {\n            metadata: {\n              name,\n              // TODO? -- replace with patch spec, so the rest of the metadata is not replaced?\n              // Can that support optimistic locking? (eg, make sure the RV is the same?)\n              finalizers: ['cleanup', 'remove-orphan-resources'],\n            },\n            spec: data,\n          },\n        });\n      }\n      return create({ repository: { metadata: generateRepositoryMetadata(data), spec: data } });\n    },\n    [create, name, update, testConfig]\n  );\n\n  return [updateOrCreate, name ? updateRequest : createRequest, testRequest] as const;\n}\n\nconst generateRepositoryMetadata = (data: RepositorySpec) => {\n  // We don't know for sure that we can use a normalised name. If we can't, we'll ask the server to generate one for us.\n  const normalisedName = data.title.toLowerCase().replaceAll(/[^a-z0-9\\-_]+/g, '');\n\n  if (\n    crypto.randomUUID && // we might not be in a secure context\n    normalisedName && // we need a non-empty string before we check the first character\n    normalisedName.charAt(0) >= 'a' && // required to start with a letter to be a valid k8s name\n    normalisedName.charAt(0) <= 'z' &&\n    normalisedName.replaceAll(/[^a-z]/g, '').length >= 3 // must look sensible to a human\n  ) {\n    // We still want a suffix, to avoid name collisions.\n    const randomBit = crypto.randomUUID().substring(0, 7);\n    const shortenedName = normalisedName.substring(0, 63 - 1 - randomBit.length);\n    return { name: `${shortenedName}-${randomBit}` };\n  } else {\n    return { generateName: 'r' };\n  }\n};\n","import { RepositorySpec } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { RepositoryFormData } from '../types';\n\nconst getWorkflows = (data: RepositoryFormData): RepositorySpec['workflows'] => {\n  if (data.readOnly) {\n    return [];\n  }\n  const workflows: RepositorySpec['workflows'] = ['write'];\n\n  if (!data.prWorkflow) {\n    return workflows;\n  }\n\n  return [...workflows, 'branch'];\n};\n\nexport const dataToSpec = (data: RepositoryFormData): RepositorySpec => {\n  const spec: RepositorySpec = {\n    type: data.type,\n    sync: data.sync,\n    title: data.title || '',\n    workflows: getWorkflows(data),\n  };\n  switch (data.type) {\n    case 'github':\n      spec.github = {\n        generateDashboardPreviews: data.generateDashboardPreviews,\n        url: data.url || '',\n        branch: data.branch,\n        token: data.token,\n        path: data.path,\n      };\n      break;\n    case 'local':\n      spec.local = {\n        path: data.path,\n      };\n      spec.workflows = spec.workflows.filter((v) => v !== 'branch'); // branch only supported by github\n      break;\n  }\n\n  // We need to deep clone the data, so it doesn't become immutable\n  return structuredClone(spec);\n};\n\nexport const specToData = (spec: RepositorySpec): RepositoryFormData => {\n  return structuredClone({\n    ...spec,\n    ...spec.github,\n    ...spec.local,\n    branch: spec.github?.branch || '',\n    url: spec.github?.url || '',\n    generateDashboardPreviews: spec.github?.generateDashboardPreviews || false,\n    readOnly: !spec.workflows.length,\n    prWorkflow: spec.workflows.includes('write'),\n  });\n};\n"],"names":["getDefaultValues","repository","getSummaryColumns","item","JobSummary","summary","TokenPermissionsInfo","styles","getStyles","theme","getFormErrors","errors","fieldsToValidate","fieldMap","error","cleanField","fieldParts","lastPart","StepStatusContext","StepStatusProvider","children","stepStatusInfo","setStepStatusInfoState","setStepStatusInfo","info","value","useStepStatus","context","filterModeOptions","modeOptions","repoName","settings","folderConnected","option","useModeOptions","getResourceStats","files","stats","fileCount","count","file","path","counts","resourceCount","stat","BootstrapStep","onOptionSelect","settingsData","register","control","setValue","watch","getValues","resourceStats","filesQuery","selectedTarget","options","target","resourceCountString","requiresMigration","isLoading","name","Box","LoadingPlaceholder","Stack","Text","ref","onChange","field","action","Card","Field","Input","ConnectStep","tokenConfigured","setTokenConfigured","type","isGithub","SecretInput","FinishStep","readOnly","isPublic","hasImageRenderer","Checkbox","e","TextLink","Stepper","visitedSteps","steps","activeStep","step","index","isActive","isCompleted","isLast","stepTextClass","Icon","RepositoryLink","repoQuery","repo","repoHref","ProgressBar","progress","JobContent","job","isFinishedJob","state","message","getStatusDisplay","Alert","Spinner","FinishedJobStatus","jobUid","repositoryName","hasRetried","finishedQuery","retryFailed","shouldRetry","timeoutId","JobStatus","activeQuery","activeJob","repoLabel","shouldCheckFinishedJobs","SynchronizeStep","isLegacyStorage","createJob","supportsHistory","setJob","startSynchronization","history","response","Button","getSteps","ProvisioningWizard","setActiveStep","completedSteps","setCompletedSteps","setRequiresMigration","isSubmitting","setIsSubmitting","isCancelling","setIsCancelling","isStepSuccess","isStepRunning","hasStepError","settingsQuery","navigate","values","methods","trigger","setError","isDirty","handleSubmit","submitData","useCreateOrUpdateRepository","deleteRepository","currentStepIndex","s","currentStepConfig","handleRepositoryDeletion","handleCancel","getNextButtonText","currentStep","stepIndex","handleNext","prev","onSubmit","formData","spec","data","rsp","errorMessage","isNextButtonDisabled","FormPrompt","ConnectPage","Page","create","createRequest","update","updateRequest","testConfig","testRequest","generateRepositoryMetadata","normalisedName","randomBit","getWorkflows","workflows","dataToSpec","v","specToData"],"sourceRoot":""}