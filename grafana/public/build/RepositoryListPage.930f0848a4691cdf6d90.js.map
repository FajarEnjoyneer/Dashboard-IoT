{"version":3,"file":"RepositoryListPage.930f0848a4691cdf6d90.js","mappings":"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","sources":["webpack://grafana/./public/app/features/provisioning/Repository/RepositoryCard.tsx","webpack://grafana/./public/app/features/provisioning/Shared/RepositoryList.tsx","webpack://grafana/./public/app/features/provisioning/hooks/useRepositoryList.ts","webpack://grafana/./public/app/features/provisioning/HomePage.tsx","webpack://grafana/./public/app/features/provisioning/Repository/DeleteRepositoryButton.tsx","webpack://grafana/./public/app/features/provisioning/Repository/SyncRepository.tsx","webpack://grafana/./public/app/features/provisioning/Shared/StatusBadge.tsx"],"sourcesContent":["import { ReactNode } from 'react';\n\nimport { Trans } from '@grafana/i18n';\nimport { IconName, Stack, Text, TextLink, Icon, Card, LinkButton } from '@grafana/ui';\nimport { Repository, ResourceCount } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { StatusBadge } from '../Shared/StatusBadge';\nimport { PROVISIONING_URL } from '../constants';\n\nimport { DeleteRepositoryButton } from './DeleteRepositoryButton';\nimport { SyncRepository } from './SyncRepository';\n\ninterface Props {\n  repository: Repository;\n}\n\nexport function RepositoryCard({ repository }: Props) {\n  const { metadata, spec, status } = repository;\n  const name = metadata?.name ?? '';\n\n  const getRepositoryMeta = (): ReactNode[] => {\n    const meta: ReactNode[] = [];\n\n    if (spec?.type === 'github') {\n      const { url = '', branch } = spec.github ?? {};\n      const branchUrl = branch ? `${url}/tree/${branch}` : url;\n\n      meta.push(\n        <TextLink key=\"link\" external href={branchUrl}>\n          {branchUrl}\n        </TextLink>\n      );\n\n      if (status?.webhook?.id) {\n        const webhookUrl = `${url}/settings/hooks/${status.webhook.id}`;\n        meta.push(\n          <Stack gap={1} direction=\"row\" alignItems=\"center\">\n            <TextLink key=\"webhook\" href={webhookUrl}>\n              <Trans i18nKey=\"provisioning.repository-card.get-repository-meta.webhook\">Webhook</Trans>\n            </TextLink>\n            <Icon name=\"check\" className=\"text-success\" />\n          </Stack>\n        );\n      }\n    } else if (spec?.type === 'local') {\n      meta.push(\n        <Text variant=\"bodySmall\" key=\"path\">\n          {spec.local?.path ?? ''}\n        </Text>\n      );\n    }\n\n    return meta;\n  };\n\n  const getRepositoryIcon = (): IconName => {\n    return spec?.type === 'github' ? 'github' : 'database';\n  };\n\n  return (\n    <Card key={name}>\n      <Card.Figure>\n        <Icon name={getRepositoryIcon()} size=\"xxl\" />\n      </Card.Figure>\n      <Card.Heading>\n        <Stack gap={2} direction=\"row\" alignItems=\"center\">\n          {spec?.title && <Text variant=\"h3\">{spec.title}</Text>}\n          <StatusBadge repo={repository} />\n        </Stack>\n      </Card.Heading>\n\n      <Card.Description>\n        <Stack gap={2} direction=\"column\">\n          {spec?.description && <Text>{spec.description}</Text>}\n          {status?.stats?.length && (\n            <Stack gap={1} direction=\"row\" wrap>\n              {status.stats.map((stat, index) => (\n                <LinkButton\n                  key={index}\n                  fill=\"outline\"\n                  size=\"md\"\n                  variant=\"secondary\"\n                  href={getListURL(repository, stat)}\n                >\n                  {stat.count} {stat.resource}\n                </LinkButton>\n              ))}\n            </Stack>\n          )}\n        </Stack>\n      </Card.Description>\n\n      <Card.Meta>\n        <Stack gap={2} direction=\"row\" wrap>\n          {getRepositoryMeta()}\n        </Stack>\n      </Card.Meta>\n\n      <Card.Actions>\n        <Stack gap={1} direction=\"row\">\n          <LinkButton icon=\"eye\" href={`${PROVISIONING_URL}/${name}`} variant=\"primary\" size=\"md\">\n            <Trans i18nKey=\"provisioning.repository-card.view\">View</Trans>\n          </LinkButton>\n          <SyncRepository repository={repository} />\n          <LinkButton variant=\"secondary\" icon=\"cog\" href={`${PROVISIONING_URL}/${name}/edit`} size=\"md\">\n            <Trans i18nKey=\"provisioning.repository-card.settings\">Settings</Trans>\n          </LinkButton>\n        </Stack>\n      </Card.Actions>\n      <Card.SecondaryActions>\n        <DeleteRepositoryButton name={name} />\n      </Card.SecondaryActions>\n    </Card>\n  );\n}\n\n// Helper function\nfunction getListURL(repo: Repository, stats: ResourceCount): string {\n  if (stats.resource === 'playlists') {\n    return '/playlists';\n  }\n  if (repo.spec?.sync.target === 'folder') {\n    return `/dashboards/f/${repo.metadata?.name}`;\n  }\n  return '/dashboards';\n}\n","import { useState } from 'react';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { EmptySearchResult, FilterInput, Stack } from '@grafana/ui';\nimport { Repository } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { RepositoryCard } from '../Repository/RepositoryCard';\nimport { checkSyncSettings } from '../utils/checkSyncSettings';\n\nimport { ConnectRepositoryButton } from './ConnectRepositoryButton';\n\ninterface Props {\n  items: Repository[];\n}\n\nexport function RepositoryList({ items }: Props) {\n  const [query, setQuery] = useState('');\n\n  const filteredItems = items.filter((item) => item.metadata?.name?.includes(query));\n  const { instanceConnected } = checkSyncSettings(items);\n  return (\n    <Stack direction={'column'} gap={3}>\n      {!instanceConnected && (\n        <Stack gap={2}>\n          <FilterInput\n            placeholder={t('provisioning.folder-repository-list.placeholder-search', 'Search')}\n            value={query}\n            onChange={setQuery}\n          />\n          <ConnectRepositoryButton items={items} showDropdown />\n        </Stack>\n      )}\n      <Stack direction={'column'}>\n        {filteredItems.length ? (\n          filteredItems.map((item) => <RepositoryCard key={item.metadata?.name} repository={item} />)\n        ) : (\n          <EmptySearchResult>\n            <Trans i18nKey=\"provisioning.folder-repository-list.no-results-matching-your-query\">\n              No results matching your query\n            </Trans>\n          </EmptySearchResult>\n        )}\n      </Stack>\n    </Stack>\n  );\n}\n","import { skipToken } from '@reduxjs/toolkit/query';\n\nimport { ListRepositoryApiArg, Repository, useListRepositoryQuery } from 'app/api/clients/provisioning/v0alpha1';\n\n// Sort repositories alphabetically by title\nexport function useRepositoryList(\n  options: ListRepositoryApiArg | typeof skipToken = {}\n): [Repository[] | undefined, boolean] {\n  const query = useListRepositoryQuery(options);\n  const collator = new Intl.Collator(undefined, { numeric: true });\n\n  const sortedItems = query.data?.items?.slice().sort((a, b) => {\n    const titleA = a.spec?.title ?? '';\n    const titleB = b.spec?.title ?? '';\n    return collator.compare(titleA, titleB);\n  });\n\n  return [sortedItems, query.isLoading];\n}\n","import { useMemo, useState } from 'react';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Alert, ConfirmModal, Stack, Tab, TabContent, TabsBar } from '@grafana/ui';\nimport {\n  useDeletecollectionRepositoryMutation,\n  useGetFrontendSettingsQuery,\n} from 'app/api/clients/provisioning/v0alpha1';\nimport { Page } from 'app/core/components/Page/Page';\n\nimport GettingStarted from './GettingStarted/GettingStarted';\nimport GettingStartedPage from './GettingStarted/GettingStartedPage';\nimport { RepositoryList } from './Shared/RepositoryList';\nimport { useRepositoryList } from './hooks/useRepositoryList';\n\nenum TabSelection {\n  Repositories = 'repositories',\n  GettingStarted = 'getting-started',\n}\n\nexport default function HomePage() {\n  const [items, isLoading] = useRepositoryList({ watch: true });\n  const settings = useGetFrontendSettingsQuery();\n  const [deleteAll] = useDeletecollectionRepositoryMutation();\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const [activeTab, setActiveTab] = useState<TabSelection>(TabSelection.Repositories);\n\n  const tabInfo = useMemo(\n    () => [\n      {\n        value: TabSelection.Repositories,\n        label: t('provisioning.home-page.tab-repositories', 'Repositories'),\n        title: t('provisioning.home-page.tab-repositories-title', 'List of repositories'),\n      },\n      {\n        value: TabSelection.GettingStarted,\n        label: t('provisioning.home-page.tab-getting-started', 'Getting started'),\n        title: t('provisioning.home-page.tab-getting-started-title', 'Getting started'),\n      },\n    ],\n    []\n  );\n\n  // Early return for onboarding\n  if (!items?.length && !isLoading) {\n    return <GettingStartedPage items={items ?? []} />;\n  }\n\n  const onConfirmDelete = () => {\n    deleteAll({});\n    setShowDeleteModal(false);\n  };\n\n  const renderTabContent = () => {\n    switch (activeTab) {\n      case TabSelection.Repositories:\n        return <RepositoryList items={items ?? []} />;\n      case TabSelection.GettingStarted:\n        return <GettingStarted items={items ?? []} />;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Page\n      navId=\"provisioning\"\n      subTitle={t('provisioning.home-page.subtitle', 'View and manage your configured repositories')}\n    >\n      <Page.Contents isLoading={isLoading}>\n        {settings.data?.legacyStorage && (\n          <Alert\n            title={t('provisioning.home-page.title-legacy-storage-detected', 'Legacy storage detected')}\n            severity=\"error\"\n            buttonContent={\n              <Trans i18nKey=\"provisioning.home-page.remove-all-configured-repositories\">\n                Remove all configured repositories\n              </Trans>\n            }\n            onRemove={() => {\n              setShowDeleteModal(true);\n            }}\n          >\n            <Trans i18nKey=\"provisioning.home-page.configured-repositories-while-running-legacy-storage\">\n              Configured repositories will not work while running legacy storage.\n            </Trans>\n          </Alert>\n        )}\n        <ConfirmModal\n          isOpen={showDeleteModal}\n          title={t(\n            'provisioning.home-page.title-delete-all-configured-repositories',\n            'Delete all configured repositories'\n          )}\n          body={t(\n            'provisioning.home-page.confirm-delete-repositories',\n            'Are you sure you want to delete all configured repositories? This action cannot be undone.'\n          )}\n          confirmText={t('provisioning.home-page.button-delete-repositories', 'Delete repositories')}\n          onConfirm={onConfirmDelete}\n          onDismiss={() => setShowDeleteModal(false)}\n        />\n        <Stack direction=\"column\" gap={2}>\n          <TabsBar>\n            {tabInfo.map((t) => (\n              <Tab\n                key={t.value}\n                label={t.label}\n                active={activeTab === t.value}\n                onChangeTab={() => setActiveTab(t.value)}\n                title={t.title}\n              />\n            ))}\n          </TabsBar>\n          <TabContent>{renderTabContent()}</TabContent>\n        </Stack>\n      </Page.Contents>\n    </Page>\n  );\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom-v5-compat';\n\nimport { t } from '@grafana/i18n';\nimport { ConfirmModal, IconButton } from '@grafana/ui';\nimport { useDeleteRepositoryMutation } from 'app/api/clients/provisioning/v0alpha1';\n\ninterface Props {\n  name: string;\n  redirectTo?: string;\n}\n\nexport function DeleteRepositoryButton({ name, redirectTo }: Props) {\n  const [deleteRepository, request] = useDeleteRepositoryMutation();\n  const [showModal, setShowModal] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (request.isSuccess) {\n      setShowModal(false);\n      if (redirectTo) {\n        navigate(redirectTo);\n      }\n    }\n  }, [request.isSuccess, redirectTo, navigate]);\n\n  const onConfirm = useCallback(() => {\n    deleteRepository({ name });\n  }, [deleteRepository, name]);\n\n  return (\n    <>\n      <IconButton\n        name=\"trash-alt\"\n        tooltip={t('provisioning.delete-repository-button.tooltip-delete-this-repository', 'Delete this repository')}\n        disabled={request.isLoading}\n        onClick={() => {\n          setShowModal(true);\n        }}\n      />\n      <ConfirmModal\n        isOpen={showModal}\n        title={t('provisioning.delete-repository-button.title-delete-repository', 'Delete repository config')}\n        body={t(\n          'provisioning.delete-repository-button.confirm-delete-repository',\n          'Are you sure you want to delete the repository config?'\n        )}\n        confirmText={t('provisioning.delete-repository-button.button-delete', 'Delete')}\n        onConfirm={onConfirm}\n        onDismiss={() => setShowModal(false)}\n      />\n    </>\n  );\n}\n","import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom-v5-compat';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, ConfirmModal } from '@grafana/ui';\nimport { Repository, useCreateRepositoryJobsMutation } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { PROVISIONING_URL } from '../constants';\n\ninterface Props {\n  repository: Repository;\n}\n\nexport function SyncRepository({ repository }: Props) {\n  const [createJob, jobQuery] = useCreateRepositoryJobsMutation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const navigate = useNavigate();\n\n  const name = repository.metadata?.name;\n\n  const onClick = () => {\n    if (!name) {\n      return;\n    }\n    createJob({\n      name,\n      jobSpec: {\n        pull: {\n          incremental: false, // will queue a full resync job\n        },\n      },\n    });\n    setIsModalOpen(false);\n  };\n\n  const isHealthy = Boolean(repository.status?.health.healthy);\n\n  return (\n    <>\n      <Button\n        icon=\"cloud-download\"\n        variant={'secondary'}\n        tooltip={\n          isHealthy\n            ? undefined\n            : t('provisioning.sync-repository.tooltip-unhealthy-repository', 'Unable to pull an unhealthy repository')\n        }\n        disabled={jobQuery.isLoading || !name || !isHealthy}\n        onClick={onClick}\n      >\n        <Trans i18nKey=\"provisioning.sync-repository.pull\">Pull</Trans>\n      </Button>\n      {!repository.spec?.sync.enabled && (\n        <ConfirmModal\n          isOpen={isModalOpen}\n          title={t('provisioning.sync-repository.title-pull-not-enabled', 'Pull is not enabled')}\n          body={t('provisioning.sync-repository.body-edit-configuration', 'Edit the configuration')}\n          confirmText={t('provisioning.sync-repository.button-edit', 'Edit')}\n          onConfirm={() => navigate(`${PROVISIONING_URL}/${name}/edit`)}\n          onDismiss={() => setIsModalOpen(false)}\n        />\n      )}\n    </>\n  );\n}\n","import { locationService } from '@grafana/runtime';\nimport { Badge, BadgeColor, IconName } from '@grafana/ui';\nimport { Repository } from 'app/api/clients/provisioning/v0alpha1';\n\nimport { PROVISIONING_URL } from '../constants';\n\ninterface StatusBadgeProps {\n  repo?: Repository;\n}\n\nexport function StatusBadge({ repo }: StatusBadgeProps) {\n  if (!repo) {\n    return null;\n  }\n\n  let tooltip: string | undefined = undefined;\n  let color: BadgeColor = 'purple';\n  let text = 'Unknown';\n  let icon: IconName = 'exclamation-triangle';\n\n  if (repo.metadata?.deletionTimestamp) {\n    color = 'red';\n    text = 'Deleting';\n    icon = 'spinner';\n  } else if (!repo.spec?.sync?.enabled) {\n    color = 'red';\n    text = 'Automatic pulling disabled';\n    icon = 'info-circle';\n  } else if (!repo.status?.sync?.state?.length) {\n    color = 'orange';\n    text = 'Pending';\n    icon = 'spinner';\n    tooltip = 'Waiting for health check to run';\n  } else {\n    // Sync state\n    switch (repo.status?.sync?.state) {\n      case 'success':\n        icon = 'check';\n        text = 'Up-to-date';\n        color = 'green';\n        break;\n      case 'working':\n      case 'pending':\n        color = 'orange';\n        text = 'Pulling';\n        icon = 'spinner';\n        break;\n      case 'error':\n        color = 'red';\n        text = 'Error';\n        icon = 'exclamation-triangle';\n        break;\n      default:\n        break;\n    }\n  }\n\n  return (\n    <Badge\n      color={color}\n      icon={icon}\n      text={text}\n      style={{ cursor: 'pointer' }}\n      tooltip={tooltip}\n      onClick={() => {\n        locationService.push(`${PROVISIONING_URL}/${repo.metadata?.name}/?tab=overview`);\n      }}\n    />\n  );\n}\n"],"names":["RepositoryCard","repository","metadata","spec","status","name","getRepositoryMeta","meta","url","branch","branchUrl","TextLink","webhookUrl","Stack","Icon","Text","getRepositoryIcon","Card","StatusBadge","stat","index","getListURL","SyncRepository","DeleteRepositoryButton","repo","stats","RepositoryList","items","query","setQuery","filteredItems","item","instanceConnected","checkSyncSettings","FilterInput","ConnectRepositoryButton","EmptySearchResult","useRepositoryList","options","collator","a","b","titleA","titleB","TabSelection","HomePage","isLoading","settings","deleteAll","showDeleteModal","setShowDeleteModal","activeTab","setActiveTab","tabInfo","GettingStartedPage","onConfirmDelete","renderTabContent","GettingStarted","Page","Alert","ConfirmModal","TabsBar","t","Tab","TabContent","redirectTo","deleteRepository","request","showModal","setShowModal","navigate","onConfirm","createJob","jobQuery","isModalOpen","setIsModalOpen","onClick","isHealthy","tooltip","color","text","icon"],"sourceRoot":""}