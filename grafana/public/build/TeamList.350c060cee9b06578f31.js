"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1036],{99929:(S,A,e)=>{e.d(A,{Y:()=>I});var a=e(74848),x=e(96540),r=e(41053),c=e(73427),_=e(11257),d=e(59812),D=e(34418);const I=({teamId:l,roleOptions:g,disabled:h,roles:f,onApplyRoles:o,pendingRoles:u,apply:E=!1,maxWidth:T,width:y,isLoading:B})=>{const[{loading:R,value:U=f||[]},P]=(0,r.A)(async()=>{try{if(f)return f;if(E&&u?.length)return u;if(c.TP.hasPermission(_.w.ActionTeamsRolesList)&&l>0)return await(0,D.xN)(l)}catch(t){console.error("Error loading options",t)}return[]},[l,u,f]);(0,x.useEffect)(()=>{P()},[P]);const v=async t=>{E?o&&o(t):(await(0,D.G3)(t,l),await P())},s=c.TP.hasPermission(_.w.ActionTeamsRolesAdd)&&c.TP.hasPermission(_.w.ActionTeamsRolesRemove);return(0,a.jsx)(d.n,{apply:E,onRolesChange:v,roleOptions:g,appliedRoles:U,isLoading:R||B,disabled:h,basicRoleDisabled:!0,canUpdateRoles:s,maxWidth:T,width:y})}},34314:(S,A,e)=>{e.r(A),e.d(A,{TeamList:()=>p,default:()=>w});var a=e(74848),x=e(22803),r=e(96540),c=e(70255),_=e(71468),d=e(92745),D=e(63142),I=e(71555),l=e(89640),g=e(94018),h=e(41654),f=e(45861),o=e(44458),u=e(50201),E=e(18027),T=e(12737),y=e(27594),B=e(34213),R=e(13791),U=e(34418),P=e(15130),v=e(11257),s=e(99929),t=e(27644),i=e(77174);const M=new Array(3).fill(null).map((m,$)=>({id:$,uid:"",memberCount:0,name:"",orgId:0,isProvisioned:!1})),p=({teams:m,query:$,noTeams:Y,hasFetched:O,loadTeams:Q,deleteTeam:V,changeQuery:Z,totalPages:F,page:k,rolesLoading:J,changePage:q,changeSort:ee})=>{const[X,ae]=(0,r.useState)([]),K=(0,D.of)(W);(0,r.useEffect)(()=>{Q(!0)},[Q]),(0,r.useEffect)(()=>{P.TP.licensedAccessControlEnabled()&&P.TP.hasPermission(v.w.ActionRolesList)&&(0,U.RL)().then(n=>ae(n))},[]);const z=P.TP.hasPermission(v.w.ActionTeamsCreate),H=j(),te=(0,r.useMemo)(()=>[{id:"avatarUrl",header:"",disableGrow:!0,cell:({cell:{value:n}})=>O?n&&(0,a.jsx)(I.e,{src:n,alt:"User avatar"}):(0,a.jsx)(c.A,{containerClassName:K.blockSkeleton,width:24,height:24,circle:!0})},{id:"name",header:"Name",cell:({cell:{value:n},row:{original:C}})=>O?P.TP.hasPermissionInMetadata(v.w.ActionTeamsRead,C)?(0,a.jsx)(l.Y,{color:"primary",inline:!1,href:`/org/teams/edit/${C.uid}`,title:(0,d.t)("teams.team-list.columns.title-edit-team","Edit team"),children:n}):n:(0,a.jsx)(c.A,{width:100}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:n}})=>O?n:(0,a.jsx)(c.A,{width:60}),sortType:"string"},{id:"memberCount",header:"Members",disableGrow:!0,cell:({cell:{value:n}})=>O?n:(0,a.jsx)(c.A,{width:40}),sortType:"number"},...H?[{id:"role",header:"Role",cell:({cell:{value:n},row:{original:C}})=>O?P.TP.hasPermissionInMetadata(v.w.ActionTeamsRolesList,C)&&(0,a.jsx)(s.Y,{teamId:C.id,roles:C.roles||[],isLoading:J,roleOptions:X,width:40}):(0,a.jsx)(c.A,{width:320,height:32,containerClassName:K.blockSkeleton})}]:[],{id:"isProvisioned",header:"",cell:({cell:{value:n}})=>O?!!n&&(0,a.jsx)(g.v,{colorIndex:14,name:"Provisioned"}):(0,a.jsx)(c.A,{width:240})},{id:"actions",header:"",disableGrow:!0,cell:({row:{original:n}})=>{if(!O)return(0,a.jsxs)(h.B,{direction:"row",justifyContent:"flex-end",alignItems:"center",children:[(0,a.jsx)(c.A,{containerClassName:K.blockSkeleton,width:16,height:16}),(0,a.jsx)(c.A,{containerClassName:K.blockSkeleton,width:22,height:24})]});const C=P.TP.hasPermissionInMetadata(v.w.ActionTeamsRead,n),G=P.TP.hasPermissionInMetadata(v.w.ActionTeamsDelete,n)&&!n.isProvisioned;return(0,a.jsxs)(h.B,{direction:"row",justifyContent:"flex-end",gap:2,children:[C&&(0,a.jsx)(f.z9,{href:`org/teams/edit/${n.uid}`,"aria-label":(0,d.t)("teams.team-list.columns.aria-label-edit-team","Edit team {{teamName}}",{teamName:n.name}),icon:"pen",size:"sm",variant:"secondary",tooltip:(0,d.t)("teams.team-list.columns.tooltip-edit-team","Edit team")}),(0,a.jsx)(o.e,{"aria-label":(0,d.t)("teams.team-list.columns.aria-label-delete-button","Delete team {{teamName}}",{teamName:n.name}),size:"sm",disabled:!G,onConfirm:()=>V(n.uid)})]})}}],[H,O,J,X,V,K]);return(0,a.jsx)(R.Y,{navId:"teams",actions:Y?void 0:(0,a.jsx)(f.z9,{href:z?"org/teams/new":"#",disabled:!z,children:(0,a.jsx)(d.x6,{i18nKey:"teams.team-list.new-team",children:"New Team"})}),children:(0,a.jsxs)(R.Y.Contents,{children:[Y?(0,a.jsx)(u.p,{variant:"call-to-action",button:(0,a.jsx)(f.z9,{disabled:!z,href:"org/teams/new",icon:"users-alt",size:"lg",children:(0,a.jsx)(d.x6,{i18nKey:"teams.empty-state.button-title",children:"New team"})}),message:(0,d.t)("teams.empty-state.title","You haven't created any teams yet"),children:(0,a.jsxs)(d.x6,{i18nKey:"teams.empty-state.pro-tip",children:["Assign folder and dashboard permissions to teams instead of users to ease administration."," ",(0,a.jsx)(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/administration/team-management",children:"Learn more"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"page-action-bar",children:(0,a.jsx)(E.I,{grow:!0,children:(0,a.jsx)(T.Z,{placeholder:(0,d.t)("teams.team-list.placeholder-search-teams","Search teams"),value:$,onChange:Z})})}),O&&m.length===0?(0,a.jsx)(u.p,{variant:"not-found",message:(0,d.t)("teams.empty-state.message","No teams found")}):(0,a.jsxs)(h.B,{direction:"column",gap:2,children:[(0,a.jsx)(y.j,{columns:te,data:O?m:M,getRowId:n=>String(n.id),fetchData:ee}),(0,a.jsx)(h.B,{justifyContent:"flex-end",children:(0,a.jsx)(B.d,{hideWhenSinglePage:!0,currentPage:k,numberOfPages:F,onNavigate:q})})]})]}),!$&&(0,a.jsx)(t.$,{page:"teams"})]})})};function j(){return P.TP.licensedAccessControlEnabled()&&P.TP.hasPermission(v.w.ActionTeamsRolesList)&&P.TP.hasPermission(v.w.ActionRolesList)}function N(m){return{teams:m.teams.teams,query:m.teams.query,perPage:m.teams.perPage,page:m.teams.page,noTeams:m.teams.noTeams,totalPages:m.teams.totalPages,hasFetched:m.teams.hasFetched,rolesLoading:m.teams.rolesLoading}}const L={loadTeams:i.Bu,deleteTeam:i.To,changePage:i.yd,changeQuery:i.nM,changeSort:i.Vk},w=(0,_.connect)(N,L)(p),W=m=>({blockSkeleton:(0,x.css)({lineHeight:1,display:"flex"})})},77174:(S,A,e)=>{e.d(A,{Bu:()=>g,It:()=>U,To:()=>o,Vk:()=>T,aK:()=>R,eo:()=>f,n7:()=>B,nC:()=>P,nM:()=>u,yd:()=>E});var a=e(2543),x=e.n(a),r=e(68143),c=e(6890),_=e(73427),d=e(81871),D=e(11257),I=e(67145),l=e(27104);function g(s=!1){return async(t,i)=>{const{query:M,page:p,perPage:j,sort:N}=i().teams;if(!_.TP.hasPermission(D.w.ActionTeamsRead)){t((0,l.Q9)({teams:[],totalCount:0,page:1,perPage:j,noTeams:!0}));return}const L=await(0,r.AI)().get("/api/teams/search",(0,d.F)({query:M,page:p,perpage:j,sort:N}));let b=!1;if(s&&(b=L.teams.length===0),_.TP.licensedAccessControlEnabled()&&_.TP.hasPermission(D.w.ActionTeamsRolesList)){t((0,l.dJ)());const w=L?.teams.map(m=>m.id),W=await(0,r.AI)().post("/api/access-control/teams/roles/search",{teamIds:w});L.teams.forEach(m=>{m.roles=W?W[m.id]||[]:[]}),t((0,l.jE)())}t((0,l.Q9)({noTeams:b,...L}))}}const h=(0,a.debounce)(s=>s(g()),500);function f(s){return async t=>{const i=await(0,r.AI)().get(`/api/teams/${s}`,(0,d.F)());t((0,l.$T)(i)),t((0,c.Vz)((0,I.R)(i)))}}function o(s){return async t=>{await(0,r.AI)().delete(`/api/teams/${s}`),await _.TP.fetchUserPermissions(),t(g())}}function u(s){return async t=>{t((0,l.L5)(s)),h(t)}}function E(s){return async t=>{t((0,l.EC)(s)),t(g())}}function T({sortBy:s}){const t=s.length?`${s[0].id}-${s[0].desc?"desc":"asc"}`:void 0;return async i=>{i((0,l.$u)(t)),i(g())}}function y(){return async(s,t)=>{const i=t().team.team,M=await getBackendSrv().get(`/api/teams/${i.uid}/members`);s(teamMembersLoaded(M))}}function B(s,t){return async(i,M)=>{const p=M().team.team;await(0,r.AI)().put(`/api/teams/${p.uid}`,{name:s,email:t}),i(f(p.uid))}}function R(){return async(s,t)=>{const i=t().team.team,M=await(0,r.AI)().get(`/api/teams/${i.uid}/groups`);s((0,l.tC)(M))}}function U(s){return async(t,i)=>{const M=i().team.team;await(0,r.AI)().post(`/api/teams/${M.uid}/groups`,{groupId:s}),t(R())}}function P(s){return async(t,i)=>{const M=i().team.team;await(0,r.AI)().delete(`/api/teams/${M.uid}/groups?groupId=${encodeURIComponent(s)}`),t(R())}}function v(s){return async t=>{await getBackendSrv().put(`/api/teams/${s.teamId}/members/${s.userId}`,{permission:s.permission}),t(y())}}},67145:(S,A,e)=>{e.d(A,{R:()=>h,X:()=>f});var a=e(92745),x=e(62061),r=e(25096),c=e(65642),_=e(15130),d=e(42939),D=e(11257),I=e(70590);const g={avatarUrl:e.p+"static/img/user_profile.4d4fc140.png",id:1,uid:"",name:"Loading",email:"loading",memberCount:0,permission:I.Xe.Member,accessControl:{isEditor:!1},orgId:0,updated:"",isProvisioned:!1};function h(o){const u={img:o.avatarUrl,id:"team-"+o.uid,subTitle:(0,a.t)("teams.build-nav-model.nav-model.subTitle.manage-members-and-settings","Manage members and settings"),url:`org/teams/edit/${o.uid}`,text:o.name,children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${o.uid}`,text:(0,a.t)("teams.build-nav-model.nav-model.text.settings","Settings"),url:`org/teams/edit/${o.uid}/settings`}]};(o===g||_.TP.hasPermissionInMetadata(D.w.ActionTeamsPermissionsRead,o))&&u.children.unshift({active:!1,icon:"users-alt",id:`team-members-${o.uid}`,text:(0,a.t)("teams.build-nav-model.text.members","Members"),url:`org/teams/edit/${o.uid}/members`});const E={active:!1,icon:"sync",id:`team-groupsync-${o.uid}`,text:(0,a.t)("teams.build-nav-model.team-group-sync.text.external-group-sync","External group sync"),url:`org/teams/edit/${o.uid}/groupsync`},T=o===g;return(0,d.z5)()&&(E.tabSuffix=()=>(0,r.J)({experimentId:T?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,x.a)("teamsync")?(T||_.TP.hasPermissionInMetadata(D.w.ActionTeamsPermissionsRead,o))&&u.children.push(E):c.Ay.featureToggles.featureHighlights&&u.children.push({...E,tabSuffix:()=>(0,r.J)({experimentId:T?"":"feature-highlights-team-sync-badge"})}),u}function f(o){const u=h(g);let E;for(const T of u.children)if(T.id.indexOf(o)>0){T.active=!0,E=T;break}return{main:u,node:E}}}}]);

//# sourceMappingURL=TeamList.350c060cee9b06578f31.js.map