(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[362],{66570:Nt=>{"use strict";Nt.exports=at,Nt.exports.default=at;function at(l,s,n){n=n||2;var o=s&&s.length,_=o?s[0]*n:l.length,D=r(l,0,_,n,!0),N=[];if(!D||D.next===D.prev)return N;var V,H,rt,it,ct,gt,yt;if(o&&(D=v(l,s,D,n)),l.length>80*n){V=rt=l[0],H=it=l[1];for(var pt=n;pt<_;pt+=n)ct=l[pt],gt=l[pt+1],ct<V&&(V=ct),gt<H&&(H=gt),ct>rt&&(rt=ct),gt>it&&(it=gt);yt=Math.max(rt-V,it-H),yt=yt!==0?32767/yt:0}return L(D,N,n,V,H,yt,0),N}function r(l,s,n,o,_){var D,N;if(_===st(l,s,n,o)>0)for(D=s;D<n;D+=o)N=T(D,l[D],l[D+1],N);else for(D=n-o;D>=s;D-=o)N=T(D,l[D],l[D+1],N);return N&&g(N,N.next)&&(K(N),N=N.next),N}function U(l,s){if(!l)return l;s||(s=l);var n=l,o;do if(o=!1,!n.steiner&&(g(n,n.next)||m(n.prev,n,n.next)===0)){if(K(n),n=s=n.prev,n===n.next)break;o=!0}else n=n.next;while(o||n!==s);return s}function L(l,s,n,o,_,D,N){if(l){!N&&D&&p(l,o,_,D);for(var V=l,H,rt;l.prev!==l.next;){if(H=l.prev,rt=l.next,D?X(l,o,_,D):Y(l)){s.push(H.i/n|0),s.push(l.i/n|0),s.push(rt.i/n|0),K(l),l=rt.next,V=rt.next;continue}if(l=rt,l===V){N?N===1?(l=I(U(l),s,n),L(l,s,n,o,_,D,2)):N===2&&C(l,s,n,o,_,D):L(U(l),s,n,o,_,D,1);break}}}}function Y(l){var s=l.prev,n=l,o=l.next;if(m(s,n,o)>=0)return!1;for(var _=s.x,D=n.x,N=o.x,V=s.y,H=n.y,rt=o.y,it=_<D?_<N?_:N:D<N?D:N,ct=V<H?V<rt?V:rt:H<rt?H:rt,gt=_>D?_>N?_:N:D>N?D:N,yt=V>H?V>rt?V:rt:H>rt?H:rt,pt=o.next;pt!==s;){if(pt.x>=it&&pt.x<=gt&&pt.y>=ct&&pt.y<=yt&&A(_,V,D,H,N,rt,pt.x,pt.y)&&m(pt.prev,pt,pt.next)>=0)return!1;pt=pt.next}return!0}function X(l,s,n,o){var _=l.prev,D=l,N=l.next;if(m(_,D,N)>=0)return!1;for(var V=_.x,H=D.x,rt=N.x,it=_.y,ct=D.y,gt=N.y,yt=V<H?V<rt?V:rt:H<rt?H:rt,pt=it<ct?it<gt?it:gt:ct<gt?ct:gt,Dt=V>H?V>rt?V:rt:H>rt?H:rt,Gt=it>ct?it>gt?it:gt:ct>gt?ct:gt,$t=z(yt,pt,s,n,o),te=z(Dt,Gt,s,n,o),Yt=l.prevZ,Zt=l.nextZ;Yt&&Yt.z>=$t&&Zt&&Zt.z<=te;){if(Yt.x>=yt&&Yt.x<=Dt&&Yt.y>=pt&&Yt.y<=Gt&&Yt!==_&&Yt!==N&&A(V,it,H,ct,rt,gt,Yt.x,Yt.y)&&m(Yt.prev,Yt,Yt.next)>=0||(Yt=Yt.prevZ,Zt.x>=yt&&Zt.x<=Dt&&Zt.y>=pt&&Zt.y<=Gt&&Zt!==_&&Zt!==N&&A(V,it,H,ct,rt,gt,Zt.x,Zt.y)&&m(Zt.prev,Zt,Zt.next)>=0))return!1;Zt=Zt.nextZ}for(;Yt&&Yt.z>=$t;){if(Yt.x>=yt&&Yt.x<=Dt&&Yt.y>=pt&&Yt.y<=Gt&&Yt!==_&&Yt!==N&&A(V,it,H,ct,rt,gt,Yt.x,Yt.y)&&m(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.prevZ}for(;Zt&&Zt.z<=te;){if(Zt.x>=yt&&Zt.x<=Dt&&Zt.y>=pt&&Zt.y<=Gt&&Zt!==_&&Zt!==N&&A(V,it,H,ct,rt,gt,Zt.x,Zt.y)&&m(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.nextZ}return!0}function I(l,s,n){var o=l;do{var _=o.prev,D=o.next.next;!g(_,D)&&O(_,o,o.next,D)&&et(_,D)&&et(D,_)&&(s.push(_.i/n|0),s.push(o.i/n|0),s.push(D.i/n|0),K(o),K(o.next),o=l=D),o=o.next}while(o!==l);return U(o)}function C(l,s,n,o,_,D){var N=l;do{for(var V=N.next.next;V!==N.prev;){if(N.i!==V.i&&M(N,V)){var H=R(N,V);N=U(N,N.next),H=U(H,H.next),L(N,s,n,o,_,D,0),L(H,s,n,o,_,D,0);return}V=V.next}N=N.next}while(N!==l)}function v(l,s,n,o){var _=[],D,N,V,H,rt;for(D=0,N=s.length;D<N;D++)V=s[D]*o,H=D<N-1?s[D+1]*o:l.length,rt=r(l,V,H,o,!1),rt===rt.next&&(rt.steiner=!0),_.push(f(rt));for(_.sort(W),D=0;D<_.length;D++)n=d(_[D],n);return n}function W(l,s){return l.x-s.x}function d(l,s){var n=a(l,s);if(!n)return s;var o=R(n,l);return U(o,o.next),U(n,n.next)}function a(l,s){var n=s,o=l.x,_=l.y,D=-1/0,N;do{if(_<=n.y&&_>=n.next.y&&n.next.y!==n.y){var V=n.x+(_-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(V<=o&&V>D&&(D=V,N=n.x<n.next.x?n:n.next,V===o))return N}n=n.next}while(n!==s);if(!N)return null;var H=N,rt=N.x,it=N.y,ct=1/0,gt;n=N;do o>=n.x&&n.x>=rt&&o!==n.x&&A(_<it?o:D,_,rt,it,_<it?D:o,_,n.x,n.y)&&(gt=Math.abs(_-n.y)/(o-n.x),et(n,l)&&(gt<ct||gt===ct&&(n.x>N.x||n.x===N.x&&E(N,n)))&&(N=n,ct=gt)),n=n.next;while(n!==H);return N}function E(l,s){return m(l.prev,l,s.prev)<0&&m(s.next,l,l.next)<0}function p(l,s,n,o){var _=l;do _.z===0&&(_.z=z(_.x,_.y,s,n,o)),_.prevZ=_.prev,_.nextZ=_.next,_=_.next;while(_!==l);_.prevZ.nextZ=null,_.prevZ=null,u(_)}function u(l){var s,n,o,_,D,N,V,H,rt=1;do{for(n=l,l=null,D=null,N=0;n;){for(N++,o=n,V=0,s=0;s<rt&&(V++,o=o.nextZ,!!o);s++);for(H=rt;V>0||H>0&&o;)V!==0&&(H===0||!o||n.z<=o.z)?(_=n,n=n.nextZ,V--):(_=o,o=o.nextZ,H--),D?D.nextZ=_:l=_,_.prevZ=D,D=_;n=o}D.nextZ=null,rt*=2}while(N>1);return l}function z(l,s,n,o,_){return l=(l-n)*_|0,s=(s-o)*_|0,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,l|s<<1}function f(l){var s=l,n=l;do(s.x<n.x||s.x===n.x&&s.y<n.y)&&(n=s),s=s.next;while(s!==l);return n}function A(l,s,n,o,_,D,N,V){return(_-N)*(s-V)>=(l-N)*(D-V)&&(l-N)*(o-V)>=(n-N)*(s-V)&&(n-N)*(D-V)>=(_-N)*(o-V)}function M(l,s){return l.next.i!==s.i&&l.prev.i!==s.i&&!ht(l,s)&&(et(l,s)&&et(s,l)&&J(l,s)&&(m(l.prev,l,s.prev)||m(l,s.prev,s))||g(l,s)&&m(l.prev,l,l.next)>0&&m(s.prev,s,s.next)>0)}function m(l,s,n){return(s.y-l.y)*(n.x-s.x)-(s.x-l.x)*(n.y-s.y)}function g(l,s){return l.x===s.x&&l.y===s.y}function O(l,s,n,o){var _=q(m(l,s,n)),D=q(m(l,s,o)),N=q(m(n,o,l)),V=q(m(n,o,s));return!!(_!==D&&N!==V||_===0&&b(l,n,s)||D===0&&b(l,o,s)||N===0&&b(n,l,o)||V===0&&b(n,s,o))}function b(l,s,n){return s.x<=Math.max(l.x,n.x)&&s.x>=Math.min(l.x,n.x)&&s.y<=Math.max(l.y,n.y)&&s.y>=Math.min(l.y,n.y)}function q(l){return l>0?1:l<0?-1:0}function ht(l,s){var n=l;do{if(n.i!==l.i&&n.next.i!==l.i&&n.i!==s.i&&n.next.i!==s.i&&O(n,n.next,l,s))return!0;n=n.next}while(n!==l);return!1}function et(l,s){return m(l.prev,l,l.next)<0?m(l,s,l.next)>=0&&m(l,l.prev,s)>=0:m(l,s,l.prev)<0||m(l,l.next,s)<0}function J(l,s){var n=l,o=!1,_=(l.x+s.x)/2,D=(l.y+s.y)/2;do n.y>D!=n.next.y>D&&n.next.y!==n.y&&_<(n.next.x-n.x)*(D-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next;while(n!==l);return o}function R(l,s){var n=new Q(l.i,l.x,l.y),o=new Q(s.i,s.x,s.y),_=l.next,D=s.prev;return l.next=s,s.prev=l,n.next=_,_.prev=n,o.next=n,n.prev=o,D.next=o,o.prev=D,o}function T(l,s,n,o){var _=new Q(l,s,n);return o?(_.next=o.next,_.prev=o,o.next.prev=_,o.next=_):(_.prev=_,_.next=_),_}function K(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Q(l,s,n){this.i=l,this.x=s,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}at.deviation=function(l,s,n,o){var _=s&&s.length,D=_?s[0]*n:l.length,N=Math.abs(st(l,0,D,n));if(_)for(var V=0,H=s.length;V<H;V++){var rt=s[V]*n,it=V<H-1?s[V+1]*n:l.length;N-=Math.abs(st(l,rt,it,n))}var ct=0;for(V=0;V<o.length;V+=3){var gt=o[V]*n,yt=o[V+1]*n,pt=o[V+2]*n;ct+=Math.abs((l[gt]-l[pt])*(l[yt+1]-l[gt+1])-(l[gt]-l[yt])*(l[pt+1]-l[gt+1]))}return N===0&&ct===0?0:Math.abs((ct-N)/N)};function st(l,s,n,o){for(var _=0,D=s,N=n-o;D<n;D+=o)_+=(l[N]-l[D])*(l[D+1]+l[N+1]),N=D;return _}at.flatten=function(l){for(var s=l[0][0].length,n={vertices:[],holes:[],dimensions:s},o=0,_=0;_<l.length;_++){for(var D=0;D<l[_].length;D++)for(var N=0;N<s;N++)n.vertices.push(l[_][D][N]);_>0&&(o+=l[_-1].length,n.holes.push(o))}return n}},77239:(Nt,at,r)=>{"use strict";r.d(at,{B:()=>m});var U=r(74848),L=r(22803),Y=r(96540),X=r(63142),I=r(53371),C=r(45967),v=r(64394),W=r(71479),d=r(55978),a=r(55302),E=(O=>(O[O.Leading=0]="Leading",O[O.Trailing=1]="Trailing",O))(E||{});const p=({color:O=v.F,colorIndicator:b=d.Ev,position:q=0,lineStyle:ht})=>{const et=(0,X.of)(u);return b===d.fX.series?(0,U.jsx)(W.p,{color:O,lineStyle:ht,className:q===0?et.leading:et.trailing}):(0,U.jsx)("span",{style:{backgroundColor:O},className:(0,L.cx)(q===0?et.leading:et.trailing,(0,a.L$)(b,et))})},u=O=>({leading:(0,L.css)({marginRight:O.spacing(.5)}),trailing:(0,L.css)({marginLeft:O.spacing(.5)}),value:(0,L.css)({width:"12px",height:"12px",borderRadius:O.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,L.css)({}),pie_1_4:(0,L.css)({}),pie_2_4:(0,L.css)({}),pie_3_4:(0,L.css)({}),marker_sm:(0,L.css)({width:"4px",height:"4px",borderRadius:O.shape.radius.circle,minWidth:"4px"}),marker_md:(0,L.css)({width:"8px",height:"8px",borderRadius:O.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,L.css)({width:"12px",height:"12px",borderRadius:O.shape.radius.circle,minWidth:"12px"})});var z=(O=>(O.label="label",O.value="value",O))(z||{});const f="Copied to clipboard",A=2*1e3,M=7,m=({label:O,value:b,color:q,colorIndicator:ht,colorPlacement:et=d.lJ.first,justify:J="flex-start",isActive:R=!1,marginRight:T="0px",isPinned:K,lineStyle:Q,showValueScroll:st})=>{const l=(0,X.of)(g,J,T),s=st?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"auto"}:{whiteSpace:"pre-line",wordBreak:"break-word",lineHeight:1.2},[n,o]=(0,Y.useState)(!1),[_,D]=(0,Y.useState)(null),[N,V]=(0,Y.useState)(!1),H=(0,Y.useRef)(null),rt=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{let pt;return N&&(pt=setTimeout(()=>{V(!1)},A)),()=>{window.clearTimeout(pt)}},[N]);const it=async(pt,Dt)=>{if(!(navigator?.clipboard&&window.isSecureContext)){ct(pt,Dt);return}try{await navigator.clipboard.writeText(pt),D({[`${Dt}`]:pt}),V(!0)}catch{D(null)}},ct=(pt,Dt)=>{const Gt=document.createElement("textarea");H.current?.appendChild(Gt),Gt.value=pt,Gt.focus(),Gt.select();try{document.execCommand("copy")&&(D({[`${Dt}`]:pt}),V(!0))}catch($t){console.error("Unable to copy to clipboard",$t)}Gt.remove()},gt=pt=>{pt.currentTarget.offsetWidth<pt.currentTarget.scrollWidth&&o(!0)},yt=()=>o(!1);return O.length*M>window.innerWidth/2&&(O=O.replaceAll("{",`{
  `).replaceAll("}",`
}`).replaceAll(", ",`,
  `)),(0,U.jsxs)("div",{className:l.contentWrapper,children:[(q||O)&&(0,U.jsxs)("div",{className:l.valueWrapper,children:[q&&et===d.lJ.first&&(0,U.jsx)(p,{color:q,colorIndicator:ht,lineStyle:Q}),K?(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(C.m,{content:O,interactive:!1,show:n,children:(0,U.jsxs)(U.Fragment,{children:[N&&_?.label&&(0,U.jsx)(I.r,{placement:"top",referenceElement:H.current,children:f}),(0,U.jsx)("div",{className:(0,L.cx)(l.label,R&&l.activeSeries,navigator?.clipboard&&l.copy),onMouseEnter:gt,onMouseLeave:yt,onClick:()=>it(O,"label"),ref:H,children:O})]})})}):(0,U.jsx)("div",{className:(0,L.cx)(l.label,R&&l.activeSeries),children:O})]}),(0,U.jsxs)("div",{className:l.valueWrapper,children:[q&&et===d.lJ.leading&&(0,U.jsx)(p,{color:q,colorIndicator:ht,position:E.Leading,lineStyle:Q}),K?(0,U.jsxs)(U.Fragment,{children:[N&&_?.value&&(0,U.jsx)(I.r,{placement:"top",referenceElement:rt.current,children:f}),(0,U.jsx)("div",{className:(0,L.cx)(l.value,R,navigator?.clipboard&&l.copy),style:s,onClick:()=>it(b?b.toString():"","value"),ref:rt,children:b})]}):(0,U.jsx)("div",{className:(0,L.cx)(l.value,R),style:s,children:b}),q&&et===d.lJ.trailing&&(0,U.jsx)(p,{color:q,colorIndicator:ht,position:E.Trailing,lineStyle:Q})]})]})},g=(O,b,q)=>({contentWrapper:(0,L.css)({display:"flex",alignItems:"start",justifyContent:b,marginRight:q}),label:(0,L.css)({color:O.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:O.spacing(2)}),value:(0,L.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,L.css)({display:"flex",alignItems:"center"}),activeSeries:(0,L.css)({fontWeight:O.typography.fontWeightBold,color:O.colors.text.maxContrast}),copy:(0,L.css)({cursor:"pointer"})})},70362:(Nt,at,r)=>{"use strict";r.d(at,{i:()=>v});var U=r(74848),L=r(22803),Y=r(63142),X=r(28134),I=r(77239),C=r(53049);const v=({displayValues:d,links:a,header:E="Exemplar",maxHeight:p})=>{const u=(0,Y.of)(W,0,p),z=d.find(f=>f.name==="Time");return d=d.filter(f=>f.name!=="Time"),(0,U.jsxs)("div",{className:u.exemplarWrapper,children:[(0,U.jsxs)("div",{className:u.exemplarHeader,children:[(0,U.jsx)("span",{className:u.title,children:E}),z&&(0,U.jsx)("span",{className:u.time,children:(0,C.A)(z.valueString)})]}),(0,U.jsx)("div",{className:u.exemplarContent,children:d.map((f,A)=>(0,U.jsx)(I.B,{label:f.name,value:(0,C.A)(f.valueString),justify:"space-between",isPinned:!1},A))}),a&&a.length>0&&(0,U.jsx)("div",{className:u.exemplarFooter,children:a.map((f,A)=>(0,U.jsx)(X.R,{link:f,buttonProps:{size:"md"}},A))})]})},W=(d,a=0,E)=>({exemplarWrapper:(0,L.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:d.shape.radius.default,background:d.colors.background.primary,border:`1px solid ${d.colors.border.weak}`}),exemplarHeader:(0,L.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:d.spacing(.5),color:d.colors.text.secondary,padding:d.spacing(1)}),time:(0,L.css)({color:d.colors.text.primary}),exemplarContent:(0,L.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${d.colors.border.medium}`,padding:d.spacing(1),overflowY:"auto",maxHeight:E}),exemplarFooter:(0,L.css)({display:"flex",flexDirection:"column",padding:d.spacing(1),borderTop:`1px solid ${d.colors.border.medium}`,gap:4}),linkButton:(0,L.css)({width:"fit-content"}),label:(0,L.css)({color:d.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:d.spacing(.5)}),value:(0,L.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,L.css)({fontWeight:d.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},53497:(Nt,at,r)=>{"use strict";r.d(at,{DY:()=>X,G4:()=>v,Sq:()=>d,T5:()=>W,W_:()=>L,_7:()=>Y,fX:()=>I,wq:()=>C,yQ:()=>a,yu:()=>E});var U=r(739),L=(p=>(p.Point="point",p.Line="line",p.Polygon="polygon",p.Any="*any*",p))(L||{});const Y=5;var X=(p=>(p.Left="left",p.Center="center",p.Right="right",p))(X||{}),I=(p=>(p.Top="top",p.Middle="middle",p.Bottom="bottom",p))(I||{}),C=(p=>(p.Left="left",p.Center="center",p.Right="right",p))(C||{}),v=(p=>(p.Top="top",p.Center="center",p.Bottom="bottom",p))(v||{});const W=Object.freeze({size:{fixed:Y,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:U.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:U.WQ.Mod,min:-360,max:360}});var d=(p=>(p.color="fill",p.opacity="fill-opacity",p.lineWidth="stroke-width",p))(d||{}),a=(p=>(p.color="marker-color",p.size="marker-size",p))(a||{}),E=(p=>(p.color="stroke",p.lineWidth="stroke-width",p))(E||{})},53049:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>X});var U=r(74848),L=r(22803),Y=r(46300);const X=I=>(0,Y.gU)(I)?(0,U.jsx)("a",{href:I,target:"_blank",className:(0,L.cx)("external-link"),rel:"noreferrer",children:I}):I},46300:(Nt,at,r)=>{"use strict";r.d(at,{rd:()=>_t,q:()=>Kt,G_:()=>Lt,ue:()=>xt,sN:()=>St,cA:()=>mt,o3:()=>Xt,gU:()=>Vt,Bz:()=>It,Lc:()=>Ft});var U=r(34120),L=r(50071),Y=r(32135),X=r(90025),I=r(74238),C=r(4087),v=r(9703),W=r(70915),d=r(82241),a=r(60764),E=r(6933);class p extends X.A{constructor(i){super(),this.map_=i}dispatchRenderEvent(i,y){(0,C.b0)()}calculateMatrices2D(i){const y=i.viewState,w=i.coordinateToPixelTransform,k=i.pixelToCoordinateTransform;(0,v.Zz)(w,i.size[0]/2,i.size[1]/2,1/y.resolution,-1/y.resolution,-y.rotation,-y.center[0],-y.center[1]),(0,v.T9)(k,w)}forEachFeatureAtCoordinate(i,y,w,k,ut,Et,bt,zt){let ne;const de=y.viewState;function le(he,me,We,be){return ut.call(Et,me,he?We:null,be)}const ge=de.projection,Ie=(0,E.Li)(i.slice(),ge),Ke=[[0,0]];if(ge.canWrapX()&&k){const he=ge.getExtent(),me=(0,W.RG)(he);Ke.push([-me,0],[me,0])}const Je=y.layerStatesArray,ze=Je.length,we=[],$e=[];for(let he=0;he<Ke.length;he++)for(let me=ze-1;me>=0;--me){const We=Je[me],be=We.layer;if(be.hasRenderer()&&(0,a.l)(We,de)&&bt.call(zt,be)){const je=be.getRenderer(),ke=be.getSource();if(je&&ke){const Qe=ke.getWrapX()?Ie:i,sn=le.bind(null,We.managed);$e[0]=Qe[0]+Ke[he][0],$e[1]=Qe[1]+Ke[he][1],ne=je.forEachFeatureAtCoordinate($e,y,w,sn,we)}if(ne)return ne}}if(we.length===0)return;const Ue=1/we.length;return we.forEach((he,me)=>he.distanceSq+=me*Ue),we.sort((he,me)=>he.distanceSq-me.distanceSq),we.some(he=>ne=he.callback(he.feature,he.layer,he.geometry)),ne}hasFeatureAtCoordinate(i,y,w,k,ut,Et){return this.forEachFeatureAtCoordinate(i,y,w,k,I.rT,this,ut,Et)!==void 0}getMap(){return this.map_}renderFrame(i){(0,C.b0)()}scheduleExpireIconCache(i){d.u.canExpireCache()&&i.postRenderFunctions.push(u)}}function u(tt,i){d.u.expire()}const z=p;var f=r(28450),A=r(9960),M=r(83984),m=r(25176),g=r(38774),O=r(9438),b=r(68711);class q extends z{constructor(i){super(i),this.fontChangeListenerKey_=(0,O.KT)(g.yY,f.A.PROPERTYCHANGE,i.redrawText.bind(i)),this.element_=document.createElement("div");const y=this.element_.style;y.position="absolute",y.width="100%",y.height="100%",y.zIndex="0",this.element_.className=m.XI+" ol-layers";const w=i.getViewport();w.insertBefore(this.element_,w.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(i,y){const w=this.getMap();if(w.hasListener(i)){const k=new A.A(i,void 0,y);w.dispatchEvent(k)}}disposeInternal(){(0,O.JH)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(i){if(!i){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(i),this.dispatchRenderEvent(M.A.PRECOMPOSE,i);const y=i.layerStatesArray.sort(function(Et,bt){return Et.zIndex-bt.zIndex}),w=i.viewState;this.children_.length=0;const k=[];let ut=null;for(let Et=0,bt=y.length;Et<bt;++Et){const zt=y[Et];i.layerIndex=Et;const ne=zt.layer,de=ne.getSourceState();if(!(0,a.l)(zt,w)||de!="ready"&&de!="undefined"){ne.unrender();continue}const le=ne.render(i,ut);le&&(le!==ut&&(this.children_.push(le),ut=le),"getDeclutter"in ne&&k.push(ne))}for(let Et=k.length-1;Et>=0;--Et)k[Et].renderDeclutter(i);(0,b.WM)(this.element_,this.children_),this.dispatchRenderEvent(M.A.POSTCOMPOSE,i),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(i)}}const ht=q;var et=r(6837),J=r(35598),R=r(10277),T=r(73445);const K={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Q=r(79332),st=r(7771);class l extends Q.A{constructor(i,y){super(i),this.map_=i,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=y===void 0?1:y,this.down_=null;const w=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=w,this.pointerdownListenerKey_=(0,O.KT)(w,K.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=(0,O.KT)(w,K.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(et.A.TOUCHMOVE,this.boundHandleTouchMove_,st.FT?{passive:!1}:!1)}emulateClick_(i){let y=new R.A(T.A.CLICK,this.map_,i);this.dispatchEvent(y),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,y=new R.A(T.A.DBLCLICK,this.map_,i),this.dispatchEvent(y)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const w=new R.A(T.A.SINGLECLICK,this.map_,i);this.dispatchEvent(w)},250)}updateActivePointers_(i){const y=i,w=y.pointerId;if(y.type==T.A.POINTERUP||y.type==T.A.POINTERCANCEL){delete this.trackedTouches_[w];for(const k in this.trackedTouches_)if(this.trackedTouches_[k].target!==y.target){delete this.trackedTouches_[k];break}}else(y.type==T.A.POINTERDOWN||y.type==T.A.POINTERMOVE)&&(this.trackedTouches_[w]=y);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(i){this.updateActivePointers_(i);const y=new R.A(T.A.POINTERUP,this.map_,i,void 0,void 0,this.activePointers_);this.dispatchEvent(y),this.emulateClicks_&&!y.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(i)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(O.JH),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(i){return i.button===0}handlePointerDown_(i){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(i);const y=new R.A(T.A.POINTERDOWN,this.map_,i,void 0,void 0,this.activePointers_);if(this.dispatchEvent(y),this.down_=new PointerEvent(i.type,i),Object.defineProperty(this.down_,"target",{writable:!1,value:i.target}),this.dragListenerKeys_.length===0){const w=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,O.KT)(w,T.A.POINTERMOVE,this.handlePointerMove_,this),(0,O.KT)(w,T.A.POINTERUP,this.handlePointerUp_,this),(0,O.KT)(this.element_,T.A.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==w&&this.dragListenerKeys_.push((0,O.KT)(this.element_.getRootNode(),T.A.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(i){if(this.isMoving_(i)){this.updateActivePointers_(i),this.dragging_=!0;const y=new R.A(T.A.POINTERDRAG,this.map_,i,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(y)}}relayMoveEvent_(i){this.originalPointerMoveEvent_=i;const y=!!(this.down_&&this.isMoving_(i));this.dispatchEvent(new R.A(T.A.POINTERMOVE,this.map_,i,y))}handleTouchMove_(i){const y=this.originalPointerMoveEvent_;(!y||y.defaultPrevented)&&(typeof i.cancelable!="boolean"||i.cancelable===!0)&&i.preventDefault()}isMoving_(i){return this.dragging_||Math.abs(i.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(i.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&((0,O.JH)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(et.A.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,O.JH)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(O.JH),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const s=l;var n=r(95801),o=r(82585);const _={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var D=r(90588),N=r(43530);const V=1/0;class H{constructor(i,y){this.priorityFunction_=i,this.keyFunction_=y,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,(0,N.I)(this.queuedElements_)}dequeue(){const i=this.elements_,y=this.priorities_,w=i[0];i.length==1?(i.length=0,y.length=0):(i[0]=i.pop(),y[0]=y.pop(),this.siftUp_(0));const k=this.keyFunction_(w);return delete this.queuedElements_[k],w}enqueue(i){(0,D.v)(!(this.keyFunction_(i)in this.queuedElements_),31);const y=this.priorityFunction_(i);return y!=V?(this.elements_.push(i),this.priorities_.push(y),this.queuedElements_[this.keyFunction_(i)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(i){return i*2+1}getRightChildIndex_(i){return i*2+2}getParentIndex_(i){return i-1>>1}heapify_(){let i;for(i=(this.elements_.length>>1)-1;i>=0;i--)this.siftUp_(i)}isEmpty(){return this.elements_.length===0}isKeyQueued(i){return i in this.queuedElements_}isQueued(i){return this.isKeyQueued(this.keyFunction_(i))}siftUp_(i){const y=this.elements_,w=this.priorities_,k=y.length,ut=y[i],Et=w[i],bt=i;for(;i<k>>1;){const zt=this.getLeftChildIndex_(i),ne=this.getRightChildIndex_(i),de=ne<k&&w[ne]<w[zt]?ne:zt;y[i]=y[de],w[i]=w[de],i=de}y[i]=ut,w[i]=Et,this.siftDown_(bt,i)}siftDown_(i,y){const w=this.elements_,k=this.priorities_,ut=w[y],Et=k[y];for(;y>i;){const bt=this.getParentIndex_(y);if(k[bt]>Et)w[y]=w[bt],k[y]=k[bt],y=bt;else break}w[y]=ut,k[y]=Et}reprioritize(){const i=this.priorityFunction_,y=this.elements_,w=this.priorities_;let k=0;const ut=y.length;let Et,bt,zt;for(bt=0;bt<ut;++bt)Et=y[bt],zt=i(Et),zt==V?delete this.queuedElements_[this.keyFunction_(Et)]:(w[k]=zt,y[k++]=Et);y.length=k,w.length=k,this.heapify_()}}const rt=H;var it=r(11078);class ct extends rt{constructor(i,y){super(function(w){return i.apply(null,w)},function(w){return w[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=y,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(i){const y=super.enqueue(i);return y&&i[0].addEventListener(et.A.CHANGE,this.boundHandleTileChange_),y}getTilesLoading(){return this.tilesLoading_}handleTileChange(i){const y=i.target,w=y.getState();if(w===it.A.LOADED||w===it.A.ERROR||w===it.A.EMPTY){w!==it.A.ERROR&&y.removeEventListener(et.A.CHANGE,this.boundHandleTileChange_);const k=y.getKey();k in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[k],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(i,y){let w=0,k,ut,Et;for(;this.tilesLoading_<i&&w<y&&this.getCount()>0;)ut=this.dequeue()[0],Et=ut.getKey(),k=ut.getState(),k===it.A.IDLE&&!(Et in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[Et]=!0,++this.tilesLoading_,++w,ut.load())}}const gt=ct;function yt(tt,i,y,w,k){if(!tt||!(y in tt.wantedTiles)||!tt.wantedTiles[y][i.getKey()])return V;const ut=tt.viewState.center,Et=w[0]-ut[0],bt=w[1]-ut[1];return 65536*Math.log(k)+Math.sqrt(Et*Et+bt*bt)/k}var pt=r(91765),Dt=r(62703),Gt=r(57456),$t=r(10972),te=r(93474);class Yt extends $t.A{constructor(i){i=i||{},super({element:document.createElement("div"),render:i.render,target:i.target});const y=i.className!==void 0?i.className:"ol-rotate",w=i.label!==void 0?i.label:"\u21E7",k=i.compassClassName!==void 0?i.compassClassName:"ol-compass";this.label_=null,typeof w=="string"?(this.label_=document.createElement("span"),this.label_.className=k,this.label_.textContent=w):(this.label_=w,this.label_.classList.add(k));const ut=i.tipLabel?i.tipLabel:"Reset rotation",Et=document.createElement("button");Et.className=y+"-reset",Et.setAttribute("type","button"),Et.title=ut,Et.appendChild(this.label_),Et.addEventListener(et.A.CLICK,this.handleClick_.bind(this),!1);const bt=y+" "+m.XI+" "+m.$N,zt=this.element;zt.className=bt,zt.appendChild(Et),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=i.duration!==void 0?i.duration:250,this.autoHide_=i.autoHide!==void 0?i.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(m.Si)}handleClick_(i){i.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const y=this.getMap().getView();if(!y)return;const w=y.getRotation();w!==void 0&&(this.duration_>0&&w%(2*Math.PI)!==0?y.animate({rotation:0,duration:this.duration_,easing:te.vT}):y.setRotation(0))}render(i){const y=i.frameState;if(!y)return;const w=y.viewState.rotation;if(w!=this.rotation_){const k="rotate("+w+"rad)";if(this.autoHide_){const ut=this.element.classList.contains(m.Si);!ut&&w===0?this.element.classList.add(m.Si):ut&&w!==0&&this.element.classList.remove(m.Si)}this.label_.style.transform=k}this.rotation_=w}}const Zt=Yt;var ye=r(69186);function Ht(tt){tt=tt||{};const i=new L.A;return(tt.zoom!==void 0?tt.zoom:!0)&&i.push(new ye.A(tt.zoomOptions)),(tt.rotate!==void 0?tt.rotate:!0)&&i.push(new Zt(tt.rotateOptions)),(tt.attribution!==void 0?tt.attribution:!0)&&i.push(new Gt.A(tt.attributionOptions)),i}var ie=r(6292);class ee extends ie.Ay{constructor(i){super(),i=i||{},this.delta_=i.delta?i.delta:1,this.duration_=i.duration!==void 0?i.duration:250}handleEvent(i){let y=!1;if(i.type==T.A.DBLCLICK){const w=i.originalEvent,k=i.map,ut=i.coordinate,Et=w.shiftKey?-this.delta_:this.delta_,bt=k.getView();(0,ie.D2)(bt,Et,ut,this.duration_),w.preventDefault(),y=!0}return!y}}const se=ee;var Jt=r(21409),qt=r(58704);class fe extends Jt.A{constructor(i){super({stopDown:I.W8}),i=i||{},this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const y=i.condition?i.condition:(0,qt.Q7)(qt.TS,qt.fs);this.condition_=i.onFocusOnly?(0,qt.Q7)(qt.eL,y):y,this.noKinetic_=!1}handleDragEvent(i){const y=i.map;this.panning_||(this.panning_=!0,y.getView().beginInteraction());const w=this.targetPointers,k=y.getEventPixel((0,Jt.v)(w));if(w.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(k[0],k[1]),this.lastCentroid){const ut=[this.lastCentroid[0]-k[0],k[1]-this.lastCentroid[1]],bt=i.map.getView();(0,E.hs)(ut,bt.getResolution()),(0,E.e$)(ut,bt.getRotation()),bt.adjustCenterInternal(ut)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=k,this.lastPointersCount_=w.length,i.originalEvent.preventDefault()}handleUpEvent(i){const y=i.map,w=y.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const k=this.kinetic_.getDistance(),ut=this.kinetic_.getAngle(),Et=w.getCenterInternal(),bt=y.getPixelFromCoordinateInternal(Et),zt=y.getCoordinateFromPixelInternal([bt[0]-k*Math.cos(ut),bt[1]-k*Math.sin(ut)]);w.animateInternal({center:w.getConstrainedCenter(zt),duration:500,easing:te.vT})}return this.panning_&&(this.panning_=!1,w.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(i){if(this.targetPointers.length>0&&this.condition_(i)){const w=i.map.getView();return this.lastCentroid=null,w.getAnimating()&&w.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const ce=fe;var Qt=r(24498);class ue extends Jt.A{constructor(i){i=i||{},super({stopDown:I.W8}),this.condition_=i.condition?i.condition:qt.IO,this.lastAngle_=void 0,this.duration_=i.duration!==void 0?i.duration:250}handleDragEvent(i){if(!(0,qt.A4)(i))return;const y=i.map,w=y.getView();if(w.getConstraints().rotation===Qt.b8)return;const k=y.getSize(),ut=i.pixel,Et=Math.atan2(k[1]/2-ut[1],ut[0]-k[0]/2);if(this.lastAngle_!==void 0){const bt=Et-this.lastAngle_;w.adjustRotationInternal(-bt)}this.lastAngle_=Et}handleUpEvent(i){return(0,qt.A4)(i)?(i.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(i){return(0,qt.A4)(i)&&(0,qt.at)(i)&&this.condition_(i)?(i.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}const Re=ue;var De=r(1685),Te=r(71064);class Ae extends X.A{constructor(i){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+i,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const i=this.startPixel_,y=this.endPixel_,w="px",k=this.element_.style;k.left=Math.min(i[0],y[0])+w,k.top=Math.min(i[1],y[1])+w,k.width=Math.abs(y[0]-i[0])+w,k.height=Math.abs(y[1]-i[1])+w}setMap(i){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const y=this.element_.style;y.left="inherit",y.top="inherit",y.width="inherit",y.height="inherit"}this.map_=i,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(i,y){this.startPixel_=i,this.endPixel_=y,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const i=this.startPixel_,y=this.endPixel_,k=[i,[i[0],y[1]],y,[y[0],i[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);k[4]=k[0].slice(),this.geometry_?this.geometry_.setCoordinates([k]):this.geometry_=new Te.Ay([k])}getGeometry(){return this.geometry_}}const vt=Ae,Oe={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class kt extends De.Ay{constructor(i,y,w){super(i),this.coordinate=y,this.mapBrowserEvent=w}}class ae extends Jt.A{constructor(i){super(),this.on,this.once,this.un,i=i||{},this.box_=new vt(i.className||"ol-dragbox"),this.minArea_=i.minArea!==void 0?i.minArea:64,i.onBoxEnd&&(this.onBoxEnd=i.onBoxEnd),this.startPixel_=null,this.condition_=i.condition?i.condition:qt.at,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(i,y,w){const k=w[0]-y[0],ut=w[1]-y[1];return k*k+ut*ut>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(i){this.box_.setPixels(this.startPixel_,i.pixel),this.dispatchEvent(new kt(Oe.BOXDRAG,i.coordinate,i))}handleUpEvent(i){this.box_.setMap(null);const y=this.boxEndCondition_(i,this.startPixel_,i.pixel);return y&&this.onBoxEnd(i),this.dispatchEvent(new kt(y?Oe.BOXEND:Oe.BOXCANCEL,i.coordinate,i)),!1}handleDownEvent(i){return this.condition_(i)?(this.startPixel_=i.pixel,this.box_.setMap(i.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new kt(Oe.BOXSTART,i.coordinate,i)),!0):!1}onBoxEnd(i){}}const Ve=ae;class _e extends Ve{constructor(i){i=i||{};const y=i.condition?i.condition:qt.Kg;super({condition:y,className:i.className||"ol-dragzoom",minArea:i.minArea}),this.duration_=i.duration!==void 0?i.duration:200,this.out_=i.out!==void 0?i.out:!1}onBoxEnd(i){const w=this.getMap().getView();let k=this.getGeometry();if(this.out_){const ut=w.rotatedExtentForGeometry(k),Et=w.getResolutionForExtentInternal(ut),bt=w.getResolution()/Et;k=k.clone(),k.scale(bt*bt)}w.fitInternal(k,{duration:this.duration_,easing:te.vT})}}const Ne=_e,Ee={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Ze extends ie.Ay{constructor(i){super(),i=i||{},this.defaultCondition_=function(y){return(0,qt.TS)(y)&&(0,qt.tE)(y)},this.condition_=i.condition!==void 0?i.condition:this.defaultCondition_,this.duration_=i.duration!==void 0?i.duration:100,this.pixelDelta_=i.pixelDelta!==void 0?i.pixelDelta:128}handleEvent(i){let y=!1;if(i.type==et.A.KEYDOWN){const w=i.originalEvent,k=w.key;if(this.condition_(i)&&(k==Ee.DOWN||k==Ee.LEFT||k==Ee.RIGHT||k==Ee.UP)){const Et=i.map.getView(),bt=Et.getResolution()*this.pixelDelta_;let zt=0,ne=0;k==Ee.DOWN?ne=-bt:k==Ee.LEFT?zt=-bt:k==Ee.RIGHT?zt=bt:ne=bt;const de=[zt,ne];(0,E.e$)(de,Et.getRotation()),(0,ie.e4)(Et,de,this.duration_),w.preventDefault(),y=!0}}return!y}}const Ge=Ze;class He extends ie.Ay{constructor(i){super(),i=i||{},this.condition_=i.condition?i.condition:qt.tE,this.delta_=i.delta?i.delta:1,this.duration_=i.duration!==void 0?i.duration:100}handleEvent(i){let y=!1;if(i.type==et.A.KEYDOWN||i.type==et.A.KEYPRESS){const w=i.originalEvent,k=w.key;if(this.condition_(i)&&(k==="+"||k==="-")){const ut=i.map,Et=k==="+"?this.delta_:-this.delta_,bt=ut.getView();(0,ie.D2)(bt,Et,void 0,this.duration_),w.preventDefault(),y=!0}}return!y}}const Bt=He;class xe{constructor(i,y,w){this.decay_=i,this.minVelocity_=y,this.delay_=w,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(i,y){this.points_.push(i,y,Date.now())}end(){if(this.points_.length<6)return!1;const i=Date.now()-this.delay_,y=this.points_.length-3;if(this.points_[y+2]<i)return!1;let w=y-3;for(;w>0&&this.points_[w+2]>i;)w-=3;const k=this.points_[y+2]-this.points_[w+2];if(k<1e3/60)return!1;const ut=this.points_[y]-this.points_[w],Et=this.points_[y+1]-this.points_[w+1];return this.angle_=Math.atan2(Et,ut),this.initialVelocity_=Math.sqrt(ut*ut+Et*Et)/k,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const re=xe;var Me=r(88751);class ve extends Jt.A{constructor(i){i=i||{};const y=i;y.stopDown||(y.stopDown=I.W8),super(y),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=i.threshold!==void 0?i.threshold:.3,this.duration_=i.duration!==void 0?i.duration:250}handleDragEvent(i){let y=0;const w=this.targetPointers[0],k=this.targetPointers[1],ut=Math.atan2(k.clientY-w.clientY,k.clientX-w.clientX);if(this.lastAngle_!==void 0){const zt=ut-this.lastAngle_;this.rotationDelta_+=zt,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),y=zt}this.lastAngle_=ut;const Et=i.map,bt=Et.getView();bt.getConstraints().rotation!==Qt.b8&&(this.anchor_=Et.getCoordinateFromPixelInternal(Et.getEventPixel((0,Jt.v)(this.targetPointers))),this.rotating_&&(Et.render(),bt.adjustRotationInternal(y,this.anchor_)))}handleUpEvent(i){return this.targetPointers.length<2?(i.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(i){if(this.targetPointers.length>=2){const y=i.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||y.getView().beginInteraction(),!0}return!1}}const oe=ve;class pe extends Jt.A{constructor(i){i=i||{};const y=i;y.stopDown||(y.stopDown=I.W8),super(y),this.anchor_=null,this.duration_=i.duration!==void 0?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(i){let y=1;const w=this.targetPointers[0],k=this.targetPointers[1],ut=w.clientX-k.clientX,Et=w.clientY-k.clientY,bt=Math.sqrt(ut*ut+Et*Et);this.lastDistance_!==void 0&&(y=this.lastDistance_/bt),this.lastDistance_=bt;const zt=i.map,ne=zt.getView();y!=1&&(this.lastScaleDelta_=y),this.anchor_=zt.getCoordinateFromPixelInternal(zt.getEventPixel((0,Jt.v)(this.targetPointers))),zt.render(),ne.adjustResolutionInternal(y,this.anchor_)}handleUpEvent(i){if(this.targetPointers.length<2){const w=i.map.getView(),k=this.lastScaleDelta_>1?1:-1;return w.endInteraction(this.duration_,k),!1}return!0}handleDownEvent(i){if(this.targetPointers.length>=2){const y=i.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||y.getView().beginInteraction(),!0}return!1}}const Ce=pe;function Pt(tt){tt=tt||{};const i=new L.A,y=new re(-.005,.05,100);return(tt.altShiftDragRotate!==void 0?tt.altShiftDragRotate:!0)&&i.push(new Re),(tt.doubleClickZoom!==void 0?tt.doubleClickZoom:!0)&&i.push(new se({delta:tt.zoomDelta,duration:tt.zoomDuration})),(tt.dragPan!==void 0?tt.dragPan:!0)&&i.push(new ce({onFocusOnly:tt.onFocusOnly,kinetic:y})),(tt.pinchRotate!==void 0?tt.pinchRotate:!0)&&i.push(new oe),(tt.pinchZoom!==void 0?tt.pinchZoom:!0)&&i.push(new Ce({duration:tt.zoomDuration})),(tt.keyboard!==void 0?tt.keyboard:!0)&&(i.push(new Ge),i.push(new Bt({delta:tt.zoomDelta,duration:tt.zoomDuration}))),(tt.mouseWheelZoom!==void 0?tt.mouseWheelZoom:!0)&&i.push(new Me.A({onFocusOnly:tt.onFocusOnly,duration:tt.zoomDuration})),(tt.shiftDragZoom!==void 0?tt.shiftDragZoom:!0)&&i.push(new Ne({duration:tt.zoomDuration})),i}var t=r(66514),c=r(22796),h=r(6782),S=r(54422);function P(tt){if(tt instanceof a.A){tt.setMapInternal(null);return}tt instanceof J.A&&tt.getLayers().forEach(P)}function B(tt,i){if(tt instanceof a.A){tt.setMapInternal(i);return}if(tt instanceof J.A){const y=tt.getLayers().getArray();for(let w=0,k=y.length;w<k;++w)B(y[w],i)}}class j extends U.A{constructor(i){super(),i=i||{},this.on,this.once,this.un;const y=Z(i);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=i.maxTilesLoading!==void 0?i.maxTilesLoading:16,this.pixelRatio_=i.pixelRatio!==void 0?i.pixelRatio:st.cr,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=(0,v.vt)(),this.pixelToCoordinateTransform_=(0,v.vt)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=i.moveTolerance,this.keyboardEventTarget_=y.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=y.controls||Ht(),this.interactions=y.interactions||Pt({onFocusOnly:!0}),this.overlays_=y.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new gt(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(_.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(_.VIEW,this.handleViewChanged_),this.addChangeListener(_.SIZE,this.handleSizeChanged_),this.addChangeListener(_.TARGET,this.handleTargetChanged_),this.setProperties(y.values);const w=this;i.view&&!(i.view instanceof pt.Ay)&&i.view.then(function(k){w.setView(new pt.Ay(k))}),this.controls.addEventListener(Y.A.ADD,k=>{k.element.setMap(this)}),this.controls.addEventListener(Y.A.REMOVE,k=>{k.element.setMap(null)}),this.interactions.addEventListener(Y.A.ADD,k=>{k.element.setMap(this)}),this.interactions.addEventListener(Y.A.REMOVE,k=>{k.element.setMap(null)}),this.overlays_.addEventListener(Y.A.ADD,k=>{this.addOverlayInternal_(k.element)}),this.overlays_.addEventListener(Y.A.REMOVE,k=>{const ut=k.element.getId();ut!==void 0&&delete this.overlayIdIndex_[ut.toString()],k.element.setMap(null)}),this.controls.forEach(k=>{k.setMap(this)}),this.interactions.forEach(k=>{k.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(i){this.getControls().push(i)}addInteraction(i){this.getInteractions().push(i)}addLayer(i){this.getLayerGroup().getLayers().push(i)}handleLayerAdd_(i){B(i.layer,this)}addOverlay(i){this.getOverlays().push(i)}addOverlayInternal_(i){const y=i.getId();y!==void 0&&(this.overlayIdIndex_[y.toString()]=i),i.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(i,y,w){if(!this.frameState_||!this.renderer_)return;const k=this.getCoordinateFromPixelInternal(i);w=w!==void 0?w:{};const ut=w.hitTolerance!==void 0?w.hitTolerance:0,Et=w.layerFilter!==void 0?w.layerFilter:I.rT,bt=w.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(k,this.frameState_,ut,bt,y,null,Et,null)}getFeaturesAtPixel(i,y){const w=[];return this.forEachFeatureAtPixel(i,function(k){w.push(k)},y),w}getAllLayers(){const i=[];function y(w){w.forEach(function(k){k instanceof J.A?y(k.getLayers()):i.push(k)})}return y(this.getLayers()),i}hasFeatureAtPixel(i,y){if(!this.frameState_||!this.renderer_)return!1;const w=this.getCoordinateFromPixelInternal(i);y=y!==void 0?y:{};const k=y.layerFilter!==void 0?y.layerFilter:I.rT,ut=y.hitTolerance!==void 0?y.hitTolerance:0,Et=y.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(w,this.frameState_,ut,Et,k,null)}getEventCoordinate(i){return this.getCoordinateFromPixel(this.getEventPixel(i))}getEventCoordinateInternal(i){return this.getCoordinateFromPixelInternal(this.getEventPixel(i))}getEventPixel(i){const w=this.viewport_.getBoundingClientRect(),k=this.getSize(),ut=w.width/k[0],Et=w.height/k[1],bt="changedTouches"in i?i.changedTouches[0]:i;return[(bt.clientX-w.left)/ut,(bt.clientY-w.top)/Et]}getTarget(){return this.get(_.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(i){return(0,c.te)(this.getCoordinateFromPixelInternal(i),this.getView().getProjection())}getCoordinateFromPixelInternal(i){const y=this.frameState_;return y?(0,v.Bb)(y.pixelToCoordinateTransform,i.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(i){const y=this.overlayIdIndex_[i.toString()];return y!==void 0?y:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(_.LAYERGROUP)}setLayers(i){const y=this.getLayerGroup();if(i instanceof L.A){y.setLayers(i);return}const w=y.getLayers();w.clear(),w.extend(i)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const i=this.getLayerGroup().getLayerStatesArray();for(let y=0,w=i.length;y<w;++y){const k=i[y];if(!k.visible)continue;const ut=k.layer.getRenderer();if(ut&&!ut.ready)return!0;const Et=k.layer.getSource();if(Et&&Et.loading)return!0}return!1}getPixelFromCoordinate(i){const y=(0,c.Ad)(i,this.getView().getProjection());return this.getPixelFromCoordinateInternal(y)}getPixelFromCoordinateInternal(i){const y=this.frameState_;return y?(0,v.Bb)(y.coordinateToPixelTransform,i.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(_.SIZE)}getView(){return this.get(_.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const i=this.getTargetElement();return i?i.ownerDocument:document}getTilePriority(i,y,w,k){return yt(this.frameState_,i,y,w,k)}handleBrowserEvent(i,y){y=y||i.type;const w=new R.A(y,this,i);this.handleMapBrowserEvent(w)}handleMapBrowserEvent(i){if(!this.frameState_)return;const y=i.originalEvent,w=y.type;if(w===K.POINTERDOWN||w===et.A.WHEEL||w===et.A.KEYDOWN){const k=this.getOwnerDocument(),ut=this.viewport_.getRootNode?this.viewport_.getRootNode():k,Et=y.target;if(this.overlayContainerStopEvent_.contains(Et)||!(ut===k?k.documentElement:ut).contains(Et))return}if(i.frameState=this.frameState_,this.dispatchEvent(i)!==!1){const k=this.getInteractions().getArray().slice();for(let ut=k.length-1;ut>=0;ut--){const Et=k[ut];if(Et.getMap()!==this||!Et.getActive()||!this.getTargetElement())continue;if(!Et.handleEvent(i)||i.propagationStopped)break}}}handlePostRender(){const i=this.frameState_,y=this.tileQueue_;if(!y.isEmpty()){let k=this.maxTilesLoading_,ut=k;if(i){const Et=i.viewHints;if(Et[Dt.A.ANIMATING]||Et[Dt.A.INTERACTING]){const bt=Date.now()-i.time>8;k=bt?0:8,ut=bt?0:2}}y.getTilesLoading()<k&&(y.reprioritize(),y.loadMoreTiles(k,ut))}i&&this.renderer_&&!i.animate&&(this.renderComplete_===!0?(this.hasListener(M.A.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(M.A.RENDERCOMPLETE,i),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new n.A(o.A.LOADEND,this,i)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new n.A(o.A.LOADSTART,this,i))));const w=this.postRenderFunctions_;for(let k=0,ut=w.length;k<ut;++k)w[k](this,i);w.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let w=0,k=this.targetChangeHandlerKeys_.length;w<k;++w)(0,O.JH)(this.targetChangeHandlerKeys_[w]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(et.A.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(et.A.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,(0,b.bf)(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const w=this.targetElement_.getRootNode();w instanceof ShadowRoot&&this.resizeObserver_.unobserve(w.host),this.setSize(void 0)}const i=this.getTarget(),y=typeof i=="string"?document.getElementById(i):i;if(this.targetElement_=y,!y)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{y.appendChild(this.viewport_),this.renderer_||(this.renderer_=new ht(this)),this.mapBrowserEventHandler_=new s(this,this.moveTolerance_);for(const ut in T.A)this.mapBrowserEventHandler_.addEventListener(T.A[ut],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(et.A.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(et.A.WHEEL,this.boundHandleBrowserEvent_,st.FT?{passive:!1}:!1);const w=this.keyboardEventTarget_?this.keyboardEventTarget_:y;this.targetChangeHandlerKeys_=[(0,O.KT)(w,et.A.KEYDOWN,this.handleBrowserEvent,this),(0,O.KT)(w,et.A.KEYPRESS,this.handleBrowserEvent,this)];const k=y.getRootNode();k instanceof ShadowRoot&&this.resizeObserver_.observe(k.host),this.resizeObserver_.observe(y)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&((0,O.JH)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,O.JH)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const i=this.getView();i&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=(0,O.KT)(i,f.A.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,O.KT)(i,et.A.CHANGE,this.handleViewPropertyChanged_,this),i.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(O.JH),this.layerGroupPropertyListenerKeys_=null);const i=this.getLayerGroup();i&&(this.handleLayerAdd_(new J.i("addlayer",i)),this.layerGroupPropertyListenerKeys_=[(0,O.KT)(i,f.A.PROPERTYCHANGE,this.render,this),(0,O.KT)(i,et.A.CHANGE,this.render,this),(0,O.KT)(i,"addlayer",this.handleLayerAdd_,this),(0,O.KT)(i,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const i=this.getLayerGroup().getLayerStatesArray();for(let y=0,w=i.length;y<w;++y){const k=i[y].layer;k.hasRenderer()&&k.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(i){return this.getControls().remove(i)}removeInteraction(i){return this.getInteractions().remove(i)}removeLayer(i){return this.getLayerGroup().getLayers().remove(i)}handleLayerRemove_(i){P(i.layer)}removeOverlay(i){return this.getOverlays().remove(i)}renderFrame_(i){const y=this.getSize(),w=this.getView(),k=this.frameState_;let ut=null;if(y!==void 0&&(0,h.Ie)(y)&&w&&w.isDef()){const Et=w.getHints(this.frameState_?this.frameState_.viewHints:void 0),bt=w.getState();if(ut={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:(0,W.Bg)(bt.center,bt.resolution,bt.rotation,y),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:y,tileQueue:this.tileQueue_,time:i,usedTiles:{},viewState:bt,viewHints:Et,wantedTiles:{},mapId:(0,C.v6)(this),renderTargets:{}},bt.nextCenter&&bt.nextResolution){const zt=isNaN(bt.nextRotation)?bt.rotation:bt.nextRotation;ut.nextExtent=(0,W.Bg)(bt.nextCenter,bt.nextResolution,zt,y)}}this.frameState_=ut,this.renderer_.renderFrame(ut),ut&&(ut.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,ut.postRenderFunctions),k&&(!this.previousExtent_||!(0,W.Im)(this.previousExtent_)&&!(0,W.aI)(ut.extent,this.previousExtent_))&&(this.dispatchEvent(new n.A(o.A.MOVESTART,this,k)),this.previousExtent_=(0,W.aZ)(this.previousExtent_)),this.previousExtent_&&!ut.viewHints[Dt.A.ANIMATING]&&!ut.viewHints[Dt.A.INTERACTING]&&!(0,W.aI)(ut.extent,this.previousExtent_)&&(this.dispatchEvent(new n.A(o.A.MOVEEND,this,ut)),(0,W.o8)(ut.extent,this.previousExtent_))),this.dispatchEvent(new n.A(o.A.POSTRENDER,this,ut)),this.renderComplete_=this.hasListener(o.A.LOADSTART)||this.hasListener(o.A.LOADEND)||this.hasListener(M.A.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(i){const y=this.getLayerGroup();y&&this.handleLayerRemove_(new J.i("removelayer",y)),this.set(_.LAYERGROUP,i)}setSize(i){this.set(_.SIZE,i)}setTarget(i){this.set(_.TARGET,i)}setView(i){if(!i||i instanceof pt.Ay){this.set(_.VIEW,i);return}this.set(_.VIEW,new pt.Ay);const y=this;i.then(function(w){y.setView(new pt.Ay(w))})}updateSize(){const i=this.getTargetElement();let y;if(i){const k=getComputedStyle(i),ut=i.offsetWidth-parseFloat(k.borderLeftWidth)-parseFloat(k.paddingLeft)-parseFloat(k.paddingRight)-parseFloat(k.borderRightWidth),Et=i.offsetHeight-parseFloat(k.borderTopWidth)-parseFloat(k.paddingTop)-parseFloat(k.paddingBottom)-parseFloat(k.borderBottomWidth);!isNaN(ut)&&!isNaN(Et)&&(y=[ut,Et],!(0,h.Ie)(y)&&(i.offsetWidth||i.offsetHeight||i.getClientRects().length)&&(0,S.R8)("No map visible because the map container's width or height are 0."))}const w=this.getSize();y&&(!w||!(0,t.aI)(y,w))&&(this.setSize(y),this.updateViewportSize_())}updateViewportSize_(){const i=this.getView();if(i){let y;const w=getComputedStyle(this.viewport_);w.width&&w.height&&(y=[parseInt(w.width,10),parseInt(w.height,10)]),i.setViewportSize(y)}}}function Z(tt){let i=null;tt.keyboardEventTarget!==void 0&&(i=typeof tt.keyboardEventTarget=="string"?document.getElementById(tt.keyboardEventTarget):tt.keyboardEventTarget);const y={},w=tt.layers&&typeof tt.layers.getLayers=="function"?tt.layers:new J.A({layers:tt.layers});y[_.LAYERGROUP]=w,y[_.TARGET]=tt.target,y[_.VIEW]=tt.view instanceof pt.Ay?tt.view:new pt.Ay;let k;tt.controls!==void 0&&(Array.isArray(tt.controls)?k=new L.A(tt.controls.slice()):((0,D.v)(typeof tt.controls.getArray=="function",47),k=tt.controls));let ut;tt.interactions!==void 0&&(Array.isArray(tt.interactions)?ut=new L.A(tt.interactions.slice()):((0,D.v)(typeof tt.interactions.getArray=="function",48),ut=tt.interactions));let Et;return tt.overlays!==void 0?Array.isArray(tt.overlays)?Et=new L.A(tt.overlays.slice()):((0,D.v)(typeof tt.overlays.getArray=="function",49),Et=tt.overlays):Et=new L.A,{controls:k,interactions:ut,keyboardEventTarget:i,overlays:Et,values:y}}const nt=j;class lt extends a.A{constructor(i){i=i||{},super(i)}}const dt=lt;var ft=r(69796);class Rt extends dt{constructor(i){super(i)}createRenderer(){return new ft.A(this)}getData(i){return super.getData(i)}}const At=Rt;var Mt=r(13504),Ct=r(82986),wt=r(46568),Wt=r(15816),Ut=r(92745),jt=r(2863),x=r(54825),e=r(57444),F=r(10392),G=r(28807),$=r(16310),ot=r(53497);function xt(tt,i,y,w){const k={};return w&&Object.keys(w).length?(k.color=(0,x.K)(tt,w.color??ot.T5.color,y),k.size=(0,F.hX)(tt,w.size??ot.T5.size),k.rotation=(0,e.H)(tt,w.rotation??ot.T5.rotation),w.text&&(w.text.field||w.text.fixed)&&(k.text=(0,G.E)(tt,w.text))):i.fields&&(i.fields.color&&(k.color=(0,x.K)(tt,i.config.color??ot.T5.color,y)),i.fields.size&&(k.size=(0,F.hX)(tt,i.config.size??ot.T5.size)),i.fields.text&&(k.text=(0,G.E)(tt,i.config.text)),i.fields.rotation&&(k.rotation=(0,e.H)(tt,i.config.rotation??ot.T5.rotation))),k}let Ot;function Lt(){return Ot||(Ot=[],Tt()),Ot}async function Tt(){const tt=await(0,$.o)();for(let i of["maps","gazetteer"])tt.listFiles(i).subscribe({next:y=>{y.forEach(w=>{if(w.name.endsWith(".geojson")){const k=`public/${i}/${w.name}`;Ot.push({value:k,label:k})}})}})}const mt=tt=>(0,jt.w)().containsTemplate(JSON.stringify(tt)),_t=(tt,i,y)=>{const w=tt.initMapView(i.view);return tt.map=new nt({view:w,pixelRatio:window.devicePixelRatio,layers:[],controls:[],target:y,interactions:Pt({mouseWheelZoom:!1})})},Ft=(tt,i)=>{tt.initControls(i.controls),tt.forceUpdate()},It=(tt,i,y)=>{tt.panelContext&&tt.panelContext.onInstanceStateChange&&tt.panelContext.onInstanceStateChange({map:tt.map,layers:i,selected:y,actions:tt.actions})},Kt=tt=>{let i=tt.layers.length;for(;i<100;){const y=(0,Ut.t)("geomap.utils.get-next-layer-name","Layer {{name}}",{name:i++});if(!tt.byName.has(y))return y}return(0,Ut.t)("geomap.utils.get-next-layer-name","Layer {{name}}",{name:Date.now()})};function Xt(tt,i,y,w){const k=tt.getPixelFromCoordinate(y),ut=tt.getPixelFromCoordinate(w),Et=Math.abs(k[0]-ut[0]),bt=Math.abs(k[1]-ut[1]);return Et>i||bt>i}const Vt=tt=>{try{return new URL(tt).protocol.includes("http")}catch{return!1}};function St(tt){if(tt instanceof J.A)return tt.getLayers().getArray().some(i=>St(i));if(tt instanceof Ct.A||tt instanceof wt.A){const i=tt.getSource();return i!=null&&i.getFeatures().length>0}if(tt instanceof Wt.A){const i=tt.getSource();return i!=null&&i.getFeatures().length>0}return tt instanceof Mt.A||tt instanceof At?!!tt.getSource():!1}},35341:function(Nt){(function(at,r){Nt.exports=r()})(this,function(){"use strict";function at(f,A,M,m,g){(function O(b,q,ht,et,J){for(;et>ht;){if(et-ht>600){var R=et-ht+1,T=q-ht+1,K=Math.log(R),Q=.5*Math.exp(2*K/3),st=.5*Math.sqrt(K*Q*(R-Q)/R)*(T-R/2<0?-1:1),l=Math.max(ht,Math.floor(q-T*Q/R+st)),s=Math.min(et,Math.floor(q+(R-T)*Q/R+st));O(b,q,l,s,J)}var n=b[q],o=ht,_=et;for(r(b,ht,q),J(b[et],n)>0&&r(b,ht,et);o<_;){for(r(b,o,_),o++,_--;J(b[o],n)<0;)o++;for(;J(b[_],n)>0;)_--}J(b[ht],n)===0?r(b,ht,_):r(b,++_,et),_<=q&&(ht=_+1),q<=_&&(et=_-1)}})(f,A,M||0,m||f.length-1,g||U)}function r(f,A,M){var m=f[A];f[A]=f[M],f[M]=m}function U(f,A){return f<A?-1:f>A?1:0}var L=function(f){f===void 0&&(f=9),this._maxEntries=Math.max(4,f),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function Y(f,A,M){if(!M)return A.indexOf(f);for(var m=0;m<A.length;m++)if(M(f,A[m]))return m;return-1}function X(f,A){I(f,0,f.children.length,A,f)}function I(f,A,M,m,g){g||(g=u(null)),g.minX=1/0,g.minY=1/0,g.maxX=-1/0,g.maxY=-1/0;for(var O=A;O<M;O++){var b=f.children[O];C(g,f.leaf?m(b):b)}return g}function C(f,A){return f.minX=Math.min(f.minX,A.minX),f.minY=Math.min(f.minY,A.minY),f.maxX=Math.max(f.maxX,A.maxX),f.maxY=Math.max(f.maxY,A.maxY),f}function v(f,A){return f.minX-A.minX}function W(f,A){return f.minY-A.minY}function d(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function a(f){return f.maxX-f.minX+(f.maxY-f.minY)}function E(f,A){return f.minX<=A.minX&&f.minY<=A.minY&&A.maxX<=f.maxX&&A.maxY<=f.maxY}function p(f,A){return A.minX<=f.maxX&&A.minY<=f.maxY&&A.maxX>=f.minX&&A.maxY>=f.minY}function u(f){return{children:f,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function z(f,A,M,m,g){for(var O=[A,M];O.length;)if(!((M=O.pop())-(A=O.pop())<=m)){var b=A+Math.ceil((M-A)/m/2)*m;at(f,b,A,M,g),O.push(A,b,b,M)}}return L.prototype.all=function(){return this._all(this.data,[])},L.prototype.search=function(f){var A=this.data,M=[];if(!p(f,A))return M;for(var m=this.toBBox,g=[];A;){for(var O=0;O<A.children.length;O++){var b=A.children[O],q=A.leaf?m(b):b;p(f,q)&&(A.leaf?M.push(b):E(f,q)?this._all(b,M):g.push(b))}A=g.pop()}return M},L.prototype.collides=function(f){var A=this.data;if(!p(f,A))return!1;for(var M=[];A;){for(var m=0;m<A.children.length;m++){var g=A.children[m],O=A.leaf?this.toBBox(g):g;if(p(f,O)){if(A.leaf||E(f,O))return!0;M.push(g)}}A=M.pop()}return!1},L.prototype.load=function(f){if(!f||!f.length)return this;if(f.length<this._minEntries){for(var A=0;A<f.length;A++)this.insert(f[A]);return this}var M=this._build(f.slice(),0,f.length-1,0);if(this.data.children.length)if(this.data.height===M.height)this._splitRoot(this.data,M);else{if(this.data.height<M.height){var m=this.data;this.data=M,M=m}this._insert(M,this.data.height-M.height-1,!0)}else this.data=M;return this},L.prototype.insert=function(f){return f&&this._insert(f,this.data.height-1),this},L.prototype.clear=function(){return this.data=u([]),this},L.prototype.remove=function(f,A){if(!f)return this;for(var M,m,g,O=this.data,b=this.toBBox(f),q=[],ht=[];O||q.length;){if(O||(O=q.pop(),m=q[q.length-1],M=ht.pop(),g=!0),O.leaf){var et=Y(f,O.children,A);if(et!==-1)return O.children.splice(et,1),q.push(O),this._condense(q),this}g||O.leaf||!E(O,b)?m?(M++,O=m.children[M],g=!1):O=null:(q.push(O),ht.push(M),M=0,m=O,O=O.children[0])}return this},L.prototype.toBBox=function(f){return f},L.prototype.compareMinX=function(f,A){return f.minX-A.minX},L.prototype.compareMinY=function(f,A){return f.minY-A.minY},L.prototype.toJSON=function(){return this.data},L.prototype.fromJSON=function(f){return this.data=f,this},L.prototype._all=function(f,A){for(var M=[];f;)f.leaf?A.push.apply(A,f.children):M.push.apply(M,f.children),f=M.pop();return A},L.prototype._build=function(f,A,M,m){var g,O=M-A+1,b=this._maxEntries;if(O<=b)return X(g=u(f.slice(A,M+1)),this.toBBox),g;m||(m=Math.ceil(Math.log(O)/Math.log(b)),b=Math.ceil(O/Math.pow(b,m-1))),(g=u([])).leaf=!1,g.height=m;var q=Math.ceil(O/b),ht=q*Math.ceil(Math.sqrt(b));z(f,A,M,ht,this.compareMinX);for(var et=A;et<=M;et+=ht){var J=Math.min(et+ht-1,M);z(f,et,J,q,this.compareMinY);for(var R=et;R<=J;R+=q){var T=Math.min(R+q-1,J);g.children.push(this._build(f,R,T,m-1))}}return X(g,this.toBBox),g},L.prototype._chooseSubtree=function(f,A,M,m){for(;m.push(A),!A.leaf&&m.length-1!==M;){for(var g=1/0,O=1/0,b=void 0,q=0;q<A.children.length;q++){var ht=A.children[q],et=d(ht),J=(R=f,T=ht,(Math.max(T.maxX,R.maxX)-Math.min(T.minX,R.minX))*(Math.max(T.maxY,R.maxY)-Math.min(T.minY,R.minY))-et);J<O?(O=J,g=et<g?et:g,b=ht):J===O&&et<g&&(g=et,b=ht)}A=b||A.children[0]}var R,T;return A},L.prototype._insert=function(f,A,M){var m=M?f:this.toBBox(f),g=[],O=this._chooseSubtree(m,this.data,A,g);for(O.children.push(f),C(O,m);A>=0&&g[A].children.length>this._maxEntries;)this._split(g,A),A--;this._adjustParentBBoxes(m,g,A)},L.prototype._split=function(f,A){var M=f[A],m=M.children.length,g=this._minEntries;this._chooseSplitAxis(M,g,m);var O=this._chooseSplitIndex(M,g,m),b=u(M.children.splice(O,M.children.length-O));b.height=M.height,b.leaf=M.leaf,X(M,this.toBBox),X(b,this.toBBox),A?f[A-1].children.push(b):this._splitRoot(M,b)},L.prototype._splitRoot=function(f,A){this.data=u([f,A]),this.data.height=f.height+1,this.data.leaf=!1,X(this.data,this.toBBox)},L.prototype._chooseSplitIndex=function(f,A,M){for(var m,g,O,b,q,ht,et,J=1/0,R=1/0,T=A;T<=M-A;T++){var K=I(f,0,T,this.toBBox),Q=I(f,T,M,this.toBBox),st=(g=K,O=Q,b=void 0,q=void 0,ht=void 0,et=void 0,b=Math.max(g.minX,O.minX),q=Math.max(g.minY,O.minY),ht=Math.min(g.maxX,O.maxX),et=Math.min(g.maxY,O.maxY),Math.max(0,ht-b)*Math.max(0,et-q)),l=d(K)+d(Q);st<J?(J=st,m=T,R=l<R?l:R):st===J&&l<R&&(R=l,m=T)}return m||M-A},L.prototype._chooseSplitAxis=function(f,A,M){var m=f.leaf?this.compareMinX:v,g=f.leaf?this.compareMinY:W;this._allDistMargin(f,A,M,m)<this._allDistMargin(f,A,M,g)&&f.children.sort(m)},L.prototype._allDistMargin=function(f,A,M,m){f.children.sort(m);for(var g=this.toBBox,O=I(f,0,A,g),b=I(f,M-A,M,g),q=a(O)+a(b),ht=A;ht<M-A;ht++){var et=f.children[ht];C(O,f.leaf?g(et):et),q+=a(O)}for(var J=M-A-1;J>=A;J--){var R=f.children[J];C(b,f.leaf?g(R):R),q+=a(b)}return q},L.prototype._adjustParentBBoxes=function(f,A,M){for(var m=M;m>=0;m--)C(A[m],f)},L.prototype._condense=function(f){for(var A=f.length-1,M=void 0;A>=0;A--)f[A].children.length===0?A>0?(M=f[A-1].children).splice(M.indexOf(f[A]),1):this.clear():X(f[A],this.toBBox)},L})},50071:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>W});var U=r(70017),L=r(34120),Y=r(32135),X=r(1685);const I={LENGTH:"length"};class C extends X.Ay{constructor(a,E,p){super(a),this.element=E,this.index=p}}class v extends L.A{constructor(a,E){if(super(),this.on,this.once,this.un,E=E||{},this.unique_=!!E.unique,this.array_=a||[],this.unique_)for(let p=0,u=this.array_.length;p<u;++p)this.assertUnique_(this.array_[p],p);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(a){for(let E=0,p=a.length;E<p;++E)this.push(a[E]);return this}forEach(a){const E=this.array_;for(let p=0,u=E.length;p<u;++p)a(E[p],p,E)}getArray(){return this.array_}item(a){return this.array_[a]}getLength(){return this.get(I.LENGTH)}insertAt(a,E){if(a<0||a>this.getLength())throw new Error("Index out of bounds: "+a);this.unique_&&this.assertUnique_(E),this.array_.splice(a,0,E),this.updateLength_(),this.dispatchEvent(new C(Y.A.ADD,E,a))}pop(){return this.removeAt(this.getLength()-1)}push(a){this.unique_&&this.assertUnique_(a);const E=this.getLength();return this.insertAt(E,a),this.getLength()}remove(a){const E=this.array_;for(let p=0,u=E.length;p<u;++p)if(E[p]===a)return this.removeAt(p)}removeAt(a){if(a<0||a>=this.getLength())return;const E=this.array_[a];return this.array_.splice(a,1),this.updateLength_(),this.dispatchEvent(new C(Y.A.REMOVE,E,a)),E}setAt(a,E){const p=this.getLength();if(a>=p){this.insertAt(a,E);return}if(a<0)throw new Error("Index out of bounds: "+a);this.unique_&&this.assertUnique_(E,a);const u=this.array_[a];this.array_[a]=E,this.dispatchEvent(new C(Y.A.REMOVE,u,a)),this.dispatchEvent(new C(Y.A.ADD,E,a))}updateLength_(){this.set(I.LENGTH,this.array_.length)}assertUnique_(a,E){for(let p=0,u=this.array_.length;p<u;++p)if(this.array_[p]===a&&p!==E)throw new U.A(58)}}const W=v},32135:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={ADD:"add",REMOVE:"remove"}},43938:(Nt,at,r)=>{"use strict";r.d(at,{f:()=>W});var U=r(6837),L=r(80611),Y=r(6141),X=r(7771),I=r(70915),C=r(9438);class v extends L.A{constructor(E,p,u,z,f,A,M){super(E,p,u,Y.A.IDLE),this.src_=z,this.image_=new Image,f!==null&&(this.image_.crossOrigin=f),this.context_=M,this.unlisten_=null,this.state=Y.A.IDLE,this.imageLoadFunction_=A}getImage(){if(this.state==Y.A.LOADED&&this.context_&&!(this.image_ instanceof HTMLCanvasElement)){const E=this.context_.canvas;E.width=this.image_.width,E.height=this.image_.height,this.context_.drawImage(this.image_,0,0),this.image_=this.context_.canvas}return this.image_}handleImageError_(){this.state=Y.A.ERROR,this.unlistenImage_(),this.changed()}handleImageLoad_(){this.resolution===void 0&&(this.resolution=(0,I.Oq)(this.extent)/this.image_.height),this.state=Y.A.LOADED,this.unlistenImage_(),this.changed()}load(){(this.state==Y.A.IDLE||this.state==Y.A.ERROR)&&(this.state=Y.A.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=W(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}setImage(E){this.image_=E,this.resolution=(0,I.Oq)(this.extent)/this.image_.height}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function W(a,E,p){const u=a;let z=!0,f=!1,A=!1;const M=[(0,C.Jz)(u,U.A.LOAD,function(){A=!0,f||E()})];return u.src&&X.DT?(f=!0,u.decode().then(function(){z&&E()}).catch(function(m){z&&(A?E():p())})):M.push((0,C.Jz)(u,U.A.ERROR,p)),function(){z=!1,M.forEach(C.JH)}}var d=null},80611:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>I});var U=r(79332),L=r(6837),Y=r(4087);class X extends U.A{constructor(v,W,d,a){super(),this.extent=v,this.pixelRatio_=d,this.resolution=W,this.state=a}changed(){this.dispatchEvent(L.A.CHANGE)}getExtent(){return this.extent}getImage(){return(0,Y.b0)()}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){(0,Y.b0)()}}const I=X},6141:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},40190:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(8143),L=r(11078),Y=r(68711),X=r(43938);class I extends U.A{constructor(d,a,E,p,u,z){super(d,a,z),this.crossOrigin_=p,this.src_=E,this.key=E,this.image_=new Image,p!==null&&(this.image_.crossOrigin=p),this.unlisten_=null,this.tileLoadFunction_=u}getImage(){return this.image_}setImage(d){this.image_=d,this.state=L.A.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=L.A.ERROR,this.unlistenImage_(),this.image_=C(),this.changed()}handleImageLoad_(){const d=this.image_;d.naturalWidth&&d.naturalHeight?this.state=L.A.LOADED:this.state=L.A.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==L.A.ERROR&&(this.state=L.A.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==L.A.IDLE&&(this.state=L.A.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,X.f)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function C(){const W=(0,Y.Y)(1,1);return W.fillStyle="rgba(0,0,0,0)",W.fillRect(0,0,1,1),W.canvas}const v=I},10277:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y});var U=r(95801);class L extends U.A{constructor(I,C,v,W,d,a){super(I,C,d),this.originalEvent=v,this.pixel_=null,this.coordinate_=null,this.dragging=W!==void 0?W:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(I){this.pixel_=I}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(I){this.coordinate_=I}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Y=L},73445:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>L});var U=r(6837);const L={SINGLECLICK:"singleclick",CLICK:U.A.CLICK,DBLCLICK:U.A.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},95801:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y});var U=r(1685);class L extends U.Ay{constructor(I,C,v){super(I),this.map=C,this.frameState=v!==void 0?v:null}}const Y=L},82585:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},8143:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(79332),L=r(6837),Y=r(11078),X=r(4087),I=r(93474);class C extends U.A{constructor(d,a,E){super(),E=E||{},this.tileCoord=d,this.state=a,this.interimTile=null,this.key="",this.transition_=E.transition===void 0?250:E.transition,this.transitionStarts_={},this.interpolate=!!E.interpolate}changed(){this.dispatchEvent(L.A.CHANGE)}release(){this.state===Y.A.ERROR&&this.setState(Y.A.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let d=this.interimTile;do{if(d.getState()==Y.A.LOADED)return this.transition_=0,d;d=d.interimTile}while(d);return this}refreshInterimChain(){if(!this.interimTile)return;let d=this.interimTile,a=this;do{if(d.getState()==Y.A.LOADED){d.interimTile=null;break}else d.getState()==Y.A.LOADING?a=d:d.getState()==Y.A.IDLE?a.interimTile=d.interimTile:a=d;d=a.interimTile}while(d)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(d){if(this.state!==Y.A.ERROR&&this.state>d)throw new Error("Tile load sequence violation");this.state=d,this.changed()}load(){(0,X.b0)()}getAlpha(d,a){if(!this.transition_)return 1;let E=this.transitionStarts_[d];if(!E)E=a,this.transitionStarts_[d]=E;else if(E===-1)return 1;const p=a-E+1e3/60;return p>=this.transition_?1:(0,I.a6)(p/this.transition_)}inTransition(d){return this.transition_?this.transitionStarts_[d]!==-1:!1}endTransition(d){this.transition_&&(this.transitionStarts_[d]=-1)}}const v=C},91110:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y,N:()=>L});class U{constructor(I,C,v,W){this.minX=I,this.maxX=C,this.minY=v,this.maxY=W}contains(I){return this.containsXY(I[1],I[2])}containsTileRange(I){return this.minX<=I.minX&&I.maxX<=this.maxX&&this.minY<=I.minY&&I.maxY<=this.maxY}containsXY(I,C){return this.minX<=I&&I<=this.maxX&&this.minY<=C&&C<=this.maxY}equals(I){return this.minX==I.minX&&this.minY==I.minY&&this.maxX==I.maxX&&this.maxY==I.maxY}extend(I){I.minX<this.minX&&(this.minX=I.minX),I.maxX>this.maxX&&(this.maxX=I.maxX),I.minY<this.minY&&(this.minY=I.minY),I.maxY>this.maxY&&(this.maxY=I.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(I){return this.minX<=I.maxX&&this.maxX>=I.minX&&this.minY<=I.maxY&&this.maxY>=I.minY}}function L(X,I,C,v,W){return W!==void 0?(W.minX=X,W.maxX=I,W.minY=C,W.maxY=v,W):new U(X,I,C,v)}const Y=U},11078:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},91765:(Nt,at,r)=>{"use strict";r.d(at,{Ay:()=>st});var U=r(34120),L=r(62703);const Y={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var X=r(57115),I=r(22796),C=r(74238),v=r(6933),W=r(90588),d=r(61597);function a(l,s,n){return function(o,_,D,N,V){if(!o)return;if(!_&&!s)return o;const H=s?0:D[0]*_,rt=s?0:D[1]*_,it=V?V[0]:0,ct=V?V[1]:0;let gt=l[0]+H/2+it,yt=l[2]-H/2+it,pt=l[1]+rt/2+ct,Dt=l[3]-rt/2+ct;gt>yt&&(gt=(yt+gt)/2,yt=gt),pt>Dt&&(pt=(Dt+pt)/2,Dt=pt);let Gt=(0,d.qE)(o[0],gt,yt),$t=(0,d.qE)(o[1],pt,Dt);if(N&&n&&_){const te=30*_;Gt+=-te*Math.log(1+Math.max(0,gt-o[0])/te)+te*Math.log(1+Math.max(0,o[0]-yt)/te),$t+=-te*Math.log(1+Math.max(0,pt-o[1])/te)+te*Math.log(1+Math.max(0,o[1]-Dt)/te)}return[Gt,$t]}}function E(l){return l}var p=r(70915),u=r(66514);function z(l,s,n,o){const _=(0,p.RG)(s)/n[0],D=(0,p.Oq)(s)/n[1];return o?Math.min(l,Math.max(_,D)):Math.min(l,Math.min(_,D))}function f(l,s,n){let o=Math.min(l,s);const _=50;return o*=Math.log(1+_*Math.max(0,l/s-1))/_+1,n&&(o=Math.max(o,n),o/=Math.log(1+_*Math.max(0,n/l-1))/_+1),(0,d.qE)(o,n/2,s*2)}function A(l,s,n,o){return s=s!==void 0?s:!0,function(_,D,N,V){if(_!==void 0){const H=l[0],rt=l[l.length-1],it=n?z(H,n,N,o):H;if(V)return s?f(_,it,rt):(0,d.qE)(_,rt,it);const ct=Math.min(it,_),gt=Math.floor((0,u.FT)(l,ct,D));return l[gt]>it&&gt<l.length-1?l[gt+1]:l[gt]}}}function M(l,s,n,o,_,D){return o=o!==void 0?o:!0,n=n!==void 0?n:0,function(N,V,H,rt){if(N!==void 0){const it=_?z(s,_,H,D):s;if(rt)return o?f(N,it,n):(0,d.qE)(N,n,it);const ct=1e-9,gt=Math.ceil(Math.log(s/it)/Math.log(l)-ct),yt=-V*(.5-ct)+.5,pt=Math.min(it,N),Dt=Math.floor(Math.log(s/pt)/Math.log(l)+yt),Gt=Math.max(gt,Dt),$t=s/Math.pow(l,Gt);return(0,d.qE)($t,n,it)}}}function m(l,s,n,o,_){return n=n!==void 0?n:!0,function(D,N,V,H){if(D!==void 0){const rt=o?z(l,o,V,_):l;return!n||!H?(0,d.qE)(D,s,rt):f(D,rt,s)}}}var g=r(24498),O=r(93474),b=r(71064);const q=0;class ht extends U.A{constructor(s){super(),this.on,this.once,this.un,s=Object.assign({},s),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=(0,I.Av)(s.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,s.projection&&(0,I.RJ)(),s.center&&(s.center=(0,I.Ad)(s.center,this.projection_)),s.extent&&(s.extent=(0,I.SD)(s.extent,this.projection_)),this.applyOptions_(s)}applyOptions_(s){const n=Object.assign({},s);for(const V in Y)delete n[V];this.setProperties(n,!0);const o=R(s);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=s.resolutions,this.padding_=s.padding,this.minZoom_=o.minZoom;const _=J(s),D=o.constraint,N=T(s);this.constraints_={center:_,resolution:D,rotation:N},this.setRotation(s.rotation!==void 0?s.rotation:0),this.setCenterInternal(s.center!==void 0?s.center:null),s.resolution!==void 0?this.setResolution(s.resolution):s.zoom!==void 0&&this.setZoom(s.zoom)}get padding(){return this.padding_}set padding(s){let n=this.padding_;this.padding_=s;const o=this.getCenterInternal();if(o){const _=s||[0,0,0,0];n=n||[0,0,0,0];const D=this.getResolution(),N=D/2*(_[3]-n[3]+n[1]-_[1]),V=D/2*(_[0]-n[0]+n[2]-_[2]);this.setCenterInternal([o[0]+N,o[1]-V])}}getUpdatedOptions_(s){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,s)}animate(s){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let o=0;o<n.length;++o){let _=arguments[o];_.center&&(_=Object.assign({},_),_.center=(0,I.Ad)(_.center,this.getProjection())),_.anchor&&(_=Object.assign({},_),_.anchor=(0,I.Ad)(_.anchor,this.getProjection())),n[o]=_}this.animateInternal.apply(this,n)}animateInternal(s){let n=arguments.length,o;n>1&&typeof arguments[n-1]=="function"&&(o=arguments[n-1],--n);let _=0;for(;_<n&&!this.isDef();++_){const it=arguments[_];it.center&&this.setCenterInternal(it.center),it.zoom!==void 0?this.setZoom(it.zoom):it.resolution&&this.setResolution(it.resolution),it.rotation!==void 0&&this.setRotation(it.rotation)}if(_===n){o&&et(o,!0);return}let D=Date.now(),N=this.targetCenter_.slice(),V=this.targetResolution_,H=this.targetRotation_;const rt=[];for(;_<n;++_){const it=arguments[_],ct={start:D,complete:!1,anchor:it.anchor,duration:it.duration!==void 0?it.duration:1e3,easing:it.easing||O.T9,callback:o};if(it.center&&(ct.sourceCenter=N,ct.targetCenter=it.center.slice(),N=ct.targetCenter),it.zoom!==void 0?(ct.sourceResolution=V,ct.targetResolution=this.getResolutionForZoom(it.zoom),V=ct.targetResolution):it.resolution&&(ct.sourceResolution=V,ct.targetResolution=it.resolution,V=ct.targetResolution),it.rotation!==void 0){ct.sourceRotation=H;const gt=(0,d.xP)(it.rotation-H+Math.PI,2*Math.PI)-Math.PI;ct.targetRotation=H+gt,H=ct.targetRotation}K(ct)?ct.complete=!0:D+=ct.duration,rt.push(ct)}this.animations_.push(rt),this.setHint(L.A.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[L.A.ANIMATING]>0}getInteracting(){return this.hints_[L.A.INTERACTING]>0}cancelAnimations(){this.setHint(L.A.ANIMATING,-this.hints_[L.A.ANIMATING]);let s;for(let n=0,o=this.animations_.length;n<o;++n){const _=this.animations_[n];if(_[0].callback&&et(_[0].callback,!1),!s)for(let D=0,N=_.length;D<N;++D){const V=_[D];if(!V.complete){s=V.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=s,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const s=Date.now();let n=!1;for(let o=this.animations_.length-1;o>=0;--o){const _=this.animations_[o];let D=!0;for(let N=0,V=_.length;N<V;++N){const H=_[N];if(H.complete)continue;const rt=s-H.start;let it=H.duration>0?rt/H.duration:1;it>=1?(H.complete=!0,it=1):D=!1;const ct=H.easing(it);if(H.sourceCenter){const gt=H.sourceCenter[0],yt=H.sourceCenter[1],pt=H.targetCenter[0],Dt=H.targetCenter[1];this.nextCenter_=H.targetCenter;const Gt=gt+ct*(pt-gt),$t=yt+ct*(Dt-yt);this.targetCenter_=[Gt,$t]}if(H.sourceResolution&&H.targetResolution){const gt=ct===1?H.targetResolution:H.sourceResolution+ct*(H.targetResolution-H.sourceResolution);if(H.anchor){const yt=this.getViewportSize_(this.getRotation()),pt=this.constraints_.resolution(gt,0,yt,!0);this.targetCenter_=this.calculateCenterZoom(pt,H.anchor)}this.nextResolution_=H.targetResolution,this.targetResolution_=gt,this.applyTargetState_(!0)}if(H.sourceRotation!==void 0&&H.targetRotation!==void 0){const gt=ct===1?(0,d.xP)(H.targetRotation+Math.PI,2*Math.PI)-Math.PI:H.sourceRotation+ct*(H.targetRotation-H.sourceRotation);if(H.anchor){const yt=this.constraints_.rotation(gt,!0);this.targetCenter_=this.calculateCenterRotate(yt,H.anchor)}this.nextRotation_=H.targetRotation,this.targetRotation_=gt}if(this.applyTargetState_(!0),n=!0,!H.complete)break}if(D){this.animations_[o]=null,this.setHint(L.A.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const N=_[0].callback;N&&et(N,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(s,n){let o;const _=this.getCenterInternal();return _!==void 0&&(o=[_[0]-n[0],_[1]-n[1]],(0,v.e$)(o,s-this.getRotation()),(0,v.WQ)(o,n)),o}calculateCenterZoom(s,n){let o;const _=this.getCenterInternal(),D=this.getResolution();if(_!==void 0&&D!==void 0){const N=n[0]-s*(n[0]-_[0])/D,V=n[1]-s*(n[1]-_[1])/D;o=[N,V]}return o}getViewportSize_(s){const n=this.viewportSize_;if(s){const o=n[0],_=n[1];return[Math.abs(o*Math.cos(s))+Math.abs(_*Math.sin(s)),Math.abs(o*Math.sin(s))+Math.abs(_*Math.cos(s))]}return n}setViewportSize(s){this.viewportSize_=Array.isArray(s)?s.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const s=this.getCenterInternal();return s&&(0,I.te)(s,this.getProjection())}getCenterInternal(){return this.get(Y.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(s){return s!==void 0?(s[0]=this.hints_[0],s[1]=this.hints_[1],s):this.hints_.slice()}calculateExtent(s){const n=this.calculateExtentInternal(s);return(0,I.JR)(n,this.getProjection())}calculateExtentInternal(s){s=s||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();(0,W.v)(n,1);const o=this.getResolution();(0,W.v)(o!==void 0,2);const _=this.getRotation();return(0,W.v)(_!==void 0,3),(0,p.Bg)(n,o,_,s)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(s){this.applyOptions_(this.getUpdatedOptions_({maxZoom:s}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(s){this.applyOptions_(this.getUpdatedOptions_({minZoom:s}))}setConstrainResolution(s){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:s}))}getProjection(){return this.projection_}getResolution(){return this.get(Y.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(s,n){return this.getResolutionForExtentInternal((0,I.SD)(s,this.getProjection()),n)}getResolutionForExtentInternal(s,n){n=n||this.getViewportSizeMinusPadding_();const o=(0,p.RG)(s)/n[0],_=(0,p.Oq)(s)/n[1];return Math.max(o,_)}getResolutionForValueFunction(s){s=s||2;const n=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,_=Math.log(n/o)/Math.log(s);return function(D){return n/Math.pow(s,D*_)}}getRotation(){return this.get(Y.ROTATION)}getValueForResolutionFunction(s){const n=Math.log(s||2),o=this.getConstrainedResolution(this.maxResolution_),_=this.minResolution_,D=Math.log(o/_)/n;return function(N){return Math.log(o/N)/n/D}}getViewportSizeMinusPadding_(s){let n=this.getViewportSize_(s);const o=this.padding_;return o&&(n=[n[0]-o[1]-o[3],n[1]-o[0]-o[2]]),n}getState(){const s=this.getProjection(),n=this.getResolution(),o=this.getRotation();let _=this.getCenterInternal();const D=this.padding_;if(D){const N=this.getViewportSizeMinusPadding_();_=Q(_,this.getViewportSize_(),[N[0]/2+D[3],N[1]/2+D[0]],n,o)}return{center:_.slice(0),projection:s!==void 0?s:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:o,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let s;const n=this.getResolution();return n!==void 0&&(s=this.getZoomForResolution(n)),s}getZoomForResolution(s){let n=this.minZoom_||0,o,_;if(this.resolutions_){const D=(0,u.FT)(this.resolutions_,s,1);n=D,o=this.resolutions_[D],D==this.resolutions_.length-1?_=2:_=o/this.resolutions_[D+1]}else o=this.maxResolution_,_=this.zoomFactor_;return n+Math.log(o/s)/Math.log(_)}getResolutionForZoom(s){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const n=(0,d.qE)(Math.floor(s),0,this.resolutions_.length-2),o=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(o,(0,d.qE)(s-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,s-this.minZoom_)}fit(s,n){let o;if((0,W.v)(Array.isArray(s)||typeof s.getSimplifiedGeometry=="function",24),Array.isArray(s)){(0,W.v)(!(0,p.Im)(s),25);const _=(0,I.SD)(s,this.getProjection());o=(0,b.VY)(_)}else if(s.getType()==="Circle"){const _=(0,I.SD)(s.getExtent(),this.getProjection());o=(0,b.VY)(_),o.rotate(this.getRotation(),(0,p.q1)(_))}else{const _=(0,I.Tf)();_?o=s.clone().transform(_,this.getProjection()):o=s}this.fitInternal(o,n)}rotatedExtentForGeometry(s){const n=this.getRotation(),o=Math.cos(n),_=Math.sin(-n),D=s.getFlatCoordinates(),N=s.getStride();let V=1/0,H=1/0,rt=-1/0,it=-1/0;for(let ct=0,gt=D.length;ct<gt;ct+=N){const yt=D[ct]*o-D[ct+1]*_,pt=D[ct]*_+D[ct+1]*o;V=Math.min(V,yt),H=Math.min(H,pt),rt=Math.max(rt,yt),it=Math.max(it,pt)}return[V,H,rt,it]}fitInternal(s,n){n=n||{};let o=n.size;o||(o=this.getViewportSizeMinusPadding_());const _=n.padding!==void 0?n.padding:[0,0,0,0],D=n.nearest!==void 0?n.nearest:!1;let N;n.minResolution!==void 0?N=n.minResolution:n.maxZoom!==void 0?N=this.getResolutionForZoom(n.maxZoom):N=0;const V=this.rotatedExtentForGeometry(s);let H=this.getResolutionForExtentInternal(V,[o[0]-_[1]-_[3],o[1]-_[0]-_[2]]);H=isNaN(H)?N:Math.max(H,N),H=this.getConstrainedResolution(H,D?0:1);const rt=this.getRotation(),it=Math.sin(rt),ct=Math.cos(rt),gt=(0,p.q1)(V);gt[0]+=(_[1]-_[3])/2*H,gt[1]+=(_[0]-_[2])/2*H;const yt=gt[0]*ct-gt[1]*it,pt=gt[1]*ct+gt[0]*it,Dt=this.getConstrainedCenter([yt,pt],H),Gt=n.callback?n.callback:C.tV;n.duration!==void 0?this.animateInternal({resolution:H,center:Dt,duration:n.duration,easing:n.easing},Gt):(this.targetResolution_=H,this.targetCenter_=Dt,this.applyTargetState_(!1,!0),et(Gt,!0))}centerOn(s,n,o){this.centerOnInternal((0,I.Ad)(s,this.getProjection()),n,o)}centerOnInternal(s,n,o){this.setCenterInternal(Q(s,n,o,this.getResolution(),this.getRotation()))}calculateCenterShift(s,n,o,_){let D;const N=this.padding_;if(N&&s){const V=this.getViewportSizeMinusPadding_(-o),H=Q(s,_,[V[0]/2+N[3],V[1]/2+N[0]],n,o);D=[s[0]-H[0],s[1]-H[1]]}return D}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(s){const n=(0,I.te)(this.targetCenter_,this.getProjection());this.setCenter([n[0]+s[0],n[1]+s[1]])}adjustCenterInternal(s){const n=this.targetCenter_;this.setCenterInternal([n[0]+s[0],n[1]+s[1]])}adjustResolution(s,n){n=n&&(0,I.Ad)(n,this.getProjection()),this.adjustResolutionInternal(s,n)}adjustResolutionInternal(s,n){const o=this.getAnimating()||this.getInteracting(),_=this.getViewportSize_(this.getRotation()),D=this.constraints_.resolution(this.targetResolution_*s,0,_,o);n&&(this.targetCenter_=this.calculateCenterZoom(D,n)),this.targetResolution_*=s,this.applyTargetState_()}adjustZoom(s,n){this.adjustResolution(Math.pow(this.zoomFactor_,-s),n)}adjustRotation(s,n){n&&(n=(0,I.Ad)(n,this.getProjection())),this.adjustRotationInternal(s,n)}adjustRotationInternal(s,n){const o=this.getAnimating()||this.getInteracting(),_=this.constraints_.rotation(this.targetRotation_+s,o);n&&(this.targetCenter_=this.calculateCenterRotate(_,n)),this.targetRotation_+=s,this.applyTargetState_()}setCenter(s){this.setCenterInternal(s&&(0,I.Ad)(s,this.getProjection()))}setCenterInternal(s){this.targetCenter_=s,this.applyTargetState_()}setHint(s,n){return this.hints_[s]+=n,this.changed(),this.hints_[s]}setResolution(s){this.targetResolution_=s,this.applyTargetState_()}setRotation(s){this.targetRotation_=s,this.applyTargetState_()}setZoom(s){this.setResolution(this.getResolutionForZoom(s))}applyTargetState_(s,n){const o=this.getAnimating()||this.getInteracting()||n,_=this.constraints_.rotation(this.targetRotation_,o),D=this.getViewportSize_(_),N=this.constraints_.resolution(this.targetResolution_,0,D,o),V=this.constraints_.center(this.targetCenter_,N,D,o,this.calculateCenterShift(this.targetCenter_,N,_,D));this.get(Y.ROTATION)!==_&&this.set(Y.ROTATION,_),this.get(Y.RESOLUTION)!==N&&(this.set(Y.RESOLUTION,N),this.set("zoom",this.getZoom(),!0)),(!V||!this.get(Y.CENTER)||!(0,v.aI)(this.get(Y.CENTER),V))&&this.set(Y.CENTER,V),this.getAnimating()&&!s&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(s,n,o){s=s!==void 0?s:200;const _=n||0,D=this.constraints_.rotation(this.targetRotation_),N=this.getViewportSize_(D),V=this.constraints_.resolution(this.targetResolution_,_,N),H=this.constraints_.center(this.targetCenter_,V,N,!1,this.calculateCenterShift(this.targetCenter_,V,D,N));if(s===0&&!this.cancelAnchor_){this.targetResolution_=V,this.targetRotation_=D,this.targetCenter_=H,this.applyTargetState_();return}o=o||(s===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==V||this.getRotation()!==D||!this.getCenterInternal()||!(0,v.aI)(this.getCenterInternal(),H))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:D,center:H,resolution:V,duration:s,easing:O.vT,anchor:o}))}beginInteraction(){this.resolveConstraints(0),this.setHint(L.A.INTERACTING,1)}endInteraction(s,n,o){o=o&&(0,I.Ad)(o,this.getProjection()),this.endInteractionInternal(s,n,o)}endInteractionInternal(s,n,o){this.getInteracting()&&(this.setHint(L.A.INTERACTING,-1),this.resolveConstraints(s,n,o))}getConstrainedCenter(s,n){const o=this.getViewportSize_(this.getRotation());return this.constraints_.center(s,n||this.getResolution(),o)}getConstrainedZoom(s,n){const o=this.getResolutionForZoom(s);return this.getZoomForResolution(this.getConstrainedResolution(o,n))}getConstrainedResolution(s,n){n=n||0;const o=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(s,n,o)}}function et(l,s){setTimeout(function(){l(s)},0)}function J(l){if(l.extent!==void 0){const n=l.smoothExtentConstraint!==void 0?l.smoothExtentConstraint:!0;return a(l.extent,l.constrainOnlyCenter,n)}const s=(0,I.Av)(l.projection,"EPSG:3857");if(l.multiWorld!==!0&&s.isGlobal()){const n=s.getExtent().slice();return n[0]=-1/0,n[2]=1/0,a(n,!1,!1)}return E}function R(l){let s,n,o,N=l.minZoom!==void 0?l.minZoom:q,V=l.maxZoom!==void 0?l.maxZoom:28;const H=l.zoomFactor!==void 0?l.zoomFactor:2,rt=l.multiWorld!==void 0?l.multiWorld:!1,it=l.smoothResolutionConstraint!==void 0?l.smoothResolutionConstraint:!0,ct=l.showFullExtent!==void 0?l.showFullExtent:!1,gt=(0,I.Av)(l.projection,"EPSG:3857"),yt=gt.getExtent();let pt=l.constrainOnlyCenter,Dt=l.extent;if(!rt&&!Dt&&gt.isGlobal()&&(pt=!1,Dt=yt),l.resolutions!==void 0){const Gt=l.resolutions;n=Gt[N],o=Gt[V]!==void 0?Gt[V]:Gt[Gt.length-1],l.constrainResolution?s=A(Gt,it,!pt&&Dt,ct):s=m(n,o,it,!pt&&Dt,ct)}else{const $t=(yt?Math.max((0,p.RG)(yt),(0,p.Oq)(yt)):360*I.Ig.degrees/gt.getMetersPerUnit())/X.R/Math.pow(2,q),te=$t/Math.pow(2,28-q);n=l.maxResolution,n!==void 0?N=0:n=$t/Math.pow(H,N),o=l.minResolution,o===void 0&&(l.maxZoom!==void 0?l.maxResolution!==void 0?o=n/Math.pow(H,V):o=$t/Math.pow(H,V):o=te),V=N+Math.floor(Math.log(n/o)/Math.log(H)),o=n/Math.pow(H,V-N),l.constrainResolution?s=M(H,n,o,it,!pt&&Dt,ct):s=m(n,o,it,!pt&&Dt,ct)}return{constraint:s,maxResolution:n,minResolution:o,minZoom:N,zoomFactor:H}}function T(l){if(l.enableRotation!==void 0?l.enableRotation:!0){const n=l.constrainRotation;return n===void 0||n===!0?(0,g.cq)():n===!1?g.dv:typeof n=="number"?(0,g.a$)(n):g.dv}return g.b8}function K(l){return!(l.sourceCenter&&l.targetCenter&&!(0,v.aI)(l.sourceCenter,l.targetCenter)||l.sourceResolution!==l.targetResolution||l.sourceRotation!==l.targetRotation)}function Q(l,s,n,o,_){const D=Math.cos(-_);let N=Math.sin(-_),V=l[0]*D-l[1]*N,H=l[1]*D+l[0]*N;V+=(s[0]/2-n[0])*o,H+=(n[1]-s[1]/2)*o,N=-N;const rt=V*D-H*N,it=H*D+V*N;return[rt,it]}const st=ht},62703:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={ANIMATING:0,INTERACTING:1}},89352:(Nt,at,r)=>{"use strict";r.d(at,{$C:()=>p,_j:()=>W,dI:()=>E,oJ:()=>I,sH:()=>v});var U=r(90588),L=r(61597);const Y=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,X=/^([a-z]*)$|^hsla?\(.*\)$/i;function I(u){return typeof u=="string"?u:E(u)}function C(u){const z=document.createElement("div");if(z.style.color=u,z.style.color!==""){document.body.appendChild(z);const f=getComputedStyle(z).color;return document.body.removeChild(z),f}return""}const v=function(){const z={};let f=0;return function(A){let M;if(z.hasOwnProperty(A))M=z[A];else{if(f>=1024){let m=0;for(const g in z)(m++&3)===0&&(delete z[g],--f)}M=d(A),z[A]=M,++f}return M}}();function W(u){return Array.isArray(u)?u:v(u)}function d(u){let z,f,A,M,m;if(X.exec(u)&&(u=C(u)),Y.exec(u)){const g=u.length-1;let O;g<=4?O=1:O=2;const b=g===4||g===8;z=parseInt(u.substr(1+0*O,O),16),f=parseInt(u.substr(1+1*O,O),16),A=parseInt(u.substr(1+2*O,O),16),b?M=parseInt(u.substr(1+3*O,O),16):M=255,O==1&&(z=(z<<4)+z,f=(f<<4)+f,A=(A<<4)+A,b&&(M=(M<<4)+M)),m=[z,f,A,M/255]}else u.startsWith("rgba(")?(m=u.slice(5,-1).split(",").map(Number),a(m)):u.startsWith("rgb(")?(m=u.slice(4,-1).split(",").map(Number),m.push(1),a(m)):(0,U.v)(!1,14);return m}function a(u){return u[0]=(0,L.qE)(u[0]+.5|0,0,255),u[1]=(0,L.qE)(u[1]+.5|0,0,255),u[2]=(0,L.qE)(u[2]+.5|0,0,255),u[3]=(0,L.qE)(u[3],0,1),u}function E(u){let z=u[0];z!=(z|0)&&(z=z+.5|0);let f=u[1];f!=(f|0)&&(f=f+.5|0);let A=u[2];A!=(A|0)&&(A=A+.5|0);const M=u[3]===void 0?1:Math.round(u[3]*100)/100;return"rgba("+z+","+f+","+A+","+M+")"}function p(u){return X.test(u)&&(u=C(u)),Y.test(u)||u.startsWith("rgba(")||u.startsWith("rgb(")}},99676:(Nt,at,r)=>{"use strict";r.d(at,{F:()=>L});var U=r(89352);function L(Y){return Array.isArray(Y)?(0,U.dI)(Y):Y}},57456:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(10972),L=r(6837),Y=r(25176),X=r(66514),I=r(68711);class C extends U.A{constructor(d){d=d||{},super({element:document.createElement("div"),render:d.render,target:d.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=d.collapsed!==void 0?d.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=d.collapsible!==void 0,this.collapsible_=d.collapsible!==void 0?d.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const a=d.className!==void 0?d.className:"ol-attribution",E=d.tipLabel!==void 0?d.tipLabel:"Attributions",p=d.expandClassName!==void 0?d.expandClassName:a+"-expand",u=d.collapseLabel!==void 0?d.collapseLabel:"\u203A",z=d.collapseClassName!==void 0?d.collapseClassName:a+"-collapse";typeof u=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=u,this.collapseLabel_.className=z):this.collapseLabel_=u;const f=d.label!==void 0?d.label:"i";typeof f=="string"?(this.label_=document.createElement("span"),this.label_.textContent=f,this.label_.className=p):this.label_=f;const A=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=E,this.toggleButton_.appendChild(A),this.toggleButton_.addEventListener(L.A.CLICK,this.handleClick_.bind(this),!1);const M=a+" "+Y.XI+" "+Y.$N+(this.collapsed_&&this.collapsible_?" "+Y.nT:"")+(this.collapsible_?"":" ol-uncollapsible"),m=this.element;m.className=M,m.appendChild(this.toggleButton_),m.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(d){const a=Array.from(new Set(this.getMap().getAllLayers().flatMap(p=>p.getAttributions(d)))),E=!this.getMap().getAllLayers().some(p=>p.getSource()&&p.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(E),a}updateElement_(d){if(!d){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const a=this.collectSourceAttributions_(d),E=a.length>0;if(this.renderedVisible_!=E&&(this.element.style.display=E?"":"none",this.renderedVisible_=E),!(0,X.aI)(a,this.renderedAttributions_)){(0,I.gS)(this.ulElement_);for(let p=0,u=a.length;p<u;++p){const z=document.createElement("li");z.innerHTML=a[p],this.ulElement_.appendChild(z)}this.renderedAttributions_=a}}handleClick_(d){d.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Y.nT),this.collapsed_?(0,I.fo)(this.collapseLabel_,this.label_):(0,I.fo)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(d){this.collapsible_!==d&&(this.collapsible_=d,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(d){this.userCollapsed_=d,!(!this.collapsible_||this.collapsed_===d)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(d){this.updateElement_(d.frameState)}}const v=C},10972:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(34120),L=r(82585),Y=r(74238),X=r(9438),I=r(68711);class C extends U.A{constructor(d){super();const a=d.element;a&&!d.target&&!a.style.pointerEvents&&(a.style.pointerEvents="auto"),this.element=a||null,this.target_=null,this.map_=null,this.listenerKeys=[],d.render&&(this.render=d.render),d.target&&this.setTarget(d.target)}disposeInternal(){(0,I.bf)(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(d){this.map_&&(0,I.bf)(this.element);for(let a=0,E=this.listenerKeys.length;a<E;++a)(0,X.JH)(this.listenerKeys[a]);this.listenerKeys.length=0,this.map_=d,d&&((this.target_?this.target_:d.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Y.tV&&this.listenerKeys.push((0,X.KT)(d,L.A.POSTRENDER,this.render,this)),d.render())}render(d){}setTarget(d){this.target_=typeof d=="string"?document.getElementById(d):d}}const v=C},69186:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>C});var U=r(10972),L=r(6837),Y=r(25176),X=r(93474);class I extends U.A{constructor(W){W=W||{},super({element:document.createElement("div"),target:W.target});const d=W.className!==void 0?W.className:"ol-zoom",a=W.delta!==void 0?W.delta:1,E=W.zoomInClassName!==void 0?W.zoomInClassName:d+"-in",p=W.zoomOutClassName!==void 0?W.zoomOutClassName:d+"-out",u=W.zoomInLabel!==void 0?W.zoomInLabel:"+",z=W.zoomOutLabel!==void 0?W.zoomOutLabel:"\u2013",f=W.zoomInTipLabel!==void 0?W.zoomInTipLabel:"Zoom in",A=W.zoomOutTipLabel!==void 0?W.zoomOutTipLabel:"Zoom out",M=document.createElement("button");M.className=E,M.setAttribute("type","button"),M.title=f,M.appendChild(typeof u=="string"?document.createTextNode(u):u),M.addEventListener(L.A.CLICK,this.handleClick_.bind(this,a),!1);const m=document.createElement("button");m.className=p,m.setAttribute("type","button"),m.title=A,m.appendChild(typeof z=="string"?document.createTextNode(z):z),m.addEventListener(L.A.CLICK,this.handleClick_.bind(this,-a),!1);const g=d+" "+Y.XI+" "+Y.$N,O=this.element;O.className=g,O.appendChild(M),O.appendChild(m),this.duration_=W.duration!==void 0?W.duration:250}handleClick_(W,d){d.preventDefault(),this.zoomByDelta_(W)}zoomByDelta_(W){const a=this.getMap().getView();if(!a)return;const E=a.getZoom();if(E!==void 0){const p=a.getConstrainedZoom(E+W);this.duration_>0?(a.getAnimating()&&a.cancelAnimations(),a.animate({zoom:p,duration:this.duration_,easing:X.vT})):a.setZoom(p)}}}const C=I},25176:(Nt,at,r)=>{"use strict";r.d(at,{$N:()=>I,K5:()=>d,Si:()=>U,XI:()=>Y,nT:()=>C});const U="ol-hidden",L="ol-selectable",Y="ol-unselectable",X="ol-unsupported",I="ol-control",C="ol-collapsed",v=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),W=["style","variant","weight","size","lineHeight","family"],d=function(a){const E=a.match(v);if(!E)return null;const p={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let u=0,z=W.length;u<z;++u){const f=E[u+1];f!==void 0&&(p[W[u]]=f)}return p.families=p.family.split(/,\s?/),p}},68711:(Nt,at,r)=>{"use strict";r.d(at,{WM:()=>d,Y:()=>L,Yg:()=>Y,bf:()=>v,fo:()=>C,gS:()=>W});var U=r(7771);function L(a,E,p,u){let z;return p&&p.length?z=p.shift():U.Wl?z=new OffscreenCanvas(a||300,E||300):z=document.createElement("canvas"),a&&(z.width=a),E&&(z.height=E),z.getContext("2d",u)}function Y(a){const E=a.canvas;E.width=1,E.height=1,a.clearRect(0,0,1,1)}function X(a){let E=a.offsetWidth;const p=getComputedStyle(a);return E+=parseInt(p.marginLeft,10)+parseInt(p.marginRight,10),E}function I(a){let E=a.offsetHeight;const p=getComputedStyle(a);return E+=parseInt(p.marginTop,10)+parseInt(p.marginBottom,10),E}function C(a,E){const p=E.parentNode;p&&p.replaceChild(a,E)}function v(a){return a&&a.parentNode?a.parentNode.removeChild(a):null}function W(a){for(;a.lastChild;)a.removeChild(a.lastChild)}function d(a,E){const p=a.childNodes;for(let u=0;;++u){const z=p[u],f=E[u];if(!z&&!f)break;if(z!==f){if(!z){a.appendChild(f);continue}if(!f){a.removeChild(z),--u;continue}a.insertBefore(f,z)}}}},93474:(Nt,at,r)=>{"use strict";r.d(at,{T9:()=>Y,a6:()=>U,sn:()=>X,vT:()=>L});function U(C){return Math.pow(C,3)}function L(C){return 1-U(1-C)}function Y(C){return 3*C*C-2*C*C*C}function X(C){return C}function I(C){return C<.5?Y(2*C):1-Y(2*(C-.5))}},58704:(Nt,at,r)=>{"use strict";r.d(at,{A4:()=>b,Gk:()=>a,IO:()=>v,Js:()=>C,Kg:()=>g,Q7:()=>I,TS:()=>M,Zm:()=>u,at:()=>p,eL:()=>d,fs:()=>et,t5:()=>f,tE:()=>O});var U=r(73445),L=r(74238),Y=r(7771),X=r(90588);function I(J){const R=arguments;return function(T){let K=!0;for(let Q=0,st=R.length;Q<st&&(K=K&&R[Q](T),!!K);++Q);return K}}const C=function(J){const R=J.originalEvent;return R.altKey&&!(R.metaKey||R.ctrlKey)&&!R.shiftKey},v=function(J){const R=J.originalEvent;return R.altKey&&!(R.metaKey||R.ctrlKey)&&R.shiftKey},W=function(J){const R=J.map.getTargetElement(),T=J.map.getOwnerDocument().activeElement;return R.contains(T)},d=function(J){return J.map.getTargetElement().hasAttribute("tabindex")?W(J):!0},a=L.rT,E=function(J){return J.type==MapBrowserEventType.CLICK},p=function(J){const R=J.originalEvent;return R.button==0&&!(Y.j&&Y.ew&&R.ctrlKey)},u=L.W8,z=function(J){return J.type=="pointermove"},f=function(J){return J.type==U.A.SINGLECLICK},A=function(J){return J.type==MapBrowserEventType.DBLCLICK},M=function(J){const R=J.originalEvent;return!R.altKey&&!(R.metaKey||R.ctrlKey)&&!R.shiftKey},m=function(J){const R=J.originalEvent;return!R.altKey&&(MAC?R.metaKey:R.ctrlKey)&&!R.shiftKey},g=function(J){const R=J.originalEvent;return!R.altKey&&!(R.metaKey||R.ctrlKey)&&R.shiftKey},O=function(J){const R=J.originalEvent,T=R.target.tagName;return T!=="INPUT"&&T!=="SELECT"&&T!=="TEXTAREA"&&!R.target.isContentEditable},b=function(J){const R=J.originalEvent;return(0,X.v)(R!==void 0,56),R.pointerType=="mouse"},q=function(J){const R=J.originalEvent;return assert(R!==void 0,56),R.pointerType==="touch"},ht=function(J){const R=J.originalEvent;return assert(R!==void 0,56),R.pointerType==="pen"},et=function(J){const R=J.originalEvent;return(0,X.v)(R!==void 0,56),R.isPrimary&&R.button===0}},6292:(Nt,at,r)=>{"use strict";r.d(at,{Ay:()=>v,D2:()=>C,e4:()=>I});var U=r(34120),L=r(82187),Y=r(93474);class X extends U.A{constructor(d){super(),this.on,this.once,this.un,d&&d.handleEvent&&(this.handleEvent=d.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(L.A.ACTIVE)}getMap(){return this.map_}handleEvent(d){return!0}setActive(d){this.set(L.A.ACTIVE,d)}setMap(d){this.map_=d}}function I(W,d,a){const E=W.getCenterInternal();if(E){const p=[E[0]+d[0],E[1]+d[1]];W.animateInternal({duration:a!==void 0?a:250,easing:Y.sn,center:W.getConstrainedCenter(p)})}}function C(W,d,a,E){const p=W.getZoom();if(p===void 0)return;const u=W.getConstrainedZoom(p+d),z=W.getResolutionForZoom(u);W.getAnimating()&&W.cancelAnimations(),W.animate({resolution:z,anchor:a,duration:E!==void 0?E:250,easing:Y.vT})}const v=X},88751:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(6837),L=r(6292),Y=r(7771),X=r(58704),I=r(61597);class C extends L.Ay{constructor(d){d=d||{},super(d),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=d.maxDelta!==void 0?d.maxDelta:1,this.duration_=d.duration!==void 0?d.duration:250,this.timeout_=d.timeout!==void 0?d.timeout:80,this.useAnchor_=d.useAnchor!==void 0?d.useAnchor:!0,this.constrainResolution_=d.constrainResolution!==void 0?d.constrainResolution:!1;const a=d.condition?d.condition:X.Gk;this.condition_=d.onFocusOnly?(0,X.Q7)(X.eL,a):a,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const d=this.getMap();if(!d)return;d.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(d){if(!this.condition_(d)||d.type!==U.A.WHEEL)return!0;const E=d.map,p=d.originalEvent;p.preventDefault(),this.useAnchor_&&(this.lastAnchor_=d.coordinate);let u;if(d.type==U.A.WHEEL&&(u=p.deltaY,Y._p&&p.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(u/=Y.cr),p.deltaMode===WheelEvent.DOM_DELTA_LINE&&(u*=40)),u===0)return!1;this.lastDelta_=u;const z=Date.now();this.startTime_===void 0&&(this.startTime_=z),(!this.mode_||z-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(u)<4?"trackpad":"wheel");const f=E.getView();if(this.mode_==="trackpad"&&!(f.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(f.getAnimating()&&f.cancelAnimations(),f.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),f.adjustZoom(-u/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=z,!1;this.totalDelta_+=u;const A=Math.max(this.timeout_-(z-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,E),A),!1}handleWheelZoom_(d){const a=d.getView();a.getAnimating()&&a.cancelAnimations();let E=-(0,I.qE)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(a.getConstrainResolution()||this.constrainResolution_)&&(E=E?E>0?1:-1:0),(0,L.D2)(a,E,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(d){this.useAnchor_=d,d||(this.lastAnchor_=null)}}const v=C},21409:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>I,v:()=>X});var U=r(6292),L=r(73445);class Y extends U.Ay{constructor(v){v=v||{},super(v),v.handleDownEvent&&(this.handleDownEvent=v.handleDownEvent),v.handleDragEvent&&(this.handleDragEvent=v.handleDragEvent),v.handleMoveEvent&&(this.handleMoveEvent=v.handleMoveEvent),v.handleUpEvent&&(this.handleUpEvent=v.handleUpEvent),v.stopDown&&(this.stopDown=v.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(v){return!1}handleDragEvent(v){}handleEvent(v){if(!v.originalEvent)return!0;let W=!1;if(this.updateTrackedPointers_(v),this.handlingDownUpSequence){if(v.type==L.A.POINTERDRAG)this.handleDragEvent(v),v.originalEvent.preventDefault();else if(v.type==L.A.POINTERUP){const d=this.handleUpEvent(v);this.handlingDownUpSequence=d&&this.targetPointers.length>0}}else if(v.type==L.A.POINTERDOWN){const d=this.handleDownEvent(v);this.handlingDownUpSequence=d,W=this.stopDown(d)}else v.type==L.A.POINTERMOVE&&this.handleMoveEvent(v);return!W}handleMoveEvent(v){}handleUpEvent(v){return!1}stopDown(v){return v}updateTrackedPointers_(v){v.activePointers&&(this.targetPointers=v.activePointers)}}function X(C){const v=C.length;let W=0,d=0;for(let a=0;a<v;a++)W+=C[a].clientX,d+=C[a].clientY;return{clientX:W/v,clientY:d/v}}const I=Y},82187:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={ACTIVE:"active"}},58620:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(34120),L=r(75332),Y=r(4087),X=r(90588),I=r(61597);class C extends U.A{constructor(d){super(),this.on,this.once,this.un,this.background_=d.background;const a=Object.assign({},d);typeof d.properties=="object"&&(delete a.properties,Object.assign(a,d.properties)),a[L.A.OPACITY]=d.opacity!==void 0?d.opacity:1,(0,X.v)(typeof a[L.A.OPACITY]=="number",64),a[L.A.VISIBLE]=d.visible!==void 0?d.visible:!0,a[L.A.Z_INDEX]=d.zIndex,a[L.A.MAX_RESOLUTION]=d.maxResolution!==void 0?d.maxResolution:1/0,a[L.A.MIN_RESOLUTION]=d.minResolution!==void 0?d.minResolution:0,a[L.A.MIN_ZOOM]=d.minZoom!==void 0?d.minZoom:-1/0,a[L.A.MAX_ZOOM]=d.maxZoom!==void 0?d.maxZoom:1/0,this.className_=a.className!==void 0?a.className:"ol-layer",delete a.className,this.setProperties(a),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(d){const a=this.state_||{layer:this,managed:d===void 0?!0:d},E=this.getZIndex();return a.opacity=(0,I.qE)(Math.round(this.getOpacity()*100)/100,0,1),a.visible=this.getVisible(),a.extent=this.getExtent(),a.zIndex=E===void 0&&!a.managed?1/0:E,a.maxResolution=this.getMaxResolution(),a.minResolution=Math.max(this.getMinResolution(),0),a.minZoom=this.getMinZoom(),a.maxZoom=this.getMaxZoom(),this.state_=a,a}getLayersArray(d){return(0,Y.b0)()}getLayerStatesArray(d){return(0,Y.b0)()}getExtent(){return this.get(L.A.EXTENT)}getMaxResolution(){return this.get(L.A.MAX_RESOLUTION)}getMinResolution(){return this.get(L.A.MIN_RESOLUTION)}getMinZoom(){return this.get(L.A.MIN_ZOOM)}getMaxZoom(){return this.get(L.A.MAX_ZOOM)}getOpacity(){return this.get(L.A.OPACITY)}getSourceState(){return(0,Y.b0)()}getVisible(){return this.get(L.A.VISIBLE)}getZIndex(){return this.get(L.A.Z_INDEX)}setBackground(d){this.background_=d,this.changed()}setExtent(d){this.set(L.A.EXTENT,d)}setMaxResolution(d){this.set(L.A.MAX_RESOLUTION,d)}setMinResolution(d){this.set(L.A.MIN_RESOLUTION,d)}setMaxZoom(d){this.set(L.A.MAX_ZOOM,d)}setMinZoom(d){this.set(L.A.MIN_ZOOM,d)}setOpacity(d){(0,X.v)(typeof d=="number",64),this.set(L.A.OPACITY,d)}setVisible(d){this.set(L.A.VISIBLE,d)}setZIndex(d){this.set(L.A.Z_INDEX,d)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const v=C},26469:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>M});var U=r(60764),L=r(35341),Y=r(29276),X=r(27733),I=r(13628),C=r(3407),v=r(86936),W=r(953),d=r(81426);function a(m){return new Y.Ay({fill:E(m,""),stroke:p(m,""),text:u(m),image:z(m)})}function E(m,g){const O=m[g+"fill-color"];if(O)return new I.A({color:O})}function p(m,g){const O=m[g+"stroke-width"],b=m[g+"stroke-color"];if(!(!O&&!b))return new W.A({width:O,color:b,lineCap:m[g+"stroke-line-cap"],lineJoin:m[g+"stroke-line-join"],lineDash:m[g+"stroke-line-dash"],lineDashOffset:m[g+"stroke-line-dash-offset"],miterLimit:m[g+"stroke-miter-limit"]})}function u(m){const g=m["text-value"];return g?new d.A({text:g,font:m["text-font"],maxAngle:m["text-max-angle"],offsetX:m["text-offset-x"],offsetY:m["text-offset-y"],overflow:m["text-overflow"],placement:m["text-placement"],repeat:m["text-repeat"],scale:m["text-scale"],rotateWithView:m["text-rotate-with-view"],rotation:m["text-rotation"],textAlign:m["text-align"],justify:m["text-justify"],textBaseline:m["text-baseline"],padding:m["text-padding"],fill:E(m,"text-"),backgroundFill:E(m,"text-background-"),stroke:p(m,"text-"),backgroundStroke:p(m,"text-background-")}):void 0}function z(m){const g=m["icon-src"],O=m["icon-img"];if(g||O)return new C.A({src:g,img:O,imgSize:m["icon-img-size"],anchor:m["icon-anchor"],anchorOrigin:m["icon-anchor-origin"],anchorXUnits:m["icon-anchor-x-units"],anchorYUnits:m["icon-anchor-y-units"],color:m["icon-color"],crossOrigin:m["icon-cross-origin"],offset:m["icon-offset"],displacement:m["icon-displacement"],opacity:m["icon-opacity"],scale:m["icon-scale"],width:m["icon-width"],height:m["icon-height"],rotation:m["icon-rotation"],rotateWithView:m["icon-rotate-with-view"],size:m["icon-size"],declutterMode:m["icon-declutter-mode"]});const b=m["shape-points"];if(b){const ht="shape-";return new v.A({points:b,fill:E(m,ht),stroke:p(m,ht),radius:m["shape-radius"],radius1:m["shape-radius1"],radius2:m["shape-radius2"],angle:m["shape-angle"],displacement:m["shape-displacement"],rotation:m["shape-rotation"],rotateWithView:m["shape-rotate-with-view"],scale:m["shape-scale"],declutterMode:m["shape-declutter-mode"]})}const q=m["circle-radius"];if(q){const ht="circle-";return new X.A({radius:q,fill:E(m,ht),stroke:p(m,ht),displacement:m["circle-displacement"],scale:m["circle-scale"],rotation:m["circle-rotation"],rotateWithView:m["circle-rotate-with-view"],declutterMode:m["circle-declutter-mode"]})}}const f={RENDER_ORDER:"renderOrder"};class A extends U.A{constructor(g){g=g||{};const O=Object.assign({},g);delete O.style,delete O.renderBuffer,delete O.updateWhileAnimating,delete O.updateWhileInteracting,super(O),this.declutter_=g.declutter!==void 0?g.declutter:!1,this.renderBuffer_=g.renderBuffer!==void 0?g.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(g.style),this.updateWhileAnimating_=g.updateWhileAnimating!==void 0?g.updateWhileAnimating:!1,this.updateWhileInteracting_=g.updateWhileInteracting!==void 0?g.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(g){return super.getFeatures(g)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(f.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(g){g.declutterTree||(g.declutterTree=new L(9)),this.getRenderer().renderDeclutter(g)}setRenderOrder(g){this.set(f.RENDER_ORDER,g)}setStyle(g){let O;if(g===void 0)O=Y.d1;else if(g===null)O=null;else if(typeof g=="function")O=g;else if(g instanceof Y.Ay)O=g;else if(Array.isArray(g)){const b=g.length,q=new Array(b);for(let ht=0;ht<b;++ht){const et=g[ht];et instanceof Y.Ay?q[ht]=et:q[ht]=a(et)}O=q}else O=a(g);this.style_=O,this.styleFunction_=g===null?void 0:(0,Y.mC)(this.style_),this.changed()}}const M=A},35598:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>f,i:()=>p});var U=r(58620),L=r(50071),Y=r(32135),X=r(1685),I=r(6837),C=r(28450),v=r(90588),W=r(43530),d=r(70915),a=r(4087),E=r(9438);class p extends X.Ay{constructor(M,m){super(M),this.layer=m}}const u={LAYERS:"layers"};class z extends U.A{constructor(M){M=M||{};const m=Object.assign({},M);delete m.layers;let g=M.layers;super(m),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(u.LAYERS,this.handleLayersChanged_),g?Array.isArray(g)?g=new L.A(g.slice(),{unique:!0}):(0,v.v)(typeof g.getArray=="function",43):g=new L.A(void 0,{unique:!0}),this.setLayers(g)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(E.JH),this.layersListenerKeys_.length=0;const M=this.getLayers();this.layersListenerKeys_.push((0,E.KT)(M,Y.A.ADD,this.handleLayersAdd_,this),(0,E.KT)(M,Y.A.REMOVE,this.handleLayersRemove_,this));for(const g in this.listenerKeys_)this.listenerKeys_[g].forEach(E.JH);(0,W.I)(this.listenerKeys_);const m=M.getArray();for(let g=0,O=m.length;g<O;g++){const b=m[g];this.registerLayerListeners_(b),this.dispatchEvent(new p("addlayer",b))}this.changed()}registerLayerListeners_(M){const m=[(0,E.KT)(M,C.A.PROPERTYCHANGE,this.handleLayerChange_,this),(0,E.KT)(M,I.A.CHANGE,this.handleLayerChange_,this)];M instanceof z&&m.push((0,E.KT)(M,"addlayer",this.handleLayerGroupAdd_,this),(0,E.KT)(M,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,a.v6)(M)]=m}handleLayerGroupAdd_(M){this.dispatchEvent(new p("addlayer",M.layer))}handleLayerGroupRemove_(M){this.dispatchEvent(new p("removelayer",M.layer))}handleLayersAdd_(M){const m=M.element;this.registerLayerListeners_(m),this.dispatchEvent(new p("addlayer",m)),this.changed()}handleLayersRemove_(M){const m=M.element,g=(0,a.v6)(m);this.listenerKeys_[g].forEach(E.JH),delete this.listenerKeys_[g],this.dispatchEvent(new p("removelayer",m)),this.changed()}getLayers(){return this.get(u.LAYERS)}setLayers(M){const m=this.getLayers();if(m){const g=m.getArray();for(let O=0,b=g.length;O<b;++O)this.dispatchEvent(new p("removelayer",g[O]))}this.set(u.LAYERS,M)}getLayersArray(M){return M=M!==void 0?M:[],this.getLayers().forEach(function(m){m.getLayersArray(M)}),M}getLayerStatesArray(M){const m=M!==void 0?M:[],g=m.length;this.getLayers().forEach(function(q){q.getLayerStatesArray(m)});const O=this.getLayerState();let b=O.zIndex;!M&&O.zIndex===void 0&&(b=0);for(let q=g,ht=m.length;q<ht;q++){const et=m[q];et.opacity*=O.opacity,et.visible=et.visible&&O.visible,et.maxResolution=Math.min(et.maxResolution,O.maxResolution),et.minResolution=Math.max(et.minResolution,O.minResolution),et.minZoom=Math.max(et.minZoom,O.minZoom),et.maxZoom=Math.min(et.maxZoom,O.maxZoom),O.extent!==void 0&&(et.extent!==void 0?et.extent=(0,d._N)(et.extent,O.extent):et.extent=O.extent),et.zIndex===void 0&&(et.zIndex=b)}return m}getSourceState(){return"ready"}}const f=z},60764:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>E,l:()=>a});var U=r(58620),L=r(6837),Y=r(75332),X=r(83984),I=r(91765),C=r(90588),v=r(70915),W=r(9438);class d extends U.A{constructor(u){const z=Object.assign({},u);delete z.source,super(z),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,u.render&&(this.render=u.render),u.map&&this.setMap(u.map),this.addChangeListener(Y.A.SOURCE,this.handleSourcePropertyChange_);const f=u.source?u.source:null;this.setSource(f)}getLayersArray(u){return u=u||[],u.push(this),u}getLayerStatesArray(u){return u=u||[],u.push(this.getLayerState()),u}getSource(){return this.get(Y.A.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const u=this.getSource();return u?u.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&((0,W.JH)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const u=this.getSource();u&&(this.sourceChangeKey_=(0,W.KT)(u,L.A.CHANGE,this.handleSourceChange_,this),u.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(u){return this.renderer_?this.renderer_.getFeatures(u):Promise.resolve([])}getData(u){return!this.renderer_||!this.rendered?null:this.renderer_.getData(u)}isVisible(u){let z;const f=this.getMapInternal();!u&&f&&(u=f.getView()),u instanceof I.Ay?z={viewState:u.getState(),extent:u.calculateExtent()}:z=u,!z.layerStatesArray&&f&&(z.layerStatesArray=f.getLayerGroup().getLayerStatesArray());let A;z.layerStatesArray?A=z.layerStatesArray.find(m=>m.layer===this):A=this.getLayerState();const M=this.getExtent();return a(A,z.viewState)&&(!M||(0,v.HY)(M,z.extent))}getAttributions(u){if(!this.isVisible(u))return[];let z;const f=this.getSource();if(f&&(z=f.getAttributions()),!z)return[];const A=u instanceof I.Ay?u.getViewStateAndExtent():u;let M=z(A);return Array.isArray(M)||(M=[M]),M}render(u,z){const f=this.getRenderer();return f.prepareFrame(u)?(this.rendered=!0,f.renderFrame(u,z)):null}unrender(){this.rendered=!1}setMapInternal(u){u||this.unrender(),this.set(Y.A.MAP,u)}getMapInternal(){return this.get(Y.A.MAP)}setMap(u){this.mapPrecomposeKey_&&((0,W.JH)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),u||this.changed(),this.mapRenderKey_&&((0,W.JH)(this.mapRenderKey_),this.mapRenderKey_=null),u&&(this.mapPrecomposeKey_=(0,W.KT)(u,X.A.PRECOMPOSE,function(z){const A=z.frameState.layerStatesArray,M=this.getLayerState(!1);(0,C.v)(!A.some(function(m){return m.layer===M.layer}),67),A.push(M)},this),this.mapRenderKey_=(0,W.KT)(this,L.A.CHANGE,u.render,u),this.changed())}setSource(u){this.set(Y.A.SOURCE,u)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function a(p,u){if(!p.visible)return!1;const z=u.resolution;if(z<p.minResolution||z>=p.maxResolution)return!1;const f=u.zoom;return f>p.minZoom&&f<=p.maxZoom}const E=d},75332:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"}},13504:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>g});var U=r(60764);const L={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class Y extends U.A{constructor(b){b=b||{};const q=Object.assign({},b);delete q.preload,delete q.useInterimTilesOnError,super(q),this.on,this.once,this.un,this.setPreload(b.preload!==void 0?b.preload:0),this.setUseInterimTilesOnError(b.useInterimTilesOnError!==void 0?b.useInterimTilesOnError:!0)}getPreload(){return this.get(L.PRELOAD)}setPreload(b){this.set(L.PRELOAD,b)}getUseInterimTilesOnError(){return this.get(L.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(b){this.set(L.USE_INTERIM_TILES_ON_ERROR,b)}getData(b){return super.getData(b)}}const X=Y;var I=r(96769),C=r(40190),v=r(97404),W=r(91110),d=r(11078),a=r(9703),E=r(66514),p=r(70915),u=r(22796),z=r(4087),f=r(6782);class A extends I.A{constructor(b){super(b),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,p.S5)(),this.tmpTileRange_=new W.A(0,0,0,0)}isDrawableTile(b){const q=this.getLayer(),ht=b.getState(),et=q.getUseInterimTilesOnError();return ht==d.A.LOADED||ht==d.A.EMPTY||ht==d.A.ERROR&&!et}getTile(b,q,ht,et){const J=et.pixelRatio,R=et.viewState.projection,T=this.getLayer();let Q=T.getSource().getTile(b,q,ht,J,R);return Q.getState()==d.A.ERROR&&T.getUseInterimTilesOnError()&&T.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(Q)||(Q=Q.getInterimTile()),Q}getData(b){const q=this.frameState;if(!q)return null;const ht=this.getLayer(),et=(0,a.Bb)(q.pixelToCoordinateTransform,b.slice()),J=ht.getExtent();if(J&&!(0,p.Ym)(J,et))return null;const R=q.pixelRatio,T=q.viewState.projection,K=q.viewState,Q=ht.getRenderSource(),st=Q.getTileGridForProjection(K.projection),l=Q.getTilePixelRatio(q.pixelRatio);for(let s=st.getZForResolution(K.resolution);s>=st.getMinZoom();--s){const n=st.getTileCoordForCoordAndZ(et,s),o=Q.getTile(s,n[1],n[2],R,T);if(!(o instanceof C.A||o instanceof v.A)||o instanceof v.A&&o.getState()===d.A.EMPTY)return null;if(o.getState()!==d.A.LOADED)continue;const _=st.getOrigin(s),D=(0,f.xq)(st.getTileSize(s)),N=st.getResolution(s),V=Math.floor(l*((et[0]-_[0])/N-n[1]*D[0])),H=Math.floor(l*((_[1]-et[1])/N-n[2]*D[1])),rt=Math.round(l*Q.getGutterForProjection(K.projection));return this.getImageData(o.getImage(),V+rt,H+rt)}return null}loadedTileCallback(b,q,ht){return this.isDrawableTile(ht)?super.loadedTileCallback(b,q,ht):!1}prepareFrame(b){return!!this.getLayer().getSource()}renderFrame(b,q){const ht=b.layerStatesArray[b.layerIndex],et=b.viewState,J=et.projection,R=et.resolution,T=et.center,K=et.rotation,Q=b.pixelRatio,st=this.getLayer(),l=st.getSource(),s=l.getRevision(),n=l.getTileGridForProjection(J),o=n.getZForResolution(R,l.zDirection),_=n.getResolution(o);let D=b.extent;const N=b.viewState.resolution,V=l.getTilePixelRatio(Q),H=Math.round((0,p.RG)(D)/N*Q),rt=Math.round((0,p.Oq)(D)/N*Q),it=ht.extent&&(0,u.SD)(ht.extent,J);it&&(D=(0,p._N)(D,(0,u.SD)(ht.extent,J)));const ct=_*H/2/V,gt=_*rt/2/V,yt=[T[0]-ct,T[1]-gt,T[0]+ct,T[1]+gt],pt=n.getTileRangeForExtentAndZ(D,o),Dt={};Dt[o]={};const Gt=this.createLoadedTileFinder(l,J,Dt),$t=this.tmpExtent,te=this.tmpTileRange_;this.newTiles_=!1;const Yt=K?(0,p.Yw)(et.center,N,K,b.size):void 0;for(let fe=pt.minX;fe<=pt.maxX;++fe)for(let ce=pt.minY;ce<=pt.maxY;++ce){if(K&&!n.tileCoordIntersectsViewport([o,fe,ce],Yt))continue;const Qt=this.getTile(o,fe,ce,b);if(this.isDrawableTile(Qt)){const De=(0,z.v6)(this);if(Qt.getState()==d.A.LOADED){Dt[o][Qt.tileCoord.toString()]=Qt;let Te=Qt.inTransition(De);Te&&ht.opacity!==1&&(Qt.endTransition(De),Te=!1),!this.newTiles_&&(Te||!this.renderedTiles.includes(Qt))&&(this.newTiles_=!0)}if(Qt.getAlpha(De,b.time)===1)continue}const ue=n.getTileCoordChildTileRange(Qt.tileCoord,te,$t);let Re=!1;ue&&(Re=Gt(o+1,ue)),Re||n.forEachTileCoordParentTileRange(Qt.tileCoord,Gt,te,$t)}const Zt=_/R*Q/V;(0,a.Zz)(this.pixelTransform,b.size[0]/2,b.size[1]/2,1/Q,1/Q,K,-H/2,-rt/2);const ye=(0,a.dI)(this.pixelTransform);this.useContainer(q,ye,this.getBackground(b));const Ht=this.context,ie=Ht.canvas;(0,a.T9)(this.inversePixelTransform,this.pixelTransform),(0,a.Zz)(this.tempTransform,H/2,rt/2,Zt,Zt,0,-H/2,-rt/2),ie.width!=H||ie.height!=rt?(ie.width=H,ie.height=rt):this.containerReused||Ht.clearRect(0,0,H,rt),it&&this.clipUnrotated(Ht,b,it),l.getInterpolate()||(Ht.imageSmoothingEnabled=!1),this.preRender(Ht,b),this.renderedTiles.length=0;let ee=Object.keys(Dt).map(Number);ee.sort(E.V_);let se,Jt,qt;ht.opacity===1&&(!this.containerReused||l.getOpaque(b.viewState.projection))?ee=ee.reverse():(se=[],Jt=[]);for(let fe=ee.length-1;fe>=0;--fe){const ce=ee[fe],Qt=l.getTilePixelSize(ce,Q,J),Re=n.getResolution(ce)/_,De=Qt[0]*Re*Zt,Te=Qt[1]*Re*Zt,Ae=n.getTileCoordForCoordAndZ((0,p.Py)(yt),ce),vt=n.getTileCoordExtent(Ae),Oe=(0,a.Bb)(this.tempTransform,[V*(vt[0]-yt[0])/_,V*(yt[3]-vt[3])/_]),kt=V*l.getGutterForProjection(J),ae=Dt[ce];for(const Ve in ae){const _e=ae[Ve],Ne=_e.tileCoord,Ee=Ae[1]-Ne[1],Ze=Math.round(Oe[0]-(Ee-1)*De),Ge=Ae[2]-Ne[2],He=Math.round(Oe[1]-(Ge-1)*Te),Bt=Math.round(Oe[0]-Ee*De),xe=Math.round(Oe[1]-Ge*Te),re=Ze-Bt,Me=He-xe,ve=o===ce,oe=ve&&_e.getAlpha((0,z.v6)(this),b.time)!==1;let pe=!1;if(!oe)if(se){qt=[Bt,xe,Bt+re,xe,Bt+re,xe+Me,Bt,xe+Me];for(let Ce=0,Pt=se.length;Ce<Pt;++Ce)if(o!==ce&&ce<Jt[Ce]){const t=se[Ce];(0,p.HY)([Bt,xe,Bt+re,xe+Me],[t[0],t[3],t[4],t[7]])&&(pe||(Ht.save(),pe=!0),Ht.beginPath(),Ht.moveTo(qt[0],qt[1]),Ht.lineTo(qt[2],qt[3]),Ht.lineTo(qt[4],qt[5]),Ht.lineTo(qt[6],qt[7]),Ht.moveTo(t[6],t[7]),Ht.lineTo(t[4],t[5]),Ht.lineTo(t[2],t[3]),Ht.lineTo(t[0],t[1]),Ht.clip())}se.push(qt),Jt.push(ce)}else Ht.clearRect(Bt,xe,re,Me);this.drawTileImage(_e,b,Bt,xe,re,Me,kt,ve),se&&!oe?(pe&&Ht.restore(),this.renderedTiles.unshift(_e)):this.renderedTiles.push(_e),this.updateUsedTiles(b.usedTiles,l,_e)}}return this.renderedRevision=s,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!(0,p.aI)(this.renderedExtent_,yt),this.renderedExtent_=yt,this.renderedPixelRatio=Q,this.renderedProjection=J,this.manageTilePyramid(b,l,n,Q,J,D,o,st.getPreload()),this.scheduleExpireCache(b,l),this.postRender(Ht,b),ht.extent&&Ht.restore(),Ht.imageSmoothingEnabled=!0,ye!==ie.style.transform&&(ie.style.transform=ye),this.container}drawTileImage(b,q,ht,et,J,R,T,K){const Q=this.getTileImage(b);if(!Q)return;const st=(0,z.v6)(this),l=q.layerStatesArray[q.layerIndex],s=l.opacity*(K?b.getAlpha(st,q.time):1),n=s!==this.context.globalAlpha;n&&(this.context.save(),this.context.globalAlpha=s),this.context.drawImage(Q,T,T,Q.width-2*T,Q.height-2*T,ht,et,J,R),n&&this.context.restore(),s!==l.opacity?q.animate=!0:K&&b.endTransition(st)}getImage(){const b=this.context;return b?b.canvas:null}getTileImage(b){return b.getImage()}scheduleExpireCache(b,q){if(q.canExpireCache()){const ht=function(et,J,R){const T=(0,z.v6)(et);T in R.usedTiles&&et.expireCache(R.viewState.projection,R.usedTiles[T])}.bind(null,q);b.postRenderFunctions.push(ht)}}updateUsedTiles(b,q,ht){const et=(0,z.v6)(q);et in b||(b[et]={}),b[et][ht.getKey()]=!0}manageTilePyramid(b,q,ht,et,J,R,T,K,Q){const st=(0,z.v6)(q);st in b.wantedTiles||(b.wantedTiles[st]={});const l=b.wantedTiles[st],s=b.tileQueue,n=ht.getMinZoom(),o=b.viewState.rotation,_=o?(0,p.Yw)(b.viewState.center,b.viewState.resolution,o,b.size):void 0;let D=0,N,V,H,rt,it,ct;for(ct=n;ct<=T;++ct)for(V=ht.getTileRangeForExtentAndZ(R,ct,V),H=ht.getResolution(ct),rt=V.minX;rt<=V.maxX;++rt)for(it=V.minY;it<=V.maxY;++it)o&&!ht.tileCoordIntersectsViewport([ct,rt,it],_)||(T-ct<=K?(++D,N=q.getTile(ct,rt,it,et,J),N.getState()==d.A.IDLE&&(l[N.getKey()]=!0,s.isKeyQueued(N.getKey())||s.enqueue([N,st,ht.getTileCoordCenter(N.tileCoord),H])),Q!==void 0&&Q(N)):q.useTile(ct,rt,it,J));q.updateCacheSize(D,J)}}const M=A;class m extends X{constructor(b){super(b)}createRenderer(){return new M(this)}}const g=m},82986:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>X});var U=r(26469),L=r(65896);class Y extends U.A{constructor(C){super(C)}createRenderer(){return new L.A(this)}}const X=Y},46568:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>A});var U=r(26469),L=r(69796),Y=r(65896),X=r(6837),I=r(80611),C=r(6141);class v extends I.A{constructor(m,g,O,b,q){const ht=q!==void 0?C.A.IDLE:C.A.LOADED;super(m,g,O,ht),this.loader_=q!==void 0?q:null,this.canvas_=b,this.error_=null}getError(){return this.error_}handleLoad_(m){m?(this.error_=m,this.state=C.A.ERROR):this.state=C.A.LOADED,this.changed()}load(){this.state==C.A.IDLE&&(this.state=C.A.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}const W=v;var d=r(35341),a=r(62703),E=r(9703),p=r(70915);class u extends L.A{constructor(m){super(m),this.vectorRenderer_=new Y.A(m),this.layerImageRatio_=m.getImageRatio(),this.coordinateToVectorPixelTransform_=(0,E.vt)(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(m){if(!this.vectorRenderer_)return Promise.resolve([]);const g=(0,E.Bb)(this.coordinateToVectorPixelTransform_,(0,E.Bb)(this.renderedPixelToCoordinateTransform_,m.slice()));return this.vectorRenderer_.getFeatures(g)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(m){const g=m.pixelRatio,O=m.viewState,b=O.resolution,q=m.viewHints,ht=this.vectorRenderer_;let et=m.extent;this.layerImageRatio_!==1&&(et=et.slice(0),(0,p.Af)(et,this.layerImageRatio_));const J=(0,p.RG)(et)/b,R=(0,p.Oq)(et)/b;if(!q[a.A.ANIMATING]&&!q[a.A.INTERACTING]&&!(0,p.Im)(et)){ht.useContainer(null,null);const T=ht.context,K=m.layerStatesArray[m.layerIndex];T.globalAlpha=K.opacity;const Q=Object.assign({},K,{opacity:1}),st=Object.assign({},m,{declutterTree:new d(9),extent:et,size:[J,R],viewState:Object.assign({},m.viewState,{rotation:0}),layerStatesArray:[Q],layerIndex:0});let l=!0;const s=new W(et,b,g,T.canvas,function(n){ht.prepareFrame(st)&&ht.replayGroupChanged&&(ht.clipping=!1,ht.renderFrame(st,null)&&(ht.renderDeclutter(st),l=!1),n())});s.addEventListener(X.A.CHANGE,()=>{if(s.getState()!==C.A.LOADED)return;this.image_=l?null:s;const n=s.getResolution(),o=s.getPixelRatio(),_=n*g/o;this.renderedResolution=_,this.coordinateToVectorPixelTransform_=(0,E.Zz)(this.coordinateToVectorPixelTransform_,J/2,R/2,1/_,-1/_,0,-O.center[0],-O.center[1])}),s.load()}return this.image_&&(this.renderedPixelToCoordinateTransform_=m.pixelToCoordinateTransform.slice()),!!this.image_}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(m,g,O,b,q){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(m,g,O,b,q):super.forEachFeatureAtCoordinate(m,g,O,b,q)}}const z=u;class f extends U.A{constructor(m){m=m||{};const g=Object.assign({},m);delete g.imageRatio,super(g),this.imageRatio_=m.imageRatio!==void 0?m.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new z(this)}}const A=f},15816:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>jt});var U=r(60764),L=r(89990);const Y=`uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform vec4 u_renderExtent;`;class X{constructor(){this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.symbolSizeExpression_="vec2(1.0)",this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_="vec4(1.0)",this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.strokeWidthExpression_="1.0",this.strokeColorExpression_="vec4(1.0)",this.fillColorExpression_="vec4(1.0)",this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e){return this.uniforms_.push(e),this}addAttribute(e){return this.attributes_.push(e),this}addVarying(e,F,G){return this.varyings_.push({name:e,type:F,expression:G}),this}setSymbolSizeExpression(e){return this.symbolSizeExpression_=e,this}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}setSymbolColorExpression(e){return this.symbolColorExpression_=e,this}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.strokeColorExpression_=e,this}setFillColorExpression(e){return this.fillColorExpression_=e,this}addVertexShaderFunction(e){this.vertexShaderFunctions_.includes(e)||this.vertexShaderFunctions_.push(e)}addFragmentShaderFunction(e){this.fragmentShaderFunctions_.includes(e)||this.fragmentShaderFunctions_.push(e)}getSymbolVertexShader(e){const F=this.symbolRotateWithView_?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix";let G=this.attributes_,$=this.varyings_;return e&&(G=G.concat("vec4 a_hitColor"),$=$.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform mat4 u_projectionMatrix;
uniform mat4 u_offsetScaleMatrix;
uniform mat4 u_offsetRotateMatrix;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
${this.uniforms_.map(function(ot){return"uniform "+ot+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
${G.map(function(ot){return"attribute "+ot+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
${$.map(function(ot){return"varying "+ot.type+" "+ot.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  mat4 offsetMatrix = ${F};
  vec2 halfSize = ${this.symbolSizeExpression_} * 0.5;
  vec2 offset = ${this.symbolOffsetExpression_};
  float angle = ${this.symbolRotationExpression_};
  float offsetX;
  float offsetY;
  if (a_index == 0.0) {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  } else if (a_index == 1.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else if (a_index == 2.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  }
  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;
  v_quadCoord = vec2(u, v);
${$.map(function(ot){return"  "+ot.name+" = "+ot.expression+";"}).join(`
`)}
}`}getSymbolFragmentShader(e){const F=e?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"";let G=this.varyings_;return e&&(G=G.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
${this.uniforms_.map(function($){return"uniform "+$+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
${G.map(function($){return"varying "+$.type+" "+$.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
void main(void) {
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
${F}
}`}getStrokeVertexShader(e){let F=this.attributes_,G=this.varyings_;return e&&(F=F.concat("vec4 a_hitColor"),G=G.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
${Y}
${this.uniforms_.map(function($){return"uniform "+$+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_parameters;
${F.map(function($){return"attribute "+$+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
${G.map(function($){return"varying "+$.type+" "+$.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = pxPos * 4.0 / u_viewportSizePx;
  return vec4(screenPos.xy, 0.0, 0.0);
}

vec2 getOffsetDirection(vec2 normalPx, vec2 tangentPx, float joinAngle) {
  if (cos(joinAngle) > 0.93) return normalPx - tangentPx;
  float halfAngle = joinAngle / 2.0;
  vec2 angleBisectorNormal = vec2(
    sin(halfAngle) * normalPx.x + cos(halfAngle) * normalPx.y,
    -cos(halfAngle) * normalPx.x + sin(halfAngle) * normalPx.y
  );
  float length = 1.0 / sin(halfAngle);
  return angleBisectorNormal * length;
}

void main(void) {
  float lineWidth = ${this.strokeWidthExpression_};
  float anglePrecision = 1500.0;
  float paramShift = 10000.0;
  v_angleStart = fract(a_parameters / paramShift) * paramShift / anglePrecision;
  v_angleEnd = fract(floor(a_parameters / paramShift + 0.5) / paramShift) * paramShift / anglePrecision;
  float vertexNumber = floor(a_parameters / paramShift / paramShift + 0.0001);
  vec2 tangentPx = worldToPx(a_segmentEnd) - worldToPx(a_segmentStart);
  tangentPx = normalize(tangentPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 offsetPx = getOffsetDirection(normalPx * normalDir, tangentDir * tangentPx, angle) * lineWidth * 0.5;
  vec2 position =  vertexNumber < 1.5 ? a_segmentStart : a_segmentEnd;
  gl_Position = u_projectionMatrix * vec4(position, 0.0, 1.0) + pxToScreen(offsetPx);
  v_segmentStart = worldToPx(a_segmentStart);
  v_segmentEnd = worldToPx(a_segmentEnd);
  v_width = lineWidth;
${G.map(function($){return"  "+$.name+" = "+$.expression+";"}).join(`
`)}
}`}getStrokeFragmentShader(e){const F=e?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"";let G=this.varyings_;return e&&(G=G.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
${Y}
${this.uniforms_.map(function($){return"uniform "+$+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
${G.map(function($){return"varying "+$.type+" "+$.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float radius) {
  vec2 startToPoint = point - start;
  vec2 startToEnd = end - start;
  float ratio = clamp(dot(startToPoint, startToEnd) / dot(startToEnd, startToEnd), 0.0, 1.0);
  float dist = length(startToPoint - ratio * startToEnd);
  return 1.0 - smoothstep(radius - 1.0, radius, dist);
}

void main(void) {
  vec2 v_currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 v_worldPos = pxToWorld(v_currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      v_worldPos[0] < u_renderExtent[0] ||
      v_worldPos[1] < u_renderExtent[1] ||
      v_worldPos[0] > u_renderExtent[2] ||
      v_worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.strokeColorExpression_} * u_globalAlpha;
  gl_FragColor *= segmentDistanceField(v_currentPoint, v_segmentStart, v_segmentEnd, v_width);
${F}
}`}getFillVertexShader(e){let F=this.attributes_,G=this.varyings_;return e&&(F=F.concat("vec4 a_hitColor"),G=G.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
${Y}
${this.uniforms_.map(function($){return"uniform "+$+";"}).join(`
`)}
attribute vec2 a_position;
${F.map(function($){return"attribute "+$+";"}).join(`
`)}
${G.map(function($){return"varying "+$.type+" "+$.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
${G.map(function($){return"  "+$.name+" = "+$.expression+";"}).join(`
`)}
}`}getFillFragmentShader(e){const F=e?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"";let G=this.varyings_;return e&&(G=G.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
${Y}
${this.uniforms_.map(function($){return"uniform "+$+";"}).join(`
`)}
${G.map(function($){return"varying "+$.type+" "+$.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

void main(void) {
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 v_worldPos = pxToWorld(gl_FragCoord.xy / u_pixelRatio);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      v_worldPos[0] < u_renderExtent[0] ||
      v_worldPos[1] < u_renderExtent[1] ||
      v_worldPos[0] > u_renderExtent[2] ||
      v_worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_} * u_globalAlpha;
${F}
}`}}class I{constructor(e,F){this.name=e,this.data=F,this.texture_=null}getTexture(e){if(!this.texture_){const F=e.createTexture();e.bindTexture(e.TEXTURE_2D,F),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=F}return this.texture_}}const C=I;var v=r(93101),W=r(8143),d=r(11078),a=r(68711);function E(x){return x instanceof Image||x instanceof HTMLCanvasElement||x instanceof HTMLVideoElement?x:null}function p(x){return x instanceof Uint8Array||x instanceof Uint8ClampedArray||x instanceof Float32Array||x instanceof DataView?x:null}let u=null;function z(x){u||(u=(0,a.Y)(x.width,x.height,void 0,{willReadFrequently:!0}));const e=u.canvas,F=x.width;e.width!==F&&(e.width=F);const G=x.height;return e.height!==G&&(e.height=G),u.clearRect(0,0,F,G),u.drawImage(x,0,0),u.getImageData(0,0,F,G).data}const f=[256,256];class A extends W.A{constructor(e){const F=d.A.IDLE;super(e.tileCoord,F,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null}getSize(){if(this.size_)return this.size_;const e=E(this.data_);return e?[e.width,e.height]:f}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==d.A.IDLE&&this.state!==d.A.ERROR)return;this.state=d.A.LOADING,this.changed();const e=this;this.loader_().then(function(F){e.data_=F,e.state=d.A.LOADED,e.changed()}).catch(function(F){e.error_=F,e.state=d.A.ERROR,e.changed()})}}const M=A;var m=r(6837),g=r(52913),O=r(33513),b=r(61597),q=r(70915),ht=r(9438);class et extends M{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8Array(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const F=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),G=this.targetTileGrid_.getExtent();let $=this.sourceTileGrid_.getExtent();const ot=G?(0,q._N)(F,G):F;if((0,q.UG)(ot)===0){this.state=d.A.EMPTY;return}const xt=e.sourceProj,Ot=xt.getExtent();Ot&&($?$=(0,q._N)($,Ot):$=Ot);const Lt=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),Tt=e.targetProj,mt=(0,O.aY)(xt,Tt,ot,Lt);if(!isFinite(mt)||mt<=0){this.state=d.A.EMPTY;return}const _t=e.errorThreshold!==void 0?e.errorThreshold:v.l;if(this.triangulation_=new g.A(xt,Tt,ot,$,mt*_t,Lt),this.triangulation_.getTriangles().length===0){this.state=d.A.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(mt);let Ft=this.triangulation_.calculateSourceExtent();if($&&(xt.canWrapX()?(Ft[1]=(0,b.qE)(Ft[1],$[1],$[3]),Ft[3]=(0,b.qE)(Ft[3],$[1],$[3])):Ft=(0,q._N)(Ft,$)),!(0,q.UG)(Ft))this.state=d.A.EMPTY;else{const It=this.sourceTileGrid_.getTileRangeForExtentAndZ(Ft,this.sourceZ_),Kt=e.getTileFunction;for(let Xt=It.minX;Xt<=It.maxX;Xt++)for(let Vt=It.minY;Vt<=It.maxY;Vt++){const St=Kt(this.sourceZ_,Xt,Vt,this.pixelRatio_);St&&this.sourceTiles_.push(St)}this.sourceTiles_.length===0&&(this.state=d.A.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];if(this.sourceTiles_.forEach(F=>{if(!F||F.getState()!==d.A.LOADED)return;const G=F.getSize(),$=this.gutter_;let ot;const xt=p(F.getData());xt?ot=xt:ot=z(E(F.getData()));const Ot=[G[0]+2*$,G[1]+2*$],Lt=ot instanceof Float32Array,Tt=Ot[0]*Ot[1],mt=Lt?Float32Array:Uint8Array,_t=new mt(ot.buffer),Ft=mt.BYTES_PER_ELEMENT,It=Ft*_t.length/Tt,Kt=_t.byteLength/Ot[1],Xt=Math.floor(Kt/Ft/Ot[0]),Vt=Tt*Xt;let St=_t;if(_t.length!==Vt){St=new mt(Vt);let tt=0,i=0;const y=Ot[0]*Xt;for(let w=0;w<Ot[1];++w){for(let k=0;k<y;++k)St[tt++]=_t[i+k];i+=Kt/Ft}}e.push({extent:this.sourceTileGrid_.getTileCoordExtent(F.tileCoord),data:new Uint8Array(St.buffer),dataType:mt,bytesPerPixel:It,pixelSize:Ot})}),this.sourceTiles_.length=0,e.length===0)this.state=d.A.ERROR;else{const F=this.wrappedTileCoord_[0],G=this.targetTileGrid_.getTileSize(F),$=typeof G=="number"?G:G[0],ot=typeof G=="number"?G:G[1],xt=this.targetTileGrid_.getResolution(F),Ot=this.sourceTileGrid_.getResolution(this.sourceZ_),Lt=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let Tt,mt;const _t=e[0].bytesPerPixel,Ft=Math.ceil(_t/3);for(let It=Ft-1;It>=0;--It){const Kt=[];for(let y=0,w=e.length;y<w;++y){const k=e[y],ut=k.data,Et=k.pixelSize,bt=Et[0],zt=Et[1],ne=(0,a.Y)(bt,zt,O.BV),de=ne.createImageData(bt,zt),le=de.data;let ge=It*3;for(let Ie=0,Ke=le.length;Ie<Ke;Ie+=4)le[Ie]=ut[ge],le[Ie+1]=ut[ge+1],le[Ie+2]=ut[ge+2],le[Ie+3]=255,ge+=_t;ne.putImageData(de,0,0),Kt.push({extent:k.extent,image:ne.canvas})}const Xt=(0,O.XX)($,ot,this.pixelRatio_,Ot,this.sourceTileGrid_.getExtent(),xt,Lt,this.triangulation_,Kt,this.gutter_,!1,!1);for(let y=0,w=Kt.length;y<w;++y){const ut=Kt[y].image.getContext("2d");(0,a.Yg)(ut),O.BV.push(ut.canvas)}const Vt=Xt.getContext("2d"),St=Vt.getImageData(0,0,Xt.width,Xt.height);(0,a.Yg)(Vt),O.BV.push(Xt),Tt||(mt=new Uint8Array(_t*St.width*St.height),Tt=new e[0].dataType(mt.buffer));const tt=St.data;let i=It*3;for(let y=0,w=tt.length;y<w;y+=4)tt[y+3]===255?(mt[i]=tt[y],mt[i+1]=tt[y+1],mt[i+2]=tt[y+2]):(mt[i]=0,mt[i+1]=0,mt[i+2]=0),i+=_t}this.reprojData_=Tt,this.reprojSize_=[Math.round($*this.pixelRatio_),Math.round(ot*this.pixelRatio_)],this.state=d.A.LOADED}this.changed()}load(){if(this.state!==d.A.IDLE&&this.state!==d.A.ERROR)return;this.state=d.A.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(F=>{const G=F.getState();if(G!==d.A.IDLE&&G!==d.A.LOADING)return;e++;const $=(0,ht.KT)(F,m.A.CHANGE,function(){const ot=F.getState();(ot==d.A.LOADED||ot==d.A.ERROR||ot==d.A.EMPTY)&&((0,ht.JH)($),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push($)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(F){F.getState()==d.A.IDLE&&F.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(ht.JH),this.sourcesListenerKeys_=null}}const J=et;var R=r(97404),T=r(79332),K=r(40190),Q=r(4087);class st extends T.A{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter_=e.gutter||0,this.helper_=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(m.A.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===d.A.LOADED,this.loaded)this.uploadTile();else{if(e instanceof K.A){const F=e.getImage();F instanceof Image&&!F.crossOrigin&&(F.crossOrigin="anonymous")}e.addEventListener(m.A.CHANGE,this.handleTileChange_)}}uploadTile(){(0,Q.b0)()}setReady(){this.ready=!0,this.dispatchEvent(m.A.CHANGE)}handleTileChange_(){this.tile.getState()===d.A.LOADED&&(this.loaded=!0,this.uploadTile())}disposeInternal(){this.tile.removeEventListener(m.A.CHANGE,this.handleTileChange_)}}const l=st;var s=r(20259),n=r(90130),o=r(6782);function _(x,e,F){const G=F?x.LINEAR:x.NEAREST;x.bindTexture(x.TEXTURE_2D,e),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,G),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,G)}function D(x,e,F,G){_(x,e,G),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,F)}function N(x,e,F,G,$,ot){const xt=x.getGL();let Ot,Lt;F instanceof Float32Array?(Ot=xt.FLOAT,x.getExtension("OES_texture_float"),Lt=x.getExtension("OES_texture_float_linear")!==null):(Ot=xt.UNSIGNED_BYTE,Lt=!0),_(xt,e,ot&&Lt);const Tt=F.byteLength/G[1];let mt=1;Tt%8===0?mt=8:Tt%4===0?mt=4:Tt%2===0&&(mt=2);let _t;switch($){case 1:{_t=xt.LUMINANCE;break}case 2:{_t=xt.LUMINANCE_ALPHA;break}case 3:{_t=xt.RGB;break}case 4:{_t=xt.RGBA;break}default:throw new Error(`Unsupported number of bands: ${$}`)}const Ft=xt.getParameter(xt.UNPACK_ALIGNMENT);xt.pixelStorei(xt.UNPACK_ALIGNMENT,mt),xt.texImage2D(xt.TEXTURE_2D,0,_t,G[0],G[1],0,_t,Ot,F),xt.pixelStorei(xt.UNPACK_ALIGNMENT,Ft)}let V=null;function H(){V=(0,a.Y)(1,1,void 0,{willReadFrequently:!0})}class rt extends l{constructor(e){super(e),this.textures=[],this.renderSize_=(0,o.xq)(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const F=new s.Ay(n.H7,n.Ek);F.fromArray([0,1,1,1,1,0,0,0]),this.helper_.flushBufferData(F),this.coords=F,this.setTile(e.tile)}uploadTile(){const e=this.helper_,F=e.getGL(),G=this.tile;this.textures.length=0;let $;G instanceof K.A||G instanceof R.A?$=G.getImage():$=G.getData();const ot=E($);if(ot){const tt=F.createTexture();this.textures.push(tt),this.bandCount=4,D(F,tt,ot,G.interpolate),this.setReady();return}$=p($);const xt=G.getSize(),Ot=[xt[0]+2*this.gutter_,xt[1]+2*this.gutter_],Lt=$ instanceof Float32Array,Tt=Ot[0]*Ot[1],mt=Lt?Float32Array:Uint8Array,_t=mt.BYTES_PER_ELEMENT,Ft=$.byteLength/Ot[1];this.bandCount=Math.floor(Ft/_t/Ot[0]);const It=Math.ceil(this.bandCount/4);if(It===1){const tt=F.createTexture();this.textures.push(tt),N(e,tt,$,Ot,this.bandCount,G.interpolate),this.setReady();return}const Kt=new Array(It);for(let tt=0;tt<It;++tt){const i=F.createTexture();this.textures.push(i);const y=tt<It-1?4:(this.bandCount-1)%4+1;Kt[tt]=new mt(Tt*y)}let Xt=0,Vt=0;const St=Ot[0]*this.bandCount;for(let tt=0;tt<Ot[1];++tt){for(let i=0;i<St;++i){const y=$[Vt+i],w=Math.floor(Xt/this.bandCount),k=i%this.bandCount,ut=Math.floor(k/4),Et=Kt[ut],bt=Et.length/Tt,zt=k%4;Et[w*bt+zt]=y,++Xt}Vt+=Ft/_t}for(let tt=0;tt<It;++tt){const i=this.textures[tt],y=Kt[tt],w=y.length/Tt;N(e,i,y,Ot,w,G.interpolate)}this.setReady()}disposeInternal(){const e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(let F=0;F<this.textures.length;++F)e.deleteTexture(this.textures[F]);this.tile.removeEventListener(m.A.CHANGE,this.handleTileChange_)}getImagePixelData_(e,F,G){const $=this.gutter_,ot=this.renderSize_[0],xt=this.renderSize_[1];V||H(),V.clearRect(0,0,1,1);const Ot=e.width,Lt=e.height,Tt=Ot-2*$,mt=Lt-2*$,_t=$+Math.floor(Tt*(F/ot)),Ft=$+Math.floor(mt*(G/xt));let It;try{V.drawImage(e,_t,Ft,1,1,0,0,1,1),It=V.getImageData(0,0,1,1).data}catch{return V=null,null}return It}getArrayPixelData_(e,F,G,$){const ot=this.gutter_,xt=this.renderSize_[0],Ot=this.renderSize_[1],Lt=F[0],Tt=F[1],mt=Lt+2*ot,_t=Tt+2*ot,Ft=ot+Math.floor(Lt*(G/xt)),It=ot+Math.floor(Tt*($/Ot));if(e instanceof DataView){const Xt=e.byteLength/(mt*_t),Vt=Xt*(It*mt+Ft),St=e.buffer.slice(Vt,Vt+Xt);return new DataView(St)}const Kt=this.bandCount*(It*mt+Ft);return e.slice(Kt,Kt+this.bandCount)}getPixelData(e,F){if(!this.loaded)return null;if(this.tile instanceof M){const G=this.tile.getData(),$=p(G);if($){const ot=this.tile.getSize();return this.getArrayPixelData_($,ot,e,F)}return this.getImagePixelData_(E(G),e,F)}return this.getImagePixelData_(this.tile.getImage(),e,F)}}const it=rt;var ct=r(14969),gt=r(91110),yt=r(38111),pt=r(66514),Dt=r(83954),Gt=r(40186),$t=r(9703),te=r(22796);const Yt={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"},Zt={};function ye(x){return 2*(1-1/(x+1))-1}function Ht(){return{tileIds:new Set,representationsByZ:{}}}function ie(x,e){return x.tileIds.has((0,Q.v6)(e))}function ee(x,e,F){const G=x.representationsByZ;F in G||(G[F]=new Set),G[F].add(e),x.tileIds.add((0,Q.v6)(e.tile))}function se(x,e){const F=x.layerStatesArray[x.layerIndex];F.extent&&(e=(0,q._N)(e,(0,te.SD)(F.extent,x.viewState.projection)));const G=F.layer.getRenderSource();if(!G.getWrapX()){const $=G.getTileGridForProjection(x.viewState.projection).getExtent();$&&(e=(0,q._N)(e,$))}return e}function Jt(x,e){return`${x.getKey()},${(0,Gt.i7)(e)}`}class qt extends yt.A{constructor(e,F){super(e,{uniforms:F.uniforms,postProcesses:F.postProcesses}),this.renderComplete=!1,this.tileTransform_=(0,$t.vt)(),this.tempMat4=(0,Dt.v)(),this.tempTileRange_=new gt.A(0,0,0,0),this.tempTileCoord_=(0,Gt.N)(0,0,0),this.tempSize_=[0,0];const G=F.cacheSize!==void 0?F.cacheSize:512;this.tileRepresentationCache=new ct.A(G),this.frameState=null,this.projection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}isDrawableTile_(e){const F=this.getLayer(),G=e.getState(),$=F.getUseInterimTilesOnError();return G==d.A.LOADED||G==d.A.EMPTY||G==d.A.ERROR&&!$}prepareFrameInternal(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;const G=this.getLayer().getRenderSource();return!G||(0,q.Im)(se(e,e.extent))?!1:G.getState()==="ready"}createTileRepresentation(e){return(0,Q.b0)()}enqueueTiles(e,F,G,$,ot){const xt=e.viewState,Ot=this.getLayer(),Lt=Ot.getRenderSource(),Tt=Lt.getTileGridForProjection(xt.projection),mt=Lt.getGutterForProjection(xt.projection),_t=(0,Q.v6)(Lt);_t in e.wantedTiles||(e.wantedTiles[_t]={});const Ft=e.wantedTiles[_t],It=this.tileRepresentationCache,Kt=Ot.getMapInternal(),Xt=Math.max(G-ot,Tt.getMinZoom(),Tt.getZForResolution(Math.min(Ot.getMaxResolution(),Kt?Kt.getView().getResolutionForZoom(Math.max(Ot.getMinZoom(),0)):Tt.getResolution(0)),Lt.zDirection));for(let Vt=G;Vt>=Xt;--Vt){const St=Tt.getTileRangeForExtentAndZ(F,Vt,this.tempTileRange_),tt=Tt.getResolution(Vt);for(let i=St.minX;i<=St.maxX;++i)for(let y=St.minY;y<=St.maxY;++y){const w=(0,Gt.N)(Vt,i,y,this.tempTileCoord_),k=Jt(Lt,w);let ut,Et;if(It.containsKey(k)&&(ut=It.get(k),Et=ut.tile),(!ut||ut.tile.key!==Lt.getKey())&&(Et=Lt.getTile(Vt,i,y,e.pixelRatio,xt.projection)),ie($,Et))continue;if(!ut)ut=this.createTileRepresentation({tile:Et,grid:Tt,helper:this.helper,gutter:mt}),It.set(k,ut);else if(this.isDrawableTile_(Et))ut.setTile(Et);else{const zt=Et.getInterimTile();ut.setTile(zt)}ee($,ut,Vt);const bt=Et.getKey();Ft[bt]=!0,Et.getState()===d.A.IDLE&&(e.tileQueue.isKeyQueued(bt)||e.tileQueue.enqueue([Et,_t,Tt.getTileCoordCenter(w),tt]))}}}beforeTilesRender(e,F){this.helper.prepareDraw(this.frameState,!F)}renderTile(e,F,G,$,ot,xt,Ot,Lt,Tt,mt,_t){}renderFrame(e){this.frameState=e,this.renderComplete=!0;const F=this.helper.getGL();this.preRender(F,e);const G=e.viewState,$=this.getLayer(),ot=$.getRenderSource(),xt=ot.getTileGridForProjection(G.projection),Ot=ot.getGutterForProjection(G.projection),Lt=se(e,e.extent),Tt=xt.getZForResolution(G.resolution,ot.zDirection),mt=Ht(),_t=$.getPreload();if(e.nextExtent){const w=xt.getZForResolution(G.nextResolution,ot.zDirection),k=se(e,e.nextExtent);this.enqueueTiles(e,k,w,mt,_t)}this.enqueueTiles(e,Lt,Tt,mt,0),_t>0&&setTimeout(()=>{this.enqueueTiles(e,Lt,Tt-1,mt,_t-1)},0);const Ft={},It=(0,Q.v6)(this),Kt=e.time;let Xt=!1;for(const w of mt.representationsByZ[Tt]){const k=w.tile;if((k instanceof R.A||k instanceof J)&&k.getState()===d.A.EMPTY)continue;const ut=k.tileCoord;if(w.loaded){const zt=k.getAlpha(It,Kt);if(zt===1){k.endTransition(It);continue}Xt=!0;const ne=(0,Gt.i7)(ut);Ft[ne]=zt}if(this.renderComplete=!1,this.findAltTiles_(xt,ut,Tt+1,mt))continue;const bt=xt.getMinZoom();for(let zt=Tt-1;zt>=bt&&!this.findAltTiles_(xt,ut,zt,mt);--zt);}this.beforeTilesRender(e,Xt);const Vt=mt.representationsByZ,St=Object.keys(Vt).map(Number).sort(pt.V_);for(let w=0,k=St.length;w<k;++w){const ut=St[w];for(const Et of Vt[ut]){if(!Et.loaded)continue;const zt=Et.tile.tileCoord,ne=(0,Gt.i7)(zt),de=ne in Ft?Ft[ne]:1;de<1&&(e.animate=!0);const le=xt.getResolution(ut),ge=(0,o.xq)(xt.getTileSize(ut),this.tempSize_),Ie=xt.getOrigin(ut),Ke=xt.getTileCoordExtent(zt),Je=ye(ut),ze=e.viewState,we=ze.center[0],$e=ze.center[1],Ue=ge[0]+2*Ot,he=ge[1]+2*Ot,me=Ue/he,We=(we-Ie[0])/(ge[0]*le),be=(Ie[1]-$e)/(ge[1]*le),je=ze.resolution/le,ke=zt[1],Qe=zt[2];(0,$t.cL)(this.tileTransform_),(0,$t.hs)(this.tileTransform_,2/(e.size[0]*je/Ue),-2/(e.size[1]*je/Ue)),(0,$t.e$)(this.tileTransform_,ze.rotation),(0,$t.hs)(this.tileTransform_,1,1/me),(0,$t.Tl)(this.tileTransform_,(ge[0]*(ke-We)-Ot)/Ue,(ge[1]*(Qe-be)-Ot)/he),this.renderTile(Et,this.tileTransform_,e,Lt,le,ge,Ie,Ke,Je,Ot,de)}}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const tt=this.helper.getCanvas(),i=this.tileRepresentationCache;for(;i.canExpireCache();)i.pop().dispose();const y=function(w,k){ot.updateCacheSize(.1,k.viewState.projection),ot.expireCache(k.viewState.projection,Zt)};return e.postRenderFunctions.push(y),this.postRender(F,e),tt}findAltTiles_(e,F,G,$){const ot=e.getTileRangeForTileCoordAndZ(F,G,this.tempTileRange_);if(!ot)return!1;let xt=!0;const Ot=this.tileRepresentationCache,Lt=this.getLayer().getRenderSource();for(let Tt=ot.minX;Tt<=ot.maxX;++Tt)for(let mt=ot.minY;mt<=ot.maxY;++mt){const _t=Jt(Lt,[G,Tt,mt]);let Ft=!1;if(Ot.containsKey(_t)){const It=Ot.get(_t);It.loaded&&!ie($,It.tile)&&(ee($,It,G),Ft=!0)}Ft||(xt=!1)}return xt}clearCache(){const e=this.tileRepresentationCache;e.forEach(F=>F.dispose()),e.clear()}removeHelper(){this.helper&&this.clearCache(),super.removeHelper()}disposeInternal(){super.disposeInternal(),delete this.frameState}}const fe=qt;var ce=r(9777);const Qt={...Yt,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},Re=[{name:{TEXTURE_COORD:"a_textureCoord"}.TEXTURE_COORD,size:2,type:ce.jQ.FLOAT}];class De extends fe{constructor(e,F){super(e,F),this.program_,this.vertexShader_=F.vertexShader,this.fragmentShader_=F.fragmentShader,this.indices_=new s.Ay(n.IP,n.Ek),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=F.paletteTextures||[]}reset(e){super.reset(e),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}createTileRepresentation(e){return new it(e)}beforeTilesRender(e,F){super.beforeTilesRender(e,F),this.helper.useProgram(this.program_,e)}renderTile(e,F,G,$,ot,xt,Ot,Lt,Tt,mt,_t){const Ft=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(Re);let It=0;for(;It<e.textures.length;){const k=`${Qt.TILE_TEXTURE_ARRAY}[${It}]`;this.helper.bindTexture(e.textures[It],It,k),++It}for(let k=0;k<this.paletteTextures_.length;++k){const ut=this.paletteTextures_[k],Et=ut.getTexture(Ft);this.helper.bindTexture(Et,It,ut.name),++It}const Kt=G.viewState,Xt=xt[0]+2*mt,Vt=xt[1]+2*mt,tt=e.tile.tileCoord,i=tt[1],y=tt[2];this.helper.setUniformMatrixValue(Qt.TILE_TRANSFORM,(0,Dt.Z)(this.tempMat4,F)),this.helper.setUniformFloatValue(Qt.TRANSITION_ALPHA,_t),this.helper.setUniformFloatValue(Qt.DEPTH,Tt);let w=$;mt>0&&(w=Lt,(0,q._N)(w,$,w)),this.helper.setUniformFloatVec4(Qt.RENDER_EXTENT,w),this.helper.setUniformFloatValue(Qt.RESOLUTION,Kt.resolution),this.helper.setUniformFloatValue(Qt.ZOOM,Kt.zoom),this.helper.setUniformFloatValue(Qt.TEXTURE_PIXEL_WIDTH,Xt),this.helper.setUniformFloatValue(Qt.TEXTURE_PIXEL_HEIGHT,Vt),this.helper.setUniformFloatValue(Qt.TEXTURE_RESOLUTION,ot),this.helper.setUniformFloatValue(Qt.TEXTURE_ORIGIN_X,Ot[0]+i*xt[0]*ot-mt*ot),this.helper.setUniformFloatValue(Qt.TEXTURE_ORIGIN_Y,Ot[1]-y*xt[1]*ot+mt*ot),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const G=this.frameState;if(!G)return null;const $=this.getLayer(),ot=(0,$t.Bb)(G.pixelToCoordinateTransform,e.slice()),xt=G.viewState,Ot=$.getExtent();if(Ot&&!(0,q.Ym)((0,te.SD)(Ot,xt.projection),ot))return null;const Lt=$.getSources((0,q.Tr)([ot]),xt.resolution);let Tt,mt,_t;for(Tt=Lt.length-1;Tt>=0;--Tt)if(mt=Lt[Tt],mt.getState()==="ready"){if(_t=mt.getTileGridForProjection(xt.projection),mt.getWrapX())break;const It=_t.getExtent();if(!It||(0,q.Ym)(It,ot))break}if(Tt<0)return null;const Ft=this.tileRepresentationCache;for(let It=_t.getZForResolution(xt.resolution);It>=_t.getMinZoom();--It){const Kt=_t.getTileCoordForCoordAndZ(ot,It),Xt=Jt(mt,Kt);if(!Ft.containsKey(Xt))continue;const Vt=Ft.get(Xt),St=Vt.tile;if((St instanceof R.A||St instanceof J)&&St.getState()===d.A.EMPTY)return null;if(!Vt.loaded)continue;const tt=_t.getOrigin(It),i=(0,o.xq)(_t.getTileSize(It)),y=_t.getResolution(It),w=(ot[0]-tt[0])/y-Kt[1]*i[0],k=(tt[1]-ot[1])/y-Kt[2]*i[1];return Vt.getPixelData(w,k)}return null}disposeInternal(){const e=this.helper;e&&(e.getGL().deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)),super.disposeInternal(),delete this.indices_}}const Te=null;var Ae=r(89352);const vt={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0};function Oe(x){switch(x){case"string":return vt.STRING;case"color":return vt.COLOR;case"number":return vt.NUMBER;case"boolean":return vt.BOOLEAN;case"number[]":return vt.NUMBER_ARRAY;default:throw new Error(`Unrecognized type hint: ${x}`)}}const kt={};function ae(x){if(typeof x=="number")return vt.NUMBER;if(typeof x=="boolean")return vt.BOOLEAN;if(typeof x=="string")return(0,Ae.$C)(x)?vt.COLOR|vt.STRING:vt.STRING;if(!Array.isArray(x))throw new Error(`Unhandled value type: ${JSON.stringify(x)}`);const e=x;if(e.every(function($){return typeof $=="number"}))return e.length===3||e.length===4?vt.COLOR|vt.NUMBER_ARRAY:vt.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error(`Expected an expression operator but received: ${JSON.stringify(e)}`);const G=kt[e[0]];if(G===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return G.getReturnType(e.slice(1))}function Ve(x){return Math.log2(x)%1===0}function _e(x){const e=[];return(x&vt.NUMBER)>0&&e.push("number"),(x&vt.COLOR)>0&&e.push("color"),(x&vt.BOOLEAN)>0&&e.push("boolean"),(x&vt.NUMBER_ARRAY)>0&&e.push("number[]"),(x&vt.STRING)>0&&e.push("string"),e.length>0?e.join(", "):"(no type)"}function Ne(x){const e=x.toString();return e.includes(".")?e:e+".0"}function Ee(x){if(x.length<2||x.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${x.length}(${x.map(Ne).join(", ")})`}function Ze(x){const e=(0,Ae._j)(x),F=e.length>3?e[3]:1;return Ee([e[0]/255*F,e[1]/255*F,e[2]/255*F,F])}function Ge(x,e){return x.stringLiteralsMap[e]===void 0&&(x.stringLiteralsMap[e]=Object.keys(x.stringLiteralsMap).length),x.stringLiteralsMap[e]}function He(x,e){return Ne(Ge(x,e))}function Bt(x,e,F){const G=F!==void 0?F:vt.NUMBER;if(Array.isArray(e)&&typeof e[0]=="string"){const ot=kt[e[0]];if(ot===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return ot.toGlsl(x,e.slice(1),G)}const $=ae(e)&G;if(c(e,$,""),($&vt.NUMBER)>0)return Ne(e);if(($&vt.BOOLEAN)>0)return e.toString();if(($&vt.STRING)>0)return He(x,e.toString());if(($&vt.COLOR)>0)return Ze(e);if(($&vt.NUMBER_ARRAY)>0)return Ee(e);throw new Error(`Unexpected expression ${e} (expected type ${_e(G)})`)}function xe(x){if((ae(x)&vt.NUMBER)===0)throw new Error(`A numeric value was expected, got ${JSON.stringify(x)} instead`)}function re(x){for(let e=0;e<x.length;e++)xe(x[e])}function Me(x){if((ae(x)&vt.STRING)===0)throw new Error(`A string value was expected, got ${JSON.stringify(x)} instead`)}function ve(x){if((ae(x)&vt.BOOLEAN)===0)throw new Error(`A boolean value was expected, got ${JSON.stringify(x)} instead`)}function oe(x,e){if(x.length!==e)throw new Error(`Exactly ${e} arguments were expected, got ${x.length} instead`)}function pe(x,e){if(x.length<e)throw new Error(`At least ${e} arguments were expected, got ${x.length} instead`)}function Ce(x,e){if(x.length>e)throw new Error(`At most ${e} arguments were expected, got ${x.length} instead`)}function Pt(x){if(x.length%2!==0)throw new Error(`An even amount of arguments was expected, got ${JSON.stringify(x)} instead`)}function t(x){if(x.length%2===0)throw new Error(`An odd amount of arguments was expected, got ${JSON.stringify(x)} instead`)}function c(x,e,F){if(e===vt.NONE)throw new Error(`No matching type was found for the following expression ${F}: ${JSON.stringify(x)}`)}function h(x,e,F){if(c(x,e,F),!Ve(e))throw new Error(`Expected to have a unique type for the following expression ${F}: ${JSON.stringify(x)}
Got the following types instead: ${_e(e)}`)}function S(x,e,F,G){if((e&F)===vt.NONE)throw new Error(`Expected the ${G} type of the following expression: ${JSON.stringify(x)} to be of the following types: ${_e(F)}
Got these types instead: ${_e(e)}`)}kt.get={getReturnType:function(x){if(x.length===2){const e=x[1];return Oe(e)}return vt.ANY},toGlsl:function(x,e,F){pe(e,1),Ce(e,2),Me(e[0]);const G=F&kt.get.getReturnType(e);h(["get",...e],G,"");const $=e[0].toString(),ot=x.attributes.find(Ot=>Ot.name===$);if(!ot)x.attributes.push({name:$,type:G});else if(G!==ot.type)throw new Error(`The following attribute was used in different places with incompatible types: ${$}
Types were: ${_e(ot.type)} and ${_e(G)}`);return(x.inFragmentShader?"v_":"a_")+$}};function P(x){return"u_var_"+x}kt.var={getReturnType:function(){return vt.ANY},toGlsl:function(x,e,F){oe(e,1),Me(e[0]);const G=e[0].toString();if(!x.style.variables||x.style.variables[G]===void 0)throw new Error(`The following variable is missing from the style: ${G}`);const $=x.style.variables[G],ot=F&ae($);h(["var",...e],ot,"");const xt=x.variables.find(Ot=>Ot.name===G);if(!xt)x.variables.push({name:G,type:ot});else if(ot!==xt.type)throw new Error(`The following variable was used in different places with incompatible types: ${G}
Types were: ${_e(xt.type)} and ${_e(ot)}`);return P(G)}};const B="u_paletteTextures";kt.palette={getReturnType:function(){return vt.COLOR},toGlsl:function(x,e){oe(e,2),xe(e[0]);const F=Bt(x,e[0]),G=e[1];if(!Array.isArray(G))throw new Error("The second argument of palette must be an array");const $=G.length,ot=new Uint8Array($*4);for(let Lt=0;Lt<$;Lt++){const Tt=G[Lt];let mt;if(typeof Tt=="string")mt=(0,Ae.sH)(Tt);else{if(!Array.isArray(Tt))throw new Error("The second argument of palette must be an array of strings or colors");const Ft=Tt.length;if(Ft===4)mt=Tt;else{if(Ft!==3)throw new Error(`Expected palette color to have 3 or 4 values, got ${Ft}`);mt=[Tt[0],Tt[1],Tt[2],1]}}const _t=Lt*4;ot[_t]=mt[0],ot[_t+1]=mt[1],ot[_t+2]=mt[2],ot[_t+3]=mt[3]*255}x.paletteTextures||(x.paletteTextures=[]);const xt=`${B}[${x.paletteTextures.length}]`,Ot=new C(xt,ot);return x.paletteTextures.push(Ot),`texture2D(${xt}, vec2((${F} + 0.5) / ${$}.0, 0.5))`}};const j="getBandValue";kt.band={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){pe(e,1),Ce(e,3);const F=e[0];if(!(j in x.functions)){let xt="";const Ot=x.bandCount||1;for(let Lt=0;Lt<Ot;Lt++){const Tt=Math.floor(Lt/4);let mt=Lt%4;Lt===Ot-1&&mt===1&&(mt=3);const _t=`${Qt.TILE_TEXTURE_ARRAY}[${Tt}]`;xt+=`
          if (band == ${Lt+1}.0) {
            return texture2D(${_t}, v_textureCoord + vec2(dx, dy))[${mt}];
          }
        `}x.functions[j]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / ${Qt.TEXTURE_PIXEL_WIDTH};
          float dy = yOffset / ${Qt.TEXTURE_PIXEL_HEIGHT};
          ${xt}
        }
      `}const G=Bt(x,F),$=Bt(x,e[1]||0),ot=Bt(x,e[2]||0);return`${j}(${G}, ${$}, ${ot})`}},kt.time={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,0),"u_time"}},kt.zoom={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,0),"u_zoom"}},kt.resolution={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,0),"u_resolution"}},kt["*"]={getReturnType:function(x){let e=vt.NUMBER|vt.COLOR;for(let F=0;F<x.length;F++)e=e&ae(x[F]);return e},toGlsl:function(x,e,F){pe(e,2);let G=F;for(let $=0;$<e.length;$++)G=G&ae(e[$]);return S(e,G,vt.NUMBER|vt.COLOR,"output"),`(${e.map($=>Bt(x,$,G)).join(" * ")})`}},kt["/"]={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} / ${Bt(x,e[1])})`}},kt["+"]={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return pe(e,2),re(e),`(${e.map(F=>Bt(x,F)).join(" + ")})`}},kt["-"]={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} - ${Bt(x,e[1])})`}},kt.clamp={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){oe(e,3),re(e);const F=Bt(x,e[1]),G=Bt(x,e[2]);return`clamp(${Bt(x,e[0])}, ${F}, ${G})`}},kt["%"]={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,2),re(e),`mod(${Bt(x,e[0])}, ${Bt(x,e[1])})`}},kt["^"]={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,2),re(e),`pow(${Bt(x,e[0])}, ${Bt(x,e[1])})`}},kt.abs={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`abs(${Bt(x,e[0])})`}},kt.floor={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`floor(${Bt(x,e[0])})`}},kt.round={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`floor(${Bt(x,e[0])} + 0.5)`}},kt.ceil={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`ceil(${Bt(x,e[0])})`}},kt.sin={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`sin(${Bt(x,e[0])})`}},kt.cos={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return oe(e,1),re(e),`cos(${Bt(x,e[0])})`}},kt.atan={getReturnType:function(){return vt.NUMBER},toGlsl:function(x,e){return pe(e,1),Ce(e,2),re(e),e.length===2?`atan(${Bt(x,e[0])}, ${Bt(x,e[1])})`:`atan(${Bt(x,e[0])})`}},kt[">"]={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} > ${Bt(x,e[1])})`}},kt[">="]={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} >= ${Bt(x,e[1])})`}},kt["<"]={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} < ${Bt(x,e[1])})`}},kt["<="]={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){return oe(e,2),re(e),`(${Bt(x,e[0])} <= ${Bt(x,e[1])})`}};function Z(x){return{getReturnType:function(){return vt.BOOLEAN},toGlsl:function(e,F){oe(F,2);let G=vt.ANY;for(let $=0;$<F.length;$++)G&=ae(F[$]);if(G===vt.NONE)throw new Error(`All arguments should be of compatible type, got ${JSON.stringify(F)} instead`);return G&=~vt.COLOR,`(${Bt(e,F[0],G)} ${x} ${Bt(e,F[1],G)})`}}}kt["=="]=Z("=="),kt["!="]=Z("!="),kt["!"]={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){return oe(e,1),ve(e[0]),`(!${Bt(x,e[0],vt.BOOLEAN)})`}};function nt(x){return{getReturnType:function(){return vt.BOOLEAN},toGlsl:function(e,F){pe(F,2);for(let $=0;$<F.length;$++)ve(F[$]);let G=F.map($=>Bt(e,$,vt.BOOLEAN)).join(` ${x} `);return G=`(${G})`,G}}}kt.all=nt("&&"),kt.any=nt("||"),kt.between={getReturnType:function(){return vt.BOOLEAN},toGlsl:function(x,e){oe(e,3),re(e);const F=Bt(x,e[1]),G=Bt(x,e[2]),$=Bt(x,e[0]);return`(${$} >= ${F} && ${$} <= ${G})`}},kt.array={getReturnType:function(){return vt.NUMBER_ARRAY},toGlsl:function(x,e){pe(e,2),Ce(e,4),re(e);const F=e.map(function(G){return Bt(x,G)});return`vec${e.length}(${F.join(", ")})`}},kt.color={getReturnType:function(){return vt.COLOR},toGlsl:function(x,e){pe(e,3),Ce(e,4),re(e);const F=e.slice(0,3).map($=>`${Bt(x,$)} / 255.0`);return e.length===3?`vec4(${F.join(", ")}, 1.0)`:`(${Bt(x,e[3])} * vec4(${F.join(", ")}, 1.0))`}},kt.interpolate={getReturnType:function(x){let e=vt.COLOR|vt.NUMBER;for(let F=3;F<x.length;F+=2)e=e&ae(x[F]);return e},toGlsl:function(x,e,F){Pt(e),pe(e,6);const G=e[0];let $;switch(G[0]){case"linear":$=1;break;case"exponential":$=G[1];break;default:$=null}if(!$)throw new Error(`Invalid interpolation type for "interpolate" operator, received: ${JSON.stringify(G)}`);const ot=vt.NUMBER,xt=kt.interpolate.getReturnType(e)&F;h(["interpolate",...e],xt,"output");const Ot=Bt(x,e[1],ot),Lt=Ne($);let Tt="";for(let mt=2;mt<e.length-2;mt+=2){const _t=Bt(x,e[mt],ot),Ft=Tt||Bt(x,e[mt+1],xt),It=Bt(x,e[mt+2],ot),Kt=Bt(x,e[mt+3],xt);Tt=`mix(${Ft}, ${Kt}, pow(clamp((${Ot} - ${_t}) / (${It} - ${_t}), 0.0, 1.0), ${Lt}))`}return Tt}},kt.match={getReturnType:function(x){let e=vt.ANY;for(let F=2;F<x.length;F+=2)e=e&ae(x[F]);return e=e&ae(x[x.length-1]),e},toGlsl:function(x,e,F){Pt(e),pe(e,4);let G=ae(e[0]);for(let Lt=1;Lt<e.length-1;Lt+=2)G=G&ae(e[Lt]);S(["match",...e],G,vt.STRING|vt.NUMBER|vt.BOOLEAN,"input"),G=(vt.STRING|vt.NUMBER|vt.BOOLEAN)&G;const $=kt.match.getReturnType(e)&F;h(["match",...e],$,"output");const ot=Bt(x,e[0],G),xt=Bt(x,e[e.length-1],$);let Ot=null;for(let Lt=e.length-3;Lt>=1;Lt-=2){const Tt=Bt(x,e[Lt],G),mt=Bt(x,e[Lt+1],$);Ot=`(${ot} == ${Tt} ? ${mt} : ${Ot||xt})`}return Ot}},kt.case={getReturnType:function(x){let e=vt.ANY;for(let F=1;F<x.length;F+=2)e=e&ae(x[F]);return e=e&ae(x[x.length-1]),e},toGlsl:function(x,e,F){t(e),pe(e,3);const G=kt.case.getReturnType(e)&F;h(["case",...e],G,"output");for(let xt=0;xt<e.length-1;xt+=2)ve(e[xt]);const $=Bt(x,e[e.length-1],G);let ot=null;for(let xt=e.length-3;xt>=0;xt-=2){const Ot=Bt(x,e[xt],vt.BOOLEAN),Lt=Bt(x,e[xt+1],G);ot=`(${Ot} ? ${Lt} : ${ot||$})`}return ot}};function lt(x,e){switch(x){case"square":case"image":return"1.0";case"circle":return`(1.0-smoothstep(1.-4./${e},1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))`;case"triangle":const F="(v_quadCoord*2.-1.)",G=`(atan(${F}.x,${F}.y))`;return`(1.0-smoothstep(.5-3./${e},.5,cos(floor(.5+${G}/2.094395102)*2.094395102-${G})*length(${F})))`;default:throw new Error(`Unexpected symbol type: ${x}`)}}function dt(x){const e=(0,Ae._j)(x),F=e[0]*256,G=e[1],$=e[2]*256,ot=Math.round(e[3]*255);return[F+G,$+ot]}const ft=`vec4 unpackColor(vec2 packedColor) {
  return fract(packedColor[1] / 256.0) * vec4(
    fract(floor(packedColor[0] / 256.0) / 256.0),
    fract(packedColor[0] / 256.0),
    fract(floor(packedColor[1] / 256.0) / 256.0),
    1.0
  );
}`;function Rt(x){return x===vt.COLOR?2:x===vt.NUMBER_ARRAY?4:1}function At(x){const e=Rt(x);return e>1?`vec${e}`:"float"}function Mt(x,e,F,G,$){if(!("symbol"in x))return!1;const ot=x.symbol,xt=ot.size!==void 0?ot.size:1,Ot=ot.color||"white",Lt=ot.textureCoord||[0,0,1,1],Tt=ot.offset||[0,0],mt=ot.opacity!==void 0?ot.opacity:1,_t=ot.rotation!==void 0?ot.rotation:0,Ft=Bt(G,xt,vt.NUMBER_ARRAY|vt.NUMBER),It=Bt(G,Tt,vt.NUMBER_ARRAY),Kt=Bt(G,Lt,vt.NUMBER_ARRAY),Xt=Bt(G,_t,vt.NUMBER),Vt=Bt($,Ot,vt.COLOR),St=Bt($,mt,vt.NUMBER),tt=`vec2(${Bt($,xt,vt.NUMBER_ARRAY|vt.NUMBER)}).x`,i=lt(ot.symbolType,tt),y=`vec4(${Vt}.rgb, ${Vt}.a * ${St} * ${i})`;if(e.setSymbolSizeExpression(`vec2(${Ft})`).setSymbolRotationExpression(Xt).setSymbolOffsetExpression(It).setTextureCoordinateExpression(Kt).setSymbolRotateWithView(!!ot.rotateWithView).setSymbolColorExpression(y),ot.symbolType==="image"&&ot.src){const w=new Image;w.crossOrigin=ot.crossOrigin===void 0?"anonymous":ot.crossOrigin,w.src=ot.src,e.addUniform("sampler2D u_texture").setSymbolColorExpression(`${y} * texture2D(u_texture, v_texCoord)`),F.u_texture=w}return!0}function Ct(x,e,F,G,$){if(!("stroke-color"in x)&&!("stroke-width"in x))return!1;const ot=x["stroke-color"]||"white",xt=x["stroke-width"]||1,Ot=Bt($,ot,vt.COLOR),Lt=Bt(G,xt,vt.NUMBER);return e.setStrokeColorExpression(Ot).setStrokeWidthExpression(Lt),!0}function wt(x,e,F,G,$){if(!("fill-color"in x))return!1;const ot=x["fill-color"]||"rgba(255, 255, 255, 0.3)",xt=Bt($,ot,vt.COLOR);return e.setFillColorExpression(xt),!0}function Wt(x){const e={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{},functions:{},style:x},F={inFragmentShader:!0,variables:e.variables,attributes:[],stringLiteralsMap:e.stringLiteralsMap,functions:{},style:x},G=new X,$={},ot=Mt(x,G,$,e,F),xt=Ct(x,G,$,e,F),Ot=wt(x,G,$,e,F);if(x.filter){const Tt=Bt(F,x.filter,vt.BOOLEAN);G.setFragmentDiscardExpression(`!${Tt}`)}F.variables.forEach(function(Tt){const mt=P(Tt.name);G.addUniform(`${At(Tt.type)} ${mt}`);let _t;Tt.type===vt.STRING?_t=()=>Ge(e,x.variables[Tt.name]):Tt.type===vt.COLOR?_t=()=>dt([...(0,Ae._j)(x.variables[Tt.name]||"#eee")]):Tt.type===vt.BOOLEAN?_t=()=>x.variables[Tt.name]?1:0:_t=()=>x.variables[Tt.name],$[mt]=_t}),F.attributes.forEach(function(Tt){e.attributes.find(Ft=>Ft.name===Tt.name)||e.attributes.push(Tt);let mt=At(Tt.type),_t=`a_${Tt.name}`;Tt.type===vt.COLOR&&(mt="vec4",_t=`unpackColor(${_t})`,G.addVertexShaderFunction(ft)),G.addVarying(`v_${Tt.name}`,mt,_t)}),e.attributes.forEach(function(Tt){G.addAttribute(`${At(Tt.type)} a_${Tt.name}`)});const Lt=e.attributes.map(function(Tt){let mt;return Tt.type===vt.STRING?mt=_t=>Ge(e,_t.get(Tt.name)):Tt.type===vt.COLOR?mt=_t=>dt([...(0,Ae._j)(_t.get(Tt.name)||"#eee")]):Tt.type===vt.BOOLEAN?mt=_t=>_t.get(Tt.name)?1:0:mt=_t=>_t.get(Tt.name),{name:Tt.name,size:Rt(Tt.type),callback:mt}});return{builder:G,hasSymbol:ot,hasStroke:xt,hasFill:Ot,attributes:Lt.reduce((Tt,mt)=>({...Tt,[mt.name]:{callback:mt.callback,size:mt.size}}),{}),uniforms:$}}class Ut extends U.A{constructor(e){const F=Object.assign({},e);super(F),this.parseResult_=Wt(e.style),this.styleVariables_=e.style.variables||{},this.hitDetectionDisabled_=!!e.disableHitDetection}createRenderer(){const e=Object.keys(this.parseResult_.attributes).map(F=>({name:F,...this.parseResult_.attributes[F]}));return new L.A(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitVertexShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.hitDetectionDisabled_&&this.parseResult_.builder.getSymbolFragmentShader(!0),uniforms:this.parseResult_.uniforms,attributes:e})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}const jt=Ut},9960:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y});var U=r(1685);class L extends U.Ay{constructor(I,C,v,W){super(I),this.inversePixelTransform=C,this.frameState=v,this.context=W}}const Y=L},83984:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}},38774:(Nt,at,r)=>{"use strict";r.d(at,{Jw:()=>Q,M8:()=>f,MY:()=>z,NT:()=>u,Oq:()=>d,TA:()=>R,Tq:()=>A,ZV:()=>C,_K:()=>E,_m:()=>W,aq:()=>M,eL:()=>p,fZ:()=>q,jT:()=>T,qY:()=>v,vk:()=>a,yY:()=>m});var U=r(34120),L=r(7771),Y=r(43530),X=r(68711),I=r(25176);const C="10px sans-serif",v="#000",W="round",d=[],a=0,E="round",p=10,u="#000",z="center",f="middle",A=[0,0,0,0],M=1,m=new U.A;let g=null,O;const b={},q=function(){const s="32px ",n=["monospace","serif"],o=n.length,_="wmytzilWMYTZIL@#/&?$%10\uF013";let D,N;function V(rt,it,ct){let gt=!0;for(let yt=0;yt<o;++yt){const pt=n[yt];if(N=J(rt+" "+it+" "+s+pt,_),ct!=pt){const Dt=J(rt+" "+it+" "+s+ct+","+pt,_);gt=gt&&Dt!=N}}return!!gt}function H(){let rt=!0;const it=m.getKeys();for(let ct=0,gt=it.length;ct<gt;++ct){const yt=it[ct];m.get(yt)<100&&(V.apply(this,yt.split(`
`))?((0,Y.I)(b),g=null,O=void 0,m.set(yt,100)):(m.set(yt,m.get(yt)+1,!0),rt=!1))}rt&&(clearInterval(D),D=void 0)}return function(rt){const it=(0,I.K5)(rt);if(!it)return;const ct=it.families;for(let gt=0,yt=ct.length;gt<yt;++gt){const pt=ct[gt],Dt=it.style+`
`+it.weight+`
`+pt;m.get(Dt)===void 0&&(m.set(Dt,100,!0),V(it.style,it.weight,pt)||(m.set(Dt,0,!0),D===void 0&&(D=setInterval(H,32))))}}}(),ht=function(){let l;return function(s){let n=b[s];if(n==null){if(L.Wl){const o=(0,I.K5)(s),_=et(s,"\u017Dg");n=(isNaN(Number(o.lineHeight))?1.2:Number(o.lineHeight))*(_.actualBoundingBoxAscent+_.actualBoundingBoxDescent)}else l||(l=document.createElement("div"),l.innerHTML="M",l.style.minHeight="0",l.style.maxHeight="none",l.style.height="auto",l.style.padding="0",l.style.border="none",l.style.position="absolute",l.style.display="block",l.style.left="-99999px"),l.style.font=s,document.body.appendChild(l),n=l.offsetHeight,document.body.removeChild(l);b[s]=n}return n}}();function et(l,s){return g||(g=(0,X.Y)(1,1)),l!=O&&(g.font=l,O=g.font),g.measureText(s)}function J(l,s){return et(l,s).width}function R(l,s,n){if(s in n)return n[s];const o=s.split(`
`).reduce((_,D)=>Math.max(_,J(l,D)),0);return n[s]=o,o}function T(l,s){const n=[],o=[],_=[];let D=0,N=0,V=0,H=0;for(let rt=0,it=s.length;rt<=it;rt+=2){const ct=s[rt];if(ct===`
`||rt===it){D=Math.max(D,N),_.push(N),N=0,V+=H;continue}const gt=s[rt+1]||l.font,yt=J(gt,ct);n.push(yt),N+=yt;const pt=ht(gt);o.push(pt),H=Math.max(H,pt)}return{width:D,height:V,widths:n,heights:o,lineWidths:_}}function K(l,s,n,o){s!==0&&(l.translate(n,o),l.rotate(s),l.translate(-n,-o))}function Q(l,s,n,o,_,D,N,V,H,rt,it){l.save(),n!==1&&(l.globalAlpha*=n),s&&l.setTransform.apply(l,s),o.contextInstructions?(l.translate(H,rt),l.scale(it[0],it[1]),st(o,l)):it[0]<0||it[1]<0?(l.translate(H,rt),l.scale(it[0],it[1]),l.drawImage(o,_,D,N,V,0,0,N,V)):l.drawImage(o,_,D,N,V,H,rt,N*it[0],V*it[1]),l.restore()}function st(l,s){const n=l.contextInstructions;for(let o=0,_=n.length;o<_;o+=2)Array.isArray(n[o+1])?s[n[o]].apply(s,n[o+1]):s[n[o]]=n[o+1]}},5986:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>C});var U=r(6837),L=r(6141),Y=r(11854),X=r(4087);class I extends Y.A{constructor(W){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=W,this.declutterExecutorGroup=null}getFeatures(W){return(0,X.b0)()}getData(W){return null}prepareFrame(W){return(0,X.b0)()}renderFrame(W,d){return(0,X.b0)()}loadedTileCallback(W,d,a){W[d]||(W[d]={}),W[d][a.tileCoord.toString()]=a}createLoadedTileFinder(W,d,a){return(E,p)=>{const u=this.loadedTileCallback.bind(this,a,E);return W.forEachLoadedTile(d,E,p,u)}}forEachFeatureAtCoordinate(W,d,a,E,p){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(W){W.target.getState()===L.A.LOADED&&this.renderIfReadyAndVisible()}loadImage(W){let d=W.getState();return d!=L.A.LOADED&&d!=L.A.ERROR&&W.addEventListener(U.A.CHANGE,this.boundHandleImageChange_),d==L.A.IDLE&&(W.load(),d=W.getState()),d==L.A.LOADED}renderIfReadyAndVisible(){const W=this.getLayer();W&&W.getVisible()&&W.getSourceState()==="ready"&&W.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const C=I},69796:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>W});var U=r(96769),L=r(6141),Y=r(62703),X=r(9703),I=r(70915),C=r(22796);class v extends U.A{constructor(a){super(a),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(a){const E=a.layerStatesArray[a.layerIndex],p=a.pixelRatio,u=a.viewState,z=u.resolution,f=this.getLayer().getSource(),A=a.viewHints;let M=a.extent;if(E.extent!==void 0&&(M=(0,I._N)(M,(0,C.SD)(E.extent,u.projection))),!A[Y.A.ANIMATING]&&!A[Y.A.INTERACTING]&&!(0,I.Im)(M))if(f){const m=u.projection,g=f.getImage(M,z,p,m);g&&(this.loadImage(g)?this.image_=g:g.getState()===L.A.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(a){const E=this.frameState;if(!E)return null;const p=this.getLayer(),u=(0,X.Bb)(E.pixelToCoordinateTransform,a.slice()),z=p.getExtent();if(z&&!(0,I.Ym)(z,u))return null;const f=this.image_.getExtent(),A=this.getImage(),M=(0,I.RG)(f),m=Math.floor(A.width*((u[0]-f[0])/M));if(m<0||m>=A.width)return null;const g=(0,I.Oq)(f),O=Math.floor(A.height*((f[3]-u[1])/g));return O<0||O>=A.height?null:this.getImageData(A,m,O)}renderFrame(a,E){const p=this.image_,u=p.getExtent(),z=p.getResolution(),f=p.getPixelRatio(),A=a.layerStatesArray[a.layerIndex],M=a.pixelRatio,m=a.viewState,g=m.center,O=m.resolution,b=M*z/(O*f),q=a.extent,ht=m.resolution,et=m.rotation,J=Math.round((0,I.RG)(q)/ht*M),R=Math.round((0,I.Oq)(q)/ht*M);(0,X.Zz)(this.pixelTransform,a.size[0]/2,a.size[1]/2,1/M,1/M,et,-J/2,-R/2),(0,X.T9)(this.inversePixelTransform,this.pixelTransform);const T=(0,X.dI)(this.pixelTransform);this.useContainer(E,T,this.getBackground(a));const K=this.context,Q=K.canvas;Q.width!=J||Q.height!=R?(Q.width=J,Q.height=R):this.containerReused||K.clearRect(0,0,J,R);let st=!1,l=!0;if(A.extent){const D=(0,C.SD)(A.extent,m.projection);l=(0,I.HY)(D,a.extent),st=l&&!(0,I.ms)(D,a.extent),st&&this.clipUnrotated(K,a,D)}const s=this.getImage(),n=(0,X.Zz)(this.tempTransform,J/2,R/2,b,b,0,f*(u[0]-g[0])/z,f*(g[1]-u[3])/z);this.renderedResolution=z*M/f;const o=s.width*n[0],_=s.height*n[3];if(this.getLayer().getSource().getInterpolate()||(K.imageSmoothingEnabled=!1),this.preRender(K,a),l&&o>=.5&&_>=.5){const D=n[4],N=n[5],V=A.opacity;let H;V!==1&&(H=K.globalAlpha,K.globalAlpha=V),K.drawImage(s,0,0,+s.width,+s.height,D,N,o,_),V!==1&&(K.globalAlpha=H)}return this.postRender(K,a),st&&K.restore(),K.imageSmoothingEnabled=!0,T!==Q.style.transform&&(Q.style.transform=T),this.container}}const W=v},96769:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>u,B:()=>d});var U=r(5986),L=r(9960),Y=r(83984),X=r(9703),I=r(89352),C=r(68711),v=r(66514),W=r(70915);const d=[];let a=null;function E(){a=(0,C.Y)(1,1,void 0,{willReadFrequently:!0})}class p extends U.A{constructor(f){super(f),this.container=null,this.renderedResolution,this.tempTransform=(0,X.vt)(),this.pixelTransform=(0,X.vt)(),this.inversePixelTransform=(0,X.vt)(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(f,A,M){a||E(),a.clearRect(0,0,1,1);let m;try{a.drawImage(f,A,M,1,1,0,0,1,1),m=a.getImageData(0,0,1,1).data}catch{return a=null,null}return m}getBackground(f){let M=this.getLayer().getBackground();return typeof M=="function"&&(M=M(f.viewState.resolution)),M||void 0}useContainer(f,A,M){const m=this.getLayer().getClassName();let g,O;if(f&&f.className===m&&(!M||f&&f.style.backgroundColor&&(0,v.aI)((0,I._j)(f.style.backgroundColor),(0,I._j)(M)))){const b=f.firstElementChild;b instanceof HTMLCanvasElement&&(O=b.getContext("2d"))}if(O&&O.canvas.style.transform===A?(this.container=f,this.context=O,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){g=document.createElement("div"),g.className=m;let b=g.style;b.position="absolute",b.width="100%",b.height="100%",O=(0,C.Y)();const q=O.canvas;g.appendChild(q),b=q.style,b.position="absolute",b.left="0",b.transformOrigin="top left",this.container=g,this.context=O}!this.containerReused&&M&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=M)}clipUnrotated(f,A,M){const m=(0,W.Py)(M),g=(0,W.WU)(M),O=(0,W.k_)(M),b=(0,W.R)(M);(0,X.Bb)(A.coordinateToPixelTransform,m),(0,X.Bb)(A.coordinateToPixelTransform,g),(0,X.Bb)(A.coordinateToPixelTransform,O),(0,X.Bb)(A.coordinateToPixelTransform,b);const q=this.inversePixelTransform;(0,X.Bb)(q,m),(0,X.Bb)(q,g),(0,X.Bb)(q,O),(0,X.Bb)(q,b),f.save(),f.beginPath(),f.moveTo(Math.round(m[0]),Math.round(m[1])),f.lineTo(Math.round(g[0]),Math.round(g[1])),f.lineTo(Math.round(O[0]),Math.round(O[1])),f.lineTo(Math.round(b[0]),Math.round(b[1])),f.clip()}dispatchRenderEvent_(f,A,M){const m=this.getLayer();if(m.hasListener(f)){const g=new L.A(f,this.inversePixelTransform,M,A);m.dispatchEvent(g)}}preRender(f,A){this.frameState=A,this.dispatchRenderEvent_(Y.A.PRERENDER,f,A)}postRender(f,A){this.dispatchRenderEvent_(Y.A.POSTRENDER,f,A)}getRenderTransform(f,A,M,m,g,O,b){const q=g/2,ht=O/2,et=m/A,J=-et,R=-f[0]+b,T=-f[1];return(0,X.Zz)(this.tempTransform,q,ht,et,J,-M,R,T)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const u=p},65896:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Ce});const U={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},L=[U.FILL],Y=[U.STROKE],X=[U.BEGIN_PATH],I=[U.CLOSE_PATH],C=U;var v=r(11580);class W{drawCustom(t,c,h,S){}drawGeometry(t){}setStyle(t){}drawCircle(t,c){}drawFeature(t,c){}drawGeometryCollection(t,c){}drawLineString(t,c){}drawMultiLineString(t,c){}drawMultiPoint(t,c){}drawMultiPolygon(t,c){}drawPoint(t,c){}drawPolygon(t,c){}drawText(t,c){}setFillStrokeStyle(t,c){}setImageStyle(t,c){}setTextStyle(t,c){}}const d=W;var a=r(99676),E=r(70915),p=r(38774),u=r(66514),z=r(56361);class f extends d{constructor(t,c,h,S){super(),this.tolerance=t,this.maxExtent=c,this.pixelRatio=S,this.maxLineWidth=0,this.resolution=h,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const c=this.pixelRatio;return c==1?t:t.map(function(h){return h*c})}appendFlatPointCoordinates(t,c){const h=this.getBufferedMaxExtent(),S=this.tmpCoordinate_,P=this.coordinates;let B=P.length;for(let j=0,Z=t.length;j<Z;j+=c)S[0]=t[j],S[1]=t[j+1],(0,E.Ym)(h,S)&&(P[B++]=S[0],P[B++]=S[1]);return B}appendFlatLineCoordinates(t,c,h,S,P,B){const j=this.coordinates;let Z=j.length;const nt=this.getBufferedMaxExtent();B&&(c+=S);let lt=t[c],dt=t[c+1];const ft=this.tmpCoordinate_;let Rt=!0,At,Mt,Ct;for(At=c+S;At<h;At+=S)ft[0]=t[At],ft[1]=t[At+1],Ct=(0,E.vz)(nt,ft),Ct!==Mt?(Rt&&(j[Z++]=lt,j[Z++]=dt,Rt=!1),j[Z++]=ft[0],j[Z++]=ft[1]):Ct===v.A.INTERSECTING?(j[Z++]=ft[0],j[Z++]=ft[1],Rt=!1):Rt=!0,lt=ft[0],dt=ft[1],Mt=Ct;return(P&&Rt||At===c+S)&&(j[Z++]=lt,j[Z++]=dt),Z}drawCustomCoordinates_(t,c,h,S,P){for(let B=0,j=h.length;B<j;++B){const Z=h[B],nt=this.appendFlatLineCoordinates(t,c,Z,S,!1,!1);P.push(nt),c=Z}return c}drawCustom(t,c,h,S){this.beginGeometry(t,c);const P=t.getType(),B=t.getStride(),j=this.coordinates.length;let Z,nt,lt,dt,ft;switch(P){case"MultiPolygon":Z=t.getOrientedFlatCoordinates(),dt=[];const Rt=t.getEndss();ft=0;for(let At=0,Mt=Rt.length;At<Mt;++At){const Ct=[];ft=this.drawCustomCoordinates_(Z,ft,Rt[At],B,Ct),dt.push(Ct)}this.instructions.push([C.CUSTOM,j,dt,t,h,z.Dz]),this.hitDetectionInstructions.push([C.CUSTOM,j,dt,t,S||h,z.Dz]);break;case"Polygon":case"MultiLineString":lt=[],Z=P=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),ft=this.drawCustomCoordinates_(Z,0,t.getEnds(),B,lt),this.instructions.push([C.CUSTOM,j,lt,t,h,z.cD]),this.hitDetectionInstructions.push([C.CUSTOM,j,lt,t,S||h,z.cD]);break;case"LineString":case"Circle":Z=t.getFlatCoordinates(),nt=this.appendFlatLineCoordinates(Z,0,Z.length,B,!1,!1),this.instructions.push([C.CUSTOM,j,nt,t,h,z.n2]),this.hitDetectionInstructions.push([C.CUSTOM,j,nt,t,S||h,z.n2]);break;case"MultiPoint":Z=t.getFlatCoordinates(),nt=this.appendFlatPointCoordinates(Z,B),nt>j&&(this.instructions.push([C.CUSTOM,j,nt,t,h,z.n2]),this.hitDetectionInstructions.push([C.CUSTOM,j,nt,t,S||h,z.n2]));break;case"Point":Z=t.getFlatCoordinates(),this.coordinates.push(Z[0],Z[1]),nt=this.coordinates.length,this.instructions.push([C.CUSTOM,j,nt,t,h]),this.hitDetectionInstructions.push([C.CUSTOM,j,nt,t,S||h]);break;default:}this.endGeometry(c)}beginGeometry(t,c){this.beginGeometryInstruction1_=[C.BEGIN_GEOMETRY,c,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[C.BEGIN_GEOMETRY,c,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let c;const h=t.length;let S,P,B=-1;for(c=0;c<h;++c)S=t[c],P=S[0],P==C.END_GEOMETRY?B=c:P==C.BEGIN_GEOMETRY&&(S[2]=c,(0,u.gI)(this.hitDetectionInstructions,B,c),B=-1)}setFillStrokeStyle(t,c){const h=this.state;if(t){const S=t.getColor();h.fillStyle=(0,a.F)(S||p.qY)}else h.fillStyle=void 0;if(c){const S=c.getColor();h.strokeStyle=(0,a.F)(S||p.NT);const P=c.getLineCap();h.lineCap=P!==void 0?P:p._m;const B=c.getLineDash();h.lineDash=B?B.slice():p.Oq;const j=c.getLineDashOffset();h.lineDashOffset=j||p.vk;const Z=c.getLineJoin();h.lineJoin=Z!==void 0?Z:p._K;const nt=c.getWidth();h.lineWidth=nt!==void 0?nt:p.aq;const lt=c.getMiterLimit();h.miterLimit=lt!==void 0?lt:p.eL,h.lineWidth>this.maxLineWidth&&(this.maxLineWidth=h.lineWidth,this.bufferedMaxExtent_=null)}else h.strokeStyle=void 0,h.lineCap=void 0,h.lineDash=null,h.lineDashOffset=void 0,h.lineJoin=void 0,h.lineWidth=void 0,h.miterLimit=void 0}createFill(t){const c=t.fillStyle,h=[C.SET_FILL_STYLE,c];return typeof c!="string"&&h.push(!0),h}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[C.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,c){const h=t.fillStyle;(typeof h!="string"||t.currentFillStyle!=h)&&(h!==void 0&&this.instructions.push(c.call(this,t)),t.currentFillStyle=h)}updateStrokeStyle(t,c){const h=t.strokeStyle,S=t.lineCap,P=t.lineDash,B=t.lineDashOffset,j=t.lineJoin,Z=t.lineWidth,nt=t.miterLimit;(t.currentStrokeStyle!=h||t.currentLineCap!=S||P!=t.currentLineDash&&!(0,u.aI)(t.currentLineDash,P)||t.currentLineDashOffset!=B||t.currentLineJoin!=j||t.currentLineWidth!=Z||t.currentMiterLimit!=nt)&&(h!==void 0&&c.call(this,t),t.currentStrokeStyle=h,t.currentLineCap=S,t.currentLineDash=P,t.currentLineDashOffset=B,t.currentLineJoin=j,t.currentLineWidth=Z,t.currentMiterLimit=nt)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const c=[C.END_GEOMETRY,t];this.instructions.push(c),this.hitDetectionInstructions.push(c)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,E.o8)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,E.r)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const A=f;class M extends A{constructor(t,c,h,S){super(t,c,h,S),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,c){if(!this.image_)return;this.beginGeometry(t,c);const h=t.getFlatCoordinates(),S=t.getStride(),P=this.coordinates.length,B=this.appendFlatPointCoordinates(h,S);this.instructions.push([C.DRAW_IMAGE,P,B,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([C.DRAW_IMAGE,P,B,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(c)}drawMultiPoint(t,c){if(!this.image_)return;this.beginGeometry(t,c);const h=t.getFlatCoordinates(),S=t.getStride(),P=this.coordinates.length,B=this.appendFlatPointCoordinates(h,S);this.instructions.push([C.DRAW_IMAGE,P,B,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([C.DRAW_IMAGE,P,B,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(c)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,c){const h=t.getAnchor(),S=t.getSize(),P=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=h[0],this.anchorY_=h[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=S[1],this.opacity_=t.getOpacity(),this.originX_=P[0],this.originY_=P[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=S[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=c}}const m=M;class g extends A{constructor(t,c,h,S){super(t,c,h,S)}drawFlatCoordinates_(t,c,h,S){const P=this.coordinates.length,B=this.appendFlatLineCoordinates(t,c,h,S,!1,!1),j=[C.MOVE_TO_LINE_TO,P,B];return this.instructions.push(j),this.hitDetectionInstructions.push(j),h}drawLineString(t,c){const h=this.state,S=h.strokeStyle,P=h.lineWidth;if(S===void 0||P===void 0)return;this.updateStrokeStyle(h,this.applyStroke),this.beginGeometry(t,c),this.hitDetectionInstructions.push([C.SET_STROKE_STYLE,h.strokeStyle,h.lineWidth,h.lineCap,h.lineJoin,h.miterLimit,p.Oq,p.vk],X);const B=t.getFlatCoordinates(),j=t.getStride();this.drawFlatCoordinates_(B,0,B.length,j),this.hitDetectionInstructions.push(Y),this.endGeometry(c)}drawMultiLineString(t,c){const h=this.state,S=h.strokeStyle,P=h.lineWidth;if(S===void 0||P===void 0)return;this.updateStrokeStyle(h,this.applyStroke),this.beginGeometry(t,c),this.hitDetectionInstructions.push([C.SET_STROKE_STYLE,h.strokeStyle,h.lineWidth,h.lineCap,h.lineJoin,h.miterLimit,h.lineDash,h.lineDashOffset],X);const B=t.getEnds(),j=t.getFlatCoordinates(),Z=t.getStride();let nt=0;for(let lt=0,dt=B.length;lt<dt;++lt)nt=this.drawFlatCoordinates_(j,nt,B[lt],Z);this.hitDetectionInstructions.push(Y),this.endGeometry(c)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Y),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Y),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(X)}}const O=g;var b=r(83671);class q extends A{constructor(t,c,h,S){super(t,c,h,S)}drawFlatCoordinatess_(t,c,h,S){const P=this.state,B=P.fillStyle!==void 0,j=P.strokeStyle!==void 0,Z=h.length;this.instructions.push(X),this.hitDetectionInstructions.push(X);for(let nt=0;nt<Z;++nt){const lt=h[nt],dt=this.coordinates.length,ft=this.appendFlatLineCoordinates(t,c,lt,S,!0,!j),Rt=[C.MOVE_TO_LINE_TO,dt,ft];this.instructions.push(Rt),this.hitDetectionInstructions.push(Rt),j&&(this.instructions.push(I),this.hitDetectionInstructions.push(I)),c=lt}return B&&(this.instructions.push(L),this.hitDetectionInstructions.push(L)),j&&(this.instructions.push(Y),this.hitDetectionInstructions.push(Y)),c}drawCircle(t,c){const h=this.state,S=h.fillStyle,P=h.strokeStyle;if(S===void 0&&P===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,c),h.fillStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_FILL_STYLE,p.qY]),h.strokeStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_STROKE_STYLE,h.strokeStyle,h.lineWidth,h.lineCap,h.lineJoin,h.miterLimit,h.lineDash,h.lineDashOffset]);const B=t.getFlatCoordinates(),j=t.getStride(),Z=this.coordinates.length;this.appendFlatLineCoordinates(B,0,B.length,j,!1,!1);const nt=[C.CIRCLE,Z];this.instructions.push(X,nt),this.hitDetectionInstructions.push(X,nt),h.fillStyle!==void 0&&(this.instructions.push(L),this.hitDetectionInstructions.push(L)),h.strokeStyle!==void 0&&(this.instructions.push(Y),this.hitDetectionInstructions.push(Y)),this.endGeometry(c)}drawPolygon(t,c){const h=this.state,S=h.fillStyle,P=h.strokeStyle;if(S===void 0&&P===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,c),h.fillStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_FILL_STYLE,p.qY]),h.strokeStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_STROKE_STYLE,h.strokeStyle,h.lineWidth,h.lineCap,h.lineJoin,h.miterLimit,h.lineDash,h.lineDashOffset]);const B=t.getEnds(),j=t.getOrientedFlatCoordinates(),Z=t.getStride();this.drawFlatCoordinatess_(j,0,B,Z),this.endGeometry(c)}drawMultiPolygon(t,c){const h=this.state,S=h.fillStyle,P=h.strokeStyle;if(S===void 0&&P===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,c),h.fillStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_FILL_STYLE,p.qY]),h.strokeStyle!==void 0&&this.hitDetectionInstructions.push([C.SET_STROKE_STYLE,h.strokeStyle,h.lineWidth,h.lineCap,h.lineJoin,h.miterLimit,h.lineDash,h.lineDashOffset]);const B=t.getEndss(),j=t.getOrientedFlatCoordinates(),Z=t.getStride();let nt=0;for(let lt=0,dt=B.length;lt<dt;++lt)nt=this.drawFlatCoordinatess_(j,nt,B[lt],Z);this.endGeometry(c)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const c=this.coordinates;for(let h=0,S=c.length;h<S;++h)c[h]=(0,b.n$)(c[h],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const ht=q;var et=r(4087),J=r(61597);function R(Pt,t,c,h,S){const P=[];let B=c,j=0,Z=t.slice(c,2);for(;j<Pt&&B+S<h;){const[nt,lt]=Z.slice(-2),dt=t[B+S],ft=t[B+S+1],Rt=Math.sqrt((dt-nt)*(dt-nt)+(ft-lt)*(ft-lt));if(j+=Rt,j>=Pt){const At=(Pt-j+Rt)/Rt,Mt=(0,J.Cc)(nt,dt,At),Ct=(0,J.Cc)(lt,ft,At);Z.push(Mt,Ct),P.push(Z),Z=[Mt,Ct],j==Pt&&(B+=S),j=0}else if(j<Pt)Z.push(t[B+S],t[B+S+1]),B+=S;else{const At=Rt-j,Mt=(0,J.Cc)(nt,dt,At/Rt),Ct=(0,J.Cc)(lt,ft,At/Rt);Z.push(Mt,Ct),P.push(Z),Z=[Mt,Ct],j=0,B+=S}}return j>0&&P.push(Z),P}function T(Pt,t,c,h,S){let P=c,B=c,j=0,Z=0,nt=c,lt,dt,ft,Rt,At,Mt,Ct,wt,Wt,Ut;for(dt=c;dt<h;dt+=S){const jt=t[dt],x=t[dt+1];At!==void 0&&(Wt=jt-At,Ut=x-Mt,Rt=Math.sqrt(Wt*Wt+Ut*Ut),Ct!==void 0&&(Z+=ft,lt=Math.acos((Ct*Wt+wt*Ut)/(ft*Rt)),lt>Pt&&(Z>j&&(j=Z,P=nt,B=dt),Z=0,nt=dt-S)),ft=Rt,Ct=Wt,wt=Ut),At=jt,Mt=x}return Z+=Rt,Z>j?[nt,dt]:[P,B]}const K={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Q extends A{constructor(t,c,h,S){super(t,c,h,S),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,c){const h=this.textFillState_,S=this.textStrokeState_,P=this.textState_;if(this.text_===""||!P||!h&&!S)return;const B=this.coordinates;let j=B.length;const Z=t.getType();let nt=null,lt=t.getStride();if(P.placement==="line"&&(Z=="LineString"||Z=="MultiLineString"||Z=="Polygon"||Z=="MultiPolygon")){if(!(0,E.HY)(this.getBufferedMaxExtent(),t.getExtent()))return;let dt;if(nt=t.getFlatCoordinates(),Z=="LineString")dt=[nt.length];else if(Z=="MultiLineString")dt=t.getEnds();else if(Z=="Polygon")dt=t.getEnds().slice(0,1);else if(Z=="MultiPolygon"){const Mt=t.getEndss();dt=[];for(let Ct=0,wt=Mt.length;Ct<wt;++Ct)dt.push(Mt[Ct][0])}this.beginGeometry(t,c);const ft=P.repeat,Rt=ft?void 0:P.textAlign;let At=0;for(let Mt=0,Ct=dt.length;Mt<Ct;++Mt){let wt;ft?wt=R(ft*this.resolution,nt,At,dt[Mt],lt):wt=[nt.slice(At,dt[Mt])];for(let Wt=0,Ut=wt.length;Wt<Ut;++Wt){const jt=wt[Wt];let x=0,e=jt.length;if(Rt==null){const G=T(P.maxAngle,jt,0,jt.length,2);x=G[0],e=G[1]}for(let G=x;G<e;G+=lt)B.push(jt[G],jt[G+1]);const F=B.length;At=dt[Mt],this.drawChars_(j,F),j=F}}this.endGeometry(c)}else{let dt=P.overflow?null:[];switch(Z){case"Point":case"MultiPoint":nt=t.getFlatCoordinates();break;case"LineString":nt=t.getFlatMidpoint();break;case"Circle":nt=t.getCenter();break;case"MultiLineString":nt=t.getFlatMidpoints(),lt=2;break;case"Polygon":nt=t.getFlatInteriorPoint(),P.overflow||dt.push(nt[2]/this.resolution),lt=3;break;case"MultiPolygon":const Ct=t.getFlatInteriorPoints();nt=[];for(let wt=0,Wt=Ct.length;wt<Wt;wt+=3)P.overflow||dt.push(Ct[wt+2]/this.resolution),nt.push(Ct[wt],Ct[wt+1]);if(nt.length===0)return;lt=2;break;default:}const ft=this.appendFlatPointCoordinates(nt,lt);if(ft===j)return;if(dt&&(ft-j)/2!==nt.length/lt){let Ct=j/2;dt=dt.filter((wt,Wt)=>{const Ut=B[(Ct+Wt)*2]===nt[Wt*lt]&&B[(Ct+Wt)*2+1]===nt[Wt*lt+1];return Ut||--Ct,Ut})}this.saveTextStates_(),(P.backgroundFill||P.backgroundStroke)&&(this.setFillStrokeStyle(P.backgroundFill,P.backgroundStroke),P.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),P.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,c);let Rt=P.padding;if(Rt!=p.Tq&&(P.scale[0]<0||P.scale[1]<0)){let Ct=P.padding[0],wt=P.padding[1],Wt=P.padding[2],Ut=P.padding[3];P.scale[0]<0&&(wt=-wt,Ut=-Ut),P.scale[1]<0&&(Ct=-Ct,Wt=-Wt),Rt=[Ct,wt,Wt,Ut]}const At=this.pixelRatio;this.instructions.push([C.DRAW_IMAGE,j,ft,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,Rt==p.Tq?p.Tq:Rt.map(function(Ct){return Ct*At}),!!P.backgroundFill,!!P.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,dt]);const Mt=1/At;this.hitDetectionInstructions.push([C.DRAW_IMAGE,j,ft,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[Mt,Mt],NaN,void 0,this.declutterImageWithText_,Rt,!!P.backgroundFill,!!P.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,dt]),this.endGeometry(c)}}saveTextStates_(){const t=this.textStrokeState_,c=this.textState_,h=this.textFillState_,S=this.strokeKey_;t&&(S in this.strokeStates||(this.strokeStates[S]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const P=this.textKey_;P in this.textStates||(this.textStates[P]={font:c.font,textAlign:c.textAlign||p.MY,justify:c.justify,textBaseline:c.textBaseline||p.M8,scale:c.scale});const B=this.fillKey_;h&&(B in this.fillStates||(this.fillStates[B]={fillStyle:h.fillStyle}))}drawChars_(t,c){const h=this.textStrokeState_,S=this.textState_,P=this.strokeKey_,B=this.textKey_,j=this.fillKey_;this.saveTextStates_();const Z=this.pixelRatio,nt=K[S.textBaseline],lt=this.textOffsetY_*Z,dt=this.text_,ft=h?h.lineWidth*Math.abs(S.scale[0])/2:0;this.instructions.push([C.DRAW_CHARS,t,c,nt,S.overflow,j,S.maxAngle,Z,lt,P,ft*Z,dt,B,1]),this.hitDetectionInstructions.push([C.DRAW_CHARS,t,c,nt,S.overflow,j,S.maxAngle,1,lt,P,ft,dt,B,1/Z])}setTextStyle(t,c){let h,S,P;if(!t)this.text_="";else{const B=t.getFill();B?(S=this.textFillState_,S||(S={},this.textFillState_=S),S.fillStyle=(0,a.F)(B.getColor()||p.qY)):(S=null,this.textFillState_=S);const j=t.getStroke();if(!j)P=null,this.textStrokeState_=P;else{P=this.textStrokeState_,P||(P={},this.textStrokeState_=P);const At=j.getLineDash(),Mt=j.getLineDashOffset(),Ct=j.getWidth(),wt=j.getMiterLimit();P.lineCap=j.getLineCap()||p._m,P.lineDash=At?At.slice():p.Oq,P.lineDashOffset=Mt===void 0?p.vk:Mt,P.lineJoin=j.getLineJoin()||p._K,P.lineWidth=Ct===void 0?p.aq:Ct,P.miterLimit=wt===void 0?p.eL:wt,P.strokeStyle=(0,a.F)(j.getColor()||p.NT)}h=this.textState_;const Z=t.getFont()||p.ZV;(0,p.fZ)(Z);const nt=t.getScaleArray();h.overflow=t.getOverflow(),h.font=Z,h.maxAngle=t.getMaxAngle(),h.placement=t.getPlacement(),h.textAlign=t.getTextAlign(),h.repeat=t.getRepeat(),h.justify=t.getJustify(),h.textBaseline=t.getTextBaseline()||p.M8,h.backgroundFill=t.getBackgroundFill(),h.backgroundStroke=t.getBackgroundStroke(),h.padding=t.getPadding()||p.Tq,h.scale=nt===void 0?[1,1]:nt;const lt=t.getOffsetX(),dt=t.getOffsetY(),ft=t.getRotateWithView(),Rt=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=lt===void 0?0:lt,this.textOffsetY_=dt===void 0?0:dt,this.textRotateWithView_=ft===void 0?!1:ft,this.textRotation_=Rt===void 0?0:Rt,this.strokeKey_=P?(typeof P.strokeStyle=="string"?P.strokeStyle:(0,et.v6)(P.strokeStyle))+P.lineCap+P.lineDashOffset+"|"+P.lineWidth+P.lineJoin+P.miterLimit+"["+P.lineDash.join()+"]":"",this.textKey_=h.font+h.scale+(h.textAlign||"?")+(h.repeat||"?")+(h.justify||"?")+(h.textBaseline||"?"),this.fillKey_=S?typeof S.fillStyle=="string"?S.fillStyle:"|"+(0,et.v6)(S.fillStyle):""}this.declutterImageWithText_=c}}const l={Circle:ht,Default:A,Image:m,LineString:O,Polygon:ht,Text:Q};class s{constructor(t,c,h,S){this.tolerance_=t,this.maxExtent_=c,this.pixelRatio_=S,this.resolution_=h,this.buildersByZIndex_={}}finish(){const t={};for(const c in this.buildersByZIndex_){t[c]=t[c]||{};const h=this.buildersByZIndex_[c];for(const S in h){const P=h[S].finish();t[c][S]=P}}return t}getBuilder(t,c){const h=t!==void 0?t.toString():"0";let S=this.buildersByZIndex_[h];S===void 0&&(S={},this.buildersByZIndex_[h]=S);let P=S[c];if(P===void 0){const B=l[c];P=new B(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),S[c]=P}return P}}const n=s;var o=r(96769),_=r(9703),D=r(87622);function N(Pt,t,c,h,S,P,B,j,Z,nt,lt,dt){let ft=Pt[t],Rt=Pt[t+1],At=0,Mt=0,Ct=0,wt=0;function Wt(){At=ft,Mt=Rt,t+=h,ft=Pt[t],Rt=Pt[t+1],wt+=Ct,Ct=Math.sqrt((ft-At)*(ft-At)+(Rt-Mt)*(Rt-Mt))}do Wt();while(t<c-h&&wt+Ct<P);let Ut=Ct===0?0:(P-wt)/Ct;const jt=(0,J.Cc)(At,ft,Ut),x=(0,J.Cc)(Mt,Rt,Ut),e=t-h,F=wt,G=P+j*Z(nt,S,lt);for(;t<c-h&&wt+Ct<G;)Wt();Ut=Ct===0?0:(G-wt)/Ct;const $=(0,J.Cc)(At,ft,Ut),ot=(0,J.Cc)(Mt,Rt,Ut);let xt;if(dt){const _t=[jt,x,$,ot];(0,D.e$)(_t,0,4,2,dt,_t,_t),xt=_t[0]>_t[2]}else xt=jt>$;const Ot=Math.PI,Lt=[],Tt=e+h===t;t=e,Ct=0,wt=F,ft=Pt[t],Rt=Pt[t+1];let mt;if(Tt){Wt(),mt=Math.atan2(Rt-Mt,ft-At),xt&&(mt+=mt>0?-Ot:Ot);const _t=($+jt)/2,Ft=(ot+x)/2;return Lt[0]=[_t,Ft,(G-P)/2,mt,S],Lt}S=S.replace(/\n/g," ");for(let _t=0,Ft=S.length;_t<Ft;){Wt();let It=Math.atan2(Rt-Mt,ft-At);if(xt&&(It+=It>0?-Ot:Ot),mt!==void 0){let i=It-mt;if(i+=i>Ot?-2*Ot:i<-Ot?2*Ot:0,Math.abs(i)>B)return null}mt=It;const Kt=_t;let Xt=0;for(;_t<Ft;++_t){const i=xt?Ft-_t-1:_t,y=j*Z(nt,S[i],lt);if(t+h<c&&wt+Ct<P+Xt+y/2)break;Xt+=y}if(_t===Kt)continue;const Vt=xt?S.substring(Ft-Kt,Ft-_t):S.substring(Kt,_t);Ut=Ct===0?0:(P+Xt/2-wt)/Ct;const St=(0,J.Cc)(At,ft,Ut),tt=(0,J.Cc)(Mt,Rt,Ut);Lt.push([St,tt,Xt/2,It,Vt]),P+=Xt}return Lt}var V=r(50904);const H=(0,E.S5)(),rt=[],it=[],ct=[],gt=[];function yt(Pt){return Pt[3].declutterBox}const pt=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function Dt(Pt,t){return(t==="start"||t==="end")&&!pt.test(Pt)&&(t=t==="start"?"left":"right"),K[t]}function Gt(Pt,t,c){return c>0&&Pt.push(`
`,""),Pt.push(t,""),Pt}class $t{constructor(t,c,h,S){this.overlaps=h,this.pixelRatio=c,this.resolution=t,this.alignFill_,this.instructions=S.instructions,this.coordinates=S.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,_.vt)(),this.hitDetectionInstructions=S.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=S.fillStates||{},this.strokeStates=S.strokeStates||{},this.textStates=S.textStates||{},this.widths_={},this.labels_={}}createLabel(t,c,h,S){const P=t+c+h+S;if(this.labels_[P])return this.labels_[P];const B=S?this.strokeStates[S]:null,j=h?this.fillStates[h]:null,Z=this.textStates[c],nt=this.pixelRatio,lt=[Z.scale[0]*nt,Z.scale[1]*nt],dt=Array.isArray(t),ft=Z.justify?K[Z.justify]:Dt(Array.isArray(t)?t[0]:t,Z.textAlign||p.MY),Rt=S&&B.lineWidth?B.lineWidth:0,At=dt?t:t.split(`
`).reduce(Gt,[]),{width:Mt,height:Ct,widths:wt,heights:Wt,lineWidths:Ut}=(0,p.jT)(Z,At),jt=Mt+Rt,x=[],e=(jt+2)*lt[0],F=(Ct+Rt)*lt[1],G={width:e<0?Math.floor(e):Math.ceil(e),height:F<0?Math.floor(F):Math.ceil(F),contextInstructions:x};(lt[0]!=1||lt[1]!=1)&&x.push("scale",lt),S&&(x.push("strokeStyle",B.strokeStyle),x.push("lineWidth",Rt),x.push("lineCap",B.lineCap),x.push("lineJoin",B.lineJoin),x.push("miterLimit",B.miterLimit),x.push("setLineDash",[B.lineDash]),x.push("lineDashOffset",B.lineDashOffset)),h&&x.push("fillStyle",j.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const $=.5-ft;let ot=ft*jt+$*Rt;const xt=[],Ot=[];let Lt=0,Tt=0,mt=0,_t=0,Ft;for(let It=0,Kt=At.length;It<Kt;It+=2){const Xt=At[It];if(Xt===`
`){Tt+=Lt,Lt=0,ot=ft*jt+$*Rt,++_t;continue}const Vt=At[It+1]||Z.font;Vt!==Ft&&(S&&xt.push("font",Vt),h&&Ot.push("font",Vt),Ft=Vt),Lt=Math.max(Lt,Wt[mt]);const St=[Xt,ot+$*wt[mt]+ft*(wt[mt]-Ut[_t]),.5*(Rt+Lt)+Tt];ot+=wt[mt],S&&xt.push("strokeText",St),h&&Ot.push("fillText",St),++mt}return Array.prototype.push.apply(x,xt),Array.prototype.push.apply(x,Ot),this.labels_[P]=G,G}replayTextBackground_(t,c,h,S,P,B,j){t.beginPath(),t.moveTo.apply(t,c),t.lineTo.apply(t,h),t.lineTo.apply(t,S),t.lineTo.apply(t,P),t.lineTo.apply(t,c),B&&(this.alignFill_=B[2],this.fill_(t)),j&&(this.setStrokeStyle_(t,j),t.stroke())}calculateImageOrLabelDimensions_(t,c,h,S,P,B,j,Z,nt,lt,dt,ft,Rt,At,Mt,Ct){j*=ft[0],Z*=ft[1];let wt=h-j,Wt=S-Z;const Ut=P+nt>t?t-nt:P,jt=B+lt>c?c-lt:B,x=At[3]+Ut*ft[0]+At[1],e=At[0]+jt*ft[1]+At[2],F=wt-At[3],G=Wt-At[0];(Mt||dt!==0)&&(rt[0]=F,gt[0]=F,rt[1]=G,it[1]=G,it[0]=F+x,ct[0]=it[0],ct[1]=G+e,gt[1]=ct[1]);let $;return dt!==0?($=(0,_.Zz)((0,_.vt)(),h,S,1,1,dt,-h,-S),(0,_.Bb)($,rt),(0,_.Bb)($,it),(0,_.Bb)($,ct),(0,_.Bb)($,gt),(0,E.N)(Math.min(rt[0],it[0],ct[0],gt[0]),Math.min(rt[1],it[1],ct[1],gt[1]),Math.max(rt[0],it[0],ct[0],gt[0]),Math.max(rt[1],it[1],ct[1],gt[1]),H)):(0,E.N)(Math.min(F,F+x),Math.min(G,G+e),Math.max(F,F+x),Math.max(G,G+e),H),Rt&&(wt=Math.round(wt),Wt=Math.round(Wt)),{drawImageX:wt,drawImageY:Wt,drawImageW:Ut,drawImageH:jt,originX:nt,originY:lt,declutterBox:{minX:H[0],minY:H[1],maxX:H[2],maxY:H[3],value:Ct},canvasTransform:$,scale:ft}}replayImageOrLabel_(t,c,h,S,P,B,j){const Z=!!(B||j),nt=S.declutterBox,lt=t.canvas,dt=j?j[2]*S.scale[0]/2:0;return nt.minX-dt<=lt.width/c&&nt.maxX+dt>=0&&nt.minY-dt<=lt.height/c&&nt.maxY+dt>=0&&(Z&&this.replayTextBackground_(t,rt,it,ct,gt,B,j),(0,p.Jw)(t,S.canvasTransform,P,h,S.originX,S.originY,S.drawImageW,S.drawImageH,S.drawImageX,S.drawImageY,S.scale)),!0}fill_(t){if(this.alignFill_){const c=(0,_.Bb)(this.renderedTransform_,[0,0]),h=512*this.pixelRatio;t.save(),t.translate(c[0]%h,c[1]%h),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,c){t.strokeStyle=c[1],t.lineWidth=c[2],t.lineCap=c[3],t.lineJoin=c[4],t.miterLimit=c[5],t.lineDashOffset=c[7],t.setLineDash(c[6])}drawLabelWithPointPlacement_(t,c,h,S){const P=this.textStates[c],B=this.createLabel(t,c,S,h),j=this.strokeStates[h],Z=this.pixelRatio,nt=Dt(Array.isArray(t)?t[0]:t,P.textAlign||p.MY),lt=K[P.textBaseline||p.M8],dt=j&&j.lineWidth?j.lineWidth:0,ft=B.width/Z-2*P.scale[0],Rt=nt*ft+2*(.5-nt)*dt,At=lt*B.height/Z+2*(.5-lt)*dt;return{label:B,anchorX:Rt,anchorY:At}}execute_(t,c,h,S,P,B,j,Z){let nt;this.pixelCoordinates_&&(0,u.aI)(h,this.renderedTransform_)?nt=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),nt=(0,D.Rc)(this.coordinates,0,this.coordinates.length,2,h,this.pixelCoordinates_),(0,_.k3)(this.renderedTransform_,h));let lt=0;const dt=S.length;let ft=0,Rt,At,Mt,Ct,wt,Wt,Ut,jt,x,e,F,G,$=0,ot=0,xt=null,Ot=null;const Lt=this.coordinateCache_,Tt=this.viewRotation_,mt=Math.round(Math.atan2(-h[1],h[0])*1e12)/1e12,_t={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Tt},Ft=this.instructions!=S||this.overlaps?0:200;let It,Kt,Xt,Vt;for(;lt<dt;){const St=S[lt];switch(St[0]){case C.BEGIN_GEOMETRY:It=St[1],Vt=St[3],It.getGeometry()?j!==void 0&&!(0,E.HY)(j,Vt.getExtent())?lt=St[2]+1:++lt:lt=St[2];break;case C.BEGIN_PATH:$>Ft&&(this.fill_(t),$=0),ot>Ft&&(t.stroke(),ot=0),!$&&!ot&&(t.beginPath(),Ct=NaN,wt=NaN),++lt;break;case C.CIRCLE:ft=St[1];const i=nt[ft],y=nt[ft+1],w=nt[ft+2],k=nt[ft+3],ut=w-i,Et=k-y,bt=Math.sqrt(ut*ut+Et*Et);t.moveTo(i+bt,y),t.arc(i,y,bt,0,2*Math.PI,!0),++lt;break;case C.CLOSE_PATH:t.closePath(),++lt;break;case C.CUSTOM:ft=St[1],Rt=St[2];const zt=St[3],ne=St[4],de=St.length==6?St[5]:void 0;_t.geometry=zt,_t.feature=It,lt in Lt||(Lt[lt]=[]);const le=Lt[lt];de?de(nt,ft,Rt,2,le):(le[0]=nt[ft],le[1]=nt[ft+1],le.length=2),ne(le,_t),++lt;break;case C.DRAW_IMAGE:ft=St[1],Rt=St[2],jt=St[3],At=St[4],Mt=St[5];let ge=St[6];const Ie=St[7],Ke=St[8],Je=St[9],ze=St[10];let we=St[11];const $e=St[12];let Ue=St[13];const he=St[14],me=St[15];if(!jt&&St.length>=20){x=St[19],e=St[20],F=St[21],G=St[22];const Pe=this.drawLabelWithPointPlacement_(x,e,F,G);jt=Pe.label,St[3]=jt;const qe=St[23];At=(Pe.anchorX-qe)*this.pixelRatio,St[4]=At;const Fe=St[24];Mt=(Pe.anchorY-Fe)*this.pixelRatio,St[5]=Mt,ge=jt.height,St[6]=ge,Ue=jt.width,St[13]=Ue}let We;St.length>25&&(We=St[25]);let be,je,ke;St.length>17?(be=St[16],je=St[17],ke=St[18]):(be=p.Tq,je=!1,ke=!1),ze&&mt?we+=Tt:!ze&&!mt&&(we-=Tt);let Qe=0;for(;ft<Rt;ft+=2){if(We&&We[Qe++]<Ue/this.pixelRatio)continue;const Pe=this.calculateImageOrLabelDimensions_(jt.width,jt.height,nt[ft],nt[ft+1],Ue,ge,At,Mt,Ke,Je,we,$e,P,be,je||ke,It),qe=[t,c,jt,Pe,Ie,je?xt:null,ke?Ot:null];if(Z){if(he==="none")continue;if(he==="obstacle"){Z.insert(Pe.declutterBox);continue}else{let Fe,Xe;if(me){const Le=Rt-ft;if(!me[Le]){me[Le]=qe;continue}if(Fe=me[Le],delete me[Le],Xe=yt(Fe),Z.collides(Xe))continue}if(Z.collides(Pe.declutterBox))continue;Fe&&(Z.insert(Xe),this.replayImageOrLabel_.apply(this,Fe)),Z.insert(Pe.declutterBox)}}this.replayImageOrLabel_.apply(this,qe)}++lt;break;case C.DRAW_CHARS:const sn=St[1],cn=St[2],an=St[3],mn=St[4];G=St[5];const pn=St[6],un=St[7],dn=St[8];F=St[9];const ln=St[10];x=St[11],e=St[12];const fn=[St[13],St[13]],hn=this.textStates[e],tn=hn.font,en=[hn.scale[0]*un,hn.scale[1]*un];let nn;tn in this.widths_?nn=this.widths_[tn]:(nn={},this.widths_[tn]=nn);const _n=(0,V.k)(nt,sn,cn,2),gn=Math.abs(en[0])*(0,p.TA)(tn,x,nn);if(mn||gn<=_n){const Pe=this.textStates[e].textAlign,qe=(_n-gn)*K[Pe],Fe=N(nt,sn,cn,2,x,qe,pn,Math.abs(en[0]),p.TA,tn,nn,mt?0:this.viewRotation_);t:if(Fe){const Xe=[];let Le,rn,on,Se,Be;if(F)for(Le=0,rn=Fe.length;Le<rn;++Le){Be=Fe[Le],on=Be[4],Se=this.createLabel(on,e,"",F),At=Be[2]+(en[0]<0?-ln:ln),Mt=an*Se.height+(.5-an)*2*ln*en[1]/en[0]-dn;const Ye=this.calculateImageOrLabelDimensions_(Se.width,Se.height,Be[0],Be[1],Se.width,Se.height,At,Mt,0,0,Be[3],fn,!1,p.Tq,!1,It);if(Z&&Z.collides(Ye.declutterBox))break t;Xe.push([t,c,Se,Ye,1,null,null])}if(G)for(Le=0,rn=Fe.length;Le<rn;++Le){Be=Fe[Le],on=Be[4],Se=this.createLabel(on,e,G,""),At=Be[2],Mt=an*Se.height-dn;const Ye=this.calculateImageOrLabelDimensions_(Se.width,Se.height,Be[0],Be[1],Se.width,Se.height,At,Mt,0,0,Be[3],fn,!1,p.Tq,!1,It);if(Z&&Z.collides(Ye.declutterBox))break t;Xe.push([t,c,Se,Ye,1,null,null])}Z&&Z.load(Xe.map(yt));for(let Ye=0,En=Xe.length;Ye<En;++Ye)this.replayImageOrLabel_.apply(this,Xe[Ye])}}++lt;break;case C.END_GEOMETRY:if(B!==void 0){It=St[1];const Pe=B(It,Vt);if(Pe)return Pe}++lt;break;case C.FILL:Ft?$++:this.fill_(t),++lt;break;case C.MOVE_TO_LINE_TO:for(ft=St[1],Rt=St[2],Kt=nt[ft],Xt=nt[ft+1],Wt=Kt+.5|0,Ut=Xt+.5|0,(Wt!==Ct||Ut!==wt)&&(t.moveTo(Kt,Xt),Ct=Wt,wt=Ut),ft+=2;ft<Rt;ft+=2)Kt=nt[ft],Xt=nt[ft+1],Wt=Kt+.5|0,Ut=Xt+.5|0,(ft==Rt-2||Wt!==Ct||Ut!==wt)&&(t.lineTo(Kt,Xt),Ct=Wt,wt=Ut);++lt;break;case C.SET_FILL_STYLE:xt=St,this.alignFill_=St[2],$&&(this.fill_(t),$=0,ot&&(t.stroke(),ot=0)),t.fillStyle=St[1],++lt;break;case C.SET_STROKE_STYLE:Ot=St,ot&&(t.stroke(),ot=0),this.setStrokeStyle_(t,St),++lt;break;case C.STROKE:Ft?ot++:t.stroke(),++lt;break;default:++lt;break}}$&&this.fill_(t),ot&&t.stroke()}execute(t,c,h,S,P,B){this.viewRotation_=S,this.execute_(t,c,h,this.instructions,P,void 0,void 0,B)}executeHitDetection(t,c,h,S,P){return this.viewRotation_=h,this.execute_(t,1,c,this.hitDetectionInstructions,!0,S,P)}}const te=$t;var Yt=r(68711),Zt=r(43530);const ye=["Polygon","Circle","LineString","Image","Text","Default"];class Ht{constructor(t,c,h,S,P,B){this.maxExtent_=t,this.overlaps_=S,this.pixelRatio_=h,this.resolution_=c,this.renderBuffer_=B,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,_.vt)(),this.createExecutors_(P)}clip(t,c){const h=this.getClipCoords(c);t.beginPath(),t.moveTo(h[0],h[1]),t.lineTo(h[2],h[3]),t.lineTo(h[4],h[5]),t.lineTo(h[6],h[7]),t.clip()}createExecutors_(t){for(const c in t){let h=this.executorsByZIndex_[c];h===void 0&&(h={},this.executorsByZIndex_[c]=h);const S=t[c];for(const P in S){const B=S[P];h[P]=new te(this.resolution_,this.pixelRatio_,this.overlaps_,B)}}}hasExecutors(t){for(const c in this.executorsByZIndex_){const h=this.executorsByZIndex_[c];for(let S=0,P=t.length;S<P;++S)if(t[S]in h)return!0}return!1}forEachFeatureAtCoordinate(t,c,h,S,P,B){S=Math.round(S);const j=S*2+1,Z=(0,_.Zz)(this.hitDetectionTransform_,S+.5,S+.5,1/c,-1/c,-h,-t[0],-t[1]),nt=!this.hitDetectionContext_;nt&&(this.hitDetectionContext_=(0,Yt.Y)(j,j,void 0,{willReadFrequently:!0}));const lt=this.hitDetectionContext_;lt.canvas.width!==j||lt.canvas.height!==j?(lt.canvas.width=j,lt.canvas.height=j):nt||lt.clearRect(0,0,j,j);let dt;this.renderBuffer_!==void 0&&(dt=(0,E.S5)(),(0,E.$C)(dt,t),(0,E.r)(dt,c*(this.renderBuffer_+S),dt));const ft=ee(S);let Rt;function At(x,e){const F=lt.getImageData(0,0,j,j).data;for(let G=0,$=ft.length;G<$;G++)if(F[ft[G]]>0){if(!B||Rt!=="Image"&&Rt!=="Text"||B.includes(x)){const ot=(ft[G]-3)/4,xt=S-ot%j,Ot=S-(ot/j|0),Lt=P(x,e,xt*xt+Ot*Ot);if(Lt)return Lt}lt.clearRect(0,0,j,j);break}}const Mt=Object.keys(this.executorsByZIndex_).map(Number);Mt.sort(u.V_);let Ct,wt,Wt,Ut,jt;for(Ct=Mt.length-1;Ct>=0;--Ct){const x=Mt[Ct].toString();for(Wt=this.executorsByZIndex_[x],wt=ye.length-1;wt>=0;--wt)if(Rt=ye[wt],Ut=Wt[Rt],Ut!==void 0&&(jt=Ut.executeHitDetection(lt,Z,h,At,dt),jt))return jt}}getClipCoords(t){const c=this.maxExtent_;if(!c)return null;const h=c[0],S=c[1],P=c[2],B=c[3],j=[h,S,h,B,P,B,P,S];return(0,D.Rc)(j,0,8,2,t,j),j}isEmpty(){return(0,Zt.p)(this.executorsByZIndex_)}execute(t,c,h,S,P,B,j){const Z=Object.keys(this.executorsByZIndex_).map(Number);Z.sort(u.V_),this.maxExtent_&&(t.save(),this.clip(t,h)),B=B||ye;let nt,lt,dt,ft,Rt,At;for(j&&Z.reverse(),nt=0,lt=Z.length;nt<lt;++nt){const Mt=Z[nt].toString();for(Rt=this.executorsByZIndex_[Mt],dt=0,ft=B.length;dt<ft;++dt){const Ct=B[dt];At=Rt[Ct],At!==void 0&&At.execute(t,c,h,S,P,j)}}this.maxExtent_&&t.restore()}}const ie={};function ee(Pt){if(ie[Pt]!==void 0)return ie[Pt];const t=Pt*2+1,c=Pt*Pt,h=new Array(c+1);for(let P=0;P<=Pt;++P)for(let B=0;B<=Pt;++B){const j=P*P+B*B;if(j>c)break;let Z=h[j];Z||(Z=[],h[j]=Z),Z.push(((Pt+P)*t+(Pt+B))*4+3),P>0&&Z.push(((Pt-P)*t+(Pt+B))*4+3),B>0&&(Z.push(((Pt+P)*t+(Pt-B))*4+3),P>0&&Z.push(((Pt-P)*t+(Pt-B))*4+3))}const S=[];for(let P=0,B=h.length;P<B;++P)h[P]&&S.push(...h[P]);return ie[Pt]=S,S}const se=Ht;var Jt=r(62703),qt=r(62096);class fe extends d{constructor(t,c,h,S,P,B,j){super(),this.context_=t,this.pixelRatio_=c,this.extent_=h,this.transform_=S,this.transformRotation_=S?(0,J.Mg)(Math.atan2(S[1],S[0]),10):0,this.viewRotation_=P,this.squaredTolerance_=B,this.userTransform_=j,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,_.vt)()}drawImages_(t,c,h,S){if(!this.image_)return;const P=(0,D.Rc)(t,c,h,S,this.transform_,this.pixelCoordinates_),B=this.context_,j=this.tmpLocalTransform_,Z=B.globalAlpha;this.imageOpacity_!=1&&(B.globalAlpha=Z*this.imageOpacity_);let nt=this.imageRotation_;this.transformRotation_===0&&(nt-=this.viewRotation_),this.imageRotateWithView_&&(nt+=this.viewRotation_);for(let lt=0,dt=P.length;lt<dt;lt+=2){const ft=P[lt]-this.imageAnchorX_,Rt=P[lt+1]-this.imageAnchorY_;if(nt!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const At=ft+this.imageAnchorX_,Mt=Rt+this.imageAnchorY_;(0,_.Zz)(j,At,Mt,1,1,nt,-At,-Mt),B.setTransform.apply(B,j),B.translate(At,Mt),B.scale(this.imageScale_[0],this.imageScale_[1]),B.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),B.setTransform(1,0,0,1,0,0)}else B.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,ft,Rt,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(B.globalAlpha=Z)}drawText_(t,c,h,S){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const P=(0,D.Rc)(t,c,h,S,this.transform_,this.pixelCoordinates_),B=this.context_;let j=this.textRotation_;for(this.transformRotation_===0&&(j-=this.viewRotation_),this.textRotateWithView_&&(j+=this.viewRotation_);c<h;c+=S){const Z=P[c]+this.textOffsetX_,nt=P[c+1]+this.textOffsetY_;j!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(B.translate(Z-this.textOffsetX_,nt-this.textOffsetY_),B.rotate(j),B.translate(this.textOffsetX_,this.textOffsetY_),B.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&B.strokeText(this.text_,0,0),this.textFillState_&&B.fillText(this.text_,0,0),B.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&B.strokeText(this.text_,Z,nt),this.textFillState_&&B.fillText(this.text_,Z,nt))}}moveToLineTo_(t,c,h,S,P){const B=this.context_,j=(0,D.Rc)(t,c,h,S,this.transform_,this.pixelCoordinates_);B.moveTo(j[0],j[1]);let Z=j.length;P&&(Z-=2);for(let nt=2;nt<Z;nt+=2)B.lineTo(j[nt],j[nt+1]);return P&&B.closePath(),h}drawRings_(t,c,h,S){for(let P=0,B=h.length;P<B;++P)c=this.moveToLineTo_(t,c,h[P],S,!0);return c}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,E.HY)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const c=(0,qt.v7)(t,this.transform_,this.pixelCoordinates_),h=c[2]-c[0],S=c[3]-c[1],P=Math.sqrt(h*h+S*S),B=this.context_;B.beginPath(),B.arc(c[0],c[1],P,0,2*Math.PI),this.fillState_&&B.fill(),this.strokeState_&&B.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break;default:}}drawFeature(t,c){const h=c.getGeometryFunction()(t);h&&(this.setStyle(c),this.drawGeometry(h))}drawGeometryCollection(t){const c=t.getGeometriesArray();for(let h=0,S=c.length;h<S;++h)this.drawGeometry(c[h])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const c=t.getFlatCoordinates(),h=t.getStride();this.image_&&this.drawImages_(c,0,c.length,h),this.text_!==""&&this.drawText_(c,0,c.length,h)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const c=t.getFlatCoordinates(),h=t.getStride();this.image_&&this.drawImages_(c,0,c.length,h),this.text_!==""&&this.drawText_(c,0,c.length,h)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,E.HY)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const c=this.context_,h=t.getFlatCoordinates();c.beginPath(),this.moveToLineTo_(h,0,h.length,t.getStride(),!1),c.stroke()}if(this.text_!==""){const c=t.getFlatMidpoint();this.drawText_(c,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const c=t.getExtent();if((0,E.HY)(this.extent_,c)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const h=this.context_,S=t.getFlatCoordinates();let P=0;const B=t.getEnds(),j=t.getStride();h.beginPath();for(let Z=0,nt=B.length;Z<nt;++Z)P=this.moveToLineTo_(S,P,B[Z],j,!1);h.stroke()}if(this.text_!==""){const h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,E.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const c=this.context_;c.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}if(this.text_!==""){const c=t.getFlatInteriorPoint();this.drawText_(c,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,E.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const c=this.context_,h=t.getOrientedFlatCoordinates();let S=0;const P=t.getEndss(),B=t.getStride();c.beginPath();for(let j=0,Z=P.length;j<Z;++j){const nt=P[j];S=this.drawRings_(h,S,nt,B)}this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}if(this.text_!==""){const c=t.getFlatInteriorPoints();this.drawText_(c,0,c.length,2)}}}setContextFillState_(t){const c=this.context_,h=this.contextFillState_;h?h.fillStyle!=t.fillStyle&&(h.fillStyle=t.fillStyle,c.fillStyle=t.fillStyle):(c.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const c=this.context_,h=this.contextStrokeState_;h?(h.lineCap!=t.lineCap&&(h.lineCap=t.lineCap,c.lineCap=t.lineCap),(0,u.aI)(h.lineDash,t.lineDash)||c.setLineDash(h.lineDash=t.lineDash),h.lineDashOffset!=t.lineDashOffset&&(h.lineDashOffset=t.lineDashOffset,c.lineDashOffset=t.lineDashOffset),h.lineJoin!=t.lineJoin&&(h.lineJoin=t.lineJoin,c.lineJoin=t.lineJoin),h.lineWidth!=t.lineWidth&&(h.lineWidth=t.lineWidth,c.lineWidth=t.lineWidth),h.miterLimit!=t.miterLimit&&(h.miterLimit=t.miterLimit,c.miterLimit=t.miterLimit),h.strokeStyle!=t.strokeStyle&&(h.strokeStyle=t.strokeStyle,c.strokeStyle=t.strokeStyle)):(c.lineCap=t.lineCap,c.setLineDash(t.lineDash),c.lineDashOffset=t.lineDashOffset,c.lineJoin=t.lineJoin,c.lineWidth=t.lineWidth,c.miterLimit=t.miterLimit,c.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const c=this.context_,h=this.contextTextState_,S=t.textAlign?t.textAlign:p.MY;h?(h.font!=t.font&&(h.font=t.font,c.font=t.font),h.textAlign!=S&&(h.textAlign=S,c.textAlign=S),h.textBaseline!=t.textBaseline&&(h.textBaseline=t.textBaseline,c.textBaseline=t.textBaseline)):(c.font=t.font,c.textAlign=S,c.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:S,textBaseline:t.textBaseline})}setFillStrokeStyle(t,c){if(!t)this.fillState_=null;else{const h=t.getColor();this.fillState_={fillStyle:(0,a.F)(h||p.qY)}}if(!c)this.strokeState_=null;else{const h=c.getColor(),S=c.getLineCap(),P=c.getLineDash(),B=c.getLineDashOffset(),j=c.getLineJoin(),Z=c.getWidth(),nt=c.getMiterLimit(),lt=P||p.Oq;this.strokeState_={lineCap:S!==void 0?S:p._m,lineDash:this.pixelRatio_===1?lt:lt.map(dt=>dt*this.pixelRatio_),lineDashOffset:(B||p.vk)*this.pixelRatio_,lineJoin:j!==void 0?j:p._K,lineWidth:(Z!==void 0?Z:p.aq)*this.pixelRatio_,miterLimit:nt!==void 0?nt:p.eL,strokeStyle:(0,a.F)(h||p.NT)}}}setImageStyle(t){let c;if(!t||!(c=t.getSize())){this.image_=null;return}const h=t.getPixelRatio(this.pixelRatio_),S=t.getAnchor(),P=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=S[0]*h,this.imageAnchorY_=S[1]*h,this.imageHeight_=c[1]*h,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=P[0],this.imageOriginY_=P[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const B=t.getScaleArray();this.imageScale_=[B[0]*this.pixelRatio_/h,B[1]*this.pixelRatio_/h],this.imageWidth_=c[0]*h}setTextStyle(t){if(!t)this.text_="";else{const c=t.getFill();if(!c)this.textFillState_=null;else{const Rt=c.getColor();this.textFillState_={fillStyle:(0,a.F)(Rt||p.qY)}}const h=t.getStroke();if(!h)this.textStrokeState_=null;else{const Rt=h.getColor(),At=h.getLineCap(),Mt=h.getLineDash(),Ct=h.getLineDashOffset(),wt=h.getLineJoin(),Wt=h.getWidth(),Ut=h.getMiterLimit();this.textStrokeState_={lineCap:At!==void 0?At:p._m,lineDash:Mt||p.Oq,lineDashOffset:Ct||p.vk,lineJoin:wt!==void 0?wt:p._K,lineWidth:Wt!==void 0?Wt:p.aq,miterLimit:Ut!==void 0?Ut:p.eL,strokeStyle:(0,a.F)(Rt||p.NT)}}const S=t.getFont(),P=t.getOffsetX(),B=t.getOffsetY(),j=t.getRotateWithView(),Z=t.getRotation(),nt=t.getScaleArray(),lt=t.getText(),dt=t.getTextAlign(),ft=t.getTextBaseline();this.textState_={font:S!==void 0?S:p.ZV,textAlign:dt!==void 0?dt:p.MY,textBaseline:ft!==void 0?ft:p.M8},this.text_=lt!==void 0?Array.isArray(lt)?lt.reduce((Rt,At,Mt)=>Rt+=Mt%2?" ":At,""):lt:"",this.textOffsetX_=P!==void 0?this.pixelRatio_*P:0,this.textOffsetY_=B!==void 0?this.pixelRatio_*B:0,this.textRotateWithView_=j!==void 0?j:!1,this.textRotation_=Z!==void 0?Z:0,this.textScale_=[this.pixelRatio_*nt[0],this.pixelRatio_*nt[1]]}}}const ce=fe;var Qt=r(3407);const ue=.5;function Re(Pt,t,c,h,S,P,B){const j=Pt[0]*ue,Z=Pt[1]*ue,nt=(0,Yt.Y)(j,Z);nt.imageSmoothingEnabled=!1;const lt=nt.canvas,dt=new ce(nt,ue,S,null,B),ft=c.length,Rt=Math.floor((256*256*256-1)/ft),At={};for(let Ct=1;Ct<=ft;++Ct){const wt=c[Ct-1],Wt=wt.getStyleFunction()||h;if(!h)continue;let Ut=Wt(wt,P);if(!Ut)continue;Array.isArray(Ut)||(Ut=[Ut]);const x=(Ct*Rt).toString(16).padStart(7,"#00000");for(let e=0,F=Ut.length;e<F;++e){const G=Ut[e],$=G.getGeometryFunction()(wt);if(!$||!(0,E.HY)(S,$.getExtent()))continue;const ot=G.clone(),xt=ot.getFill();xt&&xt.setColor(x);const Ot=ot.getStroke();Ot&&(Ot.setColor(x),Ot.setLineDash(null)),ot.setText(void 0);const Lt=G.getImage();if(Lt&&Lt.getOpacity()!==0){const Ft=Lt.getImageSize();if(!Ft)continue;const It=(0,Yt.Y)(Ft[0],Ft[1],void 0,{alpha:!1}),Kt=It.canvas;It.fillStyle=x,It.fillRect(0,0,Kt.width,Kt.height),ot.setImage(new Qt.A({img:Kt,imgSize:Ft,anchor:Lt.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Lt.getOrigin(),opacity:1,size:Lt.getSize(),scale:Lt.getScale(),rotation:Lt.getRotation(),rotateWithView:Lt.getRotateWithView()}))}const Tt=ot.getZIndex()||0;let mt=At[Tt];mt||(mt={},At[Tt]=mt,mt.Polygon=[],mt.Circle=[],mt.LineString=[],mt.Point=[]);const _t=$.getType();if(_t==="GeometryCollection"){const Ft=$.getGeometriesArrayRecursive();for(let It=0,Kt=Ft.length;It<Kt;++It){const Xt=Ft[It];mt[Xt.getType().replace("Multi","")].push(Xt,ot)}}else mt[_t.replace("Multi","")].push($,ot)}}const Mt=Object.keys(At).map(Number).sort(u.V_);for(let Ct=0,wt=Mt.length;Ct<wt;++Ct){const Wt=At[Mt[Ct]];for(const Ut in Wt){const jt=Wt[Ut];for(let x=0,e=jt.length;x<e;x+=2){dt.setStyle(jt[x+1]);for(let F=0,G=t.length;F<G;++F)dt.setTransform(t[F]),dt.drawGeometry(jt[x])}}}return nt.getImageData(0,0,lt.width,lt.height)}function De(Pt,t,c){const h=[];if(c){const S=Math.floor(Math.round(Pt[0])*ue),P=Math.floor(Math.round(Pt[1])*ue),B=((0,J.qE)(S,0,c.width-1)+(0,J.qE)(P,0,c.height-1)*c.width)*4,j=c.data[B],Z=c.data[B+1],lt=c.data[B+2]+256*(Z+256*j),dt=Math.floor((256*256*256-1)/t.length);lt&&lt%dt===0&&h.push(t[lt/dt-1])}return h}var Te=r(6141);const Ae=.5,vt={Point:xe,LineString:Ge,Polygon:Me,MultiPoint:re,MultiLineString:He,MultiPolygon:Bt,GeometryCollection:Ze,Circle:Ve};function Oe(Pt,t){return parseInt((0,et.v6)(Pt),10)-parseInt((0,et.v6)(t),10)}function kt(Pt,t){const c=ae(Pt,t);return c*c}function ae(Pt,t){return Ae*Pt/t}function Ve(Pt,t,c,h,S){const P=c.getFill(),B=c.getStroke();if(P||B){const Z=Pt.getBuilder(c.getZIndex(),"Circle");Z.setFillStrokeStyle(P,B),Z.drawCircle(t,h)}const j=c.getText();if(j&&j.getText()){const Z=(S||Pt).getBuilder(c.getZIndex(),"Text");Z.setTextStyle(j),Z.drawText(t,h)}}function _e(Pt,t,c,h,S,P,B){let j=!1;const Z=c.getImage();if(Z){const nt=Z.getImageState();nt==Te.A.LOADED||nt==Te.A.ERROR?Z.unlistenImageChange(S):(nt==Te.A.IDLE&&Z.load(),Z.listenImageChange(S),j=!0)}return Ne(Pt,t,c,h,P,B),j}function Ne(Pt,t,c,h,S,P){const B=c.getGeometryFunction()(t);if(!B)return;const j=B.simplifyTransformed(h,S);if(c.getRenderer())Ee(Pt,j,c,t);else{const nt=vt[j.getType()];nt(Pt,j,c,t,P)}}function Ee(Pt,t,c,h){if(t.getType()=="GeometryCollection"){const P=t.getGeometries();for(let B=0,j=P.length;B<j;++B)Ee(Pt,P[B],c,h);return}Pt.getBuilder(c.getZIndex(),"Default").drawCustom(t,h,c.getRenderer(),c.getHitDetectionRenderer())}function Ze(Pt,t,c,h,S){const P=t.getGeometriesArray();let B,j;for(B=0,j=P.length;B<j;++B){const Z=vt[P[B].getType()];Z(Pt,P[B],c,h,S)}}function Ge(Pt,t,c,h,S){const P=c.getStroke();if(P){const j=Pt.getBuilder(c.getZIndex(),"LineString");j.setFillStrokeStyle(null,P),j.drawLineString(t,h)}const B=c.getText();if(B&&B.getText()){const j=(S||Pt).getBuilder(c.getZIndex(),"Text");j.setTextStyle(B),j.drawText(t,h)}}function He(Pt,t,c,h,S){const P=c.getStroke();if(P){const j=Pt.getBuilder(c.getZIndex(),"LineString");j.setFillStrokeStyle(null,P),j.drawMultiLineString(t,h)}const B=c.getText();if(B&&B.getText()){const j=(S||Pt).getBuilder(c.getZIndex(),"Text");j.setTextStyle(B),j.drawText(t,h)}}function Bt(Pt,t,c,h,S){const P=c.getFill(),B=c.getStroke();if(B||P){const Z=Pt.getBuilder(c.getZIndex(),"Polygon");Z.setFillStrokeStyle(P,B),Z.drawMultiPolygon(t,h)}const j=c.getText();if(j&&j.getText()){const Z=(S||Pt).getBuilder(c.getZIndex(),"Text");Z.setTextStyle(j),Z.drawText(t,h)}}function xe(Pt,t,c,h,S){const P=c.getImage(),B=c.getText();let j;if(P){if(P.getImageState()!=Te.A.LOADED)return;let Z=Pt;if(S){const lt=P.getDeclutterMode();if(lt!=="none")if(Z=S,lt==="obstacle"){const dt=Pt.getBuilder(c.getZIndex(),"Image");dt.setImageStyle(P,j),dt.drawPoint(t,h)}else B&&B.getText()&&(j={})}const nt=Z.getBuilder(c.getZIndex(),"Image");nt.setImageStyle(P,j),nt.drawPoint(t,h)}if(B&&B.getText()){let Z=Pt;S&&(Z=S);const nt=Z.getBuilder(c.getZIndex(),"Text");nt.setTextStyle(B,j),nt.drawText(t,h)}}function re(Pt,t,c,h,S){const P=c.getImage(),B=c.getText();let j;if(P){if(P.getImageState()!=Te.A.LOADED)return;let Z=Pt;if(S){const lt=P.getDeclutterMode();if(lt!=="none")if(Z=S,lt==="obstacle"){const dt=Pt.getBuilder(c.getZIndex(),"Image");dt.setImageStyle(P,j),dt.drawMultiPoint(t,h)}else B&&B.getText()&&(j={})}const nt=Z.getBuilder(c.getZIndex(),"Image");nt.setImageStyle(P,j),nt.drawMultiPoint(t,h)}if(B&&B.getText()){let Z=Pt;S&&(Z=S);const nt=Z.getBuilder(c.getZIndex(),"Text");nt.setTextStyle(B,j),nt.drawText(t,h)}}function Me(Pt,t,c,h,S){const P=c.getFill(),B=c.getStroke();if(P||B){const Z=Pt.getBuilder(c.getZIndex(),"Polygon");Z.setFillStrokeStyle(P,B),Z.drawPolygon(t,h)}const j=c.getText();if(j&&j.getText()){const Z=(S||Pt).getBuilder(c.getZIndex(),"Text");Z.setTextStyle(j),Z.drawText(t,h)}}var ve=r(22796),oe=r(6933);class pe extends o.A{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,E.S5)(),this.wrappedRenderedExtent_=(0,E.S5)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,c,h){const S=c.extent,P=c.viewState,B=P.center,j=P.resolution,Z=P.projection,nt=P.rotation,lt=Z.getExtent(),dt=this.getLayer().getSource(),ft=c.pixelRatio,Rt=c.viewHints,At=!(Rt[Jt.A.ANIMATING]||Rt[Jt.A.INTERACTING]),Mt=this.compositionContext_,Ct=Math.round(c.size[0]*ft),wt=Math.round(c.size[1]*ft),Wt=dt.getWrapX()&&Z.canWrapX(),Ut=Wt?(0,E.RG)(lt):null,jt=Wt?Math.ceil((S[2]-lt[2])/Ut)+1:1;let x=Wt?Math.floor((S[0]-lt[0])/Ut):0;do{const e=this.getRenderTransform(B,j,nt,ft,Ct,wt,x*Ut);t.execute(Mt,1,e,nt,At,void 0,h)}while(++x<jt)}setupCompositionContext_(){if(this.opacity_!==1){const t=(0,Yt.Y)(this.context.canvas.width,this.context.canvas.height,o.B);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,(0,Yt.Yg)(this.compositionContext_),o.B.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,c){const h=t.pixelRatio,S=t.layerStatesArray[t.layerIndex];(0,_.rQ)(this.pixelTransform,1/h,1/h),(0,_.T9)(this.inversePixelTransform,this.pixelTransform);const P=(0,_.dI)(this.pixelTransform);this.useContainer(c,P,this.getBackground(t));const B=this.context,j=B.canvas,Z=this.replayGroup_,nt=this.declutterExecutorGroup;if((!Z||Z.isEmpty())&&(!nt||nt.isEmpty()))return null;const lt=Math.round(t.size[0]*h),dt=Math.round(t.size[1]*h);j.width!=lt||j.height!=dt?(j.width=lt,j.height=dt,j.style.transform!==P&&(j.style.transform=P)):this.containerReused||B.clearRect(0,0,lt,dt),this.preRender(B,t);const ft=t.viewState,Rt=ft.projection;this.opacity_=S.opacity,this.setupCompositionContext_();let At=!1,Mt=!0;if(S.extent&&this.clipping){const Ct=(0,ve.SD)(S.extent,Rt);Mt=(0,E.HY)(Ct,t.extent),At=Mt&&!(0,E.ms)(Ct,t.extent),At&&this.clipUnrotated(this.compositionContext_,t,Ct)}return Mt&&this.renderWorlds(Z,t),At&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(B,t),this.renderedRotation_!==ft.rotation&&(this.renderedRotation_=ft.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(c=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const h=[this.context.canvas.width,this.context.canvas.height];(0,_.Bb)(this.pixelTransform,h);const S=this.renderedCenter_,P=this.renderedResolution_,B=this.renderedRotation_,j=this.renderedProjection_,Z=this.wrappedRenderedExtent_,nt=this.getLayer(),lt=[],dt=h[0]*ue,ft=h[1]*ue;lt.push(this.getRenderTransform(S,P,B,ue,dt,ft,0).slice());const Rt=nt.getSource(),At=j.getExtent();if(Rt.getWrapX()&&j.canWrapX()&&!(0,E.ms)(At,Z)){let Mt=Z[0];const Ct=(0,E.RG)(At);let wt=0,Wt;for(;Mt<At[0];)--wt,Wt=Ct*wt,lt.push(this.getRenderTransform(S,P,B,ue,dt,ft,Wt).slice()),Mt+=Ct;for(wt=0,Mt=Z[2];Mt>At[2];)++wt,Wt=Ct*wt,lt.push(this.getRenderTransform(S,P,B,ue,dt,ft,Wt).slice()),Mt-=Ct}this.hitDetectionImageData_=Re(h,lt,this.renderedFeatures_,nt.getStyleFunction(),Z,P,B)}c(De(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,c,h,S,P){if(!this.replayGroup_)return;const B=c.viewState.resolution,j=c.viewState.rotation,Z=this.getLayer(),nt={},lt=function(Rt,At,Mt){const Ct=(0,et.v6)(Rt),wt=nt[Ct];if(wt){if(wt!==!0&&Mt<wt.distanceSq){if(Mt===0)return nt[Ct]=!0,P.splice(P.lastIndexOf(wt),1),S(Rt,Z,At);wt.geometry=At,wt.distanceSq=Mt}}else{if(Mt===0)return nt[Ct]=!0,S(Rt,Z,At);P.push(nt[Ct]={feature:Rt,layer:Z,geometry:At,distanceSq:Mt,callback:S})}};let dt;const ft=[this.replayGroup_];return this.declutterExecutorGroup&&ft.push(this.declutterExecutorGroup),ft.some(Rt=>dt=Rt.forEachFeatureAtCoordinate(t,B,j,h,lt,Rt===this.declutterExecutorGroup&&c.declutterTree?c.declutterTree.all().map(At=>At.value):null)),dt}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const c=this.getLayer(),h=c.getSource();if(!h)return!1;const S=t.viewHints[Jt.A.ANIMATING],P=t.viewHints[Jt.A.INTERACTING],B=c.getUpdateWhileAnimating(),j=c.getUpdateWhileInteracting();if(this.ready&&!B&&S||!j&&P)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const Z=t.extent,nt=t.viewState,lt=nt.projection,dt=nt.resolution,ft=t.pixelRatio,Rt=c.getRevision(),At=c.getRenderBuffer();let Mt=c.getRenderOrder();Mt===void 0&&(Mt=Oe);const Ct=nt.center.slice(),wt=(0,E.r)(Z,At*dt),Wt=wt.slice(),Ut=[wt.slice()],jt=lt.getExtent();if(h.getWrapX()&&lt.canWrapX()&&!(0,E.ms)(jt,t.extent)){const _t=(0,E.RG)(jt),Ft=Math.max((0,E.RG)(wt)/2,_t);wt[0]=jt[0]-Ft,wt[2]=jt[2]+Ft,(0,oe.Li)(Ct,lt);const It=(0,E.Li)(Ut[0],lt);It[0]<jt[0]&&It[2]<jt[2]?Ut.push([It[0]+_t,It[1],It[2]+_t,It[3]]):It[0]>jt[0]&&It[2]>jt[2]&&Ut.push([It[0]-_t,It[1],It[2]-_t,It[3]])}if(this.ready&&this.renderedResolution_==dt&&this.renderedRevision_==Rt&&this.renderedRenderOrder_==Mt&&(0,E.ms)(this.wrappedRenderedExtent_,wt))return(0,u.aI)(this.renderedExtent_,Wt)||(this.hitDetectionImageData_=null,this.renderedExtent_=Wt),this.renderedCenter_=Ct,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new n(ae(dt,ft),wt,dt,ft);let e;this.getLayer().getDeclutter()&&(e=new n(ae(dt,ft),wt,dt,ft));const F=(0,ve.Tf)();let G;if(F){for(let _t=0,Ft=Ut.length;_t<Ft;++_t){const It=Ut[_t],Kt=(0,ve.JR)(It,lt);h.loadFeatures(Kt,(0,ve.vN)(dt,lt),F)}G=(0,ve.FO)(F,lt)}else for(let _t=0,Ft=Ut.length;_t<Ft;++_t)h.loadFeatures(Ut[_t],dt,lt);const $=kt(dt,ft);let ot=!0;const xt=_t=>{let Ft;const It=_t.getStyleFunction()||c.getStyleFunction();if(It&&(Ft=It(_t,dt)),Ft){const Kt=this.renderFeature(_t,$,Ft,x,G,e);ot=ot&&!Kt}},Ot=(0,ve.JR)(wt,lt),Lt=h.getFeaturesInExtent(Ot);Mt&&Lt.sort(Mt);for(let _t=0,Ft=Lt.length;_t<Ft;++_t)xt(Lt[_t]);this.renderedFeatures_=Lt,this.ready=ot;const Tt=x.finish(),mt=new se(wt,dt,ft,h.getOverlaps(),Tt,c.getRenderBuffer());return e&&(this.declutterExecutorGroup=new se(wt,dt,ft,h.getOverlaps(),e.finish(),c.getRenderBuffer())),this.renderedResolution_=dt,this.renderedRevision_=Rt,this.renderedRenderOrder_=Mt,this.renderedExtent_=Wt,this.wrappedRenderedExtent_=wt,this.renderedCenter_=Ct,this.renderedProjection_=lt,this.replayGroup_=mt,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,c,h,S,P,B){if(!h)return!1;let j=!1;if(Array.isArray(h))for(let Z=0,nt=h.length;Z<nt;++Z)j=_e(S,t,h[Z],c,this.boundHandleStyleImageChange_,P,B)||j;else j=_e(S,t,h,c,this.boundHandleStyleImageChange_,P,B);return j}}const Ce=pe},38111:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>W});var U=r(75332),L=r(5986),Y=r(9960),X=r(83984),I=r(9777),C=r(9703);class v extends L.A{constructor(a,E){super(a),E=E||{},this.inversePixelTransform_=(0,C.vt)(),this.pixelContext_=null,this.postProcesses_=E.postProcesses,this.uniforms_=E.uniforms,this.helper,a.addChangeListener(U.A.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(a,E){const p=this.getLayer();if(p.hasListener(X.A.PRECOMPOSE)){const u=new Y.A(X.A.PRECOMPOSE,void 0,E,a);p.dispatchEvent(u)}}dispatchPostComposeEvent(a,E){const p=this.getLayer();if(p.hasListener(X.A.POSTCOMPOSE)){const u=new Y.A(X.A.POSTCOMPOSE,void 0,E,a);p.dispatchEvent(u)}}reset(a){this.uniforms_=a.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(a){if(this.getLayer().getRenderSource()){let E=!0,p=-1,u;for(let f=0,A=a.layerStatesArray.length;f<A;f++){const M=a.layerStatesArray[f].layer,m=M.getRenderer();if(!(m instanceof v)){E=!0;continue}const g=M.getClassName();if((E||g!==u)&&(p+=1,E=!1),u=g,m===this)break}const z="map/"+a.mapId+"/group/"+p;(!this.helper||!this.helper.canvasCacheKeyMatches(z))&&(this.removeHelper(),this.helper=new I.Ay({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:z}),u&&(this.helper.getCanvas().className=u),this.afterHelperCreated())}return this.prepareFrameInternal(a)}afterHelperCreated(){}prepareFrameInternal(a){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(a,E,p){const u=this.getLayer();if(u.hasListener(a)){(0,C.Zz)(this.inversePixelTransform_,0,0,p.pixelRatio,-p.pixelRatio,0,0,-p.size[1]);const z=new Y.A(a,this.inversePixelTransform_,p,E);u.dispatchEvent(z)}}preRender(a,E){this.dispatchRenderEvent_(X.A.PRERENDER,a,E)}postRender(a,E){this.dispatchRenderEvent_(X.A.POSTRENDER,a,E)}}const W=v},89990:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>l});var U=r(26469),L=r(88280),Y=r(62703),X=r(20259),I=r(38111),C=r(66514);const v=new Uint8Array(4);class W{constructor(n,o){this.helper_=n;const _=n.getGL();this.texture_=_.createTexture(),this.framebuffer_=_.createFramebuffer(),this.size_=o||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(n){(0,C.aI)(n,this.size_)||(this.size_[0]=n[0],this.size_[1]=n[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const n=this.size_,o=this.helper_.getGL();o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer_),o.readPixels(0,0,n[0],n[1],o.RGBA,o.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(n,o){if(n<0||o<0||n>this.size_[0]||o>=this.size_[1])return v[0]=0,v[1]=0,v[2]=0,v[3]=0,v;this.readAll();const _=Math.floor(n)+(this.size_[1]-Math.floor(o)-1)*this.size_[0];return v[0]=this.data_[_*4],v[1]=this.data_[_*4+1],v[2]=this.data_[_*4+2],v[3]=this.data_[_*4+3],v}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}updateSize_(){const n=this.size_,o=this.helper_.getGL();this.texture_=this.helper_.createTexture(n,null,this.texture_),o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer_),o.viewport(0,0,n[0],n[1]),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(n[0]*n[1]*4)}}const d=W;var a=r(90130),E=r(9777);const p={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};var u=r(9703),z=r(90588),f=r(70915),A=r(66570);const M=null,m={vertexPosition:0,indexPosition:0};function g(s,n,o,_,D){s[n+0]=o,s[n+1]=_,s[n+2]=D}function O(s,n,o,_,D,N){const rt=3+D,it=s[n+0],ct=s[n+1],gt=M;gt.length=D;for(let Gt=0;Gt<gt.length;Gt++)gt[Gt]=s[n+2+Gt];let yt=N?N.vertexPosition:0,pt=N?N.indexPosition:0;const Dt=yt/rt;return g(o,yt,it,ct,0),gt.length&&o.set(gt,yt+3),yt+=rt,g(o,yt,it,ct,1),gt.length&&o.set(gt,yt+3),yt+=rt,g(o,yt,it,ct,2),gt.length&&o.set(gt,yt+3),yt+=rt,g(o,yt,it,ct,3),gt.length&&o.set(gt,yt+3),yt+=rt,_[pt++]=Dt,_[pt++]=Dt+1,_[pt++]=Dt+3,_[pt++]=Dt+1,_[pt++]=Dt+2,_[pt++]=Dt+3,m.vertexPosition=yt,m.indexPosition=pt,m}function b(s,n,o,_,D,N,V,H,rt,it){const gt=5+H.length,yt=N.length/gt,pt=[s[n+0],s[n+1]],Dt=[s[o],s[o+1]],Gt=applyTransform(it,[...pt]),$t=applyTransform(it,[...Dt]);function te(ee,se,Jt){return Math.round(se*1500)+Math.round(Jt*1500)*1e4+ee*1e4*1e4}function Yt(ee,se,Jt){const qt=Math.sqrt((se[0]-ee[0])*(se[0]-ee[0])+(se[1]-ee[1])*(se[1]-ee[1])),fe=[(se[0]-ee[0])/qt,(se[1]-ee[1])/qt],ce=[-fe[1],fe[0]],Qt=Math.sqrt((Jt[0]-ee[0])*(Jt[0]-ee[0])+(Jt[1]-ee[1])*(Jt[1]-ee[1])),ue=[(Jt[0]-ee[0])/Qt,(Jt[1]-ee[1])/Qt],Re=qt===0||Qt===0?0:Math.acos(clamp(ue[0]*fe[0]+ue[1]*fe[1],-1,1));return ue[0]*ce[0]+ue[1]*ce[1]>0?Re:Math.PI*2-Re}const Zt=_!==null,ye=D!==null;let Ht=0,ie=0;if(Zt){const ee=[s[_],s[_+1]],se=applyTransform(it,[...ee]);Ht=Yt(Gt,$t,se)}if(ye){const ee=[s[D],s[D+1]],se=applyTransform(it,[...ee]);ie=Yt($t,Gt,se)}N.push(pt[0],pt[1],Dt[0],Dt[1],te(0,Ht,ie)),N.push(...H),N.push(pt[0],pt[1],Dt[0],Dt[1],te(1,Ht,ie)),N.push(...H),N.push(pt[0],pt[1],Dt[0],Dt[1],te(2,Ht,ie)),N.push(...H),N.push(pt[0],pt[1],Dt[0],Dt[1],te(3,Ht,ie)),N.push(...H),V.push(yt,yt+1,yt+2,yt+1,yt+3,yt+2)}function q(s,n,o,_,D){const V=2+D;let H=n;const rt=s.slice(H,H+D);H+=D;const it=s[H++];let ct=0;const gt=new Array(it-1);for(let Dt=0;Dt<it;Dt++)ct+=s[H++],Dt<it-1&&(gt[Dt]=ct);const yt=s.slice(H,H+ct*2),pt=earcut(yt,gt,2);for(let Dt=0;Dt<pt.length;Dt++)_.push(pt[Dt]+o.length/V);for(let Dt=0;Dt<yt.length;Dt+=2)o.push(yt[Dt],yt[Dt+1],...rt);return H+ct*2}function ht(){const n=document.createElement("canvas").getContext("2d").createImageData(1,1);return n.data[0]=255,n.data[1]=255,n.data[2]=255,n.data[3]=255,n}function et(s,n){n=n||[];const o=256,_=o-1;return n[0]=Math.floor(s/o/o/o)/_,n[1]=Math.floor(s/o/o)%o/_,n[2]=Math.floor(s/o)%o/_,n[3]=s%o/_,n}function J(s){let n=0;const o=256,_=o-1;return n+=Math.round(s[0]*o*o*o*_),n+=Math.round(s[1]*o*o*_),n+=Math.round(s[2]*o*_),n+=Math.round(s[3]*_),n}var R=r(48287).Buffer;function T(){const s='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS",r={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:\'`renderMode` must be `"hybrid"` or `"vector"`\',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class o extends Error{constructor(e){const t=r[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}var i=o;function a(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function s(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new i(t)}(0!==n,32);const o=t[0],a=t[1],s=t[2],u=t[3],f=t[4],x=t[5];return e[0]=u/n,e[1]=-a/n,e[2]=-s/n,e[3]=o/n,e[4]=(s*x-u*f)/n,e[5]=-(o*x-a*f)/n,e}function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}new Array(6);var f={exports:{}};function x(e,t,n){n=n||2;var r,o,i,a,s,u,f,x=t&&t.length,h=x?t[0]*n:e.length,v=l(e,0,h,n,!0),d=[];if(!v||v.next===v.prev)return d;if(x&&(v=function(e,t,n,r){var o,i,a,s=[];for(o=0,i=t.length;o<i;o++)(a=l(e,t[o]*r,o<i-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(A(a));for(s.sort(b),o=0;o<s.length;o++)n=g(s[o],n);return n}(e,t,v,n)),e.length>80*n){r=i=e[0],o=a=e[1];for(var y=n;y<h;y+=n)(s=e[y])<r&&(r=s),(u=e[y+1])<o&&(o=u),s>i&&(i=s),u>a&&(a=u);f=0!==(f=Math.max(i-r,a-o))?32767/f:0}return c(v,d,n,r,o,f,0),d}function l(e,t,n,r,o){var i,a;if(o===P(e,t,n,r)>0)for(i=t;i<n;i+=r)a=k(i,e[i],e[i+1],a);else for(i=n-r;i>=t;i-=r)a=k(i,e[i],e[i+1],a);return a&&F(a,a.next)&&(R(a),a=a.next),a}function h(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!F(r,r.next)&&0!==Z(r.prev,r,r.next))r=r.next;else{if(R(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function c(e,t,n,r,o,i,a){if(e){!a&&i&&function(e,t,n,r){var o=e;do{0===o.z&&(o.z=w(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,a,s,u,f=1;do{for(n=e,e=null,i=null,a=0;n;){for(a++,r=n,s=0,t=0;t<f&&(s++,r=r.nextZ);t++);for(u=f;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,s--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,f*=2}while(a>1)}(o)}(e,r,o,i);for(var s,u,f=e;e.prev!==e.next;)if(s=e.prev,u=e.next,i?d(e,r,o,i):v(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(u.i/n|0),R(e),e=u.next,f=u.next;else if((e=u)===f){a?1===a?c(e=y(h(e),t,n),t,n,r,o,i,2):2===a&&p(e,t,n,r,o,i):c(h(e),t,n,r,o,i,1);break}}}function v(e){var t=e.prev,n=e,r=e.next;if(Z(t,n,r)>=0)return!1;for(var o=t.x,i=n.x,a=r.x,s=t.y,u=n.y,f=r.y,x=o<i?o<a?o:a:i<a?i:a,l=s<u?s<f?s:f:u<f?u:f,h=o>i?o>a?o:a:i>a?i:a,c=s>u?s>f?s:f:u>f?u:f,v=r.next;v!==t;){if(v.x>=x&&v.x<=h&&v.y>=l&&v.y<=c&&E(o,s,i,u,a,f,v.x,v.y)&&Z(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function d(e,t,n,r){var o=e.prev,i=e,a=e.next;if(Z(o,i,a)>=0)return!1;for(var s=o.x,u=i.x,f=a.x,x=o.y,l=i.y,h=a.y,c=s<u?s<f?s:f:u<f?u:f,v=x<l?x<h?x:h:l<h?l:h,d=s>u?s>f?s:f:u>f?u:f,y=x>l?x>h?x:h:l>h?l:h,p=w(c,v,t,n,r),b=w(d,y,t,n,r),g=e.prevZ,m=e.nextZ;g&&g.z>=p&&m&&m.z<=b;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&E(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,m.x>=c&&m.x<=d&&m.y>=v&&m.y<=y&&m!==o&&m!==a&&E(s,x,u,l,f,h,m.x,m.y)&&Z(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;g&&g.z>=p;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&E(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;m&&m.z<=b;){if(m.x>=c&&m.x<=d&&m.y>=v&&m.y<=y&&m!==o&&m!==a&&E(s,x,u,l,f,h,m.x,m.y)&&Z(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function y(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;!F(o,i)&&T(o,r,r.next,i)&&z(o,i)&&z(i,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),R(r),R(r.next),r=e=i),r=r.next}while(r!==e);return h(r)}function p(e,t,n,r,o,i){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&M(a,s)){var u=U(a,s);return a=h(a,a.next),u=h(u,u.next),c(a,t,n,r,o,i,0),void c(u,t,n,r,o,i,0)}s=s.next}a=a.next}while(a!==e)}function b(e,t){return e.x-t.x}function g(e,t){var n=function(e,t){var n,r=t,o=e.x,i=e.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=o&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===o))return n}r=r.next}while(r!==t);if(!n)return null;var u,f=n,x=n.x,l=n.y,h=1/0;r=n;do{o>=r.x&&r.x>=x&&o!==r.x&&E(i<l?o:a,i,x,l,i<l?a:o,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(o-r.x),z(r,e)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&m(n,r)))&&(n=r,h=u)),r=r.next}while(r!==f);return n}(e,t);if(!n)return t;var r=U(n,e);return h(r,r.next),h(n,n.next)}function m(e,t){return Z(e.prev,e,t.prev)<0&&Z(t.next,e,e.next)<0}function w(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function A(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function E(e,t,n,r,o,i,a,s){return(o-a)*(t-s)>=(e-a)*(i-s)&&(e-a)*(r-s)>=(n-a)*(t-s)&&(n-a)*(i-s)>=(o-a)*(r-s)}function M(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&T(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(z(e,t)&&z(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Z(e.prev,e,t.prev)||Z(e,t.prev,t))||F(e,t)&&Z(e.prev,e,e.next)>0&&Z(t.prev,t,t.next)>0)}function Z(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function F(e,t){return e.x===t.x&&e.y===t.y}function T(e,t,n,r){var o=S(Z(e,t,n)),i=S(Z(e,t,r)),a=S(Z(n,r,e)),s=S(Z(n,r,t));return o!==i&&a!==s||(!(0!==o||!I(e,n,t))||(!(0!==i||!I(e,r,t))||(!(0!==a||!I(n,e,r))||!(0!==s||!I(n,t,r)))))}function I(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function S(e){return e>0?1:e<0?-1:0}function z(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function U(e,t){var n=new B(e.i,e.x,e.y),r=new B(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function k(e,t,n,r){var o=new B(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function R(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function B(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(e,t,n,r){for(var o=0,i=t,a=n-r;i<n;i+=r)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}f.exports=x,f.exports.default=x,x.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,a=Math.abs(P(e,0,i,n));if(o)for(var s=0,u=t.length;s<u;s++){var f=t[s]*n,x=s<u-1?t[s+1]*n:e.length;a-=Math.abs(P(e,f,x,n))}var l=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,c=r[s+1]*n,v=r[s+2]*n;l+=Math.abs((e[h]-e[v])*(e[c+1]-e[h+1])-(e[h]-e[c])*(e[v+1]-e[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},x.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;a<t;a++)n.vertices.push(e[o][i][a]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};var N=u(f.exports);const _=[],O={vertexPosition:0,indexPosition:0};function q(e,t,n,r,o){e[t+0]=n,e[t+1]=r,e[t+2]=o}function L(e,t,n,r,o,i){const a=3+o,s=e[t+0],u=e[t+1],f=_;f.length=o;for(let n=0;n<f.length;n++)f[n]=e[t+2+n];let x=i?i.vertexPosition:0,l=i?i.indexPosition:0;const h=x/a;return q(n,x,s,u,0),f.length&&n.set(f,x+3),x+=a,q(n,x,s,u,1),f.length&&n.set(f,x+3),x+=a,q(n,x,s,u,2),f.length&&n.set(f,x+3),x+=a,q(n,x,s,u,3),f.length&&n.set(f,x+3),x+=a,r[l++]=h,r[l++]=h+1,r[l++]=h+3,r[l++]=h+1,r[l++]=h+2,r[l++]=h+3,O.vertexPosition=x,O.indexPosition=l,O}function C(e,t,n,r,o,i,s,u,f,x){const l=5+u.length,h=i.length/l,c=[e[t+0],e[t+1]],v=[e[n],e[n+1]],d=a(x,[...c]),y=a(x,[...v]);function p(e,t,n){const r=1e4;return Math.round(1500*t)+Math.round(1500*n)*r+e*r*r}function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),o=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-o[1],o[0]],a=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),s=[(n[0]-e[0])/a,(n[1]-e[1])/a],u=0===r||0===a?0:Math.acos((f=s[0]*o[0]+s[1]*o[1],x=-1,l=1,Math.min(Math.max(f,x),l)));var f,x,l;return s[0]*i[0]+s[1]*i[1]>0?u:2*Math.PI-u}const g=null!==o;let m=0,w=0;if(null!==r){m=b(d,y,a(x,[...[e[r],e[r+1]]]))}if(g){w=b(y,d,a(x,[...[e[o],e[o+1]]]))}i.push(c[0],c[1],v[0],v[1],p(0,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(1,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(2,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(3,m,w)),i.push(...u),s.push(h,h+1,h+2,h+1,h+3,h+2)}function G(e,t,n,r,o){const i=2+o;let a=t;const s=e.slice(a,a+o);a+=o;const u=e[a++];let f=0;const x=new Array(u-1);for(let t=0;t<u;t++)f+=e[a++],t<u-1&&(x[t]=f);const l=e.slice(a,a+2*f),h=N(l,x,2);for(let e=0;e<h.length;e++)r.push(h[e]+n.length/i);for(let e=0;e<l.length;e+=2)n.push(l[e],l[e+1],...s);return a+2*f}const j=self;j.onmessage=r=>{const o=r.data;switch(o.type){case t:{const e=3,t=2,n=o.customAttributesSize,r=t+n,i=new Float32Array(o.renderInstructions),a=i.length/r,s=4*a*(n+e),u=new Uint32Array(6*a),f=new Float32Array(s);let x;for(let e=0;e<i.length;e+=r)x=L(i,e,f,u,n,x);const l=Object.assign({vertexBuffer:f.buffer,indexBuffer:u.buffer,renderInstructions:i.buffer},o);j.postMessage(l,[f.buffer,u.buffer,i.buffer]);break}case n:{const e=[],t=[],n=o.customAttributesSize,r=2,i=new Float32Array(o.renderInstructions);let a=0;const u=o.renderInstructionsTransform,f=[1,0,0,1,0,0];let x,l;for(s(f,u);a<i.length;){l=Array.from(i.slice(a,a+n)),a+=n,x=i[a++];for(let n=0;n<x-1;n++)C(i,a+n*r,a+(n+1)*r,n>0?a+(n-1)*r:null,n<x-2?a+(n+2)*r:null,e,t,l,0,f);a+=x*r}const h=Uint32Array.from(t),c=Float32Array.from(e),v=Object.assign({vertexBuffer:c.buffer,indexBuffer:h.buffer,renderInstructions:i.buffer},o);j.postMessage(v,[c.buffer,h.buffer,i.buffer]);break}case e:{const e=[],t=[],n=o.customAttributesSize,r=new Float32Array(o.renderInstructions);let i=0;for(;i<r.length;)i=G(r,i,e,t,n);const a=Uint32Array.from(t),s=Float32Array.from(e),u=Object.assign({vertexBuffer:s.buffer,indexBuffer:a.buffer,renderInstructions:r.buffer},o);j.postMessage(u,[s.buffer,a.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+R.from(s,"binary").toString("base64"):URL.createObjectURL(new Blob([s],{type:"application/javascript"})))}var K=r(4087),Q=r(9438);class st extends I.A{constructor(n,o){const _=o.uniforms||{},D=(0,u.vt)();_[E.M8.PROJECTION_MATRIX]=D,super(n,{uniforms:_,postProcesses:o.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new X.Ay(a.H7,a.Be),this.hitVerticesBuffer_=new X.Ay(a.H7,a.Be),this.indicesBuffer_=new X.Ay(a.IP,a.Be),this.vertexShader_=o.vertexShader,this.fragmentShader_=o.fragmentShader,this.program_,this.hitDetectionEnabled_=!!(o.hitFragmentShader&&o.hitVertexShader),this.hitVertexShader_=o.hitVertexShader,this.hitFragmentShader_=o.hitFragmentShader,this.hitProgram_;const N=o.attributes?o.attributes.map(function(H){return{name:"a_"+H.name,size:1,type:E.jQ.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:E.jQ.FLOAT},{name:"a_index",size:1,type:E.jQ.FLOAT}].concat(N),this.hitDetectionAttributes=[{name:"a_position",size:2,type:E.jQ.FLOAT},{name:"a_index",size:1,type:E.jQ.FLOAT},{name:"a_hitColor",size:4,type:E.jQ.FLOAT},{name:"a_featureUid",size:1,type:E.jQ.FLOAT}].concat(N),this.customAttributes=o.attributes?o.attributes:[],this.previousExtent_=(0,f.S5)(),this.currentTransform_=D,this.renderTransform_=(0,u.vt)(),this.invertRenderTransform_=(0,u.vt)(),this.renderInstructions_=new Float32Array(0),this.hitRenderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.lastSentId=0,this.worker_=T(),this.worker_.addEventListener("message",H=>{const rt=H.data;if(rt.type===p.GENERATE_POINT_BUFFERS){const it=rt.projectionTransform;rt.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(rt.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(rt.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(rt.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=it,(0,u.T9)(this.invertRenderTransform_,this.renderTransform_),rt.hitDetection?this.hitRenderInstructions_=new Float32Array(H.data.renderInstructions):(this.renderInstructions_=new Float32Array(H.data.renderInstructions),rt.id===this.lastSentId&&(this.ready=!0)),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const V=this.getLayer().getSource();this.sourceListenKeys_=[(0,Q.KT)(V,L.A.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,Q.KT)(V,L.A.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,Q.KT)(V,L.A.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,Q.KT)(V,L.A.CLEAR,this.handleSourceFeatureClear_,this)],V.forEachFeature(H=>{this.featureCache_[(0,K.v6)(H)]={feature:H,properties:H.getProperties(),geometry:H.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new d(this.helper))}handleSourceFeatureAdded_(n){const o=n.feature;this.featureCache_[(0,K.v6)(o)]={feature:o,properties:o.getProperties(),geometry:o.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(n){const o=n.feature;this.featureCache_[(0,K.v6)(o)]={feature:o,properties:o.getProperties(),geometry:o.getGeometry()}}handleSourceFeatureDelete_(n){const o=n.feature;delete this.featureCache_[(0,K.v6)(o)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(n){const o=this.helper.getGL();this.preRender(o,n);const _=n.viewState.projection,V=this.getLayer().getSource().getWrapX()&&_.canWrapX(),H=_.getExtent(),rt=n.extent,it=V?(0,f.RG)(H):null,ct=V?Math.ceil((rt[2]-H[2])/it)+1:1,gt=V?Math.floor((rt[0]-H[0])/it):0;let yt=gt;const pt=this.indicesBuffer_.getSize();do this.helper.makeProjectionTransform(n,this.currentTransform_),(0,u.Tl)(this.currentTransform_,yt*it,0),(0,u.lw)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(n),this.helper.drawElements(0,pt);while(++yt<ct);this.helper.finalizeDraw(n,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const Dt=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(n,gt,ct,it),this.hitRenderTarget_.clearCachedData()),this.postRender(o,n),Dt}prepareFrameInternal(n){const o=this.getLayer(),_=o.getSource(),D=n.viewState,N=!n.viewHints[Y.A.ANIMATING]&&!n.viewHints[Y.A.INTERACTING],V=!(0,f.aI)(this.previousExtent_,n.extent),H=this.sourceRevision_<_.getRevision();if(H&&(this.sourceRevision_=_.getRevision()),N&&(V||H)){const rt=D.projection,it=D.resolution,ct=o instanceof U.A?o.getRenderBuffer():0,gt=(0,f.r)(n.extent,ct*it);_.loadFeatures(gt,it,rt),this.rebuildBuffers_(n),this.previousExtent_=n.extent.slice()}return this.helper.useProgram(this.program_,n),this.helper.prepareDraw(n),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(n){const o=(0,u.vt)();this.helper.makeProjectionTransform(n,o);const _=(2+this.customAttributes.length)*this.featureCount_;if((!this.renderInstructions_||this.renderInstructions_.length!==_)&&(this.renderInstructions_=new Float32Array(_)),this.hitDetectionEnabled_){const yt=(7+this.customAttributes.length)*this.featureCount_;(!this.hitRenderInstructions_||this.hitRenderInstructions_.length!==yt)&&(this.hitRenderInstructions_=new Float32Array(yt))}let D,N;const V=[],H=[];let rt=0,it=0,ct;for(const yt in this.featureCache_){if(D=this.featureCache_[yt],N=D.geometry,!N||N.getType()!=="Point")continue;V[0]=N.getFlatCoordinates()[0],V[1]=N.getFlatCoordinates()[1],(0,u.Bb)(o,V),ct=et(it+6,H),this.renderInstructions_[rt++]=V[0],this.renderInstructions_[rt++]=V[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[it++]=V[0],this.hitRenderInstructions_[it++]=V[1],this.hitRenderInstructions_[it++]=ct[0],this.hitRenderInstructions_[it++]=ct[1],this.hitRenderInstructions_[it++]=ct[2],this.hitRenderInstructions_[it++]=ct[3],this.hitRenderInstructions_[it++]=Number(yt));let pt;for(let Dt=0;Dt<this.customAttributes.length;Dt++)pt=this.customAttributes[Dt].callback(D.feature,D.properties),this.renderInstructions_[rt++]=pt,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[it++]=pt)}const gt={id:++this.lastSentId,type:p.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesSize:this.customAttributes.length};if(gt.projectionTransform=o,this.ready=!1,this.worker_.postMessage(gt,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){const yt={id:0,type:p.GENERATE_POINT_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesSize:5+this.customAttributes.length};yt.projectionTransform=o,yt.hitDetection=!0,this.worker_.postMessage(yt,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}}forEachFeatureAtCoordinate(n,o,_,D,N){if((0,z.v)(this.hitDetectionEnabled_,66),!this.hitRenderInstructions_)return;const V=(0,u.Bb)(o.coordinateToPixelTransform,n.slice()),H=this.hitRenderTarget_.readPixel(V[0]/2,V[1]/2),rt=[H[0]/255,H[1]/255,H[2]/255,H[3]/255],it=J(rt),ct=this.hitRenderInstructions_[it],gt=Math.floor(ct).toString(),pt=this.getLayer().getSource().getFeatureByUid(gt);if(pt)return D(pt,this.getLayer(),null)}renderHitDetection(n,o,_,D){if(!this.hitVerticesBuffer_.getSize())return;let N=o;this.hitRenderTarget_.setSize([Math.floor(n.size[0]/2),Math.floor(n.size[1]/2)]),this.helper.useProgram(this.hitProgram_,n),this.helper.prepareDrawToRenderTarget(n,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(n,this.currentTransform_),(0,u.Tl)(this.currentTransform_,N*D,0),(0,u.lw)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(n);const V=this.indicesBuffer_.getSize();this.helper.drawElements(0,V)}while(++N<_)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(n){(0,Q.JH)(n)}),this.sourceListenKeys_=null,super.disposeInternal()}}const l=st},33513:(Nt,at,r)=>{"use strict";r.d(at,{BV:()=>C,XX:()=>p,aY:()=>E});var U=r(70915),L=r(68711),Y=r(22796),X=r(61597);let I;const C=[];function v(u,z,f,A,M){u.beginPath(),u.moveTo(0,0),u.lineTo(z,f),u.lineTo(A,M),u.closePath(),u.save(),u.clip(),u.fillRect(0,0,Math.max(z,A)+1,Math.max(f,M)),u.restore()}function W(u,z){return Math.abs(u[z*4]-210)>2||Math.abs(u[z*4+3]-.75*255)>2}function d(){if(I===void 0){const u=(0,L.Y)(6,6,C);u.globalCompositeOperation="lighter",u.fillStyle="rgba(210, 0, 0, 0.75)",v(u,4,5,4,0),v(u,4,5,0,5);const z=u.getImageData(0,0,3,3).data;I=W(z,0)||W(z,4)||W(z,8),(0,L.Yg)(u),C.push(u.canvas)}return I}function a(u,z,f,A){const M=(0,Y.pd)(f,z,u);let m=(0,Y.hO)(z,A,f);const g=z.getMetersPerUnit();g!==void 0&&(m*=g);const O=u.getMetersPerUnit();O!==void 0&&(m/=O);const b=u.getExtent();if(!b||(0,U.Ym)(b,M)){const q=(0,Y.hO)(u,m,M)/m;isFinite(q)&&q>0&&(m/=q)}return m}function E(u,z,f,A){const M=(0,U.q1)(f);let m=a(u,z,M,A);return(!isFinite(m)||m<=0)&&(0,U.sB)(f,function(g){return m=a(u,z,g,A),isFinite(m)&&m>0}),m}function p(u,z,f,A,M,m,g,O,b,q,ht,et){const J=(0,L.Y)(Math.round(f*u),Math.round(f*z),C);if(et||(J.imageSmoothingEnabled=!1),b.length===0)return J.canvas;J.scale(f,f);function R(n){return Math.round(n*f)/f}J.globalCompositeOperation="lighter";const T=(0,U.S5)();b.forEach(function(n,o,_){(0,U.X$)(T,n.extent)});const K=(0,U.RG)(T),Q=(0,U.Oq)(T),st=(0,L.Y)(Math.round(f*K/A),Math.round(f*Q/A),C);et||(st.imageSmoothingEnabled=!1);const l=f/A;b.forEach(function(n,o,_){const D=n.extent[0]-T[0],N=-(n.extent[3]-T[3]),V=(0,U.RG)(n.extent),H=(0,U.Oq)(n.extent);n.image.width>0&&n.image.height>0&&st.drawImage(n.image,q,q,n.image.width-2*q,n.image.height-2*q,D*l,N*l,V*l,H*l)});const s=(0,U.Py)(g);return O.getTriangles().forEach(function(n,o,_){const D=n.source,N=n.target;let V=D[0][0],H=D[0][1],rt=D[1][0],it=D[1][1],ct=D[2][0],gt=D[2][1];const yt=R((N[0][0]-s[0])/m),pt=R(-(N[0][1]-s[1])/m),Dt=R((N[1][0]-s[0])/m),Gt=R(-(N[1][1]-s[1])/m),$t=R((N[2][0]-s[0])/m),te=R(-(N[2][1]-s[1])/m),Yt=V,Zt=H;V=0,H=0,rt-=Yt,it-=Zt,ct-=Yt,gt-=Zt;const ye=[[rt,it,0,0,Dt-yt],[ct,gt,0,0,$t-yt],[0,0,rt,it,Gt-pt],[0,0,ct,gt,te-pt]],Ht=(0,X.KU)(ye);if(Ht){if(J.save(),J.beginPath(),d()||!et){J.moveTo(Dt,Gt);const ie=4,ee=yt-Dt,se=pt-Gt;for(let Jt=0;Jt<ie;Jt++)J.lineTo(Dt+R((Jt+1)*ee/ie),Gt+R(Jt*se/(ie-1))),Jt!=ie-1&&J.lineTo(Dt+R((Jt+1)*ee/ie),Gt+R((Jt+1)*se/(ie-1)));J.lineTo($t,te)}else J.moveTo(Dt,Gt),J.lineTo(yt,pt),J.lineTo($t,te);J.clip(),J.transform(Ht[0],Ht[2],Ht[1],Ht[3],yt,pt),J.translate(T[0]-Yt,T[3]-Zt),J.scale(A/f,-A/f),J.drawImage(st.canvas,0,0),J.restore()}}),(0,L.Yg)(st),C.push(st.canvas),ht&&(J.save(),J.globalCompositeOperation="source-over",J.strokeStyle="black",J.lineWidth=1,O.getTriangles().forEach(function(n,o,_){const D=n.target,N=(D[0][0]-s[0])/m,V=-(D[0][1]-s[1])/m,H=(D[1][0]-s[0])/m,rt=-(D[1][1]-s[1])/m,it=(D[2][0]-s[0])/m,ct=-(D[2][1]-s[1])/m;J.beginPath(),J.moveTo(H,rt),J.lineTo(N,V),J.lineTo(it,ct),J.closePath(),J.stroke()}),J.restore()),J.canvas}},97404:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>p});var U=r(93101),L=r(6837),Y=r(8143),X=r(11078),I=r(52913),C=r(33513),v=r(61597),W=r(70915),d=r(9438),a=r(68711);class E extends Y.A{constructor(z,f,A,M,m,g,O,b,q,ht,et,J){super(m,X.A.IDLE,{interpolate:!!J}),this.renderEdges_=et!==void 0?et:!1,this.pixelRatio_=O,this.gutter_=b,this.canvas_=null,this.sourceTileGrid_=f,this.targetTileGrid_=M,this.wrappedTileCoord_=g||m,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const R=M.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let K=this.sourceTileGrid_.getExtent();const Q=T?(0,W._N)(R,T):R;if((0,W.UG)(Q)===0){this.state=X.A.EMPTY;return}const st=z.getExtent();st&&(K?K=(0,W._N)(K,st):K=st);const l=M.getResolution(this.wrappedTileCoord_[0]),s=(0,C.aY)(z,A,Q,l);if(!isFinite(s)||s<=0){this.state=X.A.EMPTY;return}const n=ht!==void 0?ht:U.l;if(this.triangulation_=new I.A(z,A,Q,K,s*n,l),this.triangulation_.getTriangles().length===0){this.state=X.A.EMPTY;return}this.sourceZ_=f.getZForResolution(s);let o=this.triangulation_.calculateSourceExtent();if(K&&(z.canWrapX()?(o[1]=(0,v.qE)(o[1],K[1],K[3]),o[3]=(0,v.qE)(o[3],K[1],K[3])):o=(0,W._N)(o,K)),!(0,W.UG)(o))this.state=X.A.EMPTY;else{const _=f.getTileRangeForExtentAndZ(o,this.sourceZ_);for(let D=_.minX;D<=_.maxX;D++)for(let N=_.minY;N<=_.maxY;N++){const V=q(this.sourceZ_,D,N,O);V&&this.sourceTiles_.push(V)}this.sourceTiles_.length===0&&(this.state=X.A.EMPTY)}}getImage(){return this.canvas_}reproject_(){const z=[];if(this.sourceTiles_.forEach(f=>{f&&f.getState()==X.A.LOADED&&z.push({extent:this.sourceTileGrid_.getTileCoordExtent(f.tileCoord),image:f.getImage()})}),this.sourceTiles_.length=0,z.length===0)this.state=X.A.ERROR;else{const f=this.wrappedTileCoord_[0],A=this.targetTileGrid_.getTileSize(f),M=typeof A=="number"?A:A[0],m=typeof A=="number"?A:A[1],g=this.targetTileGrid_.getResolution(f),O=this.sourceTileGrid_.getResolution(this.sourceZ_),b=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,C.XX)(M,m,this.pixelRatio_,O,this.sourceTileGrid_.getExtent(),g,b,this.triangulation_,z,this.gutter_,this.renderEdges_,this.interpolate),this.state=X.A.LOADED}this.changed()}load(){if(this.state==X.A.IDLE){this.state=X.A.LOADING,this.changed();let z=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(f=>{const A=f.getState();if(A==X.A.IDLE||A==X.A.LOADING){z++;const M=(0,d.KT)(f,L.A.CHANGE,function(m){const g=f.getState();(g==X.A.LOADED||g==X.A.ERROR||g==X.A.EMPTY)&&((0,d.JH)(M),z--,z===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(M)}}),z===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(f,A,M){f.getState()==X.A.IDLE&&f.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(d.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,a.Yg)(this.canvas_.getContext("2d")),C.BV.push(this.canvas_),this.canvas_=null),super.release()}}const p=E},52913:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>v});var U=r(70915),L=r(22796),Y=r(61597);const X=10,I=.25;class C{constructor(d,a,E,p,u,z){this.sourceProj_=d,this.targetProj_=a;let f={};const A=(0,L.RG)(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const T=R[0]+"/"+R[1];return f[T]||(f[T]=A(R)),f[T]},this.maxSourceExtent_=p,this.errorThresholdSquared_=u*u,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!p&&!!this.sourceProj_.getExtent()&&(0,U.RG)(p)>=(0,U.RG)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,U.RG)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,U.RG)(this.targetProj_.getExtent()):null;const M=(0,U.Py)(E),m=(0,U.WU)(E),g=(0,U.k_)(E),O=(0,U.R)(E),b=this.transformInv_(M),q=this.transformInv_(m),ht=this.transformInv_(g),et=this.transformInv_(O),J=X+(z?Math.max(0,Math.ceil(Math.log2((0,U.UG)(E)/(z*z*256*256)))):0);if(this.addQuad_(M,m,g,O,b,q,ht,et,J),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(T,K,Q){R=Math.min(R,T.source[0][0],T.source[1][0],T.source[2][0])}),this.triangles_.forEach(T=>{if(Math.max(T.source[0][0],T.source[1][0],T.source[2][0])-R>this.sourceWorldWidth_/2){const K=[[T.source[0][0],T.source[0][1]],[T.source[1][0],T.source[1][1]],[T.source[2][0],T.source[2][1]]];K[0][0]-R>this.sourceWorldWidth_/2&&(K[0][0]-=this.sourceWorldWidth_),K[1][0]-R>this.sourceWorldWidth_/2&&(K[1][0]-=this.sourceWorldWidth_),K[2][0]-R>this.sourceWorldWidth_/2&&(K[2][0]-=this.sourceWorldWidth_);const Q=Math.min(K[0][0],K[1][0],K[2][0]);Math.max(K[0][0],K[1][0],K[2][0])-Q<this.sourceWorldWidth_/2&&(T.source=K)}})}f={}}addTriangle_(d,a,E,p,u,z){this.triangles_.push({source:[p,u,z],target:[d,a,E]})}addQuad_(d,a,E,p,u,z,f,A,M){const m=(0,U.Tr)([u,z,f,A]),g=this.sourceWorldWidth_?(0,U.RG)(m)/this.sourceWorldWidth_:null,O=this.sourceWorldWidth_,b=this.sourceProj_.canWrapX()&&g>.5&&g<1;let q=!1;if(M>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const et=(0,U.Tr)([d,a,E,p]);q=(0,U.RG)(et)/this.targetWorldWidth_>I||q}!b&&this.sourceProj_.isGlobal()&&g&&(q=g>I||q)}if(!q&&this.maxSourceExtent_&&isFinite(m[0])&&isFinite(m[1])&&isFinite(m[2])&&isFinite(m[3])&&!(0,U.HY)(m,this.maxSourceExtent_))return;let ht=0;if(!q&&(!isFinite(u[0])||!isFinite(u[1])||!isFinite(z[0])||!isFinite(z[1])||!isFinite(f[0])||!isFinite(f[1])||!isFinite(A[0])||!isFinite(A[1]))){if(M>0)q=!0;else if(ht=(!isFinite(u[0])||!isFinite(u[1])?8:0)+(!isFinite(z[0])||!isFinite(z[1])?4:0)+(!isFinite(f[0])||!isFinite(f[1])?2:0)+(!isFinite(A[0])||!isFinite(A[1])?1:0),ht!=1&&ht!=2&&ht!=4&&ht!=8)return}if(M>0){if(!q){const et=[(d[0]+E[0])/2,(d[1]+E[1])/2],J=this.transformInv_(et);let R;b?R=((0,Y.xP)(u[0],O)+(0,Y.xP)(f[0],O))/2-(0,Y.xP)(J[0],O):R=(u[0]+f[0])/2-J[0];const T=(u[1]+f[1])/2-J[1];q=R*R+T*T>this.errorThresholdSquared_}if(q){if(Math.abs(d[0]-E[0])<=Math.abs(d[1]-E[1])){const et=[(a[0]+E[0])/2,(a[1]+E[1])/2],J=this.transformInv_(et),R=[(p[0]+d[0])/2,(p[1]+d[1])/2],T=this.transformInv_(R);this.addQuad_(d,a,et,R,u,z,J,T,M-1),this.addQuad_(R,et,E,p,T,J,f,A,M-1)}else{const et=[(d[0]+a[0])/2,(d[1]+a[1])/2],J=this.transformInv_(et),R=[(E[0]+p[0])/2,(E[1]+p[1])/2],T=this.transformInv_(R);this.addQuad_(d,et,R,p,u,J,T,A,M-1),this.addQuad_(et,a,E,R,J,z,f,T,M-1)}return}}if(b){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(ht&11)==0&&this.addTriangle_(d,E,p,u,f,A),(ht&14)==0&&this.addTriangle_(d,E,a,u,f,z),ht&&((ht&13)==0&&this.addTriangle_(a,p,d,z,A,u),(ht&7)==0&&this.addTriangle_(a,p,E,z,A,f))}calculateSourceExtent(){const d=(0,U.S5)();return this.triangles_.forEach(function(a,E,p){const u=a.source;(0,U.$C)(d,u[0]),(0,U.$C)(d,u[1]),(0,U.$C)(d,u[2])}),d}getTriangles(){return this.triangles_}}const v=C},93101:(Nt,at,r)=>{"use strict";r.d(at,{l:()=>U});const U=.5},24498:(Nt,at,r)=>{"use strict";r.d(at,{a$:()=>X,b8:()=>L,cq:()=>I,dv:()=>Y});var U=r(61597);function L(C){if(C!==void 0)return 0}function Y(C){if(C!==void 0)return C}function X(C){const v=2*Math.PI/C;return function(W,d){if(d)return W;if(W!==void 0)return W=Math.floor(W/v+.5)*v,W}}function I(C){return C=C||(0,U.eh)(5),function(v,W){if(W)return v;if(v!==void 0)return Math.abs(v)<=C?0:v}}},6782:(Nt,at,r)=>{"use strict";r.d(at,{Ie:()=>L,hs:()=>Y,xq:()=>X});function U(I,C,v){return v===void 0&&(v=[0,0]),v[0]=I[0]+2*C,v[1]=I[1]+2*C,v}function L(I){return I[0]>0&&I[1]>0}function Y(I,C,v){return v===void 0&&(v=[0,0]),v[0]=I[0]*C+.5|0,v[1]=I[1]*C+.5|0,v}function X(I,C){return Array.isArray(I)?I:(C===void 0?C=[I,I]:(C[0]=I,C[1]=I),C)}},88280:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>U});const U={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"}},14969:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y});var U=r(90588);class L{constructor(I){this.highWaterMark=I!==void 0?I:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(I){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(I){return this.entries_.hasOwnProperty(I)}forEach(I){let C=this.oldest_;for(;C;)I(C.value_,C.key_,this),C=C.newer}get(I,C){const v=this.entries_[I];return(0,U.v)(v!==void 0,15),v===this.newest_||(v===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(v.newer.older=v.older,v.older.newer=v.newer),v.newer=null,v.older=this.newest_,this.newest_.newer=v,this.newest_=v),v.value_}remove(I){const C=this.entries_[I];return(0,U.v)(C!==void 0,15),C===this.newest_?(this.newest_=C.older,this.newest_&&(this.newest_.newer=null)):C===this.oldest_?(this.oldest_=C.newer,this.oldest_&&(this.oldest_.older=null)):(C.newer.older=C.older,C.older.newer=C.newer),delete this.entries_[I],--this.count_,C.value_}getCount(){return this.count_}getKeys(){const I=new Array(this.count_);let C=0,v;for(v=this.newest_;v;v=v.older)I[C++]=v.key_;return I}getValues(){const I=new Array(this.count_);let C=0,v;for(v=this.newest_;v;v=v.older)I[C++]=v.value_;return I}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(I){if(this.containsKey(I))return this.entries_[I].value_}pop(){const I=this.oldest_;return delete this.entries_[I.key_],I.newer&&(I.newer.older=null),this.oldest_=I.newer,this.oldest_||(this.newest_=null),--this.count_,I.value_}replace(I,C){this.get(I),this.entries_[I].value_=C}set(I,C){(0,U.v)(!(I in this.entries_),16);const v={key_:I,newer:null,older:this.newest_,value_:C};this.newest_?this.newest_.newer=v:this.oldest_=v,this.newest_=v,this.entries_[I]=v,++this.count_}setSize(I){this.highWaterMark=I}}const Y=L},27733:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>Y});var U=r(86936);class L extends U.A{constructor(I){I=I||{radius:5},super({points:1/0,fill:I.fill,radius:I.radius,stroke:I.stroke,scale:I.scale!==void 0?I.scale:1,rotation:I.rotation!==void 0?I.rotation:0,rotateWithView:I.rotateWithView!==void 0?I.rotateWithView:!1,displacement:I.displacement!==void 0?I.displacement:[0,0],declutterMode:I.declutterMode})}clone(){const I=this.getScale(),C=new L({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(I)?I.slice():I,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return C.setOpacity(this.getOpacity()),C}setRadius(I){this.radius_=I,this.render()}}const Y=L},13628:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>L});class U{constructor(X){X=X||{},this.color_=X.color!==void 0?X.color:null}clone(){const X=this.getColor();return new U({color:Array.isArray(X)?X.slice():X||void 0})}getColor(){return this.color_}setColor(X){this.color_=X}}const L=U},3407:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>M});var U=r(6837),L=r(6141),Y=r(10940),X=r(89352),I=r(90588),C=r(79332),v=r(68711),W=r(82241),d=r(43938);let a=null;class E extends C.A{constructor(g,O,b,q,ht,et){super(),this.hitDetectionImage_=null,this.image_=g,this.crossOrigin_=q,this.canvas_={},this.color_=et,this.unlisten_=null,this.imageState_=ht,this.size_=b,this.src_=O,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===L.A.LOADED){a||(a=(0,v.Y)(1,1,void 0,{willReadFrequently:!0})),a.drawImage(this.image_,0,0);try{a.getImageData(0,0,1,1),this.tainted_=!1}catch{a=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(U.A.CHANGE)}handleImageError_(){this.imageState_=L.A.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=L.A.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(g){return this.image_||this.initializeImage_(),this.replaceColor_(g),this.canvas_[g]?this.canvas_[g]:this.image_}getPixelRatio(g){return this.replaceColor_(g),this.canvas_[g]?g:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const g=this.size_[0],O=this.size_[1],b=(0,v.Y)(g,O);b.fillRect(0,0,g,O),this.hitDetectionImage_=b.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===L.A.IDLE){this.image_||this.initializeImage_(),this.imageState_=L.A.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=(0,d.f)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(g){if(!this.color_||this.canvas_[g]||this.imageState_!==L.A.LOADED)return;const O=this.image_,b=document.createElement("canvas");b.width=Math.ceil(O.width*g),b.height=Math.ceil(O.height*g);const q=b.getContext("2d");q.scale(g,g),q.drawImage(O,0,0),q.globalCompositeOperation="multiply",q.fillStyle=(0,X.oJ)(this.color_),q.fillRect(0,0,b.width/g,b.height/g),q.globalCompositeOperation="destination-in",q.drawImage(O,0,0),this.canvas_[g]=b}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function p(m,g,O,b,q,ht){let et=W.u.get(g,b,ht);return et||(et=new E(m,g,O,b,q,ht),W.u.set(g,b,ht,et)),et}const u=null;var z=r(4087);function f(m,g,O,b){return O!==void 0&&b!==void 0?[O/m,b/g]:O!==void 0?O/m:b!==void 0?b/g:1}class A extends Y.A{constructor(g){g=g||{};const O=g.opacity!==void 0?g.opacity:1,b=g.rotation!==void 0?g.rotation:0,q=g.scale!==void 0?g.scale:1,ht=g.rotateWithView!==void 0?g.rotateWithView:!1;super({opacity:O,rotation:b,scale:q,displacement:g.displacement!==void 0?g.displacement:[0,0],rotateWithView:ht,declutterMode:g.declutterMode}),this.anchor_=g.anchor!==void 0?g.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=g.anchorOrigin!==void 0?g.anchorOrigin:"top-left",this.anchorXUnits_=g.anchorXUnits!==void 0?g.anchorXUnits:"fraction",this.anchorYUnits_=g.anchorYUnits!==void 0?g.anchorYUnits:"fraction",this.crossOrigin_=g.crossOrigin!==void 0?g.crossOrigin:null;const et=g.img!==void 0?g.img:null;this.imgSize_=g.imgSize;let J=g.src;(0,I.v)(!(J!==void 0&&et),4),(0,I.v)(!et||et&&this.imgSize_,5),(J===void 0||J.length===0)&&et&&(J=et.src||(0,z.v6)(et)),(0,I.v)(J!==void 0&&J.length>0,6),(0,I.v)(!((g.width!==void 0||g.height!==void 0)&&g.scale!==void 0),69);const R=g.src!==void 0?L.A.IDLE:L.A.LOADED;if(this.color_=g.color!==void 0?(0,X._j)(g.color):null,this.iconImage_=p(et,J,this.imgSize_!==void 0?this.imgSize_:null,this.crossOrigin_,R,this.color_),this.offset_=g.offset!==void 0?g.offset:[0,0],this.offsetOrigin_=g.offsetOrigin!==void 0?g.offsetOrigin:"top-left",this.origin_=null,this.size_=g.size!==void 0?g.size:null,g.width!==void 0||g.height!==void 0){let T,K;if(g.size)[T,K]=g.size;else{const Q=this.getImage(1);if(Q instanceof HTMLCanvasElement||Q.src&&Q.complete)T=Q.width,K=Q.height;else{this.initialOptions_=g;const st=()=>{if(this.unlistenImageChange(st),!this.initialOptions_)return;const l=this.iconImage_.getSize();this.setScale(f(l[0],l[1],g.width,g.height))};this.listenImageChange(st);return}}T!==void 0&&this.setScale(f(T,K,g.width,g.height))}}clone(){let g,O,b;return this.initialOptions_?(O=this.initialOptions_.width,b=this.initialOptions_.height):(g=this.getScale(),g=Array.isArray(g)?g.slice():g),new A({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:g,width:O,height:b,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let g=this.normalizedAnchor_;if(!g){g=this.anchor_;const q=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!q)return null;g=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(g[0]*=q[0]),this.anchorYUnits_=="fraction"&&(g[1]*=q[1])}if(this.anchorOrigin_!="top-left"){if(!q)return null;g===this.anchor_&&(g=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(g[0]=-g[0]+q[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(g[1]=-g[1]+q[1])}this.normalizedAnchor_=g}const O=this.getDisplacement(),b=this.getScaleArray();return[g[0]-O[0]/b[0],g[1]+O[1]/b[1]]}setAnchor(g){this.anchor_=g,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(g){return this.iconImage_.getImage(g)}getPixelRatio(g){return this.iconImage_.getPixelRatio(g)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let g=this.offset_;if(this.offsetOrigin_!="top-left"){const O=this.getSize(),b=this.iconImage_.getSize();if(!O||!b)return null;g=g.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(g[0]=b[0]-O[0]-g[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(g[1]=b[1]-O[1]-g[1])}return this.origin_=g,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const g=this.getScaleArray();if(this.size_)return this.size_[0]*g[0];if(this.iconImage_.getImageState()==L.A.LOADED)return this.iconImage_.getSize()[0]*g[0]}getHeight(){const g=this.getScaleArray();if(this.size_)return this.size_[1]*g[1];if(this.iconImage_.getImageState()==L.A.LOADED)return this.iconImage_.getSize()[1]*g[1]}setScale(g){delete this.initialOptions_,super.setScale(g)}listenImageChange(g){this.iconImage_.addEventListener(U.A.CHANGE,g)}load(){this.iconImage_.load()}unlistenImageChange(g){this.iconImage_.removeEventListener(U.A.CHANGE,g)}}const M=A},82241:(Nt,at,r)=>{"use strict";r.d(at,{u:()=>I});var U=r(89352);class L{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let v=0;for(const W in this.cache_){const d=this.cache_[W];(v++&3)===0&&!d.hasListener()&&(delete this.cache_[W],--this.cacheSize_)}}}get(v,W,d){const a=Y(v,W,d);return a in this.cache_?this.cache_[a]:null}set(v,W,d,a){const E=Y(v,W,d);this.cache_[E]=a,++this.cacheSize_}setSize(v){this.maxCacheSize_=v,this.expire()}}function Y(C,v,W){const d=W?(0,U.oJ)(W):"null";return v+":"+C+":"+d}var X=null;const I=new L},10940:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>X});var U=r(4087),L=r(6782);class Y{constructor(C){this.opacity_=C.opacity,this.rotateWithView_=C.rotateWithView,this.rotation_=C.rotation,this.scale_=C.scale,this.scaleArray_=(0,L.xq)(C.scale),this.displacement_=C.displacement,this.declutterMode_=C.declutterMode}clone(){const C=this.getScale();return new Y({opacity:this.getOpacity(),scale:Array.isArray(C)?C.slice():C,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return(0,U.b0)()}getImage(C){return(0,U.b0)()}getHitDetectionImage(){return(0,U.b0)()}getPixelRatio(C){return 1}getImageState(){return(0,U.b0)()}getImageSize(){return(0,U.b0)()}getOrigin(){return(0,U.b0)()}getSize(){return(0,U.b0)()}setDisplacement(C){this.displacement_=C}setOpacity(C){this.opacity_=C}setRotateWithView(C){this.rotateWithView_=C}setRotation(C){this.rotation_=C}setScale(C){this.scale_=C,this.scaleArray_=(0,L.xq)(C)}listenImageChange(C){(0,U.b0)()}load(){(0,U.b0)()}unlistenImageChange(C){(0,U.b0)()}}const X=Y},86936:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>W});var U=r(6141),L=r(10940),Y=r(89352),X=r(99676),I=r(68711),C=r(38774);class v extends L.A{constructor(a){const E=a.rotateWithView!==void 0?a.rotateWithView:!1;super({opacity:1,rotateWithView:E,rotation:a.rotation!==void 0?a.rotation:0,scale:a.scale!==void 0?a.scale:1,displacement:a.displacement!==void 0?a.displacement:[0,0],declutterMode:a.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=a.fill!==void 0?a.fill:null,this.origin_=[0,0],this.points_=a.points,this.radius_=a.radius!==void 0?a.radius:a.radius1,this.radius2_=a.radius2,this.angle_=a.angle!==void 0?a.angle:0,this.stroke_=a.stroke!==void 0?a.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const a=this.getScale(),E=new v({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(a)?a.slice():a,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return E.setOpacity(this.getOpacity()),E}getAnchor(){const a=this.size_;if(!a)return null;const E=this.getDisplacement(),p=this.getScaleArray();return[a[0]/2-E[0]/p[0],a[1]/2+E[1]/p[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(a){this.fill_=a,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(a){let E=this.canvas_[a];if(!E){const p=this.renderOptions_,u=(0,I.Y)(p.size*a,p.size*a);this.draw_(p,u,a),E=u.canvas,this.canvas_[a]=E}return E}getPixelRatio(a){return a}getImageSize(){return this.size_}getImageState(){return U.A.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(a){this.stroke_=a,this.render()}listenImageChange(a){}load(){}unlistenImageChange(a){}calculateLineJoinSize_(a,E,p){if(E===0||this.points_===1/0||a!=="bevel"&&a!=="miter")return E;let u=this.radius_,z=this.radius2_===void 0?u:this.radius2_;if(u<z){const l=u;u=z,z=l}const f=this.radius2_===void 0?this.points_:this.points_*2,A=2*Math.PI/f,M=z*Math.sin(A),m=Math.sqrt(z*z-M*M),g=u-m,O=Math.sqrt(M*M+g*g),b=O/M;if(a==="miter"&&b<=p)return b*E;const q=E/2/b,ht=E/2*(g/O),J=Math.sqrt((u+q)*(u+q)+ht*ht)-u;if(this.radius2_===void 0||a==="bevel")return J*2;const R=u*Math.sin(A),T=Math.sqrt(u*u-R*R),K=z-T,st=Math.sqrt(R*R+K*K)/R;if(st<=p){const l=st*E/2-z-u;return 2*Math.max(J,l)}return J*2}createRenderOptions(){let a=C._K,E=0,p=null,u=0,z,f=0;this.stroke_&&(z=this.stroke_.getColor(),z===null&&(z=C.NT),z=(0,X.F)(z),f=this.stroke_.getWidth(),f===void 0&&(f=C.aq),p=this.stroke_.getLineDash(),u=this.stroke_.getLineDashOffset(),a=this.stroke_.getLineJoin(),a===void 0&&(a=C._K),E=this.stroke_.getMiterLimit(),E===void 0&&(E=C.eL));const A=this.calculateLineJoinSize_(a,f,E),M=Math.max(this.radius_,this.radius2_||0),m=Math.ceil(2*M+A);return{strokeStyle:z,strokeWidth:f,size:m,lineDash:p,lineDashOffset:u,lineJoin:a,miterLimit:E}}render(){this.renderOptions_=this.createRenderOptions();const a=this.renderOptions_.size;this.canvas_={},this.size_=[a,a]}draw_(a,E,p){if(E.scale(p,p),E.translate(a.size/2,a.size/2),this.createPath_(E),this.fill_){let u=this.fill_.getColor();u===null&&(u=C.qY),E.fillStyle=(0,X.F)(u),E.fill()}this.stroke_&&(E.strokeStyle=a.strokeStyle,E.lineWidth=a.strokeWidth,a.lineDash&&(E.setLineDash(a.lineDash),E.lineDashOffset=a.lineDashOffset),E.lineJoin=a.lineJoin,E.miterLimit=a.miterLimit,E.stroke())}createHitDetectionCanvas_(a){if(this.fill_){let E=this.fill_.getColor(),p=0;if(typeof E=="string"&&(E=(0,Y._j)(E)),E===null?p=1:Array.isArray(E)&&(p=E.length===4?E[3]:1),p===0){const u=(0,I.Y)(a.size,a.size);this.hitDetectionCanvas_=u.canvas,this.drawHitDetectionCanvas_(a,u)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(a){let E=this.points_;const p=this.radius_;if(E===1/0)a.arc(0,0,p,0,2*Math.PI);else{const u=this.radius2_===void 0?p:this.radius2_;this.radius2_!==void 0&&(E*=2);const z=this.angle_-Math.PI/2,f=2*Math.PI/E;for(let A=0;A<E;A++){const M=z+A*f,m=A%2===0?p:u;a.lineTo(m*Math.cos(M),m*Math.sin(M))}a.closePath()}}drawHitDetectionCanvas_(a,E){E.translate(a.size/2,a.size/2),this.createPath_(E),E.fillStyle=C.qY,E.fill(),this.stroke_&&(E.strokeStyle=a.strokeStyle,E.lineWidth=a.strokeWidth,a.lineDash&&(E.setLineDash(a.lineDash),E.lineDashOffset=a.lineDashOffset),E.lineJoin=a.lineJoin,E.miterLimit=a.miterLimit,E.stroke())}}const W=v},953:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>L});class U{constructor(X){X=X||{},this.color_=X.color!==void 0?X.color:null,this.lineCap_=X.lineCap,this.lineDash_=X.lineDash!==void 0?X.lineDash:null,this.lineDashOffset_=X.lineDashOffset,this.lineJoin_=X.lineJoin,this.miterLimit_=X.miterLimit,this.width_=X.width}clone(){const X=this.getColor();return new U({color:Array.isArray(X)?X.slice():X||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(X){this.color_=X}setLineCap(X){this.lineCap_=X}setLineDash(X){this.lineDash_=X}setLineDashOffset(X){this.lineDashOffset_=X}setLineJoin(X){this.lineJoin_=X}setMiterLimit(X){this.miterLimit_=X}setWidth(X){this.width_=X}}const L=U},29276:(Nt,at,r)=>{"use strict";r.d(at,{Ay:()=>E,d1:()=>W,mC:()=>C,mY:()=>d});var U=r(27733),L=r(13628),Y=r(953),X=r(90588);class I{constructor(u){u=u||{},this.geometry_=null,this.geometryFunction_=a,u.geometry!==void 0&&this.setGeometry(u.geometry),this.fill_=u.fill!==void 0?u.fill:null,this.image_=u.image!==void 0?u.image:null,this.renderer_=u.renderer!==void 0?u.renderer:null,this.hitDetectionRenderer_=u.hitDetectionRenderer!==void 0?u.hitDetectionRenderer:null,this.stroke_=u.stroke!==void 0?u.stroke:null,this.text_=u.text!==void 0?u.text:null,this.zIndex_=u.zIndex}clone(){let u=this.getGeometry();return u&&typeof u=="object"&&(u=u.clone()),new I({geometry:u,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(u){this.renderer_=u}setHitDetectionRenderer(u){this.hitDetectionRenderer_=u}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(u){this.fill_=u}getImage(){return this.image_}setImage(u){this.image_=u}getStroke(){return this.stroke_}setStroke(u){this.stroke_=u}getText(){return this.text_}setText(u){this.text_=u}getZIndex(){return this.zIndex_}setGeometry(u){typeof u=="function"?this.geometryFunction_=u:typeof u=="string"?this.geometryFunction_=function(z){return z.get(u)}:u?u!==void 0&&(this.geometryFunction_=function(){return u}):this.geometryFunction_=a,this.geometry_=u}setZIndex(u){this.zIndex_=u}}function C(p){let u;if(typeof p=="function")u=p;else{let z;Array.isArray(p)?z=p:((0,X.v)(typeof p.getZIndex=="function",41),z=[p]),u=function(){return z}}return u}let v=null;function W(p,u){if(!v){const z=new L.A({color:"rgba(255,255,255,0.4)"}),f=new Y.A({color:"#3399CC",width:1.25});v=[new I({image:new U.A({fill:z,stroke:f,radius:5}),fill:z,stroke:f})]}return v}function d(){const p={},u=[255,255,255,1],z=[0,153,255,1],f=3;return p.Polygon=[new I({fill:new L.A({color:[255,255,255,.5]})})],p.MultiPolygon=p.Polygon,p.LineString=[new I({stroke:new Y.A({color:u,width:f+2})}),new I({stroke:new Y.A({color:z,width:f})})],p.MultiLineString=p.LineString,p.Circle=p.Polygon.concat(p.LineString),p.Point=[new I({image:new U.A({radius:f*2,fill:new L.A({color:z}),stroke:new Y.A({color:u,width:f/2})}),zIndex:1/0})],p.MultiPoint=p.Point,p.GeometryCollection=p.Polygon.concat(p.LineString,p.Point),p}function a(p){return p.getGeometry()}const E=I},81426:(Nt,at,r)=>{"use strict";r.d(at,{A:()=>I});var U=r(13628),L=r(6782);const Y="#333";class X{constructor(v){v=v||{},this.font_=v.font,this.rotation_=v.rotation,this.rotateWithView_=v.rotateWithView,this.scale_=v.scale,this.scaleArray_=(0,L.xq)(v.scale!==void 0?v.scale:1),this.text_=v.text,this.textAlign_=v.textAlign,this.justify_=v.justify,this.repeat_=v.repeat,this.textBaseline_=v.textBaseline,this.fill_=v.fill!==void 0?v.fill:new U.A({color:Y}),this.maxAngle_=v.maxAngle!==void 0?v.maxAngle:Math.PI/4,this.placement_=v.placement!==void 0?v.placement:"point",this.overflow_=!!v.overflow,this.stroke_=v.stroke!==void 0?v.stroke:null,this.offsetX_=v.offsetX!==void 0?v.offsetX:0,this.offsetY_=v.offsetY!==void 0?v.offsetY:0,this.backgroundFill_=v.backgroundFill?v.backgroundFill:null,this.backgroundStroke_=v.backgroundStroke?v.backgroundStroke:null,this.padding_=v.padding===void 0?null:v.padding}clone(){const v=this.getScale();return new X({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(v)?v.slice():v,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(v){this.overflow_=v}setFont(v){this.font_=v}setMaxAngle(v){this.maxAngle_=v}setOffsetX(v){this.offsetX_=v}setOffsetY(v){this.offsetY_=v}setPlacement(v){this.placement_=v}setRepeat(v){this.repeat_=v}setRotateWithView(v){this.rotateWithView_=v}setFill(v){this.fill_=v}setRotation(v){this.rotation_=v}setScale(v){this.scale_=v,this.scaleArray_=(0,L.xq)(v!==void 0?v:1)}setStroke(v){this.stroke_=v}setText(v){this.text_=v}setTextAlign(v){this.textAlign_=v}setJustify(v){this.justify_=v}setTextBaseline(v){this.textBaseline_=v}setBackgroundFill(v){this.backgroundFill_=v}setBackgroundStroke(v){this.backgroundStroke_=v}setPadding(v){this.padding_=v}}const I=X},40186:(Nt,at,r)=>{"use strict";r.d(at,{K:()=>I,N:()=>U,N5:()=>v,dp:()=>L,i7:()=>Y,tW:()=>C});function U(W,d,a,E){return E!==void 0?(E[0]=W,E[1]=d,E[2]=a,E):[W,d,a]}function L(W,d,a){return W+"/"+d+"/"+a}function Y(W){return L(W[0],W[1],W[2])}function X(W){const[d,a,E]=W.substring(W.lastIndexOf("/")+1,W.length).split(",").map(Number);return L(d,a,E)}function I(W){return W.split("/").map(Number)}function C(W){return(W[1]<<W[0])+W[2]}function v(W,d){const a=W[0],E=W[1],p=W[2];if(d.getMinZoom()>a||a>d.getMaxZoom())return!1;const u=d.getFullTileRange(a);return u?u.containsXY(E,p):!0}},57115:(Nt,at,r)=>{"use strict";r.d(at,{L:()=>U,R:()=>L});const U=42,L=256},83954:(Nt,at,r)=>{"use strict";r.d(at,{Z:()=>L,v:()=>U});function U(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function L(Y,X){return Y[0]=X[0],Y[1]=X[1],Y[4]=X[2],Y[5]=X[3],Y[12]=X[4],Y[13]=X[5],Y}},90130:(Nt,at,r)=>{"use strict";r.d(at,{Be:()=>C,Ek:()=>I,H7:()=>L,IP:()=>Y,JL:()=>W,SD:()=>p,Ss:()=>X,UD:()=>d,l4:()=>v,zH:()=>a});var U=r(7771);const L=34962,Y=34963,X=35040,I=35044,C=35048,v=5121,W=5123,d=5125,a=5126,E=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function p(f,A){A=Object.assign({preserveDrawingBuffer:!0,antialias:!U.oF},A);const M=E.length;for(let m=0;m<M;++m)try{const g=f.getContext(E[m],A);if(g)return g}catch{}return null}let u;function z(){if(!u){const f=document.createElement("canvas"),A=p(f);A&&(u=A.getSupportedExtensions())}return u}},20259:(Nt,at,r)=>{"use strict";r.d(at,{Ay:()=>C});var U=r(90130),L=r(90588);const Y={STATIC_DRAW:U.Ek,STREAM_DRAW:U.Ss,DYNAMIC_DRAW:U.Be};class X{constructor(W,d){this.array=null,this.type=W,(0,L.v)(W===U.H7||W===U.IP,62),this.usage=d!==void 0?d:Y.STATIC_DRAW}ofSize(W){return this.array=new(I(this.type))(W),this}fromArray(W){return this.array=I(this.type).from(W),this}fromArrayBuffer(W){return this.array=new(I(this.type))(W),this}getType(){return this.type}getArray(){return this.array}getUsage(){return this.usage}getSize(){return this.array?this.array.length:0}}function I(v){switch(v){case U.H7:return Float32Array;case U.IP:return Uint32Array;default:return Float32Array}}const C=X},9777:(Nt,at,r)=>{"use strict";r.d(at,{jQ:()=>z,M8:()=>u,Ay:()=>et});const U={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var L=r(90025),Y=r(4087);const X=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,I=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class C{constructor(R){this.gl_=R.webGlContext;const T=this.gl_;this.scaleRatio_=R.scaleRatio||1,this.renderTargetTexture_=T.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=T.createFramebuffer();const K=T.createShader(T.VERTEX_SHADER);T.shaderSource(K,R.vertexShader||X),T.compileShader(K);const Q=T.createShader(T.FRAGMENT_SHADER);T.shaderSource(Q,R.fragmentShader||I),T.compileShader(Q),this.renderTargetProgram_=T.createProgram(),T.attachShader(this.renderTargetProgram_,K),T.attachShader(this.renderTargetProgram_,Q),T.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=T.createBuffer();const st=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];T.bindBuffer(T.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),T.bufferData(T.ARRAY_BUFFER,new Float32Array(st),T.STATIC_DRAW),this.renderTargetAttribLocation_=T.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=T.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=T.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=T.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],R.uniforms&&Object.keys(R.uniforms).forEach(l=>{this.uniforms_.push({value:R.uniforms[l],location:T.getUniformLocation(this.renderTargetProgram_,l)})})}getGL(){return this.gl_}init(R){const T=this.getGL(),K=[T.drawingBufferWidth*this.scaleRatio_,T.drawingBufferHeight*this.scaleRatio_];if(T.bindFramebuffer(T.FRAMEBUFFER,this.getFrameBuffer()),T.viewport(0,0,K[0],K[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==K[0]||this.renderTargetTextureSize_[1]!==K[1]){this.renderTargetTextureSize_=K;const Q=0,st=T.RGBA,l=0,s=T.RGBA,n=T.UNSIGNED_BYTE,o=null;T.bindTexture(T.TEXTURE_2D,this.renderTargetTexture_),T.texImage2D(T.TEXTURE_2D,Q,st,K[0],K[1],l,s,n,o),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,this.renderTargetTexture_,0)}}apply(R,T,K,Q){const st=this.getGL(),l=R.size;if(st.bindFramebuffer(st.FRAMEBUFFER,T?T.getFrameBuffer():null),st.activeTexture(st.TEXTURE0),st.bindTexture(st.TEXTURE_2D,this.renderTargetTexture_),!T){const n=(0,Y.v6)(st.canvas);if(!R.renderTargets[n]){const o=st.getContextAttributes();o&&o.preserveDrawingBuffer&&(st.clearColor(0,0,0,0),st.clear(st.COLOR_BUFFER_BIT)),R.renderTargets[n]=!0}}st.enable(st.BLEND),st.blendFunc(st.ONE,st.ONE_MINUS_SRC_ALPHA),st.viewport(0,0,st.drawingBufferWidth,st.drawingBufferHeight),st.bindBuffer(st.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),st.useProgram(this.renderTargetProgram_),st.enableVertexAttribArray(this.renderTargetAttribLocation_),st.vertexAttribPointer(this.renderTargetAttribLocation_,2,st.FLOAT,!1,0,0),st.uniform2f(this.renderTargetUniformLocation_,l[0],l[1]),st.uniform1i(this.renderTargetTextureLocation_,0);const s=R.layerStatesArray[R.layerIndex].opacity;st.uniform1f(this.renderTargetOpacityLocation_,s),this.applyUniforms(R),K&&K(st,R),st.drawArrays(st.TRIANGLES,0,6),Q&&Q(st,R)}getFrameBuffer(){return this.frameBuffer_}applyUniforms(R){const T=this.getGL();let K,Q=1;this.uniforms_.forEach(function(st){if(K=typeof st.value=="function"?st.value(R):st.value,K instanceof HTMLCanvasElement||K instanceof ImageData)st.texture||(st.texture=T.createTexture()),T.activeTexture(T[`TEXTURE${Q}`]),T.bindTexture(T.TEXTURE_2D,st.texture),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),K instanceof ImageData?T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,K.width,K.height,0,T.UNSIGNED_BYTE,new Uint8Array(K.data)):T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,K),T.uniform1i(st.location,Q++);else if(Array.isArray(K))switch(K.length){case 2:T.uniform2f(st.location,K[0],K[1]);return;case 3:T.uniform3f(st.location,K[0],K[1],K[2]);return;case 4:T.uniform4f(st.location,K[0],K[1],K[2],K[3]);return;default:return}else typeof K=="number"&&T.uniform1f(st.location,K)})}}const v=C;var W=r(90130),d=r(43530),a=r(9703),E=r(83954);const p={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633},u={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio"},z={UNSIGNED_BYTE:W.l4,UNSIGNED_SHORT:W.JL,UNSIGNED_INT:W.UD,FLOAT:W.zH},f={};function A(J){return"shared/"+J}let M=0;function m(){const J="unique/"+M;return M+=1,J}function g(J){let R=f[J];if(!R){const T=document.createElement("canvas");T.style.position="absolute",T.style.left="0",R={users:0,canvas:T},f[J]=R}return R.users+=1,R.canvas}function O(J){const R=f[J];if(!R||(R.users-=1,R.users>0))return;const T=R.canvas,Q=(0,W.SD)(T).getExtension("WEBGL_lose_context");Q&&Q.loseContext(),delete f[J]}class b extends L.A{constructor(R){super(),R=R||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=R.canvasCacheKey?A(R.canvasCacheKey):m(),this.canvas_=g(this.canvasCacheKey_),this.gl_=(0,W.SD)(this.canvas_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.canvas_.addEventListener(U.LOST,this.boundHandleWebGLContextLost_),this.canvas_.addEventListener(U.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,a.vt)(),this.offsetScaleMatrix_=(0,a.vt)(),this.tmpMat4_=(0,E.v)(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],R.uniforms&&this.setUniforms(R.uniforms),this.postProcessPasses_=R.postProcesses?R.postProcesses.map(T=>new v({webGlContext:this.gl_,scaleRatio:T.scaleRatio,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader,uniforms:T.uniforms})):[new v({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(R){this.uniforms_=[];for(const T in R)this.uniforms_.push({name:T,value:R[T]})}canvasCacheKeyMatches(R){return this.canvasCacheKey_===A(R)}getExtension(R){if(R in this.extensionCache_)return this.extensionCache_[R];const T=this.gl_.getExtension(R);return this.extensionCache_[R]=T,T}bindBuffer(R){const T=this.gl_,K=(0,Y.v6)(R);let Q=this.bufferCache_[K];if(!Q){const st=T.createBuffer();Q={buffer:R,webGlBuffer:st},this.bufferCache_[K]=Q}T.bindBuffer(R.getType(),Q.webGlBuffer)}flushBufferData(R){const T=this.gl_;this.bindBuffer(R),T.bufferData(R.getType(),R.getArray(),R.getUsage())}deleteBuffer(R){const T=this.gl_,K=(0,Y.v6)(R),Q=this.bufferCache_[K];Q&&!T.isContextLost()&&T.deleteBuffer(Q.webGlBuffer),delete this.bufferCache_[K]}disposeInternal(){this.canvas_.removeEventListener(U.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(U.RESTORED,this.boundHandleWebGLContextRestored_),O(this.canvasCacheKey_),delete this.gl_,delete this.canvas_}prepareDraw(R,T){const K=this.gl_,Q=this.getCanvas(),st=R.size,l=R.pixelRatio;(Q.width!==st[0]*l||Q.height!==st[1]*l)&&(Q.width=st[0]*l,Q.height=st[1]*l,Q.style.width=st[0]+"px",Q.style.height=st[1]+"px");for(let s=this.postProcessPasses_.length-1;s>=0;s--)this.postProcessPasses_[s].init(R);K.bindTexture(K.TEXTURE_2D,null),K.clearColor(0,0,0,0),K.clear(K.COLOR_BUFFER_BIT),K.enable(K.BLEND),K.blendFunc(K.ONE,T?K.ZERO:K.ONE_MINUS_SRC_ALPHA)}bindTexture(R,T,K){const Q=this.gl_;Q.activeTexture(Q.TEXTURE0+T),Q.bindTexture(Q.TEXTURE_2D,R),Q.uniform1i(this.getUniformLocation(K),T)}prepareDrawToRenderTarget(R,T,K){const Q=this.gl_,st=T.getSize();Q.bindFramebuffer(Q.FRAMEBUFFER,T.getFramebuffer()),Q.viewport(0,0,st[0],st[1]),Q.bindTexture(Q.TEXTURE_2D,T.getTexture()),Q.clearColor(0,0,0,0),Q.clear(Q.COLOR_BUFFER_BIT),Q.enable(Q.BLEND),Q.blendFunc(Q.ONE,K?Q.ZERO:Q.ONE_MINUS_SRC_ALPHA)}drawElements(R,T){const K=this.gl_;this.getExtension("OES_element_index_uint");const Q=K.UNSIGNED_INT,st=4,l=T-R,s=R*st;K.drawElements(K.TRIANGLES,l,Q,s)}finalizeDraw(R,T,K){for(let Q=0,st=this.postProcessPasses_.length;Q<st;Q++)Q===st-1?this.postProcessPasses_[Q].apply(R,null,T,K):this.postProcessPasses_[Q].apply(R,this.postProcessPasses_[Q+1])}getCanvas(){return this.canvas_}getGL(){return this.gl_}applyFrameState(R){const T=R.size,K=R.viewState.rotation,Q=R.pixelRatio,st=(0,a.cL)(this.offsetScaleMatrix_);(0,a.hs)(st,2/T[0],2/T[1]);const l=(0,a.cL)(this.offsetRotateMatrix_);K!==0&&(0,a.e$)(l,-K),this.setUniformMatrixValue(u.OFFSET_SCALE_MATRIX,(0,E.Z)(this.tmpMat4_,st)),this.setUniformMatrixValue(u.OFFSET_ROTATION_MATRIX,(0,E.Z)(this.tmpMat4_,l)),this.setUniformFloatValue(u.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(u.ZOOM,R.viewState.zoom),this.setUniformFloatValue(u.RESOLUTION,R.viewState.resolution),this.setUniformFloatValue(u.PIXEL_RATIO,Q),this.setUniformFloatVec2(u.VIEWPORT_SIZE_PX,[T[0],T[1]])}applyUniforms(R){const T=this.gl_;let K,Q=0;this.uniforms_.forEach(st=>{if(K=typeof st.value=="function"?st.value(R):st.value,K instanceof HTMLCanvasElement||K instanceof HTMLImageElement||K instanceof ImageData)st.texture||(st.prevValue=void 0,st.texture=T.createTexture()),T.activeTexture(T[`TEXTURE${Q}`]),T.bindTexture(T.TEXTURE_2D,st.texture),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),(!(K instanceof HTMLImageElement)||K.complete)&&st.prevValue!==K&&(st.prevValue=K,T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,K)),T.uniform1i(this.getUniformLocation(st.name),Q++);else if(Array.isArray(K)&&K.length===6)this.setUniformMatrixValue(st.name,(0,E.Z)(this.tmpMat4_,K));else if(Array.isArray(K)&&K.length<=4)switch(K.length){case 2:T.uniform2f(this.getUniformLocation(st.name),K[0],K[1]);return;case 3:T.uniform3f(this.getUniformLocation(st.name),K[0],K[1],K[2]);return;case 4:T.uniform4f(this.getUniformLocation(st.name),K[0],K[1],K[2],K[3]);return;default:return}else typeof K=="number"&&T.uniform1f(this.getUniformLocation(st.name),K)})}useProgram(R,T){this.gl_.useProgram(R),this.currentProgram_=R,this.applyFrameState(T),this.applyUniforms(T)}compileShader(R,T){const K=this.gl_,Q=K.createShader(T);return K.shaderSource(Q,R),K.compileShader(Q),Q}getProgram(R,T){const K=this.gl_,Q=this.compileShader(R,K.FRAGMENT_SHADER),st=this.compileShader(T,K.VERTEX_SHADER),l=K.createProgram();if(K.attachShader(l,Q),K.attachShader(l,st),K.linkProgram(l),!K.getShaderParameter(Q,K.COMPILE_STATUS)){const s=`Fragment shader compilation failed: ${K.getShaderInfoLog(Q)}`;throw new Error(s)}if(K.deleteShader(Q),!K.getShaderParameter(st,K.COMPILE_STATUS)){const s=`Vertex shader compilation failed: ${K.getShaderInfoLog(st)}`;throw new Error(s)}if(K.deleteShader(st),!K.getProgramParameter(l,K.LINK_STATUS)){const s=`GL program linking failed: ${K.getProgramInfoLog(l)}`;throw new Error(s)}return l}getUniformLocation(R){const T=(0,Y.v6)(this.currentProgram_);return this.uniformLocationsByProgram_[T]===void 0&&(this.uniformLocationsByProgram_[T]={}),this.uniformLocationsByProgram_[T][R]===void 0&&(this.uniformLocationsByProgram_[T][R]=this.gl_.getUniformLocation(this.currentProgram_,R)),this.uniformLocationsByProgram_[T][R]}getAttributeLocation(R){const T=(0,Y.v6)(this.currentProgram_);return this.attribLocationsByProgram_[T]===void 0&&(this.attribLocationsByProgram_[T]={}),this.attribLocationsByProgram_[T][R]===void 0&&(this.attribLocationsByProgram_[T][R]=this.gl_.getAttribLocation(this.currentProgram_,R)),this.attribLocationsByProgram_[T][R]}makeProjectionTransform(R,T){const K=R.size,Q=R.viewState.rotation,st=R.viewState.resolution,l=R.viewState.center;return(0,a.Zz)(T,0,0,2/(st*K[0]),2/(st*K[1]),-Q,-l[0],-l[1]),T}setUniformFloatValue(R,T){this.gl_.uniform1f(this.getUniformLocation(R),T)}setUniformFloatVec2(R,T){this.gl_.uniform2fv(this.getUniformLocation(R),T)}setUniformFloatVec4(R,T){this.gl_.uniform4fv(this.getUniformLocation(R),T)}setUniformMatrixValue(R,T){this.gl_.uniformMatrix4fv(this.getUniformLocation(R),!1,T)}enableAttributeArray_(R,T,K,Q,st){const l=this.getAttributeLocation(R);l<0||(this.gl_.enableVertexAttribArray(l),this.gl_.vertexAttribPointer(l,T,K,!1,Q,st))}enableAttributes(R){const T=q(R);let K=0;for(let Q=0;Q<R.length;Q++){const st=R[Q];this.enableAttributeArray_(st.name,st.size,st.type||W.zH,T,K),K+=st.size*ht(st.type)}}handleWebGLContextLost(){(0,d.I)(this.bufferCache_),this.currentProgram_=null}handleWebGLContextRestored(){}createTexture(R,T,K){const Q=this.gl_;K=K||Q.createTexture();const st=0,l=Q.RGBA,s=0,n=Q.RGBA,o=Q.UNSIGNED_BYTE;return Q.bindTexture(Q.TEXTURE_2D,K),T?Q.texImage2D(Q.TEXTURE_2D,st,l,n,o,T):Q.texImage2D(Q.TEXTURE_2D,st,l,R[0],R[1],s,n,o,null),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),K}}function q(J){let R=0;for(let T=0;T<J.length;T++){const K=J[T];R+=K.size*ht(K.type)}return R}function ht(J){switch(J){case z.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case z.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case z.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case z.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}const et=b}}]);

//# sourceMappingURL=362.30ea5d40bbd56a4f1058.js.map