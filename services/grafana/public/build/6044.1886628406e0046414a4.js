(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6044],{1749:(Z,R,e)=>{"use strict";e.d(R,{P:()=>g});var n=e(75816),a=e(10378),s=e(43173);const l=()=>s.$.namespace,o=(y,v)=>`${s.$.appSubUrl||""}/apis/${y}/${v}/namespaces/${l()}`,d=(y,v)=>`${y}/${v}`,i="v0alpha1",c="notifications.alerting.grafana.app",m=o(c,i),p=d(c,i),h=(0,n.xP)({reducerPath:p,baseQuery:(0,a.cw)({baseUrl:new URL(m,globalThis.location.origin).href}),endpoints:()=>({})}),r=["API Discovery","Receiver","RoutingTree","TemplateGroup","TimeInterval"],g=h.enhanceEndpoints({addTagTypes:r}).injectEndpoints({endpoints:y=>({getApiResources:y.query({query:()=>({url:"/apis/notifications.alerting.grafana.app/v0alpha1/"}),providesTags:["API Discovery"]}),listReceiver:y.query({query:v=>({url:"/receivers",params:{pretty:v.pretty,allowWatchBookmarks:v.allowWatchBookmarks,continue:v.continue,fieldSelector:v.fieldSelector,labelSelector:v.labelSelector,limit:v.limit,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds,watch:v.watch}}),providesTags:["Receiver"]}),createReceiver:y.mutation({query:v=>({url:"/receivers",method:"POST",body:v.receiver,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["Receiver"]}),deletecollectionReceiver:y.mutation({query:v=>({url:"/receivers",method:"DELETE",params:{pretty:v.pretty,continue:v.continue,dryRun:v.dryRun,fieldSelector:v.fieldSelector,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:v.labelSelector,limit:v.limit,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds}}),invalidatesTags:["Receiver"]}),getReceiver:y.query({query:v=>({url:`/receivers/${v.name}`,params:{pretty:v.pretty}}),providesTags:["Receiver"]}),replaceReceiver:y.mutation({query:v=>({url:`/receivers/${v.name}`,method:"PUT",body:v.receiver,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["Receiver"]}),deleteReceiver:y.mutation({query:v=>({url:`/receivers/${v.name}`,method:"DELETE",params:{pretty:v.pretty,dryRun:v.dryRun,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy}}),invalidatesTags:["Receiver"]}),updateReceiver:y.mutation({query:v=>({url:`/receivers/${v.name}`,method:"PATCH",body:v.patch,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation,force:v.force}}),invalidatesTags:["Receiver"]}),listRoutingTree:y.query({query:v=>({url:"/routingtrees",params:{pretty:v.pretty,allowWatchBookmarks:v.allowWatchBookmarks,continue:v.continue,fieldSelector:v.fieldSelector,labelSelector:v.labelSelector,limit:v.limit,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds,watch:v.watch}}),providesTags:["RoutingTree"]}),createRoutingTree:y.mutation({query:v=>({url:"/routingtrees",method:"POST",body:v.routingTree,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["RoutingTree"]}),deletecollectionRoutingTree:y.mutation({query:v=>({url:"/routingtrees",method:"DELETE",params:{pretty:v.pretty,continue:v.continue,dryRun:v.dryRun,fieldSelector:v.fieldSelector,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:v.labelSelector,limit:v.limit,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds}}),invalidatesTags:["RoutingTree"]}),getRoutingTree:y.query({query:v=>({url:`/routingtrees/${v.name}`,params:{pretty:v.pretty}}),providesTags:["RoutingTree"]}),replaceRoutingTree:y.mutation({query:v=>({url:`/routingtrees/${v.name}`,method:"PUT",body:v.routingTree,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["RoutingTree"]}),deleteRoutingTree:y.mutation({query:v=>({url:`/routingtrees/${v.name}`,method:"DELETE",params:{pretty:v.pretty,dryRun:v.dryRun,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy}}),invalidatesTags:["RoutingTree"]}),updateRoutingTree:y.mutation({query:v=>({url:`/routingtrees/${v.name}`,method:"PATCH",body:v.patch,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation,force:v.force}}),invalidatesTags:["RoutingTree"]}),listTemplateGroup:y.query({query:v=>({url:"/templategroups",params:{pretty:v.pretty,allowWatchBookmarks:v.allowWatchBookmarks,continue:v.continue,fieldSelector:v.fieldSelector,labelSelector:v.labelSelector,limit:v.limit,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds,watch:v.watch}}),providesTags:["TemplateGroup"]}),createTemplateGroup:y.mutation({query:v=>({url:"/templategroups",method:"POST",body:v.templateGroup,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deletecollectionTemplateGroup:y.mutation({query:v=>({url:"/templategroups",method:"DELETE",params:{pretty:v.pretty,continue:v.continue,dryRun:v.dryRun,fieldSelector:v.fieldSelector,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:v.labelSelector,limit:v.limit,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds}}),invalidatesTags:["TemplateGroup"]}),getTemplateGroup:y.query({query:v=>({url:`/templategroups/${v.name}`,params:{pretty:v.pretty}}),providesTags:["TemplateGroup"]}),replaceTemplateGroup:y.mutation({query:v=>({url:`/templategroups/${v.name}`,method:"PUT",body:v.templateGroup,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deleteTemplateGroup:y.mutation({query:v=>({url:`/templategroups/${v.name}`,method:"DELETE",params:{pretty:v.pretty,dryRun:v.dryRun,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy}}),invalidatesTags:["TemplateGroup"]}),updateTemplateGroup:y.mutation({query:v=>({url:`/templategroups/${v.name}`,method:"PATCH",body:v.patch,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation,force:v.force}}),invalidatesTags:["TemplateGroup"]}),listTimeInterval:y.query({query:v=>({url:"/timeintervals",params:{pretty:v.pretty,allowWatchBookmarks:v.allowWatchBookmarks,continue:v.continue,fieldSelector:v.fieldSelector,labelSelector:v.labelSelector,limit:v.limit,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds,watch:v.watch}}),providesTags:["TimeInterval"]}),createTimeInterval:y.mutation({query:v=>({url:"/timeintervals",method:"POST",body:v.timeInterval,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deletecollectionTimeInterval:y.mutation({query:v=>({url:"/timeintervals",method:"DELETE",params:{pretty:v.pretty,continue:v.continue,dryRun:v.dryRun,fieldSelector:v.fieldSelector,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:v.labelSelector,limit:v.limit,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy,resourceVersion:v.resourceVersion,resourceVersionMatch:v.resourceVersionMatch,sendInitialEvents:v.sendInitialEvents,timeoutSeconds:v.timeoutSeconds}}),invalidatesTags:["TimeInterval"]}),getTimeInterval:y.query({query:v=>({url:`/timeintervals/${v.name}`,params:{pretty:v.pretty}}),providesTags:["TimeInterval"]}),replaceTimeInterval:y.mutation({query:v=>({url:`/timeintervals/${v.name}`,method:"PUT",body:v.timeInterval,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteTimeInterval:y.mutation({query:v=>({url:`/timeintervals/${v.name}`,method:"DELETE",params:{pretty:v.pretty,dryRun:v.dryRun,gracePeriodSeconds:v.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:v.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:v.orphanDependents,propagationPolicy:v.propagationPolicy}}),invalidatesTags:["TimeInterval"]}),updateTimeInterval:y.mutation({query:v=>({url:`/timeintervals/${v.name}`,method:"PATCH",body:v.patch,params:{pretty:v.pretty,dryRun:v.dryRun,fieldManager:v.fieldManager,fieldValidation:v.fieldValidation,force:v.force}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1})},62392:(Z,R,e)=>{"use strict";e.d(R,{p:()=>l});var n=e(74848),a=e(96540),s=e(79450);function l(o){const{children:d,instanceSettings:i}=o,c=(0,a.useMemo)(()=>({instanceSettings:i,meta:i.meta}),[i]);return(0,n.jsx)(s.b.Provider,{value:c,children:d})}},79450:(Z,R,e)=>{"use strict";e.d(R,{b:()=>a});var n=e(96540);const a=(0,n.createContext)(void 0)},20877:(Z,R,e)=>{"use strict";e.d(R,{a:()=>s});var n=e(74848),a=e(79450);function s(l){const{children:o,...d}=l;return(0,n.jsx)(a.b.Provider,{value:d,children:o})}},17564:(Z,R,e)=>{"use strict";e.d(R,{S:()=>n});function n(a){return"instanceSettings"in a&&"meta"in a}},31595:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>s});var n=e(96540),a=e(79450);function s(){const l=(0,n.useContext)(a.b);return l||null}},27359:(Z,R,e)=>{"use strict";e.d(R,{I:()=>l,f:()=>s});var n=e(95004),a=e(41119);class s{constructor(c,m){return this.fields=[],this.length=0,l(c,m)}}function l(i,c){const m={fields:[],length:i.length};if(!i?.length)return m;if(c){if(!d(i))throw new Error("source is not an array of objects");for(const h of c)m.fields.push(o(h,i.map(r=>r&&r[h])));return m}if(i.find(h=>h)===null)return m;if(d(i)){const h=i.find(r=>r);m.fields=Object.keys(h||{}).map(r=>o(r,i.map(g=>g&&g[r])))}else m.fields.push(o(n.Bc,i));return m}function o(i,c){const m={name:i,config:{},values:c,type:n.PU.other};return m.type=(0,a.dF)(m)??n.PU.other,m}function d(i){const c=i.find(m=>m);return i.length>0&&typeof c=="object"}},35479:(Z,R,e)=>{"use strict";e.d(R,{x:()=>s});var n=e(94777),a=e(18700);class s extends a.k{constructor(o){super(void 0,d=>new n.$({...o,buffer:d}))}}},77154:(Z,R,e)=>{"use strict";e.d(R,{EL:()=>o,Nw:()=>c,or:()=>i,t:()=>l});var n=e(95004),a=e(41119);const s={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function l(m,p){let h;for(h in m){const r=s[h];for(const g of m[h])g<p.length&&(p[g]=r)}}function o(m,p){for(let h=0;h<p.length;h++)p[h]=m[Number(p[h])]}function d(m,p){for(const h of p)if(h!=null)return(0,a.by)(m,h);return n.PU.other}function i(m){const{schema:p,data:h}=m;if(!p||!p.fields)throw new Error("JSON needs a fields definition");const r=h?h.values.reduce((y,v)=>Math.max(y,v.length),0):0,g=p.fields.map((y,v)=>{let x=h?h.values[v]:[],f=x.length,u=y.type;f!==r&&(x.length=r,x.fill(void 0,f));let b=h?.entities?.[v];b&&l(b,x);let E=h?.enums?.[v];E&&(o(E,x),u=n.PU.string);const D=h?.nanos?.[v],C={...y,type:u??d(y.name,x),config:y.config??{},values:x,entities:b??{}};return D!=null&&(C.nanos=D),C});return{...p,fields:g,length:r}}function c(m){const p={values:[]},h=[];let r=!1;const g={refId:m.refId,meta:m.meta,name:m.name,fields:m.fields.map(y=>{const{values:v,nanos:x,state:f,display:u,...b}=y;return"entities"in b&&delete b.entities,p.values.push(v),x!=null?(h.push(x),r=!0):h.push(null),b})};return r&&(p.nanos=h),{schema:g,data:p}}},88673:(Z,R,e)=>{"use strict";e.d(R,{R:()=>a});var n=e(96453);class a extends n.F{constructor(l){super(),this.data=l,this.index=0;const o={},d={};for(let i=0;i<l.fields.length;i++){const c=l.fields[i];if(!c.name)continue;d[c.name]=c;const m=()=>c.values.get(this.index);o.hasOwnProperty(c.name)||Object.defineProperty(o,c.name,{enumerable:!0,get:m}),o.hasOwnProperty(i.toString())||Object.defineProperty(o,i,{enumerable:!1,get:m})}this.obj=o,this.fields=d}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(l){if(!this.dataFrame||!this.dataFrame.fields)return;const o=this.dataFrame.fields[l];if(!(!o||!o.display))return o.display}get(l){return this.index=l,this.obj}toArray(){return new Array(this.data.length).fill(0).map((l,o)=>({...this.get(o)}))}}},10279:(Z,R,e)=>{"use strict";e.d(R,{L:()=>s});var n=e(95004),a=e(41119);class s{constructor(o){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=o.fields.map((d,i)=>({...d,index:i}));for(let d=0;d<o.fields.length;d++){const i=o.fields[d];if(i.type===n.PU.other){const c=(0,a.dF)(i);c&&(i.type=c)}this.fieldByType[i.type]||(this.fieldByType[i.type]=[]),this.fieldByType[i.type].push({...i,index:d}),this.fieldByName[i.name]?console.warn("Duplicate field names in DataFrame: ",i.name):this.fieldByName[i.name]={...i,index:d}}}getFields(o){if(!o)return[...this.fields];const d=this.fieldByType[o];return d?[...d]:[]}hasFieldOfType(o){const d=this.fieldByType[o];return d&&d.length>0}getFirstFieldOfType(o,d=!1){return this.fieldByType[o]?.find(m=>d||!m.config.custom?.hidden)}hasFieldNamed(o){return!!this.fieldByName[o]}hasFieldWithNameAndType(o,d){return!!this.fieldByName[o]&&this.fieldByType[d].filter(i=>i.name===o).length>0}getFieldByName(o){return this.fieldByName[o]}getFieldsByLabel(o,d){return Object.values(this.fieldByName).filter(i=>i.labels&&i.labels[o]===d)}}},18700:(Z,R,e)=>{"use strict";e.d(R,{p:()=>d,k:()=>i});var n=e(2543),a=e(95004),s=e(41119);function l(c,m){return m.type||(m.name==="time"||m.name==="Time"?m.type=a.PU.time:m.type=(0,s.HW)(c)),m.type===a.PU.number?p=>parseFloat(p):m.type===a.PU.boolean?p=>!(p[0]==="F"||p[0]==="f"||p[0]==="0"):p=>p}var o=e(96453);const d=void 0;class i extends o.F{constructor(m,p){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=p||(h=>h??[]),m){const{name:h,refId:r,meta:g,fields:y}=m;if(h&&(this.name=h),r&&(this.refId=r),g&&(this.meta=g),y)for(const v of y)this.addField(v)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(m,p){return this.addField({name:p||"",type:(0,s.HW)(m)})}addField(m,p){let h;m.values&&(h=m.values);let r=m.type;!r&&(m.name==="time"||m.name==="Time")?r=a.PU.time:(!r&&h&&h.length&&(r=(0,s.HW)(h[0])),r||(r=a.PU.other));let g=m.name;g||(g=`Field ${this.fields.length+1}`);const y={...m,name:g,type:r,config:m.config||{},values:this.creator(h)};if(r===a.PU.other&&(r=(0,s.dF)(y),r&&(y.type=r)),this.fields.push(y),this.first=this.fields[0].values,p)for(;y.values.length<p;)y.values.push(d);else this.validate();return y}validate(){const m=this.fields.reduce((p,h)=>Math.max(p,h.values.length),0);for(const p of this.fields)for(;p.values.length!==m;)p.values.push(d)}setParser(m,p){return this.parsers||(this.parsers=new Map),this.parsers.set(m,p),p}parseValue(m,p){let h=this.parsers?.get(m);return h||(h=this.setParser(m,l(p,m))),h(p)}appendRow(m){for(let p=this.fields.length;p<m.length;p++)this.addField({name:`Field ${p+1}`,type:(0,s.HW)(m[p])});if(this.length<1)for(let p=0;p<this.fields.length;p++){const h=this.fields[p];(!h.type||h.type===a.PU.other)&&(h.type=(0,s.HW)(m[p]))}for(let p=0;p<this.fields.length;p++){const h=this.fields[p];let r=m[p];h.type!==a.PU.string&&(0,n.isString)(r)&&(r=this.parseValue(h,r)),h.values.push(r)}}push(...m){for(const p of m)this.add(p);return this.length}reverse(){for(const m of this.fields)m.values.reverse();return this}add(m){const p=m;for(const h of this.fields){let r=p[h.name];h.type!==a.PU.string&&(0,n.isString)(r)&&(r=this.parseValue(h,r)),r===void 0&&(r=d),h.values.push(r)}}set(m,p){if(m>this.length)throw new Error("Unable to set value beyond current length");const h=p||{};for(const r of this.fields)r.values[m]=h[r.name]}get(m){const p={};for(const h of this.fields)p[h.name]=h.values[m];return p}toJSON(){return(0,s.Kl)(this)}}},51388:(Z,R,e)=>{"use strict";e.d(R,{Kh:()=>i,Ls:()=>g,k9:()=>p,m8:()=>h});var n=e(8721),a=e(95004),s=e(71642),l=e(428),o=e(77154),d=e(41119),i=(E=>(E.Append="append",E.Replace="replace",E))(i||{});const c="__name__";var m=(E=>(E[E.wide=0]="wide",E[E.labels=1]="labels",E))(m||{});class p{constructor(D){this.options=D,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(C,P,T)=>{const O=P?Object.assign({},{...this.options,...P}):this.options,I=(0,d.By)(this,C),j=u(I.fields.map(B=>B.values??[]),typeof T?.maxLength=="number"?Math.min(T.maxLength,O.maxLength):O.maxLength,this.timeFieldIndex,O.maxDelta);I.fields=I.fields.map(B=>({...B,values:B.values?.slice(j)}));const W=I.fields[0]?.values?.length??0;return{...I,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:W,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:O}},this.initFromSerialized=C=>{this.name=C.name,this.refId=C.refId,this.meta=C.meta,this.length=C.length,this.labels=C.labels,this.schemaFields=C.schemaFields,this.timeFieldIndex=C.timeFieldIndex,this.pushMode=C.pushMode,this.packetInfo.length=C.packetInfo.length,this.packetInfo.number=C.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=C.fields.map(P=>({...P,type:P.type??a.PU.other,config:P.config??{},values:P.values??[]})),f(this.fields.map(P=>P.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:C,maxDelta:P})=>{const T=C&&this.options.maxLength<C,O=P&&this.options.maxDelta<P,I=P&&this.options.maxDelta===1/0;return!!(T||O||I)},this.resize=({maxLength:C,maxDelta:P})=>{P&&(this.options.maxDelta===1/0?this.options.maxDelta=P:this.options.maxDelta=Math.max(P,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,C??0)},this.pushNewValues=C=>{if(!C?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=C[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?x(this.fields.map(T=>T.values),C,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(C.forEach((T,O)=>{this.fields[O]&&(this.fields[O].values=T)}),f(this.fields.map(T=>T.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const P=this.fields?.[0]?.values.length;P!==void 0&&(this.length=P)},this.resetStateCalculations=()=>{this.fields.forEach(C=>{C.state={...C.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=C=>this.fields.map((P,T)=>C(P)?T:void 0).filter(P=>P!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(C=>{const P=C.values;return P.slice(Math.max(P.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=D=>{const C=new p(D.options);return C.initFromSerialized(D),C}}static{this.empty=D=>new p(h(D))}static{this.fromDataFrameJSON=(D,C)=>{const P=new p(h(C));return P.push(D),P}}get alwaysReplace(){return this.options.action==="replace"}push(D){const{schema:C,data:P}=D;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,C){this.pushMode=0,this.timeFieldIndex=C.fields.findIndex(j=>j.type===a.PU.time);const T=C.fields[0];this.timeFieldIndex===1&&T.type===a.PU.string&&(T.name==="labels"||T.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const O=this.pushMode===1?C.fields.slice(1):C.fields;this.refId=C.refId,C.meta&&(this.meta={...C.meta});const{displayNameFormat:I}=this.options;if(b(this.schemaFields,O)){const j=O.length;this.fields.forEach((W,B)=>{const S=O[B%j];W.config=S.config??{},W.labels=S.labels}),I&&this.fields.forEach(W=>{const B={[c]:W.name,...W.labels};W.config.displayNameFromDS=(0,l.j)(I,B)})}else{this.packetInfo.schemaChanged=!0;const j=this.pushMode===0;this.fields=O.map(W=>{const B=W.config??{};if(I){const S={[c]:W.name,...W.labels};B.displayNameFromDS=(0,l.j)(I,S)}return{config:B,name:W.name,labels:W.labels,type:W.type??a.PU.other,values:j?this.fields.find(S=>S.name===W.name&&W.type===S.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=O}if(P&&P.values.length&&P.values[0].length){let{values:T,entities:O}=P;if(O&&O.forEach((j,W)=>{j&&(0,o.t)(j,T[W])}),this.pushMode===1){const j=r(T);for(const S of j.keys())this.labels.has(S)||(this.packetInfo.schemaChanged=!0,this.addLabel(S));let W=Array(this.schemaFields.length).fill([]),B=[];this.labels.forEach(S=>{B.push(j.get(S)??W)}),T=(0,n.fj)(B)}if(T.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${T.length} (labels=${this.pushMode===1})`);this.fields=T.map((j,W)=>{let B=`Field ${W}`,S=(0,d.HW)(j[0]);return W===0&&S===a.PU.number&&j[0]>1600016688632&&(S=a.PU.time,B="Time"),{name:B,type:S,config:{},values:[]}})}let I=T;this.packetInfo.length=T[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",I=this.fields.map(j=>j.values),x(I,T,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),I.forEach((j,W)=>{const B=this.fields[W],{state:S}=B;B.values=j,S&&(S.calcs=void 0)}),this.length=I[0].length}return{...this.packetInfo}}addLabel(D){const{displayNameFormat:C}=this.options,P=this.labels.size,T=y(D);if(P===0)this.fields.forEach((O,I)=>{if(I>0&&(O.labels=T,C)){const j={[c]:O.name,...T};O.config.displayNameFromDS=(0,l.j)(C,j)}});else for(let O=1;O<this.schemaFields.length;O++){let I=this.schemaFields[O];const j=I.config??{};if(C){const W={[c]:I.name,...T};j.displayNameFromDS=(0,l.j)(C,W)}this.fields.push({...I,config:j,labels:T,values:Array(this.length).fill(void 0)})}this.labels.add(D)}}function h(E){return{maxLength:E?.maxLength??1e3,maxDelta:E?.maxDelta??1/0,action:E?.action??"append",displayNameFormat:E?.displayNameFormat}}function r(E){let D=new Set(E[0]),C=new Map;D.forEach(P=>{let T=Array(E.length-1).fill(null).map(()=>[]);C.set(P,T)});for(let P=0;P<E[0].length;P++){let T=C.get(E[0][P]);for(let O=1;O<E.length;O++)T[O-1].push(E[O][P])}return C}function g(E,D,C,P){let T;C=C||0,P=P||D.length-1;let O=P<=2147483647;for(;P-C>1;)T=O?C+P>>1:Math.floor((C+P)/2),D[T]<E?C=T:P=T;return E-D[C]<=D[P]-E?C:P}function y(E){if(!E.length)return{};if(E.charAt(0)==="{")return(0,s.Xy)(E);const D={};return E.split(",").forEach(C=>{const[P,T]=C.trim().split("=");D[P]=T}),D}function v(E){if(E instanceof p)return E.packetInfo.action}function x(E,D,C=1/0,P=0,T=1/0){for(let O=0;O<E.length;O++)for(let I=0;I<D[O].length;I++)E[O].push(D[O][I]);return f(E,C,P,T)}function f(E,D=1/0,C=0,P=1/0){const T=u(E,D,C,P);if(T)for(let O=0;O<E.length;O++)E[O].splice(0,T);return T}function u(E,D=1/0,C=0,P=1/0){if(!E[0]?.length)return 0;const T=E[0].length;let O=0;if(T>D&&(O=T-D),P!==1/0&&C>=0){const I=E[C],j=I[O],W=I[T-1];W-j>P&&(O=g(W-P,I,O))}return O}function b(E,D){if(E?.length!==D.length)return!1;for(let C=0;C<E.length;C++){const P=E[C],T=D[C];if(P.name!==T.name||P.type!==T.type)return!1}return!0}},76732:(Z,R,e)=>{"use strict";e.d(R,{J3:()=>l,ab:()=>d,bW:()=>s});var n=e(2543),a=e.n(n);function s(i,c,m){if(i===c)return!0;if(i?.fields?.length!==c?.fields?.length||i.name!==c.name)return!1;for(let p=0;p<i.fields.length;p++){const h=i.fields[p],r=c.fields[p];if(h.type!==r.type||h.name!==r.name)return!1;if(m)continue;if(h.labels&&r.labels&&!d(h.labels,r.labels))return!1;const g=h.config,y=r.config;if(Object.keys(g).length!==Object.keys(y).length)return!1;let v;for(v in g){if(!(v in y))return!1;if(v!=="interval"&&!(0,n.isEqual)(g[v],y[v]))return!1}}return!0}function l(i,c,m){if(i===c)return!0;if(i?.length!==c?.length)return!1;for(let p=0;p<i.length;p++)if(!m(i[p],c[p]))return!1;return!0}const o=(i,c)=>i===c;function d(i,c,m=o){if(i===c)return!0;if(Object.keys(i).length!==Object.keys(c).length)return!1;let p;for(p in i)if(!m(i[p],c[p]))return!1;return!0}},41119:(Z,R,e)=>{"use strict";e.d(R,{Bt:()=>N,By:()=>B,EI:()=>L,ES:()=>O,HW:()=>f,KR:()=>S,Kl:()=>W,LI:()=>C,N$:()=>M,Vc:()=>P,XQ:()=>b,Yn:()=>j,by:()=>v,ci:()=>D,dF:()=>u,oE:()=>x,pH:()=>E,q7:()=>I,w3:()=>T});var n=e(2543),a=e.n(n),s=e(25229),l=e(92446),o=e(16515),d=e(28105),i=e(95004),c=e(27359),m=e(77154);function p(A){const U=A.columns.map(F=>{const{text:V,type:K,...G}=F,H=[];return{name:V?.length?V:F,config:G||{},values:H,type:K&&Object.values(i.PU).includes(K)?K:i.PU.other}});if(!(0,n.isArray)(A.rows))throw new Error(`Expected table rows to be array, got ${typeof A.rows}.`);for(const F of A.rows)for(let V=0;V<U.length;V++)U[V].values.push(F[V]);for(const F of U)if(F.type===i.PU.other){const V=u(F);V&&(F.type=V)}return{fields:U,refId:A.refId,meta:A.meta,name:A.name,length:A.rows.length}}function h(A){const U=[],F=[],V=A.datapoints||A.points;for(const G of V)F.push(G[0]),U.push(G[1]);const K=[{name:i.LE,type:i.PU.time,config:{},values:U},{name:i.Bc,type:i.PU.number,config:{unit:A.unit},values:F,labels:A.tags}];return A.title&&(K[1].config.displayNameFromDS=A.title),{name:A.target||A.name,refId:A.refId,meta:A.meta,fields:K,length:F.length}}function r(A){const U=[],F=[];for(let V=0;V<A.data.length;V++){const K=A.data[V];U.push(K[1]),F.push(K[0])}return{name:A.label,fields:[{name:A.label||i.Bc,type:i.PU.number,config:{},values:U},{name:i.LE,type:i.PU.time,config:{unit:"dateTimeAsIso"},values:F}],length:U.length}}function g(A){const U=[{name:A.target,type:i.PU.other,labels:A.tags,config:{unit:A.unit,filterable:A.filterable},values:[]}];for(const F of A.datapoints)U[0].values.push(F);return{name:A.target,refId:A.target,meta:{json:!0},fields:U,length:A.datapoints.length}}const y=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function v(A,U){return A&&(A=A.toLowerCase(),A==="date"||A==="time")?i.PU.time:f(U)}function x(A){return A instanceof Date||(0,s.Ar)(A)?i.PU.time:(0,n.isNumber)(A)?i.PU.number:(0,n.isString)(A)?i.PU.string:(0,n.isBoolean)(A)?i.PU.boolean:i.PU.other}function f(A){return A instanceof Date||(0,s.Ar)(A)?i.PU.time:(0,n.isNumber)(A)?i.PU.number:(0,n.isString)(A)?y.test(A)?i.PU.number:A==="true"||A==="TRUE"||A==="True"||A==="false"||A==="FALSE"||A==="False"?i.PU.boolean:i.PU.string:(0,n.isBoolean)(A)?i.PU.boolean:i.PU.other}function u(A){if(A.name){const U=A.name.toLowerCase();if(U==="date"||U==="time")return i.PU.time}for(let U=0;U<A.values.length;U++){const F=A.values[U];if(F!=null)return f(F)}}const b=(A,U=!1)=>{for(const F of A.fields)if(!F.type||F.type===i.PU.other||U)return{...A,fields:A.fields.map(V=>V.type&&V.type!==i.PU.other&&!U?V:{...V,type:u(V)||i.PU.other})};return A},E=A=>!!(A&&A.hasOwnProperty("columns")),D=A=>!!(A&&A.hasOwnProperty("fields")),C=A=>!!(D(A)&&A.hasOwnProperty("value"));function P(A){if("fields"in A)return"length"in A&&A.fields[0]?.values?.get?A:L(A);if(A.hasOwnProperty("type")&&A.type==="docs")return g(A);if(A.hasOwnProperty("datapoints")||A.hasOwnProperty("points"))return h(A);if(A.hasOwnProperty("data"))return A.hasOwnProperty("schema")?(0,m.or)(A):r(A);if(A.hasOwnProperty("columns"))return p(A);if(Array.isArray(A))return(0,c.I)(A);throw console.warn("Can not convert",A),new Error("Unsupported data format")}const T=A=>{const{fields:U}=A,F=A.length,V=[];if(U.length===2){const{timeField:K,timeIndex:G}=S(A);if(K){const _=U[G===0?1:0],k=U[G];for(let J=0;J<F;J++)V.push([_.values[J],k.values[J]]);return{alias:A.name,target:(0,o.Ct)(_,A),datapoints:V,unit:U[0].config?U[0].config.unit:void 0,refId:A.refId,meta:A.meta}}}for(let K=0;K<F;K++){const G=[];for(let H=0;H<U.length;H++)G.push(U[H].values[K]);V.push(G)}return A.meta&&A.meta.json?{alias:U[0].name||A.name,target:U[0].name||A.name,datapoints:U[0].values,filterable:U[0].config?U[0].config.filterable:void 0,type:"docs"}:{columns:U.map(K=>{const{name:G,config:H}=K;if(H){const{..._}=H;return _.text=G,_}return{text:G}}),type:"table",refId:A.refId,meta:A.meta,rows:V}};function O(A,U,F=!1){const V=A.fields[U];if(!V)return A;const K=[];for(let H=0;H<A.length;H++)K.push(H);const G=(0,l.i)(V,F);return K.sort(G),{...A,fields:A.fields.map(H=>{const _={...H,values:H.values.map((J,z)=>H.values[K[z]])},{nanos:k}=H;return k!==void 0&&(_.nanos=k.map((J,z)=>k[K[z]])),_})}}function I(A){return{...A,fields:A.fields.map(U=>{const F=[...U.values];F.reverse();const V={...U,values:F},{nanos:K}=U;if(K!==void 0){const G=[...K];G.reverse(),V.nanos=G}return V})}}function j(A,U){const F=[];for(const V of A.fields)F.push(V.values[U]);return F}function W(A){return B(A)}function B(A,U){return{fields:(U?A.fields.filter(U):A.fields).map(K=>{let G=K.values;return{name:K.name,type:K.type,config:K.config,values:G,labels:K.labels}}),refId:A.refId,meta:A.meta,name:A.name}}const S=A=>{for(let U=0;U<A.fields.length;U++)if(A.fields[U].type===i.PU.time)return{timeField:A.fields[U],timeIndex:U};return{}};function w(A){const U=b(P(A));if(U.fields&&U.fields.length)for(const F of U.fields)F.state=null;return U}function N(A){return!A||!(0,n.isArray)(A)?[]:A.map(U=>w(U))}function M(A,U){const{series:F,annotations:V}=A;if(A.state===d.Gu.Loading&&F.length===0)return U||(U=A),{...U,state:d.Gu.Loading,request:A.request};const K=performance.now(),G=F.map(k=>w(k)),H=N(V),_=performance.now();return{...A,series:G,annotations:H,timings:{dataProcessingTime:_-K}}}function L(A){let U=0;const F=A.fields.map((V,K)=>{const{state:G,...H}=V;return H.name||(H.name=`Field ${K+1}`),H.config||(H.config={}),H.values?H.values.length>U&&(U=H.values.length):H.values=new Array(U),H.type||(H.type=u(H)??i.PU.other),H});return{...A,fields:F,length:U}}},17503:(Z,R,e)=>{"use strict";e.d(R,{S1:()=>c,aH:()=>l,hF:()=>d,jq:()=>o,t9:()=>m,tP:()=>i,uY:()=>p});var n=e(95004),a=e(41119);const s=100;function l(h){if(h.fields.length<2)return!1;const r=h.fields.find(y=>y.type===n.PU.number);let g=!1;for(const y of h.fields)if(d(y)){g=!0;break}return g&&r!==void 0}function o(h){return!h.find(r=>!l(r))}function d(h){if(h.type!==n.PU.time)return!1;let r=null,g=h.values.length>s?s:h.values.length;for(let y=0;y<g;y++){const v=h.values[y];if(r===null||v!==null&&v>r)r=v;else return!1}return!0}function i(h){for(let r=0;r<h.length;r++){const g=(0,a.KR)(h[r]);if(g.timeField!==void 0&&g.timeIndex!==void 0)return!0}return!1}function c(h){return h.fields.some(r=>r.type===n.PU.time)}function m(h,r){if(h.meta?.uniqueRowIdFields!==void 0)return h.meta.uniqueRowIdFields.map(g=>h.fields[g].values[r]).join("-")}function p(h,r){if(r instanceof Array)for(let g=0;g<r.length;g++)h.fields[g].values.push(r[g]);else for(const g of h.fields)g.values.push(r[g.name]);try{h.length++}catch{}}},74529:(Z,R,e)=>{"use strict";e.d(R,{E9:()=>i,Q7:()=>d,Ri:()=>c,V3:()=>g,WT:()=>m,dU:()=>o,di:()=>h,pp:()=>r,vd:()=>p});var n=e(47402),a=e(67676),s=e(66907);const l={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function o(v,x=!0){if((0,n.d)(v.start,v.end))return"";const f=(0,a.F)(v);return d(f,x)}function d(v,x){return Object.entries(v).reduce((f,[u,b])=>b&&b!==0&&!(u==="seconds"&&!x&&f)?f+`${f!==""?" ":""}${b}${l[u][0]}`:f,"")}function i(v){return v.split(" ").reduce((x,f)=>{const u=f.match(/(\d+)(.+)/),b=u?.[1],E=u?.[2];if(!(b&&E))return x;const D=Object.entries(l).find(([P,T])=>T?.includes(u[2])),C=parseInt(b,10);return D?{...x,[D[0]]:C}:x},{})}function c(v,x){return(0,s.W)(v,x)}function m(v){const x=new Date;return c(x,v).getTime()-x.getTime()}function p(v){return!isNaN(Date.parse(v))}function h(v){for(const x of v.trim().split(" ")){const f=x.match(/(\d+)(.+)/);if(f===null||f.length!==3||!Object.entries(l).find(([b,E])=>E?.includes(f[2]))?.[0])return!1}return!0}function r(v){return y(v,["h","m","s","ms","us","\xB5s","ns"])}function g(v){return y(v,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function y(v,x){for(const f of v.trim().split(" ")){const u=f.match(/([0-9]*[.]?[0-9]+)(.+)/);if(u===null||u.length!==3||!x.includes(u[2]))return!1}return!0}},62717:(Z,R,e)=>{"use strict";e.d(R,{HD:()=>c,P3:()=>p,QZ:()=>m,U3:()=>h,g$:()=>d,le:()=>i});var n=e(2543),a=e.n(n),s=e(84743),l=e.n(s),o=e(60188),d=(f=>(f.default="",f.localBrowserTime="browser",f.utc="utc",f))(d||{});const i=f=>{switch((0,o.O)({timeZone:f})){case"browser":return"Local browser time";case"utc":return"UTC";default:return f}},c=f=>l().tz.zone(f),m=(f,u)=>{const b=r(f,u);return b||y(f,u)},p=(0,n.memoize)((f=!1)=>{const u=[];return f===!0?u.push("","browser","utc"):f&&u.push(...f),l().tz.names().reduce((b,E)=>{const D=x[E];return!Array.isArray(D)||D.length===0||b.push(E),b},u)}),h=(0,n.memoize)((f=!1)=>{const b=p(f).reduce((E,D)=>{const C=D.indexOf("/");if(C===-1){const T="";return E[T]=E[T]??[],E[T].push(D),E}const P=D.slice(0,C);return E[P]=E[P]??[],E[P].push(D),E},{});return Object.keys(b).map(E=>({name:E,zones:b[E]}))}),r=(f,u)=>{switch(f){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:f,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const b=(0,o.O)(),D=b==="browser"||b==="utc"?r(b,u):y(b,u);return{countries:x[b]??[],abbreviation:"",offsetInMins:0,...D,ianaName:D?.ianaName??"",name:"Default",zone:f}}case"browser":{const b=l().tz.guess(!0),E=y(b,u);return{countries:x[b]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...E,name:"Browser Time",ianaName:E?.ianaName??"",zone:f}}default:return}},g=f=>/^(\+|\-).+/.test(f)?"":f,y=(f,u)=>{const b=l().tz.zone(f);if(b)return{name:f,ianaName:b.name,zone:f,countries:x[f]??[],abbreviation:g(b.abbr(u)),offsetInMins:b.utcOffset(u)}},v={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},x=l().tz.countries().reduce((f,u)=>l().tz.zonesForCountry(u).reduce((E,D)=>{E[D]||(E[D]=[]);const C=v[u];return!C||u==="AQ"&&!D.startsWith("Antarctica/")||E[D].push({code:u,name:C}),E},f),{})},57852:(Z,R,e)=>{"use strict";e.d(R,{LL:()=>m,LO:()=>l,NI:()=>c,Tp:()=>p,We:()=>o,b_:()=>a,gc:()=>d,ql:()=>s,wE:()=>i});var n=e(68388);class a extends n.x{static{this.type="data-hover"}}class s extends n.a{static{this.type="data-hover-clear"}}class l extends n.x{static{this.type="data-select"}}class o extends n.x{static{this.type="annotation-event"}}class d extends n.x{static{this.type="dashboard-loaded"}}class i extends n.a{static{this.type="datasource-updated-successfully"}}class c extends n.a{static{this.type="datasource-test-succeeded"}}class m extends n.a{static{this.type="datasource-test-failed"}}class p extends n.x{static{this.type="set-panel-attention"}}},36819:(Z,R,e)=>{"use strict";e.d(R,{R:()=>a});const n=new Set;function a(s){if(n.has(s))throw new Error(`There is already an event defined with type '${s}'`);return n.add(s),{name:s}}},76803:(Z,R,e)=>{"use strict";e.d(R,{K:()=>a});var n=e(42954);class a extends n.O{}},11576:(Z,R,e)=>{"use strict";e.d(R,{H:()=>y,J:()=>r});var n=e(2543),a=e.n(n),s=e(41119),l=e(25229),o=e(44922),d=e(95004),i=e(13227),c=e(35987),m=e(55386),p=e(79118);const h={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function r(x){if(!x||(0,n.isEmpty)(x)||!x.field)return g;const f=x.field,u=f.config??{},{palette:b}=x.theme.visualization;let E=u.unit,D=E&&(h[E]||E.startsWith("time:")),C=!1;if(f.type===d.PU.time&&!D){if(E="dateTimeAsSystem",D=!0,f.values&&f.values.length>1){let S=f.values[0],w=f.values[f.values.length-1];typeof S=="string"?(S=(0,o.b)(S).unix(),w=(0,o.b)(w).unix()):(S/=1e3,w/=1e3),C=Math.abs(w-S)<60}}else f.type===d.PU.boolean?(0,m.j9)(E)||(E="bool"):!E&&f.type===d.PU.string&&(E="string");const P=E?.startsWith("currency"),T=(0,m.j9)(E),O=f.type===d.PU.number,j=!D&&!P&&!T&&!(E==="locale")&&O&&u.decimals==null,W=(0,m.j_)(E||"none"),B=(0,p.jc)(f,x.theme);return(S,w)=>{const{mappings:N}=u,M=E==="string";D&&typeof S=="string"&&(S=(0,l.yT)(S).valueOf());let L=M?NaN:(0,i.t)(S),A,U,F,V,K,G;if(N&&N.length>0){const _=(0,c.Zz)(N,S);_&&(_.text!=null&&(A=_.text),_.color!=null&&(V=x.theme.visualization.getColorByName(_.color)),_.icon!=null&&(K=_.icon))}else if(f.type===d.PU.enum){if(S==null)return{text:"",numeric:NaN};const _=+S;if(u&&u.type&&u.type.enum){const{text:k,color:J}=u.type.enum;if(A=k?k[_]:`${S}`,V=J?J[_]:void 0,V==null){const z=b[_%b.length];V=x.theme.visualization.getColorByName(z)}}}if(!Number.isNaN(L)){if(A==null&&!(0,n.isBoolean)(S)){let _;j&&w!=null?(_=W(L,w,null,x.timeZone,C),_.text=+_.text+""):_=W(L,u.decimals,null,x.timeZone,C),A=_.text,F=_.suffix,U=_.prefix}if(V==null){const _=B(L);V=_.color,G=_.percent}}if(A==null&&(0,n.isArray)(S)&&(A=(0,n.join)(S,", ")),A==null&&(A=(0,n.toString)(S),A||(u.noValue?A=u.noValue:A="")),!V){const _=B(-1/0);V=_.color,G=_.percent}const H={text:A,numeric:L,prefix:U,suffix:F,color:V};return K!=null&&(H.icon=K),G!=null&&(H.percent=G),H}}function g(x){return{text:(0,n.toString)(x),numeric:(0,i.t)(x)}}function y(){return x=>({text:(0,s.oE)(x)==="other"?`${JSON.stringify(x,v())}`:`${x}`,numeric:null})}const v=()=>{const x=new WeakSet;return(f,u)=>{if(typeof u=="object"&&u!==null){if(x.has(u))return;x.add(u)}return u}}},76637:(Z,R,e)=>{"use strict";e.d(R,{Hs:()=>y,Qi:()=>g,lz:()=>v,uf:()=>h});var n=e(21197),a=e(55459),s=e.n(a),l=e(84140),o=e(6773),d=e(46644),i=e(64394),c=e(42954),m=e(79118),p=e(36394);const h=new c.O(()=>[{id:i.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:x},{id:i.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:f},{id:i.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(u,b)=>(E,D,C)=>{const P=C??p.QS;return b.visualization.getColorByName(P.color)}},new r({id:i.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:u=>u.visualization.palette}),new r({id:i.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:u=>u.visualization.palette.filter(b=>(0,o.eM)(u.visualization.getColorByName(b),u.colors.background.primary)>=u.colors.contrastThreshold)}),new r({id:i.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["green","yellow","red"]}),new r({id:i.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:u=>["red","yellow","green"]}),new r({id:i.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["dark-blue","super-light-yellow","dark-red"]}),new r({id:i.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-red"]}),new r({id:i.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:u=>["blue","purple"]}),new r({id:i.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-blue"]}),new r({id:i.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-blue"]}),new r({id:i.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-red"]}),new r({id:i.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-green"]}),new r({id:i.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-purple"]})]);class r{constructor(b){this.id=b.id,this.name=b.name,this.description=b.description,this.getNamedColors=b.getColors,this.isContinuous=b.isContinuous,this.isByValue=b.isByValue,this.useSeriesName=b.useSeriesName}getColors(b){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===b?this.colorCache:(this.colorCache=this.getNamedColors(b).map(b.visualization.getColorByName),this.colorCacheTheme=b,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,n.Ik)(this.colorCache)),this.interpolator}getCalculator(b,E){const D=this.getColors(E);return this.isByValue?this.isContinuous?(C,P,T)=>this.getInterpolator()(P):(C,P,T)=>D[P*(D.length-1)]:this.useSeriesName?(C,P,T)=>D[Math.abs(s()(b.state?.displayName??b.name))%D.length]:(C,P,T)=>{const O=b.state?.seriesIndex??0;return D[O%D.length]}}}function g(u){return h.get(u.config.color?.mode??i.Y.Thresholds)}function y(u){return h.get(u??i.Y.Thresholds)}function v(u,b){const E=g(u);if(!E.isByValue)return{color:E.getCalculator(u,b)(0,0),threshold:p.QS,percent:1};const D=(0,m.jc)(u,b),C=u.config.color?.seriesBy??"last",T=(0,d.Nw)({field:u,reducers:[C]})[C]??0;return D(T)}function x(u,b){return()=>b.visualization.getColorByName(u.config.color?.fixedColor??i.F)}function f(u,b){return()=>{const E=b.visualization.getColorByName(u.config.color?.fixedColor??i.F),D=[E],C=6,P=10,T=35,O=35;for(let j=1;j<C;j++)D.push((0,l.A)(E).spin(j/C*P).brighten(j/C*T).toHexString()),D.push((0,l.A)(E).spin(-(j/C)*P).darken(j/C*O).toHexString());const I=u.state?.seriesIndex??0;return D[I%D.length]}}},92446:(Z,R,e)=>{"use strict";e.d(R,{i:()=>o});var n=e(2543),a=e.n(n),s=e(25229),l=e(95004);const o=(u,b=!1)=>{const E=u.values;switch(u.type){case l.PU.number:return v(E,b);case l.PU.string:return x(E,b);case l.PU.boolean:return y(E,b);case l.PU.time:return typeof u.values[0]=="number"?r(E,b):g(E,b);default:return f(b)}},d=(u,b)=>{if(!u||!b)return h(u,b);if((0,n.isNumber)(u)&&(0,n.isNumber)(b))return i(u,b);if((0,s.u8)(u)&&(0,s.u8)(b)){if((0,s.KQ)(u).isBefore(b))return-1;if((0,s.KQ)(b).isBefore(u))return 1}return 0},i=(u,b)=>u-b,c=new Intl.Collator("en",{sensitivity:"base"}).compare,m=(u,b)=>!u||!b?h(u,b):c(String(u),String(b)),p=(u,b)=>h(u,b),h=(u,b)=>!u&&b?1:u&&!b?-1:0,r=(u,b)=>{let E=b?-1:1;return(D,C)=>E*(u[D]-u[C])},g=(u,b)=>(E,D)=>{const C=u[E],P=u[D];return b?d(P,C):d(C,P)},y=(u,b)=>(E,D)=>{const C=u[E],P=u[D];return b?p(P,C):p(C,P)},v=(u,b)=>(E,D)=>{const C=u[E],P=u[D];return b?i(P,C):i(C,P)},x=(u,b)=>(E,D)=>{const C=u[E],P=u[D];return b?m(P,C):m(C,P)},f=u=>(b,E)=>u?i(E,b):i(b,E)},44232:(Z,R,e)=>{"use strict";e.d(R,{PI:()=>f,Pm:()=>x,XS:()=>C,Zo:()=>O,a_:()=>v,eG:()=>D,k3:()=>h,k_:()=>y,nF:()=>g,py:()=>r});var n=e(2543),a=e.n(n),s=e(88673),l=e(41119),o=e(46644),d=e(36638),i=e(57866),c=e(95004),m=e(11576),p=e(16515);const h="__series.name",r="__field.displayName",g="__field.labels",y="__calc",v="__cell_",x=25,f=j=>{const{replaceVariables:W,reduceOptions:B,timeZone:S,theme:w}=j,N=B.calcs.length?B.calcs:[o.gy.last],M=[],L=(0,d.NS)(B.fields?{id:i.Ct.byRegexp,options:B.fields}:{id:i.Ct.numeric}),A=j.data??[],U=B.limit?B.limit:x;let F=!1;for(let V=0;V<A.length&&!F;V++){const K=A[V],{timeField:G}=(0,l.KR)(K),H=new s.R(K);for(let _=0;_<K.fields.length&&!F;_++){const k=K.fields[_],J=k.getLinks;if(!L(k,K,A))continue;let z=k.config;k.state?.range&&(z={...z,...k.state?.range});let Y=k.config.displayName??"";const X=k.display??(0,m.J)({field:k,theme:j.theme,timeZone:S});if(B.values)for(let Q=0;Q<k.values.length;Q++){k.state=b(k,M.length);const q=I(k,Q),te=X(k.values[Q]),ne=u(K,k,Q,W,q),se=E(ne,j.fieldConfig,w);if(M.push({name:"",field:z,display:{...te,title:ne,color:se??te.color},view:H,colIndex:_,rowIndex:Q,getLinks:J?()=>J({valueRowIndex:Q}):()=>[],hasLinks:D(k)}),M.length>=U){F=!0;break}}else{const Q=(0,o.Nw)({field:k,reducers:N});for(const q of N){const te=k.state?.scopedVars??{};te[y]={value:q,text:q};const ne=X(Q[q]);Y!==""?ne.title=W(Y,te):ne.title=(0,p.Ct)(k,K,A),ne.percentChange=j.percentChange?(0,o.Nw)({field:k,reducers:[o.gy.diffperc]}).diffperc:void 0;let se;j.sparkline&&(se={y:K.fields[_],x:G},q===o.gy.last?se.highlightIndex=se.y.values.length-1:q===o.gy.first&&(se.highlightIndex=0));const ue=K.length===1?0:void 0;M.push({name:q,field:z,display:ne,sparkline:se,view:H,colIndex:_,getLinks:J?()=>J({calculatedValue:ne,valueRowIndex:ue}):()=>[],hasLinks:D(k)})}}}}return M.length===0&&M.push(P(j)),M};function u(j,W,B,S,w){const N=W.config.displayName;if(N)return N.indexOf(v)?S(O(N),w):S(N,w);let M=[],L=0;for(const A of j.fields)if(A!==W)if(A.type===c.PU.string){const U=A.values[B]??"",F=A.display?A.display(U).text:U;F.length>0&&M.push(F)}else A.type===c.PU.number&&L++;return(L||M.length===0)&&M.push((0,p.Ct)(W,j)),M.join(" ")}function b(j,W){return{...j.state,seriesIndex:W}}function E(j,W,B){for(const S of W.overrides)if(S.matcher.id==="byName"&&S.matcher.options===j){for(const w of S.properties)if(w.id==="color"&&w.value)return B.visualization.getColorByName(w.value.fixedColor)}return null}function D(j){return j.config?.links?.length?j.config.links.length>0:!1}function C(j){let W="",B="",S="",w="";for(let N=0;N<j.length;N++){const M=j[N].display;M.text&&M.text.length>B.length&&(B=M.text),M.title&&M.title.length>W.length&&(W=M.title),M.prefix&&M.prefix.length>S.length&&(S=M.prefix),M.suffix&&M.suffix.length>w.length&&(w=M.suffix)}return{text:B,title:W,suffix:w,prefix:S}}function P(j){const W="No data",{fieldConfig:B,timeZone:S}=j,{defaults:w}=B,M=(0,m.J)({field:{name:"",type:c.PU.other,config:w},theme:j.theme,timeZone:S})(null),L=T(M,W);return{name:W,field:{...w,max:w.max??0,min:w.min??0},display:{text:L,numeric:0,color:M.color},hasLinks:!1}}function T(j,W){return!j||(0,n.isEmpty)(j.text)?W:j.text}function O(j){return j.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(W,B,S,w,N,M,L)=>`\${__data.fields[${B??w??M}]${S??N??L}}`)}function I(j,W){return j.state?.scopedVars?.__dataContext?{...j.state?.scopedVars,__dataContext:{value:{...j.state?.scopedVars?.__dataContext.value,rowIndex:W}}}:j.state?.scopedVars}},60519:(Z,R,e)=>{"use strict";e.d(R,{BF:()=>I,K3:()=>B,_M:()=>W,nJ:()=>b,rJ:()=>S,vd:()=>w,we:()=>E});var n=e(2543),a=e.n(n),s=e(96540),l=e(84596),o=e(21275),d=e(739),i=e(76732),c=e(41119),m=e(6773),p=e(46644),h=e(36638),r=e(95004),g=e(64394),y=e(38036),v=e(92138),x=e(11576),f=e(79118),u=e(53543);function b(N){let M=null,L=null;const A=[p.gy.min,p.gy.max];for(const U of N)for(const F of U.fields)if(F.type===r.PU.number){const V=(0,p.Nw)({field:F,reducers:A}),K=V[p.gy.min],G=V[p.gy.max];(M===null||K<M)&&(M=K),(L===null||G>L)&&(L=G)}return{min:M,max:L,delta:(L??0)-(M??0)}}function E(N){if(!N.data)return[];const M=N.fieldConfig;if(!M)return N.data;const L=N.fieldConfigRegistry??u.G;let A=0,U;const F=[];if(M.overrides)for(const V of M.overrides){const K=h.sJ.get(V.matcher.id);K&&F.push({match:K.get(V.matcher.options),properties:V.properties})}return N.data.map((V,K)=>{const G={...V};G.fields=G.fields.map(H=>({...H,config:(0,n.cloneDeep)(H.config),state:{...H.state}}));for(const H of G.fields){const _=H.config;H.state.scopedVars={__dataContext:{value:{data:N.data,frame:G,frameIndex:K,field:H}}};const k={field:H,data:N.data,dataFrameIndex:K,replaceVariables:N.replaceVariables,fieldConfigRegistry:L};T(_,M.defaults,k);for(const X of F)if(X.match(H,G,N.data))for(const Q of X.properties)P(_,Q,k);let J=H.type;if(!J||J===r.PU.other){const X=(0,c.dF)(H);X&&(J=X)}const{range:z,newGlobalRange:Y}=D(_,H,U,N.data);if(U=Y,H.state.displayName=null,H.state.seriesIndex=A,H.state.range=z,H.type=J,H.type!==r.PU.time&&A++,H.display=(0,x.J)({field:H,theme:N.theme,timeZone:N.timeZone}),H.config.unit!=="dateTimeFromNow"&&(H.display=C(H.display,2500)),H.getLinks=W(G,H,H.state.scopedVars,k.replaceVariables,N.timeZone,N.dataLinkPostProcessor),H.type===r.PU.nestedFrames)for(const X of H.values)for(let Q=0;Q<X.length;Q++)for(const q of X[Q].fields)q.display=(0,x.J)({field:q,theme:N.theme,timeZone:N.timeZone}),q.state={scopedVars:{__dataContext:{value:{data:X,frame:X[Q],frameIndex:Q,field:q}}}},q.getLinks=W(X[Q],q,q.state.scopedVars,k.replaceVariables,N.timeZone,N.dataLinkPostProcessor)}return G})}function D(N,M,L,A){if(M.type!==r.PU.number||(0,n.isNumber)(N.min)&&(0,n.isNumber)(N.max))return{newGlobalRange:L};if(N.fieldMinMax){const K=(0,f.AP)(M),G=N.min??K.min,H=N.max??K.max;return{range:{min:G,max:H,delta:H-G},newGlobalRange:L}}const U=L??b(A),F=N.min??U.min,V=N.max??U.max;return{range:{min:F,max:V,delta:V-F},newGlobalRange:U}}function C(N,M=2500){const L=new Map;for(let A=-1;A<=15;A++)L.set(A,new Map);return(A,U)=>{let F=L.get(U??-1),V=F.get(A);return V||(F.size===M&&F.clear(),V=N(A,U),V.color&&(V.color=(0,m.ze)(V.color)),F.set(A,V)),V}}function P(N,M,L){const U=L.fieldConfigRegistry.getIfExists(M.id);if(!U)return;const F=U.process(M.value,L,U.settings);F==null?U.isCustom&&N.custom?(0,n.unset)(N.custom,U.path):(0,n.unset)(N,U.path):U.isCustom?(N.custom||(N.custom={}),(0,n.set)(N.custom,U.path,F)):(0,n.set)(N,U.path,F)}function T(N,M,L){N.links&&M.links&&(N.links=[...N.links,...M.links]);const A=M?.thresholds?.mode===o.Ol.Absolute&&M.thresholds?.steps.find(U=>U.value===-1/0);N.thresholds?.mode===o.Ol.Absolute&&!N.thresholds.steps.some(U=>U.value===-1/0)&&A&&(N.thresholds.steps=[A,...N.thresholds.steps]);for(const U of L.fieldConfigRegistry.list())U.isCustom&&!N.custom&&(N.custom={}),O(U.isCustom?N.custom:N,U.isCustom?M.custom:M,U,L);I(N)}function O(N,M,L,A){const U=(0,n.get)(N,L.path);if(U==null){const F=A.fieldConfigRegistry.getIfExists(L.id);if(!F)return;if(F&&F.shouldApply(A.field)){const V=F.process((0,n.get)(M,F.path),A,F.settings);V!=null&&(0,n.set)(N,F.path,V)}}}function I(N){const{thresholds:M}=N;if(N.color?N.color.mode||delete N.color:M&&(N.color={mode:g.Y.Thresholds}),N.hasOwnProperty("min")&&N.hasOwnProperty("max")&&N.min>N.max){const L=N.max;N.max=N.min,N.min=L}}const j=N=>{const{link:M,linkModel:L,dataLinkScopedVars:A,field:U,replaceVariables:F}=N;return M.internal?(0,y.u)({link:M,internalLink:M.internal,scopedVars:A,field:U,range:M.internal.range,replaceVariables:F}):L},W=(N,M,L,A,U,F)=>V=>!M.config.links||M.config.links.length===0?[]:M.config.links.map(G=>{const H=w(N,M,L),_={...L,__dataContext:H},k=(Y,X,Q)=>A(Y,{..._,...X},Q);V.valueRowIndex!==void 0&&!isNaN(V.valueRowIndex)?H.value.rowIndex=V.valueRowIndex:H.value.calculatedValue=V.calculatedValue;let J,z=G.onClick||!G.onBuildUrl?G.url:G.onBuildUrl({origin:M,replaceVariables:k});return z&&(z=v.I.assureBaseUrl(z.replace(/\n/g,"")),z=A(z,_,d.$m.UriEncode),z?.length>0&&(z=v.I.processUrl(z))),G.onClick?J={href:z,title:A(G.title||"",_),target:G.targetBlank?"_blank":void 0,onClick:(Y,X)=>{G.onClick({origin:X??M,e:Y,replaceVariables:k})},origin:M,oneClick:G.oneClick??!1}:J={href:z,title:A(G.title||"",_),target:G.targetBlank?"_blank":void 0,origin:M,oneClick:G.oneClick??!1},(F||j)({frame:N,field:M,dataLinkScopedVars:_,replaceVariables:A,config:V,link:G,linkModel:J})}).filter(G=>!!G);function B(N){if(!N||N.length===0)return[];const M=[...N],L=(0,x.H)();for(let A=0;A<M.length;A++){const U={...M[A]},F=[...U.fields];for(let V=0;V<F.length;V++)F[V]={...F[V],display:L};M[A]={...U,fields:F}}return M}function S(N,M,L,A,U,F,V){const K=N?.fieldConfigRegistry,G=(0,s.useRef)(0),H=(0,l.A)(L?.series);return(0,s.useMemo)(()=>{if(!K||!M||!L)return;const _=L?.series;L.structureRev==null&&_&&H&&!(0,i.J3)(_,H,i.bW)&&G.current++;const k={structureRev:G.current,...L,series:E({data:_,fieldConfig:M,fieldConfigRegistry:K,replaceVariables:F,theme:U,timeZone:A,dataLinkPostProcessor:V})};return L.annotations&&L.annotations.length>0&&(k.annotations=E({data:L.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:F,theme:U,timeZone:A,dataLinkPostProcessor:V})),k},[K,M,L,H,A,U,F,V])}function w(N,M,L){return L?.__dataContext?{value:{...L.__dataContext.value}}:{value:{frame:N,field:M,data:[N]}}}},16515:(Z,R,e)=>{"use strict";e.d(R,{Ct:()=>i,Fm:()=>o,Ri:()=>l,fk:()=>m,j2:()=>d});var n=e(36638),a=e(95004),s=e(71642);function l(h,r){if(h.name)return h.name;const g=[];for(const y of h.fields)if(y.type!==a.PU.time){if(g.length>1)break;g.push(i(y,h))}return g.length===1?g[0]:r===void 0&&h.fields.length>0?h.fields.filter(y=>y.type!==a.PU.time).map(y=>i(y,h)).join(", "):h.refId?`Series (${h.refId})`:`Series (${r})`}function o(h){h.forEach(r=>{r.fields.forEach(g=>{i(g,r,h)})})}function d(h,r){h.forEach(g=>{g.fields.forEach(y=>{const v={legend:!1,tooltip:!1,viz:!1,...r.defaults.custom?.hideFrom},x=y.config.custom?.hideFrom;r.overrides.forEach(f=>{if("__systemRef"in f)return;if((0,n.NS)(f.matcher)(y,g,h))for(const b of f.properties)b.id==="custom.hideFrom"&&Object.assign(v,b.value)}),y.state={...y.state,hideFrom:{...x}},y.config.custom.hideFrom=v})})}function i(h,r,g){const y=h.state?.displayName,v=!!(g&&g.length>1);if(y&&v===h.state?.multipleFrames)return y;const x=c(h,r,g);return h.state=h.state||{},h.state.displayName=x,h.state.multipleFrames=v,x}function c(h,r,g){const y=h.config?.displayName&&h.config?.displayName.length,v=!!r?.meta?.timeCompare?.isTimeShiftQuery;let x=y?h.config.displayName:h.name;if(y)return v?`${x} (comparison)`:x;if(r&&h.config?.displayNameFromDS)return v?`${h.config.displayNameFromDS} (comparison)`:h.config.displayNameFromDS;if(h.type===a.PU.time&&!h.labels)return x??a.LE;let f=[],u=!1;if(g&&g.length>1){for(let D=1;D<g.length;D++)if(g[D].name!==g[D-1].name){u=!0;break}}let b=!1,E=!1;if(u&&r?.name&&(f.push(r.name),b=!0),h.name&&h.name!==a.Bc&&f.push(h.name),h.labels&&r){let D=p(g??[r]);if(D)h.labels[D]&&(f.push(h.labels[D]),E=!0);else{let C=(0,s.h6)(h.labels);C&&(f.push(C),E=!0)}}return r&&!b&&!E&&h.name===a.Bc&&r.name&&r.name.length>0&&(f.push(r.name),b=!0),f.length?x=f.join(" "):h.name?x=h.name:x=a.Bc,x===h.name&&(x=m(h,r)),v&&(x=`${x} (comparison)`),x}function m(h,r){let g=0,y=!1;if(r)for(let v=0;v<r.fields.length;v++){const x=r.fields[v];if(h===x){if(y=!0,g>0){g++;break}}else if(h.name===x.name&&(g++,y))break}return g?`${h.name} ${g}`:h.name}function p(h){let r=null;for(let g=0;g<h.length;g++){const y=h[g];for(const v of y.fields)if(v.labels){for(const x in v.labels)if(r===null)r=x;else if(x!==r)return null}}return r}},7102:(Z,R,e)=>{"use strict";e.d(R,{F:()=>o});var n=e(2543),a=e.n(n),s=e(55386),l=e(11576);function o(d){return new Proxy({},{get:(i,c)=>{let m=d.frame.fields.find(g=>c===g.name);if(!m){const g=(0,n.toNumber)(c);m=d.frame.fields[g]}if(m||(m=d.frame.fields.find(g=>c===g.config.displayName)),m||(m=d.frame.fields.find(g=>g.labels?c===g.labels.name:!1)),!m)return;const p=m.display??(0,l.J)(),h=m.values[d.rowIndex],r=p(h);return r.toString=()=>(0,s.cN)(r),r}})}},38809:(Z,R,e)=>{"use strict";e.d(R,{AM:()=>s,Ch:()=>l,FM:()=>h,N7:()=>m,OU:()=>c,X4:()=>r,cz:()=>o,hL:()=>i,hS:()=>n,lG:()=>p,m0:()=>a,xT:()=>d});const n=g=>g,a=(g,y,v)=>{if(g!=null)return parseFloat(String(g))},s=(g,y,v)=>(delete y.field?.state?.displayName,c(g,y,v)),l=(g,y,v)=>g,o=(g,y,v)=>g,d=(g,y,v)=>g,i=(g,y,v)=>g,c=(g,y,v)=>g==null?g:v&&v.expandTemplateVars&&y.replaceVariables&&typeof g=="string"?y.replaceVariables(g,y.field.state.scopedVars):`${g}`,m=(g,y,v)=>g,p=(g,y,v)=>g,h=(g,y,v)=>g;var r=(g=>(g.IncludeAll="all",g.ExcludeBaseNames="exclude",g.OnlyBaseNames="only",g))(r||{})},79118:(Z,R,e)=>{"use strict";e.d(R,{AP:()=>m,jc:()=>i,xg:()=>p});var n=e(2543),a=e.n(n),s=e(46644),l=e(95004),o=e(76637),d=e(36394);function i(h,r){if(h.type===l.PU.boolean)return c(h,r);const y=(0,o.Qi)(h).getCalculator(h,r),v=h.state?.range??m(h);return x=>{let f=0;x!==-1/0&&(f=(x-v.min)/v.delta,Number.isNaN(f)&&(f=0));const u=(0,d.k5)(h,x,f);return{percent:f,threshold:u,color:y(x,f,u)}}}function c(h,r){const g={color:r.visualization.getColorByName("green"),percent:1,threshold:void 0},y={color:r.visualization.getColorByName("red"),percent:0,threshold:void 0},v=(0,o.Qi)(h);if(v.isContinuous&&v.getColors){const x=v.getColors(r);g.color=x[x.length-1],y.color=x[0]}return x=>x?g:y}function m(h){if(h.type!==l.PU.number)return{min:0,max:100,delta:100};let r=h.config.min,g=h.config.max;if(!(0,n.isNumber)(r)||!(0,n.isNumber)(g))if(h.values&&h.values.length){const y=(0,s.Nw)({field:h,reducers:[s.gy.min,s.gy.max]});(0,n.isNumber)(r)||(r=y[s.gy.min]),(0,n.isNumber)(g)||(g=y[s.gy.max])}else r=0,g=100;return{min:r,max:g,delta:g-r}}function p(h,r){const{config:g}=h;let{min:y,max:v}=g;return(0,n.isNumber)(y)&&(0,n.isNumber)(v)?g:r||!h.state?.range?{...g,...m(h)}:{...g,...h.state.range}}},53543:(Z,R,e)=>{"use strict";e.d(R,{D:()=>l,G:()=>s});var n=e(42954),a=e(76803);const s=new a.K,l=new n.O},36394:(Z,R,e)=>{"use strict";e.d(R,{QS:()=>s,RU:()=>d,k5:()=>o,yQ:()=>l});var n=e(64394),a=e(33553);const s={value:0,color:n.F};function l(i,c){if(!c||c.length===0)return s;let m=c[0];for(const p of c)if(i>=p.value)m=p;else break;return m}function o(i,c,m){const{thresholds:p}=i.config;return p?.mode===a.O.Percentage?l(m*100,p?.steps):l(c,p?.steps)}function d(i){return i.sort((c,m)=>c.value-m.value)}},16207:(Z,R,e)=>{"use strict";e.d(R,{m:()=>c});var n=e(2543),a=e.n(n),s=e(76803),l=e(11594),o=e(52205),d=e(37615),i=e(37297);class c extends l.Ud{constructor(p){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new s.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=p}get defaults(){let p=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const h=new o.pv;this.optionsSupplier(h,{data:[]});for(const r of h.getItems())r.defaultValue!=null&&(0,n.set)(p,r.path,r.defaultValue)}return p}get fieldConfigDefaults(){const p=this._fieldConfigDefaults.defaults;p.custom={};for(const h of this.fieldConfigRegistry.list())h.defaultValue!==void 0&&(0,n.set)(p,h.id,h.defaultValue);return{defaults:{...p},overrides:this._fieldConfigDefaults.overrides}}setDefaults(p){return(0,d.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=p,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(p){return(0,d.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=p,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(p,h){return this.onPanelMigration=p,this.shouldMigrate=h,this}setPanelChangeHandler(p){return this.onPanelTypeChanged=p,this}setPanelOptions(p){return this.optionsSupplier=p,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(p){return this.dataSupport={...this.dataSupport,...p},this}useFieldConfig(p={}){return this._initConfigRegistry=()=>(0,i.O)(p,this.meta.name),this}setSuggestionsSupplier(p){return this.suggestionsSupplier=p,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(p){return this.meta.id===p}}},69168:(Z,R,e)=>{"use strict";e.d(R,{F:()=>i,H9:()=>g,TQ:()=>y,aW:()=>m,nx:()=>v});var n=e(2543),a=e.n(n),s=e(76637),l=e(64394),o=e(83340),d=e(33553);function i({plugin:x,currentOptions:f,currentFieldConfig:u,isAfterPluginChange:b}){const E=(0,n.mergeWith)({},x.defaults,f||{},(P,T)=>{if((0,n.isArray)(T))return T}),D=c(u,x),C=h(x,D,b);return{options:E,fieldConfig:C}}function c(x,f){const u=f.fieldConfigDefaults,b={defaults:(0,n.mergeWith)({},u.defaults,x?x.defaults:{},(E,D)=>{if((0,n.isArray)(D))return D}),overrides:x?.overrides??[]};p(b.defaults,"",f.fieldConfigRegistry),b.defaults.thresholds&&r(b.defaults.thresholds),b.overrides=m(b.overrides,E=>f.fieldConfigRegistry.getIfExists(E.id)!==void 0);for(const E of b.overrides)for(const D of E.properties)D.id==="thresholds"&&r(D.value);return b}function m(x,f){return x.map(u=>{const b=u.properties.filter(f);return{...u,properties:b}})}function p(x,f,u){let b=!1;for(const[E,D]of Object.entries(x)){const C=`${f}${E}`,P=!!u.getIfExists(C);if(P){b=!0;continue}(0,n.isArray)(D)||!(0,n.isObject)(D)?P||(0,n.unset)(x,E):p(D,`${C}.`,u)||(0,n.unset)(x,E)}return b}function h(x,f,u){if(!u)return f;const b=x.fieldConfigRegistry.getIfExists(o.uo.Color);if(b&&b.settings){const E=b.settings,D=s.uf.getIfExists(f.defaults.color?.mode);if(!E.byValueSupport&&(!D||D.isByValue))return f.defaults.color={mode:l.Y.PaletteClassic},f;if(E.byValueSupport&&E.preferThresholdsMode&&D?.id!==l.Y.Fixed&&(!D||!D.isByValue))return f.defaults.color={mode:l.Y.Thresholds},f;if(E.bySeriesSupport&&D?.isByValue)return f.defaults.color={mode:l.Y.PaletteClassic},f}return f}function r(x){x.mode||(x.mode=d.O.Absolute),x.steps?x.steps.length&&(x.steps[0].value=-1/0):x.steps=[]}function g(x,f){const u={defaults:{...x.defaults,custom:f.defaults.custom},overrides:[...x.overrides]};for(const b of f.overrides)for(const E of b.properties)if(y(E)){const D=u.overrides.find(C=>(0,n.isEqual)(C.matcher,b.matcher));D?D!==b&&D.properties.push(E):u.overrides.push(b)}return u}function y(x){return x.id.startsWith("custom.")}function v(x){return!y(x)}},37297:(Z,R,e)=>{"use strict";e.d(R,{O:()=>l});var n=e(76803),a=e(53543),s=e(52205);function l(d={},i){const c=new n.K,m=a.G.list(),p={};if(d.useCustomConfig){const h=new s.bk;d.useCustomConfig(h);for(const r of h.getRegistry().list())if(r.isCustom=!0,r.id="custom."+r.id,o(r,m)){const g=p[r.category[0]]??[];g.push(r),p[r.category[0]]=g}else c.register(r)}for(let h of m){const r=h.id;if(!(d.disableStandardOptions&&d.disableStandardOptions.indexOf(r)>-1)){if(d.standardOptions){const g=d.standardOptions[r]?.hideFromDefaults,y=d.standardOptions[r]?.defaultValue,v=d.standardOptions[r]?.settings;g!==void 0&&(h={...h,hideFromDefaults:g}),y&&(h={...h,defaultValue:y}),v&&(h={...h,settings:h.settings?{...h.settings,...v}:v})}if(c.register(h),h.category&&p[h.category[0]])for(let g of p[h.category[0]])c.register(g)}}for(const h of c.list())if(h.path.indexOf("[")>0)throw new Error(`[${i}] Field config paths do not support arrays: ${h.id}`);return c}function o(d,i){return!!i.find(c=>d.category&&c.category&&d.category[0]===c.category[0])}},39796:(Z,R,e)=>{"use strict";e.d(R,{M:()=>n});const n=s=>{for(let l=0;;l++){const o=a(l);if(!s.some(d=>d.refId===o))return o}};function a(s){const l="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return s<l.length?l[s]:a(Math.floor(s/l.length)-1)+l[s%l.length]}},15083:(Z,R,e)=>{"use strict";e.d(R,{F:()=>s,c:()=>a});var n=e(51388);function a(l,o){let[d]=l,[i]=o,c=d.length,m=d[0],p=d[c-1],h=i.length,r=i[0],g=i[h-1],y;if(c)if(h){if(r>p)y=l.map((v,x)=>l[x].concat(o[x]));else if(g<m)y=o.map((v,x)=>o[x].concat(l[x]));else if(r<=m&&g>=p)y=o;else if(r>m&&g<p){let v=(0,n.Ls)(r,d);v=d[v]<r?v+1:v;let x=(0,n.Ls)(g,d);x=d[x]>g?x-1:x,y=l.map((f,u)=>l[u].slice(0,v).concat(o[u]).concat(l[u].slice(x+1)))}else if(r>=m){let v=(0,n.Ls)(r,d);v=d[v]<r?v-1:v,y=l.map((x,f)=>l[f].slice(0,v).concat(o[f]))}else if(g>=m){let v=(0,n.Ls)(g,d);v=d[v]<g?v:v+1,y=o.map((x,f)=>o[f].concat(l[f].slice(v)))}}else y=l;else h?y=o:y=[[]];return y}function s(l,o,d){let[i,...c]=l,m,p;return i[0]<o&&(m=(0,n.Ls)(o,i),i[m]<o&&m++),i[i.length-1]>d&&(p=(0,n.Ls)(d,i),i[p]>d&&p--),(m!=null||p!=null)&&(i=i.slice(m??0,p),c=c.map(h=>h.slice(m??0,p))),[i,...c]}},67458:(Z,R,e)=>{"use strict";e.d(R,{G:()=>d,P:()=>i});var n=e(60023),a=e(33836),s=e(63704);let l=!1;const o={pedantic:!1,gfm:!0,breaks:!1};function d(c,m){l||(n.xI.use((0,a.z)()),n.xI.setOptions({...o}),l=!0);let p;m?.breaks&&(p={...o,breaks:!0});const h=(0,n.xI)(c||"",p);if(typeof h!="string")throw new Error("Failed to process markdown synchronously.");return m?.noSanitize?h:(0,s.G$)(h)}function i(c,m){l||(n.xI.use((0,a.z)()),n.xI.setOptions({...o}),l=!0);const p=(0,n.xI)(c||"");if(typeof p!="string")throw new Error("Failed to process markdown synchronously.");return m?.noSanitize?p:(0,s.G$)(p)}},38388:(Z,R,e)=>{"use strict";e.d(R,{Oq:()=>n,bQ:()=>d,bs:()=>s});function n({searchWords:i,textToHighlight:c}){const m=[];for(const p of i)typeof p=="string"&&m.push(...s(c,p));return m}const a=i=>i.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function s(i,c){if(!i||!c)return[];const m=[],{cleaned:p,flags:h}=d(a(c));let r;try{r=new RegExp(`(?:${p})`,h)}catch{return m}return i.replace(r,(g,...y)=>{if(g){const v=y[y.length-2];m.push({text:g,start:v,length:g.length,end:v+g.length})}return""}),m}const l="-",o=/\(\?([ims-]+)\)/g;function d(i){const c=new Set(["g"]);return{cleaned:i.replace(o,(p,h)=>{const r=h.startsWith(l);for(let g=0;g<h.length;++g){const y=h.charAt(g);r||h.charAt(g-1)===l?c.delete(y):y!==l&&c.add(y)}return""}),flags:Array.from(c).join("")}}},46644:(Z,R,e)=>{"use strict";e.d(R,{AH:()=>i,AS:()=>p,C6:()=>r,Em:()=>c,H3:()=>g,Nw:()=>m,gy:()=>d});var n=e(2543),a=e.n(n),s=e(28105),l=e(95004),o=e(42954),d=(P=>(P.sum="sum",P.max="max",P.min="min",P.logmin="logmin",P.mean="mean",P.variance="variance",P.stdDev="stdDev",P.last="last",P.median="median",P.first="first",P.count="count",P.range="range",P.diff="diff",P.diffperc="diffperc",P.delta="delta",P.step="step",P.firstNotNull="firstNotNull",P.lastNotNull="lastNotNull",P.changeCount="changeCount",P.distinctCount="distinctCount",P.allIsZero="allIsZero",P.allIsNull="allIsNull",P.allValues="allValues",P.uniqueValues="uniqueValues",P.p1="p1",P.p2="p2",P.p3="p3",P.p4="p4",P.p5="p5",P.p6="p6",P.p7="p7",P.p8="p8",P.p9="p9",P.p10="p10",P.p11="p11",P.p12="p12",P.p13="p13",P.p14="p14",P.p15="p15",P.p16="p16",P.p17="p17",P.p18="p18",P.p19="p19",P.p20="p20",P.p21="p21",P.p22="p22",P.p23="p23",P.p24="p24",P.p25="p25",P.p26="p26",P.p27="p27",P.p28="p28",P.p29="p29",P.p30="p30",P.p31="p31",P.p32="p32",P.p33="p33",P.p34="p34",P.p35="p35",P.p36="p36",P.p37="p37",P.p38="p38",P.p39="p39",P.p40="p40",P.p41="p41",P.p42="p42",P.p43="p43",P.p44="p44",P.p45="p45",P.p46="p46",P.p47="p47",P.p48="p48",P.p49="p49",P.p50="p50",P.p51="p51",P.p52="p52",P.p53="p53",P.p54="p54",P.p55="p55",P.p56="p56",P.p57="p57",P.p58="p58",P.p59="p59",P.p60="p60",P.p61="p61",P.p62="p62",P.p63="p63",P.p64="p64",P.p65="p65",P.p66="p66",P.p67="p67",P.p68="p68",P.p69="p69",P.p70="p70",P.p71="p71",P.p72="p72",P.p73="p73",P.p74="p74",P.p75="p75",P.p76="p76",P.p77="p77",P.p78="p78",P.p79="p79",P.p80="p80",P.p81="p81",P.p82="p82",P.p83="p83",P.p84="p84",P.p85="p85",P.p86="p86",P.p87="p87",P.p88="p88",P.p89="p89",P.p90="p90",P.p91="p91",P.p92="p92",P.p93="p93",P.p94="p94",P.p95="p95",P.p96="p96",P.p97="p97",P.p98="p98",P.p99="p99",P))(d||{});function i(P,T){return P==="count"||P==="distinctCount"||P==="changeCount"?l.PU.number:P==="allIsNull"||P==="allIsZero"?l.PU.boolean:T}function c(P){return Object.keys(d).includes(P)}function m(P){const{field:T,reducers:O}=P;if(!T||!O||O.length<1)return{};if(T.state?.calcs){const N=[];for(const M of O)T.state.calcs.hasOwnProperty(M)||N.push(M);if(N.length<1)return{...T.state.calcs}}T.state||(T.state={});const I=p.list(O),j=T.values;if(j&&j.length<1){const N={...T.state.calcs};for(const M of I)N[M.id]=M.emptyInputResult!==null?M.emptyInputResult:null;return T.state.calcs=N}const{nullValueMode:W=s.UW.Ignore}=T.config,B=W===s.UW.Ignore,S=W===s.UW.AsZero;if(I.length===1&&I[0].reduce){const N=I[0].reduce(T,B,S);return T.state.calcs={...T.state.calcs,...N},N}let w=g(T,B,S);for(const N of I)!w.hasOwnProperty(N.id)&&N.reduce&&(w={...w,...N.reduce(T,B,S)});return T.state.calcs={...T.state.calcs,...w},w}const p=new o.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:f,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:x,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:v,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:y,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!1,reduce:C,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:u,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:u,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:b,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:E,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:P=>({allValues:[...P.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:P=>({uniqueValues:[...new Set(P.values)]}),preservesUnits:!1},...h()]),h=(P=[...Array.from({length:99},(T,O)=>O+1)])=>{const T=[],O=I=>I>3&&I<21?"th":I%10===1?"st":I%10===2?"nd":I%10===3?"rd":"th";return P.forEach(I=>{const j=I/100,W=`p${I}`,B=`${I}${O(I)} %`,S=`${I}${O(I)} percentile value`;T.push({id:W,name:B,description:S,standard:!1,reduce:(w,N,M)=>({[W]:D(w,j,N,M)}),preservesUnits:!0})}),T},r={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function g(P,T,O){const I={...r},j=P.values;if(!j)return I;const W=P.type===l.PU.number||P.type===l.PU.time;for(let B=0;B<j.length;B++){let S=j[B];if(B===0&&(I.first=S),I.last=S,S==null){if(T)continue;O&&(S=0)}if(I.count++,S!=null&&!Number.isNaN(S)){const w=I.firstNotNull===null;if(w&&(I.firstNotNull=S),W){if(I.sum+=S,I.allIsNull=!1,I.nonNullCount++,!w){const N=S-I.lastNotNull;I.step>N&&(I.step=N),I.lastNotNull>S?I.previousDeltaUp=!1:(I.previousDeltaUp&&(I.delta+=N),I.previousDeltaUp=!0)}S>I.max&&(I.max=S),S<I.min&&(I.min=S),S<I.logmin&&S>0&&(I.logmin=S)}S!==0&&(I.allIsZero=!1),I.lastNotNull=S}}return I.max===-Number.MAX_VALUE&&(I.max=null),I.min===Number.MAX_VALUE&&(I.min=null),I.step===Number.MAX_VALUE&&(I.step=null),I.nonNullCount>0&&(I.mean=I.sum/I.nonNullCount),I.allIsNull&&(I.allIsZero=!1),I.max!==null&&I.min!==null&&(I.range=I.max-I.min),(0,n.isNumber)(I.firstNotNull)&&(0,n.isNumber)(I.lastNotNull)&&(I.diff=I.lastNotNull-I.firstNotNull),(0,n.isNumber)(I.firstNotNull)&&(0,n.isNumber)(I.diff)&&(I.diffperc=I.diff/I.firstNotNull*100),I}function y(P,T,O){return{first:P.values[0]}}function v(P,T,O){const I=P.values;for(let j=0;j<I.length;j++){const W=I[j];if(W!=null&&!Number.isNaN(W))return{firstNotNull:W}}return{firstNotNull:null}}function x(P,T,O){const I=P.values;return{last:I[I.length-1]}}function f(P,T,O){const I=P.values;let j=I.length-1;for(;j>=0;){const W=I[j--];if(W!=null&&!Number.isNaN(W))return{lastNotNull:W}}return{lastNotNull:null}}function u(P,T,O){if(!(P.type===l.PU.number||P.type===l.PU.time))return{variance:0,stdDev:0};let I=0,j=0,W=0;const B=P.values;for(let S=0;S<B.length;S++){const w=B[S];if(w!=null){W++;let N=j;j+=(w-N)/W,I+=(w-N)*(w-j)}}if(W>0){const S=I/W;return{variance:S,stdDev:Math.sqrt(S)}}return{variance:0,stdDev:0}}function b(P,T,O){const I=P.values;let j=0,W=!0,B=null;for(let S=0;S<I.length;S++){let w=I[S];if(w===null){if(T)continue;O&&(w=0)}!W&&B!==w&&j++,W=!1,B=w}return{changeCount:j}}function E(P,T,O){const I=P.values,j=new Set;for(let W=0;W<I.length;W++){let B=I[W];if(B===null){if(T)continue;O&&(B=0)}j.add(B)}return{distinctCount:j.size}}function D(P,T,O,I){let j=P.values;O&&(j=j.filter(S=>S!==null)),I&&(j=j.map(S=>S===null?0:S));const W=j.slice().sort((S,w)=>S-w),B=Math.round((W.length-1)*T);return W[B]}function C(P,T,O){const I=[];for(let W=0;W<P.values.length;W++){let B=P.values[W];if(B==null){if(T)continue;O&&(B=0)}I.push(B)}I.sort((W,B)=>W-B);const j=Math.floor(I.length/2);return I.length%2===0?{median:(I[j-1]+I[j])/2}:{median:I[j]}}},36638:(Z,R,e)=>{"use strict";e.d(R,{sJ:()=>G,RE:()=>H,NS:()=>k,Dq:()=>J,kK:()=>z,hI:()=>_});var n=e(42954),a=e(95004),s=e(57866);const l={id:s.Ct.byType,name:"Field Type",description:"match based on the field type",defaultOptions:a.PU.number,get:Y=>(X,Q,q)=>Y===X.type,getOptionsDisplayText:Y=>`Field type: ${Y}`},o={id:s.Ct.byTypes,name:"Field Type",description:"match based on the field types",defaultOptions:new Set,get:Y=>(X,Q,q)=>Y.has(X.type),getOptionsDisplayText:Y=>`Field types: ${[...Y].join(" | ")}`},d={id:s.Ct.numeric,name:"Numeric Fields",description:"Fields with type number",get:()=>l.get(a.PU.number),getOptionsDisplayText:()=>"Numeric Fields"},i={id:s.Ct.time,name:"Time Fields",description:"Fields with type time",get:()=>l.get(a.PU.time),getOptionsDisplayText:()=>"Time Fields"};function c(){return[l,o,d,i]}var m=e(739),p=e(46644),h=e(53685);function r(Y){return Y===p.gy.allIsNull||Y===p.gy.allIsZero}const g={id:s.Ct.byValue,name:"By value (reducer)",description:"Reduce a field to a single value and test for inclusion",defaultOptions:{reducer:p.gy.allIsZero,op:m.zT.GTE,value:0},get:Y=>{if(!Y||!Y.reducer)return()=>!1;let{reducer:X,op:Q,value:q}=Y;const te=r(X);return Q||(Q=m.zT.EQ),(ne,se,ue)=>{const de=(0,p.Nw)({field:ne,reducers:[X]})[X];return te?!!de:(0,h.c)(de,Q,q)}},getOptionsDisplayText:Y=>`By value (${Y.reducer})`};var y=e(4575),v=e(6844),x=e(8934);const f={id:s.jR.byRefId,name:"Query refId",description:"match the refId",defaultOptions:"A",get:Y=>{let X=null;if((0,x.AP)(Y))try{X=(0,x.dO)(Y)}catch(Q){Q instanceof Error&&console.warn(Q.message)}else if(Y.includes("|")){const Q=Y.split("|").map(x.jD).join("|");X=new RegExp(`^(?:${Q})$`)}return Q=>X?.test(Q.refId||"")??Q.refId===Y},getOptionsDisplayText:Y=>`RefID: ${Y}`};function u(){return[f]}const b={id:s.Ct.first,name:"First Field",description:"The first field in the frame",get:Y=>(X,Q,q)=>X===Q.fields[0],getOptionsDisplayText:()=>"First field"},E={id:s.Ct.firstTimeField,name:"First time field",description:"The first field of type time in a frame",get:Y=>(X,Q,q)=>X.type===a.PU.time&&X===Q.fields.find(te=>te.type===a.PU.time),getOptionsDisplayText:()=>"First time field"};function D(){return[b,E]}const C={id:s.Js.equal,name:"Is equal",description:"Match where value for given field is equal to options value.",get:Y=>(X,Q)=>Q.values[X]==Y.value,getOptionsDisplayText:()=>"Matches all rows where field is null.",isApplicable:()=>!0,getDefaultOptions:()=>({value:""})},P={id:s.Js.notEqual,name:"Is not equal",description:"Match where value for given field is not equal to options value.",get:Y=>(X,Q)=>Q.values[X]!=Y.value,getOptionsDisplayText:()=>"Matches all rows where field is not null.",isApplicable:()=>!0,getDefaultOptions:()=>({value:""})},T=()=>[C,P],O={id:s.Js.isNull,name:"Is null",description:"Match where value for given field is null.",get:()=>(Y,X)=>X.values[Y]==null,getOptionsDisplayText:()=>"Matches all rows where field is null.",isApplicable:()=>!0,getDefaultOptions:()=>({})},I={id:s.Js.isNotNull,name:"Is not null",description:"Match where value for given field is not null.",get:()=>(Y,X)=>X.values[Y]!=null,getOptionsDisplayText:()=>"Matches all rows where field is not null.",isApplicable:()=>!0,getDefaultOptions:()=>({})},j=()=>[O,I],W={id:s.Js.greater,name:"Is greater",description:"Match when field value is greater than option.",get:Y=>(X,Q)=>{const q=Q.values[X];return isNaN(q)?!1:q>Y.value},getOptionsDisplayText:Y=>`Matches all rows where field value is greater than: ${Y.value}.`,isApplicable:Y=>Y.type===a.PU.number,getDefaultOptions:()=>({value:0})},B={id:s.Js.greaterOrEqual,name:"Is greater or equal",description:"Match when field value is greater than or equal to option.",get:Y=>(X,Q)=>{const q=Q.values[X];return isNaN(q)?!1:q>=Y.value},getOptionsDisplayText:Y=>`Matches all rows where field value is greater than or equal to: ${Y.value}.`,isApplicable:Y=>Y.type===a.PU.number,getDefaultOptions:()=>({value:0})},S={id:s.Js.lower,name:"Is lower",description:"Match when field value is lower than option.",get:Y=>(X,Q)=>{const q=Q.values[X];return isNaN(q)?!1:q<Y.value},getOptionsDisplayText:Y=>`Matches all rows where field value is lower than: ${Y.value}.`,isApplicable:Y=>Y.type===a.PU.number,getDefaultOptions:()=>({value:0})},w={id:s.Js.lowerOrEqual,name:"Is lower or equal",description:"Match when field value is lower or equal than option.",get:Y=>(X,Q)=>{const q=Q.values[X];return isNaN(q)?!1:q<=Y.value},getOptionsDisplayText:Y=>`Matches all rows where field value is lower or equal than: ${Y.value}.`,isApplicable:Y=>Y.type===a.PU.number,getDefaultOptions:()=>({value:0})},N=()=>[W,B,S,w],M={id:s.Js.between,name:"Is between",description:"Match when field value is between given option values.",get:Y=>(X,Q)=>{const q=Q.values[X];if(isNaN(q))return!1;const te=typeof Y.from!="number"?parseInt(Y.from,10):Y.from,ne=typeof Y.to!="number"?parseInt(Y.to,10):Y.to;return q>te&&q<ne},getOptionsDisplayText:Y=>`Matches all rows where field value is between ${Y.from} and ${Y.to}.`,isApplicable:Y=>Y.type===a.PU.number||Y.type===a.PU.time,getDefaultOptions:Y=>Y.type===a.PU.time?{from:"$__from",to:"$__to"}:{from:0,to:100}},L=()=>[M],A={id:s.Js.regex,name:"Regex",description:"Match when field value is matching regex.",get:Y=>{const X=new RegExp(Y.value);return(Q,q)=>{const te=q.values[Q];return X.test(te)}},getOptionsDisplayText:Y=>`Matches all rows where field value is matching regex: ${Y.value}`,isApplicable:()=>!0,getDefaultOptions:()=>({value:".*"})},U=()=>[A],F={id:s.Js.substring,name:"Contains substring",description:"Match where value for given field is a substring to options value.",get:Y=>(X,Q)=>{const q=Q.values[X];return q&&Y.value&&typeof q=="string"&&q.toLowerCase().includes(Y.value.toLowerCase())||Y.value===""},getOptionsDisplayText:()=>"Matches all rows where field is similar to the value.",isApplicable:Y=>Y.type===a.PU.string,getDefaultOptions:()=>({value:""})},V={id:s.Js.notSubstring,name:"Does not contain substring",description:"Match where value for given field is not a substring to options value.",get:Y=>(X,Q)=>{const q=Q.values[X];return typeof q=="string"&&Y.value&&q&&Y.value!==""&&!q.toLowerCase().includes(Y.value.toLowerCase())},getOptionsDisplayText:()=>"Matches all rows where field is not similar to the value.",isApplicable:Y=>Y.type===a.PU.string,getDefaultOptions:()=>({value:""})},K=()=>[F,V],G=new n.O(()=>[...(0,v.nz)(),...c(),...(0,y.P7)(),...D(),g]),H=new n.O(()=>[...(0,v.UM)(),...(0,y.Y7)(),...u()]),_=new n.O(()=>[...j(),...N(),...T(),...K(),...L(),...U()]);function k(Y){const X=G.get(Y.id);if(!X)throw new Error("Unknown field matcher: "+Y.id);return X.get(Y.options)}function J(Y){const X=H.get(Y.id);if(!X)throw new Error("Unknown frame matcher: "+Y.id);return X.get(Y.options)}function z(Y){const X=_.get(Y.id);if(!X)throw new Error("Unknown value matcher: "+Y.id);return X.get(Y.options)}},53685:(Z,R,e)=>{"use strict";e.d(R,{c:()=>a});var n=e(739);function a(s,l,o){switch((s==null||o==null)&&(s==null&&(s="null"),o==null&&(o="null"),(l===n.zT.GTE||l===n.zT.LTE)&&(l=n.zT.EQ)),l){case n.zT.EQ:return`${s}`==`${o}`;case n.zT.NEQ:return`${s}`!=`${o}`;case n.zT.GT:return s>o;case n.zT.GTE:return s>=o;case n.zT.LT:return s<o;case n.zT.LTE:return s<=o;default:return!1}}},57866:(Z,R,e)=>{"use strict";e.d(R,{Ct:()=>a,Js:()=>l,cV:()=>n,jR:()=>s});var n=(o=>(o.anyMatch="anyMatch",o.allMatch="allMatch",o.invertMatch="invertMatch",o.alwaysMatch="alwaysMatch",o.neverMatch="neverMatch",o))(n||{}),a=(o=>(o.numeric="numeric",o.time="time",o.first="first",o.firstTimeField="firstTimeField",o.byType="byType",o.byTypes="byTypes",o.byName="byName",o.byNames="byNames",o.byRegexp="byRegexp",o.byRegexpOrNames="byRegexpOrNames",o.byFrameRefID="byFrameRefID",o.byValue="byValue",o))(a||{}),s=(o=>(o.byName="byName",o.byRefId="byRefId",o.byIndex="byIndex",o))(s||{}),l=(o=>(o.regex="regex",o.isNull="isNull",o.isNotNull="isNotNull",o.greater="greater",o.greaterOrEqual="greaterOrEqual",o.lower="lower",o.lowerOrEqual="lowerOrEqual",o.equal="equal",o.notEqual="notEqual",o.substring="substring",o.notSubstring="notSubstring",o.between="between",o))(l||{})},4575:(Z,R,e)=>{"use strict";e.d(R,{P7:()=>y,PP:()=>o,Y7:()=>v});var n=e(16515),a=e(8934),s=e(95004),l=e(57866),o=(x=>(x.exclude="exclude",x.include="include",x))(o||{});const d={id:l.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:x=>{const u=c(new Set([x]));return(b,E,D)=>x===b.name||x===(0,n.Ct)(b,E,D)||!!(u&&u(b,E,D))},getOptionsDisplayText:x=>`Field name: ${x}`},i={id:l.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:x=>{const{names:f,mode:u="include"}=x,b=new Set(f??[]),E=c(b),D=(C,P,T)=>b.has(C.name)||b.has((0,n.Ct)(C,P,T))||!!(E&&E(C,P,T));return u==="exclude"?(C,P,T)=>!D(C,P,T):D},getOptionsDisplayText:x=>{const{names:f,mode:u}=x,b=(f??[]).join(", ");return u==="exclude"?`All except: ${b}`:`All of: ${b}`}};function c(x){let f;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(x.has(s.Bc)?f=(b,E)=>!!b.labels&&b.labels?.__name__===b.name:(x.has("Time")||x.has("time"))&&(f=(b,E)=>E.meta?.typeVersion==null&&b.type===s.PU.time)),f}const m={id:l.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:x=>{const f=r(x);return(u,b,E)=>{const D=(0,n.Ct)(u,b,E);return!!f&&f.test(D)}},getOptionsDisplayText:x=>`Field name by pattern: ${x}`},p={id:l.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:x=>(f,u,b)=>u.refId===x,getOptionsDisplayText:x=>`Math all fields returned by query with reference ID: ${x}`},h={id:l.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:x=>{const f=m.get(x?.pattern||""),u=i.get({mode:"include",names:x?.names??[]});return(b,E,D)=>u(b,E,D)||f(b,E,D)},getOptionsDisplayText:x=>{const f=x?.pattern??"",u=x?.names?.join(",")??"";return`Field name by pattern: ${f} or names: ${u}`}},r=x=>{if(x)try{return(0,a.dO)(x)}catch(f){console.error(f);return}},g={id:l.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:x=>{const f=(0,a.dO)(x);return u=>f.test(u.name||"")},getOptionsDisplayText:x=>`Frame name: ${x}`};function y(){return[d,m,i,h,p]}function v(){return[g]}},6844:(Z,R,e)=>{"use strict";e.d(R,{UM:()=>E,Yg:()=>p,nz:()=>b,zx:()=>g});var n=e(95004),a=e(36638),s=e(57866);const l={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.NS)(P));return(P,T,O)=>{for(const I of C)if(I(P,T,O))return!0;return!1}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" OR ");const T=a.sJ.get(P.id);C+=T.getOptionsDisplayText?T.getOptionsDisplayText(P):T.name}return C}},o={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.Dq)(P));return P=>{for(const T of C)if(T(P))return!0;return!1}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" OR ");const T=a.RE.get(P.id);C+=T.getOptionsDisplayText?T.getOptionsDisplayText(P):T.name}return C}},d={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.NS)(P));return(P,T,O)=>{for(const I of C)if(!I(P,T,O))return!1;return!0}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" AND ");const T=a.sJ.get(P.id);C+=T.getOptionsDisplayText?T.getOptionsDisplayText(P):T.name}return C}},i={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.Dq)(P));return P=>{for(const T of C)if(!T(P))return!1;return!0}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" AND ");const T=a.RE.get(P.id);C+=T.getOptionsDisplayText?T.getOptionsDisplayText(P):T.name}return C}},c={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const C=(0,a.NS)(D);return(P,T,O)=>!C(P,T,O)},getOptionsDisplayText:D=>{const C=a.sJ.get(D.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(D.options):C.name)}},m={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const C=(0,a.Dq)(D);return P=>!C(P)},getOptionsDisplayText:D=>{const C=a.RE.get(D.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(D.options):C.name)}},p=D=>!0,h=D=>!0,r=D=>!1,g=D=>D.type!==n.PU.time,y=D=>!1,v={id:s.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:D=>p,getOptionsDisplayText:D=>"Always"},x={id:s.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:D=>h,getOptionsDisplayText:D=>"Always"},f={id:s.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:D=>r,getOptionsDisplayText:D=>"Never"},u={id:s.cV.neverMatch,name:"No Frames",description:"Never Match",get:D=>y,getOptionsDisplayText:D=>"Never"};function b(){return[l,d,c,v,f]}function E(){return[o,i,m,x,u]}},8642:(Z,R,e)=>{"use strict";e.d(R,{h:()=>s,m:()=>a});var n=e(42954),a=(l=>(l.Combine="combine",l.CalculateNewFields="calculateNewFields",l.CreateNewVisualization="createNewVisualization",l.Filter="filter",l.PerformSpatialOperations="performSpatialOperations",l.Reformat="reformat",l.ReorderAndRename="reorderAndRename",l))(a||{});const s=new n.O},2197:(Z,R,e)=>{"use strict";e.d(R,{m:()=>h});var n=e(2543),a=e.n(n),s=e(62467),l=e(69862),o=e(81160),d=e(36638),i=e(8642);const c=(y,v)=>x=>{const f=i.h.get(y.id);if(!f)return x;const b={...f.transformation.defaultOptions??{},...y.options},D=window.__grafanaSceneContext!=null?b:g((0,n.cloneDeep)(b),P=>typeof P=="string"?v.interpolate(P):P),C=y.filter?.options?(0,d.Dq)(y.filter):void 0;return x.pipe((0,l.Z)(P=>(0,s.of)(m(P,C)).pipe(f.transformation.operator(D,v),p(P,f,C))))};function m(y,v){return v?y.filter(x=>v(x)):y}const p=(y,v,x)=>f=>f.pipe((0,o.T)(u=>{if(u===y)return u;if(x){let b=0;const E=y.filter((D,C)=>{const P=!x(D);return P&&!b&&(b=C),P});E.length&&u.splice(b,0,...E)}return u}));function h(y,v,x){const f=(0,s.of)(v);if(!y.length)return f;const u=[],b=x??{interpolate:E=>E};for(let E=0;E<y.length;E++){const D=y[E];if(r(D))u.push(D(b));else{if(D.disabled)continue;u.push(c(D,b))}}return f.pipe.apply(f,u)}function r(y){return typeof y=="function"}function g(y,v){if(Array.isArray(y))return y.map(x=>g(x,v));if(typeof y=="object"){for(const x in y)y[x]=g(y[x],v);return y}else return v(y)??y}},96702:(Z,R,e)=>{"use strict";e.d(R,{c:()=>Pe});var n=e(84691),a=e(9287),s=e(406),l=e(882),o=e(49297),d=e(359),i=e(57866),c=e(64761);const m={id:c.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(Ie,Se)=>Me=>{const Te={};return Ie.include&&(Te.include={id:i.jR.byRefId,options:Ie.include}),Ie.exclude&&(Te.exclude={id:i.jR.byRefId,options:Ie.exclude}),Me.pipe(o.I.operator(Te,Se))}};var p=e(68779),h=e(40041),r=e(81160),g=e(16515),y=e(79319);const v={id:c.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:Ie=>{for(const Se of Ie)for(const Me of Se.fields)if(Me.type==="time")return y.M.Applicable;return y.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(Ie,Se)=>Me=>Me.pipe((0,r.T)(Te=>x(Ie,Te,Se)))},x=({timeField:Ie,outputFormat:Se,timezone:Me},Te,Ge)=>!Array.isArray(Te)||Te.length===0?Te:((0,g.Fm)(Te),Se=Ge?.interpolate(Se)??Se,Te.map(Qe=>({...Qe,fields:Qe.fields.map(tt=>(tt.state?.displayName===Ie&&(tt=(0,s.Xv)(tt,Se,{timeZone:Me})),tt))})));var f=e(47433),u=e(25260),b=e(36638);const E="Time",D="Time",C="Value",P=y.N.Empty,T=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,O={id:c.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:E,rowField:D,valueField:C},isApplicable:Ie=>{let Se=0;for(const Me of Ie)Se+=Me.fields.length;return Se>=3?y.M.Applicable:y.M.NotApplicable},isApplicableDescription:Ie=>{let Se=0;for(const Me of Ie)Se+=Me.fields.length;return`Grouping to matrix requires at least 3 fields to work. Currently there are ${Se} fields.`},operator:(Ie,Se)=>Me=>Me.pipe((0,r.T)(Te=>{const Ge=Ie.columnField||E,Qe=Ie.rowField||D,tt=Ie.valueField||C,ke=Ie.emptyValue||P;if(Te.length!==1)return Te;const He=Te[0],Re=j(He,Ge),Ne=j(He,Qe),Ae=j(He,tt),Ue=`${Qe}\\${Ge}`;if(!Re||!Ne||!Ae)return Te;const Be=I(Re.values),We=I(Ne.values),_e={};for(let le=0;le<Ae.values.length;le++){const ye=Re.values[le],pe=Ne.values[le],ve=Ae.values[le];_e[ye]||(_e[ye]={}),_e[ye][pe]=ve}const Xe=[{name:Ue,values:We,type:Ne.type,config:{}}];for(const le of Be){let ye=[];for(const pe of We){const ve=_e[le][pe]??W(ke);ye.push(ve)}T&&typeof le=="number"&&(Ae.config={...Ae.config,displayNameFromDS:void 0}),delete Ae.config.displayName,Xe.push({name:le?.toString()??null,values:ye,config:Ae.config,type:Ae.type})}return[{fields:Xe,length:We.length}]}))};function I(Ie){const Se=new Set(Ie);return Array.from(Se)}function j(Ie,Se){for(let Me=0;Me<Ie.fields.length;Me++){const Te=Ie.fields[Me];let Ge;if(T?Ge=b.sJ.get(i.Ct.byName).get(Se)(Te,Ie,[Ie]):Ge=Se===(0,g.Ct)(Te),Ge)return Te}return null}function W(Ie){switch(Ie){case y.N.False:return!1;case y.N.True:return!0;case y.N.Null:return null;case y.N.Zero:return 0;case y.N.Empty:default:return""}}var B=e(74261),S=e(6684),w=e(79184);const N=10,M={id:c.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:N},operator:(Ie,Se)=>Me=>Me.pipe((0,r.T)(Te=>{let Ge=N;return Ie.limitField!==void 0&&(typeof Ie.limitField=="string"?Ge=parseInt(Ie.limitField,10):Ge=Ie.limitField),Te.map(Qe=>Qe.length>Ge?{...Qe,fields:Qe.fields.map(tt=>({...tt,state:{...tt.state,calcs:void 0},values:Ge>=0?tt.values.slice(0,Ge):tt.values.slice(tt.values.length+Ge,tt.values.length)})),length:Math.abs(Ge)}:Qe)}))};var L=e(33023),A=e(1027),U=e(95575);const F={id:c.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:Ie=>Se=>Se.pipe((0,r.T)(Me=>{const Te=V(Ie.renameByName);return!Array.isArray(Me)||Me.length===0?Me:Me.map(Ge=>({...Ge,fields:Te(Ge)}))}))},V=Ie=>Se=>!Ie||Object.keys(Ie).length===0?Se.fields:Se.fields.map(Me=>{const Te=(0,g.Ct)(Me,Se),Ge=Ie[Te];return typeof Ge!="string"||Ge.length===0?Me:{...Me,config:{...Me.config,displayName:Ge},state:{...Me.state,displayName:Ge}}}),K={id:c.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:Ie=>Ie.length>1?y.M.NotPossible:y.M.Applicable,operator:(Ie,Se)=>Me=>Me.pipe(d.D.operator({include:Ie.includeByName?{names:G(Ie.includeByName)}:void 0,exclude:{names:G(Ie.excludeByName)}},Se),U.xQ.operator(Ie,Se),F.operator(Ie,Se))},G=Ie=>Ie?Object.keys(Ie).filter(Se=>Ie[Se]):[];var H=e(32157),_=e(8934);const k={id:c.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:Ie=>Se=>Se.pipe((0,r.T)(Me=>!Array.isArray(Me)||Me.length===0?Me:Me.map(J(Ie))))},J=Ie=>Se=>{const Me=(0,_.dO)(Ie.regex),Te=Se.fields.map(Ge=>{const Qe=(0,g.Ct)(Ge,Se);if(!Me.test(Qe))return Ge;const tt=Qe.replace(Me,Ie.renamePattern);return{...Ge,config:{...Ge.config,displayName:tt},state:{...Ge.state,displayName:tt}}});return{...Se,fields:Te}};var z=e(2543),Y=e(18700),X=e(41119),Q=e(17503),q=e(95004);const te={id:c.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:Ie=>Se=>Se.pipe((0,r.T)(Me=>{if(!Array.isArray(Me)||Me.length===0||(Me=Me.filter(ke=>ke.length>0),!(0,Q.jq)(Me)))return Me;const Te={},Ge=new Set,Qe=new Y.k({refId:`${c.F.seriesToRows}-${Me.map(ke=>ke.refId).join("-")}`,fields:[]}),tt={name:q.aI,values:[],config:{},type:q.PU.string};for(let ke=0;ke<Me.length;ke++){const He=Me[ke];for(let Re=0;Re<He.fields.length;Re++){const Ne=He.fields[Re];if(Ne.type===q.PU.time){Te[ke]=Re,Ge.has(q.LE)||(Qe.addField(ne(Ne,q.LE)),Qe.addField(tt),Ge.add(q.LE));continue}Ge.has(q.Bc)||(Qe.addField(ne(Ne,q.Bc)),Ge.add(q.Bc))}}for(let ke=0;ke<Me.length;ke++){const He=Me[ke];for(let Re=0;Re<He.length;Re++){const Ne=Te[ke],Ae=Ne===0?1:0;Qe.add({[q.LE]:He.fields[Ne].values[Re],[q.aI]:(0,g.Ri)(He),[q.Bc]:He.fields[Ae].values[Re]})}}return[(0,X.ES)(Qe,0,!0)]}))},ne=(Ie,Se)=>({...(0,z.omit)(Ie,["values","state","labels","config","name"]),name:Se,values:[],config:{...(0,z.omit)(Ie.config,["displayName","displayNameFromDS"])}}),se={id:c.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(Ie,Se)=>Me=>Me.pipe((0,r.T)(Te=>!Array.isArray(Te)||Te.length===0||!Ie?.sort?.length?Te:ue(Te,Ie.sort,Se)))};function ue(Ie,Se,Me){return Ie.map(Te=>{const Ge=de(Te,Se,Me);return Ge.length&&Ge[0].index!=null?(0,X.ES)(Te,Ge[0].index,Ge[0].desc):Te})}function de(Ie,Se,Me){return Se.map(Te=>Te.index!=null?Te:{...Te,index:Ie.fields.findIndex(Ge=>Te.field===(0,g.Ct)(Ge,Ie))})}const ie={id:c.F.transpose,name:"Transpose",description:"Transpose the data frame",defaultOptions:{},operator:Ie=>Se=>Se.pipe((0,r.T)(Me=>Me.length===0?Me:he(Ie,Me)))};function he(Ie,Se){return(0,g.Fm)(Se),Se.map(Me=>{const Te=Me.fields[0],Ge=Ie.firstFieldName?Ie.firstFieldName:"Field",Qe=Ie.restFieldsName?Ie.restFieldsName:"Value",tt=Te.type===q.PU.string||Te.type===q.PU.time||Te.type===q.PU.enum,ke=tt?[Ge,...ce(Te,Te.values)]:[Ge,...Te.values.map((Ae,Ue)=>Qe)],He=tt?Me.fields.map(Ae=>Ae.state?.displayName??Ae.name).slice(1):Me.fields.map(Ae=>Ae.state?.displayName??Ae.name),Re=me(tt?Me.fields.map(Ae=>Ae.type).slice(1):Me.fields.map(Ae=>Ae.type)),Ne=ke.map((Ae,Ue)=>{if(Ue===0)return{name:Ge,type:q.PU.string,config:{},values:He};const Be=Me.fields.map(Xe=>Re===q.PU.string?ce(Xe,[Xe.values[Ue-1]])[0]:Xe.values[Ue-1]),We=tt?Te.name:"row",_e=tt?Ae:Ue;return{name:tt?Qe:Ae,labels:{[We]:_e},type:Re,config:{},values:tt?Be.slice(1):Be}});return{...Me,fields:Ne,length:Math.max(...Ne.map(Ae=>Ae.values.length)),refId:`${c.F.transpose}-${Me.refId}`}})}function me(Ie){const Se=new Set(Ie);return Se.size===1?[...Se][0]:q.PU.string}function ce(Ie,Se){switch(Ie.type){case q.PU.time:case q.PU.number:case q.PU.boolean:case q.PU.string:return Se.map(Me=>`${Me}`);case q.PU.enum:return Se.map(Me=>Ie.config.type.enum.text[Me]);default:return Se.map(Me=>JSON.stringify(Me))}}const Pe={noopTransformer:A.W,filterFieldsTransformer:o.z,filterFieldsByNameTransformer:d.D,filterFramesTransformer:o.I,filterFramesByRefIdTransformer:m,filterByValueTransformer:p.Sv,formatStringTransformer:h.yt,formatTimeTransformer:v,orderFieldsTransformer:U.xQ,organizeFieldsTransformer:K,reduceTransformer:H.Wj,concatenateTransformer:a.vz,calculateFieldTransformer:n.SC,joinByFieldTransformer:S.L,seriesToColumnsTransformer:S.L,seriesToRowsTransformer:te,renameFieldsTransformer:F,labelsToFieldsTransformer:w.V,ensureColumnsTransformer:l.b,groupByTransformer:f.of,sortByTransformer:se,mergeTransformer:L.o,renameByRegexTransformer:k,histogramTransformer:B.OA,convertFieldTypeTransformer:s.zM,groupingToMatrixTransformer:O,limitTransformer:M,groupToNestedTable:u._,transposeTransformer:ie}},84691:(Z,R,e)=>{"use strict";e.d(R,{Bp:()=>f,SC:()=>P,UY:()=>x,Uj:()=>E,ip:()=>u,pR:()=>M,sw:()=>A});var n=e(2543),a=e.n(n),s=e(81160),l=e(41119),o=e(16515),d=e(28105),i=e(95004),c=e(12823),m=e(48233),p=e(46644),h=e(36638),r=e(57866),g=e(882),y=e(64761),v=e(1027),x=(U=>(U.ReduceRow="reduceRow",U.CumulativeFunctions="cumulativeFunctions",U.WindowFunctions="windowFunctions",U.BinaryOperation="binary",U.UnaryOperation="unary",U.Index="index",U))(x||{}),f=(U=>(U.Percentage="percentage",U.Fixed="fixed",U))(f||{}),u=(U=>(U.Trailing="trailing",U.Centered="centered",U))(u||{});const b={reducer:p.gy.sum},E={reducer:p.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},D={left:{fixed:""},operator:c.k.Add,right:{fixed:""}},C={operator:m._.Abs,fieldName:""},P={id:y.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:p.gy.sum}},operator:(U,F)=>V=>{const K=U.mode??"reduceRow",G=U.timeSeries!==!1,H=U.binary?.right,_=typeof H=="string"?H:typeof H=="object"?H.fixed:void 0,k=K==="binary"&&!Number.isNaN(Number(_)),z=G&&!k?g.b.operator(null,F):v.W.operator({},F);return V.pipe(z,(0,s.T)(Y=>{let X;switch(K){case"reduceRow":X=S((0,n.defaults)(U.reduce,b),Y);break;case"cumulativeFunctions":X=B((0,n.defaults)(U.cumulative,b),Y);break;case"windowFunctions":X=T((0,n.defaults)(U.window,E),Y);break;case"unary":X=L((0,n.defaults)(U.unary,C),Y);break;case"binary":const q=[];Y.map(ne=>{ne.fields.map(se=>{q.push(se.name)})});const te={left:M(U.binary?.left??"",q),operator:U.binary?.operator??D.operator,right:M(U.binary?.right??"",q)};if(U.binary=te,te.left?.matcher?.id&&te.left?.matcher.id===r.Ct.byType){const ne=te.left.matcher.options,se=c.b.getIfExists(te.operator);return Y.map(de=>{const{timeField:ie}=(0,l.KR)(de),he=[];let me=!1;if(ie&&U.timeSeries!==!1&&he.push(ie),de.fields.map((ce,Pe)=>{if(!U.replaceFields&&!he.includes(ce)&&he.push(ce),ce.type===ne){const Ie=ce.values,Se=w(de,te.right??D.right,Y,F);if(!Ie||!Se||!se)return;const Me=new Array(Ie.length);for(let Ge=0;Ge<Me.length;Ge++)Me[Ge]=se.operation(Ie[Ge],Se[Ge]);const Te={...ce,name:`${ce.name} ${U.binary?.operator??""} ${U.binary?.right.matcher?.options??U.binary?.right.fixed}`,values:Me};delete Te.state,he.push(Te),me=!0}}),!(U.replaceFields&&!me))return{...de,fields:he}}).filter(de=>de!=null)}else X=N((0,n.defaults)(te,D),Y,F);break;case"index":return Y.map(ne=>{const se=[...Array(ne.length).keys()];if(U.index?.asPercentile)for(let de=0;de<se.length;de++)se[de]=se[de]/se.length;const ue={name:U.alias??"Row",type:i.PU.number,values:se,config:U.index?.asPercentile?{unit:"percentunit"}:{}};return{...ne,fields:U.replaceFields?[ue]:[...ne.fields,ue]}})}return X?Y.map(q=>{const te=X(q);if(!te)return U.replaceFields?void 0:q;const ne={name:A(U),type:i.PU.number,config:{},values:te};U.alias?.length&&(ne.config.displayName=U.alias);let se=[];if(U.replaceFields){const{timeField:ue}=(0,l.KR)(q);ue&&U.timeSeries!==!1?se=[ue,ne]:se=[ne]}else se=[...q.fields,ne];return{...q,fields:se}}).filter(q=>q!=null):Y}))}};function T(U,F){if(U.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let V=(0,h.NS)({id:r.Ct.numeric});return U.field&&(V=(0,h.NS)({id:r.Ct.byNames,options:{names:[U.field]}})),K=>{const G=Math.ceil(U.windowSize*(U.windowSizeMode==="percentage"?K.length:1));let H=null;for(const _ of K.fields)if(V(_,K,F)){H=_;break}if(H){if(![p.gy.mean,p.gy.stdDev,p.gy.variance].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return U.windowAlignment==="centered"?I(K,U.reducer,H,G):O(K,U.reducer,H,G)}}}function O(U,F,V,K){const G=[];let H=0,_=0;for(let k=0;k<U.length;k++)if(F===p.gy.mean){const J=V.values[k];if(J!=null&&(_++,H+=J,k>K-1)){const z=V.values[k-K];z!=null&&(H-=z,_--)}G.push(_===0?0:H/_)}else if(F===p.gy.variance){const J=Math.max(0,k-K+1),z=k+1;G.push(j(V.values.slice(J,z)))}else if(F===p.gy.stdDev){const J=Math.max(0,k-K+1),z=k+1;G.push(W(V.values.slice(J,z)))}return G}function I(U,F,V,K){const G=[];let H=0,_=0;const k=Math.ceil(K/2)-1,J=Math.floor(K/2);for(let z=0;z<U.length;z++){const Y=z-J,X=z+k;if(F===p.gy.mean){if(z===0)for(let Q=0;Q<k+1&&Q<V.values.length;Q++)V.values[Q]!=null&&(H+=V.values[Q],_++);else X<V.values.length&&V.values[X]!=null&&(H+=V.values[X],_++),Y>0&&V.values[Y-1]!=null&&(H-=V.values[Y-1],_--);G.push(_===0?0:H/_)}else if(F===p.gy.variance){const Q=V.values.slice(Math.max(0,Y),Math.min(X+1,V.values.length));G.push(j(Q))}else if(F===p.gy.stdDev){const Q=V.values.slice(Math.max(0,Y),Math.min(X+1,V.values.length));G.push(W(Q))}}return G}function j(U){if(U.length<1)return 0;let F=0,V=0,K=0;for(let H=0;H<U.length;H++){const _=U[H];if(_!=null){K++;let k=V;V+=(_-k)/K,F+=(_-k)*(_-V)}}return K===0?0:F/K}function W(U){return Math.sqrt(j(U))}function B(U,F){let V=(0,h.NS)({id:r.Ct.numeric});if(U.field&&(V=(0,h.NS)({id:r.Ct.byNames,options:{names:[U.field]}})),![p.gy.mean,p.gy.sum].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return K=>{let G=null;for(const k of K.fields)if(V(k,K,F)){G=k;break}if(!G)return;const H=[];let _=0;for(let k=0;k<K.length;k++)_+=G.values[k]??0,U.reducer===p.gy.sum?H.push(_):U.reducer===p.gy.mean&&H.push(_/(k+1));return H}}function S(U,F){let V=(0,h.NS)({id:r.Ct.numeric});U.include&&U.include.length&&(V=(0,h.NS)({id:r.Ct.byNames,options:{names:U.include}}));const K=p.AS.get(U.reducer);if(!K)throw new Error(`Unknown reducer: ${U.reducer}`);const G=K.reduce??p.H3,H=U.nullValueMode===d.UW.Ignore,_=U.nullValueMode===d.UW.AsZero;return k=>{const J=[];for(const Q of k.fields)V(Q,k,F)&&J.push(Q.values);const z=J.length,Y={name:"temp",values:new Array(z),type:i.PU.number,config:{}},X=[];for(let Q=0;Q<k.length;Q++){for(let q=0;q<z;q++)Y.values[q]=J[q][Q];X.push(G(Y,H,_)[U.reducer])}return X}}function w(U,F,V,K){if(!F)return;if(F.matcher&&F.matcher.id===r.Ct.byName){const H=F.matcher.options??"";for(const _ of U.fields)if(H===(0,o.Ct)(_,U,V))return _.type===i.PU.boolean?_.values.map(k=>k?1:0):_.values}const G=parseFloat(F.fixed??F.matcher?.options??"");if(!isNaN(G))return new Array(U.length).fill(G)}function N(U,F,V){const K=c.b.getIfExists(U.operator);return G=>{const H=w(G,U.left,F,V),_=w(G,U.right,F,V);if(!H||!_||!K)return;const k=new Array(H.length);for(let J=0;J<k.length;J++)k[J]=K.operation(H[J],_[J]);return k}}function M(U,F){return typeof U=="string"?isNaN(Number(U))?{matcher:{id:r.Ct.byName,options:U}}:F.includes(U)?{matcher:{id:r.Ct.byName,options:U}}:{fixed:U}:U}function L(U,F){const V=m.j.getIfExists(U.operator);return K=>{let G=[];for(const k of K.fields)U.fieldName===(0,o.Ct)(k,K,F)&&k.type===i.PU.number&&(G=k.values);if(!G.length||!V)return;const H=new Array(G.length);let _=0;if(U.operator===m._.Percent)for(let k=0;k<G.length;k++)Number.isFinite(G[k])&&(_+=G[k]);for(let k=0;k<H.length;k++)H[k]=V.operation(G[k],_);return H}}function A(U){if(U.alias?.length)return U.alias;switch(U.mode){case"cumulativeFunctions":{const{cumulative:F}=U;return`cumulative ${F?.reducer??""}${F?.field?`(${F.field})`:""}`}case"windowFunctions":{const{window:F}=U;return`${F?.windowAlignment??""} moving ${F?.reducer??""}${F?.field?`(${F.field})`:""}`}case"unary":{const{unary:F}=U;return`${F?.operator??""}${F?.fieldName?`(${F.fieldName})`:""}`}case"binary":{const{binary:F}=U,V=`${F?.left?.matcher?.options??F?.left?.fixed??""} ${F?.operator??""} ${F?.right?.matcher?.options??F?.right?.fixed??""}`;return/\$/g.test(V)?"":V}case"reduceRow":{const F=p.AS.getIfExists(U.reduce?.reducer);if(F)return F.name}break;case"index":return"Row"}return"math"}},9287:(Z,R,e)=>{"use strict";e.d(R,{vz:()=>o,x1:()=>l});var n=e(81160),a=e(95004),s=e(64761),l=(i=>(i.Drop="drop",i.FieldName="field",i.Label="label",i))(l||{});const o={id:s.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:i=>c=>c.pipe((0,n.T)(m=>!Array.isArray(m)||m.length<2?m:[d(m,i)]))};function d(i,c){let m=!0,p=i[0].length;const h=c.frameNameLabel??"frame";let r=[];for(const g of i){p!==g.length&&(m=!1,p=Math.max(p,g.length));for(const y of g.fields){const v={...y};v.state=void 0,g.name&&(c.frameNameMode==="drop"||(c.frameNameMode==="label"?(v.labels={...y.labels},v.labels[h]=g.name):!v.name||v.name===a.Bc?v.name=g.name:v.name=`${g.name} \xB7 ${y.name}`)),r.push(v)}}return m||(r=r.map(g=>{if(g.values.length===p)return g;const y=g.values.slice();return y.length=p,{...g,values:y}})),{fields:r,length:p}}},406:(Z,R,e)=>{"use strict";e.d(R,{Xv:()=>y,ks:()=>x,s7:()=>m,zM:()=>i});var n=e(81160),a=e(44922),s=e(95004),l=e(36638),o=e(57866),d=e(64761);const i={id:d.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(u,b)=>E=>E.pipe((0,n.T)(D=>i.transformer(u,b)(D))),transformer:u=>b=>!Array.isArray(b)||b.length===0?b:c(u,b)??[]};function c(u,b){if(!u.conversions.length)return b;const E=b.map(D=>({...D}));for(const D of u.conversions){if(!D.targetField)continue;const C=l.sJ.get(o.Ct.byName).get(D.targetField);for(const P of E)P.fields=P.fields.map(T=>C(T,P,E)?m(T,D):T)}return E}function m(u,b){switch(b.destinationType){case s.PU.time:return x(u,b.dateFormat);case s.PU.number:return r(u);case s.PU.string:return y(u,b.dateFormat,{timeZone:b.timezone},b.joinWith);case s.PU.boolean:return g(u);case s.PU.enum:return f(u,b.enumConfig);case s.PU.other:return v(u);default:return u}}const p=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function h(u,b){let E=b?{format:b}:void 0;const D=u.values.slice();let C=D.find(O=>O!=null);const P=typeof C=="number"&&b==="X",T=typeof C=="string"&&p.test(C);for(let O=0;O<D.length;O++)if(D[O]){let I=T?Date.parse(D[O]):(0,a.b)(D[O],E).valueOf();Number.isFinite(I)?D[O]=P?I*1e3:I:D[O]=null}else D[O]=null;return{...u,type:s.PU.time,values:D}}function r(u){const b=u.values.slice(),E=b.some(D=>typeof D=="string");for(let D=0;D<b.length;D++){let C=b[D];E&&C!=null&&typeof C=="string"&&(C=C.replace(/,/g,""));const P=+C;b[D]=Number.isFinite(P)?P:null}return{...u,type:s.PU.number,values:b}}function g(u){const b=u.values.slice();for(let E=0;E<b.length;E++)b[E]=!!b[E];return{...u,type:s.PU.boolean,values:b}}function y(u,b,E,D){let C=u.values;switch(u.type){case s.PU.time:C=C.map(P=>(0,a.b)(P,E).format(b));break;case s.PU.string:case s.PU.other:C=C.map(P=>D?.length&&Array.isArray(P)?P.join(D):JSON.stringify(P));break;default:C=C.map(P=>`${P}`)}return{...u,type:s.PU.string,values:C}}function v(u){const b=u.values.slice();for(let E=0;E<b.length;E++)try{b[E]=JSON.parse(b[E])}catch{b[E]=null}return{...u,type:s.PU.other,values:b}}function x(u,b){const E=typeof u.values[0]=="number",D=b==="X";return u.type===s.PU.time&&E?u:E&&!D?{...u,type:s.PU.time}:h(u,b)}function f(u,b){const E={...b},D=u.values.slice(),C=new Map;if(E.text&&E.text.length>0)for(let P=0;P<E.text.length;P++)C.set(E.text[P],P);else return u;for(let P=0;P<D.length;P++){const T=D[P];D[P]=C.get(T)}return{...u,config:{...u.config,type:{enum:E}},type:s.PU.enum,values:D}}},882:(Z,R,e)=>{"use strict";e.d(R,{b:()=>o});var n=e(81160),a=e(41119),s=e(64761),l=e(6684);const o={id:s.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(i,c)=>m=>m.pipe((0,n.T)(p=>o.transformer(i,c)(p))),transformer:(i,c)=>m=>{const p=d(m);return m.length>1&&p?l.L.transformer({byField:p},c)(m):m}};function d(i){let c;for(const m of i){const{timeField:p}=(0,a.KR)(m);if(!p)return;if(!c)c=p.name;else if(c!==p.name)return}return c}},49297:(Z,R,e)=>{"use strict";e.d(R,{I:()=>d,z:()=>o});var n=e(81160),a=e(36638),s=e(64761),l=e(1027);const o={id:s.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(i,c)=>m=>!i.include&&!i.exclude?m.pipe(l.W.operator({},c)):(typeof i.include?.options=="string"?i.include.options=i.include?.options:typeof i.include?.options?.pattern=="string"&&(i.include.options.pattern=i.include?.options.pattern),typeof i.exclude?.options=="string"?i.exclude.options=i.exclude?.options:typeof i.exclude?.options?.pattern=="string"&&(i.exclude.options.pattern=i.exclude?.options.pattern),m.pipe((0,n.T)(p=>{const h=i.include?(0,a.NS)(i.include):null,r=i.exclude?(0,a.NS)(i.exclude):null,g=[];for(const y of p){const v=[];for(let f=0;f<y.fields.length;f++){const u=y.fields[f];if(r){if(r(u,y,p))continue;h||v.push(u)}h&&h(u,y,p)&&v.push(u)}if(!v.length)continue;const x={...y,fields:v};g.push(x)}return g})))},d={id:s.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(i,c)=>m=>!i.include&&!i.exclude?m.pipe(l.W.operator({},c)):m.pipe((0,n.T)(p=>{const h=i.include?(0,a.Dq)(i.include):null,r=i.exclude?(0,a.Dq)(i.exclude):null,g=[];for(const y of p){if(r){if(r(y))continue;h||g.push(y)}h&&h(y)&&g.push(y)}return g}))}},359:(Z,R,e)=>{"use strict";e.d(R,{D:()=>l,R:()=>o});var n=e(57866),a=e(49297),s=e(64761);const l={id:s.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(d,i)=>c=>c.pipe(a.z.operator({include:o(d.include,d.byVariable),exclude:o(d.exclude,d.byVariable)},i))},o=(d,i)=>{if(!d)return;const{names:c,pattern:m,variable:p}=d;if(i&&p){const h=p;if(/^\{.*\}$/.test(h)){const r=h.slice(1).slice(0,-1).split(",");return{id:n.Ct.byNames,options:{names:r}}}return{id:n.Ct.byNames,options:{names:h.split(",")}}}if(!((!Array.isArray(c)||c.length===0)&&!m))return m?!Array.isArray(c)||c.length===0?{id:n.Ct.byRegexp,options:m}:{id:n.Ct.byRegexpOrNames,options:d}:{id:n.Ct.byNames,options:{names:c}}}},68779:(Z,R,e)=>{"use strict";e.d(R,{Sm:()=>i,Sv:()=>c,j4:()=>d});var n=e(81160),a=e(16515),s=e(36638),l=e(64761),o=e(1027),d=(h=>(h.exclude="exclude",h.include="include",h))(d||{}),i=(h=>(h.all="all",h.any="any",h))(i||{});const c={id:l.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(h,r)=>g=>{const y=h.filters,v=h.match==="all",x=h.type==="include";return!Array.isArray(y)||y.length===0?g.pipe(o.W.operator({},r)):g.pipe((0,n.T)(f=>{if(f.length===0)return f;const u=[];for(const b of f){const E=new Set,D=p(b,f),C=m(y,D);for(let O=0;O<b.length;O++){if(E.has(O))continue;let I=!0;for(const j of C){const W=j(O,b,f);if(!v&&W){I=!0;break}if(v&&!W){I=!1;break}I=W}I&&E.add(O)}const P=[],T=x?E.size:f[0].length-E.size;for(const O of b.fields){const I=[];for(let j=0;j<b.length;j++){if(x&&E.has(j)){I.push(O.values[j]);continue}if(!x&&!E.has(j)){I.push(O.values[j]);continue}}P.push({...O,values:I,state:{}})}u.push({...b,fields:P,length:T})}return u}))}},m=(h,r)=>{const g=()=>!1;return h.map(y=>{const v=r[y.fieldName]??-1;if(v<0)return console.warn(`[FilterByValue] Could not find index for field name: ${y.fieldName}`),g;const x=(0,s.kK)(y.config);return(f,u,b)=>x(f,u.fields[v],u,b)})},p=(h,r)=>{const g={};return h.fields.forEach((y,v)=>{const x=(0,a.Ct)(y,h,r);g[x]=v}),g}},40041:(Z,R,e)=>{"use strict";e.d(R,{gs:()=>i,yt:()=>p});var n=e(81160),a=e(95004),s=e(79319),l=e(36638),o=e(57866),d=e(64761),i=(r=>(r.UpperCase="Upper Case",r.LowerCase="Lower Case",r.SentenceCase="Sentence Case",r.TitleCase="Title Case",r.PascalCase="Pascal Case",r.CamelCase="Camel Case",r.SnakeCase="Snake Case",r.KebabCase="Kebab Case",r.Trim="Trim",r.Substring="Substring",r))(i||{});const c=r=>{const g=r.split(" ");for(let y=0;y<g.length;y++)g[y]=g[y].charAt(0).toUpperCase()+g[y].slice(1).toLowerCase();return g},m=r=>g=>g.values.map(y=>{switch(r.outputFormat){case"Upper Case":return y.toUpperCase();case"Lower Case":return y.toLowerCase();case"Sentence Case":return y.charAt(0).toUpperCase()+y.slice(1);case"Title Case":return c(y).join(" ");case"Pascal Case":return c(y).join("");case"Camel Case":return y=c(y).join(""),y.charAt(0).toLowerCase()+y.slice(1);case"Snake Case":return y.toLowerCase().split(" ").join("_");case"Kebab Case":return y.toLowerCase().split(" ").join("-");case"Trim":return y.trim();case"Substring":return y.substring(r.substringStart,r.substringEnd)}}),p={id:d.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:r=>{for(const g of r)for(const y of g.fields)if(y.type==="string")return s.M.Applicable;return s.M.NotApplicable},operator:r=>g=>g.pipe((0,n.T)(y=>{if(y.length===0)return y;const v=l.sJ.get(o.Ct.byName).get(r.stringField),x=m(r),f=h(v,x);return y.map(u=>({...u,fields:f(u,y)}))}))},h=(r,g)=>(y,v)=>y.fields.map(x=>{if(r(x,y,v)){const f=g(x);return{...x,type:a.PU.string,values:f}}return x})},47433:(Z,R,e)=>{"use strict";e.d(R,{Ce:()=>y,R3:()=>p,Y2:()=>g,of:()=>h});var n=e(81160),a=e(16515),s=e(79319),l=e(46644),o=e(36638),d=e(57866),i=e(64761),c=e(91146);const m=2;var p=(v=>(v.aggregate="aggregate",v.groupBy="groupby",v))(p||{});const h={id:i.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:v=>(0,c.f)(v)>=m?s.M.Applicable:s.M.NotApplicable,isApplicableDescription:v=>{const x=(0,c.f)(v);return`The Group by transformation requires a series with at least ${m} fields to work. The maximum number of fields found on a series is ${x}`},operator:v=>x=>x.pipe((0,n.T)(f=>{const u=[];for(const[D,C]of Object.entries(v.fields))C.operation==="groupby"&&u.push(D);if(u.length===0)return f;const b=(0,o.NS)({id:d.Ct.byNames,options:{names:u}}),E=[];for(const D of f){const C=D.fields.filter(O=>b(O,D,f));if(C.length===0)continue;const P=g(D,C),T=y(C,P);for(const O of D.fields){if(!r(O,v))continue;const I=(0,a.Ct)(O),j=v.fields[I].aggregations,W={};P.forEach(B=>{const S=B[I],w=(0,l.Nw)({field:S,reducers:j});for(const N of j)Array.isArray(W[N])||(W[N]=[]),W[N].push(w[N])});for(const B of j){const S={name:`${I} (${B})`,values:W[B]??[],type:(0,l.AH)(B,O.type),config:{}};T.push(S)}}E.push({refId:D.refId,fields:T,length:P.size})}return E}))},r=(v,x)=>{const f=(0,a.Ct)(v);return x?.fields[f]?.operation==="aggregate"&&Array.isArray(x?.fields[f].aggregations)&&x?.fields[f].aggregations.length>0};function g(v,x){const f=new Map;for(let u=0;u<v.length;u++){const b=String(x.map(D=>D.values[u])),E=f.get(b)??{};f.has(b)||f.set(b,E);for(let D of v.fields){const C=(0,a.Ct)(D);E[C]||(E[C]={name:C,type:D.type,config:{...D.config},values:[]}),E[C].values.push(D.values[u])}}return f}function y(v,x){const f=[];for(const u of v){const b=[],E=(0,a.Ct)(u);x.forEach(D=>{b.push(D[E].values[0])}),f.push({name:u.name,type:u.type,config:{...u.config},values:b})}return f}},25260:(Z,R,e)=>{"use strict";e.d(R,{_:()=>g,l:()=>p});var n=e(81160),a=e(41119),s=e(16515),l=e(95004),o=e(79319),d=e(46644),i=e(47433),c=e(64761),m=e(91146);const p=!0,h=2;var r=(b=>(b.aggregate="aggregate",b.groupBy="groupby",b))(r||{});const g={id:c.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:p,fields:{}},isApplicable:b=>(0,m.f)(b)>=h?o.M.Applicable:o.M.NotApplicable,isApplicableDescription:b=>{const E=(0,m.f)(b);return`The Group to nested table transformation requires a series with at least ${h} fields to work. The maximum number of fields found on a series is ${E}`},operator:b=>E=>E.pipe((0,n.T)(D=>{if(!Object.keys(b.fields).find(T=>b.fields[T].operation==="groupby"))return D;const P=[];for(const T of D){const O=T.fields.filter(B=>v(B,b));if(O.length===0)continue;const I=(0,i.Y2)(T,O),j=(0,i.Ce)(O,I),W=u(I,b);for(let B=0;B<T.fields.length;B++){const S=T.fields[B];if(!x(S,b))continue;const w=(0,s.Ct)(S),N=b.fields[w].aggregations,M={};I.forEach(L=>{const A=L[w],U=(0,d.Nw)({field:A,reducers:N});for(const F of N)Array.isArray(M[F])||(M[F]=[]),M[F].push(U[F])});for(const L of N){const A={name:`${w} (${L})`,values:M[L],type:l.PU.other,config:{}};A.type=f(L,S,A),j.push(A)}}j.push({config:{},name:"__nestedFrames",type:l.PU.nestedFrames,values:W}),P.push({fields:j,length:I.size})}return P}))};function y(b,E,D){return{meta:{custom:{noHeader:!(D.showSubframeHeaders===void 0?p:D.showSubframeHeaders)}},length:E,fields:b}}const v=(b,E)=>{const D=(0,s.Ct)(b);return E?.fields[D]?.operation==="groupby"},x=(b,E)=>{const D=(0,s.Ct)(b);return E?.fields[D]?.operation==="aggregate"&&Array.isArray(E?.fields[D].aggregations)&&E?.fields[D].aggregations.length>0},f=(b,E,D)=>{switch(b){case d.gy.allIsNull:return l.PU.boolean;case d.gy.last:case d.gy.lastNotNull:case d.gy.first:case d.gy.firstNotNull:return E.type;default:return(0,a.dF)(D)??l.PU.string}};function u(b,E){const D=[];for(const[,C]of b){const P=[];for(const[T,O]of Object.entries(C)){const I=E.fields[T];(I===void 0||I.aggregations===void 0||I.operation==="aggregate"&&I.aggregations.length===0||I.operation===null||I.operation===void 0)&&P.push(O)}P.length>0?D.push([y(P,P[0].values.length,E)]):D.push([y([],0,E)])}return D}},74261:(Z,R,e)=>{"use strict";e.d(R,{EO:()=>j,H1:()=>b,NX:()=>f,OA:()=>v,Rt:()=>y,Uh:()=>P,ZU:()=>C,cg:()=>I,d$:()=>x,dA:()=>u,ix:()=>E,p3:()=>D,rW:()=>p,rs:()=>T});var n=e(81160),a=e(8721),s=e(11576),l=e(69884),o=e(95004),d=e(39443),i=e(79243),c=e(64761),m=e(34455);const p=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],h=30,r=[],g=(W,B)=>W-B,y={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},v={id:c.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(W,B)=>S=>S.pipe((0,n.T)(w=>v.transformer(W,B)(w))),transformer:(W,B)=>S=>{if(!Array.isArray(S)||S.length===0)return S;let w,N;W.bucketSize&&(typeof W.bucketSize=="string"?w=parseFloat(W.bucketSize):w=W.bucketSize,isNaN(w)&&(w=void 0)),W.bucketOffset&&(typeof W.bucketOffset=="string"?N=parseFloat(W.bucketOffset):N=W.bucketOffset,isNaN(N)&&(N=void 0));const M={bucketSize:w,bucketOffset:N,combine:W.combine},L=D(S,M);return L==null?[]:[I(L)]}},x="xMin";function f(W){return W===x||W==="BucketMin"}const u="xMax";function b(W){return W===u||W==="BucketMax"}function E(W){if(W.meta?.type===d.m.HeatmapCells){let N=W.fields.find(K=>K.name==="yMin"),M=W.fields.find(K=>K.name==="yMax"),L=W.fields.find(K=>K.name==="count"),A=[...new Set(M.values)].sort((K,G)=>K-G),U=[...new Set(N.values)].sort((K,G)=>K-G),F=new Map;A.forEach(K=>F.set(K,0));for(let K=0;K<M.values.length;K++){let G=M.values[K];F.set(G,F.get(G)+L.values[K])}return{xMin:{...N,name:"xMin",values:U},xMax:{...M,name:"xMax",values:A},counts:[{...L,values:[...F.values()]}]}}else if(W.meta?.type===d.m.HeatmapRows){let N=[],M=[],L=[],A="0";return W.fields.forEach(F=>{if(F.type===o.PU.number){let V=F.values.reduce((K,G)=>K+G,0);L.push(V),N.push(A),M.push(A=F.name)}}),L.push(0),N.push(A),M.push(A),{xMin:{...W.fields[1],name:"xMin",type:o.PU.string,values:N},xMax:{...W.fields[1],name:"xMax",type:o.PU.string,values:M},counts:[{...W.fields[1],name:"count",type:o.PU.number,values:L}]}}let B,S;const w=[];for(const N of W.fields)f(N.name)?B=N:b(N.name)?S=N:N.type===o.PU.number&&w.push(N);if(!S&&B&&B.values.length>1){let N=B.values,M=(0,i.h)(N[1]-N[0],6);S={...B,name:u,values:N.map(L=>L+M)}}if(!B&&S&&S?.values.length>1){let N=S.values,M=(0,i.h)(N[1]-N[0],6);B={...S,name:x,values:N.map(L=>L-M)}}if(B&&S&&w.length)return{xMin:B,xMax:S,counts:w}}function D(W,B,S){let w=B?.bucketSize,N=B?.bucketCount??h,M=B?.bucketOffset??0;if(W=W.map(_=>({..._,fields:_.fields.map(k=>{if(k.type===o.PU.number){const J=Number(k.config.noValue);Number.isNaN(J)?k={...k,values:k.values.filter(z=>z!=null)}:k=(0,m.A)(k,J)}return k})})),!w||w<0){let _=[];for(const Q of W)for(const q of Q.fields)q.type===o.PU.number&&(_=_.concat(q.values));_.sort((Q,q)=>Q-q);let k=1/0;if(_.length===1)k=1;else for(let Q=1;Q<_.length;Q++){let q=_[Q]-_[Q-1];q!==0&&(k=Math.min(k,q))}let J=_[0];const X=(_[_.length-1]-J)/N;for(let Q=0;Q<p.length;Q++){let q=p[Q];if(X<q&&q>=k){w=q;break}}}const L=_=>(0,i.h)(T(_-M,w)+M,9);let A=((""+w).match(/\.\d+$/)??["."])[0].length-1,U=[],F=[],V;for(const _ of W)for(const k of _.fields)if(k.type===o.PU.number){let J=O(k.values,L,r,g);U.push(J);const z={...k,config:{...k.config,unit:k.config.unit==="short"?"short":void 0}};z.display=(0,s.J)({field:z,theme:S??(0,l.a)()}),F.push(z),!V&&k.config.unit&&(V=k.config)}if(!F.length)return null;let K=(0,a.fj)(U);for(let _=1;_<K.length;_++){let k=K[_];for(let J=0;J<k.length;J++)k[J]==null&&(k[J]=0)}const G={name:x,values:K[0],type:o.PU.number,state:void 0,config:A===0?V??{}:{...V,decimals:A}},H={...G,name:u,values:K[0].map(_=>_+w)};if(B?.combine){const _=new Array(K[0].length).fill(0);for(let k=1;k<K.length;k++)for(let J=0;J<_.length;J++)_[J]+=K[k][J];F=[{...F[0],name:"count",values:_,type:o.PU.number,state:{...F[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else F.forEach((_,k)=>{_.values=K[k+1]});return{xMin:G,xMax:H,counts:F}}function C(W,B){return Math.round(W/B)*B}function P(W,B){return Math.ceil(W/B)*B}function T(W,B){return Math.floor(W/B)*B}function O(W,B,S,w){let N=new Map;for(let U=0;U<W.length;U++){let F=W[U];F!=null&&(F=B(F));let V=N.get(F);V?V.count++:N.set(F,{value:F,count:1})}S&&S.forEach(U=>N.delete(U));let M=[...N.values()];w&&M.sort((U,F)=>w(U.value,F.value));let L=Array(M.length),A=Array(M.length);for(let U=0;U<M.length;U++)L[U]=M[U].value,A[U]=M[U].count;return[L,A]}function I(W,B){if(!W.xMin.display){const S=(0,s.J)({field:W.xMin,theme:B??(0,l.a)()});W.xMin.display=S,W.xMax.display=S}return{length:W.xMin.values.length,meta:{type:d.m.Histogram},fields:[W.xMin,W.xMax,...W.counts],refId:`${c.F.histogram}`}}function j(W){if(W.length===1)return W[0];let B=(0,a.Fd)({frames:W.map(L=>({length:L.xMax.values.length,fields:[L.xMax,L.xMin,...L.counts]})),joinBy:L=>L.name==="xMax"}),S=null,w=null,N=[];return B.fields.forEach(L=>{if(L.name==="xMax")S=L;else if(L.name==="xMin")if(w==null)w=L;else for(let A=0;A<L.values.length;A++)w.values[A]??=L.values[A];else N.push({...L,values:L.values.map(A=>A??0)})}),{xMin:w,xMax:S,counts:N}}},64761:(Z,R,e)=>{"use strict";e.d(R,{F:()=>n});var n=(a=>(a.append="append",a.reduce="reduce",a.order="order",a.organize="organize",a.rename="rename",a.calculateField="calculateField",a.seriesToColumns="seriesToColumns",a.seriesToRows="seriesToRows",a.merge="merge",a.concatenate="concatenate",a.labelsToFields="labelsToFields",a.filterFields="filterFields",a.filterFieldsByName="filterFieldsByName",a.filterFrames="filterFrames",a.filterByRefId="filterByRefId",a.renameByRegex="renameByRegex",a.filterByValue="filterByValue",a.noop="noop",a.ensureColumns="ensureColumns",a.groupBy="groupBy",a.sortBy="sortBy",a.histogram="histogram",a.configFromData="configFromData",a.rowsToFields="rowsToFields",a.prepareTimeSeries="prepareTimeSeries",a.convertFieldType="convertFieldType",a.fieldLookup="fieldLookup",a.heatmap="heatmap",a.spatial="spatial",a.joinByField="joinByField",a.joinByLabels="joinByLabels",a.extractFields="extractFields",a.groupingToMatrix="groupingToMatrix",a.limit="limit",a.partitionByValues="partitionByValues",a.timeSeriesTable="timeSeriesTable",a.transpose="transpose",a.formatTime="formatTime",a.formatString="formatString",a.regression="regression",a.groupToNestedTable="groupToNestedTable",a))(n||{})},6684:(Z,R,e)=>{"use strict";e.d(R,{L:()=>i,W:()=>d});var n=e(81160),a=e(36638),s=e(57866),l=e(64761),o=e(8721),d=(c=>(c.outer="outer",c.inner="inner",c.outerTabular="outerTabular",c))(d||{});const i={id:l.F.joinByField,aliasIds:[l.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(c,m)=>p=>p.pipe((0,n.T)(h=>i.transformer(c,m)(h))),transformer:(c,m)=>{let p;return h=>{if(h.length>1){c.byField&&!p&&(p=a.sJ.get(s.Ct.byName).get(c.byField));const r=(0,o.Fd)({frames:h,joinBy:p,mode:c.mode});if(r)return r.refId=`${l.F.joinByField}-${h.map(g=>g.refId).join("-")}`,[r]}return h}}}},8721:(Z,R,e)=>{"use strict";e.d(R,{Fd:()=>m,JI:()=>g,RC:()=>h,WO:()=>r,Yj:()=>c,fj:()=>v,g2:()=>x});var n=e(41119),a=e(95004),s=e(36638),l=e(57866),o=e(6684);function d(f){const{timeField:u}=(0,n.KR)(f[0]);if(u)return s.sJ.get(l.Ct.firstTimeField).get({});let b=[];for(const E of f[0].fields)E.type===a.PU.number&&b.push(E.name);for(let E=1;E<f.length;E++){const D=[];for(const C of f[0].fields)C.type===a.PU.number&&D.push(C.name);b=b.filter(C=>!D.includes(C))}return s.sJ.get(l.Ct.byName).get(b[0])}function i(f){return f.joinBy??d(f.frames)}function c(f,u){if(u>=0){let b=f.fields[u];b.type!==a.PU.string&&!x(b.values)&&(f=(0,n.ES)(f,u))}return f}function m(f){if(!f.frames?.length)return;const u=f.nullMode??(T=>{let O=T.config.custom?.spanNulls;return O===!0?h:O===-1?r:g});if(f.frames.length===1){let T=f.frames[0],O=T;const I=i(f);let j=O.fields.findIndex(W=>I(W,O,f.frames));if(f.keepOriginIndices&&(O={...T,fields:T.fields.map((W,B)=>{const S={...W},w={frameIndex:0,fieldIndex:B};return S.state?S.state.origin=w:S.state={origin:w},S})},j>0)){const W=O.fields[j],B=O.fields.filter((S,w)=>w!==j);B.unshift(W),O.fields=B,j=0}if(j>=0&&(O=c(O,j)),f.keep){let W=O.fields.filter((B,S)=>S===j||f.keep(B,O,f.frames));T!==O?O.fields=W:O={...T,fields:W}}return O}const b=[],E=[],D=[],C=i(f);for(let T=0;T<f.frames.length;T++){const O=f.frames[T];if(!O||!O.fields?.length)continue;const I=[h];let j,W=[];for(let S=0;S<O.fields.length;S++){const w=O.fields[S];if(w.state=w.state||{},!j&&C(w,O,f.frames))j=w;else{if(f.keep&&!f.keep(w,O,f.frames))continue;I.push(u(w));let N=w.labels??{},M=w.name;O.name&&(w.name===a.Bc?M=O.name:N.name==null&&(N={...N,name:O.name})),W.push({...w,name:M,labels:N})}f.keepOriginIndices&&(w.state.origin={frameIndex:T,fieldIndex:S})}if(!j)continue;D.length===0&&D.push(j),b.push(I);const B=[j.values];for(const S of W)B.push(S.values),D.push(S),f.keepDisplayNames||delete S.state?.displayName;E.push(B)}let P=[];return f.mode===o.W.outerTabular?P=p(E,!0):f.mode===o.W.inner?P=p(E):P=v(E,b,f.mode),{length:P[0]?P[0].length:0,fields:D.map((T,O)=>({...T,values:P[O]}))}}function p(f,u=!1){let b=f[0],E=b[0];for(let D=1;D<f.length;D++){let C=f[D],P=C[0],T={};for(let F=0;F<P.length;F++){let V=P[F],K=T[V];K==null&&(K=T[V]=[]),K.push(F)}let O=new Set,I=[],j=[],W=[],B=0;for(let F=0;F<E.length;F++){let V=E[F];if(V!=null){let K=T[V];K!=null?(W.push([F,K]),B+=K.length,u&&O.add(V)):u&&I.push(F)}else u&&I.push(F)}if(B+=I.length,u){for(let F in T)O.has(F)||j.push(...T[F]);B+=j.length}let S=Array.from({length:b.length+C.length-1},()=>`Array(${B})`).join(","),w=b.map((F,V)=>`joined[${V}][rowIdx] = ltable[${V}][lidx]`).join(";"),N=C.slice(1).map((F,V)=>`joined[${b.length+V}][rowIdx] = rtable[${V+1}][ridx]`).join(";"),M=b.map((F,V)=>`joined[${V}][rowIdx] = ${V===0?`rtable[${V}][ridx]`:"null"}`).join(";"),L=C.slice(1).map((F,V)=>`joined[${b.length+V}][rowIdx] = null`);b=new Function("matched","unmatchedLeft","unmatchedRight","ltable","rtable",`
      const joined = [${S}];

      let rowIdx = 0;

      for (let i = 0; i < matched.length; i++) {
        let [lidx, ridxs] = matched[i];

        for (let j = 0; j < ridxs.length; j++, rowIdx++) {
          let ridx = ridxs[j];
          ${w};
          ${N};
        }
      }

      for (let i = 0; i < unmatchedLeft.length; i++, rowIdx++) {
        let lidx = unmatchedLeft[i];
        ${w};
        ${L};
      }

      for (let i = 0; i < unmatchedRight.length; i++, rowIdx++) {
        let ridx = unmatchedRight[i];
        ${M};
        ${N};
      }

      return joined;
      `)(W,I,j,b,C),E=b[0]}return b}const h=0,r=1,g=2;function y(f,u,b){for(let E=0,D,C=-1;E<u.length;E++){let P=u[E];if(P>C){for(D=P-1;D>=0&&f[D]==null;)f[D--]=null;for(D=P+1;D<b&&f[D]==null;)f[C=D++]=null}}}function v(f,u,b=o.W.outer){let E=new Set;for(let T=0;T<f.length;T++){let I=f[T][0],j=I.length;for(let W=0;W<j;W++)E.add(I[W])}let D=[Array.from(E).sort((T,O)=>T-O)],C=D[0].length,P=new Map;for(let T=0;T<C;T++)P.set(D[0][T],T);for(let T=0;T<f.length;T++){let O=f[T],I=O[0];for(let j=1;j<O.length;j++){let W=O[j],B=Array(C).fill(void 0),S=u?u[T][j]:r,w=[];for(let N=0;N<W.length;N++){let M=W[N],L=P.get(I[N]);M===null?S!==h&&(B[L]=M,S===g&&w.push(L)):B[L]=M}y(B,w,C),D.push(B)}}return D}function x(f,u=50){const b=f.length;if(b<=1)return!0;let E=0,D=b-1;for(;E<=D&&f[E]==null;)E++;for(;D>=E&&f[D]==null;)D--;if(D<=E)return!0;const C=Math.max(1,Math.floor((D-E+1)/u));for(let P=f[E],T=E+C;T<=D;T+=C){const O=f[T];if(O!=null&&P!=null){if(O<=P)return!1;P=O}}return!0}},79184:(Z,R,e)=>{"use strict";e.d(R,{V:()=>d,n:()=>o});var n=e(81160),a=e(16515),s=e(95004),l=e(64761),o=(c=>(c.Columns="columns",c.Rows="rows",c))(o||{});const d={id:l.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(c,m)=>p=>p.pipe((0,n.T)(h=>d.transformer(c,m)(h))),transformer:c=>m=>{if(c.mode==="rows")return i(m,c.keepLabels);const p=[],h=c.keepLabels?.length?new Set(c.keepLabels):void 0;for(const r of m){const g=[],y={};for(const v of r.fields){if(!v.labels){g.push(v);continue}const x={...v,config:{...v.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};g.push(x);for(const f of Object.keys(v.labels)){if(h&&!h.has(f))continue;if(c.valueLabel===f){x.name=v.labels[f];continue}(y[f]??(y[f]=new Set)).add(v.labels[f])}}for(const v in y)for(const x of y[v]){const f=new Array(r.length).fill(x);g.push({name:v,type:s.PU.string,values:f,config:{}})}p.push({...r,fields:g,length:r.length})}return p}};function i(c,m){const p=[];for(const h of c)for(const r of h.fields)if(r.labels){const g=[],y=[];if(m)for(const v of m)g.push(v),y.push(r.labels[v]);else for(const[v,x]of Object.entries(r.labels))g.push(v),y.push(x);y.length&&p.push({...h,name:(0,a.Ct)(r,h,c),fields:[{name:"label",type:s.PU.string,config:{},values:g},{name:"value",type:s.PU.string,config:{},values:y}],length:y.length})}return p}},33023:(Z,R,e)=>{"use strict";e.d(R,{o:()=>i});var n=e(2543),a=e.n(n),s=e(81160),l=e(18700),o=e(79319),d=e(64761);const i={id:d.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:y=>y.length>1?o.M.Applicable:o.M.NotApplicable,isApplicableDescription:y=>`The merge transformation requires at least 2 data series to work. There is currently ${y.length} data series.`,operator:y=>v=>v.pipe((0,s.T)(x=>{if(!Array.isArray(x)||x.length<=1)return x;const f=x.filter(I=>I.fields.length>0);if(f.length===0)return[x[0]];const u=new Set,b={},E=[],D=new l.k({refId:`${d.F.merge}-${f.map(I=>I.refId).join("-")}`,fields:[]});for(let I=0;I<f.length;I++){const j=f[I];for(let W=0;W<j.fields.length;W++){const B=j.fields[W];u.has(B.name)||(D.addField(c(B)),u.add(B.name)),b[B.name]=b[B.name]||{},b[B.name][I]=W,f.length-1===I&&r(b,B,f)&&E.push(B.name)}}if(E.length===0)return x;const C={},P=[],T=m(f,b,E),O=p(f,u,b);for(let I=0;I<f.length;I++){const j=f[I];for(let W=0;W<j.length;W++){const B=T(I,W),S=O(I,W);if(!Array.isArray(C[B])){C[B]=[S],P.push(g(B,C));continue}let w=!1;C[B]=C[B].map(N=>h(N,S)?(w=!0,{...N,...S}):N),w||(C[B].push(S),P.push(g(B,C)))}}for(const I of P){const j=C[I.key][I.index];j&&D.add(j)}return[D]}))},c=y=>({...(0,n.omit)(y,["values","state","labels","config"]),values:[],config:{...(0,n.omit)(y.config,"displayName")}}),m=(y,v,x)=>{const f=x.reduce((u,b)=>Object.keys(v[b]).reduce((E,D)=>(E[D]=E[D]||[],E[D].push(v[b][D]),E),u),{});return(u,b)=>f[u].reduce((E,D)=>E+y[u].fields[D].values[b],"")},p=(y,v,x)=>(f,u)=>{const b={},E=Array.from(v);for(const D of E){const C=x[D];if(!C)continue;const P=C[f];if(typeof P!="number")continue;const T=y[f];if(!T||!T.fields)continue;const O=T.fields[P];!O||!O.values||(b[D]=O.values[u])}return b},h=(y,v)=>{let x=!0;for(const f in v)if(!(typeof y[f]>"u")&&y[f]!==null&&y[f]!==v[f]){x=!1;break}return x},r=(y,v,x)=>Object.keys(y[v.name]).length===x.length,g=(y,v)=>({key:y,index:v[y].length-1})},1027:(Z,R,e)=>{"use strict";e.d(R,{W:()=>a});var n=e(64761);const a={id:n.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:s=>l=>l,transformer:s=>l=>l}},63409:(Z,R,e)=>{"use strict";e.d(R,{M:()=>l});var n=e(95004);const a={threshold:(d,i,c)=>d+c,midpoint:(d,i,c)=>(d+i)/2,plusone:(d,i,c)=>d+1};function s(d,i){return d.fields.find(c=>i!=null?c.name===i:c.type===n.PU.time)}function l(d){if(d.frame.length===0)return d.frame;let i=!0,{frame:c,refFieldName:m,refFieldPseudoMax:p,refFieldPseudoMin:h,insertMode:r}=d;r||(r=a.threshold);const g=s(c,m);if(g==null)return c;g.state={...g.state,nullThresholdApplied:!0};const y=c.fields.map(x=>x.config.custom?.insertNulls||g.config.interval||null),v=new Set(y);if(v.delete(null),v.size===0)return c;if(v.size===1){const x=v.values().next().value;if(!x||x<=0)return c;const f=g.values,u=c.fields.map(E=>E.values),b=o(f,u,x,h,p,r,i);return b===u?c:{...c,length:b[0].length,fields:c.fields.map((E,D)=>({...E,values:b[D]}))}}return c}function o(d,i,c,m=null,p=null,h,r){const g=d.length,y=[];if(m!=null&&m<d[0]){let u=Math.ceil((d[0]-m)/c),b=d[0]-u*c;for(;b<d[0];)y.push(h(b-c,b,c)),b+=c}y.push(d[0]);let v=d[0];for(let u=1;u<g;u++){const b=d[u];for(;b-v>c&&(y.push(h(v,b,c)),v+=c,!!r););y.push(b),v=b}if(p!=null&&p>v)for(;v+c<p;)y.push(h(v,p,c)),v+=c;const x=y.length;if(x===g)return i;const f=[];for(let u of i){let b;if(u!==d){b=Array(x);for(let E=0,D=0;E<x;E++)b[E]=d[D]===y[E]?u[D++]:null}else b=y;f.push(b)}return f}},34455:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a,C:()=>n});function n(s){return{...s,fields:s.fields.map(l=>{const o=Number(l.config.noValue);return Number.isNaN(o)?l:a(l,o)})}}function a(s,l){const o=s.values.slice();for(let d=0;d<o.length;d++)o[d]===null&&(o[d]=l);return{...s,values:o}}},95575:(Z,R,e)=>{"use strict";e.d(R,{Mq:()=>m,NU:()=>i,Xz:()=>h,pH:()=>c,wx:()=>v,xQ:()=>p});var n=e(2543),a=e.n(n),s=e(81160),l=e(16515),o=e(95004),d=e(64761),i=(x=>(x.Manual="manual",x.Auto="auto",x))(i||{}),c=(x=>(x.Off="off",x.Asc="asc",x.Desc="desc",x))(c||{}),m=(x=>(x.Name="name",x.Label="label",x))(m||{});const p={id:d.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:({indexByName:x,orderByMode:f="manual",orderBy:u=[]})=>b=>b.pipe((0,s.T)(E=>{(0,l.Fm)(E);const D=f==="manual"?r(x):v(u);return E.map(C=>({...C,fields:D(C.fields,E,C)}))}))},h=x=>(f,u)=>g(f,x)-g(u,x),r=x=>(f,u,b)=>{const E=h(x);return(0,n.clone)(f).sort((D,C)=>E((0,l.Ct)(D,b,u),(0,l.Ct)(C,b,u)))},g=(x,f)=>Number.isInteger(f[x])?f[x]:Number.MAX_SAFE_INTEGER,y=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}).compare,v=x=>f=>{const u=f.find(b=>b.type===o.PU.time);return f.slice().sort((b,E)=>{if(b===u)return-1;if(E===u)return 1;for(let D=0;D<x.length;D++){let{type:C,name:P="",desc:T=!1}=x[D],O=C==="name"?b.state?.displayName??b.name:b.labels?.[P]??"",I=C==="name"?E.state?.displayName??E.name:E.labels?.[P]??"",j=y(O,I)*(T?-1:1);if(j!==0)return j}return 0})}},32157:(Z,R,e)=>{"use strict";e.d(R,{Wj:()=>p,rV:()=>m});var n=e(81160),a=e(41119),s=e(16515),l=e(95004),o=e(46644),d=e(36638),i=e(6844),c=e(64761),m=(x=>(x.SeriesToRows="seriesToRows",x.ReduceFields="reduceFields",x))(m||{});const p={id:c.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[o.gy.max]},operator:x=>f=>f.pipe((0,n.T)(u=>{if(!x?.reducers?.length)return u;const b=x.fields?(0,d.NS)(x.fields):x.includeTimeField&&x.mode==="reduceFields"?i.Yg:i.zx;if(x.mode==="reduceFields")return y(u,b,x.reducers);const E=h(u,b,x.reducers,x.labelsToFields);return E?[{...E,refId:`${c.F.reduce}-${u.map(D=>D.refId).join("-")}`}]:[]}))};function h(x,f,u,b){const E=o.AS.list(u),D=E.map(T=>T.id),C=[],P=b?r(x):[];for(const T of x){const O=T.fields.filter(w=>f(w,T,x)),I=O.length,j=[],W=new Array(I);j.push({name:"Field",type:l.PU.string,values:W,config:{}});const B={};if(b)for(const w of P)B[w]=new Array(I),j.push({name:w,type:l.PU.string,values:B[w],config:{}});const S={};for(const w of E)S[w.id]=new Array(I),j.push({name:w.name,type:l.PU.other,values:S[w.id],config:{}});for(let w=0;w<O.length;w++){const N=O[w],M=(0,o.Nw)({field:N,reducers:D});if(b){if(W[w]=N.name,N.labels)for(const L in N.labels)B[L][w]=N.labels[L]}else W[w]=(0,s.Ct)(N,T,x);for(const L of E){const A=M[L.id];A===null?S[L.id][w]=NaN:S[L.id][w]=A}}for(const w of j)if(w.type===l.PU.other){const N=(0,a.dF)(w);N&&(w.type=N)}C.push({...T,fields:j,length:I})}return g(C)}function r(x){const f=new Set;for(const u of x)for(const b of u.fields)if(b.labels)for(const E of Object.keys(b.labels))f.add(E);return[...f]}function g(x){if(!x?.length)return;const f=x[0];for(let u=1;u<x.length;u++){const b=x[u];for(let E=0;E<f.fields.length;E++){const D=f.fields[E];for(let C=0;C<b.fields.length;C++){const P=b.fields[C],T=E===0&&C===0,O=D.type===P.type&&D.name===P.name;if(T||O){const I=D.values,j=P.values;D.values=I.concat(j)}}}}return f.name=void 0,f.length=f.fields[0].values.length,f}function y(x,f,u){const E=o.AS.list(u).map(C=>C.id),D=[];for(const C of x){const P=[];for(const T of C.fields)if(f(T,C,x)){const O=(0,o.Nw)({field:T,reducers:E});for(const I of E){const j=O[I],W={...T,labels:{...T.labels},type:v(I,T),values:[j],state:void 0};E.length>1&&(W.labels||(W.labels={}),W.labels.reducer=o.AS.get(I).name),P.push(W)}}P.length&&D.push({...C,fields:P,length:1})}return D}function v(x,f){switch(x){case o.gy.allValues:case o.gy.uniqueValues:return l.PU.other;case o.gy.first:case o.gy.firstNotNull:case o.gy.last:case o.gy.lastNotNull:return f.type;default:return l.PU.number}}},91146:(Z,R,e)=>{"use strict";e.d(R,{f:()=>n});function n(a){let s=0;for(const l of a)l.fields.length>s&&(s=l.fields.length);return s}},85891:(Z,R,e)=>{"use strict";e.d(R,{DO:()=>s,Ur:()=>o,VR:()=>a,X2:()=>n,ki:()=>l,mx:()=>d});var n=(i=>(i.Fetch="fetch",i))(n||{}),a=(i=>(i.String="string",i))(a||{}),s=(i=>(i.POST="POST",i.PUT="PUT",i.GET="GET",i))(s||{});const l=[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"GET",value:"GET"}],o=[{label:"application/json",value:"application/json"},{label:"text/plain",value:"text/plain"},{label:"application/xml",value:"application/xml"},{label:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}],d={type:"fetch",title:"",fetch:{url:"",method:"POST",body:"{}",queryParams:[],headers:[["Content-Type","application/json"]]}}},76190:(Z,R,e)=>{"use strict";e.d(R,{O:()=>n});var n=(a=>(a.NoData="no_data",a.Paused="paused",a.Alerting="alerting",a.OK="ok",a.Pending="pending",a.Recovering="recovering",a.Unknown="unknown",a))(n||{})},88907:(Z,R,e)=>{"use strict";e.d(R,{V:()=>n});var n=(a=>(a.Field="field",a.Text="text",a.Skip="skip",a))(n||{})},1906:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>o,Jk:()=>s,hX:()=>l});var n=e(78830),a=e(11594),s=(d=>(d.CloudAlerting="cloud-alerting",d.UnifiedAlerting="unified-alerting",d.Dashboard="dashboard",d.Explore="explore",d.Correlations="correlations",d.Unknown="unknown",d.PanelEditor="panel-editor",d.PanelViewer="panel-viewer",d))(s||{});class l extends a.Ud{constructor(){super(...arguments),this._exposedComponentConfigs=[],this._addedComponentConfigs=[],this._addedLinkConfigs=[],this._addedFunctionConfigs=[]}init(i){}setRootPage(i){return this.root=i,this}setComponentsFromLegacyExports(i){if((0,n.M)(i),this.meta&&this.meta.includes){for(const c of this.meta.includes)if(c.type===a.ib.page&&c.component&&!i[c.component]){console.warn("App Page uses unknown component: ",c.component,this.meta);continue}}}get exposedComponentConfigs(){return this._exposedComponentConfigs}get addedComponentConfigs(){return this._addedComponentConfigs}get addedLinkConfigs(){return this._addedLinkConfigs}get addedFunctionConfigs(){return this._addedFunctionConfigs}addLink(i){return this._addedLinkConfigs.push(i),this}addComponent(i){return this._addedComponentConfigs.push(i),this}addFunction(i){return this._addedFunctionConfigs.push(i),this}exposeComponent(i){return this._exposedComponentConfigs.push(i),this}}var o=(d=>(d.alpha="alpha",d.beta="beta",d.experimental="experimental",d.privatePreview="private preview",d.preview="preview",d.new="new",d))(o||{})},41607:(Z,R,e)=>{"use strict";e.d(R,{r:()=>n});var n=(a=>(a.OpenSource="Open Source",a.Pro="Pro",a.Enterprise="Enterprise",a))(n||{})},48588:(Z,R,e)=>{"use strict";e.d(R,{En:()=>s,d1:()=>a,tw:()=>n});const n=0,a=100,s="SAML"},84229:(Z,R,e)=>{"use strict";e.d(R,{y:()=>n});var n=(a=>(a[a.Off=0]="Off",a[a.Crosshair=1]="Crosshair",a[a.Tooltip=2]="Tooltip",a))(n||{})},28105:(Z,R,e)=>{"use strict";e.d(R,{Gu:()=>n,Gv:()=>d,Nx:()=>a,UW:()=>s,zz:()=>l});var n=(i=>(i.NotStarted="NotStarted",i.Loading="Loading",i.Streaming="Streaming",i.Done="Done",i.Error="Error",i))(n||{});const a=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var s=(i=>(i.Null="null",i.Ignore="connected",i.AsZero="null as zero",i))(s||{});const l=i=>!!i;function o(i){return i}function d(i){return typeof i=="object"&&i!==null?!0:!1}},39443:(Z,R,e)=>{"use strict";e.d(R,{m:()=>n});var n=(a=>(a.TimeSeriesWide="timeseries-wide",a.TimeSeriesLong="timeseries-long",a.TimeSeriesMany="timeseries-many",a.TimeSeriesMulti="timeseries-multi",a.NumericWide="numeric-wide",a.NumericMulti="numeric-multi",a.NumericLong="numeric-long",a.LogLines="log-lines",a.DirectoryListing="directory-listing",a.HeatmapRows="heatmap-rows",a.HeatmapCells="heatmap-cells",a.Histogram="histogram",a))(n||{})},79609:(Z,R,e)=>{"use strict";e.d(R,{$0:()=>s,CC:()=>a,uP:()=>l,x0:()=>n,yd:()=>o});var n=(d=>(d.Datasource="Datasource",d.Correlations="Correlations",d.ExploreCorrelationsEditor="CorrelationsEditor",d))(n||{}),a=(d=>(d.Regex="regex",d.Logfmt="logfmt",d))(a||{}),s=(d=>(d.Series="series",d.Field="field",d.Fields="fields",d.Value="value",d.BuiltIn="built-in",d.Template="template",d))(s||{}),l=(d=>(d.Values="values",d))(l||{}),o=(d=>(d.Action="action",d.Link="link",d.Off="off",d))(o||{})},94644:(Z,R,e)=>{"use strict";e.d(R,{Is:()=>m,ZF:()=>i,mA:()=>d,tD:()=>o,v2:()=>c});var n=e(37615),a=e(35814),s=e(78830),l=e(11594);class o extends l.Ud{constructor(h){super(),this.DataSourceClass=h,this.components={}}setConfigEditor(h){return this.components.ConfigEditor=h,this}setConfigCtrl(h){return(0,n.l)("DataSourcePlugin","setConfigCtrl"),this.angularConfigCtrl=h,this}setQueryCtrl(h){return(0,n.l)("DataSourcePlugin","setQueryCtrl"),this.components.QueryCtrl=h,this}setAnnotationQueryCtrl(h){return this.components.AnnotationsQueryCtrl=h,this}setQueryEditor(h){return this.components.QueryEditor=h,this}setExploreQueryField(h){return this.components.ExploreQueryField=h,this}setExploreMetricsQueryField(h){return this.components.ExploreMetricsQueryField=h,this}setExploreLogsQueryField(h){return this.components.ExploreLogsQueryField=h,this}setQueryEditorHelp(h){return this.components.QueryEditorHelp=h,this}setExploreStartPage(h){return this.setQueryEditorHelp(h)}setVariableQueryEditor(h){return this.components.VariableQueryEditor=h,this}setMetadataInspector(h){return this.components.MetadataInspector=h,this}setComponentsFromLegacyExports(h){(0,s.M)(h),this.components.QueryCtrl=h.QueryCtrl,this.components.AnnotationsQueryCtrl=h.AnnotationsQueryCtrl,this.components.ExploreQueryField=h.ExploreQueryField,this.components.QueryEditor=h.QueryEditor,this.components.QueryEditorHelp=h.QueryEditorHelp,this.components.VariableQueryEditor=h.VariableQueryEditor}}class d{constructor(h){this.name=h.name,this.id=h.id,this.type=h.type,this.meta=h.meta,this.cachingConfig=h.cachingConfig,this.uid=h.uid,this.apiVersion=h.apiVersion}filterQuery(h){return!0}getRef(){const h={type:this.type,uid:this.uid};return this.apiVersion&&(h.apiVersion=this.apiVersion),h}}var i=(p=>(p.Logs="Logs",p.Metrics="Metrics",p.Tracing="Tracing",p))(i||{}),c=(p=>(p.Cancelled="cancelled",p.Timeout="timeout",p.Unknown="unknown",p))(c||{});class m{}m=(0,a.Y)(m),d=(0,a.Y)(d)},83340:(Z,R,e)=>{"use strict";e.d(R,{Ow:()=>a,ZW:()=>n,uo:()=>s});function n(l){return o=>"__systemRef"in o&&o.__systemRef===l}const a=l=>"__systemRef"in l&&typeof l.__systemRef=="string";var s=(l=>(l.Unit="unit",l.Min="min",l.Max="max",l.FieldMinMax="fieldMinMax",l.Decimals="decimals",l.DisplayName="displayName",l.NoValue="noValue",l.Thresholds="thresholds",l.Mappings="mappings",l.Links="links",l.Actions="actions",l.Color="color",l.Filterable="filterable",l))(s||{})},78479:(Z,R,e)=>{"use strict";e.d(R,{R:()=>n});var n=(a=>(a.Grid="grid",a.List="list",a))(n||{})},32899:(Z,R,e)=>{"use strict";e.d(R,{Tq:()=>d,ee:()=>l,kb:()=>o,r1:()=>s});var n=e(36819),a=e(68388);const s={alertSuccess:(0,n.R)("alert-success"),alertWarning:(0,n.R)("alert-warning"),alertError:(0,n.R)("alert-error"),alertInfo:(0,n.R)("alert-info")},l={refresh:(0,n.R)("refresh"),componentDidMount:(0,n.R)("component-did-mount"),dataReceived:(0,n.R)("data-received"),dataError:(0,n.R)("data-error"),dataFramesReceived:(0,n.R)("data-frames-received"),dataSnapshotLoad:(0,n.R)("data-snapshot-load"),editModeInitialized:(0,n.R)("init-edit-mode"),initPanelActions:(0,n.R)("init-panel-actions"),initialized:(0,n.R)("panel-initialized"),panelTeardown:(0,n.R)("panel-teardown"),render:(0,n.R)("render")};class o extends a.x{static{this.type="graph-hover"}}class d extends a.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},38619:(Z,R,e)=>{"use strict";e.d(R,{Cz:()=>d,DG:()=>m,Qp:()=>h,Z7:()=>c,ZF:()=>s,aj:()=>p,ew:()=>o,jQ:()=>i,o4:()=>l,os:()=>a,qD:()=>n});var n=(r=>(r.DataSource="ds",r.Plugin="plugin",r.Grafana="grafana",r.Stream="stream",r.Watch="watch",r))(n||{}),a=(r=>(r.DataStream="stream",r.DataFrame="frame",r.JSON="json",r))(a||{}),s=(r=>(r.Pending="pending",r.Connected="connected",r.Connecting="connecting",r.Disconnected="disconnected",r.Shutdown="shutdown",r.Invalid="invalid",r))(s||{}),l=(r=>(r.Status="status",r.Join="join",r.Leave="leave",r.Message="message",r))(l||{});function o(r){return r.type==="status"}function d(r){return r.type==="join"}function i(r){return r.type==="leave"}function c(r){return r.type==="message"}function m(r){if(r?.length){let g=r.trim().split("/");if(g.length>=3)return{scope:g[0],namespace:g[1],path:g.slice(2).join("/")}}}function p(r){return!!(r?.path&&r.namespace&&r.scope)}function h(r){if(!r.scope)return"";let g=r.scope;return!r.namespace||(g+="/"+r.namespace,!r.path)?g:g+"/"+r.path}},67770:(Z,R,e)=>{"use strict";e.d(R,{$b:()=>a,Aj:()=>m,Df:()=>y,FP:()=>r,Nc:()=>p,Ol:()=>i,ZF:()=>d,_0:()=>g,_C:()=>o,cF:()=>c,s5:()=>s,tG:()=>l,wj:()=>h});var n=e(68388),a=(v=>(v.emerg="critical",v.fatal="critical",v.alert="critical",v.crit="critical",v.critical="critical",v.warn="warning",v.warning="warning",v.err="error",v.eror="error",v.error="error",v.info="info",v.information="info",v.informational="info",v.notice="info",v.dbug="debug",v.debug="debug",v.trace="trace",v.unknown="unknown",v))(a||{});const s={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var l=(v=>(v[v.Number=0]="Number",v[v.String=1]="String",v[v.LabelsMap=2]="LabelsMap",v[v.Error=3]="Error",v))(l||{}),o=(v=>(v.none="No de-duplication",v.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",v.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",v.signature="De-duplication of successive lines that have identical punctuation and whitespace.",v))(o||{}),d=(v=>(v.Backward="BACKWARD",v.Forward="FORWARD",v))(d||{});const i=v=>!v||typeof v!="object"?!1:"getLogRowContext"in v;var c=(v=>(v.LogsVolume="LogsVolume",v.LogsSample="LogsSample",v))(c||{}),m=(v=>(v.FullRange="FullRange",v.Limited="Limited",v))(m||{});const p=(v,x)=>v?("getDataProvider"in v||"getSupplementaryRequest"in v)&&"getSupplementaryQuery"in v&&"getSupportedSupplementaryQueryTypes"in v&&v.getSupportedSupplementaryQueryTypes().includes(x):!1,h=v=>!v||typeof v!="object"?!1:"getLogRowContextUi"in v,r=v=>v!=null&&typeof v=="object"&&"toggleQueryFilter"in v&&"queryHasFilter"in v,g=v=>v!=null&&typeof v=="object"&&"modifyQuery"in v&&"getSupportedQueryModifications"in v;class y extends n.x{static{this.type="logs-sort-order-change"}}},75683:(Z,R,e)=>{"use strict";e.d(R,{k:()=>n});var n=(a=>(a[a.Standard=0]="Standard",a[a.Canvas=1]="Canvas",a[a.Custom=2]="Custom",a))(n||{})},90382:(Z,R,e)=>{"use strict";e.d(R,{X:()=>n});var n=(a=>(a.None="None",a.Viewer="Viewer",a.Editor="Editor",a.Admin="Admin",a))(n||{})},38919:(Z,R,e)=>{"use strict";e.d(R,{NV:()=>i,nQ:()=>o,v2:()=>d,wV:()=>l});var n=e(2543),a=e.n(n),s=e(95004),l=(c=>(c.Auto="auto",c.Vertical="vertical",c.Horizontal="horizontal",c))(l||{}),o=(c=>(c[c.Best=100]="Best",c[c.Good=70]="Good",c[c.OK=50]="OK",c))(o||{});class d{constructor(m,p){this.list=[],this.data=m,this.panel=p,this.dataSummary=this.computeDataSummary()}getListAppender(m){return new i(this.list,m)}computeDataSummary(){const m=this.data?.series||[];let p=0,h=0,r=0,g=0,y=0,v=0,x;for(const f of m){g+=f.length,f.meta?.preferredVisualisationType&&(x=f.meta.preferredVisualisationType);for(const u of f.fields)switch(v++,u.type){case s.PU.number:p+=1;break;case s.PU.time:h+=1;break;case s.PU.string:r+=1;break}f.length>y&&(y=f.length)}return{numberFieldCount:p,timeFieldCount:h,stringFieldCount:r,rowCountTotal:g,rowCountMax:y,fieldCount:v,preferredVisualisationType:x,frameCount:m.length,hasData:g>0,hasTimeField:h>0,hasNumberField:p>0,hasStringField:r>0}}getList(){return this.list}}class i{constructor(m,p){this.list=m,this.defaults=p}append(m){this.list.push((0,n.defaultsDeep)(m,this.defaults))}}},54092:(Z,R,e)=>{"use strict";e.d(R,{S:()=>a,u:()=>n});var n=(s=>(s.link="link",s.component="component",s.function="function",s))(n||{}),a=(s=>(s.AlertInstanceAction="grafana/alerting/instance/action",s.AlertingHomePage="grafana/alerting/home",s.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",s.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",s.CommandPalette="grafana/commandpalette/action",s.DashboardPanelMenu="grafana/dashboard/panel/menu",s.DataSourceConfig="grafana/datasources/config",s.ExploreToolbarAction="grafana/explore/toolbar/action",s.UserProfileTab="grafana/user/profile/tab",s.TraceViewDetails="grafana/traceview/details",s.QueryEditorRowAdaptiveTelemetryV1="grafana/query-editor-row/adaptivetelemetry/v1",s.TraceViewResourceAttributes="grafana/traceview/resource-attributes",s.LogsViewResourceAttributes="grafana/logsview/resource-attributes",s.AppChrome="grafana/app/chrome/v1",s))(a||{})},29246:(Z,R,e)=>{"use strict";e.d(R,{x:()=>a});var n=e(11594);function a(s){return s&&s!==n.Ac.valid&&s!==n.Ac.internal}},46933:(Z,R,e)=>{"use strict";e.d(R,{D_:()=>n,Ee:()=>s,FL:()=>a});var n=(l=>(l.Equal="Equal",l.NotEqual="NotEqual",l.EqualRegEx="EqualRegEx",l.NotEqualRegEx="NotEqualRegEx",l))(n||{});const a=l=>!l||typeof l!="object"?!1:"importFromAbstractQueries"in l,s=l=>!l||typeof l!="object"?!1:"exportToAbstractQueries"in l},27164:(Z,R,e)=>{"use strict";e.d(R,{Dv:()=>s,RU:()=>n,n9:()=>a});function n(l){return new Set(["equals","not-equals","one-of","not-one-of"]).has(l)}const a={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match","=|":"one-of","!=|":"not-one-of"},s=Object.fromEntries(Object.entries(a).map(([l,o])=>[o,l]))},7389:(Z,R,e)=>{"use strict";e.d(R,{CO:()=>n,ZG:()=>a,zL:()=>s});var n=(l=>(l[l.never=0]="never",l[l.onDashboardLoad=1]="onDashboardLoad",l[l.onTimeRangeChanged=2]="onTimeRangeChanged",l))(n||{}),a=(l=>(l[l.disabled=0]="disabled",l[l.alphabeticalAsc=1]="alphabeticalAsc",l[l.alphabeticalDesc=2]="alphabeticalDesc",l[l.numericalAsc=3]="numericalAsc",l[l.numericalDesc=4]="numericalDesc",l[l.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",l[l.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",l[l.naturalAsc=7]="naturalAsc",l[l.naturalDesc=8]="naturalDesc",l))(a||{}),s=(l=>(l[l.dontHide=0]="dontHide",l[l.hideLabel=1]="hideLabel",l[l.hideVariable=2]="hideVariable",l))(s||{})},33553:(Z,R,e)=>{"use strict";e.d(R,{O:()=>n});var n=(a=>(a.Absolute="absolute",a.Percentage="percentage",a))(n||{})},79319:(Z,R,e)=>{"use strict";e.d(R,{M:()=>n,N:()=>a});var n=(s=>(s[s.NotPossible=-1]="NotPossible",s[s.NotApplicable=0]="NotApplicable",s[s.Applicable=1]="Applicable",s[s.HighlyApplicable=2]="HighlyApplicable",s))(n||{}),a=(s=>(s.True="true",s.False="false",s.Null="null",s.Empty="empty",s.Zero="zero",s))(a||{})},18600:(Z,R,e)=>{"use strict";e.d(R,{W:()=>a,d:()=>n});var n=(s=>(s.ValueToText="value",s.RangeToText="range",s.RegexToText="regex",s.SpecialValue="special",s))(n||{}),a=(s=>(s.True="true",s.False="false",s.Null="null",s.NaN="nan",s.NullAndNaN="null+nan",s.Empty="empty",s))(a||{})},48592:(Z,R,e)=>{"use strict";e.d(R,{J$:()=>s,Qz:()=>n,ZV:()=>o,f5:()=>l,xi:()=>a});var n=(d=>(d.Legacy="legacy",d.Standard="standard",d.Custom="custom",d.Datasource="datasource",d))(n||{});class a{}class s extends a{getType(){return"standard"}}class l extends a{getType(){return"custom"}}class o extends a{getType(){return"datasource"}}},52205:(Z,R,e)=>{"use strict";e.d(R,{bk:()=>i,pv:()=>p,iF:()=>m});var n=e(2543),a=e(38809),s=e(53543),l=e(42954);class o{constructor(){this.properties=[]}addCustomEditor(r){return this.properties.push(r),this}getRegistry(){return new l.O(()=>this.properties)}getItems(){return this.properties}}var d=e(28105);class i extends o{addNumberInput(r){return this.addCustomEditor({...r,id:r.path,override:s.D.get("number").editor,editor:s.D.get("number").editor,process:a.m0,shouldApply:r.shouldApply??(()=>!0),settings:r.settings||{}})}addSliderInput(r){return this.addCustomEditor({...r,id:r.path,override:s.D.get("slider").editor,editor:s.D.get("slider").editor,process:a.m0,shouldApply:r.shouldApply??(()=>!0),settings:r.settings||{}})}addTextInput(r){return this.addCustomEditor({...r,id:r.path,override:s.D.get("text").editor,editor:s.D.get("text").editor,process:a.OU,shouldApply:r.shouldApply??(()=>!0),settings:r.settings||{}})}addSelect(r){return this.addCustomEditor({...r,id:r.path,override:s.D.get("select").editor,editor:s.D.get("select").editor,process:a.hL,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{options:[]}})}addRadio(r){return this.addCustomEditor({...r,id:r.path,override:s.D.get("radio").editor,editor:s.D.get("radio").editor,process:a.hL,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{options:[]}})}addBooleanSwitch(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("boolean").editor,override:s.D.get("boolean").editor,process:a.FM,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{}})}addColorPicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("color").editor,override:s.D.get("color").editor,process:a.hS,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{}})}addUnitPicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("unit").editor,override:s.D.get("unit").editor,process:a.lG,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{}})}addFieldNamePicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("field-name").editor,override:s.D.get("field-name").editor,process:a.hS,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{}})}addGenericEditor(r,g){return this.addCustomEditor({...r,id:r.path,editor:g,override:g,process:a.hS,shouldApply:r.shouldApply?r.shouldApply:()=>!0,settings:r.settings||{}})}}class c{constructor(r){this.cfg=r,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=g=>{const y=this.cfg.values;return y?y(g):{getValue:v=>g.getValue(`${this.path}.${v}`),onChange:(v,x)=>g.onChange(`${this.path}.${v}`,x)}},this.path=r.path,this.category=r.category,this.defaultValue=this.getDefaultValue(r)}getDefaultValue(r){let g=(0,d.Gv)(r.defaultValue)?(0,n.cloneDeep)(r.defaultValue):{};const y=new p;r.build(y,{data:[]});for(const v of y.getItems())v.defaultValue!=null&&(0,n.set)(g,v.path,v.defaultValue);return g}}function m(h){return(0,d.Gv)(h)&&"id"in h&&h.id==="nested-panel-options"}class p extends o{addNestedOptions(r){const g=new c(r);return this.addCustomEditor(g)}addNumberInput(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("number").editor})}addSliderInput(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("slider").editor})}addTextInput(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("text").editor})}addStringArray(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("strings").editor})}addSelect(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("select").editor})}addMultiSelect(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("multi-select").editor})}addRadio(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("radio").editor})}addBooleanSwitch(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("boolean").editor})}addColorPicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("color").editor,settings:r.settings||{}})}addTimeZonePicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("timezone").editor,settings:r.settings||{}})}addUnitPicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("unit").editor})}addFieldNamePicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("field-name").editor})}addDashboardPicker(r){return this.addCustomEditor({...r,id:r.path,editor:s.D.get("dashboard-uid").editor})}}},13227:(Z,R,e)=>{"use strict";e.d(R,{t:()=>s});var n=e(2543),a=e.n(n);function s(l){return typeof l=="number"?l:l===""||l===null||l===void 0||Array.isArray(l)?NaN:typeof l=="boolean"?l?1:0:(0,n.toNumber)(l)}},46635:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{insertAfterImmutably:()=>l,insertBeforeImmutably:()=>s,moveItemImmutably:()=>a,sortValues:()=>i});var n=e(739);function a(c,m,p){const h=[...c];return Array.prototype.splice.call(h,p,0,Array.prototype.splice.call(h,m,1)[0]),h}function s(c,m,p){if(p<0||p>c.length)throw new Error("Index out of bounds");const h=[...c];return h.splice(p,0,m),h}function l(c,m,p){if(p<0||p>c.length)throw new Error("Index out of bounds");const h=[...c];return h.splice(p+1,0,m),h}const o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),d=(c,m)=>c-m;function i(c){return(m,p)=>{if(m===p)return 0;if(p==null||typeof p=="string"&&p.trim()==="")return-1;if(m==null||typeof m=="string"&&m?.trim()==="")return 1;let h=o.compare;return typeof m=="number"&&typeof p=="number"&&(h=d),c===n.xB.Descending?h(p,m):h(m,p)}}},12823:(Z,R,e)=>{"use strict";e.d(R,{b:()=>s,k:()=>a});var n=e(42954),a=(l=>(l.Add="+",l.Subtract="-",l.Divide="/",l.Multiply="*",l))(a||{});const s=new n.O(()=>[{id:"+",name:"Add",operation:(l,o)=>l+o,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(l,o)=>l-o,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(l,o)=>l*o,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(l,o)=>l/o,binaryOperationID:"/"}])},68125:(Z,R,e)=>{"use strict";e.d(R,{F7:()=>p,Jh:()=>h,_O:()=>u,i8:()=>g});var n=e(2543),a=e.n(n),s=e(44809),l=e.n(s),o=e(18700),d=e(41119),i=e(16515),c=e(95004),m=e(55386),p=(b=>(b[b.full=0]="full",b[b.name=1]="name",b[b.none=2]="none",b))(p||{});function h(b,E){return new g(E).readCSV(b)}var r=(b=>(b[b.Starting=0]="Starting",b[b.InHeader=1]="InHeader",b[b.ReadingRows=2]="ReadingRows",b))(r||{});class g{constructor(E){this.chunk=(D,C)=>{for(let P=0;P<D.data.length;P++){const T=D.data[P];if(T.length<1)continue;const O=T[0];if(O){if(O.startsWith("#")){const I=O.indexOf("#",2);if(I>0){const j=O.slice(1,I),W=j==="name";if(W||{unit:"#"}.hasOwnProperty(j)){this.state===2&&(this.current=new o.k({fields:[]}),this.data.push(this.current));const S=O.slice(I+1);if(W){this.current.addFieldFor(void 0,S);for(let w=1;w<T.length;w++)this.current.addFieldFor(void 0,T[w])}else{const{fields:w}=this.current;for(let N=0;N<w.length;N++){w[N].config||(w[N].config={});const M=w[N].config;M[j]=N===0?S:T[N]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,d.HW)(O)===c.PU.string){for(const j of T)this.current.addFieldFor(void 0,j);this.state=1;continue}this.state=1}}if(this.state,this.state=2,T.length>this.current.fields.length){const{fields:I}=this.current;for(let j=I.length;j<T.length;j++)this.current.addFieldFor(T[j]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(T),this.callback&&this.callback.onRow(T)}},E||(E={}),this.config=E.config||{},this.callback=E.callback,this.current=new o.k({fields:[]}),this.state=0,this.data=[]}readCSV(E){this.current=new o.k({fields:[]}),this.data=[this.current];const D={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return l().parse(E,D),this.data}}function y(b,E){if(b==null)return"";const D=b.toString();return D.includes('"')?E.quoteChar+D.replace(/"/gi,'""')+E.quoteChar:D.includes(`
`)||E.delimiter&&D.includes(E.delimiter)?E.quoteChar+D+E.quoteChar:D}function v(b,E){return b.display?D=>{const C=b.display(D);return y((0,m.cN)(C),E)}:D=>y(D,E)}function x(b,E,D){const C=b==="name",P=b==="type";for(const T of E){const O=T.config;if(C||P||O&&O.hasOwnProperty(b)){let I="#"+b+"#";for(let j=0;j<E.length;j++){j>0&&(I=I+D.delimiter);let W=E[j].name;P?W=E[j].type:C||(W=E[j].config[b]),W&&(I=I+y(W,D))}return I+D.newline}}return""}function f(){const b=["x","y"];return b.toLocaleString?b.toLocaleString().charAt(1):","}function u(b,E){if(!b)return"";E=(0,n.defaults)(E,{delimiter:f(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let D=E.useExcelHeader?`sep=${E.delimiter}${E.newline}`:"";for(let C=0;C<b.length;C++){const P=b[C],{fields:T}=P;if(T.length===0)continue;if(E.headerStyle===0)D=D+x("name",T,E)+x("type",T,E)+x("unit",T,E)+x("dateFormat",T,E);else if(E.headerStyle===1){for(let I=0;I<T.length;I++)I>0&&(D+=E.delimiter),D+=`"${(0,i.Ct)(T[I],P).replace(/"/g,'""')}"`;D+=E.newline}const O=T[0].values.length;if(O>0){const I=T.map(j=>v(j,E));for(let j=0;j<O;j++){for(let W=0;W<T.length;W++){W>0&&(D+=E.delimiter);let B=T[W].values[j];B!==null&&(T[W].type===c.PU.frame&&"value"in B&&(B=B.value),D+=I[W](B))}j!==O-1&&(D+=E.newline)}}C!==b.length-1&&(D=D+E.newline)}return D}},38036:(Z,R,e)=>{"use strict";e.d(R,{c:()=>s,u:()=>l});var n=e(92138),a=e(83175);const s={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function l(c){const{onClickFn:m,replaceVariables:p,link:h,scopedVars:r,range:g,field:y,internalLink:v}=c,x=typeof h.internal?.query=="function"?h.internal.query({replaceVariables:p,scopedVars:r}):v.query,f=d(x,r,p),u=d(h.internal?.panelsState,r,p),b=d(h.meta?.correlationData,r,p),E=h.title?h.title:v.datasourceName;return{title:p(E,r),href:o(v.datasourceUid,f,g,u),onClick:m?D=>{D.preventDefault&&D.preventDefault(),m({datasourceUid:v.datasourceUid,queries:[f],panelsState:u,correlationHelperData:b,range:g})}:void 0,target:h?.targetBlank?"_blank":"_self",origin:y}}function o(c,m,p,h){return n.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,a.Pp)({...p?.raw?{range:(0,a.sQ)(p.raw)}:{},datasource:c,queries:[m],panelsState:h}))}`)}function d(c,m,p){if(!c)return c;if(typeof c=="string")return p(c,m);const h=JSON.parse(JSON.stringify(c));return i(h,m,p)}function i(c,m,p){for(const h of Object.keys(c))typeof c[h]=="string"?c[h]=p(c[h],m):typeof c[h]=="object"&&c[h]!==null&&(c[h]=i(c[h],m,p));return c}},48480:(Z,R,e)=>{"use strict";e.d(R,{BD:()=>m,EX:()=>p,Iz:()=>o,PG:()=>i,QP:()=>x,fN:()=>l,lO:()=>y,mn:()=>c,p$:()=>s,pN:()=>g,wY:()=>h,wp:()=>v,yV:()=>r,zX:()=>d});var n=e(2543),a=e.n(n);function s(f){const u={uid:f.uid,type:f.type};return f.apiVersion&&(u.apiVersion=f.apiVersion),u}function l(f){return typeof f=="object"&&typeof f?.uid=="string"}function o(f){if(l(f))return f.uid;if((0,n.isString)(f))return f}const d=(f,u)=>b=>{g(f,u,b.currentTarget.value)},i=(f,u)=>b=>{y(f,u,b.currentTarget.value)},c=(f,u)=>b=>{v(f,u,b.currentTarget.value)},m=(f,u)=>b=>{y(f,u,b.value)},p=(f,u)=>b=>{y(f,u,b.currentTarget.checked)},h=(f,u)=>b=>{v(f,u,b.value)},r=(f,u)=>b=>{x(f,u)};function g(f,u,b){const E=f.options;f.onOptionsChange({...E,[u]:b})}const y=(f,u,b)=>{const E=f.options;f.onOptionsChange({...E,jsonData:{...E.jsonData,[u]:b}})},v=(f,u,b)=>{const E=f.options;f.onOptionsChange({...E,secureJsonData:{...E.secureJsonData?E.secureJsonData:{},[u]:b}})},x=(f,u)=>{const b=f.options;f.onOptionsChange({...b,secureJsonData:{...b.secureJsonData?b.secureJsonData:{},[u]:""},secureJsonFields:{...b.secureJsonFields,[u]:!1}})}},28882:(Z,R,e)=>{"use strict";e.d(R,{f:()=>n});var n=(a=>(a[a.Transformations=0]="Transformations",a[a.FieldConfig=1]="FieldConfig",a[a.FieldConfigOverrides=2]="FieldConfigOverrides",a))(n||{})},99885:(Z,R,e)=>{"use strict";e.d(R,{X:()=>p});var n=e(84139),a=e(8934);const s=/[^ -~]/m,l=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m,o=5,d=25,i=5,c=1e4,m=new n.A({intraMode:1});function p(h,r){if(r==="")return h.map((g,y)=>y);if(s.test(r)||l.test(r)||r.length>d||m.split(r).length>i){const g=new RegExp((0,a.$f)(r),"i"),y=[];for(let v=0;v<h.length;v++){let x=h[v];g.test(x)&&y.push(v)}return y}else{const[g,y,v]=m.search(h,r,o,c);if(g?.length)return y&&v?v.map(x=>y.idx[x]):g}return[]}},71642:(Z,R,e)=>{"use strict";e.d(R,{Xy:()=>a,_p:()=>o,h6:()=>d,s6:()=>l,yO:()=>s});const n=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function a(i){const c={};return i.replace(n,(m,p,h,r)=>(c[p]=r,"")),c}function s(i){return i.reduce((c,m)=>{if(!m)throw new Error("Need parsed labels to find common labels.");return Object.keys(m).forEach(p=>{(c[p]===void 0||c[p]!==m[p])&&delete c[p]}),Object.keys(c).forEach(p=>{m[p]===void 0&&delete c[p]}),c},{...i[0]})}function l(i,c){const m={...i};return Object.keys(c).forEach(p=>{delete m[p]}),m}function o(i,c){if(!i)return!0;for(const[m,p]of Object.entries(i))if(!c||c[m]!==p)return!1;return!0}function d(i,c="",m){if(!i||Object.keys(i).length===0)return c;const h=Object.keys(i).sort().map(r=>`${r}="${i[r]}"`).join(", ");return m?h:["{",h,"}"].join("")}},428:(Z,R,e)=>{"use strict";e.d(R,{j:()=>n});function n(a,s){const l=/\{\{\s*(.+?)\s*\}\}/g;return a.replace(l,(o,d)=>s[d]?s[d]:d)}},92138:(Z,R,e)=>{"use strict";e.d(R,{I:()=>h});var n=e(63704),a=e(83175);let s={appSubUrl:""},l,o;const d=r=>{try{return new URL(r)}catch{return}},i=r=>{const g=d(r);if(g&&g.origin!==window.location.origin)return r;const y=s.appSubUrl??"",v=y.endsWith("/")?1:0,x=r.startsWith("http");let f=y;return(!r.startsWith("/")||x)&&(f=`${window.location.origin}${y}`),r.length>0&&(r.indexOf(f+"/")===0||r===f)?r.slice(f.length-v):r},c=r=>r.startsWith("/")?`${s.appSubUrl}${i(r)}`:r,h={initialize:r=>{s=r.config,l=r.getTimeRangeForUrl,o=r.getVariablesUrlParams},stripBaseFromUrl:i,assureBaseUrl:c,updateSearchParams:(r,g)=>{const y=new URLSearchParams(g);try{const v=new URL(r);return y.forEach((x,f)=>v.searchParams.set(f,x)),v.href}catch{const v=new URLSearchParams(r);return y.forEach((x,f)=>{v.set(f,x)}),"?"+v.toString()}},getTimeRangeUrlParams:()=>l?a.kM.toUrlParams(l()):null,getVariablesUrlParams:r=>{if(!o)return null;const g=o(r);return a.kM.toUrlParams(g)},getUrlForPartial:(r,g)=>{const y=a.kM.parseKeyValue(r.search.startsWith("?")?r.search.substring(1):r.search);for(const v in g)g[v]===null||g[v]===void 0?delete y[v]:y[v]=g[v];return c(a.kM.renderUrl(r.pathname,y))},processUrl:r=>s.disableSanitizeHtml?r:n.sQ.sanitizeUrl(r)}},35814:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>n});function n(a){return new Proxy(a,{apply(s,l,o){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(s,o,l.constructor)}})}},8134:(Z,R,e)=>{"use strict";e.d(R,{_:()=>n});function n(s,l){return l.id===s?!0:a(s)?a(l.id):l.aliasIDs?l.aliasIDs.includes(s):!1}function a(s){return s==="prometheus"?!0:new RegExp("^grafana-[0-9a-z]+prometheus-datasource$").test(s)}},33985:(Z,R,e)=>{"use strict";e.d(R,{t:()=>n});const n=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]},14613:(Z,R,e)=>{"use strict";e.d(R,{u:()=>n});var n=(a=>(a.id="id",a.title="title",a.subTitle="subtitle",a.mainStat="mainstat",a.secondaryStat="secondarystat",a.arc="arc__",a.icon="icon",a.color="color",a.source="source",a.target="target",a.detail="detail__",a.nodeRadius="noderadius",a.thickness="thickness",a.highlighted="highlighted",a.strokeDasharray="strokedasharray",a.fixedX="fixedx",a.fixedY="fixedy",a.isInstrumented="isinstrumented",a))(n||{})},79243:(Z,R,e)=>{"use strict";e.d(R,{E:()=>a,h:()=>n});function n(s,l=0){if(Number.isInteger(s))return s;let o=10**l,d=s*o*(1+Number.EPSILON);return Math.round(d)/o}function a(s){return((""+s).split(".")[1]||"").length}},3594:(Z,R,e)=>{"use strict";e.d(R,{R:()=>a,w:()=>n});const n=s=>Object.keys(s).reduce((l,o)=>(s[o]!==void 0&&(l[o]=s[o]),l),{}),a=s=>typeof s=="object"&&s!==null&&Object.keys(s).length===0},78012:(Z,R,e)=>{"use strict";e.d(R,{M:()=>a,i:()=>n});class n{constructor(){this.subscribers=new Map,window.addEventListener("storage",l=>{l.key&&this.notifySubscribers(l.key)})}notifySubscribers(l){const o=this.subscribers.get(l);o&&o.forEach(d=>d())}subscribe(l,o){return this.subscribers.has(l)||this.subscribers.set(l,new Set),this.subscribers.get(l).add(o),()=>{const d=this.subscribers.get(l);d&&(d.delete(o),d.size===0&&this.subscribers.delete(l))}}get(l){return window.localStorage[l]}set(l,o){window.localStorage[l]=o,this.notifySubscribers(l)}getBool(l,o){return o!==void 0&&!this.exists(l)?o:window.localStorage[l]==="true"}getObject(l,o){let d=o;if(this.exists(l)){const i=window.localStorage[l];try{d=JSON.parse(i)}catch(c){console.error(`Error parsing store object: ${l}. Returning default: ${o}. [${c}]`)}}return d}setObject(l,o){let d;try{d=JSON.stringify(o)}catch(i){throw new Error(`Could not stringify object: ${l}. [${i}]`)}try{this.set(l,d)}catch(i){const c=new Error(`Could not save item in localStorage: ${l}. [${i}]`);throw i instanceof Error&&(c.name=i.name),c}return!0}exists(l){return window.localStorage[l]!==void 0}delete(l){window.localStorage.removeItem(l),this.notifySubscribers(l)}}const a=new n},78830:(Z,R,e)=>{"use strict";e.d(R,{M:()=>n});function n(a){const s=a?.angular?.detected??a?.angularDetected??!1,l=a?.angularPanelCtrl??!1,o=a.PanelCtrl??a?.ConfigCtrl??!1;if(s||l||o)throw new Error("Angular plugins are not supported")}},48233:(Z,R,e)=>{"use strict";e.d(R,{_:()=>a,j:()=>s});var n=e(42954),a=(l=>(l.Abs="abs",l.Exp="exp",l.Ln="ln",l.Round="round",l.Floor="floor",l.Ceil="ceil",l.Percent="percent",l))(a||{});const s=new n.O(()=>[{id:"abs",name:"Absolute value",operation:l=>Math.abs(l),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:l=>Math.exp(l),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:l=>Math.log(l),unaryOperationID:"ln"},{id:"round",name:"Round",operation:l=>Math.round(l),unaryOperationID:"round"},{id:"floor",name:"Floor",operation:l=>Math.floor(l),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:l=>Math.ceil(l),unaryOperationID:"ceil"},{id:"percent",name:"Percentage",operation:(l,o=1)=>l/(o||1),unaryOperationID:"percent"}])},83175:(Z,R,e)=>{"use strict";e.d(R,{Pp:()=>h,kM:()=>p,sQ:()=>r});var n=e(25229);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function a(g,y){return y&&Object.keys(y).length>0&&(g+="?"+l(y)),g}function s(g,y){return encodeURIComponent(g).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,y?"%20":"+").replace(/[!'()*]/g,function(v){return"%"+v.charCodeAt(0).toString(16).toUpperCase()})}function l(g,y=!0){const v=[],x=/\[\]$/,f=y?(D,C)=>s(D,C):(D,C)=>encodeURIComponent(D),u=D=>Object.prototype.toString.call(D)==="[object Array]",b=(D,C)=>{C=typeof C=="function"?C():C===null||C===void 0?"":C,v[v.length]=f(D,!0)+"="+f(C,!0)},E=(D,C)=>{let P,T,O;if(D)if(u(C))for(P=0,T=C.length;P<T;P++)x.test(D)?b(D,C[P]):E(D,C[P]);else if(C&&String(C)==="[object Object]")for(O in C)E(D+"["+O+"]",C[O]);else b(D,C);else if(u(C))for(P=0,T=C.length;P<T;P++)b(C[P].name,C[P].value);else for(O in C)E(O,C[O]);return v};return E("",g).join("&")}function o(g){return l(g,!1)}function d(g,y){if(y!=null&&y!==""){const v=g.indexOf("?");v!==-1?g.length-v>1&&(g+="&"):g+="?",g+=y}return g}function i(){const y=window.location.search.substring(1).split("&"),v={};for(const x of y){const f=x.split("=");if(f.length>1){const u=decodeURIComponent(f[0]),b=decodeURIComponent(f[1]);u in v?v[u]=[...v[u],b]:v[u]=[b]}else if(f.length===1){const u=decodeURIComponent(f[0]);v[u]=!0}}return v}function c(g){const y={},v=(g||"").split("&");for(let x of v){let f,u,b;if(x&&(u=x=x.replace(/\+/g,"%20"),f=x.indexOf("="),f!==-1&&(u=x.substring(0,f),b=x.substring(f+1)),u=m(u),u!==void 0)){b=b!==void 0?m(b):!0;let E;typeof b=="string"&&b!==""?E=b==="true"||b==="false"?b==="true":b:E=b,y.hasOwnProperty(u)?Array.isArray(y[u])?y[u].push(b):y[u]=[y[u],isNaN(E)?b:E]:y[u]=isNaN(E)?b:E}}return y}function m(g){try{return decodeURIComponent(g)}catch{return}}const p={renderUrl:a,toUrlParams:l,appendQueryToUrl:d,getUrlSearchParams:i,parseKeyValue:c,serializeParams:o};function h(g,y){return y!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(g)}const r=g=>{let y=g.from;(0,n.Ar)(y)&&(y=y.valueOf().toString());let v=g.to;return(0,n.Ar)(v)&&(v=v.valueOf().toString()),{from:y,to:v}}},35987:(Z,R,e)=>{"use strict";e.d(R,{An:()=>d,Zz:()=>l,bh:()=>i});var n=e(36394),a=e(8934),s=e(18600);function l(m,p){for(const h of m)switch(h.type){case s.d.ValueToText:if(p==null)continue;const r=h.options[p];if(r)return r;break;case s.d.RangeToText:if(p==null)continue;const g=parseFloat(p);if(isNaN(g))continue;const y=h.options.from??-1/0;if(!isNaN(y)&&g<y)continue;const x=h.options.to??1/0;if(!isNaN(x)&&g>x)continue;return h.options.result;case s.d.RegexToText:if(p==null||typeof p!="string")continue;const u=(0,a.dO)(h.options.pattern);if(p.match(u)){const b={...h.options.result};return b.text!=null&&(b.text=p.replace(u,h.options.result.text||"")),b}case s.d.SpecialValue:switch(h.options.match){case s.W.Null:{if(p==null)return h.options.result;break}case s.W.NaN:{if(typeof p=="number"&&isNaN(p))return h.options.result;break}case s.W.NullAndNaN:{if(typeof p=="number"&&isNaN(p)||p==null)return h.options.result;break}case s.W.True:{if(p===!0||p==="true")return h.options.result;break}case s.W.False:{if(p===!1||p==="false")return h.options.result;break}case s.W.Empty:{if(p==="")return h.options.result;break}}}return null}function o(m){return(typeof m=="number"||typeof m=="string"&&m.trim()!=="")&&!isNaN(m)}var d=(m=>(m[m.ValueToText=1]="ValueToText",m[m.RangeToText=2]="RangeToText",m))(d||{});function i(m,p){const h=[];let r=m.mappingType;if(m.mappingType||(m.valueMaps&&m.valueMaps.length?r=1:m.rangeMaps&&m.rangeMaps.length&&(r=2)),r===1)for(let g=0;g<m.valueMaps.length;g++){const y=m.valueMaps[g];h.push(c({...y,id:g,type:s.d.ValueToText},m.fieldConfig?.defaults?.thresholds||p))}else if(r===2)for(let g=0;g<m.rangeMaps.length;g++){const y=m.rangeMaps[g];h.push(c({...y,id:g,type:s.d.RangeToText},m.fieldConfig?.defaults?.thresholds||p))}return h}function c(m,p){const h={type:s.d.ValueToText,options:{}},r=[];let g;const y=parseFloat(m.text);if(p&&!isNaN(y)){const v=(0,n.yQ)(y,p.steps);v&&v.color&&(g=v.color)}switch(m.type){case 1:case s.d.ValueToText:m.value!=null&&(m.value==="null"?r.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:m.text,color:g}}}):h.options[String(m.value)]={text:m.text,color:g});break;case 2:case s.d.RangeToText:m.from==="null"||m.to==="null"?r.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:m.text,color:g}}}):r.push({type:s.d.RangeToText,options:{from:+m.from,to:+m.to,result:{text:m.text,color:g}}});break}return Object.keys(h.options).length>0&&r.unshift(h),r[0]}},94452:(Z,R,e)=>{"use strict";e.d(R,{E:()=>a,c:()=>s});const n="__searchFilter",a=l=>l&&typeof l=="string"?l.indexOf(n)!==-1:!1,s=l=>{const{query:o,wildcardChar:d}=l;if(!a(o))return{};let{options:i}=l;return i=i||{searchFilter:""},{__searchFilter:{value:i.searchFilter?`${i.searchFilter}${d}`:`${d}`,text:""}}}},47520:(Z,R,e)=>{"use strict";e.d(R,{k:()=>o});var n=e(44240),a=e(39697),s=e(65961),l=e(67791);function o({whileLoading:d,source:i}){return(0,n.h)((0,a.O)(200).pipe((0,s.u)(d),(0,l.Q)(i)),i)}},94777:(Z,R,e)=>{"use strict";e.d(R,{$:()=>a});var n=e(96453);class a extends n.F{constructor(l){return super(),this.buffer=l.buffer||[],this.capacity=this.buffer.length,this.tail=l.append!=="head",this.index=0,this.add=this.getAddFunction(),l.capacity&&this.setCapacity(l.capacity),new Proxy(this,{get(o,d,i){if(typeof d!="symbol"){const c=+d;if(String(c)===d)return o.get(c)}return Reflect.get(o,d,i)},set(o,d,i,c){if(typeof d!="symbol"){const m=+d;if(String(m)===d)return o.set(m,i),!0}return Reflect.set(o,d,i,c)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?l=>{this.buffer.push(l),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:l=>{this.buffer.unshift(l),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?l=>{this.buffer[this.index]=l,this.index=(this.index+1)%this.buffer.length}:l=>{let o=this.index-1;o<0&&(o=this.buffer.length-1),this.buffer[o]=l,this.index=o}}setCapacity(l){if(this.capacity===l)return;const o=this.toArray();if(l>this.length)this.buffer=o;else if(l<this.capacity){const d=this.length-l;this.tail?this.buffer=o.slice(d,o.length):this.buffer=o.slice(0,o.length-d)}this.capacity=l,this.index=0,this.add=this.getAddFunction()}setAppendMode(l){const o=l!=="head";o!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=o,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(l){return this.buffer[(l+this.index)%this.buffer.length]}set(l,o){this.buffer[(l+this.index)%this.buffer.length]=o}get length(){return this.buffer.length}}},96453:(Z,R,e)=>{"use strict";e.d(R,{E:()=>o,F:()=>s});var n,a;class s{constructor(){this[n]={}}*iterator(){for(let i=0;i<this.length;i++)yield this.get(i)}set(i,c){throw"unsupported operation"}add(i){throw"unsupported operation"}push(...i){for(const c of i)this.add(c);return this.length}[(a=Symbol.iterator,n=Symbol.unscopables,a)](){return this.iterator()}forEach(i){return o(this).forEach(i)}map(i){return o(this).map(i)}filter(i){return o(this).filter(i)}at(i){return this.get(i)}toArray(){const i=new Array(this.length);for(let c=0;c<this.length;c++)i[c]=this.get(c);return i}join(i){return this.toArray().join(i)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...i){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(i){throw new Error("Method not implemented.")}splice(i,c,...m){throw new Error("Method not implemented.")}unshift(...i){throw new Error("Method not implemented.")}fill(i,c,m){throw new Error("Method not implemented.")}copyWithin(i,c,m){throw new Error("Method not implemented.")}slice(i,c){return this.toArray().slice(i,c)}indexOf(i,c){return this.toArray().indexOf(i,c)}lastIndexOf(i,c){return this.toArray().lastIndexOf(i,c)}every(i,c){return this.toArray().every(i,c)}some(i,c){return this.toArray().some(i,c)}reduce(i,c){throw new Error("Method not implemented.")}reduceRight(i,c){throw new Error("Method not implemented.")}find(i,c){return this.toArray().find(i,c)}findIndex(i,c){return this.toArray().findIndex(i,c)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(i,c){return this.toArray().includes(i,c)}flatMap(i,c){return this.toArray().flatMap(i,c)}flat(i){throw new Error("Method not implemented.")}}const l=[];function o(d){return{*[Symbol.iterator](){for(let i=0;i<d.length;i++)yield d.get(i)},forEach(i){for(let c=0;c<d.length;c++)i(d.get(c),c,l)},map(i){const c=[];for(let m=0;m<d.length;m++)c.push(i(d.get(m),m,l));return c},filter(i){const c=[];let m=0;for(const p of this)i(p,m++,l)&&c.push(p);return c}}}},34734:(Z,R,e)=>{"use strict";e.d(R,{B9:()=>o,OP:()=>n,RT:()=>c,SM:()=>r,Sd:()=>i,_N:()=>p,bS:()=>u,fP:()=>g,fo:()=>l,gs:()=>x,h2:()=>f,k1:()=>s,mk:()=>h,o6:()=>a,qb:()=>m,uZ:()=>y,v9:()=>d,vk:()=>v});const n=1e4,a=1e3,s=30,l=25,o="grafana.datasources.prometheus.browser.labels",d=/^$|^\d+(ms|[Mwdhmsy])$/,i=/(\d+)(.+)/,c=/^(0|[1-9]\d*)(\.\d+)?(e\+?\d+)?$/,m="{}",p=4e4,h='{__name__!=""}',r="__name__",g="Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s",y="Value is not valid, you can use non-negative integers, including scientific notation",v="Value is not valid, you can use only numbers or leave it empty to use default limit or set 0 to have no limit.",x="-Instant",f=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels","suggestions"],u="none"},35748:(Z,R,e)=>{"use strict";e.d(R,{AW:()=>d,Ay:()=>m,n6:()=>c});const n=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],a=["by","group_left","group_right","ignoring","on","offset","without"],s=null,l=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],d=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...l,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"double_exponential_smoothing",label:"double_exponential_smoothing",detail:"double_exponential_smoothing(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Renamed as double_exponential_smoothing in prometheus v3.x. For prometheus versions equal and greater than v3.0 please use double_exponential_smoothing. \n\nProduces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"info",label:"info",detail:"info(v instant-vector, [data-label-selector instant-vector])",documentation:"Returns latest details and metadata about a group of metrics, such as their labels and current values, without doing any calculations"},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],i=d.map(p=>p.label),c={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${d.map(p=>p.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${a.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},m=c},31200:(Z,R,e)=>{"use strict";e.d(R,{$H:()=>a,Nc:()=>n,Rq:()=>s,p0:()=>d});const n=i=>i===""||s(i)?i:`"${i}"`,a=i=>{if(s(i))return i;let m="U__";for(let p=0;p<i.length;p++){const h=i[p],r=i.codePointAt(p);h==="_"?m+="__":r!==void 0&&l(h,p)?m+=h:r===void 0||!o(r)?m+="_FFFD_":(m+="_",m+=r.toString(16),m+="_"),r!==void 0&&r>65535&&p++}return m},s=i=>{if(i.length===0)return!1;for(let c=0;c<i.length;c++){const m=i[c];if(!l(m,c))return!1}return!0},l=(i,c)=>{const m=i.codePointAt(0);return m===void 0?!1:m>=97&&m<=122||m>=65&&m<=90||m===95||m===58||m>=48&&m<=57&&c>0},o=i=>i>=0&&i<=1114111,d=i=>{const c=[],m=/(=~|!=|!~|=)/;let p="",h="",r=!1,g="";const y=()=>{const v=g.match(m);if(v){const x=v[0];[p,h]=g.split(x),c.push(`${n(p.trim())}${x}"${h.slice(1,-1)}"`)}};for(const v of i)v==='"'&&g[g.length-1]!=="\\"?(r=!r,g+=v):v===","&&!r?(y(),g=""):g+=v;return g&&y(),c.join(",")}},61190:(Z,R,e)=>{"use strict";e.d(R,{L:()=>a,y:()=>s});var n=e(43173);function a(l){return{grafana_version:n.$.buildInfo.version,plugin_type:String(l.type),plugin_version:l.info.version,plugin_id:l.id,plugin_name:l.name}}function s(l){return{...a(l.meta),datasource_uid:l.uid}}},77010:(Z,R,e)=>{"use strict";e.d(R,{G:()=>i});var n=e(96540),a=e(31595),s=e(17564),l=e(27489),o=e(61190);const d="grafana_plugin_";function i(){const m=(0,a.Q)();return(0,n.useMemo)(()=>{if(!m)throw new Error("No PluginContext found. The usePluginInteractionReporter() hook can only be used from a plugin.");const p=(0,s.S)(m)?(0,o.y)(m.instanceSettings):(0,o.L)(m.meta);return(h,r)=>{if(!c(h))throw new Error(`Interactions reported in plugins should start with: "${d}".`);return(0,l.rR)(h,{...r,...p})}},[m])}function c(m){return m.startsWith(d)&&m.length>d.length}},33749:(Z,R,e)=>{"use strict";e.d(R,{fX:()=>s,nB:()=>a,n_:()=>n,p6:()=>l});var n=(o=>(o.DashboardView="dashboard-view",o.DataRequest="data-request",o))(n||{});const a=o=>!!o.payload.page,s=o=>!!o.payload.interactionName,l=o=>!!o.payload.experimentId},27489:(Z,R,e)=>{"use strict";e.d(R,{G$:()=>l,Jy:()=>o,Xp:()=>i,rR:()=>d});var n=e(43173),a=e(36490),s=e(78646);const l=c=>{(0,s.x$)().addEvent({type:s.on.MetaAnalytics,payload:c})},o=()=>{const c=a.Ny.getLocation(),m=`${n.$.appSubUrl??""}${c.pathname}${c.search}${c.hash}`;(0,s.x$)().addEvent({type:s.on.Pageview,payload:{page:m}})},d=(c,m)=>{n.$.reportingStaticContext&&n.$.reportingStaticContext instanceof Object&&(m={...m,...n.$.reportingStaticContext}),(0,s.x$)().addEvent({type:s.on.Interaction,payload:{interactionName:c,properties:m}})},i=(c,m,p)=>{(0,s.x$)().addEvent({type:s.on.ExperimentView,payload:{experimentId:c,experimentGroup:m,experimentVariant:p}})}},80839:(Z,R,e)=>{"use strict";e.d(R,{s:()=>h});var n=e(74848),a=e(96540),s=e(48480),l=e(29246),o=e(51898),d=e(18857),i=e(41654),c=e(63509),m=e(78282),p=e(36580);class h extends a.PureComponent{constructor(g){super(g),this.dataSourceSrv=(0,m.l)(),this.state={},this.onChange=(y,v)=>{if(v.action==="clear"&&this.props.onClear){this.props.onClear();return}const x=this.dataSourceSrv.getInstanceSettings(y.value);x&&(this.props.onChange(x),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:g}=this.props;this.dataSourceSrv.getInstanceSettings(g)||this.setState({error:"Could not find data source "+g})}getCurrentValue(){const{current:g,hideTextValue:y,noDefault:v}=this.props;if(!g&&v)return;const x=this.dataSourceSrv.getInstanceSettings(g);if(x)return{label:x.name.slice(0,37),value:x.uid,imgUrl:x.meta.info.logos.small,hideText:y,meta:x.meta};const f=(0,s.Iz)(g);return f===p.dR.uid||f===p.dR.name?{label:f,value:f,hideText:y}:{label:(f??"no name")+" - not found",value:f??void 0,imgUrl:"",hideText:y}}getDataSourceOptions(){const{alerting:g,tracing:y,metrics:v,mixed:x,dashboard:f,variables:u,annotations:b,pluginId:E,type:D,filter:C,logs:P}=this.props;return this.dataSourceSrv.getList({alerting:g,tracing:y,metrics:v,logs:P,dashboard:f,mixed:x,variables:u,annotations:b,pluginId:E,filter:C,type:D}).map(O=>({value:O.name,label:`${O.name}${O.isDefault?" (default)":""}`,imgUrl:O.meta.info.logos.small,meta:O.meta}))}render(){const{autoFocus:g,onBlur:y,onClear:v,openMenuOnFocus:x,placeholder:f,width:u,inputId:b,disabled:E=!1,isLoading:D=!1}=this.props,{error:C}=this.state,P=this.getDataSourceOptions(),T=this.getCurrentValue(),O=typeof v=="function";return(0,n.jsx)("div",{"aria-label":"Data source picker select container","data-testid":o.Tp.components.DataSourcePicker.container,children:(0,n.jsx)(d.l6,{isLoading:D,disabled:E,"aria-label":"Select a data source","data-testid":o.Tp.components.DataSourcePicker.inputV2,inputId:b||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:O,backspaceRemovesValue:!1,onChange:this.onChange,options:P,autoFocus:g,onBlur:y,width:u,openMenuOnFocus:x,maxMenuHeight:500,placeholder:f,noOptionsMessage:"No datasources found",value:T??null,invalid:!!C||!!this.props.invalid,getOptionLabel:I=>I.meta&&(0,l.x)(I.meta.signature)&&I!==T?(0,n.jsxs)(i.B,{alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)("span",{children:I.label})," ",(0,n.jsx)(c.B,{status:I.meta.signature})]}):I.label||""})})}}},43122:(Z,R,e)=>{"use strict";e.d(R,{f:()=>n,p:()=>a});let n=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function a(s){n=s}},47700:(Z,R,e)=>{"use strict";e.d(R,{N:()=>s,d:()=>l});var n=e(74848);let a;function s(o){a=o}function l(o){return a?(0,n.jsx)(a,{...o}):null}},14477:(Z,R,e)=>{"use strict";e.d(R,{a:()=>a,e:()=>s});var n=e(74848);let a=({message:l})=>(0,n.jsxs)("div",{children:["Unable to render data: ",l,"."]});function s(l){a=l}},60311:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>s,m:()=>a});var n=e(74848);let a=()=>(0,n.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function s(l){a=l}},88806:(Z,R,e)=>{"use strict";e.d(R,{V:()=>a,l:()=>s});var n=e(74848);let a=({children:l})=>(0,n.jsx)("div",{children:l});function s(l){a=l}},25076:(Z,R,e)=>{"use strict";e.d(R,{l:()=>a,r:()=>s});let n;function a(l){n=l}function s(){return n}},78646:(Z,R,e)=>{"use strict";e.d(R,{H2:()=>s,c_:()=>d,on:()=>n,pl:()=>o,x$:()=>l});var n=(i=>(i.Performance="performance",i.MetaAnalytics="meta-analytics",i.Pageview="pageview",i.Interaction="interaction",i.ExperimentView="experimentview",i.GrafanaJavascriptAgent="grafana-javascript-agent",i))(n||{});let a;function s(i){if(a instanceof d)for(const c of a.buffer)i.addEvent(c.event,c.meta);a=i}function l(){return a||(a=new d),a}const o=i=>{l().addBackend(i)};class d{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(c){}addEvent(c,m){this.buffer.push({event:c,meta:m})}}},36490:(Z,R,e)=>{"use strict";e.d(R,{K9:()=>p,Lc:()=>v,Ny:()=>r,SE:()=>h,_K:()=>u,at:()=>f,vG:()=>g});var n=e(74848),a=e(53554),s=e(96540),l=e(49426),o=e(83175),d=e(37615),i=e(60379),c=e(20720),m=e(43173);class p{constructor(E){this.history=E||a.zR({basename:m.$.appSubUrl??"/"}),this.locationObservable=new l.t(this.history.location),this.history.listen(D=>{this.locationObservable.next(D)}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getLocationObservable(){return this.locationObservable.asObservable()}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(E,D){const C=this.history.location,P=this.getSearchObject();for(const O in E)E[O]===null||E[O]===void 0?delete P[O]:P[O]=E[O];const T=o.kM.renderUrl(C.pathname,P);D?this.history.replace(T,this.history.location.state):this.history.push(T,this.history.location.state)}push(E){this.history.push(E)}replace(E){this.history.replace(E)}reload(){const E=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:E?E+1:1}})}getLocation(){return this.history.location}getSearchObject(){return h(this.history.location.search)}update(E){if((0,d.l)("LocationSrv","update","partial, push or replace"),E.partial&&E.query)this.partial(E.query,E.partial);else{const D={pathname:E.path};E.query&&(D.search=o.kM.toUrlParams(E.query)),E.replace?this.replace(D):this.push(D)}}}function h(b){let E=typeof b=="number"?String(b):b;return E.length>0?E.startsWith("?")?o.kM.parseKeyValue(E.substring(1)):o.kM.parseKeyValue(E):{}}let r=new p;const g=b=>{throw new Error("locationService can be only overriden in test environment")},y=(0,i.h)("Router"),v=y.logger;(0,c.h)("location",r,y);const x=s.createContext(void 0);function f(){const b=(0,s.useContext)(x);if(!b)throw new Error("useLocationService must be used within a LocationServiceProvider");return b}const u=({service:b,children:E})=>(0,n.jsx)(x.Provider,{value:b,children:E})},48072:(Z,R,e)=>{"use strict";e.d(R,{T:()=>a,X:()=>s});let n;function a(l){n=l}function s(){return n}},83734:(Z,R,e)=>{"use strict";e.d(R,{HC:()=>a,XJ:()=>d,d:()=>s,pC:()=>o});let n;const a=i=>{if(n)throw new Error("Runner should only be set when Grafana is starting.");n=i},s=()=>{if(!n)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return n()};let l;function o(i){if(l)throw new Error("runRequest function should only be set once, when Grafana is starting.");l=i}function d(){if(!l)throw new Error("getRunRequest can only be used after Grafana instance has started.");return l}},69896:(Z,R,e)=>{"use strict";e.d(R,{b:()=>o,j:()=>l});var n=e(96540),a=e(24120),s=e(88483);const l=(0,n.createContext)(void 0);function o(){const d=(0,n.useContext)(l);return(0,a.A)(d?.stateObservable??new s.c,d?.state),(0,n.useMemo)(()=>d?{state:d.state,stateObservable:d.stateObservable,changeScopes:d.changeScopes,setReadOnly:d.setReadOnly,setEnabled:d.setEnabled}:void 0,[d,d?.state])}},78282:(Z,R,e)=>{"use strict";e.d(R,{h:()=>a,l:()=>s});let n;function a(l){n=l}function s(){return n}},33184:(Z,R,e)=>{"use strict";e.d(R,{Kh:()=>n.Kh,S8:()=>s,oF:()=>l});var n=e(51388);let a;const s=o=>{a=o},l=()=>a},2874:(Z,R,e)=>{"use strict";e.d(R,{h:()=>a,z:()=>s});let n;function a(l){if(n)throw new Error("setGetObservablePluginComponents() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("getObservablePluginComponents() can only be used after the Grafana instance has started.");return n(l)}},58873:(Z,R,e)=>{"use strict";e.d(R,{C:()=>a,m:()=>s});let n;function a(l){if(n)throw new Error("setGetObservablePluginLinks() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("getObservablePluginLinks() can only be used after the Grafana instance has started.");return n(l)}},33005:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a,S:()=>s});let n;function a(l){if(n)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return n(l)}},33604:(Z,R,e)=>{"use strict";e.d(R,{R:()=>a,f:()=>s});let n;function a(l){if(n)throw new Error("setPluginComponentsHook() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("setPluginComponentsHook(options) can only be used after the Grafana instance has started.");return n(l)}},33707:(Z,R,e)=>{"use strict";e.d(R,{U:()=>a,W:()=>s});let n;function a(l){if(n)throw new Error("setUsePluginFunctionsHook() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("usePluginFunctions(options) can only be used after the Grafana instance has started.");return n(l)}},46907:(Z,R,e)=>{"use strict";e.d(R,{U:()=>s,q:()=>a});let n;function a(l){if(n)throw new Error("setPluginLinksHook() function should only be called once, when Grafana is starting.");n=l}function s(l){if(!n)throw new Error("setPluginLinksHook(options) can only be used after the Grafana instance has started.");return n(l)}},22099:(Z,R,e)=>{"use strict";e.d(R,{CP:()=>d,DG:()=>l,RC:()=>i,aR:()=>o});var n=e(74848),a=e(96540),s=e(54092);function l(c){return c?c.type===s.u.link&&("path"in c||"onClick"in c):!1}function o(c){return c?c.type===s.u.component&&"component"in c:!1}function d({props:c,components:m,limit:p,pluginId:h}){if(!m.length)return null;const r=[];for(const g of m){const{meta:y}=g;if(!(h&&typeof h=="string"&&h!==y.pluginId)&&!(h&&Array.isArray(h)&&!h.includes(y.pluginId))&&!(h instanceof RegExp&&!h.test(y.pluginId))){if(p===void 0){r.push(g);continue}if(a.createElement(g,c)!==null&&r.push(g),r.length>=p)break}}return r}function i({props:c,components:m,limit:p,pluginId:h}){const r=d({props:c,components:m,limit:p,pluginId:h});return r?.length?(0,n.jsx)(n.Fragment,{children:r.map(g=>(0,n.jsx)(g,{...c},g.meta.id))}):null}},2863:(Z,R,e)=>{"use strict";e.d(R,{d:()=>a,w:()=>s});let n;const a=l=>{n=l},s=()=>n},6201:(Z,R,e)=>{"use strict";e.d(R,{H:()=>s,l:()=>a});let n=null;function a(l){if(n)throw new Error("User should only be set once, when Grafana is starting.");n=l}function s(){if(!n)throw new Error("User can only be used after Grafana instance has started.");return n}},36580:(Z,R,e)=>{"use strict";e.d(R,{iy:()=>I,dR:()=>D,b1:()=>P,VQ:()=>T,s9:()=>C});var n=e(62467),a=e(75505),s=e(44240),l=e(63720),o=e(66847),d=e(94644),i=e(48480),c=e(1906),m=e(38619),p=e(77154),h=e(35814),r=e(27489),g=e(43173),y=e(78282),v=e(68143),x=e(33184),f=e(51388),u=e(38866);function b(B){const{intervalMs:S,maxDataPoints:w,requestId:N,panelId:M,queryCachingTTL:L,range:{from:A,to:U}}=B;if(!B.targets.length)return(0,n.of)({data:[]});const F={intervalMs:S,maxDataPoints:w,queryCachingTTL:L,timeRange:{from:A.valueOf().toString(),to:U.valueOf().toString(),timezone:B.timezone}};return(0,v.AI)().fetch({url:`/api/public/dashboards/${g.$.publicDashboardAccessToken}/panels/${M}/query`,method:"POST",data:F,requestId:N}).pipe((0,l.n)(V=>(0,n.of)((0,u.bE)(V,B.targets))),(0,o.W)(V=>(0,n.of)((0,u.bE)(V))))}var E=e(55315);const D=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function C(B){if(!B)return!1;const S=typeof B=="string"?B:B.type;return S===D.type||S===D.name||S==="-100"}class P extends Error{constructor(S,w){super(S),this.details=w,this.name="HealthCheckError"}}var T=(B=>(B.Unknown="UNKNOWN",B.OK="OK",B.Error="ERROR",B))(T||{}),O=(B=>(B.PluginID="X-Plugin-Id",B.DatasourceUID="X-Datasource-Uid",B.DashboardUID="X-Dashboard-Uid",B.PanelID="X-Panel-Id",B.PanelPluginId="X-Panel-Plugin-Id",B.QueryGroupID="X-Query-Group-Id",B.FromExpression="X-Grafana-From-Expr",B.SkipQueryCache="X-Cache-Skip",B.DashboardTitle="X-Dashboard-Title",B.PanelTitle="X-Panel-Title",B))(O||{});class I extends d.mA{constructor(S){super(S),this.streamOptionsProvider=W,this.userStorage=new E.X(S.type)}query(S){if(g.$.publicDashboardAccessToken)return b(S);const{intervalMs:w,maxDataPoints:N,queryCachingTTL:M,range:L,requestId:A,hideFromInspector:U=!1}=S;let F=S.targets,V=!1;const K=new Set,G=new Set,H=F.map(z=>{let Y=this.getRef(),X=this.id,Q=!0;if(C(z.datasource))return V=!0,{...z,datasource:D};if(z.datasource){const q=(0,y.l)().getInstanceSettings(z.datasource,S.scopedVars);if(!q)throw new Error(`Unknown Datasource: ${JSON.stringify(z.datasource)}`);const te=q.rawRef??(0,i.p$)(q),ne=q.id;(te.uid!==Y.uid||X!==ne)&&(Y=te,X=ne,Q=!1)}return Y.type?.length&&K.add(Y.type),Y.uid?.length&&G.add(Y.uid),{...Q?this.applyTemplateVariables(z,S.scopedVars,S.filters):z,datasource:Y,datasourceId:X,intervalMs:w,maxDataPoints:N,queryCachingTTL:M}});if(!H.length)return(0,n.of)({data:[]});const _={queries:H,from:L?.from.valueOf().toString(),to:L?.to.valueOf().toString()},k=S.headers??{};k["X-Plugin-Id"]=Array.from(K).join(", "),k["X-Datasource-Uid"]=Array.from(G).join(", ");let J="/api/ds/query?ds_type="+this.type;if(g.$.featureToggles.queryServiceFromExplore&&S.app===c.Jk.Explore){const z=g.$.featureToggles.queryService,Y=g.$.featureToggles.grafanaAPIServerWithExperimentalAPIs;!z&&!Y?console.warn("feature toggle queryServiceFromExplore also requires the queryService to be running"):J=`/apis/query.grafana.app/v0alpha1/namespaces/${g.$.namespace}/query?ds_type=${this.type}`}return g.$.featureToggles.queryServiceFromUI&&(g.$.featureToggles.queryService||g.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?J=`/apis/query.grafana.app/v0alpha1/namespaces/${g.$.namespace}/query?ds_type=${this.type}`:console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),V&&(k["X-Grafana-From-Expr"]="true",J+="&expression=true"),A&&(J+=`&requestId=${A}`),S.dashboardUID&&(k["X-Dashboard-Uid"]=S.dashboardUID,S.dashboardTitle&&(k["X-Dashboard-Title"]=S.dashboardTitle),S.panelId&&(k["X-Panel-Id"]=`${S.panelId}`),S.panelName&&(k["X-Panel-Title"]=S.panelName)),S.panelPluginId&&(k["X-Panel-Plugin-Id"]=`${S.panelPluginId}`),S.queryGroupId&&(k["X-Query-Group-Id"]=`${S.queryGroupId}`),S.skipQueryCache&&(k["X-Cache-Skip"]="true"),(0,v.AI)().fetch({url:J,method:"POST",data:_,requestId:A,hideFromInspector:U,headers:k}).pipe((0,l.n)(z=>{const Y=(0,u.bE)(z,H);return Y.data?.length&&Y.data.find(X=>X.meta?.channel)?j(Y,S,this.streamOptionsProvider):(0,n.of)(Y)}),(0,o.W)(z=>(0,n.of)((0,u.bE)(z))))}getRequestHeaders(){const S={};return S["X-Plugin-Id"]=this.type,S["X-Datasource-Uid"]=this.uid,S}interpolateVariablesInQueries(S,w,N){return S.map(M=>this.applyTemplateVariables(M,w,N))}applyTemplateVariables(S,w,N){return S}async getResource(S,w,N){const M=this.getRequestHeaders();return(await(0,a.s)((0,v.AI)().fetch({...N,method:"GET",headers:N?.headers?{...N.headers,...M}:M,params:w??N?.params,url:`/api/datasources/uid/${this.uid}/resources/${S}`}))).data}async postResource(S,w,N){const M=this.getRequestHeaders();return(await(0,a.s)((0,v.AI)().fetch({...N,method:"POST",headers:N?.headers?{...N.headers,...M}:M,data:w??{...w},url:`/api/datasources/uid/${this.uid}/resources/${S}`}))).data}async callHealthCheck(){return(0,a.s)((0,v.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(S=>S.data).catch(S=>{let w={plugin_id:this.meta?.id||"",plugin_version:this.meta?.info?.version||"",datasource_healthcheck_status:S?.data?.status||"error",datasource_healthcheck_message:S?.data?.message||""};return(0,r.rR)("datasource_health_check_completed",w),S.data})}async testDatasource(){return this.callHealthCheck().then(S=>S.status==="OK"?{status:"success",message:S.message}:Promise.reject({status:"error",message:S.message,error:new P(S.message,S.details)}))}}function j(B,S,w){const N=(0,x.oF)();if(!N)return(0,n.of)(B);const M=[],L=[];for(const A of B.data){const U=(0,m.DG)(A.meta?.channel);if(U){const F=A;L.push(N.getDataStream({addr:U,buffer:w(S,F),frame:(0,p.Nw)(A)}))}else M.push(A)}return M.length&&L.push((0,n.of)({...B,data:M})),L.length===1?L[0]:(0,s.h)(...L)}const W=(B,S)=>{const w={maxLength:B.maxDataPoints??500,action:f.Kh.Append};return B.rangeRaw?.to==="now"&&(w.maxDelta=B.range.to.valueOf()-B.range.from.valueOf()),w};I=(0,h.Y)(I)},92293:(Z,R,e)=>{"use strict";e.d(R,{_:()=>a,k:()=>s});let n;const a=l=>{n=l},s=()=>(n||console.error("useChromeHeaderHeight hook not found"),n?.())},25992:(Z,R,e)=>{"use strict";e.d(R,{DW:()=>m,FF:()=>o,MD:()=>d,fH:()=>l,l$:()=>c,vV:()=>i});var n=e(32631),a=e(37930),s=e(43173);function l(p,h){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([p],{level:a.$b.INFO,context:h})}function o(p,h){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([p],{level:a.$b.WARN,context:h})}function d(p,h){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([p],{level:a.$b.DEBUG,context:h})}function i(p,h){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushError(p,{context:h})}function c(p,h,r){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushMeasurement({type:p,values:h},{context:r})}function m(p,h){const r=g=>({source:p,...h,...g});return{logDebug:(g,y)=>d(g,r(y)),logInfo:(g,y)=>l(g,r(y)),logWarning:(g,y)=>o(g,r(y)),logError:(g,y)=>i(g,r(y)),logMeasurement:(g,y,v)=>c(g,y,r(v))}}},38353:(Z,R,e)=>{"use strict";e.d(R,{LZ:()=>l,aX:()=>d,xt:()=>i});var n=e(43173),a=e(68143),s=e(36580);function l(c){return c instanceof s.iy&&"hasBackendMigration"in c&&"shouldMigrate"in c}async function o(c){if(!(n.$.featureToggles.grafanaAPIServerWithExperimentalAPIs||n.$.featureToggles.datasourceAPIServers))return console.warn("migrateQuery is only available with the experimental API server"),c;const r=`/apis/${`${c[0].datasource?.type?.replace(/^(grafana-)?(.*?)(-datasource)?$/,"$2")}.datasource.grafana.app`}/v0alpha1/namespaces/${n.$.namespace}/queryconvert`,g={queries:c.map(v=>({...v,JSON:v}))};return(await(0,a.AI)().post(r,g)).queries.map(v=>v.JSON)}async function d(c,m){return!c.hasBackendMigration||!c.shouldMigrate(m)?m:(await o([m]))[0]}async function i(c,m){if(!c.hasBackendMigration||!m.targets.some(h=>c.shouldMigrate(h)))return m;const p=await o(m.targets);return{...m,targets:p}}},39698:(Z,R,e)=>{"use strict";e.d(R,{PL:()=>a,o:()=>o,se:()=>l});var n=e(43173);async function a(d){try{const i=n.$.bootData.user.theme==="light"?d.light:d.dark;return window.System.import(i)}catch(i){console.error(i)}}let s;function l(d){if(s)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");s=d}function o(){if(!s)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return s}},38866:(Z,R,e)=>{"use strict";e.d(R,{$h:()=>h,bE:()=>i});var n=e(28105),a=e(77154),s=e(41119),l=e(95004),o=e(97534);const d={severity:"info",text:"Cached response"};function i(r,g){const y={data:[],state:n.Gu.Done},v="traceId"in r?r.traceId:void 0;v!=null&&(y.traceIds=[v]);const x=r;if(x.data?.results){const f=x.data.results,u=g?.length?g.map(D=>D.refId):Object.keys(f),b=c(x),E=[];for(const D of u){const C=f[D];C&&(C.refId=D,E.push(C))}for(const D of E){if(D.error){const C={refId:D.refId,message:D.error,status:D.status};v!=null&&(C.traceId=v),y.error||(y.error={...C}),y.errors?y.errors.push({...C}):y.errors=[{...C}],y.state=n.Gu.Error}if(D.frames?.length){for(let C of D.frames){b&&(C=m(C));const P=(0,a.or)(C);P.refId||(P.refId=D.refId),y.data.push(P)}continue}if(D.series?.length)for(const C of D.series)C.refId||(C.refId=D.refId),y.data.push((0,s.Vc)(C));if(D.tables?.length)for(const C of D.tables)C.refId||(C.refId=D.refId),y.data.push((0,s.Vc)(C))}}return x.status&&x.status!==200&&(y.state!==n.Gu.Error&&(y.state=n.Gu.Error),y.error||(y.error=(0,o.u)(r))),y}function c(r){const g=r?.headers;return!g||!g.get?!1:g.get("X-Cache")==="HIT"}function m(r){return{...r,schema:{...r.schema,fields:[...r.schema?.fields??[]],meta:{...r.schema?.meta,notices:[...r.schema?.meta?.notices??[],d],isCachedResponse:!0}}}}function p(r){const g=i(r);if(g.error?.data?.message)return{status:"error",message:g.error.data.message,details:g.error?.data?.error?{message:g.error.data.error}:void 0};if(g.error?.refId&&g.error?.message)return{status:"error",message:g.error.message};throw r}function h(r){if(!r||!r.length)return[];const g=[];let y=r.fields.find(v=>v.type===l.PU.string);if(y||(y=r.fields.find(v=>v.type!==l.PU.time)),y)for(let v=0;v<y.values.length;v++)g.push({text:""+y.values[v]});return g}},41071:(Z,R,e)=>{"use strict";e.d(R,{_:()=>a,i:()=>s});let n;const a=l=>{n=l},s=()=>n?n():()=>console.error("ReturnToPrevious hook not found")},97534:(Z,R,e)=>{"use strict";e.d(R,{u:()=>n});function n(a){const s=a||{};if(!s.message){if(typeof a=="string")return{message:a};let l="Query error";s.message?l=s.message:s.data&&s.data.message&&s.data?.message!=="Query data error"?l=s.data.message:s?.data?.message==="Query data error"&&s?.data?.error||s.data&&s.data.error?l=s.data.error:s.status&&(l=`Query error: ${s.status} ${s.statusText}`),s.message=l}return s}},55315:(Z,R,e)=>{"use strict";e.d(R,{D:()=>p,X:()=>m});var n=e(2543),a=e.n(n),s=e(75505),l=e(31595),o=e(43173),d=e(68143);const i=`/apis/userstorage.grafana.app/v0alpha1/namespaces/${o.$.namespace}/user-storage`;async function c(h){try{const{data:r,...g}=await(0,s.s)((0,d.AI)().fetch({...h,url:i+h.url,data:h.body,showErrorAlert:!1}));return{data:r,meta:g}}catch(r){return h.manageError?h.manageError(r):{error:r}}}class m{constructor(r){this.service=r,this.userUID=o.$.bootData.user.uid===""?o.$.bootData.user.id.toString():o.$.bootData.user.uid,this.resourceName=`${r}:${this.userUID}`,this.canUseUserStorage=o.$.bootData.user.isSignedIn}async init(){if(this.storageSpec!==void 0)return;const r=await c({url:`/${this.resourceName}`,method:"GET",manageError:g=>(0,n.get)(g,"status")===404?(this.storageSpec=null,{error:null}):{error:g}});if("error"in r)return r.error;this.storageSpec=r.data.spec}async getItem(r){return this.canUseUserStorage?(await this.init(),this.storageSpec?this.storageSpec.data[r]:localStorage.getItem(`${this.resourceName}:${r}`)):localStorage.getItem(`${this.resourceName}:${r}`)}async setItem(r,g){if(!this.canUseUserStorage){localStorage.setItem(`${this.resourceName}:${r}`,g);return}const y={data:{[r]:g}};if(await this.init()){localStorage.setItem(`${this.resourceName}:${r}`,g);return}if(!this.storageSpec){await c({url:"/",method:"POST",body:{metadata:{name:this.resourceName,labels:{user:this.userUID,service:this.service}},spec:y},manageError:x=>(localStorage.setItem(`${this.resourceName}:${r}`,g),{error:x})}),this.storageSpec=y;return}this.storageSpec.data[r]=g,await c({headers:{"Content-Type":"application/merge-patch+json"},url:`/${this.resourceName}`,method:"PATCH",body:{spec:y},manageError:x=>(localStorage.setItem(`${this.resourceName}:${r}`,g),{error:x})})}}function p(){const h=(0,l.Q)();if(!h)throw new Error("No PluginContext found. The usePluginUserStorage() hook can only be used from a plugin.");return new m(h?.meta.id)}},97474:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>l});var n=e(739);const a="12.1.0",s={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:n.wV.Auto,showValue:n.yL.Auto,stacking:n.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},l={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},48390:(Z,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0",s={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},53478:(Z,R,e)=>{"use strict";e.d(R,{K:()=>a});const n="12.1.0",a={selectedSeries:0}},74194:(Z,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0",s={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto}},48850:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>a});const n="12.1.0",a={layers:[]},s={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var l=(d=>(d.Details="details",d.None="none",d))(l||{}),o=(d=>(d.Coords="coords",d.Fit="fit",d.Zero="zero",d))(o||{})},97644:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>d});var n=e(739);const a="12.1.0";var s=(i=>(i.Opacity="opacity",i.Scheme="scheme",i))(s||{}),l=(i=>(i.Exponential="exponential",i.Linear="linear",i))(l||{}),o=(i=>(i.X="x",i.Xy="xy",i.Y="y",i))(o||{});const d={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}}},55448:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>l});var n=e(739);const a="12.1.0",s={bucketCount:30,bucketOffset:0},l={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},25346:(Z,R,e)=>{"use strict";e.d(R,{K:()=>a});const n="12.1.0",a={showImage:!0}},23130:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>d});const n="12.1.0";var a=(i=>(i.Donut="donut",i.Pie="pie",i))(a||{}),s=(i=>(i.Name="name",i.Percent="percent",i.Value="value",i))(s||{}),l=(i=>(i.Percent="percent",i.Value="value",i))(l||{});const o={values:[]},d={displayLabels:[]}},7698:(Z,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0",s={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0}},16880:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>l});var n=e(739);const a="12.1.0",s={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:n.yL.Auto},l={fillOpacity:70,lineWidth:0}},93384:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>l});var n=e(739);const a="12.1.0",s={colWidth:.9,perPage:20,rowHeight:.9,showValue:n.yL.Auto},l={fillOpacity:70,lineWidth:1}},59740:(Z,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0",s={cellHeight:n.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},51250:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>d});const n="12.1.0";var a=(i=>(i.Code="code",i.HTML="html",i.Markdown="markdown",i))(a||{}),s=(i=>(i.Go="go",i.Html="html",i.Json="json",i.Markdown="markdown",i.Plaintext="plaintext",i.Sql="sql",i.Typescript="typescript",i.Xml="xml",i.Yaml="yaml",i))(s||{});const l="plaintext",o={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},d={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},81166:(Z,R,e)=>{"use strict";e.d(R,{KQ:()=>i,QB:()=>d});const n="12.1.0";var a=(c=>(c.Circle="circle",c.Square="square",c))(a||{}),s=(c=>(c.Auto="auto",c.Manual="manual",c))(s||{}),l=(c=>(c.Lines="lines",c.Points="points",c.PointsAndLines="points+lines",c))(l||{});const o={id:""},d={fillOpacity:50,show:"points"},i={series:[]}},21275:(Z,R,e)=>{"use strict";e.d(R,{$C:()=>u,CO:()=>d,GW:()=>P,OA:()=>b,Ol:()=>r,QB:()=>C,WL:()=>v,Yb:()=>p,Ye:()=>T,ZG:()=>c,aD:()=>s,bf:()=>l,bt:()=>E,dM:()=>y,lt:()=>x,rw:()=>o,ss:()=>D,yV:()=>f});const n={tags:[]},a={exclude:!1,ids:[]},s={list:[]},l={builtIn:0,enable:!0,hide:!1},o={allowCustomValue:!0,includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var d=(O=>(O[O.never=0]="never",O[O.onDashboardLoad=1]="onDashboardLoad",O[O.onTimeRangeChanged=2]="onTimeRangeChanged",O))(d||{}),i=(O=>(O[O.dontHide=0]="dontHide",O[O.hideLabel=1]="hideLabel",O[O.hideVariable=2]="hideVariable",O))(i||{}),c=(O=>(O[O.alphabeticalAsc=1]="alphabeticalAsc",O[O.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",O[O.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",O[O.alphabeticalDesc=2]="alphabeticalDesc",O[O.disabled=0]="disabled",O[O.naturalAsc=7]="naturalAsc",O[O.naturalDesc=8]="naturalDesc",O[O.numericalAsc=3]="numericalAsc",O[O.numericalDesc=4]="numericalDesc",O))(c||{});const m={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var p=(O=>(O.ContinuousBlPu="continuous-BlPu",O.ContinuousBlYlRd="continuous-BlYlRd",O.ContinuousBlues="continuous-blues",O.ContinuousGrYlRd="continuous-GrYlRd",O.ContinuousGreens="continuous-greens",O.ContinuousPurples="continuous-purples",O.ContinuousRdYlGr="continuous-RdYlGr",O.ContinuousReds="continuous-reds",O.ContinuousYlBl="continuous-YlBl",O.ContinuousYlRd="continuous-YlRd",O.Fixed="fixed",O.PaletteClassic="palette-classic",O.PaletteClassicByName="palette-classic-by-name",O.Shades="shades",O.Thresholds="thresholds",O))(p||{});const h={h:9,w:12,x:0,y:0};var r=(O=>(O.Absolute="absolute",O.Percentage="percentage",O))(r||{});const g={steps:[]};var y=(O=>(O.RangeToText="range",O.RegexToText="regex",O.SpecialValue="special",O.ValueToText="value",O))(y||{}),v=(O=>(O.Empty="empty",O.False="false",O.NaN="nan",O.Null="null",O.NullAndNan="null+nan",O.True="true",O))(v||{});const x={hidden:!1,quick_ranges:[],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]};var f=(O=>(O[O.Crosshair=1]="Crosshair",O[O.Off=0]="Off",O[O.Tooltip=2]="Tooltip",O))(f||{});const u=0,b={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},E={overrides:[]},D={id:""},C={links:[],mappings:[]},P={collapsed:!1,panels:[]},T={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:41,tags:[],timezone:"browser"}},78947:(Z,R,e)=>{"use strict";e.d(R,{Bj:()=>It,ET:()=>Ve,FM:()=>be,G9:()=>Oe,IP:()=>Ut,SR:()=>ve,X1:()=>Ke,bt:()=>C,ft:()=>We,kH:()=>Te,l_:()=>Mt,m6:()=>le,ns:()=>mt,pK:()=>ot,t1:()=>we,uB:()=>Tt,xE:()=>On});const n=()=>({kind:"AnnotationQuery",spec:a()}),a=()=>({enable:!1,hide:!1,iconColor:"",name:"",builtIn:!1}),s=()=>({}),l=()=>({kind:"",spec:{}}),o=()=>({exclude:!1,ids:[]}),d=()=>"Off",i=()=>c(),c=()=>({kind:"Panel",spec:m()}),m=()=>({id:0,title:"",description:"",links:[],data:h(),vizConfig:E()}),p=()=>({title:"",url:""}),h=()=>({kind:"QueryGroup",spec:r()}),r=()=>({queries:[],transformations:[],queryOptions:b()}),g=()=>({kind:"PanelQuery",spec:y()}),y=()=>({query:l(),refId:"",hidden:!1}),v=()=>({kind:"",spec:x()}),x=()=>({id:"",options:{}}),f=()=>({id:""}),u=()=>"series",b=()=>({}),E=()=>({kind:"",spec:D()}),D=()=>({pluginVersion:"",options:{},fieldConfig:C()}),C=()=>({defaults:P(),overrides:[]}),P=()=>({}),T=()=>O(),O=()=>({type:"value",options:{}}),I=()=>"value",j=()=>({}),W=()=>({type:"range",options:{from:0,to:0,result:j()}}),B=()=>({type:"regex",options:{pattern:"",result:j()}}),S=()=>({type:"special",options:{match:"true",result:j()}}),w=()=>"true",N=()=>({mode:"absolute",steps:[]}),M=()=>"absolute",L=()=>({value:0,color:""}),A=()=>({mode:"thresholds"}),U=()=>"thresholds",F=()=>"min",V=()=>({id:""}),K=()=>({kind:"LibraryPanel",spec:G()}),G=()=>({id:0,title:"",libraryPanel:H()}),H=()=>({name:"",uid:""}),_=()=>({kind:"GridLayout",spec:k()}),k=()=>({items:[]}),J=()=>({kind:"GridLayoutItem",spec:z()}),z=()=>({x:0,y:0,width:0,height:0,element:Y()}),Y=()=>({kind:"ElementReference",name:""}),X=()=>({mode:Q,value:""}),Q="variable",q=()=>({kind:"RowsLayout",spec:te()}),te=()=>({rows:[]}),ne=()=>({kind:"RowsLayoutRow",spec:se()}),se=()=>({layout:_()}),ue=()=>({kind:"ConditionalRenderingGroup",spec:de()}),de=()=>({visibility:"show",condition:"and",items:[]}),ie=()=>({kind:"ConditionalRenderingVariable",spec:he()}),he=()=>({variable:"",operator:"equals",value:""}),me=()=>({kind:"ConditionalRenderingData",spec:ce()}),ce=()=>({value:!1}),Pe=()=>({kind:"ConditionalRenderingTimeRangeSize",spec:Ie()}),Ie=()=>({value:""}),Se=()=>({mode:Q,value:""}),Me=()=>({kind:"AutoGridLayout",spec:Te()}),Te=()=>({maxColumnCount:3,columnWidthMode:"standard",rowHeightMode:"standard",fillScreen:!1,items:[]}),Ge=()=>({kind:"AutoGridLayoutItem",spec:Qe()}),Qe=()=>({element:Y()}),tt=()=>({mode:Q,value:""}),ke=()=>({kind:"TabsLayout",spec:He()}),He=()=>({tabs:[]}),Re=()=>({kind:"TabsLayoutTab",spec:Ne()}),Ne=()=>({layout:_()}),Ae=()=>({mode:Q,value:""}),Ue=()=>({title:"",type:"link",icon:"",tooltip:"",tags:[],asDropdown:!1,targetBlank:!1,includeVars:!1,keepTime:!1}),Be=()=>"link",We=()=>({timezone:"browser",from:"now-6h",to:"now",autoRefresh:"",autoRefreshIntervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],hideTimepicker:!1,fiscalYearStartMonth:0}),_e=()=>({display:"Last 6 hours",from:"now-6h",to:"now"}),Xe=()=>le(),le=()=>({kind:"QueryVariable",spec:ye()}),ye=()=>({name:"",current:{text:"",value:""},hide:"dontHide",refresh:"never",skipUrlSync:!1,query:l(),regex:"",sort:"disabled",options:[],multi:!1,includeAll:!1,allowCustomValue:!0}),pe=()=>({text:"",value:""}),ve=()=>"dontHide",be=()=>"never",Oe=()=>"disabled",we=()=>({kind:"TextVariable",spec:ze()}),ze=()=>({name:"",current:{text:"",value:""},query:"",hide:"dontHide",skipUrlSync:!1}),Ve=()=>({kind:"ConstantVariable",spec:ge()}),ge=()=>({name:"",query:"",current:{text:"",value:""},hide:"dontHide",skipUrlSync:!1}),Ke=()=>({kind:"DatasourceVariable",spec:qe()}),qe=()=>({name:"",pluginId:"",refresh:"never",regex:"",current:{text:"",value:""},options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),ot=()=>({kind:"IntervalVariable",spec:lt()}),lt=()=>({name:"",query:"",current:{text:"",value:""},options:[],auto:!1,auto_min:"",auto_count:0,refresh:"never",hide:"dontHide",skipUrlSync:!1}),mt=()=>({kind:"CustomVariable",spec:Lt()}),Lt=()=>({name:"",query:"",current:pe(),options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),Tt=()=>({kind:"GroupByVariable",spec:It()}),It=()=>({name:"",current:{text:"",value:""},options:[],multi:!1,hide:"dontHide",skipUrlSync:!1}),Mt=()=>({kind:"AdhocVariable",spec:Ut()}),Ut=()=>({name:"",baseFilters:[],filters:[],defaultKeys:[],hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),an=()=>({key:"",operator:"",value:""}),cn="dashboard",un=()=>({text:""}),On=()=>({annotations:[],cursorSync:"Off",editable:!0,elements:{},layout:_(),links:[],preload:!1,tags:[],timeSettings:We(),title:"",variables:[]})},31114:(Z,R,e)=>{"use strict";e.d(R,{Gu:()=>s,gB:()=>a});var n=e(739);const a={align:"auto",inspect:!1,wrapHeaderText:!1,cellOptions:{type:n.ob.Auto}};var s=(l=>(l.NotStarted="NotStarted",l.Loading="Loading",l.Streaming="Streaming",l.Done="Done",l.Error="Error",l))(s||{})},59857:(Z,R,e)=>{"use strict";e.d(R,{Ye:()=>s,lt:()=>o,rw:()=>l,zL:()=>a});var n=e(21275),a=(g=>(g[g.dontHide=0]="dontHide",g[g.hideLabel=1]="hideLabel",g[g.hideVariable=2]="hideVariable",g))(a||{});const s=n.Ye,l={...n.rw},o=n.lt,d=n.OA,i=n.GW,c=n.QB,m=n.bt,p=n.ss,h=n.bf,r=n.aD},27074:(Z,R,e)=>{"use strict";e.d(R,{l:()=>h});var n=e(74848),a=e(22803),s=e(73287),l=e(92745),o=e(27489),d=e(63142),i=e(76319),c=e(37386),m=e(50992),p=e(52308);function h({rawSql:g,datasourceType:y}){const[v,x]=(0,s.A)(),f=(0,d.of)(r),u=E=>{x(E),(0,o.rR)("grafana_sql_preview_copied",{datasource:y})},b=(0,n.jsxs)("div",{className:f.labelWrapper,children:[(0,n.jsx)("span",{className:f.label,children:(0,n.jsx)(l.x6,{i18nKey:"grafana-sql.components.preview.label-element.preview",children:"Preview"})}),(0,n.jsx)(i.K,{tooltip:(0,l.t)("grafana-sql.components.preview.label-element.tooltip-copy-to-clipboard","Copy to clipboard"),onClick:()=>u(g),name:"copy"})]});return(0,n.jsx)(c.D,{label:b,className:f.grow,children:(0,n.jsx)(m.B,{language:"sql",height:80,value:(0,p.s)(g),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function r(g){return{grow:(0,a.css)({flexGrow:1}),label:(0,a.css)({fontSize:12,fontWeight:g.typography.fontWeightMedium}),labelWrapper:(0,a.css)({display:"flex",justifyContent:"space-between",paddingBottom:g.spacing(.5)})}}},52308:(Z,R,e)=>{"use strict";e.d(R,{s:()=>a});var n=e(27633);function a(s){return n.Ay.format(s).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,l=>l.replace(/\s/g,""))}},8779:(Z,R,e)=>{"use strict";e.d(R,{r:()=>y});var n=e(74848),a=e(96540),s=e(92745),l=e(63142),o=e(45861),d=e(71599),i=e(22803),c=e(37386),m=e(16780),p=e(63527),h=e(22787);function r({action:v,onDismiss:x,onShowConfirm:f,variables:u,setVariables:b}){const E=(0,l.of)(g),D=()=>{x(),f()};return(0,n.jsxs)(h.a,{isOpen:!0,title:(0,s.t)("grafana-ui.action-editor.button.action-variables-title","Action variables"),onDismiss:x,className:E.variablesModal,children:[(0,n.jsx)(m.n,{children:v.variables.map(C=>(0,n.jsx)(c.D,{label:C.name,children:(0,n.jsx)(p.p,{type:"text",value:u[C.key]??"",onChange:P=>{b({...u,[C.key]:P.currentTarget.value})},placeholder:(0,s.t)("grafana-ui.action-editor.button.variable-value-placeholder","Value"),width:20})},C.name))}),(0,n.jsxs)(h.a.ButtonRow,{children:[(0,n.jsx)(o.$n,{variant:"secondary",onClick:x,children:(0,s.t)("grafana-ui.action-editor.close","Close")}),(0,n.jsx)(o.$n,{variant:"primary",onClick:D,children:(0,s.t)("grafana-ui.action-editor.continue","Continue")})]})]})}const g=()=>({variablesModal:(0,i.css)({zIndex:1e4})});function y({action:v,...x}){const f=(0,l.$j)(),u=v.style.backgroundColor||f.colors.secondary.main,b=f.colors.getContrastText(u),[E,D]=(0,a.useState)(!1),[C,P]=(0,a.useState)(!1),[T,O]=(0,a.useState)({}),I=v.variables&&v.variables.length>0,j=()=>{I?P(!0):D(!0)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.$n,{variant:"primary",size:"sm",onClick:j,...x,style:{width:"fit-content",backgroundColor:u,color:b},children:v.title}),I&&C&&(0,n.jsx)(r,{onDismiss:()=>P(!1),action:v,onShowConfirm:()=>D(!0),variables:T,setVariables:O}),E&&(0,n.jsx)(d.u,{isOpen:!0,title:(0,s.t)("grafana-ui.action-editor.button.confirm-action","Confirm action"),body:v.confirmation(T),confirmText:(0,s.t)("grafana-ui.action-editor.button.confirm","Confirm"),confirmButtonVariant:"primary",onConfirm:()=>{D(!1),v.onClick(new MouseEvent("click"),null,T)},onDismiss:()=>{D(!1)}})]})}},34999:(Z,R,e)=>{"use strict";e.d(R,{F:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(45861),c=e(30703),m=e(31286),p=e(66404);const h=s.forwardRef(({title:y,onRemove:v,children:x,buttonContent:f,elevated:u,bottomSpacing:b,topSpacing:E,className:D,severity:C="error",...P},T)=>{const O=(0,d.$j)(),j=g(O,C,!!y,u,b,E),W={error:"alert",warning:"alert",info:"status",success:"status"},B=P.role||W[C],S=P["aria-label"]||y,w=(0,o.t)("grafana-ui.alert.close-button","Close alert");return(0,n.jsx)("div",{ref:T,className:(0,a.cx)(j.wrapper,D),role:B,"aria-label":S,...P,children:(0,n.jsxs)(m.a,{"data-testid":l.Tp.components.Alert.alertV2(C),display:"flex",backgroundColor:C,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:C,alignItems:"stretch",boxShadow:u?"z3":void 0,children:[(0,n.jsx)(m.a,{paddingTop:1,paddingRight:2,children:(0,n.jsx)("div",{className:j.icon,children:(0,n.jsx)(c.I,{size:"xl",name:r(C)})})}),(0,n.jsxs)(m.a,{paddingY:1,grow:1,children:[(0,n.jsx)(p.E,{color:"primary",weight:"medium",children:y}),x&&(0,n.jsx)("div",{className:j.content,children:x})]}),v&&!f&&(0,n.jsx)("div",{className:j.close,children:(0,n.jsx)(i.$n,{"aria-label":w,icon:"times",onClick:v,type:"button",fill:"text",variant:"secondary"})}),v&&f&&(0,n.jsx)(m.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,n.jsx)(i.$n,{"aria-label":w,variant:"secondary",onClick:v,type:"button",children:f})})]})})});h.displayName="Alert";const r=y=>{switch(y){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},g=(y,v,x,f,u,b)=>{const E=y.colors[v];return{wrapper:(0,a.css)({flexGrow:1,marginBottom:y.spacing(u??2),marginTop:y.spacing(b??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:y.colors.background.primary,zIndex:-1}}),icon:(0,a.css)({color:E.text,position:"relative",top:"-1px"}),content:(0,a.css)({color:y.colors.text.primary,paddingTop:x?y.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,a.css)({position:"relative",color:y.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},99887:(Z,R,e)=>{"use strict";e.d(R,{E:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(70255),o=e(84140),d=e(63142),i=e(21348),c=e(30703),m=e(45967);const p=s.memo(({icon:v,color:x,text:f,tooltip:u,className:b,...E})=>{const D=(0,d.of)(y,x),C=(0,n.jsxs)("div",{className:(0,a.cx)(D.wrapper,b),...E,children:[v&&(0,n.jsx)(c.I,{name:v,size:"sm"}),f]});return u?(0,n.jsx)(m.m,{content:u,placement:"auto",children:C}):C});p.displayName="Badge";const h=({rootProps:v})=>{const x=(0,d.of)(g);return(0,n.jsx)(l.A,{width:60,height:22,containerClassName:x.container,...v})},r=(0,i.j)(p,h),g=()=>({container:(0,a.css)({lineHeight:1})}),y=(v,x)=>{let f=v.visualization.getColorByName(x),u="",b="",E="";return v.isDark?(b=(0,o.A)(f).setAlpha(.15).toString(),u=(0,o.A)(f).setAlpha(.25).toString(),E=(0,o.A)(f).lighten(15).toString()):(b=(0,o.A)(f).setAlpha(.15).toString(),u=(0,o.A)(f).setAlpha(.25).toString(),E=(0,o.A)(f).darken(20).toString()),x==="brand"&&(b=v.colors.gradients.brandHorizontal,u="transparent",E=v.colors.primary.contrastText),{wrapper:(0,a.css)({display:"inline-flex",padding:"1px 4px",borderRadius:v.shape.radius.default,background:b,border:`1px solid ${u}`,color:E,fontWeight:v.typography.fontWeightRegular,gap:v.spacing(.5),fontSize:v.typography.bodySmall.fontSize,lineHeight:v.typography.bodySmall.lineHeight,alignItems:"center"})}}},98005:(Z,R,e)=>{"use strict";e.d(R,{xE:()=>P});var n=e(74848),a=e(22803),s=e(96540),l=e(84140),o=e(38919),d=e(33553),i=e(48588),c=e(55386),m=e(64394),p=e(76637),h=e(51898),r=e(739),g=e(53568),y=e(45861),v=e(21539);const x=18,f=50,u=150,b=1.5,E=1,D=10,C=15;class P extends s.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:r.eX.Gradient,orientation:o.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:d.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0,isOverflow:!1}}render(){const{onClick:A,className:U,theme:F}=this.props,{title:V}=this.props.value,K=I(this.props);return A?(0,n.jsxs)("button",{type:"button",style:K.wrapper,onClick:A,className:(0,a.cx)((0,y.my)(F),U),children:[(0,n.jsx)("div",{style:K.title,children:V}),this.renderBarAndValue()]}):(0,n.jsxs)("div",{style:K.wrapper,className:U,children:[V&&(0,n.jsx)("div",{style:K.title,children:V}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:A,showUnfilled:U,valueDisplayMode:F}=this.props,V=S(this.props);return(0,n.jsxs)("div",{style:V.wrapper,children:[F!==r.$l.Hidden&&(0,n.jsx)(v.i,{"data-testid":h.Tp.components.Panels.Visualization.BarGauge.valueV2,value:A,style:V.value}),U&&(0,n.jsx)("div",{style:V.emptyBar}),(0,n.jsx)("div",{style:V.bar})]})}renderRetroBars(){const{display:A,field:U,value:F,itemSpacing:V,alignmentFactors:K,orientation:G,lcdCellWidth:H,text:_,valueDisplayMode:k,theme:J,isOverflow:z}=this.props,{valueHeight:Y,valueWidth:X,maxBarHeight:Q,maxBarWidth:q,wrapperWidth:te,wrapperHeight:ne}=j(this.props),se=U.min??i.tw,ue=U.max??i.d1,de=T(G),ie=ue-se,he=de?Q:q,me=V,ce=Math.floor(he/H),Pe=Math.floor((he-me*ce)/ce),Ie=N(this.props),Me=M(K||F,Ie,X,Y,G,z,_),Te={width:`${te}px`,height:`${ne}px`,display:"flex"};de?(Te.flexDirection="column-reverse",Te.alignItems="center"):(Te.flexDirection="row",Te.alignItems="center",Me.justifyContent="flex-end");const Ge=[];for(let Qe=0;Qe<ce;Qe++){const tt=se+ie/ce*Qe,ke=W(tt,F,A),He={borderRadius:J.shape.radius.default};ke.isLit?He.backgroundImage=`radial-gradient(${ke.background} 10%, ${ke.backgroundShade})`:He.backgroundColor=ke.background,de?(He.height=`${Pe}px`,He.width=`${q}px`,He.marginTop=`${me}px`):(He.width=`${Pe}px`,He.height=`${Q}px`,He.marginRight=`${me}px`),Ge.push((0,n.jsx)("div",{style:He},Qe.toString()))}return(0,n.jsxs)("div",{style:Te,children:[Ge,k!==r.$l.Hidden&&(0,n.jsx)(v.i,{"data-testid":h.Tp.components.Panels.Visualization.BarGauge.valueV2,value:F,style:Me})]})}}function T(L){return L===o.wV.Vertical}function O(L){const{height:A,width:U,alignmentFactors:F,orientation:V,text:K,namePlacement:G}=L,H=F?F.title:L.value.title;if(!H)return{fontSize:0,width:0,height:0,placement:"above"};if(G===r.TZ.Hidden)return{fontSize:0,width:0,height:0,placement:r.TZ.Hidden};if(T(V)){const Q=K?.titleSize??14;return{fontSize:Q,width:U,height:Q*b,placement:"below"}}if(A>40&&G===r.TZ.Auto||G===r.TZ.Top){if(K?.titleSize)return{fontSize:K?.titleSize,width:0,height:K.titleSize*b,placement:"above"};const q=Math.max(Math.min(A*.45,f),17);return{fontSize:q/b,width:0,height:q,placement:"above"}}const z=Math.max(A*.6,x)/b,Y=(0,g.kD)(H,z),X=Math.min(Y.width+15,U*.4);return{fontSize:K?.titleSize??z,height:0,width:X,placement:"left"}}function I(L){const A={display:"flex",overflow:"hidden",width:"100%"},U=O(L),F={fontSize:`${U.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return U.placement==="hidden"?F.display="none":T(L.orientation)?(A.flexDirection="column-reverse",F.textAlign="center"):U.placement==="above"?A.flexDirection="column":(A.flexDirection="row",F.width=`${U.width}px`,F.textAlign="right",F.paddingRight="10px"),{wrapper:A,title:F}}function j(L){const{height:A,width:U,orientation:F,text:V,alignmentFactors:K,valueDisplayMode:G}=L,H=O(L),_=K??L.value,k=(0,c.cN)(_);let J=0,z=0,Y=0,X=0,Q=0,q=0;const te=V?.valueSize??Math.max(H.fontSize,12),se=(0,g.kD)(k,te).width+D*2;return T(F)?(V?.valueSize?Y=V.valueSize*E:Y=Math.min(Math.max(A*.1,x),f),X=U,G===r.$l.Hidden&&(Y=0,X=0),J=A-(H.height+Y),z=U,Q=U,q=A-H.height):(G===r.$l.Hidden?(Y=0,X=0):(Y=A-H.height,X=Math.max(Math.min(U*.2,u),se)),J=A-H.height,z=U-X-H.width,H.placement==="above"?(Q=U,q=A-H.height):(Q=U-H.width,q=A)),{valueWidth:X,valueHeight:Y,maxBarWidth:z,maxBarHeight:J,wrapperHeight:q,wrapperWidth:Q}}function W(L,A,U){if(L===null)return{background:m.F,border:m.F};const F=U?U(L).color:null;return F?A===null||isNaN(A.numeric)||L!==null&&L>A.numeric?{background:(0,l.A)(F).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,l.A)(F).setAlpha(.95).toRgbString(),backgroundShade:(0,l.A)(F).setAlpha(.55).toRgbString(),border:(0,l.A)(F).setAlpha(.9).toRgbString(),isLit:!0}:{background:m.F,border:m.F}}function B(L,A,U){const F=Math.min((L-A)/(U-A),1);return isNaN(F)?0:F}function S(L){const{displayMode:A,field:U,value:F,alignmentFactors:V,orientation:K,theme:G,text:H,isOverflow:_}=L,{valueWidth:k,valueHeight:J,maxBarHeight:z,maxBarWidth:Y}=j(L),X=U.min??i.tw,Q=U.max??i.d1,q=B(F.numeric,X,Q),te=N(L),ne=F.color??m.F,ue=M(V||F,te,k,J,K,_,H),de=A==="basic",ie={display:"flex",flexGrow:1},he={borderRadius:G.shape.radius.default,position:"relative"},me={background:G.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:G.shape.radius.default,position:"relative"};if(T(K)){const ce=Math.max(q*z,1);ie.flexDirection="column",ie.justifyContent="flex-end",he.transition="height 1s",he.height=`${ce}px`,he.width=`${Y}px`,me.bottom="-3px",me.width=`${k}px`,de?(he.background=`${(0,l.A)(ne).setAlpha(.35).toRgbString()}`,he.borderTop=`2px solid ${ne}`):he.background=w(L,z)}else{const ce=Math.max(q*Y,1);ie.flexDirection="row-reverse",ie.justifyContent="flex-end",ie.alignItems="stretch",he.transition="width 1s",he.height=`${z}px`,he.width=`${ce}px`,me.left="-3px",me.height=`${J}px`,de?(he.background=`${(0,l.A)(ne).setAlpha(.35).toRgbString()}`,he.borderRight=`2px solid ${ne}`):he.background=w(L,Y)}return{wrapper:ie,bar:he,value:ue,emptyBar:me}}function w(L,A){const{field:U,value:F,orientation:V,theme:K}=L,G=T(V)?"0deg":"90deg",H=U.min,_=U.max;let k="",J=0,z=(0,p.Hs)(U.color?.mode);if(z.id===m.Y.Thresholds){const Y=U.thresholds;for(let X=0;X<Y.steps.length;X++){const Q=Y.steps[X],q=L.theme.visualization.getColorByName(Q.color),te=Y.mode===d.O.Percentage?Q.value/100:B(Q.value,H,_),ne=te*A,se=Math.round(ne-(ne-J)/2),ue=Y.mode===d.O.Percentage?H+(_-H)*te:Q.value;if(k==="")k=`linear-gradient(${G}, ${q}, ${q}`;else{if(F.numeric<ue)break;J=ne,k+=` ${se}px, ${q}`}}return k+")"}if(z.isContinuous&&z.getColors){const Y=z.getColors(K);for(let X=0;X<Y.length;X++){const Q=Y[X];if(k==="")k=`linear-gradient(${G}, ${Q} 0px`;else{const te=X/(Y.length-1)*A;k+=`, ${Q} ${te}px`}}return k+")"}return F.color??m.F}function N(L){if(L.valueDisplayMode==="text")return L.theme.colors.text.primary;const{value:A}=L;return A.color?A.color:m.F}function M(L,A,U,F,V,K,G){const H={color:A,height:`${F}px`,maxWidth:`${U}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:E};let _=U;const k=(0,c.cN)(L);return T(V)?(H.fontSize=G?.valueSize??(0,g.Vr)(k,_,F,E),H.justifyContent="center"):(H.fontSize=G?.valueSize??(0,g.Vr)(k,_-D*2,F,E),H.justifyContent="flex-end",H.paddingLeft=`${D}px`,H.paddingRight=`${D+(K?C:0)}px`,_-=D),H}},97611:(Z,R,e)=>{"use strict";e.d(R,{yV:()=>N,yp:()=>W,$p:()=>B,F8:()=>S,SV:()=>w});var n=e(74848),a=e(22803),s=e(96540),l=e(45861),o=e(21539),d=e(84140),i=e(95004),c=e(55386),m=e(739),p=e(8255),h=e(53568),r=e(53431),g=e(30703);const y=({percentChange:M,styles:L})=>{let A;return M>0?A="arrow-up":M<0&&(A="arrow-down"),(0,n.jsxs)("div",{style:L.containerStyles,children:[A&&(0,n.jsx)(g.I,{name:A,height:L.iconSize,width:L.iconSize,viewBox:"6 6 12 12"}),v(M)]})},v=M=>(M/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),x=1.2,f=30,u=500;class b{constructor(L){this.props=L;const{width:A,height:U,value:F,text:V}=L;this.valueColor=F.color??"gray",this.panelPadding=U>100?12:8,this.textValues=I(L),this.justifyCenter=O(L.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.percentFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=A-this.panelPadding*2,this.maxTextHeight=U-this.panelPadding*2,V&&(V.titleSize&&(this.titleFontSize=V.titleSize,this.titleToAlignTo=void 0),V.valueSize&&(this.valueFontSize=V.valueSize,this.valueToAlignTo=""),V.percentSize&&(this.percentFontSize=V.percentSize))}getTitleStyles(){const L={fontSize:`${this.titleFontSize}px`,lineHeight:x};return(this.props.colorMode===W.Background||this.props.colorMode===W.BackgroundSolid)&&(L.color=(0,p.mZ)(this.valueColor,this.props.theme.isDark)),L}getValueStyles(){const L={fontSize:this.valueFontSize,fontWeight:u,lineHeight:x,position:"relative",zIndex:1};switch(this.justifyCenter&&(L.textAlign="center"),this.props.colorMode){case W.Value:L.color=this.valueColor;break;case W.Background:case W.BackgroundSolid:L.color=(0,p.mZ)(this.valueColor,this.props.theme.isDark);break;case W.None:L.color=this.props.theme.colors.text.primary;break}return L}getPercentChangeStyles(L,A,U){const V=this.getValueAndTitleContainerStyles(),K=this.percentFontSize||Math.max(this.valueFontSize/2.5,12);let G=this.percentFontSize?this.percentFontSize-3:Math.max(this.valueFontSize/3,10);const H=this.props.theme.visualization,_=j(L,A,U,H),k={fontSize:K,fontWeight:u,lineHeight:x,position:"relative",display:"flex",alignItems:"center",gap:Math.max(K/3,4),zIndex:1,color:_};switch(this.justifyCenter&&(k.textAlign="center"),V.flexDirection==="column"&&K>12&&(k.marginTop=-(K/4)),V.flexDirection==="row"&&(k.alignItems="baseline",k.lineHeight=x*2.5),this.props.colorMode){case W.Background:case W.BackgroundSolid:k.color=(0,p.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===w.None&&(k.fontSize=(0,h.Vr)(v(L),this.maxTextWidth*.8,this.maxTextHeight*.8,x,void 0,u),G=k.fontSize*.8),{containerStyles:k,iconSize:G}}getValueAndTitleContainerStyles(){const L={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(L.alignItems="center",L.justifyContent="center",L.flexGrow=1,L.gap="0.75ch"),L}getPanelStyles(){const{width:L,height:A,theme:U,colorMode:F,textMode:V}=this.props,K={width:`${L}px`,height:`${A}px`,padding:`${V===w.None?2:this.panelPadding}px`,borderRadius:U.shape.radius.default,position:"relative",display:"flex"},G=U.isDark?1:-.7;switch(F){case W.Background:const H=(0,d.A)(this.valueColor).darken(15*G).spin(8).toRgbString(),_=(0,d.A)(this.valueColor).darken(5*G).spin(-8).toRgbString();K.background=`linear-gradient(120deg, ${H}, ${_})`;break;case W.BackgroundSolid:K.background=(0,d.A)(this.valueColor).toString();break;case W.Value:K.background="transparent";break}return this.justifyCenter&&(K.alignItems="center",K.flexDirection="row"),K}renderChart(){const{sparkline:L,colorMode:A}=this.props;if(!L||L.y?.type!==i.PU.number)return null;let U,F;switch(A){case W.Background:case W.BackgroundSolid:U="rgba(255,255,255,0.4)",F=(0,d.A)(this.valueColor).brighten(40).toRgbString();break;case W.None:case W.Value:default:F=this.valueColor,U=(0,d.A)(this.valueColor).setAlpha(.2).toRgbString();break}const V={custom:{drawStyle:m.GR.Line,lineWidth:1,fillColor:U,lineColor:F}};return(0,n.jsx)("div",{style:this.getChartStyles(),children:(0,n.jsx)(r.O,{height:this.chartHeight,width:this.chartWidth,sparkline:L,config:V,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class E extends b{constructor(L){super(L);const A=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth*A,this.maxTextHeight,x,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,x,f),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="row",L.alignItems="center",L.flexGrow=1,this.justifyCenter||(L.justifyContent="space-between"),L}renderChart(){return null}getPanelStyles(){const L=super.getPanelStyles();return L.alignItems="center",L}}class D extends b{constructor(L){super(L);const{width:A,height:U}=L,F=.5,V=.6,K=1-V,G=.4;this.chartWidth=A,this.chartHeight=U*F,this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth*V,this.maxTextHeight*G,x,f)),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth*K,this.maxTextHeight*F,x,void 0,u))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="row",L.flexGrow=1,this.justifyCenter||(L.justifyContent="space-between"),L}getPanelStyles(){const L=super.getPanelStyles();return L.flexDirection="row",L.justifyContent="space-between",L}}class C extends b{constructor(L){super(L);const{width:A,height:U}=L,F=.15,V=.25;let K=0;this.chartHeight=U*V,this.chartWidth=A,this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth,U*F,x,f),K=this.titleFontSize*x),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-K,x,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=U-this.titleFontSize*x-this.valueFontSize*x}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="column",L.justifyContent="center",L}getPanelStyles(){const L=super.getPanelStyles();return L.flexDirection="column",L}}class P extends b{constructor(L){super(L);const{height:A}=L,U=.15;let F=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,h.Vr)(this.titleToAlignTo,this.maxTextWidth,A*U,x,f),F=this.titleFontSize*x),this.valueToAlignTo.length&&(this.valueFontSize=(0,h.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-F,x,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="column",L.flexGrow=1,L}renderChart(){return null}getPanelStyles(){const L=super.getPanelStyles();return L.alignItems="center",L}}function T(M){const{width:L,height:A,sparkline:U}=M;return L/A>2.5&&!M.disableWideLayout?A>50&&U&&U.y.values.length>1?new D(M):new E(M):A>100&&U&&U.y.values.length>1?new C(M):new P(M)}function O(M,L){return M===S.Center?!0:(L??"").length===0}function I(M){const{value:L,alignmentFactors:A,count:U}=M;let{textMode:F}=M;const V=A?A.title:L.title,K=(0,c.cN)(A||L);switch(F===w.Auto&&(U??1)===1&&(F=w.Value),F){case w.Name:return{...L,title:void 0,prefix:void 0,suffix:void 0,text:L.title||"",titleToAlignTo:void 0,valueToAlignTo:V??"",tooltip:(0,c.cN)(L)};case w.Value:return{...L,title:void 0,titleToAlignTo:void 0,valueToAlignTo:K,tooltip:L.title};case w.None:return{numeric:L.numeric,color:L.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${L.title}
Value: ${(0,c.cN)(L)}`};case w.ValueAndName:default:return{...L,titleToAlignTo:V,valueToAlignTo:K}}}function j(M,L,A,U){return L===m.CD.SameAsValue?A.color:M*(L===m.CD.Inverted?-1:1)>0?U.getColorByName("green"):U.getColorByName("red")}var W=(M=>(M.Background="background",M.BackgroundSolid="background_solid",M.None="none",M.Value="value",M))(W||{}),B=(M=>(M.None="none",M.Line="line",M.Area="area",M))(B||{}),S=(M=>(M.Auto="auto",M.Center="center",M))(S||{}),w=(M=>(M.Auto="auto",M.Value="value",M.ValueAndName="value_and_name",M.Name="name",M.None="none",M))(w||{});class N extends s.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:L,className:A,hasLinks:U,theme:F}=this.props,V=T(this.props),K=V.getPanelStyles(),G=V.getValueAndTitleContainerStyles(),H=V.getValueStyles(),_=V.getTitleStyles(),k=V.textValues,J=this.props.value.percentChange,z=this.props.percentChangeColorMode,Y=J!=null&&!Number.isNaN(J),X=U?void 0:k.tooltip;return L?(0,n.jsxs)("button",{type:"button",className:(0,a.cx)((0,l.my)(F),A),style:K,onClick:L,title:X,children:[(0,n.jsxs)("div",{style:G,children:[k.title&&(0,n.jsx)("div",{style:_,children:k.title}),(0,n.jsx)(o.i,{value:k,style:H})]}),V.renderChart()]}):(0,n.jsxs)("div",{className:A,style:K,title:X,children:[(0,n.jsxs)("div",{style:G,children:[k.title&&(0,n.jsx)("div",{style:_,children:k.title}),(0,n.jsx)(o.i,{value:k,style:H}),Y&&(0,n.jsx)(y,{percentChange:J,styles:V.getPercentChangeStyles(J,z,H)})]}),V.renderChart()]})}}},88977:(Z,R,e)=>{"use strict";e.d(R,{J:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(23257),o=e.n(l),d=e(63142),i=e(20662);const c=(0,s.forwardRef)(({name:p,value:h,hidden:r,facets:g,onClick:y,className:v,loading:x,searchTerm:f,active:u,style:b,title:E,highlightParts:D,...C},P)=>{const T=(0,d.$j)(),O=m(T),I=f?[f]:[],j=(0,s.useCallback)(B=>{y&&!r&&y(p,h,B)},[y,p,r,h]);let W=h||p;return g&&(W=`${W} (${g})`),(0,n.jsx)("button",{ref:P,onClick:j,style:b,title:E||W,type:"button",role:"option","aria-selected":!!u,className:(0,a.cx)(O.base,u&&O.active,x&&O.loading,r&&O.hidden,v,y&&!r&&O.hover),...C,children:D!==void 0?(0,n.jsx)(i.z,{text:W,highlightClassName:O.matchHighLight,highlightParts:D}):(0,n.jsx)(o(),{textToHighlight:W,searchWords:I,autoEscape:!0,highlightClassName:O.matchHighLight})},W)});c.displayName="Label";const m=p=>({base:(0,a.css)({display:"inline-block",cursor:"pointer",fontSize:p.typography.size.sm,lineHeight:p.typography.bodySmall.lineHeight,backgroundColor:p.colors.background.secondary,color:p.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:p.spacing(.5),borderRadius:p.shape.radius.default,border:"none",marginRight:p.spacing(1),marginBottom:p.spacing(.5)}),loading:(0,a.css)({fontWeight:p.typography.fontWeightMedium,backgroundColor:p.colors.primary.shade,color:p.colors.text.primary,[p.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:p.colors.text.primary},"50%":{color:p.colors.text.secondary},"100%":{color:p.colors.text.disabled}}}),active:(0,a.css)({fontWeight:p.typography.fontWeightMedium,backgroundColor:p.colors.primary.main,color:p.colors.primary.contrastText}),matchHighLight:(0,a.css)({background:"inherit",color:p.components.textHighlight.text,backgroundColor:p.components.textHighlight.background}),hidden:(0,a.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,a.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},93256:(Z,R,e)=>{"use strict";e.d(R,{e:()=>o});var n=e(74848),a=e(22803),s=e(96540),l=e(63142);const o=(0,s.forwardRef)(({className:i,children:c,...m},p)=>{const h=(0,l.of)(d);return(0,n.jsx)("div",{ref:p,className:(0,a.cx)("button-group",h.wrapper,i),...m,children:c})});o.displayName="ButtonGroup";const d=i=>({wrapper:(0,a.css)({display:"flex",borderRadius:i.shape.radius.default,"> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset",borderLeft:"1px solid rgba(255, 255, 255, 0.12)"},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:"unset",borderBottomRightRadius:"unset",borderRight:"1px solid rgba(0, 0, 0, 0.12)"}})})},43951:(Z,R,e)=>{"use strict";e.d(R,{c:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({message:d,callToActionElement:i,footer:c,className:m})=>{const p=(0,s.of)(o);return(0,n.jsxs)("div",{className:(0,a.cx)([p.wrapper,m]),children:[d&&(0,n.jsx)("div",{className:p.message,children:d}),i,c&&(0,n.jsx)("div",{className:p.footer,children:c})]})},o=d=>({wrapper:(0,a.css)({label:"call-to-action-card",background:d.colors.background.secondary,borderRadius:d.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:d.spacing(3),[d.breakpoints.down("sm")]:{padding:d.spacing(3,1)}}),message:(0,a.css)({marginBottom:d.spacing(3),fontStyle:"italic"}),footer:(0,a.css)({marginTop:d.spacing(3)})})},8073:(Z,R,e)=>{"use strict";e.d(R,{H:()=>T,Z:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(35484),i=e(43856);const c=s.createContext(null),m=({disabled:O,href:I,onClick:j,children:W,isSelected:B,isCompact:S,className:w,noMargin:N,...M})=>{const L=(0,s.useMemo)(()=>s.Children.toArray(W).some(V=>s.isValidElement(V)&&V.type===p),[W]),A=O||!j&&!I,U=j&&!O?j:void 0,F=(0,o.of)(i.i,O,A,B,S,N);return(0,n.jsx)(i.Q,{disableEvents:O,disableHover:A,isSelected:B,className:(0,a.cx)(F.container,w),noMargin:N,...M,children:(0,n.jsxs)(c.Provider,{value:{href:I,onClick:U,disabled:O,isSelected:B},children:[!L&&(0,n.jsx)(p,{}),W]})})};m.displayName="Card";const p=({children:O,className:I,"aria-label":j})=>{const W=(0,s.useContext)(c),B=(0,o.of)(h),{href:S,onClick:w,isSelected:N}=W??{href:void 0,onClick:void 0,isSelected:void 0},M=(0,l.t)("grafana-ui.card.option","option");return(0,n.jsxs)("h2",{className:(0,a.cx)(B.heading,I),children:[S?(0,n.jsx)("a",{href:S,className:B.linkHack,"aria-label":j,onClick:w,children:O}):w?(0,n.jsx)("button",{onClick:w,className:B.linkHack,"aria-label":j,type:"button",children:O}):(0,n.jsx)(n.Fragment,{children:O}),N!==void 0&&(0,n.jsx)("input",{"aria-label":M,type:"radio",checked:N,readOnly:!0})]})};p.displayName="Heading";const h=O=>({heading:(0,a.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:O.typography.size.md,letterSpacing:"inherit",lineHeight:O.typography.body.lineHeight,color:O.colors.text.primary,fontWeight:O.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,a.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:O.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,d.getFocusStyles)(O),zIndex:1}}})}),r=({children:O,className:I})=>{const j=(0,o.of)(g);return(0,n.jsx)("div",{className:(0,a.cx)(j.tagList,I),children:O})};r.displayName="Tags";const g=O=>({tagList:(0,a.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),y=({children:O,className:I})=>{const j=(0,o.of)(v),W=typeof O=="string"?"p":"div";return(0,n.jsx)(W,{className:(0,a.cx)(j.description,I),children:O})};y.displayName="Description";const v=O=>({description:(0,a.css)({width:"100%",gridArea:"Description",margin:O.spacing(1,0,0),color:O.colors.text.secondary,lineHeight:O.typography.body.lineHeight})}),x=({children:O,align:I="start",className:j})=>{const W=(0,o.of)(f);return(0,n.jsx)("div",{className:(0,a.cx)(W.media,j,(0,a.css)({alignSelf:I})),children:O})};x.displayName="Figure";const f=O=>({media:(0,a.css)({position:"relative",gridArea:"Figure",marginRight:O.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),u=(0,s.memo)(({children:O,className:I,separator:j="|"})=>{const W=(0,o.of)(b);let B=O;const S=s.Children.toArray(O).filter(Boolean);return S.length?(B=S.map((w,N)=>(0,n.jsx)("div",{className:W.metadataItem,children:w},`element_${N}`)),S.length>1&&j&&(B=S.reduce((w,N,M)=>[w,(0,n.jsx)("span",{className:W.separator,children:j},`separator_${M}`),N])),(0,n.jsx)("div",{className:(0,a.cx)(W.metadata,I),children:B})):null});u.displayName="Meta";const b=O=>({metadata:(0,a.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:O.typography.size.sm,color:O.colors.text.secondary,margin:O.spacing(.5,0,0),lineHeight:O.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,a.css)({zIndex:0}),separator:(0,a.css)({margin:`0 ${O.spacing(1)}`})}),E=({children:O,disabled:I,variant:j,className:W})=>{const B=(0,o.of)(D),w=(0,s.useContext)(c)?.disabled||I,N=j==="primary"?B.actions:B.secondaryActions;return(0,n.jsx)("div",{className:(0,a.cx)(N,W),children:s.Children.map(O,M=>s.isValidElement(M)?(0,s.cloneElement)(M,{disabled:w,...M.props}):null)})},D=O=>({actions:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:O.spacing(1),gridArea:"Actions",marginTop:O.spacing(2)}),secondaryActions:(0,a.css)({alignSelf:"center",color:O.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:O.spacing(1),gridArea:"Secondary",marginTop:O.spacing(2)})}),C=({children:O,disabled:I,className:j})=>(0,n.jsx)(E,{variant:"primary",disabled:I,className:j,children:O});C.displayName="Actions";const P=({children:O,disabled:I,className:j})=>(0,n.jsx)(E,{variant:"secondary",disabled:I,className:j,children:O});P.displayName="SecondaryActions";const T=O=>({inner:(0,a.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...h(O),...b(O),...v(O),...f(O),...D(O),...g(O)});m.Heading=p,m.Tags=r,m.Figure=x,m.Meta=u,m.Actions=C,m.SecondaryActions=P,m.Description=y},43856:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>i,i:()=>c});var n=e(74848),a=e(22803),s=e(63142),l=e(35484);const o=({children:m,href:p})=>{const{inner:h}=(0,s.of)(d);return p?(0,n.jsx)("a",{className:h,href:p,children:m}):(0,n.jsx)(n.Fragment,{children:m})},d=m=>({inner:(0,a.css)({display:"flex",width:"100%",padding:m.spacing(2)})}),i=({children:m,disableEvents:p,disableHover:h,isSelected:r,className:g,href:y,noMargin:v,...x})=>{const{oldContainer:f}=(0,s.of)(c,p,h,r,void 0,v);return(0,n.jsx)("div",{...x,className:(0,a.cx)(f,g),children:(0,n.jsx)(o,{href:y,children:m})})},c=(m,p=!1,h=!1,r,g,y=!1)=>{const v=r!==void 0;return{container:(0,a.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:m.spacing(g?1:2),background:m.colors.background.secondary,borderRadius:m.shape.radius.default,marginBottom:m.spacing(y?0:1),pointerEvents:p?"none":"auto",[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background-color","box-shadow","border-color","color"],{duration:m.transitions.duration.short})},...!h&&{"&:hover":{background:m.colors.emphasize(m.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":(0,l.getFocusStyles)(m)},...v&&{cursor:"pointer"},...r&&{outline:`solid 2px ${m.colors.primary.border}`}}),oldContainer:(0,a.css)({display:"flex",width:"100%",background:m.colors.background.secondary,borderRadius:m.shape.radius.default,position:"relative",pointerEvents:p?"none":"auto",marginBottom:m.spacing(y?0:1),[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background-color","box-shadow","border-color","color"],{duration:m.transitions.duration.short})},...!h&&{"&:hover":{background:m.colors.emphasize(m.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":(0,l.getFocusStyles)(m)}})}}},56873:(Z,R,e)=>{"use strict";e.d(R,{F:()=>g});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(51182),i=e(96540),c=e(92745),m=e(63142),p=e(34999),h=e(45861),r=e(76319);const g=({images:v})=>{const[x,f]=(0,i.useState)(null),[u,b]=(0,i.useState)({}),[E,D]=(0,i.useState)(v),C=(0,m.of)(y),P=(0,m.of)(h.my),T=L=>{b(A=>({...A,[L]:!0}))};(0,i.useEffect)(()=>{const L=v.filter(A=>!u[A.path]);D(L)},[u,v]);const O=L=>{f(L)},I=()=>{f(null)},j=()=>{x!==null&&E.length>0&&f((x+1)%E.length)},W=()=>{x!==null&&E.length>0&&f((x-1+E.length)%E.length)},B=L=>{if(x!==null)switch(L.key){case"ArrowRight":j();break;case"ArrowLeft":W();break;case"Escape":I();break;default:break}},S=(0,i.useRef)(null),{overlayProps:w,underlayProps:N}=(0,o.e)({isOpen:x!==null,onClose:I},S),{dialogProps:M}=(0,s.s)({},S);return E.length===0?(0,n.jsx)(p.F,{title:(0,c.t)("carousel.error","Something went wrong loading images"),severity:"warning","data-testid":"alert-warning"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,a.cx)(C.imageGrid),children:E.map((L,A)=>(0,n.jsxs)("button",{type:"button",onClick:()=>O(A),className:(0,a.cx)(P,C.imageButton),children:[(0,n.jsx)("img",{src:L.path,alt:L.name,onError:()=>T(L.path)}),(0,n.jsx)("p",{children:L.name})]},L.path))}),x!==null&&(0,n.jsxs)(d.Sf,{children:[(0,n.jsx)("div",{role:"presentation",className:C.underlay,onClick:I,...N}),(0,n.jsx)(l.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{"data-testid":"carousel-full-screen",ref:S,...w,...M,onKeyDown:B,className:C.overlay,children:[(0,n.jsx)(r.K,{name:"times","aria-label":(0,c.t)("carousel.close","Close"),size:"xl",onClick:I,className:(0,a.cx)(C.closeButton)}),(0,n.jsx)(r.K,{size:"xl",name:"angle-left","aria-label":(0,c.t)("carousel.previous","Previous"),onClick:W,"data-testid":"previous-button"}),(0,n.jsx)("div",{className:C.imageContainer,"data-testid":"carousel-full-image",children:(0,n.jsx)("img",{className:C.imagePreview,src:E[x].path,alt:E[x].name,onError:()=>T(E[x].path)})}),(0,n.jsx)(r.K,{size:"xl",name:"angle-right","aria-label":(0,c.t)("carousel.next","Next"),onClick:j,"data-testid":"next-button"})]})})]})]})},y=v=>({imageButton:(0,a.css)({textAlign:"left"}),imageContainer:(0,a.css)({display:"flex",justifyContent:"center",flex:1}),imagePreview:(0,a.css)({maxWidth:"100%",maxHeight:"80vh",objectFit:"contain"}),imageGrid:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:v.spacing(2),marginBottom:"20px","& img":{width:"100%",height:"150px",objectFit:"cover",border:v.colors.border.strong,borderRadius:v.shape.radius.default,boxShadow:v.shadows.z1},"& p":{margin:v.spacing(.5,0),fontWeight:v.typography.fontWeightMedium,color:v.colors.text.primary}}),underlay:(0,a.css)({position:"fixed",zIndex:v.zIndex.modalBackdrop,inset:0,backgroundColor:v.components.overlay.background}),overlay:(0,a.css)({alignItems:"center",display:"flex",gap:v.spacing(1),height:"fit-content",marginBottom:"auto",marginTop:"auto",padding:v.spacing(2),position:"fixed",inset:0,zIndex:v.zIndex.modal}),closeButton:(0,a.css)({color:v.colors.text.primary,position:"fixed",top:v.spacing(2),right:v.spacing(2)})})},64913:(Z,R,e)=>{"use strict";e.d(R,{v:()=>b});var n=e(74848),a=e(22803),s=e(47078),l=e.n(s),o=e(38092),d=e(96540),i=e(92745),c=e(63142),m=e(30703),p=e(76319),h=e(63527),r=e(41654),g=e(18857),y=e(78121),v=e(21133);const x=(0,a.css)({"&:focus":{outline:"none"}}),f=" / ";class u extends d.PureComponent{constructor(D){super(D),this.flattenOptions=(O,I=[])=>{let j=[];for(const W of O){const B=[...I];B.push(W),!W.items||W.items.length===0?j.push({singleLabel:B[B.length-1].label,label:B.map(S=>S.label).join(this.props.separator||f),value:B.map(S=>S.value)}):j=[...j,...this.flattenOptions(W.items,B)]}return j},this.getSearchableOptions=l()(O=>this.flattenOptions(O)),this.onChange=(O,I)=>{const j=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?I.map(B=>B.label).join(this.props.separator||f):I[I.length-1].label,W={rcValue:{value:O,label:j},focusCascade:!0,activeLabel:j,isSearching:!1,inputValue:j};this.setState(W),this.props.onSelect(I[I.length-1].value)},this.onSelect=O=>{const I=O.value||[],j=this.props.displayAllSelectedLevels?O.label:O.singleLabel||"",W={activeLabel:j,inputValue:j,rcValue:{value:I,label:j},isSearching:!1,focusCascade:!1};this.setState(W),this.props.onSelect(I[I.length-1])},this.onCreateOption=O=>{this.setState({activeLabel:O,inputValue:O,rcValue:[],isSearching:!1}),this.props.onSelect(O)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=O=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(O.key))return;const{activeLabel:I}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:I})},this.onSelectInputChange=O=>{this.setState({inputValue:O})};const C=this.getSearchableOptions(D.options),{rcValue:P,activeLabel:T}=this.setInitialValue(C,D.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:P,activeLabel:T,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(D,C){if(!C)return{rcValue:[],activeLabel:""};for(const P of D){const T=P.value||[];if(T[T.length-1]===C)return{rcValue:T,activeLabel:this.props.displayAllSelectedLevels?P.label:P.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:C}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:D,formatCreateLabel:C,placeholder:P,width:T,changeOnSelect:O,options:I,disabled:j,id:W,isClearable:B,theme:S}=this.props,{focusCascade:w,isSearching:N,rcValue:M,activeLabel:L,inputValue:A}=this.state,U=this.getSearchableOptions(I),F=(0,v.T)(S);return(0,n.jsx)("div",{children:N?(0,n.jsx)(g.l6,{allowCustomValue:D,placeholder:P,autoFocus:!w,onChange:this.onSelect,onBlur:this.onBlur,options:U,onCreateOption:this.onCreateOption,formatCreateLabel:C,width:T,onInputChange:this.onSelectInputChange,disabled:j,inputValue:A,inputId:W}):(0,n.jsx)(o.A,{onChange:(0,y.k)(this.onChange),options:I,changeOnSelect:O,value:M.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:j,dropdownClassName:F.dropdown,children:(0,n.jsx)("div",{className:x,children:(0,n.jsx)(h.p,{autoFocus:this.props.autoFocus,width:T,placeholder:P,onBlur:this.onBlurCascade,value:L,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,n.jsxs)(r.B,{gap:.5,children:[B&&L!==""&&(0,n.jsx)(p.K,{name:"times","aria-label":(0,i.t)("grafana-ui.cascader.clear-button","Clear selection"),onClick:V=>{V.preventDefault(),V.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,n.jsx)(m.I,{name:w?"angle-up":"angle-down"})]}),disabled:j,id:W})})})})}}const b=(0,c.cV)(u)},78121:(Z,R,e)=>{"use strict";e.d(R,{W:()=>a,k:()=>n});const n=o=>(d,i)=>{o&&o(d.map(c=>String(c)),s(i))},a=o=>d=>{o&&o(s(d))},s=o=>o.map(l),l=o=>{const d=o.value?String(o.value):"";return{value:d,label:typeof o.label=="string"?o.label:d}}},21133:(Z,R,e)=>{"use strict";e.d(R,{T:()=>i});var n=e(22803),a=e(58851);const s=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),l=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),o=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),d=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),i=c=>{const m=(0,a.hO)("angle-right");return{dropdown:(0,n.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:c.colors.background.elevated,border:"none",borderRadius:c.shape.radius.default,boxShadow:c.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:s,animationPlayState:"running"},"&-topLeft":{animationName:o,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:l,animationPlayState:"running"},"&-topLeft":{animationName:d,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:c.spacing(.5),borderRight:`1px solid ${c.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:c.spacing(4),lineHeight:c.spacing(4),padding:c.spacing(0,4,0,2),borderRadius:c.shape.radius.default,cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:c.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:c.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:c.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:c.colors.text.maxContrast,background:c.colors.background.secondary,"&:hover":{background:c.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:c.colors.text.primary,content:"''",height:c.spacing(3),mask:`url(${m})`,maskType:"luminance",position:"absolute",right:0,top:c.spacing(.5),width:c.spacing(3)}}}}}})}}},8135:(Z,R,e)=>{"use strict";e.d(R,{N:()=>s});var n=e(74848),a=e(96540);class s extends a.PureComponent{constructor(){super(...arguments),this.myRef=(0,a.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=o=>{const d=this.myRef.current;(!d||o.target instanceof Node&&!d.contains(o.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,n.jsx)("div",{ref:this.myRef,children:this.props.children})}}},47931:(Z,R,e)=>{"use strict";e.d(R,{b:()=>p});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861),i=e(30703),c=e(53371);const m=2*1e3;function p({onClipboardCopy:g,onClipboardError:y,children:v,getText:x,icon:f,variant:u,...b}){const E=(0,o.of)(r),[D,C]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let I;return D&&(I=setTimeout(()=>{C(!1)},m)),()=>{window.clearTimeout(I)}},[D]);const P=(0,s.useRef)(null),T=(0,s.useCallback)(async()=>{const I=x();try{await h(I,P),C(!0),g?.(I)}catch(j){y?.(I,j)}},[x,g,y]),O=(0,l.t)("clipboard-button.inline-toast.success","Copied");return(0,n.jsxs)(n.Fragment,{children:[D&&(0,n.jsx)(c.r,{placement:"top",referenceElement:P.current,children:O}),(0,n.jsxs)(d.$n,{onClick:T,icon:f,variant:D?"success":u,"aria-label":D?O:void 0,...b,className:(0,a.cx)(E.button,D&&E.successButton,b.className),ref:P,children:[v,D&&(0,n.jsx)("div",{className:E.successOverlay,children:(0,n.jsx)(i.I,{name:"check"})})]})]})}const h=async(g,y)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(g);{const v=document.createElement("textarea");y.current?.appendChild(v),v.value=g,v.focus(),v.select(),document.execCommand("copy"),v.remove()}},r=g=>({button:(0,a.css)({position:"relative"}),successButton:(0,a.css)({"> *":(0,a.css)({visibility:"hidden"})}),successOverlay:(0,a.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},74475:(Z,R,e)=>{"use strict";e.d(R,{M:()=>p});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(63142),i=e(35484),c=e(30703),m=e(68079);const p=({label:r,isOpen:g,onToggle:y,className:v,contentClassName:x,children:f,labelId:u,loading:b=!1,headerDataTestId:E,contentDataTestId:D,unmountContentWhenClosed:C=!0})=>{const[P,T]=(0,o.useState)(g),O=(0,d.of)(h),I=g!==void 0&&y!==void 0,j=I?g:P,W=N=>{N.target instanceof HTMLElement&&N.target.tagName==="A"||(N.preventDefault(),N.stopPropagation(),y?.(!g),I||T(!P))},{current:B}=(0,o.useRef)((0,s.uniqueId)()),S=u??`collapse-label-${B}`,w=(0,n.jsx)("div",{id:`collapse-content-${B}`,className:(0,a.cx)(O.content,x,{[O.contentHidden]:!C&&!j}),"data-testid":D,children:f});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:W,className:(0,a.cx)(O.header,v),children:[(0,n.jsx)("button",{type:"button",id:`collapse-button-${B}`,className:O.button,onClick:W,"aria-expanded":j&&!b,"aria-controls":`collapse-content-${B}`,"aria-labelledby":S,children:b?(0,n.jsx)(m.y,{className:O.spinner}):(0,n.jsx)(c.I,{name:j?"angle-up":"angle-down",className:O.icon})}),(0,n.jsx)("div",{className:O.label,id:`collapse-label-${B}`,"data-testid":E,children:r})]}),C?j&&w:w]})},h=r=>({header:(0,a.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:r.typography.size.lg,padding:`${r.spacing(.5)} 0`,"&:focus-within":(0,i.getFocusStyles)(r)}),button:(0,a.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,a.css)({color:r.colors.text.secondary}),content:(0,a.css)({padding:`${r.spacing(2)} 0`}),contentHidden:(0,a.css)({display:"none"}),spinner:(0,a.css)({display:"flex",alignItems:"center",width:r.spacing(2)}),label:(0,a.css)({display:"flex",fontWeight:r.typography.fontWeightMedium,color:r.colors.text.maxContrast})})},89599:(Z,R,e)=>{"use strict";e.d(R,{S:()=>m,a:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(45861),d=e(30703);const i=p=>({collapse:(0,a.css)({label:"collapse",marginBottom:p.spacing(1),backgroundColor:p.colors.background.primary,border:`1px solid ${p.colors.border.weak}`,position:"relative",borderRadius:p.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,a.css)({label:"collapse__body",padding:p.spacing(p.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,a.css)({label:"bodyContentWrapper",flex:1}),loader:(0,a.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:p.spacing(.5)}),loaderActive:(0,a.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:p.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,a.css)({label:"collapse__header",padding:p.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,a.css)({label:"collapse__header--collapsed",padding:p.spacing(1,2,1,2)}),headerLabel:(0,a.css)({label:"collapse__header-label",fontWeight:p.typography.fontWeightMedium,marginRight:p.spacing(1),fontSize:p.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,a.css)({label:"collapse__icon",margin:p.spacing(.25,1,0,-1)})}),c=({isOpen:p,onToggle:h,...r})=>{const[g,y]=(0,s.useState)(p);return(0,n.jsx)(m,{isOpen:g,collapsible:!0,...r,onToggle:()=>{y(!g),h&&h(!g)}})},m=({isOpen:p,label:h,loading:r,collapsible:g,onToggle:y,className:v,children:x})=>{const f=(0,l.of)(o.my),u=(0,l.of)(i),b=()=>{y&&y(!p)},E=(0,a.cx)([u.collapse,v]),D=r?(0,a.cx)([u.loader,u.loaderActive]):(0,a.cx)([u.loader]),C=g?(0,a.cx)([u.header]):(0,a.cx)([u.headerCollapsed]);return(0,n.jsxs)("div",{className:E,children:[(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(f,C),onClick:b,children:[g&&(0,n.jsx)(d.I,{className:u.icon,name:p?"angle-down":"angle-right"}),(0,n.jsx)("div",{className:(0,a.cx)([u.headerLabel]),children:h})]}),p&&(0,n.jsxs)("div",{className:(0,a.cx)([u.collapseBody]),children:[(0,n.jsx)("div",{className:D}),(0,n.jsx)("div",{className:u.bodyContentWrapper,children:x})]})]})};m.displayName="Collapse"},12173:(Z,R,e)=>{"use strict";e.d(R,{A:()=>p});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(84140),i=e(63142),c=e(63527);const m=(0,o.forwardRef)(({color:g,onChange:y,isClearable:v=!1,onClick:x,onBlur:f,disabled:u,buttonAriaLabel:b,...E},D)=>{const[C,P]=(0,o.useState)(g),[T,O]=(0,o.useState)(g),I=(0,o.useMemo)(()=>(0,s.debounce)(y,100),[]);(0,o.useEffect)(()=>{const B=(0,d.A)(g);B.isValid()&&g!==T&&(P(B.toString()),O(g))},[g,T]);const j=B=>{const{value:S}=B.currentTarget;if(P(S),S===""&&v){I(S);return}const w=(0,d.A)(S);w.isValid()&&I(w.toString())},W=B=>{(0,d.A)(C).isValid()||P(g),f?.(B)};return(0,n.jsx)(c.p,{...E,value:C,onChange:j,disabled:u,onClick:x,onBlur:W,addonBefore:(0,n.jsx)(h,{onClick:x,ariaLabel:b,disabled:u,color:g}),ref:D})});m.displayName="ColorInput";const p=m,h=({color:g,onClick:y,disabled:v,ariaLabel:x})=>{const f=(0,i.of)(r);return(0,n.jsx)("button",{type:"button",onClick:y,"aria-label":x,disabled:v||!y,className:(0,a.cx)(f,(0,a.css)({backgroundColor:g}))})},r=g=>(0,a.css)({height:"100%",width:`${g.spacing.gridSize*4}px`,borderRadius:`${g.shape.radius.default} 0 0 ${g.shape.radius.default}`,border:`1px solid ${g.colors.border.medium}`})},35427:(Z,R,e)=>{"use strict";e.d(R,{Dp:()=>y,sk:()=>g});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(65240),d=e(14226),i=e(2381),c=e(43533),m=e(89772),p=e(13409),h=e(57339);const r=(x,f="ColorPicker")=>class extends s.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,s.createRef)()}static{this.displayName=f}render(){const{theme:b,children:E,onChange:D,color:C}=this.props,P=v(b),T=s.createElement(x,{...this.props,children:null,onChange:D});return(0,n.jsx)(c.I,{content:T,hideAfter:300,children:(O,I,j)=>(0,n.jsxs)(n.Fragment,{children:[this.pickerTriggerRef.current&&(0,n.jsx)(i.A,{...j,referenceElement:this.pickerTriggerRef.current,wrapperClassName:P.colorPicker,onMouseLeave:I,onMouseEnter:O,onKeyDown:W=>(0,d.Q)(W,I)}),E?E({ref:this.pickerTriggerRef,showColorPicker:O,hideColorPicker:I}):(0,n.jsx)(p.q,{ref:this.pickerTriggerRef,onClick:O,onMouseLeave:I,color:b.visualization.getColorByName(C||"#000000"),"aria-label":C})]})})}},g=(0,l.cV)(r(m.$,"ColorPicker")),y=(0,l.cV)(r(h.o,"SeriesColorPicker")),v=(0,o.N)(x=>({colorPicker:(0,a.css)({position:"absolute",zIndex:x.zIndex.tooltip,color:x.colors.text.primary,maxWidth:"400px",fontSize:x.typography.size.sm})}))},13615:(Z,R,e)=>{"use strict";e.d(R,{i:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(7612),o=e(65229),d=e(6773),i=e(63142),c=e(8135),m=e(12173),p=e(32550);const h=(0,s.forwardRef)(({value:g="",onChange:y,returnColorAs:v="rgb",...x},f)=>{const[u,b]=(0,s.useState)(g),[E,D]=(0,s.useState)(!1),C=(0,i.$j)(),P=(0,i.of)(r),T=(0,i.of)(p.$);(0,o.A)(I=>{if(I===g)return;if(!I){y("");return}const j=C.visualization.getColorByName(I);y(v==="rgb"?d.MV.asRgbString(j):d.MV.asHexString(j))},500,[u]);const O=I=>{document.querySelector('[data-testid="color-popover"]')?.contains(I.relatedTarget)||D(!1)};return(0,n.jsx)(c.N,{onClick:()=>D(!1),children:(0,n.jsxs)("div",{className:P.wrapper,children:[E&&!x.disabled&&(0,n.jsx)(l.p9,{"data-testid":"color-popover",color:u,onChange:b,className:(0,a.cx)(T.root,P.picker)}),(0,n.jsx)(m.A,{...x,theme:C,color:u,onChange:b,buttonAriaLabel:"Open color picker",onClick:()=>D(!0),onBlur:I=>O(I),ref:f,isClearable:!0})]})})});h.displayName="ColorPickerInput";const r=g=>({wrapper:(0,a.css)({position:"relative"}),picker:(0,a.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,a.css)({position:"absolute"})})},89772:(Z,R,e)=>{"use strict";e.d(R,{$:()=>E});var n=e(74848),a=e(22803),s=e(42211),l=e(96540),o=e(6773),d=e(92745),i=e(63142),c=e(65240),m=e(60208),p=e(54314),h=e(13409),r=e(2543);const y=({hue:C,selectedColor:P,onColorSelect:T,...O})=>{const I=(0,r.upperFirst)(C.name),j=(0,i.of)(v),W=(0,l.useMemo)(()=>[...C.shades].reverse(),[C.shades]);return(0,n.jsxs)("div",{className:j.colorRow,children:[(0,n.jsx)("div",{className:j.colorLabel,children:I}),(0,n.jsx)("div",{...O,className:j.swatchRow,children:W.map(B=>(0,n.jsx)(h.q,{"aria-label":B.name,variant:B.primary?h.h.Large:h.h.Small,isSelected:B.name===P,color:B.color,onClick:()=>T(B.name)},B.name))})]})},v=C=>({colorRow:(0,a.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:C.spacing(2),padding:C.spacing(.5,0),"&:hover":{background:C.colors.background.secondary}}),colorLabel:(0,a.css)({paddingLeft:C.spacing(1),display:"flex",alignItems:"center"}),swatchRow:(0,a.css)({display:"flex",gap:C.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),x=({color:C,onChange:P})=>{const T=(0,i.$j)(),O=(0,i.of)(f),I=[];for(const j of T.visualization.hues)I.push((0,n.jsx)(y,{selectedColor:C,hue:j,onColorSelect:P},j.name));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:O.swatches,children:I}),(0,n.jsxs)("div",{className:O.extraColors,children:[(0,n.jsx)(h.q,{isSelected:C==="transparent",color:"rgba(0,0,0,0)",label:(0,d.t)("grafana-ui.named-colors-palette.transparent-swatch","Transparent"),onClick:()=>P("transparent")}),(0,n.jsx)(h.q,{isSelected:C==="text",color:T.colors.text.primary,label:(0,d.t)("grafana-ui.named-colors-palette.text-color-swatch","Text color"),onClick:()=>P("text")})]})]})},f=C=>({container:(0,a.css)({display:"flex",flexDirection:"column"}),extraColors:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:C.spacing(1),padding:C.spacing(1,0)}),swatches:(0,a.css)({display:"grid",flexGrow:1})});var u=e(32550);class b extends l.Component{constructor(P){super(P),this.handleChange=T=>{const{onChange:O,enableNamedColors:I,theme:j}=this.props;if(I)return O(T);O(o.MV.asHexString(j.visualization.getColorByName(T)))},this.onTabChange=T=>()=>this.setState({activePicker:T}),this.renderPicker=()=>{const{activePicker:T}=this.state,{color:O}=this.props;switch(T){case"spectrum":return(0,n.jsx)(u.A,{color:O,onChange:this.handleChange});case"palette":return(0,n.jsx)(x,{color:O,onChange:this.handleChange});default:return this.renderCustomPicker(T)}},this.renderCustomPicker=T=>{const{customPickers:O,color:I,theme:j}=this.props;return O?l.createElement(O[T].tabComponent,{color:I,theme:j,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:T}=this.props;return T?(0,n.jsx)(n.Fragment,{children:Object.keys(T).map(O=>(0,n.jsx)(m.o,{label:T[O].name,onChangeTab:this.onTabChange(O)},O))}):null},this.state={activePicker:"palette"}}render(){const{theme:P}=this.props,{activePicker:T}=this.state,O=D(P);return(0,n.jsx)(s.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsxs)("div",{tabIndex:-1,className:O.colorPickerPopover,children:[(0,n.jsxs)(p.U,{children:[(0,n.jsx)(m.o,{label:(0,d.t)("grafana-ui.color-picker-popover.palette-tab","Colors"),onChangeTab:this.onTabChange("palette"),active:T==="palette"}),(0,n.jsx)(m.o,{label:(0,d.t)("grafana-ui.color-picker-popover.spectrum-tab","Custom"),onChangeTab:this.onTabChange("spectrum"),active:T==="spectrum"}),this.renderCustomPickerTabs()]}),(0,n.jsx)("div",{className:O.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const E=(0,i.cV)(b);E.displayName="ColorPickerPopover";const D=(0,c.N)(C=>({colorPickerPopover:(0,a.css)({borderRadius:C.shape.radius.default,boxShadow:C.shadows.z3,background:C.colors.background.elevated,padding:C.spacing(.5),border:`1px solid ${C.colors.border.weak}`}),colorPickerPopoverContent:(0,a.css)({width:"246px",fontSize:C.typography.bodySmall.fontSize,minHeight:"184px",height:"290px",padding:C.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,a.css)({display:"flex",width:"100%",borderRadius:`${C.shape.radius.default} ${C.shape.radius.default} 0 0`})}))},13409:(Z,R,e)=>{"use strict";e.d(R,{h:()=>m,q:()=>p});var n=e(74848),a=e(22803),s=e(95382),l=e(96540),o=e(84140),d=e(51898),i=e(92745),c=e(63142),m=(r=>(r.Small="small",r.Large="large",r))(m||{});const p=l.forwardRef(({color:r,label:g,variant:y="small",isSelected:v,"aria-label":x,...f},u)=>{const b=(0,c.$j)(),{isFocusVisible:E,focusProps:D}=(0,s.o)(),C=h(b,y,r,E,v),P=!!g,T=x||g;return(0,n.jsxs)("div",{ref:u,className:C.wrapper,"data-testid":d.Tp.components.ColorSwatch.name,...f,children:[P&&(0,n.jsx)("span",{className:C.label,children:g}),(0,n.jsx)("button",{className:C.swatch,...D,"aria-label":T?(0,i.t)("grafana-ui.color-swatch.aria-label-selected-color","{{colorLabel}} color",{colorLabel:T}):(0,i.t)("grafana-ui.color-swatch.aria-label-default","Pick a color"),type:"button"})]})}),h=(r,g,y,v,x)=>{const f=(0,o.A)(y),b=g==="small"?"16px":"32px";let E="none";return f.getAlpha()<.1&&(E=`2px solid ${r.colors.border.medium}`),{wrapper:(0,a.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,a.css)({marginRight:r.spacing(1)}),swatch:(0,a.css)({width:b,height:b,background:`${y}`,border:E,borderRadius:r.shape.radius.circle,outlineOffset:"1px",outline:v?`2px solid  ${r.colors.primary.main}`:"none",boxShadow:x?`inset 0 0 0 2px ${y}, inset 0 0 0 4px ${r.colors.getContrastText(y)}`:"none",[r.transitions.handleMotion("no-preference")]:{transition:r.transitions.create(["transform"],{duration:r.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};p.displayName="ColorSwatch"},57339:(Z,R,e)=>{"use strict";e.d(R,{o:()=>i,t:()=>c});var n=e(74848),a=e(92745),s=e(63142),l=e(18027),o=e(21285),d=e(89772);const i=m=>{const{yaxis:p,onToggleAxis:h,color:r,...g}=m,y=(0,a.t)("grafana-ui.series-color-picker-popover.y-axis-usage","Use right y-axis"),v=h?{yaxis:{name:"Y-Axis",tabComponent(){return(0,n.jsx)(l.I,{labelWidth:20,label:y,children:(0,n.jsx)(o.K,{value:p===2,label:y,onChange:h})})}}}:void 0;return(0,n.jsx)(d.$,{...g,color:r||"#000000",customPickers:v})},c=(0,s.cV)(i)},32550:(Z,R,e)=>{"use strict";e.d(R,{$:()=>h,A:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(7612),o=e(65229),d=e(84140),i=e(6773),c=e(63142),m=e(12173);const p=({color:g,onChange:y})=>{const[v,x]=(0,s.useState)(g);(0,o.A)(E=>{y(i.MV.asHexString(f.visualization.getColorByName(E)))},500,[v]);const f=(0,c.$j)(),u=(0,c.of)(h),b=(0,s.useMemo)(()=>v.startsWith("rgba")?v:(0,d.A)(f.visualization.getColorByName(g)).toRgbString(),[v,f,g]);return(0,n.jsxs)("div",{className:u.wrapper,children:[(0,n.jsx)(l.p9,{className:u.root,color:b,onChange:x}),(0,n.jsx)(m.A,{theme:f,color:b,onChange:x,className:u.colorInput})]})},h=g=>({wrapper:(0,a.css)({flexGrow:1}),root:(0,a.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${g.shape.radius.default} ${g.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${g.shape.radius.default} ${g.shape.radius.default}`},"&__alpha, &__hue":{height:g.spacing(2),position:"relative"},"&__pointer":{height:g.spacing(2),width:g.spacing(2)}}}),colorInput:(0,a.css)({marginTop:g.spacing(2)})}),r=p},43243:(Z,R,e)=>{"use strict";e.d(R,{G:()=>D});var n=e(74848),a=e(22803),s=e(72181),l=e(31033),o=e(96540),d=e(92745),i=e(63142),c=e(30703),m=e(33033),p=e(63527),h=e(15245),r=e(70733),g=e(92842),y=e(74440),v=e(98869),x=e(75168),f=e(5320),u=e(93521);const b=()=>{},E=4,D=C=>{const{options:P,onChange:T,value:O,placeholder:I,isClearable:j,createCustomValue:W=!1,id:B,width:S,minWidth:w,maxWidth:N,"aria-labelledby":M,"data-testid":L,autoFocus:A,onBlur:U,disabled:F,invalid:V}=C,K=typeof O=="object"?O?.value:O,G=(0,o.useId)().replace(/:/g,"--"),{options:H,groupStartIndices:_,updateOptions:k,asyncLoading:J,asyncError:z}=(0,f.I)(C.options,W),Y=typeof P=="function",X=(0,o.useMemo)(()=>{if(Y||O==null)return null;const Ae=P.findIndex(Ue=>Ue.value===K);return Ae===-1?null:Ae},[O,P,K,Y]),Q=(0,o.useMemo)(()=>O==null?null:X!==null&&!Y?P[X]:typeof O=="object"?O:{value:O,label:O.toString()},[X,Y,O,P]),q=`${G}-downshift-menu`,te=`${G}-downshift-label`,ne=(0,i.of)(v.C3),se=(0,o.useCallback)(Ae=>{const Ue=Math.max(0,Ae.startIndex-Ae.overscan),Be=Math.min(H.length-1,Ae.endIndex+Ae.overscan),We=Array.from({length:Be-Ue+1},(Xe,le)=>Ue+le),_e=H[We[0]];if(_e?.group){const Xe=_.get(_e.group);Xe!==void 0&&Xe<We[0]&&We.unshift(Xe)}return We},[H,_]),ue=(0,s.Te)({count:H.length,getScrollElement:()=>Te.current,estimateSize:Ae=>{const Ue=(0,u.S)(H[Ae],Ae>0?H[Ae-1]:void 0),Be="description"in H[Ae],We="group"in H[Ae];let _e=v.Aj;return Be&&(_e=v.pg),Ue&&We&&(_e+=v.Aj),_e},overscan:E,rangeExtractor:se}),{isOpen:de,highlightedIndex:ie,getInputProps:he,getMenuProps:me,getItemProps:ce,selectItem:Pe}=(0,l.Bp)({menuId:q,labelId:te,inputId:B,items:H,itemToString:y.y,selectedItem:Q,onSelectedItemChange:({selectedItem:Ae})=>{(j||Ae!==null)&&T(Ae)},defaultHighlightedIndex:X??0,scrollIntoView:()=>{},onIsOpenChange:({isOpen:Ae,inputValue:Ue})=>{Ae&&Ue===""&&k(Ue)},onHighlightedIndexChange:({highlightedIndex:Ae,type:Ue})=>{Ue!==l.Bp.stateChangeTypes.MenuMouseLeave&&ue.scrollToIndex(Ae)},onStateChange:({inputValue:Ae,type:Ue,selectedItem:Be})=>{switch(Ue){case l.Bp.stateChangeTypes.InputChange:k(Ae??"");break;default:break}},stateReducer(Ae,Ue){let{changes:Be}=Ue;const We=Ae.isOpen===!1&&Be.isOpen===!0,_e=Ae.isOpen===!0&&Be.isOpen===!1;return We&&Be.inputValue===Ae.inputValue&&(Be={...Be,inputValue:""}),_e&&(Be.selectedItem?Be={...Be,inputValue:(0,y.y)(Be.selectedItem)}:Be.inputValue!==""&&(Be={...Be,inputValue:""})),Be}}),{inputRef:Ie,floatingRef:Se,floatStyles:Me,scrollRef:Te}=(0,x.l)(H,de),Ge=S==="auto",Qe=Ge?m.D:p.p,tt=(de?(0,y.y)(Q):null)||I,ke=C.loading||J,He=(0,n.jsxs)(n.Fragment,{children:[K!==void 0&&K===Q?.value&&j&&(0,n.jsx)(c.I,{name:"times",className:ne.clear,title:(0,d.t)("combobox.clear.title","Clear value"),tabIndex:0,role:"button",onClick:()=>{Pe(null)},onKeyDown:Ae=>{(Ae.key==="Enter"||Ae.key===" ")&&Pe(null)}}),(0,n.jsx)(g.f,{isLoading:ke||!1,isOpen:de})]}),{Wrapper:Re,wrapperProps:Ne}=Ge?{Wrapper:"div",wrapperProps:{className:ne.adaptToParent}}:{Wrapper:o.Fragment};return(0,n.jsxs)(Re,{...Ne,children:[(0,n.jsx)(Qe,{width:Ge?void 0:S,...Ge?{minWidth:w,maxWidth:N}:{},autoFocus:A,onBlur:U,disabled:F,invalid:V,className:ne.input,suffix:He,...he({ref:Ie,onChange:b,"aria-labelledby":M,placeholder:tt,"data-testid":L})}),(0,n.jsx)(h.ZL,{children:(0,n.jsx)("div",{className:(0,a.cx)(ne.menu,!de&&ne.menuClosed),style:Me,...me({ref:Se,"aria-labelledby":M}),children:de&&(0,n.jsx)(r.e,{options:H,highlightedIndex:ie,selectedItems:Q?[Q]:[],scrollRef:Te,getItemProps:ce,error:z})})})]})}},70733:(Z,R,e)=>{"use strict";e.d(R,{e:()=>E});var n=e(74848),a=e(22803),s=e(72181),l=e(96540),o=e(63142),d=e(32635),i=e(92807),c=e(92745),m=e(30703),p=e(31286),h=e(41654),r=e(66404);const g=()=>(0,n.jsxs)(v,{children:[(0,n.jsx)(r.E,{color:"warning",children:(0,n.jsx)(m.I,{name:"exclamation-triangle",size:"md"})}),(0,n.jsx)(c.x6,{i18nKey:"combobox.async.error",children:"An error occurred while loading options."})]}),y=()=>(0,n.jsx)(v,{children:(0,n.jsx)(c.x6,{i18nKey:"combobox.options.no-found",children:"No options found."})}),v=({children:D})=>(0,n.jsx)(p.a,{padding:2,children:(0,n.jsx)(h.B,{justifyContent:"center",alignItems:"center",direction:"column",children:D})});var x=e(98869),f=e(33605),u=e(93521);const b=4,E=({options:D,highlightedIndex:C,selectedItems:P=[],scrollRef:T,getItemProps:O,enableAllOption:I,isMultiSelect:j=!1,error:W=!1})=>{const B=(0,o.of)(x.C3),S=(0,l.useCallback)(L=>{const A=(0,u.S)(D[L],L>0?D[L-1]:void 0),U="description"in D[L],F="group"in D[L];let V=x.Aj;return U&&(V=x.pg),A&&F&&(V+=x.Aj),V},[D]),w=(0,s.Te)({count:D.length,getScrollElement:()=>T.current,estimateSize:S,overscan:b}),N=(0,l.useCallback)(L=>P.some(A=>A.value===L.value),[P]),M=I&&P.length===D.length-1;return(0,n.jsxs)(i.P,{showScrollIndicators:!0,maxHeight:"inherit",ref:T,padding:.5,children:[(0,n.jsx)("div",{style:{height:w.getTotalSize()},className:B.menuUlContainer,children:w.getVirtualItems().map((L,A,U)=>{const F=D[L.index],V=(0,u.S)(F,D[L.index-1]),K=U.find(k=>D[k.index].group===F.group),G=K&&D[K.index],H=`combobox-option-${F.value}`,_=G?`combobox-option-group-${G.value}`:void 0;return(0,n.jsxs)("div",{className:B.listItem,style:{height:L.size,transform:`translateY(${L.start}px)`},children:[V&&(0,n.jsx)("div",{role:"presentation","data-testid":"combobox-option-group",id:_,className:(0,a.cx)(B.optionGroupHeader,F.group&&B.optionGroupLabel,L.index===0&&B.optionFirstGroupHeader),children:F.group}),(0,n.jsxs)("div",{className:(0,a.cx)(B.option,!j&&N(F)&&B.optionSelected,C===L.index&&B.optionFocused),...O({item:F,index:L.index,id:H,"aria-describedby":_}),children:[j&&(0,n.jsx)("div",{className:B.optionAccessory,children:(0,n.jsx)(d.S,{value:M||N(F),indeterminate:F.value===f.A&&P.length>0&&!M,"aria-labelledby":H,onClick:k=>{k.stopPropagation()}},H)}),(0,n.jsxs)("div",{className:B.optionBody,children:[(0,n.jsx)("div",{className:B.optionLabel,children:F.label??F.value}),F.description&&(0,n.jsx)("div",{className:B.optionDescription,children:F.description})]})]})]},F.value)})}),(0,n.jsxs)("div",{"aria-live":"polite",children:[W&&(0,n.jsx)(g,{}),D.length===0&&!W&&(0,n.jsx)(y,{})]})]})}},92842:(Z,R,e)=>{"use strict";e.d(R,{f:()=>s});var n=e(74848),a=e(30703);const s=({isLoading:l,isOpen:o})=>{const d=l?"spinner":o?"search":"angle-down";return(0,n.jsx)(a.I,{name:d})}},74440:(Z,R,e)=>{"use strict";e.d(R,{o:()=>s,y:()=>a});var n=e(99885);function a(l){return l==null?"":l.label??l.value.toString()}function s(l,o,d){return(0,n.X)(o,d).map(c=>l[c])}},98869:(Z,R,e)=>{"use strict";e.d(R,{AK:()=>o,Aj:()=>c,C3:()=>h,pg:()=>m,sh:()=>a,xB:()=>p,zx:()=>l});var n=e(22803);const a=14,s=12,l=500,o=8,d=2,i=1.5,c=d+o*2+a*i,m=c+s*i,p=c*8.5,h=r=>({menuClosed:(0,n.css)({display:"none"}),menu:(0,n.css)({label:"combobox-menu",background:r.components.dropdown.background,boxShadow:r.shadows.z3,zIndex:r.zIndex.dropdown,position:"relative",borderRadius:r.shape.radius.default,overflow:"hidden"}),menuUlContainer:(0,n.css)({label:"combobox-menu-ul-container",listStyle:"none"}),listItem:(0,n.css)({label:"list-item",position:"absolute",width:"100%"}),optionGroupHeader:(0,n.css)({label:"combobox-new-option-group",borderTop:`1px solid ${r.colors.border.weak}`}),optionFirstGroupHeader:(0,n.css)({borderTop:"none"}),optionGroupLabel:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",letterSpacing:0,color:r.colors.text.secondary,fontSize:r.typography.bodySmall.fontSize,fontWeight:r.typography.fontWeightLight,padding:o}),option:(0,n.css)({label:"combobox-option",position:"relative",display:"flex",width:"100%",gap:r.spacing(1),alignItems:"center",padding:o,marginBottom:d,borderRadius:r.shape.radius.default,fontWeight:r.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",cursor:"pointer","&:hover":{background:r.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}}),optionAccessory:(0,n.css)({label:"combobox-option-accessory",height:a*i}),optionBody:(0,n.css)({label:"combobox-option-body",display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"}),optionLabel:(0,n.css)({label:"combobox-option-label",fontSize:a,fontWeight:l,lineHeight:i,letterSpacing:0,textOverflow:"ellipsis",overflow:"hidden"}),optionDescription:(0,n.css)({label:"combobox-option-description",color:r.colors.text.secondary,fontSize:s,fontWeight:r.typography.fontWeightRegular,lineHeight:i,letterSpacing:0,textOverflow:"ellipsis",overflow:"hidden"}),optionFocused:(0,n.css)({label:"combobox-option-focused",background:r.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}),optionSelected:(0,n.css)({background:r.colors.action.selected,"&::before":{backgroundImage:r.colors.gradients.brandVertical,borderRadius:r.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:r.spacing(.5),left:0,top:0}}),clear:(0,n.css)({label:"combobox-clear",cursor:"pointer",pointerEvents:"auto","&:hover":{color:r.colors.text.primary}}),input:(0,n.css)({label:"combobox-input","> div > div:last-child":{pointerEvents:"none"},"& input":{cursor:"pointer"},"& input:focus":{cursor:"text"}}),adaptToParent:(0,n.css)({label:"combobox-adapt-to-parent",maxWidth:"100%",'[class*="input-wrapper-combobox-input"]':{maxWidth:"100%"}})})},33605:(Z,R,e)=>{"use strict";e.d(R,{A:()=>n});const n="__GRAFANA_INTERNAL_MULTICOMBOBOX_ALL_OPTION__"},75168:(Z,R,e)=>{"use strict";e.d(R,{l:()=>p});var n=e(34743),a=e(83505),s=e(46885),l=e(96540),o=e(53568),d=e(98869);const i=1e5,c=16,m=8,p=(r,g)=>{const y=(0,l.useRef)(null),v=(0,l.useRef)(null),x=(0,l.useRef)(null),[f,u]=(0,l.useState)({width:0,height:0}),b=(0,l.useMemo)(()=>h(),[]),E=[(0,n.RK)({allowedPlacements:["bottom-start","bottom-end","top-start","top-end"],boundary:document.body,crossAxis:!0}),(0,n.Ej)({apply({availableWidth:O,availableHeight:I}){const j=O-c,W=I-c,B=Math.max(j,0),S=Math.min(Math.max(W,d.Aj*6),d.xB);u({width:B,height:S})}})],D={reference:y.current,floating:v.current},{floatingStyles:C}=(0,a.we)({strategy:"fixed",open:g,placement:"bottom-start",middleware:E,elements:D,whileElementsMounted:s.ll}),P=(0,l.useMemo)(()=>{let O="";const I=Math.min(r.length,i);for(let W=0;W<I;W++){const B=r[W].label??r[W].value.toString();O=B.length>O.length?B:O}return(0,o.kD)(O,d.sh,d.zx).width+m+d.AK*2+b},[r,b]),T={...C,width:P,maxWidth:f.width,minWidth:y.current?.offsetWidth,maxHeight:f.height};return{inputRef:y,floatingRef:v,scrollRef:x,floatStyles:T}};function h(){const r=document.createElement("div");r.style.visibility="hidden",r.style.overflow="scroll",document.body.appendChild(r);const g=document.createElement("div");r.appendChild(g);const y=r.offsetWidth-g.offsetWidth;return r.parentNode?.removeChild(r),y}},5320:(Z,R,e)=>{"use strict";e.d(R,{I:()=>c});var n=e(2543),a=e(96540),s=e(92745),l=e(74440);function o(p){const h=(0,a.useRef)(0);return(0,a.useCallback)(g=>{h.current++;const y=h.current;return new Promise((v,x)=>{p(g).then(f=>{y===h.current?v(f):x(new d)}).catch(x)})},[p])}class d extends Error{constructor(){super("This result is stale and is discarded"),this.name="StaleResultError",Object.setPrototypeOf(this,new.target.prototype)}}const i=()=>Promise.resolve([]);function c(p,h){const r=typeof p=="function",g=o(r?p:i),y=(0,a.useMemo)(()=>(0,n.debounce)(B=>g(B).then(S=>{x(S),u(!1),E(!1)}).catch(S=>{S instanceof d||(E(!0),u(!1),S&&console.error("Error loading async options for Combobox",S))}),200),[g]),[v,x]=(0,a.useState)([]),[f,u]=(0,a.useState)(!1),[b,E]=(0,a.useState)(!1),[D,C]=(0,a.useState)(""),P=(0,a.useCallback)(B=>{let S=B;return h&&D&&(B.some(N=>N.value===D)||(S=S.slice(),S.unshift({label:D,value:D,description:(0,s.t)("combobox.custom-value.description","Use custom value")}))),S},[h,D]),T=(0,a.useCallback)(B=>{C(B),r&&(u(!0),y(B))},[y,r]),O=(0,a.useMemo)(()=>r?[]:p.map(l.y),[r,p]),I=(0,a.useMemo)(()=>r?v:(0,l.o)(p,O,D),[v,r,p,O,D]),[j,W]=(0,a.useMemo)(()=>{const{options:B,groupStartIndices:S}=m(I);return[P(B),S]},[I,P]);return{options:j,groupStartIndices:W,updateOptions:T,asyncLoading:f,asyncError:b}}function m(p){const h=new Map,r=new Map;for(const v of p){const x=v.group,f=h.get(x);f?f.push(v):h.set(x,[v])}if(h.size<=1)return p[0]?.group&&r.set(p[0]?.group,0),{options:p,groupStartIndices:r};const g=new Array(p.length);let y=0;for(const[v,x]of h){v&&r.set(v,y);for(const f of x)g[y++]=f}return{options:g,groupStartIndices:r}}},93521:(Z,R,e)=>{"use strict";e.d(R,{S:()=>n});const n=(a,s)=>{const l=a.group;return l?s?s.group!==l:!0:!!s?.group}},7075:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>i});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861);const i=({children:m,className:p,closeOnConfirm:h,confirmText:r="Save",confirmVariant:g="primary",disabled:y=!1,onCancel:v,onClick:x,onConfirm:f,size:u="md"})=>{const b=(0,s.useRef)(null),E=(0,s.useRef)(null),[D,C]=(0,s.useState)(!1),[P,T]=(0,s.useState)(!1),O=(0,o.of)(c);(0,s.useEffect)(()=>{D?(E.current?.focus(),T(!0)):P&&(b.current?.focus(),T(!1))},[P,D]);const I=N=>{N&&N.preventDefault(),C(!0),x?.()},j=N=>{N&&N.preventDefault(),C(!1),b.current?.focus(),v?.()},W=N=>{N&&N.preventDefault(),f?.(),h&&C(!1)},B=(0,a.cx)(p,O.mainButton,{[O.mainButtonHide]:D}),S=(0,a.cx)(O.confirmButton,{[O.confirmButtonHide]:!D}),w=(0,a.cx)(O.confirmButtonContainer,{[O.confirmButtonContainerHide]:!D});return(0,n.jsxs)("div",{className:O.container,children:[(0,n.jsx)("span",{className:B,children:typeof m=="string"?(0,n.jsx)(d.$n,{disabled:y,size:u,fill:"text",onClick:I,ref:b,children:m}):s.cloneElement(m,{disabled:y,onClick:I,ref:b})}),(0,n.jsx)("div",{className:w,children:(0,n.jsxs)("span",{className:S,children:[(0,n.jsx)(d.$n,{size:u,variant:g,onClick:W,ref:E,children:r}),(0,n.jsx)(d.$n,{size:u,fill:"text",onClick:j,children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.confirm-button.cancel",children:"Cancel"})})]})})]})};i.displayName="ConfirmButton";const c=m=>({container:(0,a.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,a.css)({opacity:1,[m.transitions.handleMotion("no-preference")]:{transition:m.transitions.create(["opacity"],{duration:m.transitions.duration.shortest,easing:m.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,a.css)({opacity:0,[m.transitions.handleMotion("no-preference")]:{transition:m.transitions.create(["opacity","visibility"],{duration:m.transitions.duration.shortest,easing:m.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,a.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,a.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,a.css)({alignItems:"flex-start",background:m.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[m.transitions.handleMotion("no-preference")]:{transition:m.transitions.create(["opacity","transform"],{duration:m.transitions.duration.shortest,easing:m.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,a.css)({opacity:0,transform:"translateX(100%)",[m.transitions.handleMotion("no-preference")]:{transition:m.transitions.create(["opacity","transform","visibility"],{duration:m.transitions.duration.shortest,easing:m.transitions.easing.easeIn})},visibility:"hidden"})})},44458:(Z,R,e)=>{"use strict";e.d(R,{e:()=>o});var n=e(74848),a=e(92745),s=e(45861),l=e(7075);const o=({size:d,disabled:i,onConfirm:c,"aria-label":m,closeOnConfirm:p})=>(0,n.jsx)(l.Z,{confirmText:(0,a.t)("grafana-ui.confirm-button.confirmText-delete","Delete"),confirmVariant:"destructive",size:d||"md",disabled:i,onConfirm:c,closeOnConfirm:p,children:(0,n.jsx)(s.$n,{"aria-label":m,variant:"destructive",icon:"times",size:d||"sm"})})},70735:(Z,R,e)=>{"use strict";e.d(R,{k:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(49785),o=e(51898),d=e(92745),i=e(63142),c=e(45861),m=e(37386),p=e(63527),h=e(41654);const r=({body:y,confirmPromptText:v,confirmButtonLabel:x,confirmButtonVariant:f,dismissButtonVariant:u,dismissButtonLabel:b,onConfirm:E,onDismiss:D,onAlternative:C,alternativeButtonLabel:P,description:T,justifyButtons:O="flex-end",disabled:I})=>{const[j,W]=(0,s.useState)(I),B=(0,i.of)(g),S=(0,s.useRef)(null),w=A=>{W(v?.toLowerCase().localeCompare(A.currentTarget.value.toLowerCase())!==0)};(0,s.useEffect)(()=>{S.current?.focus()},[]),(0,s.useEffect)(()=>{W(I?!0:!!v)},[v,I]);const N=async()=>{I===void 0&&W(!0);try{await E()}finally{I===void 0&&W(!1)}},{handleSubmit:M}=(0,l.mN)(),L=(0,d.t)("grafana-ui.confirm-content.placeholder",'Type "{{confirmPromptText}}" to confirm',{confirmPromptText:v});return(0,n.jsxs)("form",{onSubmit:M(N),children:[(0,n.jsxs)("div",{className:B.text,children:[y,T?(0,n.jsx)("div",{className:B.description,children:T}):null,v?(0,n.jsx)("div",{className:B.confirmationInput,children:(0,n.jsx)(h.B,{alignItems:"flex-start",children:(0,n.jsx)(m.D,{disabled:I,children:(0,n.jsx)(p.p,{placeholder:L,onChange:w})})})}):null]}),(0,n.jsx)("div",{className:B.buttonsContainer,children:(0,n.jsxs)(h.B,{justifyContent:O,gap:2,wrap:"wrap",children:[(0,n.jsx)(c.$n,{variant:u,onClick:D,fill:"outline",children:b}),(0,n.jsx)(c.$n,{type:"submit",variant:f,disabled:j,ref:S,"data-testid":o.Tp.pages.ConfirmModal.delete,children:x}),C?(0,n.jsx)(c.$n,{variant:"primary",onClick:C,children:P}):null]})})]})},g=y=>({text:(0,a.css)({fontSize:y.typography.h5.fontSize,color:y.colors.text.primary}),description:(0,a.css)({fontSize:y.typography.body.fontSize}),confirmationInput:(0,a.css)({paddingTop:y.spacing(1)}),buttonsContainer:(0,a.css)({paddingTop:y.spacing(3)})})},71599:(Z,R,e)=>{"use strict";e.d(R,{u:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(22787),o=e(70735);const d=({isOpen:c,title:m,body:p,description:h,confirmText:r,confirmVariant:g="destructive",confirmationText:y,dismissText:v="Cancel",dismissVariant:x="secondary",alternativeText:f,modalClass:u,icon:b="exclamation-triangle",onConfirm:E,onDismiss:D,onAlternative:C,confirmButtonVariant:P="destructive",disabled:T})=>{const O=(0,s.of)(i);return(0,n.jsx)(l.a,{className:(0,a.cx)(O.modal,u),title:m,icon:b,isOpen:c,onDismiss:D,children:(0,n.jsx)(o.k,{body:p,description:h,confirmButtonLabel:r,dismissButtonLabel:v,dismissButtonVariant:x,confirmPromptText:y,alternativeButtonLabel:f,confirmButtonVariant:P,onConfirm:E,onDismiss:D,onAlternative:C,disabled:T})})},i=()=>({modal:(0,a.css)({width:"500px"})})},97375:(Z,R,e)=>{"use strict";e.d(R,{t:()=>i});var n=e(74848),a=e(96540),s=e(29647),l=e(51898),o=e(87063),d=e(15245);const i=a.memo(({x:c,y:m,onClose:p,focusOnOpen:h=!0,renderMenuItems:r,renderHeader:g})=>{const y=(0,a.useRef)(null),[v,x]=(0,a.useState)({});(0,a.useLayoutEffect)(()=>{const D=y.current;if(D){const C=D.getBoundingClientRect(),P=5,T={right:window.innerWidth<c+C.width,bottom:window.innerHeight<m+C.height+P};x({position:"fixed",left:T.right?c-C.width-P:c-P,top:Math.max(0,T.bottom?m-C.height-P:m+P)})}},[c,m]),(0,s.A)(y,()=>{p?.()});const f=g?.(),u=r?.(),b=D=>{h&&D(0)},E=D=>{D.key==="Escape"&&(D.preventDefault(),D.stopPropagation(),p?.())};return(0,n.jsx)(d.ZL,{children:(0,n.jsx)(o.W,{header:f,ref:y,style:v,ariaLabel:l.Tp.components.Menu.MenuComponent("Context"),onOpen:b,onClick:p,onKeyDown:E,children:u})})});i.displayName="ContextMenu"},41479:(Z,R,e)=>{"use strict";e.d(R,{n:()=>l});var n=e(74848),a=e(96540),s=e(97375);const l=({children:o,renderMenuItems:d,focusOnOpen:i=!0})=>{const[c,m]=(0,a.useState)(!1),[p,h]=(0,a.useState)({x:0,y:0});return(0,n.jsxs)(n.Fragment,{children:[o({openMenu:r=>{m(!0),h({x:r.pageX,y:r.pageY-window.scrollY})}}),c&&(0,n.jsx)(s.t,{onClose:()=>m(!1),x:p.x,y:p.y,renderMenuItems:d,focusOnOpen:i})]})}},52718:(Z,R,e)=>{"use strict";e.d(R,{E:()=>c,A:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(62295),o=e(63142);const d=({children:r})=>{const[g,y]=(0,s.useState)(!1),[v,x]=(0,s.useState)(!1),f=(0,s.useRef)(null),u=(0,s.useRef)(null),b=(0,o.of)(i);return(0,s.useEffect)(()=>{const E=new IntersectionObserver(D=>{D.forEach(C=>{C.target===f.current?y(!C.isIntersecting):C.target===u.current&&x(!C.isIntersecting)})});return[f,u].forEach(D=>{D.current&&E.observe(D.current)}),()=>E.disconnect()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,a.cx)(b.scrollIndicator,b.scrollTopIndicator,{[b.scrollIndicatorVisible]:g})}),(0,n.jsxs)("div",{className:b.scrollContent,children:[(0,n.jsx)("div",{ref:f}),r,(0,n.jsx)("div",{ref:u})]}),(0,n.jsx)("div",{className:(0,a.cx)(b.scrollIndicator,b.scrollBottomIndicator,{[b.scrollIndicatorVisible]:v})})]})},i=r=>({scrollContent:(0,a.css)({flex:1,position:"relative"}),scrollIndicator:(0,a.css)({height:r.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[r.transitions.handleMotion("no-preference","reduce")]:{transition:r.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,a.css)({background:`linear-gradient(0deg, transparent, ${r.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,a.css)({background:`linear-gradient(180deg, transparent, ${r.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,a.css)({opacity:1})}),c=({autoHide:r=!1,autoHideTimeout:g=200,setScrollTop:y,className:v,testId:x,autoHeightMin:f="0",autoHeightMax:u="100%",hideTracksWhenNotNeeded:b=!1,hideHorizontalTrack:E,hideVerticalTrack:D,scrollRefCallback:C,showScrollIndicators:P=!1,updateAfterMountMs:T,scrollTop:O,onScroll:I,children:j,divId:W})=>{const B=(0,s.useRef)(null),S=(0,o.of)(p);(0,s.useEffect)(()=>{B.current&&C&&C(B.current.view)},[B,C]),h(B.current,O),(0,s.useEffect)(()=>{T&&setTimeout(()=>{const V=B.current;V?.update&&V.update()},T)},[T]);function w(V,K,G){return G.style&&K&&(G.style.display="none"),(0,n.jsx)("div",{...G,className:V})}const N=(0,s.useCallback)(V=>w("track-horizontal",E,V),[E]),M=(0,s.useCallback)(V=>w("track-vertical",D,V),[D]),L=(0,s.useCallback)(V=>(0,n.jsx)("div",{...V,className:"thumb-horizontal"}),[]),A=(0,s.useCallback)(V=>(0,n.jsx)("div",{...V,className:"thumb-vertical"}),[]),U=(0,s.useCallback)(V=>(V.style&&V.style.WebkitOverflowScrolling==="touch"&&(V.style.WebkitOverflowScrolling="auto"),(0,n.jsx)("div",{...V,className:"scrollbar-view",id:W})),[W]),F=(0,s.useCallback)(()=>{B.current&&y&&y(B.current.getValues())},[y]);return(0,n.jsx)(l.Ay,{"data-testid":x,ref:B,className:(0,a.cx)(S.customScrollbar,v,{[S.scrollbarWithScrollIndicators]:P}),onScrollStop:F,autoHeight:!0,autoHide:r,autoHideTimeout:g,hideTracksWhenNotNeeded:b,autoHeightMax:u,autoHeightMin:f,renderTrackHorizontal:N,renderTrackVertical:M,renderThumbHorizontal:L,renderThumbVertical:A,renderView:U,onScroll:I,children:P?(0,n.jsx)(d,{children:j}):j})},m=c,p=r=>({customScrollbar:(0,a.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:r.shape.borderRadius(2),width:`${r.spacing(1)} !important`,right:0,bottom:r.spacing(.25),top:r.spacing(.25)},".track-horizontal":{borderRadius:r.shape.borderRadius(2),height:`${r.spacing(1)} !important`,right:r.spacing(.25),bottom:r.spacing(.25),left:r.spacing(.25)},".thumb-vertical":{background:r.colors.action.focus,borderRadius:r.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:r.colors.action.focus,borderRadius:r.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,a.css)({".scrollbar-view":{position:"static !important"}})});function h(r,g){(0,s.useEffect)(()=>{r&&g!=null&&r.scrollTop(g)},[g,r])}},28134:(Z,R,e)=>{"use strict";e.d(R,{R:()=>s});var n=e(74848),a=e(45861);function s({link:l,buttonProps:o}){return(0,n.jsx)("a",{href:l.href,target:l.target,rel:"noreferrer",onClick:l.onClick?d=>{!(d.ctrlKey||d.metaKey||d.shiftKey)&&l.onClick&&(d.preventDefault(),l.onClick(d))}:void 0,children:(0,n.jsx)(a.$n,{icon:l.target==="_blank"?"external-link-alt":"link",variant:"primary",size:"sm",...o,children:l.title})})}},81917:(Z,R,e)=>{"use strict";e.d(R,{l:()=>I});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(28848),i=e.n(d),c=e(96540),m=e(84596),p=e(52845),h=e(29317),r=e(79609),g=e(38036),y=e(56103),v=e(63142),x=e(35458),f=e(63527),u=e(15245),b=e(92807),E=e(81563);class D{getBoundingClientRect(){const B=window.getSelection(),S=B&&B.anchorNode;return S&&S.parentElement?S.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const C=(W,B)=>W-B*Math.floor(W/B),P={builtInVariable:{pattern:/(\${\S+?})/}},T=[(0,y.D)({onlyIn:W=>"type"in W&&W.type==="code_block",getSyntax:()=>"links"},{...i().languages,links:P})],O=W=>({input:(0,f.n)({theme:W,invalid:!1}).input,editor:(0,a.css)({".token.builtInVariable":{color:W.colors.success.text},".token.variable":{color:W.colors.primary.text}}),suggestionsWrapper:(0,a.css)({boxShadow:W.shadows.z2}),wrapperOverrides:(0,a.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),I=(0,c.memo)(({value:W,onChange:B,suggestions:S,placeholder:w="http://your-grafana.com/d/000000010/annotations"})=>{const N=(0,c.useRef)(null),M=(0,v.of)(O),[L,A]=(0,c.useState)(!1),[U,F]=(0,c.useState)(0),[V,K]=(0,c.useState)((0,x.mO)(W)),G=(0,m.A)(V),[H,_]=(0,c.useState)(0),k=(0,c.useRef)(null);(0,c.useEffect)(()=>{k.current?.scrollTo(0,H)},[H]);const J=[(0,s.cY)(({rects:ue})=>({alignmentAxis:ue.reference.width})),(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:z,floatingStyles:Y}=(0,l.we)({open:L,placement:"bottom-start",onOpenChange:A,middleware:J,whileElementsMounted:o.ll,strategy:"fixed"}),X=(0,c.useRef)({showingSuggestions:L,suggestions:S,suggestionsIndex:U,linkUrl:V,onChange:B});X.current={showingSuggestions:L,suggestions:S,suggestionsIndex:U,linkUrl:V,onChange:B};const Q=(0,c.useRef)(null);(0,c.useEffect)(()=>{_(j(Q.current,U))},[U]);const q=c.useCallback((ue,de)=>{if(!X.current.showingSuggestions){if(ue.key==="="||ue.key==="$"||ue.keyCode===32&&ue.ctrlKey){const ie=new D;return z.setReference(ie),A(!0)}return de()}switch(ue.key){case"Backspace":X.current.linkUrl.focusText.getText().length===1&&de();case"Escape":return A(!1),F(0);case"Enter":return ue.preventDefault(),ne(X.current.suggestions[X.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ue.preventDefault();const ie=ue.key==="ArrowDown"?1:-1;return F(he=>C(he+ie,X.current.suggestions.length));default:return de()}},[]);(0,c.useEffect)(()=>{G&&G.selection.isFocused&&!V.selection.isFocused&&X.current.onChange(p.default.serialize(V))},[V,G]);const te=c.useCallback(({value:ue})=>{K(ue)},[]),ne=(ue,de=N.current)=>{const he=se()==="$";ue.origin!==r.$0.Template||ue.value===g.c.includeVars?de.insertText(`${he?"":"$"}{${ue.value}}`):de.insertText(`${he?"":"$"}{${ue.value}:queryparam}`),K(de.value),A(!1),F(0),X.current.onChange(p.default.serialize(de.value))},se=()=>{const ue=document.getElementById("data-link-input");let de="",ie,he;return window.getSelection&&(ie=window.getSelection(),ie&&ie.rangeCount>0&&(he=ie.getRangeAt(0).cloneRange(),he.collapse(!0),he.setStart(ue,0),de=he.toString().slice(-1))),de};return(0,n.jsx)("div",{className:M.wrapperOverrides,children:(0,n.jsx)("div",{className:"slate-query-field__wrapper",children:(0,n.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[L&&(0,n.jsx)(u.ZL,{children:(0,n.jsx)("div",{ref:z.setFloating,style:Y,children:(0,n.jsx)(b.P,{maxHeight:"300px",ref:k,onScroll:ue=>_(ue.currentTarget.scrollTop),children:(0,n.jsx)(E.k,{activeRef:Q,suggestions:X.current.suggestions,onSuggestionSelect:ne,onClose:()=>A(!1),activeIndex:U})})})}),(0,n.jsx)(h.Editor,{schema:x.yx,ref:N,placeholder:w,value:X.current.linkUrl,onChange:te,onKeyDown:(ue,de,ie)=>q(ue,ie),plugins:T,className:(0,a.cx)(M.editor,M.input,(0,a.css)({padding:"3px 8px"}))})]})})})});I.displayName="DataLinkInput";function j(W,B){return(W?.clientHeight??0)*B}},81563:(Z,R,e)=>{"use strict";e.d(R,{k:()=>p});var n=e(74848),a=e(96540),s=e(22803),l=e(2543),o=e.n(l),d=e(29647),i=e(63142),c=e(5585);const m=r=>({list:(0,s.css)({borderBottom:`1px solid ${r.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,s.css)({background:r.colors.background.primary,width:"250px"}),item:(0,s.css)({background:"none",padding:"2px 8px",userSelect:"none",color:r.colors.text.primary,cursor:"pointer","&:hover":{background:r.colors.action.hover}}),label:(0,s.css)({color:r.colors.text.secondary}),activeItem:(0,s.css)({background:r.colors.background.secondary,"&:hover":{background:r.colors.background.secondary}}),itemValue:(0,s.css)({fontFamily:r.typography.fontFamilyMonospace,fontSize:r.typography.size.sm})}),p=({suggestions:r,...g})=>{const y=(0,a.useRef)(null);(0,d.A)(y,()=>{g.onClose&&g.onClose()});const v=(0,a.useMemo)(()=>(0,l.groupBy)(r,f=>f.origin),[r]),x=(0,i.of)(m);return(0,n.jsx)("div",{role:"menu",ref:y,className:x.wrapper,children:Object.keys(v).map((f,u)=>{const b=u===0?0:Object.keys(v).reduce((E,D,C)=>C>=u?E:E+v[D].length,0);return(0,a.createElement)(h,{...g,suggestions:v[f],label:(0,l.capitalize)(f),activeIndex:g.activeIndex,activeIndexOffset:b,key:f})})})};p.displayName="DataLinkSuggestions";const h=a.memo(({activeIndex:r,activeIndexOffset:g,label:y,onClose:v,onSuggestionSelect:x,suggestions:f,activeRef:u})=>{const b=(0,i.of)(m);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(c.B,{className:b.list,items:f,renderItem:(E,D)=>{const C=D+g===r;return(0,n.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,s.cx)(b.item,C&&b.activeItem),ref:C?u:void 0,onClick:()=>{x(E)},title:E.documentation,children:(0,n.jsxs)("span",{className:b.itemValue,children:[(0,n.jsx)("span",{className:b.label,children:y})," ",E.label]})})}})})});h.displayName="DataLinkSuggestionsList"},6399:(Z,R,e)=>{"use strict";e.d(R,{e:()=>m});var n=e(74848),a=e(22803),s=e(51898),l=e(63142),o=e(75254),d=e(41479),i=e(30930),c=e(94535);const m=({children:h,links:r,style:g})=>{const y=(0,l.of)(p),v=[{items:(0,o.J)(r),label:r().length?"Data links":""}],x=v[0].items.length,f=()=>v.map((b,E)=>(0,n.jsx)(i.r,{label:b.label,children:(b.items||[]).map((D,C)=>(0,n.jsx)(c.D,{url:D.url,label:D.label,target:D.target,icon:D.icon,active:D.active,onClick:D.onClick,className:y.itemWrapper},`${b.label}-${E}-${C}}`))},`${b.label}${E}`)),u=(0,a.css)({cursor:"context-menu"});if(x>1)return(0,n.jsx)(d.n,{renderMenuItems:f,children:({openMenu:b})=>h({openMenu:b,targetClassName:u})});{const b=r()[0];return(0,n.jsx)("a",{href:b.href,onClick:b.onClick,target:b.target,title:b.title,style:{...g,overflow:"hidden",display:"flex"},"data-testid":s.Tp.components.DataLinksContextMenu.singleLink,children:h({})})}},p=h=>({itemWrapper:(0,a.css)({fontSize:12})})},96822:(Z,R,e)=>{"use strict";e.d(R,{e:()=>x});var n=e(74848),a=e(96540),s=e(92745),l=e(45861),o=e(22787),d=e(22803),i=e(63142),c=e(37386),m=e(63527),p=e(21285),h=e(81917);const r=(0,a.memo)(({index:f,value:u,onChange:b,suggestions:E,isLast:D,showOneClick:C=!1})=>{const P=(0,i.of)(g),T=(W,B)=>{b(f,{...u,url:W},B)},O=W=>{b(f,{...u,title:W.target.value})},I=()=>{b(f,{...u,targetBlank:!u.targetBlank})},j=()=>{b(f,{...u,oneClick:!u.oneClick})};return(0,n.jsxs)("div",{className:P.listItem,children:[(0,n.jsx)(c.D,{label:(0,s.t)("grafana-ui.data-link-editor.title-label","Title"),children:(0,n.jsx)(m.p,{id:"link-title",value:u.title,onChange:O,placeholder:(0,s.t)("grafana-ui.data-link-editor.title-placeholder","Show details")})}),(0,n.jsx)(c.D,{label:(0,s.t)("grafana-ui.data-link-editor.url-label","URL"),children:(0,n.jsx)(h.l,{value:u.url,onChange:T,suggestions:E})}),(0,n.jsx)(c.D,{label:(0,s.t)("grafana-ui.data-link-editor.new-tab-label","Open in new tab"),children:(0,n.jsx)(p.d,{id:"new-tab-toggle",value:u.targetBlank||!1,onChange:I})}),C&&(0,n.jsx)(c.D,{label:(0,s.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,s.t)("grafana-ui.data-link-editor-modal.one-click-description","Only one link can have one click enabled at a time"),children:(0,n.jsx)(p.d,{id:"one-click-toggle",value:u.oneClick||!1,onChange:j})}),D&&(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor.info",className:P.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});r.displayName="DataLinkEditor";const g=f=>({listItem:(0,d.css)({marginBottom:f.spacing()}),infoText:(0,d.css)({paddingBottom:f.spacing(2),marginLeft:"66px",color:f.colors.text.secondary})}),y=({link:f,index:u,onSave:b,onCancel:E,getSuggestions:D,showOneClick:C})=>{const[P,T]=(0,a.useState)(f);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r,{value:P,index:u,isLast:!1,onChange:(O,I)=>{T(I)},suggestions:D(),showOneClick:C}),(0,n.jsxs)(o.a.ButtonRow,{children:[(0,n.jsx)(l.$n,{variant:"secondary",onClick:()=>E(u),fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor-modal.cancel",children:"Cancel"})}),(0,n.jsx)(l.$n,{onClick:()=>{b(u,P)},disabled:P.title.trim()===""||P.url.trim()==="",children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor-modal.save",children:"Save"})})]})]})};var v=e(73628);const x=({links:f,getSuggestions:u,showOneClick:b=!1,...E})=>(0,n.jsx)(v.J,{type:"link",items:f,...E,children:(D,C,P,T)=>(0,n.jsx)(y,{index:C,link:D??{title:"",url:""},data:E.data,onSave:P,onCancel:T,getSuggestions:u,showOneClick:b})})},73628:(Z,R,e)=>{"use strict";e.d(R,{J:()=>v});var n=e(74848),a=e(22803),s=e(89332),l=e(2543),o=e(96540),d=e(92745),i=e(63142),c=e(45861),m=e(22787),p=e(99887),h=e(30703),r=e(76319);function g({item:f,onEdit:u,onRemove:b,index:E,itemKey:D}){const C=(0,i.of)(y),{title:P="",oneClick:T=!1}=f,O=f.url??f.fetch?.url??"",I=P.trim()!=="",j=O.trim()!=="";return(0,n.jsx)(s.sx,{draggableId:D,index:E,children:W=>(0,o.createElement)("div",{className:(0,a.cx)(C.wrapper,C.dragRow),ref:W.innerRef,...W.draggableProps,key:E},(0,n.jsxs)("div",{className:C.linkDetails,children:[(0,n.jsx)("div",{className:(0,a.cx)(C.url,!I&&C.notConfigured),children:I?P:(0,d.t)("grafana-ui.data-links-inline-editor.title-not-provided","Title not provided")}),(0,n.jsx)("div",{className:(0,a.cx)(C.url,!j&&C.notConfigured),title:O,children:j?O:(0,d.t)("grafana-ui.data-links-inline-editor.url-not-provided","Data link url not provided")})]}),(0,n.jsxs)("div",{className:C.icons,children:[T&&(0,n.jsx)(p.E,{color:"blue",text:(0,d.t)("grafana-ui.data-links-inline-editor.one-click","One click"),tooltip:(0,d.t)("grafana-ui.data-links-inline-editor.one-click-enabled","One click enabled")}),(0,n.jsx)(r.K,{name:"pen",onClick:u,className:C.icon,tooltip:(0,d.t)("grafana-ui.data-links-inline-editor.tooltip-edit","Edit")}),(0,n.jsx)(r.K,{name:"trash-alt",onClick:b,className:C.icon,tooltip:(0,d.t)("grafana-ui.data-links-inline-editor.tooltip-remove","Remove")}),(0,n.jsx)("div",{className:C.dragIcon,...W.dragHandleProps,children:(0,n.jsx)(h.I,{name:"draggabledots",size:"lg"})})]}))},D)}const y=f=>({wrapper:(0,a.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",padding:"5px 0 5px 10px",borderRadius:f.shape.radius.default,background:f.colors.background.secondary,gap:8}),linkDetails:(0,a.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,a.css)({color:f.colors.error.text,fontStyle:"italic"}),notConfigured:(0,a.css)({fontStyle:"italic"}),title:(0,a.css)({color:f.colors.text.primary,fontSize:f.typography.size.sm,fontWeight:f.typography.fontWeightMedium}),url:(0,a.css)({color:f.colors.text.secondary,fontSize:f.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,a.css)({position:"relative",margin:"8px"}),icons:(0,a.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,a.css)({cursor:"grab",color:f.colors.text.secondary,margin:f.spacing(0,.5)}),icon:(0,a.css)({color:f.colors.text.secondary})});function v({type:f,items:u,onChange:b,data:E,children:D}){const[C,P]=(0,o.useState)(null),[T,O]=(0,o.useState)(!1),[I,j]=(0,o.useState)([]);(0,o.useEffect)(()=>{j(u??[])},[u]);const W=(0,i.of)(x),B=C!==null,S=(U,F)=>{if(T){const K=F.title,G=F.url??F.fetch?.url??"";if(K.trim()===""&&G.trim()===""){O(!1),P(null);return}else P(null),O(!1)}F.oneClick===!0&&I.forEach(K=>{K.oneClick&&(K.oneClick=!1)});const V=(0,l.cloneDeep)(I);V[U]=F,b(V),P(null)},w=U=>{T&&O(!1),P(null)},N=()=>{let U=(0,l.cloneDeep)(I);P(U.length),O(!0)},M=U=>{const F=(0,l.cloneDeep)(I);F.splice(U,1),b(F)},L=U=>{if(u==null||U.destination==null)return;const F=(0,l.cloneDeep)(I),V=F[U.source.index];F.splice(U.source.index,1),F.splice(U.destination.index,0,V),j(F),b(F)},A=U=>{let F="";switch(f){case"link":F=U==="edit"?(0,d.t)("grafana-ui.data-links-inline-editor.edit-link","Edit link"):(0,d.t)("grafana-ui.data-links-inline-editor.add-link","Add link");break;case"action":F=U==="edit"?(0,d.t)("grafana-ui.action-editor.inline.edit-action","Edit action"):(0,d.t)("grafana-ui.action-editor.inline.add-action","Add action");break}return F};return(0,n.jsxs)("div",{className:W.container,children:[(0,n.jsx)(s.JY,{onDragEnd:L,children:(0,n.jsx)(s.gL,{droppableId:"sortable-links",direction:"vertical",children:U=>(0,n.jsxs)("div",{className:W.wrapper,ref:U.innerRef,...U.droppableProps,children:[I.map((F,V)=>{const K=`${F.title}/${V}`;return(0,n.jsx)(g,{index:V,item:F,onChange:S,onEdit:()=>P(V),onRemove:()=>M(V),data:E,itemKey:K},K)}),U.placeholder]})})}),B&&C!==null&&(0,n.jsx)(m.a,{title:A(T?"add":"edit"),isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{w(C)},children:D(I[C],C,S,w)}),(0,n.jsx)(c.$n,{size:"sm",icon:"plus",onClick:N,variant:"secondary",className:W.button,children:A("add")})]})}const x=f=>({container:(0,a.css)({position:"relative"}),wrapper:(0,a.css)({marginBottom:f.spacing(2),display:"flex",flexDirection:"column"}),button:(0,a.css)({marginLeft:f.spacing(1)})})},45558:(Z,R,e)=>{"use strict";e.d(R,{K:()=>c});var n=e(74848),a=e(92745),s=e(45861),l=e(18027),o=e(97095),d=e(63527),i=e(87105);const c=({hasCert:m,label:p,onChange:h,onClick:r,placeholder:g})=>(0,n.jsxs)(o.C,{children:[(0,n.jsx)(l.I,{label:p,labelWidth:14,disabled:m,children:m?(0,n.jsx)(d.p,{type:"text",value:"configured",width:24}):(0,n.jsx)(i.f,{rows:7,onChange:h,placeholder:g,required:!0})}),m&&(0,n.jsx)(s.$n,{variant:"secondary",onClick:r,style:{marginLeft:4},children:(0,n.jsx)(a.x6,{i18nKey:"grafana-ui.data-source-settings.cert-key-reset",children:"Reset"})})]})},55803:(Z,R,e)=>{"use strict";e.d(R,{P:()=>y});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(92745),i=e(63142),c=e(45861),m=e(94959),p=e(30703),h=e(23659);const r=()=>({layout:(0,a.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),g=({header:x,onBlur:f,onChange:u,onRemove:b,onReset:E})=>{const D=(0,i.of)(r);return(0,n.jsxs)("div",{className:D.layout,children:[(0,n.jsx)(m.z,{label:(0,d.t)("grafana-ui.data-source-settings.custom-headers-header","Header"),name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:x.name||"",onChange:C=>u({...x,name:C.target.value}),onBlur:f}),(0,n.jsx)(h.L,{label:(0,d.t)("grafana-ui.data-source-settings.custom-headers-header-value","Value"),"aria-label":(0,d.t)("grafana-ui.data-source-settings.custom-headers-header-value","Value"),name:"value",isConfigured:x.configured,value:x.value,labelWidth:5,inputWidth:x.configured?11:12,placeholder:(0,d.t)("grafana-ui.data-source-settings.custom-headers-header-placeholder","Header Value"),onReset:()=>E(x.id),onChange:C=>u({...x,value:C.target.value}),onBlur:f}),(0,n.jsx)(c.$n,{type:"button","aria-label":(0,d.t)("grafana-ui.data-source-settings.custom-headers-header-remove","Remove header"),variant:"secondary",size:"xs",onClick:C=>b(x.id),children:(0,n.jsx)(p.I,{name:"trash-alt"})})]})};g.displayName="CustomHeaderRow";class y extends o.PureComponent{constructor(f){super(f),this.state={headers:[]},this.updateSettings=()=>{const{headers:D}=this.state,C=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([T,O])=>!T.startsWith("httpHeaderName"))),P=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([T,O])=>!T.startsWith("httpHeaderValue")));for(const[T,O]of D.entries())C[`httpHeaderName${T+1}`]=O.name,O.configured||(P[`httpHeaderValue${T+1}`]=O.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:C,secureJsonData:P})},this.onHeaderAdd=()=>{this.setState(D=>({headers:[...D.headers,{id:(0,s.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(D,C)=>{this.setState(({headers:P})=>({headers:P.map((T,O)=>D!==O?T:{...C})}))},this.onHeaderReset=D=>{this.setState(({headers:C})=>({headers:C.map((P,T)=>P.id!==D?P:{...P,value:"",configured:!1})}))},this.onHeaderRemove=D=>{this.setState(({headers:C})=>({headers:C.filter(P=>P.id!==D)}),this.updateSettings)};const{jsonData:u,secureJsonData:b,secureJsonFields:E}=this.props.dataSourceConfig;this.state={headers:Object.keys(u).sort().filter(D=>D.startsWith("httpHeaderName")).map((D,C)=>({id:(0,s.uniqueId)(),name:u[D],value:b!==void 0?b[D]:"",configured:E&&E[`httpHeaderValue${C+1}`]||!1}))}}render(){const{headers:f}=this.state,{dataSourceConfig:u}=this.props;return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)("h6",{children:(0,n.jsx)(d.x6,{i18nKey:"grafana-ui.data-source-settings.custom-headers-title",children:"Custom HTTP Headers"})})}),(0,n.jsx)("div",{children:f.map((b,E)=>(0,n.jsx)(g,{header:b,onChange:D=>{this.onHeaderChange(E,D)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},b.id))}),!u.readOnly&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(c.$n,{variant:"secondary",icon:"plus",type:"button",onClick:b=>{this.onHeaderAdd()},children:(0,n.jsx)(d.x6,{i18nKey:"grafana-ui.data-source-settings.custom-headers-add",children:"Add header"})})})]})}}var v=null},96004:(Z,R,e)=>{"use strict";e.d(R,{t:()=>S});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(34999),c=e(45861),m=e(37386),p=e(18027),h=e(77824),r=e(30703),g=e(63527),y=e(41654),v=e(21285),x=e(10928),f=e(66404),u=e(94959),b=e(23659);const E=({dataSourceConfig:w,onChange:N})=>{const M=w.secureJsonData?w.secureJsonData.basicAuthPassword:"",L=()=>{N({...w,secureJsonData:{...w.secureJsonData,basicAuthPassword:""},secureJsonFields:{...w.secureJsonFields,basicAuthPassword:!1}})},A=U=>{N({...w,secureJsonData:{...w.secureJsonData,basicAuthPassword:U.currentTarget.value}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.I,{disabled:w.readOnly,children:(0,n.jsx)(u.z,{label:(0,o.t)("grafana-ui.data-source-basic-auth-settings.user-label","User"),labelWidth:10,inputWidth:18,placeholder:(0,o.t)("grafana-ui.data-source-basic-auth-settings.user-placeholder","user"),value:w.basicAuthUser,onChange:U=>N({...w,basicAuthUser:U.currentTarget.value})})}),(0,n.jsx)(p.I,{disabled:w.readOnly,children:(0,n.jsx)(b.L,{isConfigured:!!(w.secureJsonFields&&w.secureJsonFields.basicAuthPassword),value:M||"",inputWidth:18,labelWidth:10,onReset:L,onChange:A})})]})};var D=e(55803);const C=26,P=({dataSourceConfig:w,onChange:N,showForwardOAuthIdentityOption:M=!0})=>{const L=(0,d.of)(T);return(0,n.jsxs)("div",{className:L,children:[(0,n.jsxs)(y.B,{direction:"row",gap:.5,children:[(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-proxy-settings.ts-client-auth-label","TLS Client Auth"),labelWidth:C,disabled:w.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-tls-client-auth",value:w.jsonData.tlsAuth||!1,onChange:A=>N({...w.jsonData,tlsAuth:A.currentTarget.checked})})}),(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-proxy-settings.with-ca-cert-label","With CA Cert"),tooltip:(0,o.t)("grafana-ui.data-source-http-proxy-settings.with-ca-cert-tooltip","Needed for verifying self-signed TLS Certs"),labelWidth:C,disabled:w.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-ca-cert",value:w.jsonData.tlsAuthWithCACert||!1,onChange:A=>N({...w.jsonData,tlsAuthWithCACert:A.currentTarget.checked})})})]}),(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-proxy-settings.skip-tls-verify-label","Skip TLS Verify"),labelWidth:C,disabled:w.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-skip-tls-verify",value:w.jsonData.tlsSkipVerify||!1,onChange:A=>N({...w.jsonData,tlsSkipVerify:A.currentTarget.checked})})}),M&&(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-proxy-settings.oauth-identity-label","Forward OAuth Identity"),tooltip:(0,o.t)("grafana-ui.data-source-http-proxy-settings.oauth-identity-tooltip","Forward the user's upstream OAuth identity to the data source (Their access token gets passed along)."),labelWidth:C,disabled:w.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-forward-oauth",value:w.jsonData.oauthPassThru||!1,onChange:A=>N({...w.jsonData,oauthPassThru:A.currentTarget.checked})})})]})},T=w=>(0,a.css)({display:"grid",gridTemplateColumns:"auto",gap:0});var O=e(3936),I=e(37235);const j="grafana-http-access-help",W=()=>(0,n.jsxs)(i.F,{severity:"info",title:(0,o.t)("grafana-ui.data-source-http-settings.access-help-title","Access help"),topSpacing:3,id:j,children:[(0,n.jsx)("p",{children:(0,n.jsxs)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.access-help-details",children:["Access mode controls how requests to the data source will be handled.",(0,n.jsxs)("strong",{children:["\xA0",(0,n.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]})}),(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-title",children:(0,n.jsx)(f.E,{weight:"medium",children:"Server access mode (Default):"})}),(0,n.jsx)("p",{children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-description",children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."})}),(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-title",children:(0,n.jsx)(f.E,{weight:"medium",children:"Browser access mode:"})}),(0,n.jsx)("p",{children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-description",children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})})]}),B=26,S=w=>{const{defaultUrl:N,dataSourceConfig:M,onChange:L,showAccessOptions:A,sigV4AuthToggleEnabled:U,showForwardOAuthIdentityOption:F,azureAuthSettings:V,renderSigV4Editor:K,secureSocksDSProxyEnabled:G,urlLabel:H,urlDocs:_}=w,k=(0,s.useMemo)(()=>[{label:(0,o.t)("grafana-ui.data-source-http-settings.server-mode-label","Server (default)"),value:"proxy"},{label:(0,o.t)("grafana-ui.data-source-http-settings.browser-mode-label","Browser"),value:"direct"}],[]),J=(0,s.useMemo)(()=>k[0],[k]),[z,Y]=(0,s.useState)(!1),[X,Q]=(0,s.useState)(!1),q=(0,d.$j)();let te;const ne=(0,s.useCallback)(ie=>{const he=V?.azureAuthSupported&&V.getAzureAuthEnabled(M)||!1;if(Q(he),he){const me=M.jsonData.oauthPassThru!==void 0?M.jsonData.oauthPassThru:!1;ie={...ie,jsonData:{...M.jsonData,oauthPassThru:he?!1:me}}}L({...M,...ie})},[V,M,L]);switch(M.access){case"direct":te=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.direct-url-tooltip",children:["Your access method is ",(0,n.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser."]}),_]});break;case"proxy":te=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.proxy-url-tooltip",children:["Your access method is ",(0,n.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server."]}),_]});break;default:te=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.default-url-tooltip",children:"Specify a complete HTTP URL (for example http://your_server:8080)"}),_]})}const se=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(M.url),ue=(0,a.css)({display:"grid",gridTemplateColumns:"auto 1fr",gap:q.spacing(.5)}),de=(0,s.useId)();return(0,n.jsxs)(y.B,{direction:"column",gap:5,children:[(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.heading",children:"HTTP"})}),(0,n.jsx)(m.D,{label:H??"URL",description:te,invalid:!se,error:!se&&(0,o.t)("grafana-ui.data-source-http-settings.invalid-url-error","Invalid URL"),disabled:M.readOnly,children:(0,n.jsx)(g.p,{id:de,width:40,placeholder:N,value:M.url,"data-testid":l.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:ie=>ne({url:ie.currentTarget.value})})}),A&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.D,{label:(0,o.t)("grafana-ui.data-source-http-settings.access-label","Access"),disabled:M.readOnly,children:(0,n.jsxs)(y.B,{direction:"row",gap:.5,children:[(0,n.jsx)(h.z,{"aria-label":(0,o.t)("grafana-ui.data-source-http-settings.access-label","Access"),options:k,value:k.find(ie=>ie.value===M.access)?.value||J.value,onChange:ie=>ne({access:ie})}),(0,n.jsx)(c.$n,{type:"button",variant:"secondary",size:"md",fill:"outline",onClick:()=>Y(ie=>!ie),"aria-expanded":z,"aria-controls":j,children:(0,n.jsxs)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.access-help",children:["Help\xA0",(0,n.jsx)(r.I,{name:z?"angle-down":"angle-right"})]})})]})}),z&&(0,n.jsx)(W,{})]}),M.access==="proxy"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.D,{label:(0,o.t)("grafana-ui.data-source-http-settings.allowed-cookies","Allowed cookies"),description:(0,o.t)("grafana-ui.data-source-http-settings.allowed-cookies-description","Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source."),children:(0,n.jsx)(x.u,{tags:M.jsonData.keepCookies,width:40,onChange:ie=>ne({jsonData:{...M.jsonData,keepCookies:ie}}),disabled:M.readOnly})}),(0,n.jsx)(m.D,{label:(0,o.t)("grafana-ui.data-source-http-settings.timeout-label","Timeout"),description:(0,o.t)("grafana-ui.data-source-http-settings.timeout-description","HTTP request timeout in seconds"),disabled:M.readOnly,children:(0,n.jsx)(g.p,{type:"number",width:40,placeholder:(0,o.t)("grafana-ui.data-source-http-settings.timeout-placeholder","Timeout in seconds"),value:M.jsonData.timeout,onChange:ie=>{ne({jsonData:{...M.jsonData,timeout:parseInt(ie.currentTarget.value,10)}})}})})]})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.auth",children:"Auth"})}),(0,n.jsxs)(y.B,{direction:"column",gap:4,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:ue,children:[(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-settings.basic-auth-label","Basic auth"),labelWidth:B,disabled:M.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-basic-auth",value:M.basicAuth,onChange:ie=>{ne({basicAuth:ie.currentTarget.checked})}})}),(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-settings.with-credentials-label","With Credentials"),tooltip:(0,o.t)("grafana-ui.data-source-http-settings.with-credentials-tooltip","Whether credentials such as cookies or auth headers should be sent with cross-site requests."),labelWidth:B,disabled:M.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-with-credentials",value:M.withCredentials,onChange:ie=>{ne({withCredentials:ie.currentTarget.checked})}})}),V?.azureAuthSupported&&(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-settings.azure-auth-label","Azure Authentication"),tooltip:(0,o.t)("grafana-ui.data-source-http-settings.azure-auth-tooltip","Use Azure authentication for Azure endpoint."),labelWidth:B,disabled:M.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-azure-auth",value:X,onChange:ie=>{ne(V.setAzureAuthEnabled(M,ie.currentTarget.checked))}})}),U&&(0,n.jsx)(p.I,{label:(0,o.t)("grafana-ui.data-source-http-settings.sigv4-auth-label","SigV4 auth"),labelWidth:B,disabled:M.readOnly,children:(0,n.jsx)(v.K,{id:"http-settings-sigv4-auth",value:M.jsonData.sigV4Auth||!1,onChange:ie=>{ne({jsonData:{...M.jsonData,sigV4Auth:ie.currentTarget.checked}})}})})]}),M.access==="proxy"&&(0,n.jsx)(P,{dataSourceConfig:M,onChange:ie=>ne({jsonData:ie}),showForwardOAuthIdentityOption:X?!1:F})]}),M.basicAuth&&(0,n.jsxs)("section",{children:[(0,n.jsx)(f.E,{variant:"h6",element:"h4",children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.data-source-http-settings.basic-auth",children:"Basic Auth Details"})}),(0,n.jsx)(E,{...w})]}),V?.azureAuthSupported&&X&&V.azureSettingsUI&&(0,n.jsx)(V.azureSettingsUI,{dataSourceConfig:M,onChange:L}),M.jsonData.sigV4Auth&&U&&K,(M.jsonData.tlsAuth||M.jsonData.tlsAuthWithCACert)&&(0,n.jsx)(I.j,{dataSourceConfig:M,onChange:L}),M.access==="proxy"&&(0,n.jsx)(D.P,{dataSourceConfig:M,onChange:L})]})]}),G&&(0,n.jsx)(O.Y,{options:M,onOptionsChange:L})]})}},3936:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>o});var n=e(74848),a=e(92745),s=e(21285),l=e(18027);function o({options:d,onOptionsChange:i}){return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(a.x6,{i18nKey:"grafana-ui.data-source-settings.secure-socks-heading",children:"Secure Socks Proxy"})}),(0,n.jsx)("div",{className:"gf-form-group",children:(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.I,{labelWidth:26,label:(0,a.t)("grafana-ui.data-source-settings.secure-socks-label","Enabled"),tooltip:(0,a.t)("grafana-ui.data-source-settings.secure-socks-tooltip","Connect to this datasource via the secure socks proxy."),children:(0,n.jsx)(s.K,{value:d.jsonData.enableSecureSocksProxy??!1,onChange:c=>i({...d,jsonData:{...d.jsonData,enableSecureSocksProxy:c.currentTarget.checked}})})})})})})]})}},37235:(Z,R,e)=>{"use strict";e.d(R,{j:()=>c});var n=e(74848),a=e(22803),s=e(92745),l=e(94959),o=e(30703),d=e(45967),i=e(45558);const c=({dataSourceConfig:m,onChange:p})=>{const h=m.secureJsonFields&&m.secureJsonFields.tlsCACert,r=m.secureJsonFields&&m.secureJsonFields.tlsClientCert,g=m.secureJsonFields&&m.secureJsonFields.tlsClientKey,y=m.jsonData&&m.jsonData.serverName,v=E=>D=>{D.preventDefault();const C={...m.secureJsonFields};C[E]=!1,p({...m,secureJsonFields:C})},x=E=>D=>{const C={...m.secureJsonData};C[E]=D.currentTarget.value,p({...m,secureJsonData:C})},f=E=>{const D={...m.jsonData,serverName:E.currentTarget.value};p({...m,jsonData:D})},u="-----BEGIN CERTIFICATE-----";return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)("div",{className:(0,a.cx)("gf-form",(0,a.css)({alignItems:"baseline"})),children:[(0,n.jsx)("h6",{children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-source-settings.tls-heading",children:"TLS/SSL Auth Details"})}),(0,n.jsx)(d.m,{placement:"right-end",content:(0,s.t)("grafana-ui.data-source-settings.tls-tooltip","TLS/SSL Certs are encrypted and stored in the Grafana database."),theme:"info",children:(0,n.jsx)(o.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,n.jsxs)("div",{children:[m.jsonData.tlsAuthWithCACert&&(0,n.jsx)(i.K,{hasCert:!!h,onChange:x("tlsCACert"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-certification-placeholder","Begins with {{certificateBeginsWith}}",{certificateBeginsWith:u}),label:(0,s.t)("grafana-ui.data-source-settings.tls-certification-label","CA Cert"),onClick:v("tlsCACert")}),m.jsonData.tlsAuth&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.z,{label:(0,s.t)("grafana-ui.data-source-settings.tls-server-name-label","ServerName"),labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:y&&m.jsonData.serverName,onChange:f})}),(0,n.jsx)(i.K,{hasCert:!!r,label:(0,s.t)("grafana-ui.data-source-settings.tls-client-certification-label","Client Cert"),onChange:x("tlsClientCert"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-certification-placeholder","Begins with {{certificateBeginsWith}}",{certificateBeginsWith:u}),onClick:v("tlsClientCert")}),(0,n.jsx)(i.K,{hasCert:!!g,label:(0,s.t)("grafana-ui.data-source-settings.tls-client-key-label","Client Key"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-client-key-placeholder","Begins with {{privateKeyBeginsWith}}",{privateKeyBeginsWith:"-----BEGIN RSA PRIVATE KEY-----"}),onChange:x("tlsClientKey"),onClick:v("tlsClientKey")})]})]})]})}},96396:(Z,R,e)=>{"use strict";e.d(R,{l:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(93581),o=e(63142),d=e(8135),i=e(30703),c=e(66630);const m=(0,s.memo)(r=>{const g=(0,o.of)(h),{isOpen:y,onClose:v}=r;return y?(0,n.jsx)(d.N,{useCapture:!0,includeButtonPress:!1,onClick:v,children:(0,n.jsx)("div",{className:g.modal,"data-testid":"date-picker",children:(0,n.jsx)(p,{...r})})}):null});m.displayName="DatePicker";const p=(0,s.memo)(({value:r,minDate:g,maxDate:y,onChange:v})=>{const x=(0,o.of)(c.h2);return(0,n.jsx)(l.Ay,{className:x.body,tileClassName:x.title,value:r||new Date,minDate:g,maxDate:y,nextLabel:(0,n.jsx)(i.I,{name:"angle-right"}),prevLabel:(0,n.jsx)(i.I,{name:"angle-left"}),onChange:f=>{f&&!Array.isArray(f)&&v(f)},locale:"en"})});p.displayName="Body";const h=r=>({modal:(0,a.css)({zIndex:r.zIndex.modal,boxShadow:r.shadows.z3,backgroundColor:r.colors.background.primary,border:`1px solid ${r.colors.border.weak}`,borderTopLeftRadius:r.shape.radius.default,borderBottomLeftRadius:r.shape.radius.default,"button:disabled":{color:r.colors.text.disabled}})})},43482:(Z,R,e)=>{"use strict";e.d(R,{l:()=>r});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(96540),i=e(25229),c=e(63142),m=e(63527),p=e(96396);const h=y=>(0,i.KQ)(y).format("L"),r=(0,d.forwardRef)(({value:y,minDate:v,maxDate:x,onChange:f,closeOnSelect:u,placeholder:b="Date",...E},D)=>{const[C,P]=(0,d.useState)(!1),T=(0,c.of)(g),O=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:I,refs:j,floatingStyles:W}=(0,l.we)({open:C,placement:"bottom-start",onOpenChange:P,middleware:O,whileElementsMounted:o.ll,strategy:"fixed"}),B=(0,l.kp)(I),S=(0,l.s9)(I),{getReferenceProps:w,getFloatingProps:N}=(0,l.bv)([S,B]);return(0,d.useImperativeHandle)(D,()=>j.domReference.current,[j.domReference]),(0,n.jsxs)("div",{className:T.container,children:[(0,n.jsx)(m.p,{ref:j.setReference,type:"text",autoComplete:"off",placeholder:b,value:y&&h(y),onChange:M=>{M.target.value===""&&f("")},className:T.input,...E,...w()}),(0,n.jsx)("div",{className:T.popover,ref:j.setFloating,style:W,...N(),children:(0,n.jsx)(p.l,{isOpen:C,value:y&&typeof y!="string"?y:(0,i.KQ)().toDate(),minDate:v,maxDate:x,onChange:M=>{f(M),u&&P(!1)},onClose:()=>P(!1)})})]})});r.displayName="DatePickerWithInput";const g=y=>({container:(0,a.css)({position:"relative"}),input:(0,a.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,a.css)({zIndex:y.zIndex.tooltip})})},27282:(Z,R,e)=>{"use strict";e.d(R,{K:()=>B});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(18828),i=e(42211),c=e(93225),m=e(96540),p=e(93581),h=e(49045),r=e(80011),g=e(25229),y=e(60188),v=e(51898),x=e(92745),f=e(63142),u=e(45861),b=e(18027),E=e(30703),D=e(63527),C=e(41654),P=e(35621),T=e(15245),O=e(11527),I=e(66630),j=e(62348),W=e(41e3);const B=({date:M,maxDate:L,minDate:A,label:U,onChange:F,disabledHours:V,disabledMinutes:K,disabledSeconds:G,timeZone:H,showSeconds:_=!0,clearable:k=!1})=>{const[J,z]=(0,m.useState)(!1),Y=(0,m.useRef)(null),{overlayProps:X,underlayProps:Q}=(0,c.e)({onClose:()=>z(!1),isDismissable:!0,isOpen:J,shouldCloseOnInteractOutside:Pe=>{const Ie=document.getElementsByClassName(O.i)[0];return!(Ie&&Ie.contains(Pe))}},Y),{dialogProps:q}=(0,d.s)({},Y),te=(0,f.$j)(),{modalBackdrop:ne}=(0,f.of)(P.o),se=(0,h.A)(`(min-width: ${te.breakpoints.values.lg}px)`),ue=(0,f.of)(N),de=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:ie,floatingStyles:he}=(0,l.we)({open:J,placement:"bottom-start",onOpenChange:z,middleware:de,whileElementsMounted:o.ll,strategy:"fixed"}),me=(0,m.useCallback)(Pe=>{z(!1),F(Pe)},[F]),ce=(0,m.useCallback)(Pe=>{Pe.preventDefault(),z(!0)},[z]);return(0,n.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,n.jsx)(S,{date:M,onChange:F,isFullscreen:se,onOpen:ce,label:U,ref:ie.setReference,showSeconds:_,clearable:k,timeZone:H}),J?se?(0,n.jsx)(T.ZL,{children:(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:Y,...X,...q,children:(0,n.jsx)(w,{date:M,onChange:me,isFullscreen:!0,onClose:()=>z(!1),maxDate:L,minDate:A,ref:ie.setFloating,style:he,showSeconds:_,disabledHours:V,disabledMinutes:K,disabledSeconds:G,timeZone:H})})})}):(0,n.jsxs)(T.ZL,{children:[(0,n.jsx)("div",{className:ne,...Q}),(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:Y,...X,...q,children:(0,n.jsx)("div",{className:ue.modal,children:(0,n.jsx)(w,{date:M,maxDate:L,minDate:A,onChange:me,isFullscreen:!1,onClose:()=>z(!1),showSeconds:_,disabledHours:V,disabledMinutes:K,disabledSeconds:G,timeZone:H})})})})]}):null]})},S=m.forwardRef(({date:M,label:L,onChange:A,onOpen:U,timeZone:F,showSeconds:V=!0,clearable:K=!1},G)=>{const H=(0,f.of)(N),_=V?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[k,J]=(0,m.useState)(()=>({value:M?(0,r.LE)(M,{timeZone:F}):K?"":(0,r.LE)((0,g.KQ)(),{timeZone:F}),invalid:!1}));(0,m.useEffect)(()=>{if(M){const q=(0,r.LE)(M,{format:_,timeZone:F});J({invalid:!(0,j.f)(q),value:(0,g.Ar)(M)?q:M})}},[M,_,F]);const z=(0,m.useCallback)(q=>{const te=!(0,j.f)(q.currentTarget.value);J({value:q.currentTarget.value,invalid:te})},[]),Y=(0,m.useCallback)(()=>{if(!k.invalid&&k.value){const q=(0,g.oZ)((0,y.O)({timeZone:F}),k.value);A(q)}},[k,A,F]),X=(0,m.useCallback)(()=>{J({value:"",invalid:!1}),A()},[A]),Q=(0,n.jsx)(u.$n,{"aria-label":(0,x.t)("grafana-ui.date-time-picker.calendar-icon-label","Time picker"),icon:"calendar-alt",variant:"secondary",onClick:U});return(0,n.jsx)(b.I,{label:L,invalid:!!(k.value&&k.invalid),className:H.field,children:(0,n.jsx)(D.p,{onChange:z,addonAfter:Q,value:k.value,onBlur:Y,"data-testid":v.XF.DateTimePicker.input,placeholder:(0,x.t)("grafana-ui.date-time-picker.select-placeholder","Select date/time"),ref:G,suffix:K&&k.value&&(0,n.jsx)(E.I,{name:"times",className:H.clearIcon,onClick:X})})})});S.displayName="DateTimeInput";const w=m.forwardRef(({date:M,onClose:L,onChange:A,isFullscreen:U,maxDate:F,minDate:V,style:K,showSeconds:G=!0,disabledHours:H,disabledMinutes:_,disabledSeconds:k,timeZone:J},z)=>{const Y=(0,f.of)(I.h2),X=(0,f.of)(N),[Q,q]=(0,m.useState)(()=>M&&M.isValid()?(0,g.oZ)((0,y.O)({timeZone:J}),M):(0,g.oZ)((0,y.O)({timeZone:J}),new Date)),[te,ne]=(0,m.useState)(()=>M&&M.isValid()?(0,W.Q)(M.toDate(),(0,y.O)({timeZone:J})):(0,W.Q)(new Date,(0,y.O)({timeZone:J}))),se=(0,m.useCallback)(ie=>{ie&&!Array.isArray(ie)&&ne(ie)},[]),ue=(0,m.useCallback)(ie=>{q(ie)},[]),de=()=>{const ie=(0,g.KQ)(Q);ie.set("date",te.getDate()),ie.set("month",te.getMonth()),ie.set("year",te.getFullYear()),A(ie)};return(0,n.jsxs)("div",{className:(0,a.cx)(X.container,{[X.fullScreen]:U}),style:K,ref:z,children:[(0,n.jsx)(p.Ay,{next2Label:null,prev2Label:null,value:te,nextLabel:(0,n.jsx)(E.I,{name:"angle-right"}),nextAriaLabel:(0,x.t)("grafana-ui.date-time-picker.next-label","Next month"),prevLabel:(0,n.jsx)(E.I,{name:"angle-left"}),prevAriaLabel:(0,x.t)("grafana-ui.date-time-picker.previous-label","Previous month"),onChange:se,locale:"en",className:Y.body,tileClassName:Y.title,maxDate:F,minDate:V}),(0,n.jsx)("div",{className:X.time,children:(0,n.jsx)(O.R,{showSeconds:G,onChange:ue,value:Q,disabledHours:H,disabledMinutes:_,disabledSeconds:k})}),(0,n.jsxs)(C.B,{children:[(0,n.jsx)(u.$n,{type:"button",onClick:de,children:(0,n.jsx)(x.x6,{i18nKey:"grafana-ui.date-time-picker.apply",children:"Apply"})}),(0,n.jsx)(u.$n,{variant:"secondary",type:"button",onClick:L,children:(0,n.jsx)(x.x6,{i18nKey:"grafana-ui.date-time-picker.cancel",children:"Cancel"})})]})]})});w.displayName="DateTimeCalendar";const N=M=>({container:(0,a.css)({padding:M.spacing(1),border:`1px ${M.colors.border.weak} solid`,borderRadius:M.shape.radius.default,backgroundColor:M.colors.background.primary,zIndex:M.zIndex.modal}),fullScreen:(0,a.css)({position:"absolute"}),time:(0,a.css)({marginBottom:M.spacing(2)}),modal:(0,a.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:M.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,a.css)({cursor:"pointer"}),field:(0,a.css)({marginBottom:0,width:"100%"})})},90929:(Z,R,e)=>{"use strict";e.d(R,{N:()=>S});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(18828),i=e(42211),c=e(93225),m=e(96540),p=e(92745),h=e(63142),r=e(45861),g=e(37386),y=e(30703),v=e(63527),x=e(92807),f=e(47087),u=e(44398),b=e(8431);const E=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,D=M=>({from:O(M.from),to:O(M.to)}),C=M=>{const L=j(M.from),A=j(M.to);return{from:L,to:A,display:`${L} to ${A}`}},P=(M,L=Date.now())=>T(M)?O(M)>Math.ceil(L/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},T=M=>E.test(M),O=M=>{const L=E.exec(M);if(!L||L.length!==4)return 0;const[,A,U,F]=L,V=parseInt(U,10);if(isNaN(V))return 0;const K=V*I[F];return A==="+"?K*-1:K},I={w:604800,d:86400,h:3600,m:60,s:1},j=M=>{if(M===0)return"now";const L=Math.abs(M);return M<0?`now+${W(L)}`:`now-${W(L)}`};function W(M){const L=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:U,value:F}of L)if(M%F===0)return`${M/F}${U}`;const A=L[L.length-1];return`${M}${A.unit}`}const B=b.o.filter(M=>T(M.from));function S(M){const{timeRange:L,onChange:A}=M,[U,F]=(0,m.useState)(!1),V=(0,m.useCallback)(()=>F(!1),[]),K=C(L),[G,H]=(0,m.useState)({value:K.from,validation:P(K.from)}),[_,k]=(0,m.useState)({value:K.to,validation:P(K.to)}),J=(0,m.useRef)(null),{overlayProps:z,underlayProps:Y}=(0,c.e)({onClose:()=>F(!1),isDismissable:!0,isOpen:U},J),{dialogProps:X}=(0,d.s)({},J),Q=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:q,refs:te,floatingStyles:ne}=(0,l.we)({open:U,placement:"bottom-start",onOpenChange:F,middleware:Q,whileElementsMounted:o.ll,strategy:"fixed"}),se=(0,l.kp)(q),ue=(0,l.s9)(q),{getReferenceProps:de,getFloatingProps:ie}=(0,l.bv)([ue,se]),he=(0,h.of)(w(G.validation.errorMessage,_.validation.errorMessage)),me=Me=>{const Te=D(Me);Te&&(V(),H({...G,value:Me.from}),k({..._,value:Me.to}),A(Te))},ce=(0,m.useCallback)(Me=>{Me.stopPropagation(),Me.preventDefault(),F(!U)},[U]),Pe=Me=>{if(Me.preventDefault(),!_.validation.isValid||!G.validation.isValid)return;const Te=D({from:G.value,to:_.value,display:""});Te&&(A(Te),F(!1))},{from:Ie,to:Se}=K;return(0,n.jsxs)("div",{className:he.container,children:[(0,n.jsxs)("button",{ref:te.setReference,className:he.pickerInput,type:"button",onClick:ce,...de(),children:[(0,n.jsx)("span",{className:he.clockIcon,children:(0,n.jsx)(y.I,{name:"clock-nine"})}),(0,n.jsx)("span",{children:(0,n.jsxs)(p.x6,{i18nKey:"time-picker.time-range.from-to",children:[{timeOptionFrom:Ie}," to ",{timeOptionTo:Se}]})}),(0,n.jsx)("span",{className:he.caretIcon,children:(0,n.jsx)(y.I,{name:U?"angle-up":"angle-down",size:"lg"})})]}),U&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{role:"presentation",className:he.backdrop,...Y}),(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:J,...z,...X,children:(0,n.jsx)("div",{className:he.content,ref:te.setFloating,style:ne,...ie(),children:(0,n.jsxs)("div",{className:he.body,children:[(0,n.jsx)("div",{className:he.leftSide,children:(0,n.jsx)(x.P,{showScrollIndicators:!0,children:(0,n.jsx)(u.l,{title:(0,p.t)("time-picker.time-range.example-title","Example time ranges"),options:B,onChange:me,value:K})})}),(0,n.jsxs)("div",{className:he.rightSide,children:[(0,n.jsx)("div",{className:he.title,children:(0,n.jsx)(f.e,{children:(0,n.jsx)(p.x6,{i18nKey:"time-picker.time-range.specify",children:"Specify time range"})})}),(0,n.jsx)(g.D,{label:(0,p.t)("time-picker.time-range.from-label","From"),invalid:!G.validation.isValid,error:G.validation.errorMessage,children:(0,n.jsx)(v.p,{onClick:Me=>Me.stopPropagation(),onBlur:()=>H({...G,validation:P(G.value)}),onChange:Me=>H({...G,value:Me.currentTarget.value}),value:G.value})}),(0,n.jsx)(g.D,{label:(0,p.t)("time-picker.time-range.to-label","To"),invalid:!_.validation.isValid,error:_.validation.errorMessage,children:(0,n.jsx)(v.p,{onClick:Me=>Me.stopPropagation(),onBlur:()=>k({..._,validation:P(_.value)}),onChange:Me=>k({..._,value:Me.currentTarget.value}),value:_.value})}),(0,n.jsx)(r.$n,{"aria-label":(0,p.t)("time-picker.time-range.submit-button-label","TimePicker submit button"),onClick:Pe,children:(0,n.jsx)(p.x6,{i18nKey:"time-picker.time-range.apply",children:"Apply time range"})})]})]})})})})]})]})}const w=(M,L)=>A=>{const U=(0,v.n)({theme:A,invalid:!1}),V=250+N(A,M)+N(A,L);return{backdrop:(0,a.css)({position:"fixed",zIndex:A.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,a.css)({display:"flex",position:"relative"}),pickerInput:(0,a.cx)(U.input,U.wrapper,(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${A.spacing.gridSize*A.components.height.md-2}px`})),caretIcon:(0,a.cx)(U.suffix,(0,a.css)({position:"relative",marginLeft:A.spacing(.5)})),clockIcon:(0,a.cx)(U.prefix,(0,a.css)({position:"relative",marginRight:A.spacing(.5)})),content:(0,a.css)({background:A.colors.background.primary,boxShadow:A.shadows.z3,position:"absolute",zIndex:A.zIndex.modal,width:"500px",top:"100%",borderRadius:A.shape.radius.default,border:`1px solid ${A.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,a.css)({display:"flex",height:`${V}px`}),description:(0,a.css)({color:A.colors.text.secondary,fontSize:A.typography.size.sm}),leftSide:(0,a.css)({width:"50% !important",borderRight:`1px solid ${A.colors.border.medium}`}),rightSide:(0,a.css)({width:"50%",padding:A.spacing(1)}),title:(0,a.css)({marginBottom:A.spacing(1)})}};function N(M,L){return L?L.length>34?M.spacing.gridSize*6.5:M.spacing.gridSize*4:0}},11527:(Z,R,e)=>{"use strict";e.d(R,{R:()=>r,i:()=>h});var n=e(74848),a=e(22803),s=e(84783),l=e(34235),o=e(24938),d=e(25229),i=e(63142),c=e(35484),m=e(3343),p=e(30703);const h="time-of-day-picker-panel",r=({minuteStep:x=1,showHour:f=!0,showSeconds:u=!1,value:b,size:E="auto",disabled:D,disabledHours:C,disabledMinutes:P,disabledSeconds:T,placeholder:O,...I})=>{const j=(0,i.of)(v),W=I.allowEmpty??!1;return(0,n.jsx)(s.Ay,{generateConfig:l.A,locale:o.A,allowClear:W&&{clearIcon:(0,n.jsx)(p.I,{name:"times",className:j.clearIcon})},className:(0,a.cx)((0,m.lH)()[E],j.input),classNames:{popup:(0,a.cx)(j.picker,h)},defaultValue:I.allowEmpty?void 0:(0,d.AN)(),disabled:D,disabledTime:()=>({disabledHours:C,disabledMinutes:P,disabledSeconds:T}),format:g(f,u),minuteStep:x,onChange:B=>{if((0,d.u8)(B))return I.allowEmpty?I.onChange(B?(0,d.KQ)(B):void 0):I.onChange((0,d.KQ)(B))},picker:"time",placeholder:O,showNow:!1,needConfirm:!1,suffixIcon:(0,n.jsx)(y,{wrapperStyle:j.caretWrapper}),value:b&&(0,d.AN)(b)})};function g(x=!0,f=!1){const u=x?"HH:":"",b=f?":ss":"";return u+"mm"+b}const y=({wrapperStyle:x=""})=>(0,n.jsx)("div",{className:x,children:(0,n.jsx)(p.I,{name:"angle-down"})}),v=x=>{const f=x.components.input.background,u=x.colors.action.hover,b=x.shape.radius.default,E=x.components.input.borderColor;return{caretWrapper:(0,a.css)({position:"relative",top:"50%",transform:"translateY(-50%)",display:"inline-block",color:x.colors.text.secondary}),clearIcon:(0,a.css)({color:x.colors.text.secondary,"&:hover":{color:x.colors.text.maxContrast}}),picker:(0,a.css)({"&.rc-picker-dropdown":{boxShadow:"none",zIndex:x.zIndex.portal},".rc-picker-time-panel-column":{fontSize:x.typography.htmlFontSize,backgroundColor:f,color:x.colors.text.secondary,padding:"unset",overflowY:"auto",scrollbarWidth:"thin",width:x.spacing(8),li:{paddingRight:x.spacing(2),width:"auto","&.rc-picker-time-panel-cell-selected":{backgroundColor:"inherit",border:`1px solid ${x.colors.action.selectedBorder}`,borderRadius:b,color:x.colors.text.primary},"&:hover":{background:u,color:x.colors.text.primary},"&.rc-picker-time-panel-cell-disabled":{color:x.colors.action.disabledText}},".rc-picker-time-panel-cell-inner":{color:"inherit"},"&:not(:last-of-type)":{borderRight:`1px solid ${E}`}},".rc-picker-panel":{boxShadow:x.shadows.z3,backgroundColor:f,borderColor:E,borderRadius:b,overflow:"hidden"}}),input:(0,a.css)({"&.rc-picker-focused":{border:"none",".rc-picker-input":(0,c.getFocusStyles)(x)},"&.rc-picker-disabled":{".rc-picker-input":{backgroundColor:x.colors.action.disabledBackground,color:x.colors.action.disabledText,border:`1px solid ${x.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}},".rc-picker-input":{backgroundColor:f,borderRadius:b,borderColor:E,borderStyle:"solid",borderWidth:"1px",color:x.colors.text.primary,height:x.spacing(4),padding:x.spacing(0,1),input:{color:"unset",backgroundColor:"unset","&:focus":{outline:"none"},"&::placeholder":{color:x.colors.text.disabled}}},".rc-picker-clear":{alignItems:"center",display:"flex",insetInlineEnd:"unset",position:"relative"}})}}},72296:(Z,R,e)=>{"use strict";e.d(R,{A:()=>l,X:()=>o});var n=e(74848),a=e(96540);const s=(0,a.createContext)(void 0);function l({children:d}){const[i,c]=(0,a.useState)(0),[m,p]=(0,a.useState)(),h=(0,a.useMemo)(()=>({sync:r=>p(r),unSync:()=>p(void 0),addPicker:()=>c(r=>r+1),removePicker:()=>{c(r=>{const g=r-1;return g<2&&p(void 0),g})},syncPossible:i>1,synced:!!m,syncedValue:m}),[i,m]);return(0,n.jsx)(s.Provider,{value:h,children:d})}function o(d){const i=(0,a.useContext)(s);return(0,a.useEffect)(()=>i?(i.addPicker(),d&&i.sync(d),()=>{i.removePicker()}):()=>{},[]),(0,a.useMemo)(()=>i&&{sync:i.sync,unSync:i.unSync,syncPossible:i.syncPossible,synced:i.synced,syncedValue:i.syncedValue},[i])}},56265:(Z,R,e)=>{"use strict";e.d(R,{b:()=>f});var n=e(74848),a=e(22803),s=e(83505),l=e(42211),o=e(96540),d=e(25229),i=e(22592),c=e(51898),m=e(63142),p=e(30703),h=e(63527),r=e(4364),g=e(83692),y=e(8431),v=e(62348);const x=()=>{},f=({value:b,onChange:E,onChangeTimeZone:D=x,clearable:C,weekStart:P,hideTimeZone:T=!0,timeZone:O="browser",placeholder:I="Select time range",isReversed:j=!0,hideQuickRanges:W=!1,disabled:B=!1,showIcon:S=!1})=>{const[w,N]=(0,o.useState)(!1),M=(0,m.of)(u,B),L=J=>{J.stopPropagation(),J.preventDefault(),!B&&N(!w)},A=()=>{N(!1)},U=J=>{A(),E(J)},F=J=>{J.stopPropagation();const z=(0,d.KQ)(null),Y=(0,d.KQ)(null);E({from:z,to:Y,raw:{from:z,to:Y}})},{refs:V,floatingStyles:K,context:G}=(0,s.we)({open:w,onOpenChange:N,placement:"bottom-start",strategy:"fixed"}),H=(0,s.s9)(G,{bubbles:{outsidePress:!1}}),{getReferenceProps:_,getFloatingProps:k}=(0,s.bv)([H]);return(0,n.jsxs)("div",{className:M.container,children:[(0,n.jsxs)("button",{type:"button",className:M.pickerInput,"data-testid":c.Tp.components.TimePicker.openButton,onClick:L,ref:V.setReference,..._(),children:[S&&(0,n.jsx)(p.I,{name:"clock-nine",size:"sm",className:M.icon}),(0,n.jsx)(g.f,{value:b,timeZone:O,placeholder:I}),!B&&(0,n.jsxs)("span",{className:M.caretIcon,children:[(0,v.X)(b)&&C&&(0,n.jsx)(p.I,{className:M.clearIcon,name:"times",size:"lg",onClick:F}),(0,n.jsx)(p.I,{name:w?"angle-up":"angle-down",size:"lg"})]})]}),w&&(0,n.jsx)(l.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{className:M.content,ref:V.setFloating,style:K,...k(),children:(0,n.jsx)(r.r,{timeZone:O,value:(0,v.X)(b)?b:(0,i.E2)(),onChange:U,quickOptions:y.o,onChangeTimeZone:D,className:M.content,hideTimeZone:T,isReversed:j,hideQuickRanges:W,weekStart:P})})})]})},u=(b,E=!1)=>{const D=(0,h.n)({theme:b,invalid:!1});return{container:(0,a.css)({display:"flex",position:"relative"}),content:(0,a.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:b.zIndex.modal}),pickerInput:(0,a.cx)(D.input,E&&D.inputDisabled,D.wrapper,(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${b.spacing.gridSize*4-2}px`})),caretIcon:(0,a.cx)(D.suffix,(0,a.css)({position:"relative",top:"-1px",marginLeft:b.spacing(.5)})),clearIcon:(0,a.css)({marginRight:b.spacing(.5),"&:hover":{color:b.colors.text.maxContrast}}),placeholder:(0,a.css)({color:b.colors.text.disabled,opacity:1}),icon:(0,a.css)({marginRight:b.spacing(.5)})}}},91867:(Z,R,e)=>{"use strict";e.d(R,{_8:()=>B,xS:()=>W,$6:()=>I});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(96540),i=e(62717),c=e(80011),m=e(17548),p=e(33239),h=e(51898),r=e(92745),g=e(63142),y=e(93256),v=e(35621),x=e(15245),f=e(7895),u=e(45967),b=e(4364),E=e(34788),D=e(8431),C=e(84596),P=e(72296);function T(M){const{onClick:L,isSynced:A}=M,U=()=>{const F=A?"Unsync all views":"Sync all views to this time range";return(0,n.jsx)(n.Fragment,{children:F})};return(0,n.jsx)(u.m,{content:U,placement:"bottom",children:(0,n.jsx)(f.I,{icon:"link",variant:A?"active":"canvas","aria-label":A?(0,r.t)("grafana-ui.time-sync-button.aria-label-unsync","Unsync times"):(0,r.t)("grafana-ui.time-sync-button.aria-label-sync","Sync times"),onClick:L})})}function O(M){const{value:L,onChangeProp:A,isSyncedProp:U,initialIsSynced:F,timeSyncButtonProp:V}=M,K=(0,P.X)(F&&L?L:void 0),G=K?.synced,H=K?.syncedValue,_=K?.sync,k=!!(M.isSyncedProp===void 0&&K),J=(0,d.useCallback)(q=>{A(q),k&&G&&_?.(q)},[A,k,_,G]),z=(0,C.A)(L),Y=(0,C.A)(K?.syncedValue);(0,d.useEffect)(()=>{k&&G&&(L!==z&&L!==H?_?.(L):H&&H!==Y&&H!==L&&A(H))},[k,G,H,_,Y,L,z,A]);const X=k?K?.synced:U,Q=k?K?.syncPossible&&(0,n.jsx)(T,{isSynced:K?.synced,onClick:()=>K?.synced?K.unSync():K.sync(L)}):V;return{onChangeWithSync:J,isSynced:X,timeSyncButton:Q}}function I(M){const[L,A]=(0,d.useState)(!1),{value:U,onMoveBackward:F,onMoveForward:V,onZoom:K,onError:G,timeZone:H,fiscalYearStartMonth:_,history:k,onChangeTimeZone:J,onChangeFiscalYearStartMonth:z,quickRanges:Y,hideQuickRanges:X,widthOverride:Q,isOnCanvas:q,onToolbarTimePickerClick:te,weekStart:ne,initialIsSynced:se}=M,{onChangeWithSync:ue,isSynced:de,timeSyncButton:ie}=O({initialIsSynced:se,value:U,onChangeProp:M.onChange,isSyncedProp:M.isSynced,timeSyncButtonProp:M.timeSyncButton}),he=Ne=>{ue(Ne),A(!1)};(0,d.useEffect)(()=>{L&&te&&te()},[L,te]);const me=()=>{A(Ne=>!Ne)},ce=()=>{A(!1)},Pe=(0,d.createRef)(),Ie=(0,d.createRef)(),{overlayProps:Se,underlayProps:Me}=(0,o.e)({onClose:ce,isDismissable:!0,isOpen:L,shouldCloseOnInteractOutside:Ne=>{const Ae=(0,x.gF)();return!Ie.current?.contains(Ne)&&!Ae.contains(Ne)}},Pe),{dialogProps:Te}=(0,s.s)({},Pe),Ge=(0,g.of)(w),{modalBackdrop:Qe}=(0,g.of)(v.o),tt=de?"active":q?"canvas":"default",He=U?.to?.isBefore(U.from)?"exclamation-triangle":"clock-nine",Re=S(U,H,Y);return(0,n.jsxs)(y.e,{className:Ge.container,children:[(0,n.jsx)(f.I,{"aria-label":(0,r.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:tt,onClick:F,icon:"angle-left",type:"button",narrow:!0}),(0,n.jsx)(u.m,{ref:Ie,content:(0,n.jsx)(W,{timeRange:U,timeZone:H}),placement:"bottom",interactive:!0,children:(0,n.jsx)(f.I,{"data-testid":h.Tp.components.TimePicker.openButton,"aria-label":(0,r.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Re}),"aria-controls":"TimePickerContent",onClick:me,icon:He,isOpen:L,type:"button",variant:tt,children:(0,n.jsx)(B,{...M})})}),L&&(0,n.jsxs)("div",{"data-testid":h.Tp.components.TimePicker.overlayContent,children:[(0,n.jsx)("div",{role:"presentation",className:(0,a.cx)(Qe,Ge.backdrop),...Me}),(0,n.jsx)(l.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{className:Ge.content,ref:Pe,...Se,...Te,children:(0,n.jsx)(b.r,{timeZone:H,fiscalYearStartMonth:_,value:U,onChange:he,quickOptions:Y||D.o,history:k,showHistory:!0,widthOverride:Q,onChangeTimeZone:J,onChangeFiscalYearStartMonth:z,hideQuickRanges:X,onError:G,weekStart:ne})})})]}),ie,(0,n.jsx)(f.I,{"aria-label":(0,r.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:V,icon:"angle-right",narrow:!0,type:"button",variant:tt}),(0,n.jsx)(u.m,{content:j,placement:"bottom",children:(0,n.jsx)(f.I,{"aria-label":(0,r.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:K,icon:"search-minus",type:"button",variant:tt})})]})}I.displayName="TimeRangePicker";const j=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r.x6,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,n.jsx)("br",{})," CTRL+Z"]})}),W=({timeRange:M,timeZone:L})=>{const A=(0,g.of)(N),U=Date.now(),F=L?(0,i.QZ)(L,U):void 0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,c.LE)(M.from,{timeZone:L}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(r.x6,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,c.LE)(M.to,{timeZone:L})]}),(0,n.jsxs)("div",{className:A.container,children:[(0,n.jsx)("span",{className:A.utc,children:(0,i.le)(L)}),(0,n.jsx)(E.E,{info:F})]})]})},B=(0,d.memo)(({hideText:M,value:L,timeZone:A,quickRanges:U})=>{const F=(0,g.of)(N);return M?null:(0,n.jsxs)("span",{className:F.container,"aria-live":"polite","aria-atomic":"true",children:[(0,n.jsx)("span",{children:S(L,A,U)}),(0,n.jsx)("span",{className:F.utc,children:m.describeTimeRangeAbbreviation(L,A)})]})});B.displayName="TimePickerButtonLabel";const S=(M,L,A)=>{const U={to:p.isMathString(M.raw.to)?M.raw.to:M.to,from:p.isMathString(M.raw.from)?M.raw.from:M.from};return m.describeTimeRange(U,L,A)},w=M=>({container:(0,a.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,a.css)({display:"none",[M.breakpoints.down("sm")]:{display:"block"}}),content:(0,a.css)({position:"absolute",right:0,top:"116%",zIndex:M.zIndex.dropdown,[M.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:M.zIndex.modal}})}),N=M=>({container:(0,a.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap",columnGap:M.spacing(.5)}),utc:(0,a.css)({color:M.v1.palette.orange,fontSize:M.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:M.typography.fontWeightMedium})})},66630:(Z,R,e)=>{"use strict";e.d(R,{h2:()=>x,nB:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(93581),o=e(44922),d=e(92745),i=e(63142),c=e(30703),m=e(5857),p=e(41e3);const h={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function r({onChange:f,from:u,to:b,timeZone:E,weekStart:D}){const C=g(u,b,new Date,E),P=y(f,E),T=(0,i.of)(x),O=(0,m.rL)(D);return(0,n.jsx)(l.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:T.body,tileClassName:T.title,value:C,nextLabel:(0,n.jsx)(c.I,{name:"angle-right"}),nextAriaLabel:(0,d.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,n.jsx)(c.I,{name:"angle-left"}),prevAriaLabel:(0,d.t)("time-picker.calendar.previous-month","Previous month"),onChange:P,locale:"en",calendarType:h[O]})}r.displayName="Body";function g(f,u,b=new Date,E){let D=f.isValid()?f.toDate():b,C=u.isValid()?u.toDate():b;return E&&(D=(0,p.Q)(D,E),C=(0,p.Q)(C,E)),D>C?[C,D]:[D,C]}function y(f,u){return(0,s.useCallback)(b=>{if(!Array.isArray(b))return console.error("onCalendarChange: should be run in selectRange={true}");if(b[0]&&b[1]){const E=(0,o.b)(v(b[0]),{timeZone:u}),D=(0,o.b)(v(b[1]),{timeZone:u});f(E,D)}},[f,u])}function v(f){return[f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds()]}const x=f=>{const u=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,a.css)({color:f.colors.text.primary,backgroundColor:f.colors.background.primary,fontSize:f.typography.size.md,border:"1px solid transparent","&:hover, &:focus":{position:"relative"},"&:disabled":{color:f.colors.action.disabledText,cursor:"not-allowed"}}),body:(0,a.css)({zIndex:f.zIndex.modal,backgroundColor:f.colors.background.elevated,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:f.colors.text.primary,border:0,fontWeight:f.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:f.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},".react-calendar__tile--hover":{backgroundColor:f.colors.action.hover,borderRadius:0},".react-calendar__tile--hoverStart":{borderTopLeftRadius:f.shape.radius.pill,borderBottomLeftRadius:f.shape.radius.pill},".react-calendar__tile--hoverEnd":{borderTopRightRadius:f.shape.radius.pill,borderBottomRightRadius:f.shape.radius.pill},".react-calendar__tile:hover:not(.react-calendar__tile--hover):not(.react-calendar__tile--active):not(.react-calendar__tile--hasActive)":{backgroundColor:f.colors.action.hover,borderRadius:f.shape.radius.pill},[`${u}, .react-calendar__tile--rangeStart:not(.react-calendar__tile--hover)`]:{borderTopLeftRadius:f.shape.radius.pill,borderBottomLeftRadius:f.shape.radius.pill},[`${u}, .react-calendar__tile--rangeEnd:not(.react-calendar__tile--hover)`]:{borderTopRightRadius:f.shape.radius.pill,borderBottomRightRadius:f.shape.radius.pill},[`${u}, .react-calendar__tile--active, .react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart`]:{color:f.colors.primary.contrastText,fontWeight:f.typography.fontWeightMedium,background:f.colors.primary.main,border:"0px"}})}}},4364:(Z,R,e)=>{"use strict";e.d(R,{r:()=>Ie});var n=e(74848),a=e(22803),s=e(96540),l=e(25229),o=e(17548),d=e(51898),i=e(92745),c=e(63142),m=e(35484),p=e(12737),h=e(30703),r=e(2543),g=e(62717),y=e(45861),v=e(43243),x=e(37386),f=e(60208),u=e(13941),b=e(54314),E=e(59310),D=e(34788),C=e(44229),P=e(27228),T=e(8431);const O=Ne=>{const{timeZone:Ae,fiscalYearStartMonth:Ue,timestamp:Be=Date.now(),onChangeTimeZone:We,onChangeFiscalYearStartMonth:_e}=Ne,[Xe,le]=(0,s.useState)(!1),[ye,pe]=(0,s.useState)("tz"),ve=(0,s.useId)(),be=(0,s.useId)(),Oe=(0,s.useId)(),we=(0,s.useCallback)(ge=>{ge&&ge.stopPropagation(),le(!Xe)},[Xe,le]),ze=(0,c.of)(I);if(!(0,r.isString)(Ae))return null;const Ve=(0,g.QZ)(Ae,Be);return Ve?(0,n.jsxs)("div",{children:[(0,n.jsxs)("section",{"aria-label":(0,i.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ze.container,children:[(0,n.jsxs)("div",{className:ze.timeZoneContainer,children:[(0,n.jsxs)("div",{className:ze.timeZone,children:[(0,n.jsx)(P.U,{title:Ve.name}),(0,n.jsx)("div",{className:ze.spacer}),(0,n.jsx)(D.E,{info:Ve})]}),(0,n.jsx)(C.X,{timeZone:Ae,timestamp:Be})]}),(0,n.jsx)("div",{className:ze.spacer}),(0,n.jsx)(y.$n,{"data-testid":d.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:we,size:"sm","aria-expanded":Xe,"aria-controls":ve,icon:Xe?"angle-up":"angle-down",children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),Xe?(0,n.jsxs)("div",{className:ze.editContainer,id:ve,children:[(0,n.jsxs)(b.U,{children:[(0,n.jsx)(f.o,{label:(0,i.t)("time-picker.footer.time-zone-option","Time zone"),active:ye==="tz",onChangeTab:()=>{pe("tz")},"aria-controls":be}),(0,n.jsx)(f.o,{label:(0,i.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:ye==="fy",onChangeTab:()=>{pe("fy")},"aria-controls":Oe})]}),(0,n.jsx)(u.J,{className:ze.noBackground,children:ye==="tz"?(0,n.jsx)("section",{role:"tabpanel","data-testid":d.Tp.components.TimeZonePicker.containerV2,id:be,className:(0,a.cx)(ze.timeZoneContainer,ze.timeSettingContainer),children:(0,n.jsx)(E.U,{includeInternal:!0,onChange:ge=>{we(),(0,r.isString)(ge)&&We(ge)},onBlur:we,menuShouldPortal:!1})}):(0,n.jsx)("section",{role:"tabpanel","data-testid":d.Tp.components.TimeZonePicker.containerV2,id:Oe,className:(0,a.cx)(ze.timeZoneContainer,ze.timeSettingContainer),children:(0,n.jsx)(x.D,{className:ze.fiscalYearField,label:(0,i.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,n.jsx)(v.G,{value:Ue??null,options:T.Z,onChange:ge=>{_e&&_e(ge?.value??0)}})})})})]}):null]}):null},I=Ne=>({container:(0,a.css)({borderTop:`1px solid ${Ne.colors.border.weak}`,padding:Ne.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,a.css)({borderTop:`1px solid ${Ne.colors.border.weak}`,padding:Ne.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,a.css)({marginLeft:"7px"}),timeSettingContainer:(0,a.css)({paddingTop:Ne.spacing(1)}),noBackground:(0,a.css)({background:"inherit"}),fiscalYearField:(0,a.css)({marginBottom:0}),timeZoneContainer:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var j=e(47087),W=e(44922),B=e(80011),S=e(63527),w=e(45967),N=e(62348),M=e(18828),L=e(42211),A=e(93225),U=e(51182),F=e(35621),V=e(66630),K=e(41654);function G({onClose:Ne,onApply:Ae}){return(0,n.jsxs)(K.B,{gap:2,justifyContent:"space-between",children:[(0,n.jsx)(y.$n,{variant:"secondary",onClick:Ne,children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,n.jsx)(y.$n,{onClick:Ae,children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}G.displayName="Footer";var H=e(76319);function _({onClose:Ne}){return(0,n.jsxs)(K.B,{justifyContent:"space-between",children:[(0,n.jsx)(j.e,{children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,n.jsx)(H.K,{"data-testid":d.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,i.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Ne})]})}_.displayName="Header";const k=(Ne,Ae=!1)=>({container:(0,a.css)({top:0,position:"absolute",[`${Ae?"left":"right"}`]:"546px"}),modalContainer:(0,a.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,a.css)({display:"flex",flexDirection:"column",gap:Ne.spacing(1),padding:Ne.spacing(1),label:"calendar",boxShadow:Ne.shadows.z3,backgroundColor:Ne.colors.background.elevated,border:`1px solid ${Ne.colors.border.weak}`,borderRadius:Ne.shape.radius.default}),modal:(0,a.css)({label:"modal",boxShadow:Ne.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Ne.zIndex.modal})});function J(Ne){const Ae=(0,c.$j)(),{modalBackdrop:Ue}=(0,c.of)(F.o),Be=k(Ae,Ne.isReversed),{isOpen:We,isFullscreen:_e,onClose:Xe}=Ne,le=(0,s.createRef)(),{dialogProps:ye}=(0,M.s)({"aria-label":d.Tp.components.TimePicker.calendar.label},le),{overlayProps:pe}=(0,A.e)({isDismissable:!0,isOpen:We,onClose:Xe},le),ve=!_e;if(!We)return null;const be=(0,n.jsxs)("section",{className:Be.calendar,ref:le,...pe,...ye,"data-testid":d.Tp.components.TimePicker.calendar.label,children:[(0,n.jsx)(_,{...Ne}),(0,n.jsx)(V.nB,{...Ne}),ve&&(0,n.jsx)(G,{...Ne})]});return ve?(0,n.jsxs)(U.Sf,{children:[(0,n.jsx)("div",{className:Ue}),(0,n.jsx)(L.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{className:Be.modal,children:(0,n.jsx)("div",{className:Be.modalContainer,children:be})})})]}):(0,n.jsx)(L.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:Be.container,children:be})})}const z=(0,s.memo)(J);J.displayName="TimePickerCalendar";const Y={default:()=>(0,i.t)("time-picker.range-content.default-error",'Please enter a past date or "{{now}}"',{now:"now"}),range:()=>(0,i.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},X=Ne=>{const{value:Ae,isFullscreen:Ue=!1,timeZone:Be,onApply:We,isReversed:_e,fiscalYearStartMonth:Xe,onError:le,weekStart:ye}=Ne,[pe,ve]=q(Ae.raw.from,Ae.raw.to,Be),be=(0,c.of)(ne),[Oe,we]=(0,s.useState)(pe),[ze,Ve]=(0,s.useState)(ve),[ge,Ke]=(0,s.useState)(!1),qe=(0,s.useId)(),ot=(0,s.useId)();(0,s.useEffect)(()=>{const[un,On]=q(Ae.raw.from,Ae.raw.to,Be);we(un),Ve(On)},[Ae.raw.from,Ae.raw.to,Be]);const lt=(0,s.useCallback)(un=>{un.preventDefault(),Ke(!0)},[Ke]),mt=(0,s.useCallback)(()=>{if(ze.invalid||Oe.invalid)return;const un={from:Oe.value,to:ze.value},On=o.convertRawToRange(un,Be,Xe);We(On)},[Oe.invalid,Oe.value,We,Be,ze.invalid,ze.value,Xe]),Lt=(0,s.useCallback)((un,On)=>{const[yn,En]=q(un,On,Be);we(yn),Ve(En)},[Be]),Tt=un=>{un.key==="Enter"&&mt()},It=()=>{const un={from:Oe.value,to:ze.value};navigator.clipboard.writeText(JSON.stringify(un))},Mt=async()=>{const un=await navigator.clipboard.readText();let On;try{On=JSON.parse(un)}catch{le&&le(un);return}const[yn,En]=q(On.from,On.to,Be);we(yn),Ve(En)},Ut=o.convertRawToRange({from:"now/fy",to:"now/fy"},Be,Xe),an=(0,n.jsx)("div",{className:be.tooltip,children:o.isFiscal(Ae)?(0,n.jsx)(w.m,{content:(0,i.t)("time-picker.range-content.fiscal-year","Fiscal year: {{from}} - {{to}}",{from:Ut.from.format("MMM-DD"),to:Ut.to.format("MMM-DD")}),children:(0,n.jsx)(h.I,{name:"info-circle"})}):null}),cn=(0,n.jsx)(y.$n,{"aria-label":(0,i.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":d.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:lt});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:be.fieldContainer,children:[(0,n.jsx)(x.D,{label:(0,i.t)("time-picker.range-content.from-input","From"),invalid:Oe.invalid,error:Oe.errorMessage,children:(0,n.jsx)(S.p,{id:qe,onClick:un=>un.stopPropagation(),onChange:un=>Lt(un.currentTarget.value,ze.value),addonAfter:cn,onKeyDown:Tt,"data-testid":d.Tp.components.TimePicker.fromField,value:Oe.value})}),an]}),(0,n.jsxs)("div",{className:be.fieldContainer,children:[(0,n.jsx)(x.D,{label:(0,i.t)("time-picker.range-content.to-input","To"),invalid:ze.invalid,error:ze.errorMessage,children:(0,n.jsx)(S.p,{id:ot,onClick:un=>un.stopPropagation(),onChange:un=>Lt(Oe.value,un.currentTarget.value),addonAfter:cn,onKeyDown:Tt,"data-testid":d.Tp.components.TimePicker.toField,value:ze.value})}),an]}),(0,n.jsxs)("div",{className:be.buttonsContainer,children:[(0,n.jsx)(y.$n,{"data-testid":d.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,i.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:It}),(0,n.jsx)(y.$n,{"data-testid":d.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,i.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:Mt}),(0,n.jsx)(y.$n,{"data-testid":d.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:mt,children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,n.jsx)(z,{isFullscreen:Ue,isOpen:ge,from:(0,W.b)(Oe.value,{timeZone:Be}),to:(0,W.b)(ze.value,{timeZone:Be}),onApply:mt,onClose:()=>Ke(!1),onChange:Lt,timeZone:Be,isReversed:_e,weekStart:ye})]})};function Q(Ne,Ae,Ue){const Be={from:Ne,to:Ae},We=o.convertRawToRange(Be,Ue);return!(We.from.isSame(We.to)||We.from.isBefore(We.to))}function q(Ne,Ae,Ue){const Be=te(Ne,Ue),We=te(Ae,Ue),_e=!(0,N.f)(Be,!1,Ue),Xe=!(0,N.f)(We,!0,Ue),le=Q(Be,We,Ue)&&!Xe;return[{value:Be,invalid:_e||le,errorMessage:le&&!_e?Y.range():Y.default()},{value:We,invalid:Xe,errorMessage:Y.default()}]}function te(Ne,Ae){if((0,l.Ar)(Ne))return(0,B.LE)(Ne,{timeZone:Ae});if(Ne.endsWith("Z")){const Ue=(0,W.b)(Ne);return(0,B.LE)(Ue,{timeZone:Ae})}return Ne}function ne(Ne){return{fieldContainer:(0,a.css)({display:"flex"}),buttonsContainer:(0,a.css)({display:"flex",gap:Ne.spacing(.5),marginTop:Ne.spacing(1)}),tooltip:(0,a.css)({paddingLeft:Ne.spacing(1),paddingTop:Ne.spacing(3)})}}var se=e(44398),ue=e(29686),de=e(27629);const ie=(Ne,Ae)=>o.convertRawToRange({from:Ne.from,to:Ne.to},Ae),he={dateStyle:"short",timeStyle:"short"},me={dateStyle:"short",timeStyle:"medium"},ce=(Ne,Ae)=>{const Ue=(0,B.LE)(Ne.from,{timeZone:Ae}),Be=(0,B.LE)(Ne.to,{timeZone:Ae});let We=`${Ue} to ${Be}`;if((0,de.$)("localeFormatPreference")){const _e=Ne.from.toDate(),Xe=Ne.to.toDate(),le=_e.getSeconds()!==0||Xe.getSeconds()!==0;We=(0,ue.tX)(_e,Xe,le?me:he)}return{from:Ue,to:Be,display:We}},Pe=Ne=>{const{quickOptions:Ae=[],isReversed:Ue,isFullscreen:Be,hideQuickRanges:We,timeZone:_e,fiscalYearStartMonth:Xe,value:le,onChange:ye,history:pe,showHistory:ve,className:be,hideTimeZone:Oe,onChangeTimeZone:we,onChangeFiscalYearStartMonth:ze}=Ne,Ve=!pe?.length,ge=Be&&ve||!Be&&(ve&&!Ve||!We),Ke=(0,c.of)(tt,Ue,We,ge,Be),qe=Ge(pe,_e),ot=Qe(le.raw,Ae),[lt,mt]=(0,s.useState)(""),Lt=Ae.filter(It=>It.display.toLowerCase().includes(lt.toLowerCase())),Tt=It=>ye(ie(It));return(0,n.jsxs)("div",{id:"TimePickerContent",className:(0,a.cx)(Ke.container,be),children:[(0,n.jsxs)("div",{className:Ke.body,children:[(!Be||!We)&&(0,n.jsxs)("div",{className:Ke.rightSide,children:[(0,n.jsx)("div",{className:Ke.timeRangeFilter,children:(0,n.jsx)(p.Z,{width:0,value:lt,onChange:mt,placeholder:(0,i.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,n.jsxs)("div",{className:Ke.scrollContent,children:[!Be&&(0,n.jsx)(Se,{...Ne,historyOptions:qe}),!We&&(0,n.jsx)(se.l,{options:Lt,onChange:Tt,value:ot})]})]}),Be&&(0,n.jsx)("div",{className:Ke.leftSide,children:(0,n.jsx)(Me,{...Ne,historyOptions:qe})})]}),!Oe&&Be&&(0,n.jsx)(O,{timeZone:_e,fiscalYearStartMonth:Xe,onChangeTimeZone:we,onChangeFiscalYearStartMonth:ze})]})},Ie=Ne=>{const{widthOverride:Ae}=Ne,Ue=(0,c.$j)(),Be=(Ae||window.innerWidth)>=Ue.breakpoints.values.lg;return(0,n.jsx)(Pe,{...Ne,isFullscreen:Be})},Se=Ne=>{const{value:Ae,hideQuickRanges:Ue,onChange:Be,timeZone:We,historyOptions:_e=[],showHistory:Xe,onError:le,weekStart:ye}=Ne,pe=(0,c.of)(ke),ve=(0,l.Ar)(Ae.raw.from)||(0,l.Ar)(Ae.raw.to),[be,Oe]=(0,s.useState)(!ve),we=Ue?!1:be,ze=Ve=>Be(ie(Ve,We));return(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:pe.header,children:(0,n.jsxs)("button",{type:"button",className:pe.expandButton,onClick:()=>{Ue||Oe(!we)},"data-testid":d.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!we,"aria-controls":"expanded-timerange",children:[(0,n.jsx)(j.e,{children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!Ue&&(0,n.jsx)(h.I,{name:we?"angle-down":"angle-up"})]})}),!we&&(0,n.jsxs)("div",{className:pe.body,id:"expanded-timerange",children:[(0,n.jsx)("div",{className:pe.form,children:(0,n.jsx)(X,{value:Ae,onApply:Be,timeZone:We,isFullscreen:!1,onError:le,weekStart:ye})}),Xe&&(0,n.jsx)(se.l,{title:(0,i.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:_e,onChange:ze,placeholderEmpty:null})]})]})},Me=Ne=>{const{onChange:Ae,value:Ue,timeZone:Be,fiscalYearStartMonth:We,isReversed:_e,historyOptions:Xe,onError:le,weekStart:ye}=Ne,pe=(0,c.of)(He,Ne.hideQuickRanges),ve=be=>Ae(ie(be,Be));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:pe.container,children:[(0,n.jsx)("div",{className:pe.title,"data-testid":d.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,n.jsx)(j.e,{children:(0,n.jsx)(i.x6,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,n.jsx)(X,{value:Ue,timeZone:Be,fiscalYearStartMonth:We,onApply:Ae,isFullscreen:!0,isReversed:_e,onError:le,weekStart:ye})]}),Ne.showHistory&&(0,n.jsx)("div",{className:pe.recent,children:(0,n.jsx)(se.l,{title:(0,i.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Xe||[],onChange:ve,placeholderEmpty:(0,n.jsx)(Te,{})})})]})},Te=(0,s.memo)(()=>{const Ne=(0,c.of)(Re),Ae=(0,i.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,n.jsxs)("div",{className:Ne.container,children:[(0,n.jsx)("div",{children:(0,n.jsx)("span",{children:Ae})}),(0,n.jsx)(i.x6,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("a",{className:Ne.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,n.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function Ge(Ne,Ae){return!Array.isArray(Ne)||Ne.length===0?[]:Ne.map(Ue=>ce(Ue,Ae))}Te.displayName="EmptyRecentList";const Qe=(Ne,Ae)=>(0,s.useMemo)(()=>{if(o.isRelativeTimeRange(Ne))return Ae.find(Ue=>Ue.from===Ne.from&&Ue.to===Ne.to)},[Ne,Ae]),tt=(Ne,Ae,Ue,Be,We)=>({container:(0,a.css)({background:Ne.colors.background.elevated,boxShadow:Ne.shadows.z3,width:`${We?"546px":"262px"}`,borderRadius:Ne.shape.radius.default,border:`1px solid ${Ne.colors.border.weak}`,[`${Ae?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,a.css)({display:"flex",flexDirection:"row-reverse",height:`${Be?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,a.css)({display:"flex",flexDirection:"column",borderRight:`${Ae?"none":`1px solid ${Ne.colors.border.weak}`}`,width:`${Ue?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Ae?1:0}),rightSide:(0,a.css)({width:`${We?"40%":"100%"}; !important`,borderRight:Ae?`1px solid ${Ne.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,a.css)({padding:Ne.spacing(1)}),spacing:(0,a.css)({marginTop:"16px"}),scrollContent:(0,a.css)({overflowY:"auto",scrollbarWidth:"thin"})}),ke=Ne=>({header:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Ne.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,a.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,m.getFocusStyles)(Ne)}),body:(0,a.css)({borderBottom:`1px solid ${Ne.colors.border.weak}`}),form:(0,a.css)({padding:"7px 9px 7px 9px"})}),He=(Ne,Ae)=>({container:(0,a.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Ae?"11px":"20%"}),title:(0,a.css)({marginBottom:"11px"}),recent:(0,a.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Ne.spacing(1)})}),Re=Ne=>({container:(0,a.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,a.css)({color:Ne.colors.text.link})})},47087:(Z,R,e)=>{"use strict";e.d(R,{e:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(63142);const o=i=>({text:(0,a.css)({fontSize:i.typography.size.md,fontWeight:i.typography.fontWeightMedium,color:i.colors.text.primary,margin:0,display:"flex"})}),d=(0,s.memo)(({children:i})=>{const c=(0,l.of)(o);return(0,n.jsx)("h3",{className:c.text,children:i})});d.displayName="TimePickerTitle"},83692:(Z,R,e)=>{"use strict";e.d(R,{f:()=>i});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(91867),d=e(62348);const i=(0,s.memo)(function({hideText:p,value:h,timeZone:r="browser",placeholder:g="No time range selected",className:y}){const v=(0,l.of)(c);return p?null:(0,n.jsx)("span",{className:y,children:(0,d.X)(h)?(0,n.jsx)(o._8,{value:h,timeZone:r}):(0,n.jsx)("span",{className:v.placeholder,children:g})})}),c=m=>({placeholder:(0,a.css)({color:m.colors.text.disabled,opacity:1})})},44398:(Z,R,e)=>{"use strict";e.d(R,{l:()=>y});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(47087),i=e(24726),c=e(35484);const m=E=>({container:(0,a.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between",position:"relative"}),radio:(0,a.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,c.getFocusStyles)(E)}),label:(0,a.css)({cursor:"pointer",flex:1,padding:E.spacing(1),borderRadius:E.shape.radius.default,"&:hover":{background:E.colors.action.hover,cursor:"pointer"}}),labelSelected:(0,a.css)({background:E.colors.action.selected,"&::before":{backgroundImage:E.colors.gradients.brandVertical,borderRadius:E.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:E.spacing(.5),left:0,top:0}})}),p=(0,s.memo)(({value:E,onSelect:D,selected:C=!1,name:P})=>{const T=(0,o.of)(m),O=(0,i.A)();return(0,n.jsxs)("li",{className:T.container,children:[(0,n.jsx)("input",{className:T.radio,checked:C,name:P,type:"checkbox","data-role":"item",tabIndex:-1,id:O,onChange:()=>D(E)}),(0,n.jsx)("label",{className:(0,a.cx)(T.label,C&&T.labelSelected),htmlFor:O,children:E.display})]})});p.displayName="TimeRangeOption";const h=(E,D)=>(E%D+D)%D,r=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],g=({localRef:E,options:D})=>{const[C,P]=(0,s.useState)(0);return(0,s.useEffect)(()=>{const O=E.current?.querySelectorAll('[data-role="item"]')||[],I=Array.from(O).findIndex(W=>W.checked),j=I>=0?I:0;O.forEach((W,B)=>{W.tabIndex=B===j?0:-1}),P(j)},[E,D]),[O=>{const I=E?.current?.querySelectorAll('[data-role="item"]'),j=I?.length??0;r.indexOf(O.key)>-1&&(O.preventDefault(),O.key!=="Tab"&&O.stopPropagation());let W=null;switch(O.key){case"ArrowUp":W=h(C-1,j);break;case"ArrowDown":W=h(C+1,j);break;case"Home":W=0;break;case"End":W=j-1;break;case"Enter":I?.[C]?.click();break;default:break}W!==null&&(P(W),I?.[W]?.focus(),I?.forEach((B,S)=>{B.tabIndex=S===W?0:-1}))}]},y=E=>{const D=(0,o.of)(u),{title:C,options:P,placeholderEmpty:T}=E;return typeof T<"u"&&P.length<=0?(0,n.jsx)(n.Fragment,{children:T}):C?(0,n.jsx)("section",{"aria-label":C,children:(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:D.title,children:(0,n.jsx)(d.e,{children:C})}),(0,n.jsx)(v,{...E})]})}):(0,n.jsx)(v,{...E})},v=({options:E,value:D,onChange:C,title:P})=>{const T=(0,o.of)(b),O=(0,s.useRef)(null),[I]=g({localRef:O,options:E});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("ul",{role:"presentation",onKeyDown:I,ref:O,"aria-roledescription":(0,l.t)("time-picker.time-range.aria-role","Time range selection"),className:T.list,children:E.map((j,W)=>(0,n.jsx)(p,{value:j,selected:f(j,D),onSelect:C,name:P??(0,l.t)("time-picker.time-range.default-title","Time ranges")},x(j,W)))})})};function x(E,D){return`${E.from}-${E.to}-${D}`}function f(E,D){return!D||!E?!1:D.from===E.from&&D.to===E.to}const u=()=>({title:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),b=E=>({list:(0,a.css)({padding:E.spacing(.5)})})},59310:(Z,R,e)=>{"use strict";e.d(R,{U:()=>E});var n=e(74848),a=e(2543),s=e(96540),l=e(62717),o=e(92745),d=e(18857),i=e(22803),c=e(63142);const m=I=>{const{children:j,label:W}=I,B=(0,c.of)(p);return W?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:B.header,children:(0,n.jsx)("span",{className:B.label,children:W})}),j]}):(0,n.jsx)("div",{children:j})},p=I=>({header:(0,i.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${I.colors.border.weak}`,textTransform:"capitalize"}),label:(0,i.css)({fontSize:I.typography.size.sm,color:I.colors.text.secondary,fontWeight:I.typography.fontWeightMedium})});var h=e(44229),r=e(51898),g=e(30703),y=e(34788),v=e(27228);const x="tz-utc-offset",f=I=>{const{children:j,innerProps:W,innerRef:B,data:S,isSelected:w,isFocused:N}=I,M=(0,c.of)(b),L=Date.now(),A=(0,i.cx)(M.container,N&&M.containerFocused);if(!(0,a.isString)(S.value))return null;const U=(0,l.QZ)(S.value,L);return(0,n.jsx)("div",{className:A,...W,ref:B,"data-testid":r.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:(0,i.cx)(M.leftColumn,M.row),children:[(0,n.jsxs)("div",{className:(0,i.cx)(M.leftColumn,M.wideRow),children:[(0,n.jsx)(v.U,{title:j}),(0,n.jsx)("div",{className:M.spacer}),(0,n.jsx)(y.E,{info:U})]}),(0,n.jsxs)("div",{className:M.rightColumn,children:[(0,n.jsx)(h.X,{timeZone:U?.ianaName||S.value,timestamp:L,className:x}),w&&(0,n.jsx)("span",{children:(0,n.jsx)(g.I,{name:"check"})})]})]})})},u=I=>{const{children:j,innerProps:W,innerRef:B,data:S,isSelected:w,isFocused:N}=I,M=(0,c.of)(b),L=Date.now(),A=(0,i.cx)(M.container,N&&M.containerFocused);if(!(0,a.isString)(S.value))return null;const U=(0,l.QZ)(S.value,L);return(0,n.jsx)("div",{className:A,...W,ref:B,"data-testid":r.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:M.body,children:[(0,n.jsxs)("div",{className:M.row,children:[(0,n.jsx)("div",{className:M.leftColumn,children:(0,n.jsx)(v.U,{title:j})}),(0,n.jsx)("div",{className:M.rightColumn,children:w&&(0,n.jsx)("span",{children:(0,n.jsx)(g.I,{name:"check"})})})]}),(0,n.jsxs)("div",{className:M.row,children:[(0,n.jsx)("div",{className:M.leftColumn,children:(0,n.jsx)(y.E,{info:U})}),(0,n.jsx)("div",{className:M.rightColumn,children:(0,n.jsx)(h.X,{timestamp:L,timeZone:U?.ianaName||S.value,className:x})})]})]})})},b=I=>({container:(0,i.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:I.colors.action.hover}}),containerFocused:(0,i.css)({background:I.colors.action.hover}),body:(0,i.css)({display:"flex",fontWeight:I.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,i.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,i.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,i.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,i.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,i.css)({marginLeft:"6px"})}),E=I=>{const{onChange:j,width:W,autoFocus:B=!1,onBlur:S,value:w,includeInternal:N=!1,disabled:M=!1,inputId:L,menuShouldPortal:A=!0,openMenuOnFocus:U=!0}=I,F=D(N),V=C(F,w),K=T(),G=W&&W<=45?u:f,H=(0,s.useCallback)(_=>{if(!_||!(0,a.isString)(_.value))return j(w);j(_.value)},[j,w]);return(0,n.jsx)(d.l6,{inputId:L,value:V,placeholder:(0,o.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:B,menuShouldPortal:A,openMenuOnFocus:U,width:W,filterOption:K,options:F,onChange:H,onBlur:S,components:{Option:G,Group:m},disabled:M,"aria-label":(0,o.t)("time-picker.zone.select-aria-label","Time zone picker")})},D=I=>{const j=Date.now();return(0,s.useMemo)(()=>(0,l.U3)(I).map(B=>{const S=B.zones.reduce((w,N)=>{const M=(0,l.QZ)(N,j);if(!M)return w;const L=M.name.replace(/_/g," ");return w.push({label:L,value:M.zone,searchIndex:O(L,M,j)}),w},[]);return{label:B.name,options:S}}),[I,j])},C=(I,j)=>(0,s.useMemo)(()=>{if(j===void 0)return;const W=(0,a.toLower)(j);return I.find(S=>S.label?W.startsWith((0,a.toLower)(S.label)):P(W))?.options.find(S=>(0,a.isEmpty)(W)?S.value===l.g$.default:(0,a.toLower)(S.value)===W)},[I,j]),P=I=>{switch(I){case l.g$.default:case l.g$.localBrowserTime:case l.g$.utc:return!0;default:return!1}},T=()=>(0,s.useCallback)((I,j)=>!j||!I.data||!I.data.searchIndex?!0:I.data.searchIndex.indexOf((0,a.toLower)(j))>-1,[]),O=(I,j,W)=>{const B=[(0,a.toLower)(j.zone),(0,a.toLower)(j.abbreviation),(0,a.toLower)((0,h.t)(W,j.zone))];I!==j.zone&&B.push((0,a.toLower)(I));for(const S of j.countries)B.push((0,a.toLower)(S.name)),B.push((0,a.toLower)(S.code));return B.join("|")}},34788:(Z,R,e)=>{"use strict";e.d(R,{E:()=>o});var n=e(74848),a=e(22803),s=e(96540),l=e(63142);const o=({info:c})=>{const m=(0,l.of)(i),p=d(c);return c?(0,n.jsx)("div",{className:m.description,children:p}):null},d=c=>(0,s.useMemo)(()=>{const m=[];if(!c)return"";if(c.name==="Europe/Simferopol")return"Ukraine, EEST";if(c.countries.length>0){const p=c.countries[0];m.push(p.name)}return c.abbreviation&&m.push(c.abbreviation),m.join(", ")},[c]),i=c=>({description:(0,a.css)({fontWeight:"normal",fontSize:c.typography.size.sm,color:c.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},44229:(Z,R,e)=>{"use strict";e.d(R,{X:()=>i,t:()=>c});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(80011),d=e(63142);const i=p=>{const{timestamp:h,timeZone:r,className:g}=p,y=(0,d.of)(m);return(0,s.isString)(r)?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{className:(0,a.cx)(y.offset,g),children:c(h,r)})}):null},c=(p,h)=>`UTC${(0,o.LE)(p,{timeZone:h,format:"Z"})}`,m=p=>{const h=(0,a.css)({fontWeight:"normal",fontSize:p.typography.size.sm,color:p.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,a.css)(h,{color:p.colors.text.primary,background:p.colors.background.secondary,padding:"2px 5px",borderRadius:p.shape.radius.default,marginLeft:"4px"})}}},27228:(Z,R,e)=>{"use strict";e.d(R,{U:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({title:d})=>{const i=(0,s.of)(o);return d?(0,n.jsx)("span",{className:i.title,children:d}):null},o=d=>({title:(0,a.css)({fontWeight:d.typography.fontWeightRegular,textOverflow:"ellipsis"})})},5857:(Z,R,e)=>{"use strict";e.d(R,{l6:()=>c,rE:()=>d,rL:()=>i});var n=e(74848),a=e(96540),s=e(51898),l=e(92745),o=e(43243);function d(m){return["saturday","sunday","monday"].includes(m)}function i(m){if(m&&d(m))return m;const p=window?.grafanaBootData?.user?.weekStart;return p&&d(p)?p:"monday"}const c=m=>{const{onChange:p,width:h,autoFocus:r=!1,onBlur:g,value:y,disabled:v=!1,inputId:x}=m,f=(0,a.useMemo)(()=>[{value:"",label:(0,l.t)("grafana-ui.week-start-picker.weekStarts-label-default","Default")},{value:"saturday",label:(0,l.t)("grafana-ui.week-start-picker.weekStarts-label-saturday","Saturday")},{value:"sunday",label:(0,l.t)("grafana-ui.week-start-picker.weekStarts-label-sunday","Sunday")},{value:"monday",label:(0,l.t)("grafana-ui.week-start-picker.weekStarts-label-monday","Monday")}],[]),u=(0,a.useCallback)(E=>{E&&E.value!==void 0&&p(d(E.value)?E.value:void 0)},[p]),b=(0,a.useMemo)(()=>f.find(E=>E.value===y)?.value??"",[y,f]);return(0,n.jsx)(o.G,{id:x,value:b,placeholder:s.Tp.components.WeekStartPicker.placeholder,autoFocus:r,width:h,options:f,onChange:u,onBlur:g,disabled:v})}},8431:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>a,o:()=>n});const n=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],a=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},62348:(Z,R,e)=>{"use strict";e.d(R,{X:()=>o,f:()=>l});var n=e(25229),a=e(33239),s=e(44922);function l(d,i,c){return(0,n.Ar)(d)?d.isValid():a.isMathString(d)?a.isValid(d):(0,s.b)(d,{roundUp:i,timeZone:c}).isValid()}function o(d){return a.isValid(d.from)&&a.isValid(d.to)}},41e3:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>a});var n=e(62717);function a(s,l){const o=(0,n.HD)(l);if(!o)return s;const d=o.utcOffset(s.getTime()),i=s.getTimezoneOffset(),c=d-i;return new Date(s.getTime()-c*1e3*60)}},3271:(Z,R,e)=>{"use strict";e.d(R,{c:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({direction:d="horizontal",spacing:i=2})=>{const c=(0,s.of)(o,i);return d==="vertical"?(0,n.jsx)("div",{className:c.verticalDivider}):(0,n.jsx)("hr",{className:c.horizontalDivider})};l.displayName="Divider";const o=(d,i)=>({horizontalDivider:(0,a.css)({borderTop:`1px solid ${d.colors.border.weak}`,margin:d.spacing(i,0),width:"100%"}),verticalDivider:(0,a.css)({borderRight:`1px solid ${d.colors.border.weak}`,margin:d.spacing(0,i),height:"100%"})})},45897:(Z,R,e)=>{"use strict";e.d(R,{l:()=>a});var n=e(22803);const a=(s,l)=>{const o=l||"middle",d=s.colors.emphasize(s.colors.background.secondary,.15),i=s.colors.primary.border,c=s.spacing(2),m=4,p=200;let h="50%",r="50%";switch(o){case"start":{h="0%",r="0%";break}case"end":{h="100%",r="100%";break}}const g=(0,n.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:s.transitions.create("border-color"),zIndex:1},"&:after":{background:d,content:'""',position:"absolute",transition:s.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:s.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:i},"&:after":{background:i}}}),y={borderRight:"1px solid transparent",height:"100%",left:h,transform:"translateX(-50%)"},v={borderTop:"1px solid transparent",top:r,transform:"translateY(-50%)"};return{dragHandleVertical:(0,n.cx)(g,(0,n.css)({cursor:"col-resize",width:c,"&:before":y,"&:after":{left:h,top:"50%",height:p,width:m}})),dragHandleHorizontal:(0,n.cx)(g,(0,n.css)({height:c,cursor:"row-resize","&:before":v,"&:after":{left:"50%",top:r,height:m,width:p}})),dragHandleBaseVertical:(0,n.cx)(g,(0,n.css)({cursor:"col-resize",width:c,"&:before":y})),dragHandleBaseHorizontal:(0,n.cx)(g,(0,n.css)({cursor:"row-resize",height:c,"&:before":v}))}}},8207:(Z,R,e)=>{"use strict";e.d(R,{_:()=>x});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(8772),i=e(96540),c=e(51898),m=e(92745),p=e(63142),h=e(45897),r=e(76319),g=e(92807),y=e(66404);const v={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function x({children:C,onClose:P,closeOnMaskClick:T=!0,scrollableContent:O=!0,title:I,subtitle:j,width:W,size:B="md",tabs:S}){const[w,N,M]=f(),L=(0,p.of)(E),A=(0,p.of)(D,B),U=(0,p.of)(h.l),F=i.useRef(null),{dialogProps:V,titleProps:K}=(0,s.s)({},F),{overlayProps:G}=(0,o.e)({isDismissable:!1,isOpen:!0,onClose:P},F);b();const H=(0,n.jsx)("div",{className:L.content,children:C}),_=w??W??v[B].width,k=v[B].minWidth;return(0,n.jsx)(d.A,{open:!0,onClose:P,placement:"right",getContainer:".main-view",className:L.drawerContent,rootClassName:L.drawer,classNames:{wrapper:A},styles:{wrapper:{width:_,minWidth:k}},width:"",motion:{motionAppear:!0,motionName:L.drawerMotion},maskClassName:L.mask,maskClosable:T,maskMotion:{motionAppear:!0,motionName:L.maskMotion},children:(0,n.jsx)(l.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,n.jsxs)("div",{"aria-label":typeof I=="string"?c.Tp.components.Drawer.General.title(I):c.Tp.components.Drawer.General.title("no title"),className:L.container,...G,...V,ref:F,children:[(0,n.jsx)("div",{className:(0,a.cx)(U.dragHandleVertical,L.resizer),onMouseDown:N,onTouchStart:M}),(0,n.jsxs)("div",{className:(0,a.cx)(L.header,!!S&&L.headerWithTabs),children:[(0,n.jsx)("div",{className:L.actions,children:(0,n.jsx)(r.K,{name:"times",variant:"secondary",onClick:P,"data-testid":c.Tp.components.Drawer.General.close,tooltip:(0,m.t)("grafana-ui.drawer.close","Close")})}),typeof I=="string"?(0,n.jsxs)("div",{className:L.titleWrapper,children:[(0,n.jsx)(y.E,{element:"h3",...K,children:I}),j&&(0,n.jsx)("div",{className:L.subtitle,"data-testid":c.Tp.components.Drawer.General.subtitle,children:j})]}):I,S&&(0,n.jsx)("div",{className:L.tabsWrapper,children:S})]}),O?(0,n.jsx)(g.P,{showScrollIndicators:!0,children:H}):H]})})})}function f(){const[C,P]=(0,i.useState)(void 0),T=(0,i.useCallback)(S=>{P(u(S.clientX))},[]),O=(0,i.useCallback)(S=>{const w=S.touches[0];P(u(w.clientX))},[]),I=(0,i.useCallback)(S=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",I)},[T]),j=(0,i.useCallback)(S=>{document.removeEventListener("touchmove",O),document.removeEventListener("touchend",j)},[O]);function W(S){S.stopPropagation(),S.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("mouseup",I)}function B(S){S.stopPropagation(),S.preventDefault(),document.addEventListener("touchmove",O),document.addEventListener("touchend",j)}return[C,W,B]}function u(C){let P=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(P/document.body.clientWidth*100,98).toFixed(2)}vw`}function b(){(0,i.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const E=C=>({container:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,a.css)({top:0,".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,a.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,a.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,a.css)({backgroundColor:"transparent !important",position:"fixed !important","&:before":{backgroundColor:`${C.components.overlay.background} !important`,bottom:0,content:'""',left:0,position:"fixed",right:0,top:0}}),maskMotion:(0,a.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,a.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,a.css)({borderBottom:"none"}),actions:(0,a.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,a.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,a.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,a.css)({padding:C.spacing(C.components.drawer?.padding??2),height:"100%",flexGrow:1,minHeight:0}),tabsWrapper:(0,a.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,a.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function D(C,P){return(0,a.css)({label:`drawer-content-wrapper-${P}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},15356:(Z,R,e)=>{"use strict";e.d(R,{f:()=>g});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(42211),i=e(96540),c=e(63142),m=e(87063),p=e(94535),h=e(7895);const r=v=>{const{className:x,options:f,value:u,onChange:b,narrow:E,variant:D,...C}=v,P=(0,c.of)(y),[T,O]=(0,i.useState)(!1),I=[(0,s.cY)(0),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:j,refs:W,floatingStyles:B}=(0,l.we)({open:T,placement:"bottom-end",onOpenChange:O,middleware:I,whileElementsMounted:o.ll}),S=(0,l.kp)(j),w=(0,l.s9)(j),{getReferenceProps:N,getFloatingProps:M}=(0,l.bv)([w,S]),L=A=>{b(A),O(!1)};return(0,n.jsxs)("div",{className:P.wrapper,children:[(0,n.jsx)(h.I,{className:x,isOpen:T,narrow:E,variant:D,ref:W.setReference,...N(),...C,children:u?.label||(u?.value!=null?String(u?.value):null)}),T&&(0,n.jsx)("div",{className:P.menuWrapper,ref:W.setFloating,...M(),style:B,children:(0,n.jsx)(d.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)(m.W,{tabIndex:-1,onClose:()=>O(!1),children:f.map(A=>(0,n.jsx)(p.D,{label:A.label??String(A.value),onClick:()=>L(A),active:A.value===u?.value,ariaChecked:A.value===u?.value,ariaLabel:A.ariaLabel||A.label,disabled:A.isDisabled,component:A.component,role:"menuitemradio"},`${A.value}`))})})})]})};r.displayName="ButtonSelect";const g=(0,i.memo)(r),y=v=>({wrapper:(0,a.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,a.css)({zIndex:v.zIndex.dropdown})})},88559:(Z,R,e)=>{"use strict";e.d(R,{m:()=>r});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(96540),i=e(66588),c=e(63142),m=e(44019),p=e(71495),h=e(15245);const r=d.memo(({children:y,overlay:v,placement:x,offset:f,onVisibleChange:u})=>{const[b,E]=(0,d.useState)(!1),D=(0,d.useRef)(null),C=(0,d.useCallback)(A=>{E(A),u?.(A)},[u]),P=[(0,s.cY)({mainAxis:f?.[0]??8,crossAxis:f?.[1]??0}),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:T,refs:O,floatingStyles:I}=(0,l.we)({open:b,placement:(0,p.O)(x),onOpenChange:C,middleware:P,whileElementsMounted:o.ll}),j=(0,l.kp)(T),W=(0,l.s9)(T),{getReferenceProps:B,getFloatingProps:S}=(0,l.bv)([W,j]),w=150,N=(0,c.of)(g,w),M=()=>{C(!1)},L=A=>{A.key==="Tab"&&C(!1)};return(0,n.jsxs)(n.Fragment,{children:[d.cloneElement(y,{ref:O.setReference,...B()}),b&&(0,n.jsx)(h.ZL,{children:(0,n.jsx)(l.s3,{context:T,children:(0,n.jsx)("div",{ref:O.setFloating,style:I,onClick:M,onKeyDown:L,children:(0,n.jsx)(i.A,{nodeRef:D,appear:!0,in:!0,timeout:{appear:w,exit:0,enter:0},classNames:N,children:(0,n.jsx)("div",{ref:D,children:(0,m.renderOrCallToRender)(v,{...S()})})})})})})]})});r.displayName="Dropdown";const g=(y,v)=>({appear:(0,a.css)({opacity:"0",position:"relative",transformOrigin:"top",[y.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,a.css)({opacity:"1",[y.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${v}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${v}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},56887:(Z,R,e)=>{"use strict";e.d(R,{_:()=>a,y:()=>s});var n=e(96540);const a=(0,n.createContext)(void 0);function s(l){if(!l)return{};const o=(0,n.useContext)(a);if(!o)return{};const d=o.selected.some(m=>m.id===l),i=(0,n.useCallback)((m,p={})=>{o.enabled&&(m.stopPropagation(),m.shiftKey&&(m.preventDefault(),window.getSelection()?.empty()),o.onSelect({id:l},{...p,multi:p.multi??m.shiftKey}))},[o,l]),c=(0,n.useCallback)(()=>{o.enabled&&o.onClear()},[o]);return{isSelected:d,onSelect:i,onClear:c,isSelectable:o.enabled}}},74451:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d})=>{const i=(0,s.of)(o);return(0,n.jsx)("div",{className:i.container,children:d})},o=d=>({container:(0,a.css)({borderLeft:`3px solid ${d.colors.info.main}`,backgroundColor:`${d.colors.background.secondary}`,padding:d.spacing(2),minWidth:"350px",borderRadius:d.shape.radius.default,marginBottom:d.spacing(4)})})},50201:(Z,R,e)=>{"use strict";e.d(R,{p:()=>D});var n=e(74848),a=e(22803),s=e(55494),l=e(63142),o=e(31286),d=e(41654),i=e(66404),c=e(36348);const m=({width:T="auto",height:O})=>{const I=(0,l.of)(p);return(0,n.jsx)(s.default,{src:c,className:I.svg,height:O,width:T})};m.displayName="GrotCTA";const p=T=>({svg:(0,a.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:T.isDark?"#58558c":"#c9c5f4"}})});var h=e(96540),r=e(22687);const g=-20,y=5,v=-5,x=5,f=({width:T="auto",height:O})=>{const I=(0,h.useRef)(null),j=(0,l.of)(u);return(0,h.useEffect)(()=>{const W=B=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const S=I.current?.querySelector("#grot-not-found-arm"),w=I.current?.querySelector("#grot-not-found-magnifier"),{clientX:N,clientY:M}=B,{innerWidth:L,innerHeight:A}=window,U=M/A,F=N/L,V=b(U,g,y),K=b(F,v,x);window.requestAnimationFrame(()=>{S?.setAttribute("style",`transform: rotate(${V}deg) translateX(${K}%)`),w?.setAttribute("style",`transform: rotate(${V}deg) translateX(${K}%)`)})};return window.addEventListener("mousemove",W),()=>{window.removeEventListener("mousemove",W)}},[]),(0,n.jsx)(s.default,{innerRef:I,src:r,className:j.svg,height:O,width:T})};f.displayName="GrotNotFound";const u=T=>({svg:(0,a.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),b=(T,O,I)=>T*(I-O)+O;var E=e(9886);const D=({button:T,children:O,image:I,message:j,hideImage:W=!1,variant:B,role:S})=>{const w=(0,l.of)(P),N=I??C(B);return(0,n.jsx)(o.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:S,children:(0,n.jsxs)("div",{className:w.container,children:[!W&&N,(0,n.jsxs)(d.B,{direction:"column",alignItems:"center",children:[(0,n.jsx)(i.E,{variant:"h4",textAlignment:"center",children:j}),O&&(0,n.jsx)(i.E,{color:"secondary",textAlignment:"center",children:O})]}),T]})})};function C(T){switch(T){case"call-to-action":return(0,n.jsx)(m,{width:300});case"not-found":return(0,n.jsx)(f,{width:300});case"completed":return(0,n.jsx)(s.default,{src:E,width:300});default:throw new Error(`Unknown variant: ${T}`)}}const P=T=>({container:(0,a.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:T.spacing(4),maxWidth:"600px"})})},36303:(Z,R,e)=>{"use strict";e.d(R,{Xc:()=>c,Xw:()=>i,tH:()=>d});var n=e(74848),a=e(96540),s=e(32631),l=e(34999),o=e(56297);class d extends a.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(p,h){const r=this.props.errorLogger??s.P?.api?.pushError;r&&r(p),this.setState({error:p,errorInfo:h}),this.props.onError&&this.props.onError(p)}componentDidUpdate(p){const{dependencies:h,onRecover:r}=this.props;if(this.state.error&&h&&p.dependencies){for(let g=0;g<h.length;g++)if(h[g]!==p.dependencies[g]){this.setState({error:null,errorInfo:null}),r&&r();break}}}render(){const{children:p}=this.props,{error:h,errorInfo:r}=this.state;return p({error:h,errorInfo:r})}}class i extends a.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:p,children:h,style:r,dependencies:g,errorLogger:y}=this.props;return(0,n.jsx)(d,{dependencies:g,errorLogger:y,children:({error:v,errorInfo:x})=>x?r==="alertbox"?(0,n.jsx)(l.F,{title:p||"",children:(0,n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[v&&v.toString(),(0,n.jsx)("br",{}),x.componentStack]})}):(0,n.jsx)(o.D,{title:p||"",error:v,errorInfo:x}):h})}}function c(m,p={}){const h=r=>(0,n.jsx)(i,{...p,children:(0,n.jsx)(m,{...r})});return h.displayName="WithErrorBoundary",h}},991:(Z,R,e)=>{"use strict";e.d(R,{y:()=>o});var n=e(74848),a=e(1906),s=e(92745),l=e(99887);const o=({featureState:i,tooltip:c})=>{const m=d(i);return(0,n.jsx)(l.E,{text:m.text,color:m.color,icon:m.icon,tooltip:c})};function d(i){switch(i){case a.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case a.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case a.Ay.experimental:return{text:(0,s.t)("grafana-ui.feature-badge.experimental","Experimental"),icon:"exclamation-triangle",color:"orange"};case a.Ay.preview:return{text:(0,s.t)("grafana-ui.feature-badge.preview","Preview"),icon:"rocket",color:"blue"};case a.Ay.privatePreview:return{text:(0,s.t)("grafana-ui.feature-badge.private-preview","Private preview"),icon:"rocket",color:"blue"};case a.Ay.new:return{text:(0,s.t)("grafana-ui.feature-badge.new","New!"),icon:"rocket",color:"blue"}}}},40279:(Z,R,e)=>{"use strict";e.d(R,{gH:()=>g,wI:()=>x});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(10824),i=e(55386),c=e(92745),m=e(63142),p=e(34999),h=e(30703),r=e(48431);function g({options:D,children:C,readAs:P,onLoad:T,fileListRenderer:O,onFileRemove:I}){const[j,W]=(0,o.useState)([]),[B,S]=(0,o.useState)([]),w=(0,i.j_)("decbytes")(D?.maxSize?D?.maxSize:0),N=(0,o.useCallback)((J,z)=>{W(Y=>Y.map(X=>(X.id===J.id&&z(X),X)))},[]),M=(0,o.useCallback)((J,z,Y)=>{let X=J.map(b);if(D?.multiple===!1?W(X):W(Q=>[...Q,...X]),H(z),D?.onDrop)D.onDrop(J,z,Y);else for(const Q of X){const q=new FileReader,te=()=>{P?q[P](Q.file):q.readAsText(Q.file)};N(Q,ne=>{ne.abortUpload=()=>{q.abort()},ne.retryUpload=()=>{N(Q,se=>{se.error=null,se.progress=void 0}),te()}}),q.onabort=()=>{N(Q,ne=>{ne.error=new DOMException("Aborted")})},q.onprogress=ne=>{N(Q,se=>{se.progress=ne.loaded})},q.onload=()=>{T?.(q.result)},q.onerror=()=>{N(Q,ne=>{ne.error=q.error})},te()}},[T,D,P,N]),L=J=>{const z=j.filter(Y=>J.id!==Y.id);W(z),I?.(J)},{getRootProps:A,getInputProps:U,isDragActive:F}=(0,d.VB)({...D,useFsAccessApi:!1,onDrop:M,accept:v(D?.accept)}),V=(0,m.$j)(),K=E(V,F),G=j.map(J=>O?O(J,L):(0,n.jsx)(r.I,{file:J,removeFile:L},J.id)),H=J=>{let z=[];J.map(Y=>{Y.errors.map(X=>{z.findIndex(Q=>Q.code===X.code&&Q.message===X.message)===-1&&z.push(X)})}),S(z)},_=J=>{const z=(0,i.cN)(w);return(0,n.jsx)("div",{className:K.errorAlert,children:(0,n.jsx)(p.F,{title:(0,c.t)("grafana-ui.file-dropzone.error-title","Upload failed"),severity:"error",onRemove:k,children:J.map(Y=>{switch(Y.code){case d.O4.FileTooLarge:return(0,n.jsx)("div",{children:(0,n.jsxs)(c.x6,{i18nKey:"grafana-ui.file-dropzone.file-too-large",children:["File is larger than ",{size:z}]})},Y.message+Y.code);default:return(0,n.jsx)("div",{children:Y.message},Y.message+Y.code)}})})})},k=()=>{S([])};return(0,n.jsxs)("div",{className:K.container,children:[(0,n.jsxs)("div",{"data-testid":"dropzone",...A({className:K.dropzone}),children:[(0,n.jsx)("input",{...U()}),C??(0,n.jsx)(x,{primaryText:f(j,D)})]}),B.length>0&&_(B),(0,n.jsxs)("small",{className:(0,a.cx)(K.small,K.acceptContainer),children:[D?.maxSize&&`Max file size: ${(0,i.cN)(w)}`,D?.maxSize&&D?.accept&&(0,n.jsx)("span",{className:K.acceptSeparator,children:"|"}),D?.accept&&u(D.accept)]}),G]})}function y(D){return["txt","json","csv","xls","yml"].some(C=>D.match(C))?"text/plain":"application/octet-stream"}function v(D){return(0,s.isString)(D)?{[y(D)]:[D]}:Array.isArray(D)?D.reduce((C,P)=>{const T=y(P);return C[T]=C[T]?[...C[T],P]:[P],C},{}):D}function x({primaryText:D="Drop file here or click to upload",secondaryText:C=""}){const P=(0,m.$j)(),T=E(P);return(0,n.jsxs)("div",{className:(0,a.cx)(T.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,n.jsx)(h.I,{className:(0,a.cx)(T.icon),name:"upload",size:"xl"}),(0,n.jsx)("h6",{className:(0,a.cx)(T.primaryText),children:D}),(0,n.jsx)("small",{className:T.small,children:C})]})}function f(D,C){return C?.multiple===void 0||C?.multiple?"Upload file":D.length?"Replace file":"Upload file"}function u(D){return(0,s.isString)(D)?`Accepted file type: ${D}`:Array.isArray(D)?`Accepted file types: ${D.join(", ")}`:`Accepted file types: ${Object.values(D).flat().join(", ")}`}function b(D){return{id:(0,s.uniqueId)("file"),file:D,error:null}}function E(D,C){return{container:(0,a.css)({display:"flex",flexDirection:"column",width:"100%",padding:D.spacing(2),borderRadius:D.shape.radius.default,border:`1px dashed ${D.colors.border.strong}`,backgroundColor:C?D.colors.background.secondary:D.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,a.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,a.css)({textAlign:"center"}),icon:(0,a.css)({marginBottom:D.spacing(1)}),primaryText:(0,a.css)({marginBottom:D.spacing(1)}),acceptContainer:(0,a.css)({textAlign:"center",margin:0}),acceptSeparator:(0,a.css)({margin:`0 ${D.spacing(1)}`}),small:(0,a.css)({color:D.colors.text.secondary}),errorAlert:(0,a.css)({paddingTop:"10px"})}}},48431:(Z,R,e)=>{"use strict";e.d(R,{I:()=>h});var n=e(74848),a=e(22803),s=e(55386),l=e(92745),o=e(63142),d=e(28473),i=e(45861),c=e(30703),m=e(76319);const p="Remove file";function h({file:g,removeFile:y}){const v=(0,o.of)(r),{file:x,progress:f,error:u,abortUpload:b,retryUpload:E}=g,D=()=>u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:v.error,children:u.message}),E&&(0,n.jsx)(m.K,{name:"sync",tooltip:(0,l.t)("grafana-ui.file-dropzone.item-retry","Retry"),tooltipPlacement:"top",onClick:E}),y&&(0,n.jsx)(m.K,{className:E?v.marginLeft:"",name:"trash-alt",onClick:()=>y(g),tooltip:p})]}):f&&x.size>f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("progress",{className:v.progressBar,max:x.size,value:f}),(0,n.jsxs)("span",{className:v.paddingLeft,children:[Math.round(f/x.size*100),"%"]}),b&&(0,n.jsx)(i.$n,{variant:"secondary",type:"button",fill:"text",onClick:b,children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.file-dropzone.cancel-upload",children:"Cancel upload"})})]}):y&&(0,n.jsx)(m.K,{name:"trash-alt",onClick:()=>y(g),tooltip:p,tooltipPlacement:"top"}),C=(0,s.j_)("decbytes")(x.size);return(0,n.jsxs)("div",{className:v.fileListContainer,children:[(0,n.jsxs)("span",{className:v.fileNameWrapper,children:[(0,n.jsx)(c.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,n.jsx)("span",{className:v.padding,children:(0,d.i)(x.name)}),(0,n.jsx)("span",{children:(0,s.cN)(C)})]}),(0,n.jsx)("div",{className:v.fileNameWrapper,children:D()})]})}function r(g){return{fileListContainer:(0,a.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:g.spacing(2),border:`1px dashed ${g.colors.border.medium}`,backgroundColor:`${g.colors.background.secondary}`,marginTop:g.spacing(1)}),fileNameWrapper:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,a.css)({padding:g.spacing(0,1)}),paddingLeft:(0,a.css)({paddingLeft:g.spacing(2)}),marginLeft:(0,a.css)({marginLeft:g.spacing(1)}),error:(0,a.css)({paddingRight:g.spacing(2),color:g.colors.error.text}),progressBar:(0,a.css)({borderRadius:g.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:g.colors.border.weak,borderRadius:g.shape.radius.default},"::-webkit-progress-value":{backgroundColor:g.colors.primary.main,borderRadius:g.shape.radius.default}})}}},57688:(Z,R,e)=>{"use strict";e.d(R,{e:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(24726),o=e(51898),d=e(92745),i=e(63142),c=e(35484),m=e(28473),p=e(45861),h=e(30703);const r=({onFileUpload:y,className:v,children:x="Upload file",accept:f="*",size:u="md",showFileName:b})=>{const E=(0,i.of)(g(u)),[D,C]=(0,s.useState)(""),P=(0,l.A)(),T=(0,s.useCallback)(O=>{const I=O.currentTarget?.files?.[0];I&&C(I.name??""),y(O)},[y]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"file",id:P,className:E.fileUpload,onChange:T,multiple:!1,accept:f,"data-testid":o.Tp.components.FileUpload.inputField}),(0,n.jsxs)("label",{htmlFor:P,className:(0,a.cx)(E.labelWrapper,v),children:[(0,n.jsx)(h.I,{name:"upload",className:E.icon}),x]}),b&&D&&(0,n.jsx)("span",{"aria-label":(0,d.t)("grafana-ui.file-upload.file-name","File name"),className:E.fileName,"data-testid":o.Tp.components.FileUpload.fileNameSpan,children:(0,m.i)(D)})]})},g=y=>v=>{const x=(0,p.hs)({theme:v,variant:"primary",size:y,iconOnly:!1}),f=(0,c.getFocusStyles)(v);return{fileUpload:(0,a.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":f,"&:focus-visible + label":f}),labelWrapper:x.button,icon:x.icon,fileName:(0,a.css)({marginLeft:v.spacing(.5)})}}},12737:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>m});var n=e(74848),a=e(96540),s=e(8934),l=e(92745);function o(...p){const h=a.useRef(null);return a.useEffect(()=>{p.forEach(r=>{r&&(typeof r=="function"?r(h.current):r.current=h.current)})},[p]),h}var d=e(45861),i=e(30703),c=e(63527);const m=(0,a.forwardRef)(({value:p,width:h,onChange:r,escapeRegex:g=!0,...y},v)=>{const x=(0,a.useRef)(null),f=o(v,x),u=p!==""?(0,n.jsx)(d.$n,{icon:"times",fill:"text",size:"sm",onClick:b=>{x.current?.focus(),r(""),b.stopPropagation()},children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.filter-input.clear",children:"Clear"})}):null;return(0,n.jsx)(c.p,{prefix:(0,n.jsx)(i.I,{name:"search"}),suffix:u,width:h,type:"text",value:g?(0,s.xb)(p??""):p,onChange:b=>r(g?(0,s.jD)(b.currentTarget.value):b.currentTarget.value),...y,ref:f})});m.displayName="FilterInput"},34343:(Z,R,e)=>{"use strict";e.d(R,{m:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(45861),o=e(30703);const d=({label:c,selected:m,onClick:p,icon:h="check"})=>{const r=(0,s.of)(i),g=(0,s.of)(l.my);return(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(g,r.wrapper,m&&r.selected),onClick:p,children:[(0,n.jsx)("span",{children:c}),m&&(0,n.jsx)(o.I,{name:h,className:r.icon,"data-testid":"filter-pill-icon"})]})},i=c=>({wrapper:(0,a.css)({background:c.colors.background.secondary,borderRadius:c.shape.radius.pill,padding:c.spacing(0,2),fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.fontWeightMedium,lineHeight:c.typography.bodySmall.lineHeight,color:c.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${c.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:c.colors.action.hover,color:c.colors.text.primary}}),selected:(0,a.css)({color:c.colors.text.primary,background:c.colors.action.selected,"&:hover":{background:c.colors.action.focus}}),icon:(0,a.css)({marginLeft:c.spacing(.5)})})},94959:(Z,R,e)=>{"use strict";e.d(R,{z:()=>l});var n=e(74848),a=e(22803),s=e(51115);const l=({label:d,tooltip:i,labelWidth:c=6,inputWidth:m=12,inputEl:p,className:h,interactive:r,...g})=>{const y=o();return(0,n.jsxs)("div",{className:(0,a.cx)(y.formField,h),children:[(0,n.jsx)(s.I,{width:c,tooltip:i,interactive:r,children:d}),p||(0,n.jsx)("input",{type:"text",className:`gf-form-input ${m?`width-${m}`:""}`,...g,disabled:g.disabled})]})};l.displayName="FormField";const o=()=>({formField:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},51115:(Z,R,e)=>{"use strict";e.d(R,{I:()=>i});var n=e(74848),a=e(46942),s=e.n(a),l=e(30703),o=e(45967);const i=({children:c,isFocused:m,isInvalid:p,className:h,htmlFor:r,tooltip:g,width:y,interactive:v,...x})=>{const f=s()(h,`gf-form-label width-${y||"10"}`,{"gf-form-label--is-focused":m,"gf-form-label--is-invalid":p});return(0,n.jsxs)("label",{className:f,...x,htmlFor:r,children:[c,g&&(0,n.jsx)(o.m,{placement:"top",content:g,theme:"info",interactive:v,children:(0,n.jsx)(l.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},21539:(Z,R,e)=>{"use strict";e.d(R,{i:()=>s});var n=e(74848);function a(l){return l<20?.9:l<26?.8:.6}const s=({value:l,className:o,style:d,...i})=>{const c=(l.prefix??"").length>0,m=(l.suffix??"").length>0;let p;if(d&&typeof d.fontSize=="number"&&!Number.isNaN(d.fontSize)){const h=d.fontSize,r=a(h);p={fontSize:h*r}}return(0,n.jsx)("div",{className:o,style:d,...i,children:(0,n.jsxs)("div",{children:[c&&(0,n.jsx)("span",{children:l.prefix}),(0,n.jsx)("span",{children:l.text}),m&&(0,n.jsx)("span",{style:p,children:l.suffix})]})})};s.displayName="FormattedDisplayValue"},32635:(Z,R,e)=>{"use strict";e.d(R,{S:()=>i});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(35484),d=e(72636);const i=s.forwardRef(({label:m,description:p,value:h,htmlValue:r,onChange:g,disabled:y,className:v,indeterminate:x,invalid:f,...u},b)=>{const E=(0,s.useCallback)(P=>{g&&g(P)},[g]),D=(0,l.of)(c,f),C=x?"mixed":void 0;return(0,n.jsxs)("label",{className:(0,a.cx)(D.wrapper,v),children:[(0,n.jsxs)("div",{className:D.checkboxWrapper,children:[(0,n.jsx)("input",{type:"checkbox",className:(0,a.cx)(D.input,x&&D.inputIndeterminate),checked:h,disabled:y,onChange:E,value:r,"aria-checked":C,...u,ref:b}),(0,n.jsx)("span",{className:D.checkmark})]}),m&&(0,n.jsx)("span",{className:D.label,children:m}),p&&(0,n.jsx)("span",{className:D.description,children:p})]})}),c=(m,p=!1)=>{const h=(0,d.f)(m),r=2,g=1,y=v=>p?m.colors.error.border:v;return{wrapper:(0,a.css)({display:"inline-grid",alignItems:"center",columnGap:m.spacing(g),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,a.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,o.getFocusStyles)(m),"&:focus:not(:focus-visible) + span":(0,o.getMouseFocusStyles)(m),"&:checked + span":{background:m.colors.primary.main,border:`1px solid ${y(m.colors.primary.main)}`,"&:hover":{background:m.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:m.spacing(.5),top:0,width:m.spacing(.75),height:m.spacing(1.5),border:`solid ${m.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:m.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${y(m.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:m.colors.action.disabledBackground},"&:after":{borderColor:m.colors.action.disabledText}}}),inputIndeterminate:(0,a.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${y(m.colors.primary.main)}`,background:m.colors.primary.main,"&:hover":{background:m.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${m.colors.primary.contrastText}`,backgroundColor:m.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:m.colors.action.disabledBackground,border:`1px solid ${y(m.colors.error.transparent)}`,"&:after":{borderColor:m.colors.action.disabledText}}}),checkboxWrapper:(0,a.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,a.css)({position:"relative",zIndex:2,display:"inline-block",width:m.spacing(r),height:m.spacing(r),borderRadius:m.shape.radius.default,background:m.components.input.background,border:`1px solid ${y(m.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:y(m.components.input.borderHover)}}),label:(0,a.cx)(h.label,(0,a.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:m.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,a.cx)(h.description,(0,a.css)({gridColumnStart:2,gridRowStart:2,lineHeight:m.typography.bodySmall.lineHeight,marginTop:0,zIndex:1}))}};i.displayName="Checkbox"},37386:(Z,R,e)=>{"use strict";e.d(R,{D:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(44019),d=e(12594),i=e(72636);const c=s.forwardRef(({label:h,description:r,horizontal:g,invalid:y,loading:v,disabled:x,required:f,error:u,children:b,className:E,validationMessageHorizontalOverflow:D,htmlFor:C,noMargin:P,...T},O)=>{const I=(0,l.of)(p,P),j=C??(0,o.getChildId)(b),W=typeof h=="string"?(0,n.jsx)(i.J,{htmlFor:j,description:r,children:`${h}${f?" *":""}`}):h,B=m({invalid:y,disabled:x,loading:v});return(0,n.jsxs)("div",{className:(0,a.cx)(I.field,g&&I.fieldHorizontal,E),...T,children:[W,(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:O,children:s.cloneElement(b,B)}),y&&u&&!g&&(0,n.jsx)("div",{className:(0,a.cx)(I.fieldValidationWrapper,{[I.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(d.P,{children:u})})]}),y&&u&&g&&(0,n.jsx)("div",{className:(0,a.cx)(I.fieldValidationWrapper,I.fieldValidationWrapperHorizontal,{[I.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(d.P,{children:u})})]})});c.displayName="Field";function m(h){for(const r in h)h[r]===void 0&&delete h[r];return h}const p=(h,r)=>({field:(0,a.css)({display:"flex",flexDirection:"column",marginBottom:h.spacing(r?0:2)}),fieldHorizontal:(0,a.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,a.css)({marginTop:h.spacing(.5)}),fieldValidationWrapperHorizontal:(0,a.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,a.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},16780:(Z,R,e)=>{"use strict";e.d(R,{n:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(53487);const o=({label:i,children:c,className:m,...p})=>{const h=(0,s.of)(d);return(0,n.jsxs)("fieldset",{className:(0,a.cx)(h.wrapper,m),...p,children:[i&&(0,n.jsx)(l.s,{children:i}),c]})},d=i=>({wrapper:(0,a.css)({marginBottom:i.spacing(4),"&:last-child":{marginBottom:0}})})},12594:(Z,R,e)=>{"use strict";e.d(R,{P:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(30703);const o=({children:i,horizontal:c,className:m})=>{const p=(0,s.of)(d),h=(0,a.cx)(c?p.horizontal:p.vertical,m);return(0,n.jsxs)("div",{role:"alert",className:h,children:[(0,n.jsx)(l.I,{className:p.fieldValidationMessageIcon,name:"exclamation-triangle"}),i]})},d=i=>{const c=`
      font-size: ${i.typography.size.sm};
      font-weight: ${i.typography.fontWeightMedium};
      padding: ${i.spacing(.5,1)};
      color: ${i.colors.error.contrastText};
      background: ${i.colors.error.main};
      border-radius: ${i.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${i.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,a.css)(c,{margin:i.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${i.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,a.css)(c,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,a.css)({marginRight:i.spacing()})}}},50426:(Z,R,e)=>{"use strict";e.d(R,{l:()=>o});var n=e(74848),a=e(22803),s=e(96540),l=e(49785);function o({defaultValues:d,onSubmit:i,validateOnMount:c=!1,validateFieldsOnMount:m,children:p,validateOn:h="onSubmit",maxWidth:r=600,...g}){const{handleSubmit:y,trigger:v,formState:x,...f}=(0,l.mN)({mode:h,defaultValues:d});return(0,s.useEffect)(()=>{c&&v(m)},[v,m,c]),(0,n.jsx)("form",{className:(0,a.css)({maxWidth:r!=="none"?r+"px":r,width:"100%"}),onSubmit:y(i),...g,children:p({errors:x.errors,formState:x,trigger:v,...f})})}},18027:(Z,R,e)=>{"use strict";e.d(R,{I:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(44019),d=e(12594),i=e(79233);const c=({children:p,label:h,tooltip:r,labelWidth:g="auto",invalid:y,loading:v,disabled:x,required:f,className:u,htmlFor:b,grow:E,shrink:D,error:C,transparent:P,interactive:T,validationMessageHorizontalOverflow:O,...I})=>{const j=(0,l.$j)(),W=m(j,E,D),B=b??(0,o.getChildId)(p),S=typeof h=="string"?(0,n.jsx)(i.c,{interactive:T,width:g,tooltip:r,htmlFor:B,transparent:P,children:`${h}${f?" *":""}`}):h;return(0,n.jsxs)("div",{className:(0,a.cx)(W.container,u),...I,children:[S,(0,n.jsxs)("div",{className:W.childContainer,children:[(0,s.cloneElement)(p,{invalid:y,disabled:x,loading:v}),y&&C&&(0,n.jsx)("div",{className:(0,a.cx)(W.fieldValidationWrapper,{[W.validationMessageHorizontalOverflow]:!!O}),children:(0,n.jsx)(d.P,{children:C})})]})]})};c.displayName="InlineField";const m=(p,h,r)=>({container:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${h?1:0} ${r?1:0} auto`,margin:`0 ${p.spacing(.5)} ${p.spacing(.5)} 0`}),childContainer:(0,a.css)({flex:`${h?1:0} ${r?1:0} auto`}),fieldValidationWrapper:(0,a.css)({marginTop:p.spacing(.5)}),validationMessageHorizontalOverflow:(0,a.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},97095:(Z,R,e)=>{"use strict";e.d(R,{C:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i,...c})=>{const m=(0,s.of)(o);return(0,n.jsx)("div",{className:(0,a.cx)(m.container,i),...c,children:d})},o=d=>({container:(0,a.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:d.spacing(.5)})})},79233:(Z,R,e)=>{"use strict";e.d(R,{c:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(30703),o=e(45967);const d=({children:c,className:m,tooltip:p,width:h,transparent:r,interactive:g,as:y="label",...v})=>{const x=(0,s.of)(i,r,h);return(0,n.jsxs)(y,{className:(0,a.cx)(x.label,m),...v,children:[c,p&&(0,n.jsx)(o.m,{interactive:g,placement:"top",content:p,theme:"info",children:(0,n.jsx)(l.I,{tabIndex:0,name:"info-circle",size:"sm",className:x.icon})})]})},i=(c,m=!1,p)=>({label:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:c.spacing(0,1),fontWeight:c.typography.fontWeightMedium,fontSize:c.typography.size.sm,backgroundColor:m?"transparent":c.colors.background.secondary,height:c.spacing(c.components.height.md),lineHeight:c.spacing(c.components.height.md),marginRight:c.spacing(.5),borderRadius:c.shape.radius.default,border:"none",width:p?p!=="auto"?`${8*p}px`:p:"100%",color:c.colors.text.primary}),icon:(0,a.css)({color:c.colors.text.secondary,marginLeft:"10px",":hover":{color:c.colors.text.primary}})})},83871:(Z,R,e)=>{"use strict";e.d(R,{e:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i,grow:c,...m})=>{const p=(0,s.of)(o,c);return(0,n.jsx)("div",{className:(0,a.cx)(p.container,i),...m,children:d})};l.displayName="InlineSegmentGroup";const o=(d,i)=>({container:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${i?1:0} 0 auto`,marginBottom:d.spacing(.5)})})},72636:(Z,R,e)=>{"use strict";e.d(R,{J:()=>o,f:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(30703);const o=({children:i,description:c,className:m,category:p,...h})=>{const r=(0,s.of)(d),g=p?.map((y,v)=>(0,n.jsxs)("span",{className:r.categories,children:[(0,n.jsx)("span",{children:y}),(0,n.jsx)(l.I,{name:"angle-right",className:r.chevron})]},`${y}/${v}`));return(0,n.jsx)("div",{className:(0,a.cx)(r.label,m),children:(0,n.jsxs)("label",{...h,children:[(0,n.jsxs)("div",{className:r.labelContent,children:[g,i]}),c&&(0,n.jsx)("span",{className:r.description,children:c})]})})},d=i=>({label:(0,a.css)({label:"Label",fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightMedium,lineHeight:1.25,marginBottom:i.spacing(.5),color:i.colors.text.primary,maxWidth:"480px"}),labelContent:(0,a.css)({display:"flex",alignItems:"center"}),description:(0,a.css)({label:"Label-description",color:i.colors.text.secondary,fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightRegular,marginTop:i.spacing(.25),display:"block"}),categories:(0,a.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,a.css)({margin:i.spacing(0,.25)})})},32581:(Z,R,e)=>{"use strict";e.d(R,{O:()=>d,p:()=>i});var n=e(74848),a=e(46942),s=e.n(a),l=e(96540),o=e(75745),d=(c=>(c.Invalid="invalid",c.Valid="valid",c))(d||{});class i extends l.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=m=>p=>{const h=(0,o.tf)(p.target.value,m);this.setState(r=>({...r,error:h?h[0]:null}))},this.populateEventPropsWithStatus=(m,p)=>{const h={...m};return p&&Object.keys(o.Pw).forEach(r=>{((0,o.K)(r,p)||m[r])&&(h[r]=async g=>{g.persist(),(0,o.K)(r,p)&&await this.validatorAsync(p[r]).apply(this,[g]),m[r]&&m[r].apply(null,[g,this.status])})}),h}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:m,className:p,hideErrorMessage:h,inputRef:r,...g}=this.props,{error:y}=this.state,v=s()("gf-form-input",{invalid:this.isInvalid},p),x=this.populateEventPropsWithStatus(g,m);return(0,n.jsxs)("div",{style:{flexGrow:1},children:[(0,n.jsx)("input",{...x,ref:r,className:v}),y&&!h&&(0,n.jsx)("span",{children:y})]})}}},53487:(Z,R,e)=>{"use strict";e.d(R,{s:()=>o});var n=e(74848),a=e(22803),s=e(63142);const l=d=>({legend:(0,a.css)({fontSize:d.typography.h3.fontSize,fontWeight:d.typography.fontWeightRegular,margin:d.spacing(0,0,2,0)})}),o=({children:d,className:i,...c})=>{const m=(0,s.of)(l);return(0,n.jsx)("legend",{className:(0,a.cx)(m.legend,i),...c,children:d})}},77824:(Z,R,e)=>{"use strict";e.d(R,{z:()=>v});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(30360),d=e(63142),i=e(30703),c=e(51898),m=e(35484),p=e(45967),h=e(3343);const r=2,g=l.forwardRef(({children:f,active:u=!1,disabled:b=!1,size:E="md",onChange:D,onClick:C,id:P,name:T=void 0,description:O,fullWidth:I,"aria-label":j},W)=>{const B=(0,d.of)(y,E,I),S=(0,n.jsx)("input",{type:"radio",className:B.radio,onChange:D,onClick:C,disabled:b,id:P,checked:u,name:T,"aria-label":j,ref:W});return O?(0,n.jsxs)("div",{className:B.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[(0,n.jsx)(p.m,{content:O,placement:"bottom",children:S}),(0,n.jsx)("label",{className:B.radioLabel,htmlFor:P,title:O||j,children:f})]}):(0,n.jsxs)("div",{className:B.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[S,(0,n.jsx)("label",{className:B.radioLabel,htmlFor:P,title:O||j,children:f})]})});g.displayName="RadioButton";const y=(f,u,b)=>{const{fontSize:E,height:D,padding:C}=(0,h.SM)(u,f),P=f.colors.text.secondary,T=f.colors.text.primary,O=D*f.spacing.gridSize-4-2;return{radioOption:(0,a.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:b?"1 0 0":"none",textAlign:"center"}),radio:(0,a.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,background:f.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,m.getFocusStyles)(f),"&:focus:not(:focus-visible) + label":(0,m.getMouseFocusStyles)(f),"&:disabled + label":{color:f.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:E,height:`${O}px`,lineHeight:`${O}px`,color:P,padding:f.spacing(0,C),borderRadius:(0,m.getInternalRadius)(f,r),background:f.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:T}})}};function v({options:f,value:u,onChange:b,onClick:E,disabled:D,disabledOptions:C,size:P="md",id:T,className:O,fullWidth:I=!1,autoFocus:j=!1,"aria-label":W,invalid:B=!1}){const S=(0,l.useCallback)(U=>()=>{b&&b(U.value)},[b]),w=(0,l.useCallback)(U=>()=>{E&&E(U.value)},[E]),N=T??(0,s.uniqueId)("radiogroup-"),M=(0,l.useRef)(N),L=(0,d.of)(x),A=(0,l.useRef)(null);return(0,l.useEffect)(()=>{j&&A.current&&A.current.focus()},[j]),(0,n.jsx)("div",{role:"radiogroup","aria-label":W,className:(0,a.cx)(L.radioGroup,I&&L.fullWidth,B&&L.invalid,O),children:f.map((U,F)=>{const V=C&&U.value&&C.includes(U.value),K=U.icon?(0,o.Uo)(U.icon):void 0,G=!!(U.imgUrl||U.label||U.component);return(0,n.jsxs)(g,{size:P,disabled:V||D,active:u===U.value,"aria-label":U.ariaLabel,onChange:S(U),onClick:w(U),id:`option-${U.value}-${N}`,name:M.current,description:U.description,fullWidth:I,ref:u===U.value?A:void 0,children:[K&&(0,n.jsx)(i.I,{name:K,className:(0,a.cx)(G&&L.icon)}),U.imgUrl&&(0,n.jsx)("img",{src:U.imgUrl,alt:U.label,className:L.img}),U.label," ",U.component?(0,n.jsx)(U.component,{}):null]},`o.label-${F}`)})})}v.displayName="RadioButtonGroup";const x=f=>({radioGroup:(0,a.css)({backgroundColor:f.colors.background.primary,display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:r,"&:hover":{borderColor:f.components.input.borderHover}}),fullWidth:(0,a.css)({display:"flex",flexGrow:1}),icon:(0,a.css)({marginRight:"6px"}),img:(0,a.css)({width:f.spacing(2),height:f.spacing(2),marginRight:f.spacing(1)}),invalid:(0,a.css)({border:`1px solid ${f.colors.error.border}`})})},45450:(Z,R,e)=>{"use strict";e.d(R,{J:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({id:d,name:i,label:c,checked:m,value:p,disabled:h,description:r,onChange:g,...y})=>{const v=(0,s.of)(o);return(0,n.jsxs)("label",{title:r,className:v.label,children:[(0,n.jsx)("input",{...y,id:d,name:i,type:"radio",checked:m,value:p,disabled:h,className:v.input,onChange:()=>g&&g(d)}),(0,n.jsxs)("div",{children:[c,r&&(0,n.jsx)("div",{className:v.description,children:r})]})]})},o=d=>({input:(0,a.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:d.colors.background.canvas,width:`${d.spacing(2)} !important`,height:d.spacing(2),border:`1px solid ${d.colors.border.medium}`,borderRadius:d.shape.radius.circle,cursor:"pointer",margin:"3px 0",":checked":{backgroundColor:d.v1.palette.white,border:`5px solid ${d.colors.primary.main}`},":disabled":{backgroundColor:`${d.colors.action.disabledBackground} !important`,borderColor:d.colors.border.weak},":disabled:checked":{border:`1px solid ${d.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:d.colors.text.disabled,borderRadius:d.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${d.colors.background.canvas}, 0 0 0 3px ${d.colors.primary.main}`}}),label:(0,a.css)({fontSize:d.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${d.spacing(2)} auto`,gap:d.spacing(1),cursor:"pointer"}),description:(0,a.css)({fontSize:d.typography.size.sm,color:d.colors.text.secondary})})},16203:(Z,R,e)=>{"use strict";e.d(R,{a:()=>i});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(63142),d=e(45450);function i({name:m,id:p,options:h,value:r,onChange:g,className:y,disabled:v,disabledOptions:x=[]}){const f=(0,o.of)(c),u=p??(0,s.uniqueId)("radiogroup-list-");return(0,n.jsx)("div",{id:p,className:(0,a.cx)(f.container,y),role:"radiogroup",children:h.map((b,E)=>{const D=`${u}-${E}`,C=r&&r===b.value,P=v||x.some(O=>O===b.value),T=()=>g&&b.value&&g(b.value);return(0,n.jsx)(d.J,{id:D,name:m,label:b.label,description:b.description,checked:C,value:b.value,disabled:P,onChange:T},E)})})}const c=m=>({container:(0,a.css)({display:"grid",gap:m.spacing(1)})})},18627:(Z,R,e)=>{"use strict";e.d(R,{_:()=>x});var n=e(74848),a=e(34796),s=e.n(a),l=e(96540),o=e(55386),d=e(48588),i=e(33553),c=e(739),m=e(53568),p=e(45861),h=e(64394),r=e(36394);const g={mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function y(f,u,b,E){const D=b!=null,C=E===c.wV.Vertical?u:f,P=Math.min(C*.15/1.5,20),T=P*1.5,O=D?u-T:u,I=Math.min(O,f);return{showLabel:D,gaugeHeight:I,titleFontSize:P}}function v(f,u,b,E){if(u.color?.mode!==h.Y.Thresholds)return[{value:u.min??d.tw,color:b.color??h.F}];const D=u.thresholds??g,C=D.mode===i.O.Percentage,P=D.steps;let T=u.min??d.tw,O=u.max??d.d1;C&&(T=0,O=100);const I=(0,r.yQ)(T,P),j=(0,r.yQ)(O,P),W=[{value:+T.toFixed(f),color:E.visualization.getColorByName(I.color)}];let B=!0;for(let S=0;S<P.length;S++){const w=P[S];if(B){I===w&&(B=!1);continue}const N=P[S-1];if(W.push({value:w.value,color:E.visualization.getColorByName(N.color)}),w===j)break}return W.push({value:+O.toFixed(f),color:E.visualization.getColorByName(j.color)}),W}class x extends l.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:u,value:b,height:E,onClick:D,text:C,theme:P,orientation:T}=this.props,O=y(u,E,b.title,T),I=T===c.wV.Vertical?`${O.gaugeHeight}px`:"100%",j=(0,n.jsx)("div",{style:{height:`${O.gaugeHeight}px`,width:I},ref:W=>this.canvasElement=W});return(0,n.jsxs)(n.Fragment,{children:[D?(0,n.jsx)("button",{className:(0,p.my)(P),type:"button",onClick:D,children:j}):j,O.showLabel&&(0,n.jsx)("div",{style:{textAlign:"center",fontSize:C?.titleSize??O.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:I,top:"-4px",cursor:"default"},children:b.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:g}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:u,showThresholdLabels:b,showThresholdMarkers:E,width:D,height:C,theme:P,value:T,orientation:O}=this.props,I=y(D,C,T.title),j=O===c.wV.Vertical?I.gaugeHeight:D,W=Math.min(j,I.gaugeHeight),B=P.colors.background.secondary,S=b?1.5:1,w=Math.min(W/5.5,40)/S,N=w/5,M=(0,o.cN)(T),A=Math.min(j,W*1.3)*.9-((w+(E?N:0)+(b?10:0))*2+10),U=this.props.text?.valueSize??(0,m.Vr)(M,A,W,1,w*1.7),F=Math.max(U/2.5,12);let V=u.min??d.tw,K=u.max??d.d1,G=T.numeric;u.thresholds?.mode===i.O.Percentage&&(V=0,K=100,T.percent===void 0?G=(G-V)/(K-V)*100:G=T.percent*100);const H=u.decimals===void 0?2:u.decimals;E&&(V=+V.toFixed(H),K=+K.toFixed(H));const _={series:{gauges:{gauge:{min:V,max:K,neutralValue:u.custom?.neutral,background:{color:B},border:{color:null},shadow:{show:!1},width:w},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:v(H,u,T,P),label:{show:b,margin:N+1,font:{size:F}},show:E,width:N},value:{color:T.color,formatter:()=>M,font:{size:U,family:P.typography.fontFamily}},show:!0}}},k={data:[[0,G]],label:T.title};try{this.canvasElement&&s().plot(this.canvasElement,[k],_)}catch(J){console.error("Gauge rendering error",J,_,T)}}render(){return(0,n.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},79331:(Z,R,e)=>{"use strict";e.d(R,{w:()=>i});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(34999),d=e(30703);const i=s.memo(s.forwardRef(({title:m,className:p,children:h,branded:r,url:g,urlTitle:y,onDismiss:v,severity:x="info",...f},u)=>{const b=(0,l.of)(c);return(0,n.jsxs)(o.F,{severity:x,className:p,...f,ref:u,title:m,children:[(0,n.jsx)("div",{children:h}),g&&(0,n.jsxs)("a",{href:g,className:(0,a.cx)("external-link",b.docsLink),target:"_blank",rel:"noreferrer",children:[(0,n.jsx)(d.I,{name:"book"})," ",y||"Read more"]})]})}));i.displayName="InfoBox";const c=m=>({docsLink:(0,a.css)({display:"inline-block",marginTop:m.spacing(2)})})},53371:(Z,R,e)=>{"use strict";e.d(R,{r:()=>p});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(96540),i=e(63142),c=e(30703),m=e(15245);function p({referenceElement:g,children:y,suffixIcon:v,placement:x}){const f=(0,i.of)(h),u=(0,i.$j)(),b=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:E,refs:D,floatingStyles:C}=(0,l.we)({open:!0,placement:x,middleware:b,whileElementsMounted:o.ll,strategy:"fixed"});(0,d.useLayoutEffect)(()=>{D.setReference(g)},[g,D]);const{styles:P}=(0,l.DL)(E,{initial:({side:T})=>({opacity:0,transform:r(T,u)}),duration:u.transitions.duration.shortest});return(0,n.jsx)(m.ZL,{children:(0,n.jsx)("div",{style:{display:"inline-block",...C},ref:D.setFloating,"aria-live":"polite",children:(0,n.jsxs)("span",{className:(0,a.cx)(f.root),style:P,children:[y&&(0,n.jsx)("span",{children:y}),v&&(0,n.jsx)(c.I,{name:v})]})})})}const h=g=>({root:(0,a.css)({...g.typography.bodySmall,willChange:"transform",background:g.components.tooltip.background,color:g.components.tooltip.text,padding:g.spacing(.5,1.5),borderRadius:g.shape.radius.pill,display:"inline-flex",gap:g.spacing(.5),alignItems:"center"})}),r=(g,y)=>{switch(g){case"top":return`translateY(${y.spacing(1)})`;case"bottom":return`translateY(-${y.spacing(1)})`;case"left":return`translateX(${y.spacing(1)})`;case"right":return`translateX(-${y.spacing(1)})`}}},33033:(Z,R,e)=>{"use strict";e.d(R,{D:()=>d});var n=e(74848),a=e(96540),s=e(53568),l=e(74660),o=e(63527);const d=a.forwardRef((m,p)=>{const{defaultValue:h="",minWidth:r=10,maxWidth:g,onCommitChange:y,onChange:v,onKeyDown:x,onBlur:f,value:u,placeholder:b,...E}=m,[D,C]=c(u,v),P=D??h,T=(0,a.useMemo)(()=>{const O=P||b||"",I=typeof O=="string"?O:O.toString();return i(I,r,g)},[b,P,r,g]);return(0,n.jsx)(l.W.Provider,{value:!0,children:(0,n.jsx)(o.p,{"data-testid":"autosize-input",...E,placeholder:b,ref:p,value:P.toString(),onChange:O=>{v&&v(O),C(O.currentTarget.value)},width:T,onBlur:O=>{f?f(O):y&&y(O)},onKeyDown:O=>{x?x(O):O.key==="Enter"&&y&&y(O)}})})});function i(m,p,h){if(!m)return p;const g=(0,s.kD)(m.toString(),14).width/8+3;return p&&g<p?p:h&&g>h?h:g}d.displayName="AutoSizeInput";function c(m,p){const h=m!==void 0&&p!==void 0,r=(0,a.useRef)(h),g=(0,a.useRef)(!1);h!==r.current&&!g.current&&(console.warn("An AutoSizeInput is changing from an uncontrolled to a controlled input. If you want to control the input, the empty value should be an empty string."),g.current=!0);const[y,v]=a.useState(m);(0,a.useEffect)(()=>{r.current||v(m)},[m]);const x=(0,a.useCallback)(u=>{r.current||v(u)},[]);return[r.current?m:y,x]}},26987:(Z,R,e)=>{"use strict";e.d(R,{e:()=>a});var n=e(49785);const a=n.xI},27594:(Z,R,e)=>{"use strict";e.d(R,{j:()=>b});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(32885),d=e(28105),i=e(63142),c=e(30703),m=e(34213),p=e(45967),h=e(92745),r=e(76319);const g=(0,a.css)({display:"flex",alignItems:"center",height:"100%"});function y({row:P,__rowID:T}){return(0,n.jsx)("div",{className:g,children:(0,n.jsx)(r.K,{tooltip:(0,h.t)("grafana-ui.interactive-table.expand-row-tooltip","Toggle row expanded"),"aria-controls":T,name:P.isExpanded?"angle-down":"angle-right","aria-expanded":P.isExpanded,...P.getToggleRowExpandedProps(),size:"lg"})})}function v({isAllRowsExpanded:P,toggleAllRowsExpanded:T}){return(0,n.jsx)("div",{className:g,children:(0,n.jsx)(r.K,{"aria-label":P?(0,h.t)("grafana-ui.interactive-table.aria-label-collapse-all","Collapse all rows"):(0,h.t)("grafana-ui.interactive-table.aria-label-expand-all","Expand all rows"),name:P?"table-collapse-all":"table-expand-all",onClick:()=>T(),size:"lg",tooltip:P?(0,h.t)("grafana-ui.interactive-table.tooltip-collapse-all","Collapse all rows"):(0,h.t)("grafana-ui.interactive-table.tooltip-expand-all","Expand all rows"),variant:"secondary"})})}const x="__expander";function f(P,T=!1){return[{id:x,Cell:y,...T&&{Header:v},disableSortBy:!0,width:0},...P.map(O=>({id:O.id,accessor:O.id,Header:O.header||(()=>null),sortType:O.sortType||"alphanumeric",disableSortBy:!O.sortType,width:O.disableGrow?0:void 0,visible:O.visible,...O.cell&&{Cell:O.cell}}))]}const u=P=>{const T=P.colors.emphasize(P.colors.background.primary,.03);return{container:(0,a.css)({display:"flex",gap:P.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,a.css)({padding:P.spacing(1),minWidth:P.spacing(3)}),table:(0,a.css)({borderRadius:P.shape.radius.default,width:"100%"}),disableGrow:(0,a.css)({width:0}),header:(0,a.css)({borderBottom:`1px solid ${P.colors.border.weak}`,minWidth:P.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:P.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:P.spacing(2.5),textAlign:"left",fontWeight:P.typography.fontWeightMedium}}),row:(0,a.css)({label:"row",borderBottom:`1px solid ${P.colors.border.weak}`,"&:hover":{backgroundColor:T},"&:last-child":{borderBottom:0}}),expandedRow:(0,a.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,a.css)({borderBottom:`1px solid ${P.colors.border.weak}`,position:"relative",padding:P.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:P.spacing(2),background:P.colors.border.medium}}),expandedContentRow:(0,a.css)({label:"expanded-row-content"}),sortableHeader:(0,a.css)({"&&":{padding:0}})}};function b({className:P,columns:T,data:O,getRowId:I,headerTooltips:j,pageSize:W=0,renderExpandedRow:B,showExpandAll:S=!1,fetchData:w,initialSortBy:N=[]}){const M=(0,i.of)(u),L=(0,l.useMemo)(()=>f(T,S),[T,S]),A=E(),U=(0,l.useCallback)(Y=>`${A}-${Y.id}`.replace(/\s/g,""),[A]),F=[o.useSortBy,o.useExpanded],V=O.length>W,K=W>0;K&&F.push(o.usePagination);const G=(0,o.useTable)({columns:L,data:O,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!w,getRowId:I,initialState:{hiddenColumns:[!B&&x,...L.filter(Y=>!(!Y.visible||Y.visible(O))).map(Y=>Y.id).filter(d.zz)].filter(d.zz),sortBy:N}},...F),{getTableProps:H,getTableBodyProps:_,headerGroups:k,prepareRow:J}=G,{sortBy:z}=G.state;return(0,l.useEffect)(()=>{w&&w({sortBy:z})},[z,w]),(0,l.useEffect)(()=>{K&&G.setPageSize(W)},[K,W,G.setPageSize,G]),(0,n.jsxs)("div",{className:M.container,children:[(0,n.jsxs)("table",{...H(),className:(0,a.cx)(M.table,P),children:[(0,n.jsx)("thead",{children:k.map(Y=>{const{key:X,...Q}=Y.getHeaderGroupProps();return(0,n.jsx)("tr",{...Q,children:Y.headers.map(q=>{const{key:te,...ne}=q.getHeaderProps(),se=j?.[q.id];return(0,n.jsx)("th",{className:(0,a.cx)(M.header,{[M.disableGrow]:q.width===0,[M.sortableHeader]:q.canSort}),...ne,...q.isSorted&&{"aria-sort":q.isSortedDesc?"descending":"ascending"},children:(0,n.jsx)(C,{column:q,headerTooltip:se})},te)})},X)})}),(0,n.jsx)("tbody",{..._(),children:(K?G.page:G.rows).map(Y=>{J(Y);const{key:X,...Q}=Y.getRowProps(),q=U(Y),te=Y.isExpanded;return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)("tr",{...Q,className:(0,a.cx)(M.row,te&&M.expandedRow),children:Y.cells.map(ne=>{const{key:se,...ue}=ne.getCellProps();return(0,n.jsx)("td",{className:M.cell,...ue,children:ne.render("Cell",{__rowID:q})},se)})}),te&&B&&(0,n.jsx)("tr",{...Q,id:q,className:M.expandedContentRow,children:(0,n.jsx)("td",{className:M.expandedContentCell,colSpan:Y.cells.length,children:B(Y.original)})})]},X)})})]}),K&&V&&(0,n.jsx)("span",{children:(0,n.jsx)(m.d,{currentPage:G.state.pageIndex+1,numberOfPages:G.pageOptions.length,onNavigate:Y=>G.gotoPage(Y-1)})})]})}const E=()=>(0,l.useMemo)(()=>(0,s.uniqueId)("InteractiveTable"),[]),D=P=>({sortIcon:(0,a.css)({position:"absolute",top:P.spacing(1)}),headerTooltipIcon:(0,a.css)({marginLeft:P.spacing(.5)})});function C({column:{canSort:P,render:T,isSorted:O,isSortedDesc:I,getSortByToggleProps:j},headerTooltip:W}){const B=(0,i.of)(D),{onClick:S}=j(),w=(0,n.jsxs)(n.Fragment,{children:[T("Header"),W&&(0,n.jsx)(p.m,{theme:"info-alt",content:W.content,placement:"top-end",children:(0,n.jsx)(c.I,{className:B.headerTooltipIcon,name:W.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),O&&(0,n.jsx)("span",{"aria-hidden":"true",className:B.sortIcon,children:(0,n.jsx)(c.I,{name:I?"angle-down":"angle-up"})})]});return P?(0,n.jsx)("button",{type:"button",onClick:S,children:w}):w}},50275:(Z,R,e)=>{"use strict";e.d(R,{B:()=>l});var n=e(74848),a=e(96540),s=e(22658);class l extends a.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,a.createRef)(),this.renderJson=()=>{const{json:d,config:i,open:c,onDidRender:m}=this.props,p=this.wrapperRef.current,h=new s.O(d,c,i);p.hasChildNodes()?p.replaceChild(h.render(),p.lastChild):p.appendChild(h.render()),m&&m(h.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:d}=this.props;return(0,n.jsx)("div",{className:d,ref:this.wrapperRef})}}},22658:(Z,R,e)=>{"use strict";e.d(R,{O:()=>f});var n=e(2543);function a(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function s(u){return!!u&&typeof u==="object"}function l(u){if(u===void 0)return"";if(u===null||typeof u=="object"&&!u.constructor)return"Object";const E=/function ([^(]*)/.exec(u.constructor.toString());return E&&E.length>1?E[1]:""}function o(u){return u===null?"null":typeof u}function d(u,b){const E=o(u);return E==="null"||E==="undefined"?E:(E==="string"&&(b='"'+a(b)+'"'),E==="function"?u.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":b)}let i="";function c(u){return s(u)?(i=l(u),Array.isArray(u)&&(i+="["+u.length+"]")):i=d(u,u.toString()),i}function m(u){return`json-formatter-${u}`}function p(u,b,E){const D=document.createElement(u);return b&&D.classList.add(m(b)),E!==void 0&&(E instanceof Node?D.appendChild(E):D.appendChild(document.createTextNode(String(E)))),D}const h=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,r=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,g=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,y=10,v=typeof window<"u"&&window.requestAnimationFrame||(u=>(u(),0)),x={animateOpen:!0,animateClose:!0};class f{constructor(b,E=1,D=x,C){this.json=b,this.open=E,this.config=D,this.key=C,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(b){this._isOpen=b}get isDate(){return this.type==="string"&&(h.test(this.json)||g.test(this.json)||r.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return s(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return l(this.json)}get type(){return o(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(b=>b||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(m("open")))}openAtDepth(b=1){b<0||(this.open=b,this.isOpen=b!==0,this.element&&(this.removeChildren(!1),b===0?this.element.classList.remove(m("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(m("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,n.isNumber)(this.json[0])||(0,n.isNumber)(this.json[1]))}renderArray(){const b=p("span");return b.appendChild(p("span","bracket","[")),this.isNumberArray()?(this.json.forEach((E,D)=>{D>0&&b.appendChild(p("span","array-comma",",")),b.appendChild(p("span","number",E))}),this.skipChildren=!0):b.appendChild(p("span","number",this.json.length)),b.appendChild(p("span","bracket","]")),b}render(b=!1){this.element=p("div","row");const E=p("a","toggler-link"),D=p("span","toggler");if(this.isObject&&E.appendChild(D),this.hasKey&&E.appendChild(p("span","key",`${this.key}:`)),this.isObject){const P=p("span","value"),T=p("span"),O=p("span","constructor-name",this.constructorName);if(T.appendChild(O),this.isArray){const I=this.renderArray();T.appendChild(I)}P.appendChild(T),E.appendChild(P)}else{const P=this.isUrl?p("a"):p("span");P.classList.add(m(this.type)),this.isDate&&P.classList.add(m("date")),this.isUrl&&(P.classList.add(m("url")),P.setAttribute("href",this.json));const T=d(this.json,this.json);P.appendChild(document.createTextNode(T)),E.appendChild(P)}const C=p("div","children");return this.isObject&&C.classList.add(m("object")),this.isArray&&C.classList.add(m("array")),this.isEmpty&&C.classList.add(m("empty")),this.config&&this.config.theme&&this.element.classList.add(m(this.config.theme)),this.isOpen&&this.element.classList.add(m("open")),b||this.element.appendChild(E),this.skipChildren?E.removeChild(D):this.element.appendChild(C),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&E.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(b=!1){const E=this.element&&this.element.querySelector(`div.${m("children")}`);if(!(!E||this.isEmpty))if(b){let D=0;const C=()=>{const P=this.keys[D],T=new f(this.json[P],this.open-1,this.config,P);E.appendChild(T.render()),D+=1,D<this.keys.length&&(D>y?C():v(C))};v(C)}else this.keys.forEach(D=>{const C=new f(this.json[D],this.open-1,this.config,D);E.appendChild(C.render())})}removeChildren(b=!1){const E=this.element&&this.element.querySelector(`div.${m("children")}`);if(b){let D=0;const C=()=>{E&&E.children.length&&(E.removeChild(E.children[0]),D+=1,D>y?C():v(C))};v(C)}else E&&(E.innerHTML="")}}},13943:(Z,R,e)=>{"use strict";e.d(R,{x:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(43990);const d=(0,s.forwardRef)((c,m)=>{const{alignItems:p,children:h,gap:r,rowGap:g,columnGap:y,columns:v,minColumnWidth:x,...f}=c,u=(0,l.of)(i,r,g,y,v,x,p);return(0,n.jsx)("div",{ref:m,...f,className:u.grid,children:h})});d.displayName="Grid";const i=(c,m,p,h,r,g,y)=>({grid:(0,a.css)([{display:"grid"},(0,o.Y)(c,m,v=>({gap:c.spacing(v)})),(0,o.Y)(c,p,v=>({rowGap:c.spacing(v)})),(0,o.Y)(c,h,v=>({columnGap:c.spacing(v)})),g&&(0,o.Y)(c,g,v=>({gridTemplateColumns:`repeat(auto-fill, minmax(${c.spacing(v)}, 1fr))`})),r&&(0,o.Y)(c,r,v=>({gridTemplateColumns:`repeat(${v}, 1fr)`})),(0,o.Y)(c,y,v=>({alignItems:v}))])})},32881:(Z,R,e)=>{"use strict";e.d(R,{Gy:()=>i,gW:()=>c,mc:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=(g=>(g[g.Horizontal=0]="Horizontal",g[g.Vertical=1]="Vertical",g))(o||{});const d=({children:g,orientation:y=0,spacing:v="sm",justify:x="flex-start",align:f="normal",wrap:u=!1,width:b="100%",height:E="100%",...D})=>{const C=(0,l.of)(p,y,v,x,f,u);return(0,n.jsx)("div",{className:C.layout,style:{width:b,height:E},...D,children:s.Children.toArray(g).filter(Boolean).map((P,T)=>(0,n.jsx)("div",{className:C.childWrapper,children:P},T))})},i=({children:g,spacing:y,justify:v,align:x="center",wrap:f,width:u,height:b})=>(0,n.jsx)(d,{spacing:y,justify:v,orientation:0,align:x,width:u,height:b,wrap:f,children:g}),c=({children:g,spacing:y,justify:v,align:x,width:f,height:u})=>(0,n.jsx)(d,{spacing:y,justify:v,orientation:1,align:x,width:f,height:u,children:g}),m=({children:g,padding:y,margin:v,grow:x,shrink:f})=>{const u=(0,l.of)(r,y,v);return(0,n.jsx)("div",{className:(0,a.cx)(u.wrapper,x!==void 0&&(0,a.css)({flexGrow:x}),f!==void 0&&(0,a.css)({flexShrink:f})),children:g})},p=(g,y,v,x,f,u)=>{const b=v!=="none"?g.spacing(h[v]):0,E=y===0&&!u||y===1?0:`-${b}`,D=y===1?"vertical-group":"horizontal-group";return{layout:(0,a.css)({label:D,display:"flex",flexDirection:y===1?"column":"row",flexWrap:u?"wrap":"nowrap",justifyContent:x,alignItems:f,height:"100%",maxWidth:"100%",marginBottom:E}),childWrapper:(0,a.css)({label:"layoutChildrenWrapper",marginBottom:y===0&&!u?0:b,marginRight:y===0?b:0,display:"flex",alignItems:f,"&:last-child":{marginBottom:y===1?0:void 0,marginRight:y===0?0:void 0}})}},h={none:0,xs:.5,sm:1,md:2,lg:3},r=(g,y,v)=>{const x=y&&y!=="none"&&g.spacing(h[y])||0,f=v&&v!=="none"&&g.spacing(h[v])||0;return{wrapper:(0,a.css)({label:"container",margin:f,padding:x})}}},35137:(Z,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(74848),a=e(31286);const s=({v:l=0,h:o=0,layout:d})=>(0,n.jsx)(a.a,{paddingRight:o,paddingBottom:l,display:d==="inline"?"inline-block":"block"})},20941:(Z,R,e)=>{"use strict";e.d(R,{N:()=>d});var n=e(74848),a=e(96540),s=e(35557),l=e(92138),o=e(63704);const d=(0,a.forwardRef)(({href:i,children:c,...m},p)=>{const h=l.I.stripBaseFromUrl(o.sQ.sanitizeUrl(i??""));return(0,n.jsx)(s.Link,{ref:p,to:h,...m,children:c})});d.displayName="Link"},89640:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(63704),o=e(92138),d=e(63142),i=e(30703),c=e(66969),m=e(20941);const p={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},h=(0,s.forwardRef)(({href:g,color:y="link",external:v=!1,inline:x=!0,variant:f="body",weight:u,icon:b,children:E,...D},C)=>{const P=l.sQ.sanitizeUrl(g??""),T=(0,d.$j)(),O=r(T,x,f,u,y),I=b||"external-link-alt";if(v)return(0,n.jsxs)("a",{href:P,ref:C,...D,target:"_blank",rel:"noreferrer",className:O,children:[E,(0,n.jsx)(i.I,{size:p[f]||"md",name:I})]});const j=o.I.stripBaseFromUrl(P);return(0,n.jsxs)(m.N,{ref:C,href:j,...D,className:O,children:[E,b&&(0,n.jsx)(i.I,{name:b,size:p[f]||"md"})]})});h.displayName="TextLink";const r=(g,y,v,x,f)=>(0,a.css)([v&&{...g.typography[v]},x&&{fontWeight:(0,c.iV)(x,g)},f&&{color:g.colors.text[f]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:g.colors.text.link}},y&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},46559:(Z,R,e)=>{"use strict";e.d(R,{p:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(65240);const o=(0,l.N)((i=!1)=>({list:(0,a.css)({listStyleType:"none",margin:0,padding:0}),item:(0,a.css)({display:i&&"inline-block"||"block"})}));class d extends s.PureComponent{constructor(c){super(c)}render(){const{items:c,renderItem:m,getItemKey:p,className:h,inline:r}=this.props,g=o(r);return(0,n.jsx)("ul",{className:(0,a.cx)(g.list,h),children:c.map((y,v)=>(0,n.jsx)("li",{className:g.item,children:m(y,v)},p?p(y):v))})}}},34950:(Z,R,e)=>{"use strict";e.d(R,{c:()=>l});var n=e(74848),a=e(96540),s=e(46559);class l extends a.PureComponent{render(){return(0,n.jsx)(s.p,{inline:!0,...this.props})}}},5585:(Z,R,e)=>{"use strict";e.d(R,{B:()=>l});var n=e(74848),a=e(96540),s=e(46559);class l extends a.PureComponent{render(){return(0,n.jsx)(s.p,{...this.props})}}},47327:(Z,R,e)=>{"use strict";e.d(R,{G:()=>p});var n=e(74848),a=e(22803),s=e(63142);const l=28,o=2.4,d=500,i=4e3,c=300,m=100/l*100;function p({width:r,delay:g=c,ariaLabel:y="Loading bar"}){const v=Math.min(Math.max(Math.round(r*o),d),i),x=(0,s.of)(h,g,v),f={overflow:"hidden"};return(0,n.jsx)("div",{style:f,children:(0,n.jsx)("div",{"aria-label":y,className:x.bar})})}const h=(r,g,y)=>{const v=(0,a.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${m}%)`}});return{bar:(0,a.css)({width:l+"%",height:1,background:`linear-gradient(90deg, transparent 0%, ${r.colors.primary.main} 80.75%, transparent 100%)`,transform:"translateX(-100%)",willChange:"transform",[r.transitions.handleMotion("no-preference")]:{animationName:v,animationDelay:`${g}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${y}ms`},[r.transitions.handleMotion("reduce")]:{animationName:v,animationDelay:`${g}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*y}ms`}})}}},48457:(Z,R,e)=>{"use strict";e.d(R,{O:()=>d});var n=e(74848),a=e(96540),s=e(92745),l=e(18857),o=e(56755);const d=({value:i,onChange:c,context:m,item:p})=>{const h=p.settings??{},r=(0,o.sE)(m.data,h?.filter),g=(0,o.m3)(r,i,void 0,void 0,h.baseNameMode),y=(0,a.useCallback)(x=>{if(!(x&&!(0,o.v3)(x.value,r)))return c(x?.value)},[r,c]),v=g.find(x=>x.value===i);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.l6,{value:v,placeholder:h.placeholderText??(0,s.t)("grafana-ui.matchers-ui.field-name-picker.placeholder","Select field"),options:g,onChange:y,noOptionsMessage:h.noFieldsMessage,width:h.width,isClearable:h.isClearable!==!1})})}},62693:(Z,R,e)=>{"use strict";e.d(R,{A:()=>g,bx:()=>p});var n=e(74848),a=e(96540),s=e(95004),l=e(57866),o=e(36638),d=e(92745),i=e(97958),c=e(18857);const m=(0,a.memo)(y=>{const{data:v,options:x,onChange:f,id:u}=y,b=h(v),E=r(b,x),D=(0,a.useCallback)(P=>f(P.value),[f]),C=E.find(P=>P.value===x);return(0,n.jsx)(c.l6,{inputId:u,value:C,options:E,onChange:D})});m.displayName="FieldTypeMatcherEditor";const p=[{value:s.PU.number,label:"Number",icon:(0,i.lV)(s.PU.number)},{value:s.PU.string,label:"String",icon:(0,i.lV)(s.PU.string)},{value:s.PU.time,label:"Time",icon:(0,i.lV)(s.PU.time)},{value:s.PU.boolean,label:"Boolean",icon:(0,i.lV)(s.PU.boolean)},{value:s.PU.trace,label:"Traces",icon:(0,i.lV)(s.PU.trace)},{value:s.PU.enum,label:"Enum",icon:(0,i.lV)(s.PU.enum)},{value:s.PU.other,label:"Other",icon:(0,i.lV)(s.PU.other)}],h=y=>(0,a.useMemo)(()=>{const v=new Map;for(const x of p)v.set(x.value,0);for(const x of y)for(const f of x.fields){const u=f.type||s.PU.other;let b=v.get(u);b||(b=0),v.set(u,b+1)}return v},[y]),r=(y,v)=>(0,a.useMemo)(()=>{let x=!1;const f=[];for(const u of p){const b=y.get(u.value),E=v===u.value;(b||E)&&f.push({...u,label:`${u.label} (${y.get(u.value)})`}),E&&(x=!0)}return v&&!x&&f.push({value:v,label:`${v} (No matches)`}),f},[y,v]),g=()=>({id:l.Ct.byType,component:m,matcher:o.sJ.get(l.Ct.byType),name:(0,d.t)("grafana-ui.matchers-ui.name-fields-with-type","Fields with type"),description:(0,d.t)("grafana-ui.matchers-ui.description-fields-with-type","Set properties for fields of a specific type (number, string, boolean)"),optionsToLabel:y=>y})},18105:(Z,R,e)=>{"use strict";e.d(R,{N:()=>r,RH:()=>x});var n=e(74848),a=e(22803),s=e(96540),l=e(46644),o=e(57866),d=e(36638),i=e(92745),c=e(739),m=e(63142),p=e(63527),h=e(18857);const r=[{label:"==",value:c.zT.EQ},{label:"!=",value:c.zT.NEQ},{label:">",value:c.zT.GT},{label:">=",value:c.zT.GTE},{label:"<",value:c.zT.LT},{label:"<=",value:c.zT.LTE}];function g(f){return f===l.gy.allIsNull||f===l.gy.allIsZero}const y=({options:f,onChange:u})=>{const b=(0,m.of)(v),E=(0,s.useMemo)(()=>l.AS.selectOptions([f?.reducer]),[f?.reducer]),D=(0,s.useCallback)(I=>u({...f,reducer:I.value}),[f,u]),C=(0,s.useCallback)(I=>u({...f,op:I.value}),[f,u]),P=(0,s.useCallback)(I=>{const j=I.currentTarget.valueAsNumber;return u({...f,value:j})},[f,u]),T=f??{},O=g(T.reducer);return(0,n.jsxs)("div",{className:b.spot,children:[(0,n.jsx)(h.l6,{value:E.current,options:E.options,onChange:D,placeholder:(0,i.t)("grafana-ui.field-value-matcher.select-field-placeholder","Select field reducer")}),T.reducer&&!O&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.l6,{value:r.find(I=>I.value===T.op),options:r,onChange:C,"aria-label":(0,i.t)("grafana-ui.field-value-matcher.operator-label","Comparison operator"),width:19}),(0,n.jsx)(p.p,{type:"number",value:T.value,onChange:P})]})]})},v=f=>({spot:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),x=()=>({id:o.Ct.byValue,component:y,matcher:d.sJ.get(o.Ct.byValue),name:(0,i.t)("grafana-ui.matchers-ui.name-fields-with-value","Fields with values"),description:(0,i.t)("grafana-ui.matchers-ui.description-fields-with-value","Set properties for fields with reducer condition"),optionsToLabel:f=>`${f?.reducer} ${f?.op} ${f?.value}`})},88531:(Z,R,e)=>{"use strict";e.d(R,{XL:()=>p,gK:()=>r,h:()=>u,pd:()=>v});var n=e(74848),a=e(96540),s=e(47184),l=e(16515),o=e(57866),d=e(36638),i=e(92745),c=e(18857);const m=(b,E,D)=>{if(!D)return;let C=b.find(P=>!E.some(T=>P===T));if(C)return C};function p({value:b,data:E,onChange:D,placeholder:C}){const P=(0,a.useMemo)(()=>g(E),[E]),[T,O]=(0,a.useState)({refIds:[],value:void 0}),I=(0,a.useMemo)(()=>P.find(W=>W.value===b)??m(P,T.refIds,T.value),[b,P,T]),j=(0,a.useCallback)(W=>{D(W?.value)},[D]);return(P!==T.refIds||I?.value!==T.value)&&O({refIds:P,value:I?.value}),(0,n.jsx)(c.l6,{options:P,onChange:j,isClearable:!0,placeholder:C??"Select query refId",value:I})}const h=(b,E,D)=>{if(!D||!D.length)return;const C=b.filter(P=>E.some(T=>P===T));if(C.length)return C};function r({value:b,data:E,onChange:D,placeholder:C}){const P=(0,a.useMemo)(()=>g(E),[E]),[T,O]=(0,a.useState)({refIds:[],value:void 0}),I=(0,a.useMemo)(()=>{let W=new Set;if(b)if(b.startsWith("/^"))try{W=new Set(f(b))}catch{W.add(b)}else b.includes("|")?W=new Set(b.split("|")):W.add(b);const B=P.filter(w=>W.has(w.value||""));if(B.length)return B;const S=[...W].map(s.z);return h(S,T.refIds,T.value)},[b,P,T]),j=(0,a.useCallback)(W=>{D(W.map(B=>B.value))},[D]);return(P!==T.refIds||I?.length!==T.value?.length)&&O({refIds:P,value:I}),(0,n.jsx)(c.KF,{options:P,onChange:j,isClearable:!0,placeholder:C??"Select query refId",value:I})}function g(b){const E=new Map;for(const C of b){const P=C.refId??"",T=E.get(P)??[];T.length===0&&E.set(P,T),T.push(C)}const D=[];for(const[C,P]of E.entries())D.push({value:C,label:`Query: ${C??"(missing refId)"}`,description:y(P)});return D}function y(b){return`Frames (${b.length}):
    ${b.slice(0,Math.min(3,b.length)).map(E=>(0,l.Ri)(E)).join(", ")} ${b.length>3?"...":""}`}const v=()=>({id:o.Ct.byFrameRefID,component:b=>(0,n.jsx)(p,{value:b.options,data:b.data,onChange:b.onChange}),matcher:d.sJ.get(o.Ct.byFrameRefID),name:(0,i.t)("grafana-ui.matchers-ui.name-fields-by-query","Fields returned by query"),description:(0,i.t)("grafana-ui.matchers-ui.description-fields-by-query","Set properties for fields from a specific query"),optionsToLabel:b=>b});function x(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const f=b=>b.slice(5,-3).split(/(?<!\\)\|/g).map(E=>E.replace(/\\(.)/g,"$1")),u=b=>`/^(?:${b.map(E=>x(E)).join("|")})$/`},63152:(Z,R,e)=>{"use strict";e.d(R,{g:()=>b});var n=e(42954),a=e(74848),s=e(96540),l=e(57866),o=e(36638),d=e(92745),i=e(63527);const c=(0,s.memo)(E=>{const{options:D,onChange:C}=E,P=(0,s.useCallback)(T=>C(T.target.value),[C]);return(0,a.jsx)(i.p,{placeholder:(0,d.t)("grafana-ui.field-name-by-regex-matcher.input-placeholder","Enter regular expression"),defaultValue:D,onBlur:P})});c.displayName="FieldNameByRegexMatcherEditor";const m=()=>({id:l.Ct.byRegexp,component:c,matcher:o.sJ.get(l.Ct.byRegexp),name:(0,d.t)("grafana-ui.matchers-ui.name-field-name-by-regex-matcher","Fields with name matching regex"),description:(0,d.t)("grafana-ui.matchers-ui.description-field-name-by-regex-matcher","Set properties for fields with names matching a regex"),optionsToLabel:E=>E});var p=e(18857),h=e(56755);const r=(0,s.memo)(E=>{const{data:D,options:C,onChange:P,id:T}=E,O=(0,h.sE)(D),I=(0,h.m3)(O,C),j=(0,s.useCallback)(B=>{if((0,h.v3)(B.value,O))return P(B.value)},[O,P]),W=I.find(B=>B.value===C);return(0,a.jsx)(p.l6,{value:W,options:I,onChange:j,inputId:T})});r.displayName="FieldNameMatcherEditor";const g=()=>({id:l.Ct.byName,component:r,matcher:o.sJ.get(l.Ct.byName),name:(0,d.t)("grafana-ui.matchers-ui.name-fields-with-name","Fields with name"),description:(0,d.t)("grafana-ui.matchers-ui.description-fields-with-name","Set properties for a specific field"),optionsToLabel:E=>E}),y=(0,s.memo)(E=>{const{data:D,options:C,onChange:P}=E,{readOnly:T,prefix:O}=C,I=(0,h.sE)(D),j=(0,h.m3)(I,void 0),W=(0,s.useCallback)(B=>{if(Array.isArray(B))return P({...C,names:B.reduce((S,w)=>((0,h.v3)(w.value,I)&&S.push(w.value),S),[])})},[I,P,C]);if(T){const B=(C.names??[]).join(", ");return(0,a.jsx)(i.p,{value:B,readOnly:!0,disabled:!0,prefix:O})}return(0,a.jsx)(p.KF,{value:C.names,options:j,onChange:W})});y.displayName="FieldNameMatcherEditor";const v=()=>({id:l.Ct.byNames,component:y,matcher:o.sJ.get(l.Ct.byNames),name:(0,d.t)("grafana-ui.matchers-ui.name-fields-with-name","Fields with name"),description:(0,d.t)("grafana-ui.matchers-ui.description-fields-with-name","Set properties for a specific field"),optionsToLabel:E=>(E.names??[]).join(", "),excludeFromPicker:!0});var x=e(62693),f=e(18105),u=e(88531);const b=new n.O(()=>[g(),m(),(0,x.A)(),(0,u.pd)(),v(),(0,f.RH)()])},56755:(Z,R,e)=>{"use strict";e.d(R,{BP:()=>d,m3:()=>c,sE:()=>i,v3:()=>o});var n=e(96540),a=e(16515),s=e(38809),l=e(97958);function o(m,p){return m?p.display.has(m)||p.raw.has(m):!1}function d(m,p){const h={display:new Set,raw:new Set,fields:new Map};for(const r of m)for(const g of r.fields){if(p&&!p(g))continue;const y=(0,a.Ct)(g,r,m);h.display.add(y),h.fields.set(y,g),g.name&&y!==g.name&&(h.raw.add(g.name),h.fields.set(g.name,g))}return h}function i(m,p){return(0,n.useMemo)(()=>d(m,p),[m,p])}function c(m,p,h,r,g){return(0,n.useMemo)(()=>{let y=!1;const v=[];if(h&&v.push(h),g===s.X4.OnlyBaseNames)for(const x of m.raw)!y&&x===p&&(y=!0),v.push({value:x,label:`${x} (base field name)`});else{for(const x of m.display){!y&&x===p&&(y=!0);const f=m.fields.get(x);(!r||r===f?.type)&&v.push({value:x,label:x,icon:f?(0,l.SS)(f):void 0})}if(g!==s.X4.ExcludeBaseNames)for(const x of m.raw)m.display.has(x)||(!y&&x===p&&(y=!0),v.push({value:x,label:`${x} (base field name)`}))}return p&&!y&&v.push({value:p,label:`${p} (not found)`}),v},[m,p,h,r,g])}},87063:(Z,R,e)=>{"use strict";e.d(R,{W:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(31286),d=e(25460),i=e(30930),c=e(94535),m=e(92132);const p=s.forwardRef(({header:g,children:y,ariaLabel:v,onOpen:x,onClose:f,onKeyDown:u,...b},E)=>{const D=(0,l.of)(r),C=(0,s.useRef)(null);(0,s.useImperativeHandle)(E,()=>C.current);const[P]=(0,m.t)({isMenuOpen:!0,localRef:C,onOpen:x,onClose:f,onKeyDown:u});return(0,n.jsxs)(o.a,{...b,"aria-label":v,backgroundColor:"elevated",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:P,paddingX:.5,paddingY:.5,ref:C,role:"menu",tabIndex:-1,children:[g&&(0,n.jsx)("div",{className:(0,a.cx)(D.header,!!y&&s.Children.toArray(y).length>0&&D.headerBorder),children:g}),y]})});p.displayName="Menu";const h=Object.assign(p,{Item:c.D,Divider:d.N,Group:i.r}),r=g=>({header:(0,a.css)({padding:g.spacing(.5,.5,1,.5)}),headerBorder:(0,a.css)({borderBottom:`1px solid ${g.colors.border.weak}`,marginBottom:g.spacing(.5)})})},25460:(Z,R,e)=>{"use strict";e.d(R,{N:()=>l});var n=e(74848),a=e(22803),s=e(63142);function l(){const d=(0,s.of)(o);return(0,n.jsx)("div",{className:d.divider})}const o=d=>({divider:(0,a.css)({height:1,backgroundColor:d.colors.border.weak,margin:d.spacing(.5,0)})})},30930:(Z,R,e)=>{"use strict";e.d(R,{r:()=>d});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(63142);const d=({label:c,ariaLabel:m,children:p})=>{const h=(0,o.of)(i),r=`group-label-${(0,s.uniqueId)()}`;return(0,n.jsxs)("div",{role:"group","aria-labelledby":!m&&c?r:void 0,"aria-label":m,children:[c&&(0,n.jsx)("label",{id:r,className:h.groupLabel,"aria-hidden":!0,children:c}),p]})};d.displayName="MenuGroup";const i=c=>({groupLabel:(0,a.css)({color:c.colors.text.secondary,fontSize:c.typography.size.sm,padding:c.spacing(.5,1)})})},94535:(Z,R,e)=>{"use strict";e.d(R,{D:()=>y});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(35484),i=e(30703),c=e(41654),m=e(51898),p=e(92132);const h=x=>{if(!x)return!1;const f=x.parentElement.getBoundingClientRect(),u=x.getBoundingClientRect();return u.width!==0&&f.right+u.width+10>window.innerWidth},r=(0,s.memo)(({items:x,isOpen:f,close:u,customStyle:b})=>{const E=(0,o.of)(g),D=(0,s.useRef)(null),[C]=(0,p.t)({localRef:D,isMenuOpen:f,close:u}),[P,T]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{f&&D.current&&T(h(D.current))},[f]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:E.iconWrapper,"aria-hidden":!0,"data-testid":m.Tp.components.Menu.SubMenu.icon,children:(0,n.jsx)(i.I,{name:"angle-right",className:E.icon})}),f&&(0,n.jsx)("div",{ref:D,className:(0,a.cx)(E.subMenu,{[E.pushLeft]:P}),"data-testid":m.Tp.components.Menu.SubMenu.container,style:b,children:(0,n.jsx)("div",{tabIndex:-1,className:E.itemsWrapper,role:"menu",onKeyDown:C,children:x})})]})});r.displayName="SubMenu";const g=x=>({iconWrapper:(0,a.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,a.css)({opacity:.7,marginLeft:x.spacing(1),color:x.colors.text.secondary}),itemsWrapper:(0,a.css)({background:x.colors.background.elevated,padding:x.spacing(.5),boxShadow:x.shadows.z3,display:"inline-block",borderRadius:x.shape.radius.default}),pushLeft:(0,a.css)({right:"100%",left:"unset"}),subMenu:(0,a.css)({position:"absolute",top:0,left:"100%",zIndex:x.zIndex.dropdown})}),y=s.memo(s.forwardRef((x,f)=>{const{url:u,icon:b,label:E,description:D,ariaLabel:C,ariaChecked:P,target:T,onClick:O,className:I,active:j,disabled:W,destructive:B,childItems:S,role:w,tabIndex:N=-1,customSubMenuContainerStyles:M,shortcut:L,testId:A}=x,U=(0,o.of)(v),[F,V]=(0,s.useState)(j),[K,G]=(0,s.useState)(!1),H=(0,s.useCallback)(()=>{W||(G(!0),V(!0))},[W]),_=(0,s.useCallback)(()=>{W||(G(!1),V(!1))},[W]),k=S&&S.length>0,J=k?"div":u===void 0?"button":"a",z=(0,a.cx)({[U.item]:!0,[U.active]:F,[U.disabled]:W,[U.destructive]:B&&!W},I),Y={[J==="button"?"disabled":"aria-disabled"]:W,...J==="a"&&W&&{href:void 0,onClick:void 0},...W&&{tabIndex:-1,"data-disabled":W}},X=(0,s.useRef)(null);(0,s.useImperativeHandle)(f,()=>X.current);const Q=ne=>{switch(ne.key){case"ArrowRight":ne.preventDefault(),ne.stopPropagation(),k&&(G(!0),V(!0));break;default:break}},q=()=>{G(!1),V(!1),X?.current?.focus()},te=!!(L&&L.length>0);return(0,n.jsxs)(J,{target:T,className:z,rel:T==="_blank"?"noopener noreferrer":void 0,href:u,onClick:ne=>{k&&!K&&(ne.preventDefault(),ne.stopPropagation()),O?.(ne)},onMouseEnter:H,onMouseLeave:_,onKeyDown:Q,role:u?w:w||"menuitem","data-role":"menuitem",ref:X,"data-testid":A,"aria-label":C,"aria-checked":P,tabIndex:N,...Y,children:[(0,n.jsxs)(c.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[b&&(0,n.jsx)(i.I,{name:b,className:U.icon,"aria-hidden":!0}),(0,n.jsx)("span",{className:U.ellipsis,children:E}),(0,n.jsxs)("div",{className:(0,a.cx)(U.rightWrapper,{[U.withShortcut]:te}),children:[te&&(0,n.jsxs)("div",{className:U.shortcut,children:[(0,n.jsx)(i.I,{name:"keyboard",title:(0,l.t)("grafana-ui.menu-item.keyboard-shortcut-label","Keyboard shortcut")}),L]}),k&&(0,n.jsx)(r,{items:S,isOpen:K,close:q,customStyle:M})]})]}),D&&(0,n.jsx)("div",{className:(0,a.cx)(U.description,U.ellipsis,{[U.descriptionWithIcon]:b!==void 0}),children:D}),x.component?(0,n.jsx)(x.component,{}):null]})}));y.displayName="MenuItem";const v=x=>({item:(0,a.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:x.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"center",padding:x.spacing(.5,1.5),minHeight:x.spacing(4),borderRadius:x.shape.radius.default,margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:x.colors.action.hover,color:x.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,d.getFocusStyles)(x)}),active:(0,a.css)({background:x.colors.action.hover}),destructive:(0,a.css)({color:x.colors.error.text,svg:{color:x.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:x.colors.error.main,color:x.colors.error.contrastText,svg:{color:x.colors.error.contrastText}}}),disabled:(0,a.css)({color:x.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:x.colors.action.disabledText}}),icon:(0,a.css)({opacity:.7,color:x.colors.text.secondary}),rightWrapper:(0,a.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,a.css)({minWidth:x.spacing(10.5)}),shortcut:(0,a.css)({display:"flex",alignItems:"center",gap:x.spacing(1),marginLeft:x.spacing(2),color:x.colors.text.secondary,opacity:.7}),description:(0,a.css)({...x.typography.bodySmall,color:x.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,a.css)({marginLeft:x.spacing(3)}),ellipsis:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},92132:(Z,R,e)=>{"use strict";e.d(R,{t:()=>o});var n=e(96540),a=e(94701);const s=(d,i)=>(d%i+i)%i,l=-1,o=({localRef:d,isMenuOpen:i,close:c,onOpen:m,onClose:p,onKeyDown:h})=>{const[r,g]=(0,n.useState)(l);return(0,n.useEffect)(()=>{i&&g(0)},[i]),(0,n.useEffect)(()=>{const v=d?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');v?.[r]?.focus(),v?.forEach((x,f)=>{x.tabIndex=f===r?0:-1})},[d,r]),(0,a.A)(()=>{m?.(g)}),[v=>{const x=d?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),f=x?.length??0;switch(v.key){case"ArrowUp":v.preventDefault(),v.stopPropagation(),g(s(r-1,f));break;case"ArrowDown":v.preventDefault(),v.stopPropagation(),g(s(r+1,f));break;case"ArrowLeft":v.preventDefault(),v.stopPropagation(),g(l),c?.();break;case"Home":v.preventDefault(),v.stopPropagation(),g(0);break;case"End":v.preventDefault(),v.stopPropagation(),g(f-1);break;case"Enter":v.preventDefault(),v.stopPropagation(),x?.[r]?.click();break;case"Escape":p?.();break;case"Tab":v.preventDefault(),p?.();break;default:break}h?.(v)}]}},22787:(Z,R,e)=>{"use strict";e.d(R,{a:()=>y});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(51182),i=e(96540),c=e(92745),m=e(63142),p=e(76319),h=e(41654),r=e(53428),g=e(35621);function y(f){const{title:u,children:b,isOpen:E=!1,closeOnEscape:D=!0,closeOnBackdropClick:C=!0,className:P,contentClassName:T,onDismiss:O,onClickBackdrop:I,trapFocus:j=!0}=f,W=(0,m.of)(g.o),B=(0,i.useRef)(null),{overlayProps:S,underlayProps:w}=(0,o.e)({isKeyboardDismissDisabled:!D,isOpen:E,onClose:O},B),{dialogProps:N,titleProps:M}=(0,s.s)({},B);if(!E)return null;const L=(0,a.cx)(W.modalHeader,typeof u!="string"&&W.modalHeaderWithTabs);return(0,n.jsxs)(d.Sf,{children:[(0,n.jsx)("div",{role:"presentation",className:W.modalBackdrop,onClick:I||(C?O:void 0),...w}),(0,n.jsx)(l.n1,{contain:j,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{className:(0,a.cx)(W.modal,P),ref:B,...S,...N,children:[(0,n.jsxs)("div",{className:L,children:[typeof u=="string"&&(0,n.jsx)(x,{...f,title:u,id:M.id}),typeof u!="string"&&u,(0,n.jsx)("div",{className:W.modalHeaderClose,children:(0,n.jsx)(p.K,{name:"times",size:"xl",onClick:O,"aria-label":(0,c.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,n.jsx)("div",{className:(0,a.cx)(W.modalContent,T),children:b})]})})]})}function v({leftItems:f,children:u}){const b=(0,m.of)(g.o);return f?(0,n.jsx)("div",{className:b.modalButtonRow,children:(0,n.jsxs)(h.B,{justifyContent:"space-between",children:[(0,n.jsx)(h.B,{justifyContent:"flex-start",gap:2,children:f}),(0,n.jsx)(h.B,{justifyContent:"flex-end",gap:2,children:u})]})}):(0,n.jsx)("div",{className:b.modalButtonRow,children:(0,n.jsx)(h.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:u})})}y.ButtonRow=v;function x({icon:f,iconTooltip:u,title:b,id:E}){return(0,n.jsx)(r.r,{icon:f,iconTooltip:u,title:b,id:E})}},53428:(Z,R,e)=>{"use strict";e.d(R,{r:()=>l});var n=e(74848),a=e(63142),s=e(35621);const l=({icon:o,iconTooltip:d,title:i,children:c,id:m})=>{const p=(0,a.of)(s.o);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:p.modalHeaderTitle,id:m,children:i}),c]})}},52792:(Z,R,e)=>{"use strict";e.d(R,{J:()=>o});var n=e(74848),a=e(60208),s=e(54314),l=e(53428);const o=({icon:d,title:i,tabs:c,activeTab:m,onChangeTab:p})=>(0,n.jsx)(l.r,{icon:d,title:i,children:(0,n.jsx)(s.U,{hideBorder:!0,children:c.map((h,r)=>(0,n.jsx)(a.o,{label:h.label,icon:h.icon,suffix:h.tabSuffix,active:h.value===m,onChangeTab:()=>p(h)},`${h.value}-${r}`))})})},8515:(Z,R,e)=>{"use strict";e.d(R,{$s:()=>d,EO:()=>o,YO:()=>l,wE:()=>s});var n=e(74848),a=e(96540);const s=a.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class l extends a.Component{constructor(c){super(c),this.showModal=(m,p)=>{this.setState({component:m,props:p})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:c.component||null,props:c.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,n.jsx)(s.Provider,{value:this.state,children:this.props.children})}}const o=()=>(0,n.jsx)(s.Consumer,{children:({component:i,props:c})=>i?(0,n.jsx)(i,{...c}):null}),d=s.Consumer},35621:(Z,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(22803);const a=s=>{const l=s.shape.radius.default;return{modal:(0,n.css)({position:"fixed",zIndex:s.zIndex.modal,background:s.colors.background.primary,boxShadow:s.shadows.z3,borderRadius:l,border:`1px solid ${s.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,n.css)({position:"fixed",zIndex:s.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:s.components.overlay.background}),modalHeader:(0,n.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:s.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,n.css)({borderBottom:`1px solid ${s.colors.border.weak}`}),modalHeaderTitle:(0,n.css)({fontSize:s.typography.size.lg,margin:s.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,n.css)({marginRight:s.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,n.css)({height:"100%",display:"flex",alignItems:"center",color:s.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,n.css)({overflow:"auto",padding:s.spacing(3),width:"100%"}),modalButtonRow:(0,n.css)({paddingTop:s.spacing(3)})}}},13477:(Z,R,e)=>{"use strict";e.d(R,{O:()=>a});var n=e(78193);function a(s){const l="${"+s.value+"}",o=s.value===s.label?s.origin:`${s.label} / ${s.origin}`;return{label:l,kind:n.q.Property,detail:o,documentation:s.documentation}}},84600:(Z,R,e)=>{"use strict";e.d(R,{d:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(35484),c=e(30703),m=e(76319),p=e(20941),h=e(36219);const r=(0,s.memo)(({title:y,section:v,parent:x,pageIcon:f,onGoBack:u,children:b,titleHref:E,parentHref:D,leftItems:C,isFullscreen:P,className:T,"aria-label":O,buttonOverflowAlignment:I="right",forceShowLeftItems:j=!1})=>{const W=(0,d.of)(g),B=(0,a.cx)("page-toolbar",W.toolbar,{"page-toolbar--fullscreen":P,[W.noPageIcon]:!f},T),S=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:W.truncateText,children:y}),v&&(0,n.jsxs)("span",{className:W.pre,children:[" / ",v]})]}),w=(0,o.t)("grafana-ui.page-toolbar.go-back","Go back (Esc)"),N=(0,o.t)("grafana-ui.page-toolbar.search-parent-folder","Search dashboard in the {{parent}} folder",{parent:x}),M=(0,o.t)("grafana-ui.page-toolbar.search-dashboard-name","Search dashboard by name"),L=(0,o.t)("grafana-ui.page-toolbar.search-links","Search links");return(0,n.jsxs)("nav",{className:B,"aria-label":O,children:[(0,n.jsxs)("div",{className:W.leftWrapper,children:[f&&!u&&(0,n.jsx)("div",{className:W.pageIcon,children:(0,n.jsx)(c.I,{name:f,size:"lg","aria-hidden":!0})}),u&&(0,n.jsx)("div",{className:W.pageIcon,children:(0,n.jsx)(m.K,{name:"arrow-left",tooltip:w,tooltipPlacement:"bottom",size:"xxl","data-testid":l.Tp.components.BackButton.backArrow,onClick:u})}),(0,n.jsxs)("nav",{"aria-label":L,className:W.navElement,children:[x&&D&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.N,{"aria-label":N,className:(0,a.cx)(W.titleText,W.parentLink,W.titleLink,W.truncateText),href:D,children:[x," ",(0,n.jsx)("span",{className:W.parentIcon})]}),E&&(0,n.jsx)("span",{className:(0,a.cx)(W.titleText,W.titleDivider),"aria-hidden":!0,children:"/"})]}),(y||!!C?.length)&&(0,n.jsxs)("div",{className:W.titleWrapper,children:[y&&(0,n.jsx)("h1",{className:W.h1Styles,children:E?(0,n.jsx)(p.N,{"aria-label":M,className:(0,a.cx)(W.titleText,W.titleLink),href:E,children:S}):(0,n.jsx)("div",{className:W.titleText,children:S})}),C?.map((A,U)=>(0,n.jsx)("div",{className:(0,a.cx)(W.leftActionItem,{[W.forceShowLeftActionItems]:j}),children:A},U))]})]})]}),(0,n.jsx)(h.U,{alignment:I,children:s.Children.toArray(b).filter(Boolean)})]})});r.displayName="PageToolbar";const g=y=>{const{spacing:v,typography:x}=y,f=(0,i.getFocusStyles)(y);return{pre:(0,a.css)({whiteSpace:"pre"}),toolbar:(0,a.css)({alignItems:"center",background:y.colors.background.canvas,display:"flex",gap:y.spacing(2),justifyContent:"space-between",padding:y.spacing(1.5,2),[y.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,a.css)({[y.breakpoints.down("md")]:{paddingLeft:y.spacing(2)}}),leftWrapper:(0,a.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,a.css)({display:"none",[y.breakpoints.up("sm")]:{display:"flex",paddingRight:y.spacing(1),alignItems:"center"}}),truncateText:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,a.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,a.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,a.css)({margin:v(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,a.css)({marginLeft:y.spacing(.5)}),titleText:(0,a.css)({display:"flex",fontSize:x.size.lg,margin:0,borderRadius:y.shape.radius.default}),titleLink:(0,a.css)({"&:focus-visible":f}),titleDivider:(0,a.css)({padding:v(0,.5,0,.5),display:"none",[y.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,a.css)({display:"none",[y.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,a.css)({display:"none",alignItems:"center",paddingRight:v(.5),[y.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,a.css)({display:"flex"})}}},34213:(Z,R,e)=>{"use strict";e.d(R,{d:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861),i=e(30703);const c=({currentPage:p,numberOfPages:h,onNavigate:r,hideWhenSinglePage:g,showSmallVersion:y,className:v})=>{const x=(0,o.of)(m),f=y?1:8,u=(0,s.useMemo)(()=>{const D=[...new Array(h).keys()],C=h>f,P=(T,O)=>(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(d.$n,{size:"sm",variant:O,onClick:()=>r(T),children:T})},T);return D.reduce((T,O)=>{const I=O+1,j=I===p?"primary":"secondary",W=f,B=h-f+1,S=B-W,w=I===1||I===h,N=S>-1&&p>=W&&p<=B,M=y?1:3,L=y?0:2;return C?w||p<W&&I<W||S>=0&&p>B&&I>B||S<0&&p>=W&&I>B||N&&I>=p-L&&I<=p+L?T.push(P(I,j)):(I===W&&p<W||I===B&&p>B||N&&(I===p-M||I===p+M))&&T.push((0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(i.I,{className:x.ellipsis,name:"ellipsis-v","data-testid":"pagination-ellipsis-icon"})},I)):T.push(P(I,j)),T},[])},[p,h,r,f,y,x.ellipsis,x.item]);if(g&&h<=1)return null;const b=(0,l.t)("grafana-ui.pagination.previous-page","previous page"),E=(0,l.t)("grafana-ui.pagination.next-page","next page");return(0,n.jsx)("div",{className:(0,a.cx)(x.container,v),role:"navigation",children:(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(d.$n,{"aria-label":b,size:"sm",variant:"secondary",onClick:()=>r(p-1),disabled:p===1,children:(0,n.jsx)(i.I,{name:"angle-left"})})}),u,(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(d.$n,{"aria-label":E,size:"sm",variant:"secondary",onClick:()=>r(p+1),disabled:p===h,children:(0,n.jsx)(i.I,{name:"angle-right"})})})]})})},m=()=>({container:(0,a.css)({float:"right"}),item:(0,a.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,a.css)({transform:"rotate(90deg)"})})},39884:(Z,R,e)=>{"use strict";e.d(R,{I:()=>c});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(63142),d=e(30703),i=e(45967);const c=({onCancel:h,loading:r})=>{const g=window.matchMedia("(prefers-reduced-motion: reduce)").matches,y=(0,o.of)(p);return r?(0,n.jsx)(i.m,{content:(0,l.t)("grafana-ui.panel-chrome.tooltip-cancel-loading","Cancel query"),children:(0,n.jsx)(d.I,{className:(0,a.cx)(y.spin,{[y.clickable]:!!h}),name:g?"hourglass":"sync",size:"sm",onClick:h,"data-testid":s.Tp.components.LoadingIndicator.icon})}):null},m=(0,a.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),p=h=>({clickable:(0,a.css)({cursor:"pointer"}),spin:(0,a.css)({[h.transitions.handleMotion("no-preference")]:{animation:`${m} 3s linear infinite`}})})},64400:(Z,R,e)=>{"use strict";e.d(R,{XF:()=>l,d2:()=>o,e4:()=>s});var n=e(96540),a=e(19379);const s=(0,n.createContext)({eventsScope:"global",eventBus:new a.o}),l=s.Provider,o=()=>(0,n.useContext)(s)},67522:(Z,R,e)=>{"use strict";e.d(R,{NR:()=>U});var n=e(39884),a=e(74848),s=e(22803),l=e(96540),o=e(42941),d=e(49185),i=e(28105),c=e(51898),m=e(92745),p=e(63142),h=e(35484);function r({children:F,delay:V}){const[K,G]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{window.setTimeout(()=>{G(!0)},V)},[F,V]),(0,a.jsx)(a.Fragment,{children:K?F:null})}var g=e(36324),y=e(56887),v=e(30703),x=e(47327),f=e(66404),u=e(45967),b=e(88559),E=e(7895);function D({menu:F,title:V,placement:K="bottom",offset:G,dragClassCancel:H,menuButtonClass:_,onOpenMenu:k}){const J=V?c.Tp.components.Panels.Panel.menu(V):"panel-menu-button",z=(0,l.useCallback)(Y=>{Y&&k&&k()},[k]);return(0,a.jsx)(b.m,{overlay:F,placement:K,offset:G,onVisibleChange:z,children:(0,a.jsx)(E.I,{"aria-label":(0,m.t)("grafana-ui.panel-menu.label","Menu for panel {{ title }}",{title:V??"Untitled"}),title:(0,m.t)("grafana-ui.panel-menu.title","Menu"),icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":J,className:(0,s.cx)(_,H)})})}function C({menu:F,title:V,dragClass:K,children:G,offset:H=-32,onOpenMenu:_}){const k=(0,p.of)(P),J=(0,l.useRef)(null),z=c.Tp.components.Panels.Panel.HoverWidget,Y=(0,l.useCallback)(Q=>{J.current?.setPointerCapture(Q.pointerId)},[]),X=(0,l.useCallback)(Q=>{J.current?.releasePointerCapture(Q.pointerId)},[]);return G===void 0||l.Children.count(G)===0?null:(0,a.jsxs)("div",{className:(0,s.cx)(k.container,"show-on-hover"),style:{top:H},"data-testid":z.container,children:[K&&(0,a.jsx)("div",{className:(0,s.cx)(k.square,k.draggable,K),onPointerDown:Y,onPointerUp:X,ref:J,"data-testid":z.dragIcon,children:(0,a.jsx)(v.I,{name:"expand-arrows",className:k.draggableIcon})}),G,F&&(0,a.jsx)(D,{menu:F,title:V,placement:"bottom",menuButtonClass:k.menuButton,onOpenMenu:_})]})}function P(F){return{container:(0,s.css)({label:"hover-container-widget",[F.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:F.colors.background.secondary,color:F.colors.text.primary,border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.radius.default,height:F.spacing(4),boxShadow:F.shadows.z1}),square:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center",width:F.spacing(4),height:"100%"}),draggable:(0,s.css)({cursor:"move",[F.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,s.css)({background:"inherit",border:"none","&:hover":{background:F.colors.secondary.main}}),draggableIcon:(0,s.css)({transform:"rotate(45deg)",color:F.colors.text.secondary,"&:hover":{color:F.colors.text.primary}})}}var T=e(45861);const O=(0,l.forwardRef)(({className:F,children:V,href:K,onClick:G,target:H,title:_,...k},J)=>{const z=(0,p.of)(I);return K?(0,a.jsx)("a",{ref:J,href:K,onClick:G,target:H,title:_,className:(0,s.cx)(z.linkItem,F),...k,children:V}):G?(0,a.jsx)(T.$n,{ref:J,className:(0,s.cx)(z.item,F),variant:"secondary",fill:"text",onClick:G,children:V}):(0,a.jsx)("span",{ref:J,className:(0,s.cx)(z.item,F),...k,children:V})});O.displayName="TitleItem";const I=F=>{const V=(0,s.css)({color:`${F.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${F.shape.radius.default}`,padding:`${F.spacing(0,1)}`,height:`${F.spacing(F.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,h.getFocusStyles)(F),zIndex:1},"&: focus:not(:focus-visible)":(0,h.getMouseFocusStyles)(F),"&:hover ":{boxShadow:`${F.shadows.z1}`,background:`${F.colors.background.secondary}`,color:`${F.colors.text.primary}`}});return{item:V,linkItem:(0,s.cx)(V,(0,s.css)({cursor:"pointer"}))}};function j({description:F,className:V}){const K=(0,p.of)(W),G=()=>{const H=typeof F=="function"?F():F;return(0,a.jsx)("div",{className:"panel-info-content markdown-html",children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:H}})})};return F!==""?(0,a.jsx)(u.m,{interactive:!0,content:G,children:(0,a.jsx)(O,{className:(0,s.cx)(V,K.description),children:(0,a.jsx)(v.I,{name:"info-circle",size:"md"})})}):null}const W=F=>({description:(0,s.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function B({message:F,onClick:V,ariaLabel:K="status"}){const G=(0,p.of)(S);return(0,a.jsx)(E.I,{className:G.buttonStyles,onClick:V,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:F||"","aria-label":K,"data-testid":c.Tp.components.Panels.Panel.status("error")})}const S=F=>{const{headerHeight:V,padding:K}=F.components.panel;return{buttonStyles:(0,s.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(K),width:F.spacing(V),height:F.spacing(V),borderRadius:F.shape.radius.default})}};function w({width:F,height:V,children:K,padding:G="md",title:H="",description:_="",displayMode:k="default",titleItems:J,menu:z,dragClass:Y,dragClassCancel:X,hoverHeader:Q=!1,hoverHeaderOffset:q,loadingState:te,statusMessage:ne,statusMessageOnClick:se,leftItems:ue,actions:de,selectionId:ie,onCancelQuery:he,onOpenMenu:me,collapsible:ce=!1,collapsed:Pe,onToggleCollapse:Ie,onFocus:Se,onMouseMove:Me,onMouseEnter:Te,onDragStart:Ge,showMenuAlways:Qe=!1}){const tt=(0,p.$j)(),ke=(0,p.of)(A),He=(0,l.useId)(),Re=(0,l.useId)().replace(/:/g,"_"),{isSelected:Ne,onSelect:Ae,isSelectable:Ue}=(0,y.y)(ie),Be=(0,g.C)(),We=!Q,[_e,Xe]=(0,o.A)(!0),[le,ye]=(0,l.useState)(!1),pe=l.useCallback(()=>ye(!0),[]),ve=l.useCallback(()=>ye(!1),[]);Pe===void 0&&(Pe=!_e);const be=Qe?"always-show":"show-on-hover",Oe=k==="transparent",we=M(tt,We),{contentStyle:ze,innerWidth:Ve,innerHeight:ge}=L(G,tt,we,Pe,V,F),Ke={height:we,cursor:Y?"move":"auto"},qe={width:F,height:Pe?void 0:V},[ot,{width:lt}]=(0,d.A)();ue&&(de=ue);const mt=typeof H=="string"?c.Tp.components.Panels.Panel.title(H):"Panel",Lt=l.useCallback(Ut=>{Be.check(Ut)||X&&Ut.target instanceof Element&&Ut.target.closest(`.${X}`)||setTimeout(()=>Ae?.(Ut))},[X,Ae,Be]),Tt=l.useCallback(Ut=>{Ut.stopPropagation(),Be.set(Ut),Ge?.(Ut)},[Be,Ge]),It=l.useCallback(Ut=>{Ut.target instanceof Element&&Ut.target.closest("button,a,canvas,svg")||Ae?.(Ut)},[Ae]),Mt=(0,a.jsxs)(a.Fragment,{children:[!ce&&H&&(0,a.jsx)("div",{className:ke.title,children:(0,a.jsx)(f.E,{element:"h2",variant:"h6",truncate:!0,title:typeof H=="string"?H:void 0,id:Re,children:H})}),ce&&(0,a.jsx)("div",{className:ke.title,children:(0,a.jsx)(f.E,{element:"h2",variant:"h6",children:(0,a.jsxs)("button",{type:"button",className:ke.clearButtonStyles,onClick:()=>{Xe(),Ie&&Ie(!Pe)},"aria-expanded":!Pe,"aria-controls":Pe?void 0:He,children:[(0,a.jsx)(v.I,{name:Pe?"angle-right":"angle-down","aria-hidden":!!H,"aria-label":H?void 0:(0,m.t)("grafana-ui.panel-chrome.aria-label-toggle-collapse","toggle collapse panel")}),(0,a.jsx)(f.E,{variant:"h6",truncate:!0,id:Re,children:H})]})})}),(0,a.jsxs)("div",{className:(0,s.cx)(ke.titleItems,X),"data-testid":"title-items-container",children:[(0,a.jsx)(j,{description:_,className:X}),J]}),te===i.Gu.Streaming&&(0,a.jsx)(u.m,{content:he?(0,m.t)("grafana-ui.panel-chrome.tooltip-stop-streaming","Stop streaming"):(0,m.t)("grafana-ui.panel-chrome.tooltip-streaming","Streaming"),children:(0,a.jsx)(O,{className:X,"data-testid":"panel-streaming",onClick:he,children:(0,a.jsx)(v.I,{name:"circle-mono",size:"md",className:ke.streaming})})}),te===i.Gu.Loading&&he&&(0,a.jsx)(r,{delay:2e3,children:(0,a.jsx)(u.m,{content:(0,m.t)("grafana-ui.panel-chrome.tooltip-cancel","Cancel query"),children:(0,a.jsx)(O,{className:(0,s.cx)(X,ke.pointer),"data-testid":"panel-cancel-query",onClick:he,children:(0,a.jsx)(v.I,{name:"sync-slash",size:"md"})})})}),(0,a.jsx)("div",{className:ke.rightAligned,children:de&&(0,a.jsx)("div",{className:ke.rightActions,children:N(de,Ut=>Ut)})})]});return(0,a.jsxs)("section",{className:(0,s.cx)(ke.container,Oe&&ke.transparentContainer,Ne&&"dashboard-selected-element",!Ne&&Ue&&le&&"dashboard-selectable-element"),style:qe,"aria-labelledby":H?Re:void 0,"data-testid":mt,tabIndex:0,onFocus:Se,onMouseMove:Me,onMouseEnter:Te,ref:ot,children:[(0,a.jsx)("div",{className:ke.loadingBarContainer,children:te===i.Gu.Loading?(0,a.jsx)(x.G,{width:lt,ariaLabel:(0,m.t)("grafana-ui.panel-chrome.ariaLabel-panel-loading","Panel loading bar")}):null}),Q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C,{menu:z,title:typeof H=="string"?H:void 0,offset:q,dragClass:Y,onOpenMenu:me,children:Mt}),ne&&(0,a.jsx)("div",{className:ke.errorContainerFloating,children:(0,a.jsx)(B,{message:ne,onClick:se,ariaLabel:(0,m.t)("grafana-ui.panel-chrome.ariaLabel-panel-status","Panel status")})})]}),We&&(0,a.jsxs)("div",{className:(0,s.cx)(ke.headerContainer,Y),style:Ke,"data-testid":c.Tp.components.Panels.Panel.headerContainer,onPointerDown:Tt,onMouseEnter:Ue?pe:void 0,onMouseLeave:Ue?ve:void 0,onPointerUp:Lt,children:[ne&&(0,a.jsx)("div",{className:X,children:(0,a.jsx)(B,{message:ne,onClick:se,ariaLabel:(0,m.t)("grafana-ui.panel-chrome.ariaLabel-panel-status","Panel status")})}),Mt,z&&(0,a.jsx)(D,{menu:z,title:typeof H=="string"?H:void 0,placement:"bottom-end",menuButtonClass:(0,s.cx)(ke.menuItem,X,be),onOpenMenu:me})]}),!Pe&&(0,a.jsx)("div",{id:He,"data-testid":c.Tp.components.Panels.Panel.content,className:(0,s.cx)(ke.content,V===void 0&&ke.containNone),style:ze,onPointerDown:It,children:typeof K=="function"?K(Ve,ge):K})]})}const N=(F,V)=>{const K=l.Children.toArray(F).filter(Boolean);return K.length>0?V(K):null},M=(F,V)=>V?F.spacing.gridSize*F.components.panel.headerHeight:0,L=(F,V,K,G,H,_)=>{const k=(F==="md"?V.components.panel.padding:0)*V.spacing.gridSize,J=k*2,z=1*2;let Y=0;_&&(Y=_-J-z);let X=0;return H&&(X=H-K-J-z),G&&(X=K),{contentStyle:{padding:k},innerWidth:Y,innerHeight:X}},A=F=>{const{background:V,borderColor:K,padding:G}=F.components.panel;return{container:(0,s.css)({label:"panel-container",backgroundColor:V,border:`1px solid ${K}`,position:"relative",borderRadius:F.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".always-show":{background:"none","&:focus-visible, &:hover":{background:F.colors.secondary.shade}},".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,h.getFocusStyles)(F),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,s.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${K}`}}),loadingBarContainer:(0,s.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,s.css)({contain:"none"}),content:(0,s.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,s.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,s.css)({cursor:"pointer"}),streaming:(0,s.css)({label:"panel-streaming",marginRight:0,color:F.colors.success.text,"&:hover":{color:F.colors.success.text}}),title:(0,s.css)({label:"panel-title",display:"flex",padding:F.spacing(0,G),minWidth:0,"& > h2":{minWidth:0}}),items:(0,s.css)({display:"flex"}),item:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,s.css)({visibility:"hidden"}),menuItem:(0,s.css)({label:"panel-menu",border:"none",background:F.colors.secondary.main,"&:hover":{background:F.colors.secondary.shade}}),errorContainerFloating:(0,s.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,s.css)({display:"flex",padding:F.spacing(0,G),gap:F.spacing(1)}),rightAligned:(0,s.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,s.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,s.css)({alignItems:"center",display:"flex",gap:F.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},U=w;U.LoadingIndicator=n.I,U.TitleItem=O},49256:(Z,R,e)=>{"use strict";e.d(R,{B:()=>n});var n=(a=>(a.ToggleSelection="select",a.AppendToSelection="append",a))(n||{})},3023:(Z,R,e)=>{"use strict";e.d(R,{_:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i,...c})=>{const m=(0,s.of)(o);return(0,n.jsx)("div",{className:(0,a.cx)(m,i),...c,children:d})},o=d=>(0,a.css)({backgroundColor:d.components.panel.background,border:`1px solid ${d.components.panel.borderColor}`,borderRadius:d.shape.radius.default})},63509:(Z,R,e)=>{"use strict";e.d(R,{B:()=>o});var n=e(74848),a=e(11594),s=e(99887);const l={[a.kv.grafana]:"grafana",[a.kv.commercial]:"shield",[a.kv.community]:"shield",DEFAULT:"shield-exclamation"},o=({status:i,color:c,signatureType:m,signatureOrg:p,...h})=>{const r=d(i,m,p);return(0,n.jsx)(s.E,{text:r.text,color:r.color,icon:r.icon,tooltip:r.tooltip,...h})};o.displayName="PluginSignatureBadge";function d(i,c,m){i||(i=a.Ac.invalid);const p=l[c||""]||l.DEFAULT;switch(i){case a.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case a.Ac.valid:return{text:c||"Signed",icon:c?p:"lock",color:"green",tooltip:"Signed and verified plugin"};case a.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case a.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case a.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},92505:(Z,R,e)=>{"use strict";e.d(R,{X:()=>C});var n=e(74848),a=e(22803),s=e(46942),l=e.n(s),o=e(2543),d=e.n(o),i=e(96540),c=e(52845),m=e(29317),p=e(51898),h=e(16123),r=e(54024),g=e(52513),y=e(21266),v=e(59490),x=e(91272),f=e(93427),u=e(63142),b=e(35484),E=e(35458);class D extends i.PureComponent{constructor(O){super(O),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(S,w)=>{const N=S.document!==this.state.value.document,M=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(S),this.setState({value:S},()=>{if(N){const L=c.default.serialize(M)!==c.default.serialize(S);L&&w&&this.runOnChangeAndRunQuery(),L&&!w&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:S}=this.props,w=c.default.serialize(this.state.value);S&&S(this.cleanText(w))},this.runOnRunQuery=()=>{const{onRunQuery:S}=this.props;S&&(S(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(S,w,N)=>{const{onBlur:M}=this.props;if(M)M();else{const L=this.lastExecutedValue?c.default.serialize(this.lastExecutedValue):"",A=c.default.serialize(w.value);L!==A&&this.runOnChangeAndRunQuery()}return N()},this.runOnChangeDebounced=(0,o.debounce)(this.runOnChange,500);const{onTypeahead:I,cleanText:j,portalOrigin:W,onWillApplySuggestion:B}=O;this.plugins=[(0,f.Pz)({onTypeahead:I,cleanText:j,portalOrigin:W,onWillApplySuggestion:B}),(0,v.U)({handler:this.runOnChangeAndRunQuery}),(0,y.O)(),(0,h.v)(),(0,x.l)(),(0,g.T)(),(0,r.s)(),...O.additionalPlugins||[]].filter(S=>S),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,E.mO)(O.query||"",O.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(O,I){const{query:j,syntax:W,syntaxLoaded:B}=this.props;if(!O.syntaxLoaded&&B&&this.editor){const w=this.editor.insertText(" ").deleteBackward(1);this.onChange(w.value,!0)}const{value:S}=this.state;j!==O.query&&j!==c.default.serialize(S)&&this.setState({value:(0,E.mO)(j||"",W)})}cleanText(O){return O.replace(/[\r]/g,"")}render(){const{disabled:O,theme:I}=this.props,j=l()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":O}),W=P(I);return(0,n.jsx)("div",{className:(0,a.cx)(j,W.wrapper),children:(0,n.jsx)("div",{className:"slate-query-field","data-testid":p.Tp.components.QueryField.container,children:(0,n.jsx)(m.Editor,{ref:B=>this.editor=B,schema:E.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:B=>{this.onChange(B.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const C=(0,u.cV)(D),P=T=>{const O=(0,b.getFocusStyles)(T);return{wrapper:(0,a.css)({"&:focus-within":O})}}},90811:(Z,R,e)=>{"use strict";e.d(R,{cC:()=>r,cb:()=>h});var n=e(74848),a=e(22803),s=e(58521),l=e(96540),o=e(74529),d=e(51898),i=e(92745),c=e(93256),m=e(15356),p=e(7895);const h=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class r extends l.PureComponent{constructor(x){super(x),this.onChangeSelect=f=>{const{onIntervalChanged:u}=this.props;u&&f.value!=null&&u(f.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=x=>x===r.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:x,intervals:f,tooltip:u,value:b,text:E,isLoading:D,noIntervalPicker:C,width:P,showAutoInterval:T}=this.props,O=b||"",I=this.getVariant(),j=y({intervals:f,showAutoInterval:T}),W=j.find(({value:V})=>V===O),B=g(r.offOption.value);let S=W||B;S.label===B.label&&(S={value:""});const w=S.ariaLabel,N=(0,i.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:w}),M=(0,i.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),L=S.value===""?M:N,A=(0,i.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),U=(0,i.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),F=S.value===""?U:A;return(0,n.jsxs)(c.e,{className:"refresh-picker",children:[(0,n.jsx)(p.I,{"aria-label":E,tooltip:u,onClick:x,variant:I,icon:D?"spinner":"sync",style:P?{width:P}:void 0,"data-testid":d.Tp.components.RefreshPicker.runButtonV2,children:E}),!C&&(0,n.jsx)(m.f,{className:(0,a.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"}),value:S,options:j,onChange:this.onChangeSelect,variant:I,"data-testid":d.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":L,tooltip:F})]})}}function g(v){switch(v){case r.liveOption.value:return{label:(0,i.t)("refresh-picker.live-option.label","Live"),value:v,ariaLabel:(0,i.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case r.offOption.value:return{label:(0,i.t)("refresh-picker.off-option.label","Off"),value:v,ariaLabel:(0,i.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case r.autoOption.value:return{label:(0,i.t)("refresh-picker.auto-option.label",r.autoOption.label),value:v,ariaLabel:(0,i.t)("refresh-picker.auto-option.aria-label",r.autoOption.ariaLabel)}}return{label:v,value:v}}function y({intervals:v=h,showAutoInterval:x=!1}={}){const f=v.map(u=>{const b=(0,o.E9)(u),E=(0,s.a)(b);return{label:u,value:u,ariaLabel:E}});return x&&f.unshift(g(r.autoOption.value)),f.unshift(g(r.offOption.value)),f}},70663:(Z,R,e)=>{"use strict";e.d(R,{I:()=>s});var n=e(96540),a=e(63704);function s({component:l,content:o,...d}){return n.createElement(l||"span",{dangerouslySetInnerHTML:{__html:a.sQ.sanitize(o)},...d})}},23659:(Z,R,e)=>{"use strict";e.d(R,{L:()=>i});var n=e(74848),a=e(2543),s=e.n(a),l=e(92745),o=e(45861),d=e(94959);const i=({label:c="Password",labelWidth:m,inputWidth:p=12,onReset:h,isConfigured:r,tooltip:g,placeholder:y="Password",interactive:v,...x})=>(0,n.jsx)(d.z,{label:c,tooltip:g,interactive:v,labelWidth:m,inputEl:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"text",className:`gf-form-input width-${p}`,disabled:!0,value:"configured",...(0,a.omit)(x,"value")}),(0,n.jsx)(o.$n,{onClick:h,variant:"secondary",type:"button",children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.secret-form-field.reset",children:"Reset"})})]}):(0,n.jsx)("input",{type:"password",className:`gf-form-input width-${p}`,placeholder:y,...x})});i.displayName="SecretFormField"},48767:(Z,R,e)=>{"use strict";e.d(R,{L4:()=>i});var n=e(74848),a=e(45861),s=e(63527),l=e(41654);const o="configured",d="Reset",i=({isConfigured:c,onReset:m,...p})=>(0,n.jsxs)(l.B,{children:[!c&&(0,n.jsx)(s.p,{...p,type:"password"}),c&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{...p,type:"text",disabled:!0,value:o}),(0,n.jsx)(a.$n,{onClick:m,variant:"secondary",children:d})]})]})},40601:(Z,R,e)=>{"use strict";e.d(R,{lp:()=>h});var n=e(74848),a=e(22803),s=e(63142),l=e(45861),o=e(31286),d=e(41654),i=e(87105);const c="configured",m="Reset",p=r=>({configuredStyle:(0,a.css)({minHeight:r.spacing(r.components.height.md),paddingTop:r.spacing(.5),resize:"none"})}),h=({isConfigured:r,onReset:g,...y})=>{const v=(0,s.of)(p);return(0,n.jsxs)(d.B,{children:[(0,n.jsxs)(o.a,{children:[!r&&(0,n.jsx)(i.f,{...y}),r&&(0,n.jsx)(i.f,{...y,rows:1,disabled:!0,value:c,className:(0,a.cx)(v.configuredStyle)})]}),r&&(0,n.jsx)(l.$n,{onClick:g,variant:"secondary",children:m})]})}},61875:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>p});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(63142),d=e(79233),i=e(89467),c=e(37864),m=e(3431);function p({options:h,value:r,onChange:g,Component:y,className:v,allowCustomValue:x,allowEmptyValue:f,placeholder:u,disabled:b,inputMinWidth:E,inputPlaceholder:D,onExpandedChange:C,autofocus:P=!1,...T}){const[O,I,j,W]=(0,m.Q)(P,C),B=E?Math.max(E,I):I,S=(0,o.of)(c.m);if(!j){const w=(0,s.isObject)(r)?r.label:r,N=w!=null?String(w):void 0;return(0,n.jsx)(O,{disabled:b,Component:y||(0,n.jsx)(d.c,{className:(0,a.cx)(S.segment,{[S.queryPlaceholder]:u!==void 0&&!r,[S.disabled]:b},v),children:N||u})})}return(0,n.jsx)(i.a,{...T,value:r&&!(0,s.isObject)(r)?{value:r}:r,placeholder:D,options:h,width:B,onClickOutside:()=>W(!1),allowCustomValue:x,allowEmptyValue:f,onChange:w=>{W(!1),g(w)}})}},76671:(Z,R,e)=>{"use strict";e.d(R,{s:()=>r});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(41053),d=e(92745),i=e(63142),c=e(79233),m=e(89467),p=e(37864),h=e(3431);function r({value:y,onChange:v,loadOptions:x,reloadOptionsOnChange:f=!1,Component:u,className:b,allowCustomValue:E,allowEmptyValue:D,disabled:C,placeholder:P,inputMinWidth:T,inputPlaceholder:O,autofocus:I=!1,onExpandedChange:j,noOptionMessageHandler:W=g,...B}){const[S,w]=(0,o.A)(x,[x]),[N,M,L,A]=(0,h.Q)(I,j),U=T?Math.max(T,M):M,F=(0,i.of)(p.m);if(!L){const V=(0,s.isObject)(y)?y.label:y,K=V!=null?String(V):void 0;return(0,n.jsx)(N,{onClick:f?void 0:w,disabled:C,Component:u||(0,n.jsx)(c.c,{className:(0,a.cx)(F.segment,{[F.queryPlaceholder]:P!==void 0&&!y,[F.disabled]:C},b),children:K||P})})}return(0,n.jsx)(m.a,{...B,value:y&&!(0,s.isObject)(y)?{value:y}:y,placeholder:O,options:S.value??[],loadOptions:f?w:void 0,width:U,noOptionsMessage:W(S),allowCustomValue:E,allowEmptyValue:D,onClickOutside:()=>{A(!1)},onChange:V=>{A(!1),v(V)}})}function g(y){return y.loading?(0,d.t)("grafana-ui.segment-async.loading","Loading options..."):y.error?(0,d.t)("grafana-ui.segment-async.error","Failed to load options"):(0,d.t)("grafana-ui.segment-async.no-options","No options found")}},3263:(Z,R,e)=>{"use strict";e.d(R,{o:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(29647),o=e(63142),d=e(53568),i=e(79233),c=e(37864),m=e(3431);const p=14;function h({value:r,onChange:g,Component:y,className:v,placeholder:x,inputPlaceholder:f,disabled:u,autofocus:b=!1,onExpandedChange:E,...D}){const C=(0,s.useRef)(null),[P,T]=(0,s.useState)(r),[O,I]=(0,s.useState)((0,d.kD)((r||"").toString(),p).width),[j,,W,B]=(0,m.Q)(b,E),S=(0,o.of)(c.m);if((0,l.A)(C,()=>{B(!1),g(P)}),!W)return(0,n.jsx)(j,{disabled:u,Component:y||(0,n.jsx)(i.c,{className:(0,a.cx)(S.segment,{[S.queryPlaceholder]:x!==void 0&&!P,[S.disabled]:u},v),children:r||x})});const w=(0,a.css)({width:`${Math.max(O+20,32)}px`});return(0,n.jsx)("input",{...D,ref:C,autoFocus:!0,className:(0,a.cx)("gf-form gf-form-input",w),value:P,placeholder:f,onChange:N=>{const{width:M}=(0,d.kD)(N.target.value,p);I(M),T(N.target.value)},onBlur:()=>{B(!1),g(P)},onKeyDown:N=>{[13,27].includes(N.keyCode)&&(B(!1),g(P))}})}},52042:(Z,R,e)=>{"use strict";e.d(R,{L:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(97095),o=e(79233);const d=({label:c,htmlFor:m,children:p,fill:h})=>{const r=(0,s.of)(i);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(l.C,{children:[(0,n.jsx)(o.c,{htmlFor:m,width:12,className:r.label,children:c}),p,h&&(0,n.jsx)("div",{className:r.fill,children:(0,n.jsx)(o.c,{children:""})})]})})},i=c=>({label:(0,a.css)({color:c.colors.primary.text}),fill:(0,a.css)({flexGrow:1,marginBottom:c.spacing(.5)})})},89467:(Z,R,e)=>{"use strict";e.d(R,{a:()=>o});var n=e(74848),a=e(96540),s=e(63142),l=e(18857);function o({value:d,placeholder:i="",options:c=[],onChange:m,onClickOutside:p,loadOptions:h=void 0,width:r,noOptionsMessage:g="",allowCustomValue:y=!1,allowEmptyValue:v=!1,...x}){const f=(0,a.useRef)(null),u=(0,s.$j)();let b=r>0?r/u.spacing.gridSize:void 0,E,D={};return h?(E=l.DW,D={loadOptions:h,defaultOptions:!0}):E=l.l6,(0,n.jsx)("div",{...x,ref:f,children:(0,n.jsx)(E,{width:b,noOptionsMessage:g,placeholder:i,autoFocus:!0,isOpen:!0,onChange:m,options:c,value:d,closeMenuOnSelect:!1,onCloseMenu:()=>{if(f&&f.current){const C=f.current.querySelector('input[id^="react-select-"]');C&&(C.value||v)?m({value:C.value,label:C.value}):p()}},allowCustomValue:y,...D})})}},37864:(Z,R,e)=>{"use strict";e.d(R,{m:()=>a});var n=e(22803);const a=s=>{const l="v1"in s?s.v1.palette:s.palette;return{segment:(0,n.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,n.css)({color:l.gray2}),disabled:(0,n.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},3431:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>o});var n=e(74848),a=e(96540),s=e(63142),l=e(45861);const o=(d,i)=>{const c=(0,a.useRef)(null),m=(0,s.of)(l.my),[p,h]=(0,a.useState)(d),[r,g]=(0,a.useState)(0),y=x=>{h(x),i&&i(x)};return[({Component:x,onClick:f,disabled:u})=>(0,n.jsx)("button",{type:"button",className:m,ref:c,disabled:u,onClick:()=>{y(!0),c&&c.current&&g(c.current.clientWidth*1.25),f?.()},children:x}),r,p,y]}},82143:(Z,R,e)=>{"use strict";e.d(R,{u:()=>g});var n=e(2543),a=e.n(n),s=e(96540),l=e(13752),o=e(62467),d=e(11150),i=e(96083),c=e(63720),m=e(59099),p=e(8934),h=e(90811);function r(y){return{label:y,value:stringToMs(y)}}class g extends s.PureComponent{constructor(v){super(v),this.propsSubject=new l.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,c.n)(v=>h.cC.isLive(v.interval)?(0,o.of)({}):v.loading?d.t:(0,i.Y)((0,p.dc)(v.interval))),(0,m.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(v){h.cC.isLive(v.interval)&&h.cC.isLive(this.props.interval)||(0,n.isEqual)(v,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},59795:(Z,R,e)=>{"use strict";e.d(R,{I1:()=>b,_$:()=>v,gl:()=>r});var n=e(2543),a=e.n(n),s=e(38919),l=e(46644),o=e(33553),d=e(35987),i=e(64394),c=e(60519),m=e(36394),p=e(739);const h=["reduceOptions","orientation"];function r(C,P,T){let O=C.options;if(C.fieldConfig=C.fieldConfig||{defaults:{},overrides:[]},P==="singlestat"&&T.angular)return y(C,T);if(P==="graph")return g(C,T);for(const I of h)T.hasOwnProperty(I)&&(O[I]=(0,n.cloneDeep)(T[I]));return O}function g(C,P){const T=P.angular,O={orientation:s.wV.Auto,reduceOptions:{values:!1,calcs:[]},legend:{displayMode:p.lm.List,showLegend:!0,placement:"bottom",calcs:[]}};if(T.xaxis?.mode==="series"){C.fieldConfig={...C.fieldConfig,defaults:{...C.fieldConfig.defaults,color:{mode:"palette-classic"}}},T.xaxis.values&&(O.reduceOptions.calcs=D(T.xaxis.values));const I=T.legend;if(I){if(I.show?O.legend.displayMode=I.alignAsTable?p.lm.Table:p.lm.List:O.legend.showLegend=!1,I.rightSide&&(O.legend.placement="right"),I.values){const j=(0,n.pickBy)(I,n.identity);O.legend.calcs=E(j)}I.sideWidth&&(O.legend.width=I.sideWidth)}}return O}function y(C,P){const T=P.angular,O=l.AS.getIfExists(T.valueName),I={reduceOptions:{calcs:[O?O.id:l.gy.mean]},orientation:s.wV.Horizontal},j={};if(T.format&&(j.unit=T.format),T.tableColumn&&(I.reduceOptions.fields=`/^${T.tableColumn}$/`),T.nullPointMode&&(j.nullValueMode=T.nullPointMode),T.nullText&&(j.noValue=T.nullText),(T.decimals||T.decimals===0)&&(j.decimals=T.decimals),T.thresholds&&T.colors){const B=T.thresholds.split(",").map(w=>Number(w.trim())),S=[];for(const w of T.colors){const N=S.length-1;N>=0?S.push({value:B[N],color:w}):S.push({value:-1/0,color:w})}j.thresholds={mode:o.O.Absolute,steps:S}}const W=(0,d.bh)(T,j.thresholds);return W&&W.length&&(j.mappings=W),T.gauge&&T.gauge.show&&(j.min=T.gauge.minValue,j.max=T.gauge.maxValue),C.fieldConfig.defaults=j,I}function v(C){if(!C.options)return{reduceOptions:{calcs:[l.gy.mean]},orientation:s.wV.Horizontal};const P=parseFloat(C.pluginVersion||"6.1");let T=C.options;P<6.2&&(T=f(T)),P<6.3&&(T=x(T));const{fieldOptions:O}=T;if(P<6.6&&O){if(O&&O.override){const{override:W,...B}=T.fieldOptions;T={...T,fieldOptions:{...B,overrides:[]}}}let I=O?.defaults?.thresholds;I?delete O.defaults.thresholds:(I=O?.thresholds,delete O.thresholds),I&&(O.defaults.thresholds={mode:o.O.Absolute,steps:I});const{defaults:j}=O;j.color&&typeof j.color=="string"&&(j.color={mode:i.Y.Fixed,fixedColor:j.color}),(0,c.BF)(j)}if(P<7&&(C.fieldConfig=C.fieldConfig||{defaults:{},overrides:[]},C.fieldConfig={defaults:O&&O.defaults?{...C.fieldConfig.defaults,...O.defaults}:C.fieldConfig.defaults,overrides:O&&O.overrides?[...C.fieldConfig.overrides,...O.overrides]:C.fieldConfig.overrides},O&&(T.reduceOptions={values:O.values,limit:O.limit,calcs:O.calcs}),delete T.fieldOptions),P<7.1){const I=C.fieldConfig.defaults.title;I!=null&&(C.fieldConfig.defaults.displayName=I,delete C.fieldConfig.defaults.title)}if(P<8){const I=C.fieldConfig?.defaults;let j=I?.unit;j==="percent"?((0,n.isNumber)(I.min)||(I.min=0),(0,n.isNumber)(I.max)||(I.max=100)):j==="percentunit"&&((0,n.isNumber)(I.min)||(I.min=0),(0,n.isNumber)(I.max)||(I.max=1))}return T}function x(C){const{fieldOptions:P}=C;if(!P)return C;const{mappings:T,...O}=C.fieldOptions;let I;return C.thresholds&&(I={mode:o.O.Absolute,steps:u(C.thresholds)}),{...C,fieldOptions:{...O,defaults:{...P.defaults,mappings:T,thresholds:I}}}}function f(C){const{valueOptions:P}=C;if(!P)return C;const T={},O={};if(T.mappings=C.valueMappings,T.thresholds=C.thresholds,T.defaults=O,O.unit=P.unit,O.decimals=P.decimals,P.stat){const j=l.AS.get(P.stat);j&&(T.calcs=[j.id])}O.min=C.minValue,O.max=C.maxValue;const I={...C,fieldOptions:T};return(0,n.omit)(I,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function u(C){if(!C||!C.length)return;const P=C.map(T=>({value:T.value===null?-1/0:T.value,color:T.color}));return(0,m.RU)(P),P[0].value=-1/0,P}function b(C){return(0,d.bh)(C)}function E(C){const P=[];for(const T in C){const O=l.AS.getIfExists(T);O&&P.push(O.id)}return P}function D(C){const P=[];return C?.forEach(T=>{Object.values(l.gy).includes(T)?P.push(T):T==="current"?P.push(l.gy.lastNotNull):T==="total"?P.push(l.gy.sum):T==="avg"&&P.push(l.gy.mean)}),C?P:[l.gy.sum]}},21103:(Z,R,e)=>{"use strict";e.d(R,{F:()=>r});var n=e(74848),a=e(22803),s=e(17437),l=e(69156),o=e(96540),d=e(63142),i=e(5994);const c=g=>{const{value:y,children:v,visible:x,placement:f,tipFormatter:u,...b}=g,E=(0,o.useRef)(null),D=(0,o.useRef)(null),C=(0,d.of)(m);function P(){D.current!==null&&cancelAnimationFrame(D.current)}function T(){D.current=requestAnimationFrame(()=>{E.current?.forceAlign()})}return(0,o.useEffect)(()=>(x?T():P(),P),[y,x]),(0,n.jsx)(i.A,{overlayClassName:C.tooltip,placement:f,overlay:u??y,overlayInnerStyle:{minHeight:"auto"},ref:E,visible:x,...b,children:v})},m=g=>({tooltip:(0,a.css)({position:"absolute",display:"block",visibility:"visible",fontSize:g.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:g.zIndex.tooltip})}),p=c;var h=e(91302);const r=({min:g,max:y,onChange:v,onAfterChange:x,orientation:f="horizontal",reverse:u,step:b,formatTooltipResult:E,value:D,tooltipAlwaysVisible:C=!0})=>{const P=(0,o.useCallback)(W=>{v?.(typeof W=="number"?[W,W]:W)},[v]),T=(0,o.useCallback)(W=>{x?.(typeof W=="number"?[W,W]:W)},[x]),O=f==="horizontal",I=(0,d.of)(h.$,O),j=(W,B)=>(0,n.jsx)(p,{value:B.value,visible:C||B.dragging,tipFormatter:E?()=>E(B.value):void 0,placement:O?"top":"right",children:W});return(0,n.jsxs)("div",{className:(0,a.cx)(I.container,I.slider),children:[(0,n.jsx)(s.Global,{styles:I.tooltip}),(0,n.jsx)(l.A,{min:g,max:y,step:b,defaultValue:D,range:!0,onChange:P,onChangeComplete:T,vertical:!O,reverse:u,handleRender:j})]})};r.displayName="RangeSlider"},91302:(Z,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(22803),a=e(17437);const s=(l,o,d=!1)=>{const{spacing:i}=l,c=l.colors.border.strong,m=l.colors.primary.main,p=l.colors.primary.main,r=`box-shadow: 0px 0px 0px 6px ${l.colors.primary.transparent}`;return{container:(0,n.css)({width:"100%",margin:o?"inherit":i(1,3,1,1),paddingBottom:o&&d?l.spacing(1):"inherit",height:o?"auto":"100%"}),slider:(0,n.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${l.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${l.colors.text.disabled};
        font-size: ${l.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${l.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${p};
        box-shadow: ${l.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${r};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${l.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${l.colors.text.primary};
        border-color: ${l.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${m};
      }
      .rc-slider-rail {
        background-color: ${c};
        cursor: pointer;
      }
    `,tooltip:(0,a.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${l.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${l.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,n.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,n.css)({marginLeft:l.spacing(3),input:{textAlign:"center"}}),sliderInputFieldVertical:(0,n.css)({margin:`0 0 ${l.spacing(3)} 0`,order:1})}}},53431:(Z,R,e)=>{"use strict";e.d(R,{O:()=>f});var n=e(74848),a=e(2543),s=e(96540),l=e(34455),o=e(76732),d=e(95004),i=e(76637),c=e(739),m=e(92790),p=e(47276),h=e(36192),r=e(8721),g=e(41119),y=e(63409);function v(u,b){const E=u.y.values.length,D={...u.y.config,...b},C=u.x??{name:"",values:[...Array(E).keys()],type:d.PU.number,config:{}};let P={refId:"sparkline",fields:[C,{...u.y,config:D}],length:E};return(0,r.g2)(C.values)||(P=(0,g.ES)(P,0)),(0,y.M)({frame:P,refFieldPseudoMin:u.timeRange?.from.valueOf(),refFieldPseudoMax:u.timeRange?.to.valueOf()})}const x={drawStyle:c.GR.Line,showPoints:c.yL.Auto,axisPlacement:c.vM.Hidden,pointSize:2};class f extends s.PureComponent{constructor(b){super(b);const E=v(b.sparkline,b.config);this.state={data:(0,h.bq)(E,(0,h.ro)(E)),alignedDataFrame:E,configBuilder:this.prepareConfig(E)}}static getDerivedStateFromProps(b,E){const D=v(b.sparkline,b.config),C=(0,l.C)(D);return C?{...E,data:(0,h.bq)(C,(0,h.ro)(C)),alignedDataFrame:C}:{...E}}componentDidUpdate(b,E){const{alignedDataFrame:D}=this.state;if(!D)return;let C=!1;if(b.sparkline!==this.props.sparkline){const P=!(0,o.bW)(this.state.alignedDataFrame,E.alignedDataFrame),T=!(0,a.isEqual)(D.fields[1].state?.range,E.alignedDataFrame.fields[1].state?.range);C=P||T}else C=!(0,a.isEqual)(b.config,this.props.config);C&&this.setState({configBuilder:this.prepareConfig(D)})}getYRange(b){let{min:E,max:D}=this.state.alignedDataFrame.fields[1].state?.range;const C=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(C)||(E=Math.min(E,+C),D=Math.max(D,+C)),E===D?(E===0?D=100:(E=0,D*=2),[E,D]):[Math.max(E,b.config.min??-1/0),Math.min(D,b.config.max??1/0)]}prepareConfig(b){const{theme:E}=this.props,D=new p.e;D.setCursor({show:!1,x:!1,y:!1});const C=b.fields[0];D.addScale({scaleKey:"x",orientation:c.Lt.Horizontal,direction:c.ON.Right,isTime:!1,range:()=>{const{sparkline:P}=this.props;if(P.x){if(P.timeRange&&P.x.type===d.PU.time)return[P.timeRange.from.valueOf(),P.timeRange.to.valueOf()];const T=P.x.values;return[T[0],T[T.length-1]]}return[0,P.y.values.length-1]}}),D.addAxis({scaleKey:"x",theme:E,placement:c.vM.Hidden});for(let P=0;P<b.fields.length;P++){const T=b.fields[P],O=T.config,I={...x,...O.custom};if(T===C||T.type!==d.PU.number)continue;const j=O.unit||"__fixed";D.addScale({scaleKey:j,orientation:c.Lt.Vertical,direction:c.ON.Up,range:()=>this.getYRange(T)}),D.addAxis({scaleKey:j,theme:E,placement:c.vM.Hidden});const W=(0,i.Qi)(T),B=W.getCalculator(T,E)(0,0),S=I.drawStyle===c.GR.Points?c.yL.Always:I.showPoints;D.addSeries({pxAlign:!1,scaleKey:j,theme:E,colorMode:W,thresholds:O.thresholds,drawStyle:I.drawStyle,lineColor:I.lineColor??B,lineWidth:I.lineWidth,lineInterpolation:I.lineInterpolation,showPoints:S,pointSize:I.pointSize,fillOpacity:I.fillOpacity,fillColor:I.fillColor,lineStyle:I.lineStyle,gradientMode:I.gradientMode,spanNulls:I.spanNulls})}return D}render(){const{data:b,configBuilder:E}=this.state,{width:D,height:C}=this.props;return(0,n.jsx)(m.Z,{data:b,config:E,width:D,height:C})}}},93008:(Z,R,e)=>{"use strict";e.d(R,{h:()=>h});var n=e(22803),a=e(2543),s=e.n(a),l=e(96540),o=e(63142),d=e(45897);const i=.3,c=new Set(["ArrowUp","ArrowDown"]),m=new Set(["ArrowLeft","ArrowRight"]),p={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function h(x){const{direction:f,initialSize:u=x.usePixels?300:.5,dragPosition:b="middle",onResizing:E,onSizeChanged:D,usePixels:C}=x,P=v(x.handleSize),T=(0,l.useRef)(null),O=(0,l.useRef)(null),I=(0,l.useRef)(null),j=(0,l.useRef)(null),W=(0,l.useRef)(null),B=(0,l.useRef)(null),S=(0,l.useRef)(void 0),w=(0,l.useRef)(void 0),N=p[f].dim,M=p[f].axis,L=p[f].min,A=p[f].max,U=(0,l.useRef)(null),F=(0,l.useCallback)(ie=>{!O.current||!I.current||(B.current=O.current.getBoundingClientRect()[N],W.current=j.current.getBoundingClientRect()[N],U.current=ie[M],T.current.setPointerCapture(ie.pointerId),C?S.current=g(I.current,C):S.current=g(O.current),w.current=void 0)},[N,M,C]),V=(0,l.useCallback)(ie=>{if(!W.current||!B.current||!I.current)return;const he=B.current,me=W.current-he-P,ce=S.current;if(C){const Pe=(0,a.clamp)(me-ie,ce[L],ce[A]);I.current.style.flexBasis=`${Pe}px`,T.current.ariaValueNow=`${Pe}`,E?.(Pe,he+ie,Pe)}else{const Pe=(0,a.clamp)(B.current+ie,ce[L],ce[A]),Ie=Pe/(W.current-P);O.current.style.flexGrow=`${Ie}`,I.current.style.flexGrow=`${1-Ie}`,T.current.ariaValueNow=r(Pe,ce[L],ce[A]),E?.(Ie,Pe,me-ie)}},[E,P,C,L,A]),K=(0,l.useCallback)(ie=>{U.current!==null&&V(ie[M]-U.current)},[V,M]),G=(0,l.useCallback)(ie=>{ie.preventDefault(),ie.stopPropagation(),U.current=null,T.current.releasePointerCapture(ie.pointerId);const he=O.current.getBoundingClientRect()[N],me=W.current-he-P;D?.(parseFloat(O.current.style.flexGrow),he,me)},[D,P,N]),H=(0,l.useRef)(new Set),_=(0,l.useRef)(null),k=(0,l.useCallback)(ie=>{if(H.current.size===0){_.current=null;return}else if(B.current===null)return;const ce=(ie-(_.current??ie))*i;let Pe=0;f==="row"?(H.current.has("ArrowLeft")&&(Pe-=ce),H.current.has("ArrowRight")&&(Pe+=ce)):(H.current.has("ArrowUp")&&(Pe-=ce),H.current.has("ArrowDown")&&(Pe+=ce)),B.current=O.current.getBoundingClientRect()[N],W.current=j.current.getBoundingClientRect()[N],V(Pe),_.current=ie,window.requestAnimationFrame(k)},[f,N,V]),J=(0,l.useCallback)(ie=>{if(!O.current||!I.current||!T.current||!j.current||!(f==="column"&&c.has(ie.key)||f==="row"&&m.has(ie.key))||H.current.has(ie.key))return;if(w.current=void 0,ie.preventDefault(),ie.stopPropagation(),B.current=O.current.getBoundingClientRect()[N],W.current=j.current.getBoundingClientRect()[N],C?S.current=g(I.current):S.current=g(O.current),!H.current.has(ie.key)){const me=H.current.size===0;H.current.add(ie.key),me&&window.requestAnimationFrame(k)}},[f,k,,N,C]),z=(0,l.useCallback)(ie=>{if(!(f==="row"&&!m.has(ie.key)||f==="column"&&!c.has(ie.key))&&(H.current.delete(ie.key),B.current!==null)){const he=W.current-B.current-P;D?.(parseFloat(O.current.style.flexGrow),B.current,he)}},[f,D,P]),Y=(0,l.useCallback)(()=>{!O.current||!I.current||(C?I.current.style.flexBasis=`${u}px`:(O.current.style.flexGrow="0.5",I.current.style.flexGrow="0.5",B.current=O.current.getBoundingClientRect()[N],T.current.ariaValueNow="50"))},[N,C,u]),X=(0,l.useCallback)(()=>{if(H.current.size>0&&(H.current.clear(),U.current=null,typeof B.current=="number")){const ie=W.current-B.current-P;D?.(parseFloat(O.current.style.flexGrow),B.current,ie)}},[D,P]),Q=(0,o.of)(y,f),q=(0,o.of)(d.l,b),te=f==="column"?q.dragHandleHorizontal:q.dragHandleVertical,ne=(0,l.useId)(),se={flexGrow:(0,a.clamp)(u,0,1),[L]:"min-content"},ue={flexGrow:(0,a.clamp)(1-u,0,1),[L]:"min-content"};C&&(se.flexGrow=1,ue.flexGrow="unset",ue.flexBasis=`${u}px`);const de=`start-panel-${ne}`;return{containerProps:{ref:j,className:Q.container},primaryProps:{ref:O,className:Q.panel,style:se,id:de},secondaryProps:{ref:I,className:Q.panel,style:ue},splitterProps:{onPointerUp:G,onPointerDown:F,onPointerMove:K,onKeyDown:J,onKeyUp:z,onDoubleClick:Y,onBlur:X,ref:T,style:{[N]:`${P}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":u*100,"aria-controls":de,"aria-label":"Pane resize widget",tabIndex:0,className:te}}}function r(x,f,u){return`${(0,a.clamp)((x-f)/(u-f)*100,0,100)}`}function g(x,f){const u=document.body.style.overflow,b=x.style.width,E=x.style.height,D=x.style.flexGrow,C=x.style.flexBasis;document.body.style.overflow="hidden",x.style.flexGrow="0",x.style.flexBasis="0";const{width:P,height:T}=x.getBoundingClientRect();x.style.flexGrow="100";const{width:O,height:I}=x.getBoundingClientRect();return document.body.style.overflow=u,x.style.width=b,x.style.height=E,x.style.flexGrow=D,x.style.flexBasis=C,{minWidth:P,maxWidth:O,minHeight:T,maxHeight:I}}function y(x,f){return{container:(0,n.css)({display:"flex",flexDirection:f==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,n.css)({display:"flex",position:"relative",flexBasis:0})}}function v(x="md"){return{xs:4,sm:8,md:16,lg:32}[x]}},34107:(Z,R,e)=>{"use strict";e.d(R,{S:()=>i});var n=e(74848),a=e(2543),s=e.n(a),l=e(96540),o=e(46644),d=e(18857);class i extends l.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:m,allowMultiple:p,defaultStat:h,onChange:r}=this.props,g=o.AS.list(m);if(g.length!==m.length){const y=g.map(x=>x.id),v=(0,a.difference)(m,y);console.warn("Unknown stats",v,m),r(g.map(x=>x.id))}!p&&m.length>1&&(console.warn("Removing extra stat",m),r([m[0]])),h&&m.length<1&&r([h])},this.onSelectionChange=m=>{const{onChange:p}=this.props;Array.isArray(m)?p(m.map(h=>h.value)):p(m&&m.value?[m.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(m){this.checkInput()}render(){const{stats:m,allowMultiple:p,defaultStat:h,placeholder:r,className:g,menuPlacement:y,width:v,inputId:x,filterOptions:f}=this.props,u=o.AS.selectOptions(m,f);return(0,n.jsx)(d.l6,{value:u.current,className:g,isClearable:!h,isMulti:p,width:v,isSearchable:!0,options:u.options,placeholder:r,onChange:this.onSelectionChange,menuPlacement:y,inputId:x})}}},21285:(Z,R,e)=>{"use strict";e.d(R,{K:()=>h,d:()=>p});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(37615),i=e(63142),c=e(35484),m=e(30703);const p=(0,o.forwardRef)(({value:g,checked:y,onChange:v,id:x,label:f,disabled:u,invalid:b=!1,...E},D)=>{y&&(0,d.l)("Switch","checked prop","value");const C=(0,i.of)(r),P=(0,o.useRef)(x||(0,s.uniqueId)("switch-"));return(0,n.jsxs)("div",{className:(0,a.cx)(C.switch,b&&C.invalid),children:[(0,n.jsx)("input",{type:"checkbox",role:"switch",disabled:u,checked:g,onChange:T=>{!u&&v?.(T)},id:P.current,...E,ref:D}),(0,n.jsx)("label",{htmlFor:P.current,"aria-label":f,children:(0,n.jsx)(m.I,{name:"check",size:"xs"})})]})});p.displayName="Switch";const h=(0,o.forwardRef)(({transparent:g,className:y,showLabel:v,label:x,value:f,id:u,invalid:b,...E},D)=>{const C=(0,i.of)(r,g);return(0,n.jsxs)("div",{className:(0,a.cx)(C.inlineContainer,y,E.disabled&&C.disabled,b&&C.invalid),children:[v&&(0,n.jsx)("label",{htmlFor:u,className:(0,a.cx)(C.inlineLabel,f&&C.inlineLabelEnabled,"inline-switch-label"),children:x}),(0,n.jsx)(p,{...E,id:u,label:x,ref:D,value:f})]})});h.displayName="Switch";const r=(g,y)=>({switch:(0,a.css)({width:g.spacing(4),height:g.spacing(2),position:"relative",lineHeight:1,input:{height:"100%",width:"100% !important",opacity:0,zIndex:-1e3,position:"absolute","&:checked + label":{background:g.colors.primary.main,borderColor:g.colors.primary.main,"&:hover":{background:g.colors.primary.shade},svg:{transform:`translate3d(${g.spacing(2.25)}, -50%, 0)`,background:g.colors.primary.contrastText,color:g.colors.primary.main}},"&:disabled + label":{background:g.colors.action.disabledBackground,borderColor:g.colors.border.weak,cursor:"not-allowed",svg:{background:g.colors.text.disabled}},"&:disabled:checked + label":{background:g.colors.primary.transparent,svg:{color:g.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,c.getFocusStyles)(g),"&:focus:not(:focus-visible) + label":(0,c.getMouseFocusStyles)(g)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:g.shape.radius.pill,background:g.components.input.background,border:`1px solid ${g.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:g.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:g.spacing(1.5),height:g.spacing(1.5),borderRadius:g.shape.radius.circle,background:g.colors.text.secondary,boxShadow:g.shadows.z1,left:0,top:"50%",transform:`translate3d(${g.spacing(.25)}, -50%, 0)`,transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${g.colors.primary.contrastText}`}}}}),inlineContainer:(0,a.css)({padding:g.spacing(0,1),height:g.spacing(g.components.height.md),display:"inline-flex",alignItems:"center",background:y?"transparent":g.components.input.background,border:`1px solid ${y?"transparent":g.components.input.borderColor}`,borderRadius:g.shape.radius.default,"&:hover":{border:`1px solid ${y?"transparent":g.components.input.borderHover}`,".inline-switch-label":{color:g.colors.text.primary}}}),disabled:(0,a.css)({backgroundColor:y?"transparent":"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:`1px solid ${y?"transparent":"rgba(204, 204, 220, 0.04)"}`}),inlineLabel:(0,a.css)({cursor:"pointer",paddingRight:g.spacing(1),color:g.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,a.css)({color:g.colors.text.primary}),invalid:(0,a.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${g.colors.error.border}`}})})},64467:(Z,R,e)=>{"use strict";e.d(R,{q:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(76319),o=e(60208),d=e(13941),i=e(54314),c=e(63142),m=e(31286),p=e(92807);function h({tabs:g,defaultTab:y,closeIconTooltip:v,onClose:x,testId:f}){const[u,b]=(0,s.useState)(g.some(C=>C.value===y)?y:g[0].value),E=(0,c.of)(r),D=C=>{b(C.value)};return(0,n.jsxs)("div",{className:E.container,"data-testid":f,children:[(0,n.jsxs)(i.U,{className:E.tabs,children:[g.map(C=>(0,n.jsx)(o.o,{label:C.label,active:C.value===u,onChangeTab:()=>D(C),icon:C.icon},C.value)),(0,n.jsx)(m.a,{grow:1,display:"flex",justifyContent:"flex-end",paddingRight:1,children:(0,n.jsx)(l.K,{size:"lg",onClick:x,name:"times",tooltip:v??"Close"})})]}),(0,n.jsx)(p.P,{children:(0,n.jsx)(d.J,{className:E.tabContent,children:g.find(C=>C.value===u)?.content})})]})}const r=g=>({container:(0,a.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",minHeight:0}),tabContent:(0,a.css)({padding:g.spacing(2),backgroundColor:g.colors.background.primary,flex:1}),tabs:(0,a.css)({paddingTop:g.spacing(.5),borderColor:g.colors.border.weak,ul:{marginLeft:g.spacing(2)}})})},93948:(Z,R,e)=>{"use strict";e.d(R,{a:()=>g,t:()=>r});var n=e(74848),a=e(79118),s=e(41119),l=e(55386),o=e(95004),d=e(739),i=e(63142),c=e(53568),m=e(21539),p=e(53431),h=e(74198);const r={type:d.ob.Sparkline,drawStyle:d.GR.Line,lineInterpolation:d.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:d.on.Hue,pointSize:2,barAlignment:d.Nj.Center,showPoints:d.yL.Never,hideValue:!1},g=x=>{const{field:f,innerWidth:u,tableStyles:b,cell:E,cellProps:D,timeRange:C}=x,P=y(E.value),T=(0,i.$j)();if(!P)return(0,n.jsx)("div",{...D,className:b.cellContainer,children:f.config.noValue||"no data"});P.x&&!P.x.config.interval&&P.x.values.length>1&&(P.x.config.interval=P.x.values[1]-P.x.values[0]),P.y.values=P.y.values.map(w=>Number.isFinite(w)?w:null);const O=(0,a.AP)(P.y);P.y.config.min=O.min,P.y.config.max=O.max,P.y.state={range:O},P.timeRange=C;const I=v(f),j={color:f.config.color,custom:{...r,...I}},W=f.config.custom?.cellOptions?.hideValue;let B=0,S=null;if(!W){const w=(0,s.LI)(E.value)?E.value.value:null,N=f.display(w),M=(0,h.zi)(f,N,E.row.index);B=(0,c.kD)((0,l.cN)(M),16).width+T.spacing.gridSize,S=(0,n.jsx)(m.i,{style:{width:`${B-T.spacing.gridSize}px`,textAlign:"right",marginRight:T.spacing(1)},value:N})}return(0,n.jsxs)("div",{...D,className:b.cellContainer,children:[S,(0,n.jsx)("div",{children:(0,n.jsx)(p.O,{width:u-B,height:b.cellHeightInner,sparkline:P,config:j,theme:b.theme})})]})};function y(x){if(Array.isArray(x))return{y:{name:"test",type:o.PU.number,values:x,config:{}}};if((0,s.ci)(x)){const f=x.fields.find(b=>b.type===o.PU.time),u=x.fields.find(b=>b.type===o.PU.number);if(f&&u)return{x:f,y:u}}}function v(x){let f=(0,h.bk)(x);if(f.type===d.ob.Auto&&(f={...f,type:d.ob.Sparkline}),f.type===d.ob.Sparkline)return f;throw new Error(`Expected options type ${d.ob.Sparkline} but got ${f.type}`)}},28533:(Z,R,e)=>{"use strict";e.d(R,{n:()=>a});var n=e(74848);const a=({cell:s,tableStyles:l,onCellFilterAdded:o,timeRange:d,userProps:i,frame:c,rowStyled:m,rowExpanded:p,textWrapped:h,height:r,getActions:g,replaceVariables:y,setInspectCell:v})=>{const x=s.getCellProps(),f=s.column.field;if(!f?.display)return null;if(x.style){x.style.wordBreak="break-word",x.style.minWidth=x.style.width;const E=s.column.justifyContent;E==="flex-end"&&!f.config.unit?(x.style.textAlign="right",x.style.direction="rtl",x.style.unicodeBidi="plaintext"):x.style.justifyContent=E}let u=(typeof s.column.width=="number"?s.column.width:24)-l.cellPadding*2;const b=g?g(c,f,s.row.index,y):[];return(0,n.jsx)(n.Fragment,{children:s.render("Cell",{field:f,tableStyles:l,onCellFilterAdded:o,cellProps:x,innerWidth:u,timeRange:d,userProps:i,frame:c,rowStyled:m,rowExpanded:p,textWrapped:h,height:r,actions:b,setInspectCell:v})})}},58738:(Z,R,e)=>{"use strict";e.d(R,{e:()=>h,h:()=>r});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(96540),d=e(51898),i=e(63142),c=e(15245),m=e(39064),p=e(61048);const h=({links:y,actions:v,value:x,coords:f,onTooltipClose:u})=>{const b=(0,i.of)(g),E=[(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],D=(0,o.useMemo)(()=>{const{clientX:B,clientY:S}=f;return{getBoundingClientRect(){return{width:0,height:0,x:B,y:S,top:S,left:B,right:B,bottom:S}}}},[f]),C=B=>{T.setFloating(B),T.setReference(D)},{context:P,refs:T,floatingStyles:O}=(0,l.we)({open:!0,placement:"right-start",onOpenChange:u,middleware:E}),I=(0,l.s9)(P),{getFloatingProps:j,getReferenceProps:W}=(0,l.bv)([I]);return y.length===0&&!v?.length?null:(0,n.jsxs)(n.Fragment,{children:[x,(0,n.jsx)(c.ZL,{children:(0,n.jsx)("div",{ref:C,...W(),...j(),style:O,className:b.tooltipWrapper,"data-testid":d.Tp.components.DataLinksActionsTooltip.tooltipWrapper,children:(0,n.jsx)(p.i,{children:(0,n.jsx)(m.S,{dataLinks:y,actions:v})})})})]})},r=(y,v,x)=>(0,n.jsx)("a",{href:y.href,onClick:y.onClick,target:y.target,title:y.title,"data-testid":d.Tp.components.DataLinksContextMenu.singleLink,className:x,children:v}),g=y=>({tooltipWrapper:(0,a.css)({zIndex:y.zIndex.portal,whiteSpace:"pre",borderRadius:y.shape.radius.default,background:y.colors.background.primary,border:`1px solid ${y.colors.border.weak}`,boxShadow:y.shadows.z3,userSelect:"text",fontSize:y.typography.bodySmall.fontSize})})},64780:(Z,R,e)=>{"use strict";e.d(R,{B:()=>r,s:()=>g});var n=e(74848),a=e(2543),s=e.n(a),l=e(96540),o=e(92745),d=e(47931),i=e(8207),c=e(41654),m=e(50992),p=e(60208),h=e(54314),r=(y=>(y.code="code",y.text="text",y))(r||{});function g({value:y,onDismiss:v,mode:x}){let f=y;const[u,b]=(0,l.useState)(x);if((0,a.isString)(y)){const T=y.trim();if(T[0]==="{"||T[0]==="["||x==="code")try{y=JSON.parse(y),f=JSON.stringify(y,null,"  ")}catch(O){console.log("Failed to parse JSON in Table cell inspector (this will cause JSON to not print nicely): ",O.message)}}else f=JSON.stringify(y);let E=f;const D=[{label:"Plain text",value:"text"},{label:"Code editor",value:"code"}],C=()=>{b(u==="text"?"code":"text")},P=(0,n.jsx)(h.U,{children:D.map((T,O)=>(0,n.jsx)(p.o,{label:T.label,active:T.value===u,onChangeTab:C},`${T.value}-${O}`))});return(0,n.jsx)(i._,{onClose:v,title:(0,o.t)("grafana-ui.table.inspect-drawer-title","Inspect value"),tabs:P,children:(0,n.jsxs)(c.B,{direction:"column",gap:2,children:[(0,n.jsx)(d.b,{icon:"copy",getText:()=>E,style:{marginLeft:"auto",width:"200px"},children:(0,n.jsx)(o.x6,{i18nKey:"grafana-ui.table.copy",children:"Copy to Clipboard"})}),u==="code"?(0,n.jsx)(m.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(E&&E.length)>100,value:E,readOnly:!0,wordWrap:!0}):(0,n.jsx)("pre",{children:E})]})})}},74533:(Z,R,e)=>{"use strict";e.d(R,{u:()=>c,d:()=>p});var n=e(74848),a=e(96540),s=e(46644),l=e(51898),o=e(22803);const d=h=>{const r=(0,o.css)({width:"100%",listStyle:"none"}),g=(0,o.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return h.value&&!Array.isArray(h.value)?(0,n.jsx)("span",{children:h.value}):h.value&&Array.isArray(h.value)&&h.value.length>0?(0,n.jsx)("ul",{className:r,children:h.value.map((y,v)=>{const x=Object.keys(y)[0];return(0,n.jsxs)("li",{className:g,children:[(0,n.jsx)("span",{children:x}),(0,n.jsx)("span",{children:y[x]})]},v)})}):i},i=()=>(0,n.jsx)("span",{children:"\xA0"});function c(h){const{totalColumnsWidth:r,footerGroups:g,isPaginationVisible:y,tableStyles:v}=h,x=l.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{style:{position:y?"relative":"absolute",width:r?`${r}px`:"100%",bottom:"0px"},children:g.map(f=>{const{key:u,...b}=f.getFooterGroupProps();return(0,a.createElement)("div",{className:v.tfoot,...b,key:u,"data-testid":x.footer},f.headers.map(E=>m(E,v)))})})}function m(h,r){const{key:g,...y}=h.getHeaderProps();return y?(y.style=y.style??{},y.style.position="absolute",y.style.justifyContent=h.justifyContent,(0,n.jsx)("div",{className:r.headerCell,...y,children:h.render("Footer")},g)):null}function p(h,r,g){if(r===void 0)return i;if(g){if(r[h]===void 0)return i;const y=s.AS.get(s.gy.count).name;return d({value:[{[y]:String(r[h])}]})}return d({value:r[h]})}},24343:(Z,R,e)=>{"use strict";e.d(R,{X:()=>tt});var n=e(74848),a=e(96540),s=e(32885),l=e(46644),o=e(95004),d=e(17503),i=e(36638),c=e(51898),m=e(92745),p=e(739),h=e(63142),r=e(52718),g=e(34213),y=e(64780);function v(ke,He){(0,a.useEffect)(()=>{if(ke.current&&He.current){const Re=ke.current.querySelector(".track-vertical"),Ne=He.current.firstChild;Ne&&Re&&(Re.remove(),Ne instanceof HTMLElement&&(Ne.querySelector(":scope > .track-vertical")?.remove(),Ne.append(Re)))}})}function x(ke,He,Re,Ne){const Ae=JSON.stringify(Object.keys(ke.expanded));(0,a.useEffect)(()=>{let Ue=0;Ne||(Number.isFinite(ke.lastExpandedOrCollapsedIndex)&&(Ue=ke.lastExpandedOrCollapsedIndex),Ue=ke.pageIndex===0?Ue-1:Ue-ke.pageIndex-ke.pageIndex*ke.pageSize),He.current?.resetAfterIndex(Math.max(Ue,0))},[ke.lastExpandedOrCollapsedIndex,ke.pageSize,ke.pageIndex,He,Re,Ae,Ne])}var f=e(16515);function u({onColumnResize:ke,onSortByChange:He,data:Re}){return(0,a.useCallback)((Ne,Ae)=>{switch(Ae.type){case"columnDoneResizing":if(ke){const Be=Ne.columnResizing?.headerIdWidths?.[0]?.[0],We=parseInt(Be,10),_e=Math.round(Ne.columnResizing.columnWidths?.[Be]),Xe=Re.fields?.[We];if(!Xe)return Ne;const le=(0,f.Ct)(Xe,Re);ke(le,_e)}case"toggleSortBy":if(He){const Ue=[];for(const Be of Ne.sortBy){const We=Re.fields[parseInt(Be.id,10)];We&&Ue.push({displayName:(0,f.Ct)(We,Re),desc:Be.desc})}He(Ue)}case"toggleRowExpanded":if(Ae.id)return{...Ne,lastExpandedOrCollapsedIndex:parseInt(Ae.id,10)}}return Ne},[Re,ke,He])}function b(ke,He){const Re={};if(ke){Re.sortBy=[];for(const Ne of ke)for(const Ae of He)Ae.Header===Ne.displayName&&Re.sortBy.push({id:Ae.id,desc:Ne.desc})}return Re}var E=e(74198),D=e(74533),C=e(97958),P=e(30703),T=e(22803),O=e(2381),I=e(97222),j=e(55386),W=e(15356),B=e(12737),S=e(32635),w=e(72636),N=e(41654);const M=28,L=M*5,A={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},U=Object.values(A),F=A.Contains,V=A.Expression,K=ke=>{if(ke=ke.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(ke)){const Ne=new Date(ke);if(!isNaN(Ne.getTime())){const Ae=(0,j.j_)("dateTimeAsIso");return(0,j.cN)(Ae(Ne.getTime()))}}const He=parseFloat(ke);if(!isNaN(He))return He;const Re=ke.toLowerCase();return Re==="true"||Re==="false"?Re==="true":ke},G=({options:ke,values:He,caseSensitive:Re,showOperators:Ne,onChange:Ae,searchFilter:Ue,setSearchFilter:Be,operator:We,setOperator:_e})=>{const Xe=(0,a.useMemo)(()=>new RegExp(Ue,Re?void 0:"i"),[Ue,Re]),le=(0,a.useMemo)(()=>ke.filter(ot=>{if(!Ne||!Ue||We.value===F.value)return ot.label===void 0?!1:Xe.test(ot.label);if(We.value===V.value){if(ot.value===void 0)return!1;try{const lt=Ue.replace(/\\/g,""),mt=new Function("$",`'use strict'; return ${lt};`),Lt=K(ot.value);return mt(Lt)}catch{}return!1}else{if(ot.value===void 0)return!1;const lt=K(ot.value),mt=K(Ue);switch(We.value){case"=":return lt===mt;case"!=":return lt!==mt;case">":return lt>mt;case">=":return lt>=mt;case"<":return lt<mt;case"<=":return lt<=mt}return!1}}),[ke,Xe,Ne,We,Ue]),ye=(0,a.useMemo)(()=>le.filter(ot=>He.includes(ot)),[le,He]),pe=(0,a.useMemo)(()=>le.length===ye.length,[le,ye]),ve=(0,a.useMemo)(()=>ye.length>0&&le.length>ye.length,[le,ye]),be=(0,a.useMemo)(()=>ye.length?`${ye.length} selected`:"Select all",[ye]),Oe=(0,a.useMemo)(()=>le.length!==ye.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[le,ye]),we=(0,h.of)(_),Ve=(0,h.$j)().spacing.gridSize,ge=(0,a.useMemo)(()=>Math.min(le.length*M,L)+Ve,[Ve,le.length]),Ke=(0,a.useCallback)(ot=>lt=>{const mt=lt.currentTarget.checked?He.concat(ot):He.filter(Lt=>Lt.value!==ot.value);Ae(mt)},[Ae,He]),qe=(0,a.useCallback)(()=>{if(le.length===ye.length){const ot=He.filter(lt=>!le.includes(lt));Ae(ot)}else{const ot=[...new Set([...He,...le])];Ae(ot)}},[Ae,He,le,ye]);return(0,n.jsxs)(N.B,{direction:"column",gap:.25,children:[!Ne&&(0,n.jsx)(B.Z,{placeholder:(0,m.t)("grafana-ui.table.filter-placeholder","Filter values"),onChange:Be,value:Ue}),Ne&&(0,n.jsxs)(N.B,{direction:"row",gap:0,children:[(0,n.jsx)(W.f,{variant:"canvas",options:U,onChange:_e,value:We,tooltip:We.description}),(0,n.jsx)(B.Z,{placeholder:(0,m.t)("grafana-ui.table.filter-placeholder","Filter values"),onChange:Be,value:Ue})]}),le.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I.Y1,{height:ge,itemCount:le.length,itemSize:M,itemData:{items:le,values:ye,onCheckedChanged:Ke,className:we.filterListRow},width:"100%",className:we.filterList,children:H}),(0,n.jsxs)(N.B,{direction:"column",gap:.25,children:[(0,n.jsx)("div",{className:(0,T.cx)(we.selectDivider)}),(0,n.jsx)("div",{className:(0,T.cx)(we.filterListRow),children:(0,n.jsx)(S.S,{value:pe,indeterminate:ve,label:be,description:Oe,onChange:qe})})]})]}):(0,n.jsx)(w.J,{className:we.noValuesLabel,children:(0,n.jsx)(m.x6,{i18nKey:"grafana-ui.table.no-values-label",children:"No values"})})]})};function H({index:ke,style:He,data:{onCheckedChanged:Re,items:Ne,values:Ae,className:Ue}}){const Be=Ne[ke],{value:We,label:_e}=Be,Xe=Ae.find(le=>le.value===We)!==void 0;return(0,n.jsx)("div",{className:Ue,style:He,title:_e,children:(0,n.jsx)(S.S,{value:Xe,label:_e,onChange:Re(Be)})})}const _=ke=>({filterList:(0,T.css)({label:"filterList"}),filterListRow:(0,T.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:ke.spacing(.5),":hover":{backgroundColor:ke.colors.action.hover}}),selectDivider:(0,T.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${ke.colors.border.medium}`,padding:ke.spacing(.5,2)}),noValuesLabel:(0,T.css)({paddingTop:ke.spacing(1)})});var k=e(45861),J=e(8135),z=e(76319);const Y=({column:{preFilteredRows:ke,filterValue:He,setFilter:Re},onClose:Ne,field:Ae,searchFilter:Ue,setSearchFilter:Be,operator:We,setOperator:_e})=>{const Xe=(0,h.$j)(),le=(0,a.useMemo)(()=>(0,E.MY)(ke,Ae),[ke,Ae]),ye=(0,a.useMemo)(()=>(0,E.Yz)(le),[le]),pe=(0,a.useMemo)(()=>(0,E.Sj)(ye,He),[ye,He]),[ve,be]=(0,a.useState)(pe),[Oe,we]=(0,a.useState)(!1),ze=(0,a.useCallback)(ot=>Ne(),[Ne]),Ve=(0,a.useCallback)(ot=>{const lt=ve.length?ve:void 0;Re(lt),Ne()},[Re,ve,Ne]),ge=(0,a.useCallback)(ot=>{Re(void 0),Ne()},[Re,Ne]),Ke=(0,a.useMemo)(()=>He!==void 0,[He]),qe=(0,h.of)(X);return(0,n.jsx)(J.N,{onClick:ze,useCapture:!0,children:(0,n.jsx)("div",{className:(0,T.cx)(qe.filterContainer),onClick:Q,children:(0,n.jsxs)(N.B,{direction:"column",gap:3,children:[(0,n.jsxs)(N.B,{direction:"column",gap:.5,children:[(0,n.jsxs)(N.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(w.J,{className:qe.label,children:(0,n.jsx)(m.x6,{i18nKey:"grafana-ui.table.filter-popup-heading",children:"Filter by values:"})}),(0,n.jsx)(z.K,{name:"text-fields",tooltip:(0,m.t)("grafana-ui.table.filter-popup-match-case","Match case"),style:{color:Oe?Xe.colors.text.link:Xe.colors.text.disabled},onClick:()=>{we(ot=>!ot)}})]}),(0,n.jsx)("div",{className:(0,T.cx)(qe.listDivider)}),(0,n.jsx)(G,{onChange:be,values:ve,options:ye,caseSensitive:Oe,showOperators:!0,searchFilter:Ue,setSearchFilter:Be,operator:We,setOperator:_e})]}),(0,n.jsxs)(N.B,{gap:3,children:[(0,n.jsxs)(N.B,{children:[(0,n.jsx)(k.$n,{size:"sm",onClick:Ve,children:(0,n.jsx)(m.x6,{i18nKey:"grafana-ui.table.filter-popup-apply",children:"Ok"})}),(0,n.jsx)(k.$n,{size:"sm",variant:"secondary",onClick:ze,children:(0,n.jsx)(m.x6,{i18nKey:"grafana-ui.table.filter-popup-cancel",children:"Cancel"})})]}),Ke&&(0,n.jsx)(N.B,{children:(0,n.jsx)(k.$n,{fill:"text",size:"sm",onClick:ge,children:(0,n.jsx)(m.x6,{i18nKey:"grafana-ui.table.filter-popup-clear",children:"Clear filter"})})})]})]})})})},X=ke=>({filterContainer:(0,T.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:ke.colors.background.primary,border:`1px solid ${ke.colors.border.weak}`,padding:ke.spacing(2),boxShadow:ke.shadows.z3,borderRadius:ke.shape.radius.default}),listDivider:(0,T.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${ke.colors.border.medium}`,padding:ke.spacing(.5,2)}),label:(0,T.css)({marginBottom:0})}),Q=ke=>{ke.stopPropagation()},q=({column:ke,field:He,tableStyles:Re})=>{const Ne=(0,a.useRef)(null),[Ae,Ue]=(0,a.useState)(!1),Be=(0,h.of)(te),We=(0,a.useMemo)(()=>!!ke.filterValue,[ke.filterValue]),_e=(0,a.useCallback)(()=>Ue(!0),[Ue]),Xe=(0,a.useCallback)(()=>Ue(!1),[Ue]),[le,ye]=(0,a.useState)(""),[pe,ve]=(0,a.useState)(F);return!He||!He.config.custom?.filterable?null:(0,n.jsxs)("button",{className:(0,T.cx)(Re.headerFilter,We?Be.filterIconEnabled:Be.filterIconDisabled),ref:Ne,type:"button",onClick:_e,children:[(0,n.jsx)(P.I,{name:"filter"}),Ae&&Ne.current&&(0,n.jsx)(O.A,{content:(0,n.jsx)(Y,{column:ke,tableStyles:Re,field:He,onClose:Xe,searchFilter:le,setSearchFilter:ye,operator:pe,setOperator:ve}),placement:"bottom-start",referenceElement:Ne.current,show:!0})]})},te=ke=>({filterIconEnabled:(0,T.css)({label:"filterIconEnabled",color:ke.colors.primary.text}),filterIconDisabled:(0,T.css)({label:"filterIconDisabled",color:ke.colors.text.disabled})}),ne=ke=>{const{headerGroups:He,showTypeIcons:Re,tableStyles:Ne}=ke,Ae=c.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{role:"rowgroup",className:Ne.headerRow,children:He.map(Ue=>{const{key:Be,...We}=Ue.getHeaderGroupProps();return(0,a.createElement)("div",{className:Ne.thead,...We,key:Be,"aria-label":Ae.header,role:"row"},Ue.headers.map((_e,Xe)=>se(_e,Ne,Re)))})})};function se(ke,He,Re){const{key:Ne,...Ae}=ke.getHeaderProps(),Ue=ke.field??null,Be=Ue?.config.custom;ke.canResize&&(Ae.style.userSelect=ke.isResizing?"none":"auto"),Ae.style.position="absolute",Ae.style.justifyContent=ke.justifyContent,Ae.style.left=ke.totalLeft;let We=ke.render("Header"),_e=ke.canSort&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{...ke.getSortByToggleProps(),className:He.headerCellLabel,children:[Re&&(0,n.jsx)(P.I,{name:(0,C.SS)(Ue),title:Ue?.type,size:"sm",className:He.typeIcon}),(0,n.jsx)("div",{children:We}),ke.isSorted&&(ke.isSortedDesc?(0,n.jsx)(P.I,{size:"lg",name:"arrow-down",className:He.sortIcon}):(0,n.jsx)(P.I,{name:"arrow-up",size:"lg",className:He.sortIcon}))]}),ke.canFilter&&(0,n.jsx)(q,{column:ke,tableStyles:He,field:Ue})]});return _e&&Be?.headerComponent?_e=(0,n.jsx)(Be.headerComponent,{field:Ue,defaultContent:_e}):Be?.headerComponent&&(We=(0,n.jsx)(Be.headerComponent,{field:Ue,defaultContent:We})),(0,n.jsxs)("div",{className:He.headerCell,...Ae,role:"columnheader",children:[ke.canSort&&_e,!ke.canSort&&We,!ke.canSort&&ke.canFilter&&(0,n.jsx)(q,{column:ke,tableStyles:He,field:Ue}),ke.canResize&&(0,n.jsx)("div",{...ke.getResizerProps(),className:He.resizeHandle})]},Ne)}var ue=e(64423),de=e(56978),ie=e(57852),he=e(64400),me=e(28533);function ce({tableStyles:ke,nestedData:He,rowIndex:Re,width:Ne,cellHeight:Ae}){const Ue=He.values,Be=[],We=(0,h.$j)(),_e=(0,h.of)(Pe);let Xe=ke.rowHeight+We.spacing.gridSize;return Ue[Re].forEach((le,ye)=>{const pe=!!le.meta?.custom?.noHeader,ve=ke.rowHeight*(le.length+(pe?0:1)),be={height:ve,paddingLeft:E.jV,position:"absolute",top:Xe,backgroundColor:We.colors.background.primary,color:We.colors.text.primary};Xe+=ve+We.spacing.gridSize,Be.push((0,n.jsx)("div",{style:be,children:(0,n.jsx)(tt,{data:le,width:Ne-E.jV,height:ke.rowHeight*(le.length+1),noHeader:pe,cellHeight:Ae})},`subTable_${Re}_${ye}`))}),(0,n.jsx)("div",{className:_e.subTables,children:Be})}const Pe=ke=>({subTables:(0,T.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:ke.spacing(5),left:ke.spacing(1),bottom:ke.spacing(2),background:ke.colors.border.medium}})});function Ie(ke,He,Re){return ke.values[He].reduce((Ue,Be)=>{if(Be.length){const We=!!Be.meta?.custom?.noHeader;return Ue+Re.rowHeight*(Be.length+(We?0:1))+8}return Ue},Re.rowHeight)??Re.rowHeight}const Se=ke=>{const{data:He,rows:Re,headerHeight:Ne,footerPaginationEnabled:Ae,rowHeight:Ue,itemCount:Be,pageIndex:We,tableState:_e,prepareRow:Xe,onCellFilterAdded:le,width:ye,cellHeight:pe=p.qM.Sm,timeRange:ve,tableStyles:be,nestedDataField:Oe,listHeight:we,listRef:ze,enableSharedCrosshair:Ve=!1,initialRowIndex:ge=void 0,headerGroups:Ke,longestField:qe,textWrapField:ot,getActions:lt,replaceVariables:mt,setInspectCell:Lt}=ke,[Tt,It]=(0,a.useState)(ge);ge===void 0&&Tt!==void 0&&It(void 0);const Mt=(0,h.$j)(),Ut=(0,he.d2)();let an=null;window.OffscreenCanvas!==void 0&&(an=new OffscreenCanvas(256,1024).getContext("2d")),an!=null&&(an.font=`${Mt.typography.fontSize}px ${Mt.typography.body.fontFamily}`);const cn=(0,a.useMemo)(()=>{const wt=He.fields.find(Yt=>Yt.type===o.PU.time);return wt?(0,E.HY)(wt):0},[He]),un=(0,a.useCallback)((wt,Yt)=>{if(!Ut||!Ve)return;const rn=Yt.fields.find(Xt=>Xt.type===o.PU.time);rn&&Ut.eventBus.publish(new ie.b_({point:{time:rn.values[wt]}}))},[Ve,Ut]),On=(0,a.useCallback)(()=>{!Ut||!Ve||Ut.eventBus.publish(new ie.ql)},[Ve,Ut]),yn=(0,a.useCallback)(wt=>{if(wt.payload.point?.time&&wt.payload.rowIndex!==void 0){const Yt=He.fields.find(pn=>pn.type===o.PU.time),rn=Yt.values[wt.payload.rowIndex],Xt=wt.payload.point.time;if((0,E.Iy)(Xt,rn,cn)){It(wt.payload.rowIndex);return}const on=Yt.values.findIndex(pn=>(0,E.Iy)(Xt,pn,cn));if(on!==-1){It(on);return}It(void 0)}},[He.fields,cn]);(0,a.useEffect)(()=>{if(!Ut||!Ve||!(0,d.S1)(He)||Ae)return;const wt=new ue.yU;return wt.add(Ut.eventBus.getStream(ie.b_).pipe((0,de.B)(250)).subscribe({next:Yt=>{Ut.eventBus!==Yt.origin&&yn(Yt)}})),wt.add(Ut.eventBus.getStream(ie.ql).pipe((0,de.B)(250)).subscribe({next:Yt=>{Ut.eventBus!==Yt.origin&&It(void 0)}})),()=>{wt.unsubscribe()}},[He,Ve,Ae,yn,Ut]);let En;if(Tt!==void 0){const wt=Re.findIndex(Yt=>Yt.index===Tt);wt!==-1&&(En=Ne+(wt-1)*Ue)}const Bn=(0,a.useCallback)(wt=>_e.pageIndex*_e.pageSize+wt,[_e.pageIndex,_e.pageSize]);let fa,Fn;for(const wt of He.fields){const Yt=wt.config.custom;Yt!==void 0&&Yt.cellOptions!==void 0&&Yt.cellOptions.type===p.ob.ColorBackground&&Yt.cellOptions.applyToRow&&(fa=Xt=>{const on=wt.display(wt.values.get(Xt));return(0,E.HW)(be.theme,Yt.cellOptions,on)}),ot!==void 0?Fn=ot:qe!==void 0&&(Fn=qe)}const Ea=(0,a.useCallback)(({index:wt,style:Yt,rowHighlightIndex:rn})=>{const Xt=Bn(wt),on=Re[Xt];let pn={};Xe(on);const Un=_e.expanded[on.id]?(0,T.css)({"&:hover":{background:"inherit"}}):{},In=Oe&&_e.expanded[on.id];if(rn!==void 0&&on.index===rn&&(Yt={...Yt,backgroundColor:Mt.components.table.rowSelected},pn={"aria-selected":"true"}),fa){const{bgColor:za,textColor:Oa}=fa(on.index);Yt.background=za,Yt.color=Oa,Yt.borderLeft=`2px solid ${za}`}if(Fn){const Oa=He.fields.filter(Ca=>!Ca.config.custom?.hidden).findIndex(Ca=>Ca.name===Fn.name),ss=Mt.typography.body.lineHeight*Mt.typography.fontSize,La=(0,E.M2)(Fn.values[on.index],Ke[0].headers[Oa],an,ss,be.rowHeight,be.cellPadding);Yt.height=La.height}const{key:Gn,...Wa}=on.getRowProps({style:Yt,...pn});return(0,n.jsxs)("div",{...Wa,className:(0,T.cx)(be.row,Un),onMouseEnter:()=>un(on.index,He),onMouseLeave:On,children:[In&&(0,n.jsx)(ce,{nestedData:Oe,tableStyles:be,rowIndex:on.index,width:ye,cellHeight:pe}),on.cells.map((za,Oa)=>(0,n.jsx)(me.n,{tableStyles:be,cell:za,onCellFilterAdded:le,columnIndex:Oa,columnCount:on.cells.length,timeRange:ve,frame:He,rowStyled:fa!==void 0,rowExpanded:In,textWrapped:Fn!==void 0,height:Number(Yt.height)-1,getActions:lt,replaceVariables:mt,setInspectCell:Lt},Oa))]},Gn)},[Bn,Re,Xe,_e.expanded,Oe,fa,Fn,be,On,ye,pe,Mt.components.table.rowSelected,Mt.typography.body.lineHeight,Mt.typography.fontSize,He,Ke,an,un,le,ve,lt,mt,Lt]),gt=wt=>{const Yt=Bn(wt),rn=Re[Yt];if(_e.expanded[rn.id]&&Oe)return Ie(Oe,rn.index,be);if(Fn){const on=He.fields.filter(Un=>!Un.config.custom?.hidden).findIndex(Un=>Un.name===Fn.name),pn=Mt.typography.fontSize*Mt.typography.body.lineHeight;return(0,E.M2)(Fn.values[rn.index],Ke[0].headers[on],an,pn,be.rowHeight,be.cellPadding).height}return be.rowHeight},Ht=wt=>{const{scrollTop:Yt}=wt.currentTarget;ze.current!==null&&ze.current.scrollTo(Yt)};return(0,a.useEffect)(()=>{ze.current&&ze.current.resetAfterIndex(0)},[Re,ze]),(0,n.jsx)(r.A,{onScroll:Ht,hideHorizontalTrack:!0,scrollTop:En,children:(0,n.jsx)(I._m,{height:we,itemCount:Be,itemSize:gt,width:"100%",ref:ze,style:{overflow:void 0},children:({index:wt,style:Yt})=>Ea({index:wt,style:Yt,rowHighlightIndex:Tt})},`${Ue}${We}`)})};var Me=e(59692);const Te=150,Ge=36,Qe="No data",tt=(0,a.memo)(ke=>{const{ariaLabel:He,data:Re,height:Ne,onCellFilterAdded:Ae,onColumnResize:Ue,width:Be,columnMinWidth:We=Te,noHeader:_e,resizable:Xe=!0,initialSortBy:le,footerOptions:ye,showTypeIcons:pe,footerValues:ve,enablePagination:be,cellHeight:Oe=p.qM.Sm,timeRange:we,enableSharedCrosshair:ze=!1,initialRowIndex:Ve=void 0,fieldConfig:ge,getActions:Ke,replaceVariables:qe}=ke,ot=(0,a.useRef)(null),lt=(0,a.useRef)(null),mt=(0,a.useRef)(null),Lt=(0,h.$j)(),Tt=(0,Me.k)(Lt,Oe),It=_e?0:Tt.rowHeight,[Mt,Ut]=(0,a.useState)(ve),an=ge?.defaults?.noValue??Qe,[cn,un]=(0,a.useState)(null),On=(0,a.useMemo)(()=>{const dt=Ge;let St=0;if(!Mt)return 0;for(const jt of Mt)Array.isArray(jt)&&jt.length>St&&(St=jt.length);return St>1?dt*St:dt},[Mt]),yn=(0,a.useMemo)(()=>Re.fields.length?Array(Re.length).fill(0):[],[Re]),En=!!(ye?.countRows&&ye.reducer&&ye.reducer.length&&ye.reducer[0]===l.gy.count),Bn=Re.fields.find(dt=>dt.type===o.PU.nestedFrames),fa=Bn!==void 0,Fn=(0,a.useMemo)(()=>(0,E.GH)(Re,Be,We,fa,Mt,En),[Re,Be,We,fa,Mt,En]),Ea=(0,a.useRef)(),gt=u({onColumnResize:Ue,onSortByChange:dt=>{Ea.current(!1),ke.onSortByChange&&ke.onSortByChange(dt)},data:Re}),Ht=!!Re.meta?.uniqueRowIdFields?.length,wt=(0,a.useMemo)(()=>{const dt={columns:Fn,data:yn,disableResizing:!Xe,stateReducer:gt,autoResetPage:!1,initialState:b(le,Fn),autoResetFilters:!1,sortTypes:{number:E.Ok,"alphanumeric-insensitive":E.IM}};return Ht&&(dt.getRowId=(St,jt)=>(0,d.t9)(Re,jt),dt.autoResetExpanded=!1),dt},[le,Fn,yn,Xe,gt,Ht,Re]),{getTableProps:Yt,headerGroups:rn,footerGroups:Xt,rows:on,prepareRow:pn,totalColumnsWidth:Un,page:In,state:Gn,gotoPage:Wa,setPageSize:za,pageOptions:Oa,toggleAllRowsExpanded:ss}=(0,s.useTable)(wt,s.useFilters,s.useSortBy,s.useAbsoluteLayout,s.useResizeColumns,s.useExpanded,s.usePagination),La=Gn;Ea.current=ss,(0,a.useEffect)(()=>{ye||Ut(ve)},[ve,ye]),(0,a.useEffect)(()=>{if(!ye)return;if(!ye.show){Ut(void 0);return}if(En){const St=[];St[0]=on.length.toString()??Re.length.toString(),Ut(St);return}const dt=(0,E.Ux)(rn[0].headers,(0,E.XX)(on),ye,Lt);Ut(dt)},[ye,Lt,Gn.filters,Re]);let Ca=Ne-(It+On);be&&(Ca-=Tt.cellHeight);const Ka=Math.round(Ca/Tt.rowHeight)-1;(0,a.useEffect)(()=>{Ka<=0||za(Ka)},[Ka,za]),(0,a.useEffect)(()=>{Re.length/Ka<Gn.pageIndex&&Wa(0)},[Re]),x(La,ot,Re,Ht),v(mt,lt);const As=(0,a.useCallback)(dt=>{Wa(dt-1)},[Wa]),Ia=be?In.length:on.length;let _s=null;if(be){const dt=Gn.pageIndex*Gn.pageSize+1;let St=dt+Gn.pageSize-1;const jt=Be<550;St>Re.length&&(St=Re.length);const Qt=on.length,Jt=St<on.length?St:on.length;_s=(0,n.jsxs)("div",{className:Tt.paginationWrapper,children:[(0,n.jsx)(g.d,{currentPage:Gn.pageIndex+1,numberOfPages:Oa.length,showSmallVersion:jt,onNavigate:As}),jt?null:(0,n.jsx)("div",{className:Tt.paginationSummary,children:(0,n.jsxs)(m.x6,{i18nKey:"grafana-ui.table.pagination-summary",children:[{itemsRangeStart:dt}," - ",{displayedEnd:Jt}," of ",{numRows:Qt}," rows"]})})]})}const Fa=ge?(0,E.O4)(ge,Re):void 0;let xt;return ge!==void 0&&Re.fields.forEach(dt=>{ge.overrides.forEach(St=>{if((0,i.NS)(St.matcher)(dt,Re,[Re]))for(const Qt of St.properties)Qt.id==="custom.cellOptions"&&Qt.value.wrapText&&(xt=dt)})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{...Yt(),className:Tt.table,"aria-label":He,role:"table",ref:lt,style:{width:Be,height:Ne},children:[(0,n.jsx)(r.E,{hideVerticalTrack:!0,children:(0,n.jsxs)("div",{className:Tt.tableContentWrapper(Un),children:[!_e&&(0,n.jsx)(ne,{headerGroups:rn,showTypeIcons:pe,tableStyles:Tt}),Ia>0?(0,n.jsx)("div",{"data-testid":c.Tp.components.Panels.Visualization.Table.body,ref:mt,children:(0,n.jsx)(Se,{headerGroups:rn,data:Re,rows:on,width:Be,cellHeight:Oe,headerHeight:It,rowHeight:Tt.rowHeight,itemCount:Ia,pageIndex:Gn.pageIndex,listHeight:Ca,listRef:ot,tableState:Gn,prepareRow:pn,timeRange:we,onCellFilterAdded:Ae,nestedDataField:Bn,tableStyles:Tt,footerPaginationEnabled:!!be,enableSharedCrosshair:ze,initialRowIndex:Ve,longestField:Fa,textWrapField:xt,getActions:Ke,replaceVariables:qe,setInspectCell:un})}):(0,n.jsx)("div",{style:{height:Ne-It,width:Be},className:Tt.noData,children:an}),Mt&&(0,n.jsx)(D.u,{isPaginationVisible:!!be,footerValues:Mt,footerGroups:Xt,totalColumnsWidth:Un,tableStyles:Tt})]})}),_s]}),cn!==null&&(0,n.jsx)(y.s,{mode:cn.mode,value:cn.value,onDismiss:()=>{un(null)}})]})});tt.displayName="Table"},59692:(Z,R,e)=>{"use strict";e.d(R,{k:()=>a});var n=e(22803);function a(l,o){const d=l.colors.border.weak,i=l.colors.primary.border,c=6,m=s(l,o,c),p=m+2,h=28,r=(g,y,v,x,f,u,b,E,D)=>(0,n.css)({label:x?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${c}px`,width:"100%",height:D?"auto !important":`${p-1}px`,wordBreak:b?"break-all":"inherit",display:"flex",...f?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${d}`,color:E?"inherit":g??void 0,background:E?void 0:y??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:x&&!b?"visible":void 0,width:u||!x?"auto":"auto !important",height:(u||x)&&!b?"auto !important":`${p-1}px`,minHeight:`${p-1}px`,wordBreak:u?"break-word":void 0,whiteSpace:u&&x?"normal":"nowrap",boxShadow:x?`0 0 2px ${l.colors.primary.main}`:void 0,background:E?"inherit":v??l.colors.background.primary,zIndex:1,".cellActions":{background:l.components.tooltip.background,color:l.components.tooltip.text,visibility:"visible",opacity:1,width:"auto",borderRadius:l.shape.radius.default}},a:{color:"inherit"},".cellActions":{display:"flex",position:x?void 0:"absolute",top:x?void 0:"1px",right:x?void 0:0,margin:x?l.spacing(0,0,0,1):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:l.spacing(.5,0,.5,.5),background:l.components.tooltip.background,color:l.components.tooltip.text},".cellActionsLeft":{right:"auto !important",left:0}});return{theme:l,cellHeight:m,buildCellContainerStyle:r,cellPadding:c,cellHeightInner:m-c*2,rowHeight:p,table:(0,n.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,n.css)({label:"thead",height:`${h}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,n.css)({label:"tfoot",height:`${h}px`,borderTop:`1px solid ${d}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,n.css)({label:"row",borderBottom:`1px solid ${d}`}),headerCell:(0,n.css)({height:"100%",padding:`0 ${c}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:l.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,n.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:l.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:l.spacing(.5),"&:hover":{textDecoration:"underline",color:l.colors.text.link}}),cellContainerText:r(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:r(void 0,void 0,void 0,!1,!0),cellContainer:r(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:r(void 0,void 0,void 0,!1,!1),cellText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",cursor:"text"}),sortIcon:(0,n.css)({marginLeft:l.spacing(.5)}),cellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:`${l.colors.text.link} !important`,fontWeight:l.typography.fontWeightMedium,paddingRight:l.spacing(1.5),"&:hover":{textDecoration:"underline",color:l.colors.text.link}}),cellLinkEmpty:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:l.typography.fontWeightMedium,paddingRight:l.spacing(1.5)}),cellLinkForColoredCell:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:l.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,n.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,n.css)({display:"flex",height:`${m}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,n.css)({color:l.colors.text.secondary,fontSize:l.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:l.spacing(0,1,0,2)}),tableContentWrapper:g=>{const y=g!==void 0?`${g}px`:"100%";return(0,n.css)({label:"tableContentWrapper",width:y,display:"flex",flexDirection:"column"})},row:(0,n.css)({label:"row",borderBottom:`1px solid ${d}`,"&:hover":{backgroundColor:l.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,n.css)({height:"100%"}),resizeHandle:(0,n.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:i,opacity:0,[l.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:l.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,n.css)({marginRight:l.spacing(1),color:l.colors.text.secondary}),noData:(0,n.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${p}px`,cursor:"pointer"})}}function s(l,o,d){const i=l.typography.fontSize,c=l.typography.body.lineHeight;switch(o){case"md":return 42;case"lg":return 48;case"sm":default:return d*2+i*c}}},36100:(Z,R,e)=>{"use strict";e.d(R,{Zi:()=>a,mc:()=>n});const n="=",a="!="},74198:(Z,R,e)=>{"use strict";e.d(R,{jV:()=>q,HY:()=>Ae,MY:()=>de,XX:()=>Ge,zi:()=>Re,HW:()=>Ue,bk:()=>tt,GH:()=>ne,tJ:()=>_e,Sj:()=>ce,Ux:()=>Me,j1:()=>te,O4:()=>We,M2:()=>Be,Iy:()=>Ne,o7:()=>ke,IM:()=>Pe,Ok:()=>Ie,nR:()=>le,Yz:()=>he});var n=e(2543),a=e(47078),s=e.n(a),l=e(84140),o=e(95004),d=e(16515),i=e(41119),c=e(17503),m=e(55386),p=e(46644),h=e(11576),r=e(739),g=e(8255),y=e(74848),v=e(22803),x=e(63142),f=e(8779);const u=ye=>{const{cellProps:pe,tableStyles:ve,actions:be}=ye,Oe=(0,x.of)(b);return(0,y.jsx)("div",{...pe,className:(0,v.cx)(ve.cellContainerText,Oe.buttonsGap),children:be&&be.map((we,ze)=>(0,y.jsx)(f.r,{action:we,variant:"secondary"},ze))})},b=ye=>({buttonsGap:(0,v.css)({gap:6})});var E=e(96540),D=e(33553),C=e(79118),P=e(38919),T=e(98005),O=e(58738);const I={mode:D.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},j=ye=>{const{field:pe,innerWidth:ve,tableStyles:be,cell:Oe,cellProps:we,row:ze}=ye,Ve=pe.display(Oe.value),ge=tt(pe);let Ke=(0,C.xg)(pe,!1);Ke.thresholds||(Ke={...Ke,thresholds:I});let qe=r.eX.Gradient,ot;ge.type===r.ob.Gauge&&(qe=ge.mode??r.eX.Gradient,ot=ge.valueDisplayMode!==void 0?ge.valueDisplayMode:r.$l.Text);const lt=()=>(0,n.isFunction)(pe.getLinks)?pe.getLinks({valueRowIndex:ze.index}):[],mt=Re(pe,Ve,Oe.row.index),Lt=()=>(0,y.jsx)(T.xE,{width:ve,height:be.cellHeightInner,field:Ke,display:pe.display,text:{valueSize:14},value:Ve,orientation:P.wV.Horizontal,theme:be.theme,alignmentFactors:mt,itemSpacing:1,lcdCellWidth:8,displayMode:qe,valueDisplayMode:ot}),[Tt,It]=(0,E.useState)(),{shouldShowLink:Mt,hasMultipleLinksOrActions:Ut}=_e(lt()),an=Ut&&Tt!==void 0,cn=lt();return(0,y.jsx)("div",{...we,className:be.cellContainer,style:{...we.style,cursor:Ut?"context-menu":"auto"},onClick:({clientX:un,clientY:On})=>{It({clientX:un,clientY:On})},children:Mt?(0,O.h)(cn[0],Lt()):an?(0,y.jsx)(O.e,{links:cn,value:Lt(),coords:Tt,onTooltipClose:()=>It(void 0)}):Lt()})};var W=e(86059);const B=ye=>{const{field:pe,row:ve,cellProps:be,tableStyles:Oe}=ye,we=(0,W.k)(pe,ve);return(0,y.jsx)("div",{...be,className:Oe.cellContainerText,children:we?.map((ze,Ve)=>!ze.href&&ze.onClick==null?(0,y.jsx)("span",{className:Oe.cellLinkEmpty,children:ze.title},Ve):(0,y.jsx)("span",{className:Oe.cellLink,onClick:ze.onClick,children:(0,y.jsx)("a",{href:ze.href,target:ze.target,children:ze.title})},Ve))})};var S=e(92745),w=e(76319),N=e(41654),M=e(36100);function L({field:ye,cell:pe,previewMode:ve,showFilters:be,onCellFilterAdded:Oe,setInspectCell:we}){const ze=te(ye)==="flex-end",Ve=!!ye.config.custom?.inspect,ge={size:"sm",tooltipPlacement:"top"},Ke=(0,E.useCallback)(ot=>{Oe&&Oe({key:ye.name,operator:M.mc,value:pe.value})},[pe,ye,Oe]),qe=(0,E.useCallback)(ot=>{Oe&&Oe({key:ye.name,operator:M.Zi,value:pe.value})},[pe,ye,Oe]);return(0,y.jsx)("div",{className:`cellActions${ze?" cellActionsLeft":""}`,children:(0,y.jsxs)(N.B,{gap:.5,children:[Ve&&(0,y.jsx)(w.K,{name:"eye",tooltip:(0,S.t)("grafana-ui.table.cell-inspect","Inspect value"),onClick:()=>{we&&we({value:pe.value,mode:ve})},...ge}),be&&(0,y.jsx)(w.K,{name:"search-plus",onClick:Ke,tooltip:(0,S.t)("grafana-ui.table.cell-filter-on","Filter for value"),...ge}),be&&(0,y.jsx)(w.K,{name:"search-minus",onClick:qe,tooltip:(0,S.t)("grafana-ui.table.cell-filter-out","Filter out value"),...ge})]})})}var A=e(64780);const U=ye=>{const{field:pe,cell:ve,tableStyles:be,row:Oe,cellProps:we,frame:ze,rowStyled:Ve,rowExpanded:ge,textWrapped:Ke,height:qe}=ye,ot=!!pe.config.custom?.inspect,lt=pe.display(ve.value),mt=ye.onCellFilterAdded&&pe.config.filterable,Lt=mt&&ve.value!==void 0||ot,Tt=tt(pe);let It;const Mt=140;if(Tt.type===r.ob.Custom){const gt=Tt.cellComponent;It=(0,y.jsx)(gt,{field:pe,value:ve.value,rowIndex:Oe.index,frame:ze})}else E.isValidElement(ve.value)?It=ve.value:It=(0,m.cN)(lt);const Ut=typeof It=="string",an=lt.text.length<=Mt&&/\s/.test(lt.text),cn=V(be,Tt,lt,ot,Ut,an,Ke,Ve,ge);if(Ut){let gt=we.style?.justifyContent;gt==="flex-end"?we.style={...we.style,textAlign:"right"}:gt==="center"&&(we.style={...we.style,textAlign:"center"})}qe&&(we.style={...we.style,height:qe}),Ke&&(we.style={...we.style,textWrap:"wrap"});const{key:un,...On}=we,yn=(0,W.k)(pe,Oe)||[],[En,Bn]=(0,E.useState)(),{shouldShowLink:fa,hasMultipleLinksOrActions:Fn}=_e(yn),Ea=Fn&&En!==void 0;return(0,y.jsxs)("div",{...On,className:cn,style:{...we.style,cursor:Fn?"context-menu":"auto"},onClick:le(Bn),children:[fa?(0,O.h)(yn[0],It,F(be,Tt)):Ea?(0,y.jsx)(O.e,{links:yn,value:It,coords:En,onTooltipClose:()=>Bn(void 0)}):Ut?`${It}`:(0,y.jsx)("div",{className:be.cellText,children:It}),Lt&&(0,y.jsx)(L,{...ye,previewMode:A.B.text,showFilters:mt})]},un)},F=(ye,pe)=>pe.type===r.ob.Auto?ye.cellLink:ye.cellLinkForColoredCell;function V(ye,pe,ve,be=!1,Oe=!1,we=!1,ze=!1,Ve=!1,ge=!1){let Ke,qe,ot;const lt=Ue(ye.theme,pe,ve);return Ke=lt.textColor,qe=lt.bgColor,ot=lt.bgHoverColor,ye.buildCellContainerStyle(Ke,qe,ot,!be,Oe,we,ze,Ve,ge)}var K=e(64136),G=e(27430);function H(ye){const{cell:pe,tableStyles:ve,cellProps:be}=ye;let Oe="";return pe.value instanceof G.A?Oe=new K.A().writeGeometry(pe.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):pe.value!=null&&(Oe=`${pe.value}`),(0,y.jsx)("div",{...be,className:ve.cellContainer,children:(0,y.jsx)("div",{className:ve.cellText,style:{fontFamily:"monospace"},children:Oe})})}const _=10,k=ye=>{const{field:pe,cell:ve,tableStyles:be,row:Oe,cellProps:we}=ye,ze=tt(pe),{title:Ve,alt:ge}=ze.type===r.ob.Image?ze:{title:void 0,alt:void 0},Ke=pe.display(ve.value),qe=(0,W.k)(pe,Oe)||[],[ot,lt]=(0,E.useState)(),{shouldShowLink:mt,hasMultipleLinksOrActions:Lt}=_e(qe),Tt=Lt&&ot!==void 0,It=(0,y.jsx)("img",{style:{height:be.cellHeight-_,width:"auto"},src:Ke.text,className:be.imageCell,alt:ge,title:Ve});return(0,y.jsx)("div",{...we,className:be.cellContainer,style:{...we.style,cursor:Lt?"context-menu":"auto"},onClick:le(lt),children:mt?(0,O.h)(qe[0],It):Tt?(0,y.jsx)(O.e,{links:qe,value:It,coords:ot,onTooltipClose:()=>lt(void 0)}):It})};function J(ye){const{cell:pe,tableStyles:ve,cellProps:be,field:Oe,row:we}=ye,ze=!!Oe.config.custom?.inspect,Ve=(0,v.css)({cursor:"pointer",fontFamily:"monospace"});let ge=pe.value,Ke=ge;if((0,n.isString)(ge))try{ge=JSON.parse(ge)}catch{}else Ke=JSON.stringify(ge,null," ");const qe=(0,W.k)(Oe,we)||[],[ot,lt]=(0,E.useState)(),{shouldShowLink:mt,hasMultipleLinksOrActions:Lt}=_e(qe),Tt=Lt&&ot!==void 0;return(0,y.jsxs)("div",{...be,className:ze?ve.cellContainerNoOverflow:ve.cellContainer,children:[(0,y.jsx)("div",{className:(0,v.cx)(ve.cellText,Ve),onClick:le(lt),children:mt?(0,O.h)(qe[0],Ke):Tt?(0,y.jsx)(O.e,{links:qe,value:Ke,coords:ot,onTooltipClose:()=>lt(void 0)}):(0,y.jsx)("div",{className:ve.cellText,children:Ke})}),ze&&(0,y.jsx)(L,{...ye,previewMode:A.B.code})]})}var z=e(93948),Y=e(74533),X=e(30703);function Q({row:ye,tableStyles:pe}){return(0,y.jsx)("div",{className:pe.expanderCell,...ye.getToggleRowExpandedProps(),children:(0,y.jsx)(X.I,{"aria-label":ye.isExpanded?(0,S.t)("grafana-ui.row-expander.collapse","Collapse row"):(0,S.t)("grafana-ui.row-expander.expand","Expand row"),name:ye.isExpanded?"angle-down":"angle-right",size:"lg"})})}const q=50;function te(ye){if(!ye)return"flex-start";if(ye.config.custom)switch(ye.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return ye.type===o.PU.number?"flex-end":"flex-start"}function ne(ye,pe,ve,be,Oe,we){const ze=[];let Ve=0;be&&(ze.push({Header:()=>null,id:"expander",Cell:Q,width:q,minWidth:q,filter:(Ke,qe,ot)=>[],justifyContent:"left",field:ye.fields[0],sortType:"basic"}),pe-=q);for(const[Ke,qe]of ye.fields.entries()){const ot=qe.config.custom||{};if(ot.hidden||qe.type===o.PU.nestedFrames)continue;ot.width?pe-=ot.width:Ve++;const lt=Lt=>{switch(Lt){case o.PU.number:case o.PU.frame:return"number";case o.PU.time:return"basic";default:return"alphanumeric-insensitive"}},mt=se(ot.cellOptions?.type,qe);ze.push({Cell:mt,id:Ke.toString(),field:qe,Header:ot.hideHeader?"":(0,d.Ct)(qe,ye),accessor:(Lt,Tt)=>qe.values[Tt],sortType:lt(qe.type),width:ot.width,minWidth:ot.minWidth??ve,filter:s()(ue(qe)),justifyContent:te(qe),Footer:(0,Y.d)(Ke,Oe,we)})}let ge=pe/Ve;for(let Ke=Ve;Ke>0;Ke--)for(const qe of ze)!qe.width&&qe.minWidth>ge&&(qe.width=qe.minWidth,pe-=qe.width,Ve-=1,ge=pe/Ve);for(const Ke of ze)Ke.width||(Ke.width=ge),Ke.minWidth=50;return ze}function se(ye,pe){switch(ye){case r.ob.Custom:case r.ob.ColorText:case r.ob.ColorBackground:return U;case r.ob.Image:return k;case r.ob.Gauge:return j;case r.ob.Sparkline:return z.a;case r.ob.JSONView:return J;case r.ob.DataLinks:return B;case r.ob.Actions:return u;case r.ob.Pill:return U}if(pe.type===o.PU.geo)return H;if(pe.type===o.PU.frame){const ve=pe.values[0];return(0,i.ci)(ve)&&(0,c.aH)(ve)?z.a:J}return pe.type===o.PU.other?J:U}function ue(ye){return function(pe,ve,be){return pe.length===0||!be||!ye?pe:pe.filter(Oe=>{if(!Oe.values.hasOwnProperty(ve))return!1;const we=ie(Oe,ye);return be.find(ze=>ze.value===we)!==void 0})}}function de(ye,pe){if(!pe||ye.length===0)return{};const ve={};for(let be=0;be<ye.length;be++){const Oe=ie(ye[be],pe);ve[Oe||"(Blanks)"]=Oe}return ve}function ie(ye,pe){if(!pe||!ye)return"";const ve=pe.values[ye.index],be=pe.display?pe.display(ve):ve;return pe.display?(0,m.cN)(be):be}function he(ye){return Object.keys(ye).reduce((pe,ve)=>pe.concat({value:ye[ve],label:ve}),[]).sort(me)}function me(ye,pe){return ye.label===void 0&&pe.label===void 0?0:ye.label===void 0&&pe.label!==void 0?-1:ye.label!==void 0&&pe.label===void 0?1:ye.label<pe.label?-1:ye.label>pe.label?1:0}function ce(ye,pe){return pe?ye.filter(ve=>pe.some(be=>be.value===ve.value)):[]}function Pe(ye,pe,ve){return String(ye.values[ve]).localeCompare(String(pe.values[ve]),void 0,{sensitivity:"base"})}function Ie(ye,pe,ve){const be=Se(ye.values[ve]),Oe=Se(pe.values[ve]);return be===Oe?0:be>Oe?1:-1}function Se(ye){return(0,i.LI)(ye)?ye.value??Number.NEGATIVE_INFINITY:ye==null||ye===""||isNaN(ye)?Number.NEGATIVE_INFINITY:typeof ye=="number"?ye:Number(ye)}function Me(ye,pe,ve,be){return He(ye),ye.map((Oe,we)=>{if(Oe?.field?.type!==o.PU.number)return we===0&&ve.reducer&&ve.reducer.length>0?p.AS.get(ve.reducer[0]).name:void 0;let ze=(0,n.clone)(Oe.field);return ze.values=pe[Oe.id],ze.state=void 0,Oe.field=ze,ve.fields&&ve.fields.length>0?ve.fields.find(ge=>ge===Oe?.field?.name)?Te(Oe.field,ve.reducer,be):void 0:Te(Oe.field,ve.reducer||[],be)})}function Te(ye,pe,ve){const be=pe[0];if(be===void 0)return"";const Oe=ye.display??(0,h.J)({field:ye,theme:ve}),we=(0,p.Nw)({field:ye,reducers:pe})[be];return p.AS.get(be).preservesUnits?(0,m.cN)(Oe(we)):(0,m.cN)({text:we})}function Ge(ye){const pe=[];for(const ve in ye)for(const[be,Oe]of Object.entries(ye[ve].values))pe[be]===void 0&&(pe[be]=[]),pe[be].push(Oe);return pe}const Qe={type:r.ob.Auto};function tt(ye){return ye.config.custom?.displayMode?ke(ye.config.custom?.displayMode):ye.config.custom?.cellOptions?ye.config.custom.cellOptions:Qe}function ke(ye){switch(ye){case"basic":case"gradient-gauge":case"lcd-gauge":let pe=r.eX.Basic;return ye==="gradient-gauge"?pe=r.eX.Gradient:ye==="lcd-gauge"&&(pe=r.eX.Lcd),{type:r.ob.Gauge,mode:pe};case"color-background":case"color-background-solid":let ve=r.Wq.Basic;return ye==="color-background"&&(ve=r.Wq.Gradient),{type:r.ob.ColorBackground,mode:ve};default:return{type:ye}}}function He(ye){const pe=ye.findIndex((ve,be)=>ve?.id!==String(be));pe===-1||ye[pe]?.id==="expander"||(ye.splice(pe,0,{id:String(pe)}),He(ye))}function Re(ye,pe,ve){let be=ye.state?.alignmentFactors;if(be)return(0,m.cN)(be).length<(0,m.cN)(pe).length&&(be={...pe},ye.state.alignmentFactors=be),be;{be={...pe};const Oe=Math.min(ye.values.length,ve+1e3);for(let we=ve+1;we<Oe;we++){const ze=ye.display(ye.values[we]);(0,m.cN)(be).length>(0,m.cN)(ze).length&&(be.text=pe.text)}return ye.state?ye.state.alignmentFactors=be:ye.state={alignmentFactors:be},be}}function Ne(ye,pe,ve){return Math.abs(Math.floor(ye)-pe)<ve}function Ae(ye){let pe=-Number.MAX_VALUE,ve=Number.MAX_VALUE;if(ye.values.length<2)return 0;for(let be=0;be<ye.values.length;be++){const Oe=ye.values[be];Oe>pe&&(pe=Oe),Oe<ve&&(ve=Oe)}return(pe-ve)/ye.values.length}function Ue(ye,pe,ve){const be=ye.isDark?1:-.7;let Oe,we,ze;if(pe.type===r.ob.ColorText)Oe=ve.color;else if(pe.type===r.ob.ColorBackground){const Ve=pe.mode??r.Wq.Gradient;if(Ve===r.Wq.Basic)Oe=(0,g.mZ)(ve.color,ye.isDark),we=(0,l.A)(ve.color).toRgbString(),ze=(0,l.A)(ve.color).setAlpha(1).toRgbString();else if(Ve===r.Wq.Gradient){const ge=(0,l.A)(ve.color).setAlpha(1).toRgbString(),Ke=(0,l.A)(ve.color).darken(10*be).spin(5);Oe=(0,g.mZ)(ve.color,ye.isDark),we=`linear-gradient(120deg, ${Ke.toRgbString()}, ${ve.color})`,ze=`linear-gradient(120deg, ${Ke.setAlpha(1).toRgbString()}, ${ge})`}}return{textColor:Oe,bgColor:we,bgHoverColor:ze}}function Be(ye,pe,ve,be,Oe,we=0){const ze=Number(pe?.width??300),Ve=1.17,ge=42,Ke=we*2;if(ve!==null&&typeof ye=="string"){const qe=ye.split(/\s/),ot=[];let lt="",mt=0,Lt=0;for(let Mt=0;Mt<qe.length;Mt++){const Ut=qe[Mt];let an=ve.measureText(lt+" "+Ut).width;an<ze-Ke?(lt+=" "+Ut,mt++):(ot.push({width:an,line:lt}),lt=Ut,mt=0)}for(let Mt=0;Mt<ot.length;Mt++)if(ot[Mt].width>ze){let Ut=Math.floor(ot[Mt].width/ze)-1;Lt+=Ut}let Tt=ot.length+Lt,It=38;return Tt>5?It=Tt*be*Ve:It=Tt*be+ge,It+=Ke,{width:ze,height:It}}return{width:ze,height:Oe}}function We(ye,pe){let ve;if(ye.defaults.custom?.cellOptions?.wrapText){const Oe=pe.fields.filter(we=>we.type===o.PU.string);if(Oe.length>=1&&Oe[0].values.length>0){const we=Oe[0].values.length;let ze=0;if(we<=30)for(const Ve of Oe){const ge=Ve.values.find(Ke=>Ke!=null)?.length??0;ge>ze&&(ze=ge,ve=Ve)}else for(const Ve of Oe){const ge=(0,n.sampleSize)(Ve.values,3),Ke=(ge[0]?.length+ge[1]?.length+ge[2]?.length)/3;Ke>ze&&(ze=Ke,ve=Ve)}}}return ve}const _e=(ye,pe)=>{const ve=ye.length>1||!!pe?.length;return{shouldShowLink:ye.length===1&&!pe?.length,hasMultipleLinksOrActions:ve}},Xe=ye=>ye.target===ye.currentTarget,le=ye=>pe=>{if(Xe(pe)){const{clientX:ve,clientY:be}=pe;ye({clientX:ve,clientY:be})}}},72489:(Z,R,e)=>{"use strict";e.d(R,{p:()=>o});var n=e(74848),a=e(22803),s=e(55386),l=e(63142);const o=({value:i,variant:c="secondary"})=>{const m=(0,l.of)(d,c);return(0,n.jsx)("span",{className:m.counter,children:(0,s.Hg)(i,0).text})},d=(i,c)=>({counter:(0,a.css)({label:"counter",marginLeft:i.spacing(1),borderRadius:i.spacing(3),backgroundColor:c==="primary"?i.colors.primary.main:i.colors.action.hover,padding:i.spacing(.25,1),color:i.colors.text.secondary,fontWeight:i.typography.fontWeightMedium,fontSize:i.typography.size.sm})})},60208:(Z,R,e)=>{"use strict";e.d(R,{o:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(63142),d=e(35484),i=e(45861),c=e(30703),m=e(45967),p=e(72489);const h=s.forwardRef(({label:g,active:y,icon:v,onChangeTab:x,counter:f,suffix:u,className:b,href:E,truncate:D,tooltip:C,...P},T)=>{const O=(0,o.of)(r),I=(0,o.of)(i.my),j=()=>(0,n.jsxs)(n.Fragment,{children:[v&&(0,n.jsx)(c.I,{name:v,"data-testid":`tab-icon-${v}`}),g,typeof f=="number"&&(0,n.jsx)(p.p,{value:f}),u&&(0,n.jsx)(u,{className:O.suffix})]}),B={className:(0,a.cx)(I,O.link,y?O.activeStyle:O.notActive,D&&O.linkTruncate),"data-testid":l.Tp.components.Tab.title(g),...P,onClick:x,role:"tab","aria-selected":y,title:C?void 0:P.title};let S=null;return E?S=(0,n.jsx)("div",{className:(0,a.cx)(O.item,D&&O.itemTruncate,b),children:(0,n.jsx)("a",{...B,href:E,ref:T,children:j()})}):S=(0,n.jsx)("div",{className:(0,a.cx)(O.item,D&&O.itemTruncate,b),children:(0,n.jsx)("button",{...B,type:"button",ref:T,children:j()})}),C?(0,n.jsx)(m.m,{content:C,children:S}):S});h.displayName="Tab";const r=g=>({item:(0,a.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:g.spacing(0,.5)}),itemTruncate:(0,a.css)({maxWidth:g.spacing(40)}),link:(0,a.css)({color:g.colors.text.secondary,padding:g.spacing(1,1.5,1),borderRadius:g.shape.radius.default,display:"block",height:"100%",svg:{marginRight:g.spacing(1)},"&:focus-visible":(0,d.getFocusStyles)(g),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",borderRadius:g.shape.radius.default,bottom:0}}),linkTruncate:(0,a.css)({textOverflow:"ellipsis",whiteSpace:"nowrap",wordBreak:"break-word",overflow:"hidden"}),notActive:(0,a.css)({"a:hover, &:hover, &:focus":{color:g.colors.text.primary,"&::before":{backgroundColor:g.colors.action.hover}}}),activeStyle:(0,a.css)({label:"activeTabStyle",color:g.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:g.colors.gradients.brandHorizontal}}),suffix:(0,a.css)({marginLeft:g.spacing(1)})})},13941:(Z,R,e)=>{"use strict";e.d(R,{J:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i,...c})=>{const m=(0,s.of)(o);return(0,n.jsx)("div",{...c,className:(0,a.cx)(m.tabContent,i),children:d})},o=d=>({tabContent:(0,a.css)({background:d.colors.background.primary})})},54314:(Z,R,e)=>{"use strict";e.d(R,{U:()=>o});var n=e(74848),a=e(22803),s=e(96540),l=e(63142);const o=(0,s.forwardRef)(({children:i,className:c,hideBorder:m=!1},p)=>{const h=(0,l.of)(d);return(0,n.jsx)("div",{className:(0,a.cx)(h.tabsWrapper,m&&h.noBorder,c),ref:p,children:(0,n.jsx)("div",{className:h.tabs,role:"tablist",children:i})})}),d=i=>({tabsWrapper:(0,a.css)({borderBottom:`1px solid ${i.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,a.css)({borderBottom:0}),tabs:(0,a.css)({position:"relative",display:"flex",alignItems:"center"})});o.displayName="TabsBar"},94018:(Z,R,e)=>{"use strict";e.d(R,{v:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(70255),o=e(63142),d=e(21348),i=e(48542),c=e(30703);const m=(0,s.forwardRef)(({name:y,onClick:v,icon:x,className:f,colorIndex:u,...b},E)=>{const D=(0,o.$j)(),C=g(D,y,u),P=O=>{O.preventDefault(),O.stopPropagation(),v?.(y,O)},T=(0,a.cx)(C.wrapper,f,{[C.hover]:v!==void 0});return v?(0,n.jsxs)("button",{...b,className:T,onClick:P,ref:E,children:[x&&(0,n.jsx)(c.I,{name:x}),y]}):(0,n.jsxs)("span",{...b,className:T,ref:E,children:[x&&(0,n.jsx)(c.I,{name:x}),y]})});m.displayName="Tag";const p=({rootProps:y})=>{const v=(0,o.of)(r);return(0,n.jsx)(l.A,{width:60,height:22,containerClassName:v.container,...y})},h=(0,d.j)(m,p),r=()=>({container:(0,a.css)({lineHeight:1})}),g=(y,v,x)=>{let f;return x===void 0?f=(0,i.MC)(v):f=(0,i.yC)(x),{wrapper:(0,a.css)({appearance:"none",borderStyle:"none",fontWeight:y.typography.fontWeightMedium,fontSize:y.typography.size.sm,lineHeight:y.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:f.color,color:y.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:y.shape.radius.default}),hover:(0,a.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},37658:(Z,R,e)=>{"use strict";e.d(R,{L:()=>p});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(21348),i=e(94018);const c=(0,s.memo)((0,s.forwardRef)(({displayMax:g,tags:y,icon:v,onClick:x,className:f,getAriaLabel:u,getColorIndex:b},E)=>{const D=(0,o.$j)(),C=r(D,!!(g&&g>0)),P=y.length,T=g?y.slice(0,g):y;return(0,n.jsxs)("ul",{className:(0,a.cx)(C.wrapper,f),"aria-label":(0,l.t)("grafana-ui.tags.list-label","Tags"),ref:E,children:[T.map((O,I)=>(0,n.jsx)("li",{className:C.li,children:(0,n.jsx)(i.v,{name:O,icon:v,onClick:x,"aria-label":u?.(O,I),"data-tag-id":I,colorIndex:b?.(O,I)})},O)),g&&g>0&&P-g>0&&(0,n.jsxs)("span",{className:C.moreTagsLabel,children:["+ ",P-g]})]})}));c.displayName="TagList";const m=({rootProps:g})=>{const y=(0,o.of)(h);return(0,n.jsxs)("div",{className:y.container,...g,children:[(0,n.jsx)(i.v.Skeleton,{}),(0,n.jsx)(i.v.Skeleton,{})]})},p=(0,d.j)(c,m),h=g=>({container:(0,a.css)({display:"flex",gap:g.spacing(1)})}),r=(g,y)=>({wrapper:(0,a.css)({position:"relative",alignItems:y?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:y?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,a.css)({color:g.colors.text.secondary,fontSize:g.typography.size.sm}),li:(0,a.css)({listStyle:"none"})})},10928:(Z,R,e)=>{"use strict";e.d(R,{u:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861),i=e(63527),c=e(48542),m=e(76319);const p=({name:y,disabled:v,onRemove:x,autoColors:f=!0})=>{const u=(0,o.of)(h),b=(0,s.useMemo)(()=>{if(f){const{color:E,borderColor:D}=(0,c.MC)(y);return{backgroundColor:E,borderColor:D}}},[y,f]);return(0,n.jsxs)("li",{className:(0,a.cx)(u.itemStyle,!b&&u.defaultTagColor),style:b,children:[(0,n.jsx)("span",{className:u.nameStyle,children:y}),(0,n.jsx)(m.K,{name:"times",size:"lg",disabled:v,tooltip:(0,l.t)("grafana-ui.tags-input.remove","Remove tag: {{name}}",{name:y}),onClick:()=>x(y),className:u.buttonStyles})]})},h=y=>{const v=y.spacing.gridSize*3;return{itemStyle:(0,a.css)({display:"flex",gap:"3px",alignItems:"center",height:`${v}px`,lineHeight:`${v-2}px`,borderWidth:"1px",borderStyle:"solid",borderRadius:y.shape.radius.default,padding:`0 ${y.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:y.typography.size.sm,color:"#fff"}),defaultTagColor:(0,a.css)({backgroundColor:y.colors.background.secondary,borderColor:y.components.input.borderColor,color:y.colors.text.primary}),nameStyle:(0,a.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,a.css)({margin:0,"&:hover::before":{display:"none"}})}},r=(0,s.forwardRef)(({placeholder:y="New tag (enter key to add)",tags:v=[],onChange:x,width:f,className:u,disabled:b,addOnBlur:E,invalid:D,id:C,autoColors:P=!0},T)=>{const[O,I]=(0,s.useState)(""),j=(0,o.of)(g),W=(0,o.$j)(),B=(0,s.useCallback)(L=>{I(L.target.value)},[]),S=L=>{x(v.filter(A=>A!==L))},w=L=>{L?.preventDefault(),v.includes(O)||x(v.concat(O)),I("")},N=()=>{E&&O&&w()},M=L=>{L.key==="Enter"&&O!==""&&w(L)};return(0,n.jsxs)("div",{className:(0,a.cx)(j.wrapper,u,f?(0,a.css)({width:W.spacing(f)}):""),children:[(0,n.jsx)(i.p,{ref:T,id:C,disabled:b,placeholder:y,onChange:B,value:O,onKeyDown:M,onBlur:N,invalid:D,suffix:(0,n.jsx)(d.$n,{fill:"text",className:j.addButtonStyle,onClick:w,size:"md",disabled:O.length<=0,children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.tags-input.add",children:"Add"})})}),v?.length>0&&(0,n.jsx)("ul",{className:j.tags,children:v.map(L=>(0,n.jsx)(p,{name:L,onRemove:S,disabled:b,autoColors:P},L))})]})});r.displayName="TagsInput";const g=y=>({wrapper:(0,a.css)({minHeight:y.spacing(4),display:"flex",flexDirection:"column",gap:y.spacing(1),flexWrap:"wrap"}),tags:(0,a.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:y.spacing(.5)}),addButtonStyle:(0,a.css)({margin:`0 -${y.spacing(1)}`})})},87105:(Z,R,e)=>{"use strict";e.d(R,{f:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(3343);const d=(0,s.forwardRef)(({invalid:c,className:m,...p},h)=>{const r=(0,l.of)(i,c);return(0,n.jsx)("textarea",{...p,className:(0,a.cx)(r.textarea,m),ref:h})}),i=(c,m=!1)=>({textarea:(0,a.cx)((0,o.Xb)(c),(0,o.gm)(c),(0,a.css)({display:"block",borderRadius:c.shape.radius.default,padding:`${c.spacing.gridSize/4}px ${c.spacing.gridSize}px`,width:"100%",borderColor:m?c.colors.error.border:c.components.input.borderColor}))});d.displayName="TextArea"},59243:(Z,R,e)=>{"use strict";e.d(R,{G:()=>h});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(96540),i=e(92745),c=e(63142),m=e(71495),p=e(76319);const h=(0,d.memo)(({children:g,theme:y="info",placement:v="auto",content:x,title:f,closeButton:u=!0,onClose:b,footer:E,fitContent:D=!1,onOpen:C,show:P})=>{const T=(0,d.useRef)(null),O=(0,c.$j)(),I=(0,c.of)(r),j=I[y],[W,B]=(0,d.useState)(P),S=P??W,w=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)(),(0,s.UE)({element:T})],{context:N,refs:M,floatingStyles:L}=(0,l.we)({open:S,placement:(0,m.O)(v),onOpenChange:K=>{P===void 0&&B(K),K?C?.():b?.()},middleware:w,whileElementsMounted:o.ll,strategy:"fixed"}),A=(0,l.kp)(N),U=(0,l.s9)(N),{getReferenceProps:F,getFloatingProps:V}=(0,l.bv)([U,A]);return(0,n.jsxs)(n.Fragment,{children:[(0,d.cloneElement)(g,{ref:M.setReference,tabIndex:0,"aria-expanded":S,...F()}),S&&(0,n.jsx)(l.s3,{context:N,modal:!1,closeOnFocusOut:!1,children:(0,n.jsxs)("div",{"data-testid":"toggletip-content",className:(0,a.cx)(j.container,{[I.fitContent]:D}),ref:M.setFloating,style:L,...V(),children:[(0,n.jsx)(l.ie,{strokeWidth:.3,stroke:O.colors.border.weak,className:j.arrow,ref:T,context:N}),!!f&&(0,n.jsx)("div",{className:j.header,children:f}),u&&(0,n.jsx)("div",{className:j.headerClose,children:(0,n.jsx)(p.K,{"aria-label":(0,i.t)("grafana-ui.toggletip.close","Close"),name:"times","data-testid":"toggletip-header-close",onClick:()=>{B(!1),b?.()}})}),(0,n.jsxs)("div",{className:j.body,children:[(typeof x=="string"||(0,d.isValidElement)(x))&&x,typeof x=="function"&&x({})]}),!!E&&(0,n.jsx)("div",{className:j.footer,children:E})]})})]})});h.displayName="Toggletip";const r=g=>{const y=(0,m.f)(g,g.colors.background.primary,g.colors.border.weak,g.components.tooltip.text,{topBottom:2,rightLeft:2}),v=(0,m.f)(g,g.colors.error.main,g.colors.error.main,g.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:y,error:v,fitContent:(0,a.css)({maxWidth:"fit-content"})}}},7895:(Z,R,e)=>{"use strict";e.d(R,{I:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(30360),o=e(51898),d=e(63142),i=e(35484),c=e(45861),m=e(30703),p=e(45967);const h=(0,s.forwardRef)(({tooltip:v,icon:x,iconSize:f,className:u,children:b,imgSrc:E,imgAlt:D,fullWidth:C,isOpen:P,narrow:T,variant:O="default",iconOnly:I,"aria-label":j,isHighlighted:W,...B},S)=>{const w=(0,d.of)(y),N=(0,a.cx)({[w.button]:!0,[w.buttonFullWidth]:C,[w.narrow]:T},w[O],u),M=(0,a.cx)({[w.content]:!0,[w.contentWithIcon]:!!x,[w.contentWithRightIcon]:P!==void 0}),L=(0,n.jsxs)("button",{ref:S,className:N,"aria-label":r(j,v),"aria-expanded":P,type:"button",...B,children:[g(x,f),E&&(0,n.jsx)("img",{className:w.img,src:E,alt:D??""}),b&&!I&&(0,n.jsx)("div",{className:M,children:b}),P===!1&&(0,n.jsx)(m.I,{name:"angle-down"}),P===!0&&(0,n.jsx)(m.I,{name:"angle-up"}),W&&(0,n.jsx)("div",{className:w.highlight})]});return v?(0,n.jsx)(p.m,{ref:S,content:v,placement:"bottom",children:L}):L});h.displayName="ToolbarButton";function r(v,x){return v||(x?o.Tp.components.PageToolbar.item(x):void 0)}function g(v,x){return v?(0,l.n6)(v)?(0,n.jsx)(m.I,{name:v,size:`${x||"lg"}`}):v:null}const y=v=>{const x=(0,c.U_)(v,"primary","solid"),f=(0,c.U_)(v,"destructive","solid"),u=(0,a.css)({color:v.colors.text.primary,background:v.colors.secondary.main,"&:hover":{color:v.colors.text.primary,background:v.colors.secondary.shade,border:`1px solid ${v.colors.border.medium}`}});return{button:(0,a.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:v.spacing(v.components.height.md),padding:v.spacing(0,1),borderRadius:v.shape.radius.default,lineHeight:`${v.components.height.md*v.spacing.gridSize-2}px`,fontWeight:v.typography.fontWeightMedium,border:`1px solid ${v.colors.secondary.border}`,whiteSpace:"nowrap",[v.transitions.handleMotion("no-preference","reduce")]:{transition:v.transitions.create(["background","box-shadow","border-color","color"],{duration:v.transitions.duration.short})},[v.breakpoints.down("md")]:{width:"auto !important"},"&:focus, &:focus-visible":{...(0,i.getFocusStyles)(v),zIndex:1},"&:focus:not(:focus-visible)":(0,i.getMouseFocusStyles)(v),"&[disabled], &:disabled":{cursor:"not-allowed",opacity:v.colors.action.disabledOpacity,background:v.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:v.colors.text.disabled,background:v.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,a.css)({color:v.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:v.colors.text.primary,background:v.colors.action.hover}}),canvas:u,active:(0,a.cx)(u,(0,a.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:v.shape.radius.default,backgroundImage:v.colors.gradients.brandHorizontal}})),primary:(0,a.css)(x),destructive:(0,a.css)(f),narrow:(0,a.css)({padding:v.spacing(0,.5)}),img:(0,a.css)({width:"16px",height:"16px",marginRight:v.spacing(1)}),buttonFullWidth:(0,a.css)({flexGrow:1}),content:(0,a.css)({display:"flex",flexGrow:1}),contentWithIcon:(0,a.css)({display:"none",paddingLeft:v.spacing(1),[`@media ${(0,i.mediaUp)(v.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,a.css)({paddingRight:v.spacing(.5)}),highlight:(0,a.css)({backgroundColor:v.colors.success.main,borderRadius:v.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},36219:(Z,R,e)=>{"use strict";e.d(R,{U:()=>h});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(96540),i=e(92745),c=e(63142),m=e(15245),p=e(7895);const h=(0,d.forwardRef)(({alignment:g="left",className:y,children:v,...x},f)=>{const u=d.Children.toArray(v).filter(w=>w!=null),[b,E]=(0,d.useState)(Array(u.length).fill(!1)),D=(0,d.useRef)(null),[C,P]=(0,d.useState)(!1),T=(0,d.useRef)(null),O=(0,d.createRef)(),{overlayProps:I}=(0,o.e)({onClose:()=>P(!1),isDismissable:!0,isOpen:C,shouldCloseOnInteractOutside:w=>{const N=(0,m.gF)();return!T.current?.contains(w)&&!N.contains(w)}},O),{dialogProps:j}=(0,s.s)({},O),W=(0,c.$j)(),B=g==="left"?b.indexOf(!1)-1:b.length,S=r(W,B,g);return(0,d.useLayoutEffect)(()=>{const w=new IntersectionObserver(N=>{N.forEach(M=>{if(M.target instanceof HTMLElement&&M.target.parentNode){const L=Array.prototype.indexOf.call(M.target.parentNode.children,M.target);E(A=>{const U=[...A];return U[L]=M.isIntersecting,U})}})},{threshold:1,root:D.current});return D.current&&Array.from(D.current.children).forEach(N=>{N instanceof HTMLElement&&N!==T.current&&w.observe(N)}),()=>w.disconnect()},[v]),(0,n.jsxs)("div",{ref:D,className:(0,a.cx)(S.container,y),...x,children:[u.map((w,N)=>(0,n.jsx)("div",{style:{order:N,visibility:b[N]?"visible":"hidden"},className:S.childWrapper,children:w},N)),b.includes(!1)&&(0,n.jsxs)("div",{ref:T,className:S.overflowButton,children:[(0,n.jsx)(p.I,{variant:C?"active":"default",tooltip:(0,i.t)("grafana-ui.toolbar-button-row.show-more","Show more items"),onClick:()=>P(!C),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),C&&(0,n.jsx)(l.n1,{contain:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:S.overflowItems,ref:O,...I,...j,children:u.map((w,N)=>!b[N]&&w)})})]})]})});h.displayName="ToolbarButtonRow";const r=(g,y,v)=>({overflowButton:(0,a.css)({order:y}),overflowItems:(0,a.css)({alignItems:"center",backgroundColor:g.colors.background.primary,borderRadius:g.shape.radius.default,boxShadow:g.shadows.z2,display:"flex",flexWrap:"wrap",gap:g.spacing(1),marginTop:g.spacing(1),maxWidth:"80vw",padding:g.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:g.zIndex.dropdown}),container:(0,a.css)({alignItems:"center",display:"flex",gap:g.spacing(1),justifyContent:v==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,a.css)({alignItems:"center",display:"flex",gap:g.spacing(1)})})},2381:(Z,R,e)=>{"use strict";e.d(R,{A:()=>m});var n=e(74848),a=e(34743),s=e(83505),l=e(46885),o=e(96540),d=e(63142),i=e(71495),c=e(15245);function m({content:p,show:h,placement:r,className:g,wrapperClassName:y,referenceElement:v,renderArrow:x,hidePopper:f,...u}){const b=(0,d.$j)(),E=(0,o.useRef)(null),D=[(0,a.cY)(8),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)()];x&&D.push((0,a.UE)({element:E}));const{context:C,refs:P,floatingStyles:T}=(0,s.we)({open:h,placement:(0,i.O)(r),middleware:D,whileElementsMounted:l.ll,strategy:"fixed"});(0,o.useLayoutEffect)(()=>{P.setReference(v)},[v,P]);const{styles:O}=(0,s.DL)(C,{initial:()=>({opacity:0}),duration:b.transitions.duration.enteringScreen});return h?(0,n.jsx)(c.ZL,{children:(0,n.jsx)("div",{ref:P.setFloating,style:{...T,...O},className:y,...u,children:(0,n.jsxs)("div",{className:g,children:[x&&(0,n.jsx)(s.ie,{fill:b.colors.border.weak,ref:E,context:C}),typeof p=="string"&&p,o.isValidElement(p)&&o.cloneElement(p),typeof p=="function"&&p({hidePopper:f})]})})}):void 0}},43533:(Z,R,e)=>{"use strict";e.d(R,{I:()=>a});var n=e(96540);class a extends n.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:l,content:o,placement:d="auto"}=this.props,{show:i}=this.state;return l(this.showPopper,this.hidePopper,{show:i,placement:d,content:o})}}},20662:(Z,R,e)=>{"use strict";e.d(R,{z:()=>l});var n=e(74848),a=e(96540);function s(o,d){const i=[];return o.forEach(c=>{i.push(c.start,c.end+1)}),i[0]!==0&&i.unshift(0),i[i.length-1]!==d&&i.push(d),i}const l=o=>{let{highlightParts:d,text:i,highlightClassName:c}=o;if(!d?.length)return null;let m=[],p=s(d,i.length),h=d[0].start===0;for(let r=1;r<p.length;r++){let g=p[r-1],y=p[r];m.push((0,a.createElement)(h?"mark":"span",{key:r-1,className:h?c:void 0},i.substring(g,y))),h=!h}return(0,n.jsx)("div",{children:m})}},12965:(Z,R,e)=>{"use strict";e.d(R,{p:()=>i});var n=e(74848),a=e(96540),s=e(55386),l=e(92745),o=e(64913);function d(c){return`Custom unit: ${c}`}class i extends a.PureComponent{constructor(){super(...arguments),this.onChange=m=>{this.props.onChange(m.value)}}render(){const{value:m,width:p}=this.props;let h;const g=(0,s.Ke)().map(y=>{const v=y.submenu.map(x=>{const f={label:x.text,value:x.value};return x.value===m&&(h=f),f});return{label:y.text,value:y.text,items:v}});return m&&!h&&(h={value:m,label:m}),(0,n.jsx)(o.v,{width:p,initialValue:h&&h.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:d,options:g,placeholder:(0,l.t)("grafana-ui.unit-picker.placeholder","Choose"),isClearable:!0,onSelect:this.props.onChange})}}},71555:(Z,R,e)=>{"use strict";e.d(R,{e:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(43990);const o=({src:i,alt:c,width:m,height:p})=>{const h=(0,s.of)(d,m,p);return(0,n.jsx)("img",{className:h.image,src:i,alt:c})},d=(i,c=3,m=3)=>({image:(0,a.css)([(0,l.Y)(i,c,p=>({width:i.spacing(p)})),(0,l.Y)(i,m,p=>({height:i.spacing(p)})),{borderRadius:i.shape.radius.circle}])})},44815:(Z,R,e)=>{"use strict";e.d(R,{q:()=>d});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(35942);const d=({users:c,onClick:m,limit:p=4})=>{const h=(0,l.of)(i);if(!c.length)return null;p=p>0?p:4;const r=c.length>p,g=c.length-p,y=g>99;return(0,n.jsxs)("div",{className:h.container,"aria-label":(0,s.t)("grafana-ui.users-indicator.container-label","Users indicator container"),children:[r&&(0,n.jsx)(o.n,{onClick:m,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1,children:y?"...":`+${g}`}),c.slice(0,r?p:p+1).reverse().map(v=>(0,n.jsx)(o.n,{userView:v},v.user.name))]})},i=c=>({container:(0,a.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:c.spacing(1),"& > button":{marginLeft:c.spacing(-1)}}),dots:(0,a.css)({marginBottom:"3px"})})},59695:(Z,R,e)=>{"use strict";e.d(R,{i:()=>i});var n=e(74848),a=e(96540),s=e(51898),l=e(63142),o=e(45861),d=e(18857);function i({"aria-label":c,label:m,icon:p,options:h,onChange:r,variant:g,minWidth:y=16,size:v="sm",isFullWidth:x=!0,menuPlacement:f,fill:u,buttonCss:b}){const[E,D]=(0,a.useState)(!1),C=(0,l.$j)();return(0,n.jsxs)(n.Fragment,{children:[!E&&(0,n.jsx)(o.$n,{size:v||"sm",className:b,icon:p||"plus",onClick:()=>D(!0),variant:g,fill:u,fullWidth:x,"data-testid":s.Tp.components.ValuePicker.button(c??m),children:m}),E&&(0,n.jsx)("span",{style:{minWidth:C.spacing(y),flexGrow:x?1:void 0},children:(0,n.jsx)(d.l6,{placeholder:m,options:h,"aria-label":s.Tp.components.ValuePicker.select(c??m),isOpen:!0,onCloseMenu:()=>D(!1),autoFocus:!0,onChange:P=>{D(!1),r(P)},menuPlacement:f})})]})}},54735:(Z,R,e)=>{"use strict";e.d(R,{KU:()=>i});var n=e(74848),a=e(22803),s=e(49185),l=e(63142),o=e(35484),d=e(92807);const i=({width:p,height:h,legend:r,children:g})=>{const y=(0,l.$j)(),v=(0,l.of)(c),x={display:"flex",width:`${p}px`,height:`${h}px`},[f,u]=(0,s.A)();if(!r)return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{style:x,className:v.viz,children:g(p,h)})});let{placement:b,maxHeight:E="35%",maxWidth:D="60%"}=r.props;document.body.clientWidth<y.breakpoints.values.lg&&(b="bottom");let C=null;const P={};switch(b){case"bottom":x.flexDirection="column",P.maxHeight=E,u.height&&(C={width:p,height:h-u.height});break;case"right":x.flexDirection="row",P.maxWidth=D,u.width&&(C={width:p-u.width,height:h}),r.props.width&&(P.width=r.props.width,C={width:p-r.props.width,height:h});break}return C?.width===0&&(C.width=p),C?.height===0&&(C.height=h),(0,n.jsxs)("div",{style:x,children:[(0,n.jsx)("div",{className:v.viz,children:C&&g(C.width,C.height)}),(0,n.jsx)("div",{style:P,ref:f,children:(0,n.jsx)(d.P,{children:r})})]})},c=p=>({viz:(0,a.css)({flexGrow:2,borderRadius:p.shape.radius.default,"&:focus-visible":(0,o.getFocusStyles)(p)})}),m=({children:p})=>(0,n.jsx)(n.Fragment,{children:p});i.Legend=m},71479:(Z,R,e)=>{"use strict";e.d(R,{p:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(76637),o=e(63142);const d=s.memo(s.forwardRef(({color:c,className:m,gradient:p,lineStyle:h,...r},g)=>{const y=(0,o.$j)(),v=(0,o.of)(i);let x;if(p){const u=l.uf.get(p).getColors?.(y);u?.length?x=`linear-gradient(90deg, ${u.join(", ")})`:x=y.visualization.getColorByName("")}else x=c;let f;return h?.fill==="dot"&&!p?f={backgroundImage:`radial-gradient(circle at 2px 2px, ${c} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:h?.fill==="dash"&&!p?f={backgroundImage:`linear-gradient(to right, ${c} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:f={background:x,borderRadius:y.shape.radius.pill},(0,n.jsx)("div",{"data-testid":"series-icon",ref:g,className:(0,a.cx)(m,v.forcedColors,v.container),style:f,...r})})),i=c=>({container:(0,a.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,a.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});d.displayName="SeriesIcon"},4268:(Z,R,e)=>{"use strict";e.d(R,{t:()=>j});var n=e(74848),a=e(96540),s=e(57852),l=e(739),o=e(64400),d=e(49256),i=e(22803),c=e(63142),m=e(34950),p=e(5585),h=e(89123);const r=({items:W,itemRenderer:B,onLabelMouseOver:S,onLabelMouseOut:w,onLabelClick:N,placement:M,className:L,readonly:A})=>{const U=(0,c.of)(g);B||(B=V=>(0,n.jsx)(h.M,{item:V,onLabelClick:N,onLabelMouseOver:S,onLabelMouseOut:w,readonly:A}));const F=V=>`${V.getItemKey?V.getItemKey():V.label}`;switch(M){case"right":{const V=(K,G)=>(0,n.jsx)("span",{className:U.itemRight,children:B(K,G)});return(0,n.jsx)("div",{className:(0,i.cx)(U.rightWrapper,L),children:(0,n.jsx)(p.B,{items:W,renderItem:V,getItemKey:F})})}case"bottom":default:{const V=W.filter(H=>H.yAxis===1),K=W.filter(H=>H.yAxis!==1),G=(H,_)=>(0,n.jsx)("span",{className:U.itemBottom,children:B(H,_)});return(0,n.jsxs)("div",{className:(0,i.cx)(U.bottomWrapper,L),children:[V.length>0&&(0,n.jsx)("div",{className:U.section,children:(0,n.jsx)(m.c,{items:V,renderItem:G,getItemKey:F})}),K.length>0&&(0,n.jsx)("div",{className:(0,i.cx)(U.section,U.sectionRight),children:(0,n.jsx)(m.c,{items:K,renderItem:G,getItemKey:F})})]})}}};r.displayName="VizLegendList";const g=W=>{const B=(0,i.css)({paddingRight:"10px",display:"flex",fontSize:W.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:B,itemRight:(0,i.cx)(B,(0,i.css)({marginBottom:W.spacing(.5)})),rightWrapper:(0,i.css)({padding:W.spacing(.5)}),bottomWrapper:(0,i.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",padding:W.spacing(.5),gap:"15px 25px"}),section:(0,i.css)({display:"flex"}),sectionRight:(0,i.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var y=e(30703),v=e(55386),x=e(92745),f=e(35484),u=e(87);const b=({item:W,onLabelClick:B,onLabelMouseOver:S,onLabelMouseOut:w,className:N,readonly:M})=>{const L=(0,c.of)(E),A=(0,a.useCallback)(V=>{S&&S(W,V)},[W,S]),U=(0,a.useCallback)(V=>{w&&w(W,V)},[W,w]),F=(0,a.useCallback)(V=>{B&&B(W,V)},[W,B]);return(0,n.jsxs)("tr",{className:(0,i.cx)(L.row,N),children:[(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:L.itemWrapper,children:[(0,n.jsx)(u.R,{color:W.color,seriesName:W.fieldName??W.label,readonly:M,lineStyle:W.lineStyle}),(0,n.jsxs)("button",{disabled:M,type:"button",title:W.label,onBlur:U,onFocus:A,onMouseOver:A,onMouseOut:U,onClick:M?void 0:F,className:(0,i.cx)(L.label,W.disabled&&L.labelDisabled),children:[W.label," ",W.yAxis===2&&(0,n.jsx)("span",{className:L.yAxisLabel,children:(0,n.jsx)(x.x6,{i18nKey:"grafana-ui.viz-legend.right-axis-indicator",children:"(right y-axis)"})})]})]})}),W.getDisplayValues&&W.getDisplayValues().map((V,K)=>(0,n.jsx)("td",{className:L.value,children:(0,v.cN)(V)},`${V.title}-${K}`))]})};b.displayName="LegendTableItem";const E=W=>{const B=(0,f.hoverColor)(W.colors.background.primary,W);return{row:(0,i.css)({label:"LegendRow",fontSize:W.v1.typography.size.sm,borderBottom:`1px solid ${W.colors.border.weak}`,td:{padding:W.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:B}}),label:(0,i.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,i.css)({label:"LegendLabelDisabled",color:W.colors.text.disabled}),itemWrapper:(0,i.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,i.css)({textAlign:"right"}),yAxisLabel:(0,i.css)({color:W.colors.text.secondary})}},D="Name",C=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,P=({items:W,sortBy:B,sortDesc:S,itemRenderer:w,className:N,onToggleSort:M,onLabelClick:L,onLabelMouseOver:A,onLabelMouseOut:U,readonly:F,isSortable:V})=>{const K=(0,c.of)(T),G={};V&&(G[D]="");for(const H of W)if(H.getDisplayValues)for(const _ of H.getDisplayValues())G[_.title??"?"]=_.description??"";if(B!=null){let H=new Map;W.forEach(k=>{if(B!==D&&k.getDisplayValues){const J=k.getDisplayValues().find(Y=>Y.title===B),z=J==null||Number.isNaN(J.numeric)?-1/0:J.numeric;H.set(k,z)}});let _=S?-1:1;B===D?W.sort((k,J)=>_*C(k.label,J.label)):W.sort((k,J)=>{const z=H.get(k)??0,Y=H.get(J)??0;return _*(z-Y)})}return w||(w=(H,_)=>(0,n.jsx)(b,{item:H,onLabelClick:L,onLabelMouseOver:A,onLabelMouseOut:U,readonly:F},`${H.label}-${_}`)),(0,n.jsxs)("table",{className:(0,i.cx)(K.table,N),children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[!V&&(0,n.jsx)("th",{}),Object.keys(G).map(H=>(0,n.jsxs)("th",{title:G[H],className:(0,i.cx)(K.header,M&&K.headerSortable,V&&K.nameHeader,{[K.withIcon]:B===H}),onClick:()=>{M&&M(H)},children:[H,B===H&&(0,n.jsx)(y.I,{size:"xs",name:S?"angle-down":"angle-up"})]},H))]})}),(0,n.jsx)("tbody",{children:W.map(w)})]})},T=W=>({table:(0,i.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${W.colors.border.weak}`}}),header:(0,i.css)({color:W.colors.primary.text,fontWeight:W.typography.fontWeightMedium,borderBottom:`1px solid ${W.colors.border.weak}`,padding:W.spacing(.25,1,.25,1),fontSize:W.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,i.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,i.css)({paddingRight:"4px"}),headerSortable:(0,i.css)({cursor:"pointer"})});var O=e(22940);function I(W){return W.ctrlKey||W.metaKey||W.shiftKey?d.B.AppendToSelection:d.B.ToggleSelection}function j({items:W,thresholdItems:B,mappingItems:S,displayMode:w,sortBy:N,seriesVisibilityChangeBehavior:M=O.K.Isolate,sortDesc:L,onLabelClick:A,onToggleSort:U,placement:F,className:V,itemRenderer:K,readonly:G,isSortable:H}){const{eventBus:_,onToggleSeriesVisibility:k,onToggleLegendSort:J}=(0,o.d2)(),z=(0,a.useCallback)((q,te)=>{_?.publish({type:s.b_.type,payload:{raw:te,x:0,y:0,dataId:q.label}})},[_]),Y=(0,a.useCallback)((q,te)=>{_?.publish({type:s.ql.type,payload:{raw:te,x:0,y:0,dataId:q.label}})},[_]),X=(0,a.useCallback)((q,te)=>{A&&A(q,te),k&&k(q.fieldName??q.label,M===O.K.Hide?d.B.AppendToSelection:I(te))},[k,A,M]),Q=(0,a.useCallback)(q=>(0,n.jsx)(r,{className:V,placement:F,onLabelMouseOver:z,onLabelMouseOut:Y,onLabelClick:X,itemRenderer:K,readonly:G,items:q}),[V,F,z,Y,X,K,G]);switch(w){case l.lm.Table:return(0,n.jsx)(P,{className:V,items:W,placement:F,sortBy:N,sortDesc:L,onLabelClick:X,onToggleSort:U||J,onLabelMouseOver:z,onLabelMouseOut:Y,itemRenderer:K,readonly:G,isSortable:H});case l.lm.List:const q=B&&B.length>1,te=S&&S.length>0;return(0,n.jsxs)(n.Fragment,{children:[!q&&(!te||W.length>1)&&Q(W),q&&Q(B),te&&Q(S)]});default:return null}}j.displayName="VizLegend"},89123:(Z,R,e)=>{"use strict";e.d(R,{M:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(63142),d=e(87),i=e(2543),c=e(55386),m=e(34950);const p=({stats:y})=>{const v=(0,o.of)(h);return y.length===0?null:(0,n.jsx)(m.c,{className:v.list,items:y,renderItem:x=>(0,n.jsxs)("div",{className:v.item,title:x.description,children:[x.title&&`${(0,i.capitalize)(x.title)}:`," ",(0,c.cN)(x)]})})},h=()=>({list:(0,a.css)({flexGrow:1,textAlign:"right"}),item:(0,a.css)({marginLeft:"8px"})});p.displayName="VizLegendStatsList";const r=({item:y,onLabelClick:v,onLabelMouseOver:x,onLabelMouseOut:f,className:u,readonly:b})=>{const E=(0,o.of)(g),D=(0,s.useCallback)(T=>{x&&x(y,T)},[y,x]),C=(0,s.useCallback)(T=>{f&&f(y,T)},[y,f]),P=(0,s.useCallback)(T=>{v&&v(y,T)},[y,v]);return(0,n.jsxs)("div",{className:(0,a.cx)(E.itemWrapper,y.disabled&&E.itemDisabled,u),"data-testid":l.Tp.components.VizLegend.seriesName(y.label),children:[(0,n.jsx)(d.R,{seriesName:y.fieldName??y.label,color:y.color,gradient:y.gradient,readonly:b,lineStyle:y.lineStyle}),(0,n.jsx)("button",{disabled:b,type:"button",onBlur:C,onFocus:D,onMouseOver:D,onMouseOut:C,onClick:P,className:E.label,children:y.label}),y.getDisplayValues&&(0,n.jsx)(p,{stats:y.getDisplayValues()})]})};r.displayName="VizLegendListItem";const g=y=>({label:(0,a.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,a.css)({label:"LegendLabelDisabled",color:y.colors.text.disabled}),itemWrapper:(0,a.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,a.css)({textAlign:"right"}),yAxisLabel:(0,a.css)({color:y.v1.palette.gray2})})},87:(Z,R,e)=>{"use strict";e.d(R,{R:()=>d});var n=e(74848),a=e(96540),s=e(35427),l=e(64400),o=e(71479);const d=(0,a.memo)(({seriesName:i,color:c,gradient:m,readonly:p,lineStyle:h})=>{const{onSeriesColorChange:r}=(0,l.d2)(),g=(0,a.useCallback)(y=>r(i,y),[i,r]);return i&&r&&c&&!p?(0,n.jsx)(s.Dp,{color:c,onChange:g,enableNamedColors:!0,children:({ref:y,showColorPicker:v,hideColorPicker:x})=>(0,n.jsx)(o.p,{color:c,className:"pointer",ref:y,onClick:v,onMouseLeave:x,lineStyle:h})}):(0,n.jsx)(o.p,{color:c,gradient:m,lineStyle:h})});d.displayName="VizLegendSeriesIcon"},22940:(Z,R,e)=>{"use strict";e.d(R,{K:()=>n});var n=(a=>(a[a.Isolate=0]="Isolate",a[a.Hide=1]="Hide",a))(n||{})},33352:(Z,R,e)=>{"use strict";e.d(R,{S:()=>i});var n=e(74848),a=e(2543),s=e(96540),l=e(38919);const o=(m,p,h,r)=>{const g=d(m,p,r),y=d(p,m,r),v=Math.max(g,y);let x=Math.floor(m/v),f=Math.ceil(r/x);x=Math.ceil(r/f);const u=x-(x*f-r),b=m/u-h+h/u;return{width:m/x-h+h/x,height:p/f-h+h/f,widthOnLastRow:b,xCount:x,yCount:f}};function d(m,p,h){const r=Math.ceil(Math.sqrt(h*m/p));return Math.floor(r*p/m)*r<h?p/Math.ceil(r*p/m):m/r}class i extends s.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(p){super(p),this.state={values:p.getValues()}}componentDidUpdate(p){const{renderCounter:h,source:r}=this.props;(h!==p.renderCounter||r!==p.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:p,width:h,height:r}=this.props;return p===l.wV.Auto?h>r?l.wV.Vertical:l.wV.Horizontal:p}renderGrid(){const{renderValue:p,height:h,width:r,itemSpacing:g,getAlignmentFactors:y,orientation:v}=this.props,{values:x}=this.state,f=o(r,h,g,x.length),u=y?y(x,f.width,f.height):{};let b=0,E=0,D=[];for(let C=0;C<x.length;C++){const P=x[C],O=E===f.yCount-1?f.widthOnLastRow:f.width,I=f.height,j=b*O+g*b,W=E*I+g*E,B={position:"absolute",left:j,top:W,width:`${O}px`,height:`${I}px`};D.push((0,n.jsx)("div",{style:B,children:p({value:P,width:O,height:I,alignmentFactors:u,orientation:v,count:x.length})},C)),b++,b===f.xCount&&(b=0,E++)}return(0,n.jsx)("div",{style:{position:"relative"},children:D})}render(){const{renderValue:p,height:h,width:r,itemSpacing:g,getAlignmentFactors:y,autoGrid:v,orientation:x,maxVizHeight:f,minVizWidth:u,minVizHeight:b}=this.props,{values:E}=this.state;if(v&&x===l.wV.Auto)return this.renderGrid();const D={display:"flex"},C={display:"flex",overflow:`${u?"auto":"hidden"} ${b?"auto":"hidden"}`};let P=h,T=r;const O=this.getOrientation();switch(O){case l.wV.Horizontal:const j=(h+g)/E.length-g;C.flexDirection="column",C.height=`${h}px`,C.overflowX="hidden",C.scrollbarWidth="thin",D.marginBottom=`${g}px`,T=r,P=(0,a.clamp)(j,b??0,f??j);break;case l.wV.Vertical:C.flexDirection="row",C.justifyContent="space-between",C.overflowY="hidden",D.marginRight=`${g}px`,P=h,T=Math.max(r/E.length-g+g/E.length,u??0)}D.width=`${T}px`,D.height=`${P}px`;const I=y?y(E,T,P):{};return(0,n.jsx)("div",{style:C,children:E.map((j,W)=>(0,n.jsx)("div",{style:c(D,W,E.length),children:p({value:j,width:T,height:P,alignmentFactors:I,orientation:O,count:E.length})},W))})}}function c(m,p,h){return p===h-1?{...m,marginRight:0,marginBottom:0}:m}},63428:(Z,R,e)=>{"use strict";e.d(R,{g:()=>i,o:()=>c});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(71479);const d=m=>({icon:(0,a.css)({marginRight:m.spacing(1),verticalAlign:"middle"}),seriesTable:(0,a.css)({display:"table"}),seriesTableRow:(0,a.css)({display:"table-row",fontSize:m.typography.bodySmall.fontSize}),seriesTableCell:(0,a.css)({display:"table-cell"}),label:(0,a.css)({wordBreak:"break-all"}),value:(0,a.css)({paddingLeft:m.spacing(2),textAlign:"right"}),activeSeries:(0,a.css)({fontWeight:m.typography.fontWeightBold,color:m.colors.text.maxContrast}),timestamp:(0,a.css)({fontWeight:m.typography.fontWeightBold,fontSize:m.typography.bodySmall.fontSize})}),i=({color:m,label:p,value:h,isActive:r})=>{const g=(0,l.of)(d);return(0,n.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,a.cx)(g.seriesTableRow,r&&g.activeSeries),children:[m&&(0,n.jsx)("div",{className:g.seriesTableCell,children:(0,n.jsx)(o.p,{color:m,className:g.icon})}),p&&(0,n.jsx)("div",{className:(0,a.cx)(g.seriesTableCell,g.label),children:p}),h&&(0,n.jsx)("div",{className:(0,a.cx)(g.seriesTableCell,g.value),children:h})]})},c=({timestamp:m,series:p})=>{const h=(0,l.of)(d);return(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)("div",{className:h.timestamp,"aria-label":(0,s.t)("grafana-ui.viz-tooltip.timestamp","Timestamp"),children:m}),p.map((r,g)=>(0,n.jsx)(i,{isActive:r.isActive,label:r.label,color:r.color,value:r.value},`${r.label}-${g}`))]})}},71076:(Z,R,e)=>{"use strict";e.d(R,{o:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(52908),o=e(63142),d=e(35484),i=e(55302);const c=({position:{x:p,y:h},offset:{x:r,y:g},children:y,allowPointerEvents:v=!1,className:x,...f})=>{const u=(0,s.useRef)(null),[b,E]=(0,s.useState)({width:0,height:0}),{width:D,height:C}=(0,l.A)(),[P,T]=(0,s.useState)({x:p+r,y:h+g}),O=(0,s.useMemo)(()=>new ResizeObserver(j=>{for(let W of j){const B=Math.floor(W.contentRect.width+16),S=Math.floor(W.contentRect.height+2*8);(b.width!==B||b.height!==S)&&E({width:Math.min(B,D),height:Math.min(S,C)})}}),[b,D,C]);(0,s.useLayoutEffect)(()=>(u.current&&O.observe(u.current),()=>{O.disconnect()}),[O]),(0,s.useLayoutEffect)(()=>{if(u&&u.current){const{x:j,y:W}=(0,i.Ju)(p,h,b.width,b.height,r,g,D,C);T({x:j,y:W})}},[D,C,p,r,h,g,b]);const I=(0,o.of)(m);return(0,n.jsx)("div",{ref:u,style:{position:"fixed",left:0,pointerEvents:v?"auto":"none",top:0,transform:`translate(${P.x}px, ${P.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...f,className:(0,a.cx)(I.wrapper,x),children:y})};c.displayName="VizTooltipContainer";const m=p=>({wrapper:(0,a.css)((0,d.getTooltipContainerStyles)(p))})},39064:(Z,R,e)=>{"use strict";e.d(R,{S:()=>v});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(8779),i=e(45861),c=e(28134),m=e(30703),p=e(41654);const h="add-annotation-button";function r(f,u,b){return(D,C)=>{if(D.length===0)return;const P=D.find(T=>T.oneClick===!0);return P!=null?(0,n.jsx)("div",{className:C.dataLinks,children:(0,n.jsx)(p.B,{direction:"column",justifyContent:"flex-start",gap:.5,children:(0,n.jsxs)("span",{className:C.oneClickWrapper,children:[(0,n.jsx)(m.I,{name:"info-circle",size:"lg",className:C.infoIcon}),f(P.title)]})})}):(0,n.jsx)("div",{className:C.dataLinks,children:(0,n.jsx)(p.B,{direction:"column",justifyContent:"flex-start",gap:b,children:D.map((T,O)=>u(T,O,C))})})}}const g=r(f=>(0,n.jsxs)(l.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-click-to-navigate",children:["Click to open ",{linkTitle:f}]}),(f,u,b)=>(0,n.jsx)(c.R,{link:f,buttonProps:{className:b.dataLinkButton,fill:"text"}},u),.5),y=r(f=>(0,n.jsxs)(l.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-click-to-action",children:["Click to ",{actionTitle:f}]}),(f,u)=>(0,n.jsx)(d.r,{action:f,variant:"secondary"},u)),v=({dataLinks:f,actions:u=[],annotate:b})=>{const E=(0,o.of)(x),D=(0,s.useMemo)(()=>f.some(P=>P.oneClick===!0),[f]),C=(0,s.useMemo)(()=>u.some(P=>P.oneClick===!0),[u]);return(0,n.jsxs)("div",{className:E.wrapper,children:[!C&&g(f,E),!D&&y(u,E),!D&&!C&&b!=null&&(0,n.jsx)("div",{className:E.addAnnotations,children:(0,n.jsx)(i.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:h,onClick:b,children:(0,n.jsx)(l.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-add-annotation",children:"Add annotation"})})})]})},x=f=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:f.spacing(0)}),dataLinks:(0,a.css)({borderTop:`1px solid ${f.colors.border.medium}`,padding:f.spacing(1)}),addAnnotations:(0,a.css)({borderTop:`1px solid ${f.colors.border.medium}`,padding:f.spacing(1)}),dataLinkButton:(0,a.css)({cursor:"pointer","&:hover":{textDecoration:"underline",background:"none"},padding:0,height:"auto","& span":{whiteSpace:"normal",textAlign:"left"}}),oneClickWrapper:(0,a.css)({display:"flex",alignItems:"center"}),infoIcon:(0,a.css)({color:f.colors.primary.main,paddingRight:f.spacing(.5)})})},61048:(Z,R,e)=>{"use strict";e.d(R,{i:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i})=>{const c=(0,s.of)(o);return(0,n.jsx)("div",{className:(0,a.cx)(c.wrapper,i),children:d})},o=d=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",fontSize:d.typography.bodySmall.fontSize})})},55978:(Z,R,e)=>{"use strict";e.d(R,{Ev:()=>s,fX:()=>n,lJ:()=>a});var n=(l=>(l.series="series",l.value="value",l.hexagon="hexagon",l.pie_1_4="pie_1_4",l.pie_2_4="pie_2_4",l.pie_3_4="pie_3_4",l.marker_sm="marker_sm",l.marker_md="marker_md",l.marker_lg="marker_lg",l))(n||{}),a=(l=>(l.hidden="hidden",l.first="first",l.leading="leading",l.trailing="trailing",l))(a||{});const s="series"},55302:(Z,R,e)=>{"use strict";e.d(R,{Ju:()=>i,L$:()=>c,cp:()=>r});var n=e(95004),a=e(76637),s=e(55386),l=e(64394),o=e(739),d=e(55978);const i=(g=0,y=0,v=0,x=0,f=0,u=0,b=0,E=0)=>{let D=g,C=y;const P=Math.max(g+f+v-(b-f),0),T=Math.abs(Math.min(g-f-v-f,0)),O=P>0,I=T>0,j=Math.max(y+u+x-(E-u),0),W=Math.abs(Math.min(y-u-x-u,0)),B=j>0,S=W>0;return O&&I?D=P>T?f:b-f-v:O?D=g-f-v:D=g+f,B&&S?C=j>W?u:E-u-x:B?C=y-u-x:C=y+u,{x:D,y:C}},c=(g,y)=>{switch(g){case d.fX.value:return y.value;case d.fX.hexagon:return y.hexagon;case d.fX.pie_1_4:return y.pie_1_4;case d.fX.pie_2_4:return y.pie_2_4;case d.fX.pie_3_4:return y.pie_3_4;case d.fX.marker_sm:return y.marker_sm;case d.fX.marker_md:return y.marker_md;case d.fX.marker_lg:return y.marker_lg;default:return y.value}},m=(g,y)=>g.numeric-y.numeric,p=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),h=(g,y)=>p.compare(`${g.value}`,`${y.value}`),r=(g,y,v,x,f,u,b=D=>!0,E=!1)=>{let D=[],C=!0;for(let P=0;P<g.length;P++){const T=g[P];if(T===y||T.type===n.PU.time||!b(T)||T.config.custom?.hideFrom?.tooltip||T.config.custom?.hideFrom?.viz||f===o.$N.Single&&x!==P)continue;let O=v[P];if(O==null)continue;T.type===n.PU.number||T.type===n.PU.boolean||T.type===n.PU.enum||(C=!1);const I=g[P].values[O];if(I==null&&T.config.noValue==null||E&&I===0)continue;const j=T.display(I),W=Number.isNaN(j.numeric)?u===o.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:j.numeric,B=(0,a.Qi)(T);let S=d.fX.series,w=d.lJ.first;B.isByValue&&(S=d.fX.value,w=d.lJ.trailing),D.push({label:T.state?.displayName??T.name,value:(0,s.cN)(j),color:j.color??l.F,colorIndicator:S,colorPlacement:w,isActive:f===o.$N.Multi&&x===P,numeric:W,lineStyle:T.config.custom?.lineStyle})}if(u!==o.xB.None&&D.length>1){const P=C?m:h,T=u===o.xB.Descending?-1:1;D.sort((O,I)=>T*P(O,I))}return D}},92790:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>c});var n=e(74848),a=e(96540),s=e(36613),l=e(36192);function o(m,p){return p.width===m.width&&p.height===m.height}function d(m,p){return p.data===m.data}function i(m,p){return p.config===m.config}class c extends a.Component{constructor(p){super(p),this.plotContainer=(0,a.createRef)(),this.plotCanvasBBox=(0,a.createRef)(),this.plotInstance=null}reinitPlot(){let{width:p,height:h,plotRef:r}=this.props;if(this.plotInstance?.destroy(),p===0&&h===0)return;this.props.config.addHook("setSize",v=>{v.over});const g={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,l.uY)("UPlot",!1,"Reinitializing plot",g);const y=new s.A(g,this.props.data,this.plotContainer.current);r&&r(y),this.plotInstance=y}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.plotInstance?.destroy()}componentDidUpdate(p){o(p,this.props)?i(p,this.props)?d(p,this.props)||this.plotInstance?.setData(this.props.data):this.reinitPlot():this.plotInstance?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},61897:(Z,R,e)=>{"use strict";e.d(R,{$:()=>h,t:()=>p});var n=e(74848),a=e(96540),s=e(16515),l=e(76637),o=e(739),d=e(63142),i=e(54735),c=e(4268),m=e(36192);function p(r,g){return r.getSeries().some(y=>{const v=y.props.dataFrameFieldIndex;if(!v)return!1;const x=g[v.frameIndex]?.fields[v.fieldIndex];return!(!x||x.config.custom?.hideFrom?.legend)})}const h=(0,a.memo)(({data:r,config:g,placement:y,calcs:v,displayMode:x,...f})=>{const u=(0,d.$j)(),b=g.getSeries().map(E=>{const D=E.props,C=D.dataFrameFieldIndex,P=g.getAxisPlacement(E.props.scaleKey);if(!C)return;const T=r[C.frameIndex]?.fields[C.fieldIndex];if(!T||T.config.custom?.hideFrom?.legend)return;const O=(0,s.Ct)(T,r[C.frameIndex],r),j=(0,l.lz)(T,u).color;return{disabled:!(D.show??!0),fieldIndex:C,color:j,label:O,yAxis:P===o.vM.Left||P===o.vM.Bottom?1:2,getDisplayValues:()=>(0,m.UO)(v,T,u),getItemKey:()=>`${O}-${C.frameIndex}-${C.fieldIndex}`,lineStyle:D.lineStyle}}).filter(E=>E!==void 0);return(0,n.jsx)(i.KU.Legend,{placement:y,...f,children:(0,n.jsx)(c.t,{placement:y,items:b,displayMode:x,sortBy:f.sortBy,sortDesc:f.sortDesc,isSortable:!0})})});h.displayName="PlotLegend"},99555:(Z,R,e)=>{"use strict";e.d(R,{P:()=>s,t:()=>l});var n=e(92745),a=e(739);const s=()=>({drawStyle:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-lines","Lines"),value:a.GR.Line},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-bars","Bars"),value:a.GR.Bars},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-points","Points"),value:a.GR.Points}],lineInterpolation:[{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-linear","Linear"),value:a.dx.Linear,icon:"gf-interpolation-linear"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-smooth","Smooth"),value:a.dx.Smooth,icon:"gf-interpolation-smooth"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-step-before","Step before"),value:a.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-step-after","Step after"),value:a.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-before","Before"),value:a.Nj.Before,icon:"gf-bar-alignment-before"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-center","Center"),value:a.Nj.Center,icon:"gf-bar-alignment-center"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-after","After"),value:a.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-auto","Auto"),value:a.yL.Auto,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.description-auto","Show points when the density is low")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-always","Always"),value:a.yL.Always},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-never","Never"),value:a.yL.Never}],axisPlacement:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-auto","Auto"),value:a.vM.Auto,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.description-auto","First field on the left, everything else on the right")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-left","Left"),value:a.vM.Left},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-right","Right"),value:a.vM.Right},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-hidden","Hidden"),value:a.vM.Hidden}],fillGradient:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-none","None"),value:a.on.None},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-opacity","Opacity"),value:a.on.Opacity,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-opacity","Enable fill opacity gradient")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-hue","Hue"),value:a.on.Hue,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-hue","Small color hue gradient")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-scheme","Scheme"),value:a.on.Scheme,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-scheme","Use color scheme to define gradient")}],stacking:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-off","Off"),value:a.gs.None},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-normal","Normal"),value:a.gs.Normal},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-100","100%"),value:a.gs.Percent}],thresholdsDisplayModes:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-off","Off"),value:a.Ly.Off},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-lines","As lines"),value:a.Ly.Line},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-dashed-lines","As lines (dashed)"),value:a.Ly.Dashed},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions","As filled regions"),value:a.Ly.Area},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions-and-lines","As filled regions and lines"),value:a.Ly.LineAndArea},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions-and-dashed-lines","As filled regions and lines (dashed)"),value:a.Ly.DashedAndArea}]}),l=s()},23414:(Z,R,e)=>{"use strict";e.d(R,{Zj:()=>f,pi:()=>m,zH:()=>x});var n=e(55386),a=e(79243),s=e(5421),l=e(80011),o=e(739),d=e(53568),i=e(62748),c=e(42073);const m=12,p=150,h=30,r=15,g=40,y=18,v=8;class x extends i.R{merge(P){this.props.size=(0,c.Y)("max",this.props.size,P.size),this.props.label||(this.props.label=P.label),this.props.placement===o.vM.Auto&&(this.props.placement=P.placement)}getConfig(){let{scaleKey:P,label:T,show:O=!0,placement:I=o.vM.Auto,grid:j={show:!0},ticks:W,space:B,filter:S,gap:w=5,formatValue:N,splits:M,values:L,incrs:A,isTime:U,timeZone:F,theme:V,tickLabelRotation:K,size:G,color:H,border:_,decimals:k,distr:J=o.L4.Linear}=this.props;const z=`${m}px ${V.typography.fontFamily}`,Y=V.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,n.j9)(P)&&(M=[0,1]),k===0&&J===o.L4.Linear&&(S=(Q,q)=>q.map(te=>Number.isInteger(te)?te:null));let X={scale:P,show:O,stroke:H??V.colors.text.primary,side:D(I),font:z,size:G??((Q,q,te)=>E(Q,q,te)),rotate:K,gap:w,labelGap:0,grid:{show:j.show,stroke:Y,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:_?.show?H??V.colors.text.primary:Y,width:1/devicePixelRatio,size:4},W),splits:M,values:L,space:B??((Q,q,te,ne,se)=>b(Q,q,te,ne,se,N)),filter:S,incrs:A};return _?.show&&(X.border={stroke:H??V.colors.text.primary,width:1/devicePixelRatio,..._}),T!=null&&T.length>0&&(X.label=T,X.labelSize=m+v,X.labelFont=z,X.labelGap=v),L?X.values=L:U?X.values=u:N&&(X.values=(Q,q,te,ne,se)=>{let ue=(0,a.E)((0,a.h)(se,6));return q.map(de=>de==null?null:N(de,ue>0?ue:void 0))}),X.timeZone=F,X}}const f={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function u(C,P,T,O,I){const j=C.axes[T],W="timeZone"in j&&typeof j.timeZone=="string"?j.timeZone:void 0,B=C.scales.x,S=(B?.max??0)-(B?.min??0),w=Math.round(f.year/f.day)*f.day,N=Math.round(I/f.day)*f.day;let M=s.WC.interval.year;return I<f.second?M=s.WC.interval.millisecond:I<=f.minute?M=s.WC.interval.second:S<=f.day?M=s.WC.interval.minute:I<=f.day?M=s.WC.interval.hour:S<f.year?M=s.WC.interval.day:N===w?M=s.WC.interval.year:I<=f.year&&(M=s.WC.interval.month),P.map(L=>L==null?"":(0,l.LE)(L,{format:M,timeZone:W}))}function b(C,P,T,O,I,j){const W=C.axes[P],B=C.scales[W.scale];if(W.side!==2||!B)return I<=p?r:h;const S=I/g,w=(O-T)/S,N=Math.max(Math.abs(T),Math.abs(O));let M="";if(B.time)M=u(C,[N],P,g,w)[0];else if(j!=null)M=j(N);else return g;return(0,d.kD)(M,m).width+y}function E(C,P,T){const O=C.axes[T];let I=O.ticks.size;if(O.side===2)I+=O.gap+m;else if(P?.length){let j=P.reduce((B,S)=>Math.max(B,(0,d.kD)(S,m).width),0);const W=Math.min(C.width*.4,j);I+=O.gap+O.labelGap+W}return Math.ceil(I)}function D(C){switch(C){case o.vM.Top:return 0;case o.vM.Right:return 1;case o.vM.Bottom:return 2;case o.vM.Left:}return 3}},47276:(Z,R,e)=>{"use strict";e.d(R,{e:()=>E});var n=e(2543),a=e(36613),s=e(22592),l=e(62717),o=e(739),d=e(36192),i=e(23414),c=e(42073),m=e(64394),p=e(6773),h=e(62748),r=e(66650);class g extends h.R{getConfig(){const{facets:C,drawStyle:P,pathBuilder:T,pointsBuilder:O,pointsFilter:I,lineInterpolation:j,lineWidth:W,lineStyle:B,barAlignment:S,barWidthFactor:w,barMaxWidth:N,showPoints:M,pointSize:L,scaleKey:A,pxAlign:U,spanNulls:F,show:V=!0}=this.props;let K={},G=this.getLineColor();K.stroke=G,K.width=W,B&&B.fill!=="solid"&&(B.fill==="dot"&&(K.cap="round"),K.dash=B.dash??[10,10]),T!=null?K.paths=T:P===o.GR.Points?K.paths=()=>null:P!=null&&(K.paths=(k,J,z,Y)=>v(P,j,S,w,N)(k,J,z,Y));const H=typeof G=="string"?G:(k,J)=>k.series[J]._stroke,_={points:{stroke:H,fill:H,size:!L||L<W?void 0:L,filter:I}};return O!=null?_.points.show=O:P===o.GR.Points?_.points.show=!0:M===o.yL.Auto?P===o.GR.Bars&&(_.points.show=!1):M===o.yL.Never?_.points.show=!1:M===o.yL.Always&&(_.points.show=!0),{scale:A,facets:C,spanGaps:typeof F=="number"?!1:F,value:()=>"",pxAlign:U,show:V,fill:this.getFill(),...K,..._}}getLineColor(){const{lineColor:C,gradientMode:P,colorMode:T,thresholds:O,theme:I,hardMin:j,hardMax:W,softMin:B,softMax:S,dynamicSeriesColor:w}=this.props;return P===o.on.None&&w?(N,M)=>w(M)??C??m.F:P===o.on.Scheme&&T?.id!==m.Y.Fixed?(0,r.pl)(1,I,T,O,j,W,B,S):P===o.on.Hue?(0,r.B5)(C??m.F,1,I):C??m.F}getFill(){const{lineColor:C,fillColor:P,gradientMode:T,fillOpacity:O,colorMode:I,thresholds:j,theme:W,hardMin:B,hardMax:S,softMin:w,softMax:N,dynamicSeriesColor:M}=this.props;if(P)return P;const L=T??o.on.None,A=(O??0)/100;if(L===o.on.None&&M&&A>0)return(U,F)=>{let V=U.series[F]._stroke;return p.MV.alpha(V??"",A)};switch(L){case o.on.Opacity:return(0,r.WO)(P??C,A);case o.on.Hue:return(0,r.B5)(P??C,A,W);case o.on.Scheme:if(I?.id!==m.Y.Fixed)return(0,r.pl)(A,W,I,j,B,S,w,N);default:if(A>0)return p.MV.alpha(C??"",A)}}}let y;function v(D,C,P=o.Nj.Center,T=.6,O=200){const I=a.A.paths;if(y||(y={linear:I.linear(),smooth:I.spline(),stepBefore:I.stepped({align:-1}),stepAfter:I.stepped({align:1})}),D===o.GR.Bars){let j=`bars|${P}|${T}|${O}`;return y[j]||(y[j]=I.bars({size:[T,O],align:P})),y[j]}else if(D===o.GR.Line){if(C===o.dx.StepBefore)return y.stepBefore;if(C===o.dx.StepAfter)return y.stepAfter;if(C===o.dx.Smooth)return y.smooth}return y.linear}var x=e(84140),f=e(33553);function u(D){const C=D.config.mode===o.Ly.Dashed||D.config.mode===o.Ly.DashedAndArea?[10,10]:[];function P(M,L,A,U){let F=M.ctx,V=0;for(let K=0;K<A.length;K++)if(A[K].color==="transparent"){V=K;break}F.lineWidth=2,F.setLineDash(C);for(let K=1;K<A.length;K++){const G=A[K];let H;V>=K&&K>0?H=(0,x.A)(U.visualization.getColorByName(A[K-1].color)):H=(0,x.A)(U.visualization.getColorByName(G.color)),H.getAlpha()===1&&H.setAlpha(.7);const _=M.scales.x.ori===o.Lt.Horizontal,k=M.valToPos(G.value,L,!0);let J=Math.round(_?M.bbox.left:k),z=Math.round(_?k:M.bbox.top),Y=Math.round(_?M.bbox.left+M.bbox.width:k),X=Math.round(_?k:M.bbox.top+M.bbox.height);F.beginPath(),F.moveTo(J,z),F.lineTo(Y,X),F.strokeStyle=H.toString(),F.stroke()}}function T(M,L,A,U){let F=M.ctx,V=(0,r.Z8)(M,L,A.map(K=>{let G=(0,x.A)(U.visualization.getColorByName(K.color));return G.getAlpha()===1&&G.setAlpha(.15),[K.value,G.toString()]}),!0);F.fillStyle=V,F.fillRect(M.bbox.left,M.bbox.top,M.bbox.width,M.bbox.height)}const{scaleKey:O,thresholds:I,theme:j,config:W,hardMin:B,hardMax:S,softMin:w,softMax:N}=D;return M=>{const L=M.ctx,{min:A,max:U}=M.scales.x,{min:F,max:V}=M.scales[O];if(A==null||U==null||F==null||V==null)return;let{steps:K,mode:G}=I;if(G===f.O.Percentage){let[H,_]=(0,r.EJ)(M,O,B,S,w,N),k=_-H;K=K.map(J=>({...J,value:H+k*(J.value/100)}))}switch(L.save(),W.mode){case o.Ly.Line:case o.Ly.Dashed:P(M,O,K,j);break;case o.Ly.Area:T(M,O,K,j);break;case o.Ly.LineAndArea:case o.Ly.DashedAndArea:T(M,O,K,j),P(M,O,K,j)}L.restore()}}const b={drag:{setScale:!1},points:{size:(D,C)=>D.series[C].points.size*2,width:(D,C,P)=>P/4},focus:{prox:30}};class E{constructor(C=s.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=P=>{let T=new Date(P);return this.tz?a.A.tzDate(T,this.tz):T},this.tz=(0,l.QZ)(C,Date.now())?.ianaName}addHook(C,P){(0,d.uY)("UPlotConfigBuilder",!1,"addHook",C),this.hooks[C]||(this.hooks[C]=[]),this.hooks[C].push(P)}addThresholds(C){this.thresholds[C.scaleKey]||(this.thresholds[C.scaleKey]=C,this.addHook("drawClear",u(C)))}addAxis(C){C.placement=C.placement??o.vM.Auto,C.grid=C.grid??{};let P=C.scaleKey;if(P==="x"&&(P+=C.timeZone??""),this.axes[P]){this.axes[P].merge(C);return}C.placement===o.vM.Auto&&(C.placement=this.hasLeftAxis?o.vM.Right:o.vM.Left),C.placement===o.vM.Left&&(this.hasLeftAxis=!0),C.placement===o.vM.Hidden&&(C.grid.show=!1,C.size=0),this.axes[P]=new i.zH(C)}getAxisPlacement(C){return this.axes[C]?.props.placement??o.vM.Left}setCursor(C){this.cursor=(0,n.merge)({},this.cursor,C)}setMode(C){this.mode=C}setSelect(C){this.select=C}addSeries(C){this.series.push(new g(C))}getSeries(){return this.series}addScale(C){const P=this.scales.find(T=>T.props.scaleKey===C.scaleKey);if(P){P.merge(C);return}this.scales.push(new c.G(C))}addBand(C){this.bands.push(C)}setStackingGroups(C){this.stackingGroups=C}getStackingGroups(){return this.stackingGroups}setPrepData(C){this.prepData=P=>(this.frames=P,C(P,this.getStackingGroups()))}setPadding(C){this.padding=C}getConfig(){if(this.cachedConfig)return this.cachedConfig;const C={...d.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};C.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(T=>T.getConfig()),C.series=[...C.series,...this.series.map(T=>T.getConfig())],C.scales=this.scales.reduce((T,O)=>({...T,...O.getConfig()}),{}),C.hooks=this.hooks,C.select=this.select;const P=(T="")=>(O,I)=>{let j=O.series[I].points._stroke;if(typeof j!="string"){let W=this.frames[0].fields[I];j=W.display(W.values[O.cursor.idxs[I]]).color}return j+T};return C.cursor=(0,n.merge)({},b,{points:{stroke:P("80"),fill:P()}},this.cursor),C.tzDate=this.tzDate,Array.isArray(this.padding)&&(C.padding=this.padding),this.stackingGroups.forEach(T=>{(0,d.Tz)(T).forEach(O=>{this.addBand(O)})}),this.bands.length&&(C.bands=this.bands),this.cachedConfig=C,C}ensureNonOverlappingAxes(C){const P=C.find(I=>I.props.scaleKey==="x"),T=C.filter(I=>I.props.grid?.show===void 0),O=T.findIndex(I=>I.props.placement===o.vM.Left||I.props.placement===o.vM.Right||I.props.placement===o.vM.Bottom&&I!==P);for(let I=0;I<T.length;I++)T[I]===P||I===O?T[I].props.grid.show=!0:T[I].props.grid.show=!1;return C}}},42073:(Z,R,e)=>{"use strict";e.d(R,{G:()=>d,Y:()=>i});var n=e(36613),a=e(74261),s=e(55386),l=e(739),o=e(62748);class d extends o.R{merge(m){this.props.min=i("min",this.props.min,m.min),this.props.max=i("max",this.props.max,m.max)}getConfig(){let{isTime:m,auto:p,scaleKey:h,min:r,max:g,softMin:y,softMax:v,range:x,direction:f,orientation:u,centeredZero:b,decimals:E,stackingMode:D}=this.props;D===l.gs.Percent&&(r==null&&y==null&&(y=0),g==null&&v==null&&(v=1));const C=this.props.distribution,P=m?{}:{distr:C===l.L4.Symlog?4:C===l.L4.Log?3:C===l.L4.Ordinal?2:1,log:C===l.L4.Log||C===l.L4.Symlog?this.props.log??2:void 0,asinh:C===l.L4.Symlog?this.props.linearThreshold??1:void 0};if(C===l.L4.Log){let w=this.props.log,N=w===2?Math.log2:Math.log10;r!=null&&(r<=0?r=null:r=w**Math.floor(N(r))),g!=null&&(g<=0?g=null:g=w**Math.ceil(N(g))),y!=null&&(y<=0?y=null:y=w**Math.floor(N(y))),v!=null&&(v<=0?v=null:v=w**Math.ceil(N(v)))}let T=y==null?3:1,O=v==null?3:1;const I={min:{pad:.1,hard:r??-1/0,soft:y||0,mode:T},max:{pad:.1,hard:g??1/0,soft:v||0,mode:O}};let j=y==null&&r!=null,W=v==null&&g!=null,B=j&&W;const S=(w,N,M,L)=>{const A=w.scales[L];let U=[N,M];if(!B&&N==null&&M==null)return U;let F=A.log??10;if(A.distr===1||A.distr===2||A.distr===4){if(b){let V=Math.abs(N),K=Math.abs(M),G=Math.max(V,K);G===0&&(G=80),N=-G,M=G}A.distr===4?U=n.A.rangeAsinh(N,M,F,!0):U=n.A.rangeNum(j?r:N,W?g:M,I)}else A.distr===3&&(U=n.A.rangeLog(r??N,g??M,F,!0));if(E===0)if(A.distr===1||A.distr===2)U[0]=(0,a.rs)(U[0],1),U[1]=(0,a.Uh)(U[1],1);else if(A.distr===3){let V=A.log===2?Math.log2:Math.log10;if(U[0]<=1)U[0]=1;else{let G=Math.floor(V(U[0]));U[0]=F**G}let K=Math.ceil(V(U[1]));U[1]=F**K,U[0]===U[1]&&(U[1]*=F)}else A.distr===4&&(U[0]=(0,a.rs)(U[0],1),U[1]=(0,a.Uh)(U[1],1));return(A.distr===1||A.distr===4)&&(j&&(U[0]=r),W&&(U[1]=g)),U[0]>=U[1]&&(U[0]=A.distr===3?1:0,U[1]=100),U};return p??=!m&&!B,(0,s.j9)(h)&&(p=!1,x=[0,1]),{[h]:{time:m,auto:p,range:x??S,dir:f,ori:u,...P}}}}function i(c,m,p){const h=m!=null,r=p!=null;return h?r?c==="min"?m<p?m:p:m>p?m:p:m:p}},66650:(Z,R,e)=>{"use strict";e.d(R,{B5:()=>m,EJ:()=>g,WO:()=>c,Z8:()=>h,pl:()=>v});var n=e(84140),a=e(6773),s=e(64394),l=e(33553),o=e(739),d=e(53568);function i(x,f,u){let b=0,E=0,D=0,C=0;return x===3?(E=f.top,C=f.top+f.height):x===2?(b=f.left+f.width,D=f.left):x===1?(E=f.top+f.height,C=f.top):x===0&&(b=f.left,D=f.left+f.width),u.createLinearGradient(b,E,D,C)}function c(x,f){return(u,b)=>{const E=(0,d.Yc)(),D=i(u.scales.x.ori===o.Lt.Horizontal?3:2,u.bbox,E);return D.addColorStop(0,a.MV.alpha(x,f)),D.addColorStop(1,a.MV.alpha(x,0)),D}}function m(x,f,u){return(b,E)=>{const D=(0,d.Yc)(),C=i(b.scales.x.ori===o.Lt.Horizontal?3:2,b.bbox,D),P=(0,n.A)(x).spin(-25).darken(5),T=(0,n.A)(x).saturate(20).spin(20).brighten(10);return u.isDark?(C.addColorStop(0,T.lighten(10).setAlpha(f).toString()),C.addColorStop(1,P.darken(10).setAlpha(f).toString())):(C.addColorStop(0,T.lighten(10).setAlpha(f).toString()),C.addColorStop(1,P.setAlpha(f).toString())),C}}var p=(x=>(x[x.Right=0]="Right",x[x.Up=1]="Up",x[x.Left=2]="Left",x[x.Down=3]="Down",x))(p||{});function h(x,f,u,b=!1){let E=x.scales[f],D=null,C=null;for(let A=0;A<u.length;A++){let U=u[A][0];if((U<=E.min||D==null)&&(D=A),C=A,U>=E.max)break}if(D===C)return u[D][1];let P=u[D][0],T=u[C][0];P===-1/0&&(P=E.min),T===1/0&&(T=E.max);let O=Math.round(x.valToPos(P,f,!0)),I=Math.round(x.valToPos(T,f,!0)),j=O-I;if(j===0)return u[C][1];let W,B,S,w;x.scales.x.ori===o.Lt.Horizontal?(W=S=0,B=O,w=I):(B=w=0,W=O,S=I);let M=(0,d.Yc)().createLinearGradient(W,B,S,w),L;for(let A=D;A<=C;A++){let U=u[A],F=A===D?O:A===C?I:Math.round(x.valToPos(U[0],f,!0)),V=(O-F)/j;b&&A>D&&M.addColorStop(V,L),M.addColorStop(V,L=U[1])}return M}function r(x,f){let u=x.scales[f],b=1/0,E=-1/0;return x.series.forEach((D,C)=>{if(D.show&&D.scale===f)if(D.min==null){let P=x.data[C];for(let T=0;T<P.length;T++)P[T]!=null&&(b=Math.min(b,P[T]),E=Math.max(E,P[T]))}else b=Math.min(b,D.min),E=Math.max(E,D.max)}),E===b&&(b=u.min,E=u.max),[b,E]}function g(x,f,u,b,E,D){let C=u??E??null,P=b??D??null;if(C==null||P==null){let[T,O]=r(x,f);C=C??T??0,P=P??O??100}return[C,P]}function y(x){return x==="transparent"||x[0]==="#"&&x.slice(-2)==="00"}function v(x,f,u,b,E,D,C,P){if(!u)throw Error("Missing colorMode required for color scheme gradients");if(!b)throw Error("Missing thresholds required for color scheme gradients");return(T,O)=>{let I=T.series[O].scale,j="";if(u.id===s.Y.Thresholds)if(b.mode===l.O.Absolute){const W=b.steps.map(B=>[B.value,y(B.color)?"#0000":a.MV.alpha(f.visualization.getColorByName(B.color),x)]);j=h(T,I,W,!0)}else{const[W,B]=g(T,I,E,D,C,P),S=B-W,w=b.steps.map(N=>[W+S*(N.value/100),a.MV.alpha(f.visualization.getColorByName(N.color),x)]);j=h(T,I,w,!0)}else if(u.getColors){const W=u.getColors(f),[B,S]=g(T,I,E,D,C,P),w=S-B,N=W.map((M,L)=>[B+w*(L/(W.length-1)),a.MV.alpha(f.visualization.getColorByName(M),x)]);j=h(T,I,N,!1)}return j}}},7515:(Z,R,e)=>{"use strict";e.d(R,{a:()=>d});var n=e(74848),a=e(96540),s=e(1604),l=e(73858),o=e(16477);function d({id:i,events:c,renderEventMarker:m,mapEventToXYCoords:p,config:h}){const r=(0,a.useRef)(),[g,y]=(0,a.useState)(0),v=(0,s.A)();(0,a.useLayoutEffect)(()=>{h.addHook("init",f=>{r.current=f}),h.addHook("draw",()=>{v()&&y(f=>f+1)})},[h,y]);const x=(0,a.useMemo)(()=>{const f=[];if(!r.current||c.length===0)return f;for(let u=0;u<c.length;u++){const b=c[u];for(let E=0;E<b.length;E++){const D=p(b,{fieldIndex:E,frameIndex:u});D&&f.push((0,a.createElement)(l.p,{...D,key:`${i}-marker-${u}-${E}`},m(b,{fieldIndex:E,frameIndex:u})))}}return(0,n.jsx)(n.Fragment,{children:f})},[c,m,g]);return r.current?(0,n.jsx)(o._,{left:r.current.bbox.left/window.devicePixelRatio,top:r.current.bbox.top/window.devicePixelRatio,children:x}):null}},73858:(Z,R,e)=>{"use strict";e.d(R,{p:()=>a});var n=e(74848);const a=({x:s,y:l,children:o})=>(0,n.jsx)("div",{style:{position:"absolute",top:`${l}px`,left:`${s}px`},children:o})},16477:(Z,R,e)=>{"use strict";e.d(R,{_:()=>l});var n=e(74848),a=e(22803),s=e(96540);const l=({children:o,left:d,top:i})=>{const c=(0,s.useMemo)(()=>(0,a.css)({position:"absolute",overflow:"visible",left:`${d}px`,top:`${i}px`}),[d,i]);return(0,n.jsx)("div",{className:c,children:o})}},70332:(Z,R,e)=>{"use strict";e.d(R,{M:()=>s});var n=e(739),a=e(62748);function s(o,d){const i="na",c=`${o.min!==void 0?o.min:i}-${o.max!==void 0?o.max:i}`,m=`${o.custom?.axisSoftMin!==void 0?o.custom.axisSoftMin:i}-${o.custom?.axisSoftMax!==void 0?o.custom.axisSoftMax:i}`,p=`${o.custom?.axisPlacement!==void 0?o.custom?.axisPlacement:n.vM.Auto}`,h=o.unit??a.s,r=o.custom?.scaleDistribution?l(o.custom.scaleDistribution):n.L4.Linear,g=o.custom?.axisLabel?o.custom.axisLabel:i;return`${h}/${c}/${m}/${p}/${r}/${g}/${d}`}function l(o){return o.type===n.L4.Log?`${o.type}${o.log}`:o.type}},84522:(Z,R,e)=>{"use strict";e.d(R,{J:()=>o});var n=e(74848),a=e(22803),s=e(76319),l=e(63142);const o=({onClick:i,"aria-label":c,style:m})=>{const p=(0,l.of)(d);return(0,n.jsx)(s.K,{"aria-label":c??"Close",className:p,name:"times",onClick:i,style:m})},d=i=>(0,a.css)({position:"absolute",margin:"0px",right:5,top:6})},18667:(Z,R,e)=>{"use strict";e.d(R,{K:()=>c});var n=e(2543),a=e.n(n),s=e(96540),l=e(64423),o=e(99165),d=e(57852),i=e(32899);const c=({config:m,eventBus:p,frame:h})=>{const r=(0,s.useRef)(h);return r.current=h,(0,s.useLayoutEffect)(()=>{let g=null;const y={point:{time:null},data:r.current};m.addHook("init",C=>{g=C});let v=null;m.addHook("setSeries",(C,P)=>{v=P}),m.addHook("setLegend",()=>{if(!(g.cursor.event==null)){let P=g.cursor.idxs.find(T=>T!=null);if(P==null)D();else{let T=P,O=v,I=g.data[0]??g.data[1][0];y.point.time=I[T],y.rowIndex=T??void 0,y.columnIndex=O??void 0,y.data=r.current;let j=g.cursor.top;y.point.panelRelY=j===0?.001:j>0?j/g.rect.height:1,E()}}});function x(C){const P=C.payload?.point?.time;if(P){const T=g.valToPos(P,"x");g.setCursor({left:T,top:g.rect.height/2})}}const f=new l.yU,u=new d.b_(y).setTags(["uplot"]),b=new d.ql().setTags(["uplot"]);let E=(0,n.throttle)(()=>{p.publish(u)},100),D=(0,n.throttle)(()=>{p.publish(b)},100);return f.add(p.getStream(d.b_).subscribe({next:C=>{p===C.origin||C.tags?.has("uplot")||x(C)}})),f.add(p.getStream(i.kb).subscribe({next:C=>x(C)})),f.add(p.getStream(d.ql).pipe((0,o.c)(50)).subscribe({next:C=>{p===C.origin||C.tags?.has("uplot")||g.cursor._lock||g.setCursor({left:-10,top:-10})}})),()=>{f.unsubscribe()}},[m]),null}},93630:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>c});var n=e(2543),a=e.n(n),s=e(96540);const l=.1,o=2,d=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),i=m=>{let p=m.root,h=new Set,r=null,g=null;if(!p)return;p.tabIndex=0;const y=(D,C)=>{const{cursor:P}=m;if(P.left===void 0||P.top===void 0)return;const{width:T,height:O}=m.over.style,[I,j]=[Math.floor(parseFloat(T)),Math.floor(parseFloat(O))];m.setCursor({left:(0,n.clamp)(P.left+D,0,I),top:(0,n.clamp)(P.top+C,0,j)})},v=D=>{if(h.size===0||!m){g=null;return}const T=(D-(g??D))*l;let O=0,I=0;h.has("ArrowUp")&&(I-=T),h.has("ArrowDown")&&(I+=T),h.has("ArrowLeft")&&(O-=T),h.has("ArrowRight")&&(O+=T),h.has("Shift")&&(O*=o,I*=o),y(O,I);const{cursor:j}=m;if(h.has(" ")&&j){const W=Number(m.over.style.height.slice(0,-2));m.setSelect({left:j.left<r?j.left:r,top:0,width:Math.abs(j.left-(r??j.left)),height:W},!1)}g=D,window.requestAnimationFrame(v)},x=D=>{if(D.key==="Tab"){m.setCursor({left:-5,top:-5});return}if(!d.has(D.key))return;if(D.preventDefault(),D.stopPropagation(),!h.has(D.key)){const P=h.size===0;h.add(D.key),r=D.key===" "&&r===null?m.cursor.left:r,P&&window.requestAnimationFrame(v)}},f=D=>{d.has(D.key)&&(h.delete(D.key),D.key===" "&&(D.preventDefault(),D.stopPropagation(),m.setSelect(m.select),r=null))},u=()=>{if(!p?.matches(":focus-visible"))return;const D=parseFloat(m.over.style.width),C=parseFloat(m.over.style.height);m.setCursor({left:D/2,top:C/2})},b=()=>{g=null,r=null,h.clear(),m.setSelect({left:0,top:0,width:0,height:0},!1)};p.addEventListener("keydown",x),p.addEventListener("keyup",f),p.addEventListener("focus",u),p.addEventListener("blur",b);const E=()=>{p?.removeEventListener("keydown",x),p?.removeEventListener("keyup",f),p?.removeEventListener("focus",u),p?.removeEventListener("blur",b),p=null};(m.hooks.destroy??=[]).push(E)},c=({config:m})=>((0,s.useLayoutEffect)(()=>m.addHook("init",i),[m]),null)},69234:(Z,R,e)=>{"use strict";e.d(R,{b3:()=>h,xl:()=>u});var n=e(74848),a=e(22803),s=e(96540),l=e(40961),o=e(21275),d=e(63142),i=e(15245),c=e(84522);const m=void 0,p=10;var h=(E=>(E[E.xOne=0]="xOne",E[E.xAll=1]="xAll",E[E.xyOne=2]="xyOne",E))(h||{});function r(E,D){return{...E,...D,style:{...E.style,...D.style}}}function g(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const y=5,v=E=>E!=null&&!E.ctrlKey&&!E.metaKey,x=()=>[],f=/Android|iPhone|iPad/i.test(navigator.userAgent),u=({config:E,hoverMode:D,render:C,clientZoom:P=!1,queryZoom:T,onSelectRange:O,maxWidth:I,syncMode:j=o.yV.Off,syncScope:W="global",getDataLinks:B=x})=>{const S=(0,s.useRef)(null),w=(0,s.useRef)(null);w.current==null&&(w.current=(0,i.gF)());const[{plot:N,isHovering:M,isPinned:L,contents:A,style:U,dismiss:F},V]=(0,s.useReducer)(r,null,g),K=(0,s.useRef)(),G=(0,d.of)(b,I),H=(0,s.useRef)(C);H.current=C;const _=(0,s.useRef)(B);return _.current=B,(0,s.useLayoutEffect)(()=>{K.current?.observer.disconnect(),K.current={width:0,height:0,observer:new ResizeObserver(Be=>{let We=K.current;for(const _e of Be)_e.borderBoxSize?.length>0?(We.width=_e.borderBoxSize[0].inlineSize,We.height=_e.borderBoxSize[0].blockSize):(We.width=_e.contentRect.width,We.height=_e.contentRect.height)})};let k=!1,J=!1,z=N,Y=M,X=!1,Q=L,q=U,te=!1;const ne=j===o.yV.Tooltip;j!==o.yV.Off&&E.scales[0].props.isTime&&E.setCursor({sync:{key:W,scales:["x",null]}});const se=()=>{ce?Y=te&&X&&ne:Y=me!=null||D===1&&X};let ue=0,de=0,ie=null,he=[],me=null,ce=!1,Pe=[],Ie=[],Se=!1,Me=!1;const Te=(Be=!1)=>{Se||(Y?queueMicrotask(Qe):setTimeout(Qe,100),Se=!0),Be&&(Me=!0)},Ge=Be=>{Be.target.closest('[role="dialog"], #grafana-portal-container')==null&&tt()},Qe=()=>{Se=!1,Me&&(q={pointerEvents:Q?"all":"none"},z.cursor._lock=Q,Q?(document.addEventListener("mousedown",Ge,!0),document.addEventListener("keydown",Ge,!0)):(document.removeEventListener("mousedown",Ge,!0),document.removeEventListener("keydown",Ge,!0)),Me=!1);let Be={style:q,isPinned:Q,isHovering:Y,contents:Y||ie!=null?H.current(z,he,me,Q,tt,ie,ce,Q?Pe:me!=null?Ie[me]:[]):null,dismiss:tt};V(Be),ie=null},tt=()=>{let Be=Q;Q=!1,Y=!1,z.setCursor({left:-10,top:-10}),Pe=[],Te(Be)};E.addHook("init",Be=>{V({plot:z=Be}),P&&Be.over.addEventListener("mousedown",We=>{if(v(We)&&We.button===0&&We.shiftKey){J=!0,Be.cursor.drag.x=!1,Be.cursor.drag.y=!0;let _e=Xe=>{Be.cursor.drag.x=!0,Be.cursor.drag.y=!1,document.removeEventListener("mouseup",_e,!0)};document.addEventListener("mouseup",_e,!0)}},!0),Be.over.addEventListener("click",We=>{if(We.target===Be.over){if(We.ctrlKey||We.metaKey){let _e;Be.scales.x.ori===0?_e=Be.posToVal(Be.cursor.left,"x"):_e=Be.posToVal(Be.select.top+Be.select.height,"x"),ie={from:_e,to:_e},Te(!1)}else if(Y&&!Q&&me!=null){Pe=_.current(me,he[me]);const _e=Pe.find(Xe=>Xe.oneClick===!0);_e!=null?window.open(_e.href,_e.target??"_self"):setTimeout(()=>{Q=!0,Te(!0)},0)}}})}),E.addHook("setSelect",Be=>{const We=Be.scales.x.ori===0;if(!ce&&(P||T!=null))if(v(Be.cursor.event)){if(O!=null){let _e=[];const Xe=!!Be.cursor.drag.y,le=!!Be.cursor.drag.x;let ye=null,pe=[];le&&(ye={from:We?Be.posToVal(Be.select.left,"x"):Be.posToVal(Be.select.top+Be.select.height,"x"),to:We?Be.posToVal(Be.select.left+Be.select.width,"x"):Be.posToVal(Be.select.top,"x")}),Xe&&E.scales.forEach(ve=>{const be=ve.props.scaleKey;if(be!=="x"){let Oe={from:We?Be.posToVal(Be.select.top+Be.select.height,be):Be.posToVal(Be.select.left+Be.select.width,be),to:We?Be.posToVal(Be.select.top,be):Be.posToVal(Be.select.left,be)};pe.push(Oe)}}),le?Xe?_e=pe.map(ve=>({x:ye,y:ve})):_e=[{x:ye}]:Xe&&(_e=pe.map(ve=>({y:ve}))),O(_e)}else if(P&&J){if(Be.select.height>=y){for(let _e in Be.scales)if(_e!=="x"){const Xe=We?Be.posToVal(Be.select.top,_e):Be.posToVal(Be.select.left+Be.select.width,_e),le=We?Be.posToVal(Be.select.top+Be.select.height,_e):Be.posToVal(Be.select.left,_e);Be.setScale(_e,{min:le,max:Xe})}k=!0}J=!1}else if(T!=null&&Be.select.width>=y){const _e=We?Be.posToVal(Be.select.left,"x"):Be.posToVal(Be.select.top+Be.select.height,"x"),Xe=We?Be.posToVal(Be.select.left+Be.select.width,"x"):Be.posToVal(Be.select.top,"x");T({from:_e,to:Xe}),k=!1}}else ie={from:We?Be.posToVal(Be.select.left,"x"):Be.posToVal(Be.select.top+Be.select.height,"x"),to:We?Be.posToVal(Be.select.left+Be.select.width,"x"):Be.posToVal(Be.select.top,"x")},Te(!0);Be.setSelect({left:0,width:0,top:0,height:0},!1)}),(P||T!=null)&&E.setCursor({bind:{dblclick:Be=>()=>{if(!v(Be.cursor.event))return null;if(P&&k){for(let We in Be.scales)We!=="x"&&Be.setScale(We,{min:null,max:null});k=!1}else if(T!=null){let We=Be.scales.x;const _e=We.min,Xe=We.max,le=(Xe-_e)/2;T({from:_e-le,to:Xe+le})}return null}}}),E.addHook("setData",Be=>{k=!1,J=!1,Q&&tt()}),E.addHook("setSeries",(Be,We)=>{me=We,ce=Be.cursor.event==null,se(),Te()}),E.addHook("setLegend",Be=>{he=z?.cursor.idxs.slice(),X=he.some((_e,Xe)=>Xe>0&&_e!=null),Ie.length===0&&(Ie=he.map((_e,Xe)=>{if(Xe>0){const ye=B(Xe,he[Xe]).find(pe=>pe.oneClick===!0);if(ye)return[ye]}return[]})),ce=Be.cursor.event==null;let We=Y;se(),(Y||Y!==We)&&Te()});const ke=16;let He=0,Re=0;const Ne=()=>{Y&&!Q&&tt(),He=window.innerWidth-ke,Re=window.innerHeight-ke},Ae=()=>{te=z.rect.bottom<=Re&&z.rect.top>=0&&z.rect.left>=0&&z.rect.right<=He};Ne(),E.addHook("ready",Ae),E.addHook("setCursor",Be=>{if(ce=Be.cursor.event==null,!Y)return;let{left:We=-10,top:_e=-10}=Be.cursor;if(We>=0||_e>=0){let Xe=Be.rect.left+We,le=Be.rect.top+_e,ye="",{width:pe,height:ve}=K.current;pe+=p,ve+=p,de!==0?le+ve<Re||le-ve<0?de=0:de!==-ve&&(de=-ve):le+ve>Re&&le-ve>=0&&(de=-ve),ue!==0?Xe+pe<He||Xe-pe<0?ue=0:ue!==-pe&&(ue=-pe):Xe+pe>He&&Xe-pe>=0&&(ue=-pe);const be=Xe+(ue===0?p:-p),Oe=le+(de===0?p:-p);ye=`translateX(${be}px) ${ue===0?"":"translateX(-100%)"} translateY(${Oe}px) ${de===0?"":"translateY(-100%)"}`,S.current!=null?S.current.style.transform=ye:(q.transform=ye,Te())}});const Ue=Be=>{Ae(),Y&&Be.target instanceof Node&&Be.target.contains(z.root)&&tt()};return window.addEventListener("resize",Ne),window.addEventListener("scroll",Ue,!0),()=>{K.current?.observer.disconnect(),window.removeEventListener("resize",Ne),window.removeEventListener("scroll",Ue,!0),document.removeEventListener("mousedown",Ge,!0),document.removeEventListener("keydown",Ge,!0)}},[E]),(0,s.useLayoutEffect)(()=>{const k=K.current;if(S.current!=null){k.observer.disconnect(),k.observer.observe(S.current);const{width:J,height:z}=S.current.getBoundingClientRect();k.width=J,k.height=z;let Y=N.cursor.event;if(Y!=null){const X=Y.type!=="mousemove"||f;X&&(Y=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:Y.clientX,clientY:Y.clientY,screenX:Y.screenX,screenY:Y.screenY})),!(X?!1:performance.now()-Y.timeStamp>16)&&N.over.dispatchEvent(Y)}else N.setCursor({left:N.cursor.left,top:N.cursor.top},!0)}else k.width=0,k.height=0},[M]),N&&M?(0,l.createPortal)((0,n.jsxs)("div",{className:(0,a.cx)(G.tooltipWrapper,L&&G.pinned),style:U,"aria-live":"polite","aria-atomic":"true",ref:S,children:[L&&(0,n.jsx)(c.J,{onClick:F}),A]}),w.current):null},b=(E,D)=>({tooltipWrapper:(0,a.css)({top:0,left:0,zIndex:E.zIndex.portal,whiteSpace:"pre",borderRadius:E.shape.radius.default,position:"fixed",background:E.colors.background.elevated,border:`1px solid ${E.colors.border.weak}`,boxShadow:E.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,a.css)({boxShadow:E.shadows.z3})})},62748:(Z,R,e)=>{"use strict";e.d(R,{R:()=>a,s:()=>n});const n="__fixed";class a{constructor(l){this.props=l}}},36192:(Z,R,e)=>{"use strict";e.d(R,{NN:()=>c,Tz:()=>p,UO:()=>x,bq:()=>r,ro:()=>h,sw:()=>g,uY:()=>u});var n=e(46644),a=e(11576),s=e(739),l=e(20720),o=e(60379),d=e(70332);const i=(b,E,D)=>{let C=E%2?D[0]||D[2]:D[1]||D[3];return D[E]||!C?0:8},c={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[i,i,i,i],series:[],hooks:{}};var m=(b=>(b[b.Pos=1]="Pos",b[b.Neg=-1]="Neg",b))(m||{});function p(b){let E=[],{series:D,dir:C}=b,P=D.length-1,T=D.slice().reverse();return T.forEach((O,I)=>{if(I!==P){let j=T[I+1];E.push({series:[O,j],dir:-1*C})}}),E}function h(b){let E=new Map;return b.fields.forEach(({config:D,values:C,type:P},T)=>{if(T===0)return;let{custom:O}=D;if(O==null||O.hideFrom?.viz)return;let{stacking:I}=O;if(I==null)return;let{mode:j,group:W}=I;if(j===s.gs.None)return;let B=O.transform,S=y(B,C),w=O.drawStyle,N=w===s.GR.Bars?O.barAlignment:w===s.GR.Line?O.lineInterpolation:null,M=`${S}|${j}|${W}|${(0,d.M)(D,P)}|${w}|${N}`,L=E.get(M);L==null&&(L={series:[],dir:S},E.set(M,L)),L.series.push(T)}),[...E.values()]}function r(b,E,D){let C=Array(b.fields.length),P=E.length,T=b.length,O=P>0?Array(T).fill(0):[],I=P>0?Array(T).fill(!1):[],j=Array.from({length:P},()=>O.slice()),W=Array.from({length:P},()=>I.slice());if(E.forEach((B,S)=>{let w=W[S];B.series.forEach(N=>{let M=b.fields[N];if(M.config.custom?.hideFrom?.viz)return;let L=M.values;for(let A=0;A<T;A++)L[A]!=null&&(w[A]=!0)})}),b.fields.forEach((B,S)=>{let w=B.values;if(S===0){C[S]=w;return}let{custom:N}=B.config;if(!N||N.hideFrom?.viz){C[S]=w;return}if(N.transform===s.NU.Constant){let L=w.findIndex(U=>U!=null),A=w[L];w=Array(w.length).fill(void 0),w[L]=A}else if(w=w.slice(),N.transform===s.NU.NegativeY)for(let L=0;L<w.length;L++)w[L]!=null&&(w[L]*=-1);let M=N.stacking?.mode;if(!M||M===s.gs.None)C[S]=w;else{let L=E.findIndex(V=>V.series.indexOf(S)>-1),A=j[L],U=W[L],F=C[S]=Array(T);for(let V=0;V<T;V++){let K=w[V];K!=null?F[V]=A[V]+=K:F[V]=U[V]?A[V]:K}}}),D){let B=C.map((S,w)=>{let N=E.findIndex(M=>M.series.indexOf(w)>-1);return N!==-1?j[N]:S});D({totals:B})}return b.fields.forEach((B,S)=>{if(S===0||B.config.custom?.hideFrom?.viz)return;if(B.config.custom?.stacking?.mode===s.gs.Percent){let N=E.findIndex(U=>U.series.indexOf(S)>-1),M=j[N],L=E[N],A=C[S];for(let U=0;U<T;U++){let F=A[U];F!=null&&(A[U]=M[U]===0?0:L.dir*(F/M[U]))}}}),C}function g(b,E){let D,C=1,P=1,T=b.data[1][E],O=b.data[1][E];for(let I=1;I<b.data.length;I++){const W=b.data[I][E];W!=null&&(T==null?T=W:W>T&&(T=b.data[I][E],C=I),O==null?O=W:W<O&&(O=b.data[I][E],P=I))}return O==null&&T==null?D=void 0:O!=null&&T!=null?D=(b.valToPos(O,b.series[P].scale)+b.valToPos(T,b.series[C].scale))/2:D=b.valToPos(O||T,b.series[C||P].scale),D!==void 0&&D<0&&(D=b.bbox.height/devicePixelRatio),D}function y(b,E){const D=v(E);return b===s.NU.NegativeY?D?1:-1:D?-1:1}function v(b,E=100){const D=b.length;if(D===0)return!1;let C=0,P=D-1;for(;C<=P&&b[C]==null;)C++;for(;P>=C&&b[P]==null;)P--;let T=0,O=0;if(P>=C){const I=Math.max(1,Math.floor((P-C+1)/E));for(let j=C;j<=P;j+=I){const W=b[j];W!=null&&typeof W=="number"&&(W<0||Object.is(W,-0)?T++:W>0&&O++)}if(T>O)return!0}return!1}const x=(b,E,D)=>{if(!b?.length)return[];const C=I=>I==null?"-":I.toFixed(1),P=E.display??C;let T=null;const O=(0,n.Nw)({field:E,reducers:b});return b.map(I=>{const j=n.AS.get(I);let W=P;return j.id===n.gy.diffperc&&(W=(0,a.J)({field:{...E,config:{...E.config,unit:"percent"}},theme:D})),(j.id===n.gy.count||j.id===n.gy.changeCount||j.id===n.gy.distinctCount)&&(T||(T=(0,a.J)({field:{...E,config:{...E.config,unit:"none"}},theme:D})),W=T),{...W(O[I]),title:j.name,description:j.description}})},f=(0,o.h)("uPlot"),u=f.logger;(0,l.h)("graphng",void 0,f)},44017:(Z,R,e)=>{"use strict";e.d(R,{T4:()=>v,W1:()=>y,Wq:()=>x,rg:()=>r});var n=e(74848),a=e(95004),s=e(38809),l=e(92745),o=e(739),d=e(37386),i=e(77824),c=e(63527),m=e(41654),p=e(18857),h=e(99555);function r(f,u){x(f);const b=[(0,l.t)("grafana-ui.builder.axis.category-axis","Axis")];f.addTextInput({path:"axisLabel",name:(0,l.t)("grafana-ui.builder.axis.name-label","Label"),category:b,defaultValue:"",settings:{placeholder:(0,l.t)("grafana-ui.builder.axis.placeholder-label","Optional text"),expandTemplateVars:!0},showIf:E=>E.axisPlacement!==o.vM.Hidden,shouldApply:E=>E.type!==a.PU.time&&E.type!==a.PU.string}),v(f),f.addRadio({path:"axisGridShow",name:(0,l.t)("grafana-ui.builder.axis.name-grid-lines","Show grid lines"),category:b,defaultValue:void 0,settings:{options:[{value:void 0,label:(0,l.t)("grafana-ui.builder.axis.grid-line-options.label-auto","Auto")},{value:!0,label:(0,l.t)("grafana-ui.builder.axis.grid-line-options.label-on","On")},{value:!1,label:(0,l.t)("grafana-ui.builder.axis.grid-line-options.label-off","Off")}]},showIf:E=>E.axisPlacement!==o.vM.Hidden}).addRadio({path:"axisColorMode",name:(0,l.t)("grafana-ui.builder.axis.color-label","Color"),category:b,defaultValue:o.Y$.Text,settings:{options:[{value:o.Y$.Text,label:(0,l.t)("grafana-ui.builder.axis.color-options.label-text","Text")},{value:o.Y$.Series,label:(0,l.t)("grafana-ui.builder.axis.color-options.label-series","Series")}]},showIf:E=>E.axisPlacement!==o.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:(0,l.t)("grafana-ui.builder.axis.name-show-border","Show border"),category:b,defaultValue:!1,showIf:E=>E.axisPlacement!==o.vM.Hidden}),f.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:(0,l.t)("grafana-ui.builder.axis.name-scale","Scale"),category:b,editor:y,override:y,defaultValue:{type:o.L4.Linear},shouldApply:E=>E.type===a.PU.number,process:s.hS}).addBooleanSwitch({path:"axisCenteredZero",name:(0,l.t)("grafana-ui.builder.axis.name-centered-zero","Centered zero"),category:b,defaultValue:!1,showIf:E=>E.scaleDistribution?.type!==o.L4.Log}).addNumberInput({path:"axisSoftMin",name:(0,l.t)("grafana-ui.builder.axis.name-soft-min","Soft min"),defaultValue:u.axisSoftMin,category:b,settings:{placeholder:(0,l.t)("grafana-ui.builder.axis.placeholder-soft-min","See: Standard options > Min")}}).addNumberInput({path:"axisSoftMax",name:(0,l.t)("grafana-ui.builder.axis.name-soft-max","Soft max"),defaultValue:u.axisSoftMax,category:b,settings:{placeholder:(0,l.t)("grafana-ui.builder.axis.placeholder-soft-max","See: Standard options > Max")}})}const g=[{label:"2",value:2},{label:"10",value:10}],y=({value:f,onChange:u})=>{const b=f?.type??o.L4.Linear,E=f?.log??2,D=[{label:(0,l.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-linear","Linear"),value:o.L4.Linear},{label:(0,l.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-log","Logarithmic"),value:o.L4.Log},{label:(0,l.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-symlog","Symlog"),value:o.L4.Symlog}];return(0,n.jsxs)(m.B,{direction:"column",gap:2,children:[(0,n.jsx)(i.z,{value:b,options:D,onChange:C=>{u({...f,type:C,log:C===o.L4.Linear?void 0:E})}}),(b===o.L4.Log||b===o.L4.Symlog)&&(0,n.jsx)(d.D,{label:(0,l.t)("grafana-ui.axis-builder.log-base","Log base"),children:(0,n.jsx)(p.l6,{options:g,value:E,onChange:C=>{u({...f,log:C.value})}})}),b===o.L4.Symlog&&(0,n.jsx)(d.D,{label:(0,l.t)("grafana-ui.axis-builder.linear-threshold","Linear threshold"),style:{marginBottom:0},children:(0,n.jsx)(c.p,{placeholder:"1",value:f?.linearThreshold,onChange:C=>{u({...f,linearThreshold:Number(C.currentTarget.value)})}})})]})};function v(f){f.addNumberInput({path:"axisWidth",name:(0,l.t)("grafana-ui.builder.axis.name-width","Width"),category:[(0,l.t)("grafana-ui.builder.axis.category-axis","Axis")],settings:{placeholder:(0,l.t)("grafana-ui.builder.axis.placeholder-width","Auto")},showIf:u=>u.axisPlacement!==o.vM.Hidden})}function x(f,u=b=>!0){const b=(0,h.P)();f.addRadio({path:"axisPlacement",name:(0,l.t)("grafana-ui.builder.axis.name-placement","Placement"),category:[(0,l.t)("grafana-ui.builder.axis.category-axis","Axis")],defaultValue:b.axisPlacement[0].value,settings:{options:b.axisPlacement.filter(E=>u(E.value))}})}},45013:(Z,R,e)=>{"use strict";e.d(R,{e:()=>c});var n=e(74848),a=e(2543),s=e.n(a),l=e(96540),o=e(34343),d=e(41654);const i=({value:m,onChange:p})=>{const h=(0,l.useCallback)(r=>{p({...m,[r]:!m[r]})},[m,p]);return(0,n.jsx)(d.B,{gap:.5,children:Object.keys(m).map(r=>{const g=r;return(0,n.jsx)(o.m,{icon:m[g]?"eye-slash":"eye",onClick:()=>h(g),label:(0,a.startCase)(g),selected:m[g]},g)})})};function c(m){m.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:i,override:i,shouldApply:()=>!0,hideFromDefaults:!0,process:p=>p})}},41069:(Z,R,e)=>{"use strict";e.d(R,{H:()=>l});var n=e(53543),a=e(92745),s=e(739);function l(o,d=!0,i=!0){const c=[(0,a.t)("grafana-ui.builder.legend.category","Legend")];o.addBooleanSwitch({path:"legend.showLegend",name:(0,a.t)("grafana-ui.builder.legend.name-visibility","Visibility"),category:c,description:"",defaultValue:i}).addRadio({path:"legend.displayMode",name:(0,a.t)("grafana-ui.builder.legend.name-mode","Mode"),category:c,description:"",defaultValue:s.lm.List,settings:{options:[{value:s.lm.List,label:(0,a.t)("grafana-ui.builder.legend.mode-options.label-list","List")},{value:s.lm.Table,label:(0,a.t)("grafana-ui.builder.legend.mode-options.label-table","Table")}]},showIf:m=>m.legend.showLegend}).addRadio({path:"legend.placement",name:(0,a.t)("grafana-ui.builder.legend.name-placement","Placement"),category:c,description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:(0,a.t)("grafana-ui.builder.legend.placement-options.label-bottom","Bottom")},{value:"right",label:(0,a.t)("grafana-ui.builder.legend.placement-options.label-right","Right")}]},showIf:m=>m.legend.showLegend}).addNumberInput({path:"legend.width",name:(0,a.t)("grafana-ui.builder.legend.name-width","Width"),category:c,settings:{placeholder:"Auto"},showIf:m=>m.legend.showLegend&&m.legend.placement==="right"}),d&&o.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:(0,a.t)("grafana-ui.builder.legend.name-values","Values"),category:c,description:(0,a.t)("grafana-ui.builder.legend.description-values","Select values or calculations to show in legend"),editor:n.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:m=>m.legend.showLegend!==!1})}},81082:(Z,R,e)=>{"use strict";e.d(R,{I:()=>r,m:()=>h});var n=e(74848),a=e(38809),s=e(95004),l=e(92745),o=e(739),d=e(77824),i=e(76319),c=e(63527),m=e(41654),p=e(99555);const h=({value:g,context:y,onChange:v,item:x})=>(0,n.jsxs)(m.B,{children:[(0,n.jsx)(d.z,{value:g?.mode||o.gs.None,options:x.settings?.options??[],onChange:f=>{v({...g,mode:f})}}),y.isOverride&&g?.mode&&g?.mode!==o.gs.None&&(0,n.jsx)(c.p,{type:"text",placeholder:(0,l.t)("grafana-ui.stacking-builder.group","Group"),suffix:(0,n.jsx)(i.K,{name:"question-circle",tooltip:(0,l.t)("grafana-ui.stacking-builder.group-tooltip","Name of the stacking group"),tooltipPlacement:"top"}),defaultValue:g?.group,onChange:f=>{v({...g,group:f.currentTarget.value.trim()})}})]});function r(g,y,v=["Graph styles"]){const x=(0,p.P)();g.addCustomEditor({id:"stacking",path:"stacking",name:(0,l.t)("grafana-ui.builder.stacking.name-stack-series","Stack series"),category:v,defaultValue:y,editor:h,override:h,settings:{options:x.stacking},process:a.hS,shouldApply:f=>f.type===s.PU.number})}},14099:(Z,R,e)=>{"use strict";e.d(R,{I:()=>a});var n=e(92745);function a(s,l=!0){const o=[(0,n.t)("grafana-ui.builder.text.category-text-size","Text size")];l&&s.addNumberInput({path:"text.titleSize",category:o,name:(0,n.t)("grafana-ui.builder.text.name-title","Title"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-title","Auto"),integer:!1,min:1,max:200},defaultValue:void 0}),s.addNumberInput({path:"text.valueSize",category:o,name:(0,n.t)("grafana-ui.builder.text.name-value","Value"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-value","Auto"),integer:!1,min:1,max:200},defaultValue:void 0}),s.addNumberInput({path:"text.percentSize",category:o,name:(0,n.t)("grafana-ui.builder.text.name-percent-change","Percent change"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-percent-change","Auto"),integer:!1,min:1,max:200},defaultValue:void 0})}},79277:(Z,R,e)=>{"use strict";e.d(R,{D:()=>l,U:()=>s});var n=e(92745),a=e(739);const s={tooltip:{mode:a.$N.Single,sort:a.xB.None,hideZeros:!1}};function l(o,d=!1,i=!1,c){const m=[(0,n.t)("grafana-ui.builder.tooltip.category","Tooltip")],p=d?[{value:a.$N.Single,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-single","Single")},{value:a.$N.None,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-hidden","Hidden")}]:[{value:a.$N.Single,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-single","Single")},{value:a.$N.Multi,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-all","All")},{value:a.$N.None,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-hidden","Hidden")}],h=[{value:a.xB.None,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-none","None")},{value:a.xB.Ascending,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-ascending","Ascending")},{value:a.xB.Descending,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-descending","Descending")}];o.addRadio({path:"tooltip.mode",name:(0,n.t)("grafana-ui.builder.tooltip.name-tooltip-mode","Tooltip mode"),category:m,defaultValue:c?.tooltip?.mode??a.$N.Single,settings:{options:p}}).addRadio({path:"tooltip.sort",name:(0,n.t)("grafana-ui.builder.tooltip.name-values-sort-order","Values sort order"),category:m,defaultValue:c?.tooltip?.sort??a.xB.None,showIf:r=>r.tooltip?.mode===a.$N.Multi,settings:{options:h}}).addBooleanSwitch({path:"tooltip.hideZeros",name:(0,n.t)("grafana-ui.builder.tooltip.name-hide-zeros","Hide zeros"),category:m,defaultValue:!1,showIf:r=>c?.tooltip?.hideZeros!==void 0&&r.tooltip?.mode===a.$N.Multi}),i&&o.addNumberInput({path:"tooltip.hoverProximity",name:(0,n.t)("grafana-ui.builder.tooltip.name-hover-proximity","Hover proximity"),description:(0,n.t)("grafana-ui.builder.tooltip.description-hover-proximity","How close the cursor must be to a point to trigger the tooltip, in pixels"),category:m,settings:{integer:!0},showIf:r=>r.tooltip?.mode!==a.$N.None}),o.addNumberInput({path:"tooltip.maxWidth",name:(0,n.t)("grafana-ui.builder.tooltip.name-max-width","Max width"),category:m,settings:{integer:!0},showIf:r=>r.tooltip?.mode!==a.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:(0,n.t)("grafana-ui.builder.tooltip.name-max-height","Max height"),category:m,defaultValue:void 0,settings:{integer:!0},showIf:(r,g,y)=>r.tooltip?.mode===a.$N.Multi||y?.some(v=>v.meta?.custom?.resultType==="exemplar")})}},16123:(Z,R,e)=>{"use strict";e.d(R,{v:()=>n});function n(){return{onKeyDown(a,s,l){const o=s.value;if(o.selection.isExpanded)return l();if(a.key==="k"&&a.ctrlKey){a.preventDefault();const d=o.anchorText.text,i=o.selection.anchor.offset,m=d.length-i;return s.deleteForward(m),!0}return l()}}}},54024:(Z,R,e)=>{"use strict";e.d(R,{s:()=>s});const n=(l,o,d)=>{if(!l.length)return;const i=l.slice(0,-1).join("").length+l.length-1;return l.join(`
`).slice(o,i+d)},a=l=>l?.replace(/[\uFEFF]/g,"");function s(){const l={onCopy(o,d,i){o.preventDefault();const{document:c,selection:m}=d.value,{start:{offset:p},end:{offset:h}}=m,r=c.getLeafBlocksAtRange(m).toArray().map(y=>y.text),g=a(n(r,p,h));return g&&o.clipboardData&&o.clipboardData.setData("Text",g),!0},onPaste(o,d,i){if(o.preventDefault(),o.clipboardData){const m=a(o.clipboardData.getData("Text"))?.split(`
`);if(m&&m.length){d.insertText(m[0]);for(const p of m.slice(1))d.splitBlock().insertText(p)}}return!0}};return{...l,onCut(o,d,i){return l.onCopy(o,d,i),d.deleteAtRange(d.value.selection),!0}}}},52513:(Z,R,e)=>{"use strict";e.d(R,{T:()=>p});var n=e(57746),a=e(82611),s=e(52845);const l=(0,n.Sn)("mod+["),o=(0,n.Sn)("shift+tab"),d=(0,n.Sn)("mod+]"),i="  ",c=(h,r,g)=>{const{startBlock:y,endBlock:v,selection:{start:{offset:x,key:f},end:{offset:u,key:b}}}=r.value;if(s.default.serialize(r.value)==="")return;h.preventDefault();const E=y.getFirstText();E&&x===0&&f===E.key&&u===E.text.length&&b===E.key||!y.equals(v)?m(r,"right"):r.insertText(i)},m=(h,r)=>{const g=h.value.selection,y=h.value.document.getLeafBlocksAtRange(g).toArray();if(r==="left")for(const v of y){const x=v.text.length-v.text.trimLeft().length,f=v.getFirstText().key,u={anchor:{key:f,offset:x,path:[]},focus:{key:f,offset:x,path:[]}};h.deleteBackwardAtRange(a.Range.create(u),Math.min(i.length,x))}else{const{startText:v}=h.value,x=v.text.slice(0,g.start.offset),f=/^\s*$/.test(x);for(const u of y)h.insertTextByKey(u.getFirstText().key,0,i);f&&h.moveStartBackward(i.length)}};function p(){return{onKeyDown(h,r,g){if(l(h)||o(h))h.preventDefault(),m(r,"left");else if(d(h))h.preventDefault(),m(r,"right");else if(h.key==="Tab")c(h,r,g);else return g();return!0}}}},21266:(Z,R,e)=>{"use strict";e.d(R,{O:()=>a});function n(s){let l=s.length-s.trimLeft().length;if(l){let o=s[0];for(;--l;)o+=s[0];return o}return""}function a(){return{onKeyDown(s,l,o){const d=l.value;if(d.selection.isExpanded)return o();if(s.key==="Enter"){s.preventDefault();const{startBlock:i}=d,c=i.text,m=n(c);return l.splitBlock().insertText(m).focus()}return o()}}}},59490:(Z,R,e)=>{"use strict";e.d(R,{U:()=>n});function n({handler:a}){return{onKeyDown(s,l,o){return a&&s.key==="Enter"&&(s.shiftKey||s.ctrlKey)?(s.preventDefault(),a(s),l):o()}}}},91272:(Z,R,e)=>{"use strict";e.d(R,{l:()=>s});var n=e(57746);const a=(0,n.Sn)("mod+l");function s(){return{onKeyDown(l,o,d){if(a(l)){l.preventDefault();const{focusBlock:i,document:c}=o.value;o.moveAnchorToStartOfBlock(),c.getNextBlock(i.key)?o.moveFocusToStartOfNextBlock():o.moveFocusToEndOfText()}else return d();return!0}}}},65937:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a});const a="prism-token"},56103:(Z,R,e)=>{"use strict";e.d(R,{D:()=>r,R:()=>x});var n=e(28848),a=e.n(n),s=e(82611),l=e(65937),o=e(74848),d=e(49568);function i(f){return f.object==="block"&&f.type==="code_block"}function c(f){return"javascript"}function m(f,u,b){const{decoration:E}=f;if(E.type!==l.A)return b();const D=E.data.get("className");return(0,o.jsx)("span",{className:D,children:f.children})}class p extends(0,d.Record)({onlyIn:i,getSyntax:c,renderDecoration:m}){constructor(u){super(u)}}const h=p;function r(f={},u=a().languages){const b=new h(f);return{decorateNode:(E,D,C)=>{if(!b.onlyIn(E))return C();const P=s.Block.create(E),T=b.getSyntax(P),O=u[T];if(!O)return[];const j=P.getTexts().map(w=>w&&w.getText()).join(`
`),W=a().tokenize(j,O),B=x(W),S=D.value.data.set("tokens",B);return D.setData(S),g(b,W,P)},renderDecoration:(E,D,C)=>b.renderDecoration({children:E.children,decoration:E.decoration},D,C)}}function g(f,u,b){const E=b.getTexts(),D=[];let C=0,P=0;return E.forEach(T=>{P=C+T.getText().length;let O=0;function I(j,W){if(typeof j=="string"){if(W){const B=y({text:T,textStart:C,textEnd:P,start:O,end:O+j.length,className:`prism-token token ${W}`,block:b});B&&D.push(B)}O+=j.length}else if(W=`${W} ${j.type}`,j.alias&&(W+=" "+j.alias),typeof j.content=="string"){const B=y({text:T,textStart:C,textEnd:P,start:O,end:O+j.content.length,className:`prism-token token ${W}`,block:b});B&&D.push(B),O+=j.content.length}else for(let B=0;B<j.content.length;B+=1)I(j.content[B],W)}u.forEach(I),C=P+1}),D}function y({text:f,textStart:u,textEnd:b,start:E,end:D,className:C,block:P}){return E>=b||D<=u?null:(E=Math.max(E,u),D=Math.min(D,b),E-=u,D-=u,P.createDecoration({object:"decoration",anchor:{key:f.key,offset:E,object:"point"},focus:{key:f.key,offset:D,object:"point"},type:l.A,data:{className:C}}))}function v(f){return typeof f=="string"?[{content:f,types:[],aliases:[]}]:Array.isArray(f)?f.flatMap(u=>v(u)):f instanceof a().Token?v(f.content).flatMap(u=>{let b=[];return typeof f.alias=="string"?b=[f.alias]:b=f.alias??[],{content:u.content,types:[f.type,...u.types],aliases:[...b,...u.aliases]}}):[]}function x(f){const u=v(f);if(!u.length)return[];const b=u[0];b.prev=null,b.next=u.length>=2?u[1]:null,b.offsets={start:0,end:b.content.length};for(let D=1;D<u.length-1;D++)u[D].prev=u[D-1],u[D].next=u[D+1],u[D].offsets={start:u[D-1].offsets.end,end:u[D-1].offsets.end+u[D].content.length};const E=u[u.length-1];return E.prev=u.length>=2?u[u.length-2]:null,E.next=null,E.offsets={start:u.length>=2?u[u.length-2].offsets.end:0,end:u.length>=2?u[u.length-2].offsets.end+E.content.length:E.content.length},u}},93427:(Z,R,e)=>{"use strict";e.d(R,{Pz:()=>M});var n=e(74848),a=e(2543),s=e(22803),l=e(96540),o=e(40961),d=e(97222),i=e(35555),c=e(53926),m=e(49579);const p=U=>U.reduce((F,{items:V,label:K})=>(F.push({label:K,kind:c.I.GroupTitle}),V.reduce((G,H)=>(G.push(H),G),F)),[]),h=U=>U.reduce((F,V)=>F.length<V.label.length?V.label:F,""),r=(U,F,V)=>{const K=(0,m.A)(V,{font:U.typography.fontFamilyMonospace,fontSize:U.typography.bodySmall.fontSize,fontWeight:"normal"}),G=y(K.width,U),H=g(K.height,U),_=v(H,F);return{listWidth:G,listHeight:_,itemHeight:H}},g=(U,F)=>{const V=F.spacing.gridSize*2;return U+V},y=(U,F)=>{const V=F.spacing.gridSize*3;return Math.min(Math.max(U+V,200),800)},v=(U,F)=>{const V=Math.min(F.length,10),K=100,G=V*U;return Math.max(G,K)};var x=e(67458),f=e(63142);const u=(U,F,V)=>({typeaheadItem:(0,s.css)({label:"type-ahead-item",zIndex:11,padding:U.spacing(1,1,1,2),border:U.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:U.colors.background.secondary,color:U.colors.text.secondary,boxShadow:`0 0 20px ${U.v1.colors.dropdownShadow}`,visibility:V===!0?"visible":"hidden",width:"250px",minHeight:`${F+parseInt(U.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),b=({item:U,height:F})=>{const V=U&&!!U.documentation,K=U?U.label:"",G=(0,x.G)(U?.documentation),H=(0,f.$j)(),_=u(H,F,V);return(0,n.jsxs)("div",{className:(0,s.cx)([_.typeaheadItem]),children:[(0,n.jsx)("b",{children:K}),(0,n.jsx)("hr",{}),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:G}})]})};var E=e(23257),D=e.n(E),C=e(20662);const P=U=>({typeaheadItem:(0,s.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:U.typography.fontFamilyMonospace,padding:U.spacing(1,1,1,2),fontSize:U.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[U.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,s.css)({label:"type-ahead-item-selected",backgroundColor:U.colors.background.secondary}),typeaheadItemMatch:(0,s.css)({label:"type-ahead-item-match",color:U.v1.palette.yellow,borderBottom:`1px solid ${U.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,s.css)({label:"type-ahead-item-group-title",color:U.colors.text.secondary,fontSize:U.typography.bodySmall.fontSize,lineHeight:U.typography.body.lineHeight,padding:U.spacing(1)})}),T=U=>{const F=(0,f.of)(P),{isSelected:V,item:K,prefix:G,style:H,onMouseEnter:_,onMouseLeave:k,onClickItem:J}=U,z=V?(0,s.cx)([F.typeaheadItem,F.typeaheadItemSelected]):(0,s.cx)([F.typeaheadItem]),Y=(0,s.cx)([F.typeaheadItemMatch]),X=(0,s.cx)([F.typeaheadItemGroupTitle]),Q=K.label||"";return K.kind===c.I.GroupTitle?(0,n.jsx)("li",{className:X,style:H,children:(0,n.jsx)("span",{children:Q})}):(0,n.jsx)("li",{role:"none",children:(0,n.jsx)("button",{role:"menuitem",className:z,style:H,onMouseDown:J,onMouseEnter:_,onMouseLeave:k,type:"button",children:K.highlightParts!==void 0?(0,n.jsx)(C.z,{text:Q,highlightClassName:Y,highlightParts:K.highlightParts}):(0,n.jsx)(D(),{textToHighlight:Q,searchWords:[G??""],autoEscape:!0,highlightClassName:Y})})})},O=(U,F)=>U-F*Math.floor(U/F);class I extends l.PureComponent{constructor(){super(...arguments),this.listRef=(0,l.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const F=p(this.props.groupedItems),V=h(F),{listWidth:K,listHeight:G,itemHeight:H}=r(this.context,F,V);this.setState({listWidth:K,listHeight:G,itemHeight:H,allItems:F})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(F,V)=>{if(this.state.typeaheadIndex!==null&&V.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,a.isEqual)(F.groupedItems,this.props.groupedItems)===!1){const K=p(this.props.groupedItems),G=h(K),{listWidth:H,listHeight:_,itemHeight:k}=r(this.context,K,G);this.setState({listWidth:H,listHeight:_,itemHeight:k,allItems:K,typeaheadIndex:null})}},this.onMouseEnter=F=>{this.setState({hoveredItem:F})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=F=>{const V=this.state.allItems.length;if(V){const K=this.state.typeaheadIndex||0;let G=O(K+F,V);this.state.allItems[G].kind===c.I.GroupTitle&&(G=O(G+F,V)),this.setState({typeaheadIndex:G});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=i.D}get menuPosition(){if(!window.getSelection)return"";const F=window.getSelection(),V=F&&F.anchorNode;if(V&&V.parentElement){const K=V.parentElement.getBoundingClientRect(),G=window.scrollX,H=window.scrollY;return`position: absolute; display: flex; top: ${K.top+H+K.height+6}px; left: ${K.left+G-2}px`}return""}render(){const{prefix:F,isOpen:V=!1,origin:K}=this.props,{allItems:G,listWidth:H,listHeight:_,itemHeight:k,hoveredItem:J,typeaheadIndex:z}=this.state,Y=W(this.context),X=J||z,Q=G[J||z||0];return(0,n.jsxs)(j,{origin:K,isOpen:V,style:this.menuPosition,children:[(0,n.jsx)("ul",{role:"menu",className:Y.typeahead,"data-testid":"typeahead",children:(0,n.jsx)(d.Y1,{ref:this.listRef,itemCount:G.length,itemSize:k,itemKey:q=>{const te=G&&G[q];return te?`${q}-${te.label}`:`${q}`},width:H,height:_,children:({index:q,style:te})=>{const ne=G&&G[q];return ne?(0,n.jsx)(T,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(ne):{},isSelected:z===null?!1:G[z]===ne,item:ne,prefix:F,style:te,onMouseEnter:()=>this.onMouseEnter(q),onMouseLeave:this.onMouseLeave}):null}})}),X&&(0,n.jsx)(b,{height:_,item:Q})]})}}class j extends l.PureComponent{constructor(F){super(F);const{index:V=0,origin:K="query",style:G}=F;this.node=document.createElement("div"),this.node.setAttribute("style",G),this.node.classList.add(`slate-typeahead-${K}-${V}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),o.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const W=U=>({typeahead:(0,s.css)({position:"relative",zIndex:U.zIndex.typeahead,borderRadius:U.shape.radius.default,border:`1px solid ${U.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:U.components.panel.background,color:U.colors.text.primary,boxShadow:U.shadows.z2,strong:{color:U.v1.palette.yellow}})});var B=e(59258),S=e(35458),w=e(65937);const N=250;function M({onTypeahead:U,cleanText:F,onWillApplySuggestion:V,portalOrigin:K}){let G,H={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const _=(0,a.debounce)(L,N),k=J=>{H={...H,...J}};return{onBlur:(J,z,Y)=>(H={...H,groupedItems:[]},Y()),onClick:(J,z,Y)=>(H={...H,groupedItems:[]},Y()),onKeyDown:(J,z,Y)=>{const Q=H.groupedItems.length;switch(J.key){case"Escape":{if(Q)return J.preventDefault(),H={...H,groupedItems:[]},z.insertText("");break}case"ArrowDown":case"ArrowUp":if(Q){J.preventDefault(),G.moveMenuIndex(J.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(J.shiftKey||J.ctrlKey)&&Q)return J.preventDefault(),G.insertSuggestion();break}case"Tab":{if(Q)return J.preventDefault(),G.insertSuggestion();break}default:{J.key.length===1&&_(z,k,U,F);break}}return Y()},commands:{selectSuggestion:(J,z)=>{const Y=H.groupedItems;if(!Y||!Y.length)return J;const X=J.applyTypeahead(z);return _(J,k,U,F),X},applyTypeahead:(J,z)=>{let Y=z.insertText||z.label;const X=z.kind==="function",Q=z.move||0,q=Q>0?Q:0,te=Q<0?-Q:0,{typeaheadPrefix:ne,typeaheadText:se,typeaheadContext:ue}=H;V&&(Y=V(Y,{groupedItems:H.groupedItems,typeaheadContext:ue,typeaheadPrefix:ne,typeaheadText:se}));const{forward:de,backward:ie}=A(Y,ne,se,X,z.deleteBackwards,F);if(Y.match(/\n/)){const he=(0,S.dF)(Y);return J.deleteBackward(ie).deleteForward(de).insertFragment(he).focus(),J}return H={...H,groupedItems:[]},J.snapshotSelection().deleteBackward(ie).deleteForward(de).insertText(Y).moveForward(q).moveBackward(te).focus(),J}},renderEditor(J,z,Y){if(z.value.selection.isExpanded)return Y();const X=Y();return(0,n.jsxs)(n.Fragment,{children:[X,(0,n.jsx)(I,{menuRef:Q=>G=Q,origin:K,prefix:H.typeaheadPrefix,isOpen:!!H.groupedItems.length,groupedItems:H.groupedItems,onSelectSuggestion:z.selectSuggestion})]})}}}const L=async(U,F,V,K)=>{if(!V)return;const{value:G}=U,{selection:H}=G,_=G.document.getClosestBlock(G.focusBlock.key),k=G.selection.start.offset-1,J=_&&_.getDecorations(U),z=J?J.filter(ie=>ie.start.offset<=k&&ie.end.offset>k&&ie.type===w.A).toArray():[],Y=J&&J.filter(ie=>ie.end.offset<=k&&ie.type===w.A&&ie.data.get("className").includes("label-key")).last(),X=Y&&G.focusText.text.slice(Y.start.offset,Y.end.offset),Q=z.map(ie=>ie.data.get("className")).join(" ").split(" ").filter(ie=>ie.length);let q=G.focusText.text,te=q.slice(0,H.focus.offset);z.length&&(q=G.focusText.text.slice(z[0].start.offset,z[0].end.offset),te=G.focusText.text.slice(z[0].start.offset,H.focus.offset));const ne=te.match(/(?:!?=~?"?|")(.*)/);ne?te=ne[1]:K&&(te=K(te));const{suggestions:se,context:ue}=await V({prefix:te,text:q,value:G,wrapperClasses:Q,labelKey:X||void 0,editor:U}),de=se.map(ie=>{if(!ie.items)return ie;const he=ie.searchFunctionType||(ie.prefixMatch?B.T.Prefix:B.T.Word),me=B.H[he];let ce={...ie};return te&&(ie.skipFilter||(ce.items=ce.items.filter(Pe=>(Pe.filterText||Pe.label).length>=te.length),ce.items=me(ce.items,te)),ce.items=ce.items.filter(Pe=>!(Pe.insertText===te||(Pe.filterText??Pe.label)===te))),ie.skipSort||(ce.items=(0,a.sortBy)(ce.items,Pe=>Pe.sortText===void 0?Pe.sortValue!==void 0?Pe.sortValue:Pe.label:Pe.sortText||Pe.label)),ce}).filter(ie=>ie.items&&ie.items.length);F({groupedItems:de,typeaheadPrefix:te,typeaheadContext:ue,typeaheadText:q}),U.blur().focus()};function A(U,F,V,K,G,H){const _=G||F.length,k=H?H(V):V,J=V.indexOf(F),z=J>-1?k.length-J-F.length:k.length-F.length;return{forward:!!(F&&z>0||U===V)&&!K?z+J:0,backward:_}}},77345:(Z,R,e)=>{"use strict";e.d(R,{k:()=>N});var n=e(74848),a=e(17437),s=e(63142);function l(M){return(0,a.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function o(M){return(0,a.css)({".alert-state-paused, .alert-state-pending":{color:M.colors.text.secondary,fontWeight:M.typography.fontWeightMedium},".alert-state-ok":{color:M.colors.success.text,fontWeight:M.typography.fontWeightMedium},".alert-state-warning":{color:M.colors.warning.text,fontWeight:M.typography.fontWeightMedium},".alert-state-critical":{color:M.colors.error.text,fontWeight:M.typography.fontWeightMedium}})}function d(M){return(0,a.css)({".card-section":{marginBottom:M.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:M.colors.background.secondary,boxShadow:"none",padding:M.spacing(2),borderRadius:M.shape.radius.default,"&:hover":{background:M.colors.emphasize(M.colors.background.secondary,.03)},".label-tag":{marginLeft:M.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:M.spacing(2)},".card-item-type":{color:M.colors.text.secondary,textTransform:"uppercase",fontSize:M.typography.size.sm,fontWeight:M.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:M.typography.size.sm},".card-item-name":{color:M.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:M.spacing(1)},".card-item-sub-name":{color:M.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:M.colors.text.secondary,textTransform:"uppercase",marginBottom:M.spacing(2),fontSize:M.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:M.typography.size.sm,display:"inline-block",marginLeft:M.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:M.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:M.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:M.typography.h3.fontSize},[M.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[M.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[M.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:M.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:M.shape.radius.default},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:M.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:M.typography.h4.fontSize},".card-item-sub-name":{fontSize:M.typography.size.sm},".layout-selector":{marginRight:0}}})}function i(M){return(0,a.css)({"code, pre, kbd, samp":{...M.typography.code,fontSize:M.typography.bodySmall.fontSize,backgroundColor:M.colors.background.primary,color:M.colors.text.primary,border:`1px solid ${M.colors.border.medium}`,borderRadius:M.shape.radius.default},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:M.spacing(0,0,2),lineHeight:M.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function c(M){return(0,a.css)({".react-resizable-handle":{visibility:"hidden"},".react-grid-item, #grafana-portal-container":{touchAction:"initial !important","&:hover":{".react-resizable-handle":{visibility:"visible"}}},".dragging-active":{"*":{cursor:"move",userSelect:"none"}},[M.breakpoints.down("md")]:{".react-grid-layout":{height:"unset !important"},".react-grid-item":{display:"block !important",transitionProperty:"none !important",position:"unset !important",transform:"translate(0px, 0px) !important",marginBottom:M.spacing(2)},".panel-repeater-grid-item":{height:"auto !important"}},".react-grid-item.react-grid-placeholder":{boxShadow:`0 0 4px ${M.colors.primary.border} !important`,background:`${M.colors.primary.transparent} !important`,zIndex:"-1 !important",opacity:"unset !important"},".react-grid-item > .react-resizable-handle::after":{borderRight:`2px solid ${M.isDark?M.v1.palette.gray1:M.v1.palette.gray3} !important`,borderBottom:`2px solid ${M.isDark?M.v1.palette.gray1:M.v1.palette.gray3} !important`},".react-grid-item.resizing.panel, .react-grid-item.panel.dropdown-menu-open, .react-grid-item.react-draggable-dragging.panel":{zIndex:M.zIndex.dropdown},".react-grid-item.cssTransforms":{transitionProperty:"none !important"},[M.transitions.handleMotion("no-preference")]:{".react-grid-layout--enable-move-animations":{".react-grid-item.cssTransforms":{transitionProperty:"transform !important"}}},".dashboard-selected-element":{outline:`1px dashed ${M.colors.primary.border}`,outlineOffset:"0px",borderRadius:M.shape.radius.default},".dashboard-selectable-element":{"&:hover":{outline:`1px dashed ${M.colors.border.strong}`,outlineOffset:"0px",borderRadius:M.shape.radius.default,backgroundColor:M.colors.emphasize(M.colors.background.canvas,.08)}},".dashboard-canvas-add-button":{display:"flex",opacity:.5,transition:M.transitions.create("opacity"),filter:"grayscale(100%)","&:hover,:focus-within":{opacity:1,filter:"unset"}},".dashboard-visible-hidden-element":{position:"relative"},".dashboard-drop-target":{"&:is(:hover),&:not(:hover)":{outline:`2px solid ${M.colors.primary.border}`,outlineOffset:"0px",borderRadius:M.shape.radius.default}},".dashboard-draggable-transparent-selection":{"*::selection":{all:"inherit"}},".react-draggable-dragging":{opacity:.8}})}function m(M){return(0,a.css)({".delta-html":{background:M.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:M.colors.text.primary,fontFamily:M.typography.fontFamilyMonospace,fontSize:M.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:M.colors.text.secondary,display:"inline-block",fontSize:M.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:M.colors.text.primary,fontSize:M.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:M.v1.palette.gray5,".diff-line-number":{color:M.colors.text.primary}},".diff-json-new":{backgroundColor:M.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:M.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:M.colors.primary.shade},".diff-json-deleted":{backgroundColor:M.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:M.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:M.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:M.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:M.colors.action.hover,borderRadius:M.shape.radius.default,color:M.colors.text.primary,display:"inline",fontSize:`${M.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:M.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:M.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var p=e(27629),h=e(35484);function r(M,L){const A=L?{}:{overflowY:"auto !important"};return(0,a.css)({"*, *::before, *::after":{boxSizing:"inherit"},"[tabindex='-1']:focus":{outline:"none !important"},html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",boxSizing:"border-box",height:"100%",fontSize:`${M.typography.htmlFontSize}px`,fontFamily:M.typography.fontFamily,lineHeight:M.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:M.colors.mode},body:{height:"100%",width:"100%",position:"unset",color:M.colors.text.primary,backgroundColor:M.colors.background.canvas,paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0},fontVariantLigatures:"no-contextual",...M.typography.body,...A,fontVariantNumeric:(0,p.$)("tabularNumbers")?"tabular-nums":"initial"},"h1, .h1":g(M.typography.h1),"h2, .h2":g(M.typography.h2),"h3, .h3":g(M.typography.h3),"h4, .h4":g(M.typography.h4),"h5, .h5":g(M.typography.h5),"h6, .h6":g(M.typography.h6),p:{margin:M.spacing(0,0,2)},textarea:{overflow:"auto",resize:"vertical"},button:{letterSpacing:M.typography.body.letterSpacing,"&:focus-visible":(0,h.getFocusStyles)(M),"&:focus":{outline:"none"}},label:{display:"inline-block"},figure:{margin:M.spacing(0,0,2)},img:{verticalAlign:"middle"},fieldset:{minWidth:0,padding:0,margin:0,border:0},legend:{display:"block",width:"100%",padding:0,marginBottom:M.spacing(1),fontSize:M.spacing(3),lineHeight:"inherit",border:0},"small, .small":{fontSize:M.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:M.typography.fontWeightMedium},em:{fontStyle:"italic",color:M.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:M.spacing(0,0,0,2),margin:M.spacing(0,0,2),borderLeft:`5px solid ${M.v1.palette.gray3}`,p:{marginBottom:0,fontSize:M.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:M.typography.body.lineHeight,color:M.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:M.spacing(2),fontStyle:"normal",lineHeight:M.typography.body.lineHeight},"a.external-link":{color:M.colors.text.link,textDecoration:"normal","&:hover":{color:M.colors.text.link,textDecoration:"underline"}},".link":{color:M.colors.text.primary,cursor:"pointer"},".link:hover":{color:M.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:M.spacing(2),marginBottom:M.spacing(2),border:0,borderTop:`1px solid ${M.colors.border.medium}`},"mark, .mark":{background:M.colors.warning.main},"ul, ol, dl":{marginTop:0,marginBottom:0,padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:M.typography.body.lineHeight},dd:{marginBottom:M.spacing(1),marginLeft:0},"dt, dd":{lineHeight:M.typography.body.lineHeight},dt:{fontWeight:M.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{borderRadius:0,color:"inherit",font:"inherit",lineHeight:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]':{WebkitAppearance:"none"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{backgroundColor:"transparent",borderCollapse:"collapse",borderSpacing:0},caption:{paddingTop:M.spacing(.5),paddingBottom:M.spacing(.5),color:M.colors.text.secondary,textAlign:"left",captionSide:"bottom"},th:{fontWeight:M.typography.fontWeightMedium,textAlign:"left"},"td, th":{padding:0},".muted":{color:M.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:M.colors.text.primary},".text-warning":{color:M.colors.warning.text,"&:hover, &:focus":{color:M.colors.emphasize(M.colors.warning.text,.15)}},".text-error":{color:M.colors.error.text,"&:hover, &:focus":{color:M.colors.emphasize(M.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:M.colors.emphasize(M.colors.success.text,.15)}},a:{cursor:"pointer",color:M.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,h.getFocusStyles)(M),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},"[role='button']":{cursor:"pointer"},"[hidden]":{display:"none !important"},"a, area, button, [role='button'], input, label, select, summary, textarea":{touchAction:"manipulation"},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:M.components.textHighlight.background,color:M.components.textHighlight.text,padding:0},".template-variable":{color:M.colors.primary.text},".modal-header-title":{fontSize:M.typography.size.lg,float:"left",paddingTop:M.spacing(1),margin:M.spacing(0,2)}})}function g(M){return{margin:0,fontSize:M.fontSize,lineHeight:M.lineHeight,fontWeight:M.fontWeight,letterSpacing:M.letterSpacing,fontFamily:M.fontFamily,marginBottom:"0.45em"}}function y(M){return(0,a.css)({"iframe.intercom-borderless-frame":{colorScheme:M.colors.mode}})}function v(M){return(0,a.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-of-type(odd)":{background:M.colors.emphasize(M.colors.background.primary,.02)}},th:{width:"auto",padding:M.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:M.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:M.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:M.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:M.shape.radius.circle},"&--hover":{"tbody tr:hover":{background:M.colors.emphasize(M.colors.background.primary,.05)}}}})}function x(M){const L=typeof window<"u"&&window.__grafana_public_path__,A=L?`${L}fonts/`:"public/fonts/";return(0,a.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}inter/Inter-Medium.woff2') format('woff2')`}}])}function f(M){return(0,a.css)({"input, button, select, textarea":{fontFamily:M.typography.body.fontFamily,fontSize:M.typography.body.fontSize,fontWeight:M.typography.body.fontWeight,lineHeight:M.typography.body.lineHeight},"input, select":{backgroundColor:M.components.input.background,color:M.components.input.text,border:"none",boxShadow:"none"},"input, textarea":{"&::placeholder":{color:M.colors.text.disabled}},'input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button':{WebkitAppearance:"none",margin:0},'input[type="number"]':{MozAppearance:"textfield"},'select, input[type="file"]':{height:M.components.height.md,lineHeight:M.components.height.md},select:{width:"220px",border:`1px solid ${M.components.input.borderColor}`,backgroundColor:M.components.input.background},"select[multiple], select[size], textarea":{height:"auto"},'select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus':{outline:"5px auto -webkit-focus-ring-color",outlineOffset:"-2px"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"},"input[disabled], select[disabled], textarea[disabled], input[readonly], select[readonly], textarea[readonly]":{cursor:"not-allowed",backgroundColor:M.colors.action.disabledBackground},'input[type="radio"][disabled], input[type="checkbox"][disabled], input[type="radio"][readonly], input[type="checkbox"][readonly]':{cursor:"not-allowed",backgroundColor:"transparent"},"input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill, textarea:-webkit-autofill, textarea:-webkit-autofill:hover, textarea:-webkit-autofill:focus, select:-webkit-autofill, select:-webkit-autofill:hover, select:-webkit-autofill:focus":{WebkitBoxShadow:`0 0 0px 1000px ${M.components.input.background} inset !important`,WebkitTextFillColor:M.components.input.text,boxShadow:`0 0 0px 1000px ${M.components.input.background} inset`,border:`1px solid ${M.components.input.background}`},".gf-form":{display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",marginBottom:M.spacing(.5),"&--offset-1":{marginLeft:M.spacing(2)},"&--grow":{flexGrow:1},"&--flex-end":{justifyContent:"flex-end"},"&--align-center":{alignContent:"center"},"&--alt":{flexDirection:"column",alignItems:"flex-start",".gf-form-label":{padding:"4px 0"}}},".gf-form--has-input-icon":{position:"relative",marginRight:M.spacing(.5),".gf-form-input-icon":{position:"absolute",top:"8px",fontSize:M.typography.size.lg,left:"10px",color:M.colors.text.disabled},"> input":{paddingLeft:"35px","&:focus + .gf-form-input-icon":{color:M.colors.text.secondary}},".Select--multi .Select-multi-value-wrapper, .Select-placeholder":{paddingLeft:"30px"}},".gf-form-disabled":{color:M.colors.text.secondary,".gf-form-select-wrapper::after":{color:M.colors.text.secondary},"a, .gf-form-input":{color:M.colors.text.secondary}},".gf-form-group":{marginBottom:M.spacing(5)},".gf-form-inline":{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start","&--nowrap":{flexWrap:"nowrap"},"&--xs-view-flex-column":{flexDirection:"row",flexWrap:"nowrap",[M.breakpoints.down("sm")]:{flexDirection:"column"}},".select-container":{marginRight:M.spacing(.5)},".gf-form-spacing":{marginRight:M.spacing(.5)}},".gf-form-button-row":{paddingTop:M.spacing(3),"a, button":{marginRight:M.spacing(2)}},".gf-form-label":{display:"flex",alignItems:"center",padding:M.spacing(0,1),flexShrink:0,fontWeight:M.typography.fontWeightMedium,fontSize:M.typography.size.sm,backgroundColor:M.colors.background.secondary,height:"32px",lineHeight:"32px",marginRight:M.spacing(.5),borderRadius:M.shape.radius.default,justifyContent:"space-between",border:"none","&--grow":{flexGrow:1},"&--transparent":{backgroundColor:"transparent",border:0,textAlign:"right",paddingLeft:0},"&--variable":{color:M.colors.primary.text,background:M.components.panel.background,border:`1px solid ${M.components.panel.borderColor}`},"&--btn":{border:"none",borderRadius:M.shape.radius.default,"&:hover":{background:M.colors.background.secondary,color:M.colors.text.primary}},"&:disabled":{color:M.colors.text.secondary}},".gf-form-label + .gf-form-label":{marginRight:M.spacing(.5)},".gf-form-pre":{display:"block !important",flexGrow:1,margin:0,marginRight:M.spacing(.5),border:"1px solid transparent",borderLeft:"none",borderRadius:M.shape.radius.default},".gf-form-textarea":{maxWidth:"650px"},".gf-form-input":{display:"block",width:"100%",height:"32px",padding:M.spacing(0,1),fontSize:M.typography.size.md,lineHeight:"18px",color:M.components.input.text,backgroundColor:M.components.input.background,backgroundImage:"none",backgroundClip:"padding-box",border:`1px solid ${M.components.input.borderColor}`,borderRadius:M.shape.radius.default,marginRight:M.spacing(.5),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&textarea":{overflow:"auto",whiteSpace:"pre-wrap",padding:`6px ${M.spacing(1)}`,minHeight:"32px",height:"auto"},"&::-ms-expand":{backgroundColor:"transparent",border:0,display:"none"},"&:focus":{borderColor:M.colors.primary.border,outline:"none"},"&::placeholder":{color:M.colors.text.disabled,opacity:1},"&:disabled, &[readonly]":{backgroundColor:M.colors.action.disabledBackground,opacity:1},"&:disabled":{cursor:"not-allowed"},"&.gf-size-auto":{width:"auto"},"&--dropdown":{paddingRight:M.spacing(3),position:"relative",display:"flex",alignItems:"center","&::after":{position:"absolute",top:"36%",right:"11px",fontSize:"11px",backgroundColor:"transparent",color:M.colors.text.primary,font:`normal normal normal ${M.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none"}},"&--has-help-icon":{paddingRight:M.spacing(4)}},".gf-form-select-wrapper":{position:"relative",backgroundColor:M.components.input.background,marginRight:M.spacing(.5),".gf-form-select-icon":{position:"absolute",zIndex:1,top:"50%",marginTop:"-7px","+ .gf-form-input":{position:"relative",zIndex:2,paddingLeft:M.spacing(4),backgroundColor:"transparent",option:{color:M.v1.palette.black}}},".gf-form-input":{marginRight:0,lineHeight:"32px"},"select.gf-form-input":{textIndent:"0.01px",textOverflow:"''",paddingRight:M.spacing(4),appearance:"none","&:-moz-focusring":{outline:"none",color:"transparent",textShadow:`0 0 0 ${M.colors.text.primary}`},"&.ng-empty":{color:M.colors.text.secondary}},"&::after":{position:"absolute",top:"36%",right:"11px",backgroundColor:"transparent",color:M.colors.text.primary,font:`normal normal normal ${M.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none",fontSize:"11px"},"&--has-help-icon":{"&::after":{right:M.spacing(4)}}},".gf-form--v-stretch":{alignItems:"stretch"},".gf-form-btn":{padding:M.spacing(0,1),marginRight:M.spacing(.5),lineHeight:"18px",fontSize:M.typography.size.sm,flexShrink:0,flexGrow:0},".gf-form-help-icon":{flexGrow:0,color:M.colors.text.secondary,"&:hover":{color:M.colors.text.primary}},".cta-form":{position:"relative",padding:M.spacing(3),backgroundColor:M.colors.background.secondary,marginBottom:M.spacing(3),borderTop:`3px solid ${M.colors.success.main}`},".input-small":{width:"90px"}})}function u(M){return(0,a.css)([])}function b(M){return(0,a.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:M.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:M.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:M.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:M.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:M.isDark?M.colors.primary.text:M.colors.primary.main},".json-formatter-boolean":{color:M.isDark?M.colors.primary.text:M.colors.error.main},".json-formatter-null":{color:M.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:M.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:M.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:M.isDark?"#027bff":M.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:M.isDark?"#9494ff":M.colors.primary.main},".json-formatter-key":{color:M.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:M.spacing(.25),marginRight:M.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:M.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:M.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:M.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function E(M){return(0,a.css)({".gf-form-select-box__control":{width:"100%",marginRight:M.spacing(.5),backgroundColor:M.components.input.background,border:`1px solid ${M.components.input.borderColor}`,borderRadius:M.shape.radius.default,color:M.components.input.text,cursor:"default",height:M.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:M.components.input.background,borderColor:M.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${M.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:M.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:M.colors.background.primary,boxShadow:M.shadows.z3,position:"absolute",zIndex:M.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:M.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:M.components.input.background,"&.gf-form-select-box__option--is-focused":{color:M.colors.text.primary,background:M.colors.action.hover,borderImage:M.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:M.colors.text.primary}}},".gf-form-select-box__placeholder":{color:M.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:M.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:M.typography.bodySmall.fontSize,color:M.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${M.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function D(M){return(0,a.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:M.spacing(3),marginBottom:M.spacing(2)},table:{marginBottom:M.spacing(2),"td, th":{padding:M.spacing(.5,1)},th:{fontWeight:M.typography.fontWeightMedium,background:M.colors.background.secondary}},"table, th, td":{border:`1px solid ${M.colors.border.medium}`,borderCollapse:"collapse"},a:{color:M.colors.text.link,textDecoration:"none","&:hover":{color:M.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function C(M){const L=M.breakpoints.values.xxl+M.spacing.gridSize*2+M.components.sidemenu.width;return(0,a.css)({".grafana-app":{display:"flex",flexDirection:"column",height:"100vh"},".main-view":{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:M.spacing(2),paddingRight:M.spacing(2),[M.breakpoints.up("sm")]:{margin:M.spacing(0,1)},[M.breakpoints.up("md")]:{margin:M.spacing(0,2)},[`@media (min-width: ${L}px)`]:{maxWidth:`${M.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:M.spacing(2),paddingLeft:M.spacing(2),paddingRight:M.spacing(2)},".page-body":{padding:M.spacing(1),background:M.components.panel.background,border:`1px solid ${M.components.panel.borderColor}`,marginBottom:"32px",[M.breakpoints.up("md")]:{padding:M.spacing(2)},[M.breakpoints.up("lg")]:{padding:M.spacing(3)}},".page-heading":{fontSize:M.typography.h4.fontSize,marginTop:0,marginBottom:M.spacing(2)},".page-action-bar":{marginBottom:M.spacing(2),display:"flex",alignItems:"flex-start",gap:M.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:M.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:M.spacing(2)},".page-sub-heading-icon":{marginLeft:M.spacing(1),marginTop:M.spacing(.5)},".page-hidden":{display:"none"}})}function P(M){return(0,a.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:M.colors.text.secondary}}},".query-keyword":{fontWeight:M.typography.fontWeightMedium,color:`${M.colors.primary.text} !important`},".query-part":{backgroundColor:M.colors.background.secondary,"&:hover":{background:M.colors.emphasize(M.colors.background.secondary,.03)}},".query-segment-operator":{color:`${M.v1.palette.orange} !important`},".tight-form-func":{background:M.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:M.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}var T=e(21348);const O=M=>(0,a.css)({".react-loading-skeleton":T.Q});function I(M){return(0,a.css)({".slate-query-field":{fontSize:M.typography.fontSize,fontFamily:M.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:M.colors.text.primary,backgroundColor:M.components.input.background,backgroundImage:"none",border:`1px solid ${M.components.input.borderColor}`,borderRadius:M.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:M.zIndex.typeahead,borderRadius:M.shape.radius.default,border:`1px solid ${M.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:M.components.panel.background,color:M.colors.text.primary,boxShadow:M.shadows.z2},".typeahead-group__title":{color:M.colors.text.secondary,fontSize:M.typography.size.sm,lineHeight:M.typography.body.lineHeight,padding:M.spacing(1)},".typeahead-item":{height:"auto",fontFamily:M.typography.fontFamilyMonospace,padding:M.spacing(1,1,1,2),fontSize:M.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:M.isDark?M.v1.palette.dark9:M.v1.palette.gray6,".typeahead-item-hint":{fontSize:M.typography.size.xs,color:M.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:M.v1.palette.yellow,borderBottom:`1px solid ${M.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:M.colors.text.secondary},".token.variable, .token.entity":{color:M.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:M.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:M.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:M.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:M.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function j(M){return(0,a.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function W(M,L,A="#fff",U="0px 1px 0 rgba(0, 0, 0, 0.1)"){return{backgroundColor:M,backgroundImage:`linear-gradient(to bottom, ${M}, ${L})`,backgroundRepeat:"repeat-x",color:A,textShadow:U,borderColor:M,"&:hover, &:focus, &:active, &.active, &.disabled, &[disabled]":{color:A,backgroundImage:"none",backgroundColor:M}}}function B(M,L,A,U){return{padding:`${M} ${L}`,fontSize:A,borderRadius:U}}function S(M,L){let A={};for(let U=1;U<=L;U++){const F=`${M.spacing(2*U)} !important`;A[`.width-${U}`]={width:F},A[`.max-width-${U}`]={maxWidth:F,flexGrow:1},A[`.min-width-${U}`]={minWidth:F},A[`.offset-width-${U}`]={marginLeft:F}}return A}function w(M){return(0,a.css)({".highlight-word":{color:M.v1.palette.orange},".hide":{display:"none"},".show":{display:"block"},".invisible":{visibility:"hidden !important"},".absolute":{position:"absolute"},".flex-grow-1":{flexGrow:1},".flex-shrink-1":{flexShrink:1},".flex-shrink-0":{flexShrink:0},".center-vh":{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",justifyItems:"center"},".btn":{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:M.typography.fontWeightMedium,lineHeight:M.typography.body.lineHeight,textAlign:"center",verticalAlign:"middle",cursor:"pointer",border:"none",height:`${M.spacing.gridSize*M.components.height.md}px`,...B(M.spacing(0),M.spacing(2),`${M.typography.fontSize}px`,M.shape.radius.default),"&, &:active, &.active":{"&:focus, &.focus":{outline:"none"}},"&:focus, &:hover":{textDecoration:"none"},"&.focus":{textDecoration:"none"},"&:active, &.active":{backgroundImage:"none",outline:0},"&.disabled, &[disabled], &:disabled":{cursor:"not-allowed",opacity:.65,boxShadow:"none",pointerEvents:"none"}},".btn-small":{...B(M.spacing(.5),M.spacing(1),M.typography.size.sm,M.shape.radius.default),height:`${M.spacing.gridSize*M.components.height.sm}px`},".btn-mini":{...B(M.spacing(.5),M.spacing(1),M.typography.size.sm,M.shape.radius.default),height:`${M.spacing.gridSize*M.components.height.sm}px`},".btn-success, .btn-primary":{...W(M.colors.primary.main,M.colors.primary.shade)},".btn-danger":{...W(M.colors.error.main,M.colors.error.shade)},".btn-secondary":{...W(M.colors.secondary.main,M.colors.secondary.shade,M.colors.text.primary)},".btn-inverse":{...W(M.isDark?M.v1.palette.dark6:M.v1.palette.gray5,M.isDark?M.v1.palette.dark5:M.v1.palette.gray4,M.colors.text.primary),"&":{boxShadow:"none"}},".typeahead":{zIndex:M.zIndex.typeahead},...S(M,30),".row":{display:"flex",flexWrap:"wrap",marginLeft:`calc(${M.spacing(4)} / -2)`,marginRight:`calc(${M.spacing(4)} / -2)`},".container":{marginLeft:"auto",marginRight:"auto",paddingLeft:`calc(${M.spacing(4)} / 2)`,paddingRight:`calc(${M.spacing(4)} / 2)`,[M.breakpoints.up("sm")]:{maxWidth:M.breakpoints.values.sm},[M.breakpoints.up("md")]:{maxWidth:M.breakpoints.values.md},[M.breakpoints.up("lg")]:{maxWidth:M.breakpoints.values.lg},[M.breakpoints.up("xl")]:{maxWidth:M.breakpoints.values.xl}}})}function N(M){const L=(0,s.$j)(),{isExtensionSidebarOpen:A}=M;return(0,n.jsx)(a.Global,{styles:[l(L),o(L),i(L),m(L),c(L),r(L,A),y(L),v(L),x(L),f(L),b(L),d(L),D(L),C(L),P(L),O(L),I(L),j(L),w(L),E(L),u({})]})}},53926:(Z,R,e)=>{"use strict";e.d(R,{I:()=>n});var n=(a=>(a.GroupTitle="GroupTitle",a))(n||{})},14226:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>n});const n=(a,s)=>{a.key==="Tab"||a.altKey||a.ctrlKey||a.metaKey||(a.stopPropagation(),a.key==="Escape"&&s())}},8255:(Z,R,e)=>{"use strict";e.d(R,{Ih:()=>f,Mk:()=>o,Tj:()=>h,UJ:()=>p,Xw:()=>d,ct:()=>m,mZ:()=>x,nO:()=>c,sg:()=>v,xj:()=>i});var n=e(2543),a=e.n(n),s=e(84140);const l=4,o="rgba(0, 211, 255, 1)",d="rgba(11, 237, 50, 1)",i="rgba(237, 46, 24, 1)",c="rgba(150, 150, 150, 1)",m="rgba(247, 149, 32, 1)",p=.09,h=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function r(u){const b=(0,n.map)(u,g),E=(0,n.sortBy)(b,["h"]),D=(0,n.chunk)(E,l),C=(0,n.map)(D,T=>(0,n.sortBy)(T,"l")),P=(0,n.flattenDeep)((0,n.zip)(...C));return(0,n.map)(P,y)}function g(u){return(0,s.A)(u).toHsl()}function y(u){return(0,s.A)(u).toHexString()}function v(u){return(0,s.A)(u).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function x(u,b){const E=(0,s.A)(u),D=E.getBrightness();return E.getAlpha()<.3?b?"rgb(247, 248, 250)":"rgb(32, 34, 38)":D>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let f=r(h)},75254:(Z,R,e)=>{"use strict";e.d(R,{J:()=>n});const n=a=>a().map(s=>({label:s.title,ariaLabel:s.title,url:s.href,target:s.target,icon:`${s.target==="_blank"?"external-link-alt":"link"}`,onClick:s.onClick}))},20720:(Z,R,e)=>{"use strict";e.d(R,{h:()=>n});function n(a,s,l){}},27629:(Z,R,e)=>{"use strict";e.d(R,{$:()=>n});function n(a,s=!1){return window.grafanaBootData?.settings.featureToggles[a]??s}},28473:(Z,R,e)=>{"use strict";e.d(R,{i:()=>n});function n(a){const l=a.lastIndexOf("."),o=a.substring(l),d=a.substring(0,l);return d.length<16?a:`${d.substring(0,16)}...${o}`}},63267:(Z,R,e)=>{"use strict";e.d(R,{I:()=>s});var n=e(2543),a=e.n(n);function s(l,o){let d=0,i=l.indexOf(o);o=o.replace(/\s/g,"");const c=[];if(i!==-1)return{distance:0,found:!0,ranges:[{start:i,end:i+o.length-1}]};for(const m of o){const p=l.indexOf(m,i);if(p===-1)return{distance:1/0,ranges:[],found:!1};if(i!==-1&&(d+=p-i),i=p+1,c.length===0)c.push({start:p,end:p});else{const h=(0,n.last)(c);p===h.end+1?h.end++:c.push({start:p,end:p})}}return{distance:d,ranges:c,found:!0}}},60379:(Z,R,e)=>{"use strict";e.d(R,{h:()=>l});var n=e(2543),a=e.n(n);const s=(0,n.throttle)((...o)=>{console.log(...o)},500),l=o=>{let d=!1;return typeof window<"u"&&(d=window.localStorage.getItem("grafana.debug")==="true"),{logger:(i,c=!1,...m)=>{},enable:()=>d=!0,disable:()=>d=!1,isEnabled:()=>d}}},53568:(Z,R,e)=>{"use strict";e.d(R,{Vr:()=>i,Yc:()=>o,kD:()=>d});let n;const a=new Map,s=500;let l="";function o(){return n||(n=document.createElement("canvas").getContext("2d")),n}function d(c,m,p=400){const h=`${p} ${m}px 'Inter'`,r=c+h,g=a.get(r);if(g)return g;const y=o();l!==h&&(y.font=l=h);const v=y.measureText(c);return a.size===s&&a.clear(),a.set(r,v),v}function i(c,m,p,h,r,g){const y=d(c,14,g),v=m/(y.width+2)*14,x=p/h,f=Math.min(x,v);return Math.min(f,r??f)}},44019:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{getChildId:()=>a,renderOrCallToRender:()=>s});var n=e(96540);function a(l){let o;const d=n.Children.only(l);return"id"in d?.props?o=d.props.id:"inputId"in d.props&&(o=d?.props.inputId),typeof o=="string"?o:void 0}function s(l,o){if(n.isValidElement(l)||typeof l=="string"||typeof l=="number")return l;if(typeof l=="function"&&o)return l(o);throw new Error(`${l} is not a React element nor a function that returns React element`)}},59258:(Z,R,e)=>{"use strict";e.d(R,{H:()=>d,T:()=>a});var n=e(63267),a=(i=>(i.Word="Word",i.Prefix="Prefix",i.Fuzzy="Fuzzy",i))(a||{});const d={Word:(i,c)=>i.filter(m=>(m.filterText||m.label).includes(c)),Prefix:(i,c)=>i.filter(m=>(m.filterText||m.label).startsWith(c)),Fuzzy:(i,c)=>(c=c.toLowerCase(),i.filter(m=>{const{distance:p,ranges:h,found:r}=(0,n.I)(m.label.toLowerCase(),c);return r?(m.sortValue=p,m.highlightParts=h,!0):!1}))}},21348:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>l,j:()=>o});var n=e(74848),a=e(22803);const l={animationName:(0,a.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},o=(d,i)=>Object.assign(d,{Skeleton:m=>(0,n.jsx)(i,{...m,rootProps:{style:l}})})},35458:(Z,R,e)=>{"use strict";e.d(R,{dF:()=>s,mO:()=>l,yx:()=>a});var n=e(82611);const a={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},s=(o,d)=>{const i=o.split(`
`).map(m=>n.Block.create({type:"code_line",nodes:[n.Text.create(m)]})),c=n.Block.create({data:{syntax:d},type:"code_block",nodes:i});return n.Document.create({nodes:[c]})},l=(o,d)=>{const i=s(o,d);return n.Value.create({document:i})}},86059:(Z,R,e)=>{"use strict";e.d(R,{k:()=>n});const n=(a,s)=>{let l;if(a.getLinks&&(l=a.getLinks({valueRowIndex:s.index})),!!l){for(let o=0;o<l?.length;o++)if(l[o].onClick){const d=l[o].onClick;l[o].onClick=i=>{i.ctrlKey||i.metaKey||i.shiftKey||(i.preventDefault(),d(i,{field:a,rowIndex:s.index}))}}return l.filter(o=>o.href||o.onClick!=null)}}},48542:(Z,R,e)=>{"use strict";e.d(R,{JF:()=>s,MC:()=>l,yC:()=>o});const n=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],a=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function s(c=""){const m=d(c.toLowerCase());return Math.abs(m%n.length)}function l(c=""){const m=s(c);return o(m)}function o(c){return{color:n[c],borderColor:a[c]}}function d(c){let m=5381;for(let p=0;p<c.length;p++)m=(m<<5)+m+c.charCodeAt(p);return m}var i={getTagColorsFromName:l}},79104:(Z,R,e)=>{"use strict";e.d(R,{C:()=>a});var n=e(96540);function a(){const[s,l]=(0,n.useState)(0);return(0,n.useCallback)(()=>l(o=>o+1),[])}},36324:(Z,R,e)=>{"use strict";e.d(R,{C:()=>s,b:()=>a});var n=e(96540);function a(d=10){let i={x:0,y:0};return{set:p=>{i=l(p)},check:(p,h=d)=>o(i,l(p),h)}}function s(d=10){const i=n.useRef({x:0,y:0}),c=(0,n.useCallback)(p=>{i.current=l(p)},[]),m=(0,n.useCallback)((p,h=d)=>o(i.current,l(p),h),[d]);return(0,n.useMemo)(()=>({set:c,check:m}),[c,m])}function l(d){return{x:d.clientX,y:d.clientY}}function o(d,i,c){return Math.hypot(d.x-i.x,d.y-i.y)>c}},75745:(Z,R,e)=>{"use strict";e.d(R,{K:()=>s,Pw:()=>n,RP:()=>l,tf:()=>a});var n=(o=>(o.onBlur="onBlur",o.onFocus="onFocus",o.onChange="onChange",o))(n||{});const a=(o,d)=>{const i=d.reduce((c,m)=>m.rule(o)?c:c.concat(m.errorMessage),[]);return i.length>0?i:null},s=(o,d)=>d&&d[o],l=(o,d)=>({rule:i=>!!i.match(o),errorMessage:d||"Value is not valid"})},88486:(Z,R,e)=>{"use strict";e.d(R,{Nz:()=>Nl,J3:()=>Cl,rC:()=>Dl,Pl:()=>Wl});var n=e(74848),a=e(1503),s=e(96540),l=e(35254),o=e(71468),d=e(54148),i=e(43173),c=e(36490),m=e(27489),p=e(72296),h=e(36303),r=e(15245),g=e(39799),y=e(8535),v=e(58449),x=e(77345);const f=()=>{const{isOpen:Ee}=(0,v.sA)();return(0,n.jsx)(x.k,{isExtensionSidebarOpen:Ee})};var u=e(27963),b=e(15130),E=e(22803),D=e(92138),C=e(75683),P=e(92745),T=e(63142),O=e(45861),I=e(56297),j=e(13791);function W({error:Ee,errorInfo:et}){const nt=(0,d.zy)(),Ct=Ee?.name==="ChunkLoadError",vt=(0,T.of)(B);return(0,s.useEffect)(()=>{Ct&&nt.search.indexOf("chunkNotFound")===-1&&(window.location.href=D.I.getUrlForPartial(nt,{chunkNotFound:!0}))},[nt,Ct]),(0,n.jsx)(j.Y,{navId:"error",layout:C.k.Canvas,children:(0,n.jsxs)("div",{className:vt.container,children:[Ct&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:(0,n.jsx)(P.x6,{i18nKey:"route-error.title",children:"Unable to find application file"})}),(0,n.jsx)("br",{}),(0,n.jsx)("h2",{className:"page-heading",children:(0,n.jsx)(P.x6,{i18nKey:"route-error.description",children:"Grafana has likely been updated. Please try reloading the page."})}),(0,n.jsx)("br",{}),(0,n.jsx)(O.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:(0,n.jsx)(P.x6,{i18nKey:"route-error.reload-button",children:"Reload"})}),(0,n.jsx)(I.D,{title:(0,P.t)("route-error.error-title","Error details"),error:Ee,errorInfo:et})]}),!Ct&&(0,n.jsx)(I.D,{title:(0,P.t)("route-error.error-unexpected-title","An unexpected error happened"),error:Ee,errorInfo:et})]})})}const B=Ee=>({container:(0,E.css)({width:"500px",margin:Ee.spacing(8,"auto")})});var S=e(42581);function w(){const Ee=(0,T.of)(U);return(0,n.jsx)("div",{className:Ee.container,"aria-live":"polite",role:"status","aria-label":(0,P.t)("bouncing-loader.label","Loading"),children:(0,n.jsx)("div",{className:Ee.bounce,children:(0,n.jsx)("img",{alt:"",src:S,className:Ee.logo})})})}const N=(0,E.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),M=(0,E.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),L=(0,E.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),A=(0,E.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),U=Ee=>({container:(0,E.css)({opacity:0,[Ee.transitions.handleMotion("no-preference")]:{animationName:N,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[Ee.transitions.handleMotion("reduce")]:{animationName:M,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,E.css)({textAlign:"center",[Ee.transitions.handleMotion("no-preference")]:{animationName:L,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,E.css)({display:"inline-block",[Ee.transitions.handleMotion("no-preference")]:{animationName:A,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function F(){const Ee=(0,T.of)(V);return(0,n.jsx)("div",{className:Ee.loadingPage,children:(0,n.jsx)(w,{})})}const V=Ee=>({loadingPage:(0,E.css)({backgroundColor:Ee.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function K(Ee){const{chrome:et,keybindings:nt}=(0,u.Il)();return et.setMatchedRoute(Ee.route),(0,s.useLayoutEffect)(()=>{nt.clearAndInitGlobalBindings(Ee.route)},[nt,Ee.route]),(0,s.useEffect)(()=>(_(Ee.route),k(),(0,c.Lc)("GrafanaRoute",!1,"Mounted",Ee.route),()=>{(0,c.Lc)("GrafanaRoute",!1,"Unmounted",Ee.route),_(Ee.route,!0)}),[]),(0,s.useEffect)(()=>{k(),(0,m.Jy)(),(0,c.Lc)("GrafanaRoute",!1,"Updated",Ee)}),(0,c.Lc)("GrafanaRoute",!1,"Rendered",Ee.route),(0,n.jsx)(h.tH,{dependencies:[Ee.route],children:({error:Ct,errorInfo:vt})=>Ct?(0,n.jsx)(W,{error:Ct,errorInfo:vt}):(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(F,{}),children:(0,n.jsx)(Ee.route.component,{...Ee,queryParams:(0,c.SE)(Ee.location.search)})})})}function G({route:Ee}){const et=(0,d.zy)(),nt=Ee.roles?Ee.roles():[];return nt?.length&&!nt.some(Ct=>b.TP.hasRole(Ct))?(0,n.jsx)(d.C5,{replace:!0,to:"/"}):(0,n.jsx)(K,{route:Ee,location:et})}function H(Ee){return Ee.pageClass?Ee.pageClass.split(" "):[]}function _(Ee,et=!1){for(const nt of H(Ee))et?document.body.classList.remove(nt):document.body.classList.add(nt)}function k(){document.body.classList.remove("sidemenu-open--xs");const Ee=document.getElementById("tooltip");Ee?.parentElement?.removeChild(Ee);const et=document.querySelectorAll(".tooltip");for(let nt=0;nt<et.length;nt++){const Ct=et[nt];Ct.parentElement?.removeChild(Ct)}}var J=e(6007),z=e(90382),Y=e(33184),X=e(34999),Q=e(65240);class q extends s.PureComponent{constructor(){super(...arguments),this.styles=te(i.$.theme2),this.state={},this.initListener=()=>{const et=(0,Y.oF)();et&&(this.subscription=et.getConnectionState().subscribe({next:nt=>{this.setState({show:!nt})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:et}=this.state;return et?!b.TP.isSignedIn||!i.$.liveEnabled||b.TP.user.orgRole===z.X.None?null:(0,n.jsx)(X.F,{severity:"warning",className:this.styles.warn,title:(0,P.t)("live.live-connection-warning.title-connection-to-server-is-lost","Connection to server is lost...")}):null}}const te=(0,Q.N)(Ee=>({warn:(0,E.css)({position:"fixed",bottom:0,left:"50%",transform:"translate(-50%)",maxWidth:"400px",zIndex:Ee.zIndex.portal,cursor:"wait"})}));var ne=e(28337),se=e(63629),ue=e(69896),de=e(68143),ie=e(85618);const he="scope.grafana.app",me="v0alpha1",ce=(0,ie.Ge)(),Pe=`/apis/${he}/${me}/namespaces/${ce}`;class Ie{constructor(){this.fetchDashboards=async et=>{try{return(await(0,de.AI)().get(Pe+"/find/scope_dashboard_bindings",{scope:et}))?.items??[]}catch{return[]}},this.fetchScopeNavigations=async et=>{try{return(await(0,de.AI)().get(Pe+"/find/scope_navigations",{scope:et}))?.items??[]}catch{return[]}}}async fetchScope(et){try{return await(0,de.AI)().get(Pe+`/scopes/${et}`)}catch(nt){console.error(nt);return}}async fetchMultipleScopes(et){return(await Promise.all(et.map(Ct=>this.fetchScope(Ct)))).filter(Ct=>Ct!==void 0)}async fetchNodes(et){const nt=et.limit??1e3;if(!(0<nt&&nt<=1e4))throw new Error("Limit must be between 1 and 10000");try{return(await(0,de.AI)().get(Pe+"/find/scope_node_children",{parent:et.parent,query:et.query,limit:nt}))?.items??[]}catch{return[]}}}var Se=e(2543),Me=e(49426),Te=e(49510),Ge=e(81160),Qe=e(41900);class tt{constructor(et,nt,Ct){this.selectorService=et,this.dashboardsService=nt,this.locationService=Ct,this.subscriptions=[],this.updateState=Pt=>{this._state.next({...this._state.getValue(),...Pt})},this.changeScopes=Pt=>this.selectorService.changeScopes(Pt),this.setReadOnly=Pt=>{this.state.readOnly!==Pt&&this.updateState({readOnly:Pt}),Pt&&this.selectorService.state.opened&&this.selectorService.closeAndReset()},this.setEnabled=Pt=>{this.state.enabled!==Pt&&(this.updateState({enabled:Pt}),Pt&&this.locationService.partial({scopes:this.selectorService.state.appliedScopes.map(fe=>fe.scopeId)},!0))},this._state=new Me.t({enabled:!1,readOnly:!1}),this._stateObservable=new Me.t({...this._state.getValue(),value:this.selectorService.state.appliedScopes.map(Pt=>this.selectorService.state.scopes[Pt.scopeId]).filter(Pt=>Pt),loading:this.selectorService.state.loading,drawerOpened:this.dashboardsService.state.drawerOpened}),this.subscriptions.push((0,Te.z)([this._state.asObservable(),this.getSelectorServiceStateObservable(),this.getDashboardsServiceStateObservable()]).pipe((0,Ge.T)(([Pt,fe,ae])=>({...Pt,value:fe.selectedScopes,loading:fe.loading,drawerOpened:ae.drawerOpened}))).subscribe(this._stateObservable));const vt=new URLSearchParams(Ct.getLocation().search);this.changeScopes(vt.getAll("scopes")),this.subscriptions.push(Ct.getLocationObservable().subscribe(Pt=>{if(!this.state.enabled)return;const ae=new URLSearchParams(Pt.search).getAll("scopes");ae.length&&this.changeScopes(ae)})),this.subscriptions.push(et.subscribeToState((Pt,fe)=>{const ae=fe.appliedScopes.map(Le=>Le.scopeId),xe=Pt.appliedScopes.map(Le=>Le.scopeId);(0,Se.isEqual)(ae,xe)||this.locationService.partial({scopes:xe},!0)}))}get state(){return this._stateObservable.value}get stateObservable(){return this._stateObservable}getSelectorServiceStateObservable(){return this.selectorService.stateObservable.pipe((0,Ge.T)(et=>({selectedScopes:et.appliedScopes.map(nt=>et.scopes[nt.scopeId]).filter(nt=>nt),loading:et.loading})),(0,Qe.F)((et,nt)=>et.loading===nt.loading&&(0,Se.isEqual)(et.selectedScopes,nt.selectedScopes)))}getDashboardsServiceStateObservable(){return this.dashboardsService.stateObservable.pipe((0,Qe.F)((et,nt)=>et.drawerOpened===nt.drawerOpened))}cleanUp(){for(const et of this.subscriptions)et.unsubscribe()}}var ke=e(97256);class He{constructor(et){this.subscribeToState=nt=>this._state.pipe((0,ke.J)()).subscribe(([Ct,vt])=>nt(vt,Ct)),this.updateState=nt=>{this._state.next(Object.freeze({...this.state,...nt}))},this._state=new Me.t(Object.freeze(et))}get state(){return this._state.getValue()}get stateObservable(){return this._state.asObservable()}}class Re extends He{constructor(et){super({drawerOpened:!1,dashboards:[],scopeNavigations:[],filteredFolders:{},folders:{},forScopeNames:[],loading:!1,searchQuery:""}),this.apiClient=et,this.updateFolder=(nt,Ct)=>{let vt={...this.state.folders},Pt={...this.state.filteredFolders},fe=vt,ae=Pt;for(let at=0;at<nt.length-1;at++)fe=fe[nt[at]].folders,ae=ae[nt[at]].folders;const xe=nt[nt.length-1],Le=fe[xe],Ze=ae[xe];Le.expanded=Ct,Ze.expanded=Ct,this.updateState({folders:vt,filteredFolders:Pt})},this.changeSearchQuery=nt=>{nt=nt??"";const Ct=this.filterFolders(this.state.folders,nt);this.updateState({filteredFolders:Ct,searchQuery:nt})},this.clearSearchQuery=()=>{this.changeSearchQuery("")},this.fetchDashboards=async nt=>{if((0,Se.isEqual)(this.state.forScopeNames,nt))return;if(nt.length===0){this.updateState({dashboards:[],filteredFolders:{},folders:{},forScopeNames:[],loading:!1,drawerOpened:!1});return}this.updateState({forScopeNames:nt,loading:!0});const vt=await(i.$.featureToggles.useScopesNavigationEndpoint?this.apiClient.fetchScopeNavigations:this.apiClient.fetchDashboards)(nt);if((0,Se.isEqual)(this.state.forScopeNames,nt)){const Pt=this.groupSuggestedItems(vt),fe=this.filterFolders(Pt,this.state.searchQuery);this.updateState({scopeNavigations:vt,filteredFolders:fe,folders:Pt,loading:!1,drawerOpened:vt.length>0})}},this.groupSuggestedItems=nt=>{const Ct=c.Ny.getLocation().pathname,vt=Ct.startsWith("/d/"),Pt={"":{title:"",expanded:!0,folders:{},suggestedNavigations:{}}};return nt.forEach(fe=>{const ae=Pt[""],xe=fe.status.groups??[];let Le=!1;if(vt&&"dashboard"in fe.spec){const at=Ct.split("/")[2];Le=fe.spec.dashboard===at}"url"in fe.spec&&(Le=Ct.startsWith(fe.spec.url)),xe.forEach(at=>{const ut=!!ae.folders[at],Et=ut&&ae.folders[at].expanded;at&&!ut&&(ae.folders[at]={title:at,expanded:Le,folders:{},suggestedNavigations:{}}),at&&Le&&!Et&&(ae.folders[at].expanded=!0)}),(xe.length>0?xe.map(at=>at===""?ae.suggestedNavigations:ae.folders[at].suggestedNavigations):[ae.suggestedNavigations]).forEach(at=>{"dashboard"in fe.spec&&"dashboardTitle"in fe.status&&!at[fe.spec.dashboard]?at[fe.spec.dashboard]={url:"/d/"+fe.spec.dashboard,title:fe.status.dashboardTitle,id:fe.spec.dashboard}:"url"in fe.spec&&"title"in fe.status&&!at[fe.spec.url]&&(at[fe.spec.url]={title:fe.status.title||fe.metadata.name,url:fe.spec.url,id:fe.metadata.name})})}),Pt},this.filterFolders=(nt,Ct)=>(Ct=(Ct??"").toLowerCase(),Object.entries(nt).reduce((vt,[Pt,fe])=>{if(fe.title.toLowerCase().includes(Ct))return vt[Pt]={...fe,expanded:!0},vt;const ae=this.filterFolders(fe.folders,Ct),xe=Object.entries(fe.suggestedNavigations).filter(([Le,Ze])=>Ze.title.toLowerCase().includes(Ct));return(Object.keys(ae).length>0||xe.length>0)&&(vt[Pt]={...fe,expanded:!0,folders:ae,suggestedNavigations:Object.fromEntries(xe)}),vt},{})),this.toggleDrawer=()=>this.updateState({drawerOpened:!this.state.drawerOpened})}}var Ne=e(78012);function Ae(Ee){const et={...Ee};if(et.expanded=!1,et.children){et.children={...et.children};for(const nt of Object.keys(et.children))et.children[nt]=Ae(et.children[nt])}return et}function Ue(Ee,et){let nt={...Ee},Ct=nt;Ct.expanded=!0;const vt=et.slice(1);for(const Pt of vt){const fe=Ct.children?.[Pt];if(!fe)throw new Error(`Node ${Pt} not found in tree`);const ae={...fe};Ct.children={...Ct.children},Ct.children[Pt]=ae,ae.expanded=!0,Ct=ae}return nt}function Be(Ee){return Ee.spec.nodeType==="container"}function We(Ee){return Ee.spec.linkType==="scope"}function _e(Ee,et){if(Ee==="")return[""];const nt=[Ee];let Ct=et[Ee]?.spec.parentName;for(;Ct;)nt.unshift(Ct),Ct=et[Ct]?.spec.parentName;return nt.unshift(""),nt}function Xe(Ee,et,nt){if(et.length<1)return Ee;const Ct={...Ee};let vt=Ct;if(et.length===1&&et[0]==="")return nt(vt),Ct;for(const Pt of et.slice(1)){if(!vt.children?.[Pt])return Ct;vt.children={...vt.children},vt.children[Pt]={...vt.children[Pt]},vt=vt.children[Pt]}return nt(vt),Ct}function le(Ee,et){if(et.length<1)return;if(et.length===1&&et[0]==="")return Ee;let nt=Ee;for(const Ct of et.slice(1))if(nt=nt.children?.[Ct],!nt)return;return nt}const ye="grafana.scopes.recent";class pe extends He{constructor(et,nt,Ct=Ne.M){super({loading:!1,opened:!1,loadingNodeName:void 0,nodes:{},scopes:{},selectedScopes:[],appliedScopes:[],tree:{expanded:!1,scopeNodeId:"",query:"",children:void 0}}),this.apiClient=et,this.dashboardsService=nt,this.store=Ct,this.expandOrFilterNode=async(vt,Pt)=>{const fe=_e(vt,this.state.nodes),ae=le(this.state.tree,fe);if(ae)if(ae.scopeNodeId===""||Be(this.state.nodes[ae.scopeNodeId])){if(!ae.expanded||ae.query!==Pt){const xe=Xe(this.state.tree,fe,Le=>{Le.expanded=!0,Le.query=Pt||""});this.updateState({tree:xe}),await this.loadNodeChildren(fe,ae,Pt)}}else throw new Error(`Trying to expand node at id ${vt} that is not expandable`);else throw new Error(`Trying to expand node at id ${vt} not found`)},this.collapseNode=async vt=>{const Pt=_e(vt,this.state.nodes);if(le(this.state.tree,Pt)){const ae=Xe(this.state.tree,Pt,xe=>{xe.expanded=!1,xe.query=""});this.updateState({tree:ae})}else throw new Error(`Trying to collapse node at path or id ${vt} not found`)},this.loadNodeChildren=async(vt,Pt,fe)=>{this.updateState({loadingNodeName:Pt.scopeNodeId});const ae=await this.apiClient.fetchNodes({parent:Pt.scopeNodeId,query:fe}),xe={...this.state.nodes};for(const Ze of ae)xe[Ze.metadata.name]=Ze;const Le=Xe(this.state.tree,vt,Ze=>{Ze.children={};for(const at of ae)Ze.children[at.metadata.name]={expanded:!1,scopeNodeId:at.metadata.name,query:"",children:void 0}});this.updateState({tree:Le,nodes:xe,loadingNodeName:void 0})},this.selectScope=async vt=>{let Pt=this.state.nodes[vt];if(!We(Pt))throw new Error(`Trying to select node with id ${vt} that is not selectable`);if(!Pt.spec.linkId)throw new Error(`Trying to select node id ${vt} that does not have a linkId`);this.apiClient.fetchScope(Pt.spec.linkId).then(Le=>{Le&&this.updateState({scopes:{...this.state.scopes,[Le.metadata.name]:Le}})});const fe=this.state.nodes[Pt.spec.parentName],ae={scopeId:Pt.spec.linkId,scopeNodeId:Pt.metadata.name};!(this.state.selectedScopes[0]?.scopeNodeId&&this.state.nodes[this.state.selectedScopes[0].scopeNodeId].spec.parentName===Pt.spec.parentName)||fe?.spec.disableMultiSelect||this.state.selectedScopes.length===0?this.updateState({selectedScopes:[ae]}):this.updateState({selectedScopes:[...this.state.selectedScopes,ae]})},this.deselectScope=async vt=>{const Pt=this.state.nodes[vt],fe=Pt?xe=>xe.scopeNodeId!==Pt.metadata.name&&xe.scopeId!==Pt.spec.linkId:xe=>xe.scopeNodeId!==vt&&xe.scopeId!==vt;let ae=this.state.selectedScopes.filter(fe);this.updateState({selectedScopes:ae})},this.updateNode=async(vt,Pt,fe)=>Pt?this.expandOrFilterNode(vt,fe):this.collapseNode(vt),this.changeScopes=vt=>this.applyScopes(vt.map(Pt=>({scopeId:Pt}))),this.applyScopes=async vt=>{if(!(this.state.appliedScopes.length===vt.length&&this.state.appliedScopes.every(Pt=>vt.find(fe=>Pt.scopeId===fe.scopeId)))&&(this.updateState({appliedScopes:vt,selectedScopes:vt,loading:vt.length>0}),this.dashboardsService.fetchDashboards(vt.map(Pt=>Pt.scopeId)),vt.length>0)){const Pt=await this.apiClient.fetchMultipleScopes(vt.map(ae=>ae.scopeId)),fe={...this.state.scopes};for(const ae of Pt)fe[ae.metadata.name]=ae;this.addRecentScopes(Pt),this.updateState({scopes:fe,loading:!1})}},this.removeAllScopes=()=>this.applyScopes([]),this.addRecentScopes=vt=>{if(vt.length===0)return;const Pt=5,fe=this.getRecentScopes();fe.unshift(vt),this.store.set(ye,JSON.stringify(fe.slice(0,Pt-1)))},this.getRecentScopes=()=>{const vt=this.store.get(ye);return Oe(vt).filter(fe=>{if(fe.length!==this.state.appliedScopes.length)return!0;const ae=new Set(fe.map(xe=>xe.metadata.name));return!this.state.appliedScopes.every(xe=>ae.has(xe.scopeId))})},this.open=async()=>{(!this.state.tree?.children||Object.keys(this.state.tree?.children).length===0)&&await this.expandOrFilterNode("");let vt=Ae(this.state.tree);if(this.state.selectedScopes.length&&this.state.selectedScopes[0].scopeNodeId){let Pt=_e(this.state.selectedScopes[0].scopeNodeId,this.state.nodes);Pt=Pt.slice(0,Pt.length-1),vt=Ue(vt,Pt)}this.resetSelection(),this.updateState({tree:vt,opened:!0})},this.closeAndReset=()=>{this.updateState({opened:!1}),this.resetSelection()},this.closeAndApply=()=>(this.updateState({opened:!1}),this.apply()),this.apply=()=>this.applyScopes(this.state.selectedScopes),this.resetSelection=()=>{this.updateState({selectedScopes:[...this.state.appliedScopes]})},this.searchAllNodes=async(vt,Pt)=>{const fe=await this.apiClient.fetchNodes({query:vt,limit:Pt}),ae={...this.state.nodes};for(const xe of fe)ae[xe.metadata.name]=xe;return this.updateState({nodes:ae}),fe}}}function ve(Ee){return typeof Ee=="object"&&Ee!==null&&"scope"in Ee&&be(Ee.scope)}function be(Ee){return typeof Ee=="object"&&Ee!==null&&"metadata"in Ee&&typeof Ee.metadata=="object"&&Ee.metadata!==null&&"name"in Ee.metadata&&"spec"in Ee}function Oe(Ee){let et;try{et=JSON.parse(Ee||"[]")}catch(nt){return console.error("Failed to parse recent scopes",nt,Ee),[]}if(!(Array.isArray(et)&&Array.isArray(et[0])))return[];if(ve(et[0]?.[0]))et=et.map(nt=>nt.map(Ct=>Ct.scope));else if(!be(et[0]?.[0]))return[];return et}const we=(0,s.createContext)(void 0);function ze(){return(0,s.useContext)(we)}function Ve(){const Ee=new Ie,et=new Re(Ee),nt=new pe(Ee,et);return{scopesService:new tt(nt,et,c.Ny),scopesSelectorService:nt,scopesDashboardsService:et,client:Ee}}const ge=({children:Ee,services:et})=>{const nt=(0,s.useMemo)(()=>et??Ve(),[et]);return(0,s.useEffect)(()=>()=>{nt.scopesService.cleanUp()},[nt]),(0,n.jsx)(ue.j.Provider,{value:i.$.featureToggles.scopeFilters?nt.scopesService:void 0,children:(0,n.jsx)(we.Provider,{value:i.$.featureToggles.scopeFilters?nt:void 0,children:Ee})})};var Ke=e(96014),qe=e(35557),ot=e(41654),lt=e(8515),mt=e(46942),Lt=e.n(mt),Tt=e(33149),It=e(45897),Mt=e(51702),Ut=e(29043),an=e(18828),cn=e(42211),un=e(93225),On=e(51898),yn=e(30703),En=e(47327),Bn=e(50201),fa=e(65178),Fn=e(35822);const Ea=0,gt=Ee=>{const et=s.useRef(null),nt=s.useRef(null),Ct=s.useRef(Ee.items);Ct.current=Ee.items;const vt=(0,Fn.useVirtual)({size:Ct.current.length,parentRef:nt}),{query:Pt,search:fe,currentRootActionId:ae,activeIndex:xe,options:Le}=(0,a.useKBar)(Et=>({search:Et.searchQuery,currentRootActionId:Et.currentRootActionId,activeIndex:Et.activeIndex}));s.useEffect(()=>{const Et=Wt=>{Wt.key==="ArrowUp"||Wt.ctrlKey&&Wt.key==="p"?(Wt.preventDefault(),Pt.setActiveIndex(_t=>{let nn=_t>Ea?_t-1:_t;if(typeof Ct.current[nn]=="string"){if(nn===0)return _t;nn-=1}return nn})):Wt.key==="ArrowDown"||Wt.ctrlKey&&Wt.key==="n"?(Wt.preventDefault(),Pt.setActiveIndex(_t=>{let nn=_t<Ct.current.length-1?_t+1:_t;if(typeof Ct.current[nn]=="string"){if(nn===Ct.current.length-1)return _t;nn+=1}return nn})):Wt.key==="Enter"&&(Wt.metaKey||Wt.ctrlKey)?(Wt.preventDefault(),et.current instanceof HTMLAnchorElement?(window.open(et.current.href,"_blank","noopener,noreferrer"),Pt.toggle()):et.current?.click()):Wt.key==="Enter"&&!Wt.metaKey&&!Wt.ctrlKey&&(Wt.preventDefault(),et.current?.click())};return window.addEventListener("keydown",Et),()=>window.removeEventListener("keydown",Et)},[Pt]);const{scrollToIndex:Ze}=vt;s.useEffect(()=>{Ze(xe,{align:xe<=1?"end":"auto"})},[xe,Ze]),s.useEffect(()=>{Pt.setActiveIndex(typeof Ee.items[Ea]=="string"?Ea+1:Ea)},[fe,ae,Ee.items,Pt]);const at=s.useCallback((Et,Wt)=>{if(typeof Wt=="string")return;const _t=Wt.url;Wt.command?(Wt.command.perform(Wt),(!Wt.id.startsWith("scopes/")||Wt.id==="scopes/apply")&&Pt.toggle()):_t?Et.ctrlKey||Et.metaKey||Et.shiftKey||Pt.toggle():(Pt.setSearch(""),Pt.setCurrentRootAction(Wt.id)),Le.callbacks?.onSelectAction?.(Wt)},[Pt,Le]),ut=(0,fa.usePointerMovedSinceMount)();return(0,n.jsx)("div",{ref:nt,style:{maxHeight:Ee.maxHeight||400,position:"relative",overflow:"auto"},children:(0,n.jsx)("div",{role:"listbox",id:a.KBAR_LISTBOX,style:{height:`${vt.totalSize}px`,width:"100%"},children:vt.virtualItems.map(Et=>{const Wt=Ct.current[Et.index],{target:_t,url:nn}=Wt,dn=typeof Wt!="string"&&{onPointerMove:()=>ut&&xe!==Et.index&&Pt.setActiveIndex(Et.index),onPointerDown:()=>Pt.setActiveIndex(Et.index),onClick:Tn=>at(Tn,Wt)},Pn=Et.index===xe,Nn={id:(0,a.getListboxItemId)(Et.index),role:"option","aria-selected":Pn,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${Et.start}px)`},...dn},Cn=s.cloneElement(Ee.onRender({item:Wt,active:Pn}),{ref:Et.measureRef});return nn?(0,n.jsx)("a",{href:typeof nn=="function"?nn(fe):nn,target:_t,ref:Pn?et:null,...Nn,children:Cn},Et.index):(0,n.jsx)("div",{ref:Pn?et:null,...Nn,children:Cn},Et.index)})})})},Ht="kbar-listbox",wt=Ee=>`kbar-listbox-item-${Ee}`;function Yt(Ee){const{query:et,search:nt,actions:Ct,currentRootActionId:vt,activeIndex:Pt,showing:fe,options:ae}=(0,a.useKBar)(Wt=>({search:Wt.searchQuery,currentRootActionId:Wt.currentRootActionId,actions:Wt.actions,activeIndex:Wt.activeIndex,showing:Wt.visualState===a.VisualState.showing})),[xe,Le]=s.useState(nt);s.useEffect(()=>{et.setSearch(xe)},[xe,et]);const{defaultPlaceholder:Ze,...at}=Ee;s.useEffect(()=>(et.setSearch(""),et.getInput().focus(),Le(""),()=>et.setSearch("")),[vt,et]);const ut=Ze??"Type a command or search\u2026",Et=(0,T.of)(rn);return(0,n.jsx)("input",{...at,className:Et.input,ref:et.inputRefSetter,autoFocus:!0,autoComplete:"off",role:"combobox",spellCheck:"false","aria-expanded":fe,"aria-controls":Ht,"aria-activedescendant":wt(Pt),value:xe,placeholder:ut,onChange:Wt=>{Ee.onChange?.(Wt),Le(Wt.target.value),ae?.callbacks?.onQueryChange?.(Wt.target.value)},onKeyDown:Wt=>{if(Ee.onKeyDown?.(Wt),vt&&!nt&&Wt.key==="Backspace"){const _t=Ct[vt].parent;et.setCurrentRootAction(_t)}}})}const rn=Ee=>({input:(0,E.css)({label:"kbar-search-input",fontSize:Ee.typography.body.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.body.lineHeight,color:Ee.colors.text.secondary,width:"100%",outline:"none",paddingLeft:0})}),Xt=s.forwardRef(({action:Ee,active:et,currentRootActionId:nt},Ct)=>{const vt=s.useMemo(()=>{if(!nt)return Ee.ancestors;const xe=Ee.ancestors.findIndex(Le=>Le.id===nt);return Ee.ancestors.slice(xe+1)},[Ee.ancestors,nt]),Pt=(0,T.of)(on);let fe=Ee.name;const ae=xe=>!!(xe.command?.perform||xe.url);return Ee.children.length&&!ae(Ee)&&!fe.endsWith("...")&&(fe+="..."),(0,n.jsx)("div",{ref:Ct,className:(0,E.cx)(Pt.row,et&&Pt.activeRow),children:(0,n.jsxs)("div",{className:Pt.actionContainer,children:[Ee.icon,(0,n.jsxs)("div",{className:Pt.textContainer,children:[vt.map(xe=>(0,n.jsx)(s.Fragment,{children:!ae(xe)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:Pt.breadcrumbAncestor,children:xe.name}),(0,n.jsx)("span",{className:Pt.breadcrumbSeparator,children:"\u203A"})]})},xe.id)),(0,n.jsx)("span",{children:fe})]}),Ee.subtitle&&(0,n.jsx)("span",{className:Pt.subtitleText,children:Ee.subtitle})]})})});Xt.displayName="ResultItem";const on=Ee=>({row:(0,E.css)({padding:Ee.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:Ee.shape.radius.default,margin:Ee.spacing(0,1)}),activeRow:(0,E.css)({color:Ee.colors.text.maxContrast,background:Ee.colors.emphasize(Ee.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:Ee.spacing(.5),borderRadius:Ee.shape.radius.default,backgroundImage:Ee.colors.gradients.brandVertical}}),actionContainer:(0,E.css)({display:"flex",gap:Ee.spacing(1),alignItems:"baseline",fontSize:Ee.typography.fontSize,width:"100%"}),textContainer:(0,E.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,E.css)({color:Ee.colors.text.secondary}),breadcrumbSeparator:(0,E.css)({color:Ee.colors.text.secondary,marginLeft:Ee.spacing(1),marginRight:Ee.spacing(1)}),subtitleText:(0,E.css)({...Ee.typography.bodySmall,color:Ee.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var pn=e(76459),Un=e.n(pn),In=e(67020),Gn=e(55860);const Wa=8,za=7,Oa=6,ss=5,La=4,Ca=3,Ka=2,As=1,Ia=100,_s=5,Fa=Un()(dt,200);async function xt(){if(!b.TP.user.isSignedIn)return[];const Ee=(await In.A.getDashboardOpened()).slice(0,_s),nt=(await(0,Gn.S)().search({kind:["dashboard"],limit:_s,uid:Ee})).view.toArray();return nt.sort((vt,Pt)=>{const fe=Ee.indexOf(vt.uid),ae=Ee.indexOf(Pt.uid);return fe-ae}),nt.map(vt=>{const{url:Pt,name:fe}=vt;return{id:`recent-dashboards${Pt}`,name:`${fe}`,section:(0,P.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:Oa,url:Pt}})}async function dt(Ee){if(Ee.length===0||!b.TP.user.isSignedIn&&!i.$.bootData.settings.anonymousEnabled)return[];const et=await(0,Gn.S)().search({kind:["dashboard","folder"],query:Ee,limit:Ia});return et.view.map(Ct=>{const{url:vt,name:Pt,kind:fe,location:ae}=Ct;return{id:`go/${fe}${vt}`,name:`${Pt}`,section:fe==="dashboard"?(0,P.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,P.t)("command-palette.section.folder-search-results","Folders"),priority:As,url:vt,subtitle:et.view.dataFrame.meta?.custom?.locationInfo[ae]?.name}})}function St({searchQuery:Ee,show:et}){const[nt,Ct]=(0,s.useState)([]),[vt,Pt]=(0,s.useState)(!1),fe=(0,s.useRef)(0);return(0,s.useEffect)(()=>{const ae=Date.now();et&&Ee.length>0?(Pt(!0),Fa(Ee).then(xe=>{ae>fe.current&&(Ct(xe),Pt(!1),fe.current=ae)})):(Ct([]),Pt(!1),fe.current=ae)},[et,Ee]),{searchResults:nt,isFetchingSearchResults:vt}}var jt=e(34343),Qt=e(66404),Jt=e(9628);function ln({selectedScopes:Ee,isDirty:et,apply:nt,deselectScope:Ct,scopes:vt,nodes:Pt}){const fe=(0,T.of)(fn);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ot.B,{alignItems:"center",children:[(0,n.jsx)("span",{className:fe.scopesText,children:(0,n.jsx)(P.x6,{i18nKey:"command-palette.scopes.selected-scopes-label",children:"Scopes: "})}),(0,n.jsx)(ot.B,{wrap:"wrap",children:Ee?.map(ae=>{const xe=vt[ae.scopeId]?.spec.title||ae.scopeNodeId&&Pt[ae.scopeNodeId]?.spec.title||ae.scopeId;return(0,n.jsx)(jt.m,{selected:!0,icon:"times",label:xe,onClick:()=>{Ct(ae.scopeNodeId||ae.scopeId)}},ae.scopeId)})})]}),et&&(0,n.jsxs)(O.$n,{onClick:()=>{nt()},children:[(0,n.jsx)(P.x6,{i18nKey:"command-palette.scopes.apply-selected-scopes",children:"Apply"}),"\xA0",(0,n.jsx)(Qt.E,{variant:"bodySmall",children:`${(0,Jt.gn)()}+\u21B5`})]})]})}const fn=Ee=>({scopesText:(0,E.css)({label:"scopesText",fontSize:Ee.typography.bodySmall.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.bodySmall.lineHeight,color:Ee.colors.text.secondary}),selectedScope:(0,E.css)({background:Ee.colors.background.secondary,borderRadius:Ee.shape.radius.default,padding:Ee.spacing(0,.5),fontSize:Ee.typography.bodySmall.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.bodySmall.lineHeight,color:Ee.colors.text.secondary,display:"inline-flex",alignItems:"center",position:"relative",border:`1px solid ${Ee.colors.background.secondary}`,whiteSpace:"nowrap",marginRight:Ee.spacing(.5)})});function gn(){const Ee=ze();if(!(i.$.featureToggles.scopeFilters&&Ee))return[];const{scopesSelectorService:et}=Ee;return et.getRecentScopes().map(Ct=>({id:Ct.map(vt=>vt.spec.title).join(", "),name:Ct.map(vt=>vt.spec.title).join(", "),section:(0,P.t)("command-palette.section.recent-scopes","Recent scopes"),priority:za,perform:()=>{et.changeScopes(Ct.map(vt=>vt.metadata.name))}}))}var vn=e(24120),wn=e(88483);function Rt(){const Ee=ze();if(!Ee)return{updateNode:()=>{},selectScope:()=>{},resetSelection:()=>{},searchAllNodes:()=>Promise.resolve([]),apply:()=>{},deselectScope:()=>{},nodes:{},scopes:{},selectedScopes:[],appliedScopes:[],tree:{scopeNodeId:"",expanded:!1,query:""}};const{updateNode:et,selectScope:nt,resetSelection:Ct,searchAllNodes:vt,deselectScope:Pt,apply:fe}=Ee.scopesSelectorService,ae=(0,vn.A)(Ee.scopesSelectorService.stateObservable??new wn.c,Ee.scopesSelectorService.state);return{updateNode:et,selectScope:nt,resetSelection:Ct,searchAllNodes:vt,apply:fe,deselectScope:Pt,...ae}}function bt(){return{id:"scopes",section:(0,P.t)("command-palette.action.scopes","Scopes"),name:(0,P.t)("command-palette.action.scopes","Scopes"),keywords:"scopes filters",priority:Wa}}function Vt(Ee,et,nt,Ct){const vt=[bt()],Pt=(fe,ae)=>{if(!(!fe.children||Object.keys(fe.children).length===0))for(const xe of Object.keys(fe.children)){const Le=fe.children[xe],Ze=Ee[xe],at=nt.some(Et=>Et.scopeNodeId?Et.scopeNodeId===Ze.metadata.name:Et.scopeId===Ze.spec.linkId);if(Ze.spec.nodeType==="leaf"&&at)continue;let ut=Kt(Ze,Ct,ae);vt.push(ut),Pt(Le,ut.id)}};return Pt(et,"scopes"),vt}function Kt(Ee,et,nt){let Ct;return nt?(Ct={id:`${nt}/${Ee.metadata.name}`,name:Ee.spec.title,keywords:`${Ee.spec.title} ${Ee.metadata.name}`,priority:Wa,parent:nt},Ee.spec.nodeType==="leaf"&&(Ct.perform=()=>{et(Ee.metadata.name)})):Ct={id:`scopes/${Ee.metadata.name}`,name:Ee.spec.title,keywords:`${Ee.spec.title} ${Ee.metadata.name}`,priority:Wa,section:(0,P.t)("command-palette.action.scopes","Scopes"),subtitle:Ee.spec.parentName,perform:()=>{et(Ee.metadata.name)}},Ct}function Dt(){const Ee=gn();(0,a.useRegisterActions)(Ee,[Ee])}function Zt(Ee,et,nt){if(!i.$.featureToggles.scopeFilters)return{scopesRow:void 0};const Ct=va(Ee,nt),vt=Ln(Ee,nt),Pt=Ct||vt;return(0,a.useRegisterActions)(Pt,[Pt]),Qn(et)}function Ln(Ee,et){const{updateNode:nt,selectScope:Ct,resetSelection:vt,nodes:Pt,tree:fe,selectedScopes:ae}=Rt();return(0,s.useEffect)(()=>(nt("",!0,""),vt(),()=>{vt()}),[nt,vt]),(0,s.useEffect)(()=>{const xe=!et||et==="scopes"?"":(0,Se.last)(et.split("/"));nt(xe,!0,Ee)},[nt,Ee,et]),(0,s.useMemo)(()=>Vt(Pt,fe,ae,Ct),[Pt,fe,ae,Ct])}function Qn(Ee){const{nodes:et,scopes:nt,selectedScopes:Ct,appliedScopes:vt,deselectScope:Pt,apply:fe}=Rt(),ae=vt.map(Le=>Le.scopeId).sort().join("")!==Ct.map(Le=>Le.scopeId).sort().join(""),xe=(0,s.useCallback)(()=>{fe(),Ee()},[fe,Ee]);return(0,s.useEffect)(()=>{function Le(Ze){ae&&Ze.key==="Enter"&&Ze.metaKey&&(Ze.preventDefault(),xe())}return window.addEventListener("keydown",Le),()=>window.removeEventListener("keydown",Le)},[ae,xe]),{scopesRow:ae||Ct?.length?(0,n.jsx)(ln,{nodes:et,scopes:nt,deselectScope:Pt,selectedScopes:Ct,apply:xe,isDirty:ae}):null}}function va(Ee,et){const{selectScope:nt,searchAllNodes:Ct}=Rt(),[vt,Pt]=(0,s.useState)(void 0),fe=(0,s.useRef)();return(0,s.useEffect)(()=>{(!et||et==="scopes")&&Ee&&i.$.featureToggles.scopeSearchAllLevels?(fe.current=Ee,Ct(Ee,10).then(ae=>{if(fe.current===Ee){const xe=ae.filter(Ze=>Ze.spec.nodeType==="leaf"),Le=[bt()];for(const Ze of xe)Le.push(Kt(Ze,nt,et||void 0));Pt(Le)}})):(fe.current=void 0,Pt(void 0))},[Ct,Ee,et,nt]),vt}var Wn=e(30362),ia=e(65642),kn=e(79776),na=e(11257);const Ga=ia.$W.featureToggles.inviteUserExperimental&&ia.$W.externalUserMngLinkUrl&&b.TP.hasPermission(na.w.OrgUsersAdd),Ps=(Ee,et)=>{(0,m.rR)("invite_user_button_clicked",{placement:Ee});const nt=(0,kn.o)(et);window.open(nt.toString(),"_blank")};var ls=e(44410),Ta=e(68555),aa=e(52763);function Gs(Ee){return"navModel."+(Ee.id??Ee.url??Ee.text??Ee.subTitle)}function Os(Ee,et=[]){const nt=[];for(let Ct of Ee){Ct.id==="help"&&(Ct=(0,Wn.CS)({...Ct}),delete Ct.url);const{url:vt,target:Pt,text:fe,isCreateAction:ae,children:xe,onClick:Le,keywords:Ze}=Ct,at=!!xe?.length;if(!(vt||Le||at))continue;let ut=vt;vt&&(Ct.id==="connections-add-new-connection"||Ct.id==="standalone-plugin-page-/connections/add-new-connection")&&(ut=dn=>{const Pn=Ze?.find(Nn=>Nn.toLowerCase().includes(dn.toLowerCase()));return Pn?`${vt}?search=${Pn}`:vt});const Et=ae?(0,P.t)("command-palette.section.actions","Actions"):(0,P.t)("command-palette.section.pages","Pages"),Wt=ae?ss:La,_t=et.map(dn=>dn.text).join(" > "),nn={id:Gs(Ct),name:fe,section:Et,url:ut,target:Pt,parent:et.length>0&&!ae?Gs(et[et.length-1]):void 0,perform:Le,keywords:Ze?.join(" "),priority:Wt,subtitle:ae?void 0:_t};if(nt.push(nn),xe?.length){const dn=Os(xe,[...et,Ct]);nt.push(...dn)}}return nt}function Zs(){return[{id:"preferences/theme",name:(0,P.t)("command-palette.action.change-theme","Change theme"),keywords:"interface color dark light",section:(0,P.t)("command-palette.section.preferences","Preferences"),priority:Ca},{id:"preferences/dark-theme",name:(0,P.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,ls.K)("dark"),parent:"preferences/theme",priority:Ca},{id:"preferences/light-theme",name:(0,P.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,ls.K)("light"),parent:"preferences/theme",priority:Ca}]}function lr(){const Ee=(0,aa.d4)(et=>et.navBarTree);return(0,s.useMemo)(()=>{const et=Os(Ee);return Ga&&et.push({id:"invite-user",name:(0,P.t)("navigation.invite-user.invite-new-member-button","Invite new member"),section:(0,P.t)("command-palette.section.actions","Actions"),priority:ss,perform:()=>{Ps("command_palette_actions","invite-user-command-palette")}}),[...Zs(),...et]},[Ee])}var Xs=e(54092),jo=e(46907);const ci={};function Xr(){const{links:Ee}=(0,jo.U)({extensionPointId:Xs.S.CommandPalette,context:ci,limitPerPlugin:3});return(0,s.useMemo)(()=>Ee.map(et=>({section:et.category??"Extensions",priority:Ka,id:et.id,name:et.title,target:et.path,perform:()=>et.onClick&&et.onClick()})),[Ee])}function vs(){const Ee=Xr(),et=lr(),nt=(0,s.useMemo)(()=>[...et,...Ee],[et,Ee]);(0,a.useRegisterActions)(nt,[nt])}function ks(){const[Ee,et]=(0,s.useState)([]);(0,s.useEffect)(()=>{xt().then(nt=>et(nt)).catch(nt=>{console.error("Error loading recent dashboard actions",nt)})},[]),(0,a.useRegisterActions)(Ee,[Ee])}var Ys=e(84139);const Lo={name:"none",priority:a.Priority.NORMAL};function rs(Ee,et){return et.priority-Ee.priority}function Vs(){const{search:Ee,actions:et,rootActionId:nt}=(0,a.useKBar)(Ze=>({search:Ze.searchQuery,actions:Ze.actions,rootActionId:Ze.currentRootActionId})),Ct=s.useMemo(()=>Object.keys(et).reduce((Ze,at)=>{const ut=et[at];if(!ut.parent&&!nt&&Ze.push(ut),ut.id===nt)for(let Et=0;Et<ut.children.length;Et++)Ze.push(ut.children[Et]);return Ze},[]).sort(rs),[et,nt]),vt=s.useCallback(Ze=>{let at=[];for(let ut=0;ut<Ze.length;ut++)at.push(Ze[ut]);return function ut(Et,Wt=at){for(let _t=0;_t<Et.length;_t++)if(Et[_t].children.length>0){let nn=Et[_t].children;for(let dn=0;dn<nn.length;dn++)Wt.push(nn[dn]);ut(Et[_t].children,Wt)}return Wt}(Ze)},[]),Pt=!Ee,fe=s.useMemo(()=>Pt?Ct:vt(Ct),[vt,Ct,Pt]),ae=Hs(fe,Ee),xe=s.useMemo(()=>{let Ze={},at=[],ut=[];for(let Wt=0;Wt<ae.length;Wt++){const _t=ae[Wt],nn=_t.action,dn=_t.score||a.Priority.NORMAL,Pn={name:typeof nn.section=="string"?nn.section:nn.section?.name||Lo.name,priority:typeof nn.section=="string"?dn:nn.section?.priority||0+dn};Ze[Pn.name]||(Ze[Pn.name]=[],at.push(Pn)),Ze[Pn.name].push({priority:nn.priority+dn,action:nn})}ut=at.sort(rs).map(Wt=>({name:Wt.name,actions:Ze[Wt.name].sort(rs).map(_t=>_t.action)}));let Et=[];for(let Wt=0;Wt<ut.length;Wt++){let _t=ut[Wt];_t.name!==Lo.name&&Et.push(_t.name);for(let nn=0;nn<_t.actions.length;nn++)Et.push(_t.actions[nn])}return Et},[ae]),Le=s.useMemo(()=>nt,[xe]);return s.useMemo(()=>({results:xe,rootActionId:Le}),[Le,xe])}function Hs(Ee,et){const nt=qr(),Ct=s.useMemo(()=>({filtered:Ee,search:et}),[Ee,et]),{filtered:vt,search:Pt}=(0,fa.useThrottledValue)(Ct);return s.useMemo(()=>{if(Pt.trim()==="")return vt.map(xe=>({score:0,action:xe}));const fe=vt.map(({name:xe,keywords:Le})=>`${xe} ${Le??""}`.toLowerCase()),ae=[];if(Pt.length>yr){const xe=Pt.toLowerCase();for(let Le=0;Le<fe.length;Le++){const at=fe[Le].indexOf(xe);if(at>-1){const ut=at*-1,Et=vt[Le];ae.push({score:ut,action:Et})}}}else{const xe=nt.split(Pt).length,Le=1/0,Ze=xe<5?4:0,[,at,ut]=nt.search(fe,Pt,Ze,Le);if(at&&ut)for(let Et=0;Et<ut.length;Et++){const Wt=ut[Et],_t=ut.length-Et,nn=vt[at.idx[Wt]];ae.push({score:_t,action:nn})}}return ae},[vt,Pt,nt])}const yr=25;function qr(){const Ee=s.useRef();return Ee.current||(Ee.current=new Ys.A({intraMode:0,intraIns:0})),Ee.current}function xr(){return vs(),(0,n.jsx)(a.KBarPortal,{children:(0,n.jsx)(Ws,{})})}function Ws(){const Ee=uo(),et=(0,T.of)(eo,Ee),{query:nt,searchQuery:Ct,currentRootActionId:vt}=(0,a.useKBar)(ut=>({showing:ut.visualState===a.VisualState.showing,searchQuery:ut.searchQuery,currentRootActionId:ut.currentRootActionId}));ks(),Dt();const Pt=(0,s.useCallback)(()=>nt.toggle(),[nt]),{scopesRow:fe}=Zt(Ct,Pt,vt),{searchResults:ae,isFetchingSearchResults:xe}=St({searchQuery:Ct,show:!vt}),Le=(0,s.useRef)(null),{overlayProps:Ze}=(0,un.e)({isOpen:!0,onClose:()=>nt.setVisualState(a.VisualState.animatingOut)},Le),{dialogProps:at}=(0,an.s)({},Le);return(0,s.useEffect)(()=>{(0,m.rR)("command_palette_opened")},[]),(0,n.jsx)(a.KBarPositioner,{className:et.positioner,children:(0,n.jsx)(a.KBarAnimator,{className:et.animator,children:(0,n.jsx)(cn.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{...Ze,...at,children:[(0,n.jsxs)("div",{className:et.searchContainer,children:[(0,n.jsx)(yn.I,{name:"search",size:"md",className:et.searchIcon}),(0,n.jsx)(Br,{}),(0,n.jsx)(Yt,{defaultPlaceholder:(0,P.t)("command-palette.search-box.placeholder","Search or jump to..."),className:et.search}),(0,n.jsx)("div",{className:et.loadingBarContainer,children:xe&&(0,n.jsx)(En.G,{width:500,delay:0})})]}),fe?(0,n.jsx)("div",{className:et.searchContainer,children:fe}):null,(0,n.jsx)("div",{className:et.resultsContainer,children:(0,n.jsx)(Tr,{isFetchingSearchResults:xe,searchResults:ae})})]})})})})}function Br(){const Ee=uo(),et=(0,T.of)(eo,Ee),{actions:nt,currentRootActionId:Ct}=(0,a.useKBar)(Pt=>({actions:Pt.actions,currentRootActionId:Pt.currentRootActionId})),vt=Ct?[...nt[Ct].ancestors,nt[Ct]]:[];return vt.length>0&&(0,n.jsx)("span",{className:et.breadcrumbs,children:vt.map((Pt,fe)=>(0,n.jsxs)(s.Fragment,{children:[Pt.name,"\xA0/\xA0"]},Pt.id||fe))})}const Tr=({isFetchingSearchResults:Ee,searchResults:et})=>{const{results:nt,rootActionId:Ct}=Vs(),vt=uo(),Pt=(0,T.of)(eo,vt),fe=(0,P.t)("command-palette.section.dashboard-search-results","Dashboards"),ae=(0,P.t)("command-palette.section.folder-search-results","Folders"),xe=(0,s.useMemo)(()=>et.filter(ut=>ut.id.startsWith("go/dashboard")).map(ut=>new a.ActionImpl(ut,{store:{}})),[et]),Le=(0,s.useMemo)(()=>et.filter(ut=>ut.id.startsWith("go/folder")).map(ut=>new a.ActionImpl(ut,{store:{}})),[et]),Ze=(0,s.useMemo)(()=>{const ut=[...nt];return Le.length>0&&(ut.push(ae),ut.push(...Le)),xe.length>0&&(ut.push(fe),ut.push(...xe)),ut},[nt,fe,xe,ae,Le]),at=!Ee&&Ze.length===0;return(0,s.useEffect)(()=>{at&&(0,m.rR)("grafana_empty_state_shown",{source:"command_palette"})},[at]),at?(0,n.jsx)(Bn.p,{variant:"not-found",role:"alert",message:(0,P.t)("command-palette.empty-state.message","No results found")}):(0,n.jsx)(gt,{items:Ze,maxHeight:650,onRender:({item:ut,active:Et})=>{const Wt=Ze[0]===ut;return typeof ut=="string"?(0,n.jsx)("div",{className:(0,E.cx)(Pt.sectionHeader,Wt&&Pt.sectionHeaderFirst),children:ut}):(0,n.jsx)(Xt,{action:ut,active:Et,currentRootActionId:Ct})}})},uo=()=>{const et=document.querySelector(`[data-testid="${On.Tp.components.NavToolbar.commandPaletteTrigger}"]`)?.getBoundingClientRect().right??0;return document.body.clientWidth-et},eo=(Ee,et)=>({positioner:(0,E.css)({zIndex:Ee.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:Ee.components.overlay.background}}),animator:(0,E.css)({width:"100%",maxWidth:Ee.breakpoints.values.md,background:Ee.colors.background.primary,color:Ee.colors.text.primary,borderRadius:Ee.shape.radius.default,border:`1px solid ${Ee.colors.border.weak}`,overflow:"hidden",boxShadow:Ee.shadows.z3,[Ee.breakpoints.up("lg")]:{position:"fixed",right:et,left:et,maxWidth:"unset",width:"unset"}}),loadingBarContainer:(0,E.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,E.css)({alignItems:"center",background:Ee.components.input.background,borderBottom:`1px solid ${Ee.colors.border.weak}`,display:"flex",padding:Ee.spacing(1,2),position:"relative",justifyContent:"space-between"}),search:(0,E.css)({fontSize:Ee.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:Ee.components.input.text}),spinner:(0,E.css)({height:"22px"}),resultsContainer:(0,E.css)({paddingBottom:Ee.spacing(1)}),sectionHeader:(0,E.css)({padding:Ee.spacing(1.5,2,2,2),fontSize:Ee.typography.bodySmall.fontSize,fontWeight:Ee.typography.fontWeightMedium,color:Ee.colors.text.secondary,borderTop:`1px solid ${Ee.colors.border.weak}`,marginTop:Ee.spacing(1)}),sectionHeaderFirst:(0,E.css)({paddingBottom:Ee.spacing(1),borderTop:"none",marginTop:0}),breadcrumbs:(0,E.css)({label:"breadcrumbs",fontSize:Ee.typography.body.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.body.lineHeight,color:Ee.colors.text.primary,display:"flex",alignItems:"center",whiteSpace:"nowrap"}),scopesText:(0,E.css)({label:"scopesText",fontSize:Ee.typography.bodySmall.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.bodySmall.lineHeight,color:Ee.colors.text.secondary}),searchIcon:(0,E.css)({marginRight:Ee.spacing(1)}),selectedScope:(0,E.css)({background:Ee.colors.background.secondary,borderRadius:Ee.shape.radius.default,padding:Ee.spacing(0,.5),fontSize:Ee.typography.bodySmall.fontSize,fontWeight:Ee.typography.fontWeightMedium,lineHeight:Ee.typography.bodySmall.lineHeight,color:Ee.colors.text.secondary,display:"inline-flex",alignItems:"center",position:"relative",border:`1px solid ${Ee.colors.background.secondary}`,whiteSpace:"nowrap",marginRight:Ee.spacing(.5)})});var Xo=e(6975),Ur=e(92807),or=e(83175),fr=e(70958);function to({folder:Ee,folderPath:et,folders:nt,onFolderUpdate:Ct}){const vt=(0,T.of)(ho);return(0,n.jsxs)("div",{className:vt.container,role:"treeitem","aria-selected":Ee.expanded,children:[(0,n.jsxs)("button",{className:vt.expand,"data-testid":`scopes-dashboards-${Ee.title}-expand`,"aria-label":Ee.expanded?(0,P.t)("scopes.dashboards.collapse","Collapse"):(0,P.t)("scopes.dashboards.expand","Expand"),onClick:()=>{Ct(et,!Ee.expanded)},children:[(0,n.jsx)(yn.I,{name:Ee.expanded?"angle-down":"angle-right",className:vt.icon}),Ee.title]}),Ee.expanded&&(0,n.jsx)("div",{className:vt.children,children:(0,n.jsx)(po,{folders:nt,folderPath:et,onFolderUpdate:Ct})})]})}const ho=Ee=>({container:(0,E.css)({display:"flex",flexDirection:"column",padding:Ee.spacing(.5,0)}),expand:(0,E.css)({alignItems:"flex-start",background:"none",border:0,display:"flex",gap:Ee.spacing(1),margin:0,padding:0,textAlign:"left",wordBreak:"break-word"}),icon:(0,E.css)({marginTop:Ee.spacing(.25)}),children:(0,E.css)({paddingLeft:Ee.spacing(3)})});function zr(Ee){return Ee.split("/").slice(0,3).join("/")}function Gr({to:Ee,title:et,id:nt}){const Ct=(0,T.of)(Hr),vt=(0,s.useMemo)(()=>fo(Ee),[Ee]),Pt=Ee.startsWith("/d/"),fe=(0,d.zy)().pathname,ae=Pt?zr(fe):fe,xe=Ee.split("?")[0]===ae;return(0,n.jsxs)(qe.Link,{to:Ee,"aria-current":xe?"page":void 0,className:(0,E.cx)(Ct.container,xe&&Ct.current),"data-testid":`scopes-dashboards-${nt}`,role:"treeitem",children:[(0,n.jsx)(yn.I,{name:vt})," ",et]},nt)}function fo(Ee){const et=D.I.stripBaseFromUrl(Ee);for(const[nt,Ct]of Bo.entries())if(et.startsWith(nt))return Ct;return"link"}const Bo=new Map([["http","external-link-alt"],["/d","apps"],["/explore/metrics","drilldown"],["/a/grafana-metricsdrilldown-app/","drilldown"],["/a/grafana-lokiexplore-app/","drilldown"],["/a/grafana-exploretraces-app/","drilldown"],["/a/grafana-pyroscope-app/","drilldown"]]),Hr=Ee=>({container:(0,E.css)({display:"flex",alignItems:"center",gap:Ee.spacing(1),padding:Ee.spacing(.75,0),textAlign:"left",paddingLeft:Ee.spacing(1),wordBreak:"break-word","&:hover, &:focus":(0,E.css)({textDecoration:"underline"})}),current:(0,E.css)({position:"relative",background:Ee.colors.action.selected,borderRadius:`0 ${Ee.shape.radius.default} ${Ee.shape.radius.default} 0`,"&::before":{backgroundImage:Ee.colors.gradients.brandVertical,borderRadius:Ee.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:Ee.spacing(.5),top:0,left:0}})});function po({folders:Ee,folderPath:et,onFolderUpdate:nt}){const[Ct]=(0,fr.s)(),vt=et[et.length-1],Pt=Ee[vt];return(0,n.jsxs)("div",{role:"tree",children:[Object.entries(Pt.folders).map(([fe,ae])=>(0,n.jsx)(to,{folder:ae,folders:Pt.folders,folderPath:[...et,fe],onFolderUpdate:nt},fe)),Object.values(Pt.suggestedNavigations).map(fe=>(0,n.jsx)(Gr,{to:or.kM.renderUrl(fe.url,Ct),title:fe.title,id:fe.id},fe.id+fe.title))]})}var Uo=e(40996),hs=e(12737);function qo({disabled:Ee,query:et,onChange:nt}){const Ct=(0,T.of)(ys),[vt,Pt]=(0,s.useState)({value:et,dirty:!1}),[fe]=(0,Uo.A)(()=>{vt.dirty&&nt(vt.value)},500,[vt.dirty,vt.value]);return(0,s.useEffect)(()=>{(fe()||!vt.dirty)&&vt.value!==et&&Pt({value:et,dirty:!1})},[fe,vt,et]),(0,n.jsx)("div",{className:Ct.container,children:(0,n.jsx)(hs.Z,{disabled:Ee,placeholder:(0,P.t)("scopes.dashboards.search","Search"),value:vt.value,"data-testid":"scopes-dashboards-search",onChange:ae=>Pt({value:ae,dirty:!0})})})}const ys=Ee=>({container:(0,E.css)({flex:"0 1 auto"})});function At(){const Ee=(0,T.of)(bn),et=(0,ue.b)(),nt=ze();if((0,vn.A)(nt?.scopesDashboardsService.stateObservable??new wn.c,nt?.scopesDashboardsService.state),!nt||!et||!et.state.enabled||!et.state.drawerOpened||et.state.readOnly)return null;const{scopesDashboardsService:Ct}=nt,{loading:vt,forScopeNames:Pt,dashboards:fe,scopeNavigations:ae,searchQuery:xe,filteredFolders:Le}=Ct.state,{changeSearchQuery:Ze,updateFolder:at,clearSearchQuery:ut}=Ct;if(!vt){if(Pt.length===0)return(0,n.jsx)("div",{className:(0,E.cx)(Ee.container,Ee.noResultsContainer),"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,n.jsx)(P.x6,{i18nKey:"scopes.dashboards.noResultsNoScopes",children:"No scopes selected"})});if(fe.length===0&&ae.length===0)return(0,n.jsx)("div",{className:(0,E.cx)(Ee.container,Ee.noResultsContainer),"data-testid":"scopes-dashboards-notFoundForScope",children:(0,n.jsx)(P.x6,{i18nKey:"scopes.dashboards.noResultsForScopes",children:"No dashboards or links found for the selected scopes"})})}return(0,n.jsxs)("div",{className:Ee.container,"data-testid":"scopes-dashboards-container",children:[(0,n.jsx)(qo,{disabled:vt,query:xe,onChange:Ze}),vt?(0,n.jsx)(Xo._,{className:Ee.loadingIndicator,text:(0,P.t)("scopes.dashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):Le[""]?(0,n.jsx)(Ur.P,{children:(0,n.jsx)(po,{folders:Le,folderPath:[""],onFolderUpdate:at})}):(0,n.jsxs)("p",{className:Ee.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,n.jsx)(P.x6,{i18nKey:"scopes.dashboards.noResultsForFilter",children:"No results found for your query"}),(0,n.jsx)(O.$n,{variant:"secondary",onClick:ut,"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,n.jsx)(P.x6,{i18nKey:"scopes.dashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const bn=Ee=>({container:(0,E.css)({backgroundColor:Ee.colors.background.primary,borderRight:`1px solid ${Ee.colors.border.weak}`,display:"flex",flexDirection:"column",height:"100%",gap:Ee.spacing(1),padding:Ee.spacing(2),width:Ee.spacing(37.5)}),noResultsContainer:(0,E.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:Ee.spacing(1),height:"100%",justifyContent:"center",margin:0,textAlign:"center"}),loadingIndicator:(0,E.css)({alignSelf:"center"})});var An=e(51182),pa=e(66588),zn=e(38206),la=e(1492);function Zn(){return(0,n.jsx)(O.$n,{icon:"add-user",size:"sm",variant:"secondary",fill:"solid",fullWidth:!0,onClick:()=>{Ps("bottom_mega_menu","invite-user-bottom-mega-menu")},children:(0,P.t)("navigation.invite-user.invite-new-member-button","Invite new member")})}var Vn=e(89409),Hn=e(78685),Ja=e(30360),Ua=e(1906),Ha=e(991),ha=e(76319),Ba=e(90666);const ya=({children:Ee})=>{const et=(0,T.of)(xs);return(0,n.jsxs)(n.Fragment,{children:[Ee,(0,n.jsx)("span",{className:et.highlight})]})},xs=Ee=>({highlight:(0,E.css)({backgroundColor:Ee.colors.success.main,borderRadius:Ee.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var Za=e(20941);function os({children:Ee,isActive:et,onClick:nt,target:Ct,url:vt,onPin:Pt,isPinned:fe}){const ae=(0,T.$j)(),xe=Xn(ae,et),Le=!Ct&&vt.startsWith("/")?Za.N:"a",Ze=(0,n.jsxs)("div",{className:xe.linkContent,children:[Ee,Ct==="_blank"&&(0,n.jsx)(yn.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,n.jsxs)("div",{className:(0,E.cx)(xe.wrapper,{[xe.wrapperActive]:et,[xe.wrapperBookmark]:i.$.featureToggles.pinNavItems}),children:[(0,n.jsx)(Le,{"data-testid":On.Tp.components.NavMenu.item,className:xe.container,href:vt,target:Ct,onClick:nt,...et&&{"aria-current":"page"},children:Ze}),i.$.featureToggles.pinNavItems&&b.TP.isSignedIn&&vt&&vt!=="/bookmarks"&&(0,n.jsx)(ha.K,{name:"bookmark",className:"pin-icon",iconType:fe?"solid":"default",onClick:()=>Pt(vt),"aria-label":fe?(0,P.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,P.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}os.displayName="MegaMenuItemText";const Xn=(Ee,et)=>({wrapper:(0,E.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,E.css)({".pin-icon":{visibility:"hidden"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{visibility:"visible"}}}),wrapperActive:(0,E.css)({backgroundColor:Ee.colors.action.selected,borderTopRightRadius:Ee.shape.radius.default,borderBottomRightRadius:Ee.shape.radius.default,position:"relative","&::before":{backgroundImage:Ee.colors.gradients.brandVertical,borderRadius:Ee.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:Ee.spacing(.5)}}),container:(0,E.css)({alignItems:"center",color:et?Ee.colors.text.primary:Ee.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover span, &:focus-visible span":{color:Ee.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${Ee.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,E.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})}),Pa=2;function wa({link:Ee,activeItem:et,level:nt=0,onClick:Ct,onPin:vt,isPinned:Pt}){const{chrome:fe}=(0,u.Il)(),xe=fe.useState().megaMenuDocked,Le=(0,d.zy)(),Ze=Ee.highlightText?ya:s.Fragment,at=(0,Wn.m0)(Ee,et),ut=Ee===et||nt===Pa&&at,[Et,Wt]=(0,Hn.A)(`grafana.navigation.expanded[${Ee.text}]`,!!at),_t=nt<Pa&&!!(Ra(Ee)||Ee.emptyMessage),nn=(0,s.useRef)(null),dn=(0,T.of)(Yn);if((0,s.useEffect)(()=>{at&&Wt(!0)},[at,Le,xe,Wt]),(0,s.useEffect)(()=>{ut&&nn.current&&ns(nn.current)&&nn.current.scrollIntoView({block:"center"})},[ut]),!Ee.url)return null;let Pn=null;Ee.icon?Pn=(0,n.jsx)(yn.I,{className:dn.icon,name:(0,Ja.Uo)(Ee.icon)??"link",size:"lg"}):Ee.img&&(Pn=(0,n.jsx)(ot.B,{width:3,justifyContent:"center",children:(0,n.jsx)("img",{className:dn.img,src:Ee.img,alt:""})}));function Nn(Cn){return Cn?"angle-up":"angle-down"}return(0,n.jsxs)("li",{ref:nn,className:dn.listItem,children:[(0,n.jsxs)("div",{className:(0,E.cx)(dn.menuItem,{[dn.menuItemWithIcon]:!!(nt===0&&Pn)}),children:[nt!==0&&(0,n.jsx)(Ba.T,{level:nt===Pa?nt-1:nt,spacing:3}),nt===Pa&&(0,n.jsx)("div",{className:dn.itemConnector}),(0,n.jsx)("div",{className:dn.collapsibleSectionWrapper,children:(0,n.jsx)(os,{isActive:ut,onClick:()=>{Ee.onClick?.(),Ct?.()},target:Ee.target,url:Ee.url,onPin:()=>vt(Ee),isPinned:Pt(Ee.url),children:(0,n.jsxs)("div",{className:(0,E.cx)(dn.labelWrapper,{[dn.hasActiveChild]:at,[dn.labelWrapperWithIcon]:!!(nt===0&&Pn)}),children:[nt===0&&Pn&&(0,n.jsx)(Ze,{children:Pn}),(0,n.jsx)(Qt.E,{truncate:!0,children:Ee.text}),Ee.isNew&&(0,n.jsx)(Ha.y,{featureState:Ua.Ay.new})]})})}),(0,n.jsx)("div",{className:dn.collapseButtonWrapper,children:_t&&(0,n.jsx)(ha.K,{"aria-label":Et?(0,P.t)("navigation.megamenu-item.collapse-aria-label","Collapse section: {{sectionName}}",{sectionName:Ee.text}):(0,P.t)("navigation.megamenu-item.expand-aria-label","Expand section: {{sectionName}}",{sectionName:Ee.text}),className:dn.collapseButton,onClick:()=>Wt(!Et),name:Nn(!!Et),size:"md",variant:"secondary"})})]}),_t&&Et&&(0,n.jsx)("ul",{className:dn.children,children:Ra(Ee)?Ee.children.filter(Cn=>!Cn.isCreateAction).map(Cn=>(0,n.jsx)(wa,{link:Cn,activeItem:et,onClick:Ct,level:nt+1,onPin:vt,isPinned:Pt},`${Ee.text}-${Cn.text}`)):(0,n.jsx)("div",{className:dn.emptyMessage,"aria-live":"polite",children:Ee.emptyMessage})})]})}const Yn=Ee=>({icon:(0,E.css)({width:Ee.spacing(3)}),img:(0,E.css)({height:Ee.spacing(2),width:Ee.spacing(2)}),listItem:(0,E.css)({flex:1,maxWidth:"100%"}),menuItem:(0,E.css)({display:"flex",alignItems:"center",gap:Ee.spacing(1),height:Ee.spacing(4),paddingLeft:Ee.spacing(.5),position:"relative"}),menuItemWithIcon:(0,E.css)({paddingLeft:Ee.spacing(0)}),collapseButtonWrapper:(0,E.css)({display:"flex",justifyContent:"center",width:Ee.spacing(3),flexShrink:0}),itemConnector:(0,E.css)({position:"relative",height:"100%",width:Ee.spacing(1.5),"&::before":{borderLeft:`1px solid ${Ee.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,E.css)({margin:0}),collapsibleSectionWrapper:(0,E.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,E.css)({display:"flex",alignItems:"center",gap:Ee.spacing(2),minWidth:0,paddingLeft:Ee.spacing(1)}),labelWrapperWithIcon:(0,E.css)({paddingLeft:Ee.spacing(.5)}),hasActiveChild:(0,E.css)({color:Ee.colors.text.primary}),children:(0,E.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,E.css)({color:Ee.colors.text.secondary,fontStyle:"italic",padding:Ee.spacing(1,1.5,1,7)})});function Ra(Ee){return!!(Ee.children&&Ee.children.length>0)}function ns(Ee){const et=Ee.getBoundingClientRect();return et.bottom<0||et.top>=window.innerHeight}var ps=e(5071);const ga="300px",Va=(0,s.memo)((0,s.forwardRef)(({onClose:Ee,...et},nt)=>{const Ct=(0,aa.d4)(dn=>dn.navBarTree),vt=(0,T.of)(is),Pt=(0,d.zy)(),{chrome:fe}=(0,u.Il)(),ae=(0,aa.wA)(),xe=fe.useState(),[Le]=(0,la.o)(),Ze=(0,ps.s)(),at=Ct.filter(dn=>dn.id!=="profile"&&dn.id!=="help").map(dn=>(0,Wn.J0)(dn,xe.megaMenuDocked));if(i.$.featureToggles.pinNavItems){const dn=at.find(Pn=>Pn.id==="bookmarks");dn&&(dn.children=Ze.reduce((Pn,Nn)=>{const Cn=(0,Wn.Wk)(at,Nn);if(!Cn)return Pn;const Tn={id:Cn.id,text:Cn.text,url:Cn.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return Pn.push((0,Wn.J0)(Tn,xe.megaMenuDocked)),Pn},[]))}const ut=(0,Wn.A6)(at,xe.sectionNav.node,Pt.pathname),Et=()=>{fe.setMegaMenuOpen(!xe.megaMenuOpen)},Wt=()=>{fe.setMegaMenuDocked(!xe.megaMenuDocked),xe.megaMenuDocked&&fe.setMegaMenuOpen(!1)},_t=(0,s.useCallback)(dn=>!dn||!Ze?.length?!1:Ze?.includes(dn),[Ze]),nn=dn=>{const Pn=dn.url;if(Pn&&i.$.featureToggles.pinNavItems){const Nn=_t(Pn),Cn=Nn?Ze.filter(_n=>Pn!==_n):[...Ze,Pn],Tn=Nn?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,m.rR)(Tn,{path:Pn}),Le({patchPrefsCmd:{navbar:{bookmarkUrls:Cn}}}).then(_n=>{_n.error||ae((0,zn.ve)({item:dn,isSaved:!Nn}))})}};return(0,n.jsxs)("div",{"data-testid":On.Tp.components.NavMenu.Menu,ref:nt,...et,children:[(0,n.jsx)(Vn.fn,{handleDockedMenu:Wt,handleMegaMenu:Et,onClose:Ee}),(0,n.jsxs)("nav",{className:vt.content,children:[(0,n.jsx)(Ur.P,{height:"100%",overflowX:"hidden",showScrollIndicators:!0,children:(0,n.jsx)("ul",{className:vt.itemList,"aria-label":(0,P.t)("navigation.megamenu.list-label","Navigation"),children:at.map((dn,Pn)=>(0,n.jsx)(wa,{link:dn,isPinned:_t,onClick:xe.megaMenuDocked?void 0:Ee,activeItem:ut,onPin:nn},dn.text))})}),Ga&&(0,n.jsx)("div",{className:vt.inviteNewMemberButton,children:(0,n.jsx)(Zn,{})})]})]})}));Va.displayName="MegaMenu";const is=Ee=>({content:(0,E.css)({display:"flex",flexDirection:"column",minHeight:0,flexGrow:1,position:"relative"}),mobileHeader:(0,E.css)({display:"flex",justifyContent:"space-between",padding:Ee.spacing(1,1,1,2),borderBottom:`1px solid ${Ee.colors.border.weak}`,[Ee.breakpoints.up("md")]:{display:"none"}}),itemList:(0,E.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:Ee.spacing(1,1,2,1),[Ee.breakpoints.up("md")]:{width:ga}}),inviteNewMemberButton:(0,E.css)({display:"flex",padding:Ee.spacing(1.5,1,1.5,1),borderTop:`1px solid ${Ee.colors.border.weak}`}),dockMenuButton:(0,E.css)({display:"none",position:"relative",top:Ee.spacing(1),[Ee.breakpoints.up("xl")]:{display:"inline-flex"}})});function nr({}){const Ee=(0,T.$j)(),{chrome:et}=(0,u.Il)(),nt=et.useState(),Ct=(0,s.useRef)(null),vt=(0,s.useRef)(null),Pt=Ee.transitions.duration.shortest,fe=(0,T.of)(Xa,Pt),ae=nt.megaMenuOpen&&!nt.megaMenuDocked,xe=()=>et.setMegaMenuOpen(!1),{overlayProps:Le,underlayProps:Ze}=(0,un.e)({isDismissable:!0,isOpen:!0,onClose:xe,shouldCloseOnInteractOutside:Et=>!document.querySelector(`[data-testid="${On.Tp.components.Select.menu}"]`)?.contains(Et)},Ct),{dialogProps:at}=(0,an.s)({},Ct),ut=(0,T.of)(Aa);return(0,n.jsx)("div",{className:ut.wrapper,children:(0,n.jsxs)(An.Sf,{children:[(0,n.jsx)(pa.A,{nodeRef:Ct,in:ae,unmountOnExit:!0,classNames:fe.overlay,timeout:{enter:Pt,exit:0},children:(0,n.jsx)(n.Fragment,{children:ae&&(0,n.jsx)(cn.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)(Va,{className:ut.menu,onClose:xe,ref:Ct,...Le,...at})})})}),(0,n.jsx)(pa.A,{nodeRef:vt,in:ae,unmountOnExit:!0,classNames:fe.backdrop,timeout:{enter:Pt,exit:0},children:(0,n.jsx)("div",{ref:vt,className:ut.backdrop,...Ze})})]})})}const Aa=Ee=>({backdrop:(0,E.css)({backgroundColor:Ee.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:0,zIndex:Ee.zIndex.modalBackdrop}),menu:(0,E.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:Ee.zIndex.modal,position:"fixed",top:0,backgroundColor:Ee.colors.background.primary,flex:"1 1 0",[Ee.breakpoints.up("md")]:{right:"unset"}}),wrapper:(0,E.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:Ee.zIndex.sidemenu})}),Xa=(Ee,et)=>{const nt={[Ee.transitions.handleMotion("no-preference")]:{transitionDuration:`${et}ms`,transitionTimingFunction:Ee.transitions.easing.easeInOut},[Ee.breakpoints.down("md")]:{overflow:"hidden"}},Ct={...nt,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},vt={...nt,transitionProperty:"opacity"},Pt={width:"100%",[Ee.breakpoints.up("md")]:{borderRight:`1px solid ${Ee.colors.border.weak}`,boxShadow:Ee.shadows.z3,width:ga}},fe={boxShadow:"none",width:0},ae={opacity:1},xe={opacity:0};return{backdrop:{enter:(0,E.css)(xe),enterActive:(0,E.css)(vt,ae),enterDone:(0,E.css)(ae)},overlay:{enter:(0,E.css)(fe),enterActive:(0,E.css)(Ct,Pt),enterDone:(0,E.css)(Pt)}}};var qn=e(24596),Ma=e(92270),js=e(93256);const cr=({label:Ee,onClick:et,onDismiss:nt})=>{const Ct=(0,T.of)(Qs);return(0,n.jsxs)(js.e,{className:Ct.buttonGroup,children:[(0,n.jsx)(O.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:et,title:Ee,className:Ct.mainDismissableButton,"data-testid":On.Tp.components.ReturnToPrevious.backButton,children:Ee}),(0,n.jsx)(O.$n,{icon:"times","aria-label":(0,P.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:nt,"data-testid":On.Tp.components.ReturnToPrevious.dismissButton})]})},Qs=Ee=>({mainDismissableButton:(0,E.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,E.css)({width:"fit-content",backgroundColor:Ee.colors.background.secondary})});cr.displayName="DismissableButton";const qa=({href:Ee,title:et})=>{const nt=(0,T.of)(bs),{chrome:Ct}=(0,u.Il)(),vt=(0,s.useCallback)(()=>{c.Ny.push(Ee),Ct.clearReturnToPrevious("clicked")},[Ee,Ct]),Pt=(0,s.useCallback)(()=>{Ct.clearReturnToPrevious("dismissed")},[Ct]);return(0,n.jsx)("div",{className:nt.returnToPrevious,"data-testid":On.Tp.components.ReturnToPrevious.buttonGroup,children:(0,n.jsx)(cr,{label:(0,P.t)("return-to-previous.button.label","Back to {{title}}",{title:et}),onClick:vt,onDismiss:Pt})})},bs=Ee=>({returnToPrevious:(0,E.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:Ee.zIndex.tooltip,position:"fixed",bottom:Ee.spacing.x4,boxShadow:Ee.shadows.z3})});qa.displayName="ReturnToPrevious";var Es=e(7895),qs=e(88559),Er=e(95943),Wo=e(73427),di=e(43550),No=e(92948);function ui({href:Ee,isCurrent:et,text:nt,index:Ct,flexGrow:vt}){const Pt=(0,T.of)(Qr),fe=()=>{(0,m.rR)("grafana_breadcrumb_clicked",{url:Ee})};return(0,n.jsx)("li",{className:Pt.breadcrumbWrapper,style:{flexGrow:vt},children:et?(0,n.jsx)("span",{"data-testid":On.XF.Breadcrumbs.breadcrumb(nt),className:Pt.breadcrumb,"aria-current":"page",title:nt,children:nt}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{onClick:fe,"data-testid":On.XF.Breadcrumbs.breadcrumb(nt),className:(0,E.cx)(Pt.breadcrumb,Pt.breadcrumbLink),title:nt,href:Ee,children:nt}),(0,n.jsx)("div",{className:Pt.separator,"aria-hidden":!0,children:(0,n.jsx)(yn.I,{name:"angle-right"})})]})})}const Qr=Ee=>({breadcrumb:(0,E.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:Ee.colors.text.secondary}),breadcrumbLink:(0,E.css)({color:Ee.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,E.css)({alignItems:"center",color:Ee.colors.text.primary,display:"flex",flex:1,gap:Ee.spacing(.5),minWidth:0,maxWidth:"max-content",padding:Ee.spacing(.5,0,.5,.5),[Ee.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,E.css)({color:Ee.colors.text.secondary})});function Pr({breadcrumbs:Ee,className:et}){const nt=(0,T.of)(_i);return(0,n.jsx)("nav",{"aria-label":(0,P.t)("navigation.breadcrumbs.aria-label","Breadcrumbs"),className:et,children:(0,n.jsx)("ol",{className:nt.breadcrumbs,children:Ee.map((Ct,vt)=>(0,s.createElement)(ui,{...Ct,isCurrent:vt===Ee.length-1,key:vt,index:vt,flexGrow:Ri(vt,Ee.length)}))})})}function Ri(Ee,et){return et<5&&Ee>0&&Ee<et-2||et>6&&Ee>1&&Ee<et-3?4:10}const _i=Ee=>({breadcrumbs:(0,E.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var Ai=e(18607),_r=e(87063),kr=e(5423);function ki(Ee){switch(Ee){case"grafana-grafanadocsplugin-app":return"book";default:return"ai-sparkle"}}function Yi({isOpen:Ee,title:et,onClick:nt,pluginId:Ct},vt){const Pt=(0,T.of)(Fo),fe=ki(Ct);if(Ee)return(0,n.jsx)(Es.I,{ref:vt,className:(0,E.cx)(Pt.button,Pt.buttonActive),icon:fe,"data-testid":"extension-toolbar-button-close",variant:"default",onClick:nt,tooltip:(0,P.t)("navigation.extension-sidebar.button-tooltip.close","Close {{title}}",{title:et})});let ae=(0,P.t)("navigation.extension-sidebar.button-tooltip.open-all","Open AI assistants and sidebar apps");return et&&(ae=(0,P.t)("navigation.extension-sidebar.button-tooltip.open","Open {{title}}",{title:et})),(0,n.jsx)(Es.I,{ref:vt,className:(0,E.cx)(Pt.button),icon:fe,"data-testid":"extension-toolbar-button-open",variant:"default",onClick:nt,tooltip:ae})}const Ko=s.forwardRef(Yi);function Fo(Ee){return{button:(0,E.css)({aspectRatio:"1 / 1 !important",width:"28px",height:"28px",padding:0,justifyContent:"center",borderRadius:Ee.shape.radius.circle,margin:Ee.spacing(0,.25)}),buttonActive:(0,E.css)({borderRadius:Ee.shape.radius.circle,backgroundColor:Ee.colors.primary.transparent,border:`1px solid ${Ee.colors.primary.borderTransparent}`,color:Ee.colors.text.primary})}}function ji(){const{availableComponents:Ee,dockedComponentId:et,setDockedComponentId:nt,isOpen:Ct,isEnabled:vt}=(0,v.sA)();let Pt="",fe="";if(et){const Le=(0,v.rS)(et);Le&&(Pt=Le.componentTitle,fe=Le.pluginId)}if(!vt||Ee.size===0)return null;const ae=Array.from(Ee.entries()).flatMap(([Le,{addedComponents:Ze}])=>Ze.map(at=>({...at,pluginId:Le})));if(ae.length===0)return null;if(ae.length===1)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ko,{isOpen:Ct,title:ae[0].title,onClick:()=>{nt(Ct?void 0:(0,v.pF)(ae[0].pluginId,ae[0]))},pluginId:ae[0].pluginId}),(0,n.jsx)(kr.K,{})]});const xe=(0,n.jsx)(_r.W,{children:ae.map(Le=>{const Ze=(0,v.pF)(Le.pluginId,Le);return(0,n.jsx)(_r.W.Item,{active:et===Ze,label:Le.title,onClick:()=>{nt(Ct&&et===Ze?void 0:Ze)}},Ze)})});return(0,n.jsxs)(n.Fragment,{children:[Ct?(0,n.jsx)(Ko,{isOpen:!0,title:Pt,onClick:()=>{Ct&&nt(void 0)},pluginId:fe}):(0,n.jsx)(qs.m,{overlay:xe,placement:"bottom-end",children:(0,n.jsx)(Ko,{isOpen:!1})}),(0,n.jsx)(kr.K,{})]})}var ei=e(42941),wo=e(8207),Wr=e(45229),io=e(87745),Ji=e(95093),go=e.n(Ji),Zi=e(95004),pr=e(31286),Xi=e(35137),Co=e(8073),mo=e(53431),Vo=e(12810),To=e(48440);function Li({onClose:Ee}){const et=Ne.M.getObject(qn.lU,[]).filter(ae=>go()(ae.time).isAfter(go()().subtract(2,"day").startOf("day"))),[nt,Ct]=(0,s.useState)(5),vt=et.find(ae=>ae.url===window.location.href||ae.views.some(xe=>xe.url===window.location.href))?.time,Pt=et.slice(0,nt).reduce((ae,xe)=>{const Le=go()(xe.time);let Ze="";return Le.isSame(go()(),"day")?Ze=(0,P.t)("nav.history-wrapper.today","Today"):Le.isSame(go()().subtract(1,"day"),"day")?Ze=(0,P.t)("nav.history-wrapper.yesterday","Yesterday"):Ze=Le.format("YYYY-MM-DD"),ae[Ze]=[...ae[Ze]||[],xe],ae},{}),fe=(0,T.of)(Nr);return(0,n.jsxs)(ot.B,{direction:"column",alignItems:"flex-start",children:[(0,n.jsx)(pr.a,{width:"100%",children:Object.keys(Pt).map((ae,xe)=>(0,n.jsxs)(ot.B,{direction:"column",gap:1,children:[(0,n.jsx)(pr.a,{paddingLeft:2,children:(0,n.jsx)(Qt.E,{color:"secondary",children:ae})}),(0,n.jsx)("div",{className:fe.timeline,children:Pt[ae].map((Le,Ze)=>(0,n.jsx)(ti,{entry:Le,isSelected:Le.time===vt,onClick:()=>Ee()},Ze))})]},xe))}),et.length>nt&&(0,n.jsx)(pr.a,{paddingLeft:2,children:(0,n.jsx)(O.$n,{variant:"secondary",fill:"text",onClick:()=>{Ct(nt+5),(0,To.Ni)()},children:(0,P.t)("nav.history-wrapper.show-more","Show more")})})]})}function ti({entry:Ee,isSelected:et,onClick:nt}){const Ct=(0,T.of)(Nr),vt=(0,T.$j)(),[Pt,fe]=(0,s.useState)(et&&Ee.views.length>0),{breadcrumbs:ae,views:xe,time:Le,url:Ze,sparklineData:at}=Ee,ut=Pt?(0,P.t)("nav.history-wrapper.collapse","Collapse"):(0,P.t)("nav.history-wrapper.expand","Expand"),Et=Pt?(0,P.t)("nav.history-wrapper.icon-selected","Selected Entry"):(0,P.t)("nav.history-wrapper.icon-unselected","Normal Entry"),Wt=et&&Ee.views.find(_t=>_t.url===window.location.href)?.time;return(0,n.jsx)(pr.a,{marginBottom:1,children:(0,n.jsxs)(ot.B,{direction:"column",gap:1,children:[(0,n.jsxs)(ot.B,{alignItems:"baseline",children:[xe.length>0?(0,n.jsx)(ha.K,{name:Pt?"angle-down":"angle-right",onClick:()=>fe(!Pt),"aria-label":ut,className:Ct.iconButton}):(0,n.jsx)(Xi.$,{h:2}),(0,n.jsx)(yn.I,{size:"sm",name:et?"circle-mono":"circle","aria-label":Et,className:Pt?Ct.iconButtonDot:Ct.iconButtonCircle}),(0,n.jsx)(Co.Z,{onClick:()=>{Ne.M.setObject("CLICKING_HISTORY",!0),nt(),(0,To.bL)({entryURL:Ze})},href:Ze,isCompact:!0,className:et?Ct.card:(0,E.cx)(Ct.card,Ct.cardSelected),children:(0,n.jsxs)(ot.B,{direction:"column",children:[(0,n.jsx)("div",{children:ae.map((_t,nn)=>(0,n.jsxs)(Qt.E,{children:[_t.text," ",nn!==ae.length-1?"> ":""]},nn))}),(0,n.jsx)(Qt.E,{variant:"bodySmall",color:"secondary",children:(0,Vo.Y)(Le,{timeStyle:"short"})}),at&&(0,n.jsx)(mo.O,{theme:vt,width:240,height:40,config:{custom:{fillColor:"rgba(130, 181, 216, 0.1)",lineColor:"#82B5D8"}},sparkline:{y:{type:Zi.PU.number,name:"test",config:{},values:at.values,state:{range:{...at.range}}}}})]})})]}),Pt&&(0,n.jsx)("div",{className:Ct.expanded,children:xe.map((_t,nn)=>(0,n.jsx)(Co.Z,{href:_t.url,onClick:()=>{Ne.M.setObject("CLICKING_HISTORY",!0),nt(),(0,To.bL)({entryURL:_t.url,subEntry:"timeRange"})},isCompact:!0,className:_t.time===Wt?void 0:Ct.subCard,children:(0,n.jsxs)(ot.B,{direction:"column",gap:0,children:[(0,n.jsx)(Qt.E,{variant:"bodySmall",children:_t.name}),_t.description&&(0,n.jsx)(Qt.E,{color:"secondary",variant:"bodySmall",children:_t.description})]})},nn))})]})})}const Nr=Ee=>({card:(0,E.css)({label:"card",background:"none",margin:Ee.spacing(.5,0)}),cardSelected:(0,E.css)({label:"card-selected",background:"none"}),subCard:(0,E.css)({label:"subcard",background:"none",margin:0}),iconButton:(0,E.css)({label:"expand-button",margin:0}),iconButtonCircle:(0,E.css)({label:"blue-circle-icon",margin:0,background:Ee.colors.background.primary,fill:Ee.colors.primary.main,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),iconButtonDot:(0,E.css)({label:"blue-dot-icon",margin:0,color:Ee.colors.primary.main,border:Ee.shape.radius.circle,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),expanded:(0,E.css)({label:"expanded",display:"flex",flexDirection:"column",marginLeft:Ee.spacing(6),gap:Ee.spacing(1),position:"relative","&:before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:"1px",background:Ee.colors.border.weak}}),timeline:(0,E.css)({label:"timeline",position:"relative",height:"100%",width:"100%",paddingLeft:Ee.spacing(2),"&:before":{content:'""',position:"absolute",left:Ee.spacing(5.75),top:0,height:"100%",width:"1px",borderLeft:`1px dashed ${Ee.colors.border.strong}`}})});function Bi(){const[Ee,et]=(0,ei.A)(!1),nt=(0,T.of)(Ui);return(0,s.useEffect)(()=>{const Ct=Wr.l.subscribe(io.sj,vt=>{if(Ne.M.getObject("CLICKING_HISTORY")){Ne.M.setObject("CLICKING_HISTORY",!1);return}const fe=Ne.M.getObject(qn.lU,[]);let ae=fe[0];const xe=vt.payload.url;return ae.views[0]?.url!==xe&&(ae.views=[{name:vt.payload.name,description:vt.payload.description,url:xe,time:Date.now()},...ae.views],Ne.M.setObject(qn.lU,[...fe])),()=>{Ct.unsubscribe()}})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Es.I,{onClick:()=>{et(),(0,To.KX)({type:"open"})},iconOnly:!0,icon:"history","aria-label":(0,P.t)("nav.history-container.drawer-tittle","History")}),(0,n.jsx)(kr.K,{className:nt.separator}),Ee&&(0,n.jsx)(wo._,{title:(0,P.t)("nav.history-container.drawer-tittle","History"),onClose:()=>{et(),(0,To.KX)({type:"close"})},size:"sm",children:(0,n.jsx)(Li,{onClose:()=>et(!1)})})]})}const Ui=Ee=>({separator:(0,E.css)({[Ee.breakpoints.down("sm")]:{display:"none"}})});function hi(Ee){const et=[];for(const nt of Ee)nt.isCreateAction&&et.push(nt),nt.children&&et.push(...hi(nt.children));return et}const qi=({})=>{const Ee=(0,aa.d4)(fe=>fe.navBarTree),[et,nt]=(0,s.useState)(!1),Ct=(0,s.useMemo)(()=>{const fe=hi(Ee);return Ga&&fe.push({text:(0,P.t)("navigation.invite-user.invite-new-member-button","Invite new member"),url:(0,kn.o)("invite-user-top-bar"),target:"_blank",isCreateAction:!0,onClick:()=>{Ps("quick_add_button","invite-user-quick-add-button")}}),fe},[Ee]),vt=Ct.length>0;if(!vt)return null;const Pt=()=>(0,n.jsx)(_r.W,{children:Ct.map((fe,ae)=>(0,n.jsxs)("div",{children:[Ga&&ae===Ct.length-1&&(0,n.jsx)(_r.W.Divider,{}),(0,n.jsx)(_r.W.Item,{url:fe.url,label:fe.text,target:fe.target,onClick:()=>{(0,m.rR)("grafana_menu_item_clicked",{url:fe.url,from:"quickadd"}),fe.onClick?.()}})]},ae))});return vt?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(qs.m,{overlay:Pt,placement:"bottom-end",onVisibleChange:nt,children:(0,n.jsx)(Es.I,{iconOnly:!0,icon:"plus",isOpen:et,"aria-label":(0,P.t)("navigation.quick-add.aria-label","New")})}),(0,n.jsx)(kr.K,{})]}):null};var Mo=e(94535),Wi=e(89640),Ni=e(45450),el=e(35555),tl=e(3271);function So({theme:Ee}){return(0,n.jsx)(el.D.Provider,{value:Ee,children:(0,n.jsx)(fi,{})})}function fi(){const Ee=(0,T.of)(pi);return(0,n.jsx)(pr.a,{backgroundColor:"canvas",display:"flex",direction:"column",grow:1,children:(0,n.jsxs)(ot.B,{gap:0,direction:"column",children:[(0,n.jsxs)(pr.a,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:.5,backgroundColor:"primary",height:3,paddingY:.5,paddingX:1,children:[(0,n.jsxs)(ot.B,{alignItems:"center",gap:.5,children:[(0,n.jsx)(No.M.MenuLogo,{className:Ee.img}),(0,n.jsxs)("div",{className:Ee.breadcrumbs,children:[(0,n.jsx)(P.x6,{i18nKey:"theme-preview.breadcrumbs.home",children:"Home"}),(0,n.jsx)(yn.I,{className:Ee.breadcrumbSeparator,name:"angle-right"}),(0,n.jsx)(P.x6,{i18nKey:"theme-preview.breadcrumbs.dashboards",children:"Dashboards"})]})]}),(0,n.jsxs)(ot.B,{alignItems:"center",gap:.5,children:[(0,n.jsx)("div",{className:Ee.formInput}),(0,n.jsx)(pr.a,{borderStyle:"solid",borderColor:"medium",borderRadius:"circle",height:1,width:1,backgroundColor:"secondary",marginLeft:.5})]})]}),(0,n.jsx)(tl.c,{spacing:0}),(0,n.jsx)(pr.a,{padding:2.5,display:"flex",direction:"column",flex:1,children:(0,n.jsxs)("div",{className:Ee.panel,children:[(0,n.jsx)("div",{className:Ee.panelHeader,children:(0,n.jsx)(P.x6,{i18nKey:"theme-preview.panel.title",children:"Panel"})}),(0,n.jsxs)(pr.a,{padding:.5,display:"flex",direction:"column",gap:.5,grow:1,children:[(0,n.jsx)("div",{className:Ee.formLabel,children:(0,n.jsx)(P.x6,{i18nKey:"theme-preview.panel.form-label",children:"Form label"})}),(0,n.jsx)("div",{className:Ee.formInput})]}),(0,n.jsxs)(pr.a,{display:"flex",gap:.5,padding:1,justifyContent:"flex-end",children:[(0,n.jsx)("div",{className:(0,E.cx)(Ee.action,Ee.actionSecondary)}),(0,n.jsx)("div",{className:(0,E.cx)(Ee.action,Ee.actionDanger)}),(0,n.jsx)("div",{className:(0,E.cx)(Ee.action,Ee.actionPrimary)})]})]})})]})})}const pi=Ee=>({breadcrumbs:(0,E.css)({alignItems:"center",color:Ee.colors.text.primary,display:"flex",fontSize:Math.round(Ee.typography.fontSize/3),gap:Ee.spacing(.25),lineHeight:Math.round(Ee.typography.body.lineHeight/3),paddingLeft:Ee.spacing(.5)}),breadcrumbSeparator:(0,E.css)({height:Ee.spacing(.75),width:Ee.spacing(.75)}),img:(0,E.css)({height:Ee.spacing(1),width:Ee.spacing(1)}),panel:(0,E.css)({background:Ee.components.panel.background,border:`1px solid ${Ee.components.panel.borderColor}`,borderRadius:Ee.shape.radius.default,display:"flex",flexDirection:"column",flexGrow:1}),panelHeader:(0,E.css)({alignItems:"center",color:Ee.colors.text.primary,display:"flex",fontSize:Math.round(Ee.typography.fontSize/3),height:Ee.spacing(2),lineHeight:Math.round(Ee.typography.body.lineHeight/3),padding:Ee.spacing(.5)}),formLabel:(0,E.css)({color:Ee.colors.text.primary,fontSize:Math.round(Ee.typography.fontSize/3),lineHeight:Math.round(Ee.typography.body.lineHeight/3)}),formInput:(0,E.css)({background:Ee.components.input.background,border:`1px solid ${Ee.colors.border.medium}`,borderRadius:Ee.shape.radius.default,height:Ee.spacing(1),width:Ee.spacing(6)}),action:(0,E.css)({borderRadius:Ee.shape.radius.default,height:Ee.spacing(1),width:Ee.spacing(2.5)}),actionSecondary:(0,E.css)({background:Ee.colors.secondary.main}),actionDanger:(0,E.css)({background:Ee.colors.error.main}),actionPrimary:(0,E.css)({background:Ee.colors.primary.main})});function $o({themeOption:Ee,isExperimental:et,isSelected:nt,onSelect:Ct}){const vt=Ee.build(),Pt=Ki(Ee),fe=(0,T.of)(Rr);return(0,n.jsxs)("div",{className:fe.card,onClick:Ct,children:[(0,n.jsxs)("div",{className:fe.header,children:[(0,n.jsx)(Ni.J,{id:`theme-${vt.name}`,name:"theme",label:Pt,onClick:ae=>{ae.stopPropagation()},onChange:Ct,checked:nt}),et&&(0,n.jsx)(Ha.y,{featureState:Ua.Ay.experimental})]}),(0,n.jsx)(So,{theme:vt})]})}const Rr=Ee=>({card:(0,E.css)({border:`1px solid ${Ee.colors.border.weak}`,borderRadius:Ee.shape.radius.default,display:"flex",flexDirection:"column",overflow:"hidden",cursor:"pointer","&:hover":{border:`1px solid ${Ee.colors.border.medium}`}}),header:(0,E.css)({alignItems:"center",borderBottom:`1px solid ${Ee.colors.border.weak}`,display:"flex",justifyContent:"space-between",padding:Ee.spacing(1),"> label":{cursor:"pointer"}})});function Ki(Ee){switch(Ee.id){case"dark":return(0,P.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,P.t)("shared.preferences.theme.light-label","Light");case"system":return(0,P.t)("shared.preferences.theme.system-label","System preference");default:return Ee.name}}var sa=e(61074);function es({onClose:Ee}){const et=(0,T.of)(gi),nt=(0,sa.F)(),Ct=(0,T.$j)(),vt=fe=>{(0,m.rR)("grafana_preferences_theme_changed",{toTheme:fe.id,preferenceType:"theme_drawer"}),(0,ls.K)(fe.id,!1)},Pt=(0,n.jsxs)(P.x6,{i18nKey:"shared-preferences.fields.theme-description",children:["Enjoying the experimental themes? Tell us what you'd like to see"," ",(0,n.jsx)(Wi.Y,{variant:"bodySmall",external:!0,href:"https://docs.google.com/forms/d/e/1FAIpQLSeRKAY8nUMEVIKSYJ99uOO-dimF6Y69_If1Q1jTLOZRWqK1cw/viewform?usp=dialog",children:"here."})]});return(0,n.jsx)(wo._,{title:(0,P.t)("profile.change-theme","Change theme"),onClose:Ee,size:"md",subtitle:i.$.feedbackLinksEnabled?Pt:void 0,children:(0,n.jsx)("div",{className:et.grid,role:"radiogroup",children:nt.map(fe=>(0,n.jsx)($o,{themeOption:fe,isExperimental:fe.isExtra,onSelect:()=>vt(fe),isSelected:Ct.name===fe.name},fe.id))})})}const gi=Ee=>({grid:(0,E.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gridAutoRows:"250px",gap:Ee.spacing(2)})});var ni=e(73745),mi=e(49229),Oo=e(49185),vo=e(46831),Io=e(30054);function nl({feedUrl:Ee}){const et=(0,T.of)(br),{state:nt,getNews:Ct}=(0,Io.n)(Ee),[vt,Pt]=(0,Oo.A)();return(0,s.useEffect)(()=>{Ct()},[Ct]),nt.error?(0,n.jsx)("div",{className:et.innerWrapper,children:nt.error&&nt.error.message}):(0,n.jsxs)("div",{ref:vt,children:[nt.loading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(vo.K.Skeleton,{showImage:!0,width:Pt.width}),(0,n.jsx)(vo.K.Skeleton,{showImage:!0,width:Pt.width}),(0,n.jsx)(vo.K.Skeleton,{showImage:!0,width:Pt.width}),(0,n.jsx)(vo.K.Skeleton,{showImage:!0,width:Pt.width}),(0,n.jsx)(vo.K.Skeleton,{showImage:!0,width:Pt.width})]}):(0,n.jsx)(n.Fragment,{children:Pt.width>0&&nt.value?.map((fe,ae)=>(0,n.jsx)(vo.K,{index:ae,showImage:!0,width:Pt.width,data:nt.value},ae))}),(0,n.jsx)("div",{className:et.grot,children:(0,n.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:(0,P.t)("news.link-title","Go to Grafana labs blog"),children:(0,n.jsx)("img",{src:mi,alt:"Grot reading news"})})})]})}const br=Ee=>({innerWrapper:(0,E.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,E.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:Ee.spacing(5,0),img:{width:"186px",height:"186px"}})});function vl({onClose:Ee}){const et=(0,T.of)(ws);return(0,n.jsx)(wo._,{title:(0,n.jsxs)("div",{className:et.title,children:[(0,n.jsx)(Qt.E,{element:"h2",children:(0,P.t)("news.title","Latest from the blog")}),(0,n.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:(0,P.t)("news.link-title","Go to Grafana labs blog"),className:et.grot,children:(0,n.jsx)("img",{src:mi,alt:"Grot reading news"})})]}),onClose:Ee,size:"md",children:(0,n.jsx)(nl,{feedUrl:ni.$})})}const ws=Ee=>({title:(0,E.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:Ee.spacing(2)}),grot:(0,E.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:Ee.spacing(2,0),img:{width:"75px",height:"75px"}})});function vi({node:Ee,children:et}){const nt=(0,T.of)(al),Ct=(0,Wn.J0)((0,Se.cloneDeep)(Ee),!1);return Ct?(0,n.jsxs)(_r.W,{header:(0,n.jsxs)("div",{onClick:vt=>vt.stopPropagation(),className:nt.header,children:[(0,n.jsx)("div",{children:Ct.text}),Ct.subTitle&&(0,n.jsx)("div",{className:nt.subTitle,children:Ct.subTitle})]}),children:[Ct.children?.map(vt=>vt.url?(0,n.jsx)(Mo.D,{url:vt.url,label:vt.text,icon:vt.icon,target:vt.target},vt.id):(0,n.jsx)(Mo.D,{icon:vt.icon,onClick:vt.onClick,label:vt.text},vt.id)),et]}):null}const al=Ee=>({header:(0,E.css)({fontSize:Ee.typography.h5.fontSize,fontWeight:Ee.typography.h5.fontWeight,padding:Ee.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,E.css)({color:Ee.colors.text.secondary,fontSize:Ee.typography.bodySmall.fontSize})});function sl({profileNode:Ee,onToggleKioskMode:et}){const nt=(0,T.of)(er),Ct=(0,Wn.J0)((0,Se.cloneDeep)(Ee),!1),[vt,Pt]=(0,ei.A)(!1),[fe,ae]=(0,ei.A)(!1);if(!Ct)return null;const xe=()=>(0,n.jsx)(vi,{node:Ee,children:(0,n.jsxs)(n.Fragment,{children:[i.$.featureToggles.grafanaconThemes&&(0,n.jsx)(Mo.D,{icon:"palette",onClick:ae,label:(0,P.t)("profile.change-theme","Change theme")}),(0,n.jsx)(_r.W.Item,{icon:"monitor",onClick:et,label:(0,P.t)("profile.enable-kiosk-mode","Enable kiosk mode")}),i.$.newsFeedEnabled&&(0,n.jsx)(Mo.D,{icon:"rss",onClick:Pt,label:(0,P.t)("navigation.rss-button","Latest from the blog")}),(0,n.jsx)(_r.W.Divider,{}),!i.$.auth.disableSignoutMenu&&(0,n.jsx)(Mo.D,{url:`${i.$.appSubUrl}/logout`,label:(0,P.t)("nav.sign-out.title","Sign out"),icon:"arrow-from-right",target:"_self"})]})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(qs.m,{overlay:xe,placement:"bottom-end",children:(0,n.jsx)(Es.I,{className:nt.profileButton,imgSrc:Wo.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":(0,P.t)("navigation.profile.aria-label","Profile")})}),vt&&(0,n.jsx)(vl,{onClose:Pt}),fe&&(0,n.jsx)(es,{onClose:ae})]})}const er=Ee=>({profileButton:(0,E.css)({padding:Ee.spacing(0,.5),img:{borderRadius:Ee.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});var Kr=e(63704);function Fi(){const Ee=(0,d.zy)(),et=(0,T.of)(ai);let nt=Kr.sQ.sanitizeUrl(D.I.getUrlForPartial(Ee,{forceLogin:"true"}));return nt.startsWith("//")&&(nt=nt.replace(/\/+/g,"/")),(0,n.jsx)("a",{className:et.link,href:nt,target:"_self",children:(0,n.jsx)(P.x6,{i18nKey:"app-chrome.top-bar.sign-in",children:"Sign in"})})}const ai=Ee=>({link:(0,E.css)({paddingLeft:Ee.spacing(1),paddingRight:Ee.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var wi=e(68079),Ro=e(63527),yi=e(45967);function Vi({nodes:Ee,scopes:et,appliedScopes:nt,disabled:Ct,loading:vt,onInputClick:Pt,onRemoveAllClick:fe}){const[ae,xe]=(0,s.useState)(!1);(0,s.useEffect)(()=>{xe(!1)},[nt]);const Le=nt.length>0?(0,n.jsx)(ct,{nodes:Ee,scopes:et,appliedScopes:nt}):(0,n.jsx)(n.Fragment,{}),Ze=(0,s.useMemo)(()=>nt.map(ut=>et[ut.scopeId]?.spec.title||ut.scopeId).join(", "),[nt,et]),at=(0,s.useMemo)(()=>(0,n.jsx)(Ro.p,{readOnly:!0,placeholder:(0,P.t)("scopes.selector.input.placeholder","Select scopes..."),disabled:Ct,loading:vt,value:Ze,"aria-label":(0,P.t)("scopes.selector.input.placeholder","Select scopes..."),"data-testid":"scopes-selector-input",suffix:nt.length>0&&!Ct?(0,n.jsx)(ha.K,{"aria-label":(0,P.t)("scopes.selector.input.removeAll","Remove all scopes"),name:"times","data-testid":"scopes-selector-input-clear",onClick:()=>fe()}):void 0,onMouseOver:()=>xe(!0),onMouseOut:()=>xe(!1),onClick:()=>{Ct||Pt()}}),[Ct,vt,Pt,fe,nt,Ze]);return(0,n.jsx)(yi.m,{content:Le,show:nt.length===0?!1:ae,children:at})}function ct({nodes:Ee,scopes:et,appliedScopes:nt}){const Ct=(0,T.of)(ft);let vt;if(nt[0].scopeNodeId){let fe=_e(nt[0].scopeNodeId,Ee);fe=fe.slice(1,-1),vt=fe.map(ae=>Ee[ae]?.spec.title).filter(ae=>ae)}const Pt=nt.map(fe=>fe.scopeNodeId?Ee[fe.scopeNodeId]?.spec.title||fe.scopeNodeId:et[fe.scopeId]?.spec.title||fe.scopeId);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("p",{className:Ct.scopePath,children:(vt&&vt.length>0?vt.join(" > ")+" > ":"")+Pt.join(", ")})})}const ft=Ee=>({scopePath:(0,E.css)({color:Ee.colors.text.primary,fontSize:Ee.typography.pxToRem(12),margin:Ee.spacing(0,0)})});var Nt=e(70255);const tn=({recentScopes:Ee,onSelect:et})=>{const nt=(0,T.of)(mn),[Ct,vt]=(0,s.useState)(!1),Pt=(0,s.useId)();return(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("legend",{className:nt.legend,children:(0,n.jsxs)("button",{className:nt.expandButton,"aria-expanded":Ct,"aria-controls":Pt,onClick:()=>vt(!Ct),"data-testid":"scopes-selector-recent-scopes-section",children:[(0,n.jsx)(yn.I,{name:Ct?"angle-down":"angle-right"}),(0,n.jsx)(Qt.E,{variant:"body",children:(0,n.jsx)(P.x6,{i18nKey:"command-palette.section.recent-scopes"})})]})}),(0,n.jsx)(pr.a,{paddingLeft:3,paddingTop:Ct?1:0,paddingBottom:Ct?1:0,children:(0,n.jsx)(ot.B,{direction:"column",gap:1,id:Pt,children:Ct&&Ee.map(fe=>(0,n.jsx)("button",{className:nt.recentScopeButton,onClick:()=>{et(fe.map(ae=>ae.metadata.name))},children:(0,n.jsx)(Qt.E,{children:fe.map(ae=>ae.spec.title).join(", ")})},fe.map(ae=>ae.metadata.name).join(",")))})})]})},mn=Ee=>({recentScopeButton:(0,E.css)({textAlign:"left",background:"none",border:"none",padding:0,cursor:"pointer",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),expandButton:(0,E.css)({display:"flex",alignItems:"center",gap:Ee.spacing(1),background:"none",border:"none",padding:0,cursor:"pointer"}),legend:(0,E.css)({marginBottom:0})});function Dn({anyChildExpanded:Ee,query:et,resultsNodes:nt,scopeNodes:Ct}){const vt=(0,T.of)(Rn);return Ee||nt.some(Pt=>Ct[Pt.scopeNodeId].spec.nodeType==="container")&&!et?null:(0,n.jsx)("h6",{className:vt.container,"data-testid":"scopes-tree-headline",children:et?nt.length===0?(0,n.jsx)(P.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,n.jsx)(P.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,n.jsx)(P.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const Rn=Ee=>({container:(0,E.css)({color:Ee.colors.text.secondary,margin:Ee.spacing(1,0)})});var Kn=e(32635);function ra({anyChildExpanded:Ee,loadingNodeName:et,treeNode:nt,onNodeUpdate:Ct,scopeNodes:vt,selected:Pt,selectedScopes:fe,selectScope:ae,deselectScope:xe}){const Le=(0,T.of)(ca);if(Ee&&!nt.expanded)return null;const Ze=vt[nt.scopeNodeId];if(!Ze)return null;const ut=(Ze.spec.parentName?vt[Ze.spec.parentName]:void 0)?.spec.disableMultiSelect??!1,Et=We(Ze),Wt=Be(Ze);return(0,n.jsxs)("div",{role:"treeitem","aria-selected":nt.expanded,className:Ee?Le.expandedContainer:void 0,children:[(0,n.jsxs)("div",{className:(0,E.cx)(Le.title,Et&&!nt.expanded&&Le.titlePadding),children:[Et&&!nt.expanded?ut?(0,n.jsx)(Ni.J,{id:nt.scopeNodeId,name:nt.scopeNodeId,checked:Pt,label:"","data-testid":`scopes-tree-${nt.scopeNodeId}-radio`,onClick:()=>{Pt?xe(nt.scopeNodeId):ae(nt.scopeNodeId)}}):(0,n.jsx)(Kn.S,{checked:Pt,"data-testid":`scopes-tree-${nt.scopeNodeId}-checkbox`,onChange:()=>{Pt?xe(nt.scopeNodeId):ae(nt.scopeNodeId)}}):null,Wt?(0,n.jsxs)("button",{className:Le.expand,"data-testid":`scopes-tree-${nt.scopeNodeId}-expand`,"aria-label":nt.expanded?(0,P.t)("scopes.tree.collapse","Collapse"):(0,P.t)("scopes.tree.expand","Expand"),onClick:()=>{Ct(nt.scopeNodeId,!nt.expanded,nt.query)},children:[(0,n.jsx)(yn.I,{name:nt.expanded?"angle-down":"angle-right"}),Ze.spec.title]}):(0,n.jsx)("span",{"data-testid":`scopes-tree-${nt.scopeNodeId}-title`,children:Ze.spec.title})]}),(0,n.jsx)("div",{className:Le.children,children:nt.expanded&&(0,n.jsx)(Qa,{tree:nt,loadingNodeName:et,onNodeUpdate:Ct,scopeNodes:vt,selectedScopes:fe,selectScope:ae,deselectScope:xe})})]},nt.scopeNodeId)}const ca=Ee=>({expandedContainer:(0,E.css)({display:"flex",flexDirection:"column",maxHeight:"100%"}),title:(0,E.css)({alignItems:"center",display:"flex",gap:Ee.spacing(1),fontSize:Ee.typography.pxToRem(14),lineHeight:Ee.typography.pxToRem(22),padding:Ee.spacing(.5,0),"& > label":(0,E.css)({gap:0})}),titlePadding:(0,E.css)({paddingLeft:Ee.spacing(.5)}),expand:(0,E.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:Ee.spacing(1),margin:0,padding:0}),children:(0,E.css)({display:"flex",flexDirection:"column",overflowY:"hidden",maxHeight:"100%",paddingLeft:Ee.spacing(4)})});function ba({items:Ee,anyChildExpanded:et,lastExpandedNode:nt,maxHeight:Ct,selectedScopes:vt,scopeNodes:Pt,loadingNodeName:fe,onNodeUpdate:ae,selectScope:xe,deselectScope:Le}){const Ze=(0,T.of)(Sa);if(Ee.length===0)return null;const at=(0,n.jsx)("div",{role:"tree",className:et?Ze.expandedContainer:void 0,children:Ee.map(ut=>{const Et=We(Pt[ut.scopeNodeId])&&vt.some(Wt=>Wt.scopeNodeId?Wt.scopeNodeId===ut.scopeNodeId:Wt.scopeId===Pt[ut.scopeNodeId]?.spec.linkId);return(0,n.jsx)(ra,{treeNode:ut,selected:Et,selectedScopes:vt,scopeNodes:Pt,loadingNodeName:fe,anyChildExpanded:et,onNodeUpdate:ae,selectScope:xe,deselectScope:Le},ut.scopeNodeId)})});return nt?(0,n.jsx)(Ur.P,{minHeight:`${Math.min(5,Ee.length)*30}px`,maxHeight:Ct,children:at}):at}const Sa=Ee=>({expandedContainer:(0,E.css)({display:"flex",flexDirection:"column",maxHeight:"100%"})});function cs({anyChildExpanded:Ee,treeNode:et,onNodeUpdate:nt}){const Ct=(0,T.of)(fs),[vt,Pt]=(0,s.useState)({value:et.query,dirty:!1});return(0,s.useEffect)(()=>{!vt.dirty&&vt.value!==et.query&&Pt({value:et.query,dirty:!1})},[vt,et.query]),(0,Uo.A)(()=>{vt.dirty&&nt(et.scopeNodeId,!0,vt.value)},500,[vt.dirty,vt.value]),Ee?null:(0,n.jsx)(hs.Z,{placeholder:(0,P.t)("scopes.tree.search","Search"),value:vt.value,className:Ct.input,"data-testid":"scopes-tree-search",escapeRegex:!1,onChange:fe=>{Pt({value:fe,dirty:!0})}})}const fs=Ee=>({input:(0,E.css)({margin:Ee.spacing(1,0),minHeight:Ee.spacing(4),height:Ee.spacing(4),maxHeight:Ee.spacing(4),width:`calc(100% - ${Ee.spacing(.5)})`})});function Qa({tree:Ee,loadingNodeName:et,selectedScopes:nt,recentScopes:Ct,onRecentScopesSelect:vt,onNodeUpdate:Pt,scopeNodes:fe,selectScope:ae,deselectScope:xe}){const Le=(0,T.of)(Ns),Ze=et===Ee.scopeNodeId,at=Ee.children;let ut=Object.values(at||{});const Et=ut.some(({expanded:nn})=>nn);let Wt=[];nt.length>0&&nt[0].scopeNodeId&&Ee.scopeNodeId===fe[nt[0].scopeNodeId]?.spec.parentName&&(Wt=nt.filter(nn=>!ut.map(dn=>dn.scopeNodeId).includes(nn.scopeNodeId)).map(nn=>({scopeNodeId:nn.scopeNodeId,query:"",expanded:!1})));const _t=!Et&&Ee.expanded;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(cs,{anyChildExpanded:Et,onNodeUpdate:Pt,treeNode:Ee}),Ee.scopeNodeId===""&&!Et&&Ct&&Ct.length>0&&vt&&!Ee.query&&(0,n.jsx)(tn,{recentScopes:Ct,onSelect:vt}),Ze?(0,n.jsx)(Nt.A,{count:5,className:Le.loader}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ba,{items:Wt,anyChildExpanded:Et,lastExpandedNode:_t,loadingNodeName:et,onNodeUpdate:Pt,selectedScopes:nt,scopeNodes:fe,selectScope:ae,deselectScope:xe,maxHeight:`${Math.min(5,Wt.length)*30}px`}),(0,n.jsx)(Dn,{anyChildExpanded:Et,query:Ee.query,resultsNodes:ut,scopeNodes:fe}),(0,n.jsx)(ba,{items:ut,anyChildExpanded:Et,lastExpandedNode:_t,loadingNodeName:et,onNodeUpdate:Pt,selectedScopes:nt,scopeNodes:fe,selectScope:ae,deselectScope:xe,maxHeight:"100%"})]})]})}const Ns=Ee=>({loader:(0,E.css)({margin:Ee.spacing(.5,0)})}),$s=()=>{const{chrome:Ee}=(0,u.Il)(),et=Ee.useState(),nt=!et.chromeless&&et.megaMenuDocked&&et.megaMenuOpen,Ct=(0,T.of)(zs,nt),vt=(0,ue.b)(),Pt=ze(),fe=(0,vn.A)(Pt?.scopesSelectorService.stateObservable??new wn.c,Pt?.scopesSelectorService.state);if(!Pt||!vt||!vt.state.enabled||!fe)return null;const{nodes:ae,loadingNodeName:xe,opened:Le,selectedScopes:Ze,appliedScopes:at,tree:ut,scopes:Et}=fe,{scopesService:Wt,scopesSelectorService:_t,scopesDashboardsService:nn}=Pt,{readOnly:dn,drawerOpened:Pn,loading:Nn}=vt.state,{open:Cn,removeAllScopes:Tn,closeAndApply:_n,closeAndReset:ka,updateNode:ja,selectScope:ds,deselectScope:da,getRecentScopes:_a}=_t,gs=_a(),ts=dn?(0,P.t)("scopes.dashboards.toggle.disabled","Suggested dashboards list is disabled due to read only mode"):Pn?(0,P.t)("scopes.dashboards.toggle.collapse","Collapse suggested dashboards list"):(0,P.t)("scopes.dashboards.toggle.expand","Expand suggested dashboards list");return(0,n.jsxs)("div",{className:Ct.container,children:[(0,n.jsx)(ha.K,{name:"web-section-alt",className:Ct.dashboards,"aria-label":ts,tooltip:ts,"data-testid":"scopes-dashboards-expand",disabled:dn,onClick:nn.toggleDrawer}),(0,n.jsx)(Vi,{nodes:ae,scopes:Et,appliedScopes:at,disabled:dn,loading:Nn,onInputClick:()=>{Wt.state.readOnly||Cn()},onRemoveAllClick:Tn}),Le&&(0,n.jsx)(wo._,{title:(0,P.t)("scopes.selector.title","Select scopes"),size:"sm",onClose:ka,children:(0,n.jsxs)("div",{className:Ct.drawerContainer,children:[(0,n.jsx)("div",{className:Ct.treeContainer,children:Nn||!ut?(0,n.jsx)(wi.y,{"data-testid":"scopes-selector-loading"}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Qa,{tree:ut,loadingNodeName:xe,onNodeUpdate:ja,recentScopes:gs,selectedScopes:Ze,scopeNodes:ae,selectScope:ds,deselectScope:da,onRecentScopesSelect:Mr=>{_t.changeScopes(Mr),_t.closeAndReset()}})})}),(0,n.jsxs)("div",{className:Ct.buttonsContainer,children:[(0,n.jsx)(O.$n,{variant:"primary","data-testid":"scopes-selector-apply",onClick:_n,children:(0,n.jsx)(P.x6,{i18nKey:"scopes.selector.apply",children:"Apply"})}),(0,n.jsx)(O.$n,{variant:"secondary","data-testid":"scopes-selector-cancel",onClick:ka,children:(0,n.jsx)(P.x6,{i18nKey:"scopes.selector.cancel",children:"Cancel"})})]})]})})]})},zs=(Ee,et)=>({container:(0,E.css)({display:"flex",flexDirection:"row",paddingLeft:et?Ee.spacing(2):"unset"}),dashboards:(0,E.css)({color:Ee.colors.text.secondary,marginRight:Ee.spacing(2),"&:hover":(0,E.css)({color:Ee.colors.text.primary})}),drawerContainer:(0,E.css)({display:"flex",flexDirection:"column",height:"100%"}),treeContainer:(0,E.css)({display:"flex",flexDirection:"column",maxHeight:"100%",overflowY:"hidden",paddingLeft:Ee.spacing(.5)}),buttonsContainer:(0,E.css)({display:"flex",gap:Ee.spacing(1),marginTop:Ee.spacing(8)})});var Ds=e(31937);function as({actions:Ee,breadcrumbActions:et,scopes:nt}){const Ct=(0,T.of)(Ar);return(0,n.jsx)("div",{"data-testid":On.XF.NavToolbar.container,className:Ct.actionsBar,children:(0,n.jsxs)(ot.B,{alignItems:"center",justifyContent:"flex-start",flex:1,wrap:"nowrap",minWidth:0,children:[nt?.state.enabled?(0,n.jsx)($s,{}):void 0,(0,n.jsxs)(ot.B,{alignItems:"center",justifyContent:"flex-end",flex:1,wrap:"nowrap",minWidth:0,children:[et,et&&Ee&&(0,n.jsx)(kr.K,{}),Ee]})]})})}const Ar=Ee=>({actionsBar:(0,E.css)({alignItems:"center",backgroundColor:Ee.colors.background.primary,borderBottom:`1px solid ${Ee.colors.border.weak}`,display:"flex",height:(0,Ds.vn)(),padding:Ee.spacing(0,1,0,2)})});var Yr=e(35484);const Dr=s.memo(()=>{const{query:Ee}=(0,a.useKBar)(Ct=>({kbarSearchQuery:Ct.searchQuery,kbarIsOpen:Ct.visualState===a.VisualState.showing})),et=(0,Mt.i)("lg"),nt=()=>{Ee.toggle()};return et?(0,n.jsx)(jr,{onClick:nt}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Es.I,{iconOnly:!0,icon:"search","aria-label":(0,P.t)("nav.search.placeholderCommandPalette","Search..."),onClick:nt}),(0,n.jsx)(kr.K,{})]})});function jr({onClick:Ee}){const et=(0,T.of)(Ks),nt=(0,s.useMemo)(()=>(0,Jt.gn)(),[]);return(0,n.jsx)("div",{className:et.wrapper,"data-testid":On.Tp.components.NavToolbar.commandPaletteTrigger,children:(0,n.jsxs)("div",{className:et.inputWrapper,children:[(0,n.jsx)("div",{className:et.prefix,children:(0,n.jsx)(yn.I,{name:"search"})}),(0,n.jsx)("button",{className:et.fakeInput,onClick:Ee,children:(0,P.t)("nav.search.placeholderCommandPalette","Search...")}),(0,n.jsx)("div",{className:et.suffix,children:(0,n.jsx)(Qt.E,{variant:"bodySmall",children:`${nt}+k`})})]})})}const Ks=Ee=>{const et=(0,Ro.n)({theme:Ee});return{wrapper:(0,E.cx)(et.wrapper,(0,E.css)({width:"auto",minWidth:140,maxWidth:350,flexGrow:1})),inputWrapper:et.inputWrapper,prefix:et.prefix,suffix:(0,E.css)([et.suffix,{display:"flex",gap:Ee.spacing(.5)}]),fakeInput:(0,E.css)([et.input,{textAlign:"left",paddingLeft:28,color:Ee.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,Yr.getFocusStyles)(Ee)}]),button:(0,E.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}},ir=(0,s.memo)(function({onToggleMegaMenu:et,onToggleKioskMode:nt,pageNav:Ct,sectionNav:vt,scopes:Pt,actions:fe,breadcrumbActions:ae,showToolbarLevel:xe}){const{chrome:Le}=(0,u.Il)(),Ze=Le.useState(),at=!Ze.chromeless&&Ze.megaMenuDocked&&Ze.megaMenuOpen,ut=(0,T.of)(ar,at),Et=(0,aa.d4)(Tn=>Tn.navIndex),Wt=(0,Se.cloneDeep)(Et.help),_t=Wt?(0,Wn.CS)(Wt):void 0,nn=Et.profile,dn=(0,aa.d4)(Tn=>Tn.navIndex)[di.Id],Pn=(0,Ai.Z)(vt,Ct,dn),Nn=ia.$W.featureToggles.unifiedHistory,Cn=!(0,Mt.i)("sm");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:ut.layout,children:[(0,n.jsxs)(ot.B,{minWidth:0,gap:.5,alignItems:"center",flex:{xs:2,lg:1},children:[!at&&(0,n.jsx)(Es.I,{narrow:!0,id:Er.Ut,onClick:et,tooltip:(0,P.t)("navigation.megamenu.open","Open menu"),children:(0,n.jsxs)(ot.B,{gap:0,alignItems:"center",children:[(0,n.jsx)(No.M.MenuLogo,{className:ut.img}),(0,n.jsx)(yn.I,{size:"sm",name:"angle-down"})]})}),(0,n.jsx)(Pr,{breadcrumbs:Pn,className:ut.breadcrumbsWrapper}),!xe&&ae]}),(0,n.jsxs)(ot.B,{gap:.5,alignItems:"center",justifyContent:"flex-end",flex:1,"data-testid":xe?void 0:On.XF.NavToolbar.container,minWidth:{xs:"unset",lg:0},children:[(0,n.jsx)(Dr,{}),Nn&&!Cn&&(0,n.jsx)(Bi,{}),!Cn&&(0,n.jsx)(qi,{}),_t&&(0,n.jsx)(qs.m,{overlay:()=>(0,n.jsx)(vi,{node:_t}),placement:"bottom-end",children:(0,n.jsx)(Es.I,{iconOnly:!0,icon:"question-circle","aria-label":(0,P.t)("navigation.help.aria-label","Help")})}),(0,n.jsx)(kr.K,{}),ia.$W.featureToggles.extensionSidebar&&!Cn&&(0,n.jsx)(ji,{}),!xe&&fe,!Wo.TP.user.isSignedIn&&(0,n.jsx)(Fi,{}),nn&&(0,n.jsx)(sl,{profileNode:nn,onToggleKioskMode:nt})]})]}),xe&&(0,n.jsx)(as,{scopes:Pt,actions:fe,breadcrumbActions:ae})]})}),ar=(Ee,et)=>({layout:(0,E.css)({height:(0,Ds.vn)(),display:"flex",gap:Ee.spacing(2),alignItems:"center",padding:Ee.spacing(0,1),paddingLeft:et?Ee.spacing(3.5):Ee.spacing(.75),borderBottom:`1px solid ${Ee.colors.border.weak}`,justifyContent:"space-between"}),breadcrumbsWrapper:(0,E.css)({display:"flex",overflow:"hidden",[Ee.breakpoints.down("sm")]:{minWidth:"40%"}}),img:(0,E.css)({alignSelf:"center",height:Ee.spacing(3),width:Ee.spacing(3)}),kioskToggle:(0,E.css)({[Ee.breakpoints.down("lg")]:{display:"none"}})});function yo({children:Ee}){const{chrome:et}=(0,u.Il)(),{isOpen:nt,isEnabled:Ct,extensionSidebarWidth:vt,setExtensionSidebarWidth:Pt}=(0,v.sA)(),fe=et.useState(),ae=(0,ue.b)(),xe=!fe.chromeless&&fe.megaMenuDocked&&fe.megaMenuOpen,Le=!!(ae?.state.enabled&&ae?.state.drawerOpened&&!ae?.state.readOnly),Ze=(0,Ds.UH)(),at=Ze*(0,Ds.vn)(),ut=(0,T.of)(no,at),Et=(0,T.of)(dr,vt),Wt=(0,T.of)(It.l);Cs(et),(0,Wn.n0)(fe.megaMenuOpen,fe.megaMenuDocked);const _t=(0,E.cx)({[ut.content]:!0,[ut.contentChromeless]:fe.chromeless,[ut.contentWithSidebar]:nt&&!fe.chromeless}),nn=()=>{et.setMegaMenuOpen(!fe.megaMenuOpen)},{pathname:dn,search:Pn}=c.Ny.getLocation(),Nn=dn+Pn,Cn=fe.returnToPrevious&&Nn!==fe.returnToPrevious.href;return(0,s.useEffect)(()=>{fe.returnToPrevious&&Nn===fe.returnToPrevious.href&&et.clearReturnToPrevious("auto_dismissed")},[et,Nn]),(0,s.useEffect)(()=>{const Tn=(0,c.SE)(Pn);et.setKioskModeFromUrl(Tn.kiosk)},[et,Pn]),(0,n.jsxs)("div",{className:Lt()("main-view",{"main-view--chrome-hidden":fe.chromeless}),children:[!fe.chromeless&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.z9,{className:ut.skipLink,href:"#pageContent",children:(0,n.jsx)(P.x6,{i18nKey:"app-chrome.skip-content-button",children:"Skip to main content"})}),xe&&(0,n.jsx)(Va,{className:ut.dockedMegaMenu,onClose:()=>et.setMegaMenuOpen(!1)}),(0,n.jsx)("header",{className:(0,E.cx)(ut.topNav,xe&&ut.topNavMenuDocked),children:(0,n.jsx)(ir,{sectionNav:fe.sectionNav.node,pageNav:fe.pageNav,onToggleMegaMenu:nn,onToggleKioskMode:et.onToggleKioskMode,actions:fe.actions,breadcrumbActions:fe.breadcrumbActions,scopes:ae,showToolbarLevel:Ze===2})})]}),(0,n.jsx)("div",{className:_t,children:(0,n.jsxs)("div",{className:(0,E.cx)(ut.panes,{[ut.panesWithSidebar]:nt}),children:[!fe.chromeless&&(0,n.jsx)("div",{className:(0,E.cx)(ut.scopesDashboardsContainer,{[ut.scopesDashboardsContainerDocked]:xe}),children:(0,n.jsx)(h.Xw,{children:(0,n.jsx)(At,{})})}),(0,n.jsx)("main",{className:(0,E.cx)(ut.pageContainer,{[ut.pageContainerMenuDocked]:xe||Le,[ut.pageContainerMenuDockedScopes]:xe&&Le,[ut.pageContainerWithSidebar]:!fe.chromeless&&nt,[Et.contentWidth]:!fe.chromeless&&nt}),id:"pageContent",children:Ee}),!fe.chromeless&&Ct&&nt&&(0,n.jsx)(Tt.c,{className:ut.sidebarContainer,defaultSize:{width:vt},enable:{left:!0},onResize:(Tn,_n,ka)=>Pt(ka.getBoundingClientRect().width),handleClasses:{left:Wt.dragHandleBaseVertical},minWidth:Ma.nf,maxWidth:Ma.T0,children:(0,n.jsx)(Ma.EE,{})})]})}),!fe.chromeless&&!fe.megaMenuDocked&&(0,n.jsx)(nr,{}),!fe.chromeless&&(0,n.jsx)(xr,{}),Cn&&fe.returnToPrevious&&(0,n.jsx)(qa,{href:fe.returnToPrevious.href,title:fe.returnToPrevious.title})]})}function Cs(Ee){const et=Ut.A.getBool(qn.hE,!0),nt=(0,Mt.i)("xl");(0,s.useEffect)(()=>{if(!et)return;const Ct=Ee.state.getValue();nt&&!Ct.megaMenuDocked?(Ee.setMegaMenuDocked(!0,!1),Ee.setMegaMenuOpen(!0)):!nt&&Ct.megaMenuDocked&&(Ee.setMegaMenuDocked(!1,!1),Ee.setMegaMenuOpen(!1))},[nt,Ee,et])}const no=(Ee,et)=>({content:(0,E.css)({label:"page-content",display:"flex",flexDirection:"column",paddingTop:et,flexGrow:1,height:"auto"}),contentWithSidebar:(0,E.css)({height:"100vh",overflow:"hidden"}),contentChromeless:(0,E.css)({paddingTop:0}),dockedMegaMenu:(0,E.css)({background:Ee.colors.background.primary,borderRight:`1px solid ${Ee.colors.border.weak}`,display:"none",height:"100%",position:"fixed",top:0,width:ga,zIndex:2,[Ee.breakpoints.up("xl")]:{display:"flex",flexDirection:"column"}}),scopesDashboardsContainer:(0,E.css)({position:"fixed",height:`calc(100% - ${et}px)`,zIndex:1}),scopesDashboardsContainerDocked:(0,E.css)({left:ga}),topNav:(0,E.css)({display:"flex",position:"fixed",zIndex:Ee.zIndex.navbarFixed,left:0,right:0,background:Ee.colors.background.primary,flexDirection:"column"}),topNavMenuDocked:(0,E.css)({left:ga}),panes:(0,E.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}),panesWithSidebar:(0,E.css)({height:"100%",overflow:"hidden",position:"relative"}),pageContainerMenuDocked:(0,E.css)({paddingLeft:ga}),pageContainerMenuDockedScopes:(0,E.css)({paddingLeft:`calc(${ga} * 2)`}),pageContainer:(0,E.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}),pageContainerWithSidebar:(0,E.css)({overflow:"auto",height:"100%",minHeight:0}),skipLink:(0,E.css)({position:"fixed",top:-1e3,":focus":{left:Ee.spacing(1),top:Ee.spacing(1),zIndex:Ee.zIndex.portal}}),sidebarContainer:(0,E.css)({position:"fixed !important",top:et,bottom:0,zIndex:2,right:0})}),dr=(Ee,et=0)=>({contentWidth:(0,E.css)({maxWidth:`calc(100% - ${et}px) !important`})});var ao=e(33604),lo=e(22099);const rl={"/login":!0,"/signup":!0,"/verify":!0,"/user/password/send-reset-email":!0,"/user/password/reset":!0,"/sandbox/benchmarks":!0};function $i(){const Ee=(0,Ke.zy)();return i.$.featureToggles.enableAppChromeExtensions!==!0||rl[Ee.pathname]?null:(0,n.jsx)(jl,{})}function jl(){const{components:Ee,isLoading:et}=(0,ao.f)({extensionPointId:Xs.S.AppChrome});return et?null:(0,lo.RC)({props:{},components:Ee,pluginId:"grafana-setupguide-app"})}var xi=e(32899),zo=e(6890),Ll=e(12066),zi=e(64762),Bl=e(94701),Ul=e(96221);function ol({appNotification:Ee,onClearNotification:et}){const nt=(0,T.of)(Ls);(0,Bl.A)(()=>{setTimeout(()=>{et(Ee.id)},Ul.g2[Ee.severity])});const Ct=Ee.component||Ee.text||Ee.traceId,vt=Ee.traceId;return(0,n.jsx)(X.F,{severity:Ee.severity,title:Ee.title,onRemove:()=>et(Ee.id),elevated:!0,children:Ct&&(0,n.jsxs)("div",{className:nt.wrapper,children:[(0,n.jsx)("span",{children:Ee.component||Ee.text}),vt&&(0,n.jsx)("span",{className:nt.trace,children:(0,n.jsxs)(P.x6,{i18nKey:"app-notification.item.trace-id",children:["Trace ID: ",{traceId:vt}]})})]})})}function Ls(Ee){return{wrapper:(0,E.css)({display:"flex",flexDirection:"column"}),trace:(0,E.css)({fontSize:Ee.typography.pxToRem(10)})}}function il(){const Ee=(0,aa.d4)(vt=>(0,Ll.fX)(vt.appNotifications)),et=(0,aa.wA)(),nt=(0,T.of)(Ei);(0,s.useEffect)(()=>{Wr.A.on(xi.r1.alertWarning,vt=>et((0,zo.dx)((0,zi.q8)(...vt)))),Wr.A.on(xi.r1.alertSuccess,vt=>et((0,zo.dx)((0,zi.tZ)(...vt)))),Wr.A.on(xi.r1.alertError,vt=>et((0,zo.dx)((0,zi.gi)(...vt)))),Wr.A.on(xi.r1.alertInfo,vt=>et((0,zo.dx)((0,zi.Cf)(...vt))))},[et]);const Ct=vt=>{et((0,zo.Do)(vt))};return(0,n.jsx)("div",{className:nt.wrapper,children:(0,n.jsx)(ot.B,{direction:"column",children:Ee.map((vt,Pt)=>(0,n.jsx)(ol,{appNotification:vt,onClearNotification:Ct},`${vt.id}-${Pt}`))})})}function Ei(Ee){return{wrapper:(0,E.css)({label:"app-notifications-list",zIndex:Ee.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var yl=e(71599);function xl(Ee){const[et,nt]=(0,s.useState)({component:null,props:{}}),Ct=(0,s.useMemo)(()=>{function vt(fe,ae){nt({component:fe,props:ae})}function Pt(){nt({component:null,props:{}})}return{component:et.component,props:{...et.props,isOpen:!0,onDismiss:Pt},showModal:vt,hideModal:Pt}},[et]);return(0,s.useEffect)(()=>{Wr.A.subscribe(io.S8,({payload:Pt})=>{nt({component:Pt.component,props:Pt.props})}),Wr.A.subscribe(io.bY,Pt=>{El(Pt,nt)});let vt="";c.Ny.getHistory().listen(Pt=>{Pt.pathname!==vt&&nt({component:null,props:{}}),vt=Pt.pathname})},[]),(0,n.jsx)(lt.wE.Provider,{value:Ct,children:Ee.children})}function El({payload:Ee},et){const{confirmText:nt,onConfirm:Ct=()=>{},onDismiss:vt,text2:Pt,altActionText:fe,onAltAction:ae,noText:xe,text:Le,text2htmlBind:Ze,yesText:at="Yes",icon:ut,title:Et="Confirm",yesButtonVariant:Wt}=Ee,_t=()=>et({component:null,props:{}}),nn={confirmText:at,confirmButtonVariant:Wt,confirmationText:nt,icon:ut,title:Et,body:Le,description:Pt&&Ze?Kr.sQ.sanitize(Pt):Pt,isOpen:!0,dismissText:xe,onConfirm:()=>{Ct(),_t()},onDismiss:()=>{vt?.(),_t()},onAlternative:ae?()=>{ae(),_t()}:void 0,alternativeText:fe};et({component:yl.u,props:nn})}var Pl=e(52830);function bl(Ee){return Ee.providers.reduce((et,nt)=>(0,n.jsx)(nt,{children:et}),Ee.children)}function Pi(Ee){return(0,n.jsx)(Ke.Ix,{history:c.Ny.getHistory(),children:(0,n.jsx)(c._K,{service:c.Ny,children:(0,n.jsx)(qe.CompatRouter,{children:(0,n.jsx)(Pl.YZ,{children:(0,n.jsx)(bl,{providers:Ee.providers,children:(0,n.jsxs)(xl,{children:[(0,n.jsxs)(yo,{children:[(0,n.jsx)(il,{}),(0,n.jsxs)(ot.B,{gap:0,grow:1,direction:"column",children:[Ee.pageBanners.map((et,nt)=>(0,n.jsx)(et,{},nt.toString())),Ee.routes]}),Ee.bodyRenderHooks.map((et,nt)=>(0,n.jsx)(et,{},nt.toString())),(0,n.jsx)($i,{})]}),(0,n.jsx)(lt.EO,{})]})})})})})})}let bi=[],ll=[];const cl=[];function Dl(Ee){cl.push(Ee)}function Cl(Ee){bi.push(Ee)}function Wl(Ee){ll.push(Ee)}class Nl extends s.Component{constructor(et){super(et),this.iconCacheID=`grafana-icon-cache-${i.$.buildInfo.commit}`,this.renderRoute=nt=>(0,n.jsx)(d.qh,{caseSensitive:nt.sensitive===void 0?!1:nt.sensitive,path:nt.path,element:(0,n.jsx)(G,{route:nt})},nt.path),this.state={}}async componentDidMount(){this.setState({ready:!0}),$(".preloader").remove();const et=await window.caches?.keys()??[];for(const nt of et)nt.startsWith("grafana-icon-cache")&&nt!==this.iconCacheID&&window.caches.delete(nt)}renderRoutes(){return(0,n.jsx)(d.BV,{children:(0,g.kz)().map(et=>this.renderRoute(et))})}render(){const{app:et}=this.props,{ready:nt}=this.state;(0,c.Lc)("AppWrapper",!1,"rendering");const Ct=ae=>{(0,m.rR)("command_palette_action_selected",{actionId:ae.id,actionName:ae.name})},vt={routes:nt&&this.renderRoutes(),pageBanners:ll,bodyRenderHooks:bi,providers:cl},Pt=i.$.featureToggles.timeRangeProvider?p.A:s.Fragment,fe=i.$.featureToggles.extensionSidebar?v.kn:s.Fragment;return(0,n.jsx)(o.Provider,{store:y.M_,children:(0,n.jsx)(h.Xw,{style:"page",children:(0,n.jsx)(u.YE.Provider,{value:et.context,children:(0,n.jsx)(J.N,{value:i.$.theme2,children:(0,n.jsx)(l.A,{name:this.iconCacheID,children:(0,n.jsx)(a.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:Ct}},children:(0,n.jsx)(Pt,{children:(0,n.jsx)(ge,{children:(0,n.jsx)(ne.AZ,{registries:se.qm,children:(0,n.jsxs)(fe,{children:[(0,n.jsx)(f,{}),(0,n.jsxs)("div",{className:"grafana-app",children:[(0,n.jsx)(Pi,{...vt}),(0,n.jsx)(q,{}),(0,n.jsx)(r.qB,{})]})]})})})})})})})})})})}}},87161:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>c,k:()=>m});var n=e(75816),a=e(73892),s=e(85618);const l=(0,s.TP)("folder.grafana.app","v1beta1"),o=(0,n.xP)({reducerPath:"folderAPIv1beta1",baseQuery:(0,a.W)({baseURL:l}),endpoints:()=>({})}),d=["API Discovery","Folder"],c=o.enhanceEndpoints({addTagTypes:d}).injectEndpoints({endpoints:p=>({getApiResources:p.query({query:()=>({url:"/apis/folder.grafana.app/v1beta1/"}),providesTags:["API Discovery"]}),listFolder:p.query({query:h=>({url:"/folders",params:{pretty:h.pretty,allowWatchBookmarks:h.allowWatchBookmarks,continue:h.continue,fieldSelector:h.fieldSelector,labelSelector:h.labelSelector,limit:h.limit,resourceVersion:h.resourceVersion,resourceVersionMatch:h.resourceVersionMatch,sendInitialEvents:h.sendInitialEvents,timeoutSeconds:h.timeoutSeconds,watch:h.watch}}),providesTags:["Folder"]}),createFolder:p.mutation({query:h=>({url:"/folders",method:"POST",body:h.folder,params:{pretty:h.pretty,dryRun:h.dryRun,fieldManager:h.fieldManager,fieldValidation:h.fieldValidation}}),invalidatesTags:["Folder"]}),deletecollectionFolder:p.mutation({query:h=>({url:"/folders",method:"DELETE",params:{pretty:h.pretty,continue:h.continue,dryRun:h.dryRun,fieldSelector:h.fieldSelector,gracePeriodSeconds:h.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:h.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:h.labelSelector,limit:h.limit,orphanDependents:h.orphanDependents,propagationPolicy:h.propagationPolicy,resourceVersion:h.resourceVersion,resourceVersionMatch:h.resourceVersionMatch,sendInitialEvents:h.sendInitialEvents,timeoutSeconds:h.timeoutSeconds}}),invalidatesTags:["Folder"]}),getFolder:p.query({query:h=>({url:`/folders/${h.name}`,params:{pretty:h.pretty}}),providesTags:["Folder"]}),replaceFolder:p.mutation({query:h=>({url:`/folders/${h.name}`,method:"PUT",body:h.folder,params:{pretty:h.pretty,dryRun:h.dryRun,fieldManager:h.fieldManager,fieldValidation:h.fieldValidation}}),invalidatesTags:["Folder"]}),deleteFolder:p.mutation({query:h=>({url:`/folders/${h.name}`,method:"DELETE",params:{pretty:h.pretty,dryRun:h.dryRun,gracePeriodSeconds:h.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:h.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:h.orphanDependents,propagationPolicy:h.propagationPolicy}}),invalidatesTags:["Folder"]}),updateFolder:p.mutation({query:h=>({url:`/folders/${h.name}`,method:"PATCH",body:h.patch,params:{pretty:h.pretty,dryRun:h.dryRun,fieldManager:h.fieldManager,fieldValidation:h.fieldValidation,force:h.force}}),invalidatesTags:["Folder"]}),getFolderAccess:p.query({query:h=>({url:`/folders/${h.name}/access`}),providesTags:["Folder"]}),getFolderChildren:p.query({query:h=>({url:`/folders/${h.name}/children`}),providesTags:["Folder"]}),getFolderCounts:p.query({query:h=>({url:`/folders/${h.name}/counts`}),providesTags:["Folder"]}),getFolderParents:p.query({query:h=>({url:`/folders/${h.name}/parents`}),providesTags:["Folder"]})}),overrideExisting:!1}).enhanceEndpoints({}),{useGetFolderQuery:m}=c},94659:(Z,R,e)=>{"use strict";e.d(R,{v:()=>c,E:()=>m});var n=e(75816),a=e(73892),s=e(85618);const l=(0,s.TP)("iam.grafana.app","v0alpha1"),o=(0,n.xP)({baseQuery:(0,a.W)({baseURL:l}),reducerPath:"iamAPIv0alpha1",endpoints:()=>({})}),d=["Display"],i=o.enhanceEndpoints({addTagTypes:d}).injectEndpoints({endpoints:p=>({getDisplayMapping:p.query({query:h=>({url:"/display",params:{key:h.key}}),providesTags:["Display"]})}),overrideExisting:!1}),c=i.enhanceEndpoints({}),{useGetDisplayMappingQuery:m}=i},58614:(Z,R,e)=>{"use strict";e.d(R,{o3:()=>r,Dp:()=>y,Iq:()=>v,Uu:()=>x,o6:()=>f,Lv:()=>u});var n=e(68143),a=e(6890),s=e(64762),l=e(15130),o=e(85618),d=e(75816),i=e(73892);const c=(0,o.TP)("playlist.grafana.app","v0alpha1"),m=(0,d.xP)({reducerPath:"playlistAPIv0alpha1",baseQuery:(0,i.W)({baseURL:c}),endpoints:()=>({})}),p=["Playlist"],r=m.enhanceEndpoints({addTagTypes:p}).injectEndpoints({endpoints:b=>({listPlaylist:b.query({query:E=>({url:"/playlists",params:{pretty:E.pretty,allowWatchBookmarks:E.allowWatchBookmarks,continue:E.continue,fieldSelector:E.fieldSelector,labelSelector:E.labelSelector,limit:E.limit,resourceVersion:E.resourceVersion,resourceVersionMatch:E.resourceVersionMatch,sendInitialEvents:E.sendInitialEvents,timeoutSeconds:E.timeoutSeconds,watch:E.watch}}),providesTags:["Playlist"]}),createPlaylist:b.mutation({query:E=>({url:"/playlists",method:"POST",body:E.playlist,params:{pretty:E.pretty,dryRun:E.dryRun,fieldManager:E.fieldManager,fieldValidation:E.fieldValidation}}),invalidatesTags:["Playlist"]}),getPlaylist:b.query({query:E=>({url:`/playlists/${E.name}`,params:{pretty:E.pretty}}),providesTags:["Playlist"]}),replacePlaylist:b.mutation({query:E=>({url:`/playlists/${E.name}`,method:"PUT",body:E.playlist,params:{pretty:E.pretty,dryRun:E.dryRun,fieldManager:E.fieldManager,fieldValidation:E.fieldValidation}}),invalidatesTags:["Playlist"]}),deletePlaylist:b.mutation({query:E=>({url:`/playlists/${E.name}`,method:"DELETE",params:{pretty:E.pretty,dryRun:E.dryRun,gracePeriodSeconds:E.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:E.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:E.orphanDependents,propagationPolicy:E.propagationPolicy}}),invalidatesTags:["Playlist"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{getPlaylist:{transformResponse:async b=>(await g(b.spec),b)},createPlaylist:b=>{const E=b.query;E&&(b.query=D=>{if(!D.playlist.metadata.name&&!D.playlist.metadata.generateName){const C=l.TP.user.login;D.playlist.metadata.generateName=C?C.slice(0,2):"g"}return E(D)}),b.onQueryStarted=async(D,{queryFulfilled:C,dispatch:P})=>{try{await C,P((0,a.dx)((0,s.tZ)("Playlist created")))}catch(T){(0,o.H4)(T,P,"Unable to create playlist")}}},replacePlaylist:{onQueryStarted:async(b,{queryFulfilled:E,dispatch:D})=>{try{await E,D((0,a.dx)((0,s.tZ)("Playlist updated")))}catch(C){(0,o.H4)(C,D,"Unable to update playlist")}}},deletePlaylist:{onQueryStarted:async(b,{queryFulfilled:E,dispatch:D})=>{try{await E,D((0,a.dx)((0,s.tZ)("Playlist deleted")))}catch(C){(0,o.H4)(C,D,"Unable to delete playlist")}}}}});async function g(b){if(b?.items){for(const E of b.items)if(E.type==="dashboard_by_id"){E.type="dashboard_by_uid";const D=await(0,n.AI)().get(`/api/dashboards/ids/${E.value}`);D?.length&&(E.value=D[0])}}}const{useCreatePlaylistMutation:y,useDeletePlaylistMutation:v,useGetPlaylistQuery:x,useListPlaylistQuery:f,useReplacePlaylistMutation:u}=r},64975:(Z,R,e)=>{"use strict";e.d(R,{C:()=>l,F:()=>o});var n=e(75816),a=e(43173),s=e(73892);const l=`apis/provisioning.grafana.app/v0alpha1/namespaces/${a.$.namespace}`,o=(0,n.xP)({reducerPath:"provisioningAPIv0alpha1",baseQuery:(0,s.W)({baseURL:l}),endpoints:()=>({})})},33680:(Z,R,e)=>{"use strict";e.d(R,{PP:()=>F,tj:()=>D,bS:()=>I,ZL:()=>g,L:()=>N,Qo:()=>C,So:()=>f,KA:()=>y,F9:()=>A,Bm:()=>u,Kw:()=>b,$j:()=>T,qC:()=>O,$9:()=>j,Sw:()=>v,nS:()=>B,c2:()=>S,v$:()=>U,L3:()=>p,Ih:()=>r,XM:()=>E,hD:()=>x});var n=e(92745),a=e(68143),s=e(6890),l=e(64762),o=e(54115);function d(V){return async function(G,{updateCachedData:H,cacheDataLoaded:_,cacheEntryRemoved:k}){if(!G?.watch)return;const J=new o.ws({group:"provisioning.grafana.app",version:"v0alpha1",resource:V});let z=null;try{const X=(await _).data.metadata?.resourceVersion;z=J.watch({resourceVersion:X}).subscribe(Q=>{H(q=>{q.items||(q.items=[]);const te=q.items.findIndex(ne=>ne.metadata?.name===Q.object.metadata.name);Q.type==="ADDED"&&te===-1?q.items.push(Q.object):Q.type==="DELETED"&&te!==-1?q.items.splice(te,1):te!==-1&&(q.items[te]=Q.object)})})}catch(Y){console.error("Error in onCacheEntryAdded:",Y)}await k,z?.unsubscribe()}}var i=e(64975);const c=["Job","Repository","Provisioning"],m=i.F.enhanceEndpoints({addTagTypes:c}).injectEndpoints({endpoints:V=>({listJob:V.query({query:K=>({url:"/jobs",params:{allowWatchBookmarks:K.allowWatchBookmarks,continue:K.continue,fieldSelector:K.fieldSelector,labelSelector:K.labelSelector,limit:K.limit,pretty:K.pretty,resourceVersion:K.resourceVersion,resourceVersionMatch:K.resourceVersionMatch,sendInitialEvents:K.sendInitialEvents,timeoutSeconds:K.timeoutSeconds,watch:K.watch}}),providesTags:["Job"]}),getJob:V.query({query:K=>({url:`/jobs/${K.name}`,params:{pretty:K.pretty}}),providesTags:["Job"]}),listRepository:V.query({query:K=>({url:"/repositories",params:{pretty:K.pretty,allowWatchBookmarks:K.allowWatchBookmarks,continue:K.continue,fieldSelector:K.fieldSelector,labelSelector:K.labelSelector,limit:K.limit,resourceVersion:K.resourceVersion,resourceVersionMatch:K.resourceVersionMatch,sendInitialEvents:K.sendInitialEvents,timeoutSeconds:K.timeoutSeconds,watch:K.watch}}),providesTags:["Repository"]}),createRepository:V.mutation({query:K=>({url:"/repositories",method:"POST",body:K.repository,params:{pretty:K.pretty,dryRun:K.dryRun,fieldManager:K.fieldManager,fieldValidation:K.fieldValidation}}),invalidatesTags:["Repository"]}),deletecollectionRepository:V.mutation({query:K=>({url:"/repositories",method:"DELETE",params:{pretty:K.pretty,continue:K.continue,dryRun:K.dryRun,fieldSelector:K.fieldSelector,gracePeriodSeconds:K.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:K.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:K.labelSelector,limit:K.limit,orphanDependents:K.orphanDependents,propagationPolicy:K.propagationPolicy,resourceVersion:K.resourceVersion,resourceVersionMatch:K.resourceVersionMatch,sendInitialEvents:K.sendInitialEvents,timeoutSeconds:K.timeoutSeconds}}),invalidatesTags:["Repository"]}),getRepository:V.query({query:K=>({url:`/repositories/${K.name}`,params:{pretty:K.pretty}}),providesTags:["Repository"]}),replaceRepository:V.mutation({query:K=>({url:`/repositories/${K.name}`,method:"PUT",body:K.repository,params:{pretty:K.pretty,dryRun:K.dryRun,fieldManager:K.fieldManager,fieldValidation:K.fieldValidation}}),invalidatesTags:["Repository"]}),deleteRepository:V.mutation({query:K=>({url:`/repositories/${K.name}`,method:"DELETE",params:{pretty:K.pretty,dryRun:K.dryRun,gracePeriodSeconds:K.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:K.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:K.orphanDependents,propagationPolicy:K.propagationPolicy}}),invalidatesTags:["Repository"]}),getRepositoryFiles:V.query({query:K=>({url:`/repositories/${K.name}/files/`,params:{ref:K.ref}}),providesTags:["Repository"]}),getRepositoryFilesWithPath:V.query({query:K=>({url:`/repositories/${K.name}/files/${K.path}`,params:{ref:K.ref}}),providesTags:["Repository"]}),replaceRepositoryFilesWithPath:V.mutation({query:K=>({url:`/repositories/${K.name}/files/${K.path}`,method:"PUT",body:K.body,params:{ref:K.ref,message:K.message,skipDryRun:K.skipDryRun}}),invalidatesTags:["Repository"]}),createRepositoryFilesWithPath:V.mutation({query:K=>({url:`/repositories/${K.name}/files/${K.path}`,method:"POST",body:K.body,params:{ref:K.ref,message:K.message,skipDryRun:K.skipDryRun}}),invalidatesTags:["Repository"]}),deleteRepositoryFilesWithPath:V.mutation({query:K=>({url:`/repositories/${K.name}/files/${K.path}`,method:"DELETE",params:{ref:K.ref,message:K.message,skipDryRun:K.skipDryRun}}),invalidatesTags:["Repository"]}),getRepositoryHistory:V.query({query:K=>({url:`/repositories/${K.name}/history`,params:{ref:K.ref}}),providesTags:["Repository"]}),getRepositoryHistoryWithPath:V.query({query:K=>({url:`/repositories/${K.name}/history/${K.path}`,params:{ref:K.ref}}),providesTags:["Repository"]}),getRepositoryJobs:V.query({query:K=>({url:`/repositories/${K.name}/jobs`}),providesTags:["Repository"]}),createRepositoryJobs:V.mutation({query:K=>({url:`/repositories/${K.name}/jobs`,method:"POST",body:K.jobSpec}),invalidatesTags:["Repository"]}),getRepositoryJobsWithPath:V.query({query:K=>({url:`/repositories/${K.name}/jobs/${K.uid}`}),providesTags:["Repository"]}),getRepositoryRenderWithPath:V.query({query:K=>({url:`/repositories/${K.name}/render/${K.guid}`}),providesTags:["Repository"]}),getRepositoryResources:V.query({query:K=>({url:`/repositories/${K.name}/resources`}),providesTags:["Repository"]}),getRepositoryStatus:V.query({query:K=>({url:`/repositories/${K.name}/status`,params:{pretty:K.pretty}}),providesTags:["Repository"]}),replaceRepositoryStatus:V.mutation({query:K=>({url:`/repositories/${K.name}/status`,method:"PUT",body:K.repository,params:{pretty:K.pretty,dryRun:K.dryRun,fieldManager:K.fieldManager,fieldValidation:K.fieldValidation}}),invalidatesTags:["Repository"]}),createRepositoryTest:V.mutation({query:K=>({url:`/repositories/${K.name}/test`,method:"POST",body:K.body}),invalidatesTags:["Repository"]}),getRepositoryWebhook:V.query({query:K=>({url:`/repositories/${K.name}/webhook`}),providesTags:["Repository"]}),createRepositoryWebhook:V.mutation({query:K=>({url:`/repositories/${K.name}/webhook`,method:"POST"}),invalidatesTags:["Repository"]}),getFrontendSettings:V.query({query:()=>({url:"/settings"}),providesTags:["Provisioning","Repository"]}),getResourceStats:V.query({query:()=>({url:"/stats"}),providesTags:["Provisioning","Repository"]})}),overrideExisting:!1}),{useListJobQuery:p,useGetJobQuery:h,useListRepositoryQuery:r,useCreateRepositoryMutation:g,useDeletecollectionRepositoryMutation:y,useGetRepositoryQuery:v,useReplaceRepositoryMutation:x,useDeleteRepositoryMutation:f,useGetRepositoryFilesQuery:u,useGetRepositoryFilesWithPathQuery:b,useReplaceRepositoryFilesWithPathMutation:E,useCreateRepositoryFilesWithPathMutation:D,useDeleteRepositoryFilesWithPathMutation:C,useGetRepositoryHistoryQuery:P,useGetRepositoryHistoryWithPathQuery:T,useGetRepositoryJobsQuery:O,useCreateRepositoryJobsMutation:I,useGetRepositoryJobsWithPathQuery:j,useGetRepositoryRenderWithPathQuery:W,useGetRepositoryResourcesQuery:B,useGetRepositoryStatusQuery:S,useReplaceRepositoryStatusMutation:w,useCreateRepositoryTestMutation:N,useGetRepositoryWebhookQuery:M,useCreateRepositoryWebhookMutation:L,useGetFrontendSettingsQuery:A,useGetResourceStatsQuery:U}=m,F=m.enhanceEndpoints({endpoints:{listJob:{query:({watch:V,...K})=>({url:"/jobs",params:K}),onCacheEntryAdded:d("jobs")},listRepository:{query:({watch:V,...K})=>({url:"/repositories",params:K}),onCacheEntryAdded:d("repositories")},deleteRepository:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K,G((0,s.dx)((0,l.tZ)((0,n.t)("provisioning.delete-repository-button.success-repository-deleted","Repository settings queued for deletion"))))}catch(H){H instanceof Error&&G((0,s.dx)((0,l.gi)((0,n.t)("provisioning.delete-repository-button.error-repository-delete","Failed to delete repository"),H)))}}},deletecollectionRepository:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K,G((0,s.dx)((0,l.tZ)((0,n.t)("provisioning.home-page.success-all-repositories-deleted","All configured repositories deleted"))))}catch(H){H instanceof Error&&G((0,s.dx)((0,l.gi)((0,n.t)("provisioning.home-page.error-delete-all-repositories","Failed to delete all repositories"),H)))}}},createRepositoryTest:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K}catch(H){H?H instanceof Error?G((0,s.dx)((0,l.gi)("Error validating repository",H))):typeof H=="object"&&"error"in H&&(0,a.NF)(H.error)&&Array.isArray(H.error.data.errors)&&H.error.data.errors.length&&H.error.data.errors.filter(k=>!k.field).length>0&&G((0,s.dx)((0,l.gi)("Error validating repository"))):G((0,s.dx)((0,l.gi)("Error validating repository",new Error("Unknown error"))))}}},createRepositoryJobs:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K,G((0,s.dx)((0,l.tZ)((0,n.t)("provisioning.sync-repository.success-pull-started","Pull started"))))}catch(H){H instanceof Error&&G((0,s.dx)((0,l.gi)((0,n.t)("provisioning.sync-repository.error-pulling-resources","Error pulling resources"),H)))}}},createRepository:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K,G((0,s.dx)((0,l.tZ)((0,n.t)("provisioning.config-form.alert-repository-settings-saved","Repository settings saved"))))}catch(H){H instanceof Error&&G((0,s.dx)((0,l.gi)((0,n.t)("provisioning.config-form.error-save-repository","Failed to save repository settings"),H)))}}},replaceRepository:{onQueryStarted:async(V,{queryFulfilled:K,dispatch:G})=>{try{await K,G((0,s.dx)((0,l.tZ)((0,n.t)("provisioning.config-form.alert-repository-settings-updated","Repository settings updated"))))}catch(H){H instanceof Error&&G((0,s.dx)((0,l.gi)((0,n.t)("provisioning.config-form.error-save-repository","Failed to save repository settings"),H)))}}}}})},73892:(Z,R,e)=>{"use strict";e.d(R,{W:()=>s,s:()=>l});var n=e(75505),a=e(68143);function s({baseURL:o}){async function d(i){try{const{data:c,...m}=await(0,n.s)((0,a.AI)().fetch({...i,url:o+i.url,showErrorAlert:i.showErrorAlert??!1,data:i.body}));return{data:c,meta:m}}catch(c){return i.manageError?i.manageError(c):l(c)}}return d}function l(o){return(0,a.NF)(o)||o instanceof Error?{error:o}:{error:new Error("Unknown error")}}},85618:(Z,R,e)=>{"use strict";e.d(R,{Ge:()=>o,H4:()=>i,TP:()=>d});var n=e(43173),a=e(68143),s=e(6890),l=e(64762);const o=()=>n.$.namespace,d=(c,m)=>`/apis/${c}/${m}/namespaces/${o()}`,i=(c,m,p)=>{c?c instanceof Error?m((0,s.dx)((0,l.gi)(p,c))):typeof c=="object"&&"error"in c&&(c.error instanceof Error?m((0,s.dx)((0,l.gi)(p,c.error))):(0,a.NF)(c.error)&&Array.isArray(c.error.data.errors)&&c.error.data.errors.length&&m((0,s.dx)((0,l.gi)(p,c.error.data.errors.join(`
`))))):m((0,s.dx)((0,l.gi)(p,new Error("Unknown error"))))}},873:(Z,R,e)=>{"use strict";e.d(R,{A:()=>s});var n=e(2543),a=e.n(n);class s{constructor(i){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",i){if(i.columns)for(const c of i.columns)this.addColumn(c);if(i.rows)for(const c of i.rows)this.addRow(c)}}sort(i){i.col===null||i.col===void 0||this.columns.length<=i.col||(this.rows.sort((c,m)=>(c=c[i.col],m=m[i.col],+(c==null)-+(m==null)||+(c>m)||-(c<m))),i.desc&&this.rows.reverse(),this.columns[i.col].sort=!0,this.columns[i.col].desc=i.desc)}addColumn(i){this.columnMap[i.text]||(this.columns.push(i),this.columnMap[i.text]=i)}addRow(i){this.rows.push(i)}}function l(d,i,c){let m=!1;for(let p=0;p<d.length;p++)if(i[p]!==void 0&&c[p]!==void 0){if(i[p]!==c[p])return!1}else(i[p]===void 0||c[p]===void 0)&&(m=!0);return m}function o(d,...i){const c=d||new s;if(arguments.length===1)return c;if(arguments.length===2)return c.columns=i[0].hasOwnProperty("columns")?[...i[0].columns]:[],c.rows=i[0].hasOwnProperty("rows")?[...i[0].rows]:[],c;const m=i.filter(x=>!!x.columns),p={},h=m.slice().reduce((x,f)=>(f.columns.forEach(u=>{const{text:b}=u;p[b]===void 0&&(p[b]=x.length,x.push(u))}),x),[]),r=m.map(x=>x.columns.map(f=>p[f.text])),g=m.reduce((x,f,u)=>{const b=r[u];return f.rows.forEach(E=>{const D=[];b.forEach((C,P)=>{D[C]=E[P]}),x.push(D)}),x},[]),y={},v=g.reduce((x,f,u)=>{if(!y[u]){let b=u+1;for(;b<g.length;){const E=findIndex(g,D=>l(h,f,D),b);if(E>-1){const D=g[E];for(let C=0;C<h.length;C++)f[C]===void 0&&D[C]!==void 0&&(f[C]=D[C]);y[E]=D,b=E+1}else break}x.push(f)}return x},[]);return c.columns=h,c.rows=v,c}},20018:(Z,R,e)=>{"use strict";e.d(R,{N:()=>a});var n=e(65307);const a=(0,n.VP)("core/cleanUpState")},6890:(Z,R,e)=>{"use strict";e.d(R,{Do:()=>n.Do,Vz:()=>a.Vz,YA:()=>a.YA,dx:()=>n.dx});var n=e(12066),a=e(43550)},17159:(Z,R,e)=>{"use strict";e.d(R,{x:()=>U});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(92745),d=e(63142),i=e(31286),c=e(66404),m=e(45861),p=e(63722),h=e(83873),r=e(78059),g=e(90382),y=e(41654),v=e(18857),x=e(15840),f=e(76459),u=e.n(f),b=e(68143);class E extends l.Component{constructor(z){super(z),this.search=u()(async Y=>(this.setState({isLoading:!0}),(0,s.isNil)(Y)&&(Y=""),(0,b.AI)().get(`/api/serviceaccounts/search?query=${Y}&perpage=100`).then(X=>X.serviceAccounts.map(Q=>({id:Q.id,uid:Q.uid,value:Q,label:Q.login,imgUrl:Q.avatarUrl,login:Q.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:z,onSelected:Y,inputId:X}=this.props,{isLoading:Q}=this.state;return(0,n.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,n.jsx)(v.DW,{isClearable:!0,className:z,inputId:X,isLoading:Q,defaultOptions:!0,loadOptions:this.search,onChange:Y,placeholder:(0,o.t)("service-account-picker.select-placeholder","Start typing to search for service accounts"),noOptionsMessage:(0,o.t)("service-account-picker.noOptionsMessage-no-service-accounts-found","No service accounts found"),"aria-label":(0,o.t)("service-account-picker.select-aria-label","Service account picker")})})}}var D=e(81971);class C extends l.Component{constructor(z){super(z),this.search=u()(async Y=>(this.setState({isLoading:!0}),(0,s.isNil)(Y)&&(Y=""),(0,b.AI)().get(`/api/org/users/lookup?query=${Y}&limit=100`).then(X=>X.map(Q=>({id:Q.userId,uid:Q.uid,value:Q,label:Q.login,imgUrl:Q.avatarUrl,login:Q.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:z,onSelected:Y,inputId:X}=this.props,{isLoading:Q}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,n.jsx)(v.DW,{isClearable:!0,className:z,inputId:X,isLoading:Q,defaultOptions:!0,loadOptions:this.search,onChange:Y,placeholder:(0,o.t)("user-picker.select-placeholder","Start typing to search for user"),noOptionsMessage:(0,o.t)("user-picker.noOptionsMessage-no-users-found","No users found"),"aria-label":(0,o.t)("user-picker.select-aria-label","User picker")})})}}var P=(J=>(J.None="None",J.Team="Team",J.User="User",J.ServiceAccount="ServiceAccount",J.BuiltInRole="builtInRole",J))(P||{});const T=({title:J=(0,o.t)("access-control.add-permission.title","Add permission for"),permissions:z,assignments:Y,onAdd:X,onCancel:Q})=>{const[q,te]=(0,l.useState)(P.None),[ne,se]=(0,l.useState)(""),[ue,de]=(0,l.useState)(""),[ie,he]=(0,l.useState)(""),[me,ce]=(0,l.useState)(""),Pe=(0,l.useMemo)(()=>{const Se=[];return Y.users&&Se.push({value:P.User,label:(0,o.t)("access-control.add-permission.user-label","User")}),Y.serviceAccounts&&Se.push({value:P.ServiceAccount,label:(0,o.t)("access-control.add-permission.serviceaccount-label","Service Account")}),Y.teams&&Se.push({value:P.Team,label:(0,o.t)("access-control.add-permission.team-label","Team")}),Y.builtInRoles&&Se.push({value:P.BuiltInRole,label:(0,o.t)("access-control.add-permission.role-label","Role")}),Se},[Y]);(0,l.useEffect)(()=>{z.length>0&&ce(z[0])},[z]);const Ie=()=>q===P.Team&&ne||q===P.User&&ue||q===P.ServiceAccount&&ue||P.BuiltInRole&&g.X.hasOwnProperty(ie);return(0,n.jsxs)("div",{className:"cta-form","aria-label":(0,o.t)("access-control.add-permission.permissions-aria-label","Permissions slider"),children:[(0,n.jsx)(x.J,{onClick:Q}),(0,n.jsx)("h5",{children:J}),(0,n.jsx)("form",{name:"addPermission",onSubmit:Se=>{Se.preventDefault(),X({userUid:ue,teamUid:ne,builtInRole:ie,permission:me,target:q})},children:(0,n.jsxs)(y.B,{gap:1,direction:"row",children:[(0,n.jsx)(v.l6,{"aria-label":(0,o.t)("access-control.add-permission.role-select-aria-label","Role to add new permission to"),value:q,options:Pe,onChange:Se=>te(Se.value),disabled:Pe.length===0,width:"auto"}),q===P.User&&(0,n.jsx)(C,{onSelected:Se=>de(Se?.value?.uid||"")}),q===P.ServiceAccount&&(0,n.jsx)(E,{onSelected:Se=>de(Se?.value?.uid||"")}),q===P.Team&&(0,n.jsx)(D.e,{onSelected:Se=>se(Se.value?.uid||"")}),q===P.BuiltInRole&&(0,n.jsx)(v.l6,{"aria-label":(0,o.t)("access-control.add-permission.built-in-aria-label","Built-in role picker"),options:Object.values(g.X).filter(Se=>Se!==g.X.None).map(Se=>({value:Se,label:Se})),onChange:Se=>he(Se.value||""),width:"auto"}),(0,n.jsx)(v.l6,{"aria-label":(0,o.t)("access-control.add-permission.level-aria-label","Permission level"),width:"auto",value:z.find(Se=>Se===me),options:z.map(Se=>({label:Se,value:Se})),onChange:Se=>ce(Se.value||"")}),(0,n.jsx)(m.$n,{type:"submit",disabled:!Ie(),children:(0,n.jsx)(o.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var O=e(45967),I=e(30703);const j=({item:J,permissionLevels:z,canSet:Y,onRemove:X,onChange:Q})=>{const q=(0,d.of)(N);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:W(J)}),(0,n.jsx)("td",{children:S(J)}),(0,n.jsx)("td",{children:J.isInherited&&(0,n.jsx)("em",{className:q.inherited,children:(0,n.jsx)(o.x6,{i18nKey:"access-control.permission-list-item.inherited",children:"Inherited from folder"})})}),(0,n.jsx)("td",{children:(0,n.jsx)(v.l6,{disabled:!Y||!J.isManaged,onChange:te=>Q(J,te.value),value:z.find(te=>te===J.permission),options:z.map(te=>({value:te,label:te}))})}),(0,n.jsx)("td",{children:J.warning?(0,n.jsx)(O.m,{content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.a,{marginBottom:1,children:J.warning}),w(J)]}),children:(0,n.jsx)(I.I,{name:"exclamation-triangle",className:q.warning})}):(0,n.jsx)(O.m,{content:w(J),children:(0,n.jsx)(I.I,{name:"info-circle"})})}),(0,n.jsx)("td",{children:J.isManaged?(0,n.jsx)(m.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!Y,onClick:()=>X(J),"aria-label":(0,o.t)("access-control.permission-list-item.remove-aria-label","Remove permission for {{identifier}}",{identifier:B(J)})}):(0,n.jsx)(O.m,{content:J.isInherited?(0,o.t)("access-control.permission-list-item.tooltip-inherited-permission","Inherited permission"):(0,o.t)("access-control.permission-list-item.tooltip-provisioned-permission","Provisioned permission"),children:(0,n.jsx)(m.$n,{size:"sm",icon:"lock","aria-label":(0,o.t)("access-control.permission-list-item.locked-aria-label","Locked permission indicator")})})})]})},W=J=>J.teamId?(0,n.jsx)("img",{className:"filter-table__avatar",src:J.teamAvatarUrl,alt:`Avatar for team ${J.teamId}`}):J.userId?(0,n.jsx)("img",{className:"filter-table__avatar",src:J.userAvatarUrl,alt:`Avatar for user ${J.userId}`}):(0,n.jsx)(I.I,{size:"xl",name:"shield"}),B=J=>J.userId?J.userLogin:J.teamId?J.team:J.builtInRole,S=J=>J.userId?(0,n.jsxs)("span",{children:[J.userLogin," "]},"name"):J.teamId?(0,n.jsxs)("span",{children:[J.team," "]},"name"):J.builtInRole?(0,n.jsxs)("span",{children:[J.builtInRole," "]},"name"):(0,n.jsx)("span",{},"name"),w=J=>`Actions: ${[...new Set(J.actions)].sort().join(" ")}`,N=J=>({warning:(0,a.css)({color:J.colors.warning.main}),inherited:(0,a.css)({color:J.colors.text.secondary,flexWrap:"nowrap"})}),M=({title:J,items:z,compareKey:Y,permissionLevels:X,canSet:Q,onRemove:q,onChange:te})=>{const ne=(0,l.useMemo)(()=>{const se={};for(let ue of z){const de=ue[Y];if(!se[de]){se[de]=ue;continue}if(ue.actions.length>se[de].actions.length){se[de]=ue;continue}ue.actions.length===se[de].actions.length&&se[de].isManaged&&!ue.isManaged&&(se[de]=ue)}return Object.keys(se).map(ue=>se[ue])},[z,Y]);return ne.length===0?null:(0,n.jsx)("div",{children:(0,n.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{children:J}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%"},children:(0,n.jsx)(o.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)("tbody",{children:ne.map((se,ue)=>(0,n.jsx)(j,{item:se,onRemove:q,onChange:te,canSet:Q,permissionLevels:X},`${ue}-${se.userId}`))})]})})},L="",A={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},U=({title:J=(0,o.t)("access-control.permissions.title","Permissions"),buttonLabel:z=(0,o.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:Y=(0,o.t)("access-control.permissions.no-permissions","There are no permissions"),resource:X,resourceId:Q,canSetPermissions:q,addPermissionTitle:te,getWarnings:ne,epilogue:se})=>{const ue=(0,d.of)(k),[de,ie]=(0,l.useState)(!1),[he,me]=(0,l.useState)([]),[ce,Pe]=(0,l.useState)(A),Ie=(0,l.useCallback)(async()=>{let Ue=await V(X,Q);ne&&(Ue=ne(Ue)),me(Ue)},[X,Q,ne]);(0,l.useEffect)(()=>{F(X).then(Ue=>(Pe(Ue),Ie()))},[X,Q,Ie]);const Se=Ue=>{let Be=null;Ue.target===P.User||Ue.target===P.ServiceAccount?Be=K(X,Q,Ue.userUid,Ue.permission):Ue.target===P.Team?Be=G(X,Q,Ue.teamUid,Ue.permission):Ue.target===P.BuiltInRole&&(Be=H(X,Q,Ue.builtInRole,Ue.permission)),Be!==null&&Be.then(Ie)},Me=Ue=>{let Be=null;Ue.userUid?Be=K(X,Q,Ue.userUid,L):Ue.teamUid?Be=G(X,Q,Ue.teamUid,L):Ue.builtInRole&&(Be=H(X,Q,Ue.builtInRole,L)),Be!==null&&Be.then(Ie)},Te=(Ue,Be)=>{console.log("onChange",Ue,Be),Ue.permission!==Be&&(Ue.userUid||Ue.isServiceAccount?Se({permission:Be,userUid:Ue.userUid,target:P.User}):Ue.teamUid?Se({permission:Be,teamUid:Ue.teamUid,target:P.Team}):Ue.builtInRole&&Se({permission:Be,builtInRole:Ue.builtInRole,target:P.BuiltInRole}))},Ge=(0,l.useMemo)(()=>(0,s.sortBy)(he.filter(Ue=>Ue.teamId),["team","isManaged"]),[he]),Qe=(0,l.useMemo)(()=>(0,s.sortBy)(he.filter(Ue=>Ue.userId&&!Ue.isServiceAccount),["userLogin","isManaged"]),[he]),tt=(0,l.useMemo)(()=>(0,s.sortBy)(he.filter(Ue=>Ue.userId&&Ue.isServiceAccount),["userLogin","isManaged"]),[he]),ke=(0,l.useMemo)(()=>(0,s.sortBy)(he.filter(Ue=>Ue.builtInRole),["builtInRole","isManaged"]),[he]),He=(0,o.t)("access-control.permissions.role","Role"),Re=(0,o.t)("access-control.permissions.user","User"),Ne=(0,o.t)("access-control.permissions.serviceaccount","Service Account"),Ae=(0,o.t)("access-control.permissions.team","Team");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[q&&X==="folders"&&(0,n.jsxs)(i.a,{paddingBottom:2,children:[(0,n.jsx)(o.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,n.jsx)(r.x,{selectedItems:{folder:{[Q]:!0},dashboard:{},panel:{},$all:!1}})]}),he.length===0&&(0,n.jsx)(i.a,{children:(0,n.jsx)(c.E,{children:Y})}),(0,n.jsx)(M,{title:He,items:ke,compareKey:"builtInRole",permissionLevels:ce.permissions,onChange:Te,onRemove:Me,canSet:q}),(0,n.jsx)(M,{title:Re,items:Qe,compareKey:"userLogin",permissionLevels:ce.permissions,onChange:Te,onRemove:Me,canSet:q}),(0,n.jsx)(M,{title:Ne,items:tt,compareKey:"userLogin",permissionLevels:ce.permissions,onChange:Te,onRemove:Me,canSet:q}),(0,n.jsx)(M,{title:Ae,items:Ge,compareKey:"team",permissionLevels:ce.permissions,onChange:Te,onRemove:Me,canSet:q}),q&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.$n,{className:ue.addPermissionButton,variant:"primary",onClick:()=>ie(!0),icon:"plus",children:z},"add-permission"),(0,n.jsx)(p.a,{in:de,children:(0,n.jsx)(T,{title:te,onAdd:Se,permissions:ce.permissions,assignments:ce.assignments,onCancel:()=>ie(!1)})})]})]}),se&&se(he)]})},F=async J=>{try{return await(0,h.AI)().get(`/api/access-control/${J}/description`)}catch(z){return console.error("failed to load resource description: ",z),A}},V=(J,z)=>(0,h.AI)().get(`/api/access-control/${J}/${z}`),K=(J,z,Y,X)=>_(J,z,"users",Y,X),G=(J,z,Y,X)=>_(J,z,"teams",Y,X),H=(J,z,Y,X)=>_(J,z,"builtInRoles",Y,X),_=(J,z,Y,X,Q)=>(0,h.AI)().post(`/api/access-control/${J}/${z}/${Y}/${X}`,{permission:Q}),k=J=>({breakdown:(0,a.css)({...J.typography.bodySmall,color:J.colors.text.secondary,marginBottom:J.spacing(2)}),addPermissionButton:(0,a.css)({marginBottom:J.spacing(2)})})},63722:(Z,R,e)=>{"use strict";e.d(R,{a:()=>i});var n=e(74848),a=e(96540),s=e(22669);const l="200px",o=200,d={transition:`max-height ${o}ms ease-in-out`,overflow:"hidden"},i=({children:c,in:m,maxHeight:p=l,style:h=d})=>{const r=(0,a.useRef)(null),g={exited:{maxHeight:0},entering:{maxHeight:p},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,n.jsx)(s.Ay,{in:m,timeout:o,nodeRef:r,children:y=>(0,n.jsx)("div",{style:{...h,...g[y]},ref:r,children:c})})}},24596:(Z,R,e)=>{"use strict";e.d(R,{dk:()=>u,hE:()=>v,lU:()=>f});var n=e(24120),a=e(49426),s=e(75683),l=e(32899),o=e(92745),d=e(43173),i=e(27489),c=e(36490),m=e(45229),p=e(29043);function h(E,D){if(E===D)return!0;if(!(E instanceof Object)||!(D instanceof Object))return!1;const C=Object.keys(E),P=C.length;for(let T=0;T<P;T++)if(!(C[T]in D))return!1;for(let T=0;T<P;T++)if(E[C[T]]!==D[C[T]])return!1;return P===Object.keys(D).length}var r=e(6262),g=e(18607),y=e(48440);const v="grafana.navigation.docked",x="grafana.navigation.open",f="grafana.navigation.history";class u{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=d.$.theme2.breakpoints.values.xl&&p.A.getBool(v,window.innerWidth>=d.$.theme2.breakpoints.values.xl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new a.t({chromeless:!0,sectionNav:{node:{text:(0,o.t)("nav.home.title","Home")},main:{text:""}},megaMenuOpen:this.megaMenuDocked&&p.A.getBool(x,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:s.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=D=>{const C=this.state.getValue().returnToPrevious;(0,i.rR)("grafana_return_to_previous_button_created",{page:D.href,previousPage:C?.href}),this.update({returnToPrevious:D}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(D))},this.clearReturnToPrevious=D=>{const C=this.state.getValue().returnToPrevious;C&&(0,i.rR)("grafana_return_to_previous_button_dismissed",{action:D,page:C.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=D=>{const{megaMenuDocked:C}=this.state.getValue();C&&p.A.set(x,D),(0,i.rR)("grafana_mega_menu_open",{state:D}),this.update({megaMenuOpen:D})},this.setMegaMenuDocked=(D,C=!0)=>{C&&p.A.set(v,D),(0,i.rR)("grafana_mega_menu_docked",{state:D}),this.update({megaMenuDocked:D})},this.onToggleKioskMode=()=>{const D=this.getNextKioskMode();this.update({kioskMode:D}),c.Ny.partial({kiosk:this.getKioskUrlValue(D)}),(0,i.rR)("grafana_kiosk_mode",{action:"toggle",mode:D})}}setMatchedRoute(D){this.currentRoute!==D&&(this.currentRoute=D,this.routeChangeHandled=!1)}update(D){const C=this.state.getValue(),P={...C};this.routeChangeHandled||(P.actions=void 0,P.pageNav=void 0,P.sectionNav={node:{text:(0,o.t)("nav.home.title","Home")},main:{text:""}},P.chromeless=this.currentRoute?.chromeless,P.layout=s.k.Standard,this.routeChangeHandled=!0),Object.assign(P,D),P.chromeless=P.kioskMode===r.d9.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(P,C)||(d.$.featureToggles.unifiedHistory&&p.A.setObject(f,this.getUpdatedHistory(P)),this.state.next(P))}getUpdatedHistory(D){const C=(0,g.Z)(D.sectionNav.node,D.pageNav,{text:"Home",url:"/"},!0),P=D.pageNav||D.sectionNav.node;let T=p.A.getObject(f,[]);if(p.A.getObject("CLICKING_HISTORY"))return p.A.setObject("CLICKING_HISTORY",!1),T;if(!P)return T;const I=T[0],j={name:P.text,views:[],breadcrumbs:C,time:Date.now(),url:window.location.href};return I&&j.url.split("?")[0]===I.url.split("?")[0]?T[0]=j:(I&&I.name===j.name&&(0,y.kt)({entryName:j.name,lastEntryURL:I.url,newEntryURL:j.url}),T=[j,...T]),T}ignoreStateUpdate(D,C){return!!(h(D,C)||(D.sectionNav!==C.sectionNav||D.pageNav!==C.pageNav)&&D.actions===C.actions&&D.layout===C.layout&&b(D.sectionNav.node,C.sectionNav.node)&&b(D.pageNav,C.pageNav))}useState(){return(0,n.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),c.Ny.partial({kiosk:null}),(0,i.rR)("grafana_kiosk_mode",{action:"exit"})}setKioskModeFromUrl(D){let C;switch(D){case"1":case!0:C=r.d9.Full}C&&C!==this.state.getValue().kioskMode&&this.update({kioskMode:C})}getKioskUrlValue(D){switch(D){case r.d9.Full:return!0;default:return null}}getNextKioskMode(){return m.A.emit(l.r1.alertInfo,[(0,o.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),r.d9.Full}}function b(E,D){if(E===D)return!0;const C=E?.children?.find(T=>T.active),P=D?.children?.find(T=>T.active);return E?.text===D?.text&&E?.url===D?.url&&C?.url===P?.url&&b(E?.parentItem,D?.parentItem)}},43707:(Z,R,e)=>{"use strict";e.d(R,{H:()=>s});var n=e(96540),a=e(27963);const s=n.memo(({actions:l,breadcrumbActions:o})=>{const{chrome:d}=(0,a.Il)();return(0,n.useLayoutEffect)(()=>()=>{d.update({actions:void 0,breadcrumbActions:void 0})},[d]),(0,n.useLayoutEffect)(()=>{d.update({actions:l,breadcrumbActions:o})}),null});s.displayName="TopNavUpdate"},92270:(Z,R,e)=>{"use strict";e.d(R,{EE:()=>m,T0:()=>c,nf:()=>i,yq:()=>d});var n=e(74848),a=e(22803),s=e(33604),l=e(63142),o=e(58449);const d=300,i=100,c=Math.floor(window.innerWidth*(2/3));function m(){const h=p((0,l.$j)()),{dockedComponentId:r,isEnabled:g,props:y={}}=(0,o.sA)(),{components:v,isLoading:x}=(0,s.f)({extensionPointId:o.up});if(x||!r||!g)return null;const f=(0,o.rS)(r);if(!f)return null;const u=v.find(b=>b.meta.pluginId===f.pluginId&&b.meta.title===f.componentTitle);return u?(0,n.jsx)("div",{className:h.sidebarWrapper,children:(0,n.jsx)("div",{className:h.content,children:(0,n.jsx)(u,{...y})})}):null}const p=h=>({sidebarWrapper:(0,a.css)({backgroundColor:h.colors.background.primary,borderLeft:`1px solid ${h.colors.border.weak}`,display:"flex",flexDirection:"column",gap:h.spacing(1),padding:h.spacing(1),width:"100%",height:"100%",overflow:"auto"}),content:(0,a.css)({flex:1,minHeight:0})})},58449:(Z,R,e)=>{"use strict";e.d(R,{kn:()=>b,pF:()=>E,rS:()=>D,sA:()=>u,up:()=>g});var n=e(74848),a=e(96540),s=e(78685),l=e(78012),o=e(43173),d=e(36490),i=e(46907),c=e(75234),m=e(27489),p=e(3260),h=e(87745),r=e(92270);const g="grafana/extension-sidebar/v0-alpha",y="grafana.navigation.extensionSidebarDocked",v="grafana.navigation.extensionSidebarWidth",x=["grafana-investigations-app","grafana-assistant-app","grafana-dash-app","grafana-grafanadocsplugin-app"],f=(0,a.createContext)({isEnabled:!!o.$.featureToggles.extensionSidebar,isOpen:!1,dockedComponentId:void 0,setDockedComponentId:()=>{},availableComponents:new Map,extensionSidebarWidth:r.yq,setExtensionSidebarWidth:()=>{}});function u(){return(0,a.useContext)(f)}const b=({children:C})=>{const[P,T]=(0,a.useState)(void 0),O=l.M.get(y),[I,j]=(0,s.A)(v,r.yq),[W,B]=(0,a.useState)(d.Ny.getLocation().pathname);(0,a.useEffect)(()=>{const V=d.Ny.getLocationObservable().subscribe(K=>{B(K.pathname)});return()=>{V.unsubscribe()}},[]);const{links:S,isLoading:w}=(0,i.U)({extensionPointId:g,context:{path:W}}),N=!!o.$.featureToggles.extensionSidebar,M=(0,a.useMemo)(()=>N?new Map(Array.from((0,p.UX)(g).entries()).filter(([V,K])=>x.includes(V)&&S.some(G=>G.pluginId===V&&K.addedComponents.some(H=>H.title===G.title)))):new Map,[N,S]);let L;O&&D(O)&&(L=O);const[A,U]=(0,a.useState)(L);(0,a.useEffect)(()=>{if(!w&&A){const V=D(A);if(V){const K=M.get(V.pluginId);(!K||!K.addedComponents.some(G=>G.title===V.componentTitle))&&U(void 0)}else U(void 0)}},[w,M,A]);const F=(0,a.useCallback)((V,K)=>{T(K),U(V)},[U]);return(0,a.useEffect)(()=>{if(!N)return;const V=G=>{G.payload.pluginId&&G.payload.componentTitle&&x.includes(G.payload.pluginId)&&F(JSON.stringify({pluginId:G.payload.pluginId,componentTitle:G.payload.componentTitle}),G.payload.props)},K=(0,c.J7)().subscribe(h.Am,V);return()=>{K.unsubscribe()}},[N,F]),(0,a.useEffect)(()=>{if(w)return;const V=D(A??""),K=l.M.get(y),G=D(K??""),H=A!==void 0;(H||G)&&(0,m.rR)("grafana_extension_sidebar_changed",{opened:H,componentTitle:(H?V:G)?.componentTitle,pluginId:(H?V:G)?.pluginId,fromLocalstorage:K===A}),A?l.M.set(y,A):l.M.delete(y)},[A,w]),(0,n.jsx)(f.Provider,{value:{isEnabled:N,isOpen:N&&A!==void 0,dockedComponentId:A,setDockedComponentId:V=>F(V,void 0),availableComponents:M,extensionSidebarWidth:I??r.yq,setExtensionSidebarWidth:j,props:P},children:C})};function E(C,P){return JSON.stringify({pluginId:C,componentTitle:P.title})}function D(C){try{const P=JSON.parse(C);return typeof P=="object"&&P!==null&&"pluginId"in P&&"componentTitle"in P&&typeof P.pluginId=="string"&&typeof P.componentTitle=="string"?P:void 0}catch{return}}},48440:(Z,R,e)=>{"use strict";e.d(R,{KX:()=>c,Ni:()=>m,bL:()=>d,kt:()=>i});var n=e(27489);const a="grafana_unified_history_entry_clicked",s="grafana_unified_history_duplicated_entry_rendered",l="grafana_unified_history_drawer_interaction",o="grafana_unified_history_show_more",d=({entryURL:p,subEntry:h})=>{(0,n.rR)(a,{entryURL:p,subEntry:h})},i=({entryName:p,lastEntryURL:h,newEntryURL:r})=>{(0,n.rR)(s,{entryName:p,lastEntryURL:h,newEntryURL:r})},c=({type:p})=>{(0,n.rR)(l,{type:p})},m=()=>{(0,n.rR)(o)}},89409:(Z,R,e)=>{"use strict";e.d(R,{t3:()=>P,iL:()=>T,fn:()=>O});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(41654),d=e(7895),i=e(76319),c=e(27963),m=e(92948),p=e(96540),h=e(36490),r=e(35137),g=e(66404),y=e(15130),v=e(93922),x=e(52763),f=e(18857),u=e(30703);function b({orgs:j,onSelectChange:W}){const B=(0,l.of)(E),{orgId:S}=y.TP.user,w=(0,p.useMemo)(()=>j.map(U=>({label:U.name,description:U.role,value:U})),[j]),N=(0,p.useMemo)(()=>w.find(U=>U.value.orgId===S),[w,S]),[M,L]=(0,p.useState)(()=>N),A=U=>{L(U),W(U)};return(0,n.jsx)(f.l6,{"aria-label":(0,s.t)("navigation.org-switcher.aria-label","Change organization"),width:"auto",value:M,prefix:(0,n.jsx)(u.I,{className:"prefix-icon",name:"building"}),className:B.select,options:w,onChange:A})}const E=j=>({select:(0,a.css)({border:"none",background:"none",color:j.colors.text.secondary,"&:hover":{color:j.colors.text.primary,"& .prefix-icon":(0,a.css)({color:j.colors.text.primary})}})});function D(){const j=(0,x.wA)(),W=(0,x.d4)(S=>S.organization.userOrgs),B=S=>{S.value&&((0,v.bA)(S.value.orgId),h.Ny.push(`/?orgId=${S.value.orgId}`),window.location.reload())};return(0,p.useEffect)(()=>{y.TP.isSignedIn&&!(y.TP.user.authenticatedBy==="apikey"||y.TP.user.authenticatedBy==="render")&&j((0,v.wV)())},[j]),W?.length<=1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.$,{h:1}),(0,n.jsx)(g.E,{truncate:!0,children:m.M.AppTitle})]}):(0,n.jsx)(b,{orgs:W,onSelectChange:B})}var C=e(31937);const P="dock-menu-button",T="mega-menu-header-toggle";function O({handleMegaMenu:j,handleDockedMenu:W,onClose:B}){const S=(0,l.$j)(),{chrome:w}=(0,c.Il)(),N=w.useState(),M=I(S);return(0,n.jsxs)("div",{className:M.header,children:[(0,n.jsxs)(o.B,{alignItems:"center",minWidth:0,gap:.25,children:[(0,n.jsx)(d.I,{narrow:!0,id:T,onClick:j,tooltip:(0,s.t)("navigation.megamenu.close","Close menu"),children:(0,n.jsx)(m.M.MenuLogo,{className:M.img})}),(0,n.jsx)(D,{})]}),(0,n.jsx)(i.K,{id:P,className:M.dockMenuButton,tooltip:N.megaMenuDocked?(0,s.t)("navigation.megamenu.undock","Undock menu"):(0,s.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:W,variant:"secondary"}),(0,n.jsx)(i.K,{className:M.mobileCloseButton,tooltip:(0,s.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:B,size:"xl",variant:"secondary"})]})}O.displayName="MegaMenuHeader";const I=j=>({dockMenuButton:(0,a.css)({display:"none",[j.breakpoints.up("xl")]:{display:"inline-flex"}}),header:(0,a.css)({alignItems:"center",borderBottom:`1px solid ${j.colors.border.weak}`,display:"flex",gap:j.spacing(1),justifyContent:"space-between",padding:j.spacing(0,1,0,.75),height:(0,C.vn)(),flexShrink:0}),img:(0,a.css)({alignSelf:"center",height:j.spacing(3),width:j.spacing(3)}),mobileCloseButton:(0,a.css)({[j.breakpoints.up("md")]:{display:"none"}})})},5071:(Z,R,e)=>{"use strict";e.d(R,{s:()=>l});var n=e(96540),a=e(43173),s=e(1492);const l=()=>{const o=(0,s.Pj)(void 0,{skip:!a.$.bootData.user.isSignedIn}),d=(0,n.useMemo)(()=>o.data?.navbar?.bookmarkUrls||[],[o]);return a.$.featureToggles.pinNavItems?d:[]}},30362:(Z,R,e)=>{"use strict";e.d(R,{A6:()=>v,CS:()=>r,J0:()=>g,Wk:()=>f,m0:()=>y,n0:()=>u});var n=e(96540),a=e(92745),s=e(27489),l=e(43173),o=e(95943),d=e(43550),i=e(87745),c=e(45229),m=e(10388),p=e(47981),h=e(89409);const r=b=>{let E=b.children||[];if(b.id==="help"){const D=()=>{c.A.publish(new i.S8({component:p.N}))};b.children=[...E,...(0,m.Dd)(),...x(),{id:"keyboard-shortcuts",text:(0,a.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:D}]}return b},g=(b,E,D=!1)=>{const C={...b},P=C.onClick;let T;return C.isNew?T="item":D&&(T="ancestor"),C.onClick=()=>{(0,s.rR)("grafana_navigation_item_clicked",{path:C.url??C.id,menuIsDocked:E,itemIsBookmarked:!!(l.$.featureToggles.pinNavItems&&C?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!l.$.featureToggles.pinNavItems,isNew:T}),P?.()},C.children&&(C.children=C.children.map(O=>g(O,E,T!==void 0))),C},y=(b,E)=>!!b.children?.some(D=>D===E?!0:y(D,E)),v=(b,E,D)=>{const{id:C,parentItem:P}=E;if(D==="/")return b.find(O=>O.id===d.Id);if(E.id==="profile")return;for(const O of b){const I=!!(O.id&&O.id===C),j=O.text===E.text&&O.url===E.url;if(I||j)return O;if(O.children){const W=v(O.children,E);if(W)return W}}const T=b[0]?.parentItem?.id==="bookmarks";if(P&&!T)return v(b,P)};function x(){const{buildInfo:b,licenseInfo:E}=l.$,D=E.stateInfo?` (${E.stateInfo})`:"",C=[];return C.push({target:"_blank",id:"version",text:`${b.edition}${D}`,url:E.licenseUrl,icon:"external-link-alt"}),b.hasUpdate&&C.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),C}function f(b,E){for(const D of b){if(D.url===E)return D;if(D.children?.length){const C=f(D.children,E);if(C)return C}}return null}function u(b,E){(0,n.useEffect)(()=>{b?document.getElementById(h.iL)?.focus():document.getElementById(o.Ut)?.focus()},[b]),(0,n.useEffect)(()=>{E?document.getElementById(h.t3)?.focus():document.getElementById(o.Ut)?.focus()},[E])}},5423:(Z,R,e)=>{"use strict";e.d(R,{K:()=>l});var n=e(74848),a=e(22803),s=e(63142);function l({className:d,leftActionsSeparator:i}){const c=(0,s.of)(o);return i?(0,n.jsx)("div",{className:(0,a.cx)(d,c.leftActionsSeparator)}):(0,n.jsx)("div",{className:(0,a.cx)(d,c.line)})}const o=d=>({leftActionsSeparator:(0,a.css)({display:"flex",flexGrow:1}),line:(0,a.css)({width:1,backgroundColor:d.colors.border.medium,height:24,flexShrink:0,flexGrow:0,[d.breakpoints.down("sm")]:{display:"none"}})})},31937:(Z,R,e)=>{"use strict";e.d(R,{UH:()=>i,k9:()=>m,vn:()=>p});var n=e(96540),a=e(69896),s=e(43173),l=e(27963),o=e(51702),d=e(58449);function i(){const{chrome:h}=(0,l.Il)(),r=h.state.getValue(),g=(0,a.b)(),y=(0,o.i)("xl"),[v,x]=(0,n.useState)(c(r,g?.state.enabled,y));return(0,n.useEffect)(()=>{const f=h.state.subscribe(u=>{const b=c(u,g?.state.enabled,y);b!==v&&x(b)});return()=>f.unsubscribe()},[h,v,g,y]),v}function c(h,r=!1,g){return h.kioskMode||h.chromeless?0:r?2:h.actions?h.megaMenuDocked||!s.$.featureToggles.dashboardScene?2:g&&s.$.featureToggles.unifiedNavbars?1:2:1}function m(){const h=i(),{isOpen:r}=(0,d.sA)();return r?0:h*p()}function p(){return 40}},92948:(Z,R,e)=>{"use strict";e.d(R,{M:()=>r});var n=e(74848),a=e(22803),s=e(6773),l=e(63142),o=e(11701),d=e(53459),i=e(42581);const c=({className:g,logo:y})=>(0,n.jsx)("img",{className:g,src:`${y||i}`,alt:"Grafana"}),m=({className:g,children:y})=>{const v=(0,l.$j)(),x=(0,a.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(${v.isDark?o:d})`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[v.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,n.jsx)("div",{className:(0,a.cx)(x,g),children:y})},p=({className:g})=>(0,n.jsx)("img",{className:g,src:i,alt:"Grafana"}),h=()=>{const g=(0,l.$j)();return(0,a.css)({background:s.MV.alpha(g.colors.background.primary,.7),backgroundSize:"cover"})};class r{static{this.LoginLogo=c}static{this.LoginBackground=m}static{this.MenuLogo=p}static{this.LoginBoxBackground=h}static{this.AppTitle="Optimaxx"}static{this.LoginTitle="Welcome to Dashboard IIoT"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},22942:(Z,R,e)=>{"use strict";e.d(R,{q:()=>l});var n=e(74848),a=e(92745),s=e(39118);function l(){return(0,n.jsx)(s.I,{text:(0,a.t)("cloud-enterprise-feature-badge","Cloud & Enterprise")})}},39118:(Z,R,e)=>{"use strict";e.d(R,{I:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(30703);function o({text:i}){const c=(0,s.of)(d);return(0,n.jsxs)("div",{className:c.wrapper,children:[(0,n.jsx)(l.I,{name:"cloud",size:"sm"}),i]})}const d=i=>({wrapper:(0,a.css)({display:"inline-flex",padding:i.spacing(.5,1),borderRadius:i.shape.radius.pill,background:i.colors.gradients.brandHorizontal,color:i.colors.primary.contrastText,fontWeight:i.typography.fontWeightMedium,gap:i.spacing(.5),fontSize:i.typography.bodySmall.fontSize,lineHeight:i.typography.bodySmall.lineHeight,alignItems:"center"})})},18607:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>n});function n(a,s,l,o){const d=[];let i=!1,c;function m(p,h=!1){if(i)return;const r=p.url?.split("?")??["",""];let g=r[0];const y=new URLSearchParams(r[1]);if(y.has("editview")&&(g+=`?editview=${y.get("editview")}`),l&&g===l.url){o||d.unshift({text:l.text,href:p.url??""}),i=!0;return}const v=g.length>0&&c===g;if(c=g,!p.hideFromBreadcrumbs&&!(h&&v)){const f=p.children?.findIndex(u=>u.active)??-1;if(f>0){const u=p.children?.[f];u&&d.unshift({text:u.text,href:u.url??""})}d.unshift({text:p.text,href:p.url??""})}p.parentItem&&m(p.parentItem)}return s&&m(s),m(a,!0),d}},15840:(Z,R,e)=>{"use strict";e.d(R,{J:()=>d});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(76319);const d=({onClick:c,"aria-label":m,style:p})=>{const h=(0,l.of)(i);return(0,n.jsx)(o.K,{"aria-label":m??"Close",className:h,name:"times",onClick:c,style:p,tooltip:(0,s.t)("close-button.tooltip","Close")})},i=c=>(0,a.css)({position:"absolute",right:c.spacing(.5),top:c.spacing(1)})},10388:(Z,R,e)=>{"use strict";e.d(R,{DH:()=>h,Dd:()=>c,wi:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(43173),d=e(63142),i=e(30703);let c=()=>[{target:"_blank",id:"documentation",text:(0,l.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,l.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,l.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function m(v){return{hasReleaseNotes:!0,isBeta:v.includes("-beta")}}function p(v){const{buildInfo:x,licenseInfo:f}=o.$,u=[],b=f.stateInfo?` (${f.stateInfo})`:"";if(v||u.push({target:"_blank",id:"license",text:`${x.edition}${b}`,url:f.licenseUrl}),x.hideVersion)return u;const{hasReleaseNotes:E}=m(x.version);return u.push({target:"_blank",id:"version",text:x.versionString,url:E?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),x.hasUpdate&&u.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),u}function h(v){c=v}const r=(0,s.memo)(({customLinks:v,hideEdition:x})=>{const f=(v||c()).concat(p(x)),u=(0,d.of)(y);return(0,n.jsx)("footer",{className:u.footer,children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("ul",{className:u.list,children:f.map((b,E)=>(0,n.jsx)("li",{className:u.listItem,children:(0,n.jsx)(g,{item:b})},E))})})})});r.displayName="Footer";function g({item:v}){const x=v.url?(0,n.jsx)("a",{href:v.url,target:v.target,rel:"noopener noreferrer",id:v.id,children:v.text}):v.text;return(0,n.jsxs)(n.Fragment,{children:[v.icon&&(0,n.jsx)(i.I,{name:v.icon})," ",x]})}const y=v=>({footer:(0,a.css)({...v.typography.bodySmall,color:v.colors.text.primary,display:"block",padding:v.spacing(2,0),position:"relative",width:"98%","a:hover":{color:v.colors.text.maxContrast,textDecoration:"underline"},[v.breakpoints.down("md")]:{display:"none"}}),list:(0,a.css)({listStyle:"none"}),listItem:(0,a.css)({display:"inline-block","&:after":{content:"' | '",padding:v.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},83813:(Z,R,e)=>{"use strict";e.d(R,{F:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(54148),o=e(92745),d=e(22787),i=e(45861),c=e(83560);const m=({confirmRedirect:h,onDiscard:r,onLocationChange:g})=>{const[y,v]=(0,s.useState)(!1),[x,f]=(0,s.useState)(null),[u,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const P=T=>{h&&(T.preventDefault(),T.returnValue="")};return window.addEventListener("beforeunload",P),()=>{window.removeEventListener("beforeunload",P)}},[h]);const E=P=>{const T=window.location.pathname,O=P.pathname;if(T===O)return!0;const I=g?.(P);let j=h&&!u;return I!==void 0&&(j=j&&I),j?(v(!0),f(P),!1):(I&&r(),!0)},D=()=>{v(!1),f(null)},C=()=>{v(!1),b(!0),r()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.X,{when:!0,message:E}),x&&u&&(0,n.jsx)(l.C5,{replace:!0,to:x}),(0,n.jsx)(p,{isOpen:y,onDiscard:C,onBackToForm:D})]})},p=({onDiscard:h,onBackToForm:r,isOpen:g})=>(0,n.jsxs)(d.a,{isOpen:g,title:(0,o.t)("form-prompt.title","Leave page?"),onDismiss:r,icon:"exclamation-triangle",className:(0,a.css)({width:"500px"}),children:[(0,n.jsx)("h5",{children:(0,n.jsx)(o.x6,{i18nKey:"form-prompt.description",children:"Changes that you made may not be saved."})}),(0,n.jsxs)(d.a.ButtonRow,{children:[(0,n.jsx)(i.$n,{variant:"secondary",onClick:r,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"form-prompt.continue-button",children:"Continue editing"})}),(0,n.jsx)(i.$n,{variant:"destructive",onClick:h,children:(0,n.jsx)(o.x6,{i18nKey:"form-prompt.discard-button",children:"Discard unsaved changes"})})]})]})},83560:(Z,R,e)=>{"use strict";e.d(R,{X:()=>s});var n=e(96540),a=e(36490);const s=({message:l,when:o=!0})=>{const d=a.Ny.getHistory();return(0,n.useEffect)(()=>{if(!o)return;const i=d.block(l);return()=>{i()}},[o,l,d]),null}},90666:(Z,R,e)=>{"use strict";e.d(R,{T:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(43990);function o({children:i,spacing:c,level:m}){const p=(0,s.of)(d,c,m);return(0,n.jsx)("span",{className:(0,a.css)(p.indentor),children:i})}const d=(i,c,m)=>({indentor:(0,a.css)((0,l.Y)(i,c,p=>({paddingLeft:i.spacing(p*m)})))})},36321:(Z,R,e)=>{"use strict";e.d(R,{b:()=>l});var n=e(74848),a=e(96540),s=e(29043);const l=o=>{const{children:d,storageKey:i,defaultValue:c}=o,[m,p]=(0,a.useState)({value:s.A.getObject(o.storageKey,o.defaultValue)});(0,a.useEffect)(()=>{const g=y=>{y.key===i&&p({value:s.A.getObject(o.storageKey,o.defaultValue)})};return window.addEventListener("storage",g),()=>{window.removeEventListener("storage",g)}});const h=g=>{try{s.A.setObject(i,g)}catch(y){console.error(y)}p({value:g})},r=()=>{try{s.A.delete(i)}catch(g){console.log(g)}p({value:c})};return(0,n.jsx)(n.Fragment,{children:d(m.value,h,r)})}},94076:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a,X:()=>s});var n=e(96540);function a({children:l,onSetScrollRef:o,divId:d}){const i=(0,n.useRef)(null);return(0,n.useEffect)(()=>{o&&o(new s(document.documentElement))},[i,o]),l}class s{constructor(o){this.element=o}get scrollTop(){return this.element.scrollTop}scrollTo(o,d,i=0){if(!(this.element.scrollHeight-this.element.clientHeight-d>=0)&&i<10){requestAnimationFrame(()=>this.scrollTo(o,d,i+1));return}this.element.scrollTo(o,d)}}},21234:(Z,R,e)=>{"use strict";e.d(R,{I:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(8073);function o({description:i,text:c,url:m}){const p=(0,s.of)(d);return(0,n.jsxs)(l.Z,{className:p.card,href:m,children:[(0,n.jsx)(l.Z.Heading,{children:c}),(0,n.jsx)(l.Z.Description,{className:p.description,children:i})]})}const d=i=>({card:(0,a.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,a.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})})},82151:(Z,R,e)=>{"use strict";e.d(R,{b:()=>o});var n=e(74848),a=e(92745),s=e(99887),l=e(27321);function o({folder:d}){const i=(0,l.F)();return!d||"parentUID"in d&&d.parentUID||!d.managedBy||i?null:(0,n.jsx)(s.E,{text:(0,a.t)("folder-repo.badge-text","Provisioned"),color:"darkgrey"})}},3208:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{NestedFolderPicker:()=>Pe});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(10378),i=e(76459),c=e.n(i),m=e(96540),p=e(92745),h=e(43173),r=e(63142),g=e(41654),y=e(66404),v=e(63527),x=e(30703),f=e(34999),u=e(47327),b=e(18346),E=e(55860),D=e(93854),C=e(70590),P=e(82151),T=e(70255),O=e(97222),I=e(10022),j=e(76319),W=e(90666),B=e(80231),S=e(52763);const w=40,N="md",M=(Se,Me)=>`${Se}-${Me||"root"}`;function L({items:Se,focusedItemIndex:Me,foldersAreOpenable:Te,idPrefix:Ge,selectedFolder:Qe,onFolderExpand:tt,onFolderSelect:ke,isItemLoaded:He,requestLoadMore:Re}){const Ne=(0,m.useRef)(null),Ae=(0,r.of)(F),Ue=(0,m.useMemo)(()=>({items:Se,focusedItemIndex:Me,foldersAreOpenable:Te,selectedFolder:Qe,onFolderExpand:tt,onFolderSelect:ke,idPrefix:Ge}),[Se,Me,Te,Qe,tt,ke,Ge]),Be=(0,m.useCallback)(_e=>He(_e),[He]),We=(0,m.useCallback)((_e,Xe)=>{const{parentUID:le}=Se[_e];Re(le)},[Re,Se]);return(0,n.jsx)("div",{className:Ae.table,role:"tree",children:Se.length>0?(0,n.jsx)(I.A,{ref:Ne,itemCount:Se.length,isItemLoaded:Be,loadMoreItems:We,children:({onItemsRendered:_e,ref:Xe})=>(0,n.jsx)(O.Y1,{ref:Xe,height:w*Math.min(6.5,Se.length),width:"100%",itemData:Ue,itemSize:w,itemCount:Se.length,onItemsRendered:_e,children:U})}):(0,n.jsx)("div",{className:Ae.emptyMessage,children:(0,n.jsx)(p.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const A=[100,200,130,160,150];function U({index:Se,style:Me,data:Te}){const{items:Ge,focusedItemIndex:Qe,foldersAreOpenable:tt,selectedFolder:ke,onFolderExpand:He,onFolderSelect:Re,idPrefix:Ne}=Te,{item:Ae,isOpen:Ue,level:Be,parentUID:We}=Ge[Se],_e=(0,m.useRef)(null),Xe=(0,m.useId)(),le=(0,S.d4)(B.ku),ye=(0,S.d4)(B.Am),pe=(Ae.uid?ye[Ae.uid]:le)?.items??[];let ve=[];Ae.uid&&(ve=(We?ye[We]:le)?.items??[]);const be=(0,r.of)(F),Oe=(0,m.useCallback)(ze=>{ze.preventDefault(),ze.stopPropagation(),Ae.uid&&He(Ae.uid,!Ue)},[Ae.uid,Ue,He]),we=(0,m.useCallback)(()=>{Ae.kind==="folder"&&Re(Ae)},[Ae,Re]);if(Ae.kind==="ui"&&Ae.uiKind==="pagination-placeholder")return(0,n.jsxs)("span",{style:Me,className:be.row,children:[(0,n.jsx)(W.T,{level:Be,spacing:2}),(0,n.jsx)(T.A,{width:A[Se%A.length]})]});if(Ae.kind!=="folder"){const ze=Ae.kind,Ve=Ae.uid;return null}return(0,n.jsx)("div",{ref:_e,style:Me,className:(0,a.cx)(be.row,{[be.rowFocused]:Se===Qe,[be.rowSelected]:Ae.uid===ke}),tabIndex:-1,onClick:we,"aria-expanded":Ue,"aria-selected":Ae.uid===ke,"aria-labelledby":Xe,"aria-level":Be+1,role:"treeitem","aria-owns":pe.length>0?pe.map(ze=>M(Ne,ze.uid)).join(" "):void 0,"aria-setsize":pe.length,"aria-posinset":ve.findIndex(ze=>ze.uid===Ae.uid)+1,id:M(Ne,Ae.uid),children:(0,n.jsxs)("div",{className:be.rowBody,children:[(0,n.jsx)(W.T,{level:Be,spacing:2}),tt?(0,n.jsx)(j.K,{size:N,onMouseDown:Oe,tabIndex:-1,"aria-label":Ue?`Collapse folder ${Ae.title}`:`Expand folder ${Ae.title}`,name:Ue?"angle-down":"angle-right"}):(0,n.jsx)("span",{className:be.folderButtonSpacer}),(0,n.jsxs)("label",{className:be.label,id:Xe,children:[(0,n.jsx)(y.E,{truncate:!0,children:Ae.title}),(0,n.jsx)(P.b,{folder:Ae})]})]})})}const F=Se=>{const Me=(0,a.css)({height:w,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:Se.spacing(.5),overflow:"hidden",padding:Se.spacing(0,1)});return{table:(0,a.css)({background:Se.components.input.background}),emptyMessage:(0,a.css)({padding:Se.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,a.css)({paddingLeft:Se.spacing(.5)}),row:(0,a.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${Se.colors.border.weak}`}}),rowFocused:(0,a.css)({backgroundColor:Se.colors.background.secondary}),rowSelected:(0,a.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:Se.shape.radius.default,backgroundImage:Se.colors.gradients.brandVertical}}),rowBody:Me,label:(0,a.css)({display:"flex",alignItems:"center",gap:Se.spacing(1),lineHeight:w+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var V=e(35484),K=e(35222);function G({handleClearSelection:Se,isLoading:Me,invalid:Te,label:Ge,...Qe},tt){const ke=(0,r.$j)(),He=_(ke,Te),Re=Ne=>{(Ne.key==="Enter"||Ne.key===" ")&&Se?.(Ne)};return Me?(0,n.jsx)(K.A,{}):(0,n.jsx)("div",{className:He.wrapper,children:(0,n.jsxs)("div",{className:He.inputWrapper,children:[Ge?(0,n.jsx)("div",{className:He.prefix,children:(0,n.jsx)(x.I,{name:"folder"})}):void 0,(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(He.fakeInput,Ge?He.hasPrefix:void 0),...Qe,ref:tt,children:[Ge?(0,n.jsx)(y.E,{truncate:!0,children:Ge}):(0,n.jsx)(y.E,{truncate:!0,color:"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!Me&&Se&&(0,n.jsx)(x.I,{role:"button",tabIndex:0,"aria-label":(0,p.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:He.clearIcon,name:"times",onClick:Se,onKeyDown:Re})]}),(0,n.jsx)("div",{className:He.suffix,children:(0,n.jsx)(x.I,{name:"angle-down"})})]})})}const H=(0,m.forwardRef)(G),_=(Se,Me=!1)=>{const Te=(0,v.n)({theme:Se,invalid:Me});return{wrapper:Te.wrapper,inputWrapper:Te.inputWrapper,prefix:(0,a.css)([Te.prefix,{pointerEvents:"none",color:Se.colors.text.primary}]),suffix:(0,a.css)([Te.suffix,{pointerEvents:"none"}]),fakeInput:(0,a.css)([Te.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,V.getFocusStyles)(Se),alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,a.css)({paddingLeft:28}),clearIcon:(0,a.css)({color:Se.colors.text.secondary,cursor:"pointer","&:hover":{color:Se.colors.text.primary},"&:focus:not(:focus-visible)":(0,V.getMouseFocusStyles)(Se),"&:focus-visible":(0,V.getFocusStyles)(Se)})}};var k=e(25508),J=e(87161),z=e(75735),Y=e(27044),X=e(78034);const Q={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}},q="general",te=new Intl.Collator;function ne(Se,Me){const Te=(0,S.wA)(),Ge=(0,m.useRef)([]),[Qe,tt]=(0,m.useState)([]),ke=(0,m.useMemo)(()=>(0,k.Mz)(Qe,(...Ae)=>{let Ue=!1;const Be={};for(const We of Ae){We.status===d.RE.pending&&(Ue=!0);const _e=We.originalArgs?.name;_e&&(Be[_e]=We)}return{isLoading:Ue,responseByParent:Be}}),[Qe]),He=(0,S.d4)(ke),Re=(0,m.useCallback)(Ae=>{const Ue=Ae??q;if(He.responseByParent[Ue]?.status===d.RE.pending)return;const _e={name:Ue},Xe=Te(J.Z.endpoints.getFolderChildren.initiate(_e)),le=J.Z.endpoints.getFolderChildren.select(_e);tt(ye=>ye.concat(le)),Ge.current=Ge.current.concat([Xe])},[He,Te]);return(0,m.useEffect)(()=>()=>{for(const Ae of Ge.current)Ae.unsubscribe()},[]),{items:(0,m.useMemo)(()=>{if(!Se)return[];function Ae(Be,We,_e){let Xe=We?.data?.items?[...We.data.items]:[];Xe.sort((ye,pe)=>te.compare(ye.spec.title,pe.spec.title));const le=Xe.flatMap(ye=>{const pe=ye.metadata.name,ve=Me[pe],be={isOpen:!!ve,level:_e,item:{kind:"folder",title:ye.spec.title,uid:pe,managedBy:ye.metadata?.annotations?.[z.LH]}},Oe=ve&&He.responseByParent[pe];if(Oe){const we=Ae(pe,Oe,_e+1);return[be,...we]}return be});return We||le.push(...(0,X.T)(Y.md,Be,_e)),le}const Ue=Ae(q,He.responseByParent[q],1);return Ue.unshift(Q),Ue},[He,Se,Me]),isLoading:He.isLoading,requestNextPage:Re}}const se="pending";function ue(Se){const Me=Se.at(-1),Te=Me?.originalArgs?.page,Ge=Me?.status===se;return Me?.data?[Me.data.length<Me.originalArgs.limit,Te,Ge]:[!1,Te,Ge]}function de(Se,Me,Te){const Ge=(0,S.wA)(),Qe=(0,m.useRef)([]),[tt,ke]=(0,m.useState)([]),He=(0,m.useMemo)(()=>(0,k.Mz)(tt,(...Ue)=>{let Be=!1;const We=[],_e={};for(const Xe of Ue){Xe.status===se&&(Be=!0);const le=Xe.originalArgs?.parentUid;le?(_e[le]||(_e[le]=[]),_e[le].push(Xe)):We.push(Xe)}return{isLoading:Be,rootPages:We,pagesByParent:_e}}),[tt]),Re=(0,S.d4)(He),Ne=(0,m.useCallback)(Ue=>{const Be=Ue?Re.pagesByParent[Ue]:Re.rootPages,[We,_e,Xe]=ue(Be??[]);if(We||Xe)return;const le={parentUid:Ue,page:(_e??0)+1,limit:Y.md,permission:Te},ye=Ge(b.cU.endpoints.listFolders.initiate(le)),pe=b.cU.endpoints.listFolders.select({parentUid:ye.arg.parentUid,page:ye.arg.page,limit:ye.arg.limit,permission:ye.arg.permission});ke(ve=>ve.concat(pe)),Qe.current=Qe.current.concat([ye])},[Re,Ge,Te]);return(0,m.useEffect)(()=>()=>{for(const Ue of Qe.current)Ue.unsubscribe()},[]),{items:(0,m.useMemo)(()=>{if(!Se)return[];function Ue(We,_e,Xe){const le=_e.flatMap(pe=>(pe.data??[]).flatMap(be=>{const Oe=Me[be.uid],we={isOpen:!!Oe,level:Xe,item:{kind:"folder",title:be.title,uid:be.uid,managedBy:be.managedBy}},ze=Oe&&Re.pagesByParent[be.uid];if(ze){const Ve=Ue(be.uid,ze,Xe+1);return[we,...Ve]}return we})),[ye]=ue(_e);return ye||le.push(...(0,X.T)(Y.md,We,Xe)),le}const Be=Ue(void 0,Re.rootPages,1);return Be.unshift(Q),Be},[Re,Se,Me]),isLoading:Re.isLoading,requestNextPage:Ne}}function ie(Se,Me,Te){const Ge=de(Se,Me,Te),Qe=ne(Se,Me);return h.$.featureToggles.foldersAppPlatformAPI?Qe:Ge}function he({tree:Se,handleCloseOverlay:Me,handleFolderSelect:Te,handleFolderExpand:Ge,idPrefix:Qe,search:tt,visible:ke}){const[He,Re]=(0,m.useState)(-1),Ne=!!h.$.featureToggles.nestedFolders;(0,m.useEffect)(()=>{ke&&Re(-1)},[ke]),(0,m.useEffect)(()=>{Re(0)},[tt]),(0,m.useEffect)(()=>{document.getElementById(M(Qe,Se[He]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[He,Qe,Se]);const Ae=(0,m.useCallback)(Ue=>{const Be=Ne&&!tt;switch(Ue.key){case"ArrowRight":case"ArrowLeft":Be&&(Ue.preventDefault(),Ge(Se[He].item.uid,Ue.key==="ArrowRight"));break;case"ArrowUp":He>0&&(Ue.preventDefault(),Re(He-1));break;case"ArrowDown":He<Se.length-1&&(Ue.preventDefault(),Re(He+1));break;case"Enter":Ue.preventDefault();const We=Se[He].item;We.kind==="folder"&&Te(We);break;case"Tab":Ue.stopPropagation(),Me();break;case"Escape":Ue.stopPropagation(),Ue.preventDefault(),Me();break}},[He,Me,Ge,Te,Ne,tt,Se]);return{focusedItemIndex:He,handleKeyDown:Ae}}const me=c()(ce,300);async function ce(Se,Me){const Te=await(0,E.S)().search({query:Se,kind:["folder"],limit:100,permission:Me}),Ge=Te.view.map(Qe=>(0,D.hI)(Qe,Te.view));return{...Te,items:Ge}}function Pe({value:Se,invalid:Me,showRootFolder:Te=!0,clearable:Ge=!1,excludeUIDs:Qe,permission:tt="edit",onChange:ke}){const He=(0,r.of)(Ie),Re=(0,b.kH)(Se||d.hT),Ne=!!h.$.featureToggles.nestedFolders,[Ae,Ue]=(0,m.useState)(""),[Be,We]=(0,m.useState)(null),[_e,Xe]=(0,m.useState)(!1),[le,ye]=(0,m.useState)(!1),[pe,ve]=(0,m.useState)(!1),[be,Oe]=(0,m.useState)({}),we=(0,m.useId)(),[ze]=(0,m.useState)(void 0),Ve=(0,m.useRef)(0),ge=(0,m.useMemo)(()=>{if(tt==="view")return C.RG.View;if(tt==="edit")return C.RG.Edit;throw new Error("Invalid permission")},[tt]),Ke=!!(pe&&!(Ae&&Be)),{items:qe,isLoading:ot,requestNextPage:lt}=ie(Ke,be,ge);(0,m.useEffect)(()=>{if(!Ae){We(null);return}const Xt=Date.now();Xe(!0),me(Ae,ge).then(on=>{if(Xt>Ve.current){const pn=on.view.map(Un=>(0,D.hI)(Un,on.view));We({...on,items:pn}),Xe(!1),Ve.current=Xt}})},[Ae,ge]);const mt=[(0,s.UU)({crossAxis:!1,boundary:document.body})],{context:Lt,refs:Tt,floatingStyles:It,elements:Mt}=(0,l.we)({open:pe,placement:"bottom",onOpenChange:Xt=>{Xt&&(Ue(""),ye(!0)),ve(Xt)},middleware:mt,whileElementsMounted:o.ll}),Ut=(0,l.kp)(Lt),an=(0,l.s9)(Lt),{getReferenceProps:cn,getFloatingProps:un}=(0,l.bv)([an,Ut]),On=(0,m.useCallback)(async(Xt,on)=>{Oe(pn=>({...pn,[Xt]:on})),on&&!be[Xt]&&lt(Xt)},[lt,be]),yn=(0,m.useCallback)(Xt=>{ke&&ke(Xt.uid,Xt.title),ve(!1)},[ke]),En=(0,m.useCallback)(Xt=>{Xt.preventDefault(),Xt.stopPropagation(),ke&&ke(void 0,void 0)},[ke]),Bn=(0,m.useCallback)(()=>ve(!1),[ve]),fa=(0,m.useCallback)(Xt=>{Ae||lt(Xt)},[Ae,lt]),Fn=(0,m.useMemo)(()=>{let Xt=[];return Ke?Xt=qe:Xt=Be?.items.map(on=>({isOpen:!1,level:0,item:{kind:"folder",title:on.title,uid:on.uid}}))??[],(!Te||Qe?.length)&&(Xt=Xt.filter(on=>!(!Te&&on===Q||Qe?.includes(on.item.uid)))),Xt},[qe,Qe,Ke,Be?.items,Te]),Ea=(0,m.useCallback)(Xt=>{const on=Fn[Xt];if(!on)return!1;const pn=on.item;return!(pn.kind==="ui"&&pn.uiKind==="pagination-placeholder")},[Fn]),gt=ot||_e,{focusedItemIndex:Ht,handleKeyDown:wt}=he({tree:Fn,handleCloseOverlay:Bn,handleFolderSelect:yn,handleFolderExpand:On,idPrefix:we,search:Ae,visible:pe});let Yt=Re.data?.title;Se===""&&(Yt="Dashboards");const rn=Yt?(0,n.jsxs)(g.B,{alignItems:"center",children:[(0,n.jsx)(y.E,{truncate:!0,children:Yt}),(0,n.jsx)(P.b,{folder:Re.data})]}):"";return pe?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.p,{ref:Tt.setReference,autoFocus:!0,prefix:Yt?(0,n.jsx)(x.I,{name:"folder"}):null,placeholder:Yt??(0,p.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Ae,invalid:Me,className:He.search,onChange:Xt=>Ue(Xt.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":we,"aria-owns":we,"aria-activedescendant":M(we,Fn[Ht]?.item.uid),role:"combobox",suffix:(0,n.jsx)(x.I,{name:"search"}),...cn(),onKeyDown:wt}),(0,n.jsx)("fieldset",{ref:Tt.setFloating,id:we,className:He.tableWrapper,style:{...It,width:Mt.domReference?.clientWidth},...un(),children:ze?(0,n.jsx)(f.F,{className:He.error,severity:"warning",title:(0,p.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:ze.message||ze.toString?.()||(0,p.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,n.jsxs)("div",{children:[gt&&(0,n.jsx)("div",{className:He.loader,children:(0,n.jsx)(u.G,{width:600})}),(0,n.jsx)(L,{items:Fn,selectedFolder:Se,focusedItemIndex:Ht,onFolderExpand:On,onFolderSelect:yn,idPrefix:we,foldersAreOpenable:Ne&&!(Ae&&Be),isItemLoaded:Ea,requestLoadMore:fa})]})})]}):(0,n.jsx)(H,{label:rn,handleClearSelection:Ge&&Se!==void 0?En:void 0,invalid:Me,isLoading:Re.isLoading,autoFocus:le,ref:Tt.setReference,"aria-label":Yt?(0,p.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Yt}):void 0,...cn()})}const Ie=Se=>({button:(0,a.css)({maxWidth:"100%"}),error:(0,a.css)({marginBottom:0}),tableWrapper:(0,a.css)({boxShadow:Se.shadows.z3,position:"relative",zIndex:Se.zIndex.portal}),loader:(0,a.css)({position:"absolute",top:0,left:0,right:0,zIndex:Se.zIndex.portal+1,overflow:"hidden"}),search:(0,a.css)({input:{cursor:"default"}})})},35222:(Z,R,e)=>{"use strict";e.d(R,{A:()=>d});var n=e(74848),a=e(22803),s=e(70255),l=e(63142),o=e(63527);function d(){const c=(0,l.of)(i);return(0,n.jsx)("div",{className:c.wrapper,children:(0,n.jsx)("div",{className:c.inputWrapper,children:(0,n.jsx)("button",{type:"button",className:c.fakeInput,"aria-disabled":!0,children:(0,n.jsx)(s.A,{width:100})})})})}const i=c=>{const m=(0,o.n)({theme:c});return{wrapper:m.wrapper,inputWrapper:m.inputWrapper,fakeInput:(0,a.css)([m.input,{textAlign:"left"}])}}},19753:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>i});var n=e(74848),a=e(2543),s=e.n(a),l=e(96540),o=e(63527),d=e(37386);class i extends l.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=l.createRef(),this.updateValue=()=>{const m=this.inputRef.current?.value;let p=!1,h="";const r=this.props.min,g=this.props.max;let y=m!==""?Number(m):void 0;y&&!Number.isNaN(y)&&(r!=null&&y<r?(h=r.toString(),p=!0):g!=null&&y>g?(h=g.toString(),p=!0):h=m??"",this.setState({text:h,inputCorrected:p})),p&&this.updateValueDebounced(),!Number.isNaN(y)&&y!==this.props.value&&this.props.onChange(y)},this.updateValueDebounced=(0,a.debounce)(this.updateValue,500),this.onChange=m=>{this.setState({text:m.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=m=>{m.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(m){if(this.props.value!==m.value){const p=isNaN(this.props.value)?"":`${this.props.value}`;p!==this.state.text&&this.setState({text:p})}}renderInput(){return(0,n.jsx)(o.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:m}=this.state;if(m){let p="",{min:h,max:r}=this.props;return r==null?h!=null&&(p=`< ${h}`):h!=null?p=`${h} < > ${r}`:p=`> ${r}`,(0,n.jsx)(d.D,{invalid:m,error:`Out of range ${p}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},38669:(Z,R,e)=>{"use strict";e.d(R,{a:()=>c});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(35427),d=e(76319),i=e(13409);const c=({value:p,settings:h,onChange:r,details:g})=>{const y=(0,l.$j)(),v=(0,l.of)(m);return(0,n.jsx)(o.sk,{color:p??"",onChange:r,enableNamedColors:h?.enableNamedColors!==!1,children:({ref:x,showColorPicker:f,hideColorPicker:u})=>(0,n.jsxs)("div",{className:v.spot,children:[(0,n.jsx)("div",{className:v.colorPicker,children:(0,n.jsx)(i.q,{ref:x,onClick:f,onMouseLeave:u,color:p?y.visualization.getColorByName(p):y.components.input.borderColor})}),g&&(0,n.jsxs)(n.Fragment,{children:[p?(0,n.jsx)("span",{className:v.colorText,onClick:f,children:p}):(0,n.jsx)("span",{className:v.placeholderText,onClick:f,children:h?.placeholder??"Select color"}),h?.isClearable&&p&&(0,n.jsx)(d.K,{name:"times",onClick:()=>r(void 0),tooltip:(0,s.t)("options-ui.color.clear-tooltip","Clear settings")})]})]})})},m=p=>({spot:(0,a.css)({cursor:"pointer",color:p.colors.text.primary,background:p.components.input.background,padding:"3px",height:p.v1.spacing.formInputHeight,border:`1px solid ${p.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${p.components.input.borderHover}`}}),colorPicker:(0,a.css)({padding:`0 ${p.spacing(1)}`}),colorText:(0,a.css)({flexGrow:2}),placeholderText:(0,a.css)({flexGrow:2,color:p.colors.text.secondary})})},85053:(Z,R,e)=>{"use strict";e.d(R,{w:()=>l});var n=e(74848),a=e(96540),s=e(19753);const l=({value:o,onChange:d,item:i})=>{const{settings:c}=i,m=(0,a.useCallback)(p=>{d(c?.integer&&p!==void 0?Math.floor(p):p)},[d,c?.integer]);return(0,n.jsx)(s.Q,{value:o,min:c?.min,max:c?.max,step:c?.step,placeholder:c?.placeholder,onChange:m})}},83162:(Z,R,e)=>{"use strict";e.d(R,{H:()=>le,u:()=>ye});var n=e(74848),a=e(53543),s=e(38809),l=e(95004),o=e(33553),d=e(92745),i=e(21285),c=e(77824),m=e(59310),p=e(48457),h=e(96540),r=e(22803),g=e(2543),y=e(36394),v=e(35555),x=e(8255),f=e(63527),u=e(35427),b=e(76319),E=e(45861),D=e(72636),C=e(65240);class P extends h.PureComponent{constructor(ve){super(ve),this.onAddThreshold=()=>{const{steps:Oe}=this.state;let we=0;Oe.length>1&&(we=Oe[Oe.length-1].value+10);let ze=x.Tj.filter(Ke=>!Oe.some(qe=>qe.color===Ke))[1];ze||(ze="#CCCCCC");const Ve={value:we,color:ze,key:T++},ge=[...Oe,Ve];(0,y.RU)(ge),this.setState({steps:ge},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=Oe=>{const{steps:we}=this.state;we.length&&Oe.key!==we[0].key&&this.setState({steps:we.filter(ze=>ze.key!==Oe.key)},this.onChange)},this.onChangeThresholdValue=(Oe,we)=>{const ze=Oe.target.value.replace(/,/g,"."),Ve=parseFloat(ze),ge=isNaN(Ve)?"":Ve,Ke=this.state.steps.map(qe=>(qe.key===we.key&&(qe={...qe,value:ge}),qe));Ke.length&&(Ke[0].value=-1/0),(0,y.RU)(Ke),this.setState({steps:Ke})},this.onChangeThresholdColor=(Oe,we)=>{const{steps:ze}=this.state,Ve=ze.map(ge=>(ge.key===Oe.key&&(ge={...ge,color:we}),ge));this.setState({steps:Ve},this.onChange)},this.onBlur=()=>{const Oe=[...this.state.steps];(0,y.RU)(Oe),this.setState({steps:Oe},this.onChange)},this.onChange=()=>{this.props.onChange(I(this.props.thresholds,this.state.steps))},this.onModeChanged=Oe=>{this.props.onChange({...this.props.thresholds,mode:Oe})};const be=O(ve.thresholds.steps);be[0].value=-1/0,this.state={steps:be},this.latestThresholdInputRef=h.createRef()}renderInput(ve,be,Oe){const we=this.props.thresholds.mode===o.O.Percentage,ze=Oe+1,Ve=(0,d.t)("dimensions.thresholds-editor.aria-label-threshold","Threshold {{thresholdNumber}}",{thresholdNumber:ze});return isFinite(ve.value)?(0,n.jsx)(f.p,{type:"number",step:"0.0001",onChange:ge=>this.onChangeThresholdValue(ge,ve),value:ve.value,"aria-label":Ve,ref:Oe===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,n.jsxs)("div",{className:be.inputPrefix,children:[(0,n.jsx)("div",{className:be.colorPicker,children:(0,n.jsx)(u.sk,{color:ve.color,onChange:ge=>this.onChangeThresholdColor(ve,ge),enableNamedColors:!0})}),we&&(0,n.jsx)("div",{className:be.percentIcon,children:"%"})]}),suffix:(0,n.jsx)(b.K,{className:be.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(ve),tooltip:(0,d.t)("dimensions.threshold-editor.tooltip-remove-threshold","Remove threshold {{thresholdNumber}}",{thresholdNumber:ze})})},we.toString()):(0,n.jsx)(f.p,{type:"text",value:(0,d.t)("dimensions.thresholds-editor.value-base","Base"),"aria-label":Ve,disabled:!0,prefix:(0,n.jsx)("div",{className:be.colorPicker,children:(0,n.jsx)(u.sk,{color:ve.color,onChange:ge=>this.onChangeThresholdColor(ve,ge),enableNamedColors:!0})})})}render(){const{thresholds:ve}=this.props,{steps:be}=this.state,Oe=[{value:o.O.Absolute,label:(0,d.t)("dimensions.thresholds-editor.modes.label.absolute","Absolute"),description:(0,d.t)("dimensions.thresholds-editor.modes.description.thresholds-based-absolute-values","Pick thresholds based on the absolute values")},{value:o.O.Percentage,label:(0,d.t)("dimensions.thresholds-editor.modes.label.percentage","Percentage"),description:(0,d.t)("dimensions.thresholds-editor.modes.description.threshold-based-percent-between-minmax","Pick threshold based on the percent between min/max")}];return(0,n.jsx)(v.D.Consumer,{children:we=>{const ze=j(we);return(0,n.jsxs)("div",{className:ze.wrapper,children:[(0,n.jsx)(E.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:ze.addButton,fullWidth:!0,children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.thresholds-editor.add-threshold",children:"Add threshold"})}),(0,n.jsx)("div",{className:ze.thresholds,children:be.slice(0).reverse().map((Ve,ge)=>(0,n.jsx)("div",{className:ze.item,children:this.renderInput(Ve,ze,ge)},`${Ve.key}`))}),(0,n.jsxs)("div",{children:[(0,n.jsx)(D.J,{description:(0,d.t)("dimensions.thresholds-editor.description-percentage-means-thresholds-relative","Percentage means thresholds relative to min & max"),children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.thresholds-editor.thresholds-mode",children:"Thresholds mode"})}),(0,n.jsx)(c.z,{options:Oe,onChange:this.onModeChanged,value:ve.mode})]})]})}})}}let T=100;function O(pe){return(!pe||pe.length===0)&&(pe=[{value:-1/0,color:"green"}]),pe.filter((ve,be)=>(0,g.isNumber)(ve.value)||be===0).map(ve=>({color:ve.color,value:ve.value===null?-1/0:ve.value,key:T++}))}function I(pe,ve){return{mode:pe.mode??o.O.Absolute,steps:ve.map(Oe=>{const{key:we,...ze}=Oe;return ze})}}const j=(0,C.N)(pe=>({wrapper:(0,r.css)({display:"flex",flexDirection:"column"}),thresholds:(0,r.css)({display:"flex",flexDirection:"column",marginBottom:pe.spacing(2)}),item:(0,r.css)({marginBottom:pe.spacing(1),"&:last-child":{marginBottom:0}}),colorPicker:(0,r.css)({padding:pe.spacing(0,1)}),addButton:(0,r.css)({marginBottom:pe.spacing(1)}),percentIcon:(0,r.css)({fontSize:pe.typography.bodySmall.fontSize,color:pe.colors.text.secondary}),inputPrefix:(0,r.css)({display:"flex",alignItems:"center"}),trashIcon:(0,r.css)({color:pe.colors.text.secondary,cursor:"pointer",marginRight:0,"&:hover":{color:pe.colors.text.primary}})}));class W extends h.PureComponent{constructor(ve){super(ve)}render(){const{onChange:ve}=this.props;let be=this.props.value;return be||(be={mode:o.O.Percentage,steps:[]}),(0,n.jsx)(P,{thresholds:be,onChange:ve})}}var B=e(18600),S=e(63142),w=e(32881),N=e(30703),M=e(22787),L=e(4896),A=e(71451),U=e(89332),F=e(59695),V=e(18857);function K({mapping:pe,index:ve,onChange:be,onRemove:Oe,onDuplicate:we,showIconPicker:ze}){const{key:Ve,result:ge,id:Ke}=pe,qe=(0,S.of)(G),ot=(0,h.useRef)(null),lt=(0,h.useCallback)(En=>{const Bn={...pe,result:{...pe.result}};En(Bn),be(ve,Bn)},[pe,ve,be]);(0,h.useEffect)(()=>{ot.current&&pe.isNew&&(ot.current.focus(),lt(En=>{En.isNew=!1}))},[pe,ot,lt]);const mt=En=>{lt(Bn=>{Bn.result.color=En})},Lt=()=>{lt(En=>{En.result.color=void 0})},Tt=En=>{lt(Bn=>{Bn.result.icon=En})},It=()=>{lt(En=>{En.result.icon=void 0})},Mt=En=>{lt(Bn=>{Bn.key=En.currentTarget.value})},Ut=En=>{lt(Bn=>{Bn.result.text=En.currentTarget.value})},an=En=>{lt(Bn=>{Bn.from=parseFloat(En.currentTarget.value)})},cn=En=>{lt(Bn=>{Bn.to=parseFloat(En.currentTarget.value)})},un=En=>{lt(Bn=>{Bn.pattern=En.currentTarget.value})},On=En=>{lt(Bn=>{Bn.specialMatch=En.value})},yn=[{label:"Null",value:B.W.Null,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-null-and-undefined-values","Matches null and undefined values")},{label:"NaN",value:B.W.NaN,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-against-number-na-n-not-a-number","Matches against Number.NaN (not a number)")},{label:"Null + NaN",value:B.W.NullAndNaN,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-null-undefined-and-na-n","Matches null, undefined and NaN")},{label:"True",value:B.W.True,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.boolean-true-values","Boolean true values")},{label:"False",value:B.W.False,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.boolean-false-values","Boolean false values")},{label:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.label.empty","Empty"),value:B.W.Empty,description:(0,d.t)("dimensions.value-mapping-edit-row.special-match-options.description.empty-string","Empty string")}];return(0,n.jsx)(U.sx,{draggableId:Ke,index:ve,children:En=>(0,n.jsxs)("tr",{className:qe.dragRow,ref:En.innerRef,...En.draggableProps,children:[(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:qe.dragHandle,...En.dragHandleProps,children:(0,n.jsx)(N.I,{name:"draggabledots",size:"lg"})})}),(0,n.jsx)("td",{className:qe.typeColumn,children:pe.type}),(0,n.jsxs)("td",{children:[pe.type===B.d.ValueToText&&(0,n.jsx)(f.p,{ref:ot,type:"text",value:Ve??"",onChange:Mt,placeholder:(0,d.t)("dimensions.value-mapping-edit-row.placeholder-exact-value-to-match","Exact value to match")}),pe.type===B.d.RangeToText&&(0,n.jsxs)("div",{className:qe.rangeInputWrapper,children:[(0,n.jsx)(f.p,{type:"number",value:pe.from??"",placeholder:(0,d.t)("dimensions.value-mapping-edit-row.placeholder-from","From"),onChange:an}),(0,n.jsx)(f.p,{type:"number",value:pe.to??"",placeholder:(0,d.t)("dimensions.value-mapping-edit-row.placeholder-to","To"),onChange:cn})]}),pe.type===B.d.RegexToText&&(0,n.jsx)(f.p,{type:"text",value:pe.pattern??"",placeholder:(0,d.t)("dimensions.value-mapping-edit-row.placeholder-regular-expression","Regular expression"),onChange:un}),pe.type===B.d.SpecialValue&&(0,n.jsx)(V.l6,{value:yn.find(Bn=>Bn.value===pe.specialMatch),options:yn,onChange:On})]}),(0,n.jsx)("td",{children:(0,n.jsx)(f.p,{type:"text",value:ge.text??"",onChange:Ut,placeholder:(0,d.t)("dimensions.value-mapping-edit-row.placeholder-optional-display-text","Optional display text")})}),(0,n.jsxs)("td",{className:qe.textAlignCenter,children:[ge.color&&(0,n.jsxs)(w.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(u.sk,{color:ge.color,onChange:mt,enableNamedColors:!0}),(0,n.jsx)(b.K,{name:"times",onClick:Lt,tooltip:(0,d.t)("dimensions.value-mapping-edit-row.tooltip-remove-color","Remove color"),tooltipPlacement:"top"})]}),!ge.color&&(0,n.jsx)(u.sk,{color:"gray",onChange:mt,enableNamedColors:!0,children:Bn=>(0,n.jsx)(E.$n,{variant:"primary",fill:"text",onClick:Bn.showColorPicker,ref:Bn.ref,size:"sm",children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mapping-edit-row.set-color",children:"Set color"})})})]}),ze&&(0,n.jsx)("td",{className:qe.textAlignCenter,children:(0,n.jsxs)(w.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(A.n,{onChange:Tt,onClear:It,value:ge.icon,size:L.Iy.SMALL,folderName:L.Iu.Icon,mediaType:L.zu.Icon,color:ge.color}),ge.icon&&(0,n.jsx)(b.K,{name:"times",onClick:It,tooltip:(0,d.t)("dimensions.value-mapping-edit-row.tooltip-remove-icon","Remove icon"),tooltipPlacement:"top"})]})}),(0,n.jsx)("td",{className:qe.textAlignCenter,children:(0,n.jsxs)(w.Gy,{spacing:"sm",children:[(0,n.jsx)(b.K,{name:"copy",onClick:()=>we(ve),"data-testid":"duplicate-value-mapping","aria-label":(0,d.t)("dimensions.value-mapping-edit-row.duplicate-value-mapping-aria-label-duplicate-value-mapping","Duplicate value mapping"),tooltip:(0,d.t)("dimensions.value-mapping-edit-row.duplicate-value-mapping-tooltip-duplicate","Duplicate")}),(0,n.jsx)(b.K,{name:"trash-alt",onClick:()=>Oe(ve),"data-testid":"remove-value-mapping","aria-label":(0,d.t)("dimensions.value-mapping-edit-row.remove-value-mapping-aria-label-delete-value-mapping","Delete value mapping"),tooltip:(0,d.t)("dimensions.value-mapping-edit-row.remove-value-mapping-tooltip-delete","Delete")})]})})]})},Ke)}const G=pe=>({dragRow:(0,r.css)({position:"relative"}),dragHandle:(0,r.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${pe.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,r.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),regexInputWrapper:(0,r.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),typeColumn:(0,r.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,r.css)({textAlign:"center"})});function H({value:pe,onChange:ve,onClose:be,showIconPicker:Oe}){const we=(0,S.of)(_),[ze,Ve]=(0,h.useState)([]);(0,h.useEffect)(()=>{Ve(X(pe))},[pe]);const ge=Tt=>{if(!pe||!Tt.destination)return;const It=[...ze],Mt=It[Tt.source.index];It.splice(Tt.source.index,1),It.splice(Tt.destination.index,0,Mt),Ve(It)},Ke=(Tt,It)=>{const Mt=[...ze];Mt.splice(Tt,1,It),Ve(Mt)},qe=Tt=>{const It=[...ze];It.splice(Tt,1),Ve(It)},ot=[{label:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.label.value","Value"),value:B.d.ValueToText,description:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-specific-text-value","Match a specific text value")},{label:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.label.range","Range"),value:B.d.RangeToText,description:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-numerical-range-of-values","Match a numerical range of values")},{label:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.label.regex","Regex"),value:B.d.RegexToText,description:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-regular-expression-with-replacement","Match a regular expression with replacement")},{label:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.label.special","Special"),value:B.d.SpecialValue,description:(0,d.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-boolean-empty-values","Match on null, NaN, boolean and empty values")}],lt=Tt=>{Ve([...ze,J({type:Tt.value,result:{},isNew:!0})])},mt=Tt=>{const It=z(ze[Tt]),Mt=[...ze];Mt.splice(Tt,0,{...It});for(let Ut=Tt;Ut<ze.length;Ut++)Mt[Ut].result.index=Ut;Ve(Mt)},Lt=()=>{ve(Y(ze)),be()};return(0,h.useEffect)(()=>{pe?.length||lt({value:B.d.ValueToText})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:we.tableWrap,children:(0,n.jsxs)("table",{className:we.editTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.condition",children:"Condition"})}),(0,n.jsx)("th",{style:{textAlign:"left"},children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.display-text",children:"Display text"})}),(0,n.jsx)("th",{style:{width:"10%"},children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.color",children:"Color"})}),Oe&&(0,n.jsx)("th",{style:{width:"10%"},children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.icon",children:"Icon"})}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)(U.JY,{onDragEnd:ge,children:(0,n.jsx)(U.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:Tt=>(0,n.jsxs)("tbody",{ref:Tt.innerRef,...Tt.droppableProps,children:[ze.map((It,Mt)=>(0,n.jsx)(K,{mapping:It,index:Mt,onChange:Ke,onRemove:qe,onDuplicate:mt,showIconPicker:Oe},It.id)),Tt.placeholder]})})})]})}),(0,n.jsxs)(M.a.ButtonRow,{leftItems:(0,n.jsx)(F.i,{label:(0,d.t)("dimensions.value-mappings-editor-modal.label-add-a-new-mapping","Add a new mapping"),variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:ot,onChange:lt}),children:[(0,n.jsx)(E.$n,{variant:"secondary",fill:"outline",onClick:be,children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.cancel",children:"Cancel"})}),(0,n.jsx)(E.$n,{variant:"primary",onClick:Lt,children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor-modal.update",children:"Update"})})]})]})}const _=pe=>({tableWrap:(0,r.css)({maxHeight:"calc(80vh - 170px)",minHeight:"40px",overflow:"auto"}),editTable:(0,r.css)({width:"100%",marginBottom:pe.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:pe.colors.action.hover}," th, td":{padding:pe.spacing(1)}})});function k(){return(0,g.uniqueId)("mapping-")}function J(pe){return{type:B.d.ValueToText,result:{},id:k(),...pe}}function z(pe){return{...J(pe),id:k()}}function Y(pe){const ve=[],be={type:B.d.ValueToText,options:{}};return pe.forEach((Oe,we)=>{const ze={...Oe.result,index:we};switch((!ze.text||ze.text.trim().length===0)&&(ze.text=void 0),Oe.type){case B.d.ValueToText:Oe.key!=null&&(be.options[Oe.key]=ze);break;case B.d.RangeToText:(Oe.from!=null||Oe.to!=null)&&ve.push({type:Oe.type,options:{from:Oe.from??null,to:Oe.to??null,result:ze}});break;case B.d.RegexToText:Oe.pattern!=null&&ve.push({type:Oe.type,options:{pattern:Oe.pattern,result:ze}});break;case B.d.SpecialValue:ve.push({type:Oe.type,options:{match:Oe.specialMatch,result:ze}})}}),Object.keys(be.options).length>0&&ve.unshift(be),ve}function X(pe){const ve=[];if(pe)for(const be of pe)switch(be.type){case B.d.ValueToText:for(const Oe in be.options)ve.push(J({type:be.type,result:be.options[Oe],key:Oe}));break;case B.d.RangeToText:ve.push(J({type:be.type,result:be.options.result,from:be.options.from,to:be.options.to}));break;case B.d.RegexToText:ve.push(J({type:be.type,result:be.options.result,pattern:be.options.pattern}));break;case B.d.SpecialValue:ve.push(J({type:be.type,result:be.options.result,specialMatch:be.options.match??B.W.Null}))}return ve.sort((be,Oe)=>(be.result.index??0)>(Oe.result.index??0)?1:-1),ve}const Q=(0,h.memo)(pe=>{const{value:ve,onChange:be,item:Oe}=pe,we=(0,S.of)(q),ze=Oe.settings?.icon,[Ve,ge]=(0,h.useState)(!1),Ke=(0,h.useCallback)(()=>{ge(!1)},[ge]),qe=(0,h.useMemo)(()=>X(ve),[ve]),ot=(0,h.useCallback)((mt,Lt)=>{qe[Lt].result.color=mt,be(Y(qe))},[qe,be]),lt=(0,h.useCallback)((mt,Lt)=>{qe[Lt].result.icon=mt,be(Y(qe))},[qe,be]);return(0,n.jsxs)(w.gW,{children:[(0,n.jsx)("table",{className:we.compactTable,children:(0,n.jsx)("tbody",{children:qe.map((mt,Lt)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[mt.type===B.d.ValueToText&&mt.key,mt.type===B.d.RangeToText&&(0,n.jsxs)("span",{children:["[",mt.from??"-\u221E"," - ",mt.to??"\u221E","]"]}),mt.type===B.d.RegexToText&&mt.pattern,mt.type===B.d.SpecialValue&&mt.specialMatch]}),(0,n.jsx)("td",{children:(0,n.jsx)(N.I,{name:"arrow-right"})}),(0,n.jsx)("td",{children:mt.result.text}),mt.result.color&&(0,n.jsx)("td",{children:(0,n.jsx)(u.sk,{color:mt.result.color,onChange:Tt=>ot(Tt,Lt),enableNamedColors:!0})}),ze&&mt.result.icon&&(0,n.jsx)("td",{"data-testid":"iconPicker",children:(0,n.jsx)(A.n,{onChange:Tt=>lt(Tt,Lt),value:mt.result.icon,size:L.Iy.SMALL,folderName:L.Iu.Icon,mediaType:L.zu.Icon,color:mt.result.color})})]},Lt.toString()))})}),(0,n.jsxs)(E.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>ge(!0),children:[qe.length>0&&(0,n.jsx)("span",{children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor.edit-value-mappings",children:"Edit value mappings"})}),qe.length===0&&(0,n.jsx)("span",{children:(0,n.jsx)(d.x6,{i18nKey:"dimensions.value-mappings-editor.add-value-mappings",children:"Add value mappings"})})]}),(0,n.jsx)(M.a,{isOpen:Ve,title:(0,d.t)("dimensions.value-mappings-editor.title-value-mappings","Value mappings"),onDismiss:Ke,className:we.modal,closeOnBackdropClick:!1,children:(0,n.jsx)(H,{value:ve,onChange:be,onClose:Ke,showIconPicker:ze})})]})});Q.displayName="ValueMappingsEditor";const q=pe=>({modal:(0,r.css)({width:"980px"}),compactTable:(0,r.css)({width:"100%","tbody td":{padding:pe.spacing(.5)}})});var te=e(95506);const ne=({value:pe,onChange:ve,item:be})=>{const{placeholder:Oe,isClearable:we}=be?.settings??{},ze=(0,h.useCallback)(Ve=>{ve(Ve?.value?.uid)},[ve]);return(0,n.jsx)(te.b,{isClearable:we,defaultOptions:!0,onChange:ze,placeholder:Oe,value:pe})};var se=e(79609),ue=e(49517);const de=({value:pe,onChange:ve,context:be})=>(0,n.jsx)(ue.G,{actions:pe,onChange:ve,data:be.data,getSuggestions:()=>be.getSuggestions?be.getSuggestions(se.uP.Values):[]});var ie=e(38669),he=e(76637),me=e(64394),ce=e(37386);const Pe=({value:pe,onChange:ve,item:be,id:Oe})=>{const we=(0,S.$j)(),ze=(0,S.of)(Se),Ve=(0,he.Hs)(pe?.mode),Ke=(be.settings?.byValueSupport?he.uf.list():he.uf.list().filter(Lt=>!Lt.isByValue)).filter(Lt=>!Lt.excludeFromPicker).map(Lt=>{let Tt=Lt.isByValue?" (by value)":"";return{value:Lt.id,label:`${Lt.name}${Tt}`,description:Lt.description,isContinuous:Lt.isContinuous,isByValue:Lt.isByValue,component(){return(0,n.jsx)(Ie,{mode:Lt,theme:we})}}}),qe=Lt=>{ve({...pe,mode:Lt.value})},ot=Lt=>{ve({...pe,mode:mt,fixedColor:Lt})},lt=Lt=>{ve({...pe,mode:mt,seriesBy:Lt})},mt=pe?.mode??me.Y.Thresholds;if(mt===me.Y.Fixed||mt===me.Y.Shades)return(0,n.jsxs)("div",{className:ze.group,children:[(0,n.jsx)(V.l6,{minMenuHeight:200,options:Ke,value:mt,onChange:qe,className:ze.select,inputId:Oe}),(0,n.jsx)(ie.a,{value:pe?.fixedColor,onChange:ot})]});if(be.settings?.bySeriesSupport&&Ve.isByValue){const Lt=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:we.spacing(2)},children:(0,n.jsx)(V.l6,{minMenuHeight:200,options:Ke,value:mt,onChange:qe,inputId:Oe})}),(0,n.jsx)(ce.D,{label:(0,d.t)("options-ui.field-color.color-by-label","Color series by"),children:(0,n.jsx)(c.z,{value:pe?.seriesBy??"last",options:Lt,onChange:lt})})]})}return(0,n.jsx)(V.l6,{minMenuHeight:200,options:Ke,value:mt,onChange:qe,inputId:Oe})},Ie=({mode:pe,theme:ve})=>{if(!pe.getColors)return null;const be=pe.getColors(ve).map(ve.visualization.getColorByName),Oe={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(pe.isContinuous)Oe.background=`linear-gradient(90deg, ${be.join(",")})`;else{let we="",ze="";for(let Ve=0;Ve<be.length;Ve++){const ge=be[Ve];if(we==="")we=`linear-gradient(90deg, ${ge} 0%`;else{const qe=Ve/be.length*100;we+=`, ${ze} ${qe}%, ${ge} ${qe}%`}ze=ge}Oe.background=we}return(0,n.jsx)("div",{style:Oe})},Se=pe=>({group:(0,r.css)({display:"flex"}),select:(0,r.css)({marginRight:pe.spacing(1),flexGrow:1})});var Me=e(96822);const Te=({value:pe,onChange:ve,context:be,item:Oe})=>(0,n.jsx)(Me.e,{links:pe,onChange:ve,data:be.data,getSuggestions:()=>be.getSuggestions?be.getSuggestions(se.uP.Values):[],showOneClick:Oe.settings?.showOneClick});class Ge extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ve}=this.props,{settings:be}=ve;let Oe=ve.settings?.options||[];be?.getOptions&&(Oe=await be.getOptions(this.props.context)),this.state.options!==Oe&&this.setState({isLoading:!1,options:Oe})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ve){const be=ve.item?.settings,Oe=this.props.item?.settings;if(be!==Oe)this.updateOptions();else if(Oe?.getOptions){const we=ve.context?.data,ze=this.props.context?.data;we!==ze&&this.updateOptions()}}render(){const{options:ve,isLoading:be}=this.state,{value:Oe,onChange:we,item:ze}=this.props,{settings:Ve}=ze;return(0,n.jsx)(V.KF,{isLoading:be,value:Oe,defaultValue:Oe,allowCustomValue:Ve?.allowCustomValue,onChange:ge=>{we(ge.map(Ke=>Ke.value).flatMap(Ke=>Ke!==void 0?[Ke]:[]))},options:ve})}}var Qe=e(85053);class tt extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ve}=this.props,{settings:be}=ve;let Oe=ve.settings?.options||[];be?.getOptions&&(Oe=await be.getOptions(this.props.context)),this.state.options!==Oe&&this.setState({isLoading:!1,options:Oe})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ve){const be=ve.item?.settings,Oe=this.props.item?.settings;if(be!==Oe)this.updateOptions();else if(Oe?.getOptions){const we=ve.context?.data,ze=this.props.context?.data;we!==ze&&this.updateOptions()}}render(){const{options:ve,isLoading:be}=this.state,{value:Oe,onChange:we,item:ze}=this.props,{settings:Ve}=ze;let ge=ve.find(Ke=>Ke.value===Oe);return!ge&&Oe&&(ge={label:`${Oe}`,value:Oe}),(0,n.jsx)(V.l6,{isLoading:be,value:ge,defaultValue:Oe,allowCustomValue:Ve?.allowCustomValue,isClearable:Ve?.isClearable,onChange:Ke=>we(Ke?.value),options:ve})}}var ke=e(21253),He=e(34107);const Re=({value:pe,onChange:ve,item:be,id:Oe})=>(0,n.jsx)(He.S,{stats:pe,onChange:ve,allowMultiple:!!be.settings?.allowMultiple,defaultStat:be.settings?.defaultStat,inputId:Oe});var Ne=e(41185),Ae=e(43173);class Ue extends h.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=ve=>{const{value:be,onChange:Oe}=this.props,we=[...be];we.splice(ve,1),Oe(we)},this.onValueChange=(ve,be)=>{if("key"in ve&&ve.key!=="Enter")return;const{value:Oe,onChange:we}=this.props,ze=ve.currentTarget.value.trim();if(be<0){ze&&(ve.currentTarget.value="",we([...Oe,ze])),this.setState({showAdd:!1});return}if(!ze)return this.onRemoveString(be);const Ve=[...Oe];Ve[be]=ze,we(Ve)}}render(){const{value:ve,item:be}=this.props,{showAdd:Oe}=this.state,we=Be(Ae.$.theme2),ze=be.settings?.placeholder||"Add text";return(0,n.jsxs)("div",{children:[ve.map((Ve,ge)=>(0,n.jsx)(f.p,{className:we.textInput,defaultValue:Ve||"",onBlur:Ke=>this.onValueChange(Ke,ge),onKeyDown:Ke=>this.onValueChange(Ke,ge),suffix:(0,n.jsx)(N.I,{className:we.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(ge)})},`${ge}/${Ve}`)),Oe?(0,n.jsx)(f.p,{autoFocus:!0,className:we.textInput,placeholder:ze,defaultValue:"",onBlur:Ve=>this.onValueChange(Ve,-1),onKeyDown:Ve=>this.onValueChange(Ve,-1),suffix:(0,n.jsx)(N.I,{name:"plus-circle"})}):(0,n.jsx)(E.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:ze})]})}}const Be=(0,C.N)(pe=>({textInput:(0,r.css)({marginBottom:"5px","&:hover":{border:`1px solid ${pe.components.input.borderHover}`}}),trashIcon:(0,r.css)({color:pe.colors.text.secondary,cursor:"pointer","&:hover":{color:pe.colors.text.primary}})}));var We=e(12965);function _e({value:pe,onChange:ve,item:be}){const Oe=(0,S.of)(Xe);return be?.settings?.isClearable&&pe!=null?(0,n.jsxs)("div",{className:Oe.wrapper,children:[(0,n.jsx)("span",{className:Oe.first,children:(0,n.jsx)(We.p,{value:pe,onChange:ve})}),(0,n.jsx)(b.K,{name:"times",onClick:()=>ve(void 0),tooltip:(0,d.t)("options-ui.units.clear-tooltip","Clear unit selection")})]}):(0,n.jsx)(We.p,{value:pe,onChange:ve})}const Xe=pe=>({wrapper:(0,r.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,r.css)({marginRight:pe.spacing(1),flexGrow:2})}),le=()=>{const pe={id:"number",name:"Number",description:"Allows numeric values input",editor:Qe.w},ve={id:"slider",name:"Slider",description:"Allows numeric values input",editor:ke.G},be={id:"text",name:"Text",description:"Allows string values input",editor:Ne.g},Oe={id:"strings",name:"String array",description:"An array of strings",editor:Ue},we={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(cn){return(0,n.jsx)(i.d,{...cn,onChange:un=>cn.onChange(un.currentTarget.checked)})}},ze={id:"select",name:"Select",description:"Allows option selection",editor:tt},Ve={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Ge},ge={id:"radio",name:"Radio",description:"Allows option selection",editor(cn){return(0,n.jsx)(c.z,{...cn,options:cn.item.settings?.options})}},Ke={id:"unit",name:"Unit",description:"Allows unit input",editor:_e},qe={id:"color",name:"Color",description:"Allows color selection",editor(cn){return(0,n.jsx)(ie.a,{value:cn.value,onChange:cn.onChange,settings:cn.item.settings,details:!0})}},ot={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Pe},lt={id:"links",name:"Links",description:"Allows defining data links",editor:Te},mt={id:"actions",name:"Actions",description:"Allows defining actions",editor:de},Lt={id:"stats-picker",name:"Stats Picker",editor:Re,description:""},Tt={id:"timezone",name:(0,d.t)("options-ui.registry.get-all-option-editors.name-time-zone","Time zone"),description:(0,d.t)("options-ui.registry.get-all-option-editors.description-time-zone","Time zone selection"),editor:m.U},It={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:p.O};return[be,pe,ve,we,ge,ze,Ke,lt,mt,Lt,Oe,Tt,ot,qe,Ve,It,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:ne},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:Q},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:W}]},ye=()=>{const pe=[(0,d.t)("options-ui.registry.standard-field-configs.category","Standard options")],ve={id:"displayName",path:"displayName",name:(0,d.t)("options-ui.registry.standard-field-configs.name-display-name","Display name"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-display-name","Change the field or series name"),editor:a.D.get("text").editor,override:a.D.get("text").editor,process:s.AM,settings:{placeholder:(0,d.t)("options-ui.registry.standard-field-configs.placeholder-display-name","none"),expandTemplateVars:!0},shouldApply:()=>!0,category:pe},be={id:"unit",path:"unit",name:(0,d.t)("options-ui.registry.standard-field-configs.name-unit","Unit"),description:"",editor:a.D.get("unit").editor,override:a.D.get("unit").editor,process:s.OU,settings:{placeholder:(0,d.t)("options-ui.registry.standard-field-configs.placeholder-unit","none")},shouldApply:()=>!0,category:pe},Oe={id:"fieldMinMax",path:"fieldMinMax",name:(0,d.t)("options-ui.registry.standard-field-configs.name-field-min-max","Field min/max"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-field-min-max","Calculate min max per field"),editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:s.FM,shouldApply:It=>It.type===l.PU.number,showIf:It=>It.min===void 0||It.max===void 0,category:pe},we={id:"min",path:"min",name:(0,d.t)("options-ui.registry.standard-field-configs.name-min","Min"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-min","Leave empty to calculate based on all values"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,d.t)("options-ui.registry.standard-field-configs.placeholder-min","auto")},shouldApply:It=>It.type===l.PU.number,category:pe},ze={id:"max",path:"max",name:(0,d.t)("options-ui.registry.standard-field-configs.name-max","Max"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-max","Leave empty to calculate based on all values"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,d.t)("options-ui.registry.standard-field-configs.placeholder-max","auto")},shouldApply:It=>It.type===l.PU.number,category:pe},Ve={id:"decimals",path:"decimals",name:(0,d.t)("options-ui.registry.standard-field-configs.name-decimals","Decimals"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,d.t)("options-ui.registry.standard-field-configs.placeholder-decimals","auto"),min:0,max:15,integer:!0},shouldApply:It=>It.type===l.PU.number,category:pe},ge={id:"noValue",path:"noValue",name:(0,d.t)("options-ui.registry.standard-field-configs.name-no-value","No value"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-no-value","What to show when there is no value"),editor:a.D.get("text").editor,override:a.D.get("text").editor,process:s.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:pe},Ke=(0,d.t)("options-ui.registry.standard-field-condigs.category-data-links","Data links and actions"),qe={id:"links",path:"links",name:(0,d.t)("options-ui.registry.standard-field-configs.name-data-links","Data links"),editor:a.D.get("links").editor,override:a.D.get("links").editor,process:s.Ch,settings:{showOneClick:!1},shouldApply:()=>!0,category:[Ke],getItemsCount:It=>It?It.length:0},ot={id:"actions",path:"actions",name:(0,d.t)("options-ui.registry.standard-field-configs.name-actions","Actions"),editor:a.D.get("actions").editor,override:a.D.get("actions").editor,process:s.cz,settings:{showOneClick:!1},shouldApply:()=>!0,category:[Ke],getItemsCount:It=>It?It.length:0,hideFromDefaults:!0},lt={id:"color",path:"color",name:(0,d.t)("options-ui.registry.standard-field-configs.name-color-scheme","Color scheme"),editor:a.D.get("fieldColor").editor,override:a.D.get("fieldColor").editor,process:s.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:pe},mt={id:"mappings",path:"mappings",name:(0,d.t)("options-ui.registry.standard-field-configs.name-value-mappings","Value mappings"),description:(0,d.t)("options-ui.registry.standard-field-configs.description-value-mappings","Modify the display text based on input value"),editor:a.D.get("mappings").editor,override:a.D.get("mappings").editor,process:s.xT,settings:{},defaultValue:[],shouldApply:It=>It.type!==l.PU.time,category:[(0,d.t)("options-ui.registry.standard-field-configs.category-value-mappings","Value mappings")],getItemsCount:It=>It?It.length:0},Lt={id:"thresholds",path:"thresholds",name:(0,d.t)("options-ui.registry.standard-field-configs.name-thresholds","Thresholds"),editor:a.D.get("thresholds").editor,override:a.D.get("thresholds").editor,process:s.N7,settings:{},defaultValue:{mode:o.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:[(0,d.t)("options-ui.registry.standard-field-configs.category-thresholds","Thresholds")],getItemsCount:It=>It?It.steps.length:0},Tt={id:"filterable",path:"filterable",name:(0,d.t)("options-ui.registry.standard-field-configs.name-ad-hoc","Ad-hoc filterable"),hideFromDefaults:!0,editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:s.FM,shouldApply:()=>!0,settings:{},category:pe};return[be,we,ze,Oe,Ve,ve,lt,ge,qe,ot,mt,Lt,Tt]}},21253:(Z,R,e)=>{"use strict";e.d(R,{G:()=>m});var n=e(74848),a=e(22803),s=e(17437),l=e(69156),o=e(96540),d=e(63142),i=e(91302),c=e(19753);const m=({value:r,onChange:g,item:y})=>{const v=(0,o.useRef)(null),{settings:x}=y,f=x?.min||0,u=x?.max||100,b=x?.step,E=x?.marks||{[f]:f,[u]:u},D=x?.included,C=x?.ariaLabelForHandle,P=75,T=!0,O=(0,d.$j)(),[I,j]=(0,o.useState)(r??f),[W,B]=(0,o.useState)(P);(0,o.useEffect)(()=>{r!=null&&r!==I&&j(r)},[r,I]),(0,o.useEffect)(()=>{const A=getComputedStyle(v.current),U=A.getPropertyValue("font-weight")||"normal",F=A.getPropertyValue("font-size")||"16px",V=A.getPropertyValue("font-family")||"Arial",K="0",G=4,H=8,_=Math.max((u+(b||0)).toString().length,(u-(b||0)).toString().length)+G,k=K.repeat(_),J=p(k,`${U} ${F} ${V}`);J&&B(J+H*2)},[u,b]);const S=(0,o.useCallback)(A=>{const U=typeof A=="number"?A:A[0];j(U),g&&g(U)},[j,g]),w=(0,o.useCallback)(A=>{let U=A;(Number.isNaN(U)||!U)&&(U=0),j(U),g&&g(U)},[g]),N=(0,i.$)(O,T,!!E),M=h(O,W),L=T?[]:[N.sliderInputVertical];return(0,n.jsxs)("div",{className:(0,a.cx)(N.container,N.slider),children:[(0,n.jsx)(s.Global,{styles:N.slider}),(0,n.jsxs)("div",{className:(0,a.cx)(N.sliderInput,...L),children:[(0,n.jsx)(l.A,{min:f,max:u,step:b,defaultValue:r,value:I,onChange:S,vertical:!T,reverse:!1,ariaLabelForHandle:C,marks:E,included:D}),(0,n.jsx)("span",{className:M.numberInputWrapper,ref:v,children:(0,n.jsx)(c.Q,{value:I,onChange:w,max:u,min:f,step:b})})]})]})};function p(r,g){const v=document.createElement("canvas").getContext("2d");return v?(v.font=g,v.measureText(r).width):null}const h=(r,g)=>({numberInputWrapper:(0,a.css)({marginLeft:r.spacing(3),maxHeight:"32px",maxWidth:g,minWidth:g,overflow:"visible",width:"100%"})})},41185:(Z,R,e)=>{"use strict";e.d(R,{g:()=>o});var n=e(74848),a=e(96540),s=e(87105),l=e(63527);const o=({value:d,onChange:i,item:c,suffix:m})=>{const p=c.settings?.useTextarea?s.f:l.p,h=(0,a.useCallback)(r=>{let g=d??"";"key"in r?r.key==="Enter"&&!c.settings?.useTextarea&&(g=r.currentTarget.value.trim()):g=r.currentTarget.value.trim(),g!==d&&i(g===""?void 0:g)},[d,c.settings?.useTextarea,i]);return(0,n.jsx)(p,{placeholder:c.settings?.placeholder,defaultValue:d||"",rows:c.settings?.useTextarea&&c.settings.rows||5,onBlur:h,onKeyDown:h,suffix:m})}},13791:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>F});var n=e(74848),a=e(22803),s=e(96540),l=e(75683),o=e(63142),d=e(27963),i=e(94076),c=e(11098);const m=({isLoading:K,children:G,className:H})=>{let _=H?(0,n.jsx)("div",{className:H,children:G}):G;return(0,n.jsx)(n.Fragment,{children:K?(0,n.jsx)(c.A,{}):_})};function p({info:K}){const G=(0,o.of)(h);return(0,n.jsx)("div",{className:G.container,children:K.map((H,_)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)("div",{className:G.infoItem,children:[(0,n.jsx)("div",{className:G.label,children:H.label}),H.value]}),_+1<K.length&&(0,n.jsx)("div",{"data-testid":"page-info-separator",className:G.separator})]},_))})}const h=K=>({container:(0,a.css)({display:"flex",flexDirection:"row",gap:K.spacing(1.5),overflow:"auto"}),infoItem:(0,a.css)({...K.typography.bodySmall,display:"flex",flexDirection:"column",gap:K.spacing(.5)}),label:(0,a.css)({color:K.colors.text.secondary}),separator:(0,a.css)({borderLeft:`1px solid ${K.colors.border.weak}`})});var r=e(92745),g=e(68143),y=e(66404),v=e(76319),x=e(37386),f=e(63527);const u=({value:K,onEdit:G})=>{const H=(0,o.of)(b),[_,k]=(0,s.useState)(K),[J,z]=(0,s.useState)(!1),[Y,X]=(0,s.useState)(!1),[Q,q]=(0,s.useState)();(0,s.useEffect)(()=>{k(K)},[K]);const te=(0,s.useCallback)(async ne=>{const se=ne.currentTarget.value;if(!se)q("Please enter a title");else if(se===K)q(void 0),z(!1);else{X(!0);try{await G(se),q(void 0),z(!1)}catch(ue){(0,g.NF)(ue)?q(ue.data.message):ue instanceof Error&&q(ue.message)}X(!1)}},[G,K]);return J?(0,n.jsx)("div",{className:H.inputContainer,children:(0,n.jsx)(x.D,{className:H.field,loading:Y,invalid:!!Q,error:Q,children:(0,n.jsx)(f.p,{className:H.input,defaultValue:_,onKeyDown:ne=>{ne.key==="Enter"&&te(ne)},autoFocus:!0,onBlur:te,onChange:ne=>k(ne.currentTarget.value),onFocus:()=>z(!0)})})}):(0,n.jsx)("div",{className:H.textContainer,children:(0,n.jsxs)("div",{className:H.textWrapper,children:[(0,n.jsx)(y.E,{element:"h1",truncate:!0,children:_}),(0,n.jsx)(v.K,{name:"pen",size:"lg",tooltip:(0,r.t)("page.editable-title.edit-tooltip","Edit title"),onClick:()=>z(!0)})]})})};u.displayName="EditableTitle";const b=K=>({textContainer:(0,a.css)({minWidth:0}),field:(0,a.css)({flex:1,left:`calc(-${K.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,a.css)({input:{...K.typography.h1}}),inputContainer:(0,a.css)({display:"flex",flex:1}),textWrapper:(0,a.css)({alignItems:"center",display:"flex",gap:K.spacing(1),height:K.spacing(K.components.height.md)})});function E({navItem:K,renderTitle:G,actions:H,info:_,subTitle:k,onEditTitle:J}){const z=(0,o.of)(D),Y=k??K.subTitle,X=J?(0,n.jsx)(u,{value:K.text,onEdit:J}):(0,n.jsxs)("div",{className:z.title,children:[K.img&&(0,n.jsx)("img",{className:z.img,src:K.img,alt:`logo for ${K.text}`}),G?G(K.text):(0,n.jsx)("h1",{children:K.text})]});return(0,n.jsxs)("div",{className:z.pageHeader,children:[(0,n.jsxs)("div",{className:z.topRow,children:[(0,n.jsxs)("div",{className:z.titleInfoContainer,children:[X,_&&(0,n.jsx)(p,{info:_})]}),(0,n.jsx)("div",{className:z.actions,children:H})]}),Y&&(0,n.jsx)("div",{className:z.subTitle,children:Y})]})}const D=K=>({topRow:(0,a.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:K.spacing(1,3)}),title:(0,a.css)({display:"flex",flexDirection:"row",maxWidth:"100%",flex:1,h1:{marginBottom:0}}),actions:(0,a.css)({display:"flex",flexDirection:"row",gap:K.spacing(1)}),titleInfoContainer:(0,a.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:K.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,a.css)({label:"page-header",display:"flex",flexDirection:"column",gap:K.spacing(1),marginBottom:K.spacing(2)}),subTitle:(0,a.css)({position:"relative",color:K.colors.text.secondary}),img:(0,a.css)({width:"32px",height:"32px",marginRight:K.spacing(2)})});var C=e(54314),P=e(30360),T=e(60208);function O({navItem:K}){const G=(0,o.of)(I);return(0,n.jsx)("div",{className:G.tabsWrapper,children:(0,n.jsx)(C.U,{children:K.children.map((H,_)=>{const k=H.icon?(0,P.Uo)(H.icon):void 0;return!H.hideFromTabs&&(0,n.jsx)(T.o,{label:H.text,active:H.active,icon:k,counter:H.tabCounter,href:H.url,suffix:H.tabSuffix,onChangeTab:H.onClick},`${H.url}-${_}`)})})})}const I=K=>({tabsWrapper:(0,a.css)({paddingBottom:K.spacing(3)})});var j=e(25508),W=e(84057),B=e(8535),S=e(52763);function w(K,G){if(G)return G;if(K&&B.M_)return(0,S.d4)((0,j.Mz)(N,H=>(0,W.tc)(H,K??"home")))}function N(K){return K.navIndex}var M=e(43550),L=e(92948),A=e(18607);function U(K,G){const H=(0,S.d4)(_=>_.navIndex)?.[M.Id];(0,s.useEffect)(()=>{const _=(K?.node!==K?.main?K?.node:K?.main)??{text:"Grafana"},k=(0,A.Z)(_,G,H).map(J=>J.text).reverse();k[k.length-1]=L.M.AppTitle,document.title=k.join(" - ")},[H,K,G])}const F=({navId:K,navModel:G,pageNav:H,renderTitle:_,onEditTitle:k,actions:J,subTitle:z,children:Y,className:X,info:Q,layout:q=l.k.Standard,onSetScrollRef:te,...ne})=>{const se=(0,o.of)(V),ue=w(K,G),{chrome:de}=(0,d.Il)();U(ue,H);const ie=H??ue?.node;return(0,s.useLayoutEffect)(()=>{ue&&de.update({sectionNav:ue,pageNav:H,layout:q})},[ue,H,de,q]),(0,n.jsxs)("div",{className:(0,a.cx)(se.wrapper,X),...ne,children:[q===l.k.Standard&&(0,n.jsx)(i.A,{divId:"page-scrollbar",onSetScrollRef:te,children:(0,n.jsxs)("div",{className:se.pageInner,children:[ie&&(0,n.jsx)(E,{actions:J,onEditTitle:k,navItem:ie,renderTitle:_,info:Q,subTitle:z}),H&&H.children&&(0,n.jsx)(O,{navItem:H}),(0,n.jsx)("div",{className:se.pageContent,children:Y})]})}),q===l.k.Canvas&&(0,n.jsx)(i.A,{divId:"page-scrollbar",onSetScrollRef:te,children:(0,n.jsx)("div",{className:se.canvasContent,children:Y})}),q===l.k.Custom&&Y]})};F.Contents=m;const V=K=>({wrapper:(0,a.css)({label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}),pageContent:(0,a.css)({label:"page-content",flexGrow:1}),primaryBg:(0,a.css)({background:K.colors.background.primary}),pageInner:(0,a.css)({label:"page-inner",padding:K.spacing(2),borderBottom:"none",background:K.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:K.spacing(0,0,0,0),[K.breakpoints.up("md")]:{padding:K.spacing(4)}}),canvasContent:(0,a.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:K.spacing(2),flexBasis:"100%",flexGrow:1})})},11098:(Z,R,e)=>{"use strict";e.d(R,{A:()=>o});var n=e(74848),a=e(31286),s=e(6975);const o=({pageName:d=""})=>{const i=`Loading ${d}...`;return(0,n.jsx)(a.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,n.jsx)(s._,{text:i})})}},1506:(Z,R,e)=>{"use strict";e.d(R,{L:()=>c});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(63142),d=e(50201),i=e(89640);function c({entity:p="Page"}){const h=(0,o.of)(m),r=p.toLowerCase();return(0,n.jsx)("div",{className:h.container,"data-testid":s.Tp.components.EntityNotFound.container,children:(0,n.jsx)(d.p,{message:`${p} not found`,variant:"not-found",children:(0,n.jsxs)(l.x6,{i18nKey:"entity-not-found.description",children:["We're looking but can't seem to find this ",{lowerCaseEntity:r},". Try returning"," ",(0,n.jsx)(i.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,n.jsx)(i.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})})}function m(p){return{container:(0,a.css)({padding:p.spacing(8,2,2,2)})}}},86678:(Z,R,e)=>{"use strict";e.d(R,{H:()=>o});var n=e(74848),a=e(75683),s=e(13791),l=e(1506);function o(){return(0,n.jsx)(s.Y,{navId:"home",layout:a.k.Canvas,pageNav:{text:"Page not found"},children:(0,n.jsx)(l.L,{entity:"Page"})})}},92100:(Z,R,e)=>{"use strict";e.d(R,{$:()=>p});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861),i=e(18857),c=e(30703),m=e(52193);const p=({onChange:r,maxMenuHeight:g})=>{const y=(0,s.useMemo)(m.A4,[]),v=(0,s.useMemo)(()=>y.map(D=>({label:D.name,imgUrl:D.info.logos.small,value:D})).sort((D,C)=>D.label?.localeCompare(C.label)),[y]),[x,f]=(0,s.useState)([]),u=(0,s.useCallback)(D=>{const C=D.filter(P=>P.value).map(P=>P.value);r(C),f(D)},[r]),b=(0,o.of)(h),E={defaultOptions:!0,getOptionLabel:D=>D.label,getOptionValue:D=>D.value,noOptionsMessage:(0,l.t)("panel-type-filter.select-no-options","No panel types found"),placeholder:(0,l.t)("panel-type-filter.select-placeholder","Filter by type"),maxMenuHeight:g,options:v,value:x,onChange:u};return(0,n.jsxs)("div",{className:b.container,children:[x.length>0&&(0,n.jsx)(d.$n,{size:"xs",icon:"trash-alt",fill:"text",className:b.clear,onClick:()=>u([]),children:(0,n.jsx)(l.x6,{i18nKey:"panel-type-filter.clear-button",children:"Clear types"})}),(0,n.jsx)(i.KF,{...E,prefix:(0,n.jsx)(c.I,{name:"filter"}),"aria-label":(0,l.t)("panel-type-filter.select-aria-label","Panel type filter")})]})};function h(r){return{container:(0,a.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,a.css)({label:"clear",fontSize:r.spacing(1.5),position:"absolute",top:r.spacing(-4.5),right:0})}}},68805:(Z,R,e)=>{"use strict";e.d(R,{j:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(67458),o=e(63142);const d=s.memo(s.forwardRef(({className:m,children:p,markdown:h,styleOverrides:r,onRemove:g,...y},v)=>{const x=(0,o.of)(f=>c(f,r?.borderTop));return(0,n.jsxs)("div",{className:(0,a.cx)(x.wrapper,m),...y,ref:v,children:[h&&i(h),p]})}));function i(m){const p=(0,l.G)(m);return(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:p}})}d.displayName="OperationRowHelp";const c=(m,p)=>{const h=m.shape.radius.default,r=m.colors.background.secondary;return{wrapper:(0,a.css)({padding:m.spacing(2),border:`2px solid ${r}`,borderTop:p?p+r:"none",borderRadius:`0 0 ${h} ${h}`,position:"relative",top:"-4px"})}}},43260:(Z,R,e)=>{"use strict";e.d(R,{A:()=>c,q:()=>i});var n=e(74848),a=e(22803),s=e(51898),l=e(63142),o=e(76319);function d(p){const h=(0,l.of)(m);return(0,n.jsx)("div",{className:(0,a.cx)(h.icon,"active"in p&&p.active&&h.active),children:(0,n.jsx)(o.K,{name:p.icon,tooltip:p.title,className:h.icon,disabled:!!p.disabled,onClick:p.onClick,type:"button","data-testid":p.dataTestId??s.Tp.components.QueryEditorRow.actionButton(p.title),..."active"in p&&{"aria-pressed":p.active}})})}function i(p){return(0,n.jsx)(d,{...p})}const c=p=>(0,n.jsx)(d,{...p}),m=p=>({icon:(0,a.css)({display:"flex",position:"relative",color:p.colors.text.secondary}),active:(0,a.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:p.shape.radius.default,bottom:-8,backgroundImage:p.colors.gradients.brandHorizontal}})})},85348:(Z,R,e)=>{"use strict";e.d(R,{u:()=>v});var n=e(74848),a=e(22803),s=e(89332),l=e(96540),o=e(22589),d=e(27489),i=e(63142),c=e(44019),m=e(92745),p=e(76319),h=e(41654),r=e(30703);const g=({actionsElement:f,disabled:u,draggable:b,collapsable:E=!0,dragHandleProps:D,headerElement:C,isContentVisible:P,onRowToggle:T,reportDragMousePosition:O,title:I,id:j,expanderMessages:W})=>{const B=(0,i.of)(y);let S=P?(0,m.t)("query-operation.header.collapse-row","Collapse query row"):(0,m.t)("query-operation.header.expand-row","Expand query row");W!==void 0&&P?S=W.close:W!==void 0&&(S=W?.open);const w=(0,m.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,n.jsxs)("div",{className:B.header,children:[(0,n.jsxs)("div",{className:B.column,children:[E&&(0,n.jsx)(p.K,{name:P?"angle-down":"angle-right",tooltip:S,className:B.collapseIcon,onClick:T,"aria-expanded":P,"aria-controls":j}),I&&(0,n.jsx)("div",{className:B.titleWrapper,onClick:T,children:(0,n.jsx)("div",{className:(0,a.cx)(B.title,u&&B.disabled),children:I})}),C]}),(0,n.jsxs)(h.B,{gap:1,alignItems:"center",children:[f,b&&(0,n.jsx)("div",{onMouseMove:O,...D,children:(0,n.jsx)(r.I,{title:w,name:"draggabledots",size:"lg",className:B.dragIcon})})]})]})},y=f=>({header:(0,a.css)({label:"Header",padding:f.spacing(.5,.5),borderRadius:f.shape.radius.default,background:f.colors.background.secondary,minHeight:f.spacing(4),display:"grid",gridTemplateColumns:"minmax(100px, max-content) min-content",alignItems:"center",justifyContent:"space-between",whiteSpace:"nowrap","&:focus":{outline:"none"}}),column:(0,a.css)({label:"Column",display:"flex",alignItems:"center",overflow:"hidden"}),dragIcon:(0,a.css)({cursor:"grab",color:f.colors.text.disabled,margin:f.spacing(0,.5),"&:hover":{color:f.colors.text.primary}}),collapseIcon:(0,a.css)({marginLeft:f.spacing(.5),color:f.colors.text.disabled}),titleWrapper:(0,a.css)({display:"flex",alignItems:"center",flexGrow:1,cursor:"pointer",overflow:"hidden",marginRight:f.spacing(.5)}),title:(0,a.css)({fontWeight:f.typography.fontWeightBold,color:f.colors.text.link,marginLeft:f.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),disabled:(0,a.css)({color:f.colors.text.disabled})});g.displayName="QueryOperationRowHeader";function v({children:f,actions:u,title:b,headerElement:E,onClose:D,onOpen:C,isOpen:P,disabled:T,draggable:O,collapsable:I,index:j,id:W,expanderMessages:B}){const[S,w]=(0,l.useState)(P!==void 0?P:!0),N=(0,i.of)(x),M=(0,l.useCallback)(()=>{w(!S)},[S,w]);(0,l.useEffect)(()=>{typeof P=="boolean"&&w(P)},[P]);const L=(0,l.useCallback)(V=>{if(V.defaultPrevented){const K=V.currentTarget.getBoundingClientRect(),G=V.clientX-K.left,H=V.clientY-K.top;(0,d.rR)("query_row_reorder_drag_position",{x:G/K.width,y:H/K.height,width:K.width,height:K.height})}},[]);(0,o.A)(()=>{S?C&&C():D&&D()},[S]);const A={isOpen:S,onOpen:()=>{w(!0)},onClose:()=>{w(!1)}},U=u&&c.renderOrCallToRender(u,A),F=E&&c.renderOrCallToRender(E,A);return O?(0,n.jsx)(s.sx,{draggableId:W,index:j,children:V=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{ref:V.innerRef,className:N.wrapper,...V.draggableProps,children:[(0,n.jsx)("div",{children:(0,n.jsx)(g,{id:W,actionsElement:U,disabled:T,draggable:!0,collapsable:I,dragHandleProps:V.dragHandleProps,headerElement:F,isContentVisible:S,onRowToggle:M,reportDragMousePosition:L,title:b,expanderMessages:B})}),S&&(0,n.jsx)("div",{className:N.content,children:f})]})})}):(0,n.jsxs)("div",{className:N.wrapper,children:[(0,n.jsx)(g,{id:W,actionsElement:U,disabled:T,draggable:!1,collapsable:I,headerElement:F,isContentVisible:S,onRowToggle:M,reportDragMousePosition:L,title:b,expanderMessages:B}),S&&(0,n.jsx)("div",{className:N.content,children:f})]})}const x=f=>({wrapper:(0,a.css)({marginBottom:f.spacing(2)}),content:(0,a.css)({marginTop:f.spacing(.5),marginLeft:f.spacing(3)})});v.displayName="QueryOperationRow"},30868:(Z,R,e)=>{"use strict";e.d(R,{y:()=>p});var n=e(74848),a=e(55494),s=e(63704),l=e(24726);const o=2,d=5,i=y=>{const v=y.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return v?v[0]:null},c=y=>y.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[o],m=y=>{let v=c(y);if(!v){v=`x${(0,l.A)()}`;const f=y.indexOf("<svg")+d;y=y.substring(0,f)+`id="${v}" `+y.substring(f)}let x=i(y);if(x){let f=x.replace(/(#(.*?))?\./g,`#${v} .`);y=y.replace(x,f)}return y},p=y=>{const{cleanStyle:v,...x}=y;return(0,n.jsx)(a.default,{...x,cacheRequests:!0,preProcessor:v?g:r})};let h=new Map;function r(y){let v=h.get(y);return v||(v=s.sQ.sanitizeSVGContent(y),h.set(y,v)),v}function g(y){let v=h.get(y);return v||(v=s.sQ.sanitizeSVGContent(y),v.indexOf('<style type="text/css">')>-1&&(v=m(v)),h.set(y,v)),v}},95506:(Z,R,e)=>{"use strict";e.d(R,{b:()=>g});var n=e(74848),a=e(76459),s=e.n(a),l=e(96540),o=e(18857),d=e(83873),i=e(75735),c=e(13956),m=e(60171);const p=(y="Dashboards",v)=>`${y}/${v}`;async function h(y=""){return d.IB.search({type:"dash-db",query:y,limit:100}).then(v=>v.map(x=>({value:{uid:x.uid,title:x.title,folderTitle:x.folderTitle,folderUid:x.folderUid},label:p(x?.folderTitle,x.title)})))}const r=s()(h,250,{leading:!0}),g=(0,l.forwardRef)(({value:y,onChange:v,placeholder:x="Select dashboard",noOptionsMessage:f="No dashboards found",...u},b)=>{const[E,D]=(0,l.useState)();(0,l.useEffect)(()=>{!y||y===E?.value?.uid||(async()=>{const P=await(0,c.n)().getDashboardDTO(y,void 0);(0,m.HG)(P)?D({value:{uid:P.metadata.name,title:P.spec.title,folderTitle:P.metadata.annotations?.[i.w2],folderUid:P.metadata.annotations?.[i.ew]},label:p(P.metadata.annotations?.[i.ew],P.spec.title)}):P.dashboard&&D({value:{uid:P.dashboard.uid,title:P.dashboard.title,folderTitle:P.meta.folderTitle,folderUid:P.meta.folderUid},label:p(P.meta?.folderTitle,P.dashboard.title)})})()},[y]);const C=(0,l.useCallback)(P=>{D(P),v?.(P?.value)},[v,D]);return(0,n.jsx)(o.DW,{loadOptions:r,onChange:C,placeholder:x,noOptionsMessage:f,value:E,defaultOptions:!0,...u,selectRef:b})})},91156:(Z,R,e)=>{"use strict";e.d(R,{d:()=>a});var n=e(3208);const a=n.NestedFolderPicker},18552:(Z,R,e)=>{"use strict";e.d(R,{r:()=>m});var n=e(74848),a=e(16817),s=e(92745),l=e(18857),o=e(30703),d=e(99090),i=e(55860);const c=()=>(0,i.S)().getSortOptions();function m({onChange:p,value:h,placeholder:r,filter:g,getSortOptions:y,isClearable:v}){const x=(0,a.A)(async()=>{const u=await(y??c)();return g?u.filter(b=>g.includes(b.value)):u},[y,g]);if(x.loading)return null;const f=!!(h?.includes("desc")||h?.startsWith("-"));return(0,n.jsx)(l.l6,{width:28,onChange:p,value:x.value?.find(u=>u.value===h)??null,options:x.value,"aria-label":(0,s.t)("sort-picker.select-aria-label","Sort"),placeholder:r??`Sort (Default ${d.r4.label})`,prefix:(0,n.jsx)(o.I,{name:f?"sort-amount-down":"sort-amount-up"}),isClearable:v},h)}},81971:(Z,R,e)=>{"use strict";e.d(R,{e:()=>p});var n=e(74848),a=e(76459),s=e.n(a),l=e(2543),o=e.n(l),d=e(96540),i=e(92745),c=e(68143),m=e(18857);class p extends d.Component{constructor(r){super(r),this.search=s()(async g=>(this.setState({isLoading:!0}),(0,l.isNil)(g)&&(g=""),(0,c.AI)().get(`/api/teams/search?perpage=100&page=1&query=${g}`).then(y=>{const v=y.teams.map(x=>({value:x,label:x.name,imgUrl:x.avatarUrl}));return this.setState({isLoading:!1}),v})),300,{leading:!0}),this.state={isLoading:!1}}componentDidMount(){const{teamId:r}=this.props;r&&(0,c.AI)().get(`/api/teams/${r}`).then(g=>{this.setState({value:{value:g,label:g.name,imgUrl:g.avatarUrl}})})}render(){const{onSelected:r,className:g}=this.props,{isLoading:y,value:v}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,n.jsx)(m.DW,{isLoading:y,defaultOptions:!0,loadOptions:this.search,value:v,onChange:r,className:g,placeholder:(0,i.t)("team-picker.select-placeholder","Select a team"),noOptionsMessage:(0,i.t)("team-picker.noOptionsMessage-no-teams-found","No teams found"),"aria-label":(0,i.t)("team-picker.select-aria-label","Team picker")})})}}},11297:(Z,R,e)=>{"use strict";e.d(R,{$:()=>i,E:()=>d});var n=e(74848),a=e(22803),s=e(48542),l=e(63142),o=e(30703);const d=({count:c,label:m,onClick:p,removeIcon:h})=>{const{color:r}=(0,s.MC)(m),g=(0,l.of)(i),y=c!==0&&(0,n.jsx)("span",{style:{marginLeft:"3px"},children:`(${c})`});return(0,n.jsxs)("span",{className:g.badge,style:{backgroundColor:r},children:[h&&(0,n.jsx)(o.I,{onClick:p,name:"times"}),m," ",y]})},i=c=>({badge:(0,a.css)({...c.typography.bodySmall,backgroundColor:c.v1.palette.gray1,borderRadius:c.shape.radius.default,color:c.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:c.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},93732:(Z,R,e)=>{"use strict";e.d(R,{$:()=>y});var n=e(74848),a=e(22803),s=e(96540),l=e(73757),o=e(8934),d=e(92745),i=e(63142),c=e(18857),m=e(30703),p=e(11297);const h=({data:x,className:f,label:u,isFocused:b,innerProps:E})=>{const D=(0,i.of)(r);return(0,n.jsx)("div",{className:(0,a.cx)(D.option,b&&D.optionFocused),"aria-label":(0,d.t)("tag-filter.tag-option-label","Tag option"),...E,children:(0,n.jsx)("div",{className:(0,a.cx)(D.optionInner,f),children:typeof u=="string"?(0,n.jsx)(p.E,{label:u,removeIcon:!1,count:x.count??0}):u})})},r=x=>({option:(0,a.css)({padding:x.spacing(.5),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent",borderRadius:x.shape.radius.default,"&:hover":{background:x.colors.action.hover}}),optionFocused:(0,a.css)({background:x.colors.action.focus,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,a.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),g=(x,f)=>{const u=RegExp((0,o.jD)(f),"i");return!!(x.value&&u.test(x.value))},y=({allowCustomValue:x=!1,formatCreateLabel:f,hideValues:u,inputId:b,isClearable:E,onChange:D,placeholder:C,tagOptions:P,tags:T,width:O})=>{const I=(0,i.of)(v),j=T.map(H=>({value:H,label:H,count:0})),[W,B]=(0,s.useState)(j),[S,w]=(0,s.useState)(!1),[N,M]=(0,s.useState)(T),[L,A]=(0,s.useState)(j),U=(0,s.useMemo)(()=>T.join(),[T]),F=(0,s.useCallback)(async()=>(await P()).map(_=>T.includes(_.term)?{value:_.term,label:_.term,count:0}:{value:_.term,label:_.term,count:_.count}),[P,T]),V=(0,s.useCallback)(async()=>{w(!0);const H=await F();x&&L.forEach(_=>H.push(_)),B(H),w(!1)},[x,L,F]);(0,s.useEffect)(()=>{T.length>0&&W.length===0&&V()},[V,W.length,T.length]),(0,s.useEffect)(()=>{T!==N&&(M(T),V())},[V,N,T]);const K=H=>{H.forEach(_=>_.count=0),D((H||[]).map(_=>_.value)),x&&A(H.filter(_=>!T.includes(_)))},G={onFocus:V,isLoading:S,options:W,allowCreateWhileLoading:!0,allowCustomValue:x,formatCreateLabel:f,defaultOptions:!0,filterOption:g,getOptionLabel:H=>H.label,getOptionValue:H=>H.value,inputId:b,isMulti:!0,onChange:K,loadingMessage:(0,d.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,d.t)("tag-filter.no-tags","No tags found"),placeholder:C||(0,d.t)("tag-filter.placeholder","Filter by tag"),value:j,width:O,components:{Option:h,MultiValueLabel:()=>null,MultiValueRemove(H){const{data:_}=H;return(0,n.jsx)(l.c.MultiValueRemove,{...H,children:(0,n.jsx)(p.E,{label:_.label,removeIcon:!0,count:_.count},_.label)})},MultiValueContainer:u?()=>null:l.c.MultiValueContainer}};return(0,n.jsxs)("div",{className:I.tagFilter,children:[E&&T.length>0&&(0,n.jsx)("button",{className:I.clear,onClick:()=>K([]),children:(0,n.jsx)(d.x6,{i18nKey:"tag-filter.clear-button",children:"Clear tags"})}),(0,n.jsx)(c.KF,{...G,prefix:(0,n.jsx)(m.I,{name:"tag-alt"}),"aria-label":(0,d.t)("tag-filter.select-aria-label","Tag filter")},U)]})};y.displayName="TagFilter";const v=x=>{const f=(0,p.$)(x);return{tagFilter:(0,a.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${f.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,a.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:x.colors.text.secondary,"&:hover":{color:x.colors.text.primary}})}}},61074:(Z,R,e)=>{"use strict";e.d(R,{F:()=>s});var n=e(47070),a=e(43173);function s(){const l=[];return a.$.featureToggles.grafanaconThemes&&(l.push("desertbloom"),l.push("gildedgrove"),l.push("sapphiredusk"),l.push("tron"),l.push("gloom")),(0,n.k)(l)}},51158:(Z,R,e)=>{"use strict";e.d(R,{mR:()=>g});var n=e(74848),a=e(2543),s=e.n(a),l=e(32899),o=e(17548),d=e(25229),i=e(92745),c=e(91867),m=e(45229),p=e(36321);const h="grafana.dashboard.timepicker.history",r=4,g=D=>(0,n.jsx)(p.b,{storageKey:h,defaultValue:[],children:(C,P)=>{const T=y(C),O=v(T);return(0,n.jsx)(c.$6,{...D,history:O,onChange:I=>{x(I,T,P),D.onChange(I)},onError:I=>m.A.emit(l.r1.alertError,[(0,i.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,i.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:I})])})}});function y(D){const C=[];if(!Array.isArray(D))return C;for(let P of D){const T=b(P);T&&C.push(T)}return C}function v(D){return D.map(C=>o.convertRawToRange(C,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function x(D,C,P){if(!f(D))return;const T={from:E(D.raw.from),to:E(D.raw.to)},O=u([T,...C]);P(O)}function f(D){return(0,d.Ar)(D.raw.from)||(0,d.Ar)(D.raw.to)}function u(D){return(0,a.uniqBy)(D,C=>C.from+C.to).slice(0,r)}function b(D){if(typeof D!="object"||D===null||Object.keys(D).length!==2||!("from"in D)||!("to"in D))return null;const{from:C,to:P}=D;return typeof C=="string"&&typeof P=="string"?{from:C,to:P}:null}function E(D){if(typeof D=="string")return D;if(!D?.toISOString)throw console.error("Invalid DateTime object passed to convertToISOString");return D.toISOString()}},25096:(Z,R,e)=>{"use strict";e.d(R,{J:()=>d});var n=e(74848),a=e(22803),s=e(96540),l=e(27489),o=e(63142);const d=({text:c="PRO",className:m,experimentId:p,eventVariant:h="",...r})=>{const g=(0,o.of)(i);return(0,s.useEffect)(()=>{p&&(0,l.Xp)(p,"test",h)},[p,h]),(0,n.jsx)("span",{className:(0,a.cx)(g.badge,m),...r,children:c})},i=c=>({badge:(0,a.css)({marginLeft:c.spacing(1.25),borderRadius:c.shape.borderRadius(5),backgroundColor:c.colors.success.main,padding:c.spacing(.25,.75),color:"white",fontWeight:c.typography.fontWeightMedium,fontSize:c.typography.pxToRem(10)})})},2989:(Z,R,e)=>{"use strict";e.d(R,{El:()=>h,Iz:()=>m,ep:()=>g});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(27489),d=e(63142),i=e(30703),c=e(45861);const m=({featureName:x,className:f,children:u,text:b,featureId:E,eventVariant:D="",size:C="md",...P})=>{const T=(0,d.of)(p,C);return(0,s.useEffect)(()=>{(0,o.Xp)(`feature-highlights-${E}`,"test",D)},[D,E]),(0,n.jsxs)("div",{className:(0,a.cx)(T.box,f),...P,children:[(0,n.jsx)(i.I,{name:"rocket",className:T.icon}),(0,n.jsxs)("div",{className:T.inner,children:[(0,n.jsxs)("p",{className:T.text,children:[(0,n.jsx)(l.x6,{i18nKey:"upgrade-box.discovery-text",children:"You\u2019ve discovered a Pro feature!"})," ",b||(0,l.t)("upgrade-box.discovery-text-continued","Get the Grafana Pro plan to access {{featureName}}.",{featureName:x})]}),(0,n.jsx)(c.z9,{variant:"secondary",size:C,className:T.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer",children:(0,n.jsx)(l.x6,{i18nKey:"upgrade-box.upgrade-button",children:"Upgrade"})})]})]})},p=(x,f)=>{const u=x.shape.borderRadius(2),b=f==="md"?"body":"bodySmall";return{box:(0,a.css)({display:"flex",alignItems:"center",position:"relative",borderRadius:u,background:x.colors.success.transparent,padding:x.spacing(2),color:x.colors.success.text,fontSize:x.typography[b].fontSize,textAlign:"left",lineHeight:"16px",margin:x.spacing(0,"auto",3,"auto"),maxWidth:`${x.breakpoints.values.xxl}px`,width:"100%"}),inner:(0,a.css)({display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"}),text:(0,a.css)({margin:0}),button:(0,a.css)({backgroundColor:x.colors.success.main,fontWeight:x.typography.fontWeightLight,color:"white","&:hover":{backgroundColor:x.colors.success.main},"&:focus-visible":{boxShadow:"none",color:x.colors.text.primary,outline:`2px solid ${x.colors.primary.main}`}}),icon:(0,a.css)({margin:x.spacing(.5,1,.5,.5)})}},h=({listItems:x,image:f,featureUrl:u,featureName:b,description:E,caption:D,action:C})=>{const P=(0,d.of)(r);return(0,n.jsxs)("div",{className:P.container,children:[(0,n.jsxs)("div",{className:P.content,children:[(0,n.jsx)("h3",{className:P.title,children:(0,n.jsxs)(l.x6,{i18nKey:"upgrade-box.get-started",children:["Get started with ",{featureName:b}]})}),E&&(0,n.jsx)("h6",{className:P.description,children:E}),(0,n.jsx)("ul",{className:P.list,children:x.map((T,O)=>(0,n.jsxs)("li",{children:[(0,n.jsx)(i.I,{name:"check",size:"xl",className:P.icon})," ",T]},O))}),C?.link&&(0,n.jsx)(c.z9,{variant:"primary",href:C.link,children:C.text}),C?.onClick&&(0,n.jsx)(c.$n,{variant:"primary",onClick:C.onClick,children:C.text}),u&&(0,n.jsx)(c.z9,{fill:"text",href:u,className:P.link,target:"_blank",rel:"noreferrer noopener",children:(0,n.jsx)(l.x6,{i18nKey:"upgrade-box.learn-more",children:"Learn more"})})]}),(0,n.jsxs)("div",{className:P.media,children:[(0,n.jsx)("img",{src:v(f),alt:"Feature screenshot"}),D&&(0,n.jsx)("p",{className:P.caption,children:D})]})]})},r=x=>({container:(0,a.css)({display:"flex",justifyContent:"space-between"}),content:(0,a.css)({width:"45%",marginRight:x.spacing(4)}),media:(0,a.css)({width:"55%",img:{width:"100%"}}),title:(0,a.css)({color:x.colors.text.maxContrast}),description:(0,a.css)({color:x.colors.text.primary,fontWeight:x.typography.fontWeightLight}),list:(0,a.css)({listStyle:"none",margin:x.spacing(4,0,2,0),li:{display:"flex",alignItems:"flex-start",color:x.colors.text.primary,padding:x.spacing(1,0)}}),icon:(0,a.css)({color:x.colors.success.main,marginRight:x.spacing(1)}),link:(0,a.css)({marginLeft:x.spacing(2)}),caption:(0,a.css)({fontWeight:x.typography.fontWeightLight,margin:x.spacing(1,0,0)})}),g=({featureName:x,description:f,featureUrl:u,image:b})=>{const E=(0,d.of)(y);return(0,n.jsxs)("div",{className:E.container,children:[(0,n.jsx)("h3",{className:E.title,children:(0,n.jsxs)(l.x6,{i18nKey:"upgrade-box.get-started",children:["Get started with ",{featureName:x}]})}),f&&(0,n.jsx)("h6",{className:E.description,children:f}),(0,n.jsx)(c.z9,{fill:"text",href:u,target:"_blank",rel:"noreferrer noopener",children:(0,n.jsx)(l.x6,{i18nKey:"upgrade-box.learn-more",children:"Learn more"})}),(0,n.jsx)("div",{className:E.media,children:(0,n.jsx)("img",{src:v(b),alt:"Feature screenshot"})})]})},y=x=>({container:(0,a.css)({overflow:"auto",height:"100%"}),title:(0,a.css)({color:x.colors.text.maxContrast}),description:(0,a.css)({color:x.colors.text.primary,fontWeight:x.typography.fontWeightLight}),media:(0,a.css)({width:"100%",marginTop:x.spacing(2),img:{width:"100%"}})}),v=x=>x.startsWith("http")?x:"/public/build/img/enterprise/highlights/"+x},47981:(Z,R,e)=>{"use strict";e.d(R,{N:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(22787),i=e(13943),c=e(66404),m=e(9628);const p=v=>[{category:(0,l.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,l.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,l.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,l.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,l.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${v} + k`],description:(0,l.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,l.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,l.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,l.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,l.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,l.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,l.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,l.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,l.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,l.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${v} + s`],description:(0,l.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,l.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,l.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,l.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,l.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,l.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,l.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${v} + o`],description:(0,l.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,l.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,l.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","u"],description:(0,l.t)("help-modal.shortcuts-description.open-share-link-drawer","Share panel link")},{keys:["p","e"],description:(0,l.t)("help-modal.shortcuts-description.open-share-embed-drawer","Share panel embed")},{keys:["p","s"],description:(0,l.t)("help-modal.shortcuts-description.open-shared-modal","Share panel snapshot")},{keys:["p","x"],description:(0,l.t)("help-modal.shortcuts-description.explore-panel","Explore panel")},{keys:["i"],description:(0,l.t)("help-modal.shortcuts-description.inspect-panel","Inspect panel")},{keys:["p","d"],description:(0,l.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,l.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],h=({onDismiss:v})=>{const x=(0,o.of)(y),f=(0,s.useMemo)(()=>(0,m.gn)(),[]),u=(0,s.useMemo)(()=>p(f),[f]);return(0,n.jsx)(d.a,{title:(0,l.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:v,onClickBackdrop:v,children:(0,n.jsx)(i.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(u).map(({category:b,shortcuts:E})=>(0,n.jsx)("section",{children:(0,n.jsxs)("table",{className:x.table,children:[(0,n.jsx)("caption",{children:(0,n.jsx)(c.E,{element:"p",variant:"h5",children:b})}),(0,n.jsx)("thead",{className:"sr-only",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(l.x6,{i18nKey:"help-modal.column-headers.keys",children:"Keys"})}),(0,n.jsx)("th",{children:(0,n.jsx)(l.x6,{i18nKey:"help-modal.column-headers.description",children:"Description"})})]})}),(0,n.jsx)("tbody",{children:E.map(({keys:D,description:C})=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:x.keys,children:D.map(P=>(0,n.jsx)(r,{children:P},P))}),(0,n.jsx)("td",{children:(0,n.jsx)(c.E,{variant:"bodySmall",element:"p",children:C})})]},D.join()))})]})},b))})})},r=({children:v})=>{const x=(0,o.of)(y),f=(0,s.useMemo)(()=>g(v),[v]),u=(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:f}});return(0,n.jsx)("kbd",{className:x.shortcutTableKey,children:(0,n.jsx)(c.E,{variant:"code",children:u})})};function g(v){let x,f;if(v.includes("ctrl"))x="ctrl",f="Control";else if(v.includes("esc"))x="esc",f="Escape";else return v;return v.replace(x,`<span class="sr-only">${f}</span><span aria-hidden="true" role="none">${x}</span>`)}function y(v){return{table:(0,a.css)({borderCollapse:"separate",borderSpacing:v.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,a.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,a.css)({display:"inline-block",textAlign:"center",marginRight:v.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${v.colors.border.medium}`,borderRadius:v.shape.radius.default,color:v.colors.text.primary,backgroundColor:v.colors.background.secondary})}}},95943:(Z,R,e)=>{"use strict";e.d(R,{FG:()=>y,Gk:()=>h,HG:()=>o,IZ:()=>r,Pz:()=>l,Ut:()=>x,bJ:()=>i,cV:()=>s,cx:()=>c,dU:()=>a,o9:()=>d,rt:()=>p,sD:()=>n,tH:()=>m,wV:()=>v});const n=30,a=8,s=24,l="v",o="h",d=4,i=250,c=n*3,m="panel-copy",p="row-copy",h="tab-copy",r=2,g=23763571993,y=40,v="VisualizationSelectPane.ListMode",x="mega-menu-toggle"},27963:(Z,R,e)=>{"use strict";e.d(R,{Il:()=>l,YE:()=>s,ni:()=>o});var n=e(96540),a=e(36490);const s=(0,n.createContext)(void 0);function l(){const d=(0,n.useContext)(s);if(!d)throw new Error("No GrafanaContext found");return d}function o(){const{chrome:d}=l();return(0,n.useCallback)((i,c)=>{const{pathname:m,search:p}=a.Ny.getLocation();d.setReturnToPrevious({title:i,href:c??m+p})},[d])}},64762:(Z,R,e)=>{"use strict";e.d(R,{Cf:()=>y,_2:()=>v,gi:()=>r,q8:()=>g,tZ:()=>h});var n=e(96540),a=e(24726),s=e(47797),l=e(8535),o=e(96221),d=e(52763),i=e(6890);const c={title:"",text:"",severity:o.Qd.Success,icon:"check"},m={title:"",text:"",severity:o.Qd.Warning,icon:"exclamation-triangle"},p={title:"",text:"",severity:o.Qd.Error,icon:"exclamation-triangle"},h=(u,b="",E)=>({...c,title:u,text:b,id:(0,a.A)(),timestamp:Date.now(),showing:!0}),r=(u,b="",E,D)=>({...p,text:(0,s.q6)(b),title:u,id:(0,a.A)(),traceId:E,component:D,timestamp:Date.now(),showing:!0}),g=(u,b="",E)=>({...m,title:u,text:b,traceId:E,id:(0,a.A)(),timestamp:Date.now(),showing:!0}),y=(u,b="",E)=>({severity:o.Qd.Info,icon:"info-circle",title:u,text:b,id:(0,a.A)(),timestamp:Date.now(),showing:!0});function v(){const u=(0,d.wA)();return(0,n.useMemo)(()=>({[o.Qd.Success]:(b,E="")=>{u((0,i.dx)(x(b,E,o.Qd.Success)))},[o.Qd.Warning]:(b,E="",D)=>{u((0,i.dx)(x(b,E,o.Qd.Warning,D)))},[o.Qd.Error]:(b,E="",D)=>{u((0,i.dx)(x(b,E,o.Qd.Error,D)))},[o.Qd.Info]:(b,E="")=>{u((0,i.dx)(x(b,E,o.Qd.Info)))}}),[u])}function x(u,b="",E=o.Qd.Success,D){return{[o.Qd.Success]:(P,T="")=>h(P,T),[o.Qd.Warning]:(P,T="",O)=>g(P,T,O),[o.Qd.Error]:(P,T="",O)=>r(P,T,O),[o.Qd.Info]:(P,T="")=>y(P,T)}[E](u,b,D)}function f(u,b="",E=AppNotificationSeverity.Success){storeDispatch(notifyApp(x(u,b,E)))}},66594:(Z,R,e)=>{"use strict";e.d(R,{$H:()=>m,Ay:()=>p});var n=e(2543),a=e(29043),s=e(72054),l=e(78282);const o=b=>{const E=(0,l.l)().getInstanceSettings(b.datasourceName);return{id:b.ts.toString(),createdAt:b.ts,datasourceName:b.datasourceName,datasourceUid:E?.uid||"",starred:b.starred,comment:b.comment,queries:b.queries}},d=b=>{if(!(0,l.l)().getInstanceSettings({uid:b.datasourceUid}))throw new Error("Datasource not found.");return{ts:b.createdAt,datasourceName:b.datasourceName,starred:b.starred,comment:b.comment,queries:b.queries}};var i=e(68126);const c="grafana.explore.richHistory",m=1e4;class p{async getRichHistory(E){const D=y().map(o),C=E.starred?D.filter(O=>O.starred===!0):D,P=E.from&&E.to?[E.from,E.to]:void 0,T=(0,i.a_)(C,E.sortOrder,E.datasourceFilters,E.search,P);return{richHistory:T,total:T.length}}async addToRichHistory(E){const D=Date.now(),C={id:D.toString(),createdAt:D,...E},P=d(C),T=r(y()),O=P.queries.map(S=>(0,n.omit)(S,["key","refId"])),I=T.length>0&&T[0].queries.map(S=>(0,n.omit)(S,["key","refId"]));if((0,n.isEqual)(O,I)){const S=new Error("Entry already exists");throw S.name=s.m.DuplicatedEntry,S}const{queriesToKeep:j,limitExceeded:W}=g(T),B=[P,...j];try{a.A.setObject(c,B)}catch(S){if(S instanceof Error&&S.name==="QuotaExceededError")u(s.m.StorageFull,`Saving rich history failed: ${S.message}`);else throw S}return W?{warning:{type:s.C.LimitExceeded,message:`Query history reached the limit of ${m}. Old, not-starred items have been removed.`},richHistoryQuery:C}:{richHistoryQuery:C}}async deleteAll(){a.A.delete(c)}async deleteRichHistory(E){const D=parseInt(E,10),P=a.A.getObject(c,[]).filter(T=>T.ts!==D);a.A.setObject(c,P)}async updateStarred(E,D){return h(E,C=>C.starred=D)}async updateComment(E,D){return h(E,C=>C.comment=D)}async getSettings(){return{activeDatasourcesOnly:a.A.getObject(i.mE.activeDatasourcesOnly)??a.A.getObject(i.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:a.A.getObject(i.mE.retentionPeriod,7),starredTabAsFirstTab:a.A.getBool(i.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:a.A.getObject(i.mE.datasourceFilters,[]).map(D=>D.value)}}async updateSettings(E){a.A.set(i.mE.activeDatasourcesOnly,E.activeDatasourcesOnly),a.A.set(i.mE.retentionPeriod,E.retentionPeriod),a.A.set(i.mE.starredTabAsFirstTab,E.starredTabAsFirstTab),a.A.setObject(i.mE.datasourceFilters,(E.lastUsedDatasourceFilters||[]).map(D=>({value:D})))}}function h(b,E){const D=parseInt(b,10),C=a.A.getObject(c,[]),P=(0,n.find)(C,{ts:D});if(!P)throw new Error("Rich history item not found.");return E(P),a.A.setObject(c,C),o(P)}function r(b){const E=a.A.getObject(i.mE.retentionPeriod,7),D=(0,i.wQ)(E,{isLastTs:!1});return b.filter(C=>C.ts>D||C.starred===!0)||[]}function g(b){let E=!1,D=b.length-1;for(;D>=0&&b.length>=m;)b[D].starred||(b.splice(D,1),E=!0),D--;return{queriesToKeep:b,limitExceeded:E}}function y(){const b=a.A.getObject(c,[]);return v(b)}function v(b){return b.map(D=>{const C=D.queries.map((P,T)=>x(D,P,T));return{...D,queries:C}})}function x(b,E,D){const C="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof E=="object"?E:f(E)?JSON.parse(E):{expr:E,refId:C[D]}}function f(b){try{JSON.parse(b)}catch{return!1}return!0}function u(b,E){const D=new Error(E);throw D.name=b,D}},72054:(Z,R,e)=>{"use strict";e.d(R,{C:()=>a,m:()=>n});var n=(s=>(s.StorageFull="StorageFull",s.DuplicatedEntry="DuplicatedEntry",s))(n||{}),a=(s=>(s.LimitExceeded="LimitExceeded",s))(a||{})},68126:(Z,R,e)=>{"use strict";e.d(R,{a_:()=>o,mE:()=>h,wQ:()=>d});var n=e(2543),a=e.n(n),s=e(25229),l=e(80977);function o(r,g,y,v,x){const f=c(r,y),u=m(f,v),b=x?i(u,x):u;return p(b,g)}const d=(r,g)=>{let y=g.now;return y||(y=g.tz?(0,s.oZ)(g.tz):(0,s.KQ)()),y.add(-r,"d"),(g.isLastTs?y.endOf("d"):y.startOf("d")).valueOf()};function i(r,g){return r.filter(y=>y.createdAt>g[0]&&y.createdAt<g[1])}function c(r,g){return g.length>0?r.filter(y=>g.includes(y.datasourceName)):r}function m(r,g){return r.filter(y=>y.comment.includes(g)?!0:y.queries.filter(x=>Object.values((0,n.omit)(x,["datasource","key","refId","hide","queryType"])).some(f=>f?.toString().includes(g))).length>0)}const p=(r,g)=>{let y;return g===l.x.Ascending&&(y=(v,x)=>v.createdAt<x.createdAt?-1:v.createdAt>x.createdAt?1:0),g===l.x.Descending&&(y=(v,x)=>v.createdAt<x.createdAt?1:v.createdAt>x.createdAt?-1:0),g===l.x.DatasourceZA&&(y=(v,x)=>v.datasourceName<x.datasourceName?-1:v.datasourceName>x.datasourceName?1:0),g===l.x.DatasourceAZ&&(y=(v,x)=>v.datasourceName<x.datasourceName?1:v.datasourceName>x.datasourceName?-1:0),r.sort(y)},h={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},53222:(Z,R,e)=>{"use strict";e.d(R,{tU:()=>x,a:()=>v,gQ:()=>f});var n=e(43173),a=e(73427),s=e(80977),l=e(66594),o=e(75505),d=e(68143),i=e(78282),c=e(69738);const m=u=>{const b=(0,i.l)().getInstanceSettings({uid:u.datasourceUid});return{id:u.uid,createdAt:u.createdAt*1e3,datasourceName:b?.name||"",datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries}},p=u=>({uid:u.id,createdAt:Math.floor(u.createdAt/1e3),datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries});class h{constructor(){this.preferenceService=new c.W("user")}async addToRichHistory(b){const{result:E}=await(0,d.AI)().post("/api/query-history",{dataSourceUid:b.datasourceUid,queries:b.queries});return{richHistoryQuery:m(E)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(b){(0,d.AI)().delete(`/api/query-history/${b}`)}async getRichHistory(b){const E=r(b);let D="query-history-get-all";b.starred&&(D="query-history-get-starred");const P=(await(0,o.s)((0,d.AI)().fetch({method:"GET",url:`/api/query-history?${E}`,requestId:D}))).data,T=(P.result.queryHistory||[]).map(m),O=P.result.totalCount||0;return{richHistory:T,total:O}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(b,E){const D=await(0,d.AI)().patch(`/api/query-history/${b}`,{comment:E});return m(D.result)}updateSettings(b){return this.preferenceService.patch({queryHistory:{homeTab:b.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(b,E){let D;return E?D=await(0,d.AI)().post(`/api/query-history/star/${b}`):D=await(0,d.AI)().delete(`/api/query-history/star/${b}`),m(D.result)}}function r(u){let b=`${u.datasourceFilters.map(E=>{const D=(0,i.l)().getInstanceSettings(E).uid;return`datasourceUid=${encodeURIComponent(D)}`}).join("&")}`;return u.search&&(b=b+`&searchString=${u.search}`),u.sortOrder&&(b=b+`&sort=${u.sortOrder===s.x.Ascending?"time-asc":"time-desc"}`),u.starred||(b=b+`&to=${u.to}`,b=b+`&from=${u.from}`),b=b+"&limit=100",b=b+`&page=${u.page||1}`,u.starred&&(b=b+`&onlyStarred=${u.starred}`),b}const g=new l.Ay,y=new h,v=()=>n.$.queryHistoryEnabled?y:g,x=()=>g,f=()=>n.$.queryHistoryEnabled?{availableFilters:[s.x.Descending,s.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:a.TP.isSignedIn}:{availableFilters:[s.x.Descending,s.x.Ascending,s.x.DatasourceAZ,s.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},94232:(Z,R,e)=>{"use strict";e.d(R,{u:()=>a});var n=e(96540);function a(s,l){const[o,d]=(0,n.useState)();return(0,n.useEffect)(()=>{const i=s.subscribe(l,d);return()=>i.unsubscribe()},[s,l]),o}},51702:(Z,R,e)=>{"use strict";e.d(R,{i:()=>s});var n=e(96540),a=e(63142);function s(l){const o=(0,a.$j)(),d=(0,n.useMemo)(()=>window.matchMedia(`(min-width: ${o.breakpoints.values[l]}px)`),[o,l]),[i,c]=(0,n.useState)(d.matches);return(0,n.useEffect)(()=>{const m=p=>c(p.matches);return d.addEventListener("change",m),()=>d.removeEventListener("change",m)},[d]),i}},45776:(Z,R,e)=>{"use strict";e.d(R,{C:()=>s});var n=e(52763),a=e(84057);const s=l=>{const o=(0,n.d4)(d=>d.navIndex);return(0,a.tc)(o,l)}},70958:(Z,R,e)=>{"use strict";e.d(R,{s:()=>l});var n=e(96540),a=e(54148),s=e(36490);function l(){const{search:o}=(0,a.zy)(),d=(0,n.useMemo)(()=>(0,s.SE)(o||""),[o]),i=(0,n.useCallback)((c,m)=>s.Ny.partial(c,m),[]);return[d,i]}},29662:(Z,R,e)=>{"use strict";e.d(R,{VV:()=>o,Yj:()=>d,dK:()=>c});var n=e(2543),a=e.n(n),s=e(22480),l=e(57002);const o="grafana",d=s.Y.map(m=>{const p=m.code===l.wi?l.Nm:m.code;return{...m,loader:{[o]:()=>e(7170)(`./${p}/grafana.json`)}}});{const m=e(55905);if(m.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:p,ENTERPRISE_I18N_NAMESPACE:h}=m("app/extensions/locales/localeExtensions");for(const r of d){const g=p[r.code];g&&(r.loader[h]=g)}}}const i=d.map(m=>m.code),c=(0,n.uniq)(d.flatMap(m=>Object.keys(m.loader)))},12810:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>h,a:()=>r});var n=e(32017),a=e.n(n),s=e(47078),l=e.n(s),o=e(92745),d=e(65642);const i=g=>l()(g,{isEqual:a()}),c=d.$W.featureToggles.localeFormatPreference,m=i((g,y)=>new Intl.DateTimeFormat(g,y)),p=i((g,y)=>new Intl.DurationFormat(g,y)),h=i((g,y={})=>{if(typeof g=="string")return h(new Date(g),y);const v=c?d.$W.regionalFormat:(0,o.Z0)();return m(v,y).format(g)}),r=i((g,y={})=>{const v=c?d.$W.regionalFormat:(0,o.Z0)();return p(v,y).format(g)})},74101:(Z,R,e)=>{"use strict";e.d(R,{z:()=>s});var n=e(54148),a=e(36490);function s(){const l=(0,n.zy)();return[new URLSearchParams(l.search),(i,c)=>{a.Ny.partial(i,c)}]}},12066:(Z,R,e)=>{"use strict";e.d(R,{$K:()=>v,Do:()=>p,XC:()=>r,XR:()=>h,dx:()=>m,fX:()=>b,g5:()=>y,oF:()=>g,qN:()=>u});var n=e(65307),a=e(25508),s=e(96221);const l=25,o="notifications",d=`${o}/lastRead`,i={byId:P(),lastRead:Number.parseInt(window.localStorage.getItem(d)??`${Date.now()}`,10)},c=(0,n.Z0)({name:"appNotifications",initialState:i,reducers:{notifyApp:(O,{payload:I})=>{Object.values(O.byId).some(j=>E(I,j)&&j.showing)||(O.byId[I.id]=I,T(O.byId))},hideAppNotification:(O,{payload:I})=>{I in O.byId&&(O.byId[I].showing=!1,T(O.byId))},clearNotification:(O,{payload:I})=>{delete O.byId[I],T(O.byId)},clearAllNotifications:O=>{O.byId={},T(O.byId)},readAllNotifications:(O,{payload:I})=>{O.lastRead=I}}}),{notifyApp:m,hideAppNotification:p,clearNotification:h,clearAllNotifications:r,readAllNotifications:g}=c.actions,y=c.reducer,v=O=>O.lastRead,x=O=>O.byId,f=(0,a.Mz)(x,O=>Object.values(O).sort((I,j)=>j.timestamp-I.timestamp)),u=(0,a.Mz)(f,O=>O.filter(D)),b=(0,a.Mz)(x,O=>Object.values(O).filter(I=>I.showing));function E(O,I){return O.icon===I.icon&&O.severity===I.severity&&O.text===I.text&&O.title===I.title}function D(O){return O.severity===s.Qd.Warning||O.severity===s.Qd.Error}function C(O){return typeof O=="object"&&O!==null&&"id"in O&&"icon"in O&&"title"in O&&"text"in O}function P(){const O=window.localStorage.getItem(o);if(!O)return{};const I=JSON.parse(O);return Object.values(I).every(j=>C(j))?I:{}}function T(O){const I=Object.values(O).filter(D).sort((j,W)=>W.timestamp-j.timestamp).slice(0,l).reduce((j,W)=>(j[W.id]={id:W.id,severity:W.severity,icon:W.icon,title:W.title,text:W.text,traceId:W.traceId,timestamp:W.timestamp,showing:!1},j),{});try{window.localStorage.setItem(o,JSON.stringify(I))}catch(j){console.error("Unable to persist notifications to local storage"),console.error(j)}}},38206:(Z,R,e)=>{"use strict";e.d(R,{I_:()=>r,L1:()=>d,TU:()=>p,ci:()=>c,fc:()=>m,ve:()=>h});var n=e(65307),a=e(43173),s=e(18832);const l=a.$.bootData?.navTree??[];function o(g){return g.map(y=>{const v=y.children&&o(y.children);return{...y,children:v,text:(0,s.C)(y.id)??y.text,subTitle:(0,s.o)(y.id)??y.subTitle,emptyMessage:(0,s.C)(y.emptyMessageId)}})}const d="starred/",i=(0,n.Z0)({name:"navBarTree",initialState:()=>o(a.$.bootData?.navTree??[]),reducers:{setStarred:(g,y)=>{const v=g.find(E=>E.id==="starred"),{id:x,title:f,url:u,isStarred:b}=y.payload;if(v)if(b){v.children||(v.children=[]);const E={id:d+x,text:f,url:u};v.children.push(E),v.children.sort((D,C)=>D.text.localeCompare(C.text))}else{const E=v.children?.findIndex(D=>D.id===d+x)??-1;E>-1&&v?.children?.splice(E,1)}},setBookmark:(g,y)=>{if(!a.$.featureToggles.pinNavItems)return;const v=g.find(u=>u.id==="bookmarks"),{item:x,isSaved:f}=y.payload;if(v)if(f){v.children||=[];const u={...x,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:v.id,text:v.text}};v.children.push(u)}else v.children=v.children?.filter(u=>u.url!==x.url)??[]},updateDashboardName:(g,y)=>{const{id:v,title:x,url:f}=y.payload,u=g.find(b=>b.id==="starred");if(u){const b=u.children?.find(E=>E.id===v);b&&(b.text=x,b.url=f,u.children?.sort((E,D)=>E.text.localeCompare(D.text)))}},removePluginFromNavTree:(g,y)=>{const v="plugin-page-"+y.payload.pluginID,x=g.findIndex(f=>f.id===v);x>-1&&g.splice(x,1)}}}),{setStarred:c,removePluginFromNavTree:m,updateDashboardName:p,setBookmark:h}=i.actions,r=i.reducer},43550:(Z,R,e)=>{"use strict";e.d(R,{Id:()=>d,Im:()=>g,Vz:()=>h,YA:()=>r,_h:()=>v,s2:()=>i});var n=e(65307),a=e(2543),s=e.n(a),l=e(65642),o=e(18832);const d="home";function i(){const x={},f=(0,a.cloneDeep)(l.Ay.bootData.navTree),u=f.find(E=>E.id===d),b=f.filter(E=>E.id!==d);return u&&c(x,[u]),c(x,b,x[d]),x}function c(x,f,u){const b=[];for(const E of f){const D={...E,text:(0,o.C)(E.id)??E.text,subTitle:(0,o.o)(E.id)??E.subTitle,emptyMessage:(0,o.C)(E.emptyMessageId),parentItem:u};D.id&&(x[D.id]=D),D.children&&c(x,D.children,D),b.push(D)}u&&(u.children=b),x["not-found"]={...m("Page not found","404 Error").node},x.error={...m("Page error","An unexpected error").node}}function m(x,f){const u={text:x,subTitle:f,icon:"exclamation-triangle"};return{node:u,main:u}}const p={},h=(0,n.VP)("navIndex/updateNavIndex"),r=(0,n.VP)("navIndex/updateConfigurationSubtitle"),g=(0,n.VP)("navIndex/removeNavIndex"),y=(x,f)=>({...x,parentItem:{...x.parentItem,text:x.parentItem?.text??"",subTitle:f}}),v=(x=p,f)=>{if(h.match(f)){let b=function(C){if(C.children)for(const P of C.children)E[P.id]={...P,parentItem:C};C.parentItem&&b(C.parentItem)};var u=b;const E={},D=f.payload;return b(D),{...x,...E}}else if(r.match(f)){const b=`Organization: ${f.payload}`;return{...x,cfg:{...x.cfg,subTitle:b},datasources:y(x.datasources,b),correlations:y(x.correlations,b),users:y(x.users,b),teams:y(x.teams,b),plugins:y(x.plugins,b),"org-settings":y(x["org-settings"],b),apikeys:y(x.apikeys,b)}}else g.match(f)&&delete x[f.payload];return x}},84057:(Z,R,e)=>{"use strict";e.d(R,{rH:()=>d,tc:()=>o});var n=e(41811),a=e(66198),s=e(43550);const l=()=>{const m={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:m,main:m}},o=(0,n.default)((m,p,h,r=!1)=>{if(m[p]){const g=m[p],y=r?g:d(g),v=i(y,p);return{node:g,main:v}}return h||l()});function d(m){return m.id===a.Rj?m:m.parentItem&&m.parentItem.id!==s.Id?d(m.parentItem):m}function i(m,p){return m.id===p?{...m,active:!0}:m.children&&m.children.length>0?{...m,children:m.children.map(h=>i(h,p))}:m}const c=m=>`${m.main.text}${m.node.text?": "+m.node.text:""}`},69738:(Z,R,e)=>{"use strict";e.d(R,{W:()=>a});var n=e(83873);class a{constructor(l){this.resourceUri=l}update(l){return n.IB.put(`/api/${this.resourceUri}/preferences`,l)}patch(l){return n.IB.patch(`/api/${this.resourceUri}/preferences`,l)}load(){return n.IB.get(`/api/${this.resourceUri}/preferences`)}}},5114:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>l});var n=e(96540),a=e(13752),s=e(79104);class l{constructor(i){this._subject=new a.B,this._state=i}useState(){return o(this)}get state(){return this._state}setState(i){this._state={...this._state,...i},this._subject.next(this._state)}subscribeToState(i){return this._subject.subscribe(i)}}function o(d){const i=(0,s.C)();return(0,n.useEffect)(()=>{const c=d.subscribeToState({next:i});return()=>c.unsubscribe()},[d,i]),d.state}},83873:(Z,R,e)=>{"use strict";e.d(R,{Mf:()=>ke,IB:()=>He,AI:()=>Re});var n=e(56568),a=e(13752),s=e(75505),l=e(88483),o=e(64423),d=e(13288),i=e(65474),c=e(20039),m=e(81160),p=e(69862),h=e(59099),r=e(37748),g=e(66847),y=e(67791),v=e(16126),x=e(41560),f=e(69850),u=e(1005),b=e(24726),E=e(32899),D=e(94644),C=e(37615),P=e(43173),T=e(45229),O=e(65642),I=e(57680),j=e(65556),W=e(13956),B=e(74848),S=e(22803),w=e(92745),N=e(63142),M=e(15245),L=e(79331),A=e(45861),U=e(35621);const F=Ne=>{const Ae=(0,N.of)(V),Ue=(0,N.$j)(),Be=(0,U.o)(Ue),We=!!Ne.maxConcurrentSessions,_e=()=>{window.location.reload()};return(0,B.jsxs)(M.ZL,{children:[(0,B.jsx)("div",{className:Be.modal,children:(0,B.jsxs)(L.w,{title:(0,w.t)("users.token-revoked-modal.title-you-have-been-automatically-signed-out","You have been automatically signed out"),severity:"warning",className:Ae.infobox,children:[(0,B.jsxs)("div",{className:Ae.text,children:[(0,B.jsx)("p",{children:(0,B.jsxs)(w.x6,{i18nKey:"users.token-revoked-modal.auto-revoked",values:{numSessions:We?Ne.maxConcurrentSessions:""},children:["Your session token was automatically revoked because you have reached"," ",(0,B.jsxs)("strong",{children:["the maximum number of ","{{numSessions}}"," concurrent sessions"]})," for your account."]})}),(0,B.jsx)("p",{children:(0,B.jsxs)(w.x6,{i18nKey:"users.token-revoked-modal.resume-message",children:[(0,B.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})})]}),(0,B.jsx)(A.$n,{size:"md",variant:"primary",onClick:_e,children:(0,B.jsx)(w.x6,{i18nKey:"users.token-revoked-modal.sign-in",children:"Sign in"})})]})}),(0,B.jsx)("div",{className:(0,S.cx)(Be.modalBackdrop,Ae.backdrop)})]})},V=Ne=>({infobox:(0,S.css)({marginBottom:0}),text:(0,S.css)({margin:Ne.spacing(1,0,2)}),backdrop:(0,S.css)({backgroundColor:Ne.colors.background.canvas,opacity:.8})});var K=e(87745),G=e(2543),H=e(63704);const _=Ne=>{const Ae=Ne.method,Ue=ne(Ne),Be=se(Ue),We=ue(Ne,Be),_e=me(Ne);return{method:Ae,headers:Ue,body:We,credentials:_e,signal:Ne.abortSignal}},k={canParse:()=>!0,parse:Ne=>(Ne.get("accept")||Ne.set("accept","application/json, text/plain, */*"),Ne)},J=Ne=>({canParse:Ae=>(Ae?.method?Ae?.method.toLowerCase():"")===Ne,parse:Ae=>(Ae.get("content-type")||Ae.set("content-type","application/json"),Ae)}),z=J("post"),Y=J("put"),X=J("patch"),Q=[z,Y,X,k],q=/[^\u0000-\u00ff]/g;function te(Ne){return q.test(Ne)?encodeURI(Ne):Ne}const ne=Ne=>{const Ae={};for(let[_e,Xe]of Object.entries(Ne.headers??{}))Ae[te(_e)]=te(Xe);const Ue=new Headers(Ae);return Q.filter(_e=>_e.canParse(Ne)).reduce((_e,Xe)=>Xe.parse(_e),Ue)},se=Ne=>{if(!Ne)return!1;const Ae=Ne.get("content-type");return!!(Ae&&(Ae.toLowerCase()==="application/json"||Ae.toLowerCase()==="application/merge-patch+json"))},ue=(Ne,Ae)=>Ne&&(!Ne.data||typeof Ne.data=="string"||Ne.data instanceof Blob?Ne.data:Ae?JSON.stringify(Ne.data):new URLSearchParams(Ne.data));async function de(Ne,Ae){if(Ae)switch(Ae){case"arraybuffer":return Ne.arrayBuffer();case"blob":return Ne.blob();case"json":return Ne.headers.get("Content-Length")==="0"?(console.warn(`${Ne.url} returned an invalid JSON`),{}):await Ne.json();case"text":return Ne.text()}const Ue=await Ne.text();try{return JSON.parse(Ue)}catch{}return Ue}function ie(Ne){return Object.keys(Ne).map(Ae=>{const Ue=Ne[Ae];return Array.isArray(Ue)?Ue.map(Be=>`${encodeURIComponent(Ae)}=${encodeURIComponent(Be)}`).join("&"):`${encodeURIComponent(Ae)}=${encodeURIComponent(Ue)}`}).join("&")}const he=Ne=>{const Ae=(0,G.omitBy)(Ne.params,We=>We===void 0||We&&We.length===0),Ue=ie(Ae),Be=Ne.validatePath?(0,H.iQ)(Ne.url):Ne.url;return Ne.params&&Ue.length?`${Be}?${Ue}`:Be},me=Ne=>Ne&&(Ne.credentials?Ne.credentials:Ne.withCredentials?((0,C.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var ce=e(1404),Pe=(Ne=>(Ne[Ne.Pending=0]="Pending",Ne[Ne.InProgress=1]="InProgress",Ne[Ne.Done=2]="Done",Ne))(Pe||{});class Ie{constructor(Ae=!1){this.state={},this.queue=new a.B,this.updates=new a.B,this.add=(Ue,Be)=>this.queue.next({id:Ue,options:Be,state:0}),this.setInProgress=Ue=>this.queue.next({id:Ue,state:1}),this.setDone=Ue=>this.queue.next({id:Ue,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=Ue=>{const Be=Object.keys(Ue).filter(_e=>Ue[_e].state===1).length;return{noOfPending:Object.keys(Ue).filter(_e=>Ue[_e].state===0).length,noOfInProgress:Be,state:Ue}},this.publishUpdate=(Ue,Be)=>{this.printState(Ue,Be),this.updates.next(Ue)},this.printState=(Ue,Be)=>{if(!Be)return;const We=Object.keys(Ue.state).reduce((_e,Xe)=>{const le={id:Xe,state:Ue.state[Xe].state};return _e.push(le),_e},[]);console.log("FetchQueue noOfStarted",Ue.noOfInProgress),console.log("FetchQueue noOfNotStarted",Ue.noOfPending),console.log("FetchQueue state",We)},this.queue.subscribe(Ue=>{const{id:Be,state:We,options:_e}=Ue;if(this.state[Be]||(this.state[Be]={state:0,options:{url:""}}),We===2){delete this.state[Be];const le=this.getUpdate(this.state);this.publishUpdate(le,Ae);return}this.state[Be].state=We,_e&&(this.state[Be].options=_e);const Xe=this.getUpdate(this.state);this.publishUpdate(Xe,Ae)})}}var Se=e(95864);class Me{constructor(Ae,Ue,Be){const We=Be?.http2Enabled?1e3:5;Ae.getUpdates().pipe((0,v.p)(({noOfPending:_e})=>_e>0),(0,Se.H)(({state:_e,noOfInProgress:Xe})=>{const le=Object.keys(_e).filter(be=>_e[be].state===Pe.Pending&&!(0,ce.dr)(_e[be].options.url)).reduce((be,Oe)=>{const we={id:Oe,options:_e[Oe].options};return be.push(we),be},[]),ye=Object.keys(_e).filter(be=>_e[be].state===Pe.Pending&&(0,ce.dr)(_e[be].options.url)).reduce((be,Oe)=>{const we={id:Oe,options:_e[Oe].options};return be.push(we),be},[]),pe=Math.max(We-Xe-le.length,0),ve=ye.slice(0,pe);return le.concat(ve)})).subscribe(({id:_e,options:Xe})=>{Ue.add(_e,Xe)})}}class Te{constructor(Ae,Ue){this.queue=new a.B,this.responses=new a.B,this.add=(Be,We)=>{this.queue.next({id:Be,options:We})},this.getResponses=Be=>this.responses.asObservable().pipe((0,v.p)(We=>We.id===Be)),this.queue.subscribe(Be=>{const{id:We,options:_e}=Be;Ae.setInProgress(We),this.responses.next({id:We,observable:Ue(_e)})})}}var Ge=e(15130);const Qe="cancel_all_requests_request_id",tt="grafana-trace-id";class ke{constructor(Ae){this.inFlightRequests=new a.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new a.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:c.$,appEvents:T.A,contextSrv:Ge.TP,logout:()=>{Ge.TP.setLoggedOut()}},this.chunkRequestId=1,Ae&&(this.dependencies={...this.dependencies,...Ae}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new Ie,this.responseQueue=new Te(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new Me(this.fetchQueue,this.responseQueue,(0,O.zj)())}async initGrafanaDeviceID(){try{const Ue=await(await n.Ay.load()).get();this.deviceID=Ue.visitorId}catch(Ae){console.error(Ae)}}async request(Ae){return await(0,s.s)(this.fetch(Ae).pipe((0,m.T)(Ue=>Ue.data)))}fetch(Ae){const Ue=(0,b.A)(),Be=this.fetchQueue;return new l.c(We=>{const _e=new o.yU;return _e.add(this.responseQueue.getResponses(Ue).subscribe(Xe=>{_e.add(Xe.observable.subscribe(We))})),this.fetchQueue.add(Ue,Ae),function(){Be.setDone(Ue),_e.unsubscribe()}})}chunked(Ae){const Ue=Ae.requestId??`chunked-${this.chunkRequestId++}`,Be=new AbortController;let We;try{We=he(Ae)}catch(Xe){return(0,d.$)(()=>Xe)}const _e=_({...Ae,requestId:Ue,abortSignal:Be.signal});return new l.c(Xe=>{let le=!1;const ye=this.dependencies.fromFetch(We,_e).subscribe({next:pe=>{const ve={status:pe.status,statusText:pe.statusText,ok:pe.ok,headers:pe.headers,url:pe.url,type:pe.type,redirected:pe.redirected,config:Ae,traceId:pe.headers.get(tt)??void 0,data:void 0};if(!pe.body){Xe.next(ve),Xe.complete();return}const be=pe.body.getReader();async function Oe(){for(;be&&!le;){if(Be.signal.aborted){be.cancel(Be.signal.reason),console.log(Ue,"signal.aborted");return}const we=await be.read();Xe.next({...ve,data:we.value}),we.done&&(le=!0,console.log(Ue,"done"))}}Oe().then(()=>{console.log(Ue,"complete"),Xe.complete()}).catch(we=>{console.log(Ue,"catch",we),Xe.error(we)})},error:pe=>{Xe.error(pe)}});return function(){console.log(Ue,"unsubscribe"),Be.abort("unsubscribe"),ye.unsubscribe()}})}internalFetch(Ae){Ae.requestId&&this.inFlightRequests.next(Ae.requestId),Ae=this.parseRequestOptions(Ae);const Ue=(0,j.r)();return Ue!==null&&Ue!==""&&P.$.jwtUrlLogin&&P.$.jwtHeaderName&&(Ae.headers=Ae.headers??{},Ae.headers[P.$.jwtHeaderName]=`${Ue}`),this.deviceID&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Ae).pipe(this.handleStreamResponse(Ae),this.handleStreamError(Ae),this.handleStreamCancellation(Ae))}resolveCancelerIfExists(Ae){this.inFlightRequests.next(Ae)}cancelAllInFlightRequests(){this.inFlightRequests.next(Qe)}async datasourceRequest(Ae){return(0,s.s)(this.fetch(Ae))}parseRequestOptions(Ae){const Ue=this.dependencies.contextSrv.user?.orgId;return Ae.retry=Ae.retry??0,(0,ce.Lr)(Ae.url)&&(Ue&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-Org-Id"]=Ue),Ae.url.startsWith("/")&&(Ae.url=Ae.url.substring(1)),Ae.headers?.Authorization&&(Ae.headers["X-DS-Authorization"]=Ae.headers.Authorization,delete Ae.headers.Authorization),this.noBackendCache&&(Ae.headers=Ae.headers??{},Ae.headers["X-Grafana-NoCache"]="true")),Ae.hideFromInspector===void 0&&(Ae.hideFromInspector=(0,ce.Lr)(Ae.url)&&!(0,ce.dr)(Ae.url)),Ae}getFromFetchStream(Ae){const Ue=_(Ae);let Be;try{Be=he(Ae)}catch(We){return(0,d.$)(()=>We)}return this.dependencies.fromFetch(Be,Ue).pipe((0,p.Z)(async We=>{const{status:_e,statusText:Xe,ok:le,headers:ye,url:pe,type:ve,redirected:be}=We,Oe=Ae.responseType??(se(ye)?"json":void 0),we=await de(We,Oe);return{status:_e,statusText:Xe,ok:le,data:we,headers:ye,url:pe,type:ve,redirected:be,config:Ae,traceId:We.headers.get(tt)??void 0}}))}showApplicationErrorAlert(Ae){}showSuccessAlert(Ae){const{config:Ue}=Ae;if(Ue.showSuccessAlert===!1||Ue.showSuccessAlert===void 0&&(Ue.method==="GET"||(0,ce.dr)(Ue.url)||!(0,ce.Lr)(Ue.url)))return;const Be=Ae.data;Be?.message&&this.dependencies.appEvents.emit(E.r1.alertSuccess,[Be.message])}showErrorAlert(Ae,Ue){if((Ue.status<400||Ue.status>=500)&&this.dependencies.contextSrv.isSignedIn&&(this.dependencies.contextSrv.user.authenticatedBy==="apikey"||this.dependencies.contextSrv.user.authenticatedBy==="render")||Ae.showErrorAlert===!1||Ae.showErrorAlert===void 0&&((0,ce.dr)(Ae.url)||!(0,ce.Lr)(Ae.url)))return;let Be="",We=Ue.data.message;We==="Unexpected error"&&Ue.message&&(We=Ue.message),We.length>80&&(Be=We,We="Error"),Ue.status===422&&(Be=Ue.data.message,We="Validation failed"),this.dependencies.appEvents.emit(Ue.status<500?E.r1.alertWarning:E.r1.alertError,[We,Be,Ue.data.traceID])}processRequestError(Ae,Ue){return Ue.data=Ue.data??{message:"Unexpected error"},typeof Ue.data=="string"&&(Ue.data={message:Ue.data,error:Ue.statusText,response:Ue.data}),Ue.data&&!Ue.data.message&&typeof Ue.data.error=="string"&&(Ue.data.message=Ue.data.error),Ue.data.message&&setTimeout(()=>{Ue.isHandled||this.showErrorAlert(Ae,Ue)},50),this.inspectorStream.next({response:Ue,requestId:Ae.requestId}),Ue}handleStreamResponse(Ae){return Ue=>Ue.pipe((0,m.T)(Be=>{if(!Be.ok){const{status:We,statusText:_e,data:Xe}=Be;throw{status:We,statusText:_e,data:Xe,config:Ae,traceId:Be.headers.get(tt)??void 0}}return Be}),(0,h.M)(Be=>{this.showSuccessAlert(Be),this.inspectorStream.next({response:Be,requestId:Ae.requestId})}))}handleStreamError(Ae){const{isSignedIn:Ue}=this.dependencies.contextSrv.user;return Be=>Be.pipe((0,r.l)(We=>We.pipe((0,p.Z)((_e,Xe)=>{const le=Xe===0&&Ae.retry===0;if(_e.status===401&&(0,ce.Lr)(Ae.url)&&le&&Ue){if(_e.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new K.S8({component:F,props:{maxConcurrentSessions:_e.data?.error?.maxConcurrentSessions}})),this.dependencies.contextSrv.setRedirectToUrl(),(0,d.$)(()=>_e);let ye=this.loginPing();return(0,I.m)()&&(0,I.W)()*1e3<Date.now()&&(ye=this.rotateToken()),(0,i.H)(ye).pipe((0,g.W)(pe=>(pe.status===401&&this.dependencies.logout(),(0,d.$)(pe))))}return(0,d.$)(_e)}))),(0,g.W)(We=>(0,d.$)(()=>this.processRequestError(Ae,We))))}handleStreamCancellation(Ae){return Ue=>Ue.pipe((0,y.Q)(this.inFlightRequests.pipe((0,v.p)(Be=>{let We=!1;return Ae&&Ae.requestId&&Ae.requestId===Be&&(We=!0),Be===Qe&&(We=!0),We}))),(0,x.v)(()=>({type:D.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Ae})))}getInspectorStream(){return this.inspectorStream}async get(Ae,Ue,Be,We){return this.request({...We,method:"GET",url:Ae,params:Ue,requestId:Be})}async delete(Ae,Ue,Be){return this.request({...Be,method:"DELETE",url:Ae,data:Ue})}async post(Ae,Ue,Be){return this.request({...Be,method:"POST",url:Ae,data:Ue})}async patch(Ae,Ue,Be){return this.request({...Be,method:"PATCH",url:Ae,data:Ue})}async put(Ae,Ue,Be){return this.request({...Be,method:"PUT",url:Ae,data:Ue})}withNoBackendCache(Ae){return this.noBackendCache=!0,Ae().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,f.j)(()=>{this._tokenRotationInProgress=null}),(0,u.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Ae){return this.get("/api/search",Ae)}getDashboardByUid(Ae){return(0,C.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,W.n)("v1").getDashboardDTO(Ae)}validateDashboard(Ae){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Ae){return this.get(`/api/public/dashboards/${Ae}`)}getFolderByUid(Ae,Ue={}){const Be=new URLSearchParams;return Ue.withAccessControl&&Be.set("accesscontrol","true"),this.get(`/api/folders/${Ae}?${Be.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const He=new ke,Re=()=>He},78731:(Z,R,e)=>{"use strict";e.d(R,{n:()=>a});var n=e(78646);const a=(l,o)=>{(0,n.x$)().addEvent({type:n.on.Performance,payload:{name:l,value:o}})},s=l=>faro?.api?.pushError(l)},25240:(Z,R,e)=>{"use strict";e.d(R,{S5:()=>o,k0:()=>s});var n=e(60379),a=e(20720);function s(d,i=!1){return new Promise(c=>{const m=document.createElement("script");m.onload=c,m.src=d,m.async=i,document.head.appendChild(m)})}const l=(0,n.h)("EchoSrv"),o=l.logger;(0,a.h)("echo",void 0,l)},67020:(Z,R,e)=>{"use strict";e.d(R,{A:()=>c});var n=e(2543),a=e.n(n),s=e(68143),l=e(65642),o=e(29043);class d{constructor(){}addDashboardImpression(p){const h=this.impressionKey();let r=[];o.A.exists(h)&&(r=JSON.parse(o.A.get(h)),(0,n.isArray)(r)||(r=[])),r=r.filter(g=>p!==g),r.unshift(p),r.length>50&&r.pop(),o.A.set(h,JSON.stringify(r))}async convertToUIDs(){let p=this.getImpressions();const h=(0,n.filter)(p,g=>(0,n.isNumber)(g));if(!h.length)return;const r=await(0,s.AI)().get(`/api/dashboards/ids/${h.join(",")}`);o.A.set(this.impressionKey(),JSON.stringify([...(0,n.filter)(p,g=>(0,n.isString)(g)),...r]))}getImpressions(){const p=o.A.get(this.impressionKey())||"[]";return JSON.parse(p)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,n.filter)(this.getImpressions(),h=>(0,n.isString)(h))}impressionKey(){return"dashboard_impressions-"+l.Ay.bootData.user.orgId}}const c=new d},12469:(Z,R,e)=>{"use strict";e.d(R,{R:()=>u});let n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},l={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},o=null;for(let b=1;b<20;++b)n[111+b]="f"+b;for(let b=0;b<=9;++b)n[b+96]=b.toString();function d(b){if(b.type==="keypress"){let E=String.fromCharCode(b.which);return b.shiftKey||(E=E.toLowerCase()),E}return n[b.which]?n[b.which]:a[b.which]?a[b.which]:String.fromCharCode(b.which).toLowerCase()}function i(b,E){return b.sort().join(",")===E.sort().join(",")}function c(b){let E=[];return b.shiftKey&&E.push("shift"),b.altKey&&E.push("alt"),b.ctrlKey&&E.push("ctrl"),b.metaKey&&E.push("meta"),E}function m(b){if(b.preventDefault){b.preventDefault();return}b.returnValue=!1}function p(b){if(b.stopPropagation){b.stopPropagation();return}b.cancelBubble=!0}function h(b){return b==="shift"||b==="ctrl"||b==="alt"||b==="meta"}function r(){if(!o){o={};for(let b in n){const E=parseInt(b,10);E>95&&E<112||n.hasOwnProperty(b)&&(o[n[b]]=b)}}return o}function g(b,E,D){return D||(D=r()[b]?"keydown":"keypress"),D==="keypress"&&E.length&&(D="keydown"),D}function y(b){return b==="+"?["+"]:(b=b.replace(/\+{2}/g,"+plus"),b.split("+"))}function v(b,E){let D,C,P,T=[];for(D=y(b),P=0;P<D.length;++P)C=D[P],l[C]&&(C=l[C]),E&&E!=="keypress"&&s[C]&&(C=s[C],T.push("shift")),h(C)&&T.push(C);if(!C)throw new Error("Unable to get key");return E=g(C,T,E),{key:C,modifiers:T,action:E}}function x(b,E){return b===null||b===document?!1:b===E?!0:x(b.parentNode,E)}class f{constructor(E){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=D=>{D=D||{};let C=!1,P;for(P in this._sequenceLevels){if(D[P]){C=!0;continue}this._sequenceLevels[P]=0}C||(this._nextExpectedAction=!1)},this._getMatches=(D,C,P,T,O,I)=>{let j,W,B=[],S=P.type;if(!this._callbacks[D])return[];for(S==="keyup"&&h(D)&&(C=[D]),j=0;j<this._callbacks[D].length;++j)if(W=this._callbacks[D][j],!(!T&&W.seq&&this._sequenceLevels[W.seq]!==W.level)&&S===W.action&&(S==="keypress"&&!P.metaKey&&!P.ctrlKey||i(C,W.modifiers))){let w=!T&&W.combo===O,N=T&&W.seq===T&&W.level===I;(w||N)&&this._callbacks[D].splice(j,1),B.push(W)}return B},this._fireCallback=(D,C,P,T)=>{const O=C.target||C.srcElement;O&&O instanceof HTMLElement&&this.stopCallback(C,O,P,T)||D(C,P)===!1&&(m(C),p(C))},this._handleKey=(D,C,P)=>{let T=this._getMatches(D,C,P),O,I={},j=0,W=!1;for(O=0;O<T.length;++O)T[O].seq&&(j=Math.max(j,T[O].level??0));for(O=0;O<T.length;++O){const S=T[O].seq;if(S){if(T[O].level!==j)continue;W=!0,I[S]=1,this._fireCallback(T[O].callback,P,T[O].combo,S);const w=S.lastIndexOf(D),N=S.slice(0,w);for(const[M,L]of Object.entries(this._sequenceLevels))L>0&&M.startsWith(N)&&(I[M]=1);continue}W||this._fireCallback(T[O].callback,P,T[O].combo)}for(const S of this._callbacks[D]??[])S.action===P.type&&S.seq&&S.level===0&&(I[S.seq]=1);let B=P.type==="keypress"&&this._ignoreNextKeypress;P.type===this._nextExpectedAction&&!h(D)&&!B&&this._resetSequences(I),this._ignoreNextKeypress=W&&P.type==="keydown"},this._handleKeyEvent=D=>{if(!(D instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const C=D;if(C.repeat)return;typeof C.which!="number"&&(C.which=C.keyCode);let P=d(C);if(P){if(C.type==="keyup"&&this._ignoreNextKeyup===P){this._ignoreNextKeyup=!1;return}this.handleKey(P,c(C),C)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(D,C,P,T)=>{this._sequenceLevels[D]=0;const O=j=>()=>{this._nextExpectedAction=j,++this._sequenceLevels[D],this._resetSequenceTimer()},I=j=>{this._fireCallback(P,j,D),T!=="keyup"&&(this._ignoreNextKeyup=d(j)),this._resetSequenceTimer()};for(let j=0;j<C.length;++j){let B=j+1===C.length?I:O(T||v(C[j+1]).action);this._bindSingle(C[j],B,T,D,j)}},this._bindSingle=(D,C,P,T,O)=>{this._directMap[D+":"+P]=C,D=D.replace(/\s+/g," ");let I=D.split(" "),j;if(I.length>1){this._bindSequence(D,I,C,P);return}j=v(D,P),this._callbacks[j.key]=this._callbacks[j.key]||[];const W={type:j.action,metaKey:!1,ctrlKey:!1};this._getMatches(j.key,j.modifiers,W,T,D,O);const B={callback:C,modifiers:j.modifiers,action:j.action,seq:T,level:O,combo:D};this._callbacks[j.key][T?"unshift":"push"](B)},this._bindMultiple=(D,C,P)=>{for(let T=0;T<D.length;++T)this._bindSingle(D[T],C,P)},this.bind=(D,C,P)=>{let T=this;return D=D instanceof Array?D:[D],this._bindMultiple(D,C,P),T},this.unbind=(D,C)=>this.bind(D,function(){},C),this.bindGlobal=(D,C,P)=>{if(this.bind(D,C,P),D instanceof Array){for(let T=0;T<D.length;T++)this._globalCallbacks[D[T]]=!0;return}this._globalCallbacks[D]=!0},this.unbindGlobal=(D,C)=>{if(this.unbind(D,C),D instanceof Array){for(let P=0;P<D.length;P++)this._globalCallbacks[D[P]]=!1;return}this._globalCallbacks[D]=!1},this.trigger=(D,C)=>{let P=this;return P._directMap[D+":"+C]&&P._directMap[D+":"+C]({},D),P},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(D,C,P,T)=>{if(this._globalCallbacks[P]||T&&this._globalCallbacks[T]||(" "+C.className+" ").indexOf(" mousetrap ")>-1||x(C,this.target))return!1;if("composedPath"in D&&typeof D.composedPath=="function"){let O=D.composedPath()[0];O!==D.target&&O instanceof HTMLElement&&(C=O)}return!!(C.tagName==="INPUT"||C.tagName==="SELECT"||C.tagName==="TEXTAREA"||"isContentEditable"in C&&C.isContentEditable)},this.handleKey=(...D)=>this._handleKey(...D),this.addKeycodes=D=>{for(let C in D)D.hasOwnProperty(C)&&(n[C]=D[C]);o=null},this.target=E,this.target.addEventListener("keypress",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keydown",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keyup",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)})}}const u=new f(document)},44410:(Z,R,e)=>{"use strict";e.d(R,{K:()=>i,O:()=>c});var n=e(47070),a=e(75234),s=e(45229),l=e(65642),o=e(73427),d=e(69738);async function i(m,p){const h=l.$W.theme2,r=(0,n.g)(m);if(s.A.publish(new a.E8(r)),h.colors.mode!==r.colors.mode){const y=document.createElement("link");y.rel="stylesheet",y.href=l.$W.bootData.assets[r.colors.mode],y.onload=()=>{const v=document.getElementsByTagName("link");for(let x=0;x<v.length;x++){const f=v[x];f.href&&f.href.includes(`build/grafana.${h.colors.mode}`)&&f.remove()}},document.head.insertBefore(y,document.head.firstChild)}if(p||!o.TP.isSignedIn)return;await new d.W("user").patch({theme:m})}async function c(m){const p=l.$W.theme2;i(p.isDark?"light":"dark",m)}},29043:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a});var n=e(78012);const a=n.M},81871:(Z,R,e)=>{"use strict";e.d(R,{F:()=>n});function n(a={}){return{...a,accesscontrol:!0}}},49344:(Z,R,e)=>{"use strict";e.d(R,{b:()=>n});const n=(a,s,l)=>(a.splice(l,0,a.splice(s,1)[0]),a)},9628:(Z,R,e)=>{"use strict";e.d(R,{gn:()=>s});function n(){const l=navigator.userAgent.indexOf("MSIE")>-1,o=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,d=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,i=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),c=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return l&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||o&&(c&&parseFloat(c[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||d&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(i&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function a(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function s(){return a()?"\u2318":"ctrl"}},68220:(Z,R,e)=>{"use strict";e.d(R,{TS:()=>s});class n{_linkTo(i,c){c<=0&&i.inputEdges.push(this),c>=0&&i.outputEdges.push(this),i.edges.push(this)}link(i,c){if(!i)throw Error("inputNode is required");if(!c)throw Error("outputNode is required");return this.unlink(),this.inputNode=i,this.outputNode=c,this._linkTo(i,1),this._linkTo(c,-1),this}unlink(){let i;const c=this.inputNode,m=this.outputNode;c&&m&&(i=c.edges.indexOf(this),i>-1&&c.edges.splice(i,1),i=m.edges.indexOf(this),i>-1&&m.edges.splice(i,1),i=c.outputEdges.indexOf(this),i>-1&&c.outputEdges.splice(i,1),i=m.inputEdges.indexOf(this),i>-1&&m.inputEdges.splice(i,1))}}class a{constructor(i){this.name=i,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(i){return i?typeof i=="object"?this.inputEdges.find(c=>c.inputNode?.name===i.name):this.inputEdges.find(c=>c.inputNode?.name===i):null}getEdgeTo(i){return i?typeof i=="object"?this.outputEdges.find(c=>c.outputNode?.name===i.name):this.outputEdges.find(c=>c.outputNode?.name===i):null}getOptimizedInputEdges(){const i=[];return this.inputEdges.forEach(c=>{c.inputNode?.inputEdges.map(p=>p.inputNode)?.forEach(p=>{const h=p?.getEdgeTo(this.name);h&&i.push(h)})}),this.inputEdges.filter(c=>i.indexOf(c)===-1)}}class s{constructor(){this.nodes={}}createNode(i){const c=new a(i);return this.nodes[i]=c,c}createNodes(i){const c=[];return i.forEach(m=>{c.push(this.createNode(m))}),c}link(i,c){let m=[],p=[];const h=[],r=[];i instanceof Array?m=i:m=[i],c instanceof Array?p=c:p=[c];for(let y=0;y<m.length;y++){const v=m[y];if(typeof v=="string"){const x=this.getNode(v);if(!x)throw Error(`cannot link input node named ${v} since it doesn't exist in graph`);h.push(x)}else h.push(v)}for(let y=0;y<p.length;y++){const v=p[y];if(typeof v=="string"){const x=this.getNode(v);if(!x)throw Error(`cannot link output node named ${v} since it doesn't exist in graph`);r.push(x)}else r.push(v)}const g=[];return h.forEach(y=>{r.forEach(v=>{if(this.willCreateCycle(y,v))throw Error(`cannot link ${y.name} to ${v.name} since it would create a cycle`);g.push(this.createEdge().link(y,v))})}),g}descendants(i){if(!i.length)return new Set;const c=new Set(o(i)?i.map(m=>this.nodes[m]).filter(m=>m!==void 0):i);return this.descendantsRecursive(c)}descendantsRecursive(i,c=new Set){for(const m of i){const p=new Set;for(const{inputNode:h}of m.inputEdges)h&&!c.has(h)&&(c.add(h),p.add(h));this.descendantsRecursive(p,c)}return c}willCreateCycle(i,c){if(i===c)return!0;const m=new Set,p=[c];for(;p.length;){const h=p.pop();if(h===i)return!0;m.add(h);for(const r of h.outputEdges){const g=r.outputNode;g&&!m.has(g)&&p.push(g)}}return!1}createEdge(){return new n}getNode(i){return this.nodes[i]}}const l=d=>{Object.keys(d.nodes).forEach(i=>{const c=d.nodes[i];let m=c.outputEdges.map(h=>h.outputNode?.name).join(", ");m||(m="<none>");let p=c.inputEdges.map(h=>h.inputNode?.name).join(", ");p||(p="<none>"),console.log(`${c.name}:
 - links to:   ${m}
 - links from: ${p}`)})};function o(d){return d.length>0&&typeof d[0]=="string"}},47797:(Z,R,e)=>{"use strict";e.d(R,{do:()=>s,ee:()=>o,q6:()=>a,rE:()=>l});var n=e(68143);function a(d){if(typeof d=="string")return d;if(d){if(d instanceof Error)return d.message;if((0,n.NF)(d)){if(d.data&&d.data.message)return d.data.message;if(d.statusText)return d.statusText}else if(d.hasOwnProperty("message"))return d.message}return JSON.stringify(d)}function s(d){if(typeof d!="string"&&d){if(d instanceof Error)return;if((0,n.NF)(d))return d.status;if(d.hasOwnProperty("status"))return d.status}}function l(d){if(typeof d!="string"&&d){if(d instanceof Error)return;if((0,n.NF)(d))return d.data?.messageId;if(d.hasOwnProperty("messageId"))return d.messageId}}function o(d){const i=d.config?.method??"GET",c=d.config?.url;return i&&c?`${i} ${c}`:"request"}},62635:(Z,R,e)=>{"use strict";e.d(R,{HQ:()=>b,Ll:()=>W,MA:()=>I,WP:()=>v,Xe:()=>C,_u:()=>U,bI:()=>T,dY:()=>M,di:()=>S,dr:()=>E,eF:()=>B,o$:()=>D,uE:()=>A,uJ:()=>V,uq:()=>P,w4:()=>O,zT:()=>N,zq:()=>L});var n=e(43561),a=e(24726),s=e(739),l=e(83175),o=e(92138),d=e(1906),i=e(22592),c=e(39796),m=e(17548),p=e(78282),h=e(90811),r=e(29043),g=e(4651);const y={dedupStrategy:s.fY.none},v="0123456789abcdefghijklmnopqrstuvwxyz",x=(0,n.d_)(v,3),f="grafana.explore.datasource",u=K=>`${f}.${K}`,b=K=>r.A.getObject(u(K)),E=(K,G)=>r.A.setObject(u(K),G);function D(){for(;;){const K=x(3);if(!/^\d+$/.test(K))return K}}async function C(K){const{queries:G,dsRef:H,timeRange:_,scopedVars:k,adhocFilters:J}=K,z=(await Promise.allSettled(G.filter(X=>X.datasource?.uid!==g.Uj).map(async X=>{const Q=await(0,p.l)().get(X.datasource||H);return{...Q.interpolateVariablesInQueries?.([X],k??{},J)[0]||X,...!Q.meta.mixed&&{datasource:Q.getRef()}}}))).filter(X=>X.status==="fulfilled").map(X=>X.value),Y=JSON.stringify({[D()]:{range:(0,l.sQ)(_.raw),queries:z,datasource:H?.uid}});return o.I.assureBaseUrl(l.kM.renderUrl("/explore",{panes:Y,schemaVersion:1}))}function P(K){return`explore_${K}`}function T(K,G,H,_,k,J,z){const Y=Number.parseInt(K,36),{interval:X,intervalMs:Q}=F(_,H.minInterval,H.maxDataPoints),q={app:d.Jk.Explore,timezone:J||i.lE,startTime:Date.now(),interval:X,intervalMs:Q,panelId:Y,targets:G,range:_,requestId:P(K),rangeRaw:_.raw,scopedVars:{__interval:{text:X,value:X},__interval_ms:{text:Q,value:Q},...z},maxDataPoints:H.maxDataPoints,liveStreaming:H.liveStreaming,skipQueryCache:!0};return{queries:G,request:q,scanning:k,id:j(),done:!1}}const O=({key:K,...G})=>G,I=(K,G)=>{if(K==null)return"";try{return JSON.stringify(K,null,G)}catch(H){console.error(H)}return""};function j(K=0){return`Q-${(0,a.A)()}-${K}`}async function W(K,G=0,H){let _,k,J;return H?k=H:K.length>0&&K[K.length-1].datasource?k=K[K.length-1].datasource:(_=await(0,p.l)().get(),J=_.getDefaultQuery?.(d.Jk.Explore),k=_.getRef()),_||(_=await(0,p.l)().get(k),J=_.getDefaultQuery?.(d.Jk.Explore)),{...J,refId:(0,c.M)(K),key:j(G),datasource:k}}const B=(K,G,H=0)=>{const _=j(H),k=K.refId||(0,c.M)(G);return{...K,refId:k,key:_}};async function S(K,G){if(K&&typeof K=="object"&&K.length>0){const H=[];for(let _=0;_<K.length;_++){const k=K[_],J=j(_);let z=k.refId;z||(z=(0,c.M)(H));let Y=!0;if(k.datasource)try{await(0,p.l)().get(k.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),Y=!1}Y&&H.push({...k,refId:z,key:J})}return H}try{const H=G??(await(0,p.l)().get()).getRef();return[await W(K??[],void 0,H)]}catch{return[]}}const w=["refId","key","context","datasource"];function N(K){return K&&K.some(G=>Object.entries(G).filter(([_,k])=>w.indexOf(_)===-1).filter(([_,k])=>k).length>0)}const M=K=>K.reduce((H,_,k)=>{const J=_.datasource?.uid||_.key;return H.concat(`${J}-${k}`)},[]),L=(K,G,H)=>m.convertRawToRange(G,K,H),A=K=>h.cC.isLive(K)?s.uH.Ascending:s.uH.Descending,U=K=>{K&&K.unsubscribe()};function F(K,G,H){return H?m.calculateInterval(K,H,G):{interval:"1s",intervalMs:1e3}}const V=K=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(K);else{const G=document.createElement("textarea");G.value=K,document.body.appendChild(G),G.select(),document.execCommand("copy"),document.body.removeChild(G)}}},77197:(Z,R,e)=>{"use strict";e.d(R,{A:()=>i});var n=e(37615),a=e(8934),s=e(17548),l=e(55386);const d={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:c=>((0,n.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,a.$f)(c)),roundInterval:c=>((0,n.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),s.roundInterval(c)),secondsToHms:c=>((0,n.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),s.secondsToHms(c)),secondsToHhmmss:c=>{const m=[],p=Math.floor(c/3600),h=Math.floor(c%3600/60),r=Math.floor(c%3600%60);return p>9?m.push(""+p):m.push("0"+p),h>9?m.push(""+h):m.push("0"+h),r>9?m.push(""+r):m.push("0"+r),m.join(":")},toPercent:(c,m)=>Math.floor(c/m*1e4)/100+"%",addSlashes:c=>c.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:c=>((0,n.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),s.describeInterval(c)),intervalToSeconds:c=>((0,n.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),s.intervalToSeconds(c)),intervalToMs:c=>((0,n.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),s.intervalToMs(c)),calculateInterval:(c,m,p)=>((0,n.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),s.calculateInterval(c,m,p)),queryColorDot:(c,m)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+c,"font-size:"+m+"px"].join(";")+'"></div>',slugifyForUrl:c=>c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:c=>((0,n.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,a.dO)(c)),toFixed:(c,m)=>{if(c===null)return"";const p=m?Math.pow(10,Math.max(0,m)):1,h=String(Math.round(c*p)/p);if(h.indexOf("e")!==-1||c===0)return h;if(m!=null){const r=h.indexOf("."),g=r===-1?0:h.length-r-1;if(g<m)return(g?h:h+".")+String(p).slice(1,m-g+1)}return h},toFixedScaled:(c,m,p,h,r)=>p===null?d.toFixed(c,m)+r:d.toFixed(c,p+h)+r,roundValue:(c,m)=>{if(c===null)return null;const p=Math.pow(10,m),h=(p*c).toFixed(m);return Math.round(parseFloat(h))/p},getUnitFormats:l.Ke};typeof Proxy<"u"?d.valueFormats=new Proxy(d.valueFormats,{get(c,m,p){if(typeof m!="string")throw{message:`Value format ${String(m)} is not a string`};const h=(0,l.j_)(m);return h?(r,g,y,v)=>(0,l.cN)(h(r,g,y,v?"utc":"browser")):Reflect.get(c,m,p)}}):d.valueFormats=(0,l.uH)();const i=d},60017:(Z,R,e)=>{"use strict";e.d(R,{j:()=>a,z:()=>s});var n=e(78731);function a(l){if(!(!performance||!performance.mark))try{performance.mark(`${l}_started`)}catch(o){console.error(`[Metrics] Failed to startMeasure ${l}`,o)}}function s(l){if(!(!performance||!performance.mark))try{const o=`${l}_started`,d=`${l}_completed`,i=`${l}_measured`;performance.mark(d);const c=performance.measure(i,o,d);return(0,n.n)(`${l}_ms`,c.duration),performance.clearMarks(o),performance.clearMarks(d),performance.clearMeasures(i),c}catch(o){console.error(`[Metrics] Failed to stopMeasure ${l}`,o);return}}},18832:(Z,R,e)=>{"use strict";e.d(R,{C:()=>s,o:()=>l});var n=e(92745),a=e(43173);function s(o){switch(o){case"home":return(0,n.t)("nav.home.title","Home");case"home-setup-guide":return(0,n.t)("nav.setup-guide.title","Getting started guide");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return a.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.title","Shared dashboards"):(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"drilldown":return(0,n.t)("nav.drilldown.title","Drilldown");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"alerts/recently-deleted":return(0,n.t)("nav.alerts-recently-deleted.title","Recently deleted");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","More apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","AI & machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-dbo11y-app":return(0,n.t)("nav.databases.title","Databases");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function l(o){switch(o){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards and panels");case"dashboards/public":return a.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.subtitle","Manage your organization's externally shared dashboards"):void 0;case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations and enable receiving Grafana-managed alerts");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"alerts/recently-deleted":return(0,n.t)("nav.alerts-recently-deleted.subtitle","See recently deleted alert rules");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"groupsync":return(0,n.t)("nav.groupsync.subtitle","Manage mappings of Identity Provider groups to Grafana Roles");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy resources from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.subtitle","Explore AI and machine learning features");default:return}}},10605:(Z,R,e)=>{"use strict";e.d(R,{v:()=>s});var n=e(2543),a=e.n(n);function s(l,o){return(0,n.isArray)(l)?l.map(d=>s(d,o)):(0,n.isPlainObject)(l)?Object.keys(l).sort().reduce((d,i)=>{const c=l[i];return c!=null&&(d[i]=s(c,o)),o&&(c===1/0||c===-1/0)&&(d[i]=0),d},{}):l}},1404:(Z,R,e)=>{"use strict";e.d(R,{Ih:()=>a,Lr:()=>o,U7:()=>s,dr:()=>l,fE:()=>d});var n=e(39796);function a(i){const c=["refId","hide","key","queryType","datasource"];for(const m in i)if(m!=="label"&&!c.includes(m))return!1;return!0}function s(i,c,m){const p={...c,refId:(0,n.M)(i),hide:!1};return!p.datasource&&m&&(p.datasource=m),[...i,p]}function l(i){return i.indexOf("api/datasources/proxy")!==-1||i.indexOf("api/ds/query")!==-1}function o(i){return!i.match(/^http/)}function d(i){return i||void 0}},81970:(Z,R,e)=>{"use strict";e.d(R,{Ax:()=>W,DI:()=>x,Gx:()=>u,IA:()=>T,NC:()=>C,TR:()=>S,U3:()=>P,X1:()=>b,cX:()=>D,ev:()=>I,l0:()=>v,oU:()=>E,rs:()=>f,x8:()=>B,xB:()=>y.x});var n=e(2543),a=e.n(n),s=e(83175),l=e(80011),o=e(92745),d=e(78282),i=e(6890),c=e(64762),m=e(8535),p=e(72054),h=e(68126),r=e(53222),g=e(15130),y=e(80977);async function v(N){const{queries:M,localOverride:L,datasource:A,starred:U,comment:F,showNotif:V}=N,K=V?.quotaExceededError??!0,G=V?.limitExceededWarning??!0,H=V?.otherErrors??!0,_=M&&M.filter(k=>w(k));if(_.length>0){let k=!1,J=!1,z;try{z=(await(L?(0,r.tU)():(0,r.a)()).addToRichHistory({datasourceUid:A.uid,datasourceName:A.name??"",queries:_,starred:U,comment:F??""})).warning}catch(Y){return Y instanceof Error&&(Y.name===p.m.StorageFull?(k=!0,K&&(0,m.JD)((0,i.dx)((0,c.gi)(Y.message)))):H&&Y.name!==p.m.DuplicatedEntry&&(0,m.JD)((0,i.dx)((0,c.gi)((0,o.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),Y.message)))),{richHistoryStorageFull:k,limitExceeded:J}}return z&&z.type===p.C.LimitExceeded&&(J=!0,G&&(0,m.JD)((0,i.dx)((0,c.q8)(z.message)))),{richHistoryStorageFull:k,limitExceeded:J}}return{}}async function x(N){const M={...N,from:N.to===void 0?N.to:(0,h.wQ)(N.to,{isLastTs:!0,tz:g.TP.user?.timezone}),to:N.from===void 0?N.from:(0,h.wQ)(N.from,{isLastTs:!0,tz:g.TP.user?.timezone})};return await(0,r.a)().getRichHistory(M)}async function f(N){await(0,r.a)().updateSettings(N)}async function u(){return await(0,r.a)().getSettings()}async function b(){return(0,r.a)().deleteAll()}async function E(N,M){try{return await(0,r.a)().updateStarred(N,M)}catch(L){L instanceof Error&&(0,m.JD)((0,i.dx)((0,c.gi)((0,o.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),L.message)));return}}async function D(N,M){try{return await(0,r.a)().updateComment(N,M)}catch(L){L instanceof Error&&(0,m.JD)((0,i.dx)((0,c.gi)((0,o.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),L.message)));return}}async function C(N){try{return await(0,r.a)().deleteRichHistory(N),N}catch(M){M instanceof Error&&(0,m.JD)((0,i.dx)((0,c.gi)((0,o.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),M.message)));return}}const P=N=>{const M={range:{from:"now-1h",to:"now"},datasource:N.datasourceName,queries:N.queries},L=(0,s.Pp)(M),A=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return s.kM.renderUrl(`${A}/explore`,{left:L})},T=N=>{let M;switch(N){case 0:M=(0,o.t)("explore.rich-history-utils.today","today");break;case 1:M=(0,o.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:M=(0,o.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:M=(0,o.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:M=(0,o.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${N}`})}return M};function O(N){return(0,l.LE)(N,{format:"MMMM D"})}function I(N){const M=(0,n.omit)(N,["key","refId","datasource"]);return JSON.stringify(M)}function j(N,M){let L="";return M===y.x.DatasourceAZ||M===y.x.DatasourceZA?L=N.datasourceName:L=O(N.createdAt),L}function W(N,M){return M?.getQueryDisplayText?M.getQueryDisplayText(N):I(N)}function B(N,M){let L={};return N.forEach(A=>{let U=j(A,M);U in L?L[U]=[...L[U],A]:L[U]=[A]}),L}function S(){return(0,d.l)().getList({mixed:!0}).map(N=>({name:N.name,uid:N.uid}))}function w(N){const M=(0,n.omit)(N,["key","refId","datasource"]);return Object.keys(M).length>0}},80977:(Z,R,e)=>{"use strict";e.d(R,{x:()=>n});var n=(a=>(a.Descending="Descending",a.Ascending="Ascending",a.DatasourceAZ="Datasource A-Z",a.DatasourceZA="Datasource Z-A",a))(n||{})},71673:(Z,R,e)=>{"use strict";e.d(R,{$l:()=>u,Sp:()=>x,VN:()=>f,VP:()=>v,fn:()=>y,sU:()=>E});var n=e(41811),a=e(92745),s=e(43173),l=e(68143),o=e(36490),d=e(36674),i=e(6890),c=e(64762),m=e(52043),p=e(8535),h=e(62635);function r(){return`${window.location.protocol}//${window.location.host}${s.$.appSubUrl}`}function g(D){let C=D.replace(r(),"");return C.startsWith("/")?C.substring(1,C.length):C}const y=(0,n.default)(async function(D){try{return(await(0,l.AI)().post("/api/short-urls",{path:g(D)})).url}catch(C){console.error("Error when creating shortened link: ",C),(0,p.JD)((0,i.dx)((0,c.gi)("Error generating shortened link")))}}),v=async D=>{const C=await y(D);C?((0,h.uJ)(C),(0,p.JD)((0,i.dx)((0,c.tZ)("Shortened link copied to clipboard")))):(0,p.JD)((0,i.dx)((0,c.gi)("Error generating shortened link")))},x=async(D,C,P)=>{const T=f(D,C,P);if(C.useShortUrl)return await v(T);(0,h.uJ)(T),(0,p.JD)((0,i.dx)((0,c.tZ)((0,a.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},f=(D,C,P)=>{const T=o.Ny.getLocation(),O=d.jh.getTimeRange(P??D),I=u(C,O,P);return(0,m.u)({uid:D.state.uid,slug:D.state.meta.slug,currentQueryParams:T.search,updateQuery:I,absolute:!C.useShortUrl})},u=(D,C,P)=>{const T={};return P&&(T.viewPanel=P.state.key),D.useAbsoluteTimeRange&&(T.from=C.state.value.from.toISOString(),T.to=C.state.value.to.toISOString()),D.theme!=="current"&&(T.theme=D.theme),T};function b(D,C){for(let P=C.indexOf(D)-1;P>=0;P--)if(C[P].timeEpochMs>D.timeEpochMs)return C[P];return null}function E(D,C,P){const T={from:new Date(P.from).toISOString(),to:new Date(P.to).toISOString()};if(!s.$.featureToggles.logsInfiniteScrolling)return T;const O=C.filter(j=>j.dataFrame.refId===D.dataFrame.refId),I=b(D,O);return D.timeEpochMs>P.to&&!I?{from:new Date(P.from).toISOString(),to:new Date(D.timeEpochMs+1).toISOString()}:{from:new Date(P.from).toISOString(),to:new Date(I?I.timeEpochMs:P.to).toISOString()}}},23237:(Z,R,e)=>{"use strict";e.d(R,{Wb:()=>a,Zk:()=>s,zG:()=>l});var n=e(25229);const a=(o,d)=>{const i={from:(0,n.yT)(d.from),to:(0,n.yT)(d.to)},c=(i.to.valueOf()-i.from.valueOf())/2;let m,p;return o===-1?(m=i.to.valueOf()-c,p=i.from.valueOf()-c):o===1?(m=i.to.valueOf()+c,p=i.from.valueOf()+c,m>Date.now()&&i.to.valueOf()<Date.now()&&(m=Date.now(),p=i.from.valueOf())):(m=i.to.valueOf(),p=i.from.valueOf()),{from:p,to:m}},s=(o,d)=>{const i=o.to.valueOf()-o.from.valueOf(),c=o.to.valueOf()-i/2,m=i===0?3e4:i*d,p=c+m/2;return{from:c-m/2,to:p}};async function l(){const o=await navigator.clipboard.readText();let d;try{return d=JSON.parse(o),!d.from||!d.to?{range:o,isError:!0}:{range:d,isError:!1}}catch{return{range:o,isError:!0}}}},65556:(Z,R,e)=>{"use strict";e.d(R,{r:()=>a});let n="";const a=()=>{const l=new URLSearchParams(window.location.search).get("auth_token");return l!==null&&l!==""?(n=l,l):n}},68555:(Z,R,e)=>{"use strict";e.d(R,{TO:()=>c,cd:()=>m});var n=e(29043),a=e(64762),s=e(69738),l=e(96221);const o="grafana.dev.mockApi",d=()=>n.A.getBool(o,!1),i=()=>{const h=d();store.set(o,String(!h));const r=h?"Disabling":"Enabling";sendAppNotification(`${r} Mock API`,"Reloading...",AppNotificationSeverity.Info),setTimeout(()=>{window.location.reload()},200)},c=async()=>{const h=d()},m=()=>{},p=async()=>{const h=new PreferencesService("user"),r=await h.load(),g=r.language===PSEUDO_LOCALE,y=g?"Disabling":"Enabling";sendAppNotification(`${y} pseudo locale`,"Reloading...",AppNotificationSeverity.Info),await h.update({...r,language:g?DEFAULT_LANGUAGE:PSEUDO_LOCALE}),setTimeout(()=>{window.location.reload()},200)}},55320:(Z,R,e)=>{"use strict";e.d(R,{l:()=>d});var n=e(74848),a=e(22803),s=e(67458),l=e(63142),o=e(31286);function d({message:c,variant:m}){const p=(0,l.of)(i);return(0,n.jsx)(o.a,{display:"flex",backgroundColor:m,borderRadius:"default",paddingY:1,paddingX:2,alignItems:"stretch",children:(0,n.jsx)("div",{className:p.content,children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,s.G)(c)}})})})}function i(c){return{content:(0,a.css)({p:{margin:0},a:{color:c.colors.text.link}})}}},72728:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>s,Y:()=>l});var n=e(96540),a=e(28210);function s(o){const[d,i]=(0,a.KX)(),[c,m]=(0,a.so)();return[(0,n.useCallback)(h=>o?c({name:o,announcementBanner:{metadata:{name:o},spec:h}}):d({announcementBanner:{metadata:{generateName:"banner"},spec:h}}),[d,o,c]),o?m:i]}function l(){const o=(0,a.FF)({});return[o.data?.items?.slice().sort((i,c)=>Number(c.metadata?.resourceVersion)-Number(i.metadata?.resourceVersion))?.[0],o.isLoading]}},28210:(Z,R,e)=>{"use strict";e.d(R,{JU:()=>r,KX:()=>g,FF:()=>v,so:()=>y});var n=e(75816),a=e(73892),s=e(85618);const l=(0,s.TP)("banners.grafana.app","v0alpha1"),o=(0,n.xP)({reducerPath:"announcementBannerAPIv0alpha1",baseQuery:(0,a.W)({baseURL:l}),tagTypes:["AnnouncementBannerList"],endpoints:()=>({})}),d=["AnnouncementBanner"],i=o.enhanceEndpoints({addTagTypes:d}).injectEndpoints({endpoints:x=>({listAnnouncementBanner:x.query({query:f=>({url:"/announcement-banners",params:{pretty:f.pretty,allowWatchBookmarks:f.allowWatchBookmarks,continue:f.continue,fieldSelector:f.fieldSelector,labelSelector:f.labelSelector,limit:f.limit,resourceVersion:f.resourceVersion,resourceVersionMatch:f.resourceVersionMatch,sendInitialEvents:f.sendInitialEvents,timeoutSeconds:f.timeoutSeconds,watch:f.watch}}),providesTags:["AnnouncementBanner"]}),createAnnouncementBanner:x.mutation({query:f=>({url:"/announcement-banners",method:"POST",body:f.announcementBanner,params:{pretty:f.pretty,dryRun:f.dryRun,fieldManager:f.fieldManager,fieldValidation:f.fieldValidation}}),invalidatesTags:["AnnouncementBanner"]}),replaceAnnouncementBanner:x.mutation({query:f=>({url:`/announcement-banners/${f.name}`,method:"PUT",body:f.announcementBanner,params:{pretty:f.pretty,dryRun:f.dryRun,fieldManager:f.fieldManager,fieldValidation:f.fieldValidation}}),invalidatesTags:["AnnouncementBanner"]}),deleteAnnouncementBanner:x.mutation({query:f=>({url:`/announcement-banners/${f.name}`,method:"DELETE",params:{pretty:f.pretty,dryRun:f.dryRun,gracePeriodSeconds:f.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:f.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:f.orphanDependents,propagationPolicy:f.propagationPolicy}}),invalidatesTags:["AnnouncementBanner"]})}),overrideExisting:!1}),{useListAnnouncementBannerQuery:c,useCreateAnnouncementBannerMutation:m,useReplaceAnnouncementBannerMutation:p,useDeleteAnnouncementBannerMutation:h}=i,r=i.enhanceEndpoints({}),{useCreateAnnouncementBannerMutation:g,useReplaceAnnouncementBannerMutation:y,useListAnnouncementBannerQuery:v}=r},87373:(Z,R,e)=>{"use strict";e.d(R,{C:()=>s,t:()=>l});var n=e(75816),a=e(73892);const s="/api/reports",l=(0,n.xP)({baseQuery:(0,a.W)({baseURL:s}),reducerPath:"reportingAPI",endpoints:()=>({}),keepUnusedDataFor:30,refetchOnMountOrArgChange:!0,tagTypes:["Reports","Report","Settings"]})},68886:(Z,R,e)=>{"use strict";e.d(R,{B:()=>y,Bn:()=>x,QU:()=>m,TM:()=>v,Z9:()=>r,h_:()=>d,iJ:()=>g,lg:()=>c,qJ:()=>p,yi:()=>h,zh:()=>i});var n=e(6890),a=e(64762),s=e(9229),l=e(87373);const o=l.t.injectEndpoints({endpoints:f=>({getReports:f.query({query:()=>({url:"/",method:"GET",showErrorAlert:!0}),providesTags:["Reports"]}),getReportsByDashboard:f.query({query:u=>({url:`/dashboards/${u}`,method:"GET",showErrorAlert:!0}),providesTags:(u,b,E)=>[{type:"Reports",id:E}]}),getReport:f.query({query:u=>({url:`/${u}`,method:"GET",showErrorAlert:!0}),transformResponse:u=>(0,s.D0)(u),providesTags:(u,b,E)=>[{type:"Report",id:E}]}),createReport:f.mutation({query:u=>({url:"/",method:"POST",body:u,showErrorAlert:!0}),invalidatesTags:(u,b,E)=>b?[]:["Reports"]}),saveDraftReport:f.mutation({query:u=>({url:"/",method:"POST",body:u,showErrorAlert:!0}),invalidatesTags:(u,b,E)=>b?[]:["Reports"]}),updateReport:f.mutation({query:u=>({url:`/${u.id}`,method:"PUT",body:u,showErrorAlert:!0}),invalidatesTags:(u,b,E)=>b?[]:["Reports",{type:"Report",id:E.id}]}),updateStateReport:f.mutation({query:u=>({url:`/${u.id}`,method:"PUT",body:u,showErrorAlert:!0}),invalidatesTags:(u,b,E)=>b?[]:["Reports",{type:"Report",id:E.id}]}),deleteReport:f.mutation({query:u=>({url:`/${u}`,method:"DELETE"}),invalidatesTags:(u,b,E)=>b?[]:["Reports"]}),sendTestEmail:f.mutation({query:u=>({url:"/test-email/",method:"POST",body:u,showErrorAlert:!0})}),getSettings:f.query({query:()=>({url:"/settings",method:"GET",showErrorAlert:!0}),providesTags:["Settings"]}),saveSettings:f.mutation({queryFn:async(u,{dispatch:b,getState:E})=>{const D=new FormData;for(const[C,P]of Object.entries(u.branding))P instanceof File&&(u.branding={...u.branding,[C]:P.name},D.append("files",P));D.append("config",JSON.stringify(u));try{const C=await fetch(`${l.C}/settings`,{method:"POST",body:D});if(!C.ok){const T=await C.text();throw new Error(`HTTP ${C.status}: ${T}`)}const P=await C.json();return b((0,n.dx)((0,a.tZ)("Successfully saved configuration"))),{data:P}}catch(C){const P=C instanceof Error?C.message:"Unknown error";return b((0,n.dx)((0,a.gi)("Error saving configuration",P))),{error:P}}},invalidatesTags:(u,b,E)=>b?[]:["Settings"]})})}),{useCreateReportMutation:d,useSaveDraftReportMutation:i,useSendTestEmailMutation:c,useGetReportsByDashboardQuery:m,useGetReportQuery:p,useUpdateReportMutation:h,useUpdateStateReportMutation:r,useDeleteReportMutation:g,useGetReportsQuery:y,useGetSettingsQuery:v,useSaveSettingsMutation:x}=o},86224:(Z,R,e)=>{"use strict";e.d(R,{C1:()=>a,EA:()=>s,Hp:()=>o,QH:()=>l});var n=e(43173);const a="/admin/authentication/saml",s=n.$.appUrl+"saml/metadata",l=n.$.appUrl+"saml/acs",o=n.$.appUrl+"saml/slo"},55742:(Z,R,e)=>{"use strict";e.d(R,{$$:()=>h,Nh:()=>C,OG:()=>b,Pr:()=>d,SH:()=>P,XN:()=>g,ZC:()=>D,Zt:()=>y,cD:()=>p,eO:()=>m,jA:()=>i,mA:()=>x,tC:()=>E,w4:()=>r,wj:()=>u,y6:()=>O});var n=e(65307),a=e(69788);const s={assertionAttributeName:"displayName",assertionAttributeLogin:"mail",assertionAttributeEmail:"mail"},l={storedSamlSettings:{},samlSettings:{},samlStep:1,activeStep:a.SAMLStepKey.General,signRequests:!1,keyCertValueType:"base64",keyConfigured:!1,certConfigured:!1,metadataValueType:"url",configChanged:!1,showSavedBadge:!1,visitedSteps:[],isUpdated:!1,isLoading:!1,configFoundInIniFile:!1},o=(0,n.Z0)({name:"samlConfig",initialState:l,reducers:{settingsLoaded:(I,j)=>({...I,samlSettings:j.payload,configChanged:!1,isLoading:!1}),setStoredSAMLSettings:(I,j)=>({...I,storedSamlSettings:j.payload}),setConfigFoundInIniFile:(I,j)=>({...I,configFoundInIniFile:j.payload}),settingsUpdated:(I,j)=>({...I,samlSettings:j.payload,configChanged:!0}),settingsLoadingBegin:I=>({...I,isLoading:!0}),settingsLoadingEnd:I=>({...I,isLoading:!1}),samlStepChanged:(I,j)=>({...I,samlStep:j.payload}),setSignRequests:(I,j)=>({...I,signRequests:j.payload}),setKeyCertValueType:(I,j)=>({...I,keyCertValueType:j.payload}),setKeyConfigured:(I,j)=>({...I,keyConfigured:j.payload}),setCertConfigured:(I,j)=>({...I,certConfigured:j.payload}),setMetadataValueType:(I,j)=>({...I,metadataValueType:j.payload}),settingsChanged:(I,j)=>({...I,configChanged:j.payload}),setError:(I,j)=>({...I,error:j.payload}),resetError:I=>({...I,error:void 0}),setShowSavedBadge:(I,j)=>({...I,showSavedBadge:j.payload}),addVisitedStep:(I,j)=>({...I,visitedSteps:[...I.visitedSteps,...j.payload]}),clearSAMLState:I=>({...I,isUpdated:!1,visitedSteps:[]})}}),{settingsLoaded:d,settingsUpdated:i,samlStepChanged:c,setStoredSAMLSettings:m,setSignRequests:p,setKeyCertValueType:h,setKeyConfigured:r,setCertConfigured:g,setMetadataValueType:y,settingsChanged:v,setShowSavedBadge:x,setConfigFoundInIniFile:f,addVisitedStep:u,clearSAMLState:b,settingsLoadingBegin:E,settingsLoadingEnd:D,setError:C,resetError:P}=o.actions,O={samlConfig:o.reducer}},63671:(Z,R,e)=>{"use strict";e.d(R,{Bw:()=>v,DC:()=>D,aG:()=>r,iZ:()=>u,rC:()=>m});var n=e(43173),a=e(68143),s=e(73427),l=e(35991),o=e(11257),d=e(55742),i=e(29223);const c=()=>n.$.featureToggles?.ssoSettingsSAML;async function m(){return c()?h():p()}async function p(){const j=(await(0,a.AI)().get("/api/admin/settings"))["auth.saml"]||{};return[(0,i.Af)(j),j]}async function h(){const I=await(0,a.AI)().get("/api/v1/sso-settings/saml"),j=I?I.settings:{},W=T(j);return[j,W]}function r(I,j){if(c()){const W=O(I);return y(W)}else return g(I,j)}function g(I,j){const W=(0,i.wD)(I);if(W.updates){const B=(0,i.Pd)(W.updates["auth.saml"],j);W.updates["auth.saml"]=B}return(0,l.DZ)(W)}function y(I){return async j=>{if(s.TP.hasPermission(o.w.SettingsWrite))try{return await(0,a.AI)().put("/api/v1/sso-settings/saml",{provider:"saml",settings:{...I}},{showErrorAlert:!1}),j((0,d.SH)()),!0}catch(W){if((0,a.NF)(W)){W.isHandled=!0;const B={message:W.data?.message,errors:W.data?.errors};return j((0,d.Nh)(B)),!1}}return!1}}function v(){return c()?x():f()}function x(){return async I=>{if(s.TP.hasPermission(o.w.SettingsWrite))try{return await(0,a.AI)().delete("/api/v1/sso-settings/saml",void 0,{showSuccessAlert:!1,showErrorAlert:!1}),I((0,d.SH)()),!0}catch(j){if((0,a.NF)(j)){j.isHandled=!0;const W={message:j.data?.message,errors:j.data?.errors};return I((0,d.Nh)(W)),!1}}return!1}}function f(){const I={removals:{"auth.saml":["enabled","name","single_logout","allow_sign_up","auto_login","certificate","certificate_path","private_key","private_key_path","signature_algorithm","idp_metadata","idp_metadata_path","idp_metadata_url","max_issue_delay","metadata_valid_duration","allow_idp_initiated","relay_state","assertion_attribute_name","assertion_attribute_login","assertion_attribute_email","assertion_attribute_groups","assertion_attribute_role","assertion_attribute_org","allowed_organizations","org_mapping","role_values_none","role_values_viewer","role_values_editor","role_values_admin","role_values_grafana_admin","name_id_format","skip_org_role_sync","client_id","client_secret","token_url","force_use_graph_api","external_uid_assertion_name"]}};return(0,l.DZ)(I)}function u(I){return c()?b(I):E()}function b(I){return y({...I,enabled:!0})}function E(){const I={updates:{"auth.saml":{enabled:"true"}}};return(0,l.DZ)(I)}function D(I){return c()?C(I):P()}function C(I){return y({...I,enabled:!1})}function P(){const I={updates:{"auth.saml":{enabled:"false"}}};return(0,l.DZ)(I)}function T(I){return{enabled:I?.enabled?"true":"false",entityId:I?.entityId,name:I?.name,allow_sign_up:I?.allowSignUp?"true":"false",auto_login:I?.autoLogin?"true":"false",single_logout:I?.singleLogout?"true":"false",allow_idp_initiated:I?.allowIdpInitiated?"true":"false",skip_org_role_sync:I?.skipOrgRoleSync?"true":"false",private_key:I?.privateKey,private_key_path:I?.privateKeyPath,certificate:I?.certificate,certificate_path:I?.certificatePath,signature_algorithm:I?.signatureAlgorithm,idp_metadata:I?.idpMetadata,idp_metadata_path:I?.idpMetadataPath,idp_metadata_url:I?.idpMetadataUrl,max_issue_delay:I?.maxIssueDelay,metadata_valid_duration:I?.metadataValidDuration,relay_state:I?.relayState,assertion_attribute_name:I?.assertionAttributeName,assertion_attribute_login:I?.assertionAttributeLogin,assertion_attribute_email:I?.assertionAttributeEmail,assertion_attribute_groups:I?.assertionAttributeGroups,assertion_attribute_role:I?.assertionAttributeRole,assertion_attribute_org:I?.assertionAttributeOrg,assertion_attribute_external_uid:I?.assertionAttributeExternalUid,allowed_organizations:I?.allowedOrganizations,org_mapping:I?.orgMapping,role_values_none:I?.roleValuesNone,role_values_viewer:I?.roleValuesViewer,role_values_editor:I?.roleValuesEditor,role_values_admin:I?.roleValuesAdmin,role_values_grafana_admin:I?.roleValuesGrafanaAdmin,name_id_format:I?.nameIdFormat,client_id:I?.clientId,client_secret:I?.clientSecret,token_url:I?.tokenUrl,force_use_graph_api:I?.forceUseGraphApi?"true":"false"}}function O(I){return{enabled:I?.enabled,entityId:I?.entityId,name:I?.name,allowSignUp:I?.allowSignUp,autoLogin:I?.autoLogin,singleLogout:I?.singleLogout,allowIdpInitiated:I?.allowIdpInitiated,skipOrgRoleSync:I?.skipOrgRoleSync,privateKey:I?.privateKey,privateKeyPath:I?.privateKeyPath,certificate:I?.certificate,certificatePath:I?.certificatePath,signatureAlgorithm:I?.signatureAlgorithm,idpMetadata:I?.idpMetadata,idpMetadataPath:I?.idpMetadataPath,idpMetadataUrl:I?.idpMetadataUrl,maxIssueDelay:I?.maxIssueDelay,metadataValidDuration:I?.metadataValidDuration,relayState:I?.relayState,assertionAttributeName:I?.assertionAttributeName,assertionAttributeLogin:I?.assertionAttributeLogin,assertionAttributeEmail:I?.assertionAttributeEmail,assertionAttributeGroups:I?.assertionAttributeGroups,assertionAttributeRole:I?.assertionAttributeRole,assertionAttributeOrg:I?.assertionAttributeOrg,assertionAttributeExternalUid:I?.assertionAttributeExternalUid,allowedOrganizations:I?.allowedOrganizations,orgMapping:I?.orgMapping,roleValuesNone:I?.roleValuesNone,roleValuesViewer:I?.roleValuesViewer,roleValuesEditor:I?.roleValuesEditor,roleValuesAdmin:I?.roleValuesAdmin,roleValuesGrafanaAdmin:I?.roleValuesGrafanaAdmin,nameIdFormat:I?.nameIdFormat,clientId:I?.clientId,clientSecret:I?.clientSecret,tokenUrl:I?.tokenUrl,forceUseGraphApi:I?.forceUseGraphApi}}},29223:(Z,R,e)=>{"use strict";e.d(R,{A8:()=>f,Af:()=>l,Do:()=>b,H:()=>u,Pd:()=>p,nj:()=>v,wD:()=>m});var n=e(2543),a=e.n(n),s=e(86224);function l(E){return{enabled:o(E.enabled),entityId:d(E.entity_id),allowSignUp:o(E.allow_sign_up),autoLogin:o(E.auto_login),singleLogout:o(E.single_logout),allowIdpInitiated:o(E.allow_idp_initiated),skipOrgRoleSync:o(E.skip_org_role_sync),name:d(E.name),privateKey:d(E.private_key),privateKeyPath:d(E.private_key_path),certificate:d(E.certificate),certificatePath:d(E.certificate_path),signatureAlgorithm:d(E.signature_algorithm),idpMetadata:d(E.idp_metadata),idpMetadataPath:d(E.idp_metadata_path),idpMetadataUrl:d(E.idp_metadata_url),maxIssueDelay:d(E.max_issue_delay),metadataValidDuration:d(E.metadata_valid_duration),relayState:d(E.relay_state),assertionAttributeName:d(E.assertion_attribute_name),assertionAttributeLogin:d(E.assertion_attribute_login),assertionAttributeEmail:d(E.assertion_attribute_email),assertionAttributeGroups:d(E.assertion_attribute_groups),assertionAttributeRole:d(E.assertion_attribute_role),assertionAttributeOrg:d(E.assertion_attribute_org),assertionAttributeExternalUid:d(E.assertion_attribute_external_uid),allowedOrganizations:d(E.allowed_organizations),orgMapping:d(E.org_mapping),roleValuesNone:d(E.role_values_none),roleValuesViewer:d(E.role_values_viewer),roleValuesEditor:d(E.role_values_editor),roleValuesAdmin:d(E.role_values_admin),roleValuesGrafanaAdmin:d(E.role_values_grafana_admin),nameIdFormat:d(E.name_id_format),clientId:d(E.client_id),clientSecret:d(E.client_secret),tokenUrl:d(E.token_url),forceUseGraphApi:o(E.force_use_graph_api)}}function o(E){return E==="true"}function d(E){return E||""}function i(E){return E?"true":"false"}function c(E){return{enabled:i(E.enabled),entityId:d(E.entityId),allow_sign_up:i(E.allowSignUp),auto_login:i(E.autoLogin),single_logout:i(E.singleLogout),allow_idp_initiated:i(E.allowIdpInitiated),skip_org_role_sync:i(E.skipOrgRoleSync),name:d(E.name),private_key:d(E.privateKey),private_key_path:d(E.privateKeyPath),certificate:d(E.certificate),certificate_path:d(E.certificatePath),signature_algorithm:d(E.signatureAlgorithm),idp_metadata:d(E.idpMetadata),idp_metadata_path:d(E.idpMetadataPath),idp_metadata_url:d(E.idpMetadataUrl),max_issue_delay:d(E.maxIssueDelay),metadata_valid_duration:d(E.metadataValidDuration),relay_state:d(E.relayState),assertion_attribute_name:d(E.assertionAttributeName),assertion_attribute_login:d(E.assertionAttributeLogin),assertion_attribute_email:d(E.assertionAttributeEmail),assertion_attribute_groups:d(E.assertionAttributeGroups),assertion_attribute_role:d(E.assertionAttributeRole),assertion_attribute_org:d(E.assertionAttributeOrg),assertion_attribute_external_uid:d(E.assertionAttributeExternalUid),allowed_organizations:d(E.allowedOrganizations),org_mapping:d(E.orgMapping),role_values_none:d(E.roleValuesNone),role_values_viewer:d(E.roleValuesViewer),role_values_editor:d(E.roleValuesEditor),role_values_admin:d(E.roleValuesAdmin),role_values_grafana_admin:d(E.roleValuesGrafanaAdmin),name_id_format:d(E.nameIdFormat),client_id:d(E.clientId),client_secret:d(E.clientSecret),token_url:d(E.tokenUrl),force_use_graph_api:i(E.forceUseGraphApi)}}function m(E){const{keyCertValueType:D,metadataValueType:C,signRequests:P}=E,{certificate_path:T,private_key_path:O,certificate:I,private_key:j,idp_metadata_url:W,idp_metadata_path:B,idp_metadata:S,...w}=c(E),N={updates:{"auth.saml":w},removals:{"auth.saml":[]}};return D==="path"?(O&&!x(O)&&(N.updates["auth.saml"].private_key_path=O,N.updates["auth.saml"].private_key=""),T&&!x(T)&&(N.updates["auth.saml"].certificate_path=T,N.updates["auth.saml"].certificate="")):D==="base64"&&(j&&!x(j)&&(N.updates["auth.saml"].private_key=j,N.updates["auth.saml"].private_key_path=""),I&&!x(I)&&(N.updates["auth.saml"].certificate=I,N.updates["auth.saml"].certificate_path="")),P||(N.updates["auth.saml"].signature_algorithm=""),C==="url"?(N.updates["auth.saml"].idp_metadata_url=W,N.updates["auth.saml"].idp_metadata_path="",N.updates["auth.saml"].idp_metadata=""):C==="path"?(N.updates["auth.saml"].idp_metadata_path=B,N.updates["auth.saml"].idp_metadata_url="",N.updates["auth.saml"].idp_metadata=""):C==="base64"&&(N.updates["auth.saml"].idp_metadata=S,N.updates["auth.saml"].idp_metadata_url="",N.updates["auth.saml"].idp_metadata_path=""),N}function p(E,D){const C={};return Object.keys(E).forEach(P=>{E[P]!==D[P]&&(C[P]=E[P])}),C}function h(E){const D=E?.split(/[,\s]/),C=[];return D?.forEach(P=>{const T=P.split(":");if(T.length===3){const O=g(T[2]);O&&C.push({externalOrg:T[0],orgId:T[1],role:O})}}),C}function r(E){return E.map(C=>`${C.externalOrg}:${C.orgId}:${C.role}`).join(",")}function g(E){return E==="Admin"||E==="Editor"||E==="Viewer"?E:null}const y={enabled:"false",skip_org_role_sync:"false"};function v(E){return(0,n.isEqual)(E,y)}function x(E){return E?/^\*+$/.test(E):!1}function f(E,D,C){switch(E){case"privateKey":return D[E]===C.private_key&&!!C.private_key;case"privateKeyPath":return D[E]===C.private_key_path&&!!C.private_key_path;case"certificate":return D[E]===C.certificate&&!!C.certificate;case"certificatePath":return D[E]===C.certificate_path&&!!C.certificate_path;default:return!1}}function u(E){return E.idpMetadataPath?"path":E.idpMetadata?"base64":"url"}const b=E=>`${s.C1}/${E||""}`},5792:(Z,R,e)=>{"use strict";e.d(R,{$b:()=>d,Q3:()=>a,W3:()=>i,gn:()=>c,lx:()=>l,wn:()=>o});var n=e(83873),a=(m=>(m.LoadDataSourceCache="LOAD_DATA_SOURCE_CACHE",m))(a||{});const s=m=>({type:"LOAD_DATA_SOURCE_CACHE",payload:m});function l(m){return async p=>{const h=await(0,n.AI)().post(`/api/datasources/${m}/cache/enable`,{});p(s(h))}}function o(m){return async p=>{const h=await(0,n.AI)().post(`/api/datasources/${m}/cache/disable`,{});p(s(h))}}function d(m,p){return async h=>{const r=await(0,n.AI)().post(`/api/datasources/${m}/cache`,p);h(s(r))}}function i(m){return async p=>{const h=await(0,n.AI)().get(`/api/datasources/${m}/cache`);p(s(h))}}function c(m){return async p=>{const h=await(0,n.AI)().post(`/api/datasources/${m}/cache/clean`,{});p(s(h))}}},6517:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{addExtensionReducers:()=>wi,init:()=>Vi});var n=e(96540),a=e(62061),s=e(43173),l=e(27489),o=e(73427),d=e(26437),i=e(24313),c=e(39799),m=e(67203),p=e(11257),h=e(82853),r=e(74848),g=e(92745),y=e(18857),v=e(30703);const x="licensedRole",f=({filters:ct,onChange:ft,className:Nt})=>{const tn=(0,n.useMemo)(()=>[{value:"server_admin",label:(0,g.t)("admin.role-filter.server-admin-option","Server admin")},{value:"admin_editor",label:(0,g.t)("admin.role-filter.admin-editor-option","Admin/editor")},{value:"viewer",label:(0,g.t)("admin.role-filter.viewer-option","Viewer")}],[]);return(0,r.jsx)(y.KF,{value:ct.find(mn=>mn.name===x)?.value,options:tn,onChange:mn=>{ft({name:x,value:mn})},prefix:(0,r.jsx)(v.I,{name:"filter"}),width:64,placeholder:(0,g.t)("admin.role-filter.multiselect-placeholder","Filter by licensed role"),menuShouldPortal:!0,className:Nt})},u=()=>{(0,h.jT)(f)};var b=e(36490),E=e(88486);function D(ct){return/(d-solo|dashboard-solo)/.test(ct?.toLowerCase())}function C(ct,ft){return!!ft.find(Nt=>Nt.id==="apps")?.children?.find(Nt=>Nt.id===`plugin-page-${ct}`)?.children?.some(Nt=>Nt.url?.endsWith(`/a/${ct}`))}var P=e(25229),T=e(55320),O=e(72728);function I(){const[ct]=(0,O.Y)(),{message:ft,variant:Nt,enabled:tn,endTime:mn,startTime:Dn,visibility:Rn}=ct?.spec||{message:"",variant:"info"},{isSignedIn:Kn}=o.TP.user,ra=(0,P.AN)().isBetween(Dn,mn,void 0,"[]");return!tn||!ra||!(Rn==="everyone"||Rn==="authenticated"&&Kn)?null:(0,r.jsx)(T.l,{message:ft,variant:Nt})}async function j(){o.TP.isSignedIn&&!D(b.Ny.getLocation().pathname)&&o.TP.user.authenticatedBy!=="render"&&(0,E.Pl)(I)}var W=e(28210),B=e(85618),S=e(6890),w=e(64762),N=e(75816),M=e(73892);const L=1e3,A=(0,B.TP)("querylibrary.grafana.app","v0alpha1"),U=(0,N.xP)({baseQuery:(0,M.W)({baseURL:A}),reducerPath:"queryLibraryAPIv0alpha1",endpoints:()=>({})}),F=["QueryTemplate"],V=U.enhanceEndpoints({addTagTypes:F}).injectEndpoints({endpoints:ct=>({listQueryTemplate:ct.query({query:ft=>({url:"/querytemplates",params:{pretty:ft.pretty,allowWatchBookmarks:ft.allowWatchBookmarks,continue:ft.continue,fieldSelector:ft.fieldSelector,labelSelector:ft.labelSelector,limit:ft.limit,resourceVersion:ft.resourceVersion,resourceVersionMatch:ft.resourceVersionMatch,sendInitialEvents:ft.sendInitialEvents,timeoutSeconds:ft.timeoutSeconds,watch:ft.watch}}),providesTags:["QueryTemplate"]}),createQueryTemplate:ct.mutation({query:ft=>({url:"/querytemplates",method:"POST",body:ft.queryTemplate,params:{pretty:ft.pretty,dryRun:ft.dryRun,fieldManager:ft.fieldManager,fieldValidation:ft.fieldValidation}}),invalidatesTags:["QueryTemplate"]}),deleteQueryTemplate:ct.mutation({query:ft=>({url:`/querytemplates/${ft.name}`,method:"DELETE",params:{pretty:ft.pretty,dryRun:ft.dryRun,gracePeriodSeconds:ft.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:ft.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:ft.orphanDependents,propagationPolicy:ft.propagationPolicy}}),invalidatesTags:["QueryTemplate"]}),updateQueryTemplate:ct.mutation({query:ft=>({url:`/querytemplates/${ft.name}`,method:"PATCH",body:ft.patch,params:{pretty:ft.pretty,dryRun:ft.dryRun,fieldManager:ft.fieldManager,fieldValidation:ft.fieldValidation,force:ft.force}}),invalidatesTags:["QueryTemplate"]})}),overrideExisting:!1}),K=V.enhanceEndpoints({endpoints:{listQueryTemplate:ct=>{const ft=ct.query;ft&&(ct.query=Nt=>ft({...Nt,limit:L}))},updateQueryTemplate:ct=>{const ft=ct.query;ft&&(ct.query=Nt=>({...ft(Nt),headers:{"Content-Type":"application/merge-patch+json"}})),ct.onQueryStarted=async(Nt,{queryFulfilled:tn,dispatch:mn})=>{try{await tn,mn((0,S.dx)((0,w.tZ)((0,g.t)("explore.query-library.query-template-edited","Query template successfully edited"))))}catch(Dn){(0,B.H4)(Dn,mn,(0,g.t)("explore.query-library.query-template-edit-error","Error attempting to edit this query"))}}}}}),{useCreateQueryTemplateMutation:G,useDeleteQueryTemplateMutation:H,useListQueryTemplateQuery:_,useUpdateQueryTemplateMutation:k}=K;var J=e(87373),z=e(69874),Y=e(29223),X=e(63671);function Q(){const ct={id:"saml",type:"SAML",protocol:"SAML 2.0",displayName:"SAML",configPath:"saml/general"};(0,z.registerAuthProvider)(ct,q)}async function q(){if(o.TP.hasPermission(p.w.SettingsRead)){const[ct,ft]=await(0,X.rC)(),Nt=(0,Y.nj)(ft),tn=Object.keys(ct).length===0||Object.keys(ft).length===0;return Nt?{configured:!1,enabled:!1,hide:tn}:{configured:!0,enabled:!!ct.enabled,name:ct.name,hide:tn}}return{configured:!1,enabled:!1}}var te=e(55742),ne=e(22803),se=e(63142),ue=e(76319),de=e(27963),ie=e(68388);class he extends ie.x{static{this.type="page-banner-display"}}var me=(ct=>(ct[ct.info=0]="info",ct[ct.warning=1]="warning",ct[ct.error=2]="error",ct))(me||{});function ce(){const[ct,ft]=(0,n.useState)(),Nt=Pe(ct?.severity),tn=(0,se.of)(ra=>Ie(ra,Nt)),{chrome:mn}=(0,de.Il)(),Dn=mn.useState();(0,n.useEffect)(function(){const ra=o.lE.subscribe(he,ca=>{Dn.chromeless||ft(ca.payload)});return function(){ra.unsubscribe()}},[Dn.chromeless]);const Rn=(0,n.useCallback)(()=>{ft(void 0),ct?.onClose&&ct.onClose()},[ct]);if(!ct)return null;const Kn=ct.body;return(0,r.jsxs)("div",{className:tn.banner,children:[(0,r.jsx)("div",{className:tn.icon,children:(0,r.jsx)(v.I,{size:"xl",name:Nt.icon})}),(0,r.jsx)("div",{className:tn.content,children:(0,r.jsx)(Kn,{severity:ct.severity??me.info})}),ct?.onClose&&(0,r.jsx)("div",{className:tn.icon,children:(0,r.jsx)(ue.K,{size:"xl",name:"times",onClick:Rn,className:tn.close,"aria-label":(0,g.t)("auth-config.page-banner.aria-label-close-banner","Close banner"),tooltip:(0,g.t)("auth-config.page-banner.tooltip-close","Close")})})]})}function Pe(ct){const ft=(0,se.$j)();return(0,n.useMemo)(()=>{switch(ct){case me.error:return{icon:"exclamation-circle",background:ft.colors.error.main,text:ft.colors.error.contrastText};case me.warning:return{icon:"exclamation-triangle",background:ft.colors.warning.main,text:ft.colors.warning.contrastText};case me.info:default:return{icon:"info-circle",background:ft.colors.info.main,text:ft.colors.info.contrastText}}},[ft,ct])}function Ie(ct,ft){return{banner:(0,ne.css)({flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",backgroundColor:ft.background,borderRadius:ct.shape.radius.default,height:"52px"}),icon:(0,ne.css)({padding:ct.spacing(0,2),color:ft.text,display:"flex"}),content:(0,ne.css)({flexGrow:1,display:"flex",alignItems:"center",color:ft.text}),close:(0,ne.css)({color:ft.text})}}function Se(){(0,E.Pl)(ce)}var Me=e(5792);const Te={enabled:!1,dataSourceID:0,dataSourceUID:"",ttlQueriesMs:0,ttlResourcesMs:0,defaultTTLMs:0,useDefaultTTL:!0},Qe={dataSourceCache:(ct=Te,ft)=>{switch(ft.type){case Me.Q3.LoadDataSourceCache:return{...ft.payload}}return ct}};var tt=e(7913),ke=e(78646),He=e(65642),Re=e(15130),Ne=e(71468),Ae=e(7895),Ue=e(8207),Be=e(2989),We=e(42939),_e=e(25157),Xe=e(69788),le=e(38082),ye=e(65307);const pe={isDrawerOpen:!1,drawerTab:Xe.AnalyticsTab.Stats},ve=(0,ye.Z0)({name:"metaAnalytics",initialState:pe,reducers:{setDrawerOpen:(ct,ft)=>({...ct,isDrawerOpen:ft.payload}),setDrawerTab:(ct,ft)=>({...ct,drawerTab:ft.payload})}}),{setDrawerOpen:be,setDrawerTab:Oe}=ve.actions,ze={metaAnalytics:ve.reducer};var Ve=e(54314),ge=e(60208),Ke=e(13941),qe=e(90256),ot=e(74740),lt=e(70713),mt=e(95004),Lt=e(64394),Tt=e(28105),It=e(60311),Mt=e(739),Ut=e(67522);class an extends n.PureComponent{convertSummariesToDataFrame(ft,Nt){const tn=[],mn=[];return Nt.forEach(Dn=>{tn.push((0,P.KQ)(Dn.day,qe.QH).valueOf()),mn.push(Dn[ft.name])}),{fields:[{name:"Time",type:mt.PU.time,config:{},values:tn},{name:ft.name,type:ft.type,config:{displayName:ft.label??ft.name,color:ft.color?{mode:Lt.Y.Fixed,fixedColor:ft.color}:void 0},values:mn}],length:Nt.length}}buildTimeRange(){const{dailySummaries:ft}=this.props,Nt=(0,P.KQ)(ft[0].day),tn=(0,P.KQ)(ft[ft.length-1].day).add(12,"hours");return{from:Nt,to:tn,raw:{from:Nt,to:tn}}}renderChart(ft){const{dailySummaries:Nt,theme:tn}=this.props,{timeRange:mn,showBars:Dn,title:Rn,width:Kn,fields:ra,isStacked:ca=!1}=ft,ba=(0,ot.k)(tn),Sa=ra.map(Ns=>this.convertSummariesToDataFrame(Ns,Nt)),cs={series:Sa,state:Tt.Gu.Done,timeRange:mn},fs={legend:{showLegend:Sa.length>1,displayMode:Mt.lm.List,placement:"bottom",calcs:[]},tooltip:{mode:Mt.$N.Multi,sort:Mt.xB.Descending}},Qa={defaults:{custom:{showPoints:Mt.yL.Never,drawStyle:Dn?Mt.GR.Bars:Mt.GR.Line,stacking:ca?{mode:Mt.gs.Normal}:void 0,fillOpacity:Dn?50:0}},overrides:[]};return(0,r.jsx)("div",{className:ba.graphContainer,children:(0,r.jsx)(Ut.NR,{title:Rn,width:Kn,height:220,displayMode:"transparent",loadingState:cs.state,children:(Ns,$s)=>(0,r.jsx)(It.m,{title:Rn,width:Ns,height:$s,pluginId:"timeseries",data:cs,fieldConfig:Qa,options:fs})})})}}class cn extends an{render(){const{dailySummaries:ft,theme:Nt}=this.props;if(ft&&ft.length>0){const tn=this.buildTimeRange();return(0,r.jsx)(lt.Ay,{disableHeight:!0,children:({width:mn})=>mn===0?null:(0,r.jsxs)("main",{style:{width:mn},children:[this.renderChart({title:(0,g.t)("meta-analytics.analytics-public-dashboards-tab.daily-query-count-title","Daily query count"),fields:[{name:"queries",type:mt.PU.number},{name:"cachedQueries",type:mt.PU.number,label:(0,g.t)("meta-analytics.analytics-public-dashboards-tab.daily-query-count-cached-queries-label","cached queries")}],width:mn,timeRange:tn,showBars:!1,showLines:!0}),this.renderChart({title:(0,g.t)("meta-analytics.analytics-public-dashboards-tab.views-last-month-title","Views last 30 days"),fields:[{name:"views",type:mt.PU.number}],width:mn,timeRange:tn,showBars:!0,showLines:!1}),this.renderChart({title:(0,g.t)("meta-analytics.analytics-public-dashboards-tab.errors-last-month-title","Errors last 30 days"),fields:[{name:"errors",type:mt.PU.number,color:Nt.colors.error.border}],width:mn,timeRange:tn,showBars:!1,showLines:!0})]})})}return(0,r.jsx)("span",{children:(0,r.jsx)(g.x6,{i18nKey:"meta-analytics.analytics-public-dashboards-tab.no-data",children:"No data."})})}}const un={setDrawerOpen:be},On=(0,se.cV)((0,Ne.connect)(null,un)(cn));class yn extends an{render(){const{dailySummaries:ft,theme:Nt}=this.props;if(ft&&ft.length>0){const tn=this.buildTimeRange();return(0,r.jsx)(lt.Ay,{disableHeight:!0,children:({width:mn})=>mn===0?null:(0,r.jsxs)("main",{style:{width:mn},children:[this.renderChart({title:(0,g.t)("meta-analytics.analytics-stats-tab.daily-query-count-title","Daily query count"),fields:[{name:"queries",type:mt.PU.number},{name:"cachedQueries",type:mt.PU.number,label:(0,g.t)("meta-analytics.analytics-stats-tab.daily-query-count-cached-queries-label","cached queries")}],width:mn,timeRange:tn,showBars:!1,showLines:!0}),this.renderChart({title:(0,g.t)("meta-analytics.analytics-stats-tab.errors-last-month-title","Errors last 30 days"),fields:[{name:"errors",type:mt.PU.number,color:Nt.colors.error.border}],width:mn,timeRange:tn,showBars:!1,showLines:!0})]})})}return(0,r.jsx)("span",{children:(0,r.jsx)(g.x6,{i18nKey:"meta-analytics.analytics-stats-tab.no-data",children:"No data."})})}}const En=(0,se.cV)(yn);var Bn=e(60519),fa=e(35942),Fn=e(45861),Ea=e(24343);class gt extends an{constructor(ft){super(ft),this.onOpenVersionHistory=()=>{const{setDrawerOpen:Nt}=this.props;Nt(!1),b.Ny.partial({editview:"versions"})},this.state={dashboardUsersInfo:null}}async componentDidMount(){const{dashboard:ft}=this.props;try{const Nt=await(0,qe.db)(ft.uid);this.setState({dashboardUsersInfo:Nt})}catch(Nt){console.log("Error getting dashboard users info",Nt)}}formatDate(ft){const Nt=ft.diff((0,P.KQ)().startOf("day"),"days",!0);if(Nt<-6)return ft.format("YYYY-MM-DD");if(Nt<-1)return ft.locale("en").format("dddd");if(Nt<0)return(0,g.t)("meta-analytics.analytics-users-tab.format-date-yesterday","Yesterday");{const tn=ft.diff((0,P.KQ)(),"minutes",!0);return tn<-60?(0,g.t)("meta-analytics.analytics-users-tab.format-date-today","Today"):tn<-15?(0,g.t)("meta-analytics.analytics-users-tab.format-date-last-hour","Last hour"):(0,g.t)("meta-analytics.analytics-users-tab.format-date-currently-viewing","Currently viewing")}}renderUserBox(ft,Nt,tn){return(0,r.jsxs)("div",{className:tn.userBox,"aria-label":(0,g.t)("meta-analytics.analytics-users-tab.aria-label-user-information-box","User information box"),children:[(0,r.jsx)("h6",{"aria-label":(0,g.t)("meta-analytics.analytics-users-tab.aria-label-user-box-title","User box title"),children:ft}),(0,r.jsx)(fa.n,{userView:Nt,showTooltip:!1}),(0,r.jsx)("div",{className:tn.userName,children:Nt.user.name}),(0,r.jsx)("div",{children:(0,P.KQ)(Nt.lastActiveAt).format("YYYY-MM-DD")})]})}renderViewsChart(){const ft=this.buildTimeRange();return(0,r.jsx)(lt.Ay,{disableHeight:!0,children:({width:Nt})=>Nt===0?null:(0,r.jsx)("main",{style:{width:Nt},children:this.renderChart({title:(0,g.t)("meta-analytics.analytics-users-tab.views-last-month-title","Views last 30 days"),fields:[{name:"views",type:mt.PU.number}],width:Nt,timeRange:ft,showBars:!0,showLines:!1})})})}convertUserViewsToDataFrame(ft,Nt){const{userViews:tn}=this.props;if(tn&&tn.length>0){const mn=[],Dn=[],Rn=[];tn.forEach(ba=>{mn.push(this.formatDate((0,P.KQ)(ba.lastActiveAt))),Dn.push(ba.user.name),Rn.push((0,r.jsx)(fa.n,{className:ft.userIcon,userView:ba,showTooltip:!1}))});const Kn={displayName:" ",filterable:!1,custom:{width:50,align:"center",minWidth:50,cellOptions:{type:Mt.ob.ColorText},inspect:!1}},ra=[{fields:[{name:" ",type:mt.PU.other,config:Kn,values:Rn},{name:(0,g.t)("meta-analytics.analytics-users-tab.user-views-data-frame-user-field","User"),type:mt.PU.string,config:{},values:Dn},{name:(0,g.t)("meta-analytics.analytics-users-tab.user-views-data-frame-when-field","When"),type:mt.PU.string,config:{},values:mn}],length:tn.length}],ca=(0,Bn.we)({data:ra,theme:Nt,replaceVariables:ba=>ba,fieldConfig:{}});return ca.length>0?ca[0]:null}else return null}render(){const{dailySummaries:ft,dashboard:Nt,theme:tn,userViews:mn}=this.props,{dashboardUsersInfo:Dn}=this.state,Rn=(0,ot.k)(tn),Kn=this.convertUserViewsToDataFrame(Rn,tn);return(0,r.jsxs)("div",{children:[ft&&ft.length>0&&this.renderViewsChart(),(0,r.jsxs)("div",{className:Rn.userBoxesContainer,children:[Dn?.creator&&this.renderUserBox((0,g.t)("meta-analytics.analytics-users-tab.created-user-box","Created"),Dn.creator,Rn),Dn?.lastEditor&&this.renderUserBox((0,g.t)("meta-analytics.analytics-users-tab.last-edited-user-box","Last edited"),Dn.lastEditor,Rn),mn?.length>0&&this.renderUserBox((0,g.t)("meta-analytics.analytics-users-tab.last-viewed-user-box","Last viewed"),mn[0],Rn)]}),mn?.length>0&&(0,r.jsxs)("div",{className:Rn.tableContainer,children:[(0,r.jsxs)("div",{className:Rn.tableHeader,children:[(0,r.jsx)("h4",{children:(0,r.jsx)(g.x6,{i18nKey:"meta-analytics.analytics-users-tab.last-dashboard-viewers",children:"Last 30 dashboard viewers"})}),Nt.meta.showSettings&&(0,r.jsx)(Fn.$n,{icon:"history",variant:"secondary",onClick:this.onOpenVersionHistory,"aria-label":(0,g.t)("meta-analytics.analytics-users-tab.aria-label-version-history-button","Version history button"),children:(0,r.jsx)(g.x6,{i18nKey:"meta-analytics.analytics-users-tab.dashboard-version-history",children:"Dashboard version history"})})]}),(0,r.jsx)(lt.Ay,{disableHeight:!0,children:({width:ra})=>{if(ra===0)return null;const ca=35*(Kn.length+1);return(0,r.jsx)("main",{style:{width:ra},children:(0,r.jsx)(Ea.X,{data:Kn,height:ca,width:ra,"aria-label":(0,g.t)("meta-analytics.analytics-users-tab.aria-label-recent-users-table","Recent users table")})})}})]})]})}}const Ht={setDrawerOpen:be},wt=(0,se.cV)((0,Ne.connect)(null,Ht)(gt)),Yt=30;class rn extends n.PureComponent{constructor(ft){super(ft),this.onSelectTab=Nt=>{this.props.setDrawerTab(Nt.value||Xe.AnalyticsTab.Stats)},this.state={dailySummaries:[],publicDailySummaries:[],userViews:[]}}async componentDidMount(){const{dashboard:ft}=this.props,Nt=[];for(let tn=0;tn<30;tn++)Nt.push((0,P.KQ)(Date.now()).subtract(tn,"days").format(qe.QH));if(ft?.id&&ft.meta.url){const tn=await(0,qe.Au)(ft.uid,Nt),mn=await(0,qe._x)(ft.uid,Yt);let Dn=[];(0,i.iR)()&&(Dn=await(0,qe.XP)(ft.uid,Nt)),this.setState({dailySummaries:tn,userViews:mn,publicDailySummaries:Dn})}}renderHeader(ft){const Nt=[{label:(0,g.t)("meta-analytics.analytics-drawer.stats-tab-label","Stats"),value:Xe.AnalyticsTab.Stats},{label:(0,g.t)("meta-analytics.analytics-drawer.users-activity-tab-label","Users and activity"),value:Xe.AnalyticsTab.Users}];return(0,i.iR)()&&Nt.push({label:s.$.featureToggles.newDashboardSharingComponent?(0,g.t)("meta-analytics.analytics-drawer.shared-dashboards-tab-label","Shared dashboards"):(0,g.t)("meta-analytics.analytics-drawer.public-dashboards-tab-label","Public dashboards"),value:Xe.AnalyticsTab.PublicDashboards}),(0,r.jsx)(Ve.U,{className:ft.tabsBar,children:Nt.map((tn,mn)=>(0,r.jsx)(ge.o,{label:tn.label,active:tn.value===this.props.drawerTab,onChangeTab:()=>this.onSelectTab(tn)},`${tn.value}-${mn}`))})}render(){const{dailySummaries:ft,publicDailySummaries:Nt,userViews:tn}=this.state,{dashboard:mn,drawerTab:Dn,setDrawerOpen:Rn,theme:Kn}=this.props,ra=(0,ot.k)(Kn),ca=(0,g.t)("meta-analytics.analytics-drawer.title-dashboard-insights","{{dashboardTitle}} - analytics",{dashboardTitle:mn.title});return(0,r.jsx)(Ue._,{scrollableContent:!0,title:ca,size:"md",onClose:()=>Rn(!1),subtitle:this.renderHeader(ra),expandable:!0,children:(0,r.jsxs)(Ke.J,{className:ra.tabContent,children:[(0,We.z5)()&&(0,r.jsx)(Be.Iz,{featureId:"dashboard-insights",eventVariant:"trial",featureName:"dashboard usage insights",text:(0,g.t)("meta-analytics.analytics-drawer.text-access-usage-insights-during-trial-grafana","Get full access to usage insights for free during your trial of Grafana Pro.")}),Dn===Xe.AnalyticsTab.Stats&&(0,r.jsx)(En,{dashboard:mn,dailySummaries:ft}),Dn===Xe.AnalyticsTab.Users&&(0,r.jsx)(wt,{dashboard:mn,dailySummaries:ft,userViews:tn}),(0,i.iR)()&&Dn===Xe.AnalyticsTab.PublicDashboards&&(0,r.jsx)(On,{dashboard:mn,dailySummaries:Nt})]})})}}function Xt(ct){return{drawerTab:ct.metaAnalytics.drawerTab}}const on={setDrawerOpen:be,setDrawerTab:Oe},pn=(0,se.cV)((0,Ne.connect)(Xt,on)(rn)),Un=({onClick:ct,isHighlighted:ft})=>(0,r.jsx)(Ae.I,{icon:"info-circle",tooltip:(0,g.t)("meta-analytics.analytics-toolbar-button.tooltip-dashboard-insights","Dashboard insights"),onClick:ct,isHighlighted:ft}),In=({dashboard:ct,isDrawerOpen:ft,setDrawerOpen:Nt})=>{const tn=ct?.id&&ct.meta.url,mn=(0,We.z5)();return(0,n.useEffect)(()=>{tn&&mn&&(0,l.Xp)((0,le.L)("dashboard-insights-dot"),le.X.Test,"trial")},[tn,mn]),tn&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Un,{onClick:()=>{Nt(!0),(0,l.rR)("dashboards_toolbar_actions_clicked",{item:"insights"})},isHighlighted:mn}),ft&&(0,r.jsx)(pn,{dashboard:ct})]})};function Gn(ct){return{isDrawerOpen:ct.metaAnalytics.isDrawerOpen}}const Wa={setDrawerOpen:be},za=({dashboard:ct})=>{const ft=ct?.id&&ct.meta.url,[Nt,tn]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{ft&&(0,l.Xp)((0,le.L)("dashboard-insights-dot"),le.X.Test,"")},[ft]),ft&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Un,{isHighlighted:!0,onClick:()=>{tn(!0)}}),Nt&&(0,r.jsx)(ss,{dashboard:ct,onClose:()=>tn(!1)})]})},Oa=()=>{(0,a.a)("analytics")?o.TP.hasPermission(Xe.AccessControlAction.DashboardsInsightsRead)&&(0,_e.fP)({show:()=>!0,component:(0,Ne.connect)(Gn,Wa)(In),index:-1}):s.$.featureToggles.featureHighlights&&(0,_e.fP)({show:()=>!0,component:za,index:-1})},ss=({onClose:ct,dashboard:ft})=>{const Nt=(0,se.$j)(),tn=(0,g.t)("meta-analytics.analytics-upgrade-drawer.title-dashboard-insights","{{dashboardTitle}} - analytics",{dashboardTitle:ft?.title||""});return(0,r.jsxs)(Ue._,{onClose:ct,title:tn,width:"50%",children:[(0,r.jsx)(Be.Iz,{featureName:"dashboard usage insights",featureId:"dashboard-insights"}),(0,r.jsx)(Be.ep,{featureName:"dashboard usage insights",image:`usage-insights-${Nt.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights",description:(0,g.t)("meta-analytics.analytics-upgrade-drawer.description-usage-insights-provide-detailed-information-about","Usage Insights provide detailed information about dashboard usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues.")})]})};var La=e(68143);class Ca{constructor(ft){this.options=ft,this.buffer=[],this.supportedEvents=[ke.on.MetaAnalytics],this.addEvent=Nt=>{this.buffer.push(Nt)},this.flush=()=>{if(this.buffer.length===0)return;const Nt=[];for(const tn of this.buffer)Nt.push({type:tn.type,...tn.payload,meta:tn.meta});this.buffer=[],this.options.url&&(0,La.AI)().fetch({method:"POST",url:this.options.url,showSuccessAlert:!1,showErrorAlert:!1,data:Nt}).toPromise()}}}var Ka=e(2543),As=e(44815);function Ia(ct){return ft=>{ft(be(!0)),ft(Oe(ct))}}const _s={openDrawer:Ia},Fa=(0,Ne.connect)(null,_s),xt=4,dt=6e4;function St(ct,ft){const Nt=Re.TP.user;(0,qe.K4)(ct,xt+10).then(tn=>{const mn=tn.filter(Dn=>Dn.user.id!==Nt.id);ft(Dn=>(0,Ka.isEqual)(mn,Dn)?Dn:mn)})}const jt=({dashboard:ct,openDrawer:ft})=>{const Nt=ct?.uid,[tn,mn]=(0,n.useState)([]);return(0,n.useEffect)(()=>{if(!Nt||!ct?.meta.url)return;St(Nt,mn);const Dn=setInterval(()=>St(Nt,mn),dt);return()=>{clearInterval(Dn)}},[Nt,ct]),(0,r.jsx)(As.q,{users:tn,limit:xt,onClick:()=>ft(Xe.AnalyticsTab.Users)})},Qt=()=>{Re.TP.hasPermission(Xe.AccessControlAction.DashboardsInsightsRead)&&(0,_e.UP)({show:()=>!0,component:Fa(jt),index:"end"})},Jt=()=>{const ct=(0,He.zj)().analytics?.enabled,ft=(0,a.a)("analytics");ft&&(0,ke.pl)(new Ca({url:ln()})),ct&&(ft?Re.TP.user.isSignedIn&&(Qt(),Oa()):s.$.featureToggles.featureHighlights&&Oa())},ln=()=>{const ct=(0,He.zj)().publicDashboardAccessToken;return ct!==""?`api/public/ma/events/${ct}`:"api/ma/events"};var fn=e(75505);const gn=`/apis/sandboxsettings.grafana.app/v0alpha1/namespaces/${s.$.namespace}`;async function vn(ct){try{const{data:ft,...Nt}=await(0,fn.s)((0,La.AI)().fetch({...ct,url:gn+ct.url,showErrorAlert:ct.showErrorAlert,data:ct.body}));return{data:ft,meta:Nt}}catch(ft){return ct.manageError?ct.manageError(ft):{error:ft}}}function wn(){async function ct(ft){return vn(ft)}return ct}const Rt=(0,N.xP)({reducerPath:"sandboxSettingsGeneratedAPI",baseQuery:wn(),tagTypes:["SandboxSettingsList"],endpoints:()=>({})}),bt="/sandbox-settings",Vt=Rt.injectEndpoints({endpoints:ct=>({listSandboxSettings:ct.query({query:()=>({url:bt}),providesTags:["SandboxSettingsList"]}),createSandboxSettings:ct.mutation({query:ft=>({url:bt,method:"POST",body:ft}),invalidatesTags:["SandboxSettingsList"]}),getSandboxSettings:ct.query({query:ft=>({url:`${bt}/${ft.name}`,showErrorAlert:ft.showErrorAlert})}),deleteSandboxSettings:ct.mutation({query:ft=>({url:`${bt}/${ft.name}`,method:"DELETE",showErrorAlert:ft.showErrorAlert})}),updateSandboxSettings:ct.mutation({query:ft=>({url:`${bt}/${ft.name}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},body:JSON.stringify(ft.body),showErrorAlert:ft.showErrorAlert}),invalidatesTags:["SandboxSettingsList"]})}),overrideExisting:!1}),{useListSandboxSettingsQuery:Kt,useCreateSandboxSettingsMutation:Dt,useGetSandboxSettingsQuery:Zt,useDeleteSandboxSettingsMutation:Ln,useUpdateSandboxSettingsMutation:Qn}=Vt,va=Vt.enhanceEndpoints({});var Wn=e(55767),ia=e(33109),kn=e(70255),na=e(18027),Ga=e(21285),Ps=e(66404),ls=e(89640);const Ta=ct=>{const[ft,Nt]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!ct?.id){Nt(!1);return}if(ct.angularDetected){Nt(!1);return}(0,ia.SQ)({pluginId:ct.id}).then(tn=>{Nt(tn)})},[ct?.id,ct?.angularDetected]),ft},aa=ct=>{const ft=Zt({name:ct,showErrorAlert:!1}),Nt=ft?.status==="pending";return ft?.status!=="fulfilled"?[void 0,Nt]:ft?.data?.spec?[ft.data.spec,Nt]:[void 0,Nt]};function Gs(ct,ft){const[Nt,tn]=Dt(),[mn,Dn]=Qn();return[(0,n.useCallback)(Kn=>ft?mn({name:ct,body:{metadata:{name:ct},spec:Kn}}):Nt({metadata:{name:ct},spec:Kn}),[Nt,ct,mn,ft]),ft?Dn:tn]}const Os=({plugin:ct})=>{const[ft,Nt]=aa(ct.id),[tn,mn]=Gs(ct.id,!!ft),[Dn,Rn]=(0,n.useState)(!1),[Kn,ra]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{if(!ft){(0,ia.JW)({pluginId:ct.id}).then(Rn);return}Rn(ft.enabled)},[ft,ct.id]),(0,n.useEffect)(()=>{!mn.isLoading&&Kn&&(ra(!1),window.location.reload()),mn?.data?.spec?.enabled!==void 0&&Rn(mn.data.spec.enabled)},[mn,Kn]),Nt)return(0,r.jsx)(kn.A,{height:40,width:200});const ca=async ba=>{if(mn.isLoading||Kn)return;ra(!0);const Sa=ba.currentTarget.checked;(0,l.rR)("plugins_sandbox_switch",{plugin:ct.id,enabled:Sa,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"});const cs={plugin:ct.id,enabled:Sa,apiAllowList:[]};tn(cs)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(na.I,{interactive:!0,tooltip:lr,label:(0,g.t)("plugins.sandbox.enable-sandbox-label","Frontend Sandbox"),disabled:Kn,children:(0,r.jsx)(Ga.K,{onChange:ca,value:Dn})})})},Zs=({plugin:ct})=>{const ft=Ta(ct);return!ct||!ct?.id||!ft?null:(0,r.jsx)(Os,{plugin:ct})};function lr(){return(0,r.jsxs)(Ps.E,{color:"primary",element:"p",children:[(0,r.jsx)(g.x6,{i18nKey:"plugins.sandbox.enable-sandbox-tooltip",children:"The frontend sandbox runs frontend code in isolation, restricting access to global browser scope and limiting UI modifications to the plugin area."})," ",(0,r.jsx)(ls.Y,{href:"https://grafana.com/docs/grafana/next/administration/plugin-management/#plugin-frontend-sandbox",inline:!0,external:!0,weight:"light",children:(0,r.jsx)(g.x6,{i18nKey:"plugins.sandbox.enable-sandbox-tooltip-link",children:"Read more"})})]})}let Xs;async function jo(ct){if(Xs)return!!Xs[ct.pluginId];if(!s.$.bootData.user.isSignedIn)return(0,ia.Cz)(ct);const ft=await vn({url:"/sandbox-settings",showErrorAlert:!1});if("error"in ft)return`${(0,Ka.get)(ft,"error.status")}`.startsWith("4")?await(0,ia.Cz)(ct):(console.error("Error fetching sandbox settings",ft.error),!1);if(Xs={},!ft.data.items)return!1;for(const Nt of ft.data.items)Xs[Nt.spec.plugin]=Nt.spec.enabled;return!!Xs[ct.pluginId]}function ci(){Xs=void 0,(0,ia.vV)(jo),(0,Wn.QD)(Zs)}var Xr=e(98838),vs=e(22787);const ks=(ct,ft)=>{(0,l.rR)(`query_library-${ct}`,ft)},Ys={queryLibraryOpened:()=>{ks("opened")},queryLibraryClosedWithoutSelection:()=>{ks("closed_without_selection")},addQueryFromLibraryClicked:()=>{ks("add_query_from_library_clicked")},replaceWithQueryFromLibraryClicked:()=>{ks("replace_with_query_from_library_clicked")},saveQueryToLibraryClicked:()=>{ks("save_query_to_library_clicked")},saveQuerySuccess:()=>{ks("save_query_success")},searchBarFocused:()=>{ks("search_bar_focused")},dataSourceFilterChanged:()=>{ks("data_source_filter_changed")},userFilterChanged:()=>{ks("user_filter_changed")},selectQueryClicked:()=>{ks("select_query_clicked")},deleteQueryClicked:()=>{ks("delete_query_clicked")},duplicateQueryClicked:()=>{ks("duplicate_query_clicked")},lockQueryClicked:ct=>{ks("lock_query_clicked",{isLocked:ct})},editQueryClicked:()=>{ks("edit_query_clicked")},cancelEditClicked:()=>{ks("cancel_edit_clicked")},saveEditClicked:ct=>{ks("save_edit_clicked",{...ct})}},Lo=ct=>{const ft={};for(const[Nt,tn]of Object.entries(ct))typeof tn=="boolean"&&(ft[Nt]=tn);return ft};var rs=e(49785),Vs=e(16817),Hs=e(32899),yr=e(75234),qr=e(78282),xr=e(80839),Ws=e(37386),Br=e(87105),Tr=e(63527),uo=e(10928),eo=e(32635),Xo=e(81970);const fr={pages:{},components:{saveQueryButton:{button:"data-testid save to query library button"},saveQueryModal:{modal:"data-testid save to query library modal",cancel:"data-testid save to query library modal cancel",confirm:"data-testid save to query library modal confirm",title:"data-testid save to query library modal title",description:"data-testid save to query library modal description",tagsInput:"data-testid save to query library modal tags input"},queryLibraryDrawer:{content:"data-testid query library content",delete:"data-testid query library delete",lock:"data-testid query library lock",duplicate:"data-testid query library duplicate",confirm:"data-testid query library confirm",item:ct=>`data-testid query library item ${ct}`}}};var to=e(24726),ho=e(75735);const zr=ct=>ct.items?ct.items.map(ft=>({uid:ft.metadata?.name??"",title:ft.spec?.title??"",description:ft.spec?.description??"",tags:ft.spec?.tags??[],isLocked:ft.spec?.isLocked??!1,isVisible:ft.spec?.isVisible??!1,targets:ft.spec?.targets.map(Nt=>({...Nt.properties,refId:Nt.properties.refId??""}))??[],createdAtTimestamp:new Date(ft.metadata?.creationTimestamp??"").getTime(),user:{uid:ft.metadata?.annotations?.[ho.hc]??""}})):[],Gr=ct=>{const{title:ft,targets:Nt,description:tn,isLocked:mn,isVisible:Dn,tags:Rn}=ct;return{metadata:{generateName:(0,to.A)()},spec:{title:ft,description:tn,isVisible:Dn,vars:[],tags:Rn,targets:Nt.map(Kn=>({variables:{},properties:{...Kn,datasource:{...Kn.datasource,type:Kn.datasource?.type??""}}})),isLocked:mn??!1}}};var fo=e(2863);function Bo(ct){const{value:ft}=(0,Vs.A)(async()=>{const Nt=(0,fo.w)();return(0,qr.l)().get(ct?.uid?{...ct,uid:Nt.replace(ct.uid)}:ct)},[ct]);return ft}const Hr=ct=>ct?(0,g.t)("explore.query-template-modal.add-info","You're about to save this query. Once saved, you can easily access it from the query library for future use and reference."):(0,g.t)("explore.query-template-modal.edit-info","You're about to edit this query. Once saved, you can easily access it from the query library for future use and reference."),po=({onCancel:ct,onSave:ft,templateData:Nt})=>{const{register:tn,handleSubmit:mn,control:Dn}=(0,rs.mN)({defaultValues:{title:Nt?.title||(0,g.t)("explore.query-library.default-title","New query"),description:Nt?.description,isVisible:Nt?.isVisible??!1}}),[Rn]=G(),Kn=Bo(Nt?.query.datasource),ra=Nt?.query!==void 0?[Nt?.query]:[],ca="tags",ba=async fs=>Rn({queryTemplate:Gr(fs)}).unwrap().then(()=>((0,yr.J7)().publish({type:Hs.r1.alertSuccess.name,payload:[(0,g.t)("explore.query-library.query-template-added","Query successfully saved to the library")]}),!0)).catch(()=>((0,yr.J7)().publish({type:Hs.r1.alertError.name,payload:[(0,g.t)("explore.query-library.query-template-add-error","Error attempting to save this query to the library")]}),!1)),Sa=async fs=>{const Qa=fs.title||(0,g.t)("explore.query-library.default-title","New query");Nt?.query&&ba({title:Qa,description:fs.description,isVisible:fs.isVisible,targets:[Nt?.query],tags:fs.tags}).then(Ns=>{ft(Ns)})},{value:cs}=(0,Vs.A)(async()=>{const fs=ra.map(async(Qa,Ns)=>(await(0,qr.l)().get(Qa.datasource))?.getQueryDisplayText?.(Qa)||(0,Xo.ev)(Qa));return Promise.all(fs)});return(0,r.jsxs)("form",{"data-testid":fr.components.saveQueryModal.modal,onSubmit:mn(Sa),children:[(0,r.jsx)("p",{children:Hr(Nt===void 0)}),cs&&cs.map((fs,Qa)=>(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modal.query","Query"),children:(0,r.jsx)(Br.f,{readOnly:!0,value:fs})},`query-${Qa}`)),Nt?.query&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modal.data-source-name","Data source name"),children:(0,r.jsx)(xr.s,{current:Kn?.uid,disabled:!0})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modall.data-source-type","Data source type"),children:(0,r.jsx)(Tr.p,{disabled:!0,defaultValue:Kn?.meta.name})})]}),(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modal.title","Title"),children:(0,r.jsx)(Tr.p,{"data-testid":fr.components.saveQueryModal.title,id:"query-template-title",autoFocus:!0,...tn("title")})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modal.description","Description"),children:(0,r.jsx)(Tr.p,{"data-testid":fr.components.saveQueryModal.description,id:"query-template-description",...tn("description")})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("explore.query-template-modal.tags","Tags"),children:(0,r.jsx)(rs.xI,{name:ca,control:Dn,defaultValue:Nt?.tags??[],render:({field:{ref:fs,value:Qa,onChange:Ns,...$s}})=>(0,r.jsx)(uo.u,{...$s,id:ca,autoColors:!1,onChange:zs=>{Ns(Array.from(new Set(zs)).sort())},tags:Qa?Array.from(Qa):[]})})}),(0,r.jsx)(Ws.D,{children:(0,r.jsx)(eo.S,{label:(0,g.t)("query-library.query-details.make-query-visible","Share query with all users"),id:"query-template-is-visible",...tn("isVisible")})}),(0,r.jsxs)(vs.a.ButtonRow,{children:[(0,r.jsx)(Fn.$n,{"data-testid":fr.components.saveQueryModal.cancel,variant:"secondary",onClick:()=>ct(),fill:"outline",children:(0,r.jsx)(g.x6,{i18nKey:"explore.query-library.cancel",children:"Cancel"})}),(0,r.jsx)(Fn.$n,{"data-testid":fr.components.saveQueryModal.confirm,variant:"primary",type:"submit",children:(0,r.jsx)(g.x6,{i18nKey:"explore.query-library.save",children:"Save"})})]})]})};function Uo({query:ct,title:ft,context:Nt,isOpen:tn,onSave:mn,close:Dn}){return(0,r.jsx)(vs.a,{title:(0,g.t)("explore.query-template-modal.add-title","Add to query library"),isOpen:tn,onDismiss:()=>Dn(),children:(0,r.jsx)(po,{onCancel:()=>{Dn()},onSave:Rn=>{Rn&&(Dn(),Ys.saveQuerySuccess(),mn?.())},templateData:{query:ct,title:ft}})})}var hs=e(41654),qo=e(45967),ys=e(50201),At=e(31286),bn=e(3271),An=e(10378),pa=e(94659),zn=e(28998);function la(ct){const ft=(0,Ka.uniq)((0,Ka.compact)(ct));return(0,pa.E)(ct?{key:ft}:An.hT)}function Zn(ct,ft){return(0,Vs.A)(async()=>{if(!(ct&&ft))return;const Nt=ct.map(async(tn,mn)=>{try{const Dn=tn.targets[0]?.datasource,Rn=await(0,qr.l)().get(Dn),Kn=(0,zn.tR)().getInstanceSettings(Dn)?.meta.name||"",ra=tn.targets[0],ca=(0,Xo.Ax)(ra,Rn),ba=Rn?.name||"",Sa=ft.display.find(cs=>`${cs?.identity.type}:${cs?.identity.name}`===tn.user?.uid);return{index:mn.toString(),uid:tn.uid,datasourceName:ba,datasourceRef:Dn,datasourceType:Kn,createdAtTimestamp:tn?.createdAtTimestamp||0,query:ra,queryText:ca,title:tn.title,description:tn.description||"",tags:tn.tags??[],isLocked:tn.isLocked??!1,isVisible:tn.isVisible??!1,user:{uid:tn.user?.uid||"",displayName:Sa?.displayName||"",avatarUrl:Sa?.avatarURL||""},error:void 0}}catch(Dn){return{index:mn.toString(),error:Dn instanceof Error?Dn:new Error("unknown error "+JSON.stringify(Dn))}}});return Promise.all(Nt)},[ct,ft])}const Vn=(ct,ft,Nt,tn)=>ct.filter(Dn=>{const Rn=ft.toLowerCase(),Kn=Dn.datasourceName?.toLowerCase()||"",ra=Nt.length===0||Nt.some(Ar=>{const Yr=Ar.toLowerCase();return Kn.includes(Yr)}),ca=Dn.user?.displayName||"",ba=tn.length===0||tn.includes(ca),Sa=Dn.user?.uid?.replace("user:","")===o.TP?.user?.uid,cs=Dn.isVisible||Sa,fs=Kn.includes(Rn),Qa=Dn.datasourceType?.toLowerCase().includes(Rn),Ns=Dn.title?.toLowerCase().includes(Rn),$s=Dn.description?.toLowerCase().includes(Rn),zs=Dn.queryText?.toLowerCase().includes(Rn),Ds=Dn.tags?.some(Ar=>Ar.toLowerCase().includes(Rn));return(fs||Qa||Ns||$s||zs||Ds)&&ra&&ba&&cs});var Hn=e(92807),Ja=e(21348),Ua=e(8535),Ha=e(87745);const ha=ct=>{const ft=ct.user?.uid?.replace("user:","")===o.TP.user.uid,Nt=o.TP.hasRole("Admin");return ft||Nt};function Ba({onSelectQuery:ct,selectedQueryRow:ft,isEditingQuery:Nt}){const[tn]=H(),[mn]=k(),{openAddQueryModal:Dn}=(0,Xr.Y)(),{isLocked:Rn}=ft,Kn=ba=>{const Sa=async cs=>{await tn({name:cs}).unwrap(),(0,Ua.JD)((0,S.dx)((0,w.tZ)((0,g.t)("query-library.notifications.query-deleted","Query deleted")))),Ys.deleteQueryClicked()};(0,yr.J7)().publish(new Ha.bY({title:(0,g.t)("query-library.delete-modal.title","Delete query"),text:(0,g.t)("query-library.delete-modal.body-text","You're about to remove this query from the query library. This action cannot be undone. Do you want to continue?"),yesText:(0,g.t)("query-library.delete-modal.confirm-button","Delete query"),icon:"trash-alt",onConfirm:()=>Sa(ba)}))},ra=()=>{Dn(ft.query,{title:`${ft.title} ${(0,g.t)("query-library.actions.duplicate-query-title-copy","Copy")}`,isDuplicating:!0}),Ys.duplicateQueryClicked()},ca=()=>{if(ft.uid)return Ys.lockQueryClicked(!Rn),mn({name:ft.uid||"",patch:{spec:{isLocked:!Rn}}})};return(0,r.jsxs)(hs.B,{wrap:"wrap",justifyContent:"space-between",children:[(0,r.jsxs)(hs.B,{wrap:"wrap",justifyContent:"flex-start",children:[(0,r.jsx)(ue.K,{"data-testid":fr.components.queryLibraryDrawer.delete,variant:"secondary",name:"trash-alt",onClick:()=>Kn(ft.uid??""),tooltip:(0,g.t)("query-library.actions.delete-query-button","Delete query"),disabled:ft.isLocked||!ha(ft)}),(0,r.jsx)(ue.K,{"data-testid":fr.components.queryLibraryDrawer.lock,variant:Rn?"primary":"secondary",name:Rn?"lock":"unlock",onClick:ca,tooltip:Rn?(0,g.t)("query-library.actions.unlock-query-button","Unlock query"):(0,g.t)("query-library.actions.lock-query-button","Lock query"),disabled:!ha(ft)||Nt}),(0,r.jsx)(ue.K,{"data-testid":fr.components.queryLibraryDrawer.duplicate,variant:"secondary",name:"copy",onClick:ra,tooltip:(0,g.t)("query-library.actions.duplicate-query-button","Duplicate query")})]}),(0,r.jsx)(Fn.$n,{"data-testid":fr.components.queryLibraryDrawer.confirm,onClick:()=>ct(ft.query),children:(0,r.jsx)(g.x6,{i18nKey:"query-library.actions.select-query-button",children:"Select query"})})]})}var ya=e(68079),xs=e(71555),Za=e(19729);function os({query:ct,editingQuery:ft,setEditingQuery:Nt}){const{isFetching:tn}=V.endpoints.listQueryTemplate.useQueryState({}),mn=Bo(ct.datasourceRef),Dn=(0,P.KQ)(ct.createdAtTimestamp).toLocaleString(),{isLocked:Rn}=ct,Kn=(0,n.useId)(),ra=(0,n.useId)(),ca=(0,n.useId)(),ba=(0,n.useId)(),Sa=(0,n.useId)(),cs=(0,n.useId)(),fs="tags",Qa=(0,se.of)(Yn),{control:Ns,register:$s,handleSubmit:zs,reset:Ds,formState:{dirtyFields:as,isDirty:Ar}}=(0,rs.mN)({defaultValues:{title:ct.title,description:ct.description,isVisible:ct.isVisible}});(0,n.useEffect)(()=>{Ds({title:ct.title,description:ct.description,isVisible:ct.isVisible,tags:ct.tags??[]})},[ct,Ds]);const[Yr]=k(),Dr=ar=>Yr({name:ar.uid,patch:{spec:ar.partialSpec}}),jr=async ar=>{Nt(!1),Ys.saveEditClicked(Lo(as)),ct?.uid&&Dr({uid:ct.uid,partialSpec:{...ar}})},Ks=(0,n.useMemo)(()=>ft?null:(0,r.jsx)(ue.K,{onClick:()=>{Ys.editQueryClicked(),Nt(!0)},name:"pen",disabled:Rn||!ha(ct),tooltip:(0,g.t)("query-library.query-details.edit-button","Edit query")}),[ft,Rn,Nt,ct]),ir=(0,n.useMemo)(()=>ft?(0,r.jsxs)(At.a,{display:"flex",gap:1,alignItems:"center",children:[(0,r.jsx)(Fn.$n,{variant:"primary",type:"submit",disabled:!Ar,children:(0,r.jsx)(g.x6,{i18nKey:"explore.query-library.save",children:"Save"})}),(0,r.jsx)(Fn.$n,{variant:"secondary",onClick:()=>{Ds({title:ct.title,description:ct.description,isVisible:ct.isVisible,tags:ct.tags??[]}),Ys.cancelEditClicked(),Nt(!1)},children:(0,r.jsx)(g.x6,{i18nKey:"explore.query-library.cancel",children:"Cancel"})})]}):null,[ft,Ar,Nt,Ds,ct]);return(0,r.jsx)("form",{onSubmit:zs(jr),children:(0,r.jsxs)(At.a,{minWidth:0,children:[(0,r.jsxs)(At.a,{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between",marginBottom:ft?0:2,children:[(0,r.jsxs)(hs.B,{gap:1,alignItems:"center",minWidth:0,flex:1,children:[(0,r.jsx)("img",{className:Qa.logo,src:mn?.meta.info.logos.small||Za,alt:mn?.type}),ft?(0,r.jsx)(At.a,{flex:1,marginBottom:2,children:(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.title","Title"),noMargin:!0,children:(0,r.jsxs)(hs.B,{direction:"row",children:[(0,r.jsx)(Tr.p,{"data-testid":"query-title-input",id:cs,...$s("title")}),ir]})})}):(0,r.jsx)(Ps.E,{variant:"h5",truncate:!0,children:ct.title??""})]}),tn&&(0,r.jsx)(ya.y,{}),Ks]}),(0,r.jsx)("code",{className:Qa.query,children:ct.queryText}),(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.datasource","Data source"),children:(0,r.jsx)(Tr.p,{readOnly:!0,id:ra,value:ct.datasourceName})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.description","Description"),children:(0,r.jsx)(Tr.p,{id:ca,readOnly:!ft,...$s("description")})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.tags","Tags"),htmlFor:fs,children:(0,r.jsx)(rs.xI,{name:fs,control:Ns,defaultValue:ct.tags??[],render:({field:{ref:ar,value:yo,onChange:Cs,...no}})=>(0,r.jsx)(uo.u,{...no,id:fs,disabled:!ft,autoColors:!1,onChange:dr=>{Cs(Array.from(new Set(dr)).sort())},tags:yo?Array.from(yo):[]})})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.author","Author"),children:(0,r.jsx)(Tr.p,{readOnly:!0,id:Kn,prefix:(0,r.jsx)(At.a,{marginRight:.5,children:(0,r.jsx)(xs.e,{width:2,height:2,src:ct.user?.avatarUrl||"https://secure.gravatar.com/avatar",alt:""})}),value:ct.user?.displayName})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("query-library.query-details.date-added","Date added"),children:(0,r.jsx)(Tr.p,{readOnly:!0,id:ba,value:Dn})}),(0,r.jsx)(Ws.D,{children:(0,r.jsx)(eo.S,{label:(0,g.t)("query-library.query-details.make-query-visible","Share query with all users"),id:Sa,disabled:!ft,...$s("isVisible")})})]})})}const Xn=({rootProps:ct})=>{const ft=(0,se.of)(wa);return(0,r.jsx)(At.a,{minWidth:0,...ct,children:(0,r.jsxs)(hs.B,{direction:"column",gap:2,children:[(0,r.jsxs)(hs.B,{gap:1,alignItems:"center",minWidth:0,children:[(0,r.jsx)(kn.A,{circle:!0,width:24,height:24,containerClassName:ft.icon}),(0,r.jsx)(kn.A,{width:120})]}),(0,r.jsx)(kn.A,{height:32}),(0,r.jsxs)(At.a,{children:[(0,r.jsx)(kn.A,{width:60}),(0,r.jsx)(kn.A,{height:32})]}),(0,r.jsxs)(At.a,{children:[(0,r.jsx)(kn.A,{width:60}),(0,r.jsx)(kn.A,{height:32})]}),(0,r.jsxs)(At.a,{children:[(0,r.jsx)(kn.A,{width:60}),(0,r.jsx)(kn.A,{height:32})]})]})})},Pa=(0,Ja.j)(os,Xn),wa=()=>({icon:(0,ne.css)({display:"block",lineHeight:1})}),Yn=ct=>({query:(0,ne.css)({backgroundColor:ct.colors.action.disabledBackground,borderRadius:ct.shape.radius.default,display:"block",margin:ct.spacing(0,0,2,0),overflowWrap:"break-word",padding:ct.spacing(1),whiteSpace:"pre-wrap"}),logo:(0,ne.css)({width:"24px"})}),Ra="query-library-list";function ns({isSelected:ct,onSelectQueryRow:ft,queryRow:Nt}){const tn=Bo(Nt.datasourceRef),mn=(0,se.of)(is);return(0,r.jsxs)("label",{"data-testid":fr.components.queryLibraryDrawer.item(Nt.title??""),className:mn.label,htmlFor:Nt.uid,children:[(0,r.jsx)("input",{tabIndex:ct?0:-1,type:"radio",id:Nt.uid,name:Ra,className:mn.input,onChange:()=>ft(Nt),checked:ct}),(0,r.jsxs)(hs.B,{alignItems:"center",children:[(0,r.jsx)("img",{className:mn.logo,src:tn?.meta.info.logos.small||Za,alt:tn?.type}),(0,r.jsx)(Ps.E,{truncate:!0,children:Nt.title??""})]})]})}const ps=({rootProps:ct})=>{const ft=(0,se.of)(is),Nt=(0,se.of)(ga);return(0,r.jsx)("div",{className:ft.label,...ct,children:(0,r.jsxs)("div",{className:Nt.wrapper,children:[(0,r.jsx)(kn.A,{containerClassName:Nt.icon,circle:!0,width:16,height:16}),(0,r.jsx)(kn.A,{width:120})]})})},ga=ct=>({wrapper:(0,ne.css)({alignItems:"center",display:"flex",gap:ct.spacing(1),overflow:"hidden"}),icon:(0,ne.css)({display:"block",lineHeight:1})}),Va=(0,Ja.j)(ns,ps),is=ct=>({input:(0,ne.css)({cursor:"pointer",inset:0,opacity:0,position:"absolute"}),label:(0,ne.css)({padding:ct.spacing(2,2,2,1),position:"relative",":has(:checked)":{backgroundColor:ct.colors.action.selected},":has(:focus-visible)":(0,ne.css)({backgroundColor:ct.colors.action.hover,outline:`2px solid ${ct.colors.primary.main}`,outlineOffset:"-2px"})}),logo:(0,ne.css)({width:"16px"})});function nr({isFiltered:ct,onSelectQuery:ft,queryRows:Nt}){const[tn,mn]=(0,n.useState)(!1),[Dn,Rn]=(0,n.useState)(0),Kn=Nt.length===0,ra=(0,se.of)(qn),{isSuccess:ca,isFetching:ba}=V.endpoints.listQueryTemplate.useQueryState({});return(0,n.useEffect)(()=>{ca&&!ba&&Rn(Sa=>Nt[Sa]?Sa:Sa-1)},[Nt,ca,ba]),Kn?ct?(0,r.jsx)(ys.p,{message:(0,g.t)("query-library.not-found.title","No results found"),variant:"not-found",children:(0,r.jsx)(g.x6,{i18nKey:"query-library.not-found.message",children:"Try adjusting your search or filter criteria"})}):(0,r.jsx)(ys.p,{message:(0,g.t)("query-library.empty-state.title","You haven't saved any queries to the library yet"),variant:"call-to-action",children:(0,r.jsx)(g.x6,{i18nKey:"query-library.empty-state.message",children:"Start adding them from Explore or when editing a dashboard"})}):(0,r.jsxs)(hs.B,{flex:1,gap:0,minHeight:0,children:[(0,r.jsx)(At.a,{display:"flex",flex:1,minWidth:0,children:(0,r.jsx)(Hn.P,{children:(0,r.jsx)(hs.B,{direction:"column",gap:0,flex:1,minWidth:0,role:"radiogroup",children:Nt.map((Sa,cs)=>(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(Va,{isSelected:Nt[Dn]?.uid===Sa.uid,onSelectQueryRow:()=>{Rn(cs),mn(!1)},queryRow:Sa}),(0,r.jsx)(bn.c,{spacing:0})]},Sa.uid))})})}),(0,r.jsx)(bn.c,{direction:"vertical",spacing:0}),(0,r.jsx)(At.a,{display:"flex",flex:2,minWidth:0,children:(0,r.jsx)(Hn.P,{children:(0,r.jsx)(At.a,{direction:"column",display:"flex",flex:1,paddingBottom:0,paddingLeft:2,paddingRight:1,paddingTop:2,children:Nt[Dn]&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(At.a,{flex:1,children:(0,r.jsx)(Pa,{query:Nt[Dn],editingQuery:tn,setEditingQuery:mn})}),(0,r.jsx)("div",{className:ra.actions,children:(0,r.jsx)(Ba,{selectedQueryRow:Nt[Dn],onSelectQuery:ft,isEditingQuery:tn})})]})})})})]})}const Aa=({rootProps:ct})=>(0,r.jsxs)(hs.B,{flex:1,gap:0,minHeight:0,...ct,children:[(0,r.jsx)(At.a,{display:"flex",flex:1,minWidth:0,children:(0,r.jsx)(hs.B,{direction:"column",flex:1,gap:0,minWidth:0,children:new Array(5).fill(0).map((ft,Nt)=>(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(Va.Skeleton,{}),(0,r.jsx)(bn.c,{spacing:0})]},Nt))})}),(0,r.jsx)(bn.c,{direction:"vertical",spacing:0}),(0,r.jsx)(At.a,{display:"flex",flex:2,minWidth:0,children:(0,r.jsx)(At.a,{direction:"column",display:"flex",flex:1,paddingBottom:0,paddingLeft:2,paddingRight:1,paddingTop:2,children:(0,r.jsx)(Pa.Skeleton,{})})})]}),Xa=(0,Ja.j)(nr,Aa),qn=ct=>({actions:(0,ne.css)({background:ct.colors.background.primary,bottom:0,padding:ct.spacing(1,0),position:"sticky",zIndex:1})});var Ma=e(12737);const js="query-library-datasource-filter",cr="query-library-user-filter";function Qs({datasourceFilterOptions:ct,datasourceFilters:ft,disabled:Nt,onChangeDatasourceFilters:tn,onChangeSearchQuery:mn,onChangeUserFilters:Dn,searchQuery:Rn,userFilterOptions:Kn,userFilters:ra}){const ca=(0,se.of)(qa);return(0,r.jsxs)(hs.B,{direction:"column",gap:1,children:[(0,r.jsx)(Ma.Z,{disabled:Nt,placeholder:(0,g.t)("query-library.filters.search-placeholder","Search by data source, query content, title, or description"),"aria-label":(0,g.t)("query-library.filters.search-placeholder","Search by data source, query content, title, or description"),value:Rn,onChange:mn,onFocus:()=>Ys.searchBarFocused(),escapeRegex:!1}),(0,r.jsxs)(hs.B,{gap:1,wrap:"wrap",children:[(0,r.jsx)(na.I,{disabled:Nt,className:ca.filterField,grow:!0,shrink:!0,htmlFor:js,label:(0,g.t)("query-library.filters.datasource-label","Data source name(s)"),children:(0,r.jsx)(y.KF,{inputId:js,onChange:ba=>{tn(ba),Ys.dataSourceFilterChanged()},value:ft,options:ct})}),(0,r.jsx)(na.I,{disabled:Nt,className:ca.filterField,grow:!0,shrink:!0,htmlFor:cr,label:(0,g.t)("query-library.filters.user-label","User name(s)"),children:(0,r.jsx)(y.KF,{inputId:cr,onChange:ba=>{Dn(ba),Ys.userFilterChanged()},value:ra,options:Kn})})]})]})}const qa=ct=>({filterField:(0,ne.css)({margin:0})});function bs({activeDatasources:ct,onSelectQuery:ft}){const[Nt,tn]=(0,n.useState)(""),[mn,Dn]=(0,n.useState)(ct.map(as=>({value:as,label:as}))),[Rn,Kn]=(0,n.useState)([]),{data:ra,isLoading:ca,error:ba}=_({}),Sa=(0,n.useMemo)(()=>ra?zr(ra):void 0,[ra]),cs=Es(Sa),fs=cs.data?cs.data.display.map(as=>as.displayName):[],Qa=qs(Sa,cs.data),Ns=(0,n.useMemo)(()=>Qa.value?Vn(Qa.value,Nt,mn.map(as=>as.value||""),Rn.map(as=>as.value||"")):void 0,[Qa.value,Nt,mn,Rn]),$s=!!(Nt||mn.length>0||Rn.length>0),zs=ca||cs.isLoading||Qa.loading,Ds=(0,n.useMemo)(()=>(0,Ka.uniqBy)(Qa.value,"datasourceName").map(as=>as.datasourceName),[Qa.value]);return ba&&ba instanceof Error?(0,r.jsx)(ys.p,{variant:"not-found",message:(0,g.t)("query-library.error-state.title","Something went wrong!"),children:ba.message}):(0,r.jsxs)(hs.B,{"data-testid":fr.components.queryLibraryDrawer.content,height:"100%",direction:"column",gap:0,children:[(0,r.jsx)(At.a,{backgroundColor:"primary",paddingBottom:2,children:(0,r.jsx)(Qs,{datasourceFilterOptions:Ds.map(as=>({value:as,label:as})),datasourceFilters:mn,disabled:zs||!Ns,onChangeDatasourceFilters:Dn,onChangeSearchQuery:tn,onChangeUserFilters:Kn,searchQuery:Nt,userFilterOptions:fs.map(as=>({value:as,label:as})),userFilters:Rn})}),(0,r.jsx)(bn.c,{spacing:0}),(0,r.jsx)(hs.B,{direction:"column",flex:1,minHeight:0,children:zs||!Ns?(0,r.jsx)(Xa.Skeleton,{}):(0,r.jsx)(Xa,{isFiltered:$s,onSelectQuery:ft,queryRows:Ns})})]})}function Es(ct){const ft=(0,n.useMemo)(()=>ct?.map(tn=>tn.user?.uid).filter(tn=>tn!==void 0),[ct]),Nt=la(ft);return(0,n.useEffect)(()=>{Nt.error&&(0,yr.J7)().publish({type:Hs.r1.alertError.name,payload:[(0,g.t)("query-library.user-info.error","Error attempting to get user info from the library: {{error}}",{error:JSON.stringify(Nt.error)})]})},[Nt.error]),Nt}function qs(ct,ft){const Nt=Zn(ct,ft),[tn]=(0,n.useMemo)(()=>{let mn=[],Dn=[];if(Nt.value){if(!Nt.loading)for(const Rn of Nt.value)Rn.error?mn.push(Rn.error):Dn.push(Rn)}else return[void 0,mn];return[Dn]},[Nt]);return{loading:Nt.loading,value:tn}}const Er={explore:{newButton:"grafana.explore.query-library.newButton"}};function Wo({isOpen:ct,activeDatasources:ft,close:Nt,onSelectQuery:tn}){return ct&&(0,r.jsx)(Ue._,{title:(0,r.jsxs)(hs.B,{alignItems:"center",children:[(0,r.jsx)(Ps.E,{element:"h3",children:(0,g.t)("query-library.drawer.title","Query library")}),(0,r.jsx)(qo.m,{placement:"right",content:(0,g.t)("query-library.drawer.tooltip","Right now, each organization can save up to 1000 queries"),children:(0,r.jsx)(v.I,{name:"info-circle"})})]}),onClose:Nt,scrollableContent:!1,children:(0,r.jsx)(bs,{activeDatasources:ft,onSelectQuery:tn})})}var di=e(78685),No=e(99887),ui=e(43260);function Qr({query:ct}){const{openAddQueryModal:ft}=(0,Xr.Y)(),[Nt,tn]=(0,di.A)(Er.explore.newButton,!0);return Nt?(0,r.jsx)(No.E,{"data-testid":fr.components.saveQueryButton.button,text:(0,g.t)("query-operation.header.save-to-query-library-new","New: Save to query library"),icon:"save",color:"blue",onClick:()=>{ft(ct),tn(!1)},style:{cursor:"pointer"}}):(0,r.jsx)(ui.q,{dataTestId:fr.components.saveQueryButton.button,title:(0,g.t)("query-operation.header.save-to-query-library","Save to query library"),icon:"save",onClick:()=>{ft(ct)}})}function Pr({children:ct}){const[ft,Nt]=(0,n.useState)(!1),[tn,mn]=(0,n.useState)([]),[Dn,Rn]=(0,n.useState)(!1),[Kn,ra]=(0,n.useState)(void 0),[ca,ba]=(0,n.useState)(void 0),[Sa,cs]=(0,n.useState)(()=>()=>{}),[fs,Qa]=(0,n.useState)("unknown"),[Ns,$s]=(0,n.useState)(void 0),zs=(0,n.useCallback)((Dr,jr,Ks)=>{mn(Dr),cs(()=>jr),Nt(!0),Qa(Ks?.context||"unknown"),Ys.queryLibraryOpened(),Ks?.isReplacingQuery?Ys.replaceWithQueryFromLibraryClicked():Ys.addQueryFromLibraryClicked()},[]),Ds=(0,n.useCallback)(Dr=>{mn([]),cs(()=>()=>{}),Nt(!1),!Dr&&Ys.queryLibraryClosedWithoutSelection()},[]),as=(0,n.useCallback)((Dr,jr)=>{ra(Dr),Rn(!0),Qa(jr?.context||"unknown"),ba(jr?.title),$s(jr?.onSave),jr?.isDuplicating?Ys.duplicateQueryClicked():Ys.saveQueryToLibraryClicked()},[]),Ar=(0,n.useCallback)(()=>{ra(void 0),Rn(!1),$s(void 0)},[]),Yr=(0,n.useMemo)(()=>({isDrawerOpen:ft,openDrawer:zs,closeDrawer:Ds,openAddQueryModal:as,closeAddQueryModal:Ar,renderSaveQueryButton:Dr=>(0,r.jsx)(Qr,{query:Dr}),queryLibraryEnabled:!!s.$.featureToggles.queryLibrary}),[ft,zs,Ds,as,Ar]);return(0,r.jsxs)(Xr.L.Provider,{value:Yr,children:[ct,(0,r.jsx)(Wo,{isOpen:ft,close:Ds,activeDatasources:tn,onSelectQuery:Dr=>{Sa(Dr),Ds(!0),Ys.selectQueryClicked()}}),(0,r.jsx)(Uo,{isOpen:Dn,close:Ar,query:Kn,onSave:Ns,context:fs,title:ca})]})}function Ri(){(0,E.rC)(Pr)}var _i=e(36580),Ai=e(23117),_r=e(34999),kr=e(45229),ki=e(18615),Yi=e(97095),Ko=e(51115),Fo=e(76792);const ji=ct=>{const{onChange:ft,value:Nt}=ct,tn=(0,se.of)(ei);return(0,r.jsxs)(Yi.C,{className:tn.filter,children:[(0,r.jsx)(Ko.I,{width:"auto",children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.data-source-filter.filter-by-data-source",children:"Filter by data source"})}),(0,r.jsx)(na.I,{children:(0,r.jsx)(Fo.s,{width:30,placeholder:(0,g.t)("recorded-queries.data-source-filter.placeholder-select-a-data-source","Select a data source"),onChange:mn=>{ft({name:mn.name,id:mn.id,uid:mn.uid})},noDefault:!0,current:Nt})}),(0,r.jsx)(na.I,{children:(0,r.jsx)(Fn.$n,{className:tn.button,icon:"trash-alt",variant:"secondary",onClick:()=>{ft(void 0)}})})]})},ei=ct=>({filter:(0,ne.css)({marginBottom:s.$.theme.spacing.md}),button:(0,ne.css)({color:ct.colors.text.secondary})});var wo=e(23497),Wr=e(80612),io=e(7009);const Ji=ct=>({expr:`${ct.prom_name}{id="${ct.id}", name="${ct.name}"}`,legendFormat:"",interval:"",exemplar:!0,datasource:ct.dest_data_source_uid});function go(ct){return{recordedQueries:(0,io.T)(ct.recordedQueries)}}const Zi={getRecordedQueriesAsync:Wr.xY},pr=(0,Ne.connect)(go,Zi),Xi=({onAddQuery:ct,getRecordedQueriesAsync:ft,recordedQueries:Nt,onChangeDataSource:tn,filterValue:mn})=>{const[Dn,Rn]=(0,n.useState)(!1),[Kn,ra]=(0,n.useState)(mn),[ca,ba]=(0,n.useState)([]),Sa=(0,se.of)(Vo);(0,n.useEffect)(()=>{ft()},[Dn,ft]);const cs=(zs,Ds)=>{ba(Ds?ca.concat(zs):ca.filter(as=>!(0,Ka.isEqual)(as,zs)))},fs=()=>{(0,l.rR)("cloud_user_clicked_add_selected_recorded_queries",{recorded_queries_selected:ca.map(Ds=>Ds.name)});const zs=(0,qr.l)().getInstanceSettings(ki.uv);tn?.(zs),ca.map(Ji).forEach(Ds=>{ct?.(Ds)}),Rn(!1),ba([]),kr.A.emit(Hs.r1.alertSuccess,["Selected recorded queries added to the editor. The data source has been changed to mixed."])},Qa=mo(Nt,Kn).map(zs=>(0,r.jsx)(Co,{onQueryToggle:cs,recordedQuery:zs},zs.id)),Ns=()=>{Rn(!1),ba([])},$s=()=>{(0,l.rR)("cloud_user_clicked_add_recorded_query_button"),Rn(!0)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Fn.$n,{icon:"plus",onClick:$s,variant:"secondary",className:Sa.openButton,children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.recorded-query-add-modal-unconnected.recorded-query",children:"Recorded query"})}),(0,r.jsxs)(vs.a,{isOpen:Dn,title:(0,g.t)("recorded-queries.recorded-query-add-modal-unconnected.title-add-recorded-query","Add recorded query"),onDismiss:Ns,className:Sa.modal,children:[(0,r.jsx)(ji,{value:Kn?.name,onChange:ra}),(0,r.jsx)(_r.F,{title:"",severity:"info",children:(0,r.jsxs)(g.x6,{i18nKey:"recorded-queries.recorded-query-add-modal-unconnected.new-recorded-query-alert",children:["To create a new Recorded Query, return to the query editor and use the "," ",(0,r.jsx)(v.I,{name:"record-audio"})," "," icon in the series bar."]})}),Qa.length>0?Qa:Kn&&(0,r.jsx)("div",{className:Sa.noQueries,children:(0,r.jsxs)(g.x6,{i18nKey:"recorded-queries.recorded-query-add-modal-unconnected.no-queries-available",values:{datasourceName:Kn?.name},children:["No recorded queries available for ","{{datasourceName}}"]})}),(0,r.jsxs)("div",{className:Sa.modalButtons,children:[(0,r.jsx)(Fn.$n,{variant:"secondary",className:Sa.modalButton,onClick:Ns,children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.recorded-query-add-modal-unconnected.cancel",children:"Cancel"})}),(0,r.jsx)(Fn.$n,{variant:"primary",className:Sa.modalButton,onClick:fs,disabled:ca.length===0,children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.recorded-query-add-modal-unconnected.add",children:"Add"})})]})]})]})},Co=({onQueryToggle:ct,recordedQuery:ft})=>{const[Nt,tn]=(0,n.useState)(!1);return(0,r.jsx)(wo.z,{recordedQuery:ft,buttons:[(0,r.jsx)(eo.S,{name:ft.id,value:Nt,onChange:()=>{ct(ft,!Nt),tn(!Nt)}},`${ft.id}-checked`)]})},mo=(ct,ft)=>{const Nt=(0,qr.l)();return ct.filter(tn=>tn.active).filter(tn=>!ft||tn.queries[0].datasource.uid===ft.uid).sort((tn,mn)=>{const Dn=Nt?.getInstanceSettings(tn.queries[0]?.datasource),Rn=Nt?.getInstanceSettings(mn.queries[0]?.datasource),Kn=Dn?.meta.name.localeCompare(Rn?.meta.name??"");if(Kn!==void 0&&Kn!==0)return Kn;const ra=Dn?.name.localeCompare(Rn?.name??"");return ra!==void 0&&ra!==0?ra:tn.name.localeCompare(mn.name)})},Vo=ct=>({modalButtons:(0,ne.css)({display:"flex",justifyContent:"end"}),openButton:(0,ne.css)({marginLeft:"-8px"}),modalButton:(0,ne.css)({marginLeft:ct.spacing(1)}),modal:(0,ne.css)({width:"750px"}),noQueries:(0,ne.css)({marginLeft:ct.spacing(1),marginBottom:ct.spacing(3)})}),To=pr(Xi);var Li=e(7389),ti=e(22592),Nr=e(3594),Bi=e(50426),Ui=e(72636),hi=e(90929),qi=e(35621),Mo=e(54742),Wi=e(67933),Ni=e(93612),el=e(33970),tl=e(43863);const So=[{label:"30 seconds",value:30},{label:"1 minute",value:60},{label:"5 minutes",value:300},{label:"30 minutes",value:1800},{label:"1 hour",value:3600},{label:"12 hours",value:43200},{label:"24 hours",value:86400},{label:"1 week",value:604800},{label:"1 month",value:2592e3}],fi=({label:ct,description:ft,value:Nt,onChange:tn})=>(0,r.jsx)("div",{children:(0,r.jsx)(Ws.D,{label:ct,description:ft,required:!0,children:(0,r.jsx)(y.l6,{options:So,onChange:mn=>{tn(mn.value)},value:Nt,"aria-label":`${ct}-select`,menuShouldPortal:!0})})});function pi(ct){return{variables:(0,Ni.UN)(ct)}}const $o=(0,Ne.connect)(pi),Rr=({href:ct,trackingSource:ft})=>{const Nt=(0,se.of)(es);return(0,r.jsx)("a",{href:ct,className:Nt.docsLink,target:"_blank",rel:"noreferrer",onClick:()=>(0,l.rR)("cloud_user_clicked_create_recorded_query_modal_documentation_icon",{source:ft}),children:(0,r.jsx)(v.I,{name:"info-circle"})})},Ki=({query:ct,queries:ft,dataSource:Nt,variables:tn})=>{const[mn,Dn]=(0,n.useState)(!1),[Rn,Kn]=(0,n.useState)(),[ra,ca]=(0,n.useState)("info"),[ba,Sa]=(0,n.useState)(""),cs=(0,se.of)(qi.o),fs=(0,se.of)(es);(0,n.useEffect)(()=>{(async()=>{o.TP.hasPermission(Xe.AccessControlAction.LicensingRead)&&Kn(await(0,el.Pe)().catch(()=>{}))})()},[]);const Qa=()=>{Sa(""),ca("info"),Dn(!1)},Ns=async Ks=>{try{return await Ds(Ks,as)}catch(ir){ca("error"),(0,La.NF)(ir)&&Sa(ir.data.message);return}},$s=async Ks=>{const ir=await Ns(Ks);ir&&(0,Wr.u6)(ir).then(()=>{ca("success"),Sa((0,g.t)("recorded-queries.create-recorded-query-unconnected.success-alert-message","Your new recorded query is recording successfully!")),(0,l.rR)("cloud_user_created_recorded_query")}).catch(ar=>{ca("error"),Sa(ar.data.message)})},zs=async Ks=>{const ir=await Ns(Ks);ir&&(0,Wr.Lc)(ir).then(ar=>{ca("info"),Sa(ar.data.message)}).catch(ar=>{ca("error"),Sa(ar.data.message)})},Ds=async(Ks,ir)=>{const ar={target_ref_id:ct?ct.refId:"",name:Ks.name,description:Ks.description,interval:Ks.interval,range:Ks.range,count:Ks.isCount,active:!0},yo=ft?.map(async Cs=>{const no=Cs.datasource||Nt?.name,dr=await(0,qr.l)().get(no),lo=dr.interpolateVariablesInQueries?dr.interpolateVariablesInQueries([Cs],{...ir})[0]:Cs;return lo.datasourceId=dr?dr.id:-1,lo.datasource===void 0&&(Cs.datasource!==void 0&&Cs.datasource!==null?lo.datasource=Cs.datasource:dr&&(lo.datasource={uid:dr.uid,type:dr.type})),lo});return ar.queries=yo?await Promise.all(yo):[],ar},as=tn?.filter(Ks=>Ks.hide!==Li.zL.hideVariable),Ar=(0,r.jsxs)("h2",{className:cs.modalHeaderTitle,children:[(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.title-create-recorded-query",children:"Create recorded query"}),(0,r.jsx)(Rr,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"modal-title"})]}),Yr=ra!=="success"?(0,r.jsx)("div",{"aria-label":(0,g.t)("recorded-queries.create-recorded-query-unconnected.sync-button.aria-label-test-the-recorded-query","Test the recorded query"),children:(0,r.jsx)(v.I,{name:"sync"})}):void 0,Dr=ra==="success"?(0,r.jsx)(Fn.$n,{type:"button",variant:"primary",onClick:Qa,"aria-label":(0,g.t)("recorded-queries.create-recorded-query-unconnected.done-button.aria-label-close-recording-query-button","Close recording query button"),children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.done-button.close",children:"Close"})}):(0,r.jsx)(Fn.$n,{type:"button",variant:"secondary",onClick:Qa,fill:"outline","aria-label":(0,g.t)("recorded-queries.create-recorded-query-unconnected.done-button.aria-label-cancel-recording-query-button","Cancel recording query button"),children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.done-button.cancel",children:"Cancel"})}),jr=()=>{switch(ra){case"info":return ba===""?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.results-alert-message",children:"Results: "}),(0,r.jsx)("pre",{children:ba})]});default:return(0,r.jsx)(r.Fragment,{children:ba})}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ui.q,{title:(0,g.t)("recorded-queries.create-recorded-query-unconnected.title-create-recorded-query","Create recorded query"),icon:"record-audio",onClick:()=>{Dn(!0),(0,l.rR)("cloud_user_clicked_create_recorded_query_icon")}}),(0,r.jsxs)(vs.a,{isOpen:mn,title:Ar,onDismiss:Qa,className:fs.modal,children:[(0,tl.recordedQueriesDeprecationNotice)(),(0,r.jsx)(Bi.l,{onSubmit:$s,validateOn:"all",children:({register:Ks,errors:ir,control:ar,getValues:yo})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ws.D,{label:(0,g.t)("recorded-queries.create-recorded-query-unconnected.label-name","Name"),description:(0,g.t)("recorded-queries.create-recorded-query-unconnected.description-give-this-query-a-name","Give this query a name"),invalid:!!ir.name,error:ir.name?.message,required:!0,children:(0,r.jsx)(Tr.p,{...Ks("name",{required:{value:!0,message:(0,g.t)("recorded-queries.create-recorded-query-unconnected.message.name-is-required","Name is required")}}),id:"add-recorded-query-name",autoFocus:!0})}),(0,r.jsx)(Ws.D,{label:(0,g.t)("recorded-queries.create-recorded-query-unconnected.label-description","Description"),description:(0,g.t)("recorded-queries.create-recorded-query-unconnected.description-provide-a-description-for-this-query","Provide a description for this query"),children:(0,r.jsx)(Tr.p,{...Ks("description"),id:"add-recorded-query-desc"})}),(0,r.jsx)("div",{className:fs.timeSelect,children:(0,r.jsx)(rs.xI,{name:"interval",control:ar,defaultValue:So[0].value,render:({field:{ref:Cs,value:no,onChange:dr,...ao}})=>(0,r.jsx)(fi,{label:(0,g.t)("recorded-queries.create-recorded-query-unconnected.label-interval","Interval"),description:(0,g.t)("recorded-queries.create-recorded-query-unconnected.description-decide-often-record-query","Decide how often to record this query"),value:no,onChange:dr})})}),(0,r.jsx)("div",{className:fs.timeSelect,children:(0,r.jsx)(rs.xI,{name:"range",control:ar,defaultValue:(0,ti.Cn)().from,render:({field:{ref:Cs,value:no,onChange:dr,...ao}})=>{const lo=(0,r.jsxs)(r.Fragment,{children:[(0,g.t)("recorded-queries.create-recorded-query-unconnected.query-relative-time-range","Select this query's relative time range"),(0,r.jsx)(Rr,{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/#time-units-and-relative-ranges",trackingSource:"time-range"})]}),rl=(0,r.jsxs)(Ui.J,{description:lo,children:[(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.label.relative-time-range",children:"Relative Time Range"})," ","*"]});return(0,r.jsx)(Ws.D,{label:rl,invalid:!!ir.range,error:ir.name?.message,required:!0,children:(0,r.jsx)(hi.N,{timeRange:{from:no,to:0},onChange:$i=>dr($i.from)})})}})}),as?.length>0?(0,r.jsx)(Ws.D,{label:(0,g.t)("recorded-queries.create-recorded-query-unconnected.label-template-variables","Template variables"),description:(0,g.t)("recorded-queries.create-recorded-query-unconnected.description-select-value-template-variable","Select a value for each template variable"),children:(0,r.jsx)(r.Fragment,{children:as.map(Cs=>{const{picker:no,setValue:dr}=Mo.B.get(Cs.type);return(0,r.jsx)(na.I,{label:Cs.name,labelWidth:16,children:(0,r.jsx)(no,{onVariableChange:ao=>{(0,Wi.SP)(ao)&&!(0,Nr.R)(ao.current)&&dr(ao,ao.current)},variable:Cs,readOnly:!1})},Cs.name)})})}):null,(0,r.jsx)(Ws.D,{label:(0,g.t)("recorded-queries.create-recorded-query-unconnected.label-count-query-results","Count query results"),description:(0,r.jsxs)(r.Fragment,{children:[(0,g.t)("recorded-queries.create-recorded-query-unconnected.count-rows-returned","Count the rows returned from this query"),(0,r.jsx)(Rr,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"count-field"})]}),children:(0,r.jsx)(Ga.d,{...Ks("isCount"),id:"add-recorded-query-count"})}),(0,r.jsxs)(_r.F,{className:fs.testQuery,severity:ra,title:ra==="success"?(0,g.t)("recorded-queries.create-recorded-query-unconnected.alert-severity-succesful","Successful"):(0,g.t)("recorded-queries.create-recorded-query-unconnected.alert-severity-test","Test this recorded query"),buttonContent:Yr,onRemove:ra!=="success"?()=>zs(yo()):void 0,children:[jr(),ba==="An unknown issue is preventing the system from processing your query."&&sa(Rn)]}),(0,r.jsxs)(vs.a.ButtonRow,{children:[Dr,ra!=="success"&&(0,r.jsx)(Fn.$n,{type:"submit","aria-label":(0,g.t)("recorded-queries.create-recorded-query-unconnected.aria-label-start-recording-query-button","Start recording query button"),children:(0,r.jsx)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.start-recording-query",children:"Start recording query"})})]})]})})]})]})},sa=ct=>{let ft="https://grafana.com/contact";return ct&&ct.slug&&ct.lid&&(ft=`https://grafana.com/orgs/${ct.slug}/tickets?support=licensing&licenseId=${ct.lid}`),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(g.x6,{i18nKey:"recorded-queries.create-recorded-query-unconnected.contact-support",children:["To submit a support ticket to Grafana Labs, complete the ",(0,r.jsx)("a",{href:ft,children:"Contact Grafana Labs"})]})})},es=ct=>({modal:(0,ne.css)({width:"550px"}),testQuery:(0,ne.css)({marginTop:ct.spacing(3)}),timeSelect:(0,ne.css)({width:"50%"}),docsLink:(0,ne.css)({marginLeft:ct.spacing(.5)})}),gi=$o(Ki),ni=()=>{const ft=Ua.M_.getState().recordedQueries.prometheusWriteTarget;return!!ft?.data_source_uid&&!!ft?.remote_write_path};function mi(){if(!((0,a.a)("recordedqueries")&&s.$?.recordedQueries?.enabled))return;(!Ua.M_.getState().recordedQueries.prometheusWriteTarget||o.TP.user.orgRole!=="")&&(0,Ua.JD)((0,Wr.Nd)()),Ai.d.addExtraRenderAction(Nt=>ni()&&(Nt.dataSource?.meta.backend||(0,_i.s9)(Nt.dataSource))?(0,r.jsx)(gi,{...Nt}):null),Ai.m.addExtraRenderAction(Nt=>ni()?(0,r.jsx)(To,{...Nt}):null)}var Oo=e(34178),vo=e(55355),Io=e(54148),nl=e(6262),br=e(70234);function vl(){const{id:ct}=(0,Io.g)();return(0,r.jsx)(Io.C5,{replace:!0,to:`${br.lb}?reportId=${ct}`})}function ws(){const ct=[];return s.$.reporting?.enabled&&((0,a.a)("reports")?(ct.push({path:br.lb,component:(0,n.lazy)(()=>e.e(3057).then(e.bind(e,26225)))},{path:`${br.lb}/settings`,component:()=>(0,r.jsx)(Io.C5,{replace:!0,to:`${br.lb}?reportView=settings`})},{path:"/d-csv/:uid",pageClass:"dashboard-solo",routeName:nl.Z4.Normal,component:(0,n.lazy)(()=>Promise.all([e.e(6088),e.e(4650)]).then(e.bind(e,14414)))}),s.$.featureToggles.newPDFRendering&&ct.push({path:"/d-report/:uid/:slug?",component:(0,n.lazy)(()=>e.e(1538).then(e.bind(e,33099)))})):s.$.featureToggles.featureHighlights&&ct.push({path:br.lb,component:(0,n.lazy)(()=>e.e(1517).then(e.bind(e,8011)))}),(0,a.a)("reports.creation")&&(ct.push({path:`${br.lb}/new`,component:()=>(0,r.jsx)(Io.C5,{replace:!0,to:s.$.featureToggles.newShareReportDrawer?`${br.lb}?reportView=new`:`/${br.km}`})}),ct.push({path:`${br.lb}/:step?/:id?`,component:s.$.featureToggles.newShareReportDrawer?()=>(0,r.jsx)(vl,{}):(0,n.lazy)(()=>e.e(2560).then(e.bind(e,95546)))}))),ct}var vi=e(94676),al=e(58120),sl=e(35484),er=e(92948),Kr=e(10388),Fi=e(45004);function ai(){const ct=s.$.whitelabeling;if(ct){if(er.M.LoginTitle="Welcome to Grafana Enterprise",ct.links.length>0&&(0,Kr.DH)(()=>ct.links.map(ft=>({...ft,target:"_blank"}))),(0,Fi.Q)(ct.publicDashboard),ct.appTitle&&(er.M.AppTitle=ct.appTitle),ct.loginLogo&&(er.M.LoginLogo=ft=>(0,r.jsx)("img",{className:(0,ne.cx)(ft.className,(0,ne.css)({maxWidth:"150px",maxHeight:"250px",width:"auto",[`@media ${sl.mediaUp(s.$.theme.breakpoints.sm)}`]:{maxWidth:"250px"}})),src:ct.loginLogo,alt:"Login logo"}),er.M.LoginLogo.displayName="BrandingLoginLogo",er.M.LoginTitle="",er.M.GetLoginSubTitle=()=>""),ct.loginTitle&&(er.M.LoginTitle=ct.loginTitle),ct.hideEdition&&(er.M.HideEdition=ct.hideEdition),ct.loginSubtitle&&(er.M.GetLoginSubTitle=()=>ct.loginSubtitle),ct.menuLogo&&(er.M.MenuLogo=ft=>(0,r.jsx)("img",{className:ft.className,src:ct.menuLogo,alt:"Menu logo"}),er.M.MenuLogo.displayName="BrandingMenuLogo"),ct.loginBackground){const ft=(0,ne.css)({background:ct.loginBackground,backgroundSize:"cover"});er.M.LoginBackground=Nt=>(0,r.jsx)("div",{className:(0,ne.cx)(ft,Nt.className),children:Nt.children}),er.M.LoginBackground.displayName="BrandingLoginBackground"}if(ct.loginBoxBackground){const ft=(0,ne.css)({background:ct.loginBoxBackground,backgroundSize:"cover"});er.M.LoginBoxBackground=()=>ft}}}function wi(){(0,a.a)("caching")&&(0,m.Co)(Qe),(0,a.a)("reports")&&((0,m.Co)(vi.Ay),(0,m.Co)({[J.t.reducerPath]:J.t.reducer}),(0,m.C3)(J.t.middleware)),(0,a.a)("analytics")&&(0,m.Co)(ze),(0,a.a)("recordedqueries")&&(0,m.Co)(Oo.Fu),(0,a.a)("saml")&&(0,m.Co)(te.y6),(0,m.Co)(al.aV),(0,a.a)("announcementBanner")&&((0,m.Co)({[W.JU.reducerPath]:W.JU.reducer}),(0,m.C3)(W.JU.middleware)),s.$.featureToggles.pluginsFrontendSandbox&&((0,m.Co)({[va.reducerPath]:va.reducer}),(0,m.C3)(va.middleware)),s.$.featureToggles.queryLibrary&&((0,m.Co)({[K.reducerPath]:K.reducer}),(0,m.C3)(K.middleware))}function Ro(){const ct=s.$.featureToggles.featureHighlights;(0,tt.x9)(),(0,vo.Bn)(),Jt(),(0,a.a)("saml")&&Q(),((0,a.a)("whitelabeling")||(0,a.a)("grafanacloud"))&&ai(),(0,a.a)("recordedqueries")&&s.$.publicDashboardAccessToken===""&&mi(),(0,a.a)("admin")&&u(),c.jK.push(...ws()),(0,a.a)("publicDashboardsEmailSharing")&&(c.jK.push({path:"/public-dashboards/:accessToken/request-access",component:(0,n.lazy)(()=>e.e(5318).then(e.bind(e,24359))),chromeless:!0},{path:"/public-dashboards/:accessToken/confirm-access",component:(0,n.lazy)(()=>e.e(1290).then(e.bind(e,35919))),chromeless:!0}),(0,i.AY)()&&e.e(4351).then(e.bind(e,54351))),(0,a.a)("saml")&&c.jK.push({path:"/admin/authentication/saml/:step?",component:(0,n.lazy)(()=>Promise.all([e.e(975),e.e(8224)]).then(e.bind(e,30975)))});const ft="/datasources/edit/:uid/cache",Nt=`${d.b.DataSourcesEdit}/cache`;(0,a.a)("caching")?(c.jK.push({path:ft,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(6843)]).then(e.bind(e,56257)))}),c.jK.push({path:Nt,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(5012)]).then(e.bind(e,63877)))})):ct&&(c.jK.push({path:`${ft}/upgrade`,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(758),e.e(8435)]).then(e.bind(e,86499)))}),c.jK.push({path:`${Nt}/upgrade`,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(758),e.e(5346)]).then(e.bind(e,72687)))}));const tn="/datasources/edit/:uid/insights",mn=`${d.b.DataSourcesEdit}/insights`;s.$.analytics?.enabled&&((0,a.a)("analytics")?(c.jK.push({path:tn,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(8890)]).then(e.bind(e,9794)))}),c.jK.push({path:mn,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(847)]).then(e.bind(e,13926)))})):ct&&(c.jK.push({path:`${tn}/upgrade`,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(876)]).then(e.bind(e,51742)))}),c.jK.push({path:`${mn}/upgrade`,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(5967)]).then(e.bind(e,28154)))})));const Dn="/datasources/edit/:uid/permissions",Rn=`${d.b.DataSourcesEdit}/permissions`;(0,a.a)("dspermissions.enforcement")?(c.jK.push({path:Dn,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(7097),e.e(5357)]).then(e.bind(e,43960)))}),c.jK.push({path:Rn,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(7097),e.e(4738)]).then(e.bind(e,53683)))})):ct&&(c.jK.push({path:Dn+"/upgrade",component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(7785)]).then(e.bind(e,32333)))}),c.jK.push({path:`${Rn}/upgrade`,component:(0,n.lazy)(()=>Promise.all([e.e(8354),e.e(4004)]).then(e.bind(e,37745)))}));const Kn=(0,a.a)("recordedqueries")&&s.$?.recordedQueries?.enabled;o.TP.isEditor&&Kn&&c.jK.push({path:"/recorded-queries",component:(0,n.lazy)(()=>Promise.resolve().then(e.bind(e,43863)))},{path:"/recorded-queries/write-target",component:(0,n.lazy)(()=>e.e(1893).then(e.bind(e,23703)))}),(0,a.a)("announcementBanner")&&(c.jK.push({path:"/admin/banner-settings",component:(0,n.lazy)(()=>e.e(2715).then(e.bind(e,9133))),roles:()=>o.TP.evaluatePermission([Xe.AccessControlAction.ActionBannersWrite])}),j()),s.$.featureToggles.groupAttributeSync&&(0,a.a)("groupsync")&&c.jK.push({path:"/admin/access/groupsync",roles:()=>o.TP.evaluatePermission([p.w.GroupSyncMappingsRead,p.w.GroupSyncMappingsWrite]),component:(0,n.lazy)(()=>Promise.all([e.e(265),e.e(8573)]).then(e.bind(e,56878)))}),s.$.featureToggles.pluginsFrontendSandbox&&ci(),s.$.featureToggles.queryLibrary&&Ri()}function yi(){Se(),c.jK.push({path:"/admin/licensing",roles:()=>o.TP.evaluatePermission([Xe.AccessControlAction.LicensingRead,p.w.ActionServerStatsRead]),component:(0,n.lazy)(()=>Promise.all([e.e(4729),e.e(6125)]).then(e.bind(e,64729)))}),o.TP.isSignedIn&&s.$.licenseInfo.stateInfo!=="Licensed"&&(0,l.Xp)((0,le.L)(),s.$.featureToggles.featureHighlights?le.X.Test:le.X.Control,"")}function Vi(){yi(),Ro()}},61741:(Z,R,e)=>{"use strict";e.d(R,{BV:()=>r,Bb:()=>g,Qf:()=>a,WN:()=>y,_7:()=>n,dO:()=>l,eZ:()=>c,i$:()=>h,oe:()=>p});const n=80,a=100,s=0,l=1,o=2,d=3,i=4,c=5,m=6,p=5,h=3600,r="grafana.licence.warning.dismissUntil",g="users",y="AWS/Marketplace"},7913:(Z,R,e)=>{"use strict";e.d(R,{x9:()=>P});var n=e(74848),a=e(96540),s=e(25229),l=e(43173),o=e(88486),d=e(15130),i=e(29043),c=e(69788),m=e(22803),p=e(92745),h=e(63142),r=e(34999);const g=({title:U,subTitle:F,severity:V,onButtonClick:K,buttonText:G})=>{const H=(0,h.IS)(E);return(0,n.jsx)("div",{className:H.container,children:(0,n.jsx)("div",{className:"page-container",children:(0,n.jsx)(r.F,{title:U,severity:V,buttonContent:G,onRemove:K,children:F})})})},y=({isLicensingReader:U,children:F})=>U?(0,n.jsx)("a",{href:"/admin/licensing",children:F}):(0,n.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",target:"_blank",rel:"noreferrer noopener",children:F}),v=({isLicensingReader:U})=>(0,n.jsx)(g,{title:(0,p.t)("licensing.has-expired.title-your-grafana-enterprise-license-has-expired","Your Grafana Enterprise license has expired"),subTitle:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.x6,{i18nKey:"licensing.has-expired.sub-title-licensing-reader",children:[(0,n.jsx)(y,{isLicensingReader:U,children:"Some features"})," have been disabled."]})}),severity:"error"}),x=({isLicensingReader:U})=>(0,n.jsx)(g,{title:(0,p.t)("licensing.is-invalid.title-your-grafana-enterprise-license-is-invalid","Your Grafana Enterprise license is invalid"),subTitle:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.x6,{i18nKey:"licensing.is-invalid.sub-title-licensing-reader",children:[(0,n.jsx)(y,{isLicensingReader:U,children:"Some features"})," have been disabled."]})}),severity:"error"}),f=({days:U,onCloseWarning:F,isLicensingReader:V})=>(0,n.jsx)(g,{onButtonClick:F,title:(0,p.t)("licensing.expires-soon.title-grafana-enterprise-license-expire","Your Grafana Enterprise license will expire soon"),subTitle:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.x6,{i18nKey:"licensing.expires-soon.sub-title-license-expiration",count:U,children:[{count:U}," days remaining, after which"," ",(0,n.jsx)(y,{isLicensingReader:V,children:"Enterprise features will be disabled."})]})}),severity:"info",buttonText:"Dismiss"}),u=({days:U,onCloseWarning:F,isLicensingReader:V})=>(0,n.jsx)(g,{onButtonClick:F,title:(0,p.t)("licensing.token-expires-soon.title-grafana-enterprise-token-needs-renewed","Your Grafana Enterprise token needs to be renewed"),subTitle:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.x6,{i18nKey:"licensing.token-expires-soon.sub-title-token-expiration",count:U,children:["Your license token has ",{count:U}," days remaining, after which"," ",(0,n.jsx)(y,{isLicensingReader:V,children:"Enterprise features will be disabled."})]})}),severity:"info",buttonText:"Dismiss"}),b=({activeUsers:U,maxUsers:F,slug:V,onRefreshWarning:K})=>(0,n.jsx)(g,{onButtonClick:K,title:(0,p.t)("licensing.max-users-reached.title-exceeded-included-number-active-users","You have exceeded the included number of active users"),subTitle:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.x6,{i18nKey:"licensing.max-users-reached.upgrade-your-license-subtitle",count:U,children:["Your Grafana Enterprise license includes ",{maxUsers:F}," active users; you currently have"," ",{count:U}," active users."," "]}),V?(0,n.jsxs)(p.x6,{i18nKey:"licensing.max-users-reached.upgrade-your-license-link",children:["Please"," ",(0,n.jsx)("a",{href:"https://grafana.com/orgs/"+V+"/licenses",target:"_blank",rel:"noreferrer noopener",children:"upgrade your license."})]}):(0,n.jsx)(p.x6,{i18nKey:"licensing.max-users-reached.upgrade-your-license-no-link",children:"Please upgrade your license."})]}),severity:"error",buttonText:"Refresh"}),E=U=>({container:(0,m.css)({position:"fixed",bottom:0,left:0,right:0,display:"flex",flexDirection:"column",justifyContent:"center",zIndex:3})});var D=e(61741),C=e(33970);function P(){(0,o.J3)(T)}function T(){const[U,F]=(0,a.useState)(!1),[V,K]=(0,a.useState)(l.$.licensing),G=i.A.get(D.BV),H=G&&G>(0,s.KQ)().valueOf(),_=d.TP.hasPermission(c.AccessControlAction.LicensingRead),k=d.TP.hasPermission(c.AccessControlAction.LicensingRead),J=_&&I()&&!H,z=_&&B()&&!H,Y=N();let X=!1,Q=0,q=0;if(V.limitBy===D.Bb){const se=w(V.includedUsers,V.activeUsers);X=Y&&se&&(_||k),Q=V.activeUsers,q=V.includedUsers}if(L()||A())return null;const te=()=>{const se=(0,s.KQ)().add(D.oe,"d").valueOf();i.A.set(D.BV,se),F(!0)},ne=async()=>{const se=await(0,C.o0)().catch(ue=>null);if(se){const ue={...V,activeUsers:se.active_users};l.$.licensing=ue,K(ue)}};if(U)return null;if(O())return(0,n.jsx)(x,{isLicensingReader:k});if(W())return(0,n.jsx)(v,{isLicensingReader:k});if(X)return(0,n.jsx)(b,{activeUsers:Q,maxUsers:q,slug:V.slug,onRefreshWarning:_?ne:void 0});if(J){const se=j();return setTimeout(te,1e3*D.i$),(0,n.jsx)(f,{days:se,onCloseWarning:te,isLicensingReader:k})}else if(z){const se=S();return setTimeout(te,1e3*D.i$),(0,n.jsx)(u,{days:se,onCloseWarning:te,isLicensingReader:k})}return null}function O(){const{expiry:U,hasLicense:F}=l.$.licenseInfo;return F&&!U}function I(){const{licenseExpiry:U,licenseExpiryWarnDays:F=30}=l.$.licensing;return U>0&&(0,s.KQ)(U*1e3)<(0,s.KQ)().add(F,"d")}function j(){const{licenseExpiry:U}=l.$.licensing;return Math.ceil((U-(0,s.KQ)().unix())/3600/24)}function W(){const{licenseExpiry:U}=l.$.licensing;return U>0&&(0,s.KQ)(U*1e3)<(0,s.KQ)()}function B(){const{tokenExpiry:U,tokenExpiryWarnDays:F=3}=l.$.licensing;return U>0&&(0,s.KQ)(U*1e3)<(0,s.KQ)().add(F,"d")}function S(){const{tokenExpiry:U}=l.$.licensing;return Math.ceil((U-(0,s.KQ)().unix())/3600/24)}function w(U,F){return U===void 0||F===void 0?!1:U!==-1&&F>U}function N(){return!l.$.licensing.usageBilling}function M(){const U=/\/d-solo\//,F=window.location.pathname;return U.test(F)}function L(){return M()}function A(){const U=/\/admin\/licensing$/,F=window.location.pathname;return U.test(F)}},33970:(Z,R,e)=>{"use strict";e.d(R,{$6:()=>s,Pe:()=>a,Sj:()=>l,o0:()=>o});var n=e(83873);const a=async()=>(0,n.AI)().get("/api/licensing/token"),s=async d=>(0,n.AI)().post("/api/licensing/token",{token:d}),l=async()=>(0,n.AI)().post("/api/licensing/token/renew",{}),o=async()=>(0,n.AI)().get("/api/licensing/refresh-stats")},41339:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{ENTERPRISE_I18N_NAMESPACE:()=>a,LOCALE_EXTENSIONS:()=>s});var n=e(57002);const a="grafana-enterprise",s={[n.MB]:()=>e.e(9740).then(e.t.bind(e,29740,19)),[n.NY]:()=>e.e(7179).then(e.t.bind(e,87179,19)),[n.d_]:()=>e.e(6119).then(e.t.bind(e,16119,19)),[n.rT]:()=>e.e(3749).then(e.t.bind(e,23749,19)),[n.fY]:()=>e.e(8249).then(e.t.bind(e,18249,19)),[n.jQ]:()=>e.e(8591).then(e.t.bind(e,28591,19))}},90256:(Z,R,e)=>{"use strict";e.d(R,{Au:()=>i,FW:()=>m,K4:()=>l,QH:()=>s,XP:()=>c,_x:()=>o,db:()=>p});var n=e(25229),a=e(68143);const s="YYYY-MM-DD",l=async(h,r)=>await(0,a.AI)().get(`/api/usage/dashboard/uid/${h}/views/recent?limit=${r}`,{retry:0}),o=async(h,r)=>await(0,a.AI)().get(`/api/usage/dashboard/uid/${h}/views?limit=${r}`),d=h=>{const r=[];for(let g in h)r.push(h[g]);return r.sort((g,y)=>(0,n.KQ)(g.day,s).valueOf()-(0,n.KQ)(y.day,s).valueOf()),r},i=async(h,r)=>{const g=await(0,a.AI)().get(`/api/usage/dashboard/uid/${h}/daily`,{days:r});return d(g)},c=async(h,r)=>{const g=await(0,a.AI)().get(`/api/usage/dashboard/uid/${h}/public/daily`,{days:r});return d(g)},m=async(h,r,g)=>{const y=await(0,a.AI)().get(`/api/usage/datasource/${h}/daily`,{from:r,to:g});return d(y)},p=async h=>await(0,a.AI)().get(`/api/usage/dashboard/uid/${h}/info`)},74740:(Z,R,e)=>{"use strict";e.d(R,{k:()=>s});var n=e(22803),a=e(65240);const s=(0,a.N)(l=>{const o=l.colors.background.secondary;return{tabContent:(0,n.css)({height:"100%"}),tabsBar:(0,n.css)({paddingLeft:l.spacing(2),margin:l.spacing(3,-1,-3,-3)}),graphContainer:(0,n.css)({marginTop:l.spacing(2),backgroundColor:o}),panelContent:(0,n.css)({contain:"none"}),userBoxesContainer:(0,n.css)({display:"flex",marginTop:l.spacing(3),"> div + div":{marginLeft:l.spacing(2)}}),userBox:(0,n.css)({padding:l.spacing(2),flex:1,textAlign:"center",backgroundColor:o,borderRadius:l.shape.radius.default,"button, img":{margin:l.spacing(0,0,1,0)}}),userName:(0,n.css)({fontWeight:l.typography.fontWeightBold}),tableContainer:(0,n.css)({marginTop:l.spacing(3),backgroundColor:o,paddingBottom:l.spacing(1),borderRadius:l.shape.radius.default,"[role='cell']:first-child > div":{padding:"4px"},"[role='columnheader']:first-child":{height:"33px"},"[role='row']:not(:only-child):nth-child(odd)":{backgroundColor:l.colors.background.primary}}),tableHeader:(0,n.css)({padding:l.spacing(0,2,.5,2),display:"flex",justifyContent:"space-between",alignItems:"center",h4:{marginBottom:"0px",padding:l.spacing(3,0)}}),userIcon:(0,n.css)({margin:"0 0",width:"26px",height:"26px",lineHeight:"20px","& > *":{width:"26px",height:"26px",lineHeight:"20px"}})}})},23497:(Z,R,e)=>{"use strict";e.d(R,{z:()=>i});var n=e(74848),a=e(22803),s=e(17548),l=e(92745),o=e(78282),d=e(63142);const i=({recordedQuery:p,buttons:h})=>{const r=(0,d.of)(m),g=(0,o.l)()?.getInstanceSettings(p.queries[0]?.datasource);return(0,n.jsxs)("div",{className:r.alert,children:[g?.meta&&(0,n.jsx)("img",{className:r.media,src:g.meta.info.logos.small,alt:"Query logo"}),(0,n.jsx)("div",{className:r.body,children:(0,n.jsxs)("div",{className:r.info,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:r.heading,children:p.name}),(0,n.jsx)("p",{className:r.description,children:c(p)}),(0,n.jsx)("div",{children:(0,n.jsx)(l.x6,{i18nKey:"recorded-queries.query-card.query-expression",children:"Query expression:"})}),(0,n.jsx)("div",{children:p.queries.map((y,v)=>(0,n.jsx)("div",{children:y.expr},`query-${v}`))})]}),(0,n.jsx)("div",{className:r.buttonWrapper,children:h.map((y,v)=>(0,n.jsx)("div",{className:r.button,children:y},`button-${v}`))})]})})]})},c=p=>{const h=[(0,l.t)("recorded-queries.query-card.interval-content","Interval: {{interval}}",{interval:s.secondsToHms(p.interval)}),(0,l.t)("recorded-queries.query-card.interval-range","Range: Last {{range}}",{range:s.secondsToHms(p.range)})],r=(0,o.l)()?.getInstanceSettings(p.queries[0]?.datasource);return r!==void 0&&h.unshift(r.name),p.description!==""&&h.push(`${p.description}`),h.join(" | ")},m=p=>{const h=p.shape.borderRadius();return{info:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}),heading:(0,a.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:p.typography.size.md,letterSpacing:"inherit",lineHeight:p.typography.body.lineHeight,color:p.colors.text.primary,fontWeight:p.typography.fontWeightMedium}),description:(0,a.css)({width:"100%",margin:p.spacing(1,0,0),color:p.colors.text.secondary,lineHeight:p.typography.body.lineHeight}),alert:(0,a.css)({flexGrow:1,position:"relative",borderRadius:h,display:"flex",flexDirection:"row",alignItems:"center",background:p.colors.background.secondary,boxShadow:p.shadows.z1,marginBottom:p.spacing(1),"&:before":{content:"''",position:"absolute",top:0,left:0,bottom:0,right:0,background:p.colors.background.primary,zIndex:-1}}),body:(0,a.css)({color:p.colors.text.secondary,padding:p.spacing(2),flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",overflowWrap:"break-word",wordBreak:"break-word"}),content:(0,a.css)({color:p.colors.text.secondary,paddingTop:p.spacing(1),marginLeft:"26px"}),media:(0,a.css)({marginLeft:p.spacing(2),width:"40px"}),buttonWrapper:(0,a.css)({padding:p.spacing(1),background:"none",display:"flex",alignItems:"center",marginRight:p.spacing()}),button:(0,a.css)({marginLeft:p.spacing()})}}},43863:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{RecordedQueriesConfig:()=>I,RecordedQueriesConfigUnconnected:()=>T,default:()=>j,recordedQueriesDeprecationNotice:()=>P});var n=e(74848),a=e(22803),s=e(96540),l=e(71468),o=e(92745),d=e(34999),i=e(63142),c=e(45861),m=e(71599),p=e(13791),h=e(11098),r=e(84057),g=e(43951),y=e(30703);const v=()=>{const W=(0,i.of)(x);return(0,n.jsx)(g.c,{className:W.cta,message:(0,o.t)("recorded-queries.empty-recorded-query-list.message","No recorded queries defined"),footer:(0,n.jsxs)("span",{children:[(0,n.jsx)(y.I,{name:"rocket"}),(0,n.jsxs)(o.x6,{i18nKey:"recorded-queries.empty-recorded-query-list.pro-tip",children:["ProTip: ","You can record queries from the query editor."]})]},"proTipFooter"),callToActionElement:(0,n.jsx)(n.Fragment,{})})},x=W=>({cta:(0,a.css)({textAlign:"center"})});var f=e(23497),u=e(80612),b=e(7009);function E(W){return{navModel:(0,r.tc)(W.navIndex,"recordedQueries"),recordedQueries:(0,b.T)(W.recordedQueries),isLoading:W.recordedQueries.isLoading}}const D={getRecordedQueriesAsync:u.xY,updateRecordedQuery:u.qE,deleteRecordedQuery:u.eB},C=(0,l.connect)(E,D);function P(){return(0,n.jsx)(d.F,{title:(0,o.t)("recorded-queries.recorded-queries-deprecation-notice.title-deprecation-notice","Deprecation Notice"),severity:"warning",children:(0,n.jsxs)(o.x6,{i18nKey:"recorded-queries.recorded-queries-deprecation-notice.description",children:["Recorded queries are deprecated. Please use the new"," ",(0,n.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/alerting/alerting-rules/create-recording-rules/create-grafana-managed-recording-rules/",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline"},children:"Grafana Managed Recording Rules"})," ","instead."]})})}const T=({navModel:W,isLoading:B,recordedQueries:S,getRecordedQueriesAsync:w,updateRecordedQuery:N,deleteRecordedQuery:M})=>{(0,s.useEffect)(()=>{w()},[w]);const L=(0,i.of)(O),[A,U]=(0,s.useState)(),F=S.map(K=>{const G=[(0,n.jsx)(c.$n,{onClick:async()=>{await N({...K,active:!K.active})},variant:K.active?"secondary":"primary",children:K.active?(0,o.t)("recorded-queries.recorded-queries-config-unconnected.queries-to-display.buttons.aria-label-pause-recorded-query","Pause recording"):(0,o.t)("recorded-queries.recorded-queries-config-unconnected.queries-to-display.buttons.aria-label-resume-recorded-query","Resume recording")},"toggle-recorded-query-active"),(0,n.jsx)(c.$n,{"aria-label":(0,o.t)("recorded-queries.recorded-queries-config-unconnected.queries-to-display.buttons.aria-label-delete-recorded-query","Delete recorded query"),onClick:()=>U(K),variant:"destructive",children:(0,n.jsx)(o.x6,{i18nKey:"recorded-queries.recorded-queries-config-unconnected.queries-to-display.buttons.delete",children:"Delete"})},"delete-recorded-query")];return(0,n.jsx)(f.z,{recordedQuery:K,buttons:G},K.id)}),V=()=>B?(0,n.jsx)(h.A,{}):F.length===0?(0,n.jsx)(v,{}):F;return(0,n.jsx)(p.Y,{navModel:W,children:(0,n.jsxs)(p.Y.Contents,{children:[P(),(0,n.jsx)("div",{className:L.header,children:(0,n.jsx)(c.z9,{icon:"cog",href:"/recorded-queries/write-target",children:(0,n.jsx)(o.x6,{i18nKey:"recorded-queries.recorded-queries-config-unconnected.edit-remote-write-target",children:"Edit remote write target"})})}),V(),A&&(0,n.jsx)(m.u,{isOpen:!0,icon:"trash-alt",title:(0,o.t)("recorded-queries.recorded-queries-config-unconnected.title-delete","Delete"),body:(0,n.jsx)("div",{children:(0,n.jsxs)(o.x6,{i18nKey:"recorded-queries.recorded-queries-config-unconnected.body-delete",children:["Are you sure you want to delete '",{name:A.name},"'?"]})}),confirmText:(0,o.t)("recorded-queries.recorded-queries-config-unconnected.confirm-text-delete","Delete"),onDismiss:()=>U(void 0),onConfirm:async()=>{await M(A),U(void 0)}})]})})},O=W=>({header:(0,a.css)({display:"flex",justifyContent:"flex-end",marginBottom:W.spacing(1)}),title:(0,a.css)({marginBottom:0,width:"100%"})}),I=C(T),j=I},80612:(Z,R,e)=>{"use strict";e.d(R,{Lc:()=>m,Nd:()=>p,Of:()=>h,eB:()=>i,qE:()=>d,u6:()=>c,xY:()=>o});var n=e(75505),a=e(68143),s=e(34178);const l="api/recording-rules";function o(){return async r=>{r((0,s.lV)());try{const g=await(0,a.AI)().get(l);r((0,s._i)(g))}finally{r((0,s.aT)())}}}function d(r){return async g=>{await(0,a.AI)().put(l,r),g((0,s.cz)(r))}}function i(r){return async g=>{await(0,a.AI)().delete(`${l}/${r.id}`),g((0,s.YE)(r))}}function c(r){return(0,n.s)((0,a.AI)().fetch({method:"POST",url:l,data:r,showErrorAlert:!1}))}function m(r){return(0,n.s)((0,a.AI)().fetch({method:"POST",url:`${l}/test`,data:r,showSuccessAlert:!1,showErrorAlert:!1}))}function p(){return async r=>{try{const g=await(0,n.s)((0,a.AI)().fetch({method:"GET",url:`${l}/writer`,showSuccessAlert:!1,showErrorAlert:!1}));r((0,s.NX)(g.data))}catch(g){g.status!==404&&console.error(g)}}}function h(r){return(0,n.s)((0,a.AI)().fetch({method:"POST",url:`${l}/writer`,data:r,showSuccessAlert:!1,showErrorAlert:!1}))}},34178:(Z,R,e)=>{"use strict";e.d(R,{Fu:()=>h,NX:()=>m,YE:()=>c,_i:()=>d,aT:()=>o,cz:()=>i,lV:()=>l});var n=e(65307);const a={recordedQueries:[],isLoading:!1,errorRecordedQueryTestResponse:""},s=(0,n.Z0)({name:"recorded-queries",initialState:a,reducers:{loadRecordedQueries:r=>({...r,isLoading:!0}),endLoadRecordedQueries:r=>({...r,isLoading:!1}),loadedRecordedQueries:(r,g)=>{const y=g.payload;return{...r,recordedQueries:y}},updateRecordedQueries:(r,g)=>{const y=g.payload,v=r.recordedQueries.map(x=>x.id===y.id?y:x);return{...r,recordedQueries:v}},deleteRecordedQueries:(r,g)=>{const y=g.payload,v=r.recordedQueries.filter(x=>x.id!==y.id);return{...r,recordedQueries:v}},setPrometheusWriteTarget:(r,g)=>{const y=g.payload;return{...r,prometheusWriteTarget:y}}}}),{loadRecordedQueries:l,endLoadRecordedQueries:o,loadedRecordedQueries:d,updateRecordedQueries:i,deleteRecordedQueries:c,setPrometheusWriteTarget:m}=s.actions,h={recordedQueries:s.reducer}},7009:(Z,R,e)=>{"use strict";e.d(R,{S:()=>a,T:()=>n});const n=s=>s.recordedQueries,a=s=>s.prometheusWriteTarget},38362:(Z,R,e)=>{"use strict";e.d(R,{E:()=>c,c:()=>d});var n=e(74848),a=e(92745),s=e(34999);const l=()=>(0,n.jsx)(a.x6,{i18nKey:"reporting.errors.action-message",children:"Please contact your Grafana administrator to install the plugin."}),o=()=>(0,n.jsxs)(a.x6,{i18nKey:"reporting.errors.no-renderer-description",children:["To generate PDF reports, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),d=({variant:m="info"})=>(0,n.jsxs)(s.F,{title:(0,a.t)("reporting.errors.no-renderer-title","Image renderer plugin not installed"),severity:m,children:[(0,n.jsx)(o,{})," ",(0,n.jsx)("br",{}),(0,n.jsx)(l,{})]}),i=()=>(0,n.jsxs)(a.x6,{i18nKey:"reporting.errors.old-renderer-description",children:["To generate CSV files, you must update the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),c=()=>(0,n.jsxs)(s.F,{title:(0,a.t)("reporting.errors.old-renderer-title","You are using an old version of the image renderer plugin"),severity:"warning",children:[(0,n.jsx)(i,{})," ",(0,n.jsx)("br",{}),(0,n.jsx)(l,{})]})},40951:(Z,R,e)=>{"use strict";e.d(R,{M:()=>l});var n=e(17548),a=e(27489),s=e(69788);const l={saveClicked(i,c){o("save_clicked",i,d(c))},saveDraftClicked(i,c){o("save_draft_clicked",i,d(c))},sendPreviewClicked(i,c){o("send_preview_clicked",i,c)},downloadCSVClicked(i,c){o("download_csv_clicked",i,c)},previewPDFClicked(i,c){o("preview_pdf_clicked",i,c)},settingsClicked(i,c){o("settings_clicked",i,c)},sendClicked(i,c){o("send_clicked",i,c)},deleteClicked(i,c){o("delete_clicked",i,c)},pauseClicked(i,c){o("pause_clicked",i,c)},resumeClicked(i,c){o("resume_clicked",i,c)},discardClicked(i){o("discard_clicked",i)}},o=(i,c,m)=>{(0,a.rR)(`report_${i}`,{context:c,...m})},d=i=>({replyToPopulated:!!i.replyTo,includesDashboardLink:i.enableDashboardUrl,numberOfDashboardsSelected:i.dashboards.length,numberOfDashboardsWithAbsoluteTimeRange:i.dashboards.filter(c=>!n.isRelativeTimeRange(c.timeRange)).length,templateVariablesSelected:i.dashboards.some(c=>!!c.reportVariables),orientation:i.options.orientation,layout:i.options.layout,frequency:i.schedule.frequency,sendTime:i.schedule.startDate?"later":"now",startDate:!!i.schedule.startDate,endDate:!!i.schedule.endDate,attachPDF:i.formats.includes(s.ReportFormat.PDF),attachPDFTables:i.formats.includes(s.ReportFormat.PDFTables),attachCSV:i.formats.includes(s.ReportFormat.CSV),attachImage:i.formats.includes(s.ReportFormat.Image),action:i.id===0?"create":"update"})},16904:(Z,R,e)=>{"use strict";e.d(R,{P:()=>n});var n=(a=>(a.SelectDashboards="select-dashboards",a.Schedule="schedule",a.EmailConfiguration="email-configuration",a.Recipients="recipients",a.Attachments="attachments",a))(n||{})},30063:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(69788);function o({reportState:c}){if(!c)return"NEW";const m=(0,s.$j)(),p=(0,s.of)(i),h=d(m).get(c);return(0,n.jsx)("span",{className:(0,a.cx)(p.scheduleStatus,(0,a.css)({color:h})),children:c.toUpperCase()})}const d=c=>new Map([[l.ReportState.Scheduled,c.colors.success.text],[l.ReportState.Expired,c.colors.warning.text],[l.ReportState.Draft,c.colors.text.primary],[l.ReportState.Never,c.colors.text.primary],[l.ReportState.Paused,c.colors.text.disabled]]),i=c=>({scheduleStatus:(0,a.css)({textTransform:"uppercase"})})},28772:(Z,R,e)=>{"use strict";e.d(R,{R:()=>b});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(43856),d=e(41654),i=e(45967),c=e(45861),m=e(7075),p=e(73427),h=e(95955),r=e(69788),g=e(30063),y=e(9735),v=e(46310),x=e(65988),f=e(17834);const u=(D,C)=>{const P=["name","recipients"],T=O=>O.dashboards.some(({dashboard:I})=>I?.name.toLowerCase().includes(C.toLowerCase()));return D.filter(O=>P.some(I=>O[I]?.toLowerCase().includes(C.toLowerCase()))||T(O))},b=({deleteReport:D,updateReport:C,reports:P,filter:T,onClick:O,redirectTo:I})=>{const j=(0,l.of)(E),W=N=>{const M=(0,v.U)(N.state);C({...N,state:M},!0)},B=p.TP.hasPermission(r.AccessControlAction.ReportingWrite),S=p.TP.hasPermission(r.AccessControlAction.ReportingDelete),w=(N,M,L)=>M?L===r.ReportState.Draft?(0,y.U)(N.schedule):(0,s.t)("reporting.report-list.content-resume-report","Resume report"):(0,s.t)("reporting.report-list.content-pause-report","Pause report");return(0,n.jsx)("div",{"data-testid":h.Tp.components.ReportsList.container,children:u(P,T).map(N=>{const M=N.recipients?N.recipients.split(";"):[],L=M.length,A=(0,x.I5)(N.schedule),{isNever:U,showPlay:F,disableEdit:V,reportState:K}=(0,v.m)(N),G=`${L} recipient${L!==1?"s":""}`;return(0,n.jsx)(o.Q,{href:I?.(N),className:j.container,children:(0,n.jsx)("div",{className:(0,a.cx)(j.box,{[j.boxPadding]:!I}),children:(0,n.jsxs)(d.B,{flex:1,direction:{xs:"column",md:"row"},gap:4,justifyContent:"space-between",children:[(0,n.jsxs)(d.B,{onClick:()=>O?.(N),flex:1,direction:{xs:"column",md:"row"},gap:4,justifyContent:"space-between",children:[(0,n.jsxs)("div",{className:j.info,children:[(0,n.jsx)("span",{className:j.title,children:N.name}),(0,n.jsx)("span",{className:j.dashboards,children:[...new Set(N.dashboards.map(({dashboard:H})=>H?.name))].join(", ")})]}),L?(0,n.jsx)("div",{className:(0,a.cx)(j.recipients,j.recipientsBox),children:(0,n.jsx)(i.m,{content:M.join(", "),placement:"top",children:(0,n.jsx)("div",{children:G})})}):(0,n.jsx)("div",{className:j.recipientsBox,children:G}),(0,n.jsxs)("div",{className:j.schedule,children:[(0,n.jsx)(g.Z,{reportState:K}),!U&&(0,n.jsx)("span",{className:j.text,children:A})]})]}),(0,n.jsxs)("div",{className:j.buttonWrapper,children:[(0,n.jsx)(i.m,{content:w(N,F,K),placement:"top",children:(0,n.jsx)(c.$n,{type:"button",variant:"secondary",fill:"text",icon:F?"play":"pause",size:"md",onClick:H=>{H.preventDefault(),W(N)},disabled:V||!B||(0,f.a_)(N)})}),(0,n.jsx)(m.Z,{confirmText:(0,s.t)("reporting.report-list.confirmText-delete","Delete"),confirmVariant:"destructive",size:"md",disabled:!S,onConfirm:()=>D(N),children:(0,n.jsx)(c.$n,{type:"button",className:j.deleteButton,"aria-label":(0,s.t)("reporting.report-list.delete-report","Delete report {{name}}",{name:N.name}),variant:"secondary",icon:"trash-alt",size:"md",fill:"text"})})]})]})})},N.id)})})},E=D=>({box:(0,a.css)({display:"flex",width:"100%"}),boxPadding:(0,a.css)({padding:D.spacing(2)}),container:(0,a.css)({"& > a":{alignItems:"center"}}),info:(0,a.css)({display:"flex",flexDirection:"column",[D.breakpoints.up("md")]:{width:"30%"}}),title:(0,a.css)({fontSize:D.typography.h5.fontSize,fontWeight:D.typography.fontWeightBold}),dashboards:(0,a.css)({fontSize:D.typography.bodySmall.fontSize,color:D.colors.text.secondary}),recipients:(0,a.css)({cursor:"pointer","&:hover":{textDecoration:"underline"}}),recipientsBox:(0,a.css)({display:"flex",width:"25%"}),schedule:(0,a.css)({display:"flex",flexDirection:"column",[D.breakpoints.up("md")]:{width:"40%"}}),buttonWrapper:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"flex-end","& > button":{"&[disabled]":{pointerEvents:"all"}}}),deleteButton:(0,a.css)({"&:hover":{color:D.colors.error.text}}),text:(0,a.css)({color:D.colors.text.secondary})})},52237:(Z,R,e)=>{"use strict";e.d(R,{o:()=>l});var n=e(74848),a=e(92745),s=e(79331);const l=({message:o})=>(0,n.jsx)(s.w,{title:(0,a.t)("reports.unavailable-feature-info-box.title-feature-available-expired-license","Feature not available with an expired license"),url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration",children:(0,n.jsx)("span",{children:o})})},70234:(Z,R,e)=>{"use strict";e.d(R,{D3:()=>s,FE:()=>p,Pf:()=>h,Sw:()=>i,aZ:()=>r,km:()=>d,lb:()=>l,oS:()=>c,oY:()=>o,xJ:()=>a,yo:()=>m});var n=e(42581);const a=n,s="https://grafana.com/static/assets/img/grafana_logo_lockup_ltbg.png",l="/reports",o=`${l}?reportView=settings`,d="reports/select-dashboard",i="api/reports/images/",c="api/reports/render/pdfs/",m="api/reports/render/csvs/",p=`Hi, 
Please find attached a PDF status report. If you have any questions, feel free to contact me!
Best,`,h=100,r=g=>[{value:50,label:"50%",isDisabled:!g},{value:75,label:"75%"},{value:100,label:"100%"},{value:125,label:"125%",isDisabled:!g},{value:150,label:"150%",isDisabled:!g},{value:175,label:"175%",isDisabled:!g},{value:200,label:"200%"}]},47006:(Z,R,e)=>{"use strict";e.d(R,{b0:()=>d,oZ:()=>o,vc:()=>s});var n=e(74848),a=e(96540),s=(i=>(i.DashboardPage="dashboard-page",i.ReportPage="report-page",i))(s||{});const l=(0,a.createContext)({renderingContext:"report-page"}),o=({children:i,renderingFormContext:c})=>(0,n.jsx)(l.Provider,{value:c,children:i}),d=()=>{const i=(0,a.useContext)(l);if(!i)throw new Error("useReportFormContext must be used within a ReportRenderingProvider");return i}},95955:(Z,R,e)=>{"use strict";e.d(R,{Tp:()=>s});const s={pages:{Report:{url:"/reports"}},components:{reportForm:{nextStep:l=>`data-testid report form next ${l}`,previousStep:l=>`data-testid report form previous ${l}`,selectDashboard:l=>`data-testid report select dashboard ${l}`,formatCheckbox:l=>`data-testid report form checkbox format ${l}`,nameInput:"data-testid report name input",subjectInput:"data-testid report subject input",sendTestEmailButton:"data-testid report send test email button",useRecipientsCheckbox:"data-testid report send test email use recipients checkbox",sendTestEmailConfirmButton:"data-testid report send test email confirm button",submitButton:"data-testid report form submit button"},ReportFormDrawer:{SelectDashboards:{header:"data-testid report form select dashboards header",content:"data-testid report form select dashboards content"},Schedule:{header:"data-testid report form schedule header",content:"data-testid report form schedule content"},Recipients:{header:"data-testid report form recipients header",content:"data-testid report form recipients content"},EmailConfiguration:{header:"data-testid report form email configuration header",content:"data-testid report form email configuration content",messageInput:"data-testid report form email configuration message input",replyToInput:"data-testid report form email configuration reply to input",subjectInput:"data-testid report form email configuration subject input",addDashboardUrlCheckbox:"data-testid report form email configuration add dashboard url checkbox",addDashboardImageCheckbox:"data-testid report form email configuration add dashboard image checkbox"},Attachments:{header:"data-testid report form attachments header",content:"data-testid report form attachments content",pdfReportCheckbox:"data-testid report form attachments pdf report checkbox",pdfTablesCheckbox:"data-testid report form attachments pdf tables checkbox",csvTablesCheckbox:"data-testid report form attachments csv tables checkbox",combineDashboardsCheckbox:"data-testid report form attachments combine dashboards checkbox",showTemplateVariablesCheckbox:"data-testid report form attachments show template variables checkbox",pdfTablesAppendixCheckbox:"data-testid report form attachments pdf tables appendix checkbox"},container:"data-testid report form drawer container",actionsMenuButton:"data-testid report form actions menu button",ActionsMenu:{previewPdf:"data-testid report form actions menu preview pdf button",downloadCsv:"data-testid report form actions menu download csv button",reportSettings:"data-testid report form actions menu report settings button"},submitButton:"data-testid report form submit button"},ReportsList:{container:"data-testid reports list container"},scheduleReport:{shareMenuItem:"data-testid new share button schedule report"},NewShareButton:{Menu:{scheduleReport:"data-testid new share button schedule report"}},NewExportButton:{Menu:{exportAsPdf:"data-testid new export button export as pdf"}},ExportAsPdf:{unavailableFeatureInfoBox:"data-testid unavailable feature info box",noRendererInfoBox:"data-testid no renderer info box",container:"data-testid export as pdf drawer container",orientationButton:"data-testid export as pdf orientation button",layoutButton:"data-testid export as pdf layout button",zoomCombobox:"data-testid export as zoom combobox",previewImage:"data-testid export as pdf preview image",generatePdfButton:"data-testid export as pdf generate pdf button",cancelButton:"data-testid export as pdf cancel button",modalCancelButton:"data-testid old modal cancel button",saveAsPdfButton:"data-testid save as pdf button"},ReportingListPage:{createButton:"data-testid create new report button"}}}},55355:(Z,R,e)=>{"use strict";e.d(R,{Bn:()=>Uo,Ek:()=>ys});var n=e(92138),a=e(92745),s=e(62061),l=e(36490),o=e(27489),d=e(25096),i=e(65642),c=e(15130),m=e(42939),p=e(23753),h=e(58662),r=e(55867),g=e(16001),y=e(25494),v=e(99949),x=e(69788),f=e(38082),u=e(74848),b=e(22803),E=e(63142),D=e(45861),C=e(2989),P=e(51208);const T=({dashboard:At,onDismiss:bn})=>{const An=(0,E.of)(O),pa=!(0,s.a)("reports.creation");function zn(){(0,o.rR)("dashboards_sharing_report_create_clicked"),bn&&bn()}return pa?(0,u.jsxs)("div",{className:An.container,children:[(0,u.jsx)(C.Iz,{featureName:"reporting",featureId:"reporting-tab"}),(0,u.jsx)(C.ep,{image:"reporting-email.png",featureName:"reporting",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting",description:(0,a.t)("reports.create-report-tab.description-reporting-allows-automatically-generate-dashboards-grafana","Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule.")})]}):(0,u.jsxs)(u.Fragment,{children:[(0,m.z5)()&&(0,u.jsxs)("div",{className:An.highlight,children:[(0,u.jsx)(C.Iz,{featureId:"reporting-tab",eventVariant:"trial",featureName:"reporting",text:(0,a.t)("reports.create-report-tab.text-create-unlimited-reports-during-trial-grafana","Create unlimited reports during your trial of Grafana Pro.")}),(0,u.jsx)("h3",{children:(0,u.jsx)(a.x6,{i18nKey:"reports.create-report-tab.get-started-with-reporting",children:"Get started with reporting"})}),(0,u.jsx)("h6",{children:(0,u.jsx)(a.x6,{i18nKey:"reports.create-report-tab.description-reporting-allows-automatically-generate-dashboards-grafana",children:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})})]}),(0,u.jsx)(D.z9,{href:(0,P.A2)(At),onClick:zn,className:An.button,children:(0,u.jsx)(a.x6,{i18nKey:"reports.create-report-tab.create-report-using-this-dashboard",children:"Create report using this dashboard"})}),(0,m.z5)()&&(0,u.jsx)(D.z9,{fill:"text",href:"https://grafana.com/docs/grafana/latest/enterprise/reporting",children:(0,u.jsx)(a.x6,{i18nKey:"reports.create-report-tab.learn-more",children:"Learn more"})})]})},O=At=>({container:(0,b.css)({display:"flex",flexDirection:"column",alignItems:"flex-start"}),button:(0,b.css)({marginRight:At.spacing(2)}),highlight:(0,b.css)({marginBottom:At.spacing(3),h6:{fontWeight:At.typography.fontWeightLight}})});var I=e(2543),j=e(96540),W=e(49785),B=e(71468),S=e(54148),w=e(30703),N=e(16780),M=e(44229),L=e(70234),A=e(27770),U=e(94676),F=e(19196);const V=At=>(0,I.upperFirst)(At.map(bn=>{switch(bn){case x.ReportFormat.CSV:case x.ReportFormat.PDF:return bn.toUpperCase();case x.ReportFormat.Image:return"embedded image";case x.ReportFormat.PDFTablesAppendix:return"PDF tables appendix";case x.ReportFormat.PDFTables:return"PDF tables"}}).join(", "));var K=e(65988),G=e(17834),H=e(12880),_=e(43173);const k=({uid:At,name:bn,className:An})=>{const pa=(0,E.of)(J);return At?(0,u.jsx)("a",{href:`${_.$.appUrl}d/${At}`,className:(0,b.cx)(pa.link,An),target:"_blank",rel:"noreferrer",children:bn||"View dashboard"}):null},J=At=>({link:(0,b.css)({display:"inline-block",color:At.colors.text.link,marginTop:At.spacing(1),fontSize:At.typography.bodySmall.fontSize,":hover":{textDecoration:"underline"}})});var z=e(83813),Y=e(61984);const X=At=>{if(!At)return ys[0];const bn=ys.findIndex(An=>An.id===At);return bn===ys.length-1?ys[bn]:ys[bn+1]},Q=At=>{if(!At||At===ys[0].id)return;const bn=ys.findIndex(An=>An.id===At);return ys[bn-1]},q=(At,bn)=>{const An=Q(At);An&&An.id!==At&&l.Ny.push((0,P.Do)(An.id,bn))};var te=e(95955);const ne=(0,j.forwardRef)(({activeStep:At,disabled:bn,reportId:An},pa)=>{const zn=(0,E.of)(se),la=(0,j.useRef)(null),Zn=Q(At),Vn=X(At),Hn=Vn.id===At;return(0,j.useImperativeHandle)(pa,()=>({click:()=>{la.current?.click()}})),(0,u.jsx)("div",{className:zn.buttonRow,children:(0,u.jsx)("div",{className:zn.buttonRowInner,children:(0,u.jsxs)("div",{children:[Zn&&(0,u.jsx)(D.$n,{variant:"secondary",onClick:()=>q(At,An),"data-testid":te.Tp.components.reportForm.previousStep(Zn.name),children:(0,u.jsxs)(a.x6,{i18nKey:"reporting.button-row.previous-step",children:["Previous: ",{prevName:Zn.name}]})}),!Hn&&(0,u.jsx)(D.$n,{ref:la,disabled:bn,type:"submit","data-testid":te.Tp.components.reportForm.nextStep(Vn.name),children:(0,u.jsxs)(a.x6,{i18nKey:"reporting.button-row.next-step",children:["Next: ",{nextName:Vn.name}]})})]})})})});ne.displayName="ButtonRow";const se=At=>({buttonRow:(0,b.css)({display:"flex",padding:At.spacing(2,0,.5,0),borderTop:`1px solid ${At.colors.border.weak}`,width:"100%",backgroundColor:At.colors.background.primary,button:{"&:first-of-type":{marginRight:At.spacing(2)},"&:last-of-type":{marginRight:0}}}),buttonRowInner:(0,b.css)({display:"flex",justifyContent:"space-between",width:"100%"})});var ue=e(76319),de=e(71599),ie=e(9735),he=e(46310);const me=At=>{const{report:bn}=At.reports;return{report:bn}},ce={loadReport:A.N1,deleteReport:A.y8,updateReport:A.A0},Pe=(0,B.connect)(me,ce),Ie=({report:At,loadReport:bn,deleteReport:An,updateReport:pa,disabled:zn})=>{const la=(0,E.of)(Se),[Zn,Vn]=(0,j.useState)(!1),Hn=c.TP.hasPermission(x.AccessControlAction.ReportingDelete),Ja=c.TP.hasPermission(x.AccessControlAction.ReportingWrite),{showPlay:Ua,disableEdit:Ha,reportState:ha}=(0,he.m)(At),Ba=async()=>{const xs=(0,he.U)(ha);await pa({...At,state:xs}),At.id&&bn(At.id)},ya=()=>{An(At.id),Vn(!1),l.Ny.push(L.lb)};return(0,u.jsxs)("div",{className:la.editActions,children:[(0,u.jsx)(D.z9,{href:(0,P.Do)(x.StepKey.SelectDashboard,At.id),type:"button",disabled:!Ja,children:(0,u.jsx)(a.x6,{i18nKey:"reports.edit-actions.edit-report",children:"Edit report"})}),(0,u.jsx)(D.$n,{type:"button",variant:"secondary",disabled:Ha||!Ja||zn,onClick:Ba,children:Ua?ha===x.ReportState.Draft?(0,ie.U)(At.schedule):(0,a.t)("reports.edit-actions.resume-button","Resume"):(0,a.t)("reports.edit-actions.pause-button","Pause")}),(0,u.jsx)(ue.K,{variant:"destructive","aria-label":(0,a.t)("reports.edit-actions.aria-label-delete-report","Delete report"),tooltip:(0,a.t)("reports.edit-actions.tooltip-delete","Delete"),name:"trash-alt",disabled:!Hn,onClick:()=>Vn(!0)}),(0,u.jsx)(de.u,{isOpen:Zn,title:(0,a.t)("reports.edit-actions.title-delete-report","Delete report"),body:(0,a.t)("reports.edit-actions.body-are-you-sure","Are you sure you want to delete this report?"),confirmText:(0,a.t)("reports.edit-actions.confirmText-delete","Delete"),onConfirm:ya,onDismiss:()=>Vn(!1)})]})},Se=At=>({editActions:(0,b.css)({display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%",marginBottom:At.spacing(3),"button, a":{marginLeft:At.spacing(2)}})}),Me=Pe(Ie),Te=(0,j.forwardRef)(({saveDraft:At,children:bn,existingReport:An,disabled:pa,activeStep:zn,onDiscard:la,schedule:Zn},Vn)=>{const Hn=(0,E.of)(Ge),Ja=X(zn),Ua=(0,j.useRef)(null),Ha=Ja.id===zn,ha=An?(0,a.t)("reporting.page-actions.update-button","Update report"):(0,ie.U)(Zn);return(0,j.useImperativeHandle)(Vn,()=>({click:()=>{Ua.current?.click()}})),(0,u.jsxs)("div",{className:Hn.container,children:[Ha&&(0,u.jsx)(D.$n,{ref:Ua,disabled:pa,type:"submit","data-testid":te.Tp.components.reportForm.submitButton,children:ha}),(0,u.jsx)(D.$n,{variant:"secondary",onClick:At,children:(0,u.jsx)(a.x6,{i18nKey:"reporting.page-actions.save-as-draft-button",children:"Save as draft"})}),bn,(0,u.jsx)(D.$n,{variant:"destructive",fill:"outline",onClick:la,children:(0,u.jsx)(a.x6,{i18nKey:"reporting.page-actions.discard-button",children:"Discard"})})]})});Te.displayName="PageActions";const Ge=At=>({container:(0,b.css)({display:"flex",justifyContent:"flex-end",width:"100%","& > button, & > a":{marginRight:At.spacing(3)}})}),Qe=At=>{const{report:bn,isUpdated:An,visitedSteps:pa}=At.reports;return{existingReport:!!bn.id,isUpdated:An,report:bn,visitedSteps:pa}},tt={addVisitedStep:U.wj,clearReportState:U.$J,createReport:A.LU,updateReport:A.A0},ke=(0,B.connect)(Qe,tt),He=({activeStep:At,addVisitedStep:bn,children:An,clearReportState:pa,confirmRedirect:zn,createReport:la,disabled:Zn,editMode:Vn,existingReport:Hn,getFormData:Ja,isUpdated:Ua,onSubmit:Ha,report:ha,reportId:Ba,updateReport:ya,visitedSteps:xs,pageActions:Za})=>{const os=(0,E.of)(Re),Xn=X(At),Pa=(0,S.Zp)(),wa=(0,S.zy)(),Yn=(0,j.useRef)(null),[Ra,ns]=(0,j.useState)(!1);(0,j.useEffect)(()=>{(Ma=>{Ma===ys[ys.length-1].id?bn(ys.map(js=>js.id)):bn([Ma])})(At)},[At,bn]),(0,j.useEffect)(()=>{Ra&&Pa(L.lb)},[Ra,Pa]);const ps=qn=>{qn.preventDefault();const Ma=(0,P.Do)(Xn.id,Ba);Ha(),Pa(Ma)},ga=async()=>{if(Ja){const Ma=Ja();ha={...ha,...Ma}}ns(!0),await(ha.id?ya:la)({...ha,state:x.ReportState.Draft}),(0,o.rR)("reports_draft_saved",{step:At,state:ha.id?ha.state:"new"}),pa()},Va=()=>{pa(),(0,o.rR)("reports_report_abandoned",{namePopulated:!!ha.name,recipientsPopulated:!!ha.recipients,replyToPopulated:!!ha.replyTo,numberOfDashboardsSelected:ha.dashboards.length,scheduleCustomized:(0,K.XO)(ha.schedule)})},is=qn=>!ys.map(js=>(0,P.Do)(js.id,Ba)).includes(qn.pathname),nr=()=>{const qn=ys[ys.length-1].id;At!==qn&&Yn.current?.click()},Aa=()=>{const qn=new URLSearchParams(wa.search),Ma=qn.get("db-uid");Ma?(qn.delete("db-uid"),qn.delete("db-name"),Pa(`/d/${Ma}?${qn}`)):Pa(L.lb)},Xa=(0,j.useMemo)(()=>(0,G.mr)(ha),[ha]);return(0,u.jsxs)("form",{onSubmit:ps,className:os.container,children:[Vn?(0,u.jsx)(Me,{disabled:Zn}):(0,u.jsx)(Te,{saveDraft:ga,existingReport:Hn,ref:Yn,activeStep:At,disabled:Zn,onDiscard:Aa,schedule:ha.schedule,children:Za}),(0,u.jsx)(z.F,{confirmRedirect:!Ra&&!!(zn||Ua),onDiscard:Va,onLocationChange:is}),(0,u.jsxs)("div",{className:os.inner,children:[!Vn&&(0,u.jsx)(Y.C,{activeStep:At,onStepChange:nr,getNextUrl:(0,P.s0)(Ba),visitedSteps:xs,steps:ys,validationResults:Xa}),(0,u.jsxs)("div",{className:os.content,children:[An,!Vn&&(0,u.jsx)(ne,{ref:Yn,activeStep:At,disabled:Zn,reportId:Ba})]})]})]})},Re=At=>({container:(0,b.css)({display:"flex",flexDirection:"column",height:"100%",alignContent:"center"}),inner:(0,b.css)({display:"flex",justifyContent:"flex-start",flexDirection:"column",flex:"1 0 auto"}),content:(0,b.css)({paddingBottom:At.spacing(3),width:"min(70%, 800px)"})}),Ne=ke(He),Ae=At=>{const{report:bn,isUpdated:An}=At.reports;return{report:bn,isUpdated:An}},Ue={createReport:A.LU,updateReport:A.A0,clearReportState:U.$J},_e=(0,B.connect)(Ae,Ue)(({report:At,createReport:bn,updateReport:An,clearReportState:pa,isUpdated:zn,reportId:la})=>{const{formats:Zn,options:Vn,schedule:Hn,dashboards:Ja}=At,{handleSubmit:Ua,formState:{isSubmitSuccessful:Ha}}=(0,W.mN)(),ha=(0,S.Zp)(),Ba=(0,E.of)(Xe),ya=!!la&&!zn,xs=(0,G.a_)(At),{time:Za,date:os}=(0,F.Th)(Hn.startDate,Hn.timeZone),{time:Xn,date:Pa}=(0,F.Th)(Hn.endDate,Hn.timeZone);(0,j.useEffect)(()=>{Ha&&ha(L.lb)},[Ha,ha]);const wa=async()=>{const ga=At.id?An:bn;if(At.state===x.ReportState.Draft){const Va=At.schedule.frequency===x.ReportSchedulingFrequency.Never?x.ReportState.Never:x.ReportState.Scheduled;At={...At,state:Va}}await ga(At),(0,o.rR)("reports_report_submitted",{replyToPopulated:!!At.replyTo,includesDashboardLink:At.enableDashboardUrl,numberOfDashboardsSelected:At.dashboards.length,templateVariablesSelected:At.dashboards.some(Va=>!!Va.reportVariables),orientation:At.options.orientation,layout:At.options.layout,frequency:At.schedule.frequency,sendTime:At.schedule.startDate?"later":"now",endDate:!!At.schedule.endDate}),pa()},{orientation:Yn,layout:Ra}=U.ue.report.options,ns=i.Ay.featureToggles.newPDFRendering,ps=[{title:(0,a.t)("reports.confirm.report-data.title.select-dashboard","Select dashboard"),id:x.StepKey.SelectDashboard,items:(Ja||[]).flatMap((ga,Va,is)=>{const nr=(0,H.oI)(ga.reportVariables,ga.dashboard?.uid);return[{title:`Source dashboard${Va===0?"*":""}`,value:ga.dashboard?.uid?(0,u.jsx)(k,{name:ga.dashboard.name,uid:ga.dashboard?.uid,className:Ba.dashboardLink}):"",id:"name",required:!0},{title:(0,a.t)("reports.confirm.report-data.title.template-variables","Template variables"),value:(0,u.jsx)(le,{previewVariables:nr,className:Ba.title})},{title:(0,a.t)("reports.confirm.report-data.title.time-range","Time range"),value:(0,F.J5)(ga.timeRange)},...is.length>1&&Va!==is.length-1?[{title:"",value:""}]:[]]})},{title:(0,a.t)("reports.confirm.report-data.title.format-report","Format report"),id:x.StepKey.FormatReport,items:[{title:(0,a.t)("reports.confirm.report-data.title.preferred-format","Preferred format*"),value:V(Zn),id:"formats",required:!0},...Zn.includes(x.ReportFormat.PDF)?ns?[{title:(0,a.t)("reports.confirm.report-data.title.pdf-orientation","PDF orientation"),value:(0,I.capitalize)(Vn.orientation||Yn)},{title:(0,a.t)("reports.confirm.report-data.title.pdf-layout","PDF layout"),value:(0,I.capitalize)(Vn.layout||Ra)},{title:(0,a.t)("reports.confirm.report-data.title.scale-factor","Scale factor"),value:(0,L.aZ)(ns).find(ga=>ga.value===At.scaleFactor&&!ga.isDisabled)?.label||"100%"},{title:(0,a.t)("reports.confirm.report-data.title.pdf-show-template-variables","PDF show template variables"),value:Vn.pdfShowTemplateVariables?"Yes":"No"},{title:(0,a.t)("reports.confirm.report-data.title.combine-all-pdfs-in-one-file","Combine all PDFs in one file"),value:Vn.pdfCombineOneFile?"Yes":"No"}]:[{title:(0,a.t)("reports.confirm.report-data.title.pdf-orientation","PDF orientation"),value:(0,I.capitalize)(Vn.orientation||Yn)},{title:(0,a.t)("reports.confirm.report-data.title.pdf-layout","PDF layout"),value:(0,I.capitalize)(Vn.layout||Ra)},{title:(0,a.t)("reports.confirm.report-data.title.scale-factor","Scale factor"),value:(0,L.aZ)(ns).find(ga=>ga.value===At.scaleFactor&&!ga.isDisabled)?.label||"100%"}]:[]]},{title:(0,a.t)("reports.confirm.report-data.title.schedule","Schedule"),id:x.StepKey.Schedule,items:[{title:(0,a.t)("reports.confirm.report-data.title.recurrence","Recurrence"),value:(0,I.capitalize)(Hn.frequency)},...Hn.frequency===x.ReportSchedulingFrequency.Custom?[{title:(0,a.t)("reports.confirm.report-data.title.repeat-every","Repeat every"),value:`${Hn.intervalAmount} ${Hn.intervalFrequency}`}]:[],...Hn.frequency!==x.ReportSchedulingFrequency.Never?[{title:(0,a.t)("reports.confirm.report-data.title.start-date","Start date"),value:os||"Now"},{title:(0,a.t)("reports.confirm.report-data.title.start-time","Start time"),value:Za||"Now"},{title:(0,a.t)("reports.confirm.report-data.title.end-date","End date"),value:Pa},{title:(0,a.t)("reports.confirm.report-data.title.end-time","End time"),value:Xn},{title:(0,a.t)("reports.confirm.report-data.title.time-zone","Time zone"),value:Hn.timeZone?(0,M.t)(Date.now(),Hn.timeZone):""}]:[],...(0,K.mM)(Hn.frequency,Hn.intervalFrequency)?[{title:(0,a.t)("reports.confirm.report-data.title.send-monday-to-friday-only","Send Monday to Friday only"),value:Hn.workdaysOnly?(0,u.jsx)(w.I,{name:"check",size:"xl"}):(0,u.jsx)(w.I,{name:"minus",size:"xl"})}]:[],{value:(0,K.OG)(At.schedule),title:""}]},{title:(0,a.t)("reports.confirm.report-data.title.share","Share"),id:x.StepKey.Share,items:[{title:(0,a.t)("reports.confirm.report-data.title.report-name","Report name*"),value:At.name,id:"name",required:!0},{title:(0,a.t)("reports.confirm.report-data.title.email-subject","Email subject"),value:At.subject,id:"subject"},{title:(0,a.t)("reports.confirm.report-data.title.recipients","Recipients*"),value:At.recipients,id:"recipients",required:!0},{title:(0,a.t)("reports.confirm.report-data.title.replytoemail","Reply-to-email"),value:At.replyTo||"none"},{title:(0,a.t)("reports.confirm.report-data.title.message","Message"),value:At.message||"none"},{title:(0,a.t)("reports.confirm.report-data.title.dashboard-link","Dashboard link"),value:At.enableDashboardUrl?"Yes":"No"}]}];return(0,u.jsx)(Ne,{activeStep:x.StepKey.Confirm,confirmRedirect:!Ha&&zn,disabled:xs,editMode:ya,onSubmit:Ua(wa),reportId:la,children:(0,u.jsx)(N.n,{label:ya?"":(0,a.t)("reporting.report-form.edit-step","5. Confirm"),children:ps.map(ga=>{const Va=(0,G.a_)(At,ga.id);return(0,u.jsxs)("div",{className:Ba.section,children:[(0,u.jsxs)("div",{className:Ba.sectionHeader,children:[(0,u.jsx)("h5",{className:Ba.sectionTitle,children:ga.title}),(0,u.jsx)(D.z9,{variant:Va?"primary":"secondary",fill:"text",href:(0,P.Do)(ga.id,la),size:"sm",children:(0,u.jsx)(a.x6,{i18nKey:"reports.confirm.edit",children:"Edit"})})]}),ga.items.filter(is=>is.value!==void 0).map((is,nr)=>{const Aa=!!is.required&&(!is.value||Array.isArray(is.value)&&!is.value.length);return is.title?(0,u.jsxs)("div",{className:Ba.row,children:[(0,u.jsxs)("div",{className:(0,b.cx)(Ba.title,Aa&&Ba.warning),children:[is.title,":"]}),(0,u.jsx)("div",{className:(0,b.cx)(Ba.value,is.value==="none"&&!Aa?Ba.textMuted:""),children:Aa?(0,u.jsx)(w.I,{name:"exclamation-triangle",className:Ba.warning}):is.value})]},nr):(0,u.jsx)("div",{className:(0,b.cx)(Ba.row,Ba.textMuted),children:is.value},nr)})]},ga.title)})})})}),Xe=At=>({section:(0,b.css)({width:"100%",padding:At.spacing(3,0),marginBottom:At.spacing(3)}),sectionHeader:(0,b.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:At.spacing(1),border:`1px solid ${At.colors.border.weak}`}),sectionTitle:(0,b.css)({margin:0}),row:(0,b.css)({border:`1px solid ${At.colors.border.weak}`,borderTop:"none",display:"flex",width:"100%",padding:At.spacing(1)}),warning:(0,b.css)({color:At.colors.warning.text}),title:(0,b.css)({width:"30%",color:At.colors.text.secondary}),textMuted:(0,b.css)({color:At.colors.text.secondary}),value:(0,b.css)({width:"70%",wordBreak:"break-word"}),dashboardLink:(0,b.css)({color:At.colors.text.primary,fontSize:At.typography.body.fontSize,marginTop:0})}),le=({className:At,previewVariables:bn})=>{const An=(0,E.of)(Xe);return!bn||!bn.length?(0,u.jsx)("span",{className:An.textMuted,children:(0,u.jsx)(a.x6,{i18nKey:"reports.variables-preview.none",children:"none"})}):(0,u.jsx)(u.Fragment,{children:bn.map(([pa,zn])=>(0,u.jsxs)("span",{children:[(0,u.jsx)("span",{className:At,children:pa}),": ",zn.join(", "),";"," "]},pa))})};var ye=e(83175),pe=e(32899),ve=e(41654),be=e(32635),Oe=e(37386),we=e(77824),ze=e(18857),Ve=e(73427),ge=e(8921),Ke=e(93612),qe=e(34999);const ot=()=>(0,u.jsx)(qe.F,{severity:"warning",title:(0,a.t)("reports.all-template-alert.title-not-supported","Not supported"),children:(0,u.jsx)(a.x6,{i18nKey:"reports.all-template-alert.description-not-supported",children:"The value All in template variables used in repeating rows or panels is not supported in PDF"})});var lt=e(98924),mt=e(60861),Lt=e(76686);const Tt=At=>{const{isDownloadingCSV:bn,report:An}=At.reports;return{report:An,isDownloadingCSV:bn}},It={updateReportProp:U.n0,downloadCSV:A.Bf},Mt=(0,B.connect)(Tt,It),Ut=new Map([["grid","Display the panels in their positions on the dashboard."],["simple","Display one panel per row."]]),an=new Map([[x.ReportFormat.PDF,{description:"Attach the report as a PDF"}],[x.ReportFormat.PDFTablesAppendix,{description:"Include table data as PDF appendix",dependsOn:x.ReportFormat.PDF,hide:!i.Ay.featureToggles.pdfTables}],[x.ReportFormat.Image,{description:"Embed a dashboard image in the email"}],[x.ReportFormat.CSV,{description:"Attach a CSV file of table panel data"}],[x.ReportFormat.PDFTables,{description:"Attach a separate PDF of table data",hide:!i.Ay.featureToggles.pdfTables}]]),cn=({report:At,updateReportProp:bn,reportId:An,downloadCSV:pa,isDownloadingCSV:zn})=>{const la=(0,E.of)(un),{dashboards:Zn,formats:Vn,options:Hn,name:Ja,scaleFactor:Ua=L.Pf}=At||{},{handleSubmit:Ha,control:ha,register:Ba,watch:ya,getValues:xs,formState:{isDirty:Za}}=(0,W.mN)({defaultValues:{formats:Vn,scaleFactor:Ua,options:{layout:Hn.layout,orientation:Hn.orientation,timeRange:Hn.timeRange,pdfShowTemplateVariables:Hn.pdfShowTemplateVariables,pdfCombineOneFile:Hn.pdfCombineOneFile}}}),os=ya("options.layout"),Xn=ya("options.orientation"),Pa=ya("options.pdfShowTemplateVariables"),wa=ya("options.pdfCombineOneFile"),Yn=ya("formats"),Ra=ya("scaleFactor"),ns=(0,Lt.D)(),ps=!(0,lt.b0)(At.dashboards),ga=(0,s.a)("reports.pdf")&&ps,Va=i.Ay.featureToggles.newPDFRendering,is=Va?!1:(0,j.useMemo)(()=>{const qn=At.dashboards.flatMap(js=>js.dashboard?.uid?(0,Ke.SS)(js.dashboard.uid):[]);return(0,H.T6)(ge.To,"query",qn)&&Yn.includes(x.ReportFormat.PDF)},[At.dashboards,Yn]),nr=({formats:qn,options:Ma,scaleFactor:js})=>{Za&&bn({...At,options:{...At.options,...Ma},formats:qn,scaleFactor:js})},Aa=()=>{const{formats:qn,options:Ma,scaleFactor:js}=xs();return{options:{...At.options,...Ma},formats:qn,scaleFactor:js}},Xa=()=>{if((0,lt.b0)(Zn))return;const qn={title:Ja,scaleFactor:Ra};return Xn&&(qn.orientation=Xn),os&&(qn.layout=os),Pa&&(qn.pdfShowTemplateVariables=(!!Pa).toString()),wa&&(qn.pdfCombineOneFile=(!!wa).toString()),Yn&&Yn.includes(x.ReportFormat.PDFTablesAppendix)&&(qn.includeTables="true"),qn.dashboards=(0,P.U)(Zn),ye.kM.appendQueryToUrl("api/reports/render/pdfs/",ye.kM.toUrlParams(qn))};return(0,u.jsx)(Ne,{activeStep:x.StepKey.FormatReport,onSubmit:Ha(nr),confirmRedirect:Za,getFormData:Aa,reportId:An,pageActions:[(0,u.jsx)(D.z9,{onClick:()=>ga&&(0,o.rR)("reports_preview_pdf"),icon:"external-link-alt",href:Xa(),size:"xs",target:"_blank",rel:"noreferrer noopener",variant:"secondary",disabled:!ga,children:(0,u.jsx)(a.x6,{i18nKey:"reports.format-report.preview-pdf",children:"Preview PDF"})},"preview"),(0,u.jsx)(D.$n,{onClick:()=>pa(At.name,Zn),icon:zn?"spinner":"download-alt",variant:"secondary",disabled:!ps||zn,tooltip:(0,a.t)("reports.format-report.tooltip-download-table-panel","Download table panel data as CSVs in a ZIP file"),children:zn?"Downloading...":"Download CSV"},"downloadCSV")],children:(0,u.jsxs)(N.n,{label:(0,a.t)("reports.format-report.label-format-report","2. Format report"),disabled:!mt.V,children:[is&&(0,u.jsx)(ot,{}),(0,u.jsx)(N.n,{children:(0,u.jsx)(ve.B,{direction:"column",alignItems:"start",children:[...an].map(([qn,Ma])=>{const{onChange:js,...cr}=Ba("formats");return!Ma.hide&&(!Ma.dependsOn||Yn.includes(Ma.dependsOn))&&(0,j.createElement)(be.S,{...cr,hidden:Ma.hide||Ma.dependsOn&&Yn.includes(Ma.dependsOn),key:qn,htmlValue:qn,label:Ma.description,className:(0,b.cx)(Ma.dependsOn&&la.subCheckbox),"data-testid":te.Tp.components.reportForm.formatCheckbox(qn),onChange:Qs=>{qn==="csv"&&Qs.currentTarget.checked&&ns!==null&&ns<3&&Ve.lE.emit(pe.r1.alertError,["To export CSV files, you must update the Grafana Image Renderer plugin."]),js(Qs)}})})})}),(Yn.includes(x.ReportFormat.PDF)||Yn.includes(x.ReportFormat.PDFTables))&&(0,u.jsxs)(N.n,{label:(0,a.t)("reports.format-report.label-style-the-pdf","Style the PDF"),children:[Va&&Zn?.length>1&&(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.format-report.label-configure-multiple-pdfs","Configure multiple PDFs"),children:(0,u.jsx)(be.S,{...Ba("options.pdfCombineOneFile"),label:(0,a.t)("reports.format-report.label-combine-dashboard","Combine all dashboard PDFs in one file"),defaultChecked:wa})}),Va&&(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.format-report.label-configure-report-header","Configure report header"),children:(0,u.jsx)(be.S,{...Ba("options.pdfShowTemplateVariables"),label:(0,a.t)("reports.format-report.label-show-template-variables","Show template variables")})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.format-report.label-orientation","Orientation"),children:(0,u.jsx)(W.xI,{name:"options.orientation",control:ha,render:({field:{ref:qn,...Ma}})=>(0,u.jsx)(we.z,{...Ma,options:x.reportOrientations,size:"md"})})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.format-report.label-layout","Layout"),description:Ut.get(os),children:(0,u.jsx)(W.xI,{name:"options.layout",control:ha,render:({field:{ref:qn,...Ma}})=>(0,u.jsx)(we.z,{...Ma,options:x.reportLayouts,size:"md"})})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.format-report.label-zoom","Zoom"),description:(0,a.t)("reports.format-report.description-enlarge-table-columns-panel","Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel."),children:(0,u.jsx)(W.xI,{name:"scaleFactor",control:ha,defaultValue:L.Pf,render:({field:{ref:qn,value:Ma,onChange:js,...cr}})=>(0,u.jsx)(ze.l6,{...cr,onChange:Qs=>js(Qs.value),options:(0,L.aZ)(Va).filter(Qs=>!Qs.isDisabled),value:(0,L.aZ)(Va).find(Qs=>Qs.value===Ma&&!Qs.isDisabled)?Ma:L.Pf,width:30,placeholder:"xx%","aria-label":(0,a.t)("reports.format-report.aria-label-zoom","Zoom")})})})]})]})})},un=At=>({sliderField:(0,b.css)({maxWidth:"350px",input:{display:"none"}}),subCheckbox:(0,b.css)({marginLeft:At.spacing(2)})}),On=Mt(cn);var yn=e(95062),En=e(25229),Bn=e(63527),fa=e(43482),Fn=e(11527),Ea=e(59310);const gt=At=>{const{report:bn}=At.reports;return{report:bn}},Ht={updateReportProp:U.n0},wt=(0,B.connect)(gt,Ht),Yt=[{label:"Once",value:x.ReportSchedulingFrequency.Once},{label:"Hourly",value:x.ReportSchedulingFrequency.Hourly},{label:"Daily",value:x.ReportSchedulingFrequency.Daily},{label:"Weekly",value:x.ReportSchedulingFrequency.Weekly},{label:"Monthly",value:x.ReportSchedulingFrequency.Monthly},{label:"Custom",value:x.ReportSchedulingFrequency.Custom},{label:"Never",value:x.ReportSchedulingFrequency.Never}],rn=[{label:"hours",value:x.ReportIntervalFrequency.Hours},{label:"days",value:x.ReportIntervalFrequency.Days},{label:"weeks",value:x.ReportIntervalFrequency.Weeks},{label:"months",value:x.ReportIntervalFrequency.Months}],Xt=At=>At==="now"&&(0,F.lB)((0,En.KQ)().toDate().getDate()),pn=wt(({report:At,updateReportProp:bn,reportId:An})=>{const{handleSubmit:pa,control:zn,watch:la,register:Zn,setValue:Vn,getValues:Hn,formState:{isDirty:Ja}}=(0,W.mN)(),{frequency:Ua,timeZone:Ha,startDate:ha,endDate:Ba,dayOfMonth:ya,intervalAmount:xs,intervalFrequency:Za}=At.schedule,os=Ua===x.ReportSchedulingFrequency.Never?"":ha,Xn=os?"later":"now",Pa={startDate:os,sendTime:Xn,intervalFrequency:x.ReportIntervalFrequency.Hours,intervalAmount:"2",sendOnLastDayOfMonth:ya===x.LAST_DAY_OF_MONTH,...At.schedule},wa=la("schedule",Pa)||{},{frequency:Yn,startDate:Ra,endDate:ns,intervalFrequency:ps=x.ReportIntervalFrequency.Hours,dayOfMonth:ga,sendOnLastDayOfMonth:Va,sendTime:is=Xn,workdaysOnly:nr}=wa,Aa=(0,E.of)(Un),Xa=new Date(Ra),qn=qa=>{if(Ja){const bs=(0,K.A0)(qa.schedule);bn({...At,schedule:bs})}},Ma=()=>({schedule:(0,K.A0)(Hn().schedule)}),js=qa=>{const bs=Va&&(0,yn.c)(qa);Vn("schedule.sendOnLastDayOfMonth",bs),Vn("schedule.dayOfMonth",bs?x.LAST_DAY_OF_MONTH:"")},cr=qa=>{const bs=(0,En.KQ)(Ra).endOf("month").toDate();Vn("schedule.startDate",bs),Vn("schedule.dayOfMonth",qa?x.LAST_DAY_OF_MONTH:"")},Qs=(0,K.En)(Xt(is)?(0,En.KQ)().toDate().getDate():Xa.getDate());return(0,u.jsx)(Ne,{activeStep:x.StepKey.Schedule,onSubmit:pa(qn),confirmRedirect:Ja,getFormData:Ma,reportId:An,children:(0,u.jsxs)(N.n,{label:(0,a.t)("reports.schedule.label-schedule","3. Schedule"),children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.schedule.label-frequency","Frequency"),children:(0,u.jsx)(W.xI,{defaultValue:Ua,name:"schedule.frequency",render:({field:{ref:qa,onChange:bs,...Es}})=>(0,u.jsx)(we.z,{...Es,fullWidth:!0,options:Yt,disabled:!mt.V,onChange:qs=>{(0,K.mM)(qs,ps)||Vn("schedule.workdaysOnly",!1),bs(qs)}}),control:zn})}),Yn!==x.ReportSchedulingFrequency.Never&&(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.schedule.label-time","Time"),children:(0,u.jsx)(W.xI,{control:zn,name:"schedule.sendTime",defaultValue:Xn,render:({field:{ref:qa,onChange:bs,...Es}})=>(0,u.jsx)(we.z,{...Es,onChange:qs=>{qs!=="now"&&!Ra?Vn("schedule.startDate",(0,En.KQ)().toDate()):qs==="now"&&Vn("schedule.startDate",""),bs(qs)},options:[{label:(0,a.t)("reporting.schedule.frecuency-send-now","Send now"),value:"now"},{label:(0,a.t)("reporting.schedule.frecuency-send-later","Send later"),value:"later"}]})})}),(0,u.jsxs)(u.Fragment,{children:[Yn===x.ReportSchedulingFrequency.Custom&&(0,u.jsxs)(ve.B,{children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reporting.schedule.frecuency-custom-input-label","Repeat every"),children:(0,u.jsx)(Bn.p,{type:"number",min:"2",...Zn("schedule.intervalAmount"),placeholder:"2",defaultValue:xs||2,id:"repeat-frequency"})}),(0,u.jsx)(Oe.D,{label:" ",children:(0,u.jsx)(W.xI,{control:zn,defaultValue:rn.find(qa=>qa.value===Za)?.value||x.ReportIntervalFrequency.Hours,render:({field:{ref:qa,onChange:bs,...Es}})=>(0,u.jsx)(ze.l6,{...Es,onChange:qs=>bs(qs.value),options:rn,width:16,placeholder:(0,a.t)("reporting.schedule.frecuency-custom-select-placeholder","hours"),"aria-label":(0,a.t)("reporting.schedule.frecuency-custom-select-label","Custom frequency")}),name:"schedule.intervalFrequency"})})]}),Yn===x.ReportSchedulingFrequency.Monthly&&(Xt(is)||is==="later")&&(0,u.jsx)(Oe.D,{children:(0,u.jsx)(W.xI,{control:zn,defaultValue:ga===x.LAST_DAY_OF_MONTH,render:({field:{onChange:qa,...bs}})=>(0,u.jsx)(be.S,{...bs,label:(0,a.t)("reporting.schedule.frecuency-last-day-label","Send on the last day of month"),onChange:Es=>{cr(Es.currentTarget.checked),qa(Es.currentTarget.checked)}}),name:"schedule.sendOnLastDayOfMonth"})})]}),(0,u.jsx)("div",{className:is!=="now"&&Yn!==x.ReportSchedulingFrequency.Never?"":Aa.hidden,children:(0,u.jsxs)(ve.B,{children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.schedule.label-start-date","Start date"),children:(0,u.jsx)(W.xI,{name:"schedule.startDate",control:zn,defaultValue:(0,F.pp)(os),render:({field:{ref:qa,onChange:bs,...Es}})=>(0,u.jsx)(fa.l,{...Es,width:16,placeholder:(0,a.t)("reporting.schedule.frecuency-date-picker-placeholder","Select date"),"aria-label":(0,a.t)("reporting.schedule.frecuency-date-picker-label","Report schedule start date"),closeOnSelect:!0,onChange:qs=>{const Er=new Date(qs);js(Er),bs(Er)}})})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("reporting.schedule.frecuency-start-time-label","Start time"),children:(0,u.jsx)(W.xI,{name:"schedule.time",render:({field:{onChange:qa,ref:bs,value:Es,...qs}})=>(0,u.jsx)(Fn.R,{...qs,value:Es,minuteStep:10,disabled:!mt.V,onChange:Er=>{Er.isValid()&&qa({hour:Er.hour?.(),minute:Er.minute?.()})}}),defaultValue:(0,F.WB)(ha),control:zn})}),(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(Oe.D,{label:(0,a.t)("reporting.schedule.frecuency-time-zone-label","Time zone"),children:(0,u.jsx)(W.xI,{name:"schedule.timeZone",render:({field:{ref:qa,...bs}})=>(0,u.jsx)(Ea.U,{...bs,width:30,disabled:!mt.V}),defaultValue:Ha||(0,U.Md)(),control:zn})})})]})}),Yn===x.ReportSchedulingFrequency.Monthly&&!Va&&((0,F.lB)(Xa.getDate())||Xt(is))&&(0,u.jsx)("small",{className:Aa.warningText,children:(0,u.jsxs)(a.x6,{i18nKey:"reporting.schedule.frecuency-last-day-warning",children:["Note: some months do not have a ",{warningDateText:Qs}," day and reports will not be sent on those months. Choose an earlier date or ",(0,u.jsx)("strong",{children:'"Send on the last day of month"'})," to send a report at the end of each month."]})}),![x.ReportSchedulingFrequency.Once,x.ReportSchedulingFrequency.Never].includes(Yn)&&(0,u.jsxs)(ve.B,{children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reporting.schedule.frecuency-end-date-label","End date"),children:(0,u.jsx)(W.xI,{name:"schedule.endDate",control:zn,defaultValue:(0,F.pp)(Ba),render:({field:{ref:qa,...bs}})=>(0,u.jsx)(fa.l,{...bs,width:16,placeholder:(0,a.t)("reporting.schedule.report-schedule-end-date-placeholder","Does not end"),"aria-label":(0,a.t)("reporting.schedule.report-schedule-end-date-label","Report schedule end date"),minDate:new Date(Ra),closeOnSelect:!0})})}),ns&&(Yn===x.ReportSchedulingFrequency.Hourly||(0,K.hv)(Yn,ps))&&(0,u.jsx)(Oe.D,{label:(0,a.t)("reporting.schedule.frecuency-end-time-label","End time"),children:(0,u.jsx)(W.xI,{name:"schedule.endTime",render:({field:{onChange:qa,ref:bs,value:Es,...qs}})=>(0,u.jsx)(Fn.R,{...qs,value:Es,minuteStep:10,disabled:!mt.V,onChange:Er=>{Er?.isValid()&&qa({hour:Er.hour?.(),minute:Er.minute?.()})}}),defaultValue:(0,F.WB)(Ba),control:zn})})]}),(0,K.mM)(Yn,ps)&&(0,u.jsx)(Oe.D,{children:(0,u.jsx)(be.S,{...Zn("schedule.workdaysOnly"),label:(0,a.t)("reporting.schedule.frecuency-workdays-label","Send Monday to Friday only"),defaultChecked:nr})}),(0,u.jsxs)(ve.B,{alignItems:"center",children:[(0,u.jsx)(w.I,{name:"calendar-alt"}),(0,K.OG)({...Pa,...wa})]})]})})}),Un=At=>({warningText:(0,b.css)({color:At.colors.warning.main,display:"block",margin:At.spacing(-1,0,3,0)}),hidden:(0,b.css)({display:"none"})});var In=e(7389),Gn=e(3594),Wa=e(18027),za=e(56265),Oa=e(95506),ss=e(54742),La=e(67933),Ca=e(39167),Ka=e(68392);const As=At=>{const{report:bn}=At.reports;return{report:bn,templating:At.templating.keys}},Ia={updateReportProp:U.n0,initVariables:A.U1,cleanUpVariables:Ca._m},_s=(0,B.connect)(As,Ia),Fa={dashboard:void 0,timeRange:{from:"",to:"",raw:{from:"",to:""}},reportVariables:{}},xt=({report:At,reportId:bn,updateReportProp:An,initVariables:pa,cleanUpVariables:zn})=>{const{handleSubmit:la,control:Zn,formState:{isDirty:Vn},setValue:Hn,getValues:Ja,watch:Ua}=(0,W.mN)({defaultValues:{dashboards:At.dashboards||[Fa]}}),{fields:Ha,append:ha,remove:Ba}=(0,W.jz)({control:Zn,name:"dashboards",keyName:"fieldId"}),ya=Ua("dashboards"),xs=(0,E.of)(Qt);(0,j.useEffect)(()=>{const wa=(0,P.y3)();if(wa){const{dashboard:Yn,variables:Ra,timeRange:ns}=wa;Ra&&Yn.uid&&pa(Yn.uid,Ra,ns),Yn.uid&&(Hn("dashboards.0.dashboard",Yn,{shouldDirty:!0}),ns&&Hn("dashboards.0.timeRange",{...ns,raw:ns},{shouldDirty:!0}))}},[pa,At,Hn]);const Za=wa=>(Yn,Ra)=>{Hn(`dashboards.${wa}.timeRange`,{from:"",to:""});const ns=Ja().dashboards?.map(({dashboard:ga})=>ga);if(!Yn){if(!Ra)return;ns.some(Va=>Va?.uid===Ra)||zn(Ra);return}const ps=ns.filter(ga=>ga?.uid===Yn.uid).length>1;if(Yn.uid&&!ps){const ga=At.dashboards?.[wa],Va=Yn.uid===ga?.dashboard?.uid?ga?.reportVariables:void 0;pa(Yn.uid,Va)}},os=wa=>{const Yn=Xn(wa.dashboards);Vn&&An({...At,dashboards:Yn})},Xn=wa=>{const Yn=wa?.filter(({dashboard:Ra})=>Ra?.uid).map(({dashboard:Ra,timeRange:ns})=>{const ps=Ra?.uid;return{dashboard:ps?{uid:ps,name:Ra?.name}:void 0,timeRange:(0,Ka.RC)(ns?.raw),reportVariables:ps?(0,H.Z5)((0,Ke.SS)(ps).filter(ga=>ga.hide!==In.zL.hideVariable)):void 0}});return Yn?.length?Yn:[Fa]},Pa=()=>({dashboards:Xn(Ja().dashboards)});return(0,u.jsx)(Ne,{activeStep:x.StepKey.SelectDashboard,onSubmit:la(os),confirmRedirect:Vn,getFormData:Pa,reportId:bn,children:(0,u.jsx)(N.n,{label:(0,a.t)("reports.select-dashboards.label-select-dashboard","1. Select dashboard"),children:(0,u.jsxs)(u.Fragment,{children:[Ha.map((wa,Yn)=>{const Ra=ya[Yn].dashboard?.uid||"",ns=ya[Yn]?.reportVariables,ps=Ra?(0,Ke.SS)(Ra):[],ga=Va=>{(0,H.zp)(ps)&&pa(Ra,ns,Va)};return(0,u.jsxs)("div",{className:(0,b.cx)(xs.section,ya.length>1&&xs.sectionBorder),children:[(0,u.jsx)(dt,{field:wa,dashboardUid:Ra,onDashboardChange:Za(Yn),variables:ps,control:Zn,index:Yn,setValue:Hn,selectedDashboards:ya,onTimeRangeChange:ga,dataTestId:te.Tp.components.reportForm.selectDashboard(Yn.toString())}),Ha.length>1&&(0,u.jsx)(D.$n,{className:xs.removeBtn,variant:"secondary",fill:"outline",icon:"trash-alt",onClick:()=>Ba(Yn),children:(0,u.jsx)(a.x6,{i18nKey:"reports.select-dashboards.remove-dashboard",children:"Remove dashboard"})})]},wa.fieldId)}),(0,u.jsx)(D.$n,{type:"button",icon:"plus",variant:"secondary",onClick:()=>ha(Fa),children:(0,u.jsx)(a.x6,{i18nKey:"reports.select-dashboards.add-another-dashboard",children:"Add another dashboard"})})]})})})},dt=({field:At,index:bn,onDashboardChange:An,variables:pa,control:zn,dashboardUid:la,setValue:Zn,onTimeRangeChange:Vn,selectedDashboards:Hn=[],dataTestId:Ja})=>{const Ua=(0,Ka.eO)(At.timeRange),Ha=pa.filter(Za=>Za.hide!==In.zL.hideVariable),ha=la!==void 0&&!!Ha.length,Ba=Hn.filter(({dashboard:Za})=>Za?.uid===la).length>1,ya=Hn.findIndex(({dashboard:Za})=>Za?.uid===la),xs=Ba&&ya!==bn;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.select-dashboard.label-source-dashboard","Source dashboard"),required:!0,children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(W.xI,{name:`dashboards.${bn}.dashboard`,control:zn,render:({field:{onChange:Za,ref:os,value:Xn,...Pa}})=>(0,u.jsx)(Oa.b,{...Pa,id:`dashboard-${bn}`,"data-testid":Ja,"aria-label":(0,a.t)("reports.select-dashboard.aria-label-source-dashboard","Source dashboard"),isClearable:!0,value:Xn?.uid,disabled:!mt.V,onChange:wa=>{Za({...wa,name:wa?.title}),An(wa,la)}})}),(0,u.jsx)(k,{uid:la})]})}),ha&&(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.select-dashboard.label-template-variables","Template variables"),description:xs&&`When adding the same dashboard multiple times in one report, template variables that you selected first
are applied to all instances of that dashboard in the report.`,children:xs?(0,u.jsx)(u.Fragment,{}):(0,u.jsx)(u.Fragment,{children:Ha.map(Za=>{const{picker:os,setValue:Xn}=ss.B.get(Za.type);return(0,u.jsx)(Wa.I,{label:Za.name,labelWidth:16,disabled:!mt.V,children:(0,u.jsx)(os,{variable:Za,readOnly:!1,onVariableChange:Pa=>{(0,La.SP)(Pa)&&!(0,Gn.R)(Pa.current)&&(Xn(Pa,Pa.current),Zn(`dashboards.${bn}.reportVariables`,(0,H.Z5)([Pa]),{shouldDirty:!0}))}})},Za.name)})})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.select-dashboard.label-time-range","Time range"),description:(0,a.t)("reports.select-dashboard.description-time-range","Generate report with the data from specified time range. If custom time range is empty the time range from the report's dashboard is used."),disabled:!mt.V,children:(0,u.jsx)(W.xI,{control:zn,name:`dashboards.${bn}.timeRange`,defaultValue:Ua,render:({field:{ref:Za,value:os,onChange:Xn,...Pa}})=>(0,u.jsx)(za.b,{...Pa,value:jt(os,Ua),onChange:wa=>{Xn(wa),Vn(wa.raw)},clearable:!0})})})]})},St=_s(xt),jt=(At,bn)=>At?At.raw?At:{...At,raw:At}:bn,Qt=At=>({removeBtn:(0,b.css)({marginBottom:At.spacing(2)}),section:(0,b.css)({paddingBottom:At.spacing(2)}),sectionBorder:(0,b.css)({"&:not(:last-of-type)":{borderBottom:`1px solid ${At.colors.border.weak}`,marginBottom:At.spacing(3)}}),infoText:(0,b.css)({color:At.colors.text.secondary,fontSize:At.typography.size.sm,fontWeight:At.typography.fontWeightRegular})});var Jt=e(8515),ln=e(10928),fn=e(87105),gn=e(43910),vn=e(22787),wn=e(65240);const Rt=({onDismiss:At,onSendTestEmail:bn,emails:An})=>{const pa=(0,E.DP)(),zn=bt(pa),[la,Zn]=(0,j.useState)(""),[Vn,Hn]=(0,j.useState)(""),[Ja,Ua]=(0,j.useState)(!1),[Ha,ha]=(0,j.useState)(!1),Ba=Xn=>{const{checked:Pa}=Xn.target;ha(Pa),Pa?(Zn(An),xs(An)):(Za(),Zn(""))},ya=Xn=>{Zn(Xn.currentTarget.value),Ua(!1)},xs=Xn=>(0,gn.K7)(Xn)?(Za(),!0):(Ua(!0),Hn("Invalid email"),!1),Za=()=>{Ua(!1),Hn("")},os=()=>{xs(la),xs(la)&&(bn(la,Ha),At())};return(0,u.jsx)(vn.a,{className:zn.modal,isOpen:!0,title:(0,a.t)("reports.send-test-email-modal.title-send-test-email","Send test email"),icon:"share-alt",onDismiss:At,children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:zn.content,children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.send-test-email-modal.label-email","Email"),disabled:Ha,invalid:Ja,error:Vn,children:(0,u.jsx)(Bn.p,{disabled:Ha,name:"email",placeholder:"your.address@company.com",type:"email",value:la,onChange:ya})}),(0,u.jsx)(be.S,{value:Ha,label:(0,a.t)("reports.send-test-email-modal.label-use-emails-from-report","Use emails from report"),onChange:Ba,"data-testid":te.Tp.components.reportForm.useRecipientsCheckbox})]}),(0,u.jsxs)(vn.a.ButtonRow,{children:[(0,u.jsx)(D.$n,{variant:"secondary",onClick:At,fill:"outline",children:(0,u.jsx)(a.x6,{i18nKey:"reports.send-test-email-modal.cancel",children:"Cancel"})}),(0,u.jsx)(D.$n,{variant:"primary",onClick:os,"data-testid":te.Tp.components.reportForm.sendTestEmailConfirmButton,children:(0,u.jsx)(a.x6,{i18nKey:"reports.send-test-email-modal.send",children:"Send"})})]})]})})},bt=(0,wn.N)(At=>({modal:(0,b.css)({width:"500px"}),content:(0,b.css)({marginBottom:At.spacing.lg})})),Vt=At=>{const{testEmailIsSending:bn,report:An}=At.reports;return{report:An,testEmailIsSending:bn}},Kt={updateReportProp:U.n0,sendTestEmail:A.FI},Dt=(0,B.connect)(Vt,Kt),Zt=({report:At,reportId:bn,updateReportProp:An,sendTestEmail:pa,testEmailIsSending:zn})=>{const{message:la,name:Zn,recipients:Vn,replyTo:Hn,enableDashboardUrl:Ja,dashboards:Ua,subject:Ha}=At,{handleSubmit:ha,control:Ba,register:ya,setError:xs,clearErrors:Za,watch:os,getValues:Xn,formState:{errors:Pa,isDirty:wa}}=(0,W.mN)({mode:"onBlur"}),Yn=(0,E.of)(Ln),Ra=Ve.TP.hasPermission(x.AccessControlAction.ReportingSend),ns=os("name",Zn),ps=os("recipients",Vn),ga=!Ra||!(0,s.a)("reports.email")||!ns||!ps||(0,lt.b0)(Ua),Va=(Aa,Xa)=>{const qn={...At,...Xn()},Ma=Xa?qn.recipients:Aa;return pa({...qn,recipients:Ma})},is=Aa=>{if(wa){const{name:Xa}=Aa;An({...At,...Aa,name:Xa.trim()})}},nr=()=>{const Aa=Xn(),{name:Xa}=Aa;return{...Aa,name:Xa.trim()}};return(0,u.jsxs)(Ne,{activeStep:x.StepKey.Share,onSubmit:ha(is),confirmRedirect:wa,getFormData:nr,reportId:bn,pageActions:[(0,u.jsx)(Jt.$s,{children:({showModal:Aa,hideModal:Xa})=>(0,u.jsx)(D.$n,{disabled:ga,size:"xs",variant:"secondary","data-testid":te.Tp.components.reportForm.sendTestEmailButton,onClick:qn=>{qn.preventDefault(),Aa(Rt,{onDismiss:Xa,onSendTestEmail:Va,emails:ps})},children:(0,u.jsx)(a.x6,{i18nKey:"reports.share.send-test-email",children:"Send test email"})})},"send-test-email")],children:[zn&&(0,u.jsx)("div",{className:"page-alert-list",children:(0,u.jsx)(qe.F,{title:(0,a.t)("reports.share.title-sending-test-email","Sending test email..."),severity:"info",elevated:!0})}),(0,u.jsxs)(N.n,{label:(0,a.t)("reports.share.label-share","4. Share"),disabled:!mt.V,children:[(0,u.jsx)(Oe.D,{label:(0,a.t)("reports.share.label-report-name","Report name"),required:!0,invalid:!!Pa.name,error:"Name is required",children:(0,u.jsx)(Bn.p,{...ya("name",{required:!0}),type:"text",id:"name",defaultValue:Zn,placeholder:(0,a.t)("reports.share.name-placeholder-system-status-report","System status report"),"data-testid":te.Tp.components.reportForm.nameInput})}),(0,u.jsx)(Oe.D,{className:Yn.field,label:(0,u.jsxs)(ve.B,{gap:0,alignItems:"center",direction:"row",children:[(0,u.jsx)("span",{children:(0,u.jsx)(a.x6,{i18nKey:"reports.share.email-subject",children:"Email subject"})}),(0,u.jsx)(D.$n,{icon:"info-circle",fill:"text",variant:"secondary",tooltip:(0,a.t)("reports.share.email-info-button","The report name will be used as the email subject if this field is left empty"),tooltipPlacement:"right"})]}),children:(0,u.jsx)(Bn.p,{...ya("subject"),type:"text",id:"subject",defaultValue:Ha,placeholder:(0,a.t)("reports.share.subject-placeholder-email-subject","Email subject"),"data-testid":te.Tp.components.reportForm.subjectInput,autoComplete:"off"})}),(0,u.jsx)(Oe.D,{className:Yn.field,label:(0,a.t)("reports.share.label-recipients","Recipients"),required:!0,invalid:!!Pa.recipients,error:Pa.recipients?.message,description:(0,a.t)("reports.share.description-separate-multiple-emails-comma-semicolon","Separate multiple emails with a comma or semicolon."),children:(0,u.jsx)(W.xI,{name:"recipients",control:Ba,defaultValue:Vn,render:({field:{ref:Aa,value:Xa,onChange:qn,...Ma}})=>(0,u.jsx)(ln.u,{...Ma,id:"recipients",disabled:!mt.V,invalid:!!Pa.recipients,onChange:js=>{const cr=js.join(";").split(gn.mF).filter(Boolean).map(qa=>qa.trim()),Qs=cr.filter(qa=>!(0,gn.xf)(qa));Qs.length?xs("recipients",{type:"manual",message:`Invalid email${Qs.length>1?"s":""}: ${Qs.join("; ")}`}):Za("recipients"),qn(cr.filter(qa=>(0,gn.xf)(qa)).join(";"))},placeholder:(0,a.t)("reports.share.recipients-placeholder-recipients-email-addresses-press-enter","Type in the recipients email addresses and press Enter"),tags:Xa?Xa.split(gn.mF):[],className:Yn.tagsInput,addOnBlur:!0}),rules:{validate:Aa=>(0,gn.K7)(Aa)||"Invalid email"}})}),(0,u.jsx)(Oe.D,{invalid:!!Pa.replyTo,error:Pa.replyTo?.message,className:Yn.field,label:(0,a.t)("reports.share.label-replyto-email-address","Reply-to email address"),description:(0,a.t)("reports.share.description-address-appear-reply-field-email","The address that will appear in the Reply to field of the email"),children:(0,u.jsx)(Bn.p,{...ya("replyTo",{validate:Aa=>(0,gn.K7)(Aa)||"Invalid email"}),id:"replyTo",placeholder:"your.address@company.com - optional",type:"email",defaultValue:Hn})}),(0,u.jsx)(Oe.D,{className:Yn.field,label:(0,a.t)("reports.share.label-message","Message"),children:(0,u.jsx)(fn.f,{...ya("message"),id:"message",placeholder:la,rows:10,defaultValue:la})}),(0,u.jsx)(Oe.D,{className:Yn.field,children:(0,u.jsx)(be.S,{...ya("enableDashboardUrl"),defaultChecked:Ja,label:(0,a.t)("reports.share.label-include-a-dashboard-link","Include a dashboard link")})})]})]})},Ln=At=>({field:(0,b.css)({"&:not(:last-of-type)":{marginBottom:At.spacing(3)}}),tagsInput:(0,b.css)({li:{marginBottom:At.spacing(1),backgroundColor:`${At.colors.background.secondary} !important`,borderColor:`${At.components.input.borderColor} !important`,color:At.colors.text.primary}})}),Qn=Dt(Zt);var va=e(38362),Wn=e(52237),ia=e(48614),kn=e(38496),na=e(43112),Ga=e(26161);const Ps=(At=window.location.origin)=>{let bn=At+_.$.appSubUrl;return bn.endsWith("/")&&bn.slice(0,-1),bn},ls=(At,bn,An,pa,zn)=>{let la=`${Ps()}/api/reports/render/pdfs`;const Zn={orientation:At,layout:bn,scaleFactor:An},Vn={dashboard:{uid:pa}};Object.keys(zn).length!==0&&(Vn.reportVariables=zn);const Hn=(0,P.KM)();return Hn&&(Vn.timeRange=Hn),Zn.dashboards=JSON.stringify([Vn]),la=ye.kM.appendQueryToUrl(la,ye.kM.toUrlParams(Zn)),la},Ta=te.Tp.components.ExportAsPdf,aa={landscapegrid:ia,landscapesimple:kn,portraitgrid:na,portraitsimple:Ga},Gs=({displayQueryVariablesAlert:At,onDismiss:bn,variables:An,dashboardUid:pa})=>{const[zn,la]=(0,j.useState)("landscape"),[Zn,Vn]=(0,j.useState)("grid"),[Hn,Ja]=(0,j.useState)(L.Pf),Ua=(0,E.of)(Zs),Ha=aa[`${zn}${Zn}`],ha=ls(zn,Zn,Hn,pa,An);function Ba(){(0,o.rR)("dashboards_sharing_pdf_save_clicked",{orientation:zn,layout:Zn,scaleFactor:Hn})}return _.$.rendererAvailable?(0,s.a)("reports.pdf")?(0,u.jsxs)("div",{"data-testid":Ta.container,children:[At&&(0,u.jsx)(ot,{}),(0,u.jsx)("p",{className:"share-modal-info-text",children:(0,u.jsx)(a.x6,{i18nKey:"export.pdf.info-text",children:"Export the dashboard as a PDF document"})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("export.pdf.orientation-label","Orientation"),"data-testid":Ta.orientationButton,children:(0,u.jsx)(we.z,{options:x.reportOrientations,value:zn,onChange:la})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("export.pdf.layout-label","Layout"),"data-testid":Ta.layoutButton,children:(0,u.jsx)(we.z,{options:x.reportLayouts,value:Zn,onChange:Vn})}),(0,u.jsx)(Oe.D,{label:(0,a.t)("export.pdf.zoom-label","Zoom"),description:(0,a.t)("export.pdf.zoom-description","Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel."),"data-testid":Ta.zoomCombobox,children:(0,u.jsx)(ze.l6,{onChange:ya=>Ja(ya.value),options:(0,L.aZ)(_.$.featureToggles.newPDFRendering).filter(ya=>!ya.isDisabled),value:Hn,width:30,placeholder:"xx%","aria-label":(0,a.t)("export.pdf.zoom-label","Zoom")})}),_.$.featureToggles.newDashboardSharingComponent?(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:Ua.imageContainer,children:(0,u.jsx)("img",{"data-testid":Ta.previewImage,src:Ha,alt:(0,a.t)("export.pdf.image-alt","PDF preview")})}),(0,u.jsx)("div",{className:Ua.container,children:(0,u.jsxs)(ve.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,u.jsx)(D.z9,{"data-testid":Ta.generatePdfButton,variant:"primary",href:ha,target:"_blank",rel:"noreferrer noopener",icon:"external-link-alt",onClick:Ba,children:(0,u.jsx)(a.x6,{i18nKey:"export.pdf.download-button",children:"Generate PDF"})}),(0,u.jsx)(D.$n,{"data-testid":Ta.cancelButton,variant:"secondary",onClick:bn,children:(0,u.jsx)(a.x6,{i18nKey:"export.pdf.cancel-button",children:"Cancel"})})]})})]}):(0,u.jsxs)(vn.a.ButtonRow,{children:[(0,u.jsx)(D.$n,{"data-testid":Ta.modalCancelButton,variant:"secondary",onClick:bn,children:(0,u.jsx)(a.x6,{i18nKey:"reports.share-pdfbase.cancel",children:"Cancel"})}),(0,u.jsx)(D.z9,{"data-testid":Ta.saveAsPdfButton,variant:"primary",href:ha,target:"_blank",rel:"noreferrer noopener",onClick:Ba,children:(0,u.jsx)(a.x6,{i18nKey:"reports.share-pdfbase.save-as-pdf",children:"Save as PDF"})})]})]}):(0,u.jsx)(Wn.o,{message:`Rendering a dashboard as a PDF document is not available with your current license.
            To enable this feature, update your license.`}):(0,u.jsx)(va.c,{"data-testid":Ta.noRendererInfoBox})},Os=({dashboard:At,onDismiss:bn})=>{const An=_.$.featureToggles.newPDFRendering?!1:(0,j.useMemo)(()=>{const zn=(0,A.Yx)(At.panels),la=(0,Ke.SS)(At.uid),Zn=(0,H.IU)(ge.To,"query",la);return Zn&&zn.has(Zn.name)},[At]),pa=(0,j.useMemo)(()=>{const zn=(0,Ke.SS)(At.uid);return(0,H.Z5)(zn)},[At.uid]);return(0,u.jsx)(Gs,{displayQueryVariablesAlert:An,onDismiss:bn,variables:pa,dashboardUid:At.uid})};function Zs(At){return{container:(0,b.css)({padding:`${At.spacing(2)} 0`}),imageContainer:(0,b.css)({display:"flex",height:320,maxWidth:"100%",padding:At.spacing(2),margin:"auto",justifyContent:"center"}),zoomSlider:(0,b.css)({maxWidth:350,input:{display:"none"}})}}var lr=e(36674),Xs=e(8285);class jo extends lr.Bs{constructor(){super(...arguments),this.tabId=h.wr.report}static{this.Component=ci}getTabLabel(){return _.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-dashboard.menu.schedule-report-title","Schedule report"):"Report"}}function ci({model:At}){const{modalRef:bn}=At.useState(),An=(0,Xs.YQ)(At);return(0,u.jsx)(T,{dashboard:An,onDismiss:()=>{bn?.resolve()?.onDismiss()}})}class Xr extends lr.Bs{constructor(){super(...arguments),this.tabId=h.wr.pdf}static{this.Component=vs}getTabLabel(){return _.$.featureToggles.newDashboardSharingComponent?(0,a.t)("export.pdf.title","Export dashboard PDF"):"PDF"}}function vs({model:At}){const{modalRef:bn,onDismiss:An}=At.useState(),pa=(0,Xs.YQ)(At),zn=(0,j.useMemo)(()=>{const la=lr.jh.getVariables(pa).state.variables;return(0,H.$w)(la)},[pa]);return(0,u.jsx)(Gs,{onDismiss:()=>{bn?bn.resolve().onDismiss():An?.()},displayQueryVariablesAlert:!1,variables:zn,dashboardUid:pa.state.uid})}var ks=e(31286),Ys=e(68079),Lo=e(50201),rs=e(89640),Vs=e(6975),Hs=e(6890),yr=e(64762),qr=e(74101),xr=e(68886),Ws=e(52763),Br=e(16904),Tr=e(28772),uo=e(2556),eo=e(9229);function Xo(){const At=(0,E.of)(Ur);return(0,u.jsxs)("div",{className:At.highlight,children:[(0,u.jsx)(C.Iz,{featureId:"reporting-tab",eventVariant:"trial",featureName:"reporting",text:(0,a.t)("reports.highlight-trial-report.text-create-unlimited-reports-during-trial-grafana","Create unlimited reports during your trial of Grafana Pro.")}),(0,u.jsx)("h3",{children:(0,u.jsx)(a.x6,{i18nKey:"reports.highlight-trial-report.get-started-with-reporting",children:"Get started with reporting"})}),(0,u.jsx)("h6",{children:(0,u.jsx)(a.x6,{i18nKey:"reports.highlight-trial-report.get-started-with-reporting-text",children:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})}),(0,u.jsx)(D.z9,{fill:"text",href:"https://grafana.com/docs/grafana/latest/enterprise/reporting",children:(0,u.jsx)(a.x6,{i18nKey:"reports.highlight-trial-report.learn-more",children:"Learn more"})})]})}const Ur=At=>({highlight:(0,b.css)({marginBottom:At.spacing(3),h6:{fontWeight:At.typography.fontWeightLight}})});var or=e(47006);const fr=(0,j.lazy)(()=>e.e(1661).then(e.bind(e,81661))),to=({showLoadingSpinner:At,onCreateReportClick:bn,onDeleteReportClick:An,onUpdateReportClick:pa,reports:zn,isError:la})=>{const Zn=(0,s.a)("reports.creation"),Vn=(0,S.zy)(),Hn=(0,E.of)(Gr);return(0,u.jsx)(ks.a,{height:"100%",display:"flex",direction:"column",children:(0,u.jsxs)(ve.B,{flex:1,direction:"column",gap:2,children:[(0,u.jsx)("div",{className:Hn.listHeader,children:(0,u.jsxs)(ve.B,{direction:{xs:"column",md:"row"},justifyContent:"space-between",children:[At&&(0,u.jsx)(Ys.y,{}),(0,u.jsxs)(ve.B,{gap:1,direction:{xs:"column",md:"row"},flex:1,justifyContent:"flex-end",children:[Zn&&(0,u.jsx)(D.$n,{variant:"primary",onClick:bn,icon:"plus",children:(0,a.t)("share-report.create-report","Create a new report")}),(0,u.jsx)(D.z9,{variant:"secondary",href:L.lb,children:(0,a.t)("share-report.see-all-reports","See all reports")})]})]})}),la?(0,u.jsx)(qe.F,{title:(0,a.t)("share-report.error-list.title","Error loading reports"),severity:"error"}):zn?.length?(0,u.jsx)(Tr.R,{reports:zn,deleteReport:An,updateReport:pa,redirectTo:Ja=>`${Vn.pathname}?${Vn.search}&reportId=${Ja.id}`,filter:""}):(0,u.jsx)(ve.B,{flex:1,direction:"column",justifyContent:"center",children:(0,u.jsx)(Lo.p,{variant:"call-to-action",message:(0,a.t)("share-report.empty-list.title","There are no reports for this dashboard"),children:(0,u.jsxs)(a.x6,{i18nKey:"share-report.empty-list.description",children:["Create a report from this dashboard."," ",(0,u.jsx)(rs.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/create-reports/",children:"Learn more"})]})})})]})})};class ho extends lr.Bs{constructor(bn){super({isDirty:!1,onClose:()=>{},...bn}),this.onClose=()=>{l.Ny.partial({shareView:null,reportId:null,reportView:null})},this.onDismiss=()=>{this.state.isDirty?(0,uo.p)(this.onClose,or.vc.DashboardPage):this.onClose()}}static{this.Component=zr}getTabLabel(){return"Schedule report"}}function zr({model:At}){const bn=!(0,s.a)("reports.creation"),An=(0,Xs.YQ)(At),pa=(0,Ws.wA)(),[zn,la]=(0,qr.z)(),Zn=Number(zn.get("reportId")),Vn=zn.get("reportView")==="new",Hn=zn.get("shareView")==="report",{data:Ja,isLoading:Ua,isFetching:Ha,isError:ha}=(0,xr.QU)(An.state.uid,{skip:!!Zn||Vn||!Hn}),[Ba,{isLoading:ya}]=(0,xr.iJ)(),[xs,{isLoading:Za}]=(0,xr.yi)(),{data:os,isLoading:Xn,isFetching:Pa,isError:wa}=(0,xr.qJ)(Zn,{skip:!Zn}),Yn=Ja?.map(qn=>(0,eo.zn)(qn))||[],Ra=Ha||ya||Za,ns=!!Zn,ps=(0,j.useMemo)(()=>{if(Zn&&os)return os;const{from:qn,to:Ma,raw:js}=An.state.$timeRange?.state.value||{},cr={from:js?.from.toString()??qn?.toISOString()??"",to:js?.to.toString()??Ma?.toISOString()??""};let Qs={};try{Qs=(0,lt._7)(An.state.$variables)}catch(qa){pa((0,Hs.dx)((0,yr.gi)(qa instanceof Error?qa.message:"Reporting: Error when trying to get template variables from dashboard")))}return{title:An.state.title,dashboards:[{uid:An.state.uid,title:An.state.title,timeRange:cr,variables:Qs}]}},[An,Zn,os,pa]),ga=qn=>{At.setState({isDirty:qn})},Va=()=>{la({reportView:"new",reportId:null})},is=async qn=>{await Ba(qn.id).unwrap(),Aa()},nr=async qn=>{const Ma=(0,eo.Jh)(qn);await xs(Ma).unwrap(),Aa()},Aa=()=>{At.setState({isDirty:!1}),la({reportView:null,reportId:null})},Xa=()=>{At.state.isDirty?(0,uo.p)(Aa,or.vc.DashboardPage):Aa()};return Ua?(0,u.jsx)(Vs._,{text:(0,a.t)("share-report.loading-reports","Loading reports...")}):Xn?(0,u.jsx)(Vs._,{text:(0,a.t)("share-report.loading-report","Loading report...")}):Hn?Hn&&!Zn&&!Vn?(0,u.jsxs)(u.Fragment,{children:[bn&&(0,u.jsx)(Wn.o,{message:(0,a.t)("share-report.unavailable-feature-info-box.message","Creating new reports is not available with an expired license. Existing reports continue to be processed but you need to update your license to create a new one.")}),(0,u.jsx)(to,{showLoadingSpinner:Ra,onCreateReportClick:Va,onDeleteReportClick:is,onUpdateReportClick:nr,reports:Yn,isError:ha})]}):(0,u.jsxs)(ks.a,{height:"100%",display:"flex",direction:"column",children:[(0,m.z5)()&&(0,u.jsx)(Xo,{}),(0,u.jsx)(j.Suspense,{fallback:(0,u.jsx)(Vs._,{text:(0,a.t)("share-report.loading-report-form","Loading report form...")}),children:(0,u.jsx)(ve.B,{flex:1,direction:"column",children:wa?(0,u.jsx)(qe.F,{title:(0,a.t)("share-report.error-form.title","Error loading report"),severity:"error"}):(0,u.jsx)(or.oZ,{renderingFormContext:{renderingContext:or.vc.DashboardPage},children:(0,u.jsx)(fr,{report:ps,setIsDirty:ga,onSuccess:Aa,headerActions:(0,u.jsxs)(ve.B,{children:[(0,u.jsx)(D.$n,{variant:"secondary",icon:"angle-left",onClick:Xa,children:(0,a.t)("share-report.back-button-text","Back to reports list")}),Pa&&(0,u.jsx)(Ys.y,{})]}),defaultOpenSections:{[Br.P.SelectDashboards]:ns,[Br.P.Schedule]:!0,[Br.P.EmailConfiguration]:ns,[Br.P.Recipients]:!0,[Br.P.Attachments]:ns}})})})})]}):null}const Gr=At=>({listHeader:(0,b.css)({position:"sticky",top:0,left:0,right:0,width:"100%",background:At.colors.background.primary,zIndex:At.zIndex.modal,marginTop:At.spacing(-2),paddingTop:At.spacing(2),marginBottom:At.spacing(-2),paddingBottom:At.spacing(2)})}),fo=i.$W.featureToggles.featureHighlights,Bo=te.Tp.components.NewShareButton.Menu,Hr={label:"PDF",value:h.wr.pdf,component:Os},po={label:"Report",value:h.wr.report,tabSuffix:fo&&!(0,s.a)("reports.creation")||(0,m.z5)()?()=>(0,d.J)({experimentId:(0,f.L)("reporting-tab-badge")}):void 0,component:T};function Uo(){i.$W.reporting?.enabled&&(hs(),qo())}const hs=()=>{if((0,s.a)("reports.creation")){(0,p.mJ)(Hr),(0,v.m)(Xr);const At=()=>{l.Ny.partial({shareView:h.wr.pdf})},bn={shareId:h.wr.pdf,testId:"data-testid new export button export as pdf",icon:"file-alt",label:(0,a.t)("share-dashboard.menu.export-pdf-title","Export as PDF"),renderCondition:!0,onClick:At};(0,r.i)(bn),(0,y.K)({id:h.wr.pdf,shareOption:Xr})}},qo=()=>{((0,s.a)("reports.creation")||fo)&&((0,p.mJ)(po),(0,v.m)(jo));const At=An=>{if(i.$W.featureToggles.newShareReportDrawer){l.Ny.partial({shareView:h.wr.report});return}if((0,s.a)("reports.creation")&&!(0,m.z5)()){(0,o.rR)("dashboards_sharing_report_create_clicked");const zn=n.I.stripBaseFromUrl(`${i.$W.appUrl}${(0,P.A2)(An)}`);l.Ny.push(zn)}else l.Ny.partial({shareView:h.wr.report})},bn={shareId:h.wr.report,testId:Bo.scheduleReport,icon:"clock-nine",label:(0,a.t)("share-dashboard.menu.schedule-report-title","Schedule report"),renderCondition:!0,onClick:At};if(i.$W.featureToggles.newShareReportDrawer&&(0,s.a)("reports")&&c.TP.hasPermission(x.AccessControlAction.ReportingRead)){(0,g.Hl)(bn),(0,y.K)({id:h.wr.report,shareOption:ho});return}((0,s.a)("reports.creation")&&c.TP.hasPermission(x.AccessControlAction.ReportingCreate)||fo)&&((0,g.Hl)(bn),i.$W.featureToggles.newShareReportDrawer?(0,y.K)({id:h.wr.report,shareOption:ho}):(0,y.K)({id:h.wr.report,shareOption:jo}))},ys=[{id:x.StepKey.SelectDashboard,name:"Select dashboard",component:St},{id:x.StepKey.FormatReport,name:"Format report",component:On},{id:x.StepKey.Schedule,name:"Schedule",component:pn},{id:x.StepKey.Share,name:"Share",component:Qn},{id:x.StepKey.Confirm,name:"Confirm",component:_e}]},27770:(Z,R,e)=>{"use strict";e.d(R,{A0:()=>O,Bf:()=>I,FI:()=>C,LU:()=>T,N1:()=>D,U1:()=>b,Yx:()=>E,y8:()=>P});var n=e(4213),a=e.n(n),s=e(75505),l=e(32899),o=e(83175),d=e(68143),i=e(75234),c=e(13956),m=e(75421),p=e(7817),h=e(39167),r=e(98924),g=e(19196),y=e(51208),v=e(12880),x=e(94676);const f="api/reports";function u(){return async j=>{const W=await(0,d.AI)().get(f);j((0,x.JQ)(W))}}function b(j,W,B){return async S=>{const w=await(0,c.n)("v1").getDashboardDTO(j),N=new p.G(w.dashboard,w.meta),M=E(N.panels);if((0,v.zp)(N.templating.list)){const A=(0,g.Uz)(B)?N?.time:B;(0,m.jG)().setTime(A)}const L=(0,v.lo)(N.templating.list,W||(0,v.Z5)(N.templating.list),M);await S((0,h._q)(w.dashboard.uid,{...N,templating:{list:L}})),S((0,x.Lm)(j))}}function E(j,W=new Set){return j.forEach(B=>{B.repeat&&W.add(B.repeat),B.panels&&E(B.panels,W)}),W}function D(j){return async W=>{W((0,x.qJ)());try{const B=await(0,d.AI)().get(`${f}/${j}`);B.dashboards||(B.dashboards=[{dashboard:{uid:B.dashboardUid,id:B.dashboardId,name:B.dashboardName},reportVariables:B.templateVars,timeRange:B.options.timeRange}]);for(const S of B.dashboards)S.dashboard.uid&&await W(b(S.dashboard.uid,S.reportVariables,S.timeRange));W((0,x.Yk)(B))}catch{W((0,x.et)())}}}function C(j){return W=>(W((0,x.an)()),(0,d.AI)().post(`${f}/test-email/`,j).finally(()=>W((0,x.Zl)())))}function P(j){return async W=>{await(0,d.AI)().delete(`${f}/${j}`),W(u())}}function T(j){return async()=>{try{await(0,d.AI)().post(f,j)}catch(W){throw W}}}function O(j,W){return async B=>{const S=["hour","minute","day"];j={...j,schedule:Object.fromEntries(Object.entries(j.schedule).filter(([w,N])=>!S.includes(w)))},await(0,d.AI)().put(`${f}/${j.id}`,j),W&&B(u())}}function I(j,W){return async B=>{if((0,r.b0)(W)){(0,i.J7)().publish({type:l.r1.alertError.name,payload:["Invalid dashboards"]});return}const S={title:j};S.dashboards=(0,y.U)(W);const w=o.kM.appendQueryToUrl(`${f}/render/csvs/`,o.kM.toUrlParams(S));try{B((0,x.Q7)());const N=await(0,s.s)((0,d.AI)().fetch({url:w,method:"GET",responseType:"blob"}));if(N.status===204){(0,i.J7)().publish({type:l.r1.alertWarning.name,payload:["The report does not contain any dashboard with a table panel"]});return}const M=new Blob([N.data],{type:"application/zip"});(0,n.saveAs)(M,`${j||"report-csv"}.zip`),(0,i.J7)().publish({type:l.r1.alertSuccess.name,payload:["CSV downloaded"]})}catch{(0,i.J7)().publish({type:l.r1.alertError.name,payload:["There was an error downloading the CSV"]})}finally{B((0,x.kH)())}}}},94676:(Z,R,e)=>{"use strict";e.d(R,{$J:()=>p,Ay:()=>P,JQ:()=>r,Lm:()=>u,Md:()=>o,Q7:()=>E,Yk:()=>h,Zl:()=>f,an:()=>x,et:()=>v,kH:()=>D,n0:()=>g,qJ:()=>y,ue:()=>c,uq:()=>d,wj:()=>b});var n=e(65307),a=e(99305),s=e(69788),l=e(70234);const o=()=>{if(!window.Intl)return"";const T=window.Intl.DateTimeFormat();if(!T.resolvedOptions)return"";const O=T.resolvedOptions();return O.timeZone?O.timeZone:""},d={from:"",to:"",raw:{from:"",to:""}},i={id:0,name:"",subject:"",recipients:"",replyTo:"",message:l.FE,dashboardId:void 0,dashboardName:"",dashboards:[{dashboard:void 0,timeRange:d.raw}],schedule:{frequency:s.ReportSchedulingFrequency.Weekly,timeZone:o()},formats:[s.ReportFormat.PDF],scaleFactor:l.Pf,options:{orientation:"landscape",layout:"grid",timeRange:d.raw,pdfShowTemplateVariables:!1,pdfCombineOneFile:!1},enableDashboardUrl:!0,state:s.ReportState.Scheduled},c={reports:[],report:i,hasFetchedList:!1,hasFetchedSingle:!1,searchQuery:"",reportCount:0,isLoading:!0,isUpdated:!1,visitedSteps:[]},m=(0,n.Z0)({name:"reports",initialState:c,reducers:{reportsLoaded:(T,O)=>({...T,reports:O.payload,reportCount:O.payload.length,hasFetchedList:!0}),reportLoaded:(T,O)=>({...T,report:O.payload,hasFetchedSingle:!0,isLoading:!1}),updateReportProp:(T,O)=>({...T,isUpdated:!0,report:O.payload}),clearReportState:T=>({...T,isUpdated:!1,visitedSteps:[],report:i}),reportLoadingBegin:T=>({...T,isLoading:!0}),reportLoadingEnd:T=>({...T,isLoading:!1}),testEmailSendBegin:T=>({...T,testEmailIsSending:!0}),testEmailSendEnd:T=>({...T,testEmailIsSending:!1}),setLastUid:(T,O)=>({...T,lastUid:(0,a.q4)(O.payload)}),addVisitedStep:(T,O)=>({...T,visitedSteps:[...T.visitedSteps,...O.payload]}),downloadCSVBegin:T=>({...T,isDownloadingCSV:!0}),downloadCSVEnd:T=>({...T,isDownloadingCSV:!1})}}),{clearReportState:p,reportLoaded:h,reportsLoaded:r,updateReportProp:g,reportLoadingBegin:y,reportLoadingEnd:v,testEmailSendBegin:x,testEmailSendEnd:f,setLastUid:u,addVisitedStep:b,downloadCSVBegin:E,downloadCSVEnd:D}=m.actions,P={reports:m.reducer}},98924:(Z,R,e)=>{"use strict";e.d(R,{_7:()=>p,b0:()=>c,nu:()=>m,rq:()=>h});var n=e(7389),a=e(17548),s=e(25229),l=e(36674),o=e(8921),d=e(68392),i=e(12880);const c=r=>r?.length?!r.some(g=>!!g.dashboard?.uid):!0,m=r=>r?.length?!r.some(g=>!!g.state.uid):!0,p=r=>r?.state.variables.reduce((g,y)=>{if(y.state.hide!==n.zL.hideVariable){let v;if(l.Go.isAdHocVariable(y))v=(0,i.Zc)(y.state.filters);else if((0,i.li)(y))v=y.state.value,Array.isArray(v)&&v.includes(o.To)&&(v=o.Zm);else throw new Error(`Reporting: Unsupported variable type ${y.state.type}`);g[y.state.name]=Array.isArray(v)?v.map(String):[String(v??"")]}return g},{})??{},h=r=>r.map(g=>{const{state:y}=g,v=a.isRelativeTimeRange({from:y.$timeRange?.state.from??"",to:y.$timeRange?.state.to??""}),x={from:y.$timeRange?.state.from&&v?y.$timeRange?.state.from:(0,s.KQ)(y.$timeRange?.state.from),to:y.$timeRange?.state.to&&v?y.$timeRange?.state.to:(0,s.KQ)(y.$timeRange?.state.to)};return{dashboard:{uid:y.uid??"",name:y.title},reportVariables:p(g.state.$variables),timeRange:(0,d.RC)(x)}})},19196:(Z,R,e)=>{"use strict";e.d(R,{J5:()=>r,JO:()=>l,Th:()=>h,Uz:()=>g,WB:()=>m,Zf:()=>c,lB:()=>y,pp:()=>d,zc:()=>i});var n=e(25229),a=e(80011),s=e(17548);const l=(v,x={hour:0,minute:0},f)=>{const u=`${x.hour}:${x.minute}:00`,b=typeof v=="string"?d(v):v,E=new Date(`${(0,n.KQ)(b).format("YYYY/MM/DD")} ${u}`),D=(0,a.LE)(E.getTime(),{timeZone:f,format:"Z"});return o((0,n.KQ)(E).format())+D},o=v=>v.includes("Z")?v.replace("Z",""):v.slice(0,-6),d=v=>v?(0,n.KQ)(v.split("T")[0]).toDate():"",i=v=>(0,n.KQ)(v.split("T")[0]).toDate(),c=v=>String(v).length===1?`0${v}`:String(v),m=v=>{if(!v)return{hour:0,minute:0};const x=v.match(/T(\d+):(\d+)/);if(x){const[,f,u]=x;return{hour:parseInt(f,10),minute:parseInt(u,10)}}return{hour:0,minute:0}},p=v=>v?dateTime(v).isBefore(dateTime()):!1,h=(v,x)=>{if(!v)return{time:void 0,date:void 0};const{hour:f,minute:u}=m(v);return{date:(0,a.LE)(v,{format:"MMMM DD, YYYY",timeZone:x??""}),time:`${c(f)}:${c(u)}`}},r=v=>{if(!v.from||!v.to)return"Dashboard time range";const x=parseInt(v.from,10),f=parseInt(v.to,10);return!isNaN(x)&&!isNaN(f)?s.describeTimeRange({from:(0,n.KQ)(x),to:(0,n.KQ)(f)}):s.describeTimeRange(v)},g=v=>!v||!v.from||!v.to,y=v=>[29,30,31].includes(v)},2556:(Z,R,e)=>{"use strict";e.d(R,{p:()=>o});var n=e(92745),a=e(73427),s=e(87745),l=e(40951);const o=(d,i)=>{const c=()=>{l.M.discardClicked(i),d()};a.lE.publish(new s.bY({title:(0,n.t)("share-report.discard-changes.title","Discard changes to report?"),text:(0,n.t)("share-report.discard-changes.text","You have unsaved changes to this dashboard report. Are you sure you want to discard them?"),icon:"trash-alt",yesText:(0,n.t)("share-report.discard-changes.discard-button","Discard"),onConfirm:c}))}},9735:(Z,R,e)=>{"use strict";e.d(R,{U:()=>a});var n=e(69788);const a=s=>s?s.frequency===n.ReportSchedulingFrequency.Never?"Save and exit":s.startDate?"Schedule send":"Send now":"Save report"},60861:(Z,R,e)=>{"use strict";e.d(R,{V:()=>s});var n=e(73427),a=e(69788);const s=n.TP.hasPermission(a.AccessControlAction.ReportingWrite)||n.TP.hasPermission(a.AccessControlAction.ReportingCreate)},76686:(Z,R,e)=>{"use strict";e.d(R,{D:()=>a});var n=e(43173);const a=()=>{const s=n.$.rendererVersion;if(s==="")return null;const o=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/.exec(s);let d="";if(o&&o.length>1&&(d=o[1]),d==="")return 1;let i=parseInt(d,10);return isNaN(i)&&(i=1),i}},46310:(Z,R,e)=>{"use strict";e.d(R,{U:()=>s,m:()=>a});var n=e(69788);const a=l=>{const o=l.state,d=l.schedule.frequency===n.ReportSchedulingFrequency.Never,i=d||[n.ReportState.Draft,n.ReportState.Expired,n.ReportState.Paused].includes(o),c=d||[n.ReportState.Expired].includes(o);return{isNever:d,showPlay:i,disableEdit:c,reportState:o}},s=l=>{let o=n.ReportState.Scheduled;return l===n.ReportState.Expired?o=l:l!==n.ReportState.Paused&&(o=n.ReportState.Paused),o}},65988:(Z,R,e)=>{"use strict";e.d(R,{A0:()=>d,En:()=>i,I5:()=>p,OG:()=>r,XO:()=>g,hv:()=>c,mM:()=>m});var n=e(25229),a=e(44229),s=e(69788),l=e(94676),o=e(19196);const d=(y={})=>{const{time:v,startDate:x,endDate:f,endTime:u,timeZone:b,frequency:E,dayOfMonth:D,workdaysOnly:C,intervalFrequency:P,intervalAmount:T,sendTime:O}=y,I=!v&&x?(0,o.WB)(String(x)):v,j=x&&O!=="now"?(0,o.JO)(x,I,b):"",W=f&&![s.ReportSchedulingFrequency.Once,s.ReportSchedulingFrequency.Never].includes(E)?(0,o.JO)(f,u,b):"",B={frequency:E,timeZone:b,workdaysOnly:C,intervalFrequency:P,intervalAmount:T?parseInt(T,10):0,startDate:j,endDate:W,dayOfMonth:D===s.LAST_DAY_OF_MONTH?s.LAST_DAY_OF_MONTH:""};return Object.fromEntries(Object.entries(B).filter(([S,w])=>w))};function i(y){const v=["th","st","nd","rd"],x=y%100;return y+(v[(x-20)%10]||v[x]||v[0])}const c=(y,v=s.ReportIntervalFrequency.Hours)=>y===s.ReportSchedulingFrequency.Custom&&v===s.ReportIntervalFrequency.Hours,m=(y,v=s.ReportIntervalFrequency.Hours)=>[s.ReportSchedulingFrequency.Hourly,s.ReportSchedulingFrequency.Daily].includes(y)||c(y,v);function p({startDate:y,endDate:v,intervalFrequency:x=s.ReportIntervalFrequency.Hours,intervalAmount:f=2,frequency:u,dayOfMonth:b,timeZone:E,workdaysOnly:D}){if(!y)return"";const C="en-US",{hour:P,minute:T}=(0,o.WB)(y),O=(0,o.Zf)(T),I=(0,o.Zf)(P),j=(0,n.KQ)((0,o.pp)(y)).locale(C).format("dddd"),W=b==="last"?"last":i((0,o.pp)(y).getDate());let B,S;const w=(0,a.t)(Date.now(),E),N=`at ${I}:${O}${w?` ${w}`:""}`,M=D&&m(u,x)?", Monday to Friday":"";if(v){const L=(0,n.KQ)((0,o.pp)(y)).locale(C).format("LL"),A=(0,n.KQ)((0,o.pp)(v)).locale(C).format("LL");A!==L?B=`${L} - ${A}`:B=L}switch(u){case s.ReportSchedulingFrequency.Monthly:S=`Monthly on the ${W} day ${N}`;break;case s.ReportSchedulingFrequency.Weekly:S=`Every ${j} ${N}`;break;case s.ReportSchedulingFrequency.Daily:S=`Daily ${N}`;break;case s.ReportSchedulingFrequency.Hourly:S=`Hourly at minute ${O}`;break;case s.ReportSchedulingFrequency.Custom:S=`Every ${f} ${x}`;break;case s.ReportSchedulingFrequency.Once:S=`Once on ${(0,n.KQ)((0,o.pp)(y)).locale(C).format("LL")}`;break;case s.ReportSchedulingFrequency.Never:S="Never";break;default:S=""}return B&&S?`${S}, ${B}${M}`:(u===s.ReportSchedulingFrequency.Custom&&(S+=`, ${x===s.ReportIntervalFrequency.Hours?`from ${I}:${O}${w?` ${w}`:""}`:`from ${(0,n.KQ)((0,o.pp)(y)).locale(C).format("LL")}`}`),S+M)}const h=new Map([[s.ReportSchedulingFrequency.Monthly,"month"],[s.ReportSchedulingFrequency.Daily,"day"],[s.ReportSchedulingFrequency.Weekly,"week"],[s.ReportSchedulingFrequency.Hourly,"hour"]]),r=y=>{const{frequency:v,intervalFrequency:x=s.ReportIntervalFrequency.Hours,intervalAmount:f="2"}=y;if(v===s.ReportSchedulingFrequency.Never)return"This report will not be sent.";const u=y.workdaysOnly?", Monday to Friday.":".",b=[];if(!y.startDate){b.push("This report will be sent immediately after it's saved");const D=v===s.ReportSchedulingFrequency.Custom?`${f} ${x}`:h.get(v);return D&&b.push(`and then every ${D}`),b.join(" ")+u}const E=p(d(y));return E&&b.push(`This report will be sent: ${E}.`),b.join(" ")},g=y=>{const v=l.ue.report.schedule;return Object.keys(v).length!==Object.keys(y).length?!0:Object.entries(v).some(([x,f])=>f!==y[x])}},9229:(Z,R,e)=>{"use strict";e.d(R,{D0:()=>c,Jh:()=>p,Js:()=>i,zn:()=>m});var n=e(25229),a=e(80238),s=e(68392),l=e(94676),o=e(98924),d=e(19196);const i=h=>{let r=[];h.dashboardsScene&&(r=(0,o.rq)(h.dashboardsScene));const g=[{condition:h.attachments?.pdf,format:a.ac.PDF},{condition:h.attachments?.csv,format:a.ac.CSV},{condition:h.attachments?.pdfTables,format:a.ac.PDFTables},{condition:h.pdfOptions?.dashboardPDF?.addPDFTablesAppendix,format:a.ac.PDFTablesAppendix},{condition:h.addDashboardImage,format:a.ac.Image}].reduce((C,{condition:P,format:T})=>(P&&C.push(T),C),[]),{startDate:y,startTime:v,endDate:x,endTime:f,timeZone:u}=h.schedule||{};let b;if(y){const C={hour:v?.hour?.()??0,minute:v?.minute?.()??0};b=(0,d.JO)(y,C,u)}let E;if(x){const C={hour:f?.hour?.()??0,minute:f?.minute?.()??0};E=(0,d.JO)(x,C,u)}return{id:h.id??0,subject:h.subject,state:h.state??a.QF.Draft,message:h.message||"",name:h.title||"",replyTo:h.replyTo||"",recipients:h.recipients?.join(",")||"",formats:g,options:{orientation:h.pdfOptions?.orientation||"landscape",layout:h.pdfOptions?.layout||"grid",pdfShowTemplateVariables:h.pdfOptions?.dashboardPDF?.showTemplateVariables||!1,pdfCombineOneFile:h.pdfOptions?.dashboardPDF?.combineOneFile||!1},enableDashboardUrl:h.addDashboardUrl,dashboards:r,scaleFactor:h.pdfOptions?.scaleFactor,schedule:{intervalFrequency:h.schedule?.intervalFrequency,intervalAmount:h.schedule?.intervalAmount,workdaysOnly:h.schedule?.workdaysOnly,timeZone:h.schedule?.timeZone||(0,l.Md)(),frequency:h.schedule?.frequency||a.Bw.Daily,dayOfMonth:h.schedule?.lastDayOfMonthOnly?a.F0:void 0,startDate:b,endDate:E}}},c=h=>{const r={pdf:h.formats.includes(a.ac.PDF),csv:h.formats.includes(a.ac.CSV),pdfTables:h.formats.includes(a.ac.PDFTables)},g={orientation:h.options.orientation,layout:h.options.layout,scaleFactor:h.scaleFactor??1,dashboardPDF:{showTemplateVariables:h.options.pdfShowTemplateVariables??!1,combineOneFile:h.options.pdfCombineOneFile??!1,addPDFTablesAppendix:h.formats.includes(a.ac.PDFTablesAppendix)}},y={frequency:h.schedule.frequency,timeZone:h.schedule.timeZone,startDate:h.schedule.startDate?(0,d.zc)(h.schedule.startDate):void 0,startTime:h.schedule.startDate?(0,n.oZ)(h.schedule.timeZone,h.schedule.startDate):void 0,endDate:h.schedule.endDate?(0,d.zc)(h.schedule.endDate):void 0,endTime:h.schedule.endDate?(0,n.oZ)(h.schedule.timeZone,h.schedule.endDate):void 0,intervalFrequency:h.schedule.intervalFrequency,intervalAmount:h.schedule.intervalAmount,workdaysOnly:h.schedule.workdaysOnly,lastDayOfMonthOnly:h.schedule.dayOfMonth===a.F0,sendTime:h.schedule.startDate?a.OZ.Later:a.OZ.Now};return{id:h.id,title:h.name,subject:h.subject,message:h.message,replyTo:h.replyTo,recipients:h.recipients?h.recipients.split(","):[],attachments:r,pdfOptions:g,addDashboardUrl:h.enableDashboardUrl??!1,addDashboardImage:h.formats.includes(a.ac.Image),dashboards:h.dashboards.map(v=>({uid:v.dashboard?.uid,title:v.dashboard?.name,variables:v.reportVariables,timeRange:(0,s.GE)(v.timeRange)})),schedule:y,state:h.state??a.QF.Draft}},m=h=>({...h,schedule:{...h.schedule,frequency:h.schedule.frequency}}),p=h=>({...h,schedule:{...h.schedule,frequency:h.schedule.frequency}})},51208:(Z,R,e)=>{"use strict";e.d(R,{A2:()=>v,Do:()=>g,IM:()=>f,KM:()=>r,U:()=>x,s0:()=>y,y3:()=>p});var n=e(83175),a=e(75421),s=e(72746),l=e(66223),o=e(68392),d=e(70234),i=e(94676),c=e(98924),m=e(12880);const p=()=>{if(!window.location.search)return null;const u=new URLSearchParams(window.location.search);return{timeRange:{to:u.get("to")||"",from:u.get("from")||""},dashboard:{uid:u.get("db-uid")||"",name:u.get("db-name")||""},variables:(0,m.S9)()}},h=u=>{if(u.id)return u;const b=p();if(!b)return u;const{timeRange:E,dashboard:D,variables:C}=b;let P=[...initialState.report.dashboards];return E?.from&&E?.to&&(P[0]={...P[0],timeRange:{...E,raw:E}}),D.name&&D.uid&&(P[0]={...P[0],dashboard:{uid:D.uid,name:D.name}}),C&&Object.keys(C).length&&(P[0]={...P[0],reportVariables:C}),{...u,dashboards:P}},r=()=>{const u=new URLSearchParams(window.location.search),b=u.get("to"),E=u.get("from");return E&&b?{from:E,to:b}:null},g=(u,b)=>`${d.lb}/${u}${b?"/"+b:""}`,y=u=>b=>`${d.lb}/${b}${u?"/"+u:""}`,v=u=>{const b=n.kM.toUrlParams((0,l.z)()),E=n.kM.toUrlParams((0,a.jG)().timeRangeForUrl()),D=u instanceof s.H$?u?.state.uid:u?.uid,C=u instanceof s.H$?u?.state.title:u?.title;return`${d.km}/?${b}&${E}&db-uid=${D}&db-name=${C}`},x=u=>JSON.stringify(u.map(b=>{const{from:E,to:D}=(0,o.eO)(b.timeRange).raw||i.uq.raw;return{dashboard:{uid:b.dashboard?.uid},timeRange:{from:E.valueOf().toString(),to:D.valueOf().toString()},reportVariables:b.reportVariables}})),f=u=>JSON.stringify(u.map(b=>{const{state:E}=b,{from:D,to:C}=(0,o.eO)(E.$timeRange?.state.value).raw||i.uq.raw;return{dashboard:{uid:E.uid},timeRange:{from:D.valueOf().toString(),to:C.valueOf().toString()},reportVariables:(0,c._7)(E.$variables)}}))},17834:(Z,R,e)=>{"use strict";e.d(R,{As:()=>p,a_:()=>m,mr:()=>c});var n=e(88652),a=e(47402),s=e(92745),l=e(43910),o=e(69788),d=e(55355);const i=h=>Array.isArray(h)?h?.length:!0,c=h=>{const r=[{step:o.StepKey.SelectDashboard,fields:["dashboards"]},{step:o.StepKey.FormatReport,fields:["formats"]},{step:o.StepKey.Share,fields:["name","recipients"]}],g=!h.dashboards?.[0]?.dashboard?.uid;return d.Ek.reduce((y,v)=>{if(y[v.id]={valid:!0},v.id===o.StepKey.SelectDashboard)return y[o.StepKey.SelectDashboard].valid=!g,y;{const x=r.find(f=>f.step===v.id)?.fields;return x&&(y[v.id].valid=x.every(f=>h[f]&&i(h[f]))),y}},{})},m=(h,r)=>{const g=c(h);return r?!g[r].valid:Object.values(g).some(y=>!y.valid)},p=h=>({title:{required:(0,s.t)("share-report.report-name.required","Report name is required")},dashboards:{uid:{required:(0,s.t)("share-report.dashboard.dashboard-required","Dashboard is required")}},replyTo:{validate:r=>r?(0,l.xf)(r)||(0,s.t)("share-report.email-configuration.invalid-email","Invalid email"):!0},schedule:{startDate:{required:(0,s.t)("share-report.schedule.start-date-required","Start date is required")},endDate:{validate:r=>!r||!h?.schedule?.startDate?!0:h?.schedule?.startDate&&((0,n.r)(r,h.schedule.startDate)||(0,a.d)(r,h.schedule.startDate))||(0,s.t)("share-report.schedule.end-date-invalid","End date must be greater or equal to start date")},intervalAmount:{required:(0,s.t)("share-report.schedule.interval-amount-required","Interval amount is required"),min:{value:2,message:(0,s.t)("share-report.schedule.interval-amount-min","Interval amount must be at least 2")}}},recipients:{required:(0,s.t)("share-report.recipients.recipients-required","Recipients are required")}})},12880:(Z,R,e)=>{"use strict";e.d(R,{$w:()=>h,IU:()=>b,S9:()=>x,T6:()=>u,Xt:()=>r,Z5:()=>p,Zc:()=>C,li:()=>D,lo:()=>v,oI:()=>E,zp:()=>f});var n=e(2543),a=e.n(n),s=e(7389),l=e(36674),o=e(54742),d=e(8921),i=e(67933),c=e(93612),m=e(99305);const p=B=>B?.length?Object.fromEntries(B.map(S=>{const{getValueForUrl:w}=o.B.get(S.type),N=w(S);return[S.name,Array.isArray(N)?N:[N]]})):{},h=B=>{if(!B?.length)return{};const S=(0,m.pY)();return Object.fromEntries(B.map(w=>{const{name:N}=w.state,M=S[N],L=(Array.isArray(M)?M:[M]).map(A=>A?.toString()??"");return[N,L]}))},r=(B,S)=>!S||!Object.keys(S).length?B:B.map(w=>{const N=S[w.name];if(!N)return w;if(w.type==="adhoc")return{...w,filters:P(N)};if(g(w))return y(w,N);throw new Error(`Reporting: Unsupported variable type ${w.type}`)});function g(B){return["custom","query","datasource","interval","constant","textbox","groupby"].includes(B.type)}const y=(B,S)=>{const w=S.map(L=>B.options?.find(A=>A.value===L)||{text:L,value:L}).filter(Boolean),N="multi"in B&&B.multi,M="current"in B?{current:{...B.current,text:N?w.map(L=>L?.text):w[0].text,value:N?w.map(L=>L?.value===d.Zm?d.To:L?.value):w[0].value}}:void 0;return{...B,...M,options:B.options.map(L=>({...L,selected:typeof L.value=="string"&&S.includes(L.value)}))}},v=(B,S,w)=>!S||!Object.keys(S).length?B.map(N=>({...N,usedInRepeat:w?.has(N.name)})):B.map(N=>{const M=S[N.name];if(!M||!(0,i.SP)(N))return N;const L=M.map(U=>N.options.find(F=>F.value===U)||{text:U,value:U}).filter(Boolean),A="multi"in N&&N.multi;return{...N,usedInRepeat:w?.has(N.name),current:{...N.current,text:A?L.map(U=>U?.text):L[0].text,value:A?L.map(U=>U?.value):L[0].value},options:N.options.map(U=>({...U,selected:typeof U.value=="string"&&M.includes(U.value)}))}}),x=()=>{const B="var-",S=new URLSearchParams(window.location.search),w={};for(const[N,M]of S.entries())if(N.startsWith(B)){const L=N.replace(B,"");w[L]=[...w[L]||[],M]}return w},f=B=>B.some(S=>(0,i.P4)(S)&&S.refresh===s.CO.onTimeRangeChanged),u=(B,S,w)=>{const N=b(B,S,w);return N&&N.usedInRepeat},b=(B,S,w)=>w.find(N=>"current"in N&&N.current.value?N.current.value.length===1&&N.current.value[0]===B&&N.type===S:!1),E=(B,S)=>{if(!B)return[];const w=S?(0,c.SS)(S):[],N=v(w,B);return Object.entries(B).map(([M,L])=>{let A=L;const U=N.find(F=>F.name===M);return U&&(0,i.m8)(U)&&(A=Array.isArray(U.current.text)?U.current.text:[U.current.text]),[M,A]})},D=B=>l.Go.isCustomVariable(B)||l.Go.isQueryVariable(B)||l.Go.isDataSourceVariable(B)||l.Go.isIntervalVariable(B)||l.Go.isConstantVariable(B)||l.Go.isTextBoxVariable(B)||l.Go.isGroupByVariable(B),C=B=>B.map(S=>I(S).map(T).join("|")),P=B=>{if((0,n.isArray)(B))return B.map(j).filter(W);const S=j(B);return S===null?[]:[S]};function T(B){return B==null?"":/\|/g[Symbol.replace](B,"__gfp__")}function O(B){return B==null?"":/__gfp__/g[Symbol.replace](B,"|")}function I(B){return[B.key,B.operator,B.value]}function j(B){if(!(0,n.isString)(B)||B.length===0)return null;const S=B.split("|").map(O);return{key:S[0],operator:S[1],value:S[2]}}function W(B){return B!==null&&(0,n.isString)(B.value)}},61984:(Z,R,e)=>{"use strict";e.d(R,{C:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(30703),o=e(20941);function d({validationResults:c,onStepChange:m,visitedSteps:p=[],getNextUrl:h,steps:r,activeStep:g=r[0].id}){const y=(0,s.of)(i),v=r[r.length-1];return(0,n.jsx)("ol",{className:y.container,children:r.map(x=>{const f=x.id===v.id,u=x.id===g,b=p.includes(x.id)||g===v.id,E=!f&&!c[x.id].valid,D=!u&&!f&&b,C=D&&!E,P=D&&E,T=(0,a.cx)(y.item,{[y.active]:u,[y.successItem]:C,[y.warnItem]:P});return(0,n.jsxs)("li",{className:T,children:[C&&(0,n.jsx)(l.I,{name:"check",size:"xl",className:y.successItem}),P&&(0,n.jsx)(l.I,{name:"exclamation-triangle",className:y.warnItem}),(0,n.jsx)(o.N,{onClick:u?void 0:()=>m(x.id),href:h(x.id),className:y.link,children:x.name}),!f&&(0,n.jsx)("div",{className:y.divider,children:"\u2014"})]},x.id)})})}const i=c=>({container:(0,a.css)({counterReset:"item",listStyleType:"none",width:"100%",position:"relative",display:"flex",justifyContent:"center",border:`1px solid ${c.colors.border.weak}`,margin:c.spacing(4,0)}),item:(0,a.css)({color:c.colors.text.secondary,display:"flex",alignItems:"center"}),successItem:(0,a.css)({a:{"&::before":{content:"''"}},svg:{color:c.colors.success.text,margin:c.spacing(0,.5,0,-1)}}),warnItem:(0,a.css)({"a::before":{content:"''"},svg:{color:c.colors.warning.text,margin:c.spacing(0,1,.5,-.5)}}),link:(0,a.css)({color:"inherit","&:hover":{color:c.colors.text.link},"&::before":{content:"counter(item) '  '",counterIncrement:"item"}}),active:(0,a.css)({fontWeight:500,color:c.colors.text.maxContrast,"&::before":{fontWeight:500}}),divider:(0,a.css)({padding:c.spacing(2)})})},58120:(Z,R,e)=>{"use strict";e.d(R,{Tg:()=>l,aV:()=>d});var n=e(65307);const a={teamLBACConfig:{rules:[]}},s=(0,n.Z0)({name:"teamLBAC",initialState:a,reducers:{teamLBACLoaded:(i,c)=>({...i,teamLBACConfig:c.payload})}}),{teamLBACLoaded:l}=s.actions,d={teamLBAC:s.reducer}},27288:()=>{"use strict"},69788:(Z,R,e)=>{"use strict";e.d(R,{AccessControlAction:()=>d,AnalyticsTab:()=>l,FooterMode:()=>s.z7,LAST_DAY_OF_MONTH:()=>s.F0,ReportFormat:()=>s.ac,ReportIntervalFrequency:()=>s.o9,ReportSchedulingFrequency:()=>s.Dr,ReportState:()=>s.QF,SAMLStepKey:()=>c,StepKey:()=>s.K1,Theme:()=>s.Sx,reportLayouts:()=>s.Ae,reportOrientations:()=>s.mG});var n=e(17057),a=e(77636),s=e(80238),l=(m=>(m.Stats="stats",m.Users="users",m.PublicDashboards="public-dashboards",m))(l||{}),o=e(27288),d=(m=>(m.ReportingCreate="reports:create",m.ReportingWrite="reports:write",m.ReportingDelete="reports:delete",m.ReportingRead="reports:read",m.ReportingSend="reports:send",m.ReportingSettingsWrite="reports.settings:write",m.ReportingSettingsRead="reports.settings:read",m.DataSourcesPermissionsRead="datasources.permissions:read",m.DataSourcesPermissionsWrite="datasources.permissions:write",m.DataSourcesCachingWrite="datasources.caching:write",m.LicensingRead="licensing:read",m.LicensingWrite="licensing:write",m.LicensingReportsRead="licensing.reports:read",m.DashboardsInsightsRead="dashboards.insights:read",m.ActionBannersWrite="banners:write",m))(d||{}),i=e(71461),c=(m=>(m.General="general",m.KeyCert="key-cert",m.ConnectToIdP="connect-to-idp",m.AssertionMapping="assertion-mapping",m.SaveAndTest="save-and-test",m))(c||{})},17057:()=>{"use strict"},71461:()=>{"use strict"},80238:(Z,R,e)=>{"use strict";e.d(R,{Ae:()=>c,Bw:()=>h,Dr:()=>n,F0:()=>p,K1:()=>m,OZ:()=>r,QF:()=>l,Sx:()=>d,ac:()=>o,mG:()=>i,o9:()=>a,z7:()=>s});var n=(g=>(g.Monthly="monthly",g.Weekly="weekly",g.Daily="daily",g.Hourly="hourly",g.Never="never",g.Custom="custom",g.Once="once",g))(n||{}),a=(g=>(g.Hours="hours",g.Days="days",g.Weeks="weeks",g.Months="months",g))(a||{}),s=(g=>(g.Default="",g.SentBy="sent-by",g.None="none",g))(s||{}),l=(g=>(g.Paused="paused",g.Scheduled="scheduled",g.Expired="expired",g.Draft="draft",g.Never="not scheduled",g))(l||{}),o=(g=>(g.PDF="pdf",g.CSV="csv",g.Image="image",g.PDFTables="pdf-tables",g.PDFTablesAppendix="pdf-tables-appendix",g))(o||{}),d=(g=>(g.Light="light",g.Dark="dark",g))(d||{});const i=[{value:"landscape",label:"Landscape",icon:"gf-landscape"},{value:"portrait",label:"Portrait",icon:"gf-portrait"}],c=[{value:"grid",label:"Grid",icon:"table"},{value:"simple",label:"Simple",icon:"gf-layout-simple"}];var m=(g=>(g.SelectDashboard="select-dashboard",g.FormatReport="format-report",g.Schedule="schedule",g.Share="share",g.Confirm="confirm",g))(m||{});const p="last";var h=(g=>(g.Monthly="monthly",g.Weekly="weekly",g.Daily="daily",g.Hourly="hourly",g.Custom="custom",g.Once="once",g))(h||{}),r=(g=>(g.Later="later",g.Now="now",g))(r||{})},77636:()=>{"use strict"},38082:(Z,R,e)=>{"use strict";e.d(R,{L:()=>a,X:()=>n});var n=(s=>(s.Test="test",s.Control="control",s))(n||{});const a=s=>"feature-highlights"+(s?`-${s}`:"")},68392:(Z,R,e)=>{"use strict";e.d(R,{GE:()=>m,RC:()=>d,eO:()=>i});var n=e(33239),a=e(25229),s=e(17548),l=e(94676);const o=h=>n.isValid(h.from)&&n.isValid(h.to),d=h=>!h||!o(h)?{from:"",to:""}:{to:h.to.valueOf().toString(),from:h.from.valueOf().toString()},i=h=>{const r=c(h.from),g=c(h.to);return o({from:r,to:g})?{from:r,to:g,raw:{from:r,to:g}}:l.uq},c=h=>{const r=parseInt(h,10);return isNaN(r)?h:(0,a.yT)(r)},m=h=>{const r=s.isRelativeTimeRange({from:h.from,to:h.to});return{from:r||h.from===""?h.from:p(h.from),to:r||h.to===""?h.to:p(h.to),raw:{from:h.from,to:h.to}}},p=h=>{const r=isNaN(Number(h))?h:parseInt(h,10);return(0,a.yT)(r).toISOString()}},43910:(Z,R,e)=>{"use strict";e.d(R,{K7:()=>s,mF:()=>a,nB:()=>l,xf:()=>n});const n=o=>o?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o):!1,a=/[,;\n]/,s=(o,d=a)=>o?o.split(d).filter(Boolean).every(i=>n(i)):!0,l=(o="",d=["png","jpg","gif","svg"])=>{if(!o)return!0;const i=o.split(".");return d.includes(i[i.length-1])}},49517:(Z,R,e)=>{"use strict";e.d(R,{G:()=>S});var n=e(74848),a=e(85891),s=e(73628),l=e(96540),o=e(92745),d=e(22787),i=e(45861),c=e(22803),m=e(63142),p=e(50275),h=e(37386),r=e(18027),g=e(35427),y=e(21285),v=e(97095),x=e(77824),f=e(17200),u=e(41654),b=e(63527),E=e(43243),D=e(76319);const C=({value:w,onChange:N})=>{const[M,L]=(0,l.useState)(""),[A,U]=(0,l.useState)(""),[F,V]=(0,l.useState)(a.VR.String),K=Y=>{L(Y)},G=Y=>{U(Y)},H=Y=>{V(Y.value)},_=()=>{let Y;w?Y=w.filter(X=>X.key!==M):Y=[],Y.push({key:M,name:A,type:F}),Y.sort((X,Q)=>X.key.localeCompare(Q.key)),N(Y),L(""),U(""),V(a.VR.String)},k=Y=>()=>{const X=w.filter(Q=>Q.key!==Y);N(X)},J=A===""||M==="",z=[{label:"string",value:a.VR.String}];return(0,n.jsxs)("div",{children:[(0,n.jsxs)(u.B,{direction:"row",children:[(0,n.jsx)(b.p,{value:M,onChange:Y=>K(Y.currentTarget.value),placeholder:(0,o.t)("actions.params-editor.placeholder-key","Key"),width:300}),(0,n.jsx)(b.p,{value:A,onChange:Y=>G(Y.currentTarget.value),placeholder:(0,o.t)("actions.params-editor.placeholder-name","Name"),width:300}),(0,n.jsx)(E.G,{value:F,onChange:H,placeholder:(0,o.t)("actions.variables-editor.placeholder-type","Type"),options:z,maxWidth:100,minWidth:10,width:"auto"}),(0,n.jsx)(D.K,{"aria-label":(0,o.t)("actions.params-editor.aria-label-add","Add"),name:"plus-circle",onClick:()=>_(),disabled:J})]}),(0,n.jsx)(u.B,{direction:"column",children:w.map(Y=>(0,n.jsxs)(u.B,{direction:"row",children:[(0,n.jsx)(b.p,{disabled:!0,value:Y.key,width:300}),(0,n.jsx)(b.p,{disabled:!0,value:Y.name,width:300}),(0,n.jsx)(b.p,{disabled:!0,value:Y.type,width:100}),(0,n.jsx)(D.K,{"aria-label":(0,o.t)("actions.params-editor.aria-label-delete","Delete"),onClick:k(Y.key),name:"trash-alt"})]},Y.key))})]})};var P=e(18857);const T=({value:w,onChange:N,suggestions:M,contentTypeHeader:L=!1})=>{const A=(0,m.of)(O),U=w.find(([ne,se])=>ne==="Content-Type"),[F,V]=(0,l.useState)(""),[K,G]=(0,l.useState)(""),[H,_]=(0,l.useState)("");(0,l.useEffect)(()=>{H!==""?_(H):U&&_(U[1])},[H,U]);const[k,J]=(0,l.useState)(Math.random().toString()),z=ne=>{G(ne)},Y=ne=>{V(ne)},X=ne=>()=>{const se=w.filter(ue=>ue[0]!==ne);N(se)},Q=ne=>{let se;w?se=w.filter(ue=>ue[0]!==(ne?ne[0]:F)):se=[],se.push(ne??[F,K]),se.sort((ue,de)=>ue[0].localeCompare(de[0])),N(se),V(""),G(""),J(Math.random().toString())},q=ne=>{_(ne),Q(["Content-Type",ne])},te=F===""||K==="";return(0,n.jsxs)("div",{children:[(0,n.jsxs)(u.B,{direction:"row",children:[(0,n.jsx)(f.y,{value:F,onChange:Y,suggestions:M,placeholder:(0,o.t)("actions.params-editor.placeholder-key","Key"),style:{width:332}}),(0,n.jsx)(f.y,{value:K,onChange:z,suggestions:M,placeholder:(0,o.t)("actions.params-editor.placeholder-value","Value"),style:{width:332}}),(0,n.jsx)(D.K,{"aria-label":(0,o.t)("actions.params-editor.aria-label-add","Add"),name:"plus-circle",onClick:()=>Q(),disabled:te})]},k),(0,n.jsx)(u.B,{direction:"column",children:Array.from(w.filter(ne=>ne[0]!=="Content-Type")||[]).map(ne=>(0,n.jsxs)(u.B,{direction:"row",children:[(0,n.jsx)(b.p,{disabled:!0,value:ne[0]}),(0,n.jsx)(b.p,{disabled:!0,value:ne[1]}),(0,n.jsx)(D.K,{"aria-label":(0,o.t)("actions.params-editor.aria-label-delete","Delete"),onClick:X(ne[0]),name:"trash-alt"})]},ne[0]))}),L&&(0,n.jsx)("div",{className:A.extraHeader,children:(0,n.jsxs)(u.B,{direction:"row",children:[(0,n.jsx)(b.p,{value:"Content-Type",disabled:!0}),(0,n.jsx)(P.l6,{onChange:ne=>q(ne.value),options:a.Ur,value:H})]})})]})},O=w=>({extraHeader:(0,c.css)({marginTop:w.spacing(1),marginBottom:w.spacing(1),maxWidth:673})}),I=13,j=(0,l.memo)(({index:w,value:N,onChange:M,suggestions:L,showOneClick:A})=>{const U=(0,m.of)(W),F=(0,m.$j)(),V=te=>{M(w,{...N,title:te})},K=te=>{M(w,{...N,confirmation:te})},G=()=>{M(w,{...N,oneClick:!N.oneClick})},H=te=>{M(w,{...N,fetch:{...N.fetch,url:te}})},_=te=>{M(w,{...N,fetch:{...N.fetch,body:te}})},k=te=>{M(w,{...N,fetch:{...N.fetch,method:te}})},J=te=>{M(w,{...N,variables:te})},z=te=>{M(w,{...N,fetch:{...N.fetch,queryParams:te}})},Y=te=>{M(w,{...N,fetch:{...N.fetch,headers:te}})},X=te=>{M(w,{...N,style:{...N.style,backgroundColor:te}})},Q=(te="{}")=>{try{const ne=JSON.parse(te);return(0,n.jsx)(p.B,{json:ne})}catch(ne){return ne instanceof Error?`Invalid JSON provided: ${ne.message}`:"Invalid JSON provided"}},q=N.fetch.method!==a.DO.GET&&N.fetch.headers?.some(([te,ne])=>te==="Content-Type"&&ne==="application/json");return(0,n.jsxs)("div",{className:U.listItem,children:[(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.action-editor.modal.action-title","Title"),className:U.inputField,children:(0,n.jsx)(f.y,{value:N.title,onChange:V,suggestions:L,autoFocus:N.title==="",placeholder:(0,o.t)("grafana-ui.action-editor.modal.action-title-placeholder","Action title")})}),(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.viz-tooltip.actions-confirmation-label","Confirmation message"),description:(0,o.t)("grafana-ui.viz-tooltip.actions-confirmation-message","Provide a descriptive prompt to confirm or cancel the action."),className:U.inputField,children:(0,n.jsx)(f.y,{value:N.confirmation,onChange:K,suggestions:L,placeholder:(0,o.t)("grafana-ui.viz-tooltip.actions-confirmation-input-placeholder","Are you sure you want to {{ actionTitle }}?",{actionTitle:N.title||"... "})})}),(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.action-editor.button.style","Button style"),children:(0,n.jsx)(r.I,{label:(0,o.t)("actions.action-editor.button.style.background-color","Color"),labelWidth:I,className:U.colorPicker,children:(0,n.jsx)(g.sk,{color:N?.style?.backgroundColor||F.colors.secondary.main,onChange:X})})}),A&&(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,o.t)("grafana-ui.action-editor.modal.one-click-description","Only one link or action can have one click enabled at a time"),children:(0,n.jsx)(y.d,{value:N.oneClick||!1,onChange:G})}),(0,n.jsx)(v.C,{children:(0,n.jsx)(r.I,{label:(0,o.t)("grafana-ui.action-editor.modal.action-method","Method"),labelWidth:I,grow:!0,children:(0,n.jsx)(x.z,{value:N?.fetch.method,options:a.ki,onChange:k,fullWidth:!0})})}),(0,n.jsx)(v.C,{children:(0,n.jsx)(r.I,{label:(0,o.t)("actions.action-editor.label-url","URL"),labelWidth:I,grow:!0,children:(0,n.jsx)(f.y,{value:N.fetch.url,onChange:H,suggestions:L,placeholder:(0,o.t)("actions.action-editor.placeholder-url","URL")})})}),(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.action-editor.modal.action-variables","Variables"),className:U.fieldGap,noMargin:!0,children:(0,n.jsx)(C,{onChange:J,value:N.variables??[]})}),(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.action-editor.modal.action-query-params","Query parameters"),className:U.fieldGap,children:(0,n.jsx)(T,{value:N?.fetch.queryParams??[],onChange:z,suggestions:L})}),(0,n.jsx)(h.D,{label:(0,o.t)("actions.action-editor.label-headers","Headers"),children:(0,n.jsx)(T,{value:N?.fetch.headers??[],onChange:Y,suggestions:L,contentTypeHeader:!0})}),N?.fetch.method!==a.DO.GET&&(0,n.jsx)(h.D,{label:(0,o.t)("grafana-ui.action-editor.modal.action-body","Body"),className:U.inputField,children:(0,n.jsx)(f.y,{value:N.fetch.body,onChange:_,suggestions:L,type:f.c.TextAreaElement})}),q&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),Q(N?.fetch.body)]})]})}),W=w=>({listItem:(0,c.css)({marginBottom:w.spacing()}),infoText:(0,c.css)({paddingBottom:w.spacing(2),marginLeft:"66px",color:w.colors.text.secondary}),fieldGap:(0,c.css)({marginTop:w.spacing(2)}),inputField:(0,c.css)({marginRight:4}),colorPicker:(0,c.css)({display:"flex",alignItems:"center"})});j.displayName="ActionEditor";const B=({action:w,index:N,onSave:M,onCancel:L,getSuggestions:A,showOneClick:U})=>{const[F,V]=(0,l.useState)(w);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j,{value:F,index:N,onChange:(K,G)=>{V(G)},suggestions:A(),showOneClick:U}),(0,n.jsxs)(d.a.ButtonRow,{children:[(0,n.jsx)(i.$n,{variant:"secondary",onClick:()=>L(N),fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"action-editor.modal.cancel-button",children:"Cancel"})}),(0,n.jsx)(i.$n,{onClick:()=>{M(N,F)},disabled:F.title.trim()===""||F.fetch.url.trim()==="",children:(0,n.jsx)(o.x6,{i18nKey:"action-editor.modal.save-button",children:"Save"})})]})]})},S=({actions:w,getSuggestions:N,showOneClick:M=!1,...L})=>(0,n.jsx)(s.J,{type:"action",items:w,...L,children:(A,U,F,V)=>(0,n.jsx)(B,{index:U,action:A??a.mx,data:L.data,onSave:F,onCancel:V,getSuggestions:N,showOneClick:M})})},27644:(Z,R,e)=>{"use strict";e.d(R,{$:()=>y,Z:()=>x});var n=e(74848),a=e(22803),s=e(96540),l=e(41607),o=e(92745),d=e(43173),i=e(63142),c=e(41654),m=e(45861),p=e(66404),h=e(22942),r=e(73427),g=e(83873);function y({page:f}){const u=(0,i.of)(v),b=r.TP.user.helpFlags1,E=4,[D,C]=(0,s.useState)(!!(b&E)),P=()=>{g.IB.put(`/api/user/helpflags/${E}`,void 0,{showSuccessAlert:!1}).then(T=>{r.TP.user.helpFlags1=T.helpFlags1,C(!0)})};return D||!x()?null:(0,n.jsxs)("div",{className:u.box,children:[(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)(h.q,{}),(0,n.jsx)(m.$n,{variant:"secondary",fill:"text",icon:"times",onClick:P,"aria-label":(0,o.t)("admin.enterprise-auth-features-card.dismiss","Dismiss")})]}),(0,n.jsxs)(c.B,{direction:"column",gap:.5,children:[(0,n.jsx)(p.E,{variant:"h4",children:(0,n.jsx)(o.x6,{i18nKey:"admin.enterprise-auth-features-card.heading",children:"Enterprise authentication"})}),(0,n.jsx)(p.E,{variant:"body",color:"secondary",children:(0,n.jsxs)(o.x6,{i18nKey:"admin.enterprise-auth-features-card.text",children:["Manage users, teams, and permissions automatically with ",(0,n.jsx)("strong",{children:"SAML"}),", ",(0,n.jsx)("strong",{children:"SCIM"}),","," ",(0,n.jsx)("strong",{children:"LDAP"}),", and ",(0,n.jsx)("strong",{children:"RBAC"})," \u2014 available in Grafana Cloud and Enterprise."]})})]}),(0,n.jsx)("div",{children:(0,n.jsx)(m.z9,{href:`https://grafana.com/auth/sign-up/create-user?cloud-auth=&redirectPath=cloud-auth&utm_source=oss-grafana&cnt-admin-${f}`,icon:"external-link-alt",variant:"secondary",target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)(o.x6,{i18nKey:"admin.enterprise-auth-features-card.learn-more-link",children:"Learn more"})})})]})}function v(f){return{cloudBadge:(0,a.css)({display:"flex",alignItems:"center",background:f.colors.gradients.brandHorizontal,color:f.colors.primary.contrastText,padding:f.spacing(.5,1),borderRadius:f.shape.radius.pill,fontSize:f.typography.bodySmall.fontSize,gap:f.spacing(1)}),box:(0,a.css)({padding:f.spacing(3),border:`1px solid ${f.colors.border.weak}`,backgroundColor:f.colors.background.secondary,display:"flex",flexDirection:"column",gap:f.spacing(1.5),borderRadius:f.shape.radius.default,marginTop:f.spacing(3),strong:{color:f.colors.text.primary}}),icon:(0,a.css)({position:"relative",top:-1})}}function x(){return d.$.buildInfo.edition===l.r.OpenSource||d.$.licenseInfo.stateInfo!=="Licensed"}},82853:(Z,R,e)=>{"use strict";e.d(R,{PU:()=>V,jT:()=>N});var n=e(74848),a=e(22803),s=e(96540),l=e(71468),o=e(51898),d=e(92745),i=e(63142),c=e(12737),m=e(77824),p=e(45861),h=e(50201),r=e(13791),g=e(73427),y=e(11257),v=e(27644),x=e(71555),f=e(89640),u=e(41654),b=e(45967),E=e(30703),D=e(66404),C=e(94018),P=e(27594),T=e(34213),O=e(11297),I=e(31286);const j=({units:_,icon:k})=>_?.length?_.length>1?(0,n.jsx)(b.m,{placement:"top",content:(0,n.jsx)(u.B,{direction:"column",children:_?.map(J=>(0,n.jsx)("span",{children:J.name},J.name))}),children:(0,n.jsx)(W,{icon:k,children:_.length})}):(0,n.jsx)(W,{icon:k,children:_[0].name}):null,W=(0,s.forwardRef)(({children:_,icon:k},J)=>(0,n.jsxs)(I.a,{ref:J,display:"flex",alignItems:"center",marginRight:1,children:[(0,n.jsx)(E.I,{name:k})," ",(0,n.jsx)(I.a,{marginLeft:1,children:_})]}));W.displayName="TooltipContent";const B=({users:_,showPaging:k,totalPages:J,onChangePage:z,currentPage:Y,fetchData:X})=>{const Q=(0,s.useMemo)(()=>_.some(ne=>ne.licensedRole),[_]),q=(0,s.useMemo)(()=>_.some(ne=>ne.orgs),[_]),te=(0,s.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:ne}})=>ne&&(0,n.jsx)(x.e,{src:ne,alt:"User avatar"})},{id:"login",header:"Login",cell:({row:{original:ne}})=>(0,n.jsx)(f.Y,{color:"primary",inline:!1,href:`/admin/users/edit/${ne.uid}`,title:(0,d.t)("admin.users-table.columns.title-edit-user","Edit user"),children:ne.login}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:ne}})=>ne,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:ne}})=>ne,sortType:"string"},...q?[{id:"orgs",header:"Belongs to",cell:({cell:{value:ne,row:se}})=>(0,n.jsxs)(u.B,{alignItems:"center",children:[(0,n.jsx)(j,{units:ne,icon:"building"}),se.original.isAdmin&&(0,n.jsx)(b.m,{placement:"top",content:(0,d.t)("admin.users-table.columns.content-grafana-admin","Grafana Admin"),children:(0,n.jsx)(E.I,{name:"shield"})})]})}]:[],...Q?[{id:"licensedRole",header:"Licensed role",cell:({cell:{value:ne}})=>ne==="None"?(0,n.jsxs)(D.E,{color:"disabled",children:[(0,n.jsx)(d.x6,{i18nKey:"admin.users-table.no-licensed-roles",children:"Not assigned"}),(0,n.jsx)(b.m,{placement:"top",content:(0,d.t)("admin.users-table.tooltip-assigned-role","A licensed role will be assigned when this user signs in"),children:(0,n.jsx)(E.I,{name:"question-circle",style:{margin:"0 0 4 4"}})})]}):ne}]:[],{id:"lastSeenAtAge",header:"Last active",headerTooltip:{content:"Time since user was seen using Grafana",iconName:"question-circle"},cell:({cell:{value:ne}})=>(0,n.jsx)(n.Fragment,{children:ne&&(0,n.jsx)(n.Fragment,{children:ne==="10 years"?(0,n.jsx)(D.E,{color:"disabled",children:(0,n.jsx)(d.x6,{i18nKey:"admin.users-table.last-seen-never",children:"Never"})}):ne})}),sortType:(ne,se)=>new Date(ne.original.lastSeenAt).getTime()-new Date(se.original.lastSeenAt).getTime()},{id:"authLabels",header:"Origin",cell:({cell:{value:ne}})=>(0,n.jsx)(n.Fragment,{children:Array.isArray(ne)&&ne.length>0&&(0,n.jsx)(O.E,{label:ne[0],removeIcon:!1,count:0})})},{id:"isProvisioned",header:"Provisioned",cell:({cell:{value:ne}})=>(0,n.jsx)(n.Fragment,{children:ne&&(0,n.jsx)(C.v,{colorIndex:14,name:"Provisioned"})})},{id:"isDisabled",header:"",cell:({cell:{value:ne}})=>(0,n.jsx)(n.Fragment,{children:ne&&(0,n.jsx)(C.v,{colorIndex:9,name:"Disabled"})})},{id:"edit",header:"",cell:({row:{original:ne}})=>(0,n.jsx)(p.z9,{variant:"secondary",size:"sm",icon:"pen",href:`admin/users/edit/${ne.uid}`,"aria-label":(0,d.t)("admin.users-table.edit-aria-label","Edit user: {{name}}",{name:ne.name}),tooltip:(0,d.t)("admin.users-table.edit-tooltip","Edit user")})}],[Q,q]);return(0,n.jsxs)(u.B,{direction:"column",gap:2,children:[(0,n.jsx)(P.j,{columns:te,data:_,getRowId:ne=>String(ne.id),fetchData:X}),k&&(0,n.jsx)(u.B,{justifyContent:"flex-end",children:(0,n.jsx)(T.d,{numberOfPages:J,currentPage:Y,onNavigate:z})})]})};var S=e(74267);const w=[],N=_=>{w.push(_)},M=o.Tp.pages.UserListPage.UserListAdminPage,L={fetchUsers:S.hU,changeQuery:S.nM,changePage:S.yd,changeFilter:S.$u,changeSort:S.Vk},A=_=>({users:_.userListAdmin.users,query:_.userListAdmin.query,showPaging:_.userListAdmin.showPaging,totalPages:_.userListAdmin.totalPages,page:_.userListAdmin.page,filters:_.userListAdmin.filters,isLoading:_.userListAdmin.isLoading}),V=(0,l.connect)(A,L)(({fetchUsers:_,query:k,changeQuery:J,users:z,showPaging:Y,changeFilter:X,filters:Q,totalPages:q,page:te,changePage:ne,changeSort:se,isLoading:ue})=>{const de=(0,i.of)(G);return(0,s.useEffect)(()=>{_()},[_]),(0,n.jsxs)(r.Y.Contents,{children:[(0,n.jsx)("div",{className:de.actionBar,"data-testid":M.container,children:(0,n.jsxs)("div",{className:de.row,children:[(0,n.jsx)(c.Z,{placeholder:(0,d.t)("admin.user-list-admin-page-un-connected.placeholder-search-login-email","Search user by login, email, or name."),autoFocus:!0,value:k,onChange:J,escapeRegex:!1}),(0,n.jsx)(m.z,{options:[{label:(0,d.t)("admin.user-list-admin-page-un-connected.label.all-users","All users"),value:!1},{label:(0,d.t)("admin.user-list-admin-page-un-connected.label.active-last-days","Active last 30 days"),value:!0}],onChange:ie=>X({name:"activeLast30Days",value:ie}),value:Q.find(ie=>ie.name==="activeLast30Days")?.value,className:de.filter}),w.map((ie,he)=>(0,n.jsx)(ie,{filters:Q,onChange:X,className:de.filter},he)),g.TP.hasPermission(y.w.UsersCreate)&&(0,n.jsx)(p.z9,{href:"admin/users/create",variant:"primary",children:(0,n.jsx)(d.x6,{i18nKey:"admin.users-list.create-button",children:"New user"})})]})}),!ue&&z.length===0?(0,n.jsx)(h.p,{message:(0,d.t)("users.empty-state.message","No users found"),variant:"not-found"}):(0,n.jsx)(B,{users:z,showPaging:Y,totalPages:q,onChangePage:ne,currentPage:te,fetchData:se}),(0,n.jsx)(v.$,{page:"users"})]})});function K(){return jsx(Page,{navId:"global-users",children:jsx(V,{})})}const G=_=>({filter:(0,a.css)({margin:_.spacing(0,1),[_.breakpoints.down("sm")]:{margin:0}}),actionBar:(0,a.css)({marginBottom:_.spacing(2),display:"flex",alignItems:"flex-start",gap:_.spacing(2),[_.breakpoints.down("sm")]:{flexWrap:"wrap"}}),row:(0,a.css)({display:"flex",alignItems:"flex-start",textAlign:"left",marginBottom:_.spacing(.5),flexGrow:1,[_.breakpoints.down("sm")]:{flexWrap:"wrap",gap:_.spacing(2),width:"100%"}})}),H=null},74267:(Z,R,e)=>{"use strict";e.d(R,{$u:()=>F,A5:()=>k,Bc:()=>J,DX:()=>w,JI:()=>B,Jc:()=>N,Kg:()=>S,MV:()=>x,N6:()=>b,P3:()=>C,Pi:()=>P,T$:()=>O,TK:()=>y,VR:()=>I,Vk:()=>K,hG:()=>u,hU:()=>L,is:()=>z,kz:()=>r,ly:()=>v,mI:()=>W,nM:()=>U,nh:()=>D,nr:()=>f,pm:()=>j,xq:()=>H,yd:()=>V});var n=e(2543),a=e.n(n),s=e(80011),l=e(62061),o=e(68143),d=e(36490),i=e(65642),c=e(73427),m=e(81871),p=e(11257),h=e(52695);function r(Y){return async X=>{try{X((0,h.D1)(!1)),await X(g(Y)),await X(E(Y)),await X(T(Y)),i.Ay.ldapEnabled&&(0,l.a)("ldapsync")&&await X(j()),X((0,h.D1)(!0))}catch(Q){if(console.error(Q),(0,o.NF)(Q)){const q={title:Q.data.message,body:Q.data.error};X((0,h.PV)(q))}}}}function g(Y){return async X=>{const Q=await(0,o.AI)().get(`/api/users/${Y}`,(0,m.F)());X((0,h.G_)(Q))}}function y(Y){return async X=>{await(0,o.AI)().put(`/api/users/${Y.uid}`,Y),X(r(Y.uid))}}function v(Y,X){return async Q=>{const q={password:X};await(0,o.AI)().put(`/api/admin/users/${Y}/password`,q),Q(r(Y))}}function x(Y){return async X=>{await(0,o.AI)().post(`/api/admin/users/${Y}/disable`),d.Ny.push("/admin/users")}}function f(Y){return async X=>{await(0,o.AI)().post(`/api/admin/users/${Y}/enable`),X(r(Y))}}function u(Y){return async X=>{await(0,o.AI)().delete(`/api/admin/users/${Y}`),d.Ny.push("/admin/users")}}function b(Y,X){return async Q=>{const q={isGrafanaAdmin:X};await(0,o.AI)().put(`/api/admin/users/${Y}/permissions`,q),Q(r(Y))}}function E(Y){return async X=>{const Q=await(0,o.AI)().get(`/api/users/${Y}/orgs`);X((0,h.OF)(Q))}}function D(Y,X,Q){return async q=>{const te={loginOrEmail:Y.login,role:Q};await(0,o.AI)().post(`/api/orgs/${X}/users/`,te),q(r(Y.uid))}}function C(Y,X,Q){return async q=>{const te={role:Q};await(0,o.AI)().patch(`/api/orgs/${X}/users/${Y}`,te),q(r(Y))}}function P(Y,X){return async Q=>{await(0,o.AI)().delete(`/api/orgs/${X}/users/${Y}`),Q(r(Y))}}function T(Y){return async X=>{if(!c.TP.hasPermission(p.w.UsersAuthTokenList))return;const Q=await(0,o.AI)().get(`/api/admin/users/${Y}/auth-tokens`);Q.reverse();const q=Q.map(te=>({id:te.id,isActive:te.isActive,seenAt:(0,s.fq)(te.seenAt),createdAt:te.createdAt,clientIp:te.clientIp,browser:te.browser,browserVersion:te.browserVersion,authModule:te.authModule,os:te.os,osVersion:te.osVersion,device:te.device}));X((0,h.ag)(q))}}function O(Y,X){return async Q=>{const q={authTokenId:Y};await(0,o.AI)().post(`/api/admin/users/${X}/revoke-auth-token`,q),Q(T(X))}}function I(Y){return async X=>{await(0,o.AI)().post(`/api/admin/users/${Y}/logout`),X(T(Y))}}function j(){return async Y=>{const X=c.TP.hasPermission(p.w.LDAPStatusRead);if((0,l.a)("ldapsync")&&X){const Q=await(0,o.AI)().get("/api/admin/ldap-sync-status");Y((0,h.OR)(Q))}}}function W(Y,X){return async Q=>{await(0,o.AI)().post(`/api/admin/ldap/sync/${Y}`),Q(r(X))}}function B(){return async Y=>{if(c.TP.hasPermission(p.w.LDAPStatusRead))try{const X=await(0,o.AI)().get("/api/admin/ldap/status");Y((0,h.pH)(X))}catch(X){if((0,o.NF)(X)){X.isHandled=!0;const Q={title:X.data.message,body:X.data.error};Y((0,h.V$)(Q))}}}}function S(Y){return async X=>{try{const Q=await(0,o.AI)().get(`/api/admin/ldap/${encodeURIComponent(Y)}`),{name:q,surname:te,email:ne,login:se,isGrafanaAdmin:ue,isDisabled:de,roles:ie,teams:he}=Q,me={info:{name:q,surname:te,email:ne,login:se},permissions:{isGrafanaAdmin:ue,isDisabled:de},roles:ie,teams:he};X((0,h.TW)(me))}catch(Q){if((0,o.NF)(Q)){Q.isHandled=!0;const q={title:Q.data.message,body:Q.data.error};X((0,h.Vv)()),X((0,h.Nf)(q))}}}}function w(){return Y=>{Y((0,h.zi)())}}function N(){return Y=>{Y((0,h.zi)()),Y((0,h.Vv)())}}const M=Y=>Y.map(X=>Array.isArray(X.value)?X.value.map(Q=>`${X.name}=${Q.value}`).join("&"):`${X.name}=${X.value}`).join("&");function L(){return async(Y,X)=>{try{const{perPage:Q,page:q,query:te,filters:ne,sort:se}=X().userListAdmin;let ue=`/api/users/search?perpage=${Q}&page=${q}&query=${te}&${M(ne)}`;se&&(ue+=`&sort=${se}`);const de=await(0,o.AI)().get(ue);Y((0,h.Mb)(de))}catch(Q){(0,h.g4)(),console.error(Q)}}}const A=(0,n.debounce)(Y=>Y(L()),500);function U(Y){return async X=>{X((0,h.Cj)()),X((0,h.L5)(Y)),A(X)}}function F(Y){return async X=>{X((0,h.Cj)()),X((0,h.jX)(Y)),A(X)}}function V(Y){return async X=>{X((0,h.Cj)()),X((0,h.EC)(Y)),X(L())}}function K({sortBy:Y}){const X=Y.length?`${Y[0].id}-${Y[0].desc?"desc":"asc"}`:void 0;return async(Q,q)=>{q().userListAdmin.sort!==X&&(Q((0,h.Cj)()),Q((0,h.$u)(X)),Q(L()))}}const G=Y=>Y.map(X=>Array.isArray(X.value)?X.value.map(Q=>`${X.name}=${Q.value}`).join("&"):`${X.name}=${X.value}`).join("&");function H(){return async(Y,X)=>{try{const{perPage:Q,page:q,query:te,filters:ne,sort:se}=X().userListAnonymousDevices;let ue=`/api/anonymous/search?perpage=${Q}&page=${q}&query=${te}&${G(ne)}`;se&&(ue+=`&sort=${se}`);const de=await(0,o.AI)().get(ue);Y((0,h.o3)(de))}catch(Q){console.error(Q)}}}const _=(0,n.debounce)(Y=>Y(H()),500);function k({sortBy:Y}){const X=Y.length?`${Y[0].id}-${Y[0].desc?"desc":"asc"}`:void 0;return async(Q,q)=>{q().userListAnonymousDevices.sort!==X&&(Q((0,h.kh)(X)),Q(H()))}}function J(Y){return async X=>{X((0,h.xx)(Y)),_(X)}}function z(Y){return async X=>{X((0,h.iK)(Y)),X(H())}}},52695:(Z,R,e)=>{"use strict";e.d(R,{$u:()=>W,Ay:()=>F,Cj:()=>P,D1:()=>f,EC:()=>I,G_:()=>y,L5:()=>O,Mb:()=>C,Nf:()=>m,OF:()=>v,OR:()=>c,PV:()=>u,TW:()=>p,V$:()=>i,Vv:()=>o,ag:()=>x,g4:()=>T,iK:()=>L,jX:()=>j,kh:()=>M,o3:()=>N,pH:()=>d,xx:()=>A,zi:()=>l});var n=e(65307);const a={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},s=(0,n.Z0)({name:"ldap",initialState:a,reducers:{ldapConnectionInfoLoadedAction:(V,K)=>({...V,ldapError:void 0,connectionInfo:K.payload}),ldapFailedAction:(V,K)=>({...V,ldapError:K.payload}),ldapSyncStatusLoadedAction:(V,K)=>({...V,syncInfo:K.payload}),userMappingInfoLoadedAction:(V,K)=>({...V,user:K.payload,userError:void 0}),userMappingInfoFailedAction:(V,K)=>({...V,user:void 0,userError:K.payload}),clearUserMappingInfoAction:(V,K)=>({...V,user:void 0}),clearUserErrorAction:(V,K)=>({...V,userError:void 0})}}),{clearUserErrorAction:l,clearUserMappingInfoAction:o,ldapConnectionInfoLoadedAction:d,ldapFailedAction:i,ldapSyncStatusLoadedAction:c,userMappingInfoFailedAction:m,userMappingInfoLoadedAction:p}=s.actions,h=s.reducer,r={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},g=(0,n.Z0)({name:"userAdmin",initialState:r,reducers:{userProfileLoadedAction:(V,K)=>({...V,user:K.payload}),userOrgsLoadedAction:(V,K)=>({...V,orgs:K.payload}),userSessionsLoadedAction:(V,K)=>({...V,sessions:K.payload}),userAdminPageLoadedAction:(V,K)=>({...V,isLoading:!K.payload}),userAdminPageFailedAction:(V,K)=>({...V,error:K.payload,isLoading:!1})}}),{userProfileLoadedAction:y,userOrgsLoadedAction:v,userSessionsLoadedAction:x,userAdminPageLoadedAction:f,userAdminPageFailedAction:u}=g.actions,b=g.reducer,E={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},D=(0,n.Z0)({name:"userListAdmin",initialState:E,reducers:{usersFetched:(V,K)=>{const{totalCount:G,perPage:H,..._}=K.payload,k=Math.ceil(G/H);return{...V,..._,totalPages:k,perPage:H,showPaging:k>1,isLoading:!1}},usersFetchBegin:V=>({...V,isLoading:!0}),usersFetchEnd:V=>({...V,isLoading:!1}),queryChanged:(V,K)=>({...V,query:K.payload,page:0}),pageChanged:(V,K)=>({...V,page:K.payload}),sortChanged:(V,K)=>({...V,page:0,sort:K.payload}),filterChanged:(V,K)=>{const{name:G,value:H}=K.payload;return V.filters.some(_=>_.name===G)?{...V,page:0,filters:V.filters.map(_=>_.name===G?{..._,value:H}:_)}:{...V,page:0,filters:[...V.filters,K.payload]}}}}),{usersFetched:C,usersFetchBegin:P,usersFetchEnd:T,queryChanged:O,pageChanged:I,filterChanged:j,sortChanged:W}=D.actions,B=D.reducer,S={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},w=(0,n.Z0)({name:"userListAnonymousDevices",initialState:S,reducers:{usersAnonymousDevicesFetched:(V,K)=>{const{totalCount:G,perPage:H,..._}=K.payload,k=Math.ceil(G/H);return{...V,..._,totalPages:k,perPage:H,showPaging:k>1}},anonQueryChanged:(V,K)=>({...V,query:K.payload,page:0}),anonPageChanged:(V,K)=>({...V,page:K.payload}),anonUserSortChanged:(V,K)=>({...V,page:0,sort:K.payload}),filterChanged:(V,K)=>{const{name:G,value:H}=K.payload;return V.filters.some(_=>_.name===G)?{...V,page:0,filters:V.filters.map(_=>_.name===G?{..._,value:H}:_)}:{...V,page:0,filters:[...V.filters,K.payload]}}}}),{usersAnonymousDevicesFetched:N,anonUserSortChanged:M,anonPageChanged:L,anonQueryChanged:A}=w.actions,U=w.reducer,F={ldap:h,userAdmin:b,userListAdmin:B,userListAnonymousDevices:U}},42939:(Z,R,e)=>{"use strict";e.d(R,{pL:()=>a,z5:()=>l});var n=e(43173);const a=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function s(){const o=n.$.licenseInfo?.trialExpiry;return!!(o&&o>0)}const l=()=>s()&&n.$.featureToggles.featureHighlights},2954:(Z,R,e)=>{"use strict";e.d(R,{A:()=>E,p:()=>c});var n=e(2543),a=e.n(n),s=e(92745),l=e(56355);const o=new l.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),d=[{text:"Query",value:"query"}],i={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var c=(D=>(D.IsAbove="gt",D.IsBelow="lt",D.IsEqual="eq",D.IsNotEqual="ne",D.IsGreaterThanEqual="gte",D.IsLessThanEqual="lte",D.IsOutsideRange="outside_range",D.IsWithinRange="within_range",D.IsWithinRangeIncluded="within_range_included",D.IsOutsideRangeIncluded="outside_range_included",D.HasNoValue="no_value",D))(c||{});const m=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"eq",text:"IS EQUAL TO"},{value:"ne",text:"IS NOT EQUAL TO"},{value:"gte",text:"IS ABOVE OR EQUAL TO"},{value:"lte",text:"IS BELOW OR EQUAL TO"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"outside_range_included",text:"IS OUTSIDE RANGE INCLUDED"},{value:"within_range_included",text:"IS WITHIN RANGE INCLUDED"},{value:"no_value",text:"HAS NO VALUE"}],p=[{text:"OR",value:"or"},{text:"AND",value:"and"},{text:"LOGIC OR",value:"logic-or"}],h=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],r=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],g=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function y(D){const C=new l.tI({type:D.type,defaultParams:[]});return new l.kW(D,C)}function v(D){return D.toLowerCase().replace(/_/g,"").split(" ")[0]}function x(D){switch(v(D)){case"normal":case"ok":return{text:(0,s.t)("alerting.get-state-display-model.text.ok","OK"),iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:(0,s.t)("alerting.get-state-display-model.text.alerting","ALERTING"),iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:(0,s.t)("alerting.get-state-display-model.text.no-data","NO DATA"),iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:(0,s.t)("alerting.get-state-display-model.text.paused","PAUSED"),iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:(0,s.t)("alerting.get-state-display-model.text.pending","PENDING"),iconClass:"hourglass",stateClass:"alert-state-warning"};case"recovering":return{text:(0,s.t)("alerting.get-state-display-model.text.recovering","RECOVERING"),iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:(0,s.t)("alerting.get-state-display-model.text.firing","FIRING"),iconClass:"fire",stateClass:""};case"inactive":return{text:(0,s.t)("alerting.get-state-display-model.text.inactive","INACTIVE"),iconClass:"check",stateClass:""};case"error":return{text:(0,s.t)("alerting.get-state-display-model.text.error","ERROR"),iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:(0,s.t)("alerting.get-state-display-model.text.unknown","UNKNOWN"),iconClass:"question-circle",stateClass:".alert-state-paused"}}}function f(D,C){return(0,n.reduce)(D,(P,T)=>(T.metric!==void 0&&T.value!==void 0&&P.push(T.metric+"="+T.value),T.Metric!==void 0&&T.Value!==void 0&&P.push(T.Metric+"="+T.Value),P),[]).join(C)}function u(D){return(0,n.isArray)(D.data)?f(D.data,", "):(0,n.isArray)(D.data.evalMatches)?f(D.data.evalMatches,", "):D.data.error?"Error: "+D.data.error:""}function b(D){return(0,n.isArray)(D)?f(D,", "):(0,n.isArray)(D.evalMatches)?f(D.evalMatches,", "):D.error?"Error: "+D.error:""}const E={alertQueryDef:o,getStateDisplayModel:x,conditionTypes:d,evalFunctions:m,evalOperators:p,noDataModes:r,executionErrorModes:g,reducerTypes:h,createReducerPart:y,getAlertAnnotationInfo:u,getAlertAnnotationText:b,alertStateSortScore:i}},56355:(Z,R,e)=>{"use strict";e.d(R,{Dw:()=>d,Wn:()=>o,kW:()=>l,tI:()=>s});var n=e(2543),a=e.n(n);class s{constructor(p){this.type=p.type,this.params=p.params,this.defaultParams=p.defaultParams,this.renderer=p.renderer,this.category=p.category,this.addStrategy=p.addStrategy}}class l{constructor(p,h){if(this.part=p,this.def=h,!this.def)throw{message:"Could not find query part "+p.type};p.params=p.params||(0,n.clone)(this.def.defaultParams),this.params=p.params,this.text="",this.updateText()}render(p){return this.def.renderer(this,p)}hasMultipleParamsInString(p,h){return p.indexOf(",")===-1?!1:this.def.params[h+1]&&this.def.params[h+1].optional}updateParam(p,h){if(this.hasMultipleParamsInString(p,h)){(0,n.each)(p.split(","),(r,g)=>{this.updateParam(r.trim(),g)});return}p===""&&this.def.params[h].optional?this.params.splice(h,1):this.params[h]=p,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let p=this.def.type+"(";p+=this.params.join(", "),p+=")",this.text=p}}function o(m,p){const h=m.def.type+"(",r=(0,n.map)(m.params,(g,y)=>{const v=m.def.params[y];return v.type==="time"&&g==="auto"&&(g="$__interval"),v.quote==="single"?"'"+g+"'":v.quote==="double"?'"'+g+'"':g});return p&&r.unshift(p),h+r.join(", ")+")"}function d(m,p){return p+" "+m.params[0]}function i(m,p){return m.params[0]}function c(m,p){return'"'+m.params[0]+'"'}},74268:(Z,R,e)=>{"use strict";e.d(R,{AK:()=>I,Cl:()=>H,D0:()=>z,D_:()=>q,Ey:()=>S,FF:()=>r,Gn:()=>P,Hs:()=>J,IR:()=>C,KF:()=>v,Ke:()=>f,Ks:()=>Y,P6:()=>_,Pq:()=>w,QA:()=>X,Rh:()=>j,Rk:()=>D,Sn:()=>F,Sq:()=>b,Tc:()=>M,U6:()=>K,U7:()=>y,XW:()=>B,Yk:()=>O,Zc:()=>Q,a5:()=>te,aL:()=>V,cg:()=>W,fH:()=>m,iF:()=>N,iW:()=>k,l$:()=>h,le:()=>c,nf:()=>E,t6:()=>G,vO:()=>T,vV:()=>p,xd:()=>g,zs:()=>A});var n=e(2543),a=e.n(n),s=e(25992),l=e(43173),o=e(27489),d=e(73427),i=e(56369);const c={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history",exportNewGrafanaRule:"exporting new Grafana rule",noAlertRuleVersionsFound:"no alert rule versions found"},{logInfo:m,logError:p,logMeasurement:h,logWarning:r}=(0,s.DW)("features.alerting",{module:"Alerting"});function g(ne,se,ue={}){return async function(...de){const ie=`${se}:start`;performance.mark(ie);const he=await ne(...de),me=performance.measure(se,ie);return h(se,{duration:me.duration,loadTimesMs:me.duration},ue),he}}function y(ne,se,ue){return async(...de)=>{const ie=performance.now(),he=await se(...de),{namespacesCount:me,groupsCount:ce,rulesCount:Pe}=x(he);return h(ne,{loadTimeMs:performance.now()-ie,namespacesCount:me,groupsCount:ce,rulesCount:Pe},ue),he}}function v(ne){Object.entries(ne).forEach(([se,ue])=>{const de=ue.message??"unknown error",ie=String(ue.type)??"unknown",he=new Error(de);p(he,{field:se,type:ie})})}function x(ne){const se=ne.length,ue=ne.flatMap(he=>he.groups).length,de=ne.flatMap(he=>he.groups).flatMap(he=>he.rules).length;return{namespacesCount:se,groupsCount:ue,rulesCount:de}}function f(ne,se,ue){return async(...de)=>{const ie=performance.now(),he=await se(...de),{namespacesCount:me,groupsCount:ce,rulesCount:Pe}=u(he);return h(ne,{namespacesCount:me,groupsCount:ce,rulesCount:Pe,loadTimeMs:performance.now()-ie},ue),he}}function u(ne){const se=Object.keys(ne),ue=Object.values(ne).flatMap(ie=>ie),de=ue.flatMap(ie=>ie.rules);return{namespacesCount:se.length,groupsCount:ue.length,rulesCount:de.length}}const b=async(ne={grafana_version:l.$.buildInfo.version,org_id:d.TP.user.orgId,user_id:d.TP.user.id})=>{(0,o.rR)("grafana_alerting_navigation",ne)},E=ne=>{(0,o.rR)("grafana_alerting_rule_creation",ne)},D=ne=>{(0,o.rR)("grafana_alerting_rule_aborted",ne)},C=ne=>{(0,o.rR)("grafana_alerting_rule_form_error",ne)},P=ne=>{(0,o.rR)("grafana_alerting_grafana_rule_creation_new_success",ne)},T=()=>{(0,o.rR)("grafana_alerting_grafana_rule_creation_new_aborted")},O=()=>{(0,o.rR)("grafana_alerting_grafana_rule_creation_new_error")},I=async ne=>{const se={grafana_version:l.$.buildInfo.version,org_id:d.TP.user.orgId,user_id:d.TP.user.id};(0,o.rR)("grafana_alerting_insights",{...se,...ne})},j=async ne=>{(0,o.rR)("grafana_alerting_rule_versions_comparison_click",{...ne})},W=async ne=>{(0,o.rR)("grafana_alerting_rule_versions_restore_success",{...ne})},B=async ne=>{(0,o.rR)("grafana_alerting_rule_versions_restore_error",{...ne})},S=async()=>{(0,o.rR)("grafana_alerting_deleted_rule_restore_success")},w=async()=>{(0,o.rR)("grafana_alerting_deleted_rule_restore_error")},N=async ne=>{(0,o.rR)("grafana_alerting_import_to_gma_success",{...ne})},M=async ne=>{(0,o.rR)("grafana_alerting_import_to_gma_error",{...ne})};function L(ne){(0,o.rR)("grafana_alerting_rules_search",{...ne})}function A({oldQuery:ne,newQuery:se}){try{const ue=(0,i.XY)(ne),de=(0,i.XY)(se),ie=U(ue);U(de).filter(ce=>!ie.includes(ce)).forEach(ce=>{L({filter:ce,triggeredBy:"typing"})})}catch(ue){ue instanceof Error&&p(ue)}}function U(ne){return Object.entries(ne).filter(([se,ue])=>!(0,n.isEmpty)(ue)).map(([se])=>se)}function F(ne){L({filter:ne,triggeredBy:"component"})}function V(ne){(0,o.rR)("grafana_alerting_rules_list_mode",{...ne})}function K(){(0,o.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function G(){(0,o.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function H(){(0,o.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function _(ne){(0,o.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",ne)}function k(){(0,o.rR)("grafana_alerting_central_alert_state_history_expand_row")}function J(ne){(0,o.rR)("grafana_alerting_central_alert_state_history_max_events_reached",ne)}function z(){(0,o.rR)("grafana_alerting_folder_bulk_actions_delete_success")}function Y(){(0,o.rR)("grafana_alerting_folder_bulk_actions_delete_fail")}function X(){(0,o.rR)("grafana_alerting_folder_bulk_actions_pause_success")}function Q(){(0,o.rR)("grafana_alerting_folder_bulk_actions_unpause_success")}function q(){(0,o.rR)("grafana_alerting_folder_bulk_actions_pause_fail")}function te(){(0,o.rR)("grafana_alerting_folder_bulk_actions_unpause_fail")}},28390:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>u,defaultPageNav:()=>x});var n=e(74848),a=e(96540),s=e(54148),l=e(92745),o=e(68143),d=e(34999),i=e(1506),c=e(36826),m=e(54552),p=e(22973),h=e(44109),r=e(77256),g=e(94646),y=e(88547);const v=()=>{const b=(0,s.g)(),E=(0,g.uE)(b),[D]=(0,p.P5)(),P=D===p.gQ.Instances?void 0:0,T=(0,a.useMemo)(()=>{if(!E)throw new Error("Rule ID is required");return(0,g.qg)(E,!0)},[E]),{loading:O,error:I,result:j}=(0,h.ZU)({ruleIdentifier:T,limitAlerts:P});return I?(0,n.jsx)(c.d,{pageNav:x,navId:"alert-list",children:(0,n.jsx)(f,{error:I})}):O?(0,n.jsx)(c.d,{pageNav:x,navId:"alert-list",isLoading:!0}):j?(0,n.jsx)(m.K,{identifier:T,rule:j,children:(0,n.jsx)(p.Ay,{})}):!j&&!O?(0,n.jsx)(c.d,{pageNav:x,navId:"alert-list",children:(0,n.jsx)(i.L,{entity:"Rule"})}):null},x={id:"alert-rule-view",text:""};function f({error:b}){return(0,o.NF)(b)&&b.status===404?(0,n.jsx)(i.L,{entity:"Rule"}):(0,n.jsx)(d.F,{title:(0,l.t)("alerting.rule-viewer.error-loading","Something went wrong loading the rule"),children:(0,r.JZ)(b)})}const u=(0,y.S)(v)},70327:(Z,R,e)=>{"use strict";e.d(R,{hK:()=>r});var n=e(92745),a=e(52161),s=e(39659),l=e(29609),o=e(5709),d=e(55143),i=e(78467),c=e(77295);const m="/api/v1/rule/test/grafana",p="api/prometheus/grafana/api/v1/rules";var h=(g=>(g.RuleName="rule_name",g.RuleNameVanilla="rule_name[]",g.RuleGroup="rule_group",g.RuleGroupVanilla="rule_group[]",g.Namespace="file",g.NamespaceVanilla="file[]",g.FolderUID="folder_uid",g.LimitAlerts="limit_alerts",g.MaxGroups="max_groups",g.ExcludeAlerts="exclude_alerts",g))(h||{});const r=o.H.injectEndpoints({endpoints:g=>({preview:g.mutation({query:({alertQueries:y,condition:v,customLabels:x,folder:f,alertName:u,alertUid:b})=>({url:m,data:{rule:{grafana_alert:{data:y,condition:v,no_data_state:"Alerting",title:u,uid:b??"N/A"},for:"0s",labels:(0,s.x4)(x),annotations:{}},folderUid:f.uid,folderTitle:f.title},method:"POST"})}),prometheusRulesByNamespace:g.query({query:({limitAlerts:y,identifier:v,filter:x,state:f,matcher:u})=>{const b=new URLSearchParams;y&&b.set("limit_alerts",String(y)),v&&((0,l.Mj)(v)||(0,l.X4)(v))&&(b.set("file",v.namespace),b.set("file[]",v.namespace),b.set("rule_group",v.groupName),b.set("rule_group[]",v.groupName));const D={...(0,i.ou)(x),...Object.fromEntries(b)};return{url:p,params:(0,i.Dj)(D,f,u)}},transformResponse:y=>(0,i.lH)(y.data.groups,a.hY)}),prometheusRuleNamespaces:g.query({query:({ruleSourceName:y,namespace:v,groupName:x,ruleName:f,dashboardUid:u,panelId:b,limitAlerts:E,maxGroups:D,excludeAlerts:C})=>{const P={rule_group:x,rule_name:f,dashboard_uid:u,panel_id:b?.toString()};return v&&((0,a.z2)(y)?P.folder_uid=v:(P.file=v,P["file[]"]=v)),E!==void 0&&(P.limit_alerts="limit_alerts"),D&&(P.max_groups=String(D)),C&&(P.exclude_alerts="true"),{url:`api/prometheus/${(0,a.w5)(y)}/api/v1/rules`,params:P}},transformResponse:(y,v,x)=>(0,i.lH)(y.data.groups,x.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:g.query({query:({rulerConfig:y,filter:v})=>{const{path:x,params:f}=(0,c.$o)(y).rules(v);return{url:x,params:f}},providesTags:["CombinedAlertRule"]}),rulerNamespace:g.query({query:({rulerConfig:y,namespace:v})=>{const{path:x,params:f}=(0,c.$o)(y).namespace(v);return{url:x,params:f}},providesTags:(y,v,{namespace:x})=>[{type:"RuleNamespace",id:x}]}),getRuleGroupForNamespace:g.query({query:({rulerConfig:y,namespace:v,group:x,notificationOptions:f})=>{const{path:u,params:b}=(0,c.$o)(y).namespaceGroup(v,x);return{url:u,params:b,notificationOptions:f}},providesTags:(y,v,{namespace:x,group:f,rulerConfig:u})=>[{type:"RuleGroup",id:`${u.dataSourceUid}/${x}/${f}`},{type:"RuleNamespace",id:`${u.dataSourceUid}/${x}`}]}),getGrafanaRulerGroup:g.query({query:({folderUid:y,groupName:v})=>{const{path:x,params:f}=(0,c.$o)(d.b).namespaceGroup(y,v);return{url:x,params:f}},providesTags:(y,v,{folderUid:x,groupName:f})=>[{type:"RuleGroup",id:`grafana/${x}/${f}`},{type:"RuleNamespace",id:`grafana/${x}`}]}),deleteRuleGroupFromNamespace:g.mutation({query:({rulerConfig:y,namespace:v,group:x,notificationOptions:f})=>{const u=(0,n.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:b,params:E}=(0,c.$o)(y).namespaceGroup(v,x);return{url:b,params:E,method:"DELETE",notificationOptions:{successMessage:u,...f}}},invalidatesTags:(y,v,{namespace:x,group:f,rulerConfig:u})=>[{type:"RuleGroup",id:`${u.dataSourceUid}/${x}/${f}`},{type:"RuleNamespace",id:`${u.dataSourceUid}/${x}`},"DeletedRules"]}),upsertRuleGroupForNamespace:g.mutation({query:({payload:y,namespace:v,rulerConfig:x,notificationOptions:f})=>{const{path:u,params:b}=(0,c.$o)(x).namespace(v),E=(0,n.t)("alerting.rule-groups.update.success","Successfully updated rule group");return{url:u,params:b,data:y,method:"POST",notificationOptions:{successMessage:E,...f}}},invalidatesTags:(y,v,{namespace:x,payload:f,rulerConfig:u})=>{const b=f.rules.filter(l.p.grafana.rule),E=[];return u.dataSourceUid===a.hY&&E.push({type:"GrafanaPrometheusGroups",id:`grafana/${x}/__any__/`},{type:"GrafanaPrometheusGroups",id:`grafana/${x}/${f.name}/__any__`},...b.map(D=>({type:"GrafanaPrometheusGroups",id:`grafana/${x}/${f.name}/${D.grafana_alert.title}`}))),[{type:"RuleNamespace",id:`${u.dataSourceUid}/${x}`},{type:"RuleGroup",id:`${u.dataSourceUid}/${x}/${f.name}`},...b.flatMap(D=>[{type:"GrafanaRulerRule",id:D.grafana_alert.uid},{type:"GrafanaRulerRuleVersion",id:D.grafana_alert.uid}]),...E,"DeletedRules"]}}),getAlertRule:g.query({query:({uid:y})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${y}`}),providesTags:(y,v,{uid:x})=>[{type:"GrafanaRulerRule",id:x}]}),getAlertVersionHistory:g.query({query:({uid:y})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${y}/versions`}),providesTags:(y,v,{uid:x})=>[{type:"GrafanaRulerRuleVersion",id:x}]}),exportRules:g.query({query:({format:y,folderUid:v,group:x,ruleUid:f})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:y,folderUid:v,group:x,ruleUid:f},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:g.query({query:({receiverName:y,decrypt:v,format:x})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:x,decrypt:v,name:y},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:g.query({query:({decrypt:y,format:v})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:v,decrypt:y},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:g.query({query:({format:y})=>({url:"/api/v1/provisioning/policies/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:g.mutation({query:({payload:y,format:v,nameSpaceUID:x})=>({url:`/api/ruler/grafana/api/v1/rules/${x}/export/`,params:{format:v},responseType:"text",data:y,method:"POST"})}),exportMuteTimings:g.query({query:({format:y})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:g.query({query:({format:y,muteTiming:v})=>({url:`/api/v1/provisioning/mute-timings/${v}/export/`,params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),getDeletedRules:g.query({query:()=>({url:`/api/ruler/${a.hY}/api/v1/rules/`,params:{deleted:"true"}}),transformResponse:y=>{const v=Object.values(y);return v.length>0?v[0][0]?.rules:[]},providesTags:["DeletedRules"]}),permanentlyDeleteRule:g.mutation({query:({guid:y})=>({url:`/api/ruler/${a.hY}/api/v1/trash/rule/guid/${y}`,method:"DELETE"}),invalidatesTags:["DeletedRules"]})})})},62421:(Z,R,e)=>{"use strict";e.d(R,{F:()=>l});var n=e(32899),a=e(45229),s=e(5709);const l=s.H.injectEndpoints({endpoints:o=>({getSilences:o.query({query:({datasourceUid:d,ruleMetadata:i,accessControl:c})=>({url:`/api/alertmanager/${d}/api/v2/silences`,params:{ruleMetadata:i,accesscontrol:c}}),providesTags:d=>d?[...d.map(({id:i})=>({type:"AlertmanagerSilences",id:i})),{type:"AlertmanagerSilences"}]:[{type:"AlertmanagerSilences"}]}),getSilence:o.query({query:({datasourceUid:d,id:i,ruleMetadata:c,accessControl:m})=>({url:`/api/alertmanager/${d}/api/v2/silence/${i}`,showErrorAlert:!1,params:{ruleMetadata:c,accesscontrol:m}}),providesTags:(d,i,{id:c})=>d?[{type:"AlertmanagerSilences",id:c}]:["AlertmanagerSilences"]}),createSilence:o.mutation({query:({datasourceUid:d,payload:i})=>({url:`/api/alertmanager/${d}/api/v2/silences`,method:"POST",data:i}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(d,{queryFulfilled:i})=>{try{await i,a.A.emit(n.r1.alertSuccess,["Silence created"])}catch{a.A.emit(n.r1.alertError,["Could not create silence"])}}}),expireSilence:o.mutation({query:({datasourceUid:d,silenceId:i})=>({url:`/api/alertmanager/${d}/api/v2/silence/${i}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},5709:(Z,R,e)=>{"use strict";e.d(R,{H:()=>h});var n=e(75816),a=e(10378),s=e(2543),l=e.n(s),o=e(75505),d=e(32899),i=e(68143),c=e(45229),m=e(74268);const p=()=>async({body:r,notificationOptions:g={},...y},v,x)=>{const{errorMessage:f,showErrorAlert:u,successMessage:b,showSuccessAlert:E}=g,{hideErrorMessage:D}=x||{};try{const C={...y,...r&&{data:r},...(0,s.isBoolean)(E)&&{showSuccessAlert:E},...(0,s.isBoolean)(u)&&{showErrorAlert:u},...b&&{showSuccessAlert:!1},...(f||D)&&{showErrorAlert:!1}},P=performance.now(),{data:T,...O}=await(0,o.s)((0,i.AI)().fetch(C));return(0,m.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-P},{url:y.url,method:y.method??"GET",responseStatus:O.statusText}),b&&E!==!1&&c.A.emit(d.r1.alertSuccess,[b]),{data:T,meta:O}}catch(C){return f&&u!==!1&&c.A.emit(d.r1.alertError,[f]),{error:C}}},h=(0,n.xP)({reducerPath:"alertingApi",baseQuery:p(),serializeQueryArgs:r=>(0,a.lE)((0,s.omit)(r,"queryArgs.notificationOptions")),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaRulerRuleVersion","GrafanaSlo","RuleGroup","RuleNamespace","ContactPoint","ContactPointsStatus","Receiver","DeletedRules","GrafanaPrometheusGroups"],endpoints:()=>({})})},47938:(Z,R,e)=>{"use strict";e.d(R,{By:()=>p,VO:()=>m,WS:()=>o,f4:()=>c,nd:()=>i,vk:()=>d});var n=e(75505),a=e(28105),s=e(68143),l=e(52161);async function o(v){try{const x=await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,l.w5)(v)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:x.data.template_files??{},template_file_provenances:x.data.template_file_provenances??{},alertmanager_config:x.data.alertmanager_config??{},last_applied:x.data.last_applied,id:x.data.id}}catch(x){if(v===l.hY&&(0,s.NF)(x)&&x.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw x}}async function d(v,x){await(0,n.s)((0,s.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,l.w5)(v)}/config/api/v1/alerts`,data:x,showErrorAlert:!1,showSuccessAlert:!1}))}async function i(v){await(0,n.s)((0,s.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,l.w5)(v)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function c(v){return(await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,l.w5)(v)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function m(v){return(await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,l.w5)(v)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function p(v,x,f){const u={receivers:x,alert:f};try{const b=await(0,n.s)((0,s.AI)().fetch({method:"POST",data:u,url:`/api/alertmanager/${(0,l.w5)(v)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(h(b.data))throw new Error(y(b.data))}catch(b){throw(0,s.NF)(b)&&r(b.data)&&h(b.data)?new Error(y(b.data)):b}}function h(v){return v.receivers.some(x=>x.grafana_managed_receiver_configs.some(f=>f.status==="failed"))}function r(v){return(0,a.Gv)(v)&&"receivers"in v&&Array.isArray(v.receivers)?v.receivers.every(g):!1}function g(v){return(0,a.Gv)(v)&&"name"in v&&typeof v.name=="string"&&"grafana_managed_receiver_configs"in v&&Array.isArray(v.grafana_managed_receiver_configs)}function y(v){return v.receivers.flatMap(x=>x.grafana_managed_receiver_configs.filter(f=>f.status==="failed").map(f=>f.error??"Unknown error.")).join("; ")}},91984:(Z,R,e)=>{"use strict";e.d(R,{m:()=>x});var n=e(2543),a=e.n(n),s=e(63895),l=e(8535),o=e(74268),d=e(86017),i=e(52161),c=e(77256),m=e(36200),p=e(5709),h=e(47938),r=e(55143);const g=30,y=30*1e3,v=["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","ContactPoint","ContactPointsStatus","Receiver"],x=p.H.injectEndpoints({endpoints:f=>({getAlertmanagerAlerts:f.query({query:({amSourceName:u,filter:b,showErrorAlert:E=!0})=>{const D=b?.matchers?.filter(W=>W.name&&W.value).map(W=>(0,s.b2)((0,d.MU)(W))),{silenced:C,inhibited:P,unprocessed:T,active:O}=b||{},I=Object.fromEntries(Object.entries({silenced:C,active:O,inhibited:P,unprocessed:T}).filter(([W,B])=>B!==void 0)),j={filter:D};return I&&Object.keys(I).forEach(W=>{j[W]=I[W]}),{url:`/api/alertmanager/${(0,i.w5)(u)}/api/v2/alerts`,params:j,showErrorAlert:E}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:f.query({query:({amSourceName:u})=>({url:`/api/alertmanager/${(0,i.w5)(u)}/api/v2/alerts/groups`})}),grafanaNotifiers:f.query({query:()=>({url:"/api/alert-notifiers"}),transformResponse:u=>{const b=(E,D)=>({...E,secureFieldKey:E.secure&&!E.secureFieldKey?`${D}${E.propertyName}`:void 0,subformOptions:E.subformOptions?.map(C=>b(C,`${D}${E.propertyName}.`))});return u.map(E=>({...E,options:E.options.map(D=>b(D,""))}))}}),getGrafanaAlertingConfiguration:f.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:f.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:f.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:u=>u.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:f.mutation({query:u=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:u,showSuccessAlert:!1}),invalidatesTags:[...v]}),getAlertmanagerConfigurationHistory:f.query({query:()=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/history`,params:{limit:g}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:f.mutation({query:u=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/history/${u.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:f.query({queryFn:async u=>{const b=u===i.hY;if((0,i.AL)(u))return(0,m.$I)((0,h.VO)(u).then(I=>({data:{alertmanager_config:I.config,template_files:{}}})));const{data:D}=await(0,l.JD)(r.L.endpoints.discoverAmFeatures.initiate({amSourceName:u})),C={alertmanager_config:{},template_files:{},template_file_provenances:{}},P=D?.lazyConfigInit??!1,T=(0,o.xd)(h.WS,"unifiedalerting/fetchAmConfig",{dataSourceName:u,thunk:"unifiedalerting/fetchAmConfig"}),O=(0,c.i9)(()=>T(u),I=>!!(0,m.CZ)(I)?.includes("alertmanager storage object not found")&&!P,y).then(I=>b?I:(0,n.isEmpty)(I.alertmanager_config)&&(0,n.isEmpty)(I.template_files)?(0,h.VO)(u).then(W=>({alertmanager_config:W.config,template_files:{},template_file_provenances:I.template_file_provenances,last_applied:I.last_applied,id:I.id})):I).then(I=>I??C).then(I=>({data:I})).catch(I=>{if(P&&(0,m.CZ)(I)?.includes("alertmanager storage object not found"))return{data:C};throw I});return(0,m.$I)(O).catch(I=>({error:I,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:f.mutation({query:({selectedAlertmanager:u,config:b})=>({url:`/api/alertmanager/${(0,i.w5)(u)}/config/api/v1/alerts`,method:"POST",data:b,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"]}),getContactPointsStatus:f.query({query:()=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/api/v1/receivers`}),transformResponse:u=>{const b=E=>E.startsWith("0001-01-01");return u.map(E=>({...E,integrations:E.integrations.map(D=>{const C=b(D.lastNotifyAttempt);return{...D,lastNotifyAttempt:C?"":D.lastNotifyAttempt,lastNotifyAttemptDuration:C?"":D.lastNotifyAttemptDuration}})}))},providesTags:["ContactPointsStatus"]})})})},1895:(Z,R,e)=>{"use strict";e.d(R,{O5:()=>h,_y:()=>p,cc:()=>c});var n=e(75505),a=e(68143),s=e(24619),l=e(95443),o=e(52161),d=e(78467),i=e(77295);async function c(f){if(f===o.hY)return{application:"grafana",features:{rulerApiEnabled:!0}};const u=(0,o.of)(f);if(!u)throw new Error(`Cannot find data source configuration for ${f}`);const{url:b,name:E,type:D}=u;if(!b)throw new Error("The data source url cannot be empty.");if(!(0,o.cl)(D))throw new Error(`The build info request is not available for ${D}. Supported values are ${o.at.join()}.`);return m({name:E,url:b,type:D})}async function m(f){const{url:u,name:b,type:E}=f,D=E==="loki"?void 0:await g(u);if(!(D!==void 0)){if(!await y(b))throw new Error(`Unable to fetch alert rules. Is the ${b} data source properly configured?`);const O=await v(b);return{application:E==="loki"?"Loki":s.N1.Cortex,features:{rulerApiEnabled:O}}}const{features:P}=D.data;return P?{application:s.N1.Mimir,features:{rulerApiEnabled:P?.ruler_config_api==="true"}}:{application:s.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function p(f){if(f===o.hY)return{lazyConfigInit:!1};const u=r(f),{url:b,type:E}=u;if(!b)throw new Error("The data source url cannot be empty.");if(E!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${E}. Only 'alertmanager' type is supported`);return await h(b)}async function h(f){try{return{lazyConfigInit:(await g(f))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function r(f){const u=(0,o.oh)(f);if(!u)throw new Error(`Cannot find data source configuration for ${f}`);return u}async function g(f){return(await(0,n.s)((0,a.AI)().fetch({url:`${f}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(b=>{if(!("status"in b&&b.status===404))throw b}))?.data}async function y(f){try{return await(0,d.sA)(f),!0}catch{return!1}}async function v(f){try{return await(0,i.Zp)(f),!0}catch(u){if(x(u))return!1;throw u}}function x(f){return(0,a.NF)(f)?f.data.message?.includes("GetRuleGroup unsupported in rule local store")||f.data.message?.includes("page not found")||f.data.message?.includes(l.UU):f instanceof Error&&f.message?.includes("404 from rules config endpoint")}},55143:(Z,R,e)=>{"use strict";e.d(R,{L:()=>i,b:()=>d});var n=e(86791),a=e(24619),s=e(52161),l=e(5709),o=e(1895);const d={dataSourceName:"grafana",dataSourceUid:"grafana",apiVersion:"legacy"},i=l.H.injectEndpoints({endpoints:c=>({discoverAmFeatures:c.query({queryFn:async({amSourceName:m})=>{try{return{data:await(0,o._y)(m)}}catch(p){return{error:p}}}}),discoverDsFeatures:c.query({queryFn:async m=>{const p=(0,s.Iz)(m);if(!p)return{error:new Error(`Unable to find data source for ${JSON.stringify(m)}`)};if(p===n.l$)return{data:{name:s.hY,uid:s.hY,application:"grafana",rulerConfig:d}};const h=p?(0,s.of)(p):void 0;if(!h)return{error:new Error(`Missing data source configuration for ${m}`)};try{const r=await(0,o.cc)(h.uid),g=r.features.rulerApiEnabled?{dataSourceName:h.name,dataSourceUid:h.uid,apiVersion:r.application===a.N1.Cortex?"legacy":"config"}:void 0;return{data:{name:h.name,uid:h.uid,application:r.application,rulerConfig:g}}}catch(r){return{error:r}}}})})})},77788:(Z,R,e)=>{"use strict";e.d(R,{Pc:()=>o,WG:()=>i,uz:()=>p});var n=e(68143),a=e(6135),s=e(182),l=e(5709);const o="grafana_alerting_v2";function d(h){return`/api/plugins/${(0,s.BO)()}/resources${h}`}const i=l.H.injectEndpoints({endpoints:h=>({grafanaOnCallIntegrations:h.query({query:()=>({url:d("/alert_receive_channels/"),params:{filters:!0,integration:[a.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:r=>c(r)?r.results:r,providesTags:["OnCallIntegrations"]}),validateIntegrationName:h.query({query:r=>({url:d("/alert_receive_channels/validate_name/"),params:{verbal_name:r},showErrorAlert:!1})}),createIntegration:h.mutation({query:r=>({url:d("/alert_receive_channels/"),data:r,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:h.query({query:()=>({url:d("/features/"),showErrorAlert:!1})}),onCallConfigChecks:h.query({query:()=>({url:d("/organization/config-checks/"),showErrorAlert:!1})})})});function c(h){return"results"in h&&Array.isArray(h.results)}const{useGrafanaOnCallIntegrationsQuery:m}=i;function p(h){return(0,n.NF)(h)&&"detail"in h.data}},78467:(Z,R,e)=>{"use strict";e.d(R,{Dj:()=>p,JY:()=>h,Kw:()=>g,lH:()=>r,ou:()=>m,sA:()=>v});var n=e(1932),a=e(75505),s=e(68143),l=e(74268),o=e(24619),d=e(52161),i=e(29609);function c(x){const{dataSourceName:f,limitAlerts:u,identifier:b}=x;return{rules:(E,D,C)=>{const P=new URLSearchParams;f===d.hY&&u&&P.set("limit_alerts",String(u)),b&&((0,i.Mj)(b)||(0,i.X4)(b))&&(P.set("file",b.namespace),P.set("rule_group",b.groupName));const O={...m(E),...Object.fromEntries(P)};return{url:`/api/prometheus/${(0,d.w5)(f)}/api/v1/rules`,params:p(O,D,C)}}}}function m(x){const f={};return x?.dashboardUID&&(f.dashboard_uid=x.dashboardUID,x?.panelId&&(f.panel_id=String(x.panelId))),f}function p(x,f,u){let b={...x};if(f?.length&&(b={...b,state:f}),u?.length){const E=u.map(D=>JSON.stringify(D));b={...b,matcher:E}}return b}function h(x){return(0,n.jM)(x,f=>{f.rules.forEach(u=>{u.query=u.query||"",u.type===o.JS.Alerting&&(u.state||((0,l.fH)("prom rule with type=alerting is missing a state",{ruleName:u.name}),u.state=o.cF.Inactive))})})}const r=(x,f)=>{const u=x.map(h),b={};return u.forEach(E=>{b[E.file]?b[E.file].groups.push(E):b[E.file]={dataSourceName:f,name:E.file,groups:[E]}}),Object.values(b)},g=(x=[])=>x?.flatMap(f=>f.groups.flatMap(u=>y(u,f.name)));function y(x,f){return{name:x.name,file:f,rules:x.rules,interval:x.interval}}async function v(x,f,u,b,E,D){if(f?.dashboardUID&&x!==d.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:C,params:P}=c({dataSourceName:x,limitAlerts:u,identifier:D}).rules(f,E,b),T=await(0,a.s)((0,s.AI)().fetch({url:C,params:P,showErrorAlert:!1,showSuccessAlert:!1})).catch(O=>{throw"status"in O&&O.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):O});return r(T.data.data.groups,x)}},77295:(Z,R,e)=>{"use strict";e.d(R,{$o:()=>p,HO:()=>x,Zp:()=>v,iy:()=>g});var n=e(75505),a=e(28105),s=e(68143),l=e(55376),o=e(95443),d=e(52161),i=e(78467);const c="QUERY_NAMESPACE",m="QUERY_GROUP";function p(D){const C=r(D),P=h(D),T=D.apiVersion==="legacy"?"cortex":"mimir";return{rules:O=>({path:C,params:{subtype:T,...(0,i.ou)(O)}}),namespace:O=>{const{namespace:I,searchParams:j}=P.namespace(O);return{path:`${C}/${encodeURIComponent(I)}`,params:{subtype:T,...j}}},namespaceGroup:(O,I)=>{if(!O)throw new Error("Namespace UID is required to fetch ruler group");if(!I)throw new Error("Group name is required to fetch ruler group");const{namespace:j,searchParams:W}=P.namespace(O),{group:B,searchParams:S}=P.group(I);return{path:`${C}/${encodeURIComponent(j)}/${encodeURIComponent(B)}`,params:{subtype:T,...W,...S}}}}}function h(D){const C=D.dataSourceName===d.hY,P=T=>(0,l.Cl)(T)===!0?{group:m,searchParams:{group:T}}:{group:T,searchParams:{}};return C?{namespace:T=>({namespace:T,searchParams:{}}),group:P}:{namespace:T=>(0,l.Cl)(T)===!0?{namespace:c,searchParams:{namespace:T}}:{namespace:T,searchParams:{}},group:P}}function r(D){return`${`/api/ruler/${D.dataSourceUid}`}/api/v1/rules`}async function g(D,C){if(C?.dashboardUID&&D.dataSourceName!==d.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:P,params:T}=p(D).rules(C);return f(P,{},T)}async function y(D,C){const{path:P,params:T}=p(D).namespace(C);return(await f(P,{},T))[C]||[]}async function v(D){return f(`/api/ruler/${(0,d.w5)(D)}/api/v1/rules/test/test`,null)}async function x(D,C,P){const{path:T,params:O}=p(D).namespaceGroup(C,P);return f(T,null,O)}async function f(D,C,P){try{return(await(0,n.s)((0,s.AI)().fetch({url:D,showErrorAlert:!1,showSuccessAlert:!1,params:P}))).data}catch(T){if(!u(T))throw T;if(E(T))return C;throw b(T)?{...T,data:{...T.data,message:o.UU}}:T}}function u(D){if(!(0,a.Gv)(D))return!1;const C="data"in D&&D.data!==null&&D.data!==void 0;return"status"in D&&Number.isFinite(D.status)&&C}function b(D){return D.status===404||D.status===500&&D.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function E(D){return D.status===404&&(D.data.message?.includes("group does not exist")||D.data.message?.includes("no rule groups found"))}},62939:(Z,R,e)=>{"use strict";e.d(R,{E:()=>s,R:()=>a});var n=e(68143);function a(l){if(s(l))return null;throw l}function s(l){return(0,n.NF)(l)&&l.status===404}},7840:(Z,R,e)=>{"use strict";e.d(R,{m:()=>r});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(92745),i=e(63142),c=e(45861),m=e(48542),p=e(39659),h=e(78793);const r=({labels:v,commonLabels:x={},size:f,onClick:u})=>{const b=(0,i.of)(y,f),[E,D]=(0,o.useState)(!1),C=(0,s.chain)(v).toPairs().reject(p.w0).reject(([I])=>E?!1:I in x).value(),P=Object.keys(x).length,T=P>0,O=(0,d.t)("alert-labels.button.show.tooltip","Show common labels");return(0,n.jsxs)("div",{className:b.wrapper,role:"list","aria-label":(0,d.t)("alerting.alert-labels.aria-label-labels","Labels"),children:[C.map(([I,j])=>(0,n.jsx)(h.J,{size:f,label:I,value:j,color:g(I),onClick:u},I+j)),!E&&T&&(0,n.jsx)(c.$n,{variant:"secondary",fill:"text",onClick:()=>D(!0),tooltip:O,tooltipPlacement:"top",size:"sm",children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.alert-labels.common-labels-count",count:P,children:["+","{{count}}"," common labels"]})}),E&&T&&(0,n.jsx)(c.$n,{variant:"secondary",fill:"text",onClick:()=>D(!1),tooltipPlacement:"top",size:"sm",children:(0,n.jsx)(d.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function g(v){return(0,m.MC)(v).color}const y=(v,x)=>({wrapper:(0,a.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:x==="md"?v.spacing():v.spacing(.5)})})},36826:(Z,R,e)=>{"use strict";e.d(R,{d:()=>D,y:()=>C});var n=e(74848),a=e(87586),s=e(13791),l=e(5358),o=e(22803),d=e(96540),i=e(92745),c=e(63142),m=e(18027),p=e(18857),h=e(72508),r=e(52161);function g(O){return O.name===r.hY?"Grafana":O.name}const y=({disabled:O=!1})=>{const I=(0,c.of)(v),{selectedAlertmanager:j,availableAlertManagers:W,setSelectedAlertmanager:B}=(0,l.VI)(),S=(0,d.useMemo)(()=>W.map(M=>({label:g(M),value:M.name,imgUrl:M.imgUrl,meta:M.meta})),[W]),w=O||S.length===1,N=w?"Alertmanager":"Choose Alertmanager";return(0,n.jsx)(m.I,{className:I.field,label:N,disabled:w,"data-testid":"alertmanager-picker",children:(0,n.jsx)(p.l6,{"aria-label":N,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:M=>{M?.value&&B(M.value)},options:S,noOptionsMessage:(0,i.t)("alerting.alert-manager-picker.noOptionsMessage-no-datasources-found","No datasources found"),value:j,getOptionLabel:M=>M.label,components:{Option:x}})})},v=O=>({field:(0,o.css)({margin:0})}),x=O=>(0,n.jsx)(h.o5,{...O,renderOptionLabel:({label:I})=>(0,n.jsx)("div",{style:{whiteSpace:"pre-line"},children:I})});var f=e(34999);const u=()=>(0,n.jsx)(f.F,{title:(0,i.t)("alerting.no-alert-managers-available.title-no-alertmanager-found","No Alertmanager found"),severity:"warning",children:(0,n.jsx)(i.x6,{i18nKey:"alerting.no-alert-managers-available.body-no-alertmanager-found",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."})}),b=()=>(0,n.jsx)(f.F,{title:(0,i.t)("alerting.other-alert-managers-available.title-selected-alertmanager-not-found","Selected Alertmanager not found."),severity:"warning",children:(0,n.jsx)(i.x6,{i18nKey:"alerting.other-alert-managers-available.body-selected-alertmanager-not-found",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."})}),E=({availableAlertManagers:O})=>{const I=O.length>0;return(0,n.jsx)("div",{children:I?(0,n.jsx)(b,{}):(0,n.jsx)(u,{})})},D=({children:O,isLoading:I,...j})=>(0,n.jsx)(s.Y,{...j,children:(0,n.jsx)(s.Y.Contents,{isLoading:I,children:O})}),C=({children:O,accessType:I,...j})=>{const W=P();return(0,n.jsx)(l.b9,{accessType:I,children:(0,n.jsx)(D,{...j,actions:(0,n.jsx)(y,{disabled:W}),children:(0,n.jsx)(T,{children:O})})})};function P(){const O=(0,a.A)();return["/edit","/new"].some(j=>O?.pathname?.includes(j))}const T=({children:O})=>{const{availableAlertManagers:I,selectedAlertmanager:j}=(0,l.VI)();return j?(0,n.jsx)(n.Fragment,{children:O}):(0,n.jsx)(E,{availableAlertManagers:I})}},83750:(Z,R,e)=>{"use strict";e.d(R,{s:()=>h});var n=e(74848),a=e(22803),s=e(45967),l=e(63142),o=e(89640),d=e(95443),i=e(40165),c=e(9368),m=e(16591);const p=["message","description"],h=({annotationKey:y,value:v,valueLink:x})=>{const f=y,u=d.J3[f]?(0,n.jsx)(s.m,{content:y,placement:"top",theme:"info",children:(0,n.jsx)("span",{children:d.J3[f]})}):y;return(0,n.jsx)(i.X,{label:u,horizontal:!0,children:(0,n.jsx)(r,{annotationKey:y,value:v,valueLink:x})})},r=({annotationKey:y,value:v,valueLink:x})=>{const f=(0,l.of)(g),u=p.includes(y),b=v&&v.startsWith("http"),E=(0,n.jsx)(c.Y,{input:v,delimiter:["{{","}}"]});return x?(0,n.jsx)(o.Y,{href:x,external:!0,children:v}):u?(0,n.jsx)(m.L,{className:f.well,children:E}):b?(0,n.jsx)(o.Y,{href:v,external:!0,children:v}):(0,n.jsx)(n.Fragment,{children:E})},g=y=>({well:(0,a.css)({wordBreak:"break-word"})})},24898:(Z,R,e)=>{"use strict";e.d(R,{_:()=>o});var n=e(74848),a=e(2543),s=e.n(a),l=e(16692);const o=({actions:h,children:r})=>{const g=(0,a.filter)(h,m),y=(0,a.filter)(h,p);return g.length?(0,n.jsx)(d,{actions:g,children:r}):y.length?(0,n.jsx)(i,{actions:y,children:r}):null},d=({actions:h,children:r})=>{const g=(0,l.iI)();return c(g,h)?(0,n.jsx)(n.Fragment,{children:r}):null},i=({actions:h,children:r})=>{const g=(0,l.e2)();return c(g,h)?(0,n.jsx)(n.Fragment,{children:r}):null};function c(h,r){return(0,a.chain)(h).pick(r).values().value().some(([g,y])=>y===!0)}function m(h){return Object.values(l.QI).includes(h)}function p(h){return Object.values(l.RY).includes(h)}},10427:(Z,R,e)=>{"use strict";e.d(R,{A:()=>s});var n=e(96540);function a({children:l,shouldWrap:o,wrap:d},i){return o?(0,n.cloneElement)(d(l)):l}const s=(0,n.forwardRef)(a)},40165:(Z,R,e)=>{"use strict";e.d(R,{X:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({className:d,label:i,horizontal:c,children:m,childrenWrapperClassName:p})=>{const h=(0,s.of)(o);return(0,n.jsxs)("div",{className:(0,a.cx)(h.field,c?h.fieldHorizontal:h.fieldVertical,d),children:[(0,n.jsx)("div",{children:i}),(0,n.jsx)("div",{className:p,children:m})]})},o=d=>({fieldHorizontal:(0,a.css)({flexDirection:"row",[d.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,a.css)({flexDirection:"column"}),field:(0,a.css)({display:"flex",margin:`${d.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:d.spacing(1),fontSize:d.typography.size.sm,fontWeight:d.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:d.colors.text.secondary}})})},6106:(Z,R,e)=>{"use strict";e.d(R,{E:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(76319),c=e(34213),m=e(74048),p=e(18771);const h=({cols:g,items:y,isExpandable:v=!1,onCollapse:x,onExpand:f,isExpanded:u,renderExpandedContent:b,testIdGenerator:E,pagination:D,paginationStyles:C,renderPrefixCell:P,renderPrefixHeader:T,footerRow:O,dataTestId:I})=>{const j=(0,d.of)(p.H);if((x||f||u)&&!(x&&f&&u))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((v||b)&&!(v&&b))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const W=(0,d.of)(r(g,v,!!T)),[B,S]=(0,s.useState)([]),w=F=>{u&&x&&f?u(F)?x(F):f(F):S(B.includes(F.id)?B.filter(V=>V!==F.id):[...B,F.id])},N=D?.itemsPerPage??y.length,{page:M,numberOfPages:L,onPageChange:A,pageItems:U}=(0,m.W)(y,1,N);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:W.container,"data-testid":I??"dynamic-table",children:[(0,n.jsxs)("div",{className:W.row,"data-testid":"header",children:[T&&T(),v&&(0,n.jsx)("div",{className:W.cell()}),g.map(F=>(0,n.jsx)("div",{className:W.cell(F.alignColumn),children:F.label},F.id))]}),U.map((F,V)=>{const K=u?u(F):B.includes(F.id);return(0,n.jsxs)("div",{className:W.row,"data-testid":E?.(F,V)??"row",children:[P&&P(F,V,y),v&&(0,n.jsx)("div",{className:(0,a.cx)(W.cell(),W.expandCell),children:(0,n.jsx)(i.K,{tooltip:K?(0,o.t)("alerting.dynamic-table.tooltip-collapse-row","Collapse row"):(0,o.t)("alerting.dynamic-table.tooltip-expand-row","Expand row"),"data-testid":l.Tp.components.AlertRules.toggle,name:K?"angle-down":"angle-right",onClick:()=>w(F)})}),g.map(G=>(0,n.jsx)("div",{className:(0,a.cx)(W.cell(G.alignColumn),W.bodyCell,G.className),"data-column":G.label,children:G.renderCell(F,V)},`${F.id}-${G.id}`)),K&&b&&(0,n.jsx)("div",{className:W.expandedContentRow,"data-testid":l.Tp.components.AlertRules.expandedContent,children:b(F,V,y)})]},`${F.id}-${V}`)}),O&&(0,n.jsx)("div",{className:(0,a.cx)(W.row,W.footerRow),children:O})]}),D&&(0,n.jsx)(c.d,{className:(0,a.cx)(j,C),currentPage:M,numberOfPages:L,onNavigate:A,hideWhenSinglePage:!0})]})},r=(g,y,v)=>{const x=g.map(f=>f.size?typeof f.size=="number"?`${f.size}fr`:f.size:"auto");return y&&x.unshift("calc(1em + 16px)"),v&&x.unshift("0"),f=>({container:(0,a.css)({border:`1px solid ${f.colors.border.weak}`,borderRadius:f.shape.radius.default,color:f.colors.text.secondary}),row:(0,a.css)({display:"grid",gridTemplateColumns:x.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:f.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:f.colors.background.primary},[f.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${f.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:v?"none":void 0}}}),footerRow:(0,a.css)({display:"flex",padding:f.spacing(1)}),cell:u=>(0,a.css)({display:"flex",alignItems:"center",padding:f.spacing(1),justifyContent:u||"initial",[f.breakpoints.down("sm")]:{padding:`${f.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,a.css)({overflow:"hidden",[f.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:f.colors.text.primary}}}),expandCell:(0,a.css)({justifyContent:"center",[f.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,a.css)({gridColumnEnd:x.length+1,gridColumnStart:v?3:2,gridRow:2,padding:`0 ${f.spacing(3)} 0 ${f.spacing(1)}`,position:"relative",[f.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${f.colors.border.strong}`,gridRow:"auto",padding:`${f.spacing(1)} 0 0 0`}})})}},57487:(Z,R,e)=>{"use strict";e.d(R,{B:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(6106);const o=({renderExpandedContent:i,...c})=>{const m=(0,s.of)(d);return(0,n.jsx)(l.E,{renderExpandedContent:i?(p,h,r)=>(0,n.jsxs)(n.Fragment,{children:[h!==r.length-1&&(0,n.jsx)("div",{className:(0,a.cx)(m.contentGuideline,m.guideline)}),i(p,h,r)]}):void 0,renderPrefixHeader:()=>(0,n.jsx)("div",{className:m.relative,children:(0,n.jsx)("div",{className:(0,a.cx)(m.headerGuideline,m.guideline)})}),renderPrefixCell:(p,h,r)=>(0,n.jsxs)("div",{className:m.relative,children:[(0,n.jsx)("div",{className:(0,a.cx)(m.topGuideline,m.guideline)}),h!==r.length-1&&(0,n.jsx)("div",{className:(0,a.cx)(m.bottomGuideline,m.guideline)})]}),...c})},d=i=>({relative:(0,a.css)({position:"relative",height:"100%"}),guideline:(0,a.css)({left:"-19px",borderLeft:`1px solid ${i.colors.border.weak}`,position:"absolute",[i.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,a.css)({width:"18px",borderBottom:`1px solid ${i.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,a.css)({top:"50%",bottom:0}),contentGuideline:(0,a.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,a.css)({top:"-17px",bottom:0})})},58750:(Z,R,e)=>{"use strict";e.d(R,{M:()=>p});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(34999),d=e(84266),i=e(91984),c=e(16692),m=e(52161);function p({currentAlertmanager:r}){const g=(0,l.of)(h),y=r!==m.hY,[v,x]=(0,c.Ej)(c.RY.ReadConfigurationStatus),f=v&&x,{currentData:u}=i.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:y||!f});if(!(u?.alertmanagersChoice&&[d.nA.External,d.nA.All].includes(u?.alertmanagersChoice))||y)return null;const E=u.numExternalAlertmanagers>0;return u.alertmanagersChoice===d.nA.External?(0,n.jsxs)(o.F,{title:(0,s.t)("alerting.grafana-alertmanager-delivery-warning.title-grafana-alerts-delivered-alertmanager","Grafana alerts are not delivered to Grafana Alertmanager"),children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.configuration-changes-external",children:"Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts."}),(0,n.jsx)("div",{className:g.adminHint,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.admin-hint-external",children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})})]}):u.alertmanagersChoice===d.nA.All&&E?(0,n.jsxs)(o.F,{title:(0,s.t)("alerting.grafana-alertmanager-delivery-warning.title-you-have-additional-alertmanagers-to-configure","You have additional Alertmanagers to configure"),severity:"warning",children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.configuration-changes-all",children:"Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others."}),(0,n.jsx)("div",{className:g.adminHint,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.admin-hint-all",children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})})]}):null}const h=r=>({adminHint:(0,a.css)({fontSize:r.typography.bodySmall.fontSize,fontWeight:r.typography.bodySmall.fontWeight})})},38055:(Z,R,e)=>{"use strict";e.d(R,{B:()=>p});var n=e(74848),a=e(22803),s=e(46942),l=e.n(s),o=e(96540),d=e(63142),i=e(41654),c=e(43533),m=e(2381);const p=({children:r,header:g,content:y,footer:v,arrow:x,showAfter:f=300,wrapperClassName:u,disabled:b=!1,showOn:E="hover",...D})=>{const C=(0,o.useRef)(null),P=(0,d.of)(h);if(b)return r;const T=E==="hover",O=E==="click",I=(0,n.jsxs)(i.B,{direction:"column",gap:0,role:"tooltip",children:[g&&(0,n.jsx)("div",{className:P.card.header,children:g}),(0,n.jsx)("div",{className:P.card.body,children:y}),v&&(0,n.jsx)("div",{className:P.card.footer,children:v})]});return(0,n.jsx)(c.I,{content:I,hideAfter:100,children:(j,W,B)=>{const S={onClick:j},w={onMouseLeave:W,onMouseEnter:j},N={onBlur:W,onFocus:j};return(0,n.jsxs)(n.Fragment,{children:[C.current&&(0,n.jsx)(m.A,{...B,...D,wrapperClassName:l()(P.popover,u),referenceElement:C.current,renderArrow:x,...N,...T?w:{}}),(0,o.cloneElement)(r,{ref:C,onFocus:j,onBlur:W,tabIndex:0,...T?w:{},...O?S:{}})]})}})},h=r=>({popover:(0,a.css)({borderRadius:r.shape.radius.default,boxShadow:r.shadows.z3,background:r.colors.background.primary,border:`1px solid ${r.colors.border.weak}`}),card:{body:(0,a.css)({padding:r.spacing(1)}),header:(0,a.css)({padding:r.spacing(1),background:r.colors.background.secondary,borderBottom:`solid 1px ${r.colors.border.medium}`}),footer:(0,a.css)({padding:r.spacing(.5,1),background:r.colors.background.secondary,borderTop:`solid 1px ${r.colors.border.medium}`})}})},85311:(Z,R,e)=>{"use strict";e.d(R,{A:()=>o});var n=e(74848),a=e(92745),s=e(34999);const o=()=>(0,n.jsx)(s.F,{severity:"info",title:(0,a.t)("alerting.alert.evaluation-paused","Alert evaluation currently paused"),children:(0,n.jsx)(a.x6,{i18nKey:"alerting.alert.evaluation-paused-description",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})})},78793:(Z,R,e)=>{"use strict";e.d(R,{J:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(84140),o=e(63142),d=e(41654),i=e(30703);const c=({label:p,value:h,icon:r,color:g,size:y="md",onClick:v})=>{const x=(0,o.of)(m,g,y),f=`${p}: ${h}`,u=p?.toString()??"",b=h?.toString()??"",E=(0,s.useMemo)(()=>(0,n.jsxs)(d.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,n.jsx)("div",{className:x.label,children:(0,n.jsxs)(d.B,{direction:"row",gap:.5,alignItems:"center",children:[r&&(0,n.jsx)(i.I,{name:r}),p&&(0,n.jsx)("span",{className:x.labelText,title:p.toString(),children:p??""})]})}),(0,n.jsx)("div",{className:x.value,title:h?.toString(),children:h??"-"})]}),[r,p,h,x]);return(0,n.jsx)("div",{className:x.wrapper,role:"listitem","aria-label":f,"data-testid":"label-value",children:v?(0,n.jsx)("div",{className:x.clickable,role:"button",tabIndex:0,onClick:()=>v(u,b),onKeyDown:D=>{D.key==="Enter"&&(v(u,b),D.preventDefault())},children:E},u+b):E})},m=(p,h,r)=>{const g=h??p.colors.secondary.main,y=p.isDark?(0,l.A)(g).lighten(5).toString():(0,l.A)(g).darken(5).toString(),v=p.isDark?(0,l.A)(g).darken(5).toString():(0,l.A)(g).lighten(5).toString(),x=h?l.A.mostReadable(g,["#000","#fff"]).toString():p.colors.text.primary;let f=p.spacing(.33,1);switch(r){case"sm":f=p.spacing(.2,.6);break;case"xs":f=p.spacing(0,.5);break;default:break}return{wrapper:(0,a.css)({color:x,fontSize:p.typography.bodySmall.fontSize,borderRadius:p.shape.borderRadius(2)}),labelText:(0,a.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,a.css)({display:"flex",alignItems:"center",color:"inherit",padding:f,background:g,border:`solid 1px ${y}`,borderTopLeftRadius:p.shape.borderRadius(2),borderBottomLeftRadius:p.shape.borderRadius(2)}),clickable:(0,a.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,a.css)({color:"inherit",padding:f,background:v,border:`solid 1px ${y}`,borderLeft:"none",borderTopRightRadius:p.shape.borderRadius(2),borderBottomRightRadius:p.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},1625:(Z,R,e)=>{"use strict";e.d(R,{P:()=>i});var n=e(74848),a=e(22803),s=e(63142),l=e(66404),o=e(41654),d=e(30703);const i=({children:m,icon:p,color:h="secondary",direction:r="row",...g})=>{const y=(0,s.of)(c),v=typeof g.onClick=="function",x=r==="row",f=x?"center":"flex-start",u=x?.5:0;return(0,n.jsx)("div",{className:(0,a.cx)({[y.interactive]:v}),...g,children:(0,n.jsx)(l.E,{variant:"bodySmall",color:h,children:(0,n.jsxs)(o.B,{direction:r,alignItems:f,gap:u,wrap:"wrap",children:[p&&(0,n.jsx)(d.I,{size:"xs",name:p}),m]})})})},c=()=>({interactive:(0,a.css)({cursor:"pointer"})})},27691:(Z,R,e)=>{"use strict";e.d(R,{A:()=>c});var n=e(74848),a=e(96540),s=e(92745),l=e(45861),o=e(41654),d=e(30703);const c=(0,a.forwardRef)(function(p,h){return(0,n.jsx)(l.$n,{variant:"secondary",size:"sm",type:"button","aria-label":p.title??(0,s.t)("alerting.more-button.aria-label","More"),ref:h,...p,children:(0,n.jsxs)(o.B,{direction:"row",alignItems:"center",gap:0,children:[p.title??(0,n.jsx)(s.x6,{i18nKey:"alerting.more-button.button-text",children:"More"}),(0,n.jsx)(d.I,{name:"angle-down"})]})})})},28405:(Z,R,e)=>{"use strict";e.d(R,{h:()=>l});var n=e(74848),a=e(3986);const s=({children:o,plugin:d,loadingComponent:i,notInstalledFallback:c})=>{const{loading:m,installed:p}=usePluginBridge(d);return m?i??null:p?jsx(Fragment,{children:o}):c??null};function l(o,d,i){const c=new URLSearchParams(i).toString();return`/a/${o}${d}`+(c?"?"+c:"")}},1972:(Z,R,e)=>{"use strict";e.d(R,{Yi:()=>i,hk:()=>d,rS:()=>c});var n=e(74848),a=e(92745),s=e(34999),l=e(99887),o=e(45967),d=(m=>(m.ContactPoint="contact point",m.Template="template",m.MuteTiming="time interval",m.AlertRule="alert rule",m.RootNotificationPolicy="root notification policy",m))(d||{});const i=({resource:m,...p})=>(0,n.jsx)(s.F,{title:(0,a.t)("alerting.provisioning.title-provisioned","This {{resource}} cannot be edited through the UI",{resource:m}),severity:"info",...p,children:(0,n.jsxs)(a.x6,{i18nKey:"alerting.provisioning.body-provisioned",children:["This ",{resource:m}," has been provisioned, that means it was created by config. Please contact your server admin to update this ",{resource:m},"."]})}),c=({tooltip:m,provenance:p})=>{const h=(0,n.jsx)(l.E,{text:(0,a.t)("alerting.provisioning-badge.badge.text-provisioned","Provisioned"),color:"purple"});if(m){const r=(0,n.jsxs)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:p},children:["This resource has been provisioned via ",{provenance:p}," and cannot be edited through the UI"]}),g=(0,n.jsx)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),y=p?r:g;return(0,n.jsx)(o.m,{content:y,children:(0,n.jsx)("span",{children:h})})}return h}},40360:(Z,R,e)=>{"use strict";e.d(R,{c:()=>l});var n=e(74848),a=e(66404),s=e(30703);const l=({namespace:o,group:d})=>d?(0,n.jsxs)(a.E,{element:"h3",variant:"body",children:[o," ",(0,n.jsx)(s.I,{name:"angle-right","aria-label":">"})," ",d]}):(0,n.jsx)(a.E,{element:"h3",variant:"body",children:o})},49779:(Z,R,e)=>{"use strict";e.d(R,{h:()=>s});var n=e(74848),a=e(22803);const s=()=>(0,n.jsx)("span",{className:(0,a.css)({flex:1})})},67834:(Z,R,e)=>{"use strict";e.d(R,{O:()=>o});var n=e(74848),a=e(22803),s=e(96540),l=e(63142);const o=(0,s.forwardRef)(({children:i,state:c,size:m="md",muted:p=!1},h)=>{const r=(0,l.of)(d);return(0,n.jsx)("span",{className:(0,a.cx)(r.common,r[c],r[m],{[r.muted]:p}),ref:h,children:i||c})});o.displayName="StateTag";const d=i=>({common:(0,a.css)({display:"inline-block",color:"white",borderRadius:i.shape.radius.default,fontSize:i.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:i.typography.fontWeightBold}),good:(0,a.css)({backgroundColor:i.colors.success.main,border:`solid 1px ${i.colors.success.main}`,color:i.colors.success.contrastText}),warning:(0,a.css)({backgroundColor:i.colors.warning.main,border:`solid 1px ${i.colors.warning.main}`,color:i.colors.warning.contrastText}),bad:(0,a.css)({backgroundColor:i.colors.error.main,border:`solid 1px ${i.colors.error.main}`,color:i.colors.error.contrastText}),neutral:(0,a.css)({backgroundColor:i.colors.secondary.main,border:`solid 1px ${i.colors.secondary.main}`,color:i.colors.secondary.contrastText}),info:(0,a.css)({backgroundColor:i.colors.primary.main,border:`solid 1px ${i.colors.primary.main}`,color:i.colors.primary.contrastText}),md:(0,a.css)({padding:i.spacing(.5,1),minWidth:i.spacing(8)}),sm:(0,a.css)({padding:i.spacing(.3,.5),minWidth:"52px"}),muted:(0,a.css)({opacity:"0.5"})})},9368:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>c});var n=e(74848),a=e(22803),s=e(63142),l=e(99887),o=e(38055),d=e(56652);const i=["$",".",'"'];function c({input:x,delimiter:f=["{{","}}"]}){const u=(0,s.of)(v),[b,E]=f,D=new RegExp(`(?<before>.*?)(${b}(?<token>.*?)${E}|$)`,"gm"),C=x.split(`
`),P=[];return C.forEach((T,O)=>{Array.from(T.matchAll(D)).forEach((j,W)=>{const B=j.groups?.before,S=j.groups?.token?.trim();if(B&&P.push((0,n.jsx)("span",{children:B},`${O}-${W}-before`)),S){const w=y(S),N=w==="variable"?S:"",M=`${b} ${S} ${E}`;P.push((0,n.jsx)(p,{content:M,type:w,description:N},`${O}-${W}-token`))}}),P.push((0,n.jsx)("br",{},`${O}-newline`))}),(0,n.jsx)("span",{className:u.wrapper,children:P})}var m=(x=>(x.Variable="variable",x.Function="function",x.Keyword="keyword",x.Unknown="unknown",x))(m||{});function p({content:x,description:f,type:u}){const b=(0,s.of)(v),E=!u;return(0,n.jsx)(o.B,{placement:"top-start",disabled:E,content:(0,n.jsxs)("div",{className:b.hoverTokenItem,children:[(0,n.jsx)(l.E,{tabIndex:0,text:(0,n.jsx)(n.Fragment,{children:u}),color:"blue"})," ",f&&(0,n.jsx)("code",{children:f})]}),children:(0,n.jsx)("span",{children:(0,n.jsx)(l.E,{tabIndex:0,className:b.token,text:x,color:"blue"})})})}function h(x){return i.some(f=>x.startsWith(f))}function r(x){return d.keywords.some(f=>x.startsWith(f))}function g(x){return d.builtinFunctions.some(f=>x.startsWith(f))}function y(x){let f;return h(x)?f="variable":r(x)?f="keyword":g(x)?f="function":f="unknown",f}const v=x=>({wrapper:(0,a.css)({whiteSpace:"pre-wrap"}),token:(0,a.css)({cursor:"default",fontFamily:x.typography.fontFamilyMonospace}),popover:(0,a.css)({borderRadius:x.shape.radius.default,boxShadow:x.shadows.z3,background:x.colors.background.primary,border:`1px solid ${x.colors.border.medium}`,padding:x.spacing(1)}),hoverTokenItem:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:x.spacing(1)})})},16591:(Z,R,e)=>{"use strict";e.d(R,{L:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,className:i})=>{const c=(0,s.of)(o);return(0,n.jsx)("div",{className:(0,a.cx)(c.wrapper,i),children:d})},o=d=>({wrapper:(0,a.css)({backgroundColor:d.components.panel.background,border:`solid 1px ${d.components.input.borderColor}`,borderRadius:d.shape.radius.default,padding:d.spacing(.5,1),fontFamily:d.typography.fontFamilyMonospace})})},2401:(Z,R,e)=>{"use strict";e.d(R,{d:()=>s});var n=e(96540),a=e(41071);const s=({component:l,title:o="previous page"})=>{const d=(0,a.i)(),i=(0,n.useCallback)(()=>{d(o)},[d,o]);return(0,n.cloneElement)(l,{onClick:i})}},87133:(Z,R,e)=>{"use strict";e.d(R,{X:()=>v});var n=e(74848),a=e(22803),s=e(96540),l=e(40996),o=e(92745),d=e(63142),i=e(30703),c=e(37386),m=e(72636),p=e(41654),h=e(45967),r=e(63527),g=e(74268),y=e(63895);const v=({onFilterChange:f,defaultQueryString:u})=>{const b=(0,d.of)(x),[E,D]=(0,s.useState)(u??"");(0,l.A)(()=>{(0,g.fH)(g.le.filterByLabel),f(E)},600,[E]);const C=(0,n.jsx)(i.I,{name:"search"});let P=!!(u&&u.length>=3);try{u?(0,y.S6)(u):P=!0}catch{P=!1}return(0,n.jsx)(c.D,{className:b.fixMargin,invalid:!P,error:P?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,n.jsx)(m.J,{children:(0,n.jsxs)(p.B,{gap:.5,alignItems:"center",children:[(0,n.jsx)("span",{children:(0,n.jsx)(o.x6,{i18nKey:"alerting.matcher-filter.search-by-label",children:"Search by label"})}),(0,n.jsx)(h.m,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(o.x6,{i18nKey:"alerting.matcher-filter.filter-alerts-using-label-querying-without-spaces",children:"Filter alerts using label querying without spaces, ex:"}),(0,n.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),(0,n.jsx)(o.x6,{i18nKey:"alerting.matcher-filter.invalid-use-of-spaces",children:"Invalid use of spaces:"}),(0,n.jsx)("pre",{children:'{severity= "critical"}'}),(0,n.jsx)("pre",{children:'{severity ="critical"}'}),(0,n.jsx)(o.x6,{i18nKey:"alerting.matcher-filter.valid-use-of-spaces",children:"Valid use of spaces:"}),(0,n.jsx)("pre",{children:'{severity=" critical"}'}),(0,n.jsx)(o.x6,{i18nKey:"alerting.matcher-filter.filter-alerts-using-label-querying-without-braces",children:"Filter alerts using label querying without braces, ex:"}),(0,n.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,n.jsx)(i.I,{name:"info-circle",size:"sm"})})]})}),children:(0,n.jsx)(r.p,{placeholder:(0,o.t)("alerting.matcher-filter.search-query-input-placeholder-search","Search"),value:E,onChange:T=>D(T.currentTarget.value),"data-testid":"search-query-input",prefix:C,className:b.inputWidth})})},x=f=>({fixMargin:(0,a.css)({marginBottom:0}),inputWidth:(0,a.css)({width:340,flexGrow:0})})},16194:(Z,R,e)=>{"use strict";e.d(R,{S:()=>s,X:()=>l});var n=e(74848),a=e(66404);const s=({content:o})=>(0,n.jsx)(a.E,{color:"primary",children:o}),l=({content:o})=>(0,n.jsx)(a.E,{variant:"code",children:o})},24961:(Z,R,e)=>{"use strict";e.d(R,{z8:()=>J,yz:()=>X});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(25229),d=e(92745),i=e(63142),c=e(41654),m=e(30703),p=e(66404),h=e(45967),r=e(16194),g=e(87063),y=e(89640),v=e(45861),x=e(88559),f=e(10427),u=e(8307),b=e(28141),E=e(5358),D=e(22628),C=e(56476),P=e(16692),T=e(92367),O=e(27691),I=e(1972),j=e(49779),W=e(99887);const B=()=>(0,n.jsx)(W.E,{text:(0,d.t)("alerting.unused-contact-point-badge.text-unused","Unused"),"aria-label":(0,d.t)("alerting.unused-contact-point-badge.aria-label-unused","unused"),color:"orange",icon:"exclamation-triangle",tooltip:(0,d.t)("alerting.unused-contact-point-badge.tooltip-unused","This contact point is not used in any notification policy or alert rule")});var S=e(66056);const w=({contactPoint:te,onDelete:ne})=>{const{name:se,id:ue,provisioned:de,policies:ie=[]}=te,he=(0,i.of)(N),[me,ce]=(0,l.useState)(!1),{selectedAlertmanager:Pe}=(0,E.VI)(),Ie=(0,C.dM)(Pe),[Se,Me]=(0,P.L7)(P.QI.ExportContactPoint),[Te,Ge]=(0,P.L7)(P.QI.UpdateContactPoint),[Qe,tt]=(0,P.L7)(P.QI.UpdateContactPoint),[ke,He]=(0,u.G)(),Re=(0,S.T8)(Pe,te),Ne=ie.filter(ge=>ge.route.type!=="auto-generated"),Ae=(0,C.gw)(te,D.T.InUseRoutes),Ue=Ie?Number(Ae):ie.length,Be=Ie?Number(Ae):Ne.length,We=Number((0,C.gw)(te,D.T.InUseRules))||0,_e=Ie?!!(Ue||We):ie.length>0,Xe=(0,C.Au)(te)||Ge,ye=Te&&Xe&&!de,pe=(0,C.zl)(te)||tt,be=Qe&&pe&&(!de&&!Be&&!We),Oe=[];if(Re&&Oe.push((0,n.jsx)(l.Fragment,{children:(0,n.jsx)(g.W.Item,{icon:"unlock",label:(0,d.t)("alerting.contact-point-header.label-manage-permissions","Manage permissions"),onClick:()=>ce(!0)})},"manage-permissions")),Se&&Oe.push((0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)(g.W.Item,{icon:"download-alt",label:(0,d.t)("alerting.contact-point-header.export-label-export","Export"),ariaLabel:(0,d.t)("alerting.contact-point-header.export-ariaLabel-export","Export"),disabled:!Me,"data-testid":"export",onClick:()=>He(se)}),(0,n.jsx)(g.W.Divider,{})]},"export-contact-point")),Qe){const ge=(0,d.t)("alerting.contact-points.delete-reasons.no-permissions","You do not have the required permission to delete this contact point"),Ke=(0,d.t)("alerting.contact-points.delete-reasons.provisioned","Contact point is provisioned and cannot be deleted via the UI"),qe=(0,d.t)("alerting.contact-points.delete-reasons.policies","Contact point is referenced by one or more notification policies"),ot=(0,d.t)("alerting.contact-points.delete-reasons.rules","Contact point is referenced by one or more alert rules"),lt=[pe?"":ge,de?Ke:"",Be>0?qe:"",We?ot:""].filter(Boolean),mt=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.x6,{i18nKey:"alerting.contact-points.delete-reasons.heading",children:"Contact point cannot be deleted for the following reasons:"}),(0,n.jsx)("br",{}),lt.map(Lt=>(0,n.jsx)("li",{children:Lt},Lt))]});Oe.push((0,n.jsx)(f.A,{shouldWrap:!be,wrap:Lt=>(0,n.jsx)(h.m,{content:mt,placement:"top",children:(0,n.jsx)("span",{children:Lt})}),children:(0,n.jsx)(g.W.Item,{label:(0,d.t)("alerting.contact-point-header.label-delete","Delete"),ariaLabel:(0,d.t)("alerting.contact-point-header.ariaLabel-delete","Delete"),icon:"trash-alt",destructive:!0,disabled:!be,onClick:()=>ne(te)})},"delete-contact-point"))}const we=(0,d.t)("alerting.contact-points.used-by","Used by {{ count }} notification policy",{count:Ue}),ze=(0,d.t)("alerting.contact-points.used-by-rules","Used by {{ count }} alert rule",{count:We}),Ve=ue||se;return(0,n.jsxs)("div",{className:he.headerWrapper,children:[(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:1,children:[(0,n.jsx)(c.B,{alignItems:"center",gap:1,minWidth:0,children:(0,n.jsx)(p.E,{element:"h2",variant:"body",weight:"medium",truncate:!0,children:se})}),Ue>0&&(0,n.jsx)(y.Y,{href:(0,T.G)("/alerting/routes",{contactPoint:se}),variant:"bodySmall",color:"primary",inline:!1,children:we}),We>0&&(0,n.jsx)(y.Y,{href:(0,T.G)("/alerting/list",{search:`contactPoint:"${se}"`}),variant:"bodySmall",color:"primary",inline:!1,children:ze}),de&&(0,n.jsx)(I.rS,{tooltip:!0,provenance:(0,C.gw)(te,D.T.Provenance)}),!_e&&(0,n.jsx)(B,{}),(0,n.jsx)(j.h,{}),(0,n.jsx)(v.z9,{tooltipPlacement:"top",tooltip:de?(0,d.t)("alerting.contact-point-header.tooltip-provisioned-contact-points","Provisioned contact points cannot be edited in the UI"):void 0,variant:"secondary",size:"sm",icon:ye?"pen":"eye",type:"button","data-testid":`${ye?"edit":"view"}-action`,href:`/alerting/notifications/receivers/${encodeURIComponent(Ve)}/edit`,children:ye?(0,d.t)("alerting.contact-point-header.button-edit","Edit"):(0,d.t)("alerting.contact-point-header.button-view","View")}),Oe.length>0&&(0,n.jsx)(x.m,{overlay:(0,n.jsx)(g.W,{children:Oe}),children:(0,n.jsx)(O.A,{"aria-label":(0,d.t)("alerting.contact-point-header.aria-label-more-actions",'More actions for contact point "{{contactPointName}}"',{contactPointName:te.name})})})]}),ke,me&&(0,n.jsx)(b.v,{resource:"receivers",resourceId:te.id,resourceName:te.name,onClose:()=>ce(!1)})]})},N=te=>({headerWrapper:(0,a.css)({background:`${te.colors.background.secondary}`,padding:`${te.spacing(1)} ${te.spacing(1.5)}`,borderBottom:`solid 1px ${te.colors.border.weak}`,borderTopLeftRadius:`${te.shape.radius.default}`,borderTopRightRadius:`${te.shape.radius.default}`})});var M=e(22787),L=e(77256);const A=te=>{const[ne,se]=(0,l.useState)(!1),[ue,de]=(0,l.useState)(),[ie,he]=(0,l.useState)(),[me,ce]=(0,l.useState)(!1),Pe=(0,l.useCallback)(()=>{me||(de(void 0),se(!1),he(void 0))},[me]),Ie=(0,l.useCallback)(({name:Te,resourceVersion:Ge})=>{de({name:Te,resourceVersion:Ge}),se(!0),he(void 0)},[]),Se=(0,l.useCallback)(()=>{ue&&(ce(!0),te(ue).then(()=>se(!1)).catch(he).finally(()=>{ce(!1)}))},[te,ue]);return[(0,l.useMemo)(()=>ie?(0,n.jsx)(U,{isOpen:ne,onDismiss:Pe,error:ie}):(0,n.jsxs)(M.a,{isOpen:ne,onDismiss:Pe,closeOnBackdropClick:!me,closeOnEscape:!me,title:(0,d.t)("alerting.use-delete-contact-point-modal.modal-element.title-delete-contact-point","Delete contact point"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(d.x6,{i18nKey:"alerting.use-delete-contact-point-modal.modal-element.deleting-contact-point-permanently-remove",children:"Deleting this contact point will permanently remove it."})}),(0,n.jsx)("p",{children:(0,n.jsx)(d.x6,{i18nKey:"alerting.use-delete-contact-point-modal.modal-element.delete-contact-point",children:"Are you sure you want to delete this contact point?"})}),(0,n.jsxs)(M.a.ButtonRow,{children:[(0,n.jsx)(v.$n,{type:"button",variant:"destructive",onClick:Se,disabled:me,children:me?(0,d.t)("alerting.use-delete-contact-point-modal.deleting","Deleting..."):(0,d.t)("alerting.use-delete-contact-point-modal.delete-confirm","Yes, delete contact point")}),(0,n.jsx)(v.$n,{type:"button",variant:"secondary",onClick:Pe,disabled:me,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})]}),[ie,Pe,Se,me,ne]),Ie,Pe]},U=({isOpen:te,onDismiss:ne,error:se})=>(0,n.jsxs)(M.a,{isOpen:te,onDismiss:ne,closeOnBackdropClick:!0,closeOnEscape:!0,title:(0,d.t)("alerting.error-modal.title-something-went-wrong","Something went wrong"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(d.x6,{i18nKey:"alerting.error-modal.failed-to-update-your-configuration",children:"Failed to update your configuration:"})}),(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:(0,L.JZ)(se)})})]});var F=e(97507);const V={pagerduty:"PagerDuty",pushover:"Pushover",slack:"Slack",opsgenie:"OpsGenie",webhook:"Webhook",victorops:"VictorOps",wechat:"WeChat",discord:"Discord",webex:"Cisco Webex Teams",sns:"Amazon SNS",telegram:"Telegram",msteams:"Microsoft Teams"},K={discord:"discord",email:"envelope",googlechat:"google-hangouts-alt",hipchat:"hipchat",line:"line",pagerduty:"pagerduty",slack:"slack",teams:"microsoft",telegram:"telegram-alt",webhook:"link",sns:"amazon"};var G=e(1625);const H=({metadata:{icon:te,title:ne,externalUrl:se,warning:ue}})=>{const de=(0,i.of)(_);return(0,n.jsxs)(c.B,{alignItems:"center",gap:.5,children:[(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:.5,children:[ue?(0,n.jsx)(h.m,{content:ue,theme:"error",children:(0,n.jsx)(m.I,{name:"exclamation-triangle",className:de.warnIcon})}):(0,n.jsx)("img",{src:te,alt:ne,height:"16px"}),(0,n.jsx)("span",{children:ne})]}),se&&(0,n.jsx)(v.z9,{icon:"external-link-alt",href:se,target:"_blank",variant:"secondary",size:"sm"})]})},_=te=>({warnIcon:(0,a.css)({fill:te.colors.warning.text})});var k=e(3887);const J=({contactPoint:te})=>{const{grafana_managed_receiver_configs:ne}=te,se=(0,i.of)(q),{selectedAlertmanager:ue}=(0,E.VI)(),[de]=(0,F.$x)({alertmanager:ue}),[ie,he]=A(de.execute),me=ne.some(ce=>!!ce[k.MX]);return(0,n.jsxs)("div",{className:se.contactPointWrapper,"data-testid":"contact-point",children:[(0,n.jsxs)(c.B,{direction:"column",gap:0,children:[(0,n.jsx)(w,{contactPoint:te,onDelete:ce=>he({name:ce.id||ce.name,resourceVersion:ce.metadata?.resourceVersion})}),me?(0,n.jsx)("div",{children:ne.map((ce,Pe)=>{const Ie=ce[k.v4],Se=ce[k.MX],Me=!ce.disableResolveMessage,Te=ce[k.sW],Ge=Se.name+Pe;return(0,n.jsx)(z,{name:Se.name,type:ce.type,description:(0,S.aM)(ce),diagnostics:Ie,pluginMetadata:Te,sendingResolved:Me},Ge)})}):(0,n.jsx)("div",{className:se.integrationWrapper,children:(0,n.jsx)(X,{receivers:ne})})]}),ie]})},z=te=>{const{name:ne,type:se,description:ue,diagnostics:de,pluginMetadata:ie,sendingResolved:he=!0}=te,me=(0,i.of)(q),ce=de!==void 0;return(0,n.jsx)("div",{className:me.integrationWrapper,children:(0,n.jsxs)(c.B,{direction:"column",gap:.5,children:[(0,n.jsx)(Y,{name:ne,type:se,description:ue,pluginMetadata:ie}),ce&&(0,n.jsx)(Q,{diagnostics:de,sendingResolved:he})]})})};function Y(te){const{name:ne,type:se,description:ue,pluginMetadata:de}=te,ie=K[se];return(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:1,children:[(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:.5,children:[ie&&(0,n.jsx)(m.I,{name:ie}),de?(0,n.jsx)(H,{metadata:de}):(0,n.jsx)(p.E,{variant:"body",color:"primary",children:ne})]}),ue&&(0,n.jsx)(p.E,{variant:"bodySmall",color:"secondary",children:ue})]})}const X=({receivers:te,limit:ne})=>{const se=ne??Number.MAX_VALUE,ue=(0,s.groupBy)(te,me=>me.type),de=(0,s.size)(ue),ie=Object.entries(ue).slice(0,se),he=de-se;return(0,n.jsx)(c.B,{direction:"column",gap:0,children:(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:1,children:[ie.length===0&&(0,n.jsx)(G.P,{color:"warning",icon:"exclamation-triangle",children:(0,n.jsx)(d.x6,{i18nKey:"alerting.contact-points.no-integrations",children:"No integrations configured"})}),ie.map(([me,ce],Pe)=>{const Ie=K[me],Se=V[me]??(0,s.upperFirst)(me),Me=(0,s.size)(ue)-1===Pe,Te=ce[0];return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",gap:.5,children:[Te[k.sW]?.icon&&(0,n.jsx)("img",{width:"14px",src:Te[k.sW]?.icon,alt:Te[k.sW]?.title}),Ie&&(0,n.jsx)(m.I,{name:Ie}),(0,n.jsxs)("span",{children:[Se,ce.length>1&&` (${ce.length})`]})]}),!Me&&"\u22C5"]},me)}),he>0&&(0,n.jsx)("span",{children:`+${he} more`})]})})},Q=({diagnostics:te,sendingResolved:ne})=>{const se=(0,i.of)(q),ue=!!te.lastNotifyAttemptError,de=(0,o.KQ)(te.lastNotifyAttempt),ie=te.lastNotifyAttemptDuration,he=de.isValid();return(0,n.jsx)("div",{className:se.metadataRow,children:(0,n.jsx)(c.B,{direction:"row",gap:1,children:ue?(0,n.jsx)(G.P,{color:"error",icon:"exclamation-circle",children:(0,n.jsx)(h.m,{content:te.lastNotifyAttemptError,children:(0,n.jsx)("span",{children:(0,n.jsx)(d.x6,{i18nKey:"alerting.contact-points.last-delivery-failed",children:"Last delivery attempt failed"})})})}):(0,n.jsxs)(n.Fragment,{children:[he&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(G.P,{icon:"clock-nine",children:[(0,n.jsx)(d.x6,{i18nKey:"alerting.contact-points.last-delivery-attempt",children:"Last delivery attempt"}),(0,n.jsx)(h.m,{content:de.toLocaleString(),children:(0,n.jsx)("span",{children:(0,n.jsx)(p.E,{color:"primary",children:de.locale("en").fromNow()})})})]}),(0,n.jsx)(G.P,{icon:"stopwatch",children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.contact-points.delivery-duration",children:["Last delivery took ",(0,n.jsx)(r.S,{content:ie})]})})]}),!he&&(0,n.jsx)(G.P,{icon:"clock-nine",children:(0,n.jsx)(d.x6,{i18nKey:"alerting.contact-points.no-delivery-attempts",children:"No delivery attempts"})}),!ne&&(0,n.jsx)(G.P,{icon:"info-circle",children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.contact-points.only-firing",children:["Delivering ",(0,n.jsx)(p.E,{color:"primary",children:"only firing"})," notifications"]})})]})})})},q=te=>({contactPointWrapper:(0,a.css)({borderRadius:te.shape.radius.default,border:`solid 1px ${te.colors.border.weak}`,borderBottom:"none"}),integrationWrapper:(0,a.css)({position:"relative",background:`${te.colors.background.primary}`,padding:`${te.spacing(1)} ${te.spacing(1.5)}`,borderBottom:`solid 1px ${te.colors.border.weak}`}),metadataRow:(0,a.css)({borderBottomLeftRadius:`${te.shape.radius.default}`,borderBottomRightRadius:`${te.shape.radius.default}`}),noIntegrationsContainer:(0,a.css)({paddingTop:`${te.spacing(1.5)}`,paddingLeft:`${te.spacing(1.5)}`})})},3887:(Z,R,e)=>{"use strict";e.d(R,{MX:()=>a,sW:()=>s,v4:()=>n});const n=Symbol("receiver_status"),a=Symbol("receiver_metadata"),s=Symbol("receiver_plugin_metadata")},76070:(Z,R,e)=>{"use strict";e.d(R,{PE:()=>a,w6:()=>l});var n=e(11257);const a=[n.w.AlertingReceiversRead],s=[n.w.AlertingReceiversCreate,n.w.AlertingReceiversWrite],l=[...a,...s]},97507:(Z,R,e)=>{"use strict";e.d(R,{dK:()=>V,Kt:()=>H,$x:()=>K,om:()=>F,Z3:()=>L,Pm:()=>_,cB:()=>k});var n=e(96540),a=e(5709);const s=["Receiver"],o=a.H.enhanceEndpoints({addTagTypes:s}).injectEndpoints({endpoints:J=>({listNamespacedReceiver:J.query({query:z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${z.namespace}/receivers`,params:{pretty:z.pretty,allowWatchBookmarks:z.allowWatchBookmarks,continue:z.continue,fieldSelector:z.fieldSelector,labelSelector:z.labelSelector,limit:z.limit,resourceVersion:z.resourceVersion,resourceVersionMatch:z.resourceVersionMatch,sendInitialEvents:z.sendInitialEvents,timeoutSeconds:z.timeoutSeconds,watch:z.watch}}),providesTags:["Receiver"]}),createNamespacedReceiver:J.mutation({query:z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${z.namespace}/receivers`,method:"POST",body:z.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:z.pretty,dryRun:z.dryRun,fieldManager:z.fieldManager,fieldValidation:z.fieldValidation}}),invalidatesTags:["Receiver"]}),readNamespacedReceiver:J.query({query:z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${z.namespace}/receivers/${z.name}`,params:{pretty:z.pretty}}),providesTags:["Receiver"]}),replaceNamespacedReceiver:J.mutation({query:z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${z.namespace}/receivers/${z.name}`,method:"PUT",body:z.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:z.pretty,dryRun:z.dryRun,fieldManager:z.fieldManager,fieldValidation:z.fieldValidation}}),invalidatesTags:["Receiver"]}),deleteNamespacedReceiver:J.mutation({query:z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${z.namespace}/receivers/${z.name}`,method:"DELETE",body:z.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:z.pretty,dryRun:z.dryRun,gracePeriodSeconds:z.gracePeriodSeconds,orphanDependents:z.orphanDependents,propagationPolicy:z.propagationPolicy}}),invalidatesTags:["Receiver"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{createNamespacedReceiver:{invalidatesTags:["Receiver","ContactPoint","ContactPointsStatus","AlertmanagerConfiguration"]},deleteNamespacedReceiver:J=>{const z=J.query;J.query=(...Y)=>{const X=z(...Y);return X.headers={"content-type":"application/json"},X}},readNamespacedReceiver:J=>{const z={hideErrorMessage:!0};J.extraOptions=z}}});var d=e(53226),i=e(51740),c=e(52161),m=e(56476),p=e(85618),h=e(91984),r=e(77788),g=e(80218),y=e(3986),v=e(43100),x=e(15518),f=e(182),u=e(66056);const b=10*1e3,{useGetAlertmanagerConfigurationQuery:E,useGetContactPointsStatusQuery:D,useGrafanaNotifiersQuery:C,useLazyGetAlertmanagerConfigurationQuery:P}=h.m,{useGrafanaOnCallIntegrationsQuery:T}=r.WG,{useListNamespacedReceiverQuery:O,useReadNamespacedReceiverQuery:I,useDeleteNamespacedReceiverMutation:j,useCreateNamespacedReceiverMutation:W,useReplaceNamespacedReceiverMutation:B}=o,S={refetchOnFocus:!0,refetchOnReconnect:!0},w=({skip:J}={})=>{const{installed:z,loading:Y}=(0,y._)((0,f.BO)()),X=T(void 0,{skip:J||!z});return(0,n.useMemo)(()=>z?X:{isLoading:Y,data:void 0},[z,Y,X])},N=J=>({id:J.metadata.name||J.metadata.uid||J.spec.title,name:J.spec.title,provisioned:(0,m.Uo)(J),grafana_managed_receiver_configs:J.spec.integrations,metadata:J.metadata}),M=(...[J,z])=>O(J,{...z,selectFromResult:Y=>{const X=Y.data?.items.map(Q=>N(Q));return{...Y,data:Y.error?[]:X,currentData:X}}}),L=({fetchStatuses:J,fetchPolicies:z,skip:Y}={})=>{const X=(0,p.Ge)(),Q={skip:Y},q=w(Q),te=C(void 0,Q),ne=M({namespace:X},Q),se=D(void 0,{...S,pollingInterval:b,skip:Y||!J}),ue=E(c.hY,{skip:Y||!z});return(0,n.useMemo)(()=>{if(q.isLoading||te.isLoading||ne.isLoading)return{...ne,isLoading:!0,contactPoints:[]};const ie=(0,u.Rm)({status:se.data,notifiers:te.data,onCallIntegrations:q?.data,contactPoints:ne.data||[],alertmanagerConfiguration:ue.data});return{...ne,contactPoints:ie}},[te,ue,ne,se,q])},A=({alertmanager:J,name:z},Y)=>E(J,{...Y,selectFromResult:X=>{const Q=X.data?.alertmanager_config.receivers?.find(q=>q.name===z);return{...X,data:Q,currentData:Q}}}),U=({name:J},z)=>{const Y=(0,p.Ge)();return I({namespace:Y,name:J},{...z,selectFromResult:X=>{const Q=X.data?N(X.data):void 0;return{...X,data:Q,currentData:Q}},skip:z?.skip})},F=({alertmanager:J,name:z})=>{const Y=J===c.hY,X=U({name:z},{skip:!Y}),Q=A({alertmanager:J,name:z},{skip:Y});return Y?X:Q};function V({alertmanager:J,fetchStatuses:z,fetchPolicies:Y,skip:X}){const Q=J===c.hY,q=L({skip:X||!Q,fetchStatuses:z,fetchPolicies:Y}),te=E(J,{...S,selectFromResult:ne=>({...ne,contactPoints:ne.data?(0,u.Rm)({notifiers:i.r,contactPoints:ne.data.alertmanager_config.receivers??[],alertmanagerConfiguration:ne.data}):[]}),skip:X||Q});return Q?q:te}function K({alertmanager:J}){const z=(0,m.dM)(J),[Y]=(0,v.d)(),[X]=j(),Q=(0,g.Yb)(async({name:te,resourceVersion:ne})=>{const se=(0,p.Ge)();await X({name:te,namespace:se,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{preconditions:{resourceVersion:ne}}}).unwrap()}),q=(0,g.Yb)(async({name:te})=>{const ne=(0,x.FS)(te);return Y(ne)});return z?Q:q}const G=(J,z,Y)=>({metadata:{...z&&{name:z},resourceVersion:Y},spec:{title:J.name,integrations:J.grafana_managed_receiver_configs||[]}}),H=({alertmanager:J})=>{const z=J===c.hY,{createOnCallIntegrations:Y}=(0,d.VY)(),[X]=W(),[Q]=(0,v.d)(),q=(0,g.Yb)(async({contactPoint:ne})=>{const se=await Y(ne),ue=(0,p.Ge)(),de=G(se);return X({namespace:ue,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:de}).unwrap()}),te=(0,g.Yb)(async({contactPoint:ne})=>{const se=(0,x.BD)(ne);return Q(se)});return z?q:te},_=({alertmanager:J})=>{const z=J===c.hY,Y=(0,m.dM)(J),{createOnCallIntegrations:X}=(0,d.VY)(),[Q]=B(),[q]=(0,v.d)();return(0,g.Yb)(async ne=>{if("resourceVersion"in ne&&Y){const{contactPoint:se,id:ue,resourceVersion:de}=ne,ie=z?await X(se):se,he=(0,p.Ge)(),me=G(ie,ue,de);return Q({name:ue,namespace:he,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:me}).unwrap()}else if("originalName"in ne){const{contactPoint:se,originalName:ue}=ne,de=z?await X(se):se,ie=(0,x.Xm)({name:ue,receiver:de});return q(ie)}})},k=({alertmanager:J})=>{const[z]=P();return J===c.hY?()=>{}:async(Y,X)=>{if(!(X&&Y===X))return z(J).unwrap().then(Q=>{const{alertmanager_config:q}=Q;return!!q.receivers?.find(ne=>ne.name===Y)?`Contact point already exists with name "${Y}"`:void 0})}}},8307:(Z,R,e)=>{"use strict";e.d(R,{B:()=>v,G:()=>x});var n=e(74848),a=e(96540),s=e(42941),l=e(16692),o=e(92745),d=e(6975),i=e(70327),c=e(77880),m=e(25149),p=e(78102);const h=({receiverName:f,decrypt:u,exportFormat:b,onClose:E})=>{const{currentData:D="",isFetching:C}=i.hK.useExportReceiverQuery({receiverName:f,decrypt:u,format:b}),P=`cp-${f}-${new Date().getTime()}`;return C?(0,n.jsx)(d._,{text:(0,o.t)("alerting.grafana-receiver-export-preview.text-loading","Loading....")}):(0,n.jsx)(c.J,{format:b,textDefinition:D,downloadFileName:P,onClose:E})},r=({onClose:f,receiverName:u,decrypt:b})=>{const[E,D]=(0,a.useState)("yaml");return(0,n.jsx)(m.m,{activeTab:E,onTabChange:D,onClose:f,formatProviders:Object.values(p.sl),children:(0,n.jsx)(h,{receiverName:u,decrypt:b,exportFormat:E,onClose:f})})},g=({decrypt:f,exportFormat:u,onClose:b})=>{const{currentData:E="",isFetching:D}=i.hK.useExportReceiversQuery({decrypt:f,format:u}),C=`contact-points-${new Date().getTime()}`;return D?(0,n.jsx)(d._,{text:(0,o.t)("alerting.grafana-receivers-export-preview.text-loading","Loading....")}):(0,n.jsx)(c.J,{format:u,textDefinition:E,downloadFileName:C,onClose:b})},y=({onClose:f,decrypt:u})=>{const[b,E]=(0,a.useState)("yaml");return(0,n.jsx)(m.m,{activeTab:b,onTabChange:E,onClose:f,formatProviders:Object.values(p.sl),children:(0,n.jsx)(g,{decrypt:u,exportFormat:b,onClose:f})})},v=Symbol("all contact points"),x=()=>{const[f,u]=(0,a.useState)(null),[b,E]=(0,s.A)(!1),[D,C]=(0,l.L7)(l.QI.DecryptSecrets),P=D&&C,T=(0,a.useCallback)(()=>{u(null),E(!1)},[E]),O=j=>{u(j),E(!0)};return[(0,a.useMemo)(()=>!f||!b?null:f===v?(0,n.jsx)(y,{decrypt:P,onClose:T}):(0,n.jsx)(r,{receiverName:f,decrypt:P,onClose:T}),[P,b,T,f]),O]}},66056:(Z,R,e)=>{"use strict";e.d(R,{Rm:()=>C,aM:()=>E,T8:()=>j});var n=e(2543),a=e(92745),s=e(56476),l=e(84266),o=e(48442);function d(W){return"grafana_managed_receiver_configs"in W?W.grafana_managed_receiver_configs??[]:Object.entries(W).filter(([S])=>S!=="grafana_managed_receiver_configs"&&S.endsWith("_configs")).filter(([S,w])=>Array.isArray(w)&&!(0,n.isEmpty)(w)).reduce((S,[w,N])=>{const M=w.replace("_configs",""),L=N.map(A=>({name:W.name,type:M,settings:A,disableResolveMessage:!1}));return S.concat(L)},[])}var i=e(6135),c=e(182),m=e(28405),p=e(58774),h=e(15645),r=e(2869);const x={title:"Grafana OnCall",icon:{[r.W.OnCall]:h,[r.W.Irm]:p,[r.W.Incident]:"",[r.W.MachineLearning]:"",[r.W.Labels]:"",[r.W.Slo]:""}[(0,c.BO)()]};function f(W,B,S=!0){const w=(0,c.ZP)()?"IRM":"OnCall";if(!S||!B.settings?.url||W===void 0)return x;if(W==null)return{...x,warning:`Grafana ${w} is not installed or is disabled`};const N=W.find(M=>M.integration_url===B.settings?.url);return{...x,description:N?.display_name,externalUrl:N?(0,m.h)((0,c.BO)(),`/integrations/${N.value}`):void 0,warning:N?void 0:`${w} Integration no longer exists`}}var u=e(3887);const b="__grafana_receiver__";function E(W){if(!W.settings)return;const{settings:B}=W;switch(W.type){case"email":{const S=B.addresses||B.to;return S?D(S):void 0}case"slack":{const S=B.recipient||B.channel;return S?`#${S.replace(/^#/,"")}`:void 0}case"kafka":return B.kafkaTopic;case"webhook":return B.url;case"jira":return(0,a.t)("alerting.contact-points.receiver-summary.jira",'Creates a "{{issueType}}" issue in the "{{project}}" project',{issueType:B.issue_type,project:B.project,url:B.api_url});case i.J4.OnCall:return W[u.sW]?.description;default:return W[u.MX]?.description}}function D(W){const S=/,|;|\n+/g,w=W.trim().split(S).map(n.trim),N=(0,n.take)(w,3),M=(0,n.difference)(w,N);return M.length&&N.push(`+${M.length} more`),N.join(", ")}function C({status:W=[],notifiers:B=[],onCallIntegrations:S,contactPoints:w,alertmanagerConfiguration:N}){const M=(0,o._I)(N?.alertmanager_config?.route??{}),L=O(M),A=(0,n.groupBy)(L,"receiver");return w.map(F=>{const V=d(F),K=W.find(H=>H.name===F.name),G=P(F);return{...F,id:G,policies:N&&A&&(A[F.name]??[]),grafana_managed_receiver_configs:V.map((H,_)=>{const k=H.type===i.J4.OnCall;return{...H,[u.v4]:K?.integrations[_],[u.MX]:I(B,H),[u.sW]:k?f(S,H,!!N):void 0}})}}).sort((F,V)=>F.name.localeCompare(V.name))}function P(W){return"id"in W&&W.id?W.id:W.name}function T(W){return W.object_matchers?W.object_matchers.some(B=>B[0]===b&&B[1]===l.ho.equal)??!1:!1}function O(W){const B=W.routes?.flatMap(S=>O(S))??[];return W.receiver?[{receiver:W.receiver,route:{type:T(W)?"auto-generated":"normal"}},...B]:B}function I(W,B){const S=W.find(w=>w.type===B.type);return{name:S?.name??(0,n.upperFirst)(B.type),description:S?.description}}const j=(W,B)=>(0,s.dM)(W)&&(0,s.jw)(B)},77880:(Z,R,e)=>{"use strict";e.d(R,{J:()=>v});var n=e(74848),a=e(22803),s=e(4213),l=e.n(s),o=e(96540),d=e(70713),i=e(92745),c=e(63142),m=e(50992),p=e(45861),h=e(47931),r=e(89640),g=e(34999),y=e(78102);function v({format:u,textDefinition:b,downloadFileName:E,onClose:D}){const C=(0,c.of)(x),P=y.sl[u],T=(0,o.useCallback)(()=>{const I=new Blob([b],{type:`application/${u};charset=utf-8`});l()(I,`${E}.${u}`)},[b,E,u]),O=(0,o.useMemo)(()=>P.formatter?P.formatter(b):b,[P,b]);return(0,n.jsxs)("div",{className:C.container,children:[(0,n.jsx)(f,{exportProvider:P}),(0,n.jsx)("div",{className:C.content,children:(0,n.jsx)(d.Ay,{disableWidth:!0,children:({height:I})=>(0,n.jsx)(m.B,{width:"100%",height:I,language:u,value:O,monacoOptions:{minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",readOnly:!0}})})}),(0,n.jsxs)("div",{className:C.actions,children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:D,children:(0,n.jsx)(i.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})}),(0,n.jsx)(h.b,{icon:"copy",getText:()=>b,children:(0,n.jsx)(i.x6,{i18nKey:"alerting.file-export-preview.copy-code",children:"Copy code"})}),(0,n.jsx)(p.$n,{icon:"download-alt",onClick:T,children:(0,n.jsx)(i.x6,{i18nKey:"alerting.file-export-preview.download",children:"Download"})})]})]})}const x=u=>({container:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",gap:u.spacing(2)}),content:(0,a.css)({flex:"1 1 100%"}),actions:(0,a.css)({flex:0,justifyContent:"flex-end",display:"flex",gap:u.spacing(1)})});function f({exportProvider:u}){const{name:b,type:E}=u,D={file:{title:(0,i.t)("alerting.file-export-inline-documentation.export-inline-doc.title.fileprovisioning-format","File-provisioning format"),component:(0,n.jsxs)(i.x6,{i18nKey:"alerting.file-export-inline-documentation.file-provisioning",children:[{name:b}," format is only valid for File Provisioning."," ",(0,n.jsx)(r.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/",external:!0,children:"Read more in the docs."})]})},api:{title:(0,i.t)("alerting.file-export-inline-documentation.export-inline-doc.title.apiprovisioning-format","API-provisioning format"),component:(0,n.jsxs)(i.x6,{i18nKey:"alerting.file-export-inline-documentation.api-provisioning",children:[{name:b}," format is only valid for API Provisioning."," ",(0,n.jsx)(r.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/http-api-provisioning/",external:!0,children:"Read more in the docs."})]})},terraform:{title:(0,i.t)("alerting.file-export-inline-documentation.export-inline-doc.title.terraformprovisioning-format","Terraform-provisioning format"),component:(0,n.jsxs)(i.x6,{i18nKey:"alerting.file-export-inline-documentation.terraform-provisioning",children:[{name:b}," format is only valid for Terraform Provisioning."," ",(0,n.jsx)(r.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/terraform-provisioning/",external:!0,children:"Read more in the docs."})]})}},{title:C,component:P}=D[E];return(0,n.jsx)(g.F,{title:C,severity:"info",bottomSpacing:0,topSpacing:0,children:P})}},25149:(Z,R,e)=>{"use strict";e.d(R,{m:()=>o});var n=e(74848),a=e(92745),s=e(8207),l=e(29855);function o({activeTab:d,onTabChange:i,children:c,onClose:m,formatProviders:p,title:h="Export"}){const r=Object.values(p).map(y=>({label:y.name,value:y.exportFormat})),g=p.length>1?(0,a.t)("alerting.export.subtitle.formats","Select the format and download the file or copy the contents to clipboard"):(0,a.t)("alerting.export.subtitle.one-format","Download the file or copy the contents to clipboard");return(0,n.jsx)(s._,{title:h,subtitle:g,tabs:(0,n.jsx)(l.sb,{tabs:r,setActiveTab:i,activeTab:d}),onClose:m,size:"md",children:c})}},78102:(Z,R,e)=>{"use strict";e.d(R,{dX:()=>s,sl:()=>l});const n={name:"JSON",exportFormat:"json",type:"file",formatter:d=>{try{return JSON.stringify(JSON.parse(d),null,4)}catch{return d}}},a={name:"YAML",exportFormat:"yaml",type:"file"},s={name:"Terraform (HCL)",exportFormat:"hcl",type:"terraform"},l={[n.exportFormat]:n,[a.exportFormat]:a,[s.exportFormat]:s},o=[n,a]},51993:(Z,R,e)=>{"use strict";e.d(R,{GX:()=>U,r4:()=>L});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(96540),d=e(49785),i=e(28105),c=e(1906),m=e(17503),p=e(80011),h=e(92745),r=e(63142),g=e(34999),y=e(41654),v=e(45861),x=e(33033),f=e(76319),u=e(66404),b=e(91073),E=e(18203),D=e(89931),C=e(4652),P=e(32576),T=e(38610),O=e(4651),I=e(24619),j=e(74048),W=e(29609),B=e(38055),S=e(49779),w=e(65420),N=e(38076),M=e(88589);const L=({queries:X=[],query:Q,data:q,error:te,warning:ne,isAlertCondition:se,onSetCondition:ue,onUpdateRefId:de,onRemoveExpression:ie,onUpdateExpressionType:he,onChangeQuery:me})=>{const ce=(0,r.of)(Y),Pe=Q?.type,{setError:Ie,clearErrors:Se,watch:Me}=(0,d.xW)(),Te=Me("type"),Ge=Te?(0,W.pq)(Te):!1,Qe=(0,o.useCallback)(_e=>{_e?Ie("queries",{type:"custom",message:_e}):Se("queries")},[Ie,Se]),tt=q&&Object.values(q).some(_e=>!!_e&&_e.state===i.Gu.Loading),ke=Array.isArray(q?.series)&&!tt,He=q?.series??[],Re=se??!1,{seriesCount:Ne,groupedByState:Ae}=V(He),Ue=(0,o.useCallback)(_e=>{const Xe=X.filter(le=>_e.refId!==le.refId).map(le=>({value:le.refId,label:le.refId}));switch(_e.type){case O.Tz.math:return(0,n.jsx)(E.z,{onChange:me,query:_e,labelWidth:"auto",onRunQuery:()=>{}});case O.Tz.reduce:return(0,n.jsx)(D.Z,{onChange:me,refIds:Xe,labelWidth:"auto",app:c.Jk.UnifiedAlerting,query:_e});case O.Tz.resample:return(0,n.jsx)(C.C,{onChange:me,query:_e,labelWidth:"auto",refIds:Xe});case O.Tz.classic:return(0,n.jsx)(b.z,{onChange:me,query:_e,refIds:Xe});case O.Tz.threshold:return(0,n.jsx)(T.O,{onChange:me,query:_e,labelWidth:"auto",refIds:Xe,onError:Qe,useHysteresis:!0});case O.Tz.sql:return(0,n.jsx)(P.k,{onChange:le=>me(le),query:_e,refIds:Xe,alerting:!0});default:return(0,n.jsxs)(h.x6,{i18nKey:"alerting.expression.not-supported",values:{expression:_e.type},children:["Expression not supported: ","{{expression}}"]})}},[me,X,Qe]),We=O.uQ.find(_e=>_e.value===Pe)?.description??"";return(0,n.jsx)("div",{className:(0,a.cx)(ce.expression.wrapper,Re&&ce.expression.alertCondition,Pe===O.Tz.classic&&ce.expression.classic,Pe!==O.Tz.classic&&ce.expression.nonClassic),children:(0,n.jsxs)("div",{className:ce.expression.stack,children:[(0,n.jsx)(K,{refId:Q.refId,queryType:Pe,onRemoveExpression:()=>ie(Q.refId),onUpdateRefId:_e=>de(Q.refId,_e),onSetCondition:ue,query:Q,alertCondition:Re}),(0,n.jsxs)("div",{className:ce.expression.body,children:[te&&(0,n.jsx)(g.F,{title:(0,h.t)("alerting.expression.title-expression-failed","Expression failed"),severity:"error",children:te.message}),ne&&(0,n.jsx)(g.F,{title:(0,h.t)("alerting.expression.title-expression-warning","Expression warning"),severity:"warning",children:ne.message}),(0,n.jsx)("div",{className:ce.expression.description,children:We}),Ue(Q)]}),ke&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U,{series:He,isAlertCondition:se,isRecordingRule:Ge}),!Ge&&(0,n.jsx)("div",{className:ce.footer,children:(0,n.jsxs)(y.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)(S.h,{}),(0,n.jsx)(F,{isCondition:!!se,firing:Ae[I.cF.Firing].length,normal:Ae[I.cF.Inactive].length,seriesCount:Ne})]})})]})]})})},A=20,U=({series:X,isAlertCondition:Q,isRecordingRule:q=!1})=>{const{pageItems:te,previousPage:ne,nextPage:se,numberOfPages:ue,pageStart:de,pageEnd:ie}=(0,j.W)(X,1,A),he=(0,r.of)(Y),me=(0,M.PI)(X),ce=!me&&(0,m.jq)(X),Pe=ue>1;return(0,n.jsxs)("div",{className:he.expression.results,children:[!me&&ce&&(0,n.jsx)("div",{children:te.map((Ie,Se)=>(0,n.jsx)(z,{frame:Ie,index:de+Se,isAlertCondition:Q},(0,s.uniqueId)()))}),!me&&!ce&&te.map((Ie,Se)=>(0,n.jsx)(J,{frame:Ie,index:de+Se,isAlertCondition:Q,isRecordingRule:q},(0,s.uniqueId)())),me&&(0,n.jsx)("div",{className:(0,a.cx)(he.expression.noData,he.mutedText),children:(0,n.jsx)(h.x6,{i18nKey:"alerting.expression-result.no-data",children:"No data"})}),Pe&&(0,n.jsx)("div",{className:he.pagination.wrapper,"data-testid":"paginate-expression",children:(0,n.jsxs)(y.B,{children:[(0,n.jsx)(v.$n,{variant:"secondary",fill:"outline",onClick:ne,icon:"angle-left",size:"sm","aria-label":(0,h.t)("alerting.expression-result.aria-label-previouspage","previous-page")}),(0,n.jsx)(S.h,{}),(0,n.jsx)("span",{className:he.mutedText,children:(0,n.jsxs)(h.x6,{i18nKey:"alerting.expression-result.page-counter",values:{pageStart:de,pageEnd:ie,numPages:X.length},children:["{{pageStart}}"," - ","{{pageEnd}}"," of ","{{numPages}}"]})}),(0,n.jsx)(S.h,{}),(0,n.jsx)(v.$n,{variant:"secondary",fill:"outline",onClick:se,icon:"angle-right",size:"sm","aria-label":(0,h.t)("alerting.expression-result.aria-label-nextpage","next-page")})]})})]})},F=({firing:X,normal:Q,isCondition:q,seriesCount:te})=>{const{mutedText:ne}=(0,r.of)(Y);return te===0?(0,n.jsx)("span",{className:ne,children:(0,n.jsx)(h.x6,{i18nKey:"alerting.preview-summary.no-series",children:"No series"})}):q?(0,n.jsx)("span",{className:ne,children:`${te} series: ${X} firing, ${Q} normal`}):(0,n.jsx)("span",{className:ne,children:`${te} series`})};function V(X){const Q=X.filter(ne=>(0,M.Lm)(ne)===void 0).length,q={[I.cF.Firing]:X.filter(ne=>(0,M.Lm)(ne)!==void 0&&(0,M.Lm)(ne)!==0),[I.cF.Inactive]:X.filter(ne=>(0,M.Lm)(ne)===0)},te=X.length-Q;return{groupedByState:q,seriesCount:te}}const K=({refId:X,queryType:Q,onUpdateRefId:q,onRemoveExpression:te,onSetCondition:ne,alertCondition:se,query:ue})=>{const de=(0,r.of)(Y),ie=(0,r.of)(v.my),[he,me]=(0,o.useState)(!1),Pe=he!==!1&&he==="refId";return(0,n.jsx)("header",{className:de.header.wrapper,children:(0,n.jsxs)(y.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,n.jsxs)(y.B,{direction:"row",gap:1,alignItems:"center",children:[!Pe&&(0,n.jsx)("button",{type:"button",className:(0,a.cx)(ie,de.editable),onClick:()=>me("refId"),children:(0,n.jsx)("div",{className:de.expression.refId,children:X})}),Pe&&(0,n.jsx)(x.D,{autoFocus:!0,defaultValue:X,minWidth:5,onFocus:Ie=>Ie.target.select(),onBlur:Ie=>{q(Ie.currentTarget.value),me(!1)}}),(0,n.jsx)("div",{children:(0,O.NI)(Q)})]}),(0,n.jsx)(S.h,{}),(0,n.jsx)(N.a,{refId:X,onSetCondition:()=>ne(ue.refId),isCondition:se}),(0,n.jsx)(f.K,{name:"trash-alt",variant:"secondary",className:de.mutedIcon,onClick:te,tooltip:(0,h.t)("alerting.header.tooltip-remove",'Remove expression "{{refId}}"',{refId:X})})]})})},G=()=>(0,n.jsx)("span",{children:"{"}),H=()=>(0,n.jsx)("span",{children:"}"}),_=()=>(0,n.jsx)("span",{children:'"'}),k=()=>(0,n.jsx)("span",{children:"="});function J({frame:X,index:Q,isAlertCondition:q,isRecordingRule:te}){const ne=(0,r.of)(Y),se=(0,M.Jw)(X)||"Series "+Q,ue=(0,M.Lm)(X),de=(0,M.JQ)(X),ie=Object.entries(de),he=ie.length>0,me=q&&ue!==0,ce=q&&ue===0,Pe=`${he?"":se}${he?`{${(0,M.h6)(de)}}`:""}`,Ie=!te;return(0,n.jsx)("div",{className:ne.expression.resultsRow,children:(0,n.jsxs)(y.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{className:ne.expression.resultLabel,title:Pe,children:(0,n.jsx)(u.E,{variant:"code",children:he?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(G,{}),ie.map(([Se,Me],Te)=>(0,n.jsxs)(u.E,{variant:"body",children:[(0,n.jsx)("span",{className:ne.expression.labelKey,children:Se}),(0,n.jsx)(k,{}),(0,n.jsx)(_,{}),(0,n.jsx)("span",{className:ne.expression.labelValue,children:Me}),(0,n.jsx)(_,{}),Te<ie.length-1&&(0,n.jsx)("span",{children:", "})]},(0,s.uniqueId)())),(0,n.jsx)(H,{})]}):(0,n.jsx)("span",{className:ne.expression.labelKey,children:Pe})})}),(0,n.jsx)("div",{className:ne.expression.resultValue,children:(0,M.Cs)(ue)}),Ie&&(0,n.jsxs)(n.Fragment,{children:[me&&(0,n.jsx)(w.C,{state:I.cF.Firing,size:"sm"}),ce&&(0,n.jsx)(w.C,{state:I.cF.Inactive,size:"sm"})]})]})})}const z=({frame:X,index:Q})=>{const q=(0,r.of)(Y),te=X.fields[1],ne=te.labels,ue=te.config?.displayNameFromDS??(ne?(0,M.h6)(te.labels??{}):"Series "+Q),de=X.fields[0].values,ie=me=>X.fields[0].values[me],he=me=>X.fields[1].values[me];return(0,n.jsx)("div",{className:q.expression.resultsRow,children:(0,n.jsxs)(y.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)("span",{className:(0,a.cx)(q.mutedText,q.expression.resultLabel),title:ue,children:ue}),(0,n.jsx)("div",{className:q.expression.resultValue,children:(0,n.jsx)(B.B,{placement:"right",wrapperClassName:q.timeseriesTableWrapper,content:(0,n.jsxs)("table",{className:q.timeseriesTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(h.x6,{i18nKey:"alerting.timeseries-row.timestamp",children:"Timestamp"})}),(0,n.jsx)("th",{children:(0,n.jsx)(h.x6,{i18nKey:"alerting.timeseries-row.value",children:"Value"})})]})}),(0,n.jsx)("tbody",{children:de.map((me,ce)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:q.mutedText,children:(0,p.LE)(ie(ce))}),(0,n.jsx)("td",{className:q.expression.resultValue,children:he(ce)})]},ce))})]}),children:(0,n.jsx)("span",{children:(0,n.jsx)(h.x6,{i18nKey:"alerting.timeseries-row.time-series-data",children:"Time series data"})})})})]})})},Y=X=>({expression:{wrapper:(0,a.css)({display:"flex",border:`solid 1px ${X.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:X.shape.radius.default}),stack:(0,a.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,a.css)({maxWidth:"100%"}),nonClassic:(0,a.css)({maxWidth:"640px"}),alertCondition:(0,a.css)({}),body:(0,a.css)({padding:X.spacing(1),flex:1}),description:(0,a.css)({marginBottom:X.spacing(1),fontSize:X.typography.size.xs,color:X.colors.text.secondary}),refId:(0,a.css)({fontWeight:X.typography.fontWeightBold,color:X.colors.primary.text}),results:(0,a.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${X.colors.border.medium}`}),noResults:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,a.css)({padding:`${X.spacing(.75)} ${X.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:X.colors.background.secondary},"&:hover":{backgroundColor:X.colors.background.canvas}}),labelKey:(0,a.css)({color:X.isDark?"#73bf69":"#56a64b"}),labelValue:(0,a.css)({color:X.isDark?"#ce9178":"#a31515"}),resultValue:(0,a.css)({textAlign:"right"}),resultLabel:(0,a.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:X.spacing()})},mutedText:(0,a.css)({color:X.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,a.css)({background:X.colors.background.secondary,padding:`${X.spacing(.5)} ${X.spacing(1)}`,borderBottom:`solid 1px ${X.colors.border.weak}`})},footer:(0,a.css)({background:X.colors.background.secondary,padding:X.spacing(1),borderTop:`solid 1px ${X.colors.border.weak}`}),draggableIcon:(0,a.css)({cursor:"grab"}),mutedIcon:(0,a.css)({color:X.colors.text.secondary}),editable:(0,a.css)({padding:`${X.spacing(.5)} ${X.spacing(1)}`,border:`solid 1px ${X.colors.border.weak}`,borderRadius:X.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:X.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,a.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,a.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:X.spacing(1)},td:{background:X.colors.background.primary},th:{background:X.colors.background.secondary},tr:{borderBottom:`1px solid ${X.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,a.css)({borderTop:`1px solid ${X.colors.border.medium}`,padding:X.spacing()})}})},38076:(Z,R,e)=>{"use strict";e.d(R,{a:()=>c});var n=e(74848),a=e(22803),s=e(49785),l=e(63142),o=e(99887),d=e(45861),i=e(29609);const c=({isCondition:p,onSetCondition:h,refId:r})=>{const g=(0,l.of)(m),{watch:y}=(0,s.xW)(),v=y("type"),x=v?(0,i.pq)(v):!1,f=x?"Recording rule output":"Alert condition",u=r?`Set "${r}" as alert condition`:"Set as alert condition",b=x?"Set as recording rule output":u;return p?(0,n.jsx)(o.E,{color:"green",icon:"check",text:f},"condition"):(0,n.jsx)("button",{type:"button",className:g.actionLink,onClick:()=>h&&h(),children:b},"make-condition")},m=p=>{const h=(0,d.my)(p);return{actionLink:(0,a.css)(h,{color:p.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},88589:(Z,R,e)=>{"use strict";e.d(R,{Cs:()=>c,EL:()=>h,JQ:()=>m,Jw:()=>o,Lm:()=>d,PI:()=>g,h6:()=>p});var n=e(2543),a=e.n(n),s=e(79243),l=e(52161);const o=y=>{const v=y.fields.at(0);return v?.config?.displayNameFromDS??y.name??v?.labels?.__name__},d=y=>y.fields.at(0)?.values.at(0),i=new Intl.NumberFormat(void 0,{maximumSignificantDigits:5}),c=y=>Number.isFinite(y)&&typeof y=="number"?Math.abs(y)<1?i.format(y):(0,s.h)(y,5).toString(10):String(y),m=y=>y.fields[0]?.labels??{},p=y=>Object.entries(y).map(([v,x])=>v+"="+x).join(", "),h=y=>{const v=y.name;if((0,l.Eb)(y.rulesSource))return{name:v,parents:[]};try{const x=JSON.parse(v);if(!Array.isArray(x))throw new Error("not a nested Grafana folder");const f=(0,n.last)(x)??v,u=(0,n.dropRight)(x,1);return{name:f,parents:u}}catch{return{name:y.name,parents:[]}}},r=(y,v=[])=>JSON.stringify(v.concat(y)),g=y=>y.every(x=>x.fields.every(f=>f.values.every(u=>u==null)))},66513:(Z,R,e)=>{"use strict";e.d(R,{GK:()=>l,Zr:()=>s,xK:()=>a});var n=e(11257);const a=[n.w.AlertingTimeIntervalsRead],s=[n.w.AlertingTimeIntervalsWrite],l=[...a,...s]},92125:(Z,R,e)=>{"use strict";e.d(R,{s:()=>p});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(63142),d=e(41654),i=e(48542),c=e(63895),m=e(38055);const p=({matchers:g,formatter:y="default"})=>{const v=(0,o.of)(r),x=5,f=(0,s.take)(g,x),u=(0,s.takeRight)(g,g.length-x),b=u.length>0;return(0,n.jsx)("span",{"data-testid":"label-matchers",children:(0,n.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",wrap:"wrap",children:[f.map(E=>(0,n.jsx)(h,{matcher:E,formatter:y},(0,s.uniqueId)())),b&&(0,n.jsx)(m.B,{arrow:!0,placement:"top",content:(0,n.jsx)(n.Fragment,{children:u.map(E=>(0,n.jsx)(h,{matcher:E},(0,s.uniqueId)()))}),children:(0,n.jsx)("span",{children:(0,n.jsx)("div",{className:v.metadata,children:`and ${u.length} more`})})})]})})},h=({matcher:g,formatter:y="default"})=>{const v=(0,o.of)(r);return(0,n.jsx)("div",{className:v.matcher(g[0]).wrapper,children:(0,n.jsx)(d.B,{direction:"row",gap:0,alignItems:"baseline",children:c.t8[y](g)})})},r=g=>({matcher:y=>{const{color:v,borderColor:x}=(0,i.MC)(y);return{wrapper:(0,a.css)({color:"#fff",background:v,padding:`${g.spacing(.33)} ${g.spacing(.66)}`,fontSize:g.typography.bodySmall.fontSize,border:`solid 1px ${x}`,borderRadius:g.shape.borderRadius(2),whiteSpace:"pre"})}},metadata:(0,a.css)({color:g.colors.text.secondary,fontSize:g.typography.bodySmall.fontSize,fontWeight:g.typography.bodySmall.fontWeight})})},42004:(Z,R,e)=>{"use strict";e.d(R,{PE:()=>Y,OJ:()=>Pe});var n=e(74848),a=e(22803),s=e(2543),l=e(55127),o=e.n(l),d=e(96540),i=e(42941),c=e(92745),m=e(63142),p=e(41654),h=e(76319),r=e(45861),g=e(88559),y=e(87063),v=e(66404),x=e(45967),f=e(99887),u=e(30703),b=e(89640),E=e(48542),D=e(10427),C=e(27691),P=e(16194),T=e(24961),O=e(84266),I=e(16692),j=e(86017),W=e(63895),B=e(77256),S=e(48442),w=e(24898),N=e(38055),M=e(78793),L=e(1625),A=e(1972),U=e(49779),F=e(6975),V=e(70327),K=e(77880),G=e(25149),H=e(78102);const _=({exportFormat:Qe,onClose:tt})=>{const{currentData:ke="",isFetching:He}=V.hK.useExportPoliciesQuery({format:Qe}),Re=`policies-${new Date().getTime()}`;return He?(0,n.jsx)(F._,{text:(0,c.t)("alerting.grafana-policies-exporter-preview.text-loading","Loading....")}):(0,n.jsx)(K.J,{format:Qe,textDefinition:ke,downloadFileName:Re,onClose:tt})},k=({onClose:Qe})=>{const[tt,ke]=(0,d.useState)("yaml");return(0,n.jsx)(G.m,{activeTab:tt,onTabChange:ke,onClose:Qe,formatProviders:Object.values(H.sl),children:(0,n.jsx)(_,{exportFormat:tt,onClose:Qe})})};var J=e(92125);const z=20,Y=Qe=>{const{receivers:tt=[],contactPointsState:ke,readOnly:He=!1,provisioned:Re=!1,alertManagerSourceName:Ne,currentRoute:Ae,inheritedProperties:Ue,routesMatchingFilters:Be={filtersApplied:!1,matchedRoutesWithPath:new Map},matchingInstancesPreview:We={enabled:!1},onEditPolicy:_e,onAddPolicy:Xe,onDeletePolicy:le,onShowAlertInstances:ye,isAutoGenerated:pe=!1,isDefaultPolicy:ve=!1}=Qe,be=(0,m.of)(Ge),Oe=Ae.receiver,we=Ae.continue??!1,ze=(0,W.J$)(Ae),Ve=!!(ze&&ze.length),{filtersApplied:ge,matchedRoutesWithPath:Ke}=Be,qe=Array.from(Ke.keys()),ot=ge&&qe.some(Ca=>Ca.id===Ae.id),lt=Array.from(Ke.values()).flat(),mt=lt.some(Ca=>Ca.id===Ae.id),Lt=[],Tt=!Ve&&!ve&&!we,It=Oe??Ue?.receiver??"",Mt=ke?Se(It,ke):[],Ut=Ae.routes??[],an=ge?Ut.filter(Ca=>lt.some(Ka=>Ka.id===Ca.id)):Ut,cn=an.length>0,[un,On]=(0,i.A)(!1),yn=We?.groupsMap?.get(Ae.id),En=yn?(0,s.sumBy)(yn,Ca=>Ca.alerts.length):void 0,[Bn,fa]=(0,I.L7)(I.QI.ViewAutogeneratedPolicyTree),Fn=te(Ae),[Ea,gt]=(0,i.A)(!Fn),Ht=Ae.group_by,wt=Ae.mute_time_intervals??[],Yt=Ae.active_time_intervals??[],rn={group_wait:Ae.group_wait,group_interval:Ae.group_interval,repeat_interval:Ae.repeat_interval};Mt.forEach(Ca=>{Lt.push(Ca)});const[Xt,on]=(0,d.useState)(z),pn=Q(pe,ve,Re,_e,Ae,On,le);if(pe&&(!fa||!Bn)||ge&&!mt)return null;const Gn=ve||Fn,Wa=an.filter(Ca=>lt.some(Ka=>Ka.id===Ca.id)),za=ge?Wa:an,Oa=za.slice(0,Xt),ss=za.length-Oa.length,La=ss>0;return(0,n.jsxs)(p.B,{direction:"column",gap:1.5,children:[(0,n.jsxs)("div",{className:be.policyWrapper(ot),"data-testid":ve?"am-root-route-container":"am-route-container",children:[we&&(0,n.jsx)(ue,{}),Tt&&(0,n.jsx)(de,{}),(0,n.jsx)("div",{className:be.policyItemWrapper,children:(0,n.jsxs)(p.B,{direction:"column",gap:1,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(p.B,{direction:"row",alignItems:"center",gap:1,children:[cn?(0,n.jsx)(h.K,{name:Ea?"angle-down":"angle-right",onClick:gt,"aria-label":Ea?(0,c.t)("alerting.policies.aria-label-collapse","Collapse"):(0,c.t)("alerting.policies.aria-label-expand","Expand")}):null,Gn&&(0,n.jsx)(n.Fragment,{children:Fn?(0,n.jsx)(he,{}):(0,n.jsx)(ie,{})}),!Gn&&(0,n.jsx)(n.Fragment,{children:Ve?(0,n.jsx)(J.s,{matchers:ze??[],formatter:(0,j.VE)(Ne)}):(0,n.jsx)("span",{className:be.metadata,children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.no-matchers",children:"No matchers"})})}),(0,n.jsx)(U.h,{}),Lt.length>0&&(0,n.jsx)(se,{errors:Lt}),Re&&(0,n.jsx)(A.rS,{}),(0,n.jsxs)(p.B,{direction:"row",gap:.5,children:[!pe&&!He&&(0,n.jsx)(w._,{actions:[I.QI.CreateNotificationPolicy],children:(0,n.jsx)(D.A,{shouldWrap:Re,wrap:ne,children:ve?(0,n.jsx)(r.$n,{variant:"secondary",icon:"plus",size:"sm",disabled:Re,type:"button",onClick:()=>Xe(Ae,"child"),children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.new-child",children:"New child policy"})}):(0,n.jsx)(g.m,{overlay:(0,n.jsxs)(y.W,{children:[(0,n.jsx)(y.W.Item,{label:(0,c.t)("alerting.policy.label-new-sibling-above","New sibling above"),icon:"arrow-up",onClick:()=>Xe(Ae,"above")}),(0,n.jsx)(y.W.Item,{label:(0,c.t)("alerting.policy.label-new-sibling-below","New sibling below"),icon:"arrow-down",onClick:()=>Xe(Ae,"below")}),(0,n.jsx)(y.W.Divider,{}),(0,n.jsx)(y.W.Item,{label:(0,c.t)("alerting.policy.label-new-child-policy","New child policy"),icon:"plus",onClick:()=>Xe(Ae,"child")})]}),children:(0,n.jsx)(r.$n,{size:"sm",variant:"secondary",disabled:Re,icon:"angle-down",type:"button",children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.new-policy",children:"Add new policy"})})})})}),pn.length>0&&(0,n.jsx)(g.m,{overlay:(0,n.jsx)(y.W,{children:pn}),children:(0,n.jsx)(C.A,{"aria-label":ve?(0,c.t)("alerting.policies.aria-label-more-default","more actions for default policy"):(0,c.t)("alerting.policies.aria-label-more","more actions for policy"),"data-testid":"more-actions"})})]})]})}),(0,n.jsx)(X,{matchingInstancesPreview:We,numberOfAlertInstances:En,contactPoint:Oe??void 0,groupBy:Ht,muteTimings:wt,activeTimings:Yt,timingOptions:rn,inheritedProperties:Ue,alertManagerSourceName:Ne,receivers:tt,matchingAlertGroups:yn,matchers:ze,isDefaultPolicy:ve,onShowAlertInstances:ye})]})})]}),(0,n.jsx)("div",{className:be.childPolicies,children:Ea&&(0,n.jsxs)(n.Fragment,{children:[Oa.map(Ca=>{const Ka=(0,S.W$)(Ae,Ca,Ue),As=te(Ca)||pe,Ia=He||Re||pe;return(0,n.jsx)(Y,{currentRoute:Ca,receivers:tt,contactPointsState:ke,readOnly:Ia,inheritedProperties:Ka,onAddPolicy:Xe,onEditPolicy:_e,onDeletePolicy:le,onShowAlertInstances:ye,alertManagerSourceName:Ne,routesMatchingFilters:Be,matchingInstancesPreview:We,isAutoGenerated:As,provisioned:Re},Ca.id)}),La&&(0,n.jsx)(r.$n,{size:"sm",icon:"angle-down",variant:"secondary",className:be.moreButtons,onClick:()=>on(Xt+z),children:(0,n.jsxs)(c.x6,{i18nKey:"alerting.policies.n-more-policies",count:ss,children:[{count:ss}," additional policies"]})})]})}),un&&(0,n.jsx)(k,{onClose:On})]})};function X({numberOfAlertInstances:Qe,isDefaultPolicy:tt,timingOptions:ke,groupBy:He,muteTimings:Re=[],activeTimings:Ne=[],matchingInstancesPreview:Ae,inheritedProperties:Ue,matchingAlertGroups:Be,onShowAlertInstances:We,matchers:_e,contactPoint:Xe,alertManagerSourceName:le,receivers:ye}){const pe=(0,m.of)(Ge),ve=Ue&&Ue.group_by,be=Ue&&Object.keys(Ue).length>0,Oe=(0,s.isArray)(He)&&He[0]==="...",we=!Oe&&(0,s.isArray)(He)&&He.length>0,ze=tt&&(0,s.isArray)(He)&&He.length===0,Ve=!!Re.length,ge=!!Ne.length;return(0,n.jsx)("div",{className:pe.metadataRow,children:(0,n.jsxs)(p.B,{direction:"row",alignItems:"center",gap:1,children:[Ae.enabled&&(0,n.jsxs)(L.P,{icon:"layers-alt",onClick:()=>{Be&&We(Be,_e,(0,j.VE)(le))},"data-testid":"matching-instances",children:[(0,n.jsx)(v.E,{color:"primary",children:Qe??"-"}),(0,n.jsx)("span",{children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.n-instances",count:Qe??0,children:"instance"})})]}),Xe&&(0,n.jsxs)(L.P,{icon:"at","data-testid":"contact-point",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.delivered-to",children:"Delivered to"})," "]}),(0,n.jsx)(Ie,{alertManagerSourceName:le,receivers:ye,contactPoint:Xe})]}),!ve&&(0,n.jsxs)(n.Fragment,{children:[we&&(0,n.jsxs)(L.P,{icon:"layer-group","data-testid":"grouping",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.grouped-by",children:"Grouped by"})," "]}),(0,n.jsx)(v.E,{color:"primary",children:He.join(", ")})]}),ze&&(0,n.jsx)(L.P,{icon:"layer-group",children:(0,n.jsx)("span",{children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.grouping.single-group",children:"Single group"})})}),Oe&&(0,n.jsx)(L.P,{icon:"layer-group",children:(0,n.jsx)("span",{children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.grouping.none",children:"Not grouping"})})})]}),Ve&&(0,n.jsxs)(L.P,{icon:"calendar-slash","data-testid":"mute-timings",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.mute-time",children:"Muted when"})," "]}),(0,n.jsx)(ce,{timings:Re,alertManagerSourceName:le})]}),ge&&(0,n.jsxs)(L.P,{icon:"calendar-alt","data-testid":"active-timings",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.active-time",children:"Active when"})," "]}),(0,n.jsx)(ce,{timings:Ne,alertManagerSourceName:le})]}),ke&&(0,n.jsx)(Pe,{timingOptions:ke}),be&&(0,n.jsxs)(L.P,{icon:"corner-down-right-alt","data-testid":"inherited-properties",children:[(0,n.jsx)("span",{children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.inherited",children:"Inherited"})}),(0,n.jsx)(me,{properties:Ue})]})]})})}const Q=(Qe,tt,ke,He,Re,Ne,Ae)=>{const[[Ue,Be],[We,_e],[Xe,le]]=(0,I.Hl)([I.QI.UpdateNotificationPolicyTree,I.QI.DeleteNotificationPolicy,I.QI.ExportNotificationPolicies]),ye=[],pe=le&&Xe&&tt&&!Qe,ve=Ue&&Be,be=We&&_e&&!tt&&!Qe;return ve&&ye.push((0,n.jsx)(d.Fragment,{children:(0,n.jsx)(D.A,{shouldWrap:ke,wrap:ne,children:(0,n.jsx)(y.W.Item,{icon:"edit",disabled:ke||Qe,label:(0,c.t)("alerting.use-create-dropdown-menu-actions.label-edit","Edit"),onClick:()=>He(Re,tt)})})},"edit-policy")),pe&&ye.push((0,n.jsx)(y.W.Item,{icon:"download-alt",label:(0,c.t)("alerting.use-create-dropdown-menu-actions.label-export","Export"),onClick:Ne},"export-policy")),be&&ye.push((0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(y.W.Divider,{}),(0,n.jsx)(D.A,{shouldWrap:ke,wrap:ne,children:(0,n.jsx)(y.W.Item,{destructive:!0,icon:"trash-alt",disabled:ke||Qe,label:(0,c.t)("alerting.use-create-dropdown-menu-actions.label-delete","Delete"),onClick:()=>Ae(Re)})})]},"delete-policy")),ye},q="__grafana_autogenerated__";function te(Qe){return Qe.object_matchers?Qe.object_matchers.some(tt=>tt[0]===q&&tt[1]===O.ho.equal&&tt[2]==="true")??!1:!1}const ne=Qe=>(0,n.jsx)(x.m,{content:(0,c.t)("alerting.provisioned-tooltip.content-provisioned-items-cannot-edited","Provisioned items cannot be edited in the UI"),placement:"top",children:(0,n.jsx)("span",{children:Qe})}),se=({errors:Qe})=>(0,n.jsx)(N.B,{arrow:!0,placement:"top",content:(0,n.jsx)(p.B,{direction:"column",gap:.5,children:Qe.map(tt=>(0,n.jsx)(d.Fragment,{children:tt},(0,s.uniqueId)()))}),children:(0,n.jsx)("span",{children:(0,n.jsx)(f.E,{icon:"exclamation-circle",color:"red",text:o()("error",Qe.length,!0)})})}),ue=()=>{const Qe=(0,m.of)(Ge);return(0,n.jsx)(x.m,{placement:"top",content:(0,c.t)("alerting.continue-matching-indicator.content-route-continue-matching-other-policies","This route will continue matching other policies"),children:(0,n.jsx)("div",{className:Qe.gutterIcon,"data-testid":"continue-matching",children:(0,n.jsx)(u.I,{name:"arrow-down"})})})},de=()=>{const Qe=(0,m.of)(Ge);return(0,n.jsx)(x.m,{placement:"top",content:(0,c.t)("alerting.all-matches-indicator.content-this-policy-matches-all-labels","This policy matches all labels"),children:(0,n.jsx)("div",{className:Qe.gutterIcon,"data-testid":"matches-all",children:(0,n.jsx)(u.I,{name:"exclamation-triangle"})})})};function ie(){const Qe=(0,m.of)(Ge);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.E,{element:"h2",variant:"body",weight:"medium",children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.default-policy.title",children:"Default policy"})}),(0,n.jsx)("span",{className:Qe.metadata,children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.default-policy.description",children:"All alert instances will be handled by the default policy if no other matching policies are found."})})]})}function he(){return(0,n.jsx)(v.E,{element:"h3",variant:"body",weight:"medium",children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.generated-policies",children:"Auto-generated policies"})})}const me=({properties:Qe})=>(0,n.jsx)(N.B,{arrow:!0,placement:"top",content:(0,n.jsx)(p.B,{direction:"row",gap:.5,children:Object.entries(Qe).map(([tt,ke])=>ke?(0,n.jsx)(M.J,{label:Me(tt),value:Te(tt,ke)},tt):null)}),children:(0,n.jsx)("div",{children:(0,n.jsx)(v.E,{color:"primary",children:o()("property",Object.keys(Qe).length,!0)})})}),ce=({timings:Qe,alertManagerSourceName:tt})=>{const[,ke]=(0,I.L7)(I.QI.ViewTimeInterval);return(0,n.jsx)("div",{children:Qe.map((He,Re)=>{const Ne=ke?b.Y:v.E;return(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(Ne,{href:(0,B.i7)(He,tt),color:ke?"primary":"secondary",variant:"bodySmall",inline:ke?!1:void 0,children:He}),Re<Qe.length-1&&", "]},He)})})},Pe=({timingOptions:Qe})=>{const tt=Qe.group_wait,ke=Qe.group_interval,He=Qe.repeat_interval;if(!tt&&!ke&&!He)return null;const Re=[];return tt&&Re.push((0,n.jsx)(x.m,{placement:"top",content:(0,c.t)("alerting.policies.metadata.timingOptions.groupWait.description","How long to initially wait to send a notification for a group of alert instances."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(c.x6,{i18nKey:"alerting.policies.metadata.timingOptions.groupWait.label",children:["Wait ",(0,n.jsx)(P.S,{content:tt})," to group instances"]})})})),ke&&Re.push((0,n.jsx)(x.m,{placement:"top",content:(0,c.t)("alerting.policies.metadata.timingOptions.groupInterval.description","How long to wait before sending a notification about new alerts that are added to a group of alerts for which an initial notification has already been sent."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(c.x6,{i18nKey:"alerting.policies.metadata.timingOptions.groupInterval.label",children:["Wait ",(0,n.jsx)(P.S,{content:ke})," before sending updates"]})})})),He&&Re.push((0,n.jsx)(x.m,{placement:"top",content:(0,c.t)("alerting.policies.metadata.timingOptions.repeatInterval.description","How often notifications are sent if the group of alerts has not changed since the last notification."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(c.x6,{i18nKey:"alerting.policies.metadata.timingOptions.repeatInterval.label",children:["Repeated every ",(0,n.jsx)(P.S,{content:He})]})})})),(0,n.jsx)(L.P,{icon:"hourglass","data-testid":"timing-options",children:Re.map((Ne,Ae)=>(0,n.jsxs)("span",{children:[Ne,Ae<Re.length-1&&" \xB7 "]},(0,s.uniqueId)()))})},Ie=({alertManagerSourceName:Qe,contactPoint:tt,receivers:ke})=>{const He=ke.find(Ae=>Ae.name===tt);if(!He)return(0,n.jsx)(v.E,{color:"secondary",variant:"bodySmall",children:tt});const Re=He.grafana_managed_receiver_configs,Ne="id"in He&&He.id?(0,B.bg)(He.id,Qe):(0,B.bI)(He.name,Qe);return(0,n.jsx)(N.B,{disabled:!Re,arrow:!0,placement:"top",header:(0,n.jsx)(L.P,{icon:"at",children:(0,n.jsx)(v.E,{color:"primary",children:tt})}),content:(0,n.jsx)(v.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(T.yz,{receivers:He.grafana_managed_receiver_configs||[],limit:3})}),children:(0,n.jsx)(b.Y,{href:Ne,color:"primary",variant:"bodySmall",inline:!1,children:tt})},(0,s.uniqueId)())};function Se(Qe,tt){return Object.entries(tt[Qe]?.notifiers??[]).reduce((Re=[],[Ne,Ae])=>{const Ue=Ae.filter(Be=>Be.lastNotifyAttemptError).map(Be=>(0,n.jsx)(M.J,{icon:"at",label:(0,c.t)("alerting.contact-point-errors.label-contact-point","Contact Point \u203A {{name}}",{name:Be.name}),value:Be.lastNotifyAttemptError},(0,s.uniqueId)()));return Re.concat(Ue)},[])}const Me=Qe=>{switch(Qe){case"receiver":return"Contact Point";case"group_by":return"Group by";case"group_interval":return"Group interval";case"group_wait":return"Group wait";case"repeat_interval":return"Repeat interval";default:return Qe}},Te=(Qe,tt)=>{const ke=Qe==="group_by"&&Array.isArray(tt)&&tt[0]==="...",He=Qe==="group_by"&&Array.isArray(tt)&&tt.length===0;return ke?(0,n.jsx)(v.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.grouping.none",children:"Not grouping"})}):He?(0,n.jsx)(v.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(c.x6,{i18nKey:"alerting.policies.metadata.grouping.single-group",children:"Single group"})}):Array.isArray(tt)?tt.join(", "):tt},Ge=Qe=>({matcher:tt=>{const{color:ke,borderColor:He}=(0,E.MC)(tt);return{wrapper:(0,a.css)({color:"#fff",background:ke,padding:`${Qe.spacing(.33)} ${Qe.spacing(.66)}`,fontSize:Qe.typography.bodySmall.fontSize,border:`solid 1px ${He}`,borderRadius:Qe.shape.radius.default})}},childPolicies:(0,a.css)({marginLeft:Qe.spacing(4),position:"relative","&:before":{content:'""',position:"absolute",height:"calc(100% - 10px)",borderLeft:`solid 1px ${Qe.colors.border.weak}`,marginTop:0,marginLeft:"-20px"}}),policyItemWrapper:(0,a.css)({padding:Qe.spacing(1.5)}),metadataRow:(0,a.css)({borderBottomLeftRadius:Qe.shape.borderRadius(2),borderBottomRightRadius:Qe.shape.borderRadius(2)}),policyWrapper:(tt=!1)=>(0,a.css)({flex:1,position:"relative",background:Qe.colors.background.secondary,borderRadius:Qe.shape.radius.default,border:`solid 1px ${Qe.colors.border.weak}`,...tt&&{borderColor:Qe.colors.primary.border,background:Qe.colors.primary.transparent}}),metadata:(0,a.css)({color:Qe.colors.text.secondary,fontSize:Qe.typography.bodySmall.fontSize,fontWeight:Qe.typography.bodySmall.fontWeight}),break:(0,a.css)({width:"100%",height:0,marginBottom:Qe.spacing(2)}),gutterIcon:(0,a.css)({position:"absolute",top:0,transform:"translateY(50%)",left:`-${Qe.spacing(4)}`,color:Qe.colors.text.secondary,background:Qe.colors.background.primary,width:"25px",height:"25px",textAlign:"center",border:`solid 1px ${Qe.colors.border.weak}`,borderRadius:Qe.shape.radius.default,padding:0}),moreButtons:(0,a.css)({marginTop:Qe.spacing(.5),marginBottom:Qe.spacing(1.5)})})},88114:(Z,R,e)=>{"use strict";e.d(R,{Im:()=>l,nv:()=>s,rw:()=>a});var n=e(11257);const a=[n.w.AlertingRoutesRead],s=[n.w.AlertingRoutesWrite],l=[...a,...s]},46202:(Z,R,e)=>{"use strict";e.d(R,{g0:()=>j,a1:()=>I,yV:()=>P,F:()=>O});var n=e(2543),a=e(47078),s=e.n(a),l=e(84266),o=e(85618),d=e(91984),i=e(80218),c=e(43100),m=e(5709);const p=["RoutingTree"],h=m.H.enhanceEndpoints({addTagTypes:p}).injectEndpoints({endpoints:M=>({listNamespacedRoutingTree:M.query({query:L=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${L.namespace}/routingtrees`,params:{pretty:L.pretty,allowWatchBookmarks:L.allowWatchBookmarks,continue:L.continue,fieldSelector:L.fieldSelector,labelSelector:L.labelSelector,limit:L.limit,resourceVersion:L.resourceVersion,resourceVersionMatch:L.resourceVersionMatch,sendInitialEvents:L.sendInitialEvents,timeoutSeconds:L.timeoutSeconds,watch:L.watch}}),providesTags:["RoutingTree"]}),replaceNamespacedRoutingTree:M.mutation({query:L=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${L.namespace}/routingtrees/${L.name}`,method:"PUT",body:L.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree,params:{pretty:L.pretty,dryRun:L.dryRun,fieldManager:L.fieldManager,fieldValidation:L.fieldValidation}}),invalidatesTags:["RoutingTree"]})}),overrideExisting:!1});var r=e(78045),g=e(42824),y=e(22628),v=e(56476),x=e(48442),f=e(67923);const u=s()(W,{maxSize:1}),{useListNamespacedRoutingTreeQuery:b,useReplaceNamespacedRoutingTreeMutation:E,useLazyListNamespacedRoutingTreeQuery:D}=h,{useGetAlertmanagerConfigurationQuery:C}=d.m,P=({alertmanager:M},{skip:L}={})=>{const A=(0,v.dM)(M),U=b({namespace:(0,o.Ge)()},{skip:L||!A,selectFromResult:V=>({...V,currentData:V.currentData?u(V.currentData.items):void 0,data:V.data?u(V.data.items):void 0})}),F=C(M,{skip:L||A,selectFromResult:V=>({...V,currentData:V.currentData?.alertmanager_config?.route?[T(V.currentData.alertmanager_config.route)]:void 0,data:V.data?.alertmanager_config?.route?[T(V.data.alertmanager_config.route)]:void 0})});return A?U:F},T=s()(M=>({...M,[l.uz]:{provisioned:!!(M.provenance&&M.provenance!==y.rh)}}));function O({alertmanager:M}){const L=(0,v.dM)(M),[A]=E(),[U]=(0,c.d)(),[F]=D(),V=(0,i.Yb)(async G=>{const H=(0,o.Ge)(),_=await F({namespace:H}),[k]=_.data?u(_.data.items):[];if(!k)throw new Error(`no root route found for namespace ${H}`);const J=(0,g.QM)(k),z=(0,f.AB)(M,G,J),Y=N(z);return A({name:y.DM,namespace:H,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,f.HO)(Y)}).unwrap()}),K=(0,i.Yb)(async G=>{const H=(0,r.LY)({update:G,alertmanager:M});return U(H)});return L?V:K}function I({alertmanager:M}){const L=(0,v.dM)(M),[A]=(0,c.d)(),[U]=D(),[F]=E(),V=(0,i.Yb)(async G=>{const H=(0,o.Ge)(),_=await U({namespace:H}),[k]=_.data?u(_.data.items):[];if(!k)throw new Error(`no root route found for namespace ${H}`);const J=(0,g.QM)(k),z=(0,f.AS)(G,J),Y=N(z);return F({name:y.DM,namespace:H,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:Y}).unwrap()}),K=(0,i.Yb)(async G=>{const H=(0,r.Z8)({id:G});return A(H)});return L?V:K}function j({alertmanager:M}){const L=(0,v.dM)(M),[A]=(0,c.d)(),[U]=D(),[F]=E(),V=(0,i.Yb)(async({partialRoute:G,referenceRouteIdentifier:H,insertPosition:_})=>{const k=(0,o.Ge)(),J=await U({namespace:k}),[z]=J.data?u(J.data.items):[];if(!z)throw new Error(`no root route found for namespace ${k}`);const Y=(0,g.QM)(z),X=(0,f.I8)(M??"",G,H,Y,_),Q=N(X);return F({name:y.DM,namespace:k,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,f.HO)(Q)}).unwrap()}),K=(0,i.Yb)(async({partialRoute:G,referenceRouteIdentifier:H,insertPosition:_})=>{const k=(0,r.tD)({partialRoute:G,referenceRouteIdentifier:H,insertPosition:_,alertmanager:M});return A(k)});return L?V:K}function W(M){return M?.map(L=>({...L.spec.defaults,routes:L.spec.routes?.map(S),[l.uz]:{provisioned:(0,v.Uo)(L),resourceVersion:L.metadata.resourceVersion,name:L.metadata.name}}))}function B(M){return Object.values(l.ho).includes(M)}function S(M){return{...M,routes:M.routes?.map(S),matchers:void 0,object_matchers:M.matchers?.map(({label:L,type:A,value:U})=>{if(!B(A))throw new Error(`Invalid matcher operator from API: ${A}`);return[L,A,U]})}}function w(M){const{object_matchers:L,...A}=M;return{...A,receiver:M.receiver??void 0,matchers:L?.map(([U,F,V])=>({label:U,type:F,value:V})),routes:M.routes?.map(w)}}function N(M){const A={...(0,n.pick)(M,x.Rs),receiver:M.receiver??""},U=M.routes?.map(w)??[];return{spec:{defaults:A,routes:U},metadata:{name:y.DM,resourceVersion:M[l.uz]?.resourceVersion}}}},28141:(Z,R,e)=>{"use strict";e.d(R,{k:()=>m,v:()=>i});var n=e(74848),a=e(96540),s=e(92745),l=e(8207),o=e(45861),d=e(17159);const i=({resourceName:p,title:h,onClose:r,...g})=>{const y=(0,s.t)("alerting.manage-permissions.title","Manage permissions");return(0,n.jsx)(l._,{onClose:r,title:h||y,subtitle:p,children:(0,n.jsx)(d.x,{...g,canSetPermissions:!0})})},c=({onClick:p})=>(0,n.jsx)(o.$n,{variant:"secondary",onClick:p,icon:"unlock",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.manage-permissions.button",children:"Manage permissions"})}),m=({resource:p,resourceId:h,resourceName:r,title:g,renderButton:y})=>{const[v,x]=(0,a.useState)(!1),f=()=>x(!1),u=()=>x(!0);return(0,n.jsxs)(n.Fragment,{children:[y?y({onClick:u}):(0,n.jsx)(c,{onClick:u}),v&&(0,n.jsx)(i,{resource:p,resourceId:h,resourceName:r,title:g,onClose:f})]})}},56652:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{AlertmanagerTemplateFunction:()=>a,GomplateFunctions:()=>s,availableAlertManagerFunctions:()=>l,builtinFunctions:()=>d,conf:()=>m,keywords:()=>i,language:()=>c});var n=(p=>(p.Delimiter="delimiter",p.Keyword="keyword",p.Function="type.identifier",p.String="string",p.Variable="variable.name",p.Number="number",p.Comment="comment",p.Operator="operator",p.Identifier="idenfifier",p))(n||{}),a=(p=>(p.toUpper="toUpper",p.toLower="toLower",p.title="title",p.join="join",p.match="match",p.safeHtml="safeHtml",p.reReplaceAll="reReplaceAll",p.stringSlice="stringSlice",p))(a||{});const s={coll:[{keyword:"coll.Dict",definition:"Creates a map with string keys from key/value pairs. All keys are converted to strings. If an odd number of arguments is provided, the last is used as the key with an empty string value.",usage:"function(key string, val any, ...)",example:'{{ coll.Dict "name" "Frank" "age" 42 | data.ToYAML }}'},{keyword:"coll.Slice",definition:"Creates a slice (like an array or list). Useful when needing to range over a bunch of variables.",usage:"function(in ...any)",example:'{{ range coll.Slice "Bart" "Lisa" "Maggie" }}Hello, {{ . }}{{ end }}'},{keyword:"coll.Append",definition:"Appends a value to the end of a list. Creates a new list rather than modifying the input.",usage:"function(value any, list []any)",example:"{{ coll.Slice 1 1 2 3 | append 5 }}"}],data:[{keyword:"data.JSON",definition:"Converts a JSON string into an object. Works for JSON Objects and Arrays.",usage:"function(json string)",example:"{{ ($json | data.JSON).hello }}"},{keyword:"data.ToJSON",definition:"Converts an object to a JSON document.",usage:"function(obj any)",example:'{{ (`{"foo":{"hello":"world"}}` | json).foo | data.ToJSON }}'},{keyword:"data.ToJSONPretty",definition:"Converts an object to a pretty-printed (indented) JSON document.",usage:"function(indent string, obj any)",example:'{{ `{"hello":"world"}` | data.JSON | data.ToJSONPretty "  " }}'}],tmpl:[{keyword:"tmpl.Exec",definition:"Execute (render) the named template. This is equivalent to using the `template` action, except the result is returned as a string. This allows for post-processing of templates.",usage:"function(name string, [context any])",example:'{{ tmpl.Exec "T1" | strings.ToUpper }}'},{keyword:"tmpl.Inline",definition:"Render the given string as a template, just like a nested template. If the template is given a name, it can be re-used later with the `template` keyword. A context can be provided, otherwise the default gomplate context will be used.",usage:"function(partial string, context any)",example:'{{ tmpl.Inline "{{print `hello world`}}" }}'}],time:[{keyword:"time.Now",definition:"Returns the current local time, as a time.Time. This wraps Go's time.Now.",usage:"function()",example:'{{ (time.Now).UTC.Format "Day 2 of month 1 in year 2006 (timezone MST)" }}'}]},l=[...Object.values(a),...Object.keys(s).map(p=>p)],d=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],i=["define","if","else","end","range","break","continue","template","block","with"],c={defaultToken:"",keywords:i,functions:[...d,...l],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},m={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},6135:(Z,R,e)=>{"use strict";e.d(R,{FI:()=>n,J4:()=>a});const n="grafana_alerting";var a=(o=>(o.OnCall="oncall",o))(a||{});const s=(o,d)=>d.includes(o),l=(o,d)=>{if(!o.grafana_managed_receiver_configs)return!1;const i=o.grafana_managed_receiver_configs.length===1,c=s(o.grafana_managed_receiver_configs[0]?.settings?.url??"",d.map(m=>m.integration_url));return i&&c}},53226:(Z,R,e)=>{"use strict";e.d(R,{U0:()=>g,VY:()=>f});var n=e(74848),a=e(1932),s=e(96540),l=e(92745),o=e(68143),d=e(99887),i=e(182),c=e(64762),m=e(77788),p=e(3986),h=e(72930),r=e(6135),g=(u=>(u.NewIntegration="new_oncall_integration",u.ExistingIntegration="existing_oncall_integration",u))(g||{}),y=(u=>(u.IntegrationType="integration_type",u.IntegrationName="integration_name",u))(y||{}),v=(u=>(u.Disabled="disabled",u.V1="v1",u.V2="v2",u))(v||{});function x(){const{installed:u,loading:b,error:E}=(0,p._)((0,i.BO)()),{data:D=[],error:C,isLoading:P}=m.WG.endpoints.features.useQuery(void 0,{skip:!u}),T=(0,s.useMemo)(()=>u?D.includes(m.Pc)?"v2":"v1":"disabled",[u,D]),O=(0,s.useMemo)(()=>T==="v2",[T]);return{isOnCallEnabled:u,integrationStatus:T,isAlertingV2IntegrationEnabled:O,isOnCallStatusLoading:b||P,onCallError:E??C}}function f(){const u=(0,c._2)(),{isOnCallEnabled:b,integrationStatus:E,isAlertingV2IntegrationEnabled:D,isOnCallStatusLoading:C,onCallError:P}=x(),{useCreateIntegrationMutation:T,useGrafanaOnCallIntegrationsQuery:O,useLazyValidateIntegrationNameQuery:I}=m.WG,[j,{isFetching:W}]=I(),[B]=T(),{data:S=[],isLoading:w,isError:N}=O(void 0,{skip:!D}),M=(0,s.useMemo)(()=>({integration_name:async F=>{try{return await j(F).unwrap(),!0}catch(V){if((0,o.NF)(V)&&V.status===409)return(0,l.t)("alerting.irm-integration.integration-name-exists","Integration of this name already exists in IRM");throw u.error((0,l.t)("alerting.irm-integration.validation-failed","Failed to validate IRM integration name. Is the OnCall API available?")),V}},url:F=>D?S.map(V=>V.integration_url).includes(F)?!0:(0,l.t)("alerting.irm-integration.integration-required","Selection of existing IRM integration is required"):!0}),[S,j,D,u]),L=(0,s.useCallback)(F=>D?(0,a.jM)(F,V=>{V.grafana_managed_receiver_configs?.forEach(K=>{K.type===r.J4.OnCall&&(K.settings.integration_type="existing_oncall_integration")})}):F,[D]),A=(0,s.useCallback)(async F=>{if(!D)return F;const G=(F.grafana_managed_receiver_configs?.filter(H=>H.type===r.J4.OnCall)??[]).filter(H=>H.settings.integration_type==="new_oncall_integration").map(async H=>{const _=await B({integration:r.FI,verbal_name:H.settings.integration_name}).unwrap();H.settings.url=_.integration_url});return await Promise.all(G),(0,a.jM)(F,H=>{H.grafana_managed_receiver_configs?.forEach(_=>{_.type===r.J4.OnCall&&(delete _.settings.integration_type,delete _.settings.integration_name)})})},[D,B]),U=(0,s.useCallback)(F=>{if(F.type===r.J4.OnCall&&D){const V=F.options.filter(H=>H.propertyName!=="url"),K={value:"new_oncall_integration",label:(0,l.t)("alerting.irm-integration.new-integration","New IRM integration"),description:(0,l.t)("alerting.irm-integration.new-integration-description","A new IRM integration without escalation chains will be automatically created")},G={value:"existing_oncall_integration",label:(0,l.t)("alerting.irm-integration.existing-integration","Existing IRM integration"),description:(0,l.t)("alerting.irm-integration.existing-integration-description","Use an existing IRM integration")};return V.unshift((0,h.u)("integration_type",(0,l.t)("alerting.irm-integration.connection-method","How to connect to IRM"),"",{required:!0,element:"radio",defaultValue:K,selectOptions:[K,G]}),(0,h.u)("integration_name",(0,l.t)("alerting.irm-integration.integration-name","Integration name"),(0,l.t)("alerting.irm-integration.integration-name-description","The name of the new IRM integration"),{required:!0,showWhen:{field:"integration_type",is:"new_oncall_integration"}}),(0,h.u)("url",(0,l.t)("alerting.irm-integration.integration","IRM Integration"),(0,l.t)("alerting.irm-integration.integration-description","The IRM integration to send alerts to"),{element:"select",required:!0,showWhen:{field:"integration_type",is:"existing_oncall_integration"},selectOptions:S.map(H=>({label:H.display_name,description:H.integration_url,value:H.integration_url}))})),{...F,options:V}}return F},[S,D]);return{integrationStatus:E,onCallNotifierMeta:{enabled:!!b,order:-1,description:b?(0,l.t)("alerting.irm-integration.enabled-description","Seamless way to handle alerts and manage incidents"):(0,l.t)("alerting.irm-integration.disabled-description","Enable IRM through a Webhook integration"),badge:(0,n.jsx)(d.E,{color:"blue",text:(0,l.t)("alerting.irm-integration.recommended","Recommended")})},extendOnCallNotifierFeatures:U,extendOnCallReceivers:L,createOnCallIntegrations:A,onCallFormValidators:M,isLoadingOnCallIntegration:w||C,isValidating:W,hasOnCallError:!!P||N}}},29855:(Z,R,e)=>{"use strict";e.d(R,{G_:()=>E,sb:()=>D});var n=e(74848),a=e(22803),s=e(20382),l=e(96540),o=e(49785),d=e(70713),i=e(92745),c=e(63142),m=e(8207),p=e(54314),h=e(60208),r=e(45861),g=e(45967),y=e(30703),v=e(50992),x=e(89640),f=e(20437),u=e(29609);const b=[{label:"Yaml",value:"yaml"}],E=({onClose:j})=>{const[W,B]=(0,l.useState)("yaml"),{setValue:S}=(0,o.xW)(),w=(0,c.of)(I),N=M=>{for(const L in M)S(L,M[L]);j()};return(0,n.jsx)(m._,{title:(0,i.t)("alerting.rule-inspector.title-inspect-alert-rule","Inspect Alert rule"),subtitle:(0,n.jsx)("div",{className:w.subtitle,children:(0,n.jsx)(D,{tabs:b,setActiveTab:B,activeTab:W})}),onClose:j,children:W==="yaml"&&(0,n.jsx)(C,{onSubmit:N})})};function D({tabs:j,activeTab:W,setActiveTab:B}){return(0,n.jsx)(p.U,{children:j.map((S,w)=>(0,n.jsx)(h.o,{label:S.label,value:S.value,onChangeTab:()=>B(S.value),active:W===S.value},`${S.value}-${w}`))})}const C=({onSubmit:j})=>{const W=(0,c.of)(O),{getValues:B}=(0,o.xW)(),S=(0,f.l1)(B()),[w,N]=(0,l.useState)((0,s.Bh)(S)),M=()=>{const L=(0,s.Hh)(w),A=B(),U=T(L);j({...A,...U})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:W.applyButton,children:[(0,n.jsx)(r.$n,{type:"button",onClick:M,children:(0,n.jsx)(i.x6,{i18nKey:"alerting.inspector-yaml-tab.apply",children:"Apply"})}),(0,n.jsx)(g.m,{content:(0,n.jsx)(P,{}),theme:"info",placement:"left-start",interactive:!0,children:(0,n.jsx)(y.I,{name:"exclamation-triangle",size:"xl"})})]}),(0,n.jsx)("div",{className:W.content,children:(0,n.jsx)(d.Ay,{disableWidth:!0,children:({height:L})=>(0,n.jsx)(v.B,{width:"100%",height:L,language:"yaml",value:w,onBlur:N,monacoOptions:{minimap:{enabled:!1}}})})})]})};function P(){return(0,n.jsx)("div",{children:(0,n.jsxs)(i.x6,{i18nKey:"alerting.yaml-content-info.body",children:["The YAML content in the editor only contains alert rule configuration ",(0,n.jsx)("br",{}),"To configure Prometheus, you need to provide the rest of the"," ",(0,n.jsx)(x.Y,{href:"https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/",external:!0,children:"configuration file content."})]})})}function T(j){return u.p.dataSource.alertingRule(j)?(0,f.Qk)(j):u.p.dataSource.recordingRule(j)?(0,f.XI)(j):{}}const O=j=>({content:(0,a.css)({flexGrow:1,height:"100%",paddingBottom:"16px",marginBottom:j.spacing(2)}),applyButton:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:0,marginBottom:j.spacing(2)})}),I=()=>({subtitle:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between"})})},89144:(Z,R,e)=>{"use strict";e.d(R,{j:()=>h});var n=e(74848),a=e(22803),s=e(70713),l=e(17503),o=e(92745),d=e(63142),i=e(45229),c=e(5929),m=e(51993),p=e(55376);const h=({data:g,thresholds:y,thresholdsType:v})=>{const x=(0,d.of)(r),f=(0,l.jq)(g.series),u=(0,p.yW)(g),b=v?{mode:v}:void 0;return(0,n.jsx)("div",{className:x.wrapper,children:(0,n.jsx)(s.Ay,{disableHeight:!0,children:({width:E})=>(0,n.jsx)("div",{style:{width:E},children:f?(0,n.jsx)(c.y,{statusMessage:u,data:g.series,eventBus:i.A,height:300,width:E,timeRange:g.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:g.state,thresholdsConfig:y,thresholdsStyle:b}):(0,n.jsxs)("div",{className:x.instantVectorResultWrapper,children:[(0,n.jsx)("header",{className:x.title,children:(0,n.jsx)(o.x6,{i18nKey:"alerting.viz-wrapper.table",children:"Table"})}),(0,n.jsx)(m.GX,{series:g.series})]})})})})},r=g=>({wrapper:(0,a.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,a.css)({border:`solid 1px ${g.colors.border.medium}`,borderRadius:g.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,a.css)({label:"panel-title",padding:g.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:g.typography.h6.fontSize,fontWeight:g.typography.h6.fontWeight})})},42970:(Z,R,e)=>{"use strict";e.d(R,{p_:()=>y,qQ:()=>g,vL:()=>d,wz:()=>i});var n=e(2543),a=e.n(n),s=e(68220),l=e(44022),o=e(4651);function d(u){const b=new s.TS,E=[],D=u.map(C=>C.refId);if(b.createNodes(D),u.forEach(C=>{if(!(0,l.f)(C.model))return;const P=C.refId;m(C.model).forEach(O=>{if(P&&O)try{b.link(O,P)}catch(I){E.push({source:P,target:O,error:I})}})}),E.length>0)throw new c("failed to create DAG from queries",{cause:E});return b}function i(u,b=[]){try{return[d(u),b]}catch(E){if(E instanceof c){const D=E.cause;b.push(...D);const C=(0,n.reject)(u,P=>D.some(T=>T.source===P.refId));return i(C,b)}}return[new s.TS,b]}class c extends Error{constructor(b,E){super(b,E),this.cause=E?.cause??[]}}function m(u){const b=u.type===o.Tz.math,E=u.type===o.Tz.classic,D=u.type===o.Tz.sql;return b?p(u.expression??""):E?u.conditions?.map(C=>C.query.params[0])??[]:D?h(u.expression??""):[u.expression]}function p(u){const b=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),E=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),D=Array.from(u.matchAll(b)).map(P=>P.groups?.var),C=Array.from(u.matchAll(E)).map(P=>P.groups?.var);return(0,n.compact)((0,n.uniq)([...D,...C]))}function h(u){if(!u)return[];const C=u.split(`
`).filter(I=>!I.trim().startsWith("--")).join(" ").replace(/\s+/g," ").replace(/\/\*[\s\S]*?\*\//g,""),P=[],T=/from\s+([^;]*?)(?:\s+(?:join|where|group|having|order|limit)|\s*$)/gi;for(const I of C.matchAll(T)){const W=I[1].trim().split(",").map(B=>B.trim());for(const B of W)P.push(r(B))}const O=/join\s+([a-zA-Z0-9_."]+)/gi;for(const I of C.matchAll(O))P.push(r(I[1]));return(0,n.compact)((0,n.uniq)(P))}function r(u){let b=u.replace(/['"]/g,"");return b.includes(" as ")?b=b.split(" as ")[0]:b.includes(" ")&&(b=b.split(" ")[0]),b.includes(".")&&(b=b.split(".").pop()||""),b.trim()}const g=(0,n.memoize)(v,(u,b)=>u+f(b)),y=(0,n.memoize)(x,(u,b)=>u+f(b));function v(u,b){const E=b.getNode(u);if(!E)return[];const D=[];function C(P){const T=P.inputEdges;T.length>0?T.forEach(O=>{O.inputNode&&C(O.inputNode)}):D.push(P)}return C(E),D.map(P=>P.name)}function x(u,b){const E=b.getNode(u);if(!E)return[];const D=[];function C(P){P.outputEdges.forEach(O=>{O.outputNode&&(D.push(O.outputNode),C(O.outputNode))})}return C(E),D.map(P=>P.name)}function f(u){return Object.keys(u.nodes).map(b=>{const E=u.nodes[b],D=E.outputEdges.map(P=>P.outputNode?.name).join(", "),C=E.inputEdges.map(P=>P.inputNode?.name).join(", ");return`${E.name}:${D}:${C}`}).join(" ")}},54513:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>H});var n=e(96540),a=e(28105),s=e(2543),l=e(39741),o=e(62467),d=e(66847),i=e(1005),c=e(81160),m=e(24726),p=e(41119),h=e(47520),r=e(17548),g=e(22592),y=e(77154),v=e(92745),x=e(78282),f=e(36580),u=e(97534),b=e(83873),E=e(44022),D=e(77526),C=e(39050),P=e(42970),T=e(4651);const O={from:21600,to:0},I=(_,k)=>{const J=j(_,k);if(!J)return O;const{from:z,to:Y}=B(J,k);return!z.length&&!Y.length?O:{from:Math.max(...z),to:Math.min(...Y)}},j=(_,k)=>{switch(_.type){case T.Tz.classic:return W(_);case T.Tz.math:case T.Tz.sql:return S(_,k);case T.Tz.resample:case T.Tz.reduce:case T.Tz.threshold:return w(_)}},W=_=>_.conditions?.map(k=>k.query.params[0]),B=(_,k)=>{const J=[],z=[O.to];for(const Y of _){const X=k.find(Q=>Q.refId===Y);!X||!X.relativeTimeRange||(J.push(X.relativeTimeRange.from),z.push(X.relativeTimeRange.to))}return{from:J,to:z}},S=(_,k)=>k.filter(J=>J.queryType==="query"&&_.expression?.includes(J.refId)).map(J=>J.refId),w=_=>_.expression?[_.expression]:void 0;class N{constructor(k=(0,b.AI)(),J=(0,x.l)()){this.backendSrv=k,this.dataSourceSrv=J,this.subject=new l.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(k,J){const z=await this.prepareQueries(k);if(z.length===0)return;const X=z.some(Q=>Q.refId===J)?J:"";this.subscription=M(this.backendSrv,z,X).subscribe({next:Q=>{const q=V(Q,(se,ue)=>{const de=this.lastResult[se],ie=(0,p.N$)(ue,de);return(0,C.B)(ie,de)}),[te,ne]=(0,P.wz)(k);ne.forEach(se=>{q[se.source]=K(se)}),this.lastResult=q,this.subject.next(this.lastResult)},error:Q=>{this.lastResult=F(this.lastResult,Q),this.subject.next(this.lastResult)}})}async prepareQueries(k){const J=[];for(const Q of k){const q=Q.model.refId;if((0,E.f)(Q.model))continue;const te=await this.dataSourceSrv.get(Q.datasourceUid);te instanceof f.iy&&te.filterQuery&&!te.filterQuery(Q.model)&&J.push(q)}const[z]=(0,P.wz)(k),Y=Object.keys(z.nodes);return J.forEach(Q=>{const q=(0,P.p_)(Q,z);J.push(...q)}),k.filter(Q=>!Y.includes(Q.refId)).forEach(Q=>{J.push(Q.refId)}),(0,s.reject)(k,Q=>J.includes(Q.refId))}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let k=!1;const J=V(this.lastResult,(z,Y)=>(Y.state===a.Gu.Loading&&(k=!0),{...Y,state:a.Gu.Done}));k&&this.subject.next(J)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const M=(_,k,J)=>{const z=L(k,a.Gu.Loading),Y={data:{data:k,condition:J},url:"/api/v1/eval",method:"POST",requestId:(0,m.A)()};return(0,h.k)({whileLoading:z,source:_.fetch(Y).pipe(U(z),(0,d.W)(X=>(0,o.of)(F(z,X))),(0,D.N)(_,Y.requestId),(0,i.u)())})},L=(_,k)=>_.reduce((J,z)=>(J[z.refId]={state:k,series:[],timeRange:A(z,_)},J),{}),A=(_,k)=>{if((0,E.f)(_.model)){const J=I(_.model,k);return r.relativeToTimeRange(J)}return _.relativeTimeRange?r.relativeToTimeRange(_.relativeTimeRange):(console.warn(`Query with refId: ${_.refId} did not have any relative time range, using default.`),(0,g.E2)())},U=_=>(0,c.T)(k=>{const{data:J}=k,z={};for(const[Y,X]of Object.entries(J.results)){const{error:Q,status:q,frames:te=[]}=X,ne=Q?[{message:Q,refId:Y,status:q}]:[];z[Y]={errors:ne,timeRange:_[Y].timeRange,state:a.Gu.Done,series:te.map(y.or)}}return z}),F=(_,k)=>{const J=(0,u.u)(k);return V(_,(z,Y)=>Y.state===a.Gu.Error?Y:{...Y,state:a.Gu.Error,error:J})},V=(_,k)=>{const J={};for(const[z,Y]of Object.entries(_))J[z]=k(z,Y);return J},K=_=>({series:[],state:a.Gu.Error,errors:[{message:G(_)}],timeRange:(0,g.E2)()});function G(_){return _.source===_.target?(0,v.t)("alerting.dag.self-reference","You can't link an expression to itself"):(0,v.t)("alerting.dag.missing-reference",'Expression "{{source}}" failed to run because "{{target}}" is missing or also failed.',{source:_.source,target:_.target})}function H(){const[_,k]=(0,n.useState)({}),J=(0,n.useRef)(new N);(0,n.useEffect)(()=>{const q=J.current;return q.get().subscribe(te=>{k(te)}),()=>{q.destroy()}},[]);const z=(0,n.useCallback)(()=>{k({})},[]),Y=(0,n.useCallback)(()=>{J.current.cancel()},[]),X=(0,n.useCallback)((q,te)=>{J.current.run(q,te)},[]),Q=(0,n.useMemo)(()=>Object.values(_).some(q=>q.state===a.Gu.Loading),[_]);return{queryPreviewData:_,runQueries:X,cancelQueries:Y,isPreviewLoading:Q,clearPreviewData:z}}},55376:(Z,R,e)=>{"use strict";e.d(R,{Cl:()=>v,I3:()=>r,YG:()=>C,an:()=>b,lb:()=>f,xb:()=>y,yW:()=>D,yr:()=>u,zy:()=>x});var n=e(2543),a=e.n(n),s=e(17503),l=e(33553),o=e(28105),d=e(739),i=e(65642),c=e(2954),m=e(44022),p=e(4651),h=e(42970);function r(P,T,O){return P.map(I=>{if(T===O||!(0,m.f)(I.model))return I;const j=I.model.type==="math",W=I.model.type==="reduce",B=I.model.type==="resample",S=I.model.type==="classic_conditions",w=I.model.type==="threshold";if(j)return{...I,model:{...I.model,expression:g(I.model.expression??"",T,O)}};if(B||W||w){const N=I.model.expression===T;return{...I,model:{...I.model,expression:N?O:I.model.expression}}}if(S){const N=I.model.conditions?.map(M=>({...M,query:{...M.query,params:M.query.params.map(L=>L===T?O:L)}}));return{...I,model:{...I.model,conditions:N}}}return I})}function g(P,T,O){const I=new RegExp("(\\$"+T+"\\b)|(\\${"+T+"})","gm"),j="${"+O+"}";return P.replace(I,j)}function y(P,T){return P.find(O=>O.refId===T)!==void 0}function v(P){return P.includes("/")||P.includes("\\")}function x(P){if(P.series.length===0)return;const T=(0,s.jq)(P.series);let O;return T&&(O=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),O}function f(P){if(P.errors?.length)return new Error(P.errors[0].message)}function u(P){const O=(P[0]?.meta?.notices??[]).find(I=>I.severity==="warning")?.text;return O?new Error(O):void 0}function b(P,T){const O={},I=[p.Tz.threshold,p.Tz.classic];if(!T)return O;for(const B of P){if(!(0,m.f)(B.model)||!I.includes(B.model.type)||!Array.isArray(B.model.conditions)||B.model.refId!==T)continue;const S=B.model.conditions.some(E);B.model.conditions.forEach(w=>{const N=w.evaluator.params,M=w.query?.params[0]??B.model.expression;if(!M)return;const L=E(w);try{const A=(0,h.vL)(P),U=(0,h.qQ)(M,A);P.filter(V=>U.includes(V.refId)).forEach(V=>{const K=V.refId,H=!!(!(0,m.f)(V?.model)&&K);K&&!O[K]&&(O[K]={config:{mode:l.O.Absolute,steps:[]},mode:d.Ly.Line}),K&&H&&!L&&!S?j(K,N[0]):K&&H&&L&&(W(K,N,w.evaluator.type),O[K].mode=d.Ly.LineAndArea)})}catch(A){console.error("Failed to parse thresholds",A);return}})}function j(B,S){O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S,color:i.$W.theme2.colors.error.main})}function W(B,S,w){w===c.p.IsWithinRange&&O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S[0],color:i.$W.theme2.colors.error.main},{value:S[1],color:i.$W.theme2.colors.error.main},{value:S[1],color:"transparent"}),w===c.p.IsOutsideRange&&O[B].config.steps.push({value:-1/0,color:i.$W.theme2.colors.error.main},{value:S[0],color:i.$W.theme2.colors.error.main},{value:S[0],color:"transparent"},{value:S[1],color:i.$W.theme2.colors.error.main}),w===c.p.IsWithinRangeIncluded&&O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S[0],color:i.$W.theme2.colors.error.main},{value:S[1],color:i.$W.theme2.colors.error.main},{value:S[1],color:"transparent"}),w===c.p.IsOutsideRangeIncluded&&O[B].config.steps.push({value:-1/0,color:i.$W.theme2.colors.error.main},{value:S[0],color:i.$W.theme2.colors.error.main},{value:S[0],color:"transparent"},{value:S[1],color:i.$W.theme2.colors.error.main}),O[B].config.steps.sort((N,M)=>N.value-M.value),O[B].config.steps=O[B].config.steps.filter(N=>N.value!==void 0)}return O}function E(P){return P.evaluator.type===c.p.IsWithinRange||P.evaluator.type===c.p.IsOutsideRange||P.evaluator.type===c.p.IsOutsideRangeIncluded||P.evaluator.type===c.p.IsWithinRangeIncluded}function D(P){const T="Failed to fetch data";if(P.state!==o.Gu.Error)return;const O=P.errors;return O?.length?O.map(I=>I.message??T).join(", "):P.error?.message??T}function C(P,T){const O=T.filter(B=>!(0,m.f)(B.model)).map(B=>B.refId),I=P.filter(B=>!(0,m.f)(B.model)).map(B=>B.refId),[j,W]=(0,n.xor)(I,O);return[j,W]}},94380:(Z,R,e)=>{"use strict";e.d(R,{A:()=>V});var n=e(74848),a=e(32899),s=e(92745),l=e(87063),o=e(88559),d=e(45229),i=e(64762),c=e(70327),m=e(96137),p=e(67598),h=e(80218),r=e(71639);function g(){const[K]=(0,r.D)(),[G]=c.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),H=(0,s.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),_=(0,s.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return(0,h.Yb)(async(k,J,z)=>{const Y=(0,p.Rc)(k),X=(0,m.LH)({uid:J,pause:z}),{newRuleGroupDefinition:Q,rulerConfig:q}=await K(Y,[X]);return G({rulerConfig:q,namespace:k.namespace.uid,payload:Q,notificationOptions:{successMessage:z?H:_}}).unwrap()})}var y=e(77256);const x=({uid:K,isPaused:G,groupIdentifier:H,onPauseChange:_})=>{const k=(0,i._2)(),[J,z]=g(),[Y,X]=G?["play","Resume evaluation"]:["pause","Pause evaluation"],Q=async q=>{try{await J.execute(H,K,q)}catch(te){k.error(`Failed to ${q?"pause":"resume"} the rule: ${(0,y.JZ)(te)}`);return}_?.()};return(0,n.jsx)(l.W.Item,{label:X,icon:Y,disabled:(0,h.VP)(z),onClick:()=>{Q(!G)}})};var f=e(27691),u=e(96540),b=e(54092),E=e(46907),D=e(24619),C=e(29609);function P(K,G){const H=(0,u.useRef)([]),_=T(K,G),{links:k}=(0,E.U)(_);if(!K)return H.current;const J=(0,C.uo)(K),z=K.type;if(!J||!z)return H.current;const{pluginId:Y}=J;return k.filter(X=>X.pluginId===Y)}function T(K,G){return(0,u.useMemo)(()=>{if(!K)return{extensionPointId:""};const H=K.type,{namespace:_,groupName:k}=G,J="uid"in _?_.uid:_.name;switch(H){case D.JS.Alerting:return{extensionPointId:b.S.AlertingAlertingRuleAction,context:{name:K.name,namespace:J,group:k,expression:K.query,labels:K.labels??{},annotations:K.annotations??{}}};case D.JS.Recording:return{extensionPointId:b.S.AlertingRecordingRuleAction,context:{name:K.name,namespace:J,group:k,expression:K.query,labels:K.labels??{}}};default:return{extensionPointId:""}}},[G,K])}var O=e(16692),I=e(94646),j=e(92367),W=e(45967),B=e(3986),S=e(182),w=e(28405);const N=(0,S.Wx)(),M=({title:K="",severity:G="",url:H=""})=>{const _=createBridgeURL(N,"/incidents/declare",{title:K,severity:G,url:H}),{loading:k,installed:J,settings:z}=usePluginBridge(N);return jsxs(Fragment,{children:[k===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})}),J===!1&&jsx(Tooltip,{content:t("alerting.declare-incident-button.content-grafana-incident-installed-configured-correctly","Grafana Incident is not installed or is not configured correctly"),children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})})}),z&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:_,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})})]})},L=({title:K="",severity:G="",url:H=""})=>{const _=(0,w.h)(N,"/incidents/declare",{title:K,severity:G,url:H}),{loading:k,installed:J,settings:z}=(0,B._)(N);return(0,n.jsxs)(n.Fragment,{children:[k===!0&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),icon:"fire",disabled:!0}),J===!1&&(0,n.jsx)(W.m,{content:(0,s.t)("alerting.declare-incident-menu-item.content-grafana-incident-installed-configured-correctly","Grafana Incident is not installed or is not configured correctly"),children:(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),icon:"fire",disabled:!0})}),z&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),url:_,icon:"fire"})]})},A=({promRule:K,rulerRule:G,identifier:H,groupIdentifier:_,handleSilence:k,handleDelete:J,handleDuplicateRule:z,onPauseChange:Y,buttonSize:X,fill:Q})=>{const[q,te,ne,se,ue]=(0,O.Gy)(G,_,[O.j5.Pause,O.j5.Delete,O.j5.Duplicate,O.j5.Silence,O.j5.ModifyExport]),[de,ie,he,me,ce]=(0,O.M6)(C.R$.grafana.rule(K)?K:O.hT,[O.j5.Pause,O.j5.Delete,O.j5.Duplicate,O.j5.Silence,O.j5.ModifyExport]),[Pe,Ie]=q,[Se,Me]=de,Te=Pe&&Ie||Se&&Me,[Ge,Qe]=te,[tt,ke]=ie,He=Ge&&Qe||tt&&ke,[Re,Ne]=ne,[Ae,Ue]=he,Be=Re&&Ne||Ae&&Ue,[We,_e]=se,[Xe,le]=me,ye=We&&_e||Xe&&le,[pe,ve]=ue,[be,Oe]=ce,we=pe&&ve||be&&Oe,ze=P(K,_),Ve=ze.length>0,ge=(!(0,y.y$)()||(0,y.ES)())&&C.R$.alertingRule(K)&&K.state===D.cF.Firing,Ke=(0,y.S2)(H),qe=[Te,ye,ge,Be].some(Boolean)&&[we].some(Boolean),ot=(0,C.xE)(G??K),lt=C.p.grafana.rule(G)&&(0,C.hC)(G)||C.R$.grafana.rule(K)&&K.isPaused,mt=(0,n.jsxs)(n.Fragment,{children:[Te&&ot&&_.groupOrigin==="grafana"&&(0,n.jsx)(x,{uid:ot,isPaused:lt,groupIdentifier:_,onPauseChange:Y}),ye&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.alert-menu.silence-notifications","Silence notifications"),icon:"bell-slash",onClick:k}),ge&&(0,n.jsx)(L,{title:K.name,url:""}),Be&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.alert-menu.duplicate","Duplicate"),icon:"copy",onClick:()=>z(H)}),qe&&(0,n.jsx)(l.W.Divider,{}),Ke&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.alert-menu.copy-link","Copy link"),icon:"share-alt",onClick:()=>F(Ke)}),we&&(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.alert-menu.export","Export"),icon:"download-alt",childItems:[(0,n.jsx)(U,{identifier:H},"export-with-modifications")]}),Ve&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.W.Divider,{}),ze.map(Lt=>(0,n.jsx)(l.W.Item,{label:Lt.title,icon:Lt.icon,onClick:Lt.onClick},Lt.id))]}),He&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.W.Divider,{}),(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.common.delete","Delete"),icon:"trash-alt",destructive:!0,onClick:()=>{(0,C.aw)(H)&&J(H,_)}})]})]});return(0,n.jsx)(o.m,{overlay:(0,n.jsx)(l.W,{children:mt}),placement:"bottom",children:(0,n.jsx)(f.A,{size:X,fill:Q})})},U=({identifier:K})=>{const G=window.location.pathname+window.location.search,H=(0,j.G)(`/alerting/${encodeURIComponent(I.$9(K))}/modify-export`,{returnTo:G});return(0,n.jsx)(l.W.Item,{label:(0,s.t)("alerting.alert-menu.with-modifications","With modifications"),icon:"file-edit-alt",url:H},"with-modifications")};function F(K){navigator.clipboard?.writeText(K).then(()=>{d.A.emit(a.r1.alertSuccess,["URL copied to clipboard"])})}const V=A},87281:(Z,R,e)=>{"use strict";e.d(R,{z:()=>d});var n=e(74848),a=e(70255),s=e(1749),l=e(89640),o=e(77256);const d=({name:c,...m})=>{const{currentData:p,isLoading:h,isSuccess:r}=s.P.endpoints.listReceiver.useQuery({fieldSelector:`spec.title=${c}`}),g=p?.items.at(0)?.metadata.name;return h?i:r&&g?(0,n.jsx)(l.Y,{href:(0,o.vV)(g,{alertmanager:"grafana"}),inline:!1,...m,children:c}):c},i=(0,n.jsx)(a.A,{height:8,width:64})},53567:(Z,R,e)=>{"use strict";e.d(R,{w:()=>y});var n=e(74848),a=e(96540),s=e(92745),l=e(36490),o=e(71599),d=e(8535),i=e(74869),c=e(75756),m=e(80276),p=e(11018),h=e(67598),r=e(29609);const g=(0,i.wS)(),y=(v=!1)=>{const[x,f]=(0,a.useState)(),[u]=(0,c.Y)(),{waitForRemoval:b}=(0,m.IH)(),E=(0,i.f2)(),D=(0,a.useCallback)(()=>{f(void 0)},[]),C=(0,a.useCallback)((O,I)=>{f({ruleIdentifier:O,groupIdentifier:I})},[]),P=(0,a.useCallback)(async()=>{if(!x)return;const{ruleIdentifier:O,groupIdentifier:I}=x,j=(0,h.Rc)(I),W=j.dataSourceName;await u.execute(j,O),(0,d.JD)((0,p.Lc)({rulesSourceName:W})),g&&(0,r.X4)(O)?await b(O):await(0,d.JD)((0,p.eB)({rulesSourceName:W})),D(),v&&l.Ny.replace("/alerting/list")},[u,D,x,v,b]);return[(0,a.useMemo)(()=>(0,n.jsx)(o.u,{isOpen:!!x,title:(0,s.t)("alerting.delete-rule-modal.title","Delete rule"),body:E?(0,s.t)("alerting.delete-rule-modal.with-soft-delete","Are you sure you want to delete this rule? This rule will be recoverable from the Recently deleted page by a user with an admin role."):(0,s.t)("alerting.delete-rule-modal.without-soft-delete","Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?"),confirmText:(0,s.t)("alerting.use-delete-modal.modal.confirmText-yes-delete","Yes, delete"),icon:"exclamation-triangle",onConfirm:P,onDismiss:D}),[x,P,D,E]),C,D]}},41517:(Z,R,e)=>{"use strict";e.d(R,{X:()=>d});var n=e(74848),a=e(92745),s=e(34999),l=e(41654),o=e(45861);function d(){return(0,n.jsx)(s.F,{severity:"info",title:(0,a.t)("alerting.federated-rule-warning.title-federated-group","This rule is part of a federated rule group."),bottomSpacing:0,topSpacing:2,children:(0,n.jsxs)(l.B,{direction:"column",children:[(0,n.jsx)(a.x6,{i18nKey:"alerting.federated-rule-warning.experimental",children:"Federated rule groups are currently an experimental feature."}),(0,n.jsx)(o.$n,{fill:"text",icon:"book",children:(0,n.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:(0,n.jsx)(a.x6,{i18nKey:"alerting.federated-rule-warning.read-documentation",children:"Read documentation"})})})]})})}},54552:(Z,R,e)=>{"use strict";e.d(R,{K:()=>l,k:()=>o});var n=e(74848),a=e(96540);const s=a.createContext(void 0),l=({children:d,rule:i,identifier:c})=>{const m={rule:i,identifier:c};return(0,n.jsx)(s.Provider,{value:m,children:d})},o=()=>{const d=a.useContext(s);if(d===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return d}},22973:(Z,R,e)=>{"use strict";e.d(R,{gQ:()=>on,rf:()=>As,Ay:()=>Fa,lf:()=>ss,P5:()=>La});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(49185),d=e(92745),i=e(41654),c=e(34999),m=e(13941),p=e(63142),h=e(89640),r=e(66404),g=e(45861),y=e(36303),v=e(47327),x=e(70958),f=e(85311),u=e(3969),b=e(86791),E=e(24619),D=e(74268),C=e(28390),P=e(74869),T=e(80218),O=e(44109),I=e(11940),j=e(80276),W=e(39187),B=e(17305),S=e(95443),w=e(52161),N=e(39659),M=e(77256),L=e(29442),A=e(29609),U=e(7840),F=e(36826),V=e(1972),K=e(2401),G=e(88589),H=e(14050),_=e(87281),k=e(41517),J=e(30703);function z(){return(0,n.jsx)(r.E,{variant:"bodySmall",color:"warning",children:(0,n.jsxs)(i.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(J.I,{name:"pause",size:"xs"})," ",(0,n.jsx)(d.x6,{i18nKey:"alerting.paused-badge.paused",children:"Paused"})]})})}var Y=e(54552);const X=({color:xt,includeState:dt})=>{const St=(0,p.of)(Q,{color:xt,includeState:dt});return(0,n.jsx)(i.B,{direction:"row",gap:.5,children:(0,n.jsx)("div",{className:St.dot})})},Q=(xt,dt)=>{const St=xt.spacing(1.25),jt=`calc(${St} / 2.5)`,Qt=dt.color==="error",Jt=dt.color==="success",ln=dt.color==="warning";return{dot:(0,a.css)({width:St,height:St,borderRadius:xt.shape.radius.circle,backgroundColor:xt.colors.secondary.main,outline:`solid ${jt} ${xt.colors.secondary.transparent}`,margin:jt},Jt&&(0,a.css)({backgroundColor:xt.colors.success.main,outlineColor:xt.colors.success.transparent}),ln&&(0,a.css)({backgroundColor:xt.colors.warning.main,outlineColor:xt.colors.warning.transparent}),Qt&&(0,a.css)({backgroundColor:xt.colors.error.main,outlineColor:xt.colors.error.transparent}))}},q=({health:xt})=>{const dt=ss(xt),St=dt?"error":"success",jt=dt?"Recording error":"Recording";return(0,n.jsx)(ne,{color:St,text:jt})},te=({state:xt,health:dt})=>{let St,jt;switch(xt){case E.cF.Inactive:jt="success",St="Normal";break;case E.cF.Firing:jt="error",St="Firing";break;case E.cF.Pending:jt="warning",St="Pending";break;case E.cF.Recovering:jt="warning",St="Recovering";break;case E.cF.Unknown:jt="info",St="Unknown";break}return ss(dt)&&(jt="error",St="Error"),dt==="nodata"&&(jt="warning",St="No data"),(0,n.jsx)(ne,{color:jt,text:St})};function ne({color:xt,text:dt}){return(0,n.jsxs)(i.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(X,{color:xt}),(0,n.jsx)(r.E,{variant:"bodySmall",color:xt,children:dt})]})}var se=e(3845),ue=e(45746),de=e(43173),ie=e(58138);const he=(0,l.lazy)(()=>e.e(2835).then(e.bind(e,32835))),me=(0,l.lazy)(()=>Promise.all([e.e(8706),e.e(4302)]).then(e.bind(e,54302))),ce=({rule:xt})=>{const dt=de.$.unifiedAlerting.alertStateHistoryBackend,St=de.$.unifiedAlerting.alertStateHistoryPrimary,Qt=[dt,St].some(ln=>ln===ie.Q.Loki)?ie.Q.Loki:ie.Q.Annotations,Jt=xt.grafana_alert.uid;return(0,n.jsxs)(l.Suspense,{fallback:"Loading...",children:[Qt===ie.Q.Loki&&(0,n.jsx)(me,{ruleUID:Jt}),Qt===ie.Q.Annotations&&(0,n.jsx)(he,{ruleUID:Jt})]})};var Pe=e(95943),Ie=e(66773);const Se=({rule:xt})=>(0,n.jsx)(Ie.s,{rule:xt,pagination:{itemsPerPage:Pe.FG},enableFiltering:!0});var Me=e(17548),Te=e(83175),Ge=e(27074),Qe=e(99887),tt=e(44022),ke=e(4651),He=e(2954),Re=e(49779),Ne=e(51993),Ae=e(55376),Ue=e(89144);function Be({data:xt,thresholds:dt}){return xt?(0,n.jsx)(Ue.j,{data:xt,thresholds:dt?.config,thresholdsType:dt?.mode}):null}var We=e(20382),_e=e(20437),Xe=e(65232);const le=({expression:xt})=>(0,n.jsx)(Xe.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:xt,width:"100%"});function ye(xt){return"rawSql"in xt}const pe=null,ve=l.lazy(()=>e.e(3659).then(e.bind(e,33659))),be=l.lazy(()=>e.e(4964).then(e.bind(e,24964)));function Oe({model:xt,dataSource:dt}){return(0,w.bS)(dt.type)&&(0,_e.Bu)(xt)?(0,n.jsx)(ve,{query:xt.expr}):dt.type===w.ol.Loki&&(0,_e.Bu)(xt)?(0,n.jsx)(be,{query:xt.expr??""}):ye(xt)?(0,n.jsx)(le,{expression:xt.rawSql}):(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:(0,We.Bh)(xt)})})}var we=e(16692);function ze({rule:xt,queries:dt,condition:St,evalDataByQuery:jt={}}){const Qt=(0,s.keyBy)(Object.values(de.$.datasources),vn=>vn.uid),Jt=dt.filter(vn=>!(0,tt.f)(vn.model)),ln=dt.filter(vn=>(0,tt.f)(vn.model)),fn=(0,p.of)(un),gn=(0,Ae.an)(dt,St);return(0,n.jsxs)(i.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,n.jsx)("div",{className:fn.maxWidthContainer,children:(0,n.jsx)(i.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:Jt.map(({model:vn,relativeTimeRange:wn,refId:Rt,datasourceUid:bt},Vt)=>{const Kt=Qt[bt];return(0,n.jsx)(Ve,{rule:xt,refId:Rt,model:vn,relativeTimeRange:wn,dataSource:Kt,thresholds:gn[Rt],queryData:jt[Rt]},Vt)})})}),(0,n.jsx)("div",{className:fn.maxWidthContainer,children:(0,n.jsx)(i.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:ln.map(({model:vn,refId:wn,datasourceUid:Rt},bt)=>(0,tt.f)(vn)&&(0,n.jsx)(ot,{refId:wn,isAlertCondition:St===wn,model:vn,evalData:jt[wn]},bt))})})]})}function Ve({refId:xt,rule:dt,thresholds:St,model:jt,dataSource:Qt,queryData:Jt,relativeTimeRange:ln}){const fn=(0,p.of)(qe),gn=(0,tt.f)(jt),[vn,wn]=(0,we.mh)(dt,we.j5.Explore),Rt=vn&&wn,bt=[];if(Qt){const Kt=Qt.name??"[[Data source not found]]",Dt=Qt.meta.info.logos.small;bt.push((0,n.jsx)(Ke,{name:Kt,imgUrl:Dt},"datasource"))}ln&&bt.push((0,n.jsx)(r.E,{color:"secondary",children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.query-preview.relative-time-range",values:{from:Me.secondsToHms(ln.from)},children:[(0,n.jsx)("code",{children:"{{from}}"})," to now"]})},"timerange"));let Vt;return!gn&&Rt&&(Vt=Qt&&ge(Qt,jt)),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lt,{refId:xt,headerItems:bt,exploreLink:Vt,children:(0,n.jsx)("div",{className:fn.queryPreviewWrapper,children:(0,n.jsx)(y.Xw,{children:jt&&Qt&&(0,n.jsx)(Oe,{model:jt,dataSource:Qt})})})}),Qt&&(0,n.jsx)(Be,{data:Jt,thresholds:St})]})}function ge(xt,dt){const{uid:St,type:jt}=xt,{refId:Qt,...Jt}=dt;return Te.kM.renderUrl(`${de.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:xt.uid,queries:[{refId:"A",...Jt,datasource:{type:jt,uid:St}}],range:{from:"now-1h",to:"now"}})})}function Ke({name:xt,imgUrl:dt}){const St=(0,p.of)(qe);return(0,n.jsxs)("div",{className:St.dataSource,children:[(0,n.jsx)("img",{src:dt,width:16,alt:xt}),xt]},"datasource")}const qe=xt=>({queryPreviewWrapper:(0,a.css)({margin:xt.spacing(1)}),contentBox:(0,a.css)({flex:"1 0 100%"}),dataSource:(0,a.css)({border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default,padding:xt.spacing(.5,1),display:"flex",alignItems:"center",gap:xt.spacing(1)})});function ot({refId:xt,model:dt,evalData:St,isAlertCondition:jt}){const Qt=(0,p.of)(mt);function Jt(){switch(dt.type){case ke.Tz.math:return(0,n.jsx)(On,{model:dt});case ke.Tz.reduce:return(0,n.jsx)(It,{model:dt});case ke.Tz.resample:return(0,n.jsx)(Ut,{model:dt});case ke.Tz.classic:return(0,n.jsx)(Lt,{model:dt});case ke.Tz.threshold:return(0,n.jsx)(cn,{model:dt});case ke.Tz.sql:return(0,n.jsx)(Ge.l,{rawSql:dt.expression||"",datasourceType:dt.datasource?.type});default:return(0,n.jsxs)(d.x6,{i18nKey:"alerting.expression-preview.expression-not-supported",values:{type:dt.type},children:["Expression not supported: ","{{type}}"]})}}return(0,n.jsxs)(lt,{refId:xt,headerItems:[(0,n.jsx)(r.E,{color:"secondary",children:(0,s.startCase)(dt.type)},"expression-type")],isAlertCondition:jt,children:[(0,n.jsxs)("div",{className:Qt.previewWrapper,children:[St?.errors?.map(ln=>(0,n.jsx)(c.F,{title:(0,d.t)("alerting.expression-preview.title-expression-failed","Expression failed"),severity:"error",bottomSpacing:1,children:ln.message},(0,s.uniqueId)())),Jt()]}),(0,n.jsx)(Re.h,{}),St&&(0,n.jsx)(Ne.GX,{series:St.series,isAlertCondition:jt})]})}function lt({refId:xt,headerItems:dt=[],children:St,isAlertCondition:jt,exploreLink:Qt}){const Jt=(0,p.of)(mt);return(0,n.jsxs)("div",{className:(0,a.cx)(Jt.container),children:[(0,n.jsxs)("header",{className:Jt.header,children:[(0,n.jsx)("span",{className:Jt.refId,children:xt}),dt,(0,n.jsx)(Re.h,{}),jt&&(0,n.jsx)(Qe.E,{color:"green",icon:"check",text:(0,d.t)("alerting.query-box.text-alert-condition","Alert condition")}),Qt&&(0,n.jsx)(K.d,{component:(0,n.jsx)(g.z9,{size:"md",variant:"secondary",icon:"compass",href:Qt,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.query-box.view-in-explore",children:"View in Explore"})})})]}),St]})}const mt=xt=>({container:(0,a.css)({flex:"1 0 25%",border:`1px solid ${xt.colors.border.weak}`,maxWidth:"100%",borderRadius:xt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,a.css)({display:"flex",alignItems:"center",gap:xt.spacing(1),padding:xt.spacing(1),backgroundColor:xt.colors.background.secondary}),textBlock:(0,a.css)({border:`1px solid ${xt.colors.border.weak}`,padding:xt.spacing(.5,1),backgroundColor:xt.colors.background.primary,borderRadius:xt.shape.radius.default}),refId:(0,a.css)({color:xt.colors.text.link,padding:xt.spacing(.5,1),border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default}),previewWrapper:(0,a.css)({padding:xt.spacing(1)})});function Lt({model:xt}){const dt=(0,p.of)(Tt),St=(0,s.keyBy)(He.A.reducerTypes,Jt=>Jt.value),jt=(0,s.keyBy)(He.A.evalOperators,Jt=>Jt.value),Qt=(0,s.keyBy)(He.A.evalFunctions,Jt=>Jt.value);return(0,n.jsx)("div",{className:dt.container,children:xt.conditions?.map(({query:Jt,operator:ln,reducer:fn,evaluator:gn},vn)=>{const wn=En(gn);return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:vn===0?(0,d.t)("alerting.classic-condition-viewer.when","WHEN"):!!ln?.type&&jt[ln?.type]?.text}),(0,n.jsx)("div",{className:dt.bold,children:fn?.type&&St[fn.type]?.text}),(0,n.jsx)("div",{className:dt.blue,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.classic-condition-viewer.of",children:"OF"})}),(0,n.jsx)("div",{className:dt.bold,children:Jt.params[0]}),(0,n.jsx)("div",{className:dt.blue,children:Qt[gn.type].text}),(0,n.jsx)("div",{className:dt.bold,children:wn?`(${gn.params[0]}; ${gn.params[1]})`:gn.params[0]})]},vn)})})}const Tt=xt=>({container:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:xt.spacing(0,1)}),...yn(xt)});function It({model:xt}){const dt=(0,p.of)(Mt),{reducer:St,expression:jt,settings:Qt}=xt,Jt=ke.Cu.find(gn=>gn.value===St),ln=Qt?.mode??ke.Mt.Strict,fn=ke.HZ.find(gn=>gn.value===ln);return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.reduce-condition-viewer.function",children:"Function"})}),(0,n.jsx)("div",{className:dt.value,children:Jt?.label}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.reduce-condition-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:jt}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.reduce-condition-viewer.mode",children:"Mode"})}),(0,n.jsx)("div",{className:dt.value,children:fn?.label})]})}const Mt=xt=>({container:(0,a.css)({display:"grid",gap:xt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...yn(xt)});function Ut({model:xt}){const dt=(0,p.of)(an),{expression:St,window:jt,downsampler:Qt,upsampler:Jt}=xt,ln=ke.PN.find(gn=>gn.value===Qt),fn=ke.iX.find(gn=>gn.value===Jt);return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.resample-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:St}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.resample-expression-viewer.resample-to",children:"Resample to"})}),(0,n.jsx)("div",{className:dt.value,children:jt}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.resample-expression-viewer.downsample",children:"Downsample"})}),(0,n.jsx)("div",{className:dt.value,children:ln?.label}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.resample-expression-viewer.upsample",children:"Upsample"})}),(0,n.jsx)("div",{className:dt.value,children:fn?.label})]})}const an=xt=>({container:(0,a.css)({display:"grid",gap:xt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...yn(xt)});function cn({model:xt}){const dt=(0,p.of)(un),{expression:St,conditions:jt}=xt,Qt=jt&&jt[0]?.evaluator,Jt=ke.zd.find(wn=>wn.value===Qt?.type),ln=Qt?En(Qt):!1,fn=jt&&jt[0]?.unloadEvaluator,gn=ke.zd.find(wn=>wn.value===fn?.type),vn=fn?En(fn):!1;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.threshold-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:St}),Qt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:Jt?.label}),(0,n.jsx)("div",{className:dt.bold,children:ln?`(${Qt.params[0]}; ${Qt.params[1]})`:Qt.params[0]})]})]}),(0,n.jsx)("div",{className:dt.container,children:fn&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.threshold-expression-viewer.stop-alerting-when",children:["Stop alerting (or pending state) when"," "]})}),(0,n.jsx)("div",{className:dt.value,children:St}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:gn?.label}),(0,n.jsx)("div",{className:dt.bold,children:vn?`(${fn.params[0]}; ${fn.params[1]})`:fn.params[0]})]})]})})]})}const un=xt=>{const{blue:dt,bold:St,...jt}=yn(xt);return{...jt,maxWidthContainer:(0,a.css)({maxWidth:"100%"}),container:(0,a.css)({display:"flex",gap:xt.spacing(.5)}),blue:(0,a.css)(dt,{margin:"auto 0"}),bold:(0,a.css)(St,{margin:"auto 0"})}};function On({model:xt}){const dt=(0,p.of)(un),{expression:St}=xt;return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.math-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:St})]})}const yn=xt=>({blue:(0,a.css)({color:xt.colors.text.link}),bold:(0,a.css)({fontWeight:xt.typography.fontWeightBold}),label:(0,a.css)({display:"flex",alignItems:"center",padding:xt.spacing(.5,1),backgroundColor:xt.colors.background.secondary,fontSize:xt.typography.bodySmall.fontSize,lineHeight:xt.typography.bodySmall.lineHeight,fontWeight:xt.typography.fontWeightBold,borderRadius:xt.shape.radius.default}),value:(0,a.css)({padding:xt.spacing(.5,1),border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default})});function En(xt){return xt.type===He.p.IsWithinRange||xt.type===He.p.IsOutsideRange||xt.type===He.p.IsOutsideRangeIncluded||xt.type===He.p.IsWithinRangeIncluded}var Bn=e(55096),fa=e(1932),Fn=e(15629);function Ea(xt){if(!xt)return[];const{namespace:dt,rulerRule:St}=xt,{rulesSource:jt}=dt;if(A.p.grafana.rule(St)){const Qt=St.grafana_alert.data;return gt(Qt,St.for??"",xt.group.interval)}if((0,w.Eb)(jt)){const Qt=wt(jt,xt);return[Ht(Qt,jt.uid)]}return[]}function gt(xt,dt,St){const jt=(0,Fn.P8)(dt)??(0,Fn.P8)(St??"1m"),Qt=Math.floor(jt/1e3);return xt.map(Jt=>(0,fa.jM)(Jt,ln=>{const fn=ln.relativeTimeRange?.from??0,gn=Math.max(Qt*3,fn+Qt*2);ln.relativeTimeRange={from:gn,to:0}}))}function Ht(xt,dt){return{refId:xt.refId,datasourceUid:dt,queryType:"",model:xt,relativeTimeRange:{from:360,to:0}}}function wt(xt,dt){if(!(0,w.cl)(xt.type))throw new Error(`Query for datasource type ${xt.type} is currently not supported by cloud alert rules.`);return{refId:"A",expr:dt.query}}var Yt=e(54513);const rn=({rule:xt})=>{const{queryPreviewData:dt,runQueries:St,isPreviewLoading:jt}=(0,Yt.Y)(),Qt=(0,l.useMemo)(()=>Ea(xt),[xt]),{allDataSourcesAvailable:Jt}=(0,Bn.g)(Qt),ln=(0,l.useCallback)(()=>{if(Qt.length>0&&Jt){let gn;xt&&A.p.grafana.rule(xt.rulerRule)&&(gn=xt.rulerRule.grafana_alert.condition),St(Qt,gn??"A")}},[Qt,Jt,xt,St]);(0,l.useEffect)(()=>{Jt&&ln()},[Jt,ln]);const fn=(0,A.YN)(xt.group);return jt?(0,n.jsx)(d.x6,{i18nKey:"alerting.common.loading",children:"Loading..."}):(0,n.jsxs)(n.Fragment,{children:[A.p.grafana.rule(xt.rulerRule)&&!fn&&(0,n.jsx)(ze,{rule:xt,condition:xt.rulerRule.grafana_alert.condition,queries:Qt,evalDataByQuery:dt}),!A.p.grafana.rule(xt.rulerRule)&&!fn&&dt&&Object.keys(dt).length>0&&(0,n.jsx)(i.B,{direction:"column",gap:1,children:Qt.map(gn=>(0,n.jsx)(Ve,{rule:xt,refId:gn.refId,model:gn.model,dataSource:Object.values(de.$.datasources).find(vn=>vn.uid===gn.datasourceUid),queryData:dt[gn.refId],relativeTimeRange:gn.relativeTimeRange},gn.refId))}),!fn&&!Jt&&(0,n.jsx)(c.F,{title:(0,d.t)("alerting.rule-view.query.datasources-na.title","Query not available"),severity:"warning",children:(0,n.jsx)(d.x6,{i18nKey:"alerting.rule-view.query.datasources-na.description",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})})]})},Xt=()=>(0,n.jsx)(d.x6,{i18nKey:"alerting.routing.routing",children:"Routing"});var on=(xt=>(xt.Query="query",xt.Instances="instances",xt.History="history",xt.Routing="routing",xt.Details="details",xt.VersionHistory="version-history",xt))(on||{});const pn=(0,P.wS)(),Un=(0,P.sk)(),In=pn||Un,Gn=()=>{const{rule:xt,identifier:dt}=(0,Y.k)(),{pageNav:St,activeTab:jt}=Ka(xt),[Qt,Jt]=(0,l.useState)(),{returnTo:ln}=(0,W.h)("/alerting/list"),{annotations:fn,promRule:gn,rulerRule:vn}=xt,wn=ss(gn?.health),Rt=(0,A.YN)(xt.group),bt=A.p.grafana.rule(vn)&&!!vn.grafana_alert.provenance,Vt=A.p.grafana.rule(vn)&&(0,A.hC)(vn),Kt=wn&&!Vt,Dt=vn?(0,A.uo)(vn):(0,A.uo)(gn),Zt=fn[S.YH.summary];return(0,n.jsxs)(F.d,{pageNav:St,navId:"alert-list",isLoading:!1,renderTitle:Ln=>(0,n.jsx)(za,{name:Ln,paused:Vt,state:A.R$.alertingRule(gn)?gn.state:void 0,health:gn?.health,ruleType:gn?.type,ruleOrigin:Dt,returnToHref:ln}),actions:(0,n.jsx)(u.l,{rule:xt,rulesSource:xt.namespace.rulesSource}),info:Wa(xt),subTitle:(0,n.jsxs)(i.B,{direction:"column",children:[Zt,Vt&&(0,n.jsx)(f.A,{}),Rt&&(0,n.jsx)(k.X,{}),bt&&(0,n.jsx)(V.Yi,{resource:V.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Kt&&(0,n.jsx)(c.F,{title:(0,d.t)("alerting.rule-viewer.title-something-wrong-evaluating-alert","Something went wrong when evaluating this alert rule"),bottomSpacing:0,topSpacing:2,children:(0,n.jsx)("pre",{style:{marginBottom:0},children:(0,n.jsx)("code",{children:xt.promRule?.lastError??"No error message"})})})]}),children:[In&&(0,n.jsx)(Oa,{ruleIdentifier:dt}),(0,n.jsx)(i.B,{direction:"column",gap:2,children:(0,n.jsxs)(m.J,{children:[jt==="query"&&(0,n.jsx)(rn,{rule:xt}),jt==="instances"&&(0,n.jsx)(Se,{rule:xt}),jt==="history"&&A.p.grafana.rule(xt.rulerRule)&&(0,n.jsx)(ce,{rule:xt.rulerRule}),jt==="routing"&&(0,n.jsx)(Xt,{}),jt==="details"&&(0,n.jsx)(ue.B,{rule:xt}),jt==="version-history"&&A.p.grafana.rule(xt.rulerRule)&&(0,n.jsx)(se.f,{rule:xt.rulerRule})]})}),Qt&&(0,n.jsx)(H.Z,{redirectTo:!0,identifier:Qt,isProvisioned:bt,onDismiss:()=>Jt(void 0)})]})},Wa=xt=>{const{labels:dt,annotations:St,group:jt,rulerRule:Qt}=xt,Jt=[],ln=St[S.YH.runbookURL],fn=St[S.YH.dashboardUID],gn=St[S.YH.panelID],vn=fn&&gn,wn=fn,Rt=(0,N.rm)(dt)>0,bt=jt.interval,Vt=(0,p.of)(Ia);if(A.p.grafana.alertingRule(Qt)){const Kt=Qt.grafana_alert.notification_settings?.receiver;Kt&&Jt.push({label:(0,d.t)("alerting.create-metadata.label.contact-point","Notifications are delivered to"),value:(0,n.jsx)(_.z,{name:Kt,variant:"bodySmall"})})}if(ln){const Kt=(0,s.truncate)(ln,{length:42}),Dt=_s(ln)?(0,n.jsx)(h.Y,{variant:"bodySmall",className:Vt.url,href:ln,external:!0,children:Kt}):(0,n.jsx)(r.E,{variant:"bodySmall",children:Kt});Jt.push({label:(0,d.t)("alerting.create-metadata.label.runbook-url","Runbook URL"),value:Dt})}if(vn?Jt.push({label:(0,d.t)("alerting.create-metadata.label.dashboard-and-panel","Dashboard and panel"),value:(0,n.jsx)(K.d,{title:xt.name,component:(0,n.jsx)(h.Y,{variant:"bodySmall",href:(0,M.D2)(fn,gn),children:(0,n.jsx)(d.x6,{i18nKey:"alerting.create-metadata.view-panel",children:"View panel"})})})}):wn&&Jt.push({label:(0,d.t)("alerting.create-metadata.label.dashboard","Dashboard"),value:(0,n.jsx)(K.d,{title:xt.name,component:(0,n.jsx)(h.Y,{title:xt.name,variant:"bodySmall",href:(0,M.JM)(fn),children:(0,n.jsx)(d.x6,{i18nKey:"alerting.create-metadata.view-dashboard",children:"View dashboard"})})})}),A.p.grafana.recordingRule(xt.rulerRule)){const Kt=xt.rulerRule?.grafana_alert.record?.metric??"";Jt.push({label:(0,d.t)("alerting.create-metadata.label.metric-name","Metric name"),value:(0,n.jsx)(r.E,{color:"primary",children:Kt})})}return bt&&Jt.push({label:(0,d.t)("alerting.create-metadata.label.evaluation-interval","Evaluation interval"),value:(0,n.jsx)(r.E,{color:"primary",children:(0,n.jsxs)(d.x6,{i18nKey:"alerting.rule-viewer.evaluation-interval",children:["Every ",{interval:bt}]})})}),Rt&&Jt.push({label:(0,d.t)("alerting.create-metadata.label.labels","Labels"),value:(0,n.jsx)(U.m,{labels:dt,size:"sm"})}),Jt},za=({name:xt,paused:dt=!1,state:St,health:jt,ruleType:Qt,ruleOrigin:Jt,returnToHref:ln=""})=>{const fn=Qt===E.JS.Recording,{returnTo:gn}=(0,W.h)(ln);return(0,n.jsxs)(i.B,{direction:"row",gap:1,minWidth:0,alignItems:"center",children:[ln&&(0,n.jsx)(g.z9,{variant:"secondary",icon:"angle-left",href:gn}),Jt&&(0,n.jsx)(B.T,{pluginId:Jt.pluginId,size:"lg"}),(0,n.jsx)(r.E,{variant:"h1",truncate:!0,children:xt}),dt?(0,n.jsx)(z,{}):(0,n.jsxs)(n.Fragment,{children:[St&&(0,n.jsx)(te,{state:St,health:jt}),fn&&(0,n.jsx)(q,{health:jt})]})]})},Oa=(0,y.Xc)(({ruleIdentifier:xt})=>{const[dt,{width:St}]=(0,o.A)(),{hasRuler:jt}=(0,I.w)((0,w.bt)(xt)),{result:Qt}=(0,O.FY)(xt),{waitForGroupConsistency:Jt,groupConsistent:ln}=(0,j.zx)(),[fn,gn]=(0,T.Yb)(vn=>Jt(vn));return(0,l.useEffect)(()=>{Qt&&jt&&fn.execute(Qt.groupIdentifier)},[Qt,jt,fn]),(0,T.bJ)(gn)?(0,n.jsx)(c.F,{title:(0,d.t)("alerting.prometheus-consistency-check.title-unable-to-check-the-rule-status","Unable to check the rule status"),bottomSpacing:0,topSpacing:2,children:(0,M.JZ)(gn.error)}):ln===!1?(0,n.jsxs)(i.B,{direction:"column",gap:0,ref:dt,children:[(0,n.jsx)(v.G,{width:St}),(0,n.jsx)(c.F,{title:(0,d.t)("alerting.rule-viewer.prometheus-consistency-check.alert-title","Update in progress"),severity:"info",children:(0,n.jsx)(d.x6,{i18nKey:"alerting.rule-viewer.prometheus-consistency-check.alert-message",children:"Alert rule has been added or updated. Changes may take up to a minute to appear on the Alert rules list view."})})]}):null},{errorLogger:D.vV}),ss=xt=>xt==="error"||xt==="err";function La(){const[xt,dt]=(0,x.s)(),St=xt.tab;return[Ca(St)?St:"query",Jt=>{dt({tab:Jt})}]}function Ca(xt){return typeof xt=="string"&&Object.values(on).includes(xt)}function Ka(xt){const[dt,St]=La(),{annotations:jt,promRule:Qt,rulerRule:Jt}=xt,ln=jt[S.YH.summary],gn=A.R$.alertingRule(Qt)?As(xt.instanceTotals):void 0,vn=(0,G.EL)(xt.namespace).name,wn=xt.group.name,Rt=A.p.grafana.alertingRule(Jt),bt=A.p.grafana.recordingRule(Jt),Vt=A.R$.recordingRule(Qt);return{pageNav:{...C.defaultPageNav,text:xt.name,subTitle:ln,children:[{text:(0,d.t)("alerting.use-page-nav.page-nav.text.query-and-conditions","Query and conditions"),active:dt==="query",onClick:()=>{St("query")}},{text:(0,d.t)("alerting.use-page-nav.page-nav.text.instances","Instances"),active:dt==="instances",onClick:()=>{St("instances")},tabCounter:gn,hideFromTabs:Vt},{text:(0,d.t)("alerting.use-page-nav.page-nav.text.history","History"),active:dt==="history",onClick:()=>{St("history")},hideFromTabs:!Rt},{text:(0,d.t)("alerting.use-page-nav.page-nav.text.details","Details"),active:dt==="details",onClick:()=>{St("details")}},{text:(0,d.t)("alerting.use-page-nav.page-nav.text.versions","Versions"),active:dt==="version-history",onClick:()=>{St("version-history")},hideFromTabs:!Rt&&!bt}],parentItem:{text:wn,url:(0,L.tx)([["namespace",vn],["group",wn]]),parentItem:{text:vn,url:(0,L.tx)([["namespace",vn]])}}},activeTab:dt}}const As=xt=>(0,s.chain)(xt).pick([b.$7.Alerting,b.$7.Pending,b.$7.Recovering,b.$7.Normal,b.$7.NoData,b.$7.Error]).values().sum().value(),Ia=()=>({url:(0,a.css)({wordBreak:"break-all"})});function _s(xt){const dt=xt.startsWith("/");let St=!1;try{new URL(xt),St=!0}catch{return!1}return dt||St}const Fa=Gn},3845:(Z,R,e)=>{"use strict";e.d(R,{f:()=>te,R:()=>q});var n=e(74848),a=e(96540),s=e(92745),l=e(43173),o=e(34999),d=e(6975),i=e(50201),c=e(41654),m=e(66404),p=e(45967),h=e(45861),r=e(74268),g=e(70327),y=e(16692),v=e(52161),x=e(77256),f=e(8207),u=e(2543),b=e(80011),E=e(31286),D=e(30703),C=e(3271),P=e(34753),T=e(1199),O=e(61371);const I=({info:ne})=>{const{createdAt:se,createdBy:ue,version:de,message:ie=""}=ne,he=(0,b.fq)(se);return(0,n.jsxs)(s.x6,{i18nKey:"core.versionHistory.comparison.header.text",children:["Version ",{version:de}," updated by ",{createdBy:ue}," (",{ageString:he},") ",{message:ie}]})},j=({oldSummary:ne,newSummary:se,oldVersion:ue,newVersion:de,preprocessVersion:ie=u.identity,showRestoreButton:he=!1,onRestore:me})=>{const ce=(0,O.G4)(ie(ue),ie(de)),Pe=Object.entries(ce).length===0,[Ie,Se]=(0,a.useState)(Pe);return(0,n.jsxs)(c.B,{gap:2,direction:"column",children:[(0,n.jsx)(E.a,{children:(0,n.jsxs)(m.E,{variant:"h5",element:"h4",children:[(0,n.jsx)(I,{info:ne}),(0,n.jsx)(D.I,{name:"arrow-right"}),(0,n.jsx)(I,{info:se})]})}),(0,n.jsxs)(E.a,{children:[Pe&&(0,n.jsx)(i.p,{message:(0,s.t)("core.versionHistory.no-properties-changed","No relevant properties changed"),variant:"not-found",hideImage:!0,children:(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.view-json-diff",children:"View JSON diff to see all changes"})}),Object.entries(ce).map(([Me,Te])=>(0,n.jsx)(P.D,{diffs:Te,title:Me},Me)),(0,n.jsx)(C.c,{})]}),(0,n.jsxs)(c.B,{gap:2,direction:"row",justifyContent:"space-between",children:[(0,n.jsxs)(h.$n,{variant:"secondary",onClick:()=>{Se(!Ie)},children:[Ie&&(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.comparison.header.hide-json-diff",children:"Hide JSON diff "}),!Ie&&(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.comparison.header.show-json-diff",children:"Show JSON diff "})]}),he&&(0,n.jsx)(h.$n,{variant:"destructive",onClick:me,icon:"history",children:(0,n.jsxs)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-version",children:["Restore to version ",{version:ne.version}]})})]}),Ie&&(0,n.jsx)(T.M,{oldValue:JSON.stringify(ue,null,2),newValue:JSON.stringify(de,null,2)})]})};var W=e(54148),B=e(83175),S=e(71599),w=e(44109),N=e(20437),M=e(23390),L=e(80218),A=e(94646),U=e(29609);function F(){const[ne]=(0,M.pU)();return(0,L.Yb)(async(se,ue)=>{const de=(0,U.I2)(ue),ie=(0,A.mw)(de,se);return ne.execute(de,ie,se,{dataSourceName:v.hY,namespaceName:se.grafana_alert.namespace_uid,groupName:se.grafana_alert.rule_group})})}var V=e(21241);const K=({isOpen:ne,baseVersion:se,versionToRestore:ue,ruleIdentifier:de,onDismiss:ie,onRestoreSucess:he,onRestoreError:me})=>{const{result:ce}=(0,w.Ll)({ruleIdentifier:de}),Pe=(0,W.Zp)(),[Ie,{error:Se}]=F(),Me=(0,s.t)("alerting.alertVersionHistory.restore-modal.title","Restore version"),Te=(0,s.t)("alerting.alertVersionHistory.restore-modal.error","Could not restore alert rule version "),Ge=Se?"Manually restore rule":(0,s.t)("alerting.alertVersionHistory.restore-modal.confirm","Yes, restore configuration"),Qe=se&&ue?(0,O.G4)((0,V.L0)(se),(0,V.L0)(ue)):void 0;async function tt(){if(!(!ue||!ce))return Ie.execute(ue,ce).then(()=>{ie(),he()}).catch(He=>{me(He)})}async function ke(){if(!ue||!ce)return;const He=(0,N.QX)({...ce,rule:ue}),Re=B.kM.renderUrl(`/alerting/${de.uid}/edit`,{isManualRestore:!0,defaults:JSON.stringify(He),returnTo:window.location.pathname+window.location.search});Pe(Re)}return(0,n.jsx)(S.u,{isOpen:ne,title:Me,confirmText:Ge,confirmButtonVariant:Se?"primary":"destructive",body:(0,n.jsxs)(c.B,{direction:"column",gap:2,children:[!Se&&(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.body",children:"Are you sure you want to restore the alert rule definition to this version? All unsaved changes will be lost."}),(0,n.jsx)(m.E,{variant:"h6",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.summary",children:"Summary of changes to be applied:"})}),(0,n.jsx)("div",{children:Qe&&Object.entries(Qe).map(([He,Re])=>(0,n.jsx)(P.D,{diffs:Re,title:He},He))}),Se&&(0,n.jsxs)(o.F,{severity:"warning",title:Te,children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-manually",children:"Your alert rule could not be restored. This may be due to changes to other entities such as contact points, data sources etc. Please manually restore the rule version"}),(0,n.jsx)("pre",{style:{marginBottom:0},children:(0,n.jsx)("code",{children:(0,x.JZ)(Se)})})]})]}),onConfirm:Se?ke:tt,onDismiss:ie})},G=({oldVersion:ne,newVersion:se,ruleIdentifier:ue,isNewLatest:de,setShowDrawer:ie,onRestoreSuccess:he,onRestoreError:me,canRestore:ce})=>{const[Pe,Ie]=(0,a.useState)(!1),Se=(0,a.useCallback)(()=>ie(!1),[ie]),Me=(0,V.Lw)(ne),Te=(0,V.Lw)(se);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f._,{onClose:()=>ie(!1),title:(0,s.t)("alerting.alertVersionHistory.comparing-versions","Comparing versions"),children:(0,n.jsx)(j,{oldSummary:Me,oldVersion:ne,newSummary:Te,newVersion:se,preprocessVersion:V.L0,showRestoreButton:de&&ce,onRestore:()=>Ie(!0)})}),Pe&&(0,n.jsx)(K,{ruleIdentifier:ue,baseVersion:se,versionToRestore:ne,isOpen:Pe,onDismiss:Se,onRestoreSucess:he,onRestoreError:me})]})};var H=e(32635),_=e(99887),k=e(27594),J=e(85835),z=e(49914);const Y=20;function X({onVersionsChecked:ne,onCompareSingleVersion:se,ruleVersions:ue,disableSelection:de,checkedVersions:ie,onRestoreSuccess:he,onRestoreError:me,canRestore:ce}){const[Pe,Ie]=(0,a.useState)(!1),[Se,Me]=(0,a.useState)(),Te=Se?.grafana_alert?.uid??"",Ge=(0,a.useMemo)(()=>({ruleSourceName:v.hY,uid:Te}),[Te]),Qe=Re=>{Ie(!0),Me(Re)},tt=()=>{Ie(!1)},ke=(0,s.t)("alerting.alertVersionHistory.unknown","Unknown"),He=[{disableGrow:!0,id:"id",header:(0,s.t)("core.versionHistory.table.version","Version"),cell:({row:Re})=>{const Ne=String(Re.original.grafana_alert.version),Ae=ie.has(String(Ne??!1))??!1;return(0,n.jsx)(c.B,{direction:"row",children:(0,n.jsx)(H.S,{label:Ne,checked:Ae,disabled:de&&!Ae,onChange:()=>{ne(Ne)}})})}},{id:"createdBy",header:(0,s.t)("core.versionHistory.table.updatedBy","Updated By"),disableGrow:!0,cell:({row:Re})=>(0,n.jsx)(z.m,{user:Re.original.grafana_alert.updated_by})},{id:"created",header:(0,s.t)("core.versionHistory.table.updated","Date"),disableGrow:!0,cell:({row:Re})=>{const Ne=Re.original.grafana_alert.updated;return Ne?(0,b.LE)(Ne)+" ("+(0,b.fq)(Ne)+")":ke}},{id:"diff",disableGrow:!0,cell:({rows:Re,row:Ne})=>{const Ue=Ne.index===ue.length-1?{}:Re[Ne.index+1]?.original,Be=Ne.original,We=(0,J.h)(Ue,Be),_e=`+${We.added}`,Xe=`-${We.removed}`;return(0,n.jsxs)(c.B,{alignItems:"baseline",gap:.5,children:[(0,n.jsx)(m.E,{color:"success",variant:"bodySmall",children:_e}),(0,n.jsx)(m.E,{color:"error",variant:"bodySmall",children:Xe})]})}},{id:"actions",disableGrow:!0,cell:({row:Re})=>{const Ne=Re.index===0,Ae=(0,s.t)("alerting.alertVersionHistory.compare-with-latest","Compare with latest version");return(0,n.jsxs)(c.B,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[Ne&&(0,n.jsx)(_.E,{text:(0,s.t)("alerting.alertVersionHistory.latest","Latest"),color:"blue"}),!Ne&&ce&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.$n,{variant:"secondary",size:"sm",icon:"code-branch",onClick:()=>{se(Re.original)},tooltip:Ae,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.compare",children:"Compare"})}),(0,n.jsx)(h.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{Re.original.grafana_alert.version&&Qe(Re.original)},children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore",children:"Restore"})})]})]})}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.j,{pageSize:Y,columns:He,data:ue,getRowId:Re=>`${Re.grafana_alert.version}`}),(0,n.jsx)(K,{ruleIdentifier:Ge,baseVersion:ue[0],versionToRestore:Se,isOpen:Pe,onDismiss:tt,onRestoreSucess:he,onRestoreError:me})]})}const{useGetAlertVersionHistoryQuery:Q}=g.hK,q=["id","uid","updated","updated_by","version"];function te({rule:ne}){const se=ne.grafana_alert.uid,{isLoading:ue,currentData:de=[],error:ie}=Q({uid:se}),he=(0,a.useMemo)(()=>({ruleSourceName:v.hY,uid:se}),[se]),[me,ce]=(0,a.useState)(),[Pe,Ie]=(0,a.useState)(),[Se,Me]=(0,a.useState)(!1),[Te,Ge]=(0,a.useState)(new Set),Qe=(0,a.useMemo)(()=>Te.size>1,[Te]),tt={namespace:{uid:ne.grafana_alert.namespace_uid},groupName:ne.grafana_alert.rule_group,groupOrigin:"grafana"},[ke,He]=(0,y.mW)(ne,tt,y.j5.Restore),Re=He&&ke&&!!l.$.featureToggles.alertingRuleVersionHistoryRestore,Ne=(0,a.useCallback)(Xe=>{(0,r.cg)({origin:Xe,latest:Pe===de[0],oldVersion:me?.grafana_alert.version||0,newVersion:Pe?.grafana_alert.version||0})},[me,Pe,de]),Ae=(0,a.useCallback)((Xe,le)=>{(0,r.XW)({origin:Xe,latest:Pe===de[0],oldVersion:me?.grafana_alert.version||0,newVersion:Pe?.grafana_alert.version||0,error:le})},[me,Pe,de]);if(ie)return(0,n.jsx)(o.F,{title:(0,s.t)("alerting.alertVersionHistory.errorloading","Failed to load alert rule versions"),children:(0,x.JZ)(ie)});if(ue)return(0,n.jsx)(d._,{text:(0,s.t)("alerting.common.loading","Loading...")});if(!de.length)return(0,r.fH)(r.le.noAlertRuleVersionsFound,{ruleUid:se}),(0,n.jsx)(i.p,{variant:"not-found",message:(0,s.t)("alerting.alertVersionHistory.noVersionsFound","No versions found for this rule")});const Ue=()=>{const[Xe,le]=de.filter(ye=>{const pe=ye.grafana_alert.version;if(!(!pe&&pe!==0))return Te.has(String(ye.grafana_alert.version))}).sort((ye,pe)=>{const ve=ye.grafana_alert.version,be=pe.grafana_alert.version;return ve===void 0||be===void 0?0:ve-be});(0,r.Rh)({latest:le===de[0],oldVersion:Xe?.grafana_alert.version||0,newVersion:le?.grafana_alert.version||0}),Be(Xe,le)},Be=(Xe,le)=>{ce(Xe),Ie(le),Me(!0)};function We(Xe){Ge(le=>{const ye=new Set(le);return ye.has(Xe)?ye.delete(Xe):ye.add(Xe),ye}),ce(void 0),Ie(void 0)}const _e=de[0].grafana_alert.version===Pe?.grafana_alert.version;return(0,n.jsxs)(c.B,{direction:"column",gap:2,children:[(0,n.jsx)(m.E,{variant:"body",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.description",children:"Each time you edit the alert rule, a new version is created. Select two versions below and compare their differences."})}),(0,n.jsx)(c.B,{children:(0,n.jsx)(p.m,{content:(0,s.t)("core.versionHistory.comparison.select","Select two versions to start comparing"),placement:"bottom",children:(0,n.jsx)(h.$n,{type:"button",disabled:!Qe,onClick:Ue,icon:"code-branch",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.compareVersions",children:"Compare versions"})})})}),Se&&me&&Pe&&(0,n.jsx)(G,{oldVersion:me,newVersion:Pe,ruleIdentifier:he,isNewLatest:_e,setShowDrawer:Me,onRestoreSuccess:()=>Ne("comparison-drawer"),onRestoreError:Xe=>Ae("comparison-drawer",Xe),canRestore:Re}),(0,n.jsx)(X,{onCompareSingleVersion:Xe=>Be(Xe,de[0]),onVersionsChecked:We,ruleVersions:de,disableSelection:Qe,checkedVersions:Te,onRestoreSuccess:()=>Ne("version-list"),onRestoreError:Xe=>Ae("version-list",Xe),canRestore:Re})]})}},45746:(Z,R,e)=>{"use strict";e.d(R,{$:()=>S,B:()=>B});var n=e(74848),a=e(22803),s=e(74226),l=e(2543),o=e(80011),d=e(92745),i=e(41654),c=e(66404),m=e(63142),p=e(30703),h=e(20941),r=e(89640),g=e(42227),y=e(11504),v=e(77256),x=e(29609),f=e(15629),u=e(9368),b=e(31286),E=e(45967),D=e(47931),C=e(10427);const P=({id:M,label:L,value:A,monospace:U,showCopyButton:F,copyValue:V,tooltipValue:K})=>{const G=(0,d.t)("alerting.copy-to-clipboard",'Copy "{{label}}" to clipboard',{label:L});return(0,n.jsx)(b.a,{children:(0,n.jsxs)(i.B,{direction:"column",gap:0,children:[(0,n.jsx)(c.E,{color:"secondary",id:M,children:L}),(0,n.jsxs)(c.E,{"aria-labelledby":M,color:"primary",variant:U?"code":"body",children:[(0,n.jsx)(C.A,{shouldWrap:!!K,wrap:H=>(0,n.jsx)(E.m,{content:K,children:H}),children:(0,n.jsx)("span",{children:A})}),F&&(0,n.jsx)(D.b,{"aria-label":G,fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:()=>V})]})]})})};var T=e(42004),O=e(87281),I=e(49914),j=(M=>(M.GrafanaManagedAlertRule="Grafana-managed alert rule",M.GrafanaManagedRecordingRule="Grafana-managed recording rule",M.CloudAlertRule="Cloud alert rule",M.CloudRecordingRule="Cloud recording rule",M.Unknown="Unknown",M))(j||{});const W=({title:M,children:L})=>(0,n.jsxs)(i.B,{direction:"column",gap:1,children:[(0,n.jsx)(c.E,{variant:"h4",children:M}),(0,n.jsx)(i.B,{direction:"column",gap:2,children:L})]}),B=({rule:M})=>{const L=(0,m.of)(N),A=(0,y.G)(M),U=x.p.grafana.alertingRule(M.rulerRule)?M.rulerRule.keep_firing_for:void 0;let F="Unknown";x.p.grafana.alertingRule(M.rulerRule)?F="Grafana-managed alert rule":x.p.grafana.recordingRule(M.rulerRule)?F="Grafana-managed recording rule":x.p.dataSource.alertingRule(M.rulerRule)?F="Cloud alert rule":x.p.dataSource.recordingRule(M.rulerRule)&&(F="Cloud recording rule");const V=x.p.grafana.recordingRule(M.rulerRule)?M.rulerRule.grafana_alert.record?.target_datasource_uid:null,K=(0,g.ps)(V),G=V&&V!=="grafana",H=M.promRule?.evaluationTime,_=M.promRule?.lastEvaluation,k=x.R$.alertingRule(M.promRule)?(0,x.Rh)(M.promRule):void 0,J=Number.isFinite(H),z=x.p.grafana.rule(M.rulerRule)?M.rulerRule.grafana_alert.updated:void 0,Y=x.p.grafana.rule(M.rulerRule)&&(0,x.hC)(M.rulerRule),X=x.p.grafana.rule(M.rulerRule)&&!(0,l.isUndefined)(M.rulerRule.grafana_alert.missing_series_evals_to_resolve)?String(M.rulerRule.grafana_alert.missing_series_evals_to_resolve):void 0,Q=(0,n.jsxs)(i.B,{children:[(0,n.jsx)(c.E,{color:"warning",children:(0,n.jsx)(p.I,{name:"pause-circle"})}),(0,n.jsx)(c.E,{children:(0,n.jsx)(d.x6,{i18nKey:"alerting.alert.evaluation-paused",children:"Alert evaluation currently paused"})})]});return(0,n.jsxs)("div",{className:L.metadata,children:[(0,n.jsxs)(W,{title:(0,d.t)("alerting.alert.rule","Rule"),children:[(0,n.jsx)(P,{id:"rule-type",label:(0,d.t)("alerting.alert.rule-type","Rule type"),value:F}),x.p.grafana.rule(M.rulerRule)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{id:"rule-type",label:(0,d.t)("alerting.alert.rule-identifier","Rule identifier"),value:M.rulerRule.grafana_alert.uid,monospace:!0,showCopyButton:!0,copyValue:M.rulerRule.grafana_alert.uid}),(0,n.jsx)(P,{id:"last-updated-by",label:(0,d.t)("alerting.alert.last-updated-by","Last updated by"),value:(0,n.jsx)(I.m,{user:M.rulerRule.grafana_alert.updated_by})}),z&&(0,n.jsx)(P,{id:"date-of-last-update",label:(0,d.t)("alerting.alert.last-updated-at","Last updated at"),value:(0,o.LE)(z)+` (${(0,o.fq)(z)})`})]}),G&&(0,n.jsx)(P,{id:"target-datasource-uid",label:(0,d.t)("alerting.alert.target-datasource-uid","Target data source"),value:(0,n.jsx)(h.N,{href:`/connections/datasources/edit/${K?.uid}`,children:(0,n.jsxs)(i.B,{direction:"row",gap:1,children:[(0,n.jsx)("img",{style:{width:"16px"},src:K?.meta.info.logos.small,alt:"datasource logo"}),K?.name]})})})]}),(0,n.jsxs)(W,{title:(0,d.t)("alerting.alert.evaluation","Evaluation"),children:[Y?Q:(0,n.jsxs)(n.Fragment,{children:[J&&_&&(0,n.jsx)(P,{id:"last-evaluated",label:(0,d.t)("alerting.alert.last-evaluated","Last evaluated"),value:(0,f.mo)(_)?"-":(0,s.B)(new Date(_),{addSuffix:!0}),tooltipValue:(0,f.mo)(_)?void 0:(0,o.LE)(_)}),J&&(0,n.jsx)(P,{id:"last-evaluation-duration",label:(0,d.t)("alerting.alert.last-evaluation-duration","Last evaluation duration"),value:`${H} ms`}),X&&(0,n.jsx)(P,{id:"missing-series-resolve",label:(0,d.t)("alerting.alert.missing-series-resolve","Missing series evaluations to resolve"),value:X,tooltipValue:(0,d.t)("alerting.alert.description-missing-series-evaluations","The number of consecutive evaluation intervals a dimension must be missing before the alert instance becomes stale, and is then automatically resolved and evicted. Defaults to 2 if empty.")})]}),A&&(0,n.jsx)(P,{id:"pending-period",label:(0,d.t)("alerting.alert.pending-period","Pending period"),value:A}),U&&(0,n.jsx)(P,{id:"keep-firing-for",label:(0,d.t)("alerting.alert.keep-firing-for","Keep firing for"),value:U})]}),x.p.grafana.alertingRule(M.rulerRule)&&!(0,l.isEmpty)(M.rulerRule.grafana_alert.notification_settings)&&(0,n.jsx)(w,{rulerRule:M.rulerRule}),x.p.grafana.rule(M.rulerRule)&&M.rulerRule.grafana_alert.no_data_state&&M.rulerRule.grafana_alert.exec_err_state&&(0,n.jsxs)(W,{title:(0,d.t)("alerting.alert.alert-state","Alert state"),children:[J&&(0,n.jsx)(P,{id:"alert-state-no-data",label:(0,d.t)("alerting.alert.state-no-data","Alert state if no data or all values are null"),value:M.rulerRule.grafana_alert.no_data_state}),A&&(0,n.jsx)(P,{id:"alert-state-exec-err",label:(0,d.t)("alerting.alert.state-error-timeout","Alert state if execution error or timeout"),value:M.rulerRule.grafana_alert.exec_err_state})]}),k&&(0,n.jsx)(W,{title:(0,d.t)("alerting.alert.annotations","Annotations"),children:Object.keys(k).length===0?(0,n.jsx)("div",{children:(0,n.jsx)(c.E,{color:"secondary",italic:!0,children:(0,n.jsx)(d.x6,{i18nKey:"alerting.alert.no-annotations",children:"No annotations"})})}):Object.entries(k).map(([q,te])=>{const ne=`annotation-${q.replace(/\s/g,"-")}`;return(0,n.jsx)(P,{id:ne,label:q,value:(0,n.jsx)(S,{value:te})},q)})})]})};function S({value:M}){const L=M&&M.startsWith("http"),A=(0,n.jsx)(u.Y,{input:M,delimiter:["{{","}}"]});return L?(0,n.jsx)(r.Y,{href:M,external:!0,children:M}):(0,n.jsx)(c.E,{color:"primary",children:A})}const w=({rulerRule:M})=>{const L=M.grafana_alert.notification_settings;return L?(0,n.jsxs)(W,{title:(0,d.t)("alerting.alert.notification-configuration.group-title","Notification configuration"),children:[(0,n.jsx)(P,{id:"receiver",label:(0,d.t)("alerting.alert.notification-configuration.contact-point","Contact point"),value:(0,n.jsx)(O.z,{name:L.receiver})}),L.mute_time_intervals&&(0,n.jsx)(P,{id:"mute-timings",label:(0,d.t)("alerting.alert.notification-configuration.mute-timings","Mute timings"),value:(0,n.jsx)(n.Fragment,{children:L.mute_time_intervals.map((A,U)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{href:(0,v.NJ)(A,{alertmanager:"grafana"}),children:A}),U<L.mute_time_intervals.length-1&&", "]},A))})}),L.active_time_intervals&&(0,n.jsx)(P,{id:"active-time-intervals",label:(0,d.t)("alerting.alert.notification-configuration.active-timings","Active time intervals"),value:(0,n.jsx)(n.Fragment,{children:L.active_time_intervals.map((A,U)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{href:(0,v.NJ)(A,{alertmanager:"grafana"}),children:A}),U<L.active_time_intervals.length-1&&", "]},A))})}),L.group_by&&(0,n.jsx)(P,{id:"group-by",label:(0,d.t)("alerting.alert.notification-configuration.group-by","Grouped by"),value:L.group_by.join(", ")}),(L.group_interval||L.group_wait||L.repeat_interval)&&(0,n.jsx)(P,{id:"timing-options",label:(0,d.t)("alerting.alert.notification-configuration.timing-options","Timings"),value:(0,n.jsx)(T.OJ,{timingOptions:{group_interval:L.group_interval,group_wait:L.group_wait,repeat_interval:L.repeat_interval}})})]}):null},N=M=>({metadata:(0,a.css)({display:"grid",gap:M.spacing(4),gridTemplateColumns:"1fr 1fr 1fr",[M.breakpoints.down("lg")]:{gridTemplateColumns:"1fr 1fr"},[M.breakpoints.down("sm")]:{gridTemplateColumns:"1fr"}})})},49914:(Z,R,e)=>{"use strict";e.d(R,{m:()=>m});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(45967),d=e(30703),i=e(99887),c=e(21241);const m=({user:h})=>{const r=(0,s.t)("alerting.alertVersionHistory.unknown","Unknown"),g=(0,c.J8)(),y=(0,l.of)(p),v=(0,n.jsx)(o.m,{content:(0,s.t)("alerting.alertVersionHistory.unknown-change-description","This update was made prior to the implementation of alert rule version history. The user who made the change is not tracked, but future changes will include the user"),children:(0,n.jsxs)("span",{children:[(0,n.jsxs)("span",{className:y.underline,children:[r," "]}),(0,n.jsx)(d.I,{name:"question-circle"})]})});if(!h)return v;const x=g[h.uid];return x||!h?(0,n.jsx)(o.m,{content:x.tooltipContent,children:(0,n.jsx)("span",{children:(0,n.jsx)(i.E,{className:y.badge,text:x.name,color:x.badgeColor,icon:x.icon})})}):h.name?h.name:h.uid?(0,s.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:h.uid}):v},p=()=>({badge:(0,a.css)({cursor:"help"}),underline:(0,a.css)({textDecoration:"underline dotted",textUnderlineOffset:"5px",cursor:"help"})})},21241:(Z,R,e)=>{"use strict";e.d(R,{J8:()=>s,L0:()=>l,Lw:()=>o});var n=e(92745),a=e(3845);const s=()=>{const d={name:(0,n.t)("alerting.alertVersionHistory.provisioning","Provisioning"),tooltipContent:(0,n.t)("alerting.alertVersionHistory.provisioning-change-description","Version update was made via provisioning"),badgeColor:"purple"};return{__alerting__:{name:(0,n.t)("alerting.alertVersionHistory.alerting","Alerting"),tooltipContent:(0,n.t)("alerting.alertVersionHistory.alerting-change-description","This update was made by the alerting system due to other changes. For example, when renaming a contact point that is used for simplified routing, this will update affected rules"),badgeColor:"orange",icon:"bell"},service:d,__provisioning__:d}};function l(d){const{grafana_alert:i,...c}=d,m={for:(0,n.t)("alerting.alertVersionHistory.pendingPeriod","Pending period"),annotations:(0,n.t)("alerting.alertVersionHistory.annotations","Annotations"),labels:(0,n.t)("alerting.alertVersionHistory.labels","Labels")},p={title:(0,n.t)("alerting.alertVersionHistory.name","Name"),namespace_uid:(0,n.t)("alerting.alertVersionHistory.namespace_uid","Folder UID"),data:(0,n.t)("alerting.alertVersionHistory.queryAndAlertCondition","Query and alert condition"),notification_settings:(0,n.t)("alerting.alertVersionHistory.contactPointRouting","Contact point routing"),no_data_state:(0,n.t)("alerting.alertVersionHistory.noDataState","Alert state when no data"),exec_err_state:(0,n.t)("alerting.alertVersionHistory.execErrorState","Alert state when execution error"),is_paused:(0,n.t)("alerting.alertVersionHistory.paused","Paused state"),rule_group:(0,n.t)("alerting.alertVersionHistory.rule_group","Rule group"),condition:(0,n.t)("alerting.alertVersionHistory.condition","Alert condition"),intervalSeconds:(0,n.t)("alerting.alertVersionHistory.intervalSeconds","Evaluation interval")},h=Object.entries(c).reduce((g,[y,v])=>{const f=m[y]||y;return{...g,[f]:v}},{}),r=Object.entries(i).reduce((g,[y,v])=>{const x=y;if(a.R.includes(x))return g;const f=p[x]||y;return{...g,[f]:v}},{});return{...h,...r}}function o(d){const i=(0,n.t)("alerting.alertVersionHistory.unknown","Unknown"),c=s(),m=(()=>{const p=d?.grafana_alert.updated_by,h=p?.uid,r=p?.name;return p?h&&c[h]?c[h].name:r||(h?(0,n.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:h}):i):i})();return{createdAt:d.grafana_alert.updated||i,createdBy:m,version:d.grafana_alert.version||i}}},75983:(Z,R,e)=>{"use strict";e.d(R,{D:()=>D});var n=e(74848),a=e(96540),s=e(71642),l=e(25229),o=e(54092),d=e(29609),i=e(7840),c=e(6106),m=e(92745),p=e(46907),h=e(88559),r=e(76319),g=e(20806),y=e(9860);const v=({rule:P,instance:T,extensionPointId:O})=>{const[I,j]=(0,a.useState)(),W=(0,a.useMemo)(()=>({instance:T,rule:P}),[T,P]),{links:B}=(0,p.U)({context:W,extensionPointId:O,limitPerPlugin:3});if(B.length===0)return null;const S=(0,n.jsx)(y.w,{extensions:B,onSelect:j});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.m,{placement:"bottom-start",overlay:S,children:(0,n.jsx)(r.K,{name:"ellipsis-v","aria-label":(0,m.t)("alerting.alert-instance-extension-point.aria-label-actions","Actions"),variant:"secondary"})}),!!I&&!!I.path&&(0,n.jsx)(g.s,{path:I.path,title:I.title,onDismiss:()=>j(void 0)})]})};var x=e(75640),f=e(83750),u=e(40165);const b=({instance:P})=>{const T=(0,x.Hx)(P.annotations),O=(0,x.gO)(T);return(0,n.jsxs)("div",{children:[P.value&&(0,n.jsx)(u.X,{label:(0,m.t)("alerting.alert-instance-details.label-value","Value"),horizontal:!0,children:P.value}),T.map(([I,j])=>(0,n.jsx)(f.s,{annotationKey:I,value:j,valueLink:O.get(I)},I))]})};var E=e(65420);const D=({rule:P,instances:T,pagination:O,footerRow:I})=>{const j=(0,a.useMemo)(()=>T.length>1?(0,s.yO)(T.map(B=>B.labels)):{},[T]),W=(0,a.useMemo)(()=>T.map(B=>({data:{rule:P,alert:{...B,commonLabels:j}},id:(0,d.RI)(B)})),[j,T,P]);return(0,n.jsx)(c.E,{cols:C,isExpandable:!0,items:W,renderExpandedContent:({data:B})=>(0,n.jsx)(b,{instance:B.alert}),pagination:O,footerRow:I})},C=[{id:"state",label:"State",renderCell:({data:{alert:{state:P}}})=>(0,n.jsx)(E.C,{state:P}),size:"95px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:P,commonLabels:T}}})=>(0,n.jsx)(i.m,{labels:P,commonLabels:T,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:P}}})=>(0,n.jsx)(n.Fragment,{children:P.startsWith("0001")?"-":(0,l.KQ)(P).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:P,rule:T}})=>(0,n.jsx)(v,{rule:T,instance:P,extensionPointId:o.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},65420:(Z,R,e)=>{"use strict";e.d(R,{C:()=>c});var n=e(74848),a=e(96540),s=e(92745),l=e(45967),o=e(30703),d=e(29609),i=e(67834);const c=(0,a.memo)(({state:m,isPaused:p=!1,size:h="md",muted:r=!1})=>p?(0,n.jsx)(l.m,{content:(0,s.t)("alerting.alert-state-tag.content-alert-evaluation-is-currently-paused","Alert evaluation is currently paused"),placement:"top",children:(0,n.jsxs)(i.O,{state:"warning",size:h,muted:r,children:[(0,n.jsx)(o.I,{name:"pause",size:"xs"})," ",(0,n.jsx)(s.x6,{i18nKey:"alerting.alert-state-tag.paused",children:"Paused"})]})}):(0,n.jsx)(i.O,{state:(0,d.Wy)(m),size:h,muted:r,children:(0,d.XI)(m)}));c.displayName="AlertStateTag"},14050:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>c});var n=e(74848),a=e(96540),s=e(54148),l=e(92745),o=e(71599),d=e(45861),i=e(94646);function c({identifier:p,isProvisioned:h,redirectTo:r=!1,onDismiss:g}){const y=(0,s.zy)(),[v,x]=(0,a.useState)(h?"confirm":"redirect");if(v==="redirect"){const f=i.$9(p),u=y.pathname+y.search,b=new URLSearchParams({copyFrom:f,returnTo:r?u:""});return(0,n.jsx)(s.C5,{to:"/alerting/new?"+b.toString(),replace:!1})}return(0,n.jsx)(o.u,{isOpen:v==="confirm",title:(0,l.t)("alerting.redirect-to-clone-rule.title-copy-provisioned-alert-rule","Copy provisioned alert rule"),body:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsxs)(l.x6,{i18nKey:"alerting.redirect-to-clone-rule.body-not-provisioned",children:["The new rule will ",(0,n.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]})}),(0,n.jsx)("p",{children:(0,n.jsx)(l.x6,{i18nKey:"alerting.redirect-to-clone-rule.body-evaluation-group",children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})})]}),confirmText:(0,l.t)("alerting.redirect-to-clone-rule.confirmText-copy","Copy"),onConfirm:()=>x("redirect"),onDismiss:g})}const m=(0,a.forwardRef)(({text:p,ruleIdentifier:h,isProvisioned:r,className:g},y)=>{const[v,x]=(0,a.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.$n,{title:(0,l.t)("alerting.clone-rule-button.title-copy","Copy"),className:g,size:"sm",variant:"secondary",icon:"copy",onClick:()=>x(!0),ref:y,children:p},"clone"),v&&(0,n.jsx)(c,{identifier:h,isProvisioned:r,onDismiss:()=>x(!1)})]})});m.displayName="CloneRuleButton"},3969:(Z,R,e)=>{"use strict";e.d(R,{l:()=>T});var n=e(74848),a=e(2543),s=e.n(a),l=e(96540),o=e(92745),d=e(45861),i=e(41654),c=e(94380),m=e(53567),p=e(90186),h=e(2218),r=e(96784),g=e(52763),y=e(16692),v=e(11018),x=e(52161),f=e(67598),u=e(77256),b=e(94646),E=e(29609),D=e(92367),C=e(14050);const P=O=>window.matchMedia(`(max-width: ${O}px)`).matches,T=({compact:O,showViewButton:I,rule:j,rulesSource:W})=>{const B=(0,g.wA)(),S=!O,[w,N]=(0,m.w)(S),[M,L]=(0,l.useState)(!1),[A,U]=(0,l.useState)(void 0),{namespace:F,group:V,rulerRule:K}=j,{hasActiveFilters:G}=(0,r.dI)(),H=E.p.grafana.rule(j.rulerRule)&&!!j.rulerRule.grafana_alert.provenance,[_,k]=(0,y.mh)(j,y.j5.Update),J=_&&k,z=[],Y=O?"sm":"md",X=(0,x.EV)(W),Q=b.UP(X,j),q=f.HA.fromCombinedRule(j);if(I&&z.push((0,n.jsx)(d.z9,{title:(0,o.t)("alerting.rule-actions-buttons.title-view","View"),size:Y,variant:"secondary",icon:"eye",href:(0,u.w$)(W,j),children:(0,n.jsx)(o.x6,{i18nKey:"common.view",children:"View"})},"view")),K&&J){const se=b.P1(X,F.name,V.name,K),ue=(0,D.G)(`/alerting/${encodeURIComponent(b.$9(se))}/edit`);z.push((0,n.jsx)(d.z9,{title:(0,o.t)("alerting.rule-actions-buttons.title-edit","Edit"),size:Y,variant:"secondary",icon:"pen",href:ue,children:(0,n.jsx)(o.x6,{i18nKey:"common.edit",children:"Edit"})},"edit"))}if(!j.promRule&&!j.rulerRule)return null;const te=(0,E.xE)(j.rulerRule??j.promRule),ne=(0,a.isString)(te)&&(E.p.grafana.alertingRule(j.rulerRule)||E.R$.grafana.alertingRule(j.promRule));return(0,n.jsxs)(i.B,{gap:1,alignItems:"center",wrap:"nowrap",children:[z,(0,n.jsx)(c.A,{rulerRule:j.rulerRule,promRule:j.promRule,identifier:Q,groupIdentifier:q,handleDelete:()=>{if(j.rulerRule){const se=b.co(q,j.rulerRule);N(se,q)}},handleSilence:()=>L(!0),handleDuplicateRule:()=>U({identifier:Q,isProvisioned:H}),onPauseChange:()=>{const se=G?void 0:p.Ys+1;B((0,v.Lc)({rulesSourceName:x.hY,limitAlerts:se}))},buttonSize:Y}),w,ne&&M&&(0,n.jsx)(h.A,{ruleUid:te,onClose:()=>L(!1)}),A?.identifier&&(0,n.jsx)(C.Z,{identifier:A.identifier,isProvisioned:A.isProvisioned,onDismiss:()=>U(void 0)})]})}},90186:(Z,R,e)=>{"use strict";e.d(R,{Ys:()=>X,DI:()=>Q});var n=e(74848),a=e(22803),s=e(80011),l=e(25229),o=e(92745),d=e(63142),i=e(45967),c=e(55555),m=e(11504),p=e(75640),h=e(29609),r=e(15629),g=e(7840),y=e(40165),v=e(83750);function x(ne){const se=(0,d.of)(f),{annotations:ue}=ne,de=(0,p.gO)(ue);return ue.length===0?null:(0,n.jsx)("div",{className:se.annotations,children:ue.map(([ie,he])=>(0,n.jsx)(v.s,{annotationKey:ie,value:he,valueLink:de.get(ie)},ie))})}const f=()=>({annotations:(0,a.css)({marginTop:"46px"})});var u=e(96540),b=e(63704),E=e(41071),D=e(45861),C=e(41654),P=e(16692),T=e(58138),O=e(95443),I=e(52161),j=e(77256);const B=({rule:ne,rulesSource:se})=>{const{group:ue}=ne,{StateHistoryModal:de,showStateHistoryModal:ie}=(0,T.G)(),he=(0,E.i)(),[me,ce]=(0,P.mh)(ne,P.j5.Explore),Pe=[],Ie=(0,h.YN)(ue);if((0,I.Eb)(se)&&me&&ce&&!Ie&&Pe.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,j.Yp)(se,ne.query),children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-details-buttons.see-graph",children:"See graph"})},"explore")),ne.annotations[O.YH.runbookURL]&&Pe.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:b.sQ.sanitizeUrl(ne.annotations[O.YH.runbookURL]),children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-details-buttons.view-runbook",children:"View runbook"})},"runbook")),ne.annotations[O.YH.dashboardUID]){const Se=ne.annotations[O.YH.dashboardUID];if(Se){Pe.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Se)}`,onClick:()=>{he(ne.name)},children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-details-buttons.go-to-dashboard",children:"Go to dashboard"})},"dashboard"));const Me=ne.annotations[O.YH.panelID];Me&&Pe.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Se)}?viewPanel=${encodeURIComponent(Me)}`,onClick:()=>{he(ne.name)},children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-details-buttons.go-to-panel",children:"Go to panel"})},"panel"))}}return h.p.grafana.alertingRule(ne.rulerRule)&&Pe.push((0,n.jsxs)(u.Fragment,{children:[(0,n.jsx)(D.$n,{size:"sm",icon:"history",onClick:()=>h.p.grafana.rule(ne.rulerRule)&&ie(ne.rulerRule),children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-details-buttons.show-state-history",children:"Show state history"})}),de]},"history")),Pe.length?(0,n.jsx)(C.B,{children:Pe}):null};var S=e(78282),w=e(4651);function N(ne){const{rulesSource:se,rule:ue}=ne,de=(0,d.of)(M),ie=(0,u.useMemo)(()=>{if((0,I.Eb)(se))return[{name:se.name,icon:se.meta.info.logos.small}];if(h.p.grafana.rule(ue.rulerRule)){const{data:he}=ue.rulerRule.grafana_alert,me=he.reduce((ce,Pe)=>{const Ie=(0,S.l)().getInstanceSettings(Pe.datasourceUid);return!Ie||Ie.uid===w.Uj||(ce[Ie.name]={name:Ie.name,icon:Ie.meta.info.logos.small}),ce},{});return Object.values(me)}return[]},[ue,se]);return ie.length===0?null:(0,n.jsx)(y.X,{label:(0,o.t)("alerting.rule-details-data-sources.label-data-source","Data source"),children:ie.map(({name:he,icon:me},ce)=>(0,n.jsxs)("div",{children:[me&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{alt:`${he} datasource logo`,className:de.dataSourceIcon,src:me})," "]}),he]},he))})}function M(ne){const se=ne.spacing(2);return{dataSourceIcon:(0,a.css)({width:se,height:se})}}var L=e(28848),A=e(29317),U=e(35748),F=e(56103),V=e(35458),K=e(77236),G=e(16591);const H=({language:ne,expr:se})=>{const ue=(0,u.useMemo)(()=>[(0,F.D)({onlyIn:ie=>"type"in ie&&ie.type==="code_block",getSyntax:()=>ne},{...L.languages,[ne]:ne==="logql"?K.Ay:U.n6})],[ne]),de=(0,u.useMemo)(()=>(0,V.mO)(se),[se]);return(0,n.jsx)(A.Editor,{"data-testid":"expression-editor",plugins:ue,value:de})},_=({expression:ne,rulesSource:se})=>{const ue=(0,d.of)(k);return(0,n.jsx)(G.L,{className:(0,a.cx)(ue.well,"slate-query-field"),children:(0,I.Eb)(se)?(0,n.jsx)(H,{expr:ne,language:se.type===I.ol.Loki?"logql":"promql"}):ne})},k=ne=>({well:(0,a.css)({fontFamily:ne.typography.fontFamilyMonospace})});function J(ne){const{annotations:se,rulesSource:ue,rule:de}=ne,ie=z();return(0,I.Eb)(ue)?(0,n.jsx)(y.X,{label:(0,o.t)("alerting.rule-details-expression.label-expression","Expression"),horizontal:!0,className:(0,a.cx)({[ie.exprRow]:!!se.length}),children:(0,n.jsx)(_,{expression:de.query,rulesSource:ue})}):null}const z=()=>({exprRow:(0,a.css)({marginBottom:"46px"})});var Y=e(66773);const X=15,Q=({rule:ne})=>{const se=(0,d.of)(te),{namespace:{rulesSource:ue}}=ne,de=(0,p.Hx)(ne.annotations),ie=h.p.any.alertingRule(ne.rulerRule)||h.R$.alertingRule(ne.promRule);return(0,n.jsxs)("div",{children:[(0,n.jsx)(B,{rule:ne,rulesSource:ue}),(0,n.jsxs)("div",{className:se.wrapper,children:[(0,n.jsxs)("div",{className:se.leftSide,children:[(0,n.jsx)(q,{rule:ne}),!!ne.labels&&!!Object.keys(ne.labels).length&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.rule-details.label-labels","Labels"),horizontal:!0,children:(0,n.jsx)(g.m,{labels:ne.labels})}),(0,n.jsx)(J,{rulesSource:ue,rule:ne,annotations:de}),(0,n.jsx)(x,{annotations:de})]}),(0,n.jsx)("div",{className:se.rightSide,children:(0,n.jsx)(N,{rulesSource:ue,rule:ne})})]}),ie&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.rule-details.label-instances","Instances"),horizontal:!0,children:(0,n.jsx)(Y.s,{rule:ne,itemsDisplayLimit:X})})]})},q=({rule:ne})=>{const se=ne.group.interval,ue=ne.promRule?.lastEvaluation,de=ne.promRule?.evaluationTime,ie=h.p.grafana.recordingRule(ne.rulerRule)?ne.rulerRule?.grafana_alert.record?.metric:void 0,he=(0,m.G)(ne),me=h.p.grafana.alertingRule(ne.rulerRule)?ne.rulerRule.keep_firing_for:void 0;return(0,n.jsxs)(n.Fragment,{children:[ie&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.evaluation-behavior-summary.label-metric","Metric"),horizontal:!0,children:ie}),se&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.evaluation-behavior-summary.label-evaluate","Evaluate"),horizontal:!0,children:(0,n.jsxs)(o.x6,{i18nKey:"alerting.evaluation-behavior-summary.evaluate",values:{interval:se},children:["Every ",{interval:se}]})}),he&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.evaluation-behavior-summary.label-pending-period","Pending period"),horizontal:!0,children:he}),me&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.rule-details.keep-firing-for","Keep firing for"),horizontal:!0,children:me}),ue&&!(0,r.mo)(ue)&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.evaluation-behavior-summary.label-last-evaluation","Last evaluation"),horizontal:!0,children:(0,n.jsx)(i.m,{placement:"top",content:`${(0,s.LE)(ue,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,n.jsx)("span",{children:(0,o.t)("alerting.rule-details.last-evaluation-ago","{{time}} ago",{time:(0,l.KQ)(ue).locale("en").fromNow(!0)})})})}),ue&&!(0,r.mo)(ue)&&de!==void 0&&(0,n.jsx)(y.X,{label:(0,o.t)("alerting.evaluation-behavior-summary.label-evaluation-time","Evaluation time"),horizontal:!0,children:(0,n.jsx)(i.m,{placement:"top",content:`${de}s`,theme:"info",children:(0,n.jsx)("span",{children:(0,c.g)({timeInMs:de,humanize:!0})})})})]})},te=ne=>({wrapper:(0,a.css)({display:"flex",flexDirection:"row",[ne.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,a.css)({flex:1}),rightSide:(0,a.css)({[ne.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},66773:(Z,R,e)=>{"use strict";e.d(R,{s:()=>T});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(92745),d=e(63142),i=e(45861),c=e(87133),m=e(94018),p=e(72636),h=e(77824),r=e(24619);const g=({className:j,onStateFilterChange:W,stateFilter:B,filterType:S,itemPerStateStats:w})=>{const N=(0,d.of)(y),M=V=>function(){return w&&w[V]?(0,n.jsx)(m.v,{name:w[V].toFixed(0),colorIndex:9,className:N.tag}):null},L=Object.values(r.Gi).map(V=>({label:V,value:V,component:M(V)})),U=[r.cF.Firing,r.cF.Pending].map(V=>({label:(0,s.capitalize)(V),value:V,component:M(V)})),F=S==="grafana"?L:U;return(0,n.jsxs)("div",{className:j,"data-testid":"alert-instance-state-filter",children:[(0,n.jsx)(p.J,{children:(0,n.jsx)(o.x6,{i18nKey:"alerting.alert-instance-state-filter.state",children:"State"})}),(0,n.jsx)(h.z,{options:F,value:B,onChange:W,onClick:V=>{V===B&&W(void 0)}})]})};function y(j){return{tag:(0,a.css)({fontSize:"11px",fontWeight:"normal",padding:j.spacing(.25,.5),verticalAlign:"middle",marginLeft:j.spacing(.5)})}}var v=e(86017),x=e(77256),f=e(21834),u=e(52161),b=e(63895),E=e(29609),D=e(75983),C=e(46672);function P({stats:j,onClick:W,href:B}){const S=(0,d.of)(I);return(0,n.jsxs)("div",{className:S.footerRow,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(o.x6,{i18nKey:"alerting.rule-details-matching-instances.showing-count",values:{visibleItems:j.visibleItemsCount,totalItems:j.totalItemsCount},children:["Showing ","{{visibleItems}}"," out of ","{{totalItems}}"," instances"]})}),(0,n.jsx)(i.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:W,href:B,children:(0,n.jsxs)(o.x6,{i18nKey:"alerting.rule-details-matching-instances.button-show-all",count:j.totalItemsCount,children:["Show all ","{{totalItems}}"," alert instances"]})})]})}function T(j){const{rule:W,itemsDisplayLimit:B=Number.POSITIVE_INFINITY,pagination:S,enableFiltering:w=!1}=j,{promRule:N,namespace:M,instanceTotals:L}=W,[A,U]=(0,l.useState)(),[F,V]=(0,l.useState)(),[K]=(0,l.useState)(Math.floor(Math.random()*100)),G=`queryString-${K}`,H=(0,d.of)(I),_=(0,u.z2)(M.rulesSource)?u.hY:"prometheus",k=(0,l.useMemo)(()=>E.R$.alertingRule(N)&&N.alerts?.length?O(A,F,(0,x.Cp)(f.xB.Importance,N.alerts)):[],[N,F,A]);if(!E.R$.alertingRule(N))return null;const J=k.slice(0,B),z=(0,s.countBy)(N.alerts,ue=>(0,r.lh)(ue.state)),Y=(0,s.sum)([L.alerting,L.inactive,L.pending,L.recovering,L.nodata]),X=Y-J.length,Q={totalItemsCount:Y,visibleItemsCount:J.length},q=(0,x.w$)(M.rulesSource,j.rule,window.location.pathname+window.location.search),te=(0,C.kc)(L),ne=()=>V(void 0),se=X?(0,n.jsx)(P,{stats:Q,onClick:w?ne:void 0,href:w?void 0:q}):void 0;return(0,n.jsxs)(n.Fragment,{children:[w&&(0,n.jsx)("div",{className:(0,a.cx)(H.flexRow,H.spaceBetween),children:(0,n.jsxs)("div",{className:H.flexRow,children:[(0,n.jsx)(c.X,{defaultQueryString:A,onFilterChange:ue=>U(ue)},G),(0,n.jsx)(g,{filterType:_,stateFilter:F,onStateFilterChange:V,itemPerStateStats:z})]})}),!w&&(0,n.jsx)("div",{className:H.stats,children:te}),(0,n.jsx)(D.D,{rule:W,instances:J,pagination:S,footerRow:se})]})}function O(j,W,B){let S=[...B];if(j){const w=j?(0,b.Zc)(j):[];S=S.filter(({labels:N})=>(0,v.Av)(N,w))}return W&&(S=S.filter(w=>(0,r.lh)(w.state)===W)),S}const I=j=>({flexRow:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:j.spacing(1),gap:j.spacing(1)}),spaceBetween:(0,a.css)({justifyContent:"space-between"}),footerRow:(0,a.css)({display:"flex",flexDirection:"column",gap:j.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,a.css)({marginBottom:j.spacing(2)}),stats:(0,a.css)({display:"flex",gap:j.spacing(1),padding:j.spacing(1,0)})})},46672:(Z,R,e)=>{"use strict";e.d(R,{M_:()=>y,j7:()=>x,kc:()=>f});var n=e(74848),a=e(2543),s=e.n(a),l=e(55127),o=e.n(l),d=e(96540),i=e(92745),c=e(41654),m=e(99887),p=e(86791),h=e(24619),r=e(45311);const g={recording:0,alerting:0,[h.cF.Pending]:0,[h.cF.Inactive]:0,[h.cF.Recovering]:0,paused:0,error:0,nodata:0},y=d.memo(({namespaces:u})=>{const b=(0,d.useDeferredValue)(u),E=(0,d.useMemo)(()=>v(b),[b]),D=(0,r.U)(E),C=f(E),P=!!C.length;return C.unshift((0,n.jsxs)(d.Fragment,{children:[D," ",o()("rule",D)]},"total")),(0,n.jsx)(c.B,{direction:"row",children:P&&(0,n.jsx)("div",{children:(0,n.jsx)(c.B,{gap:.5,children:C})})})});y.displayName="RuleStats";function v(u){const b={...g};return u.forEach(({groups:E})=>{E.forEach(D=>{const C=(0,a.omitBy)(D.totals,a.isUndefined);for(const P in C)b[P]+=C[P]})}),b}const x=({group:u})=>{const b=u.totals,E=u?.interval,D=f(b),C=!!D.length;return(0,n.jsxs)(c.B,{direction:"row",children:[C&&(0,n.jsx)("div",{children:(0,n.jsx)(c.B,{gap:.5,children:D})}),E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"|"}),(0,n.jsx)(m.E,{text:E,icon:"clock-nine",color:"blue"})]})]})};function f(u){const b=[];if(u[p.$7.Alerting]&&b.push((0,n.jsx)(m.E,{color:"red",text:(0,i.t)("alerting.rule-stats.firing","{{alertingStats}} firing",{alertingStats:u[p.$7.Alerting]})},"firing")),u.error&&b.push((0,n.jsx)(m.E,{color:"red",text:(0,i.t)("alerting.rule-stats.error","{{count}} errors",{count:u.error})},"errors")),u.nodata&&b.push((0,n.jsx)(m.E,{color:"blue",text:(0,i.t)("alerting.rule-stats.nodata","{{nodataStats}} no data",{nodataStats:u.nodata})},"nodata")),u[p.$7.Pending]){const E=u[p.$7.Pending];b.push((0,n.jsx)(m.E,{color:"orange",text:(0,i.t)("alerting.rule-stats.pending","{{pendingStats}} pending",{pendingStats:E})},"pending"))}if(u[p.$7.Recovering]){const E=u[p.$7.Recovering];b.push((0,n.jsx)(m.E,{color:"orange",text:(0,i.t)("alerting.rule-stats.recovering","{{recoveringStats}} recovering",{recoveringStats:E})},"recovering"))}if(u[p.$7.Normal]&&u.paused){const E=u[p.$7.Normal],D=u.paused;b.push((0,n.jsx)(m.E,{color:"green",text:(0,i.t)("alerting.rule-stats.paused","{{normalStats}} normal ({{pausedStats}} paused)",{normalStats:E,pausedStats:D})},"paused"))}if(u[p.$7.Normal]&&!u.paused){const E=u[p.$7.Normal];b.push((0,n.jsx)(m.E,{color:"green",text:(0,i.t)("alerting.rule-stats.inactive","{{normalStats}} normal",{normalStats:E})},"inactive"))}if(u.recording){const E=u.recording;b.push((0,n.jsx)(m.E,{color:"purple",text:(0,i.t)("alerting.rule-stats.recording","{{recordingStats}} recording",{recordingStats:E})},"recording"))}return b}},22971:(Z,R,e)=>{"use strict";e.d(R,{sF:()=>q,ZI:()=>ie});var n=e(74848),a=e(22803),s=e(96540),l=e(70255),o=e(92745),d=e(63142),i=e(34213),c=e(45967),m=e(95943),p=e(70327),h=e(55143),r=e(74869),g=e(80218),y=e(23265),v=e(11940),x=e(74048),f=e(98127),u=e(17305),b=e(76267),E=e(95443),D=e(52161),C=e(29609),P=e(6106),T=e(57487),O=e(1972),I=e(40360),j=e(9368),W=e(3969),B=e(43173),S=e(30703),w=e(182);function N({rule:me}){const ce=(0,d.of)(M),Pe=C.p.grafana.rule(me.rulerRule);return(0,s.useMemo)(()=>Pe?(0,w.qf)(me.group.interval).exceedsLimit:!1,[me.group.interval,Pe])?(0,n.jsx)(c.m,{theme:"error",content:(0,n.jsx)("div",{children:(0,n.jsxs)(o.x6,{i18nKey:"alerting.rule-config-status.tooltip-min-interval",values:{minInterval:B.$.unifiedAlerting.minInterval,ruleInterval:me.group.interval},children:["A minimum evaluation interval of ",(0,n.jsx)("span",{className:ce.globalLimitValue,children:"{{minInterval}}"})," has been configured in Grafana and will be used instead of the ","{{ruleInterval}}"," interval configured for the Rule Group."]})}),children:(0,n.jsx)(S.I,{name:"stopwatch-slash",className:ce.icon})}):null}function M(me){return{globalLimitValue:(0,a.css)({fontWeight:me.typography.fontWeightBold}),icon:(0,a.css)({fill:me.colors.warning.text})}}var L=e(90186),A=e(22973);const U=({rule:me})=>{const ce=(0,d.of)(F);return(0,A.lf)(me.health)?(0,n.jsx)(c.m,{theme:"error",content:me.lastError||"No error message provided.",children:(0,n.jsxs)("div",{className:ce.warn,children:[(0,n.jsx)(S.I,{name:"exclamation-triangle"}),(0,n.jsx)("span",{children:(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-health.error",children:"error"})})]})}):(0,n.jsx)(n.Fragment,{children:me.health})},F=me=>({warn:(0,a.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:me.spacing(1),color:me.colors.warning.text})});var V=e(74529),K=e(41654),G=e(68079),H=e(24619),_=e(67834),k=e(65420);const J=({rule:me,isDeleting:ce,isCreating:Pe,isPaused:Ie})=>{const Se=(0,d.of)(z),{promRule:Me,rulerRule:Te}=me,Ge=()=>Ie&&C.p.grafana.recordingRule(Te)?(0,n.jsx)(c.m,{content:(0,o.t)("alerting.rule-state.recording-rule-state.content-recording-rule-evaluation-is-currently-paused","Recording rule evaluation is currently paused"),placement:"top",children:(0,n.jsxs)(_.O,{state:"warning",children:[(0,n.jsx)(S.I,{name:"pause",size:"xs"}),(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),Qe=(0,s.useMemo)(()=>{if(C.R$.alertingRule(Me)&&Me.alerts?.length&&Me.state!==H.cF.Inactive){const tt=Me.activeAt?new Date(Me.activeAt):(0,C.Om)(Me);if(tt)return(0,n.jsxs)("span",{title:String(tt),className:Se.for,children:[(0,n.jsxs)(o.x6,{i18nKey:"alerting.rule-state.for",values:{duration:(0,V.dU)({start:tt,end:new Date},!1)},children:["for ","{{duration}}"]})," "]})}return null},[Me,Se]);return ce?(0,n.jsxs)(K.B,{gap:1,children:[(0,n.jsx)(G.y,{}),(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):Pe?(0,n.jsxs)(K.B,{gap:1,children:[(0,n.jsx)(G.y,{}),(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):C.R$.alertingRule(Me)?(0,n.jsxs)(K.B,{gap:1,children:[(0,n.jsx)(k.C,{state:Me.state,isPaused:Ie}),!Ie&&Qe]}):Me&&C.R$.recordingRule(Me)?(0,n.jsx)(Ge,{}):(0,n.jsx)(o.x6,{i18nKey:"alerting.rule-state.na",children:"n/a"})},z=me=>({for:(0,a.css)({fontSize:me.typography.bodySmall.fontSize,color:me.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),Y=(0,r.wS)(),{useLazyGetRuleGroupForNamespaceQuery:X}=p.hK,{useLazyDiscoverDsFeaturesQuery:Q}=h.L,q=({rules:me,className:ce,showGuidelines:Pe=!1,emptyMessage:Ie="No rules found.",showGroupColumn:Se=!1,showSummaryColumn:Me=!1,showNextEvaluationColumn:Te=!1})=>{const Ge=(0,d.of)(ne),Qe=(0,a.cx)(Ge.wrapper,ce,{[Ge.wrapperMargin]:Pe}),{pageItems:tt,page:ke,numberOfPages:He,onPageChange:Re}=(0,x.W)(me,1,m.FG),{result:Ne,status:Ae}=te(tt),Ue=Ae==="loading",Be=(0,s.useMemo)(()=>Ne.map((Xe,le)=>({id:`${Xe.namespace.name}-${Xe.group.name}-${Xe.name}-${le}`,data:Xe})),[Ne]),We=se(Me,Se,Te,Ue);if(!tt.length)return(0,n.jsx)("div",{className:(0,a.cx)(Qe,Ge.emptyMessage),children:Ie});const _e=Pe?T.B:P.E;return(0,n.jsxs)("div",{className:Qe,"data-testid":"rules-table",children:[(0,n.jsx)(_e,{cols:We,isExpandable:!0,items:Be,renderExpandedContent:({data:Xe})=>(0,n.jsx)(L.DI,{rule:Xe})}),(0,n.jsx)(i.d,{currentPage:ke,numberOfPages:He,onNavigate:Re,hideWhenSinglePage:!0,className:Ge.pagination})]})};function te(me){const[ce]=X(),[Pe]=Q(),[Ie,Se]=(0,g.Yb)(async()=>Promise.all(me.map(async Te=>{const Ge=await Pe({rulesSourceName:(0,D.EV)(Te.namespace.rulesSource)},!0).unwrap();if(Ge.rulerConfig&&Te.namespace.rulesSource!==D.hY){const Qe=await ce({namespace:Te.namespace.name,group:Te.group.name,rulerConfig:Ge.rulerConfig},!0).unwrap();(0,y.yh)(Te,Qe)}return Te})),me);return(0,s.useEffect)(()=>{Y?Ie.execute():Ie.reset()},[me,Ie]),Se}const ne=me=>({wrapperMargin:(0,a.css)({[me.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,a.css)({padding:me.spacing(1)}),wrapper:(0,a.css)({width:"auto",borderRadius:me.shape.radius.default}),skeletonWrapper:(0,a.css)({flex:1}),pagination:(0,a.css)({display:"flex",margin:0,paddingTop:me.spacing(1),paddingBottom:me.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${me.colors.border.medium}`,borderRight:`1px solid ${me.colors.border.medium}`,borderBottom:`1px solid ${me.colors.border.medium}`,float:"none"})});function se(me,ce,Pe,Ie){return(0,s.useMemo)(()=>{const Se=[{id:"state",label:(0,o.t)("alerting.use-columns.columns.label.state","State"),renderCell:({data:Me})=>(0,n.jsx)(ue,{rule:Me}),size:"165px"},{id:"name",label:(0,o.t)("alerting.use-columns.columns.label.name","Name"),renderCell:({data:Me})=>Me.name,size:Pe?4:5},{id:"metadata",label:"",renderCell:({data:Me})=>{const{promRule:Te,rulerRule:Ge}=Me,Qe=(0,C.uo)(Te??Ge);return Qe?(0,n.jsx)(u.T,{pluginId:Qe.pluginId}):C.p.grafana.rule(Ge)&&Ge.grafana_alert.provenance?(0,n.jsx)(O.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:Me})=>(0,n.jsx)(N,{rule:Me}),size:"45px"},{id:"health",label:(0,o.t)("alerting.use-columns.columns.label.health","Health"),renderCell:({data:{promRule:Me,group:Te}})=>Me?(0,n.jsx)(U,{rule:Me}):null,size:"75px"}];return me&&Se.push({id:"summary",label:(0,o.t)("alerting.use-columns.label.summary","Summary"),renderCell:({data:Me})=>(0,n.jsx)(j.Y,{input:Me.annotations[E.YH.summary]??""}),size:Pe?4:5}),Pe&&Se.push({id:"nextEvaluation",label:(0,o.t)("alerting.use-columns.label.next-evaluation","Next evaluation"),renderCell:({data:Me})=>{const Te=(0,b.C)(Me.promRule?.lastEvaluation,Me.group.interval);return Te&&(0,n.jsx)(c.m,{placement:"top",content:`${Te?.fullDate}`,theme:"info",children:(0,n.jsx)("span",{children:Te?.humanized})})},size:2}),ce&&Se.push({id:"group",label:(0,o.t)("alerting.use-columns.label.group","Group"),renderCell:({data:Me})=>{const{namespace:Te,group:Ge}=Me;return Ge.name==="default"?(0,n.jsx)(I.c,{namespace:Te.name}):(0,n.jsx)(I.c,{namespace:Te.name,group:Ge.name})},size:5}),Se.push({id:"actions",label:(0,o.t)("alerting.use-columns.label.actions","Actions"),renderCell:({data:Me})=>(0,n.jsx)(de,{rule:Me,isLoadingRuler:Ie}),size:"215px"}),Se},[Pe,me,ce,Ie])}function ue({rule:me}){const{isDeleting:ce,isCreating:Pe,isPaused:Ie}=he(me);return(0,n.jsx)(J,{rule:me,isDeleting:ce,isCreating:Pe,isPaused:Ie})}function de({rule:me,isLoadingRuler:ce}){const Pe=(0,d.of)(ne),{isDeleting:Ie,isCreating:Se}=he(me);return ce?(0,n.jsx)(l.A,{containerClassName:Pe.skeletonWrapper}):(0,n.jsx)(W.l,{compact:!0,showViewButton:!Ie&&!Se,rule:me,rulesSource:me.namespace.rulesSource})}function ie(me){const ce=(0,f.$)(Se=>Se.rulerRules),Pe=(0,D.EV)(me);return!!ce[Pe]?.result}function he(me){const ce=me.namespace.rulesSource,Pe=ie(ce),{hasRuler:Ie}=(0,v.y)(ce),{promRule:Se,rulerRule:Me}=me;if(Y&&!C.p.grafana.rule(Me))return{isDeleting:!1,isCreating:!1,isPaused:!1};const Te=!!(Ie&&Pe&&Se&&!Me),Ge=!!(Ie&&Pe&&Me&&!Se),Qe=C.p.grafana.rule(Me)&&(0,C.hC)(Me);return{isDeleting:Te,isCreating:Ge,isPaused:Qe}}},83903:(Z,R,e)=>{"use strict";e.d(R,{y:()=>o});var n=e(74848),a=e(84266),s=e(67834);const l={[a.Or.Active]:"bad",[a.Or.Unprocessed]:"neutral",[a.Or.Suppressed]:"info"},o=({state:d})=>(0,n.jsx)(s.O,{state:l[d],children:d})},2218:(Z,R,e)=>{"use strict";e.d(R,{A:()=>p});var n=e(74848),a=e(96540),s=e(92745),l=e(8207),o=e(41654),d=e(24158),i=e(52161),c=e(5358);const p=a.memo(({ruleUid:h,onClose:r})=>(0,n.jsx)(l._,{title:(0,s.t)("alerting.silence-grafana-rule-drawer.title-silence-alert-rule","Silence alert rule"),subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:r,size:"md",children:(0,n.jsx)(o.B,{direction:"column",children:(0,n.jsx)(c.b9,{accessType:"instance",children:(0,n.jsx)(d.SilencesEditor,{ruleUid:h,alertManagerSourceName:i.hY,onSilenceCreated:r,onCancel:r})})})}),(h,r)=>h.ruleUid===r.ruleUid)},24158:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{SilencesEditor:()=>Pe,default:()=>Me});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(49785),d=e(54148),i=e(40996),c=e(74529),m=e(25229),p=e(92745),h=e(68143),r=e(36490),g=e(43173),y=e(6975),v=e(34999),x=e(63142),f=e(16780),u=e(37386),b=e(63527),E=e(87105),D=e(41654),C=e(45861),P=e(62421),T=e(95443),O=e(52161),I=e(84266),j=e(16692),W=e(5358),B=e(86017),S=e(77256),w=e(88547),N=e(36826),M=e(58750),L=e(3271),A=e(18857),U=e(76319),F=e(70327);const V=({className:Te,required:Ge,ruleUid:Qe})=>{const tt=(0,x.of)(K),ke=(0,o.xW)(),{control:He,register:Re,formState:{errors:Ne}}=ke,{fields:Ae=[],append:Ue,remove:Be}=(0,o.jz)({name:"matchers"}),[We,{data:_e}]=F.hK.endpoints.getAlertRule.useLazyQuery();return(0,l.useEffect)(()=>{Qe&&We({uid:Qe})},[We,Qe]),(0,n.jsx)("div",{className:Te,children:(0,n.jsx)(u.D,{label:(0,p.t)("alerting.matchers-field.label-refine-affected-alerts","Refine affected alerts"),required:Ge,children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:(0,a.cx)(tt.matchers,tt.indent),children:[_e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(u.D,{label:(0,p.t)("alerting.matchers-field.label-alert-rule","Alert rule"),disabled:!0,children:(0,n.jsx)(b.p,{id:"alert-rule-name",defaultValue:_e.grafana_alert.title,disabled:!0})}),(0,n.jsx)(L.c,{})]}),Ae.map((Xe,le)=>(0,n.jsxs)("div",{className:tt.row,"data-testid":"matcher",children:[(0,n.jsx)(u.D,{label:(0,p.t)("alerting.matchers-field.label-label","Label"),invalid:!!Ne?.matchers?.[le]?.name,error:Ne?.matchers?.[le]?.name?.message,children:(0,n.jsx)(b.p,{...Re(`matchers.${le}.name`,{required:{value:Ge,message:(0,p.t)("alerting.matchers-field.message.required","Required.")}}),defaultValue:Xe.name,placeholder:(0,p.t)("alerting.matchers-field.placeholder-label","label"),id:`matcher-${le}-label`})}),(0,n.jsx)(u.D,{label:(0,p.t)("alerting.matchers-field.label-operator","Operator"),children:(0,n.jsx)(o.xI,{control:He,render:({field:{onChange:ye,ref:pe,...ve}})=>(0,n.jsx)(A.l6,{...ve,onChange:be=>ye(be.value),className:tt.matcherOptions,options:B.xH,"aria-label":(0,p.t)("alerting.matchers-field.aria-label-operator","operator"),id:`matcher-${le}-operator`}),defaultValue:Xe.operator||B.xH[0].value,name:`matchers.${le}.operator`,rules:{required:{value:Ge,message:(0,p.t)("alerting.matchers-field.message.required","Required.")}}})}),(0,n.jsx)(u.D,{label:(0,p.t)("alerting.matchers-field.label-value","Value"),invalid:!!Ne?.matchers?.[le]?.value,error:Ne?.matchers?.[le]?.value?.message,children:(0,n.jsx)(b.p,{...Re(`matchers.${le}.value`,{required:{value:Ge,message:(0,p.t)("alerting.matchers-field.message.required","Required.")}}),defaultValue:Xe.value,placeholder:(0,p.t)("alerting.matchers-field.placeholder-value","value"),id:`matcher-${le}-value`})}),(Ae.length>1||!Ge)&&(0,n.jsx)(U.K,{"aria-label":(0,p.t)("alerting.matchers-field.aria-label-remove-matcher","Remove matcher"),className:tt.removeButton,name:"trash-alt",onClick:()=>Be(le),children:(0,n.jsx)(p.x6,{i18nKey:"alerting.matchers-field.remove",children:"Remove"})})]},`${Xe.id}`))]}),(0,n.jsx)(C.$n,{className:tt.indent,tooltip:(0,p.t)("alerting.matchers-field.tooltip-refine-which-alert-instances-silenced-selecting","Refine which alert instances are silenced by selecting label matchers"),type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Xe={name:"",value:"",operator:I.ho.equal};Ue(Xe)},children:(0,n.jsx)(p.x6,{i18nKey:"alerting.matchers-field.add-matcher",children:"Add matcher"})})]})})})},K=Te=>({wrapper:(0,a.css)({marginTop:Te.spacing(2)}),row:(0,a.css)({marginTop:Te.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:Te.colors.background.secondary,padding:`${Te.spacing(1)} ${Te.spacing(1)} 0 ${Te.spacing(1)}`,"& > * + *":{marginLeft:Te.spacing(2)}}),removeButton:(0,a.css)({marginLeft:Te.spacing(1),marginTop:Te.spacing(2.5)}),matcherOptions:(0,a.css)({minWidth:"140px"}),matchers:(0,a.css)({maxWidth:`${Te.breakpoints.values.sm}px`,margin:`${Te.spacing(1)} 0`,paddingTop:Te.spacing(.5)}),indent:(0,a.css)({marginLeft:Te.spacing(2)})}),G=V;var H=e(56265);const _=()=>{const{control:Te,getValues:Ge}=(0,o.xW)(),{field:{onChange:Qe,value:tt},fieldState:{invalid:ke}}=(0,o.as)({name:"startsAt",control:Te,rules:{validate:Xe=>Ge().endsAt>Xe}}),{field:{onChange:He,value:Re},fieldState:{invalid:Ne}}=(0,o.as)({name:"endsAt",control:Te,rules:{validate:Xe=>Ge().startsAt<Xe}}),{field:{onChange:Ae,value:Ue}}=(0,o.as)({name:"timeZone",control:Te}),Be=ke||Ne,We=(0,m.KQ)(tt),_e=(0,m.KQ)(Re);return(0,n.jsx)(u.D,{className:k.timeRange,label:(0,p.t)("alerting.silence-period.label-silence-start-and-end","Silence start and end"),error:Be?"To is before or the same as from":"",invalid:Be,children:(0,n.jsx)(H.b,{value:{from:We,to:_e,raw:{from:We,to:_e}},timeZone:Ue,onChange:Xe=>{Qe((0,m.KQ)(Xe.from)),He((0,m.KQ)(Xe.to))},onChangeTimeZone:Xe=>Ae(Xe),hideTimeZone:!1,hideQuickRanges:!0,placeholder:(0,p.t)("alerting.silence-period.placeholder-select-time-range","Select time range")})})},k={timeRange:(0,a.css)({width:"400px"})};var J=e(45214),z=e(45967),Y=e(30703),X=e(99887),Q=e(91984),q=e(15629),te=e(7840),ne=e(6106),se=e(83903);const ue=(Te,Ge,Qe)=>{const[tt,ke]=(0,l.useState)();(0,i.A)(Te,Ge,[tt]),(0,J.A)(()=>{ke(Qe)},[Qe])},de=({amSourceName:Te,matchers:Ge,ruleUid:Qe})=>{const tt=[...Qe?[{name:T.kW,value:Qe,operator:I.ho.equal}]:[],...Ge].map(B.Wc),ke=Q.m.endpoints.getAlertmanagerAlerts.useLazyQuery,He=(0,x.of)(he),Re=ie(),Ne=Qe||Ge.some(Xe=>Xe.value&&Xe.name),[Ae,{currentData:Ue=[],isFetching:Be,isError:We}]=ke();if(ue(()=>{Ne&&Ae({amSourceName:Te,filter:{matchers:tt}})},500,[Te,tt]),We)return(0,n.jsx)(v.F,{title:(0,p.t)("alerting.silenced-instances-preview.title-preview-not-available","Preview not available"),severity:"error",children:(0,n.jsx)(p.x6,{i18nKey:"alerting.silenced-instances-preview.error-generating-preview",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"})});const _e=Ue.map(Xe=>({id:Xe.fingerprint,data:Xe}));return(0,n.jsxs)("div",{children:[(0,n.jsxs)("h4",{className:He.title,children:[(0,n.jsx)(p.x6,{i18nKey:"alerting.silences.affected-instances",children:"Affected alert instances"}),(0,n.jsx)(z.m,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(p.x6,{i18nKey:"alerting.silences.preview-affected-instances",children:"Preview the alert instances affected by this silence."}),(0,n.jsx)("br",{}),(0,n.jsx)(p.x6,{i18nKey:"alerting.silences.only-firing-instances",children:"Only alert instances in the firing state are displayed."})]}),children:(0,n.jsxs)("span",{children:["\xA0",(0,n.jsx)(Y.I,{name:"info-circle",size:"sm"})]})}),_e.length>0?(0,n.jsx)(X.E,{className:He.badge,color:"blue",text:_e.length}):null]}),!Ne&&(0,n.jsx)("span",{children:(0,n.jsx)(p.x6,{i18nKey:"alerting.silenced-instances-preview.valid-matcher-affected-alerts",children:"Add a valid matcher to see affected alerts"})}),Be&&(0,n.jsx)(y._,{text:(0,p.t)("alerting.silenced-instances-preview.text-loading-affected-alert-rule-instances","Loading affected alert rule instances...")}),!Be&&!We&&Ne&&(0,n.jsx)("div",{className:He.table,children:_e.length>0?(0,n.jsx)(ne.E,{items:_e,isExpandable:!1,cols:Re,pagination:{itemsPerPage:10}}):(0,n.jsx)("span",{children:(0,n.jsx)(p.x6,{i18nKey:"alerting.silenced-instances-preview.no-firing-alert-instances-found",children:"No firing alert instances found"})})})]})};function ie(){const Te=(0,x.of)(he);return[{id:"state",label:(0,p.t)("alerting.use-columns.label.state","State"),renderCell:function({data:Qe}){return(0,n.jsx)(se.y,{state:Qe.status.state})},size:"120px",className:Te.stateColumn},{id:"labels",label:(0,p.t)("alerting.use-columns.label.labels","Labels"),renderCell:function({data:Qe}){return(0,n.jsx)(te.m,{labels:Qe.labels,size:"sm"})},size:"auto"},{id:"created",label:(0,p.t)("alerting.use-columns.label.created","Created"),renderCell:function({data:Qe}){return(0,n.jsx)(n.Fragment,{children:(0,q.mo)(Qe.startsAt)?"-":(0,m.KQ)(Qe.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const he=Te=>({table:(0,a.css)({maxWidth:`${Te.breakpoints.values.lg}px`}),moreMatches:(0,a.css)({marginTop:Te.spacing(1)}),title:(0,a.css)({display:"flex",alignItems:"center"}),badge:(0,a.css)({marginLeft:Te.spacing(1)}),stateColumn:(0,a.css)({display:"flex",alignItems:"center"})});var me=e(39947);const ce=()=>{const{id:Te=""}=(0,d.g)(),{selectedAlertmanager:Ge=""}=(0,W.VI)(),{data:Qe,isLoading:tt,error:ke}=P.F.endpoints.getSilence.useQuery({id:Te,datasourceUid:(0,O.w5)(Ge),ruleMetadata:!0,accessControl:!0}),He=Qe?.matchers?.find(Be=>Be.name===T.kW)?.value,Re=Ge===O.hY,Ne=(0,l.useMemo)(()=>{if(!Qe)return;const Be=Qe.matchers?.filter(We=>We.name!==T.kW);return(0,me.Ee)({...Qe,matchers:Be})},[Qe]);return Te&&tt?(0,n.jsx)(y._,{text:(0,p.t)("alerting.existing-silence-editor.text-loading-existing-silence-information","Loading existing silence information...")}):(0,h.NF)(ke)&&ke.status===404?(0,n.jsx)(v.F,{title:(0,p.t)("alerting.existing-silence-editor.title-silence-not-found",'Existing silence "{{silenceId}}" not found',{silenceId:Te}),severity:"warning"}):(Re?Qe?.accessControl?.write:!0)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.M,{currentAlertmanager:Ge}),(0,n.jsx)(Pe,{ruleUid:He,formValues:Ne,alertManagerSourceName:Ge})]}):(0,n.jsx)(v.F,{title:(0,p.t)("alerting.existing-silence-editor.title-permission-editrecreate-silence","You do not have permission to edit/recreate this silence"),severity:"error"})},Pe=({formValues:Te=(0,me.Di)(),alertManagerSourceName:Ge,onSilenceCreated:Qe,onCancel:tt,ruleUid:ke})=>{const[He,Re]=(0,j.L7)(j.QI.PreviewSilencedInstances),Ne=He&&Re,[Ae,{isLoading:Ue}]=P.F.endpoints.createSilence.useMutation(),Be=(0,o.mN)({defaultValues:Te}),We=(0,x.of)(Ie),{register:_e,handleSubmit:Xe,formState:le,watch:ye,setValue:pe,clearErrors:ve}=Be,[be,Oe,we,ze]=ye(["duration","startsAt","endsAt","matchers"]),Ve=()=>{r.Ny.push((0,S.nL)("/alerting/silences",Ge))},ge=Qe||Ve,Ke=tt||Ve,qe=async Lt=>{const{id:Tt,startsAt:It,endsAt:Mt,comment:Ut,createdBy:an,matchers:cn}=Lt;ke&&cn.push({name:T.kW,value:ke,operator:I.ho.equal});const un=cn.map(B.Wc).filter(yn=>yn.name&&yn.value),On=(0,s.pickBy)({id:Tt,startsAt:It,endsAt:Mt,comment:Ut,createdBy:an,matchers:un},yn=>!!yn);await Ae({datasourceUid:(0,O.w5)(Ge),payload:On}).unwrap().then(yn=>{ge?.(yn)})},[ot,lt]=(0,l.useState)(be);(0,i.A)(()=>{if((0,c.vd)(Oe)&&(0,c.vd)(we))if(be!==ot)pe("endsAt",(0,m.KQ)((0,c.Ri)(new Date(Oe),(0,c.E9)(be))).toISOString()),lt(be);else{const Lt=new Date(Oe).valueOf();if(new Date(we).valueOf()>Lt){const It=(0,c.dU)({start:new Date(Oe),end:new Date(we)});pe("duration",It),lt(It)}}},700,[ve,be,we,ot,pe,Oe]);const mt=!!(g.$.bootData.user.isSignedIn&&g.$.bootData.user.name);return(0,n.jsx)(o.Op,{...Be,children:(0,n.jsxs)("form",{onSubmit:Xe(qe),children:[(0,n.jsxs)(f.n,{className:We.formContainer,children:[(0,n.jsxs)("div",{className:We.silencePeriod,children:[(0,n.jsx)(_,{}),(0,n.jsx)(u.D,{label:(0,p.t)("alerting.silences-editor.label-duration","Duration"),invalid:!!le.errors.duration,error:le.errors.duration&&(le.errors.duration.type==="required"?"Required field":le.errors.duration.message),children:(0,n.jsx)(b.p,{..._e("duration",{validate:Lt=>Object.keys((0,c.E9)(Lt)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,n.jsx)(G,{required:!ke,ruleUid:ke}),(0,n.jsx)(u.D,{label:(0,p.t)("alerting.silences-editor.label-comment","Comment"),required:!0,error:le.errors.comment?.message,invalid:!!le.errors.comment,children:(0,n.jsx)(E.f,{..._e("comment",{required:{value:!0,message:(0,p.t)("alerting.silences-editor.message.required","Required.")}}),rows:5,placeholder:(0,p.t)("alerting.silences-editor.comment-placeholder-details-about-the-silence","Details about the silence"),id:"comment"})}),!mt&&(0,n.jsx)(u.D,{label:(0,p.t)("alerting.silences-editor.label-created-by","Created By"),required:!0,error:le.errors.createdBy?.message,invalid:!!le.errors.createdBy,children:(0,n.jsx)(b.p,{..._e("createdBy",{required:{value:!0,message:(0,p.t)("alerting.silences-editor.message.required","Required.")}}),placeholder:(0,p.t)("alerting.silences-editor.placeholder-whos-creating-the-silence","Who's creating the silence")})}),Ne&&(0,n.jsx)(de,{amSourceName:Ge,matchers:ze,ruleUid:ke})]}),(0,n.jsxs)(D.B,{gap:1,children:[Ue&&(0,n.jsx)(C.$n,{disabled:!0,icon:"spinner",variant:"primary",children:(0,n.jsx)(p.x6,{i18nKey:"alerting.silences-editor.saving",children:"Saving..."})}),!Ue&&(0,n.jsx)(C.$n,{type:"submit",children:(0,n.jsx)(p.x6,{i18nKey:"alerting.silences-editor.save-silence",children:"Save silence"})}),(0,n.jsx)(C.z9,{onClick:Ke,variant:"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})]})})},Ie=Te=>({formContainer:(0,a.css)({maxWidth:Te.breakpoints.values.md}),alertRule:(0,a.css)({paddingBottom:Te.spacing(2)}),silencePeriod:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:Te.spacing(1),maxWidth:Te.breakpoints.values.sm,paddingTop:Te.spacing(2)})});function Se(){const Te={id:"silence-edit",text:(0,p.t)("alerting.existing-silence-editor-page.page-nav.text.edit-silence","Edit silence"),subTitle:"Recreate existing silence to stop notifications from a particular alert rule"};return(0,n.jsx)(N.y,{navId:"silences",pageNav:Te,accessType:"instance",children:(0,n.jsx)(ce,{})})}const Me=(0,w.S)(Se)},39947:(Z,R,e)=>{"use strict";e.d(R,{Di:()=>h,Ee:()=>p,LP:()=>m});var n=e(74529),a=e(22592),s=e(25229),l=e(43173),o=e(86017),d=e(95443),i=e(63895),c=e(84266);const m=r=>{const g={},y=r.get("comment"),x=r.getAll("matcher").filter(u=>!u.startsWith(d.kW)),f=(0,i.ou)(x);return f.length&&(g.matchers=f.map(o.MU)),y&&(g.comment=y),g},p=r=>{const g=new Date,v=Date.parse(r.endsAt)<Date.now()?{start:g,end:(0,n.Ri)(g,{hours:2})}:{start:new Date(r.startsAt),end:new Date(r.endsAt)};return{id:r.id,startsAt:v.start.toISOString(),endsAt:v.end.toISOString(),comment:r.comment,createdBy:r.createdBy,duration:(0,n.dU)(v),isRegex:!1,matchers:r.matchers?.map(o.MU)||[],matcherName:"",matcherValue:"",timeZone:a.lE}},h=r=>{const g=new Date,y=(0,n.Ri)(g,{hours:2});return{id:"",startsAt:g.toISOString(),endsAt:y.toISOString(),comment:`created ${(0,s.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:l.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:a.lE,matchers:[{name:"",value:"",operator:c.ho.equal}],...r}}},17349:(Z,R,e)=>{"use strict";e.d(R,{X:()=>a});var n=e(11257);const a=[n.w.AlertingTemplatesRead,n.w.AlertingTemplatesWrite,n.w.AlertingTemplatesDelete]},74869:(Z,R,e)=>{"use strict";e.d(R,{VB:()=>i,f2:()=>d,sk:()=>o,wS:()=>l});var n=e(43173),a=e(1487),s=e(77256);const l=()=>n.$.featureToggles.alertingPrometheusRulesPrimary??!1,o=()=>{const c=(0,a.H)("alertingListViewV2");return n.$.featureToggles.alertingListViewV2PreviewToggle&&c!==void 0?c:n.$.featureToggles.alertingListViewV2},d=()=>((0,s.qc)()&&n.$.featureToggles.alertingRuleRecoverDeleted&&n.$.featureToggles.alertRuleRestore)??!1,i=()=>(d()&&n.$.featureToggles.alertingRulePermanentlyDelete)??!1},75756:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>d});var n=e(92745),a=e(70327),s=e(96137),l=e(80218),o=e(71639);function d(){const[i]=(0,o.D)(),[c]=a.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[m]=a.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,l.Yb)(async(p,h)=>{const{groupName:r,namespaceName:g}=p,y=(0,s.KH)({identifier:h}),{newRuleGroupDefinition:v,rulerConfig:x}=await i(p,[y]),f=(0,n.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return v.rules.length===0?m({rulerConfig:x,namespace:g,group:r,notificationOptions:{successMessage:f}}).unwrap():c({rulerConfig:x,namespace:g,payload:v,notificationOptions:{successMessage:f}}).unwrap()})}},71639:(Z,R,e)=>{"use strict";e.d(R,{D:()=>r,_:()=>h});var n=e(86791),a=e(70327),s=e(55143),l=e(62939),o=e(96137),d=e(84523),i=e(52161);const c=!0,{useLazyGetRuleGroupForNamespaceQuery:m}=a.hK,{useLazyDiscoverDsFeaturesQuery:p}=s.L,h=y=>new Error(`DataSource ${y} does not support ruler API or does not have the ruler API enabled.`);function r(){const[y,v]=m(),[x]=p();return[async(u,b)=>{const{dataSourceName:E,groupName:D,namespaceName:C}=u,P=E==="grafana"?n.l$:(0,i.w5)(E),{rulerConfig:T}=await x({uid:P},c).unwrap();if(!T)throw h(E);const O=await y({rulerConfig:T,namespace:C,group:D,notificationOptions:{showErrorAlert:!1}}).unwrap().catch(l.R),I=O??g(D);return{newRuleGroupDefinition:b.reduce((W,B)=>(O&&o.Qn.match(B)&&(B.payload.interval=O.interval),(0,o.i3)(W,B)),I),rulerConfig:T}},v]}const g=y=>({name:y,interval:d.T6,rules:[]})},23390:(Z,R,e)=>{"use strict";e.d(R,{d:()=>h,pU:()=>r});var n=e(1932),a=e(2543),s=e.n(a),l=e(92745),o=e(70327),d=e(96137),i=e(29609),c=e(80218),m=e(75756),p=e(71639);function h(){const[v]=(0,p.D)(),[x]=o.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),f=(0,l.t)("alerting.rules.add-rule.success","Rule added successfully");return(0,c.Yb)(async(u,b,E)=>{const{namespaceName:D}=u,C=(0,d.Qn)({rule:b,interval:E,groupName:u.groupName}),{newRuleGroupDefinition:P,rulerConfig:T}=await v(u,[C]);return x({rulerConfig:T,namespace:D,payload:P,notificationOptions:{successMessage:f}}).unwrap()})}function r(){const[v]=(0,p.D)(),[x]=g(),[f]=o.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),u=(0,l.t)("alerting.rules.update-rule.success","Rule updated successfully");return(0,c.Yb)(async(b,E,D,C,P)=>{const{namespaceName:T}=b,O=y(E,D),I=(0,a.isEqual)(b,C);if(C&&!I)return x.execute(b,C,E,D,P);const j=(0,d.Wu)({identifier:E,rule:O}),{newRuleGroupDefinition:W,rulerConfig:B}=await v(b,[j]);return f({rulerConfig:B,namespace:T,payload:W,notificationOptions:{successMessage:u}}).unwrap()})}function g(){const[v]=(0,p.D)(),[x]=(0,m.Y)(),[f]=o.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),u=(0,l.t)("alerting.rules.update-rule.success","Rule updated successfully");return(0,c.Yb)(async(b,E,D,C,P)=>{const T=y(D,C),O=(0,d.Qn)({rule:T,interval:P}),{newRuleGroupDefinition:I,rulerConfig:j}=await v(E,[O]),W=await f({rulerConfig:j,namespace:E.namespaceName,payload:I,notificationOptions:{successMessage:u}}).unwrap();return(0,i.A4)(D)||await x.execute(b,D),W})}function y(v,x){const f=(0,i.A4)(v);return(0,n.jM)(x,u=>{const b=i.p.grafana.rule(u);f&&b&&(u.grafana_alert.uid=v.uid)})}},11504:(Z,R,e)=>{"use strict";e.d(R,{G:()=>s});var n=e(96540),a=e(29609);function s(l){return(0,n.useMemo)(()=>(0,a.fC)(l),[l])}},16692:(Z,R,e)=>{"use strict";e.d(R,{$m:()=>u,Ej:()=>O,Es:()=>A,Gy:()=>B,Hl:()=>K,L7:()=>V,M6:()=>U,QI:()=>x,RY:()=>b,aw:()=>P,e2:()=>T,hT:()=>L,iI:()=>F,j5:()=>f,mW:()=>W,mh:()=>I});var n=e(96540),a=e(15130),s=e(76070),l=e(66513),o=e(88114),d=e(18404),i=e(84266),c=e(11257),m=e(91984),p=e(5358),h=e(54),r=e(67598),g=e(77256),y=e(29609),v=e(12770),x=(Y=>(Y.ViewExternalConfiguration="view-external-configuration",Y.UpdateExternalConfiguration="update-external-configuration",Y.CreateContactPoint="create-contact-point",Y.ViewContactPoint="view-contact-point",Y.UpdateContactPoint="edit-contact-points",Y.DeleteContactPoint="delete-contact-point",Y.ExportContactPoint="export-contact-point",Y.CreateNotificationTemplate="create-notification-template",Y.ViewNotificationTemplate="view-notification-template",Y.UpdateNotificationTemplate="edit-notification-template",Y.DeleteNotificationTemplate="delete-notification-template",Y.DecryptSecrets="decrypt-secrets",Y.CreateNotificationPolicy="create-notification-policy",Y.ViewNotificationPolicyTree="view-notification-policy-tree",Y.UpdateNotificationPolicyTree="update-notification-policy-tree",Y.DeleteNotificationPolicy="delete-notification-policy",Y.ExportNotificationPolicies="export-notification-policies",Y.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",Y.CreateSilence="create-silence",Y.ViewSilence="view-silence",Y.UpdateSilence="update-silence",Y.PreviewSilencedInstances="preview-silenced-alerts",Y.ViewTimeInterval="view-time-interval",Y.CreateTimeInterval="create-time-interval",Y.UpdateTimeInterval="update-time-interval",Y.DeleteTimeInterval="delete-time-interval",Y.ExportTimeIntervals="export-time-intervals",Y.ViewAlertGroups="view-alert-groups",Y))(x||{}),f=(Y=>(Y.Duplicate="duplicate-alert-rule",Y.View="view-alert-rule",Y.Update="update-alert-rule",Y.Delete="delete-alert-rule",Y.Explore="explore-alert-rule",Y.Silence="silence-alert-rule",Y.ModifyExport="modify-export-rule",Y.Pause="pause-alert-rule",Y.Restore="restore-alert-rule",Y.DeletePermanently="delete-alert-rule-permanently",Y))(f||{}),u=(Y=>(Y.Pause="pause-folder",Y.Delete="delete-folder",Y))(u||{}),b=(Y=>(Y.CreateAlertRule="create-alert-rule",Y.ViewAlertRule="view-alert-rule",Y.UpdateAlertRule="update-alert-rule",Y.DeleteAlertRule="delete-alert-rule",Y.ExportGrafanaManagedRules="export-grafana-managed-rules",Y.ReadConfigurationStatus="read-configuration-status",Y.CreateExternalAlertRule="create-external-alert-rule",Y.ViewExternalAlertRule="view-external-alert-rule",Y.UpdateExternalAlertRule="update-external-alert-rule",Y.DeleteExternalAlertRule="delete-external-alert-rule",Y))(b||{});const E=!0,D=!1,C=()=>({"pause-folder":[E,(0,g.qc)()],"delete-folder":[E,(0,g.qc)()]}),P=Y=>C()[Y],T=()=>({"create-alert-rule":z(E,c.w.AlertingRuleCreate),"view-alert-rule":z(E,c.w.AlertingRuleRead),"update-alert-rule":z(E,c.w.AlertingRuleUpdate),"delete-alert-rule":z(E,c.w.AlertingRuleDelete),"export-grafana-managed-rules":z(E,c.w.AlertingRuleRead),"read-configuration-status":[E,a.TP.hasPermission(c.w.AlertingInstanceRead)||a.TP.hasPermission(c.w.AlertingNotificationsRead)],"create-external-alert-rule":z(E,c.w.AlertingRuleExternalWrite),"view-external-alert-rule":z(E,c.w.AlertingRuleExternalRead),"update-external-alert-rule":z(E,c.w.AlertingRuleExternalWrite),"delete-external-alert-rule":z(E,c.w.AlertingRuleExternalWrite)}),O=Y=>T()[Y];function I(Y,X){const Q=S(Y);return(0,n.useMemo)(()=>Q[X],[Q,X])}function j(Y,X){const Q=S(Y);return useMemo(()=>X.map(q=>Q[q]),[Q,X])}function W(Y,X,Q){const q=w(Y,X);return(0,n.useMemo)(()=>q[Q],[q,Q])}function B(Y,X,Q){const q=w(Y,X);return(0,n.useMemo)(()=>Q.map(te=>q[te]),[q,Q])}function S(Y){const X=(0,n.useMemo)(()=>r.HA.fromCombinedRule(Y),[Y]);return w(Y.rulerRule,X)}function w(Y,X){const Q=(0,r.rO)(X),{isEditable:q,isRemovable:te,isRulerAvailable:ne=!1,loading:se}=(0,v.g)(Q,Y),[ue,de]=O("export-grafana-managed-rules"),ie=H(Y);return(0,n.useMemo)(()=>{const me=Y?(0,y.Nv)(Y):!1,ce=!1,Pe=y.p.grafana.rule(Y),Ie=(0,y.Tm)(Y),Se=me||ce||Ie,Me=se?D:ne,Te=Se?D:Me,Ge=Ie?D:Me,Qe=(0,h.Wd)(Q);return{"duplicate-alert-rule":z(Ge,Qe.create),"view-alert-rule":z(E,Qe.read),"update-alert-rule":[Te,q??!1],"delete-alert-rule":[Te,te??!1],"explore-alert-rule":z(E,c.w.DataSourcesExplore),"silence-alert-rule":ie,"modify-export-rule":[Pe,de],"pause-alert-rule":[Te&&Pe,q??!1],"restore-alert-rule":[Te&&Pe,q??!1],"delete-alert-rule-permanently":[Te&&Pe,(te&&(0,g.qc)())??!1]}},[Y,se,ne,Q,q,te,ie,de])}function N(Y){const{isEditable:X,isRemovable:Q,loading:q}=M(Y),[te,ne]=O("export-grafana-managed-rules"),se=k(),ue=_(Y?.folderUid);return(0,n.useMemo)(()=>{const ie=Y?(0,y.bL)(Y):!1,he=!1,me=y.R$.grafana.alertingRule(Y),ce=(0,y.Tm)(Y),Pe=ie||he||ce,Ie=q?D:E,Se=Pe?D:Ie,Me=ce?D:Ie,Te=(0,h.Wd)("grafana");return{"duplicate-alert-rule":z(Me,Te.create),"view-alert-rule":z(E,Te.read),"update-alert-rule":[Se,X??!1],"delete-alert-rule":[Se,Q??!1],"explore-alert-rule":z(E,c.w.DataSourcesExplore),"silence-alert-rule":[se,ue&&me],"modify-export-rule":[me,ne],"pause-alert-rule":[Se&&me,X??!1],"restore-alert-rule":[Se&&me,X??!1],"delete-alert-rule-permanently":[Se&&me,(Q&&(0,g.qc)())??!1]}},[Y,q,X,Q,ue,ne,se])}function M(Y){const X=Y?.folderUid,{folder:Q,loading:q}=(0,d.a)(X);return(0,n.useMemo)(()=>{if(!Y||!X)return{isEditable:!1,isRemovable:!1,loading:!1};if(!Q)return{isEditable:!1,isRemovable:!1,loading:q};const te=(0,h.Wd)("grafana"),ne=a.TP.hasPermissionInMetadata(te.update,Q),se=a.TP.hasPermissionInMetadata(te.delete,Q);return{isEditable:ne,isRemovable:se,loading:q}},[Y,X,Q,q])}const L=Symbol("ability-skip-token");function A(Y,X){const Q=N(Y===L?void 0:Y);return(0,n.useMemo)(()=>Q[X],[Q,X])}function U(Y,X){const Q=N(Y===L?void 0:Y);return(0,n.useMemo)(()=>X.map(q=>Q[q]),[Q,X])}function F(){const{selectedAlertmanager:Y,hasConfigurationAPI:X,isGrafanaAlertmanager:Q}=(0,p.VI)(),q=(0,h.lV)(Y),te=(0,h.jy)(Y);return{"view-external-configuration":z(E,c.w.AlertingNotificationsExternalRead),"update-external-configuration":z(X,c.w.AlertingNotificationsExternalWrite),"create-contact-point":z(X,q.create,...Q?[c.w.AlertingReceiversCreate]:[]),"view-contact-point":z(E,q.read,...Q?s.PE:[]),"edit-contact-points":z(X,q.update,...Q?[c.w.AlertingReceiversWrite]:[]),"delete-contact-point":z(X,q.delete,...Q?[c.w.AlertingReceiversWrite]:[]),"export-contact-point":[Q,Q],"create-notification-template":z(X,q.create,...Q?[c.w.AlertingTemplatesWrite]:[]),"view-notification-template":z(E,q.read,...Q?[c.w.AlertingTemplatesRead]:[]),"edit-notification-template":z(X,q.update,...Q?[c.w.AlertingTemplatesWrite]:[]),"delete-notification-template":z(X,q.delete),"create-notification-policy":z(X,q.create,...Q?o.nv:[]),"view-notification-policy-tree":z(E,q.read,...Q?o.rw:[]),"update-notification-policy-tree":z(X,q.update,...Q?o.nv:[]),"delete-notification-policy":z(X,q.delete,...Q?o.nv:[]),"export-notification-policies":z(Q,q.read),"decrypt-secrets":z(Q,q.provisioning.readSecrets),"view-autogenerated-policy-tree":[Q,(0,g.qc)()],"create-silence":z(E,te.create),"view-silence":z(E,te.read),"update-silence":z(E,te.update),"preview-silenced-alerts":z(E,te.read),"create-time-interval":z(X,q.create,...Q?l.Zr:[]),"view-time-interval":z(E,q.read,...Q?l.xK:[]),"update-time-interval":z(X,q.update,...Q?l.Zr:[]),"delete-time-interval":z(X,q.delete,...Q?l.Zr:[]),"export-time-intervals":z(Q,q.read),"view-alert-groups":z(E,te.read)}}function V(Y){const X=F();return(0,n.useMemo)(()=>X[Y],[X,Y])}function K(Y){const X=F();return(0,n.useMemo)(()=>Y.map(Q=>X[Q]),[X,Y])}const{useGetGrafanaAlertingConfigurationStatusQuery:G}=m.m;function H(Y){const X=y.p.grafana.rule(Y)?Y.grafana_alert.namespace_uid:void 0,{loading:Q,folder:q}=(0,d.a)(X),te=Y&&y.p.grafana.rule(Y),ne=y.p.grafana.recordingRule(Y),se=k(),ue=_(X);return Y?!te||ne||Q||!q?[!1,!1]:[se,ue]:[!1,!1]}function _(Y){const Q=J(Y)[c.w.AlertingSilenceCreate]??!1;return a.TP.hasPermission(c.w.AlertingInstanceCreate)||Q}function k(){const{currentData:Y,isLoading:X}=G(void 0),Q=Y?.alertmanagersChoice===i.nA.External,q=Y?.alertmanagersChoice===i.nA.All;return X?!1:!Q||q}function J(Y){const{folder:X}=(0,d.a)(Y);return X?.accessControl??{}}const z=(Y,...X)=>[Y,X.some(Q=>Q&&a.TP.hasPermission(Q))]},93395:(Z,R,e)=>{"use strict";e.d(R,{W:()=>s});var n=e(96540),a=e(52161);function s(l){return(0,n.useMemo)(()=>(0,a.sq)(l),[l])}},55096:(Z,R,e)=>{"use strict";e.d(R,{g:()=>l});var n=e(96540),a=e(36580),s=e(78282);function l(o){return{allDataSourcesAvailable:(0,n.useMemo)(()=>o.filter(i=>!(0,a.s9)(i.datasourceUid)).every(i=>!!(0,s.l)().getInstanceSettings(i.datasourceUid)),[o])}}},80218:(Z,R,e)=>{"use strict";e.d(R,{Gz:()=>p,VP:()=>m,Yb:()=>l,bJ:()=>d});var n=e(74848),a=e(96540),s=e(77256);function l(r,g){const[y,v]=(0,a.useState)({status:"not-executed",error:void 0,result:g}),x=(0,a.useRef)(),f=(0,a.useRef)(),u=o({execute(...b){f.current=b;const E=r(...b);return x.current=E,v(D=>({...D,status:"loading"})),E.then(D=>{E===x.current&&v(C=>({...C,status:"success",error:void 0,result:D}))},D=>{E===x.current&&v(C=>({...C,status:"error",error:D}))}),E},reset(){v({status:"not-executed",error:void 0,result:g}),x.current=void 0,f.current=void 0}});return[(0,a.useMemo)(()=>({reset(){u.current.reset()},execute:(...b)=>u.current.execute(...b)}),[]),y,{promise:x.current,lastArgs:f.current}]}function o(r){const g=(0,a.useRef)(r);return g.current=r,(0,a.useMemo)(()=>Object.freeze({get current(){return g.current}}),[])}function d(r){return r.status==="error"}function i(r){return r.status==="success"}function c(r){return r.status==="not-executed"}function m(r){return r.status==="loading"}function p(...r){return{uninitialized:r.every(c),loading:r.some(m),error:r.find(d)?.error,success:r.some(i)}}function h({state:r}){return jsxs(Fragment,{children:[c(r)&&"uninitialized",m(r)&&"loading",i(r)&&"success",i(r)&&`result: ${JSON.stringify(r.result,null,2)}`,d(r)&&`error: ${stringifyErrorLike(r.error)}`]})}},44109:(Z,R,e)=>{"use strict";e.d(R,{FY:()=>y,Ll:()=>x,O3:()=>f,ZU:()=>g,we:()=>r});var n=e(10378),a=e(96540),s=e(16817),l=e(52161),o=e(70327),d=e(55143),i=e(67598),c=e(94646),m=e(29609),p=e(23265),h=e(18404);function r(u,b,E){const D=(0,l.oh)(b),{dsFeatures:C,isLoadingDsFeatures:P}=f(b),{currentData:T,isLoading:O,error:I}=o.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:b,ruleName:u,namespace:E?.namespace,groupName:E?.groupName}),[j]=o.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:W,error:B,value:S}=(0,s.A)(async()=>{if(!D)throw new Error("Unable to obtain data source settings");if(I)throw new Error("Unable to obtain Prometheus rules");const w=T||[],N=[];if(C?.rulerConfig){const A=C.rulerConfig,U=w.map(F=>F.groups.map(V=>({namespace:F,group:V}))).flat();await Promise.allSettled(U.map(async F=>{const V=await j({rulerConfig:A,namespace:F.namespace.name,group:F.group.name}).unwrap();N.push(V)}))}return w.map(A=>(0,p.O6)(D,A,N)).flatMap(A=>A.groups.flatMap(U=>U.rules))},[D,C,O,I,T,j]);return{loading:P||W,error:B,rules:S}}function g({ruleIdentifier:u,limitAlerts:b}){const{ruleSourceName:E}=u,D=v(u),{dsFeatures:C,isLoadingDsFeatures:P}=f(E),{loading:T,error:O,result:I}=y(u),{currentData:j=[],isLoading:W,error:B}=o.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:u.ruleSourceName,namespace:I?.namespace,groupName:I?.group,ruleName:I?.ruleName,limitAlerts:b},{skip:!I||T,refetchOnMountOrArgChange:!0}),S=(0,l.z2)(E),w=(0,h.a)(S?I?.namespace:void 0),N=S&&w.folder?(0,h.W)(w.folder):I?.namespace,[M,{currentData:L,isLoading:A,error:U}]=o.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,a.useEffect)(()=>{!C?.rulerConfig||!I||M({rulerConfig:C.rulerConfig,namespace:I.namespace,group:I.group})},[C,M,I]);const F=(0,a.useMemo)(()=>{if(!D||!I)return;const V=L&&N?{[N]:[L]}:{};return(0,p.gt)(D,j,V).flatMap(_=>_.groups).flatMap(_=>_.rules).find(_=>c.LC(c.UP(E,_),u))},[u,E,j,L,D,I,N]);return{loading:T||P||W||A,error:O??B??U,result:F}}function y(u){const b=(0,m.A4)(u)&&u.uid!==""?{uid:u.uid}:n.hT,{isLoading:E,currentData:D,error:C,isUninitialized:P}=o.hK.endpoints.getAlertRule.useQuery(b,{refetchOnMountOrArgChange:!0});return(0,a.useMemo)(()=>{if((0,m.Mj)(u)||(0,m.X4)(u))try{return{result:{datasource:u.ruleSourceName,namespace:u.namespace,group:u.groupName,ruleName:u.ruleName,groupIdentifier:i.HA.fromRuleIdentifier(u)},loading:!1}}catch(T){return{loading:!1,error:T}}return(0,m.A4)(u)?E||P?{loading:!0}:C?{loading:!1,error:C}:D?{result:{datasource:u.ruleSourceName,namespace:D.grafana_alert.namespace_uid,group:D.grafana_alert.rule_group,ruleName:D.grafana_alert.title,groupIdentifier:{namespace:{uid:D.grafana_alert.namespace_uid},groupName:D.grafana_alert.rule_group,groupOrigin:"grafana"}},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${u.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")}},[u,E,P,C,D])}function v(u){return(0,m.A4)(u)?"grafana":(0,l.oh)(u.ruleSourceName)}function x({ruleIdentifier:u}){const b=v(u),{data:E,isLoading:D}=d.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:u.ruleSourceName}),{loading:C,error:P,result:T}=y(u),[O,{currentData:I,isLoading:j,isUninitialized:W,error:B}]=o.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,a.useEffect)(()=>{!E?.rulerConfig||!T||O({rulerConfig:E.rulerConfig,namespace:T.namespace,group:T.group})},[E,O,T]);const S=(0,a.useMemo)(()=>{const{ruleSourceName:w}=u;if(!I||!b||!T)return;const N=I.rules.find(M=>{const L=c.P1(w,T.namespace,T.group,M);return c.LC(L,u)});if(N)return{ruleSourceName:w,group:I,namespace:T.namespace,rule:N}},[u,I,b,T]);return{loading:C||D||j||W,error:P??B,result:S}}function f(u){const{currentData:b,isLoading:E}=d.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:u});return{isLoadingDsFeatures:E,dsFeatures:b}}},23265:(Z,R,e)=>{"use strict";e.d(R,{Jr:()=>u,NW:()=>P,O6:()=>v,Tj:()=>T,Ug:()=>C,dy:()=>g,gt:()=>y,kU:()=>S,yh:()=>x});var n=e(2543),a=e.n(n),s=e(96540),l=e(86791),o=e(24619),d=e(70327),i=e(55143),c=e(95443),m=e(52161),p=e(94646),h=e(29609),r=e(98127);function g(N,M){const L=(0,r.$)(V=>V.promRules),A=(0,r.$)(V=>V.rulerRules),U=(0,s.useRef)({}),F=(0,s.useMemo)(()=>{if(N){const V=(0,m.Zw)(N);if(!V)throw new Error(`Unknown rules source: ${N}`);return[V]}return(0,m.lS)()},[N]);return(0,s.useMemo)(()=>F.map(V=>{const K=(0,m.Eb)(V)?V.name:V,G=A[K]?.result;let H=L[K]?.result;K===m.hY&&M&&(H=M);const _=U.current[K];if(_&&_.promRules===H&&_.rulerRules===G)return _.result;const k={};Object.entries(G||{}).forEach(([z,Y])=>{const X={rulesSource:V,name:z,groups:[]};h.p.grafana.rule(Y[0].rules[0])&&(X.uid=Y[0].rules[0].grafana_alert.namespace_uid),k[z]=X,E(X,Y)}),H?.forEach(({name:z,groups:Y})=>{const X=k[z]=k[z]||{rulesSource:V,name:z,groups:[]};D(X,Y)});const J=Object.values(k);return U.current[K]={promRules:H,rulerRules:G,result:J},J}).flat(),[L,A,F,M])}function y(N,M,L){const A={};return Object.entries(L||{}).forEach(([U,F])=>{const V={rulesSource:N,name:U,groups:[]};A[U]=V,E(V,F)}),M?.forEach(({name:U,groups:F})=>{const V=A[U]=A[U]||{rulesSource:N,name:U,groups:[]};D(V,F)}),Object.values(A)}function v(N,M,L){const A={rulesSource:N,name:M.name,groups:[]};return E(A,L),D(A,M.groups),A.groups.forEach(U=>{U.rules=U.rules.filter(F=>F.promRule)}),A}function x(N,M){if(!N.promRule)return;const A=M.rules.map(F=>j(F,N.namespace,N.group)).reduce((F,V)=>{const K=F.get(w(V));return K?K.push(V):F.set(w(V),[V]),F},new Map),U=W(N.promRule,A,N.namespace.rulesSource);U&&(N.rulerRule=U.rulerRule,N.query=U.query,N.labels=U.labels,N.annotations=U.annotations)}function f(N,M,L){return E(N,L),D(N,M),N}function u(N){return N.map(M=>{const L={...M,groups:[]};return L.groups.push({name:"default",rules:b(M.groups.flatMap(A=>A.rules)),totals:O(M.groups)}),L})}function b(N){return N.sort((M,L)=>M.name.localeCompare(L.name))}function E(N,M=[]){N.groups=M.map(L=>{const A=L.rules.filter(V=>h.p.any.recordingRule(V)).length,U=L.rules.filter(V=>h.p.grafana.alertingRule(V)&&(0,h.hC)(V)).length,F={name:L.name,interval:L.interval,source_tenants:L.source_tenants,rules:[],totals:{paused:U,recording:A}};return F.rules=L.rules.map(V=>j(V,N,F)),F})}function D(N,M){const L=new Map;N.groups.forEach(A=>L.set(A.name,A)),M.forEach(A=>{let U=L.get(A.name);U||(U={name:A.name,rules:[],totals:T(A)},N.groups.push(U),L.set(A.name,U)),U.totals={...U.totals,...T(A)};const F=new Map;U.rules.forEach(V=>{const K=F.get(w(V));K?K.push(V):F.set(w(V),[V])}),(A.rules??[]).forEach(V=>{const K=W(V,F,N.rulesSource);K?(K.promRule=V,K.instanceTotals=h.R$.alertingRule(V)?C(V):{},K.filteredInstanceTotals=h.R$.alertingRule(V)?P(V):{}):U.rules.push(I(V,N,U))})})}function C(N){const M=(0,n.countBy)(N.alerts,"state");if(N.totals){const{normal:L,...A}=N.totals;return{...A,inactive:L}}return{alerting:M[l.$7.Alerting]||M.firing,pending:M[l.$7.Pending],recovering:M[l.$7.Recovering],inactive:M[l.$7.Normal],nodata:M[l.$7.NoData],error:M[l.$7.Error]||M.err||void 0}}function P(N){if(N.totalsFiltered){const{normal:M,...L}=N.totalsFiltered;return{...L,inactive:M}}return{}}function T(N){if(N.totals){const{firing:U,...F}=N.totals;return{...F,alerting:U}}const M=(0,n.countBy)(N.rules,U=>h.R$.alertingRule(U)&&U.state),L=(0,n.countBy)(N.rules,U=>U.health),A=N.rules.filter(U=>h.R$.recordingRule(U)).length;return{alerting:M[o.cF.Firing],error:L.error,nodata:L.nodata,inactive:M[o.cF.Inactive],pending:M[o.cF.Pending],recovering:M[o.cF.Recovering],recording:A}}function O(N){const M={};return N.forEach(L=>{const A=L.totals;Object.entries(A).forEach(([U,F])=>{M[U]||(M[U]=0),F!=null&&(M[U]+=F)})}),M}function I(N,M,L){return{name:N.name,query:N.query,labels:N.labels||{},annotations:h.R$.alertingRule(N)?(0,h.Rh)(N):{},promRule:N,namespace:M,group:L,instanceTotals:h.R$.alertingRule(N)?C(N):{},filteredInstanceTotals:h.R$.alertingRule(N)?P(N):{}}}function j(N,M,L){const A={labels:N.labels||{},rulerRule:N,namespace:M,group:L,instanceTotals:{},filteredInstanceTotals:{},uid:h.p.grafana.rule(N)?N.grafana_alert.uid:void 0};return h.p.dataSource.alertingRule(N)?{...A,name:N.alert,query:N.expr,annotations:N.annotations||{}}:h.p.dataSource.recordingRule(N)?{...A,name:N.record,query:N.expr,annotations:{}}:{...A,name:N.grafana_alert.title,query:"",annotations:N.annotations||{}}}function W(N,M,L){const A=w(N),U=M.get(A);if(!U)return;if((0,m.z2)(L))return U[0];const F=U.find(K=>!K.promRule&&B(K,N,!0));if(F)return F;const V=U.find(K=>!K.promRule&&B(K,N,!1));if(V)return V}function B(N,M,L=!0){const A=h.R$.alertingRule(M)?(0,h.Rh)(M):{},U=M.labels??{},F=L?(0,p.h1)(M.query):"",V=N.annotations,K=N.labels,G=L?(0,p.h1)(N.query):"";return N.name===M.name?(0,n.isEqual)([G,K,V],[F,U,A]):!1}function S(N,M,L){const A=!N,{currentData:U,isLoading:F,error:V}=d.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:m.hY,dashboardUid:N??void 0,panelId:M},{skip:A,pollingInterval:L?c.HH:void 0}),{currentData:K,isLoading:G,error:H}=d.hK.endpoints.rulerRules.useQuery({rulerConfig:i.b,filter:{dashboardUID:N??void 0,panelId:M}},{pollingInterval:L?c.HH:void 0,skip:A}),_=(0,s.useRef)({}),k=(0,m.Zw)(m.hY),J=(0,s.useMemo)(()=>{if(!k)return[];const z=_.current[m.hY];if(z&&z.promRules===U&&z.rulerRules===K)return z.result;const Y={};Object.entries(K||{}).forEach(([Q,q])=>{const te={rulesSource:k,name:Q,groups:[]};h.p.grafana.rule(q[0].rules[0])&&(te.uid=q[0].rules[0].grafana_alert.namespace_uid),Y[Q]=te,E(te,q)}),U?.forEach(({name:Q,groups:q})=>{const te=Y[Q]=Y[Q]||{rulesSource:k,name:Q,groups:[]};D(te,q)});const X=Object.values(Y);return _.current[m.hY]={promRules:U,rulerRules:K,result:X},X},[U,K,k]);return{loading:F||G,error:V??H,result:J}}function w(N){return N.uid?N.uid??"":N.name}},96784:(Z,R,e)=>{"use strict";e.d(R,{dI:()=>C,i7:()=>P});var n=e(84139),a=e(1932),s=e(2543),l=e.n(s),o=e(96540),d=e(78282),i=e(24619),c=e(74268),m=e(56369),p=e(86017),h=e(95443),r=e(52161),g=e(63895),y=e(29609),v=e(23265),x=e(20962);const f=25,u=1/0,b=5,E=/[^ -~]/m,D=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m;function C(){const[N,M]=(0,x.l)(),L=N.get("search")??"",A=(0,o.useMemo)(()=>(0,m.XY)(L),[L]),U=(0,o.useMemo)(()=>Object.values(A).some(G=>!(0,s.isEmpty)(G)),[A]),F=(0,o.useMemo)(()=>(0,s.chain)(A).omitBy(s.isEmpty).keys().filter(w).value(),[A]),V=(0,o.useCallback)(G=>{const H=(0,m.kL)(L,G);M({search:H})},[L,M]),K=(0,o.useCallback)(G=>{M({search:G})},[M]);return(0,o.useEffect)(()=>{const G={dataSource:N.get("dataSource")??void 0,alertState:N.get("alertState")??void 0,ruleType:N.get("ruleType")??void 0,labels:(0,g.S6)(N.get("queryString")??"").map(p.MU)};Object.values(G).some(_=>!(0,s.isEmpty)(_))&&(M({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),V((0,a.jM)(A,_=>{if(_.dataSourceNames??=G.dataSource?[G.dataSource]:[],G.alertState&&(0,i.Si)(G.alertState)&&(_.ruleState??=G.alertState),G.ruleType&&(0,y.nf)(G.ruleType)&&(_.ruleType??=G.ruleType),_.labels.length===0&&G.labels.length>0){const k=G.labels.map(({name:J,operator:z,value:Y})=>`${J}${z}${Y}`);_.labels.push(...k)}})))},[N,V,A,M]),{filterState:A,hasActiveFilters:U,activeFilters:F,searchQuery:L,setSearchQuery:K,updateFilters:V}}const P=(N,M)=>{const L=(0,o.useDeferredValue)(N),A=(0,o.useDeferredValue)(M);return(0,o.useMemo)(()=>{const U=T(L,A);return U.forEach(F=>{F.groups.forEach(V=>{V.rules.forEach(K=>{y.R$.alertingRule(K.promRule)&&(K.instanceTotals=(0,v.Ug)(K.promRule),K.filteredInstanceTotals=(0,v.NW)(K.promRule))}),V.totals=(0,v.Tj)({rules:V.rules.map(K=>K.promRule).filter(K=>!!K)})})}),U},[L,A])},T=(N,M={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let L=N;const A=M.dataSourceNames;A.length&&(L=L.filter(({rulesSource:V})=>(0,r.Eb)(V)?A.includes(V.name):!0));const U=M.namespace;U&&(L=W(L,V=>V.name,U));const F=[];try{L.reduce(O(M),[]).forEach(K=>{F.push(K)})}catch(V){(0,c.vV)(new Error("Failed to filter rules",{cause:V}),{search:JSON.stringify(M)})}return F},O=N=>(M,L)=>{const A=N.groupName;let U=L.groups;return A&&(U=W(U,F=>F.name,A)),U=U.reduce(I(N),[]),U.length&&M.push({...L,groups:U}),M},I=N=>{const M=N.ruleName??N.freeFormWords.join(" ");return(L,A)=>{let U=A.rules;return M&&(U=W(U,F=>F.name,M)),U=U.filter(F=>{const V=F.promRule,K=(0,s.chain)(N).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins","contactPoint"]).omitBy(s.isEmpty).mapValues(()=>!1).value();if("ruleType"in K&&N.ruleType===V?.type&&(K.ruleType=!0),"plugins"in K&&N.plugins==="hide"&&(K.plugins=F.rulerRule&&!(0,y.Tm)(F.rulerRule)),"contactPoint"in K){const G=N.contactPoint;y.p.grafana.rule(F.rulerRule)&&F.rulerRule.grafana_alert.notification_settings?.receiver===G&&(K.contactPoint=!0)}if("dataSourceNames"in K&&(y.p.grafana.rule(F.rulerRule)?B(F.rulerRule,N)&&(K.dataSourceNames=!0):K.dataSourceNames=!0),"ruleHealth"in N&&V){const G=(0,y.f6)(V.health);N.ruleHealth===G&&(K.ruleHealth=!0)}if("labels"in K){const G=(0,s.compact)(N.labels.map(j)),H=G.length>0&&(0,p.Av)(F.labels,G),_=G.length>0&&V&&V.type===i.JS.Alerting&&V.alerts&&V.alerts.some(k=>(0,p.Av)(k.labels,G));(H||_)&&(K.labels=!0)}if("ruleState"in K){const G=F.promRule;G&&y.R$.alertingRule(G)&&G.state===N.ruleState&&(K.ruleState=!0)}return"dashboardUid"in K&&F.annotations[h.YH.dashboardUID]===N.dashboardUid&&(K.dashboardUid=!0),Object.values(K).every(G=>G===!0)}),U.length&&L.push({...A,rules:U}),L}};function j(N){try{return(0,g.qR)(N)}catch{return{name:N,value:"",isRegex:!0,isEqual:!0}}}function W(N,M,L){let A=N;const U=new n.A({intraMode:1}),F=U.split(L).length;if(E.test(L)||D.test(L)||L.length>f||F>b)return N.filter(J=>M(J).toLowerCase().includes(L.toLowerCase()));const K=N.map(M),G=F<5?4:0,[H,_,k]=U.search(K,L,G,u);return _&&k?A=k.map(J=>A[_.idx[J]]):H&&(A=H.map(J=>A[J])),A}const B=(N,M)=>M.dataSourceNames?.length?!!N.grafana_alert.data.find(L=>{if(!L.datasourceUid)return!1;const A=(0,d.l)().getInstanceSettings(L.datasourceUid);return A?.name&&M?.dataSourceNames?.includes(A.name)}):!0,S=new Set(["freeFormWords","namespace","groupName","ruleName","ruleState","ruleType","dataSourceNames","labels","ruleHealth","dashboardUid","plugins","contactPoint"]),w=N=>S.has(N)},18404:(Z,R,e)=>{"use strict";e.d(R,{W:()=>l,a:()=>s});var n=e(10378),a=e(18346);function s(d){const i=(0,a.kH)(d||n.hT);return{loading:i.isLoading,folder:i.data}}function l({title:d,parents:i}){return i&&i?.length?[...i.map(c=>c.title),d].map(o).join("/"):o(d)}function o(d){return d.replaceAll("/","\\/")}},11940:(Z,R,e)=>{"use strict";e.d(R,{w:()=>o,y:()=>l});var n=e(55143),a=e(52161);const{useDiscoverDsFeaturesQuery:s}=n.L;function l(d){const i=(0,a.EV)(d),{currentData:c}=s({rulesSourceName:i});return{hasRuler:!!c?.rulerConfig,rulerConfig:c?.rulerConfig}}function o(d){const{currentData:i}=s({uid:d.uid});return{hasRuler:!!i?.rulerConfig,rulerConfig:i?.rulerConfig}}},12770:(Z,R,e)=>{"use strict";e.d(R,{g:()=>d});var n=e(15130),a=e(55143),s=e(54),l=e(29609),o=e(18404);function d(i,c){const{currentData:m,isLoading:p,error:h}=a.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:i}),r=c&&l.p.grafana.rule(c)?c.grafana_alert.namespace_uid:void 0,g=(0,s.Wd)(i),{folder:y,loading:v}=(0,o.a)(r);if(h)return{isEditable:!1,isRemovable:!1,loading:!1,isRulerAvailable:!1,error:h};if(!c)return{isEditable:!1,isRemovable:!1,loading:!1};if(l.p.grafana.rule(c)){if(!r)throw new Error(`Rule ${c.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!y)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:v};const b=n.TP.hasPermissionInMetadata(g.update,y),E=n.TP.hasPermissionInMetadata(g.delete,y);return{isRulerAvailable:!0,isEditable:b,isRemovable:E,loading:v||p}}const x=!!m?.rulerConfig,f=n.TP.hasPermission(g.update),u=n.TP.hasPermission(g.delete);return{isRulerAvailable:x,isEditable:f&&x,isRemovable:u&&x,loading:p}}},74048:(Z,R,e)=>{"use strict";e.d(R,{W:()=>l});var n=e(2543),a=e.n(n),s=e(96540);function l(o,d=1,i){const[c,m]=(0,s.useState)(d),p=(0,s.useMemo)(()=>(0,n.chunk)(o,i),[o,i]),h=p.length,r=p[c-1]??[],g=(c-1)*i+1,y=(0,n.clamp)(c*i,o.length),v=(0,s.useCallback)(u=>{m((0,n.clamp)(u,1,p.length))},[m,p]),x=(0,s.useCallback)(()=>v(c+1),[c,v]),f=(0,s.useCallback)(()=>v(c-1),[c,v]);return(0,s.useEffect)(()=>m(1),[h]),{page:c,onPageChange:v,numberOfPages:h,pageItems:r,pageStart:g,pageEnd:y,nextPage:x,previousPage:f}}},21764:(Z,R,e)=>{"use strict";e.d(R,{S:()=>a});var n=e(23265);function a({dashboardUID:s,panelId:l,poll:o=!1}){const{result:d,loading:i,error:c}=(0,n.kU)(s,l,o);return{rules:d?d.flatMap(p=>p.groups).flatMap(p=>p.rules):[],errors:c?[c]:[],loading:i}}},3986:(Z,R,e)=>{"use strict";e.d(R,{_:()=>s});var n=e(16817),a=e(95027);function s(l){const{loading:o,error:d,value:i}=(0,n.A)(()=>(0,a.x)(l,{showErrorAlert:!1})),c=i&&!d&&!o,m=i?.enabled;return o&&!i?{loading:!0}:!c||!m?{loading:!1,installed:!1}:{loading:o,installed:!0,settings:i}}},43100:(Z,R,e)=>{"use strict";e.d(R,{d:()=>y});var n=e(34632),a=e(91984),s=e(72748),l=e(78045),o=e(55614),d=e(15518),i=e(5358);function c(...v){return{error:v.find(x=>x.error),isUninitialized:v.every(x=>x.isUninitialized),isSuccess:v.every(x=>x.isSuccess),isError:v.some(x=>x.isError),isLoading:v.some(x=>x.isLoading)}}const m=new Error("no active Alertmanager"),{useLazyGetAlertmanagerConfigurationQuery:p,useUpdateAlertmanagerConfigurationMutation:h}=a.m,r={alertmanager_config:{receivers:[],route:{},time_intervals:[],mute_time_intervals:[],inhibit_rules:[],templates:[]},template_files:{}},g=(0,n.A)(r,s.f1,d.NF,o.r0,l.B8);function y(){const{selectedAlertmanager:v}=(0,i.VI)(),[x,f]=p(),[u,b]=h(),E=c(f,b);if(!v)throw m;return[async C=>{const P=await x(v).unwrap(),T=g(P,C);return u({selectedAlertmanager:v,config:T}).unwrap()},E]}},80276:(Z,R,e)=>{"use strict";e.d(R,{IH:()=>C,zx:()=>D});var n=e(2543),a=e.n(n),s=e(96540),l=e(86791),o=e(74268),d=e(70327),i=e(55143),c=e(94646),m=e(29609),p=e(80218);const{useLazyPrometheusRuleNamespacesQuery:h,useLazyGetRuleGroupForNamespaceQuery:r}=d.hK,{useLazyDiscoverDsFeaturesQuery:g}=i.L,y=3*1e3,v=90*1e3,{setInterval:x,clearInterval:f}=window;function u(){const[T]=h();return{matchingPromRuleExists:(0,s.useCallback)(async I=>{const{ruleSourceName:j,namespace:W,groupName:B,ruleName:S}=I;return(await T({ruleSourceName:j,namespace:W,groupName:B,ruleName:S}).unwrap()).find(L=>L.name===W)?.groups.find(L=>L.name===B)?.rules.some(L=>{const A=c.Lg(j,W,B,L);return c.LC(A,I)})??!1},[T])}}const b=!0;function E(){const[T]=g(),[O]=h(),[I]=r();return{isGroupInSync:(0,s.useCallback)(async W=>{const B=W.groupOrigin==="datasource"?W.rulesSource.uid:l.l$,S=await T({uid:B},b).unwrap();if(!S.rulerConfig)throw new Error("Datasource does not support ruler. Unable to determine group consistency");const w=W.groupOrigin==="datasource"?W.namespace.name:W.namespace.uid,N={ruleSourceName:S.name,namespace:w,groupName:W.groupName,limitAlerts:0,excludeAlerts:!0},M={namespace:w,group:W.groupName,rulerConfig:S.rulerConfig,notificationOptions:{showSuccessAlert:!1,showErrorAlert:!1}},[L,A]=await Promise.allSettled([O(N).unwrap(),I(M).unwrap()]);if(L.status==="rejected"&&A.status==="rejected")return(0,o.vV)(new Error("Error fetching Prometheus and Ruler rule groups",{cause:[L.reason,A.reason]})),!0;if(L.status==="rejected"&&A.status==="fulfilled")return(0,o.vV)(new Error("Error fetching Prometheus rule groups",{cause:L.reason})),!0;if(A.status==="rejected"&&L.status==="fulfilled")return L.value.flatMap(F=>F.groups).every(F=>F.name!==W.groupName);if(L.status==="fulfilled"&&A.status==="fulfilled"){const U=L.value.flatMap(V=>V.groups).find(V=>V.name===W.groupName),F=A.value;if(U&&F){if(!(U.rules.length===F.rules.length))return!1;const K=U.rules.map(H=>H.name),G=F.rules.map(m.qz);for(const[H,_]of(0,n.zip)(K,G))if(H!==_)return!1;return!0}}return!1},[T,O,I])}}function D(){const{isGroupInSync:T}=E(),[O,I]=(0,s.useState)(),j=(0,s.useRef)(),W=(0,s.useRef)();(0,s.useEffect)(()=>()=>{B(),S()},[]);function B(){W.current&&(clearTimeout(W.current),W.current=void 0)}function S(){j.current&&(clearTimeout(j.current),j.current=void 0)}async function w(N){B(),S();const M=new Promise((A,U)=>{W.current=setTimeout(()=>{S();const F=new Error("Timeout while waiting for rule group consistency");(0,o.vV)(F,{groupOrigin:N.groupOrigin}),U(F)},v)}),L=new Promise((A,U)=>{function F(){performance.mark("waitForGroupConsistency:finished");const K=performance.measure("waitForGroupConsistency","waitForGroupConsistency:started","waitForGroupConsistency:finished");(0,o.l$)("alerting:wait-for-group-consistency",{duration:K.duration},{groupOrigin:N.groupOrigin})}function V(){T(N).then(K=>{I(K),K?(F(),A()):j.current=setTimeout(V,y)}).catch(K=>{U(K)}).finally(()=>{B()})}performance.mark("waitForGroupConsistency:started"),V()});return Promise.race([M,L])}return{waitForGroupConsistency:w,groupConsistent:O}}function C(){const{matchingPromRuleExists:T}=u(),O=(0,s.useRef)(),I=(0,s.useRef)();(0,s.useEffect)(()=>()=>{j(),W()},[]);const j=()=>{O.current&&(f(O.current),O.current=void 0)},W=()=>{I.current&&(f(I.current),I.current=void 0)};async function B(w){j();const N=new Promise((L,A)=>{setTimeout(()=>{j(),A(new Error("Timeout while waiting for rule removal"))},v)}),M=new Promise((L,A)=>{O.current=x(()=>{T(w).then(U=>{U===!1&&(j(),L())}).catch(U=>{j(),A(U)})},y)});return Promise.race([N,M])}async function S(w){W();const N=new Promise((L,A)=>{setTimeout(()=>{W(),A(new Error("Timeout while waiting for rule creation"))},v)}),M=new Promise((L,A)=>{I.current=x(()=>{T(w).then(U=>{U===!0&&(W(),L())}).catch(U=>{W(),A(U)})},y)});return Promise.race([N,M])}return{waitForRemoval:B,waitForCreation:S}}function P(T){const{matchingPromRuleExists:O}=u(),{waitForCreation:I}=C(),[j,W]=useAsync(async B=>isCloudRuleIdentifier(B)?I(B):Promise.resolve());return useEffect(()=>{isCloudRuleIdentifier(T)&&O(T).then(B=>{B||j.execute(T)})},[j,T,O]),{isConsistent:W.status==="success"||W.status==="not-executed",error:W.error}}},39187:(Z,R,e)=>{"use strict";e.d(R,{h:()=>d,w:()=>i});var n=e(63704),a=e(43173),s=e(36490),l=e(74268),o=e(20962);function d(m){const p={returnTo:m},[h]=(0,o.l)(),r=h.get("returnTo");if(!r)return p;const g=n.sQ.sanitizeUrl(r),y=`${window.location.origin}/${a.$.appSubUrl}`,v=c(g,y);if(!v)return(0,l.FF)("Malformed returnTo parameter",{returnTo:r}),p;const{protocol:x,origin:f,pathname:u,search:b}=v;return["http:","https:"].includes(x)===!1||f!==window.location.origin?((0,l.FF)("Malformed returnTo parameter",{returnTo:r}),p):{returnTo:`${u}${b}`}}function i(m=!0){const{pathname:p,search:h}=s.Ny.getLocation();return p+(m?h:"")}function c(m,p){try{return new URL(m,p)}catch{return null}}},58138:(Z,R,e)=>{"use strict";e.d(R,{G:()=>h,Q:()=>p});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(43173),d=e(63142),i=e(22787);const c=(0,s.lazy)(()=>e.e(2835).then(e.bind(e,32835))),m=(0,s.lazy)(()=>Promise.all([e.e(8706),e.e(4302)]).then(e.bind(e,54302)));var p=(g=>(g.Loki="loki",g.Annotations="annotations",g))(p||{});function h(){const[g,y]=(0,s.useState)(!1),[v,x]=(0,s.useState)(),f=(0,d.of)(r),u=o.$.unifiedAlerting.alertStateHistoryBackend,b=o.$.unifiedAlerting.alertStateHistoryPrimary,D=[u,b].some(O=>O==="loki")?"loki":"annotations",C=(0,s.useCallback)(()=>{x(void 0),y(!1)},[]),P=(0,s.useCallback)(O=>{x(O),y(!0)},[]);return{StateHistoryModal:(0,s.useMemo)(()=>v?(0,n.jsx)(i.a,{isOpen:g,onDismiss:C,closeOnBackdropClick:!0,closeOnEscape:!0,title:(0,l.t)("alerting.use-state-history-modal.state-history-modal.title-state-history","State history"),className:f.modal,contentClassName:f.modalContent,children:(0,n.jsxs)(s.Suspense,{fallback:"Loading...",children:[D==="loki"&&(0,n.jsx)(m,{ruleUID:v.grafana_alert.uid}),D==="annotations"&&(0,n.jsx)(c,{ruleUID:v.grafana_alert.uid??""})]})}):null,[v,g,C,D,f]),showStateHistoryModal:P,hideStateHistoryModal:C}}const r=g=>({modal:(0,a.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,a.css)({height:"100%",width:"100%",padding:g.spacing(2)})})},20962:(Z,R,e)=>{"use strict";e.d(R,{l:()=>l});var n=e(96540),a=e(54148),s=e(36490);function l(){const{search:o}=(0,a.zy)(),d=(0,n.useMemo)(()=>new URLSearchParams(o),[o]),i=(0,n.useCallback)((c,m)=>{s.Ny.partial(c,m)},[]);return[d,i]}},98127:(Z,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(25508),a=e(52763);function s(l,o){return(0,a.d4)((0,n.Mz)(d=>d.unifiedAlerting,d=>l(d)),o)}},17305:(Z,R,e)=>{"use strict";e.d(R,{T:()=>c});var n=e(74848),a=e(16817),s=e(92745),l=e(99887),o=e(45967),d=e(58851),i=e(95027);function c({pluginId:m,size:p="md"}){const{value:h,loading:r}=(0,a.A)(()=>(0,i.x)(m));if(r||!h)return null;const g=h.info.logos?.small,y=h.name,v=(0,d.cs)(p),x=g?(0,n.jsx)("img",{src:g,alt:y,height:v}):(0,n.jsx)(l.E,{text:m,color:"orange"});return(0,n.jsx)(o.m,{content:(0,s.t)("alerting.plugin-origin-badge.tooltip-managed-by-plugin","This rule is managed by the {{pluginName}} plugin",{pluginName:y}),children:x})}},1487:(Z,R,e)=>{"use strict";e.d(R,{H:()=>s,J:()=>l});var n=e(78012);const a="grafana.alerting.previewToggles";function s(o){return n.M.getObject(a,{})[o]}function l(o,d){const i=n.M.getObject(a,{});i[o]=d,n.M.setObject(a,i)}},72748:(Z,R,e)=>{"use strict";e.d(R,{$8:()=>i,X9:()=>o,f1:()=>m,ov:()=>d});var n=e(65307),a=e(2543),s=e.n(a),l=e(86017);const o=(0,n.VP)("muteTiming/add"),d=(0,n.VP)("muteTiming/update"),i=(0,n.VP)("muteTiming/delete"),c={alertmanager_config:{},template_files:{}},m=(0,n.vy)(c,p=>{p.addCase(o,(h,{payload:r})=>{const{interval:g}=r;h.alertmanager_config.time_intervals=(h.alertmanager_config.time_intervals??[]).concat(g)}).addCase(d,(h,{payload:r})=>{const{interval:g,originalName:y}=r,v=g.name!==y,x=h.alertmanager_config.time_intervals??[],f=h.alertmanager_config.mute_time_intervals??[],u=x.findIndex(({name:E})=>E===y);u!==-1&&(x[u]=g);const b=f.findIndex(({name:E})=>E===y);b!==-1&&(f[b]=g),v&&h.alertmanager_config.route&&(h.alertmanager_config.route=(0,l.$m)(g.name,y,h.alertmanager_config.route))}).addCase(i,(h,{payload:r})=>{const{name:g}=r,{alertmanager_config:y}=h,{time_intervals:v=[],mute_time_intervals:x=[]}=y;(0,a.remove)(v,f=>f.name===g),(0,a.remove)(x,f=>f.name===g),y.route=(0,l._n)(g,y.route??{})})})},78045:(Z,R,e)=>{"use strict";e.d(R,{B8:()=>c,LY:()=>l,Z8:()=>o,tD:()=>d});var n=e(65307),a=e(42824),s=e(67923);const l=(0,n.VP)("routes/update"),o=(0,n.VP)("routes/delete"),d=(0,n.VP)("routes/add"),i={alertmanager_config:{},template_files:{}},c=(0,n.vy)(i,m=>{m.addCase(l,(p,{payload:h})=>{const{update:r,alertmanager:g}=h,{alertmanager_config:y}=p;if(!y.route)return;const v=(0,a.QM)(y.route),x=(0,s.AB)(g,r,v);y.route=(0,s.dn)(x)}).addCase(o,(p,{payload:h})=>{const{id:r}=h,{alertmanager_config:g}=p;if(!g.route)return;const y=(0,a.QM)(g.route),v=(0,s.AS)(r,y);p.alertmanager_config.route=(0,s.dn)(v)}).addCase(d,(p,{payload:h})=>{const{partialRoute:r,referenceRouteIdentifier:g,insertPosition:y,alertmanager:v}=h,{alertmanager_config:x}=p;if(!x.route)return;const f=(0,a.QM)(x.route),u=(0,s.I8)(v,r,g,f,y);p.alertmanager_config.route=(0,s.dn)(u)})})},55614:(Z,R,e)=>{"use strict";e.d(R,{FB:()=>o,JI:()=>i,jS:()=>d,r0:()=>m});var n=e(65307),a=e(2543),s=e.n(a),l=e(42801);const o=(0,n.VP)("notificationTemplate/add"),d=(0,n.VP)("notificationTemplate/update"),i=(0,n.VP)("notificationTemplate/delete"),c={alertmanager_config:{},template_files:{}},m=(0,n.vy)(c,p=>{p.addCase(o,(h,{payload:r})=>{const{alertmanager_config:g={},template_files:y={}}=h,{template:v}=r;if(y[v.title]!==void 0)throw new Error("target template already exists");const f=(0,l.o)(v.title,v.content);y[v.title]=f,g.templates=(0,a.toArray)(g.templates).concat(v.title)}).addCase(d,(h,{payload:r})=>{const{alertmanager_config:g={},template_files:y={}}=h,{name:v,template:x}=r,f=v!==x.title;if(!(y[v]!==void 0))throw new Error(`Expected notification template ${v} to exist, but did not find it in the config`);const b=(0,l.o)(x.title,x.content);if(f){const E=v,D=x.title;if(y[D]!==void 0)throw new Error(`Duplicate template name ${D}`);(0,a.unset)(y,E),(0,a.remove)(g.templates??[],P=>P===E),g.templates=(0,a.toArray)(g.templates).concat(x.title)}y[x.title]=b}).addCase(i,(h,{payload:r})=>{const{name:g}=r,{alertmanager_config:y={},template_files:v={}}=h;(0,a.unset)(v,g),(0,a.remove)(y.templates??[],x=>x===g)})})},15518:(Z,R,e)=>{"use strict";e.d(R,{BD:()=>o,FS:()=>i,NF:()=>m,Xm:()=>d});var n=e(65307),a=e(2543),s=e.n(a),l=e(48442);const o=(0,n.VP)("receiver/add"),d=(0,n.VP)("receiver/update"),i=(0,n.VP)("receiver/delete"),c={alertmanager_config:{},template_files:{}},m=(0,n.vy)(c,p=>{p.addCase(o,(h,{payload:r})=>{const g=h.alertmanager_config.receivers=h.alertmanager_config.receivers??[];if(g.some(v=>v.name===r.name))throw new Error(`Duplicate receiver name ${r.name}`);g.push(r)}).addCase(d,(h,{payload:r})=>{const{name:g,receiver:y}=r,v=g!==y.name,x=h.alertmanager_config.receivers??[],f=x.findIndex(E=>E.name===g);if(!(f>-1))throw new Error(`Expected receiver ${g} to exist, but did not find it in the config`);if(v&&x.some(D=>D.name===y.name))throw new Error(`Duplicate receiver name ${y.name}`);x[f]=y;const b=h.alertmanager_config.route;b&&v&&(h.alertmanager_config.route=(0,l.Wn)(b,g,y.name))}).addCase(i,(h,{payload:r})=>{(0,a.remove)(h.alertmanager_config.receivers??[],g=>g.name===r)})})},96137:(Z,R,e)=>{"use strict";e.d(R,{Ct:()=>b,KH:()=>p,KL:()=>g,LH:()=>m,Qn:()=>i,Wu:()=>c,bw:()=>y,fO:()=>r,i3:()=>x,lF:()=>h});var n=e(65307),a=e(2543),s=e.n(a),l=e(52161),o=e(94646),d=e(29609);const i=(0,n.VP)("ruleGroup/rules/add"),c=(0,n.VP)("ruleGroup/rules/update"),m=(0,n.VP)("ruleGroup/rules/pause"),p=(0,n.VP)("ruleGroup/rules/delete"),h=(0,n.VP)("ruleGroup/update"),r=(0,n.VP)("ruleGroup/move"),g=(0,n.VP)("ruleGroup/rename"),y=(0,n.VP)("ruleGroup/rules/reorder"),v={name:"initial",rules:[]},x=(0,n.vy)(v,D=>{D.addCase(i,(C,{payload:P})=>{const{rule:T}=P;C.rules.push(T)}).addCase(c,(C,{payload:P})=>{const{identifier:T,rule:O}=P,I=E(C.rules,T);C.rules[I]=O}).addCase(p,(C,{payload:P})=>{const{identifier:T}=P,O=E(C.rules,T);C.rules.splice(O,1)}).addCase(m,(C,{payload:P})=>{const{uid:T,pause:O}=P,I={ruleSourceName:l.hY,uid:T},j=E(C.rules,I),W=C.rules[j];if(d.p.grafana.rule(W))W.grafana_alert.is_paused=O;else throw new Error("Matching rule is not a Grafana-managed rule")}).addCase(y,(C,{payload:P})=>{const{swaps:T}=P;u(C.rules,T)}).addMatcher((0,n.i0)(g,r,i),(C,{payload:P})=>{const{groupName:T}=P;C.name=T??C.name}).addMatcher((0,n.i0)(h,g,r,i),(C,{payload:P})=>{const{interval:T}=P;C.interval=T??C.interval}).addDefaultCase((C,P)=>{throw new Error(`Unknown action for rule group reducer: ${P.type}`)})}),f=D=>{const C=(0,d.A4)(D),P=(0,d.X4)(D);return T=>{const O=d.p.grafana.rule(T),I=d.p.dataSource.rule(T);if(C&&O)return T.grafana_alert.uid===D.uid;if(I&&P)return(0,o.Ns)(T)===D.rulerRuleHash}};function u(D,C){for(const P of C)b(D,P);return D}function b(D,[C,P]){if(!((0,a.inRange)(C,D.length)&&(0,a.inRange)(P,D.length)))throw new Error("Invalid operation: index out of bounds");const[O]=D.splice(C,1);D.splice(P,0,O)}function E(D,C){const P=D.findIndex(f(C));if(P===-1)throw new Error("no rule matching identifier found");return P}},84523:(Z,R,e)=>{"use strict";e.d(R,{BH:()=>j,IJ:()=>D,JG:()=>T,T6:()=>b,_u:()=>W,b0:()=>O,ir:()=>I});var n=e(2543),a=e.n(n),s=e(47551),l=e(43173),o=e(78282),d=e(24619),i=e(67817),c=e(54),m=e(95443),p=e(52161),h=e(20437),r=e(29609),g=e(15629),y=e(6194);const v=(0,g.P8)(l.$.unifiedAlerting?.minInterval??"10s"),x=(0,g.P8)("1m"),f=1/0,u="0s",b=(0,g.an)((0,n.clamp)(v,x,f));function E(){const S=l.$.unifiedAlerting?.defaultRecordingRulesTargetDatasourceUID;if(S)try{const w=(0,o.l)().getInstanceSettings(S);if(w&&(0,p.Gb)(w))return S}catch{}}const D=S=>{const{canCreateGrafanaRules:w,canCreateCloudRules:N}=(0,c.Q9)(),M=(()=>{if(S===i.Z.grafanaRecording)return i.Z.grafanaRecording;if(w)return i.Z.grafana;if(N)return i.Z.cloudAlerting})();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:m.kl,dataSourceName:p.hY,type:M,group:"",folder:void 0,queries:[],recordingRulesQueries:[],condition:"",noDataState:d.Q8.NoData,execErrState:d.Q8.Error,evaluateFor:b,keepFiringFor:u,evaluateEvery:b,manualRouting:C(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],editorSettings:P(S),targetDatasourceUid:E(),namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},C=()=>localStorage.getItem(h.Q8)!=="false";function P(S){if(S===i.Z.grafanaRecording||!(l.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return;const N=localStorage.getItem(h.Os),M=localStorage.getItem(h.Q8);return{simplifiedQueryEditor:N!=="false",simplifiedNotificationEditor:M!=="false"}}function T(S,w){let N;try{N=JSON.parse(S)}catch{return{...D(w),queries:(0,h.qO)()}}return(0,y.bx)((0,y.A2)((0,y.i_)({...D(w),...N,annotations:(0,y.JE)(N.annotations??[]),queries:N.queries??(0,h.qO)(),type:N.type??w??i.Z.grafana,evaluateEvery:b})))}function O(S){const w=B.parse(S);return(0,y.i_)({...D(S.type),...w})}function I(S){return(0,y.i_)((0,h.QX)(S))}function j(S){return{...D(S),condition:"C",queries:(0,h.qO)((0,r.pq)(S)),type:S,evaluateEvery:b}}function W(S=""){return S==="recording"?i.Z.cloudRecording:S==="grafana-recording"?i.Z.grafanaRecording:i.Z.grafana}const B=s.z.looseObject({name:s.z.string().optional(),type:s.z.enum(i.Z).catch(i.Z.grafana),dataSourceName:s.z.string().optional().default(""),group:s.z.string().optional(),labels:s.z.array(s.z.object({key:s.z.string(),value:s.z.string()})).optional().default([]),annotations:s.z.array(s.z.object({key:s.z.string(),value:s.z.string()})).optional().default([]),queries:s.z.array(s.z.any()).optional(),condition:s.z.string().optional(),noDataState:s.z.enum(d.Q8).optional().default(d.Q8.NoData).catch(d.Q8.NoData),execErrState:s.z.enum(d.Q8).optional().default(d.Q8.Error).catch(d.Q8.Error),folder:s.z.union([s.z.object({title:s.z.string(),uid:s.z.string()}),s.z.undefined()]).optional(),evaluateEvery:s.z.string().optional(),evaluateFor:s.z.string().optional().default("0s"),keepFiringFor:s.z.string().optional(),isPaused:s.z.boolean().optional().default(!1),manualRouting:s.z.boolean().optional(),contactPoints:s.z.record(s.z.string(),s.z.object({selectedContactPoint:s.z.string(),overrideGrouping:s.z.boolean(),groupBy:s.z.array(s.z.string()),overrideTimings:s.z.boolean(),groupWaitValue:s.z.string(),groupIntervalValue:s.z.string(),repeatIntervalValue:s.z.string(),muteTimeIntervals:s.z.array(s.z.string()),activeTimeIntervals:s.z.array(s.z.string())})).optional(),editorSettings:s.z.object({simplifiedQueryEditor:s.z.boolean(),simplifiedNotificationEditor:s.z.boolean()}).optional(),metric:s.z.string().optional(),targetDatasourceUid:s.z.string().optional(),namespace:s.z.string().optional(),expression:s.z.string().optional(),missingSeriesEvalsToResolve:s.z.number().optional()})},6194:(Z,R,e)=>{"use strict";e.d(R,{A2:()=>h,JE:()=>x,Nx:()=>r,Oy:()=>g,bx:()=>p,i_:()=>v});var n=e(2543),a=e.n(n),s=e(43173),l=e(44022),o=e(4651),d=e(82779),i=e(95443),c=e(52161),m=e(20437);function p(f){if(!(s.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return{...f,editorSettings:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!0}};const b=f.queries.filter(C=>!(0,l.f)(C.model)),E=f.queries.filter(C=>g(C)),D=r(b,E);return{...f,editorSettings:{simplifiedQueryEditor:D,simplifiedNotificationEditor:!0}}}function h(f){return{...f,queries:f.queries?.map(u=>{if((0,l.f)(u.model))return u;const b=u.model.datasource?.type?(0,c.cl)(u.model.datasource.type):!1,E="instant"in u.model&&u.model.instant!==void 0?u.model.instant:b;return{...u,model:{...u.model,instant:E,range:!E}}})}}function r(f,u){if(f.length!==1||u.length>2)return!1;const b=f.at(0),E=u.find(w=>w.model.type===o.Tz.reduce),D=u.find(w=>w.model.type===o.Tz.threshold),C=E?(0,d.OC)(E.model):!1,P=D?.model.conditions?.every(w=>(0,n.isEmpty)(w.unloadEvaluator))??!0,T=E&&C,O=D&&P,I=D?.model.expression===E?.refId,j=E?.model.expression===b?.refId;if(T&&j&&O&&I)return!0;const W=b?(0,m.mY)(b):!1,B=u.length===1&&D,S=D?.model.expression===b?.refId;return!!(W&&B&&O&&S)}function g(f){return(0,l.f)(f.model)}function y(f){return!isExpressionQuery(f.model)}const v=f=>({...f,queries:f.queries?.map(u=>(0,n.omit)(u,"model.hide"))});function x(f){const u=[...f];return i.kl.map(E=>E.key).forEach((E,D)=>{const C=u.findIndex(P=>P.key===E);if(C===-1){const P={key:E,value:""};u.splice(D,0,P)}else C!==D&&u.splice(D,0,u.splice(C,1)[0])}),u}},76267:(Z,R,e)=>{"use strict";e.d(R,{C:()=>i});var n=e(79197),a=e(48497),s=e(74529),l=e(25229),o=e(80011),d=e(15629);function i(m,p){if(!m||!p||!(0,s.vd)(m))return;let h;try{h=(0,d.M9)(p)}catch{return}if((0,d.mo)(m))return;const r=Date.parse(m||""),g=(0,n.A)(r,h);return(0,a.Y)(g,new Date)?{humanized:`within ${p}`,fullDate:`within ${p}`}:{humanized:`in ${(0,l.KQ)(g).locale("en").fromNow(!0)}`,fullDate:(0,o.LE)(g,{format:"YYYY-MM-DD HH:mm:ss"})}}function c(m){if(!m)return null;if(!isNullDate(m))return formatDistanceToNowStrict(new Date(m))}},56369:(Z,R,e)=>{"use strict";e.d(R,{Jc:()=>H,kL:()=>k,XY:()=>_});var n=e(24619),a=e(29609);const s=1,l=2,o=3,d=4,i=5,c=6,m=7,p=8,h=9,r=10,g=11,y=12,v=13,x=14,f=15,u=0,b=1,E=2,D=3,C=4,P=5,T=6,O=7,I=8,j=9,W=10;var B=e(2543),S=e(48820);const w=S.U1.deserialize({version:14,states:"!vOQOPOOO{OPO'#CkOOOO'#Ck'#CkOQOPO'#CoOOOO'#Cl'#ClQQOPOOO!yOQO'#C^O#OOPO'#CmO#TOPO,59VOOOO,59Z,59ZOOOO-E6j-E6jOOOO,58x,58xOOOO,59X,59XOOOO-E6k-E6k",stateData:"$t~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UO^UOdPOfQO~OeVOR_XT_XU_XV_XW_XX_XY_XZ_X[_X]_X^_Xd_Xf_X~OSZO~Od[O~OeVOR_aT_aU_aV_aW_aX_aY_aZ_a[_a]_a^_ad_af_a~OR~T~U~V~W~Y~Z~[~]~^~R^][ZYXWVUTd~",goto:"}dPPePPPPPPPPPPPPejpPvVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken ContactPointToken FreeFormExpression",maxTerm:22,skippedNodes:[0],repeatNodeCount:2,tokenData:"$ nRRtqr#crs&ost#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]+q!]#V#c#V#W-T#W#X@m#X#Z#c#Z#[!/S#[#]!7|#]#`#c#`#a!B`#a#b#c#b#c!KY#c#d#c#d#e#,W#e#f#c#f#g#8S#g#h#?d#h#i#H^#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#jcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cQ$zcSQqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uQ&YP;=`<%l$uQ&`P;=`;NQ$uR&fP;=`<%l#cR&lP;=`;NQ#cR&rrX^(|pq(|qr(|st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R)PsX^(|pq(|qr(|rs+^st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R+eOSQfPR+hP;=`<%l(|R+nP;=`;NQ(|R+xcSQePqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR-[eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d.m#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR.teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c0V#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR0^eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i1o#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR1veSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U3X#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR3`eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W4q#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR4xeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i6Z#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR6beSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]!r#c!r!s7s!s$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR7zeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d9]#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR9deSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^:u#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR:|eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c<_#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR<feSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i=w#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR>OcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]?Z!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR?bcSQ^Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR@teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UBV#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRB^fSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#hCr#h#i! n#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRCyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]E[#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cREceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#VFt#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRF{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#dH^#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRHeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UIv#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRI}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#gK`#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRKgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#W#c#W#XLx#X$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRMPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRNccSQ[Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR! ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!#W#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!#_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h!$p#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!$weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!&Y#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!&aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!'r#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!'yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!)[#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!)ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W!*t#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!*{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!,^#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!,ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!-p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!-wcSQRPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!/ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!0l#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!0seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!2U#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!2]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!3n#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!3ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e!5W#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!5_cSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!6j!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!6qcSQVPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!8TeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!9f#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!9meSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!;O#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!;VeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!<h#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!<oeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i!>Q#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!>XeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]!?j#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!?qcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!@|!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!ATcSQZPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!BgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Cx#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!DPeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#V!Eb#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!EieSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!Fz#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!GReSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!Hd#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!HkcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!Iv!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!I}cSQUPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!KaeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Lr#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!LyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#a#c#a#b!N[#b$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!NceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y# t#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR# {eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h##^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR##eeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#$v#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#$}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#&`#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#&geSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W#'x#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#(PeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#)b#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#)icSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#*t!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#*{cSQTPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#,_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#-p#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#-weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#/Y#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#/aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#Z#c#Z#[#0r#[$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#0yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^#2[#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#2ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c#3t#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#3{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h#5^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#5ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#6p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#6wcSQ]Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#8ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#9l#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#9seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#;U#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#;]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#<n#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#<ucSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#>Q!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#>XcSQWPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#?keSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#@|#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#ATeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#Bf#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#BmeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#DO#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#DVeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Eh#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#EocSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#Fz!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#GRcSQXPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#HeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#m#c#m#n#Iv#n$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#I}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#K`#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#KgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Lx#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#MPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#NccSQYPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$u",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:141,nameSpaceFilter:143,labelFilter:145,groupFilter:147,ruleFilter:149,stateFilter:84,typeFilter:151,healthFilter:153,dashboardFilter:155,pluginsFilter:157,contactPointFilter:159},tokenPrec:161}),N={[o]:"datasource",[i]:"namespace",[c]:"label",[p]:"rule",[m]:"group",[h]:"state",[r]:"type",[g]:"health",[y]:"dashboard",[v]:"plugins",[x]:"contactPoint"};var M=(z=>(z.dataSource="dataSourceFilter",z.nameSpace="nameSpaceFilter",z.label="labelFilter",z.group="groupFilter",z.rule="ruleFilter",z.state="stateFilter",z.type="typeFilter",z.health="healthFilter",z.dashboard="dashboardFilter",z.plugins="pluginsFilter",z.contactPoint="contactPointFilter",z))(M||{});function L(z,Y,X){V(z,Y,Q=>{if(Q.type.id===l){const q=A(z,Q);if(q.type&&q.value){const te=X[q.type];te&&te(q.value)}}else if(Q.type.id===f){const q=X[f];q&&q(U(z,Q))}})}function A(z,Y){if(Y.type.id!==l)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const X=Y.firstChild;if(!X)return{type:void 0,value:void 0};const Q=Y.getChild(d),q=Q?(0,B.trim)(U(z,Q),'"'):void 0;return{type:X.type.id,value:q}}function U(z,Y){return z.slice(Y.from,Y.to).trim().replace(/\"/g,"")}function F(z,Y,X){const Q=[];V(z,Y,te=>{te.type.id===l&&te.firstChild&&Q.push(te.firstChild),te.type.id===f&&Q.push(te)});const q=[];return Q.forEach(te=>{const ne=X.findIndex(se=>se.type===te.type.id);if(ne!==-1){if(te.parent?.type.is(l)){const se=N[te.type.id],ue=X.splice(ne,1)[0];q.push(`${se}:${K(ue.value)}`)}if(te.type.is(f)){const se=X.splice(ne,1)[0];q.push(se.value)}}}),X.forEach(te=>{te.type===f?q.push(te.value):q.push(`${N[te.type]}:${K(te.value)}`)}),q.join(" ")}function V(z,Y,X){const Q=Y.join(" "),te=w.configure({dialect:Q}).parse(z).cursor();do X(te.node);while(te.next())}function K(z){return/\s/.test(z)?`"${z}"`:z}const G=[M.dataSource,M.nameSpace,M.label,M.group,M.rule,M.state,M.type,M.health,M.dashboard,M.plugins,M.contactPoint];var H=(z=>(z.Ok="ok",z.Error="error",z.NoData="nodata",z.Unknown="unknown",z))(H||{});function _(z){const Y={labels:[],freeFormWords:[],dataSourceNames:[]},X={[o]:Q=>Y.dataSourceNames.push(Q),[i]:Q=>Y.namespace=Q,[m]:Q=>Y.groupName=Q,[p]:Q=>Y.ruleName=Q,[c]:Q=>Y.labels.push(Q),[h]:Q=>Y.ruleState=J(Q),[r]:Q=>(0,a.nf)(Q)?Y.ruleType=Q:void 0,[g]:Q=>Y.ruleHealth=(0,a.f6)(Q),[y]:Q=>Y.dashboardUid=Q,[v]:Q=>Y.plugins=Q==="hide"?Q:void 0,[x]:Q=>Y.contactPoint=Q,[f]:Q=>Y.freeFormWords.push(Q)};return L(z,G,X),Y}function k(z,Y){const X=[];return Y.dataSourceNames&&X.push(...Y.dataSourceNames.map(Q=>({type:o,value:Q}))),Y.namespace&&X.push({type:i,value:Y.namespace}),Y.groupName&&X.push({type:m,value:Y.groupName}),Y.ruleName&&X.push({type:p,value:Y.ruleName}),Y.ruleState&&X.push({type:h,value:Y.ruleState}),Y.ruleType&&X.push({type:r,value:Y.ruleType}),Y.ruleHealth&&X.push({type:g,value:Y.ruleHealth}),Y.labels&&X.push(...Y.labels.map(Q=>({type:c,value:Q}))),Y.dashboardUid&&X.push({type:y,value:Y.dashboardUid}),Y.plugins&&X.push({type:v,value:Y.plugins}),Y.freeFormWords&&X.push(...Y.freeFormWords.map(Q=>({type:f,value:Q}))),Y.contactPoint&&X.push({type:x,value:Y.contactPoint}),F(z,G,X)}function J(z){if(z==="normal")return n.cF.Inactive;if((0,n.Si)(z))return z}},5358:(Z,R,e)=>{"use strict";e.d(R,{Kh:()=>y,VI:()=>h,b9:()=>p});var n=e(74848),a=e(96540),s=e(36490),l=e(29043),o=e(84266),d=e(93395),i=e(95443),c=e(52161);const m=a.createContext(void 0),p=({children:v,accessType:x,alertmanagerSourceName:f})=>{const u=s.Ny.getSearch(),b=s.Ny.partial,E=(0,d.W)(x),D=E.availableInternalDataSources.concat(E.availableExternalDataSources),C=a.useCallback(M=>{r(D,M)&&(M===c.hY?(l.A.delete(i.Oq),b({[i.DD]:void 0})):(l.A.set(i.Oq,M),b({[i.DD]:M})))},[D,b]),P=u.get(i.DD),T=l.A.get(i.Oq),O=c.hY;a.useEffect(()=>{P&&P!==T&&l.A.set(i.Oq,P)},[P,T]);const I=f??P??T??O,j=r(D,I)?I:void 0,W=(0,c.r3)(j)?.jsonData,B=j===c.hY,S=W?y(W):!1,N={selectedAlertmanager:j,hasConfigurationAPI:B||S,isGrafanaAlertmanager:B,selectedAlertmanagerConfig:W,availableAlertManagers:D,setSelectedAlertmanager:C};return(0,n.jsx)(m.Provider,{value:N,children:v})};function h(){const v=a.useContext(m);if(v===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return v}function r(v,x){return v.map(u=>u.name).includes(x)}const g=[o.Oz.mimir,o.Oz.cortex,void 0];function y(v){return g.includes(v.implementation)}},11018:(Z,R,e)=>{"use strict";e.d(R,{nO:()=>W,D3:()=>j,yo:()=>P,nV:()=>T,JH:()=>O,Lc:()=>C,mB:()=>E,eB:()=>D,uQ:()=>S,bO:()=>B,RW:()=>I});var n=e(65307),a=e(2543),s=e(25992),l=e(36490),o=e(74268),d=e(47938),i=e(91984),c=e(68143);function m(w){return(0,c.AI)().get("/api/annotations",{alertUID:w}).then(N=>N?.sort(p))}function p(w,N){const M=(U,F)=>U>F?-1:F>U?1:0,L=M(w.timeEnd,N.timeEnd);if(L)return L;const A=M(w.time,N.time);return A||M(w.id,N.id)}var h=e(55143),r=e(78467),g=e(77295),y=e(86017),v=e(52161),x=e(77256),f=e(36200),u=e(29609),b=e(15629);const E=(0,n.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:w,filter:N,limitAlerts:M,matcher:L,state:A,identifier:U},F)=>{const V=(0,o.U7)("unifiedalerting/fetchPromRules",r.sA,{dataSourceName:w,thunk:"unifiedalerting/fetchPromRules"});return await(0,f.$I)(V(w,N,M,L,A,U))}),D=(0,n.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:w,filter:N},{dispatch:M,getState:L})=>{const{data:A}=await M(h.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:w}));if(!A?.rulerConfig)return null;const U=(0,o.Ke)("unifiedalerting/fetchRulerRules",g.iy,{dataSourceName:w,thunk:"unifiedalerting/fetchRulerRules"});return await(0,f.$I)(U(A.rulerConfig,N))});function C({rulesSourceName:w,identifier:N,filter:M,limitAlerts:L,matcher:A,state:U}){return async F=>{const{data:V}=await F(h.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:w}));await Promise.all([F(E({rulesSourceName:w,identifier:N,filter:M,limitAlerts:L,matcher:A,state:U})),V?.rulerConfig?F(D({rulesSourceName:w})):Promise.resolve()])}}function P(w=!1,N={}){return async(M,L)=>{const A=performance.now();await Promise.allSettled((0,v.gR)().map(async U=>{const{data:F}=await M(h.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:U})),{promRules:V,rulerRules:K}=L().unifiedAlerting;if(!F)return;const G=w||!V[U]?.loading,H=(w||!K[U]?.loading)&&!!F?.rulerConfig;await Promise.allSettled([G&&M(E({rulesSourceName:U,...N})),H&&M(D({rulesSourceName:U}))])})),(0,s.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-A})}}function T(w=!1,N={}){return async(M,L)=>{const{promRules:A}=L().unifiedAlerting;(0,v.gR)().map(U=>{(w||!A[U]?.loading)&&M(E({rulesSourceName:U,...N}))})}}const O=(0,n.zD)("unifiedalerting/fetchGrafanaAnnotations",w=>(0,f.$I)(m(w))),I=(0,n.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:w,oldConfig:N,newConfig:M,successMessage:L,redirectPath:A,redirectSearch:U},F)=>(0,f.v5)((0,f.$I)((async()=>{const V=await F.dispatch(i.m.endpoints.getAlertmanagerConfiguration.initiate(w,{forceRefetch:!0})).unwrap(),K=(0,a.isEmpty)(V.alertmanager_config)&&(0,a.isEmpty)(V.template_files),G=JSON.stringify(V)!==JSON.stringify(N);if(!K&&G)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,d.vk)(w,(0,y.MZ)(M)),F.dispatch(i.m.util.invalidateTags(["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"])),A){const H=new URLSearchParams(U??"");l.Ny.push((0,x.nL)(A,w,H))}})()),{successMessage:L})),j=(0,n.zD)("unifiedalerting/fetchAlertGroups",w=>(0,f.$I)((0,d.f4)(w))),W=(0,n.zD)("unifiedalerting/deleteAlertManagerConfig",async(w,N)=>(0,f.v5)((0,f.$I)((async()=>{await(0,d.nd)(w),await N.dispatch(i.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),B=(0,n.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:w,receivers:N,alert:M})=>(0,f.v5)((0,f.$I)((0,d.By)(w,N,M)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),S=(w,N)=>w.filter(M=>{const{forDuration:L}=(0,u.jg)(M,N),A=L?(0,b.P8)(L):null,U=(0,b.P8)(N);return A?A!==0&&A<U:!1})},18771:(Z,R,e)=>{"use strict";e.d(R,{H:()=>a});var n=e(22803);const a=s=>(0,n.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:s.spacing(2,0)})},2869:(Z,R,e)=>{"use strict";e.d(R,{W:()=>n});var n=(a=>(a.Incident="grafana-incident-app",a.OnCall="grafana-oncall-app",a.Irm="grafana-irm-app",a.MachineLearning="grafana-ml-app",a.Labels="grafana-labels-app",a.Slo="grafana-slo-app",a))(n||{})},67817:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>n});var n=(a=>(a.grafana="grafana-alerting",a.grafanaRecording="grafana-recording",a.cloudAlerting="cloud-alerting",a.cloudRecording="cloud-recording",a))(n||{})},72649:(Z,R,e)=>{"use strict";e.d(R,{y:()=>n});var n=(a=>(a.seconds="s",a.minutes="m",a.hours="h",a.days="d",a.weeks="w",a))(n||{})},54:(Z,R,e)=>{"use strict";e.d(R,{C0:()=>y,HL:()=>d,Q9:()=>v,VQ:()=>i,Wd:()=>g,jy:()=>h,lV:()=>r,nU:()=>c,q0:()=>x});var n=e(65642),a=e(15130),s=e(11257),l=e(52161);function o(f){return(0,l.z2)(f)?"grafana":"external"}const d={read:{grafana:s.w.AlertingInstanceRead,external:s.w.AlertingInstancesExternalRead},create:{grafana:s.w.AlertingInstanceCreate,external:s.w.AlertingInstancesExternalWrite},update:{grafana:s.w.AlertingInstanceUpdate,external:s.w.AlertingInstancesExternalWrite},delete:{grafana:s.w.AlertingInstanceUpdate,external:s.w.AlertingInstancesExternalWrite}},i={read:{grafana:s.w.AlertingNotificationsRead,external:s.w.AlertingNotificationsExternalRead},create:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite},update:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite},delete:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite}},c={read:{grafana:s.w.AlertingSilenceRead,external:s.w.AlertingInstanceRead},create:{grafana:s.w.AlertingSilenceCreate,external:s.w.AlertingInstancesExternalWrite},update:{grafana:s.w.AlertingSilenceUpdate,external:s.w.AlertingInstancesExternalWrite}},m={read:s.w.AlertingProvisioningRead,readSecrets:s.w.AlertingProvisioningReadSecrets,write:s.w.AlertingProvisioningWrite},p={read:{grafana:s.w.AlertingRuleRead,external:s.w.AlertingRuleExternalRead},create:{grafana:s.w.AlertingRuleCreate,external:s.w.AlertingRuleExternalWrite},update:{grafana:s.w.AlertingRuleUpdate,external:s.w.AlertingRuleExternalWrite},delete:{grafana:s.w.AlertingRuleDelete,external:s.w.AlertingRuleExternalWrite}};function h(f){const u=o(f);return{read:d.read[u],create:d.create[u],update:d.update[u],delete:d.delete[u]}}function r(f){const u=o(f);return{read:i.read[u],create:i.create[u],update:i.update[u],delete:i.delete[u],provisioning:m}}function g(f){const u=o(f);return{read:p.read[u],create:p.create[u],update:p.update[u],delete:p.delete[u]}}function y(f){return()=>a.TP.evaluatePermission(f)}function v(){return{canCreateGrafanaRules:a.TP.hasPermission(s.w.FoldersRead)&&a.TP.hasPermission(p.create.grafana),canCreateCloudRules:a.TP.hasPermission(s.w.DataSourcesRead)&&a.TP.hasPermission(p.create.external),canEditRules:f=>a.TP.hasPermission(g(f).update)}}function x(){const{unifiedAlertingEnabled:f}=(0,n.zj)(),u=a.TP.hasPermission(g(l.hY).read),b=a.TP.hasPermission(g(l.hY).update);return f&&u&&b}},86017:(Z,R,e)=>{"use strict";e.d(R,{$P:()=>W,$m:()=>p,Av:()=>b,Dm:()=>O,EU:()=>E,LF:()=>T,MN:()=>r,MU:()=>y,MZ:()=>c,NL:()=>u,UL:()=>j,VE:()=>D,Wc:()=>v,_n:()=>m,mP:()=>B,uH:()=>I,xH:()=>f});var n=e(2543),a=e.n(n),s=e(84266),l=e(182),o=e(52161),d=e(39659),i=e(63895);function c(S){return S.alertmanager_config.receivers||(S.alertmanager_config.receivers=[{name:"default "}]),S.alertmanager_config.route||(S.alertmanager_config.route={receiver:S.alertmanager_config.receivers[0].name}),S.template_files||(S.template_files={}),S}function m(S,w){return{...w,mute_time_intervals:w.mute_time_intervals?.filter(M=>M!==S)??[],active_time_intervals:w.active_time_intervals?.filter(M=>M!==S)??[],routes:w.routes?.map(M=>m(S,M))}}function p(S,w,N){return{...N,mute_time_intervals:N.mute_time_intervals?.map(M=>M===w?S:M),active_time_intervals:N.active_time_intervals?.map(M=>M===w?S:M),routes:N.routes?.map(M=>p(S,w,M))}}function h(S){return S.map(([w,N,M])=>[w,N,unquoteWithUnescape(M)])}function r(S){return S.isEqual?S.isRegex?s.ho.regex:s.ho.equal:S.isRegex?s.ho.notRegex:s.ho.notEqual}function g(S){switch(S){case s.ho.equal:return{isEqual:!0,isRegex:!1};case s.ho.notEqual:return{isEqual:!1,isRegex:!1};case s.ho.regex:return{isEqual:!0,isRegex:!0};case s.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function y(S){return{name:S.name,value:S.value,operator:r(S)}}function v(S){return{name:S.name,value:S.value,...g(S.operator)}}function x(S){return`{ ${S.map(y).reduce((M,L)=>{const A=`${L.name}${L.operator}"${L.value}"`;return M?`${M}, ${A}`:A},"")} }`}const f=[{label:s.ho.equal,description:"Equals",value:s.ho.equal},{label:s.ho.notEqual,description:"Does not equal",value:s.ho.notEqual},{label:s.ho.regex,description:"Matches regex",value:s.ho.regex},{label:s.ho.notRegex,description:"Does not match regex",value:s.ho.notRegex}];function u(S){const w=r(S);return[S.name,w,S.value]}function b(S,w){const N=(0,d.Dd)(S),M=w.map(u);return(0,i.ry)(M,N)}function E(...S){const w=S.map(i.Zc).flat(),N=(0,n.uniqWith)(w,n.isEqual);return x(N)}function D(S){return S===o.hY?"default":"unquote"}function C(){return getAllDataSources().filter(S=>S.type===DataSourceType.Alertmanager)}function P(S){return C().find(w=>S===w.uid)}function T(S){const{times:w,weekdays:N,days_of_month:M,months:L,years:A,location:U}=S,F=O(w,U),V=I(N),K=j(M),G=W(L),H=B(A);return[F,V,K,G,H].join(", ")}function O(S,w){return"Times: "+(S?S?.map(({start_time:N,end_time:M})=>`${N} - ${M} [${w??"UTC"}]`).join(" and "):"All")}function I(S){return"Weekdays: "+(S?.map(w=>{if(w.includes(":"))return w.split(":").map(N=>{const M=N.slice(0,3);return M[0].toLocaleUpperCase()+M.slice(1)}).join("-");{const N=w.slice(0,3);return N[0].toLocaleUpperCase()+N.slice(1)}}).join(", ")??"All")}function j(S){return"Days of the month: "+(S?.join(", ")??"All")}function W(S){return"Months: "+(S?.join(", ")??"All")}function B(S){return"Years: "+(S?.join(", ")??"All")}},42824:(Z,R,e)=>{"use strict";e.d(R,{DY:()=>C,Mk:()=>f,QM:()=>y,Rg:()=>p,SJ:()=>x,YE:()=>v,Yl:()=>r,gY:()=>u,hH:()=>E,ie:()=>b});var n=e(84266),a=e(86017),s=e(52161),l=e(63895),o=e(67923),d=e(15629);const i=(P,T)=>Object.entries(P??{}).reduce((O,[I,j])=>[...O,{name:I,value:j,operator:T?n.ho.regex:n.ho.equal}],[]),c=P=>P.value,m=P=>(P??[]).map(c),p={name:"",value:"",operator:n.ho.equal},h=["grafana_folder","alertname"],r=[{label:"grafana_folder",value:"grafana_folder",isFixed:!0},{label:"alertname",value:"alertname",isFixed:!0},{label:"Disable (...)",value:"..."}],g={id:"",overrideGrouping:!1,groupBy:h,object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupIntervalValue:"",repeatIntervalValue:"",muteTimeIntervals:[],activeTimeIntervals:[]};function y(P,T="0"){const O=(0,o.KR)(P),I=P.routes??[];return{id:`${T}-${O}`,...P,routes:I.map((j,W)=>y(j,`${T}-${W}`))}}const v=P=>{if(!P)return g;const T=P.id;if(Object.keys(P).length===0)return{...g,id:T};const O=[];P.routes?.forEach(W=>{const B=v(W);O.push(B)});const I=P.object_matchers?.map(W=>({name:W[0],operator:W[1],value:W[2]}))??[],j=P.matchers?.flatMap(W=>(0,l.So)(W).flatMap(a.MU)).map(({name:W,operator:B,value:S})=>({name:(0,l.Ig)(W),operator:B,value:(0,l.Ig)(S)}))??[];return{id:T,object_matchers:[...j,...I,...i(P.match,!1),...i(P.match_re,!0)],continue:P.continue??!1,receiver:P.receiver??"",overrideGrouping:Array.isArray(P.group_by)&&P.group_by.length>0,groupBy:P.group_by??void 0,overrideTimings:[P.group_wait,P.group_interval,P.repeat_interval].some(Boolean),groupWaitValue:P.group_wait??"",groupIntervalValue:P.group_interval??"",repeatIntervalValue:P.repeat_interval??"",routes:O,muteTimeIntervals:P.mute_time_intervals??[],activeTimeIntervals:P.active_time_intervals??[]}},x=(P,T,O)=>{const I=(0,o.eM)(T.id??"",O),{overrideGrouping:j,groupBy:W,overrideTimings:B,groupWaitValue:S,groupIntervalValue:w,repeatIntervalValue:N,receiver:M}=T,L=void 0,A=j?W:L,F=B&&S?S:L,K=B&&w?w:L,H=B&&N?N:L,_=T.object_matchers?.filter(z=>z.name&&z.operator&&z.value!==null&&z.value!==void 0).map(({name:z,operator:Y,value:X})=>[z,Y,X]),k=T.routes?.map(z=>x(P,z,O)),J={...I??{},continue:T.continue,group_by:A,object_matchers:_,match:void 0,match_re:void 0,group_wait:F,group_interval:K,repeat_interval:H,routes:k,mute_time_intervals:T.muteTimeIntervals,active_time_intervals:T.activeTimeIntervals,receiver:M};return P!==s.hY?(J.matchers=T.object_matchers?.map(l.b2),J.object_matchers=void 0):(J.object_matchers=(0,l.J$)(J),J.matchers=void 0),T.receiver&&(J.receiver=T.receiver),J},f=P=>({label:P,value:P}),u=P=>(P??[]).map(f),b=P=>P?m(P):[];function E(P){return!P||P.length===0?!0:(0,d.TN)(P)||"Invalid duration format. Must be {number}{time_unit}"}const D=P=>P.map(T=>{const[O,I,j]=T;return`${O}${I}${j}`}),C=(P,T="")=>{if(P.length===0)return!0;const O=E(P),I=E(T);if(O!==!0)return O;if(I!==!0)return I;const j=(0,d.P8)(P),W=(0,d.P8)(T);return W!==0&&j<W?"Repeat interval should be higher or equal to Group interval":!0}},75640:(Z,R,e)=>{"use strict";e.d(R,{Hx:()=>o,gO:()=>d});var n=e(96540),a=e(95443),s=e(77256);function l(i){return{dashboardUID:i.find(([c])=>c===a.YH.dashboardUID)?.[1],panelId:i.find(([c])=>c===a.YH.panelID)?.[1]}}function o(i){return(0,n.useMemo)(()=>Object.entries(i||{}).filter(([c,m])=>!!m.trim()),[i])}function d(i){const c=new Map,{panelId:m,dashboardUID:p}=l(i);return p&&c.set(a.YH.dashboardUID,(0,s.JM)(p)),p&&m&&c.set(a.YH.panelID,(0,s.D2)(p,m)),c}},51740:(Z,R,e)=>{"use strict";e.d(R,{U:()=>m,r:()=>c});var n=e(43173),a=e(72930);const s=(0,a.u)("basic_auth","Basic auth","Sets the `Authorization` header with the configured username and password. Password and password_file are mutually exclusive.",{element:"subform",subformOptions:[(0,a.u)("username","Username",""),(0,a.u)("password","Password",""),(0,a.u)("password_file","Password file","")]}),l=(0,a.u)("tls_config","TLS config","Configures the TLS settings.",{element:"subform",subformOptions:[(0,a.u)("ca_file","CA file","CA certificate to validate the server certificate with."),(0,a.u)("cert_file","Cert file","Certificate for client cert authentication to the server."),(0,a.u)("key_file","Key file","Key file for client cert authentication to the server."),(0,a.u)("server_name","Server name","ServerName extension to indicate the name of the server."),(0,a.u)("insecure_skip_verify","Skip verify","Disable validation of the server certificate.",{element:"checkbox"})]}),o=(0,a.u)("oauth2","OAuth2","Configures the OAuth2 settings.",{element:"subform",subformOptions:[(0,a.u)("client_id","Client ID","The OAuth2 client ID",{required:!0}),(0,a.u)("client_secret","Client secret","The OAuth2 client secret",{required:!0}),(0,a.u)("token_url","Token URL","The OAuth2 token exchange URL",{required:!0}),(0,a.u)("scopes","Scopes","Comma-separated list of scopes",{element:"string_array"}),(0,a.u)("endpoint_params","Additional parameters","",{element:"key_value_map"})]}),d=(0,a.u)("http_config","HTTP Config","Note that `basic_auth`, `bearer_token` and `bearer_token_file` options are mutually exclusive.",{element:"subform",subformOptions:[(0,a.u)("bearer_token","Bearer token","Sets the `Authorization` header with the configured bearer token."),(0,a.u)("bearer_token_file","Bearer token file","Sets the `Authorization` header with the bearer token read from the configured file."),(0,a.u)("proxy_url","Proxy URL","Optional proxy URL."),s,l,o]}),i={name:"Jira",description:"Send notifications to Jira Service Management",type:"jira",info:"",heading:"Jira settings",options:[(0,a.u)("api_url","API URL","The host to send Jira API requests to",{required:!0}),(0,a.u)("project","Project Key","The project key where issues are created",{required:!0}),(0,a.u)("summary","Summary","Issue summary template",{placeholder:'{{ template "jira.default.summary" . }}'}),(0,a.u)("description","Description","Issue description template",{placeholder:'{{ template "jira.default.description" . }}'}),(0,a.u)("labels","Labels"," Labels to be added to the issue",{element:"string_array"}),(0,a.u)("priority","Priority","Priority of the issue",{placeholder:'{{ template "jira.default.priority" . }}'}),(0,a.u)("issue_type","Issue Type","Type of the issue (e.g. Bug)",{required:!0}),(0,a.u)("reopen_transition","Reopen transition",'Name of the workflow transition to reopen an issue. The target status should not have the category "done"'),(0,a.u)("resolve_transition","Resolve transition",'Name of the workflow transition to resolve an issue. The target status must have the category "done"'),(0,a.u)("wont_fix_resolution","Won't fix resolution",'If "Reopen transition" is defined, ignore issues with that resolution'),(0,a.u)("reopen_duration","Reopen duration",'If "Reopen transition" is defined, reopen the issue when it is not older than this value (rounded down to the nearest minute)',{placeholder:"Use duration format, for example: 1.2s, 100ms"}),(0,a.u)("fields","Fields","Other issue and custom fields",{element:"key_value_map"}),d]},c=[{name:"Email",description:"Send notification over SMTP",type:"email",info:"",heading:"Email settings",options:[(0,a.u)("to","To",'The email address to send notifications to. You can enter multiple addresses using a "," separator',{required:!0}),(0,a.u)("from","From","The sender address."),(0,a.u)("smarthost","SMTP host","The SMTP host through which emails are sent."),(0,a.u)("hello","Hello","The hostname to identify to the SMTP server."),(0,a.u)("auth_username","Username","SMTP authentication information"),(0,a.u)("auth_password","Password","SMTP authentication information"),(0,a.u)("auth_secret","Secret","SMTP authentication information"),(0,a.u)("auth_identity","Identity","SMTP authentication information"),(0,a.u)("require_tls","Require TLS","The SMTP TLS requirement",{element:"checkbox"}),(0,a.u)("html","Email HTML body","The HTML body of the email notification.",{placeholder:'{{ template "email.default.html" . }}',element:"textarea"}),(0,a.u)("text","Email text body","The text body of the email notification.",{element:"textarea"}),(0,a.u)("headers","Headers","Further headers email header key/value pairs. Overrides any headers previously set by the notification implementation.",{element:"key_value_map"}),l]},{name:"PagerDuty",description:"Send notifications to PagerDuty",type:"pagerduty",info:"",heading:"PagerDuty settings",options:[(0,a.u)("routing_key","Routing key","The PagerDuty integration key (when using PagerDuty integration type `Events API v2`)"),(0,a.u)("service_key","Service key","The PagerDuty integration key (when using PagerDuty integration type `Prometheus`)."),(0,a.u)("url","URL","The URL to send API requests to"),(0,a.u)("client","Client","The client identification of the Alertmanager.",{placeholder:'{{ template "pagerduty.default.client" . }}'}),(0,a.u)("client_url","Client URL","A backlink to the sender of the notification.",{placeholder:'{{ template "pagerduty.default.clientURL" . }}'}),(0,a.u)("description","Description","A description of the incident.",{placeholder:'{{ template "pagerduty.default.description" .}}'}),(0,a.u)("severity","Severity","Severity of the incident.",{placeholder:"error"}),(0,a.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,a.u)("images","Images","Images to attach to the incident.",{element:"subform_array",subformOptions:[(0,a.u)("href","URL","",{required:!0}),(0,a.u)("source","Source","",{required:!0}),(0,a.u)("alt","Alt","",{required:!0})]}),(0,a.u)("links","Links","Links to attach to the incident.",{element:"subform_array",subformOptions:[(0,a.u)("href","URL","",{required:!0}),(0,a.u)("text","Text","",{required:!0})]}),d]},{name:"Pushover",description:"Send notifications to Pushover",type:"pushover",info:"",heading:"Pushover settings",options:[(0,a.u)("user_key","User key","The recipient user\u2019s user key.",{required:!0}),(0,a.u)("token","Token","Your registered application\u2019s API token, see https://pushover.net/app",{required:!0}),(0,a.u)("title","Title","Notification title.",{placeholder:'{{ template "pushover.default.title" . }}'}),(0,a.u)("message","Message","Notification message.",{placeholder:'{{ template "pushover.default.message" . }}'}),(0,a.u)("url","URL","A supplementary URL shown alongside the message.",{placeholder:'{{ template "pushover.default.url" . }}'}),(0,a.u)("priority","Priority","Priority, see https://pushover.net/api#priority",{placeholder:'{{ if eq .Status "firing" }}2{{ else }}0{{ end }}'}),(0,a.u)("retry","Retry","How often the Pushover servers will send the same notification to the user. Must be at least 30 seconds.",{placeholder:"1m"}),(0,a.u)("expire","Expire","How long your notification will continue to be retried for, unless the user acknowledges the notification.",{placeholder:"1h"}),(0,a.u)("ttl","TTL","The number of seconds before a message expires and is deleted automatically. Examples: 10s, 5m30s, 8h.",{validationRule:"^(\\d+[s|m|h])+$|^$",element:"input"}),d]},{name:"Slack",description:"Send notifications to Slack",type:"slack",info:"",heading:"Slack settings",options:[(0,a.u)("api_url","Webhook URL","The Slack webhook URL."),(0,a.u)("channel","Channel","The #channel or @user to send notifications to.",{required:!0}),(0,a.u)("icon_emoji","Emoji icon",""),(0,a.u)("icon_url","Icon URL",""),(0,a.u)("link_names","Names link","",{element:"checkbox"}),(0,a.u)("username","Username","",{placeholder:'{{ template "slack.default.username" . }}'}),(0,a.u)("callback_id","Callback ID","",{placeholder:'{{ template "slack.default.callbackid" . }}'}),(0,a.u)("color","Color","",{placeholder:'{{ if eq .Status "firing" }}danger{{ else }}good{{ end }}'}),(0,a.u)("fallback","Fallback","",{placeholder:'{{ template "slack.default.fallback" . }}'}),(0,a.u)("footer","Footer","",{placeholder:'{{ template "slack.default.footer" . }}'}),(0,a.u)("mrkdwn_in","Mrkdwn fields","An array of field names that should be formatted by mrkdwn syntax.",{element:"string_array"}),(0,a.u)("pretext","Pre-text","",{placeholder:'{{ template "slack.default.pretext" . }}'}),(0,a.u)("short_fields","Short fields","",{element:"checkbox"}),(0,a.u)("text","Message body","",{element:"textarea",placeholder:'{{ template "slack.default.text" . }}'}),(0,a.u)("title","Title","",{placeholder:'{{ template "slack.default.title" . }}'}),(0,a.u)("title_link","Title link","",{placeholder:'{{ template "slack.default.titlelink" . }}'}),(0,a.u)("image_url","Image URL",""),(0,a.u)("thumb_url","Thumbnail URL",""),(0,a.u)("actions","Actions","",{element:"subform_array",subformOptions:[(0,a.u)("text","Text","",{required:!0}),(0,a.u)("type","Type","",{required:!0}),(0,a.u)("url","URL","Either url or name and value are mandatory."),(0,a.u)("name","Name",""),(0,a.u)("value","Value",""),(0,a.u)("confirm","Confirm","",{element:"subform",subformOptions:[(0,a.u)("text","Text","",{required:!0}),(0,a.u)("dismiss_text","Dismiss text",""),(0,a.u)("ok_text","OK text",""),(0,a.u)("title","Title","")]}),(0,a.u)("style","Style","")]}),(0,a.u)("fields","Fields","",{element:"subform_array",subformOptions:[(0,a.u)("title","Title","",{required:!0}),(0,a.u)("value","Value","",{required:!0}),(0,a.u)("short","Short","",{element:"checkbox"})]}),d]},...n.$.featureToggles?.alertingJiraIntegration?[i]:[],{name:"OpsGenie",description:"Send notifications to OpsGenie",type:"opsgenie",info:"",heading:"OpsGenie settings",options:[(0,a.u)("api_key","API key","The API key to use when talking to the OpsGenie API."),(0,a.u)("api_url","API URL","The host to send OpsGenie API requests to."),(0,a.u)("message","Message","Alert text limited to 130 characters."),(0,a.u)("description","Description","A description of the incident.",{placeholder:'{{ template "opsgenie.default.description" . }}'}),(0,a.u)("source","Source","A backlink to the sender of the notification.",{placeholder:'{{ template "opsgenie.default.source" . }}'}),(0,a.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,a.u)("tags","Tags","Comma separated list of tags attached to the notifications."),(0,a.u)("note","Note","Additional alert note."),(0,a.u)("priority","Priority","Priority level of alert. Possible values are P1, P2, P3, P4, and P5."),(0,a.u)("responders","Responders","List of responders responsible for notifications.",{element:"subform_array",subformOptions:[(0,a.u)("type","Type",'"team", "user", "escalation" or schedule".',{required:!0}),(0,a.u)("id","ID","Exactly one of these fields should be defined."),(0,a.u)("name","Name","Exactly one of these fields should be defined."),(0,a.u)("username","Username","Exactly one of these fields should be defined.")]}),d]},{name:"VictorOps",description:"Send notifications to VictorOps",type:"victorops",info:"",heading:"VictorOps settings",options:[(0,a.u)("api_key","API key","The API key to use when talking to the VictorOps API."),(0,a.u)("api_url","API URL","The VictorOps API URL."),(0,a.u)("routing_key","Routing key","A key used to map the alert to a team.",{required:!0}),(0,a.u)("message_type","Message type","Describes the behavior of the alert (CRITICAL, WARNING, INFO)."),(0,a.u)("entity_display_name","Entity display name","Contains summary of the alerted problem.",{placeholder:'{{ template "victorops.default.entity_display_name" . }}'}),(0,a.u)("state_message","State message","Contains long explanation of the alerted problem.",{placeholder:'{{ template "victorops.default.state_message" . }}'}),(0,a.u)("monitoring_tool","Monitoring tool","The monitoring tool the state message is from.",{placeholder:'{{ template "victorops.default.monitoring_tool" . }}'}),d]},{name:"Webhook",description:"Send notifications to a webhook",type:"webhook",info:"",heading:"Webhook settings",options:[(0,a.u)("url","URL","The endpoint to send HTTP POST requests to.",{required:!0}),(0,a.u)("max_alerts","Max alerts","The maximum number of alerts to include in a single webhook message. Alerts above this threshold are truncated. When leaving this at its default value of 0, all alerts are included.",{placeholder:"0",inputType:"number",validationRule:"(^\\d+$|^$)",setValueAs:p=>{const h=Number(p);return Number.isFinite(h)?h:0}}),(0,a.u)("timeout","Timeout","The maximum time to wait for a webhook request to complete, before failing the request and allowing it to be retried. The default value of 0s indicates that no timeout should be applied. NOTE: This will have no effect if set higher than the group_interval.",{placeholder:"Use duration format, for example: 1.2s, 100ms"}),d]},{name:"Discord",description:"Sends notifications to Discord",type:"discord",info:"",heading:"Discord settings",options:[(0,a.u)("title","Title","Templated title of the message",{placeholder:'{{ template "discord.default.title" . }}'}),(0,a.u)("message","Message Content","Mention a group using @ or a user using <@ID> when notifying in a channel",{placeholder:'{{ template "discord.default.message" . }}'}),(0,a.u)("webhook_url","Webhook URL","",{placeholder:"Discord webhook URL",required:!0}),d]},{name:"Cisco Webex Teams",description:"Sends notifications to Cisco Webex Teams",type:"webex",info:"",heading:"Cisco Webex Teams settings",options:[(0,a.u)("api_url","API URL","The Webex Teams API URL",{placeholder:"https://webexapis.com/v1/messages"}),(0,a.u)("room_id","Room ID","ID of the Webex Teams room where to send the messages",{required:!0}),(0,a.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),{...d,required:!0}]},{name:"Telegram",description:"Sends notifications to Telegram",type:"telegram",info:"",heading:"Telegram settings",options:[(0,a.u)("api_url","API URL","The Telegram API URL",{placeholder:"https://api.telegram.org"}),(0,a.u)("bot_token","Bot token","Telegram bot token",{required:!0}),(0,a.u)("chat_id","Chat ID","ID of the chat where to send the messages",{required:!0,setValueAs:p=>typeof p=="string"?parseInt(p,10):p}),(0,a.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),(0,a.u)("disable_notifications","Disable notifications","Disable telegram notifications",{element:"checkbox"}),(0,a.u)("parse_mode","Parse mode","Parse mode for telegram message",{element:"select",defaultValue:{label:"None",value:""},selectOptions:[{label:"None",value:""},{label:"MarkdownV2",value:"MarkdownV2"},{label:"Markdown",value:"Markdown"},{label:"HTML",value:"HTML"}]}),d]},{name:"Amazon SNS",description:"Sends notifications to Amazon SNS",type:"sns",info:"",heading:"Amazon SNS settings",options:[(0,a.u)("api_url","API URL","The Amazon SNS API URL"),(0,a.u)("sigv4","SigV4 authentication","Configures AWS's Signature Verification 4 signing process to sign requests",{element:"subform",subformOptions:[(0,a.u)("region","Region","The AWS region. If blank, the region from the default credentials chain is used"),(0,a.u)("access_key","Access key",'The AWS API access_key. If blank the environment variable "AWS_ACCESS_KEY_ID" is used'),(0,a.u)("secret_key","Secret key",'The AWS API secret_key. If blank the environment variable "AWS_ACCESS_SECRET_ID" is used'),(0,a.u)("profile","Profile","Named AWS profile used to authenticate"),(0,a.u)("role_arn","Role ARN","AWS Role ARN, an alternative to using AWS API keys")]}),(0,a.u)("topic_arn","SNS topic ARN","If you don't specify this value, you must specify a value for the phone_number or target_arn. If you are using a FIFO SNS topic you should set a message group interval longer than 5 minutes to prevent messages with the same group key being deduplicated by the SNS default deduplication window"),(0,a.u)("phone_number","Phone number","Phone number if message is delivered via SMS in E.164 format. If you don't specify this value, you must specify a value for the topic_arn or target_arn"),(0,a.u)("target_arn","Target ARN","The  mobile platform endpoint ARN if message is delivered via mobile notifications. If you don't specify this value, you must specify a value for the topic_arn or phone_number"),(0,a.u)("subject","Subject","Subject line when the message is delivered",{placeholder:'{{ template "sns.default.subject" .}}'}),(0,a.u)("message","Message","The message content of the SNS notification",{placeholder:'{{ template "sns.default.message" .}}'}),(0,a.u)("attributes","Attributes","SNS message attributes",{element:"key_value_map"}),d]},{name:"WeChat",description:"Sends notifications to WeChat",type:"wechat",info:"",heading:"WeChat settings",options:[(0,a.u)("api_url","API URL","The WeChat API URL"),(0,a.u)("api_secret","API Secret","The API key to use when talking to the WeChat API"),(0,a.u)("corp_id","Corp ID","The corp id for authentication"),(0,a.u)("message","Message","API request data as defined by the WeChat API",{placeholder:'{{ template "wechat.default.message" . }}'}),(0,a.u)("message_type","Message type","Type of the message type",{element:"select",defaultValue:{label:"Text",value:"text"},selectOptions:[{label:"Text",value:"text"},{label:"Markdown",value:"markdown"}]}),(0,a.u)("agent_id","Agent ID","",{placeholder:'{{ template "wechat.default.agent_id" . }}'}),(0,a.u)("to_user","to user","",{placeholder:'{{ template "wechat.default.to_user" . }}'}),(0,a.u)("to_party","to party","",{placeholder:'{{ template "wechat.default.to_party" . }}'}),(0,a.u)("to_tag","to tag","",{placeholder:'{{ template "wechat.default.to_tag" . }}'})]},{name:"Microsoft Teams",description:"Sends notifications to Microsoft Teams",type:"msteams",info:"",heading:"Microsoft Teams settings",options:[(0,a.u)("webhook_url","Webhook URL","The incoming webhook URL."),(0,a.u)("title","Title","Message title template.",{placeholder:'{{ template "teams.default.title" . }}'}),(0,a.u)("text","Text","Message body template.",{placeholder:'{{ template "teams.default.text" . }}'})]}],m=[(0,a.u)("smtp_from","SMTP from","The default SMTP From header field."),(0,a.u)("smtp_smarthost","SMTP smarthost","The default SMTP smarthost used for sending emails, including port number. Port number usually is 25, or 587 for SMTP over TLS (sometimes referred to as STARTTLS). Example: smtp.example.org:587"),(0,a.u)("smtp_hello","SMTP hello","The default hostname to identify to the SMTP server.",{placeholder:"localhost"}),(0,a.u)("smtp_auth_username","SMTP auth username","SMTP Auth using CRAM-MD5, LOGIN and PLAIN. If empty, Alertmanager doesn't authenticate to the SMTP server."),(0,a.u)("smtp_auth_password","SMTP auth password","SMTP Auth using LOGIN and PLAIN."),(0,a.u)("smtp_auth_identity","SMTP auth identity","SMTP Auth using PLAIN."),(0,a.u)("smtp_auth_secret","SMTP auth secret","SMTP Auth using CRAM-MD5."),(0,a.u)("smtp_require_tls","SMTP require TLS","The default SMTP TLS requirement. Note that Go does not support unencrypted connections to remote SMTP endpoints.",{element:"checkbox"}),(0,a.u)("slack_api_url","Slack API URL",""),(0,a.u)("victorops_api_key","VictorOps API key",""),(0,a.u)("victorops_api_url","VictorOps API URL","",{placeholder:"https://alert.victorops.com/integrations/generic/20131114/alert/"}),(0,a.u)("pagerduty_url","PagerDuty URL","https://events.pagerduty.com/v2/enqueue"),(0,a.u)("opsgenie_api_key","OpsGenie API key",""),(0,a.u)("opsgenie_api_url","OpsGenie API URL","",{placeholder:"https://api.opsgenie.com/"}),(0,a.u)("wechat_api_url","WeChat API URL","",{placeholder:"https://qyapi.weixin.qq.com/cgi-bin/"}),(0,a.u)("wechat_api_secret","WeChat API secret",""),(0,a.u)("wechat_api_corp_id","WeChat API corp id",""),(0,a.u)("webex_api_url","Cisco Webex Teams API URL",""),(0,a.u)("telegram_api_url","The Telegram API URL",""),d,(0,a.u)("resolve_timeout","Resolve timeout","ResolveTimeout is the default value used by alertmanager if the alert does not include EndsAt, after this time passes it can declare the alert as resolved if it has not been updated. This has no impact on alerts from Prometheus, as they always include EndsAt.",{placeholder:"5m"})]},182:(Z,R,e)=>{"use strict";e.d(R,{BO:()=>c,Wx:()=>i,ZP:()=>d,k7:()=>l,qf:()=>o});var n=e(43173),a=e(2869),s=e(15629);function l(){return Object.values(n.$.datasources)}function o(m){if(!(0,s.TN)(n.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const p=(0,s.P8)(n.$.unifiedAlerting.minInterval);if(!m||!(0,s.TN)(m))return{globalLimit:p,exceedsLimit:!1};const h=(0,s.P8)(m),r=p>h&&h>0;return{globalLimit:p,exceedsLimit:r}}function d(){return a.W.Irm in n.$.apps}function i(){return d()?a.W.Irm:a.W.Incident}function c(){return d()?a.W.Irm:a.W.OnCall}},95443:(Z,R,e)=>{"use strict";e.d(R,{DD:()=>s,H8:()=>g,HH:()=>a,J3:()=>r,Oq:()=>l,U3:()=>d,UU:()=>n,YH:()=>h,cB:()=>i,kW:()=>v,kl:()=>y,wG:()=>o});const n="ruler not supported",a=3e4,s="alertmanager",l="alerting-alertmanager",o=2e4,d=2e4,i=2e4,c="timeseries",m="table",p="stat";var h=(x=>(x.description="description",x.summary="summary",x.runbookURL="runbook_url",x.alertId="__alertId__",x.dashboardUID="__dashboardUid__",x.panelID="__panelId__",x))(h||{});const r={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},g={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},y=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],v="__alert_rule_uid__"},52161:(Z,R,e)=>{"use strict";e.d(R,{$e:()=>J,AL:()=>G,EV:()=>F,Eb:()=>K,Gb:()=>Se,Iz:()=>q,TG:()=>A,Zw:()=>Y,at:()=>ce,bD:()=>j,bS:()=>ie,bt:()=>de,cl:()=>me,cy:()=>N,gR:()=>L,hP:()=>se,hY:()=>f,iV:()=>B,k5:()=>te,lS:()=>U,o_:()=>Ie,of:()=>T,oh:()=>k,ol:()=>E,qi:()=>D,r3:()=>z,r6:()=>b,sq:()=>M,v0:()=>V,vv:()=>u,w5:()=>Q,y9:()=>ne,yc:()=>H,z2:()=>_});var n=e(78282),a=e(15130),s=e(66513),l=e(88114),o=e(84266),d=e(11257),i=e(86791),c=e(42581),m=e(91984),p=e(76070),h=e(17349),r=e(93395),g=e(5358),y=e(54),v=e(182),x=e(29609);const f="grafana",u="-- Grafana --",b={uid:i.l$,name:f,ruleSourceType:"grafana"};var E=(Me=>(Me.Alertmanager="alertmanager",Me.Loki="loki",Me.Prometheus="prometheus",Me.AmazonPrometheus="grafana-amazonprometheus-datasource",Me.AzurePrometheus="grafana-azureprometheus-datasource",Me))(E||{});function D(){const Me=a.TP.hasPermission(d.w.AlertingRuleExternalRead),Te=a.TP.hasPermission(d.w.AlertingRuleExternalWrite);return!Me&&!Te?[]:(0,v.k7)().filter(Ge=>me(Ge.type)).filter(Ge=>se(Ge)).sort((Ge,Qe)=>Ge.name.localeCompare(Qe.name))}function C(Me){return _(Me)?"grafana":Me.uid??Me.id}function P(Me){return D().find(Te=>Te.name===Me)}function T(Me){return D().find(Te=>Te.uid===Me)}function O(){return(0,v.k7)().filter(I).sort((Me,Te)=>Me.name.localeCompare(Te.name))}function I(Me){return Me.type==="alertmanager"}function j(Me){return Me.type==="alertmanager"}function W(){return O().filter(Me=>Me.jsonData.handleGrafanaManagedAlerts)}function B(Me){return Me.jsonData.handleGrafanaManagedAlerts===!0}const S={name:f,imgUrl:c,hasConfigurationAPI:!0};function w(){return[S,...O().map(Me=>({name:Me.name,displayName:Me.name,imgUrl:Me.meta.info.logos.small,meta:Me.meta}))]}function N(Me){const Te=(0,r.W)(Me),Ge=Te.availableExternalDataSources.filter(He=>He.handleGrafanaManagedAlerts),Qe=Te.availableInternalDataSources,{currentData:tt}=m.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(tt?.alertmanagersChoice){case o.nA.Internal:return Qe;case o.nA.External:return Ge;default:return[...Qe,...Ge]}}function M(Me){const Te=[],Ge=[],Qe={instance:y.HL.read,notification:y.VQ.read,silence:y.nU.read};if([...Object.values(Qe).flatMap(He=>He.grafana),...p.w6,...l.Im,...h.X,...s.GK].some(He=>a.TP.hasPermission(He))&&Te.push(S),a.TP.hasPermission(Qe[Me].external)){const He=O().map(Re=>({name:Re.name,displayName:Re.name,imgUrl:Re.meta.info.logos.small,meta:Re.meta,hasConfigurationAPI:(0,g.Kh)(Re.jsonData),handleGrafanaManagedAlerts:Re.jsonData.handleGrafanaManagedAlerts}));Ge.push(...He)}return{availableInternalDataSources:Te,availableExternalDataSources:Ge}}function L(){const Me=D().map(Te=>Te.name);return a.TP.hasPermission(d.w.AlertingRuleRead)&&Me.push(f),Me}function A(){return D().map(Me=>({name:Me.name,uid:Me.uid,ruleSourceType:"datasource"}))}function U(){const Me=D();return a.TP.hasPermission(d.w.AlertingRuleRead)&&Me.unshift(f),Me}function F(Me){return K(Me)?Me.name:Me}function V(Me){return K(Me)?Me.uid:f}function K(Me){return Me!==f}function G(Me){return Me!==f&&z(Me)?.jsonData?.implementation===o.Oz.prometheus}function H(Me){return Me.readOnly===!0}function _(Me){return Me===f}function k(Me){return(0,v.k7)().find(Te=>Te.name===Me)}function J(Me){return(0,v.k7)().find(Te=>Te.uid===Me)}function z(Me){return(0,v.k7)().filter(I).find(Te=>Te.name===Me)}function Y(Me){return Me===f?f:k(Me)}function X(Me){if(Me===f)return f;const Te=k(Me);if(!Te)throw new Error(`Datasource "${Me}" not found`);return String(Te.id)}function Q(Me){if(Me===f)return f;const Te=k(Me);if(!Te)throw new Error(`Datasource "${Me}" not found`);return Te.uid}function q(Me){if("uid"in Me)return Me.uid;if(Me.rulesSourceName===f)return i.l$;const Te=P(Me.rulesSourceName);if(Te)return Te.uid}function te(){return(0,n.l)().getList({alerting:!0})[0]}function ne(){const Me=(0,n.l)().getInstanceSettings("default");return Me?.meta.alerting??!1?Me:te()}function se(Me){return Me.jsonData.manageAlerts!==!1}function ue(Me){return Me.jsonData.allowAsRecordingRulesTarget!==!1}function de(Me){return(0,x.A4)(Me)?{uid:i.l$,name:f,ruleSourceType:"grafana"}:{uid:Q(Me.ruleSourceName),name:Me.ruleSourceName,ruleSourceType:"datasource"}}function ie(Me){return he.find(Te=>Te===Me)!==void 0}const he=["prometheus","grafana-amazonprometheus-datasource","grafana-azureprometheus-datasource"];function me(Me){return ce.find(Te=>Te===Me)!==void 0}const ce=["loki",...he];function Pe(Me){return Me===f||me(Me)}const Ie=[f,...ce];function Se(Me){return ie(Me.type)&&ue(Me)}},85835:(Z,R,e)=>{"use strict";e.d(R,{h:()=>l});var n=e(2543),a=e.n(n),s=e(61371);function l(o,d,i=n.identity){const c=i(o),m=i(d),p=(0,s.G4)(c,m),h=(0,n.chain)(p).values().flatMap().filter(g=>g.op==="add"||g.op==="replace"||g.op==="move").sumBy(g=>g.endLineNumber-g.startLineNumber+1).value(),r=(0,n.chain)(p).values().flatMap().filter(g=>g.op==="remove"||g.op==="replace").sumBy(g=>g.endLineNumber-g.startLineNumber+1).value();return{added:h,removed:r}}},67598:(Z,R,e)=>{"use strict";e.d(R,{HA:()=>i,Rc:()=>o,rO:()=>l});var n=e(52161),a=e(29609);function s(c){if(a.p.grafana.rule(c.rulerRule)&&(0,n.z2)(c.namespace.rulesSource))return{namespace:{uid:c.rulerRule.grafana_alert.namespace_uid},groupName:c.group.name,groupOrigin:"grafana"};const m=(0,n.EV)(c.namespace.rulesSource);return{rulesSource:{uid:(0,n.w5)(m),name:m,ruleSourceType:"datasource"},namespace:{name:c.namespace.name},groupName:c.group.name,groupOrigin:"datasource"}}function l(c){return c.groupOrigin==="grafana"?n.hY:c.rulesSource.name}function o(c){return{dataSourceName:l(c),namespaceName:"uid"in c.namespace?c.namespace.uid:c.namespace.name,groupName:c.groupName}}function d(c){return{rulesSource:{ruleSourceType:"datasource",name:c.ruleSourceName,uid:(0,n.w5)(c.ruleSourceName)},namespace:{name:c.namespace},groupName:c.groupName,groupOrigin:"datasource"}}const i={fromCombinedRule:s,fromRuleIdentifier:d}},22628:(Z,R,e)=>{"use strict";e.d(R,{DM:()=>l,T:()=>s,a3:()=>n,rh:()=>a});const n="grafana.com/provenance",a="none";var s=(o=>(o.Provenance="grafana.com/provenance",o.InUseRoutes="grafana.com/inUse/routes",o.InUseRules="grafana.com/inUse/rules",o.AccessWrite="grafana.com/access/canWrite",o.AccessAdmin="grafana.com/access/canAdmin",o.AccessDelete="grafana.com/access/canDelete",o))(s||{});const l="user-defined"},33998:(Z,R,e)=>{"use strict";e.d(R,{LQ:()=>c,g2:()=>d,j2:()=>m,jX:()=>p});var n=e(2543),a=e.n(n),s=e(92745),l=e(68143),o=e(77256);const d="alerting.notifications.conflict",i="alerting.notifications.routes.conflictingMatchers";function c(h){const r=(0,o.E2)(h);return r?{[d]:m(r),[i]:(0,s.t)("alerting.policies.update-errors.routes.conflictingMatchers","Cannot add or update route: matchers conflict with an external routing tree if we merged matchers {{-matchers}}. This would make the route unreachable.",{matchers:h.data.details?.causes?.map(y=>y.message).join(", ")??(0,s.t)("alerting.policies.update-errors.routes.unknownMatchers","<unknown matchers>")})}[r]:h.data.message}function m(h){return{[d]:(0,s.t)("alerting.policies.update-errors.conflict","The notification policy tree has been updated by another user.")}[h]}function p(h){return(0,l.NF)(h)&&(0,n.get)(h.data,"kind")==="Status"&&(0,n.get)(h.data,"status")==="Failure"}},56476:(Z,R,e)=>{"use strict";e.d(R,{Au:()=>i,O:()=>p,Uo:()=>l,dM:()=>s,gw:()=>d,jw:()=>c,zl:()=>m});var n=e(52161),a=e(22628);const s=h=>h===n.hY,l=h=>{const r=d(h,a.T.Provenance);return!!(r&&r!==a.rh)},o="grafana.com/access/",d=(h,r)=>h.metadata?.annotations?.[r],i=h=>d(h,a.T.AccessWrite)==="true",c=h=>d(h,a.T.AccessAdmin)==="true",m=h=>d(h,a.T.AccessDelete)==="true",p=h=>h.replaceAll(/\\/g,"\\\\").replaceAll(/\=/g,"\\=").replaceAll(/,/g,"\\,")},39659:(Z,R,e)=>{"use strict";e.d(R,{Dd:()=>l,F2:()=>m,M4:()=>s,lL:()=>i,rm:()=>c,w0:()=>p,x4:()=>d,zm:()=>o});var n=e(2543),a=e.n(n);function s(h){return Object.entries(h).map(([r,g])=>`${r}=${g}`).sort()}function l(h){return Object.entries(h)}function o(h){const r={};return h.forEach(g=>{r[g[0]]=g[1]}),r}function d(h){const r={};return h.forEach(g=>{g.key&&(r[g.key]=g.value)}),r}const i="__grafana_origin";function c(h){return(0,n.isEmpty)(h)?0:Object.keys(h).filter(r=>!m(r)).length}function m(h){return h.startsWith("__")&&h.endsWith("__")||h===i}const p=([h,r])=>m(h)},63895:(Z,R,e)=>{"use strict";e.d(R,{Ig:()=>E,J$:()=>y,J9:()=>g,S6:()=>p,So:()=>c,Zc:()=>h,b2:()=>b,ou:()=>r,qR:()=>i,ry:()=>O,t8:()=>D,yk:()=>u});var n=e(2543),a=e.n(n),s=e(38388),l=e(84266),o=e(39659);const d=[l.ho.regex,l.ho.notRegex,l.ho.notEqual,l.ho.equal];function i(B){if(B.startsWith("{")&&B.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const S=d.map(A=>[A,B.indexOf(A)]).filter(([A,U])=>U>-1).sort((A,U)=>A[1]-U[1]);if(!S.length)throw new Error(`Invalid matcher: ${B}`);const[w,N]=S[0],M=B.slice(0,N).trim(),L=B.slice(N+w.length);if(!M)throw new Error(`Invalid matcher: ${B}`);return{name:M,value:L,isRegex:w===l.ho.regex||w===l.ho.notRegex,isEqual:w===l.ho.equal||w===l.ho.regex}}function c(B){return C(B)?m(B):[i(B)]}function m(B){if(!C(B))throw new Error("not a PromQL style matcher");return p(B)}function p(B){const S=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,w=B.replace(/^\{/,"").replace(/\}$/,"").trim().split(S);return(0,n.compact)(w).flatMap(i).map(N=>({...N,name:E(N.name),value:E(N.value)}))}function h(B){try{return p(B)}catch{return[]}}function r(B){return(0,n.chain)(B).map(S=>S.trim()).compact().flatMap(h).uniqBy("name").value()}const g=B=>{const S=Object.entries(B).filter(([N])=>!(0,o.F2)(N)),w=new URLSearchParams;return S.forEach(([N,M])=>w.append("matcher",`${N}=${M}`)),w},y=B=>{let S=[];return B.matchers&&B.matchers.forEach(w=>{const N=c(w).map(P);S=S.concat(N)}),B.object_matchers&&S.push(...B.object_matchers),B.match_re&&Object.entries(B.match_re).forEach(([w,N])=>{S.push([w,l.ho.regex,N])}),B.match&&Object.entries(B.match).forEach(([w,N])=>{S.push([w,l.ho.equal,N])}),S};function v(B){return`"${B.replace(/[\\"]/g,w=>`\\${w}`)}"`}const x=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function f(B){return x.test(B)?v(B):B}function u(B){return f(E(B))}const b=({name:B,operator:S,value:w})=>{const N=f(B),M=v(w);return`${N}${S}${M}`};function E(B){return/^"(.*)"$/.test(B)?B.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):B}const D={default:([B,S,w])=>`${B} ${S} ${w||""}`,unquote:([B,S,w])=>{const N=E(B),M=E(w)||'""';return`${N} ${S} ${M}`}};function C(B){return B.startsWith("{")&&B.endsWith("}")}function P(B){const S=T(B);return[B.name,S,B.value]}function T(B){return B.isEqual?B.isRegex?l.ho.regex:l.ho.equal:B.isRegex?l.ho.notRegex:l.ho.notEqual}function O(B,S){for(const w of B)if(!j(w,S))return!1;return!0}const I={[l.ho.equal]:(B,S)=>B===S,[l.ho.notEqual]:(B,S)=>B!==S,[l.ho.regex]:(B,S)=>{const w=(0,s.bQ)(`^(?:${S})$`);return new RegExp(w.cleaned,w.flags).test(B)},[l.ho.notRegex]:(B,S)=>{const w=(0,s.bQ)(`^(?:${S})$`);return!new RegExp(w.cleaned,w.flags).test(B)}};function j(B,S){const[w,N,M]=B;let L="";const A=Object.fromEntries(S)[w];A&&(L=A);const U=I[N];if(!U)throw new Error(`no such operator: ${N}`);try{return U(L,M)}catch(F){return console.warn(F),!1}}function W(B,S){const[w,N]=S,[M,L,A]=B;if(w!==M)return!1;const U=I[L];if(!U)throw new Error(`no such operator: ${L}`);return U(N,A)}},77256:(Z,R,e)=>{"use strict";e.d(R,{BK:()=>M,Cp:()=>J,D2:()=>K,E2:()=>q,ES:()=>X,GD:()=>L,Ht:()=>W,JM:()=>V,JZ:()=>ne,KT:()=>w,NH:()=>A,NJ:()=>H,S2:()=>I,Sl:()=>j,Yp:()=>C,bI:()=>T,bg:()=>P,i7:()=>O,i9:()=>_,nL:()=>N,qc:()=>Y,qy:()=>S,u7:()=>Q,vV:()=>G,w$:()=>b,y$:()=>z});var n=e(2543),a=e.n(n),s=e(41607),l=e(92745),o=e(43173),d=e(68143),i=e(15130),c=e(47797),m=e(94646),p=e(29609),h=e(21834),r=e(24619),g=e(95443),y=e(52161),v=e(33998),x=e(63895),f=e(29442),u=e(92367);function b(se,ue,de){const ie=(0,y.EV)(se),he=m.UP(ie,ue);return f.PP.detailsPageLink(ie,he,de?{returnTo:de}:void 0)}function E(se,ue,de){const ie=se.rulesSource.name,he=ruleId.fromRule(ie,se.namespace.name,se.groupName,ue);return rulesNav.detailsPageLink(ie,he,de?{returnTo:de}:void 0)}function D(se){const ue=se.ruleSourceName,de=ruleId.fromRuleWithLocation(se),ie=encodeURIComponent(ruleId.stringifyIdentifier(de)),he=encodeURIComponent(ue);return createRelativeUrl(`/alerting/${he}/${ie}/view`)}function C(se,ue){const{uid:de,type:ie}=se;return(0,u.G)("/explore",{left:JSON.stringify({datasource:se.uid,queries:[{refId:"A",datasource:{uid:de,type:ie},expr:ue}],range:{from:"now-1h",to:"now"}})})}function P(se,ue=""){return(0,u.G)(`/alerting/notifications/receivers/${encodeURIComponent(se)}/edit`,{alertmanager:ue})}function T(se,ue=""){return(0,u.G)("/alerting/notifications",{search:se,tab:"contact_points",alertmanager:ue})}function O(se,ue=""){return(0,u.G)("/alerting/routes/mute-timing/edit",{muteName:se,alertmanager:ue})}function I(se){if((0,p.X4)(se)||(0,p.Mj)(se))return(0,u.z)(`/alerting/${encodeURIComponent(se.ruleSourceName)}/${encodeURIComponent((0,m.PH)(se.ruleName))}/find`);if((0,p.A4)(se))return(0,u.z)(`/alerting/grafana/${se.uid}/view`)}function j(se){return se.reduce((ue,{key:de,value:ie})=>(ue[de]=ie,ue),{})}const W=se=>{const ue=se.queryString===void 0?void 0:String(se.queryString),de=se.alertState===void 0?void 0:String(se.alertState),ie=se.dataSource===void 0?void 0:String(se.dataSource),he=se.ruleType===void 0?void 0:String(se.ruleType),me=se.groupBy===void 0?void 0:String(se.groupBy).split(",");return{queryString:ue,alertState:de,dataSource:ie,groupBy:me,ruleType:he}},B=se=>({queryString:se.get("queryString")??void 0,contactPoint:se.get("contactPoint")??void 0}),S=se=>{const ue=se.queryString===void 0?void 0:String(se.queryString),de=se.silenceState===void 0?void 0:String(se.silenceState);return{queryString:ue,silenceState:de}};function w(se){return Object.entries(se).map(([ue,de])=>({key:ue,value:de}))}function N(se,ue,de){const ie=new URLSearchParams(de);return ue&&ie.set(g.DD,ue),`${se}?${ie.toString()}`}function M(se,ue){const de=new URLSearchParams;return de.append("alertmanager",se),(0,x.J9)(ue).forEach((he,me)=>de.append(me,he)),(0,u.G)("/alerting/silence/new",de)}function L(se){return(0,u.G)(`/datasources/edit/${se}`)}function A(se){return(0,u.G)(`/dashboards/f/${se}`)}function U(se,ue){return createRelativeUrl(`/dashboards/f/${se}/${ue}/alerting`)}function F(se){return createRelativeUrl(`/dashboards/f/${se}/settings`)}function V(se){return(0,u.G)(`/d/${encodeURIComponent(se)}`)}function K(se,ue){const de=new URLSearchParams({viewPanel:ue});return(0,u.G)(`/d/${encodeURIComponent(se)}`,de)}function G(se,ue){return(0,u.G)(`/alerting/notifications/receivers/${encodeURIComponent(se)}/edit`,ue)}function H(se,ue){return(0,u.G)("/alerting/routes/mute-timing/edit",{...ue,muteName:se})}function _(se,ue,de,ie=1e3){const he=new Date().getTime(),me=()=>se().catch(ce=>{if(ue(ce)&&new Date().getTime()-he<de)return new Promise(Pe=>setTimeout(Pe,ie)).then(me);throw ce});return me()}const k={[r.Gi.Alerting]:1,[r.cF.Firing]:1,[r.Gi.Error]:1,[r.Gi.Pending]:2,[r.Gi.Recovering]:2,[r.cF.Pending]:2,[r.cF.Recovering]:2,[r.cF.Inactive]:2,[r.Gi.NoData]:3,[r.Gi.Normal]:4,[r.cF.Unknown]:5};function J(se,ue){if(se===h.xB.Importance)return(0,n.sortBy)(ue,ie=>[k[(0,r.lh)(ie.state)],(0,p.RI)(ie).toLocaleLowerCase()]);if(se===h.xB.TimeAsc)return(0,n.sortBy)(ue,ie=>[new Date(ie.activeAt)||new Date,(0,p.RI)(ie).toLocaleLowerCase()]);if(se===h.xB.TimeDesc)return(0,n.sortBy)(ue,ie=>[new Date(ie.activeAt)||new Date,(0,p.RI)(ie).toLocaleLowerCase()]).reverse();const de=(0,n.sortBy)(ue,ie=>(0,p.RI)(ie).toLocaleLowerCase());return se===h.xB.AlphaDesc&&de.reverse(),de}function z(){return o.$.buildInfo.edition===s.r.OpenSource}function Y(){return i.TP.hasRole("Admin")||i.TP.isGrafanaAdmin}function X(){return o.$.buildInfo.env==="development"}function Q(se){return!!(se&&typeof se=="object"&&"message"in se)}function q(se){if((0,v.jX)(se)&&se.data.details)return se.data.details.uid;if(Q(se)&&(0,n.isString)(se.cause))return se.cause}function te(se,ue){return se?q(se)===ue:!1}function ne(se){if((0,d.NF)(se)){if((0,v.jX)(se)){const ie=(0,v.LQ)(se);if(ie)return ie}if(se.message)return se.message;if("message"in se.data&&typeof se.data.message=="string"){const ie=(0,c.do)(se),he=(0,c.q6)(se),me=(0,c.ee)(se);return(0,l.t)("alerting.errors.failedWith","{{-config}} failed with {{status}}: {{-message}}",{config:me,status:ie,message:he})}return se.statusText?se.statusText:String(se.status)||"Unknown error"}if(!Q(se))return String(se);const de=q(se);if(typeof de=="string"){const ie=(0,v.j2)(de);if(ie)return ie}return se.cause?`${se.message}, cause: ${ne(se.cause)}`:se.message}},29442:(Z,R,e)=>{"use strict";e.d(R,{Mo:()=>o,PP:()=>i,TN:()=>d,tx:()=>l});var n=e(39187),a=e(94646),s=e(92367);const l=(c,m)=>{const p=new URLSearchParams([["search",c.map(([h,r])=>`${h}:"${r}"`).join(" ")]]);return(0,s.G)("/alerting/list",p,{skipSubPath:m?.skipSubPath})},o=(c={},m)=>(0,s.G)("/alerting/list",c,{skipSubPath:m?.skipSubPath}),d={detailsPageLink:(c,m,p,h)=>{const r=h?.includeReturnTo?{returnTo:(0,n.w)()}:{};return(0,s.G)(`/alerting/${c}/namespaces/${encodeURIComponent(m)}/groups/${encodeURIComponent(p)}/view`,r)},detailsPageLinkFromGroupIdentifier:c=>{const{groupOrigin:m,namespace:p,groupName:h}=c;return m==="grafana"?d.detailsPageLink("grafana",p.uid,h):d.detailsPageLink(c.rulesSource.uid,p.name,h)},editPageLink:(c,m,p,h)=>{const r=h?.includeReturnTo?{returnTo:(0,n.w)()}:{};return(0,s.G)(`/alerting/${c}/namespaces/${encodeURIComponent(m)}/groups/${encodeURIComponent(p)}/edit`,r,{skipSubPath:h?.skipSubPath})},newAlertRuleLink:(c,m,p)=>{const h=(0,n.w)(),r=JSON.stringify({folder:{title:c,uid:m},group:p});return(0,s.G)("/alerting/new",{defaults:r,returnTo:h})},newRecordingRuleLink:(c,m,p)=>{const h=(0,n.w)(),r=JSON.stringify({folder:{title:c,uid:m},group:p});return(0,s.G)("/alerting/new/grafana-recording",{defaults:r,returnTo:h})}},i={detailsPageLink:(c,m,p,h)=>(0,s.G)(`/alerting/${encodeURIComponent(c)}/${encodeURIComponent((0,a.$9)(m))}/view`,p,{skipSubPath:h?.skipSubPath})}},48442:(Z,R,e)=>{"use strict";e.d(R,{Rs:()=>l,W$:()=>p,Wn:()=>r,_I:()=>h,rJ:()=>i});var n=e(2543),a=e.n(n),s=e(63895);const l=["receiver","group_by","group_wait","group_interval","repeat_interval"];function o(g,y){const v=matchLabelsSet(g,y),x=new Map(y.map(f=>[f,{match:!1,matcher:null}]));return g.forEach(f=>{const u=y.find(b=>isLabelMatch(f,b));u&&x.set(u,{match:!0,matcher:f})}),{matches:v,labelsMatch:x}}function d(g,y){let v=[];const x=o(g.object_matchers??[],y);if(!x.matches)return[];if(g.routes)for(const f of g.routes){const u=d(f,y);if(v=v.concat(u),u.length&&!f.continue)break}return v.length===0&&v.push({route:g,labelsMatch:x.labelsMatch}),v}function i(g){function y(x){x.object_matchers=(0,s.J$)(x),delete x.matchers,delete x.match,delete x.match_re,x.routes?.forEach(y)}const v=structuredClone(g);return y(v),v}function c(g){function y(x){x.object_matchers=x.object_matchers?.map(([f,u,b])=>[unquoteWithUnescape(f),u,unquoteWithUnescape(b)]),x.routes?.forEach(y)}const v=structuredClone(g);return y(v),v}function m(g,y,v){const x=[];return v.reduce((f,u)=>{const b=u.alerts.filter(E=>{const D=Object.entries(E.labels);return d(g,D).some(C=>C.route===y)});return b.length&&f.push({...u,alerts:b}),f},x)}function p(g,y,v){const f={...(0,n.pick)(g,l),...v};return(0,n.reduce)(f,(b,E,D)=>{const C=E!=null,O=[void 0,"",null].some(W=>y[D]===W)&&C,I=D==="group_by"&&C&&(0,n.isArray)(y[D])&&y[D]?.length===0;return(O||I)&&(b[D]=E),b},{})}function h(g){return{...g,routes:g.routes?.map(y=>{const v=p(g,y);return h({...y,...v})})}}function r(g,y,v){const x={...g};return x.receiver===y&&(x.receiver=v),x.routes&&(x.routes=x.routes.map(f=>r(f,y,v))),x}},72930:(Z,R,e)=>{"use strict";e.d(R,{u:()=>n});function n(a,s,l,o={}){return{propertyName:a,label:s,description:l,element:"input",inputType:"",required:!1,secure:!1,placeholder:"",validationRule:"",showWhen:{field:"",is:""},dependsOn:"",...o}}},36200:(Z,R,e)=>{"use strict";e.d(R,{$I:()=>h,BU:()=>D,CZ:()=>y,J7:()=>m,ML:()=>C,Vf:()=>b,Xw:()=>p,jA:()=>i,p0:()=>v,t4:()=>E,v5:()=>r});var n=e(65307),a=e(32899),s=e(68143),l=e(73427),o=e(74268),d=e(77256);const i=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function c(P,T=i,O){if(P.pending.match(O))return{result:T.result,loading:!0,error:T.error,dispatched:!0,requestId:O.meta.requestId};if(P.fulfilled.match(O)){if(T.requestId===void 0||T.requestId===O.meta.requestId)return{...T,result:O.payload,loading:!1,error:void 0}}else if(P.rejected.match(O)&&T.requestId===O.meta.requestId)return{...T,loading:!1,error:O.error};return T}function m(P,T){return(0,n.Z0)({name:P,initialState:i,reducers:{},extraReducers:O=>O.addDefaultCase((I,j)=>c(T,I,j))})}function p(P,T,O){return(0,n.Z0)({name:P,initialState:{},reducers:{},extraReducers:I=>I.addDefaultCase((j,W)=>{if((0,n.$S)(T)(W)){const B=W,S=O(B.meta.arg);return{...j,[S]:c(T,j[S],B)}}return j})})}function h(P){return P.catch(T=>{throw{message:y(T),code:T.statusCode}})}function r(P,T){return P.then(O=>(T.successMessage&&l.lE.emit(a.r1.alertSuccess,[T.successMessage]),O)).catch(O=>{const I=y(O);throw l.lE.emit(a.r1.alertError,[`${T.errorMessage??"Error"}: ${I}`]),O})}const g="Unknown Error";function y(P){if((0,s.NF)(P))if(P.data?.message){let T=P.data?.message;return typeof P.data?.error=="string"&&(T+=`; ${P.data.error}`),T}else{if(Array.isArray(P.data)&&P.data.length&&P.data[0]?.message)return P.data.map(T=>T?.message).filter(T=>!!T).join(" ");if(P.statusText)return P.statusText}return(0,d.u7)(P)?P.message:((0,o.fH)(o.le.unknownMessageFromError,{error:JSON.stringify(P)}),g)}function v(P){return Object.values(P).every(x)}function x(P){return P.dispatched&&!P.loading}function f(P){return Object.values(P).every(u)}function u(P){return P.dispatched&&!P.loading&&!P.error}function b(P){return Object.values(P).some(C)}function E(P){return Object.values(P).some(T=>T.dispatched)}function D(P){return Object.values(P).some(u)}function C(P){return P?P.dispatched&&P.loading:!1}},67923:(Z,R,e)=>{"use strict";e.d(R,{AB:()=>c,AS:()=>m,HO:()=>g,I8:()=>p,KR:()=>v,dn:()=>r,eM:()=>y});var n=e(1932),a=e(2543),s=e.n(a),l=e(46635),o=e(84266),d=e(42824),i=e(33998);const c=(u,b,E)=>{if(!y(b.id??"",E))throw new Error(`No such route with ID '${b.id}'`,{cause:i.g2});function C(P){let T=P;if(P.id===b.id){const O=(0,d.SJ)(u,b,E);T={...P,...O}}return{...T,routes:P.routes?.map(C)}}return C(E)},m=(u,b)=>{if(u===b.id)throw new Error("You cant remove the root policy");function E(D){return{...D,routes:D.routes?.reduce((C=[],P)=>(P.id===u||C.push(E(P)),C),[])}}return E(b)},p=(u,b,E,D,C)=>{const P=(0,d.SJ)(u,b,D);return(0,n.jM)(D,T=>{const[O,I,j]=h(T,E);if(O===void 0||I===void 0||j===void 0)throw new Error(`could not find reference route "${E}" in tree`,{cause:i.g2});C==="child"&&(O.routes?O.routes.push(P):O.routes=[P]),C==="above"&&(I.routes=l.insertBeforeImmutably(I.routes??[],P,j)),C==="below"&&(I.routes=l.insertAfterImmutably(I.routes??[],P,j))})};function h(u,b){let E,D,C;function P(T,O,I){E||(T.id===b&&(E=T,D=I,C=O),T.routes&&T.routes.forEach((j,W)=>P(j,W,T)))}return P(u,0,u),[E,D,C]}function r(u){return(0,a.omit)({...u,routes:u.routes?.map(b=>r(b))},"id")}function g(u){return(0,n.jM)(u,b=>{b.spec.routes=b.spec.routes.map(r)})}function y(u,b){return b.id===u?b:b.routes?.find(E=>y(u,E))}function v(u){const b=JSON.stringify(x(u));let E=0;for(let D=0;D<b.length;D++){const C=b.charCodeAt(D);E=(E<<5)-E+C,E=E&E}return E.toString(36)}function x(u){return{receiver:u.receiver??"",group_by:u.group_by?[...u.group_by].sort():[],continue:u.continue??!1,object_matchers:u.object_matchers?[...u.object_matchers].sort():[],matchers:u.matchers?[...u.matchers].sort():[],match:u.match?f(u.match):{},match_re:u.match_re?f(u.match_re):{},group_wait:u.group_wait??"",group_interval:u.group_interval??"",repeat_interval:u.repeat_interval??"",routes:u.routes??[],mute_time_intervals:u.mute_time_intervals?[...u.mute_time_intervals].sort():[],active_time_intervals:u.active_time_intervals?[...u.active_time_intervals].sort():[],provenance:u.provenance??"",[o.uz]:{}}}function f(u){const b={};return Object.keys(u).sort().forEach(E=>{b[E]=u[E]}),b}},20437:(Z,R,e)=>{"use strict";e.d(R,{Bu:()=>z,J6:()=>H,Os:()=>E,Q8:()=>b,QX:()=>w,Qk:()=>M,XI:()=>L,Z9:()=>O,l1:()=>D,mY:()=>Y,mp:()=>G,qO:()=>A,zQ:()=>N});var n=e(22592),a=e(17548),s=e(39796),l=e(43173),o=e(78282),d=e(36580),i=e(36674),c=e(8285),m=e(4651),p=e(2954),h=e(84523),r=e(6194),g=e(67817),y=e(95443),v=e(52161),x=e(77256),f=e(29609),u=e(15629);const b="grafana.alerting.manualRouting",E="grafana.alerting.simplifiedQueryEditor";function D(X){const{name:Q,expression:q,forTime:te,forTimeUnit:ne,keepFiringForTime:se,keepFiringForTimeUnit:ue,type:de}=X,ie=(0,x.Sl)(I(X.annotations)),he=(0,x.Sl)(j(X.labels));if(de===g.Z.cloudAlerting){let me;return se&&ue&&(me=`${se}${ue}`),{alert:Q,for:`${te}${ne}`,keep_firing_for:me,annotations:ie,labels:he,expr:q}}else if(de===g.Z.cloudRecording)return{record:Q,labels:he,expr:q};throw new Error(`unexpected rule type: ${de}`)}function C(X,Q){const q=[...(0,x.KT)(X||{})];return Q&&q.push({key:"",value:""}),q}function P(X,Q){if(Q?.grafana?.selectedContactPoint&&X)return{receiver:Q?.grafana?.selectedContactPoint,mute_time_intervals:Q?.grafana?.muteTimeIntervals,active_time_intervals:Q?.grafana?.activeTimeIntervals,group_by:Q?.grafana?.overrideGrouping?Q?.grafana?.groupBy:void 0,group_wait:Q?.grafana?.overrideTimings&&Q?.grafana?.groupWaitValue?Q?.grafana?.groupWaitValue:void 0,group_interval:Q?.grafana?.overrideTimings&&Q?.grafana?.groupIntervalValue?Q?.grafana?.groupIntervalValue:void 0,repeat_interval:Q?.grafana?.overrideTimings&&Q?.grafana?.repeatIntervalValue?Q?.grafana?.repeatIntervalValue:void 0}}function T(X){return{simplified_query_and_expressions_section:X.simplifiedQueryEditor,simplified_notifications_section:X.simplifiedNotificationEditor}}function O(X){const{name:Q,condition:q,noDataState:te,execErrState:ne,evaluateFor:se,keepFiringFor:ue,queries:de,isPaused:ie,contactPoints:he,manualRouting:me,type:ce,metric:Pe,targetDatasourceUid:Ie,missingSeriesEvalsToResolve:Se}=X;if(!q)throw new Error("You cannot create an alert rule without specifying the alert condition");const Me=P(me,he),Te=X.editorSettings?{editor_settings:T(X.editorSettings)}:void 0,Ge=(0,x.Sl)(I(X.annotations)),Qe=(0,x.Sl)(j(X.labels)),tt=(0,f.Mu)(ce),ke=(0,f.pq)(ce);if(tt)return{grafana_alert:{title:Q,condition:q,data:de.map(k),is_paused:!!ie,no_data_state:te,exec_err_state:ne,notification_settings:Me,metadata:Te,missing_series_evals_to_resolve:Se?Number(Se):0},annotations:Ge,labels:Qe,for:se,keep_firing_for:ue};if(ke)return{grafana_alert:{title:Q,condition:q,data:de.map(k),is_paused:!!ie,record:{metric:Pe??Q,from:q,target_datasource_uid:Ie}},annotations:Ge,labels:Qe};throw new Error(`Failed to convert form values to Grafana rule: unknown type ${ce}`)}const I=X=>X.map(W).filter(({key:Q,value:q})=>!!Q&&!!q),j=X=>X.map(W).filter(({key:Q})=>!!Q),W=({key:X,value:Q})=>({key:X.trim(),value:Q.trim()});function B(X){const Q=X.notification_settings?{selectedContactPoint:X.notification_settings.receiver,muteTimeIntervals:X.notification_settings.mute_time_intervals??[],activeTimeIntervals:X.notification_settings.active_time_intervals??[],overrideGrouping:Array.isArray(X.notification_settings.group_by)&&X.notification_settings.group_by.length>0,overrideTimings:[X.notification_settings.group_wait,X.notification_settings.group_interval,X.notification_settings.repeat_interval].some(Boolean),groupBy:X.notification_settings.group_by||[],groupWaitValue:X.notification_settings.group_wait||"",groupIntervalValue:X.notification_settings.group_interval||"",repeatIntervalValue:X.notification_settings.repeat_interval||""}:void 0;return Q?{[v.hY]:Q}:void 0}function S(X){if(l.$.featureToggles.alertingQueryAndExpressionsStepMode)return X.metadata?.editor_settings?{simplifiedQueryEditor:X.metadata.editor_settings.simplified_query_and_expressions_section,simplifiedNotificationEditor:X.metadata.editor_settings.simplified_notifications_section}:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!!X.notification_settings}}function w(X){const{ruleSourceName:Q,namespace:q,group:te,rule:ne}=X,se=f.p.grafana.recordingRule(ne),ue=(0,h.IJ)(se?g.Z.grafanaRecording:void 0);if((0,v.z2)(Q))if(se){const de=ne.grafana_alert;return{...ue,name:de.title,type:g.Z.grafanaRecording,group:te.name,evaluateEvery:te.interval||ue.evaluateEvery,queries:de.data,condition:de.condition,annotations:(0,r.JE)(C(ne.annotations,!1)),labels:C(ne.labels,!0),folder:{title:q,uid:de.namespace_uid},isPaused:de.is_paused,metric:de.record?.metric,targetDatasourceUid:de.record?.target_datasource_uid||ue.targetDatasourceUid}}else if(f.p.grafana.rule(ne)){const de=ne.grafana_alert,ie=B(de);if(de.no_data_state!==void 0&&de.exec_err_state!==void 0)return{...ue,name:de.title,type:g.Z.grafana,group:te.name,evaluateEvery:te.interval||ue.evaluateEvery,evaluateFor:ne.for||"0",keepFiringFor:ne.keep_firing_for||"0",noDataState:de.no_data_state,execErrState:de.exec_err_state,queries:de.data,condition:de.condition,annotations:(0,r.JE)(C(ne.annotations,!1)),labels:C(ne.labels,!0),folder:{title:q,uid:de.namespace_uid},isPaused:de.is_paused,contactPoints:ie,manualRouting:!!ie,editorSettings:S(de),missingSeriesEvalsToResolve:de.missing_series_evals_to_resolve};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if(f.p.dataSource.alertingRule(ne)){const ie={refId:"A",datasourceUid:(0,o.l)().getInstanceSettings(Q)?.uid??"",queryType:"",relativeTimeRange:(0,n.Cn)(),expr:ne.expr,model:{refId:"A",hide:!1,expr:ne.expr}},he=M(ne);return{...ue,...he,queries:[ie],annotations:(0,r.JE)(C(ne.annotations,!1)),type:g.Z.cloudAlerting,dataSourceName:Q,namespace:q,group:te.name}}else if(f.p.dataSource.recordingRule(ne)){const de=L(ne);return{...ue,...de,type:g.Z.cloudRecording,dataSourceName:Q,namespace:q,group:te.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function N(X,Q){const q=f.p.grafana.recordingRule(X),te=(0,h.IJ)(q?g.Z.grafanaRecording:void 0),ne=X.grafana_alert,se=X.for,ue=X.keep_firing_for,de=X.annotations,ie=X.labels,he={...te,name:ne.title,queries:ne.data,condition:ne.condition,annotations:(0,r.JE)(C(de,!1)),labels:C(ie,!0),folder:{title:Q,uid:ne.namespace_uid},isPaused:ne.is_paused};if(f.p.grafana.recordingRule(X))return{...he,type:g.Z.grafanaRecording,group:ne.rule_group,metric:ne.record?.metric};const me=B(ne);if(ne.no_data_state!==void 0&&ne.exec_err_state!==void 0)return{...he,type:g.Z.grafana,group:ne.rule_group,evaluateFor:se||"0",keepFiringFor:ue||"0",noDataState:ne.no_data_state,execErrState:ne.exec_err_state,contactPoints:me,manualRouting:!!me,editorSettings:S(ne)};throw new Error("Unexpected type of rule for grafana rules source")}function M(X){const Q=(0,h.IJ)(),[q,te]=X.for?(0,u.P1)(X.for):[0,"s"],[ne,se]=X.keep_firing_for?(0,u.P1)(X.keep_firing_for):[Q.keepFiringForTime,Q.keepFiringForTimeUnit];return{name:X.alert,expression:X.expr,forTime:q,forTimeUnit:te,keepFiringForTime:ne,keepFiringForTimeUnit:se,annotations:C(X.annotations,!1),labels:C(X.labels,!0)}}function L(X){return{name:X.record,expression:X.expr,labels:C(X.labels,!0)}}const A=(X=!1)=>{const Q=(0,v.y9)();if(!Q)return[...X?V("A"):F("A","B")];const q=(0,n.Cn)(),te=X?V("B"):F("B","C"),ne=Q?(0,v.cl)(Q.type):!1;return[{refId:"A",datasourceUid:Q.uid,queryType:"",relativeTimeRange:q,model:{refId:"A",instant:ne?!0:void 0}},...te]},U=X=>{const Q=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:X[0]?.uid||"",queryType:"",relativeTimeRange:Q,model:{refId:"A"}}]},F=(...X)=>{const Q=X[0],q=X[1],te={refId:X[0],type:m.Tz.reduce,datasource:{uid:m.Uj,type:d.dR.type},conditions:[{type:"query",evaluator:{params:[],type:p.p.IsAbove},operator:{type:"and"},query:{params:[Q]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},ne={refId:q,type:m.Tz.threshold,datasource:{uid:m.Uj,type:d.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:p.p.IsAbove},operator:{type:"and"},query:{params:[q]},reducer:{params:[],type:"last"}}],expression:Q};return[{refId:Q,datasourceUid:m.Uj,queryType:"",model:te},{refId:q,datasourceUid:m.Uj,queryType:"",model:ne}]},V=X=>{const Q={refId:X,type:m.Tz.reduce,datasource:{uid:m.Uj,type:d.dR.type},conditions:[{type:"query",evaluator:{params:[],type:p.p.IsAbove},operator:{type:"and"},query:{params:[X]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"};return[{refId:X,datasourceUid:m.Uj,queryType:"",model:Q}]},K=async(X,Q,q,te,ne,se)=>{const ue=[];for(const de of X){const ie=await(0,o.l)().get(de.datasource?.uid?de.datasource:te),he={uid:ie.uid,type:ie.type},me=a.relativeToTimeRange(Q),{interval:ce,intervalMs:Pe}=_(me,se??ie.interval,ne),Ie={__interval:{text:ce,value:ce},__interval_ms:{text:Pe,value:Pe},...q},Se=ie.interpolateVariablesInQueries?ie.interpolateVariablesInQueries([de],Ie)[0]:de;if(he.uid===m.Uj){const Me={refId:Se.refId,queryType:"",relativeTimeRange:Q,datasourceUid:m.Uj,model:Se};ue.push(Me)}else{const Me=(0,o.l)().getInstanceSettings(he);if(Me&&Me.meta.alerting){const Te={refId:Se.refId,queryType:Se.queryType??"",relativeTimeRange:Q,datasourceUid:Me.uid,model:{...Se,maxDataPoints:ne,intervalMs:Pe}};ue.push(Te)}}}return ue},G=async(X,Q)=>{const{targets:q}=X;if(!X.id||!Q.uid)return;const te=a.timeRangeToRelative(a.convertRawToRange(Q.time)),ne=await K(q,te,X.scopedVars||{},X.datasource??void 0,X.maxDataPoints??void 0,X.interval??void 0);if(!ne.length||!ne.find(he=>he.datasourceUid!==m.Uj))return;if(!ne.find(he=>he.datasourceUid===m.Uj)){const[he,me]=F((0,s.M)(ne),"-");ne.push(he);const[ce,Pe]=F(he.refId,(0,s.M)(ne));ne.push(Pe)}const{folderTitle:se,folderUid:ue}=Q.meta,de=ue&&se?{kind:"folder",uid:ue,title:se}:void 0;return{type:g.Z.grafana,folder:de,queries:ne,name:X.title,condition:ne[ne.length-1].refId,annotations:[{key:y.YH.dashboardUID,value:Q.uid},{key:y.YH.panelID,value:String(X.id)}]}},H=async X=>{if(!X.state.key)return;const Q=i.jh.getTimeRange(X),q=(0,c.un)(X);if(!q)return;const{queries:te,datasource:ne,maxDataPoints:se,minInterval:ue}=q.state,de=(0,c.YQ)(X);if(!de||!de.state.uid)return;const ie=await K(te,a.timeRangeToRelative(a.convertRawToRange(Q.state.value.raw)),{__sceneObject:{value:X}},ne,se,ue);if(!ie.length||!ie.find(Ie=>Ie.datasourceUid!==m.Uj))return;if(!ie.find(Ie=>Ie.datasourceUid===m.Uj)){const[Ie,Se]=F((0,s.M)(ie),"-");ie.push(Ie);const[Me,Te]=F(Ie.refId,(0,s.M)(ie));ie.push(Te)}const{folderTitle:he,folderUid:me}=de.state.meta,ce=me&&he?{kind:"folder",uid:me,title:he}:void 0;return{type:g.Z.grafana,folder:ce,queries:ie,name:X.state.title,condition:ie[ie.length-1].refId,annotations:[{key:y.YH.dashboardUID,value:de.state.uid},{key:y.YH.panelID,value:String((0,c.Cs)(X))}]}};function _(X,Q,q){return q?a.calculateInterval(X,q,Q):Q&&a.intervalToMs(Q)>1e3?{interval:Q,intervalMs:a.intervalToMs(Q)}:{interval:"1s",intervalMs:1e3}}function k(X){const Q=X.model;return J(Q)&&Q.instant&&Q.range?{...X,model:{...Q,range:!0,instant:!1}}:X}function J(X){return"expr"in X&&"instant"in X&&"range"in X}function z(X){return"expr"in X}function Y(X){const Q=X.datasourceUid??X.model.datasource?.uid;if(!Q)return;const q=(0,o.l)().getInstanceSettings(Q)?.type;if(!q||!(0,v.cl)(q))return;const{model:te}=X,ne="instant"in te&&te.instant!==void 0?te.instant:!0,se="queryType"in te&&te.queryType!==void 0?te.queryType==="instant":!0;return(0,v.bS)(q)?ne:se}},94646:(Z,R,e)=>{"use strict";e.d(R,{$9:()=>T,LC:()=>v,Lg:()=>r,Ns:()=>I,P1:()=>m,PH:()=>E,Tn:()=>B,UP:()=>g,VY:()=>N,c:()=>D,co:()=>p,h1:()=>S,jY:()=>W,mw:()=>h,qg:()=>C,uE:()=>M,vL:()=>j,x6:()=>P});var n=e(2543),a=e.n(n),s=e(36490),l=e(24619),o=e(74268),d=e(74869),i=e(52161),c=e(29609);function m(L,A,U,F){return c.p.grafana.rule(F)?{uid:F.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:L,namespace:A,groupName:U,ruleName:(0,c.qz)(F),rulerRuleHash:I(F)}}function p(L,A){if(L.groupOrigin==="grafana"){if(c.p.grafana.rule(A))return{uid:A.grafana_alert.uid,ruleSourceName:"grafana"};throw(0,o.vV)(new Error("Rule is not a Grafana Ruler rule")),new Error("Rule is not a Grafana Ruler rule")}return m(L.rulesSource.name,L.namespace.name,L.groupName,A)}function h(L,A){const{dataSourceName:U,namespaceName:F,groupName:V}=L;return m(U,F,V,A)}function r(L,A,U,F){return{ruleSourceName:L,namespace:A,groupName:U,ruleName:F.name,ruleHash:W(F)}}function g(L,A){const U=A.namespace.name,F=A.group.name;if(A.rulerRule)return m(L,U,F,A.rulerRule);if(A.promRule)return r(L,U,F,A.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function y(L){return m(L.ruleSourceName,L.namespace,L.group.name,L.rule)}function v(L,A){return(0,c.A4)(L)&&(0,c.A4)(A)?L.uid===A.uid:(0,c.X4)(L)&&(0,c.X4)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.rulerRuleHash===A.rulerRuleHash&&L.ruleSourceName===A.ruleSourceName:(0,c.Mj)(L)&&(0,c.Mj)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.ruleHash===A.ruleHash&&L.ruleSourceName===A.ruleSourceName:(0,c.X4)(L)&&(0,c.Mj)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.rulerRuleHash===A.ruleHash&&L.ruleSourceName===A.ruleSourceName:(0,c.Mj)(L)&&(0,c.X4)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.ruleHash===A.rulerRuleHash&&L.ruleSourceName===A.ruleSourceName:!1}const x="cri",f="pri";function u(L){return L.replace(/\$/g,"_DOLLAR_")}function b(L){return L.replace(/\_DOLLAR\_/g,"$")}function E(L){return L.replace(/\//g,"").replace(/\\/g,"")}function D(L){return L.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function C(L,A=!1){const F=(A?decodeURIComponent(L):L).split("$");if(F.length===1)return{uid:L,ruleSourceName:"grafana"};if(F.length===6){const[V,K,G,H,_,k]=F.map(b).map(D);if(V===x)return{ruleSourceName:K,namespace:G,groupName:H,ruleName:_,rulerRuleHash:k};if(V===f)return{ruleSourceName:K,namespace:G,groupName:H,ruleName:_,ruleHash:k}}throw new Error(`Failed to parse rule location: ${L}`)}function P(L,A=!1){if(L)try{return C(L,A)}catch{return}}function T(L){return(0,c.A4)(L)?L.uid:(0,c.X4)(L)?[x,L.ruleSourceName,L.namespace,L.groupName,L.ruleName,L.rulerRuleHash].map(String).map(u).map(E).join("$"):[f,L.ruleSourceName,L.namespace,L.groupName,L.ruleName,L.ruleHash].map(String).map(u).map(E).join("$")}function O(L){let A=0;if(L.length===0)return A;for(let U=0;U<L.length;U++){const F=L.charCodeAt(U);A=(A<<5)-A+F,A=A&A}return A}function I(L){if(c.p.grafana.rule(L))return L.grafana_alert.uid;const U=!(0,d.wS)(),F=j(L,U);return O(JSON.stringify(F)).toString()}function j(L,A){const U=A?S(L.expr):"",F=w(L.labels);if(c.p.dataSource.recordingRule(L))return[L.record,l.JS.Recording,U,F];if(c.p.dataSource.alertingRule(L))return[L.alert,l.JS.Alerting,U,w(L.annotations),F];throw new Error("Only recording and alerting ruler rules can be hashed")}function W(L){const U=!(0,d.wS)(),F=B(L,U);return O(JSON.stringify(F)).toString()}function B(L,A){const U=A?S(L.query):"",F=w(L.labels);if(c.R$.recordingRule(L))return[L.name,l.JS.Recording,U,F];if(c.R$.alertingRule(L))return[L.name,l.JS.Alerting,U,w(L.annotations),F];throw new Error("Only recording and alerting rules can be hashed")}function S(L){return L.length>1&&L[0]==="("&&L[L.length-1]===")"&&(L=L.slice(1,-1)),L=L.replace(/\s|\n/g,""),L.split("").sort().join("")}function w(L){return JSON.stringify(Object.entries(L||{}).sort((A,U)=>A[0].localeCompare(U[0])))}function N(L){return(0,c.A4)(L)?i.hY:L.ruleSourceName}function M(L){const{pathname:A=""}=s.Ny.getLocation(),{id:U}=L;return U?(0,n.nth)(A.split("/"),-2):void 0}},45311:(Z,R,e)=>{"use strict";e.d(R,{U:()=>s});var n=e(2543),a=e.n(n);function s(l){const o=(0,n.pick)(l,["alerting","pending","inactive","recording","recovering"]);return(0,n.sum)(Object.values(o))}},29609:(Z,R,e)=>{"use strict";e.d(R,{$7:()=>j,A4:()=>W,BL:()=>Te,H2:()=>Qe,I2:()=>ce,Mj:()=>w,Mu:()=>Se,Nv:()=>M,O9:()=>ie,OF:()=>Ge,Om:()=>ne,R$:()=>O,RI:()=>I,Rh:()=>G,TU:()=>X,Tm:()=>J,Wy:()=>q,X4:()=>B,XI:()=>z,YN:()=>se,aw:()=>N,bL:()=>L,dS:()=>Q,f6:()=>U,fC:()=>F,hC:()=>v,j_:()=>Pe,jg:()=>de,nf:()=>S,oI:()=>A,p:()=>T,pq:()=>Me,qz:()=>ue,s_:()=>ke,uo:()=>H,vE:()=>tt,x6:()=>b,xE:()=>He});var n=e(2543),a=e.n(n),s=e(76190),l=e(43173),o=e(24619),d=e(56369),i=e(67817),c=e(95443),m=e(52161),p=e(39659),h=e(15629);function r(Re){return typeof Re=="object"&&"grafana_alert"in Re}function g(Re){return r(Re)&&!y(Re)}function y(Re){return r(Re)&&"record"in Re.grafana_alert}function v(Re){return!!Re.grafana_alert.is_paused}function x(Re){return typeof Re=="object"&&"alert"in Re}function f(Re){return typeof Re=="object"&&!r(Re)}function u(Re){return typeof Re=="object"&&"record"in Re}function b(Re){return Re.rules.every(Ne=>f(Ne))}function E(Re){return typeof Re=="object"&&Re.type===o.JS.Alerting}function D(Re){return typeof Re=="object"&&Re.type===o.JS.Recording}function C(Re){return E(Re)&&"folderUid"in Re&&"uid"in Re}function P(Re){return D(Re)&&"folderUid"in Re&&"uid"in Re}const T={grafana:{rule:r,alertingRule:g,recordingRule:y},dataSource:{rule:f,alertingRule:x,recordingRule:u},any:{recordingRule:Re=>u(Re)||y(Re),alertingRule:Re=>x(Re)||g(Re)}},O={rule:Re=>E(Re)||D(Re),alertingRule:E,recordingRule:D,grafana:{rule:Re=>C(Re)||P(Re),alertingRule:C,recordingRule:P}};function I(Re){return JSON.stringify(Re.labels)}function j(Re){return Re.error&&Re.error?.message?.includes(c.UU)}function W(Re){return"uid"in Re}function B(Re){return"rulerRuleHash"in Re}function S(Re){return Object.values(o.JS).includes(Re)}function w(Re){return"ruleHash"in Re}function N(Re){return W(Re)||B(Re)}function M(Re){return r(Re)&&!!Re.grafana_alert.provenance}function L(Re){return O.grafana.rule(Re)&&!!Re.provenance}function A(Re){return Re.rules.some(Ne=>M(Ne))}function U(Re){switch(Re){case"ok":return d.Jc.Ok;case"nodata":return d.Jc.NoData;case"error":case"err":return d.Jc.Error;case"unknown":return d.Jc.Unknown;default:return}}function F(Re){if(!T.any.recordingRule(Re.rulerRule)){if(x(Re.rulerRule))return Re.rulerRule.for;if(E(Re.promRule)){const Ne=(Re.promRule.duration??0)*1e3;return(0,h.an)(Ne)}}}function V(Re){return T.any.alertingRule(Re)?Re.for:void 0}function K(Re){if(!T.any.recordingRule(Re.rulerRule)&&g(Re.rulerRule))return Re.rulerRule.keep_firing_for}function G(Re){return Re?.annotations??{}}function H(Re){if(!Re)return;const Ne=Re.labels?.[p.lL];if(!Ne)return;const Ae=Ne.match(/^plugin\/(?<pluginId>.+)$/);if(!Ae?.groups)return;const Ue=Ae.groups.pluginId;if(_(Ue))return{pluginId:Ue}}function _(Re){return!!l.$.apps[Re]}function k(Re){return Re.rules.some(Ne=>J(Ne))}function J(Re){return!!H(Re)}function z(Re){return Re===o.cF.Inactive?"Normal":(0,n.capitalize)(Re)}const Y=Re=>Re.reduce((Ne,{dataSourceName:Ae,name:Ue,groups:Be})=>(Be.forEach(({name:We,rules:_e})=>{_e.forEach(Xe=>{E(Xe)&&Ne.push({dataSourceName:Ae,namespaceName:Ue,groupName:We,rule:Xe})})}),Ne),[]),X=Re=>E(Re.promRule)?Re.promRule:null,Q=Re=>Re.reduce((Ne,{rulesSource:Ae,name:Ue,groups:Be})=>(Be.forEach(({name:We,rules:_e})=>{_e.forEach(Xe=>{Xe.promRule&&E(Xe.promRule)&&Ne.push({dataSourceName:(0,m.EV)(Ae),namespaceName:Ue,groupName:We,...Xe,namespace:{...Xe.namespace,uid:Xe.promRule.folderUid}})})}),Ne),[]);function q(Re){let Ne;return Object.values(s.O).includes(Re)?Ne=Re:Ne=(0,o.lh)(Re),te[Ne]}const te={[o.cF.Inactive]:"good",[o.cF.Firing]:"bad",[o.cF.Pending]:"warning",[o.cF.Recovering]:"warning",[o.Gi.Alerting]:"bad",[o.Gi.Error]:"bad",[o.Gi.NoData]:"info",[o.Gi.Normal]:"good",[o.Gi.Pending]:"warning",[o.Gi.Recovering]:"warning",[s.O.NoData]:"info",[s.O.Paused]:"warning",[s.O.Alerting]:"bad",[s.O.OK]:"good",[s.O.Unknown]:"info"};function ne(Re){return Re?.alerts?Re.alerts.reduce((Ne,Ae)=>{const Ue=(0,o.lh)(Ae.state)!==o.Gi.Normal;if(Ae.activeAt&&Ue){const Be=new Date(Ae.activeAt);if(Ne===null||Ne.getTime()>Be.getTime())return Be}return Ne},null):null}function se(Re){return Array.isArray(Re.source_tenants)}function ue(Re){return T.grafana.rule(Re)?Re.grafana_alert.title:T.dataSource.alertingRule(Re)?Re.alert:T.dataSource.recordingRule(Re)?Re.record:""}const de=(Re,Ne)=>{const Ae={alertName:"",forDuration:"0s",evaluationsToFire:0};return r(Re)?{alertName:Re.grafana_alert.title,forDuration:Re.for,evaluationsToFire:Re.for?ie(Re.for,Ne):null}:x(Re)?{alertName:Re.alert,forDuration:Re.for??"0s",evaluationsToFire:ie(Re.for??"0s",Ne)}:Ae},ie=(Re,Ne)=>{const Ae=(0,h.P8)(Ne),Ue=(0,h.P8)(Re);return Ue===0&&Ae!==0?1:Ae===0||Ue/Ae<1?0:Math.ceil(Ue/Ae)+1};function he(Re,Ne){return Re===0?1:Ne===0||Re/Ne<1?0:Math.ceil(Re/Ne)+1}function me(Re){const Ne=isGrafanaRulesSource(Re.namespace.rulesSource)?Re.namespace.rulesSource:Re.namespace.rulesSource.name,Ae=r(Re.rulerRule)?Re.rulerRule.grafana_alert.namespace_uid:Re.namespace.name;return{dataSourceName:Ne,namespaceName:Ae,groupName:Re.group.name}}function ce(Re){const Ne=Re.ruleSourceName,Ae=r(Re.rule)?Re.rule.grafana_alert.namespace_uid:Re.namespace,Ue=Re.group.name;return{dataSourceName:Ne,namespaceName:Ae,groupName:Ue}}function Pe(Re){const Ne=Re.dataSourceName,Ae=Re.folder?.uid??Re.namespace,Ue=Re.group;if(!Ne)throw new Error("no datasource name in form values");return{dataSourceName:Ne,namespaceName:Ae,groupName:Ue}}function Ie(Re){return isGrafanaRulesSource(Re)?Re:Re.name}function Se(Re){return Re===i.Z.grafana}function Me(Re){return Re===i.Z.grafanaRecording}function Te(Re){return Re===i.Z.cloudAlerting}function Ge(Re){return Re===i.Z.cloudRecording}function Qe(Re){return Se(Re)||Me(Re)}function tt(Re){return Me(Re)||Ge(Re)}function ke(Re){return Te(Re)||Ge(Re)}function He(Re){if(!Re)return;let Ne;return"grafana_alert"in Re&&T.grafana.rule(Re)?Ne=Re.grafana_alert.uid:"uid"in Re&&O.grafana.rule(Re)&&(Ne=Re.uid),Ne}},42801:(Z,R,e)=>{"use strict";e.d(R,{a:()=>l,o:()=>s});var n=e(2543),a=e.n(n);function s(o,d){let i=d.trim();if(!i.match(/\{\{\s*define/)){const c=i.split(`
`).map(m=>"  "+m).join(`
`);i=`{{ define "${o}" }}
${c}
{{ end }}`}return i}function l(o){const d=(i,c)=>`{{ define "${c}_NEW_${(0,n.now)()}" }}`;return o.replace(/\{\{\s*define\s*\"(?<defineName>.*)\"\s*\}\}/g,d)}},15629:(Z,R,e)=>{"use strict";e.d(R,{M9:()=>m,P1:()=>a,P8:()=>h,TN:()=>o,an:()=>p,mo:()=>r,sc:()=>l,yl:()=>g});var n=e(72649);function a(y){const v=y.match(/(\d+)(\w+)/);if(v)return[Number(v[1]),v[2]];throw new Error(`Invalid interval description: ${y}`)}function s(y){const{sec:v,count:x}=rangeUtil.describeInterval(y);return v*x}const l=Object.entries(n.y).map(([y,v])=>({label:y[0].toUpperCase()+y.slice(1),value:v}));function o(y){try{return m(y),!0}catch{return!1}}const d={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},i=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),c=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(n.y).join(", ")}`);function m(y){let v=y;const x=[];function f(b){const E=i.exec(b),D=E?.groups?.value&&E?.groups?.type;if(!E||!D)throw c;E&&E.groups?.value&&E.groups?.type&&(v=v.replace(E[0],""),x.push([Number(E.groups.value),E.groups.type])),v&&f(v)}if(f(y),!x.length)throw c;return x.reduce((b,[E,D])=>{const C=E*d[D];return b+C},0)}function p(y){const v=Math.floor(y/1e3),x=Math.floor(v/60),f=Math.floor(x/60),u=Math.floor(f/24),b=Math.floor(u/7),E=Math.floor(u/365);return y===0?"0s":[[E,"y"],[b%52,"w"],[u%365-7*(b%52),"d"],[f%24,"h"],[x%60,"m"],[v%60,"s"],[y%1e3,"ms"]].filter(([C])=>C>0).map(([C,P])=>C+P).join("")}const h=y=>{try{return m(y)}catch{return 0}},r=y=>y.includes("0001-01-01T00");function g(y){return y%(1e3*60*60)===0?y/(1e3*60*60)+"h":y%(1e3*60)===0?y/(1e3*60)+"m":y%1e3===0?y/1e3+"s":y.toFixed()+"ms"}},92367:(Z,R,e)=>{"use strict";e.d(R,{G:()=>a,z:()=>s});var n=e(43173);function a(l,o,d={skipSubPath:!1}){const c=new URLSearchParams(o).toString();return`${d.skipSubPath?"":n.$.appSubUrl}${l}${c?`?${c}`:""}`}function s(l,o){const i=new URLSearchParams(o).toString();try{return`${new URL(n.$.appSubUrl+l,n.$.appUrl).href}${i?`?${i}`:""}`}catch{return a(l,o)}}},88547:(Z,R,e)=>{"use strict";e.d(R,{S:()=>s});var n=e(36303),a=e(74268);function s(l,o={}){return(0,n.Xc)(l,{...o,style:"page",errorLogger:a.vV})}},78767:(Z,R,e)=>{"use strict";e.d(R,{Xm:()=>l,rJ:()=>s,vJ:()=>a,vy:()=>o});var n=e(68143);function a(d){return(0,n.AI)().post("/api/annotations",d)}function s(d){return(0,n.AI)().put(`/api/annotations/${d.id}`,d)}function l(d){return(0,n.AI)().delete(`/api/annotations/${d.id}`)}async function o(){return(await(0,n.AI)().get("/api/annotations/tags")).result.tags.map(({tag:i,count:c})=>({term:i,count:c}))}},76478:(Z,R,e)=>{"use strict";e.d(R,{A:()=>T});var n=e(74848),a=e(96540),s=e(75505),l=e(28105),o=e(62392),d=e(51898),i=e(92745),c=e(35137),m=e(68079),p=e(45861),h=e(34999),r=e(22429),g=e(75421),y=e(82612),v=e(87033),x=e(90696),f=e(16515),u=e(88907),b=e(55386),E=e(45967),D=e(30703),C=e(18857);class P extends a.PureComponent{constructor(I){super(I),this.updateFields=()=>{const j=this.props.response?.panelData,W=j?.series?.[0]??j?.annotations?.[0];if(W&&W.fields){const B=W.fields.map(S=>{const w=(0,f.Ct)(S,W);let N="";for(let M=0;M<W.length;M++){if(M>0&&(N+=", "),M>2){N+="...";break}N+=S.values[M]}return N.length>50&&(N=N.substring(0,50)+"..."),{label:`${w} (${S.type})`,value:w,description:N}});this.setState({fieldNames:B})}},this.onFieldSourceChange=(j,W)=>{const B=this.props.mappings||{},S=B[j]||{};this.props.change({...B,[j]:{...S,source:W.value||u.V.Field}})},this.onFieldNameChange=(j,W)=>{const B=this.props.mappings||{};if(!W){const w={...this.props.mappings};delete w[j],this.props.change(w);return}const S=B[j]||{};this.props.change({...B,[j]:{...S,value:W.value,source:u.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(I){I.response!==this.props.response&&this.updateFields()}renderRow(I,j,W){const{fieldNames:B}=this.state;let S=[...B];const w=j.value;let N=B.find(L=>w===L.value);w&&!N&&S.push({label:w,value:w});let M=W?W[I.key]:"";if(M&&I.key.startsWith("time")){const L=(0,b.j_)("dateTimeAsIso");M=(0,b.cN)(L(M))}return M==null&&(M=""),(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[I.label||I.key," ",I.help&&(0,n.jsx)(E.m,{content:I.help,children:(0,n.jsx)(D.I,{name:"info-circle"})})]}),(0,n.jsx)("td",{children:(0,n.jsx)(C.l6,{value:N,options:S,placeholder:I.placeholder||I.key,onChange:L=>{this.onFieldNameChange(I.key,L)},noOptionsMessage:(0,i.t)("annotations.annotation-field-mapper.noOptionsMessage-unknown-field-names","Unknown field names"),allowCustomValue:!0,isClearable:!0})}),(0,n.jsx)("td",{children:`${M}`})]},I.key)}render(){const I=this.props.response?.events?.[0],j=this.props.mappings||{};return(0,n.jsxs)("table",{className:"filter-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(i.x6,{i18nKey:"annotations.annotation-field-mapper.annotation",children:"Annotation"})}),(0,n.jsx)("th",{children:(0,n.jsx)(i.x6,{i18nKey:"annotations.annotation-field-mapper.from",children:"From"})}),(0,n.jsx)("th",{children:(0,n.jsx)(i.x6,{i18nKey:"annotations.annotation-field-mapper.first-value",children:"First value"})})]})}),(0,n.jsx)("tbody",{children:x.kj.map(W=>this.renderRow(W,j[W.key]||{},I))})]})}}class T extends a.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:I,annotation:j}=this.props;if((0,x.E7)(I))return;const W=(0,r.UA)().getCurrent();if(!W)return;this.setState({running:!0});const B=await(0,s.s)((0,v.b)({range:(0,g.jG)().timeRange(),panel:new y.a9({}),dashboard:W},I,j));this.setState({running:!1,response:B})},this.onQueryChange=I=>{this.props.annotation.query&&this.props.annotation.query.spec&&(I={...this.props.annotation.query.spec,...I}),this.props.onChange({...this.props.annotation,target:I,...this.props.annotation.query&&{query:{kind:this.props.annotation.query.kind,spec:{...I}}},...this.props.annotation.legacyOptions?{legacyOptions:this.props.annotation.legacyOptions}:{}})},this.onMappingChange=I=>{this.props.onChange({...this.props.annotation,mappings:I})},this.onAnnotationChange=I=>{this.props.onChange({...I,...this.props.annotation.legacyOptions?{legacyOptions:this.props.annotation.legacyOptions}:{}})}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(I){this.props.annotation!==I.annotation&&!(0,x.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:I,annotation:j}=this.props,B={...x.CU,...I.annotations}.prepareAnnotation(j);B!==j?this.props.onChange(B):this.onRunQuery()}getStatusSeverity(I){const{events:j,panelData:W}=I;return W?.errors||W?.error?"error":j?.length?"success":"warning"}renderStatusText(I,j){const{events:W,panelData:B}=I;if(j||I?.panelData?.state===l.Gu.Loading||!I)return(0,n.jsx)("p",{children:"loading..."});if(B?.errors)return(0,n.jsx)(n.Fragment,{children:B.errors.map((M,L)=>(0,n.jsx)("p",{children:M.message},L))});if(B?.error)return(0,n.jsx)("p",{children:B.error.message??"There was an error fetching data"});if(!W?.length)return(0,n.jsx)("p",{children:(0,n.jsx)(i.x6,{i18nKey:"annotations.standard-annotation-query-editor.no-events-found",children:"No events found"})});const S=B?.series?.[0]??B?.annotations?.[0],w=W.length,N=S?.fields.length;return(0,n.jsx)("p",{children:(0,n.jsxs)(i.x6,{i18nKey:"annotations.standard-annotation-query-editor.events-found",children:[{numEvents:w}," events (from ",{numFields:N}," fields)"]})})}renderStatus(){const{response:I,running:j}=this.state;return I?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$,{v:2}),(0,n.jsx)("div",{children:j?(0,n.jsx)(m.y,{}):(0,n.jsx)(p.$n,{"data-testid":d.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:(0,n.jsx)(i.x6,{i18nKey:"annotations.standard-annotation-query-editor.test-annotation-query",children:"Test annotation query"})})}),(0,n.jsx)(c.$,{v:2,layout:"block"}),(0,n.jsx)(h.F,{"data-testid":d.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(I),title:(0,i.t)("annotations.standard-annotation-query-editor.title-query-result","Query result"),children:this.renderStatusText(I,j)})]}):null}render(){const{datasource:I,annotation:j,datasourceInstanceSettings:W}=this.props,{response:B}=this.state;let S=I.annotations?.QueryEditor||I.components?.QueryEditor;if(!S)return(0,n.jsx)("div",{children:(0,n.jsx)(i.x6,{i18nKey:"annotations.standard-annotation-query-editor.no-query-editor",children:"Annotations are not supported. This datasource needs to export a QueryEditor"})});let w=j.target;j.query&&j.query.spec&&(w={...j.query.spec});let N={...I.annotations?.getDefaultQuery?.(),...w??{refId:"Anno"}},M=j;return j.query&&j.legacyOptions&&(M={...j.legacyOptions,...j}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.p,{instanceSettings:W,children:(0,n.jsx)(S,{query:N,datasource:I,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:B?.panelData,range:(0,g.jG)().timeRange(),annotation:M,onAnnotationChange:this.onAnnotationChange},I?.name)}),(0,x.JX)(I)&&(0,n.jsxs)(n.Fragment,{children:[this.renderStatus(),(0,n.jsx)(P,{response:B,mappings:j.mappings,change:this.onMappingChange})]})]})}}},87033:(Z,R,e)=>{"use strict";e.d(R,{b:()=>p});var n=e(62467),a=e(69862),s=e(81160),l=e(17548),o=e(1906),d=e(71393),i=e(90696);let c=100;function m(){return"AQ"+c++}function p(h,r,g){const y={...i.CU,...r.annotations},v={...y.getDefaultQuery?.(),...g},x=y.prepareAnnotation(v);if(!x)return(0,n.of)({});const f=y.prepareQuery(x);if(!f)return(0,n.of)({});const u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b=l.calculateInterval(h.range,u,r.interval),E={__interval:{text:b.interval,value:b.interval},__interval_ms:{text:b.intervalMs.toString(),value:b.intervalMs},__annotation:{text:x.name,value:x}},D={startTime:Date.now(),requestId:m(),range:h.range,maxDataPoints:u,scopedVars:E,...b,app:o.Jk.Dashboard,timezone:h.dashboard.timezone,targets:[{...f,refId:"Anno"}]};return(0,d.BN)(r,D).pipe((0,a.Z)(C=>{const P=C?.series.length?C.series:C.annotations;return P?.length?y.processEvents(x,P).pipe((0,s.T)(T=>({panelData:C,events:T}))):(0,n.of)({panelData:C,events:[]})}))}},90696:(Z,R,e)=>{"use strict";e.d(R,{CU:()=>h,E7:()=>b,JX:()=>u,kj:()=>g});var n=e(2543),a=e.n(n),s=e(62467),l=e(69862),o=e(81160),d=e(96702),i=e(95004),c=e(16515),m=e(88907),p=e(65642);const h={prepareAnnotation:E=>{if((0,n.isString)(E?.query)){const{query:D,...C}=E;return{...C,target:{refId:"annotation_query",query:D},mappings:{}}}return E},prepareQuery:E=>E.target,processEvents:(E,D)=>x(D,E.mappings)};function r(){return E=>E.pipe((0,l.Z)(D=>{if(!D?.length)return(0,s.of)(void 0);if(D.length===1)return(0,s.of)(D[0]);const C={interpolate:P=>P};return(0,s.of)(D).pipe(d.c.mergeTransformer.operator({},C),(0,o.T)(P=>P[0]))}))}const g=[{key:"time",field:E=>E.fields.find(D=>D.type===i.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:E=>E.fields.find(D=>D.type===i.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],y=[{key:"color"},{key:"isRegion"},{key:"source"}],v=[...p.$W.publicDashboardAccessToken?y:[],...g,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function x(E,D){return(0,s.of)(E).pipe(r(),(0,o.T)(C=>{if(!C?.length)return[];let P=!1,T=!1;const O={};for(const W of C.fields){const B=(0,c.Ct)(W,C);O[B.toLowerCase()]=W}D||(D={});const I=[];for(const W of v){const B=D[W.key]||{};if(B.source===m.V.Skip)continue;const S={key:W.key,split:W.split};if(B.source===m.V.Text)S.text=B.value;else{const w=(B.value||W.key).toLowerCase();S.field=O[w],!S.field&&W.field&&(S.field=W.field(C))}(S.field||S.text)&&(I.push(S),S.key==="time"?P=!0:S.key==="text"&&(T=!0))}if(!P||!T)return console.error("Cannot process annotation fields. No time or text present."),[];const j=[];for(let W=0;W<C.length;W++){const B={type:"default",color:"red"};for(const S of I){let w;if(S.text)w=S.text;else if(S.field&&(w=S.field.values[W],w!==void 0&&S.regex)){const N=S.regex.exec(w);N&&(w=N[1]?N[1]:N[0])}w!=null&&(S.split&&typeof w=="string"&&(w=w.split(",")),B[S.key]=w)}j.push(B)}return j}))}const f=["loki","elasticsearch","grafana-opensearch-datasource"];function u(E){const{type:D}=E;return!(D==="datasource"||f.includes(D))}function b(E){const{type:D}=E;return f.includes(D)}},54115:(Z,R,e)=>{"use strict";e.d(R,{H1:()=>x,ws:()=>y});var n=e(16126),a=e(81160),s=e(69862),l=e(65474),o=e(33160),d=e(66847),i=e(38619),c=e(68143),m=e(33184),p=e(43173),h=e(73427),r=e(85618),g=e(75735);class y{constructor(b,E=!0){this.parseListOptionsSelector=f;const D=E?`namespaces/${(0,r.Ge)()}/`:"";this.gvr=b,this.url=`/apis/${b.group}/${b.version}/${D}${b.resource}`}async get(b){return(0,c.AI)().get(`${this.url}/${b}`)}watch(b){const E={watch:!0,labelSelector:this.parseListOptionsSelector(b?.labelSelector),fieldSelector:this.parseListOptionsSelector(b?.fieldSelector)};if(b?.name&&(E.fieldSelector=`metadata.name=${b.name}`),this.gvr.group==="provisioning.grafana.app"){let C="";return E.fieldSelector?.startsWith("metadata.name=")&&(C=E.fieldSelector.substring(13)),(0,m.oF)().getStream({scope:i.qD.Watch,namespace:this.gvr.group,path:`${this.gvr.version}/${this.gvr.resource}${C}/${p.$.bootData.user.uid}`}).pipe((0,n.p)(P=>(0,i.Z7)(P)),(0,a.T)(P=>P.message))}const D=new TextDecoder;return(0,c.AI)().chunked({url:this.url,params:E,method:"GET"}).pipe((0,n.p)(C=>C.ok&&C.data instanceof Uint8Array),(0,a.T)(C=>D.decode(C.data).split(`
`)),(0,s.Z)(C=>(0,l.H)(C)),(0,n.p)(C=>C.length>0),(0,a.T)(C=>{try{return JSON.parse(C)}catch(P){return console.warn("Invalid JSON in watch stream:",P,C),null}}),(0,n.p)(C=>C!==null),(0,o.L)({count:3,delay:1e3}),(0,d.W)(C=>{throw console.error("Watch stream error:",C),C}))}async subresource(b,E,D){return(0,c.AI)().get(`${this.url}/${b}/${E}`,D)}async list(b){const E=b||{};return E.labelSelector=this.parseListOptionsSelector(E?.labelSelector),E.fieldSelector=this.parseListOptionsSelector(E?.fieldSelector),(0,c.AI)().get(this.url,b)}async create(b,E){if(!b.metadata.name&&!b.metadata.generateName){const D=h.TP.user.login,C=D?D.replace(/[^a-zA-Z]/g,"").slice(0,2):"";b.metadata.generateName=C||"g"}return v(b.metadata),(0,c.AI)().post(this.url,b,{params:E})}async update(b,E){v(b.metadata);const D=`${this.url}/${b.metadata.name}`;return(0,c.AI)().put(D,b,{params:E})}async delete(b,E){return(0,c.AI)().delete(`${this.url}/${b}`,void 0,{showSuccessAlert:E})}}function v(u){u.annotations||(u.annotations={}),u.annotations[g.Pd]=p.$.buildInfo.versionString}class x{async get(b){if(this.apiVersions)return this.apiVersions[b];const E=await(0,c.AI)().get("/apis"),D={};return E.groups.forEach(C=>{if(C.name.includes("datasource.grafana.app")){const P=C.name.split(".")[0];D[P]=C.preferredVersion.version,P.endsWith("-datasource")||(P.includes("-")?D[`${P}-datasource`]=C.preferredVersion.version:D[`grafana-${P}-datasource`]=C.preferredVersion.version)}}),this.apiVersions=D,D[b]}}const f=u=>Array.isArray(u)?u.map(b=>{const E=String(b.key),D=b.operator;switch(D){case"=":case"!=":return`${E}${D}${b.value}`;case"in":case"notin":return`${E} ${D} (${b.value.join(",")})`;case"":case"!":return`${D}${E}`;default:return null}}).filter(Boolean).join(","):u},66402:(Z,R,e)=>{"use strict";e.d(R,{F:()=>s,N:()=>a});function n(l){return l!==null&&typeof l=="object"}function a(l){if(!n(l))return!1;const o=l.metadata;return n(o)?typeof l.apiVersion=="string"&&typeof l.kind=="string"&&typeof o.name=="string"&&typeof o.resourceVersion=="string"&&typeof o.creationTimestamp=="string"&&n(l.spec):!1}function s(l){if(!n(l))return!1;const o=l.metadata;return n(o)?typeof o.resourceVersion=="string"&&Array.isArray(l.items):!1}},75735:(Z,R,e)=>{"use strict";e.d(R,{AI:()=>y,D1:()=>E,Jw:()=>c,LH:()=>i,Ms:()=>m,Pd:()=>g,Qu:()=>s,Sf:()=>d,UL:()=>f,Y5:()=>D,Y_:()=>p,ew:()=>l,fY:()=>o,hX:()=>v,hc:()=>n,hm:()=>u,qw:()=>x,w2:()=>b,xU:()=>a});const n="grafana.app/createdBy",a="grafana.app/updatedTimestamp",s="grafana.app/updatedBy",l="grafana.app/folder",o="grafana.app/message";var d=(C=>(C.Repo="repo",C.Terraform="terraform",C.Kubectl="kubectl",C.Plugin="plugin",C))(d||{});const i="grafana.app/managedBy",c="grafana.app/managerId",m="grafana.app/managerAllowsEdits",p="grafana.app/sourcePath",h="grafana.app/sourceChecksum",r="grafana.app/sourceTimestamp",g="grafana.app/saved-from-ui",y="grafana.app/grant-permissions",v="grafana.app/slug",x="grafana.app/dashboard-is-snapshot",f="grafana.app/dashboard-snapshot-original-url",u="grafana.app/dashboard-gnet-id",b="grafana.app/folderTitle",E="grafana.app/folderUrl",D="grafana.app/deprecatedInternalID"},69874:(Z,R,e)=>{"use strict";e.d(R,{getAuthProviderStatus:()=>h,getRegisteredAuthProviders:()=>c,initAuthConfig:()=>r,registerAuthProvider:()=>i});var n=e(65642),a=e(73427),s=e(83873),l=e(11257);const o=[],d={};function i(y,v){o.find(x=>x.id===y.id)||(o.push(y),v&&(d[y.id]=v))}function c(){return o}function m(y){return o.find(v=>v.id===y)}function p(y){const v=[];for(const[x,f]of Object.entries(y)){const u=o.find(b=>`auth.${b.id}`===x);if(u){const b={...f,providerId:u.id,displayName:f.name||u.displayName};v.push(b)}}return v}async function h(y){if(d[y]){const v=d[y];return v()}return{configured:!1,enabled:!1}}function r(){if(n.Ay.featureToggles.ssoSettingsLDAP)return;i({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},g)}async function g(){if(a.TP.hasPermission(l.w.SettingsRead)){const v=(await(0,s.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:v.enabled==="true",enabled:v.enabled==="true",hide:v.enabled!=="true"}}return{configured:!1,enabled:!1}}},35991:(Z,R,e)=>{"use strict";e.d(R,{DZ:()=>p,M5:()=>i,TD:()=>c});var n=e(75505),a=e(68143),s=e(73427),l=e(11257),o=e(69874),d=e(21875);function i(h=!0){return async r=>{if(s.TP.hasPermission(l.w.SettingsRead)){h&&r((0,d.sr)()),r(c());const g=await(0,a.AI)().get("/api/admin/settings");return r((0,d.jA)(g)),await r(m()),h&&r((0,d.MH)()),g}}}function c(h=""){return async r=>{const g=await(0,a.AI)().get(`/api/v1/sso-settings${h?`/${h}`:""}`);return r((0,d.Oy)(h?[g]:g)),g}}function m(){return async h=>{const r=(0,o.getRegisteredAuthProviders)(),g={},y=[];for(const x of r)y.push((0,o.getAuthProviderStatus)(x.id));const v=await Promise.all(y);for(let x=0;x<r.length;x++){const f=r[x];g[f.id]=v[x]}h((0,d.TO)(g))}}function p(h){return async r=>{if(s.TP.hasPermission(l.w.SettingsWrite))try{return await(0,n.s)((0,a.AI)().fetch({url:"/api/admin/settings",method:"PUT",data:h,showSuccessAlert:!1,showErrorAlert:!1})),r((0,d.SH)()),!0}catch(g){if(console.log(g),(0,a.NF)(g)){g.isHandled=!0;const y={message:g.data?.message,errors:g.data?.errors};return r((0,d.Nh)(y)),!1}}return!1}}},21875:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>y,MH:()=>i,Nh:()=>c,Oy:()=>r,SH:()=>m,TO:()=>o,jA:()=>l,sr:()=>d,yk:()=>h});var n=e(65307);const a={settings:{},providerStatuses:{},isLoading:!1,providers:[]},s=(0,n.Z0)({name:"authConfig",initialState:a,reducers:{settingsUpdated:(v,x)=>({...v,settings:x.payload}),providerStatusesLoaded:(v,x)=>({...v,providerStatuses:x.payload}),loadingBegin:v=>({...v,isLoading:!0}),loadingEnd:v=>({...v,isLoading:!1}),setError:(v,x)=>({...v,updateError:x.payload}),resetError:v=>({...v,updateError:void 0}),setWarning:(v,x)=>({...v,warning:x.payload}),resetWarning:v=>({...v,warning:void 0}),providersLoaded:(v,x)=>({...v,providers:x.payload})}}),{settingsUpdated:l,providerStatusesLoaded:o,loadingBegin:d,loadingEnd:i,setError:c,resetError:m,setWarning:p,resetWarning:h,providersLoaded:r}=s.actions,y={authConfig:s.reducer}},18346:(Z,R,e)=>{"use strict";e.d(R,{cU:()=>C,vZ:()=>P,Ko:()=>T,uz:()=>O,G2:()=>I,kH:()=>j,CE:()=>A,aF:()=>B,wt:()=>S,Vc:()=>w,vR:()=>L,e8:()=>N,iB:()=>M});var n=e(75816),a=e(28105),s=e(32899),l=e(92138),o=e(92745),d=e(68143),i=e(43173),c=e(36490),m=e(87161),p=e(73892),h=e(45229),r=e(73427),g=e(13956),y=e(60171),v=e(79718),x=e(8535),f=e(44220),u=e(75735);function b(U){return("meta"in U?U.meta.k8s?.annotations:U.metadata.annotations)?.[u.LH]===u.Sf.Repo}function E(U){return U.metadata.annotations?.[u.LH]===u.Sf.Repo}var D=e(27044);const C=(0,n.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:(0,p.W)({baseURL:"/api"}),endpoints:U=>({listFolders:U.query({providesTags:F=>F&&F.length>0?F.map(V=>({type:"getFolder",id:V.uid})):[{type:"getFolder",id:"EMPTY_RESULT"}],query:({parentUid:F,limit:V,page:K,permission:G})=>({url:"/folders",params:{parentUid:F,limit:V,page:K,permission:G}})}),getFolder:U.query({providesTags:(F,V,K)=>[{type:"getFolder",id:K}],query:F=>({url:`/folders/${F}`,params:{accesscontrol:!0}})}),newFolder:U.mutation({invalidatesTags:["getFolder"],query:({title:F,parentUid:V})=>({method:"POST",url:"/folders",body:{title:F,parentUid:V}}),onQueryStarted:({parentUid:F},{queryFulfilled:V,dispatch:K})=>{V.then(async({data:G})=>{await r.TP.fetchUserPermissions(),K((0,f.bw)({parentUID:F,pageSize:D.md}))})}}),saveFolder:U.mutation({invalidatesTags:["getFolder"],query:({uid:F,title:V,version:K})=>({method:"PUT",url:`/folders/${F}`,body:{title:V,version:K}}),onQueryStarted:({parentUid:F},{queryFulfilled:V,dispatch:K})=>{V.then(()=>{K((0,f.bw)({parentUID:F,pageSize:D.md}))})}}),moveFolder:U.mutation({invalidatesTags:["getFolder"],query:({folder:F,destinationUID:V})=>({url:`/folders/${F.uid}/move`,method:"POST",body:{parentUID:V}}),onQueryStarted:({folder:F,destinationUID:V},{queryFulfilled:K,dispatch:G})=>{const{parentUid:H}=F;K.then(()=>{G((0,f.bw)({parentUID:H,pageSize:D.md})),G((0,f.bw)({parentUID:V,pageSize:D.md}))})}}),deleteFolder:U.mutation({query:({uid:F})=>({url:`/folders/${F}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:F},{queryFulfilled:V,dispatch:K})=>{V.then(()=>{K((0,f.bw)({parentUID:F,pageSize:D.md}))})}}),getAffectedItems:U.query({keepUnusedDataFor:0,queryFn:async F=>{const K=Object.keys(F.folder).filter(_=>F.folder[_]).map(_=>(0,d.AI)().get(`/api/folders/${_}/counts`)),G=await Promise.all(K),H={folder:Object.values(F.folder).filter(a.zz).length,dashboard:Object.values(F.dashboard).filter(a.zz).length,libraryPanel:0,alertRule:0};for(const _ of G)H.folder+=_.folder??0,H.dashboard+=_.dashboard,H.alertRule+=_.alertrule,H.libraryPanel+=_.librarypanel;return{data:H}}}),moveItems:U.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:F,destinationUID:V},K,G,H)=>{const _=Object.keys(F.dashboard).filter(J=>F.dashboard[J]),k=Object.keys(F.folder).filter(J=>F.folder[J]);for(const J of k){if(i.$.featureToggles.provisioning){const z=await(0,x.JD)(m.Z.endpoints.getFolder.initiate({name:J}));if(E(z.data)){h.A.publish({type:s.r1.alertWarning.name,payload:["Cannot move provisioned folder"]});continue}}await H({url:`/folders/${J}/move`,method:"POST",body:{parentUID:V}})}for(const J of _){const z=await(0,g.n)().getDashboardDTO(J),Y=(0,y.HG)(z)?z.spec:z.dashboard,X=(0,y.HG)(z)?z.metadata:void 0;if(i.$.featureToggles.provisioning&&b(z)){h.A.publish({type:s.r1.alertWarning.name,payload:["Cannot move provisioned dashboard"]});continue}await(0,g.n)().saveDashboard({dashboard:Y,folderUid:V,overwrite:!1,message:"",k8s:X})}return{data:void 0}},onQueryStarted:({destinationUID:F,selectedItems:V},{queryFulfilled:K,dispatch:G})=>{const H=Object.keys(V.dashboard).filter(k=>V.dashboard[k]),_=Object.keys(V.folder).filter(k=>V.folder[k]);K.then(()=>{G((0,f.bw)({parentUID:F,pageSize:D.md})),G((0,f.Zw)([..._,...H]))})}}),deleteItems:U.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:F},V,K,G)=>{const H=Object.keys(F.dashboard).filter(k=>F.dashboard[k]),_=Object.keys(F.folder).filter(k=>F.folder[k]);for(const k of _){if(i.$.featureToggles.provisioning){const J=await(0,x.JD)(m.Z.endpoints.getFolder.initiate({name:k}));if(E(J.data)){h.A.publish({type:s.r1.alertWarning.name,payload:["Cannot delete provisioned folder. To remove it, delete it from the repository and synchronise to apply the changes."]});continue}}await G({url:`/folders/${k}`,method:"DELETE",params:{forceDeleteRules:!1}})}for(const k of H){if(i.$.featureToggles.provisioning){const J=await(0,g.n)().getDashboardDTO(k);if(b(J)){h.A.publish({type:s.r1.alertWarning.name,payload:["Cannot delete provisioned dashboard. To remove it, delete it from the repository and synchronise to apply the changes."]});continue}}await(0,g.n)().deleteDashboard(k,!0),i.$.featureToggles.kubernetesDashboards&&h.A.publish({type:s.r1.alertSuccess.name,payload:["Dashboard deleted"]})}return{data:void 0}},onQueryStarted:({selectedItems:F},{queryFulfilled:V,dispatch:K})=>{const G=Object.keys(F.dashboard).filter(_=>F.dashboard[_]),H=Object.keys(F.folder).filter(_=>F.folder[_]);V.then(()=>{K((0,f.Zw)([...H,...G]))})}}),saveDashboard:U.mutation({queryFn:async F=>{try{if((0,y.mi)(F))return{data:await(0,g.n)("v2").saveDashboard(F)};if((0,y.rL)(F))return{data:await(0,g.n)().saveDashboard(F)};throw new Error("Invalid dashboard version")}catch(V){return(0,p.s)(V)}},onQueryStarted:({folderUid:F},{queryFulfilled:V,dispatch:K})=>{v.t.ignoreNextSave(),V.then(async()=>{await r.TP.fetchUserPermissions(),K((0,f.bw)({parentUID:F,pageSize:D.md}))})}}),importDashboard:U.mutation({query:({dashboard:F,overwrite:V,inputs:K,folderUid:G})=>({method:"POST",url:"/dashboards/import",body:{dashboard:F,overwrite:V,inputs:K,folderUid:G}}),onQueryStarted:async({dashboard:F,folderUid:V},{queryFulfilled:K,dispatch:G})=>{let H;if(F.uid)try{const _=await(0,g.n)().getDashboardDTO(F.uid);H=(0,y.HG)(_)?_.metadata?.name:_.meta?.folderUid}catch(_){(0,d.NF)(_)&&(_.status!==404?console.error("Error fetching dashboard",_):_.isHandled=!0)}K.then(async _=>{G((0,f.bw)({parentUID:V,pageSize:D.md})),H&&H!==V&&G((0,f.bw)({parentUID:H,pageSize:D.md}));const k=l.I.stripBaseFromUrl(_.data.importedUrl);c.Ny.push(k)})}}),listDeletedDashboards:U.query({queryFn:async()=>{try{return{data:await(0,g.n)().listDeletedDashboards({})}}catch(F){return(0,p.s)(F)}}}),restoreDashboard:U.mutation({queryFn:async({dashboard:F})=>{try{const G=(await(0,g.n)().restoreDashboard(F)).spec.title;return G&&h.A.publish({type:s.r1.alertSuccess.name,payload:[(0,o.t)("browse-dashboards.restore.success","Dashboard {{name}} restored",{name:G})]}),{data:void 0}}catch(V){return(0,p.s)(V)}}})})}),{endpoints:P,useDeleteFolderMutation:T,useDeleteItemsMutation:O,useGetAffectedItemsQuery:I,useGetFolderQuery:j,useLazyGetFolderQuery:W,useMoveFolderMutation:B,useMoveItemsMutation:S,useNewFolderMutation:w,useSaveDashboardMutation:N,useSaveFolderMutation:M,useRestoreDashboardMutation:L,useListDeletedDashboardsQuery:A}=C},27044:(Z,R,e)=>{"use strict";e.d(R,{aw:()=>h,md:()=>m,uT:()=>p});var n=e(43173),a=e(68143),s=e(99090),l=e(55860),o=e(93854),d=e(11257),i=e(73427),c=e(62963);const m=50;async function p(r,g,y=1,v=m){if(r&&!n.$.featureToggles.nestedFolders)return[];const x=(0,a.AI)();let f=[];return i.TP.hasPermission(d.w.FoldersRead)&&(f=await x.get("/api/folders",{parentUid:r,page:y,limit:v})),f.map(u=>({kind:"folder",uid:u.uid,title:u.title,parentTitle:g,parentUID:r,managedBy:u.managedBy,url:(0,c.I2)(u.uid)?void 0:(0,c._0)(u.uid)}))}async function h(r,g=1,y=m){const x=await(0,l.S)().search({kind:["dashboard"],query:"*",location:r||"general",from:(g-1)*y,limit:y});return x.view.map(f=>{const u=(0,o.hI)(f,x.view);return u.parentUID===s.TF&&(u.parentUID=void 0),u})}},78059:(Z,R,e)=>{"use strict";e.d(R,{x:()=>c});var n=e(74848),a=e(70255),s=e(92745),l=e(34999),o=e(66404),d=e(18346);function i(m,p,h,r){const g=m+p+h+r,y=[];m&&y.push((0,s.t)("browse-dashboards.counts.folder","{{count}} folder",{count:m})),p&&y.push((0,s.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:p})),h&&y.push((0,s.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:h})),r&&y.push((0,s.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:r}));let v=(0,s.t)("browse-dashboards.counts.total","{{count}} item",{count:g});return y.length>0&&(v+=`: ${y.join(", ")}`),v}const c=({selectedItems:m})=>{const{data:p,isFetching:h,isLoading:r,error:g}=(0,d.G2)(m);return g?(0,n.jsx)(l.F,{severity:"error",title:(0,s.t)("browse-dashboards.descendant-count.title-unable-to-retrieve-descendant-information","Unable to retrieve descendant information")}):(0,n.jsxs)(o.E,{element:"p",color:"secondary",children:[p&&i(p.folder,p.dashboard,p.libraryPanel,p.alertRule),(h||r)&&(0,n.jsx)(a.A,{width:200})]})}},62963:(Z,R,e)=>{"use strict";e.d(R,{I2:()=>l,_0:()=>o,eM:()=>s});var n=e(43173),a=e(73427);function s(d,i){return d+i.uid}function l(d){return d===n.$.sharedWithMeFolderUID}function o(d){const{orgId:i}=a.TP.user,m=`${n.$.appSubUrl??""}/dashboards/f/${d}/`;return i?`${m}?orgId=${i}`:m}},44220:(Z,R,e)=>{"use strict";e.d(R,{Ii:()=>i,Zw:()=>o,bw:()=>d});var n=e(99090),a=e(52763),s=e(27044),l=e(78034);const o=(0,a.zD)("browseDashboards/refreshParents",async(c,{getState:m,dispatch:p})=>{const{browseDashboards:h}=m(),{rootItems:r,childrenByParentUID:g}=h,y=new Set;for(const v of c){const x=(0,l.R)(r?.items??[],g,v);y.add(x?.parentUID)}for(const v of y)p(d({parentUID:v,pageSize:s.md}))}),d=(0,a.zD)("browseDashboards/refetchChildren",async({parentUID:c,pageSize:m})=>{const p=c===n.TF?void 0:c;let h=1,r="folder",g=await(0,s.uT)(p,void 0,h,m),y=g.length<m;if(r==="folder"&&y){r="dashboard",h=1;const v=await(0,s.aw)(p,h,m);y=v.length<m,g=g.concat(v)}return{children:g,lastPageOfKind:y,page:h,kind:r}}),i=(0,a.zD)("browseDashboards/fetchNextChildrenPage",async({parentUID:c,excludeKinds:m=[],pageSize:p},h)=>{const r=!m.includes("dashboard"),g=c===n.TF?void 0:c,y=h.getState().browseDashboards,v=g?y.childrenByParentUID[g]:y.rootItems;let x=1,f;if(v?v.lastFetchedKind==="dashboard"&&!v.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${g} but that collection is fully loaded`):v.lastFetchedKind==="folder"&&v.lastKindHasMoreItems?(x=v.lastFetchedPage+1,f="folder"):r&&(x=v.lastFetchedKind==="folder"?1:v.lastFetchedPage+1,f="dashboard"):(x=1,f="folder"),!f)return;let u=f==="folder"?await(0,s.uT)(g,void 0,x,p):await(0,s.aw)(g,x,p),b=u.length<p;if(f==="folder"&&b&&r){f="dashboard",x=1;const E=await(0,s.aw)(g,x,p);b=E.length<p,u=u.concat(E)}return{children:u,lastPageOfKind:b,page:x,kind:f}})},80231:(Z,R,e)=>{"use strict";e.d(R,{Am:()=>m,Ms:()=>u,QE:()=>f,V6:()=>b,Zg:()=>D,eC:()=>v,ku:()=>c,q0:()=>x,xK:()=>E});var n=e(96540),a=e(25508),s=e(52763),l=e(27044),o=e(62963),d=e(44220),i=e(78034);const c=P=>P.browseDashboards.rootItems,m=P=>P.browseDashboards.childrenByParentUID,p=P=>P.browseDashboards.openFolders,h=P=>P.browseDashboards.selectedItems,r=(0,a.Mz)(c,m,p,(P,T)=>T,(P,T,O,I)=>C(I,P,T,O)),g=(0,a.Mz)(h,P=>Object.values(P).some(T=>Object.values(T).some(O=>O))),y=(0,a.Mz)(h,m,(P,T)=>{const O={dashboard:{...P.dashboard},folder:{...P.folder}};for(const I of Object.keys(P.folder))if(P.folder[I]){const W=T[I];if(W)for(const B of W.items)B.kind==="dashboard"&&(O.dashboard[B.uid]=!1),B.kind==="folder"&&(O.folder[B.uid]=!1)}return O});function v(P){return(0,s.d4)(T=>(P?T.browseDashboards.childrenByParentUID[P]:T.browseDashboards.rootItems)?"fulfilled":"pending")}function x(P){return(0,s.d4)(T=>r(T,P))}function f(){return(0,s.d4)(P=>g(P))}function u(){return(0,s.d4)(h)}function b(){return(0,s.d4)(P=>P.browseDashboards.childrenByParentUID)}function E(){return(0,s.d4)(P=>y(P))}function D(P=[]){const T=(0,s.wA)(),O=(0,n.useRef)(!1);return(0,n.useCallback)(j=>{if(O.current)return Promise.resolve();O.current=!0;const W=T((0,d.Ii)({parentUID:j,excludeKinds:P,pageSize:l.md}));return W.finally(()=>O.current=!1),W},[T,P])}function C(P,T,O,I,j=0,W=[],B=[]){function S(F,V,K){if(W.includes(F.kind)||B.includes(F.uid))return[];const G=C(F.uid,T,O,I,K+1,W,B),H=!!I[F.uid],_=O[F.uid]?.items.length===0;H&&_&&!W.includes("empty-folder")&&G.push({isOpen:!1,level:K+1,item:{kind:"ui",uiKind:"empty-folder",uid:F.uid+"empty-folder"},parentUID:V});const k={item:F,parentUID:V,level:K,isOpen:H},J=[k,...G];return(0,o.I2)(k.item.uid)&&J.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:V,level:K+1,isOpen:!1}),J}const w=P&&I[P]||j===0,N=P?O[P]:T;let L=((P?w&&N?.items:N?.items)||[]).flatMap(F=>S(F,P,j));const A=W.includes("dashboard")&&N?.lastFetchedKind==="dashboard";return(j===0&&!N||w&&N&&!(N.isFullyLoaded||A))&&(L=L.concat((0,i.T)(l.md,P,j))),L}},87186:(Z,R,e)=>{"use strict";e.d(R,{xN:()=>C,Ay:()=>P,cT:()=>D,wn:()=>b,t$:()=>E});var n={};e.r(n),e.d(n,{clearFolders:()=>r,fetchNextChildrenPageFulfilled:()=>c,refetchChildrenFulfilled:()=>i,setAllSelection:()=>h,setFolderOpenState:()=>m,setItemSelectionState:()=>p});var a=e(65307),s=e(44220),l=e(75735),o=e(62963),d=e(78034);function i(T,O){const{children:I,page:j,kind:W,lastPageOfKind:B}=O.payload,{parentUID:S}=O.meta.arg,w={items:I,lastFetchedKind:W,lastFetchedPage:j,lastKindHasMoreItems:!B,isFullyLoaded:W==="dashboard"&&B};S?T.childrenByParentUID[S]=w:T.rootItems=w}function c(T,O){const I=O.payload;if(!I)return;const{children:j,page:W,kind:B,lastPageOfKind:S}=I,{parentUID:w,excludeKinds:N=[]}=O.meta.arg,A={items:((w?T.childrenByParentUID[w]:T.rootItems)?.items??[]).concat(j),lastFetchedKind:B,lastFetchedPage:W,lastKindHasMoreItems:!S,isFullyLoaded:(N.includes("dashboard")||B==="dashboard")&&S};if(!w){T.rootItems=A;return}if(T.childrenByParentUID[w]=A,T.selectedItems.folder[w])for(const F of j)T.selectedItems[F.kind][F.uid]=!0}function m(T,O){const{folderUID:I,isOpen:j}=O.payload;T.openFolders[I]=j}function p(T,O){const{item:I,isSelected:j}=O.payload;if((0,o.I2)(I.uid)||I.managedBy===l.Sf.Repo)return;function W(B,S){if(T.selectedItems[B][S]=j,B!=="folder")return;let w=T.childrenByParentUID[S];for(const N of w?.items??[])W(N.kind,N.uid)}if(W(I.kind,I.uid),!j){let B=I.parentUID;for(;B;){const S=(0,d.R)(T.rootItems?.items??[],T.childrenByParentUID,B);if(!S)break;T.selectedItems[S.kind][S.uid]=!1,B=S.parentUID}}T.selectedItems.$all=T.rootItems?.items?.every(B=>T.selectedItems[B.kind][B.uid])??!1}function h(T,O){const{isSelected:I,folderUID:j}=O.payload;if(!(j&&(0,o.I2)(j)))if(T.selectedItems.$all=I,I){let B=function(S){if(S&&(0,o.I2)(S))return;const w=S?T.childrenByParentUID[S]:T.rootItems;if(w)for(const N of w.items)(0,o.I2)(N.uid)||N.managedBy===l.Sf.Repo||(T.selectedItems[N.kind][N.uid]=I,N.kind==="folder"&&B(N.uid))};var W=B;B(j)}else for(const B in T.selectedItems){if(!(B==="dashboard"||B==="panel"||B==="folder"))continue;const S=T.selectedItems[B];for(const w in S)S[w]=I}}function r(T,O){const I=Array.isArray(O.payload)?O.payload:[O.payload];for(const j of I)j?(T.childrenByParentUID[j]=void 0,T.openFolders[j]=!1):T.rootItems=void 0}const{fetchNextChildrenPageFulfilled:g,refetchChildrenFulfilled:y,...v}=n,x={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},f=(0,a.Z0)({name:"browseDashboards",initialState:x,reducers:v,extraReducers:T=>{T.addCase(s.Ii.fulfilled,g),T.addCase(s.bw.fulfilled,y)}}),u=f.reducer,{setFolderOpenState:b,setItemSelectionState:E,setAllSelection:D,clearFolders:C}=f.actions,P={browseDashboards:u}},78034:(Z,R,e)=>{"use strict";e.d(R,{R:()=>n,T:()=>a});function n(s,l,o){for(const d of s)if(d.uid===o)return d;for(const d in l){const i=l[d];if(i){for(const c of i.items)if(c.uid===o)return c}}}function a(s,l,o){return new Array(s).fill(null).map((d,i)=>({parentUID:l,level:o,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${l}-pagination-${i}`}}))}},26437:(Z,R,e)=>{"use strict";e.d(R,{b:()=>a,q:()=>n});const n="connections",a={Base:`/${n}`,DataSources:`/${n}/datasources`,DataSourcesNew:`/${n}/datasources/new`,DataSourcesEdit:`/${n}/datasources/edit/:uid`,DataSourcesDashboards:`/${n}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${n}/add-new-connection`,DataSourcesDetails:`/${n}/datasources/:id`,ConnectDataOutdated:`/${n}/connect-data`,YourConnectionsOutdated:`/${n}/your-connections`}},70191:(Z,R,e)=>{"use strict";e.d(R,{k:()=>o});var n=e(60455),a=e.n(n),s=e(79609),l=e(62635);const o=(d,i,c)=>{let m={},p={};if(d.type===s.CC.Regex&&d.expression){const h=new RegExp(d.expression,"gi"),g=(typeof i=="string"?i:(0,l.MA)(i)).matchAll(h);for(const y of g)y.groups?p=y.groups:p[d.mapValue||c]=y[1]||y[0]}else d.type===s.CC.Logfmt&&i!==void 0&&(p=a().parse(i));return Object.keys(p).forEach(h=>{const r=typeof p[h]=="string"?p[h]:(0,l.MA)(p[h]);m[h]={value:r}}),m}},52860:(Z,R,e)=>{"use strict";e.d(R,{F0:()=>c,bQ:()=>m,lW:()=>p});var n=e(41053),a=e(75505),s=e(78282),l=e(27963),o=e(6219);const d=({sourceUID:h,...r})=>{const g=(0,s.l)().getInstanceSettings(h),y=r.type==="query"?(0,s.l)().getInstanceSettings(r.targetUID):void 0;if((r?.orgId===void 0||r?.orgId===null||r?.orgId===0)&&o.kb.logWarning("Invalid correlation config: Missing org id."),g&&g?.uid!==void 0&&y?.uid!==void 0&&r.type==="query")return{...r,source:g,target:y};if(g&&g?.uid!==void 0&&y?.uid===void 0&&r.type==="external")return{...r,source:g};o.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(g),target:JSON.stringify(y)})},i=h=>!!h,c=h=>({...h,correlations:h.correlations.map(d).filter(i)});function m(h){return h.data}const p=()=>{const{backend:h}=(0,l.Il)(),[r,g]=(0,n.A)(E=>(0,a.s)(h.fetch({url:"/api/datasources/correlations",params:{page:E.page},method:"GET",showErrorAlert:!1})).then(m).then(c),[h]),[y,v]=(0,n.A)(({sourceUID:E,...D})=>h.post(`/api/datasources/uid/${E}/correlations`,D).then(C=>{const P=d(C.result);if(P!==void 0)return P;throw new Error("invalid sourceUID")}),[h]),[x,f]=(0,n.A)(({sourceUID:E,uid:D})=>h.delete(`/api/datasources/uid/${E}/correlations/${D}`),[h]),[u,b]=(0,n.A)(({sourceUID:E,uid:D,...C})=>h.patch(`/api/datasources/uid/${E}/correlations/${D}`,C).then(P=>{const T=d(P.result);if(T!==void 0)return T;throw new Error("invalid sourceUID")}),[h]);return{create:{execute:v,...y},update:{execute:b,...u},get:{execute:g,...r},remove:{execute:f,...x}}}},6219:(Z,R,e)=>{"use strict";e.d(R,{$q:()=>y,J6:()=>g,cA:()=>p,kb:()=>f,tZ:()=>x});var n=e(75505),a=e(79609),s=e(43173),l=e(68143),o=e(78282),d=e(25992),i=e(44720),c=e(46072),m=e(52860);const p=(u,b,E)=>(u.forEach(D=>{const C=D.refId;if(!C)return;let P=E[C];if(P===void 0&&D.meta?.preferredVisualisationType==="rawPrometheus"){const O=(0,i.a)(C);P=E[O]}const T=b.filter(O=>O.source.uid===P);h(D,r(T,D))}),u),h=(u,b)=>{u.fields.forEach(E=>{E.config.links=E.config.links?.filter(D=>D.origin!==a.x0.Correlations)||[],b.map(D=>{if(D.config.field===E.name){if(D.type==="query"){const C=D.config.target||{};E.config.links.push({internal:{query:{...C,datasource:{uid:D.target.uid}},datasourceUid:D.target.uid,datasourceName:D.target.name},url:"",title:D.label||D.target.name,origin:a.x0.Correlations,meta:{transformations:D.config.transformations}})}else if(D.type==="external"){const C=D.config.target;E.config.links.push({url:C.url,title:D.label||"External URL",origin:a.x0.Correlations,meta:{transformations:D.config?.transformations}})}}})})},r=(u,b)=>u.map(E=>{if(E.source.meta?.id==="loki"&&s.$.featureToggles.lokiLogsDataplane===!0&&E.config.field==="Line"){const D=(0,c.Os)(b);D!=null&&D.bodyField.name!==void 0&&(E.config.field=D?.bodyField.name)}return E}),g=async u=>(0,n.s)((0,l.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:u}})).then(m.bQ).then(m.F0),y=async(u,b)=>(0,l.AI)().post(`/api/datasources/uid/${u}/correlations`,b),v=async u=>u.datasourceInstance?.meta.mixed?await(0,o.l)().get(u.queries[0].datasource):u.datasourceInstance,x=async(u,b)=>Promise.all([v(u),v(b)]).then(E=>E[0]?.name!==void 0&&E[1]?.name!==void 0?`${E[0]?.name} to ${E[1]?.name}`:""),f=(0,d.DW)("features.correlations")},11968:(Z,R,e)=>{"use strict";e.d(R,{U:()=>d});var n=e(36674),a=e(29043),s=e(7817),l=e(6262),o=e(9683);function d(i){const c=a.A.getObject(l.us);if(c){console.log("asd",c);const m=new s.G(c.dashboard);for(const p of m.panels){const h=(0,o.tt)(p);i.addPanel(h.state.body)}if(c.dashboard.time){const p=new n.JZ({from:c.dashboard.time.from,to:c.dashboard.time.to}),h=i.state.$timeRange;h&&h.setState({value:p.state.value,from:p.state.from,to:p.state.to})}}a.A.delete(l.us)}},89314:(Z,R,e)=>{"use strict";e.d(R,{x:()=>h});var n=e(74848),a=e(96540),s=e(49785),l=e(92745),o=e(37386),d=e(63527),i=e(87105),c=e(77824);function m(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.branch-validation-error.invalid-branch-name",children:"Invalid branch name."}),(0,n.jsxs)("ul",{style:{padding:"0 20px"},children:[(0,n.jsx)("li",{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.branch-validation-error.cannot-start-with",children:"It cannot start with '/' or end with '/', '.', or whitespace."})}),(0,n.jsx)("li",{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.branch-validation-error.it-cannot-contain-or",children:"It cannot contain '//' or '..'."})}),(0,n.jsx)("li",{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.branch-validation-error.cannot-contain-invalid-characters",children:"It cannot contain invalid characters: '~', '^', ':', '?', '*', '[', '\\\\', or ']'."})}),(0,n.jsx)("li",{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.branch-validation-error.least-valid-character",children:"It must have at least one valid character."})})]})]})}var p=e(92784);const h=(0,a.memo)(({readOnly:r=!1,workflow:g,workflowOptions:y,isGitHub:v,isNew:x,resourceType:f,hidePath:u=!1})=>{const{control:b,register:E,formState:{errors:D}}=(0,s.xW)(),C=f==="dashboard"?"File path inside the repository (.json or .yaml)":"Folder path inside the repository";return(0,n.jsxs)(n.Fragment,{children:[!u&&(0,n.jsx)(o.D,{noMargin:!0,label:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-path","Path"),description:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.description-inside-repository",C),children:(0,n.jsx)(d.p,{id:"dashboard-path",type:"text",...E("path"),readOnly:!x})}),(0,n.jsx)(o.D,{noMargin:!0,label:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-comment","Comment"),children:(0,n.jsx)(i.f,{id:"provisioned-resource-form-comment",...E("comment"),disabled:r,placeholder:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.comment-placeholder-describe-changes-optional","Add a note to describe your changes (optional)"),rows:5})}),v&&!r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.D,{noMargin:!0,label:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-workflow","Workflow"),children:(0,n.jsx)(s.xI,{control:b,name:"workflow",render:({field:{ref:P,...T}})=>(0,n.jsx)(c.z,{id:"provisioned-resource-form-workflow",...T,options:y})})}),g==="branch"&&(0,n.jsx)(o.D,{noMargin:!0,label:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-branch","Branch"),description:(0,l.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.description-branch-name-in-git-hub","Branch name in GitHub"),invalid:!!D.ref,error:D.ref&&(0,n.jsx)(m,{}),children:(0,n.jsx)(d.p,{id:"provisioned-resource-form-branch",...E("ref",{validate:p.e})})})]})]})})},57558:(Z,R,e)=>{"use strict";e.d(R,{p:()=>m});var n=e(92745),a=e(36674),s=e(33143),l=e(55793),o=e(25953),d=e(97335),i=e(92769);function c(h){return h instanceof o.X?"panel":h instanceof d.o?"row":h instanceof i.V?"tab":"element"}class m extends a.Bs{static{this.Component=p}get info(){return(0,n.t)("dashboard.conditional-rendering.root.info","Set rules to control {{type}} visibility by matching any or all rules.",{type:this.getItemType()})}constructor(r){super(r),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.forEachChild(r=>{r.isActive||this._subs.add(r.activate())})}evaluate(){return this.state.rootGroup.evaluate()}notifyChange(){this.parent?.forceRender(),this.parent?.publishEvent(new s.N4(this),!0)}deleteItem(r){a.jh.getAncestor(r,l.M).removeItem(r.state.key)}serialize(){return this.state.rootGroup.serialize()}getItem(){return this.parent}getItemType(){return c(this.getItem())}static createEmpty(){return new m({rootGroup:l.M.createEmpty()})}}function p({model:h}){const{rootGroup:r}=h.useState();return r.render(!1)}},70903:(Z,R,e)=>{"use strict";e.d(R,{G:()=>h});var n=e(74848),a=e(92745),s=e(36674),l=e(41654),o=e(66404),d=e(45967),i=e(30703),c=e(34999),m=e(76319),p=e(57558);class h extends s.Bs{constructor(y){super(y),this.supportedItemTypes=void 0,this.addActivationHandler(()=>this._baseActivationHandler())}_baseActivationHandler(){this.forEachChild(y=>{y.isActive||this._subs.add(y.activate())})}onDelete(){this._getConditionalLogicRoot().deleteItem(this)}render(y=!0){return(0,n.jsx)(r,{model:this,withWrapper:y},this.state.key)}getItem(){return this._getConditionalLogicRoot().getItem()}getItemType(){return this._getConditionalLogicRoot().getItemType()}isItemSupported(){return this.supportedItemTypes?this.supportedItemTypes.includes(this.getItemType()):!0}notifyChange(){this._getConditionalLogicRoot().notifyChange()}setStateAndNotify(y){this.setState(y),this.notifyChange()}_getConditionalLogicRoot(){return s.jh.getAncestor(this,p.p)}}function r({model:g,withWrapper:y}){const v=(0,n.jsx)(g.Component,{model:g},g.state.key);return y?(0,n.jsxs)(l.B,{direction:"column",children:[(0,n.jsxs)(l.B,{direction:"row",gap:1,children:[(0,n.jsx)(o.E,{variant:"bodySmall",children:g.title}),g.info&&(0,n.jsx)(d.m,{content:g.info,children:(0,n.jsx)(i.I,{name:"info-circle"})})]}),(0,n.jsxs)(l.B,{direction:"row",gap:1,justifyContent:"stretch",alignItems:"center",children:[(0,n.jsxs)(l.B,{flex:1,direction:"column",gap:1,children:[v,!g.isItemSupported()&&(0,n.jsx)(c.F,{severity:"error",title:"",children:(0,n.jsx)(a.x6,{i18nKey:"dashboard.conditional-rendering.conditions.shared.unsupported-item-type",children:"This condition is not supported by the element, hence it will be ignored."})})]}),(0,n.jsx)(m.K,{"aria-label":(0,a.t)("dashboard.conditional-rendering.conditions.shared.delete-condition","Delete Condition"),name:"trash-alt",onClick:()=>g.onDelete()})]})]},g.state.key):v}},73816:(Z,R,e)=>{"use strict";e.d(R,{t:()=>c});var n=e(74848),a=e(96540),s=e(92745),l=e(36674),o=e(43243),d=e(25953),i=e(70903);class c extends i.G{constructor(h){super(h),this.supportedItemTypes=["panel"],this.addActivationHandler(()=>this._activationHandler())}static{this.Component=m}static{this.serializer={id:"ConditionalRenderingData",name:"Data",deserialize:this.deserialize}}get title(){return(0,s.t)("dashboard.conditional-rendering.conditions.data.label","Query result")}get info(){return(0,s.t)("dashboard.conditional-rendering.conditions.data.info","Show or hide the {{type}} based on query results.",{type:this.getItemType()})}_activationHandler(){if(!this.isItemSupported())return;const h=this.getItem();if(h instanceof d.X){const r=l.jh.getData(h.state.body);if(!r)return;this._subs.add(r.subscribeToState(()=>this.notifyChange()))}}evaluate(){if(!this.isItemSupported())return!0;const h=this._hasData();return this.state.value&&h||!this.state.value&&!h}serialize(){return{kind:"ConditionalRenderingData",spec:{value:this.state.value}}}_hasData(){const h=this.getItem();let r;if(h instanceof d.X&&(r=l.jh.getData(h.state.body).state.data),!r)return!1;const g=r?.series??[];for(let y=0;y<g.length;y++)if(g[y].length>0)return!0;return!1}static deserialize(h){return new c({value:h.spec.value})}static createEmpty(){return new c({value:!0})}}function m({model:p}){const{value:h}=p.useState(),r=(0,a.useMemo)(()=>[{label:(0,s.t)("dashboard.conditional-rendering.conditions.data.enable","Has data"),value:1},{label:(0,s.t)("dashboard.conditional-rendering.conditions.data.disable","No data"),value:0}],[]),g=(0,a.useMemo)(()=>r.find(y=>!!y.value===h)??r[0],[r,h]);return(0,n.jsx)(o.G,{options:r,value:g,onChange:({value:y})=>p.setStateAndNotify({value:!!y})})}},46415:(Z,R,e)=>{"use strict";e.d(R,{h:()=>c});var n=e(74848),a=e(92745),s=e(41654),l=e(45967),o=e(30703),d=e(25797),i=e(51156);function c(m){if(!m)return null;const p=(0,a.t)("dashboard.conditional-rendering.root.title","Show / hide rules");return new d.C({title:p,id:"conditional-rendering-options",renderTitle:()=>(0,n.jsxs)(s.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{children:p}),(0,n.jsx)(l.m,{content:m.info,children:(0,n.jsx)(o.I,{name:m.evaluate()?"eye":"eye-slash"})})]}),isOpenDefault:!0}).addItem(new i.v({title:p,render:()=>(0,n.jsx)(m.Component,{model:m})}))}},55793:(Z,R,e)=>{"use strict";e.d(R,{M:()=>C});var n=e(74848),a=e(92745),s=e(36674),l=e(41654),o=e(70903),d=e(73816),i=e(96540),c=e(59695);const m=({itemType:T,hasVariables:O,onAdd:I})=>{const j=(0,i.useMemo)(()=>{const W=[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.data","Query result"),value:"data"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.variable","Template variable"),value:"variable",isDisabled:!O},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.time-range-size","Time range less than"),value:"timeRangeSize"}];return T!=="panel"&&W.shift(),W},[T,O]);return(0,n.jsx)(c.i,{isFullWidth:!0,size:"sm",icon:"plus",variant:"secondary",label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.button","Add rule"),options:j,onChange:({value:W})=>I(W)})};var p=e(22803),h=e(63142),r=e(37386),g=e(77824);const y=({value:T,onChange:O})=>{const I=(0,h.of)(v),j=(0,i.useMemo)(()=>[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.all","Match all"),value:"and"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.any","Match any"),value:"or"}],[]);return(0,n.jsx)(r.D,{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.label","Match rules"),className:I.container,children:(0,n.jsx)(g.z,{fullWidth:!0,options:j,value:T,onChange:O})})},v=()=>({container:(0,p.css)({margin:0})});var x=e(2543);const f=({itemType:T,value:O,onChange:I})=>{const j=(0,h.of)(u),W=(0,i.useMemo)(()=>[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.show","Show"),value:"show"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.hide","Hide"),value:"hide"}],[]);return(0,n.jsx)(r.D,{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.label","{{type}} visibility",{type:(0,x.capitalize)(T)}),className:j.container,children:(0,n.jsx)(g.z,{fullWidth:!0,options:W,value:O,onChange:I})})},u=()=>({container:(0,p.css)({margin:0})});var b=e(91135),E=e(75904),D=e(84655);class C extends o.G{static{this.Component=P}static{this.serializer={id:"ConditionalRenderingGroup",name:"Group",deserialize:this.deserialize}}get title(){return(0,a.t)("dashboard.conditional-rendering.conditions.group.label","Group")}get info(){}evaluate(){if(this.state.value.length===0)return!0;const O=this.state.condition==="and"?this.state.value.every(I=>I.evaluate()):this.state.value.some(I=>I.evaluate());return this.state.visibility==="show"?O:!O}changeVisibility(O){this.setStateAndNotify({visibility:O})}changeCondition(O){this.setStateAndNotify({condition:O})}addItem(O){const I=O==="data"?d.t.createEmpty():O==="variable"?E.H.createEmpty(s.jh.getVariables(this).state.variables[0].state.name):b.K.createEmpty();this.setState({value:[...this.state.value,I]}),this.isActive&&!I.isActive&&I.activate(),this.notifyChange()}removeItem(O){this.setStateAndNotify({value:this.state.value.filter(I=>I.state.key!==O)})}serialize(){if(this.state.value.some(O=>O instanceof C))throw new Error("ConditionalRenderingGroup cannot contain nested ConditionalRenderingGroups");return{kind:"ConditionalRenderingGroup",spec:{visibility:this.state.visibility,condition:this.state.condition,items:this.state.value.map(O=>O.serialize()).filter(O=>O.kind!=="ConditionalRenderingGroup")}}}static deserialize(O){return new C({condition:O.spec.condition,visibility:O.spec.visibility,value:O.spec.items.map(I=>{const j=D.k.getIfExists(I.kind);if(!j)throw new Error(`No serializer found for conditional rendering kind: ${I.kind}`);return j.deserialize(I)})})}static createEmpty(){return new C({condition:"and",visibility:"show",value:[]})}}function P({model:T}){const{condition:O,visibility:I,value:j}=T.useState(),{variables:W}=s.jh.getVariables(T).useState();return(0,n.jsxs)(l.B,{direction:"column",gap:2,children:[(0,n.jsx)(f,{itemType:T.getItemType(),value:I,onChange:B=>T.changeVisibility(B)}),j.length>1&&(0,n.jsx)(y,{value:O,onChange:B=>T.changeCondition(B)}),j.map(B=>B.render()),(0,n.jsx)(m,{itemType:T.getItemType(),hasVariables:W.length>0,onAdd:B=>T.addItem(B)})]})}},91135:(Z,R,e)=>{"use strict";e.d(R,{K:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(17548),o=e(92745),d=e(36674),i=e(63142),c=e(37386),m=e(18857),p=e(70903);class h extends p.G{static{this.Component=r}static{this.serializer={id:"ConditionalRenderingTimeRangeSize",name:"Time Range Size",deserialize:this.deserialize}}get title(){return(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.label","Time range less than")}get info(){return(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.info","Show or hide the {{type}} if the dashboard time range is shorter than the selected time frame.",{type:this.getItemType()})}constructor(x){super(x),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this._subs.add(d.jh.getTimeRange(this).subscribeToState(()=>this.notifyChange()))}evaluate(){try{if(!y.test(this.state.value))return!0;const x=l.intervalToSeconds(this.state.value),f=d.jh.getTimeRange(this);if(f.state.value.to.unix()-f.state.value.from.unix()<=x)return!0}catch{return!1}return!1}serialize(){return{kind:"ConditionalRenderingTimeRangeSize",spec:{value:this.state.value}}}static deserialize(x){return new h({value:x.spec.value})}static createEmpty(){return new h({value:"7d"})}}function r({model:v}){const{value:x}=v.useState(),[f,u]=(0,s.useState)(y.test(x)),b=(0,i.of)(g);(0,s.useEffect)(()=>u(y.test(x)),[x]);const E=(0,s.useMemo)(()=>[{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:5}),value:"5m"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:15}),value:"15m"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:30}),value:"30m"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hour","{{value}} hour",{value:1}),value:"1h"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:3}),value:"3h"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:6}),value:"6h"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:12}),value:"12h"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:24}),value:"24h"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:2}),value:"2d"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:7}),value:"7d"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:30}),value:"30d"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:90}),value:"90d"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.months","{{value}} months",{value:6}),value:"6M"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.year","{{value}} year",{value:1}),value:"1y"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.years","{{value}} years",{value:2}),value:"2y"},{label:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.values.years","{{value}} years",{value:5}),value:"5y"}],[]),D=(0,s.useMemo)(()=>E.find(C=>C.value===x)?E:[{label:x,value:x},...E],[E,x]);return(0,n.jsx)(c.D,{invalid:!f,error:(0,o.t)("dashboard.conditional-rendering.conditions.time-range-size.invalid-message","Invalid interval"),className:b.container,children:(0,n.jsx)(m.l6,{isClearable:!1,allowCustomValue:!0,onCreateOption:C=>v.setStateAndNotify({value:C}),value:x,options:D,onChange:({value:C})=>v.setStateAndNotify({value:C})})})}const g=()=>({container:(0,a.css)({margin:0})}),y=/^(\d+(?:\.\d+)?)[Mwdhmsy]$/},75904:(Z,R,e)=>{"use strict";e.d(R,{H:()=>p});var n=e(74848),a=e(96540),s=e(92745),l=e(36674),o=e(41654),d=e(31286),i=e(43243),c=e(63527),m=e(70903);class p extends m.G{constructor(){super(...arguments),this._variableDependency=new l.Sh(this,{onAnyVariableChanged:g=>{g.state.name===this.state.value.name&&this.notifyChange()}})}static{this.Component=h}static{this.serializer={id:"ConditionalRenderingVariable",name:"Variable",deserialize:this.deserialize}}get title(){return(0,s.t)("dashboard.conditional-rendering.conditions.variable.label","Template variable")}get info(){return(0,s.t)("dashboard.conditional-rendering.conditions.variable.info","Show or hide the {{type}} dynamically based on the variable value.",{type:this.getItemType()})}evaluate(){if(!this.state.value.name)return!0;const g=l.jh.getVariables(this).getByName(this.state.value.name);if(!g)return!1;const y=g.getValue()??"",v=Array.isArray(y)?y.includes(this.state.value.value):y===this.state.value.value;return this.state.value.operator==="!="?!v:v}serialize(){return{kind:"ConditionalRenderingVariable",spec:{variable:this.state.value.name,operator:this.state.value.operator==="="?"equals":"notEquals",value:this.state.value.value}}}static deserialize(g){return new p({value:{name:g.spec.variable,operator:g.spec.operator==="equals"?"=":"!=",value:g.spec.value}})}static createEmpty(g){return new p({value:{name:g,operator:"=",value:""}})}}function h({model:r}){const{value:g}=r.useState(),y=(0,a.useMemo)(()=>l.jh.getVariables(r),[r]),v=(0,a.useMemo)(()=>y.state.variables.map(f=>({value:f.state.name,label:f.state.label??f.state.name})),[y.state.variables]),x=(0,a.useMemo)(()=>[{value:"=",description:(0,s.t)("dashboard.conditional-rendering.conditions.variable.operator.equals","Equals")},{value:"!=",description:(0,s.t)("dashboard.conditional-rendering.conditions.variable.operator.not-equals","Not equals")}],[]);return(0,n.jsxs)(o.B,{direction:"column",gap:.5,children:[(0,n.jsxs)(o.B,{direction:"row",gap:.5,grow:1,children:[(0,n.jsx)(d.a,{flex:1,children:(0,n.jsx)(i.G,{placeholder:(0,s.t)("dashboard.conditional-rendering.conditions.variable.name","Name"),options:v,value:g.name,onChange:f=>r.setStateAndNotify({value:{...g,name:f.value}})})}),(0,n.jsx)(i.G,{width:"auto",minWidth:10,options:x,value:g.operator,onChange:f=>r.setStateAndNotify({value:{...g,operator:f.value}})})]}),(0,n.jsx)(c.p,{placeholder:(0,s.t)("dashboard.conditional-rendering.conditions.variable.value","Value"),value:g.value,onChange:f=>r.setStateAndNotify({value:{...g,value:f.currentTarget.value}})})]})}},84655:(Z,R,e)=>{"use strict";e.d(R,{k:()=>d});var n=e(42954),a=e(73816),s=e(55793),l=e(91135),o=e(75904);const d=new n.O(()=>[s.M.serializer,o.H.serializer,a.t.serializer,l.K.serializer])},41116:(Z,R,e)=>{"use strict";e.d(R,{H:()=>p});var n=e(74848),a=e(57558),s=e(22803),l=e(92745),o=e(63142),d=e(45967),i=e(30703);const c=()=>{const h=(0,o.of)(m);return(0,n.jsx)("div",{className:h.container,children:(0,n.jsx)(d.m,{content:(0,l.t)("dashboard.conditional-rendering.overlay.tooltip","Element is hidden due to conditional rendering."),children:(0,n.jsx)(i.I,{name:"eye-slash"})})})},m=h=>({container:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",width:"100%",height:"100%",bottom:0,right:0,zIndex:1,[h.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease"},"&:before":(0,s.css)({content:'""',opacity:.6,position:"absolute",width:"100%",height:"100%",top:0,left:0,backgroundColor:h.colors.background.canvas,pointerEvents:"none"}),"& > svg":(0,s.css)({height:"48px",width:"48px",maxWidth:"75%",maxHeight:"75%"}),".dashboard-visible-hidden-element:hover > &":(0,s.css)({width:"30px",height:"30px",top:"unset",left:"unset",right:0,bottom:0})})});function p(h){const r=h.useState();if(!("conditionalRendering"in r)||!(r.conditionalRendering instanceof a.p))return[!1,void 0,null];const g=r.conditionalRendering.evaluate()??!0;return[!g,g?void 0:"dashboard-visible-hidden-element",g?null:(0,n.jsx)(c,{})]}},33143:(Z,R,e)=>{"use strict";e.d(R,{N4:()=>be,BF:()=>Oe,WG:()=>we,jO:()=>ye,ck:()=>pe,su:()=>ve,cc:()=>ze,wT:()=>le,JU:()=>Ve,dt:()=>Xe});var n=e(88544),a=e(68388),s=e(92745),l=e(36674),o=e(72746),d=e(74848),i=e(96540),c=e(51898),m=e(63527),p=e(34999),h=e(89640),r=e(25797),g=e(51156),y=e(31819),v=e(9931),x=e(18615),f=e(8285),u=e(1131),b=e(87308);class E{constructor(Ke){this._row=Ke,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.row","Row"),instanceName:l.jh.interpolate(this._row,this._row.state.title,void 0,"text"),icon:"list-ul"}}getOutlineChildren(){return this._row.state.children}useEditPaneOptions(){const Ke=this._row,qe=(0,i.useMemo)(()=>new r.C({title:(0,s.t)("dashboard.default-layout.row-options.title","Row options"),id:"row-options",isOpenDefault:!0}).addItem(new g.v({title:(0,s.t)("dashboard.default-layout.row-options.form.title","Title"),render:()=>(0,d.jsx)(D,{row:Ke})})),[Ke]),ot=(0,i.useMemo)(()=>{const lt=(0,f.YQ)(Ke);return new r.C({title:(0,s.t)("dashboard.default-layout.row-options.repeat.title","Repeat options"),id:"row-repeat-options",isOpenDefault:!0}).addItem(new g.v({title:(0,s.t)("dashboard.default-layout.row-options.repeat.variable.title","Variable"),render:()=>(0,d.jsx)(C,{row:Ke,dashboard:lt})}))},[Ke]);return[qe,ot]}onDelete(){const Ke=(0,f.h$)(this._row);Ke instanceof u.D&&Ke.removeRow(this._row)}}function D({row:ge}){const{title:Ke}=ge.useState();return(0,d.jsx)(m.p,{value:Ke,onChange:qe=>ge.setState({title:qe.currentTarget.value})})}function C({row:ge,dashboard:Ke}){const{$behaviors:qe,children:ot}=ge.useState();let lt=qe?.find(Tt=>Tt instanceof b.L);const Lt=(0,i.useMemo)(()=>ot.reduce((Tt,It)=>[...Tt,...l.jh.findDescendents(It,l.Eb)],[]),[ot]).some(Tt=>{const It=(0,f.un)(Tt);return It?.state.datasource?.uid===v.K||It?.state.datasource?.uid===x.uv&&It?.state.queries.some(Mt=>Mt.datasource?.uid===v.K)});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(y.U,{sceneContext:Ke,repeat:lt?.state.variableName,onChange:Tt=>{Tt?(lt?.removeBehavior(),lt=new b.L({variableName:Tt}),ge.setState({$behaviors:[...ge.state.$behaviors??[],lt]})):lt?.removeBehavior()}}),Lt?(0,d.jsxs)(p.F,{"data-testid":c.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,d.jsx)("p",{children:(0,d.jsxs)(s.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.warning.text",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:v.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,d.jsx)(h.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.learn-more",children:"Learn more"})})]}):void 0]})}var P=e(95395);function T(ge){return"isEditableDashboardElement"in ge}var O=e(31286),I=e(41654);class j{constructor(Ke){this.variable=Ke,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.local-variable","Local variable"),icon:"dollar-alt",instanceName:`\xA0$${this.variable.state.name} = ${this.variable.getValueText()}`,isHidden:!0}}useEditPaneOptions(){const Ke=this.variable;return(0,i.useMemo)(()=>{const qe=new r.C({title:"",id:"local-variable-options"});return qe.addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(O.a,{paddingBottom:1,children:(0,d.jsx)(I.B,{children:(0,d.jsxs)(I.B,{children:[(0,d.jsxs)("span",{children:["$",Ke.state.name]}),(0,d.jsx)("span",{children:"="}),(0,d.jsx)("span",{children:Ke.getValueText()})]})})})})),[qe]},[Ke])}}var W=e(7389),B=e(36490),S=e(37386),w=e(87105),N=e(45861),M=e(20246),L=e(29),A=e(44741),U=e(21285);function F(ge){return(0,i.useMemo)(()=>new r.C({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.category","Selection options"),id:"selection-options-category",isOpenDefault:!0}).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.multi-value","Multi-value"),render:()=>(0,d.jsx)(V,{variable:ge})})).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.include-all","Include All value"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.include-all-description","Enables a single option that represent all values"),render:()=>(0,d.jsx)(K,{variable:ge})})).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.custom-all-value","Custom all value"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.custom-all-value-description","A wildcard regex or other value to represent All"),useShowIf:()=>ge.useState().includeAll??!1,render:()=>(0,d.jsx)(H,{variable:ge})})).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.allow-custom-values","Allow custom values"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.allow-custom-values-description","Enables users to enter values"),render:()=>(0,d.jsx)(G,{variable:ge})})),[ge])}function V({variable:ge}){const{isMulti:Ke}=ge.useState();return(0,d.jsx)(U.d,{value:Ke,onChange:qe=>ge.setState({isMulti:qe.currentTarget.checked})})}function K({variable:ge}){const{includeAll:Ke}=ge.useState();return(0,d.jsx)(U.d,{value:Ke,onChange:qe=>ge.setState({includeAll:qe.currentTarget.checked})})}function G({variable:ge}){const{allowCustomValue:Ke}=ge.useState();return(0,d.jsx)(U.d,{value:Ke,onChange:qe=>ge.setState({allowCustomValue:qe.currentTarget.checked})})}function H({variable:ge}){const{allValue:Ke}=ge.useState(),qe=(0,i.useRef)(null),ot=(0,i.useCallback)(lt=>{const mt=lt.currentTarget.value;mt!==ge.state.allValue&&(ge.setState({allValue:mt}),ge.hasAllValue()&&ge.publishEvent(new l.oh(ge),!0))},[ge]);return(0,d.jsx)(m.p,{ref:qe,defaultValue:Ke??"",onBlur:ot})}class _{constructor(Ke){this.variable=Ke,this.isEditableDashboardElement=!0,this.typeName="Variable"}getEditableElementInfo(){if(this.variable instanceof l.xc)return{typeName:(0,s.t)("dashboard.edit-pane.elements.local-variable","Local variable"),icon:"dollar-alt",instanceName:this.variable.state.name,isHidden:!0};const Ke=(0,A.IO)(this.variable.state.type);return{typeName:(0,s.t)("dashboard.edit-pane.elements.variable","{{type}} variable",{type:Ke.name}),icon:"dollar-alt",instanceName:this.variable.state.name,isHidden:this.variable.state.hide===W.zL.hideVariable}}useEditPaneOptions(Ke){const qe=this.variable;if(qe instanceof l.xc)return q(qe);const lt=[(0,i.useMemo)(()=>new r.C({title:"",id:"variable-options"}).addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(k,{variable:qe,isNewElement:Ke})})).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.label","Label"),description:(0,s.t)("dashboard.edit-pane.variable.label-description","Optional display name"),render:()=>(0,d.jsx)(J,{variable:qe})})).addItem(new g.v({title:(0,s.t)("dashboard.edit-pane.variable.description","Description"),render:()=>(0,d.jsx)(z,{variable:qe})})).addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(Y,{variable:qe})})),[qe,Ke])],mt=X(qe);return lt.push(mt),qe instanceof l.n8&&lt.push(F(qe)),lt}onDelete(){const Ke=this.variable.parent;Ke instanceof l.Pj&&ze.removeVariable({source:Ke,removedObject:this.variable})}onChangeName(Ke){this.variable.setState({name:Ke});const qe=(0,A.c$)(this.variable,Ke);if(qe.errorMessage)return qe}}function k({variable:ge,isNewElement:Ke}){const{name:qe}=ge.useState(),ot=(0,M.z4)({autoFocus:Ke}),[lt,mt]=(0,i.useState)(),[Lt,Tt]=(0,i.useState)(ge.state.name),It=Ut=>{const an=(0,A.c$)(ge,Ut.currentTarget.value);an.errorMessage!==lt?mt(an.errorMessage):Tt(ge.state.name),ge.setState({name:Ut.currentTarget.value})},Mt=()=>{lt&&(ge.setState({name:Lt}),mt(void 0))};return(0,d.jsx)(S.D,{label:(0,s.t)("dashboard.edit-pane.variable.name","Name"),invalid:!!lt,error:lt,children:(0,d.jsx)(m.p,{ref:ot,value:qe,onChange:It,required:!0,onBlur:Mt,"data-testid":c.Tp.components.PanelEditor.ElementEditPane.variableNameInput})})}function J({variable:ge}){const{label:Ke}=ge.useState();return(0,d.jsx)(m.p,{value:Ke,onChange:qe=>ge.setState({label:qe.currentTarget.value}),"data-testid":c.Tp.components.PanelEditor.ElementEditPane.variableLabelInput})}function z({variable:ge}){const{description:Ke}=ge.useState();return(0,d.jsx)(w.f,{id:"description-text-area",value:Ke??"",placeholder:(0,s.t)("dashboard.edit-pane.variable.description-placeholder","Descriptive text"),onChange:qe=>ge.setState({description:qe.currentTarget.value})})}function Y({variable:ge}){const{hide:Ke=W.zL.dontHide}=ge.useState(),qe=ot=>{ge.setState({hide:ot})};return(0,d.jsx)(L.D,{hide:Ke,type:ge.state.type,onChange:qe})}function X(ge){return(0,i.useMemo)(()=>{const Ke=(0,A.IO)(ge.state.type),qe=(0,s.t)("dashboard.edit-pane.variable.type-category","{{type}} options",{type:Ke.name}),ot=new r.C({title:qe,id:"variable-type",isOpenDefault:!0});return Ke.getOptions?Ke.getOptions(ge).forEach(mt=>ot.addItem(mt)):ot.addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(Q,{variable:ge})})),ot},[ge])}function Q({variable:ge}){const Ke=()=>{const qe=ge.parent;if(!(qe instanceof l.Pj))return;const ot=qe.state.variables.indexOf(ge);B.Ny.partial({editview:"variables",editIndex:ot})};return(0,d.jsx)(O.a,{display:"flex",direction:"column",paddingBottom:1,children:(0,d.jsx)(N.$n,{tooltip:(0,s.t)("dashboard.edit-pane.variable.open-editor-tooltip","For more variable options open variable editor"),onClick:Ke,size:"sm",fullWidth:!0,children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variable.open-editor",children:"Open variable editor"})})})}function q(ge){return(0,i.useMemo)(()=>{const Ke=new r.C({title:"",id:"local-variable-options"});return Ke.addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(O.a,{paddingBottom:1,children:(0,d.jsx)(I.B,{children:(0,d.jsxs)(I.B,{children:[(0,d.jsxs)("span",{children:["$",ge.state.name]}),(0,d.jsx)("span",{children:"="}),(0,d.jsx)("span",{children:ge.getValueText()})]})})})})),[Ke]},[ge])}var te=e(22803),ne=e(42941),se=e(63142),ue=e(66404),de=e(8073);class ie{constructor(Ke){this.set=Ke,this.isEditableDashboardElement=!0,this.typeName="Variable"}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.variable-set","Variables"),icon:"x",instanceName:(0,s.t)("dashboard.edit-pane.elements.variable-set","Variables")}}getOutlineChildren(){return this.set.state.variables}useEditPaneOptions(){const Ke=this.set;return[(0,i.useMemo)(()=>new r.C({title:"",id:"variables"}).addItem(new g.v({title:"",skipField:!0,render:()=>(0,d.jsx)(he,{set:Ke})})),[Ke])]}}function he({set:ge}){const{variables:Ke}=ge.useState(),qe=(0,se.of)(ce),[ot,lt]=(0,ne.A)(!1),mt=ge.parent instanceof o.H$,Lt=It=>{const{editPane:Mt}=(0,f.YQ)(ge).state;Mt.selectObject(It,It.state.key)},Tt=It=>{const{variables:Mt}=ge.state,Ut=(0,A.e_)(It,Mt),an=(0,A.No)(It,{name:Ut});ze.addVariable({source:ge,addedObject:an}),lt(!1)};return ot?(0,d.jsx)(me,{onAddVariable:Tt}):(0,d.jsxs)(I.B,{direction:"column",gap:0,children:[Ke.map(It=>(0,d.jsxs)("div",{className:qe.variableItem,onClick:()=>Lt(It),children:[(0,d.jsxs)(ue.E,{children:["$",It.state.name]}),(0,d.jsx)(I.B,{direction:"row",gap:1,alignItems:"center",children:(0,d.jsx)(N.$n,{variant:"primary",size:"sm",fill:"outline",children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.select-variable",children:"Select"})})})]},It.state.name)),mt&&(0,d.jsx)(O.a,{paddingBottom:1,display:"flex",children:(0,d.jsx)(N.$n,{fullWidth:!0,icon:"plus",size:"sm",variant:"secondary",onClick:lt,"data-testid":c.Tp.components.PanelEditor.ElementEditPane.addVariableButton,children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.add-variable",children:"Add variable"})})})]})}function me({onAddVariable:ge}){const Ke=(0,A.B$)(),qe=(0,se.of)(ce);return(0,d.jsxs)(I.B,{direction:"column",gap:0,children:[(0,d.jsx)(O.a,{paddingBottom:1,display:"flex",children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.select-type",children:"Choose variable type"})}),Ke.map(ot=>(0,d.jsxs)(de.Z,{isCompact:!0,onClick:()=>ge(ot.value),title:(0,s.t)("dashboard.edit-pane.variables.select-type-card-tooltip","Click to select type"),"data-testid":c.Tp.components.PanelEditor.ElementEditPane.variableType(ot.value),children:[(0,d.jsx)(de.Z.Heading,{children:ot.label}),(0,d.jsx)(de.Z.Description,{className:qe.cardDescription,children:ot.description})]},ot.value))]})}function ce(ge){return{variableItem:(0,te.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",gap:ge.spacing(1),padding:ge.spacing(.5),borderRadius:ge.shape.radius.default,cursor:"pointer",[ge.transitions.handleMotion("no-preference","reduce")]:{transition:ge.transitions.create(["color"],{duration:ge.transitions.duration.short})},"&:last-child":{marginBottom:ge.spacing(2)},button:{visibility:"hidden"},"&:hover":{color:ge.colors.text.link,button:{visibility:"visible"}}}),cardDescription:(0,te.css)({fontSize:ge.typography.bodySmall.fontSize,marginTop:ge.spacing(0)})}}var Pe=e(44802),Ie=e(30703);const Se=({dashboard:ge})=>(0,d.jsx)(N.$n,{size:"sm",variant:"secondary",tooltip:(0,s.t)("dashboard.toolbar.new.edit-dashboard-v2-schema.tooltip","Edit dashboard v2 schema"),icon:(0,d.jsx)(Ie.I,{name:"brackets-curly",size:"lg",type:"default"}),onClick:()=>ge.openV2SchemaEditor()});class Me{constructor(Ke){this.dashboard=Ke,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.dashboard","Dashboard"),icon:"apps",instanceName:(0,s.t)("dashboard.edit-pane.elements.dashboard","Dashboard")}}getOutlineChildren(){const{$variables:Ke,body:qe}=this.dashboard.state;return[Ke,...qe.getOutlineChildren()]}useEditPaneOptions(){const Ke=this.dashboard,{body:qe}=Ke.useState(),ot=(0,i.useMemo)(()=>{const mt="dashboard-title-input",Lt="dashboard-description-input";return new r.C({title:"",id:"dashboard-options"}).addItem(new g.v({title:(0,s.t)("dashboard.options.title-option","Title"),id:mt,render:()=>(0,d.jsx)(Te,{id:mt,dashboard:Ke})})).addItem(new g.v({title:(0,s.t)("dashboard.options.description","Description"),id:Lt,render:()=>(0,d.jsx)(Ge,{id:Lt,dashboard:Ke})}))},[Ke]),lt=(0,Pe.W)(qe);return[ot,...lt]}renderActions(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Se,{dashboard:this.dashboard}),(0,d.jsx)(N.$n,{variant:"secondary",size:"sm",onClick:()=>this.dashboard.onOpenSettings(),tooltip:(0,s.t)("dashboard.toolbar.dashboard-settings.tooltip","Dashboard settings"),icon:"sliders-v-alt",iconPlacement:"right",children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.actions.open-settings",children:"Settings"})})]})}}function Te({dashboard:ge,id:Ke}){const{title:qe}=ge.useState(),ot=(0,i.useRef)("");return(0,d.jsx)(m.p,{id:Ke,value:qe,onChange:lt=>{ge.setState({title:lt.currentTarget.value})},onFocus:lt=>{ot.current=lt.currentTarget.value},onBlur:lt=>{ot.current===lt.currentTarget.value||Ve(lt)||ze.changeTitle({source:ge,oldTitle:ot.current,newTitle:lt.currentTarget.value})}})}function Ge({dashboard:ge,id:Ke}){const{description:qe}=ge.useState(),ot=(0,i.useRef)("");return(0,d.jsx)(w.f,{id:Ke,value:qe,onChange:lt=>ge.setState({description:lt.currentTarget.value}),onFocus:lt=>{ot.current=lt.currentTarget.value},onBlur:lt=>{ot.current===lt.currentTarget.value||Ve(lt)||ze.changeDescription({source:ge,oldDescription:ot.current,newDescription:lt.currentTarget.value})}})}var Qe=e(73427),tt=e(87745),ke=e(22175),He=e(25953),Re=e(93389),Ne=e(3688),Ae=e(1682),Ue=e(24726);class Be{constructor(Ke){this._panels=Ke,this.isEditableDashboardElement=!0,this.key=(0,Ue.A)()}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.panels","Panels"),icon:"folder",instanceName:""}}useEditPaneOptions(){return[new r.C({title:"",id:""})]}onConfirmDelete(){Qe.lE.publish(new tt.bY({title:(0,s.t)("dashboard.edit-pane.elements.multiple-panels","Multiple panels"),text:(0,s.t)("dashboard.edit-pane.elements.multiple-panels-delete-text","Are you sure you want to delete these panels? All queries will be removed."),onConfirm:()=>this.onDelete()}))}onDelete(){this._panels.forEach(Ke=>{Ke.onDelete()})}}class We{constructor(Ke){this.panel=Ke,this.isEditableDashboardElement=!0,this.typeName="Panel"}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.panel","Panel"),icon:"chart-line",instanceName:l.jh.interpolate(this.panel,this.panel.state.title,void 0,"text")}}useEditPaneOptions(Ke){const qe=this.panel,ot=qe.parent,lt=(0,i.useMemo)(()=>new r.C({title:"",id:"panel-options"}).addItem(new g.v({title:"",render:()=>(0,d.jsx)(_e,{panel:this.panel})})).addItem(new g.v({title:(0,s.t)("dashboard.viz-panel.options.title-option","Title"),id:"PanelFrameTitle",value:qe.state.title,popularRank:1,render:Lt=>(0,d.jsx)(ke.m,{id:Lt.props.id,panel:qe,isNewElement:Ke})})).addItem(new g.v({title:(0,s.t)("dashboard.viz-panel.options.description","Description"),id:"description-text-area",value:qe.state.description,render:Lt=>(0,d.jsx)(ke.dF,{id:Lt.props.id,panel:qe})})).addItem(new g.v({title:(0,s.t)("dashboard.viz-panel.options.transparent-background","Transparent background"),id:"transparent-background",render:Lt=>(0,d.jsx)(ke.R4,{id:Lt.props.id,panel:qe})})),[qe,Ke]),mt=(0,i.useMemo)(()=>(0,Ne.y)(ot)&&ot.getOptions?ot.getOptions():[],[ot]);return[lt,...mt]}onDelete(){Ae.b4.getLayoutManagerFor(this.panel).removePanel?.(this.panel)}onConfirmDelete(){Qe.lE.publish(new tt.bY({title:(0,s.t)("dashboard.viz-panel.delete-panel-title","Delete panel?"),text:(0,s.t)("dashboard.viz-panel.delete-panel-text","Deleting this panel will also remove all queries. Are you sure you want to continue?"),yesText:(0,s.t)("dashboard.viz-panel.delete-panel-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}onDuplicate(){Ae.b4.getLayoutManagerFor(this.panel).duplicatePanel?.(this.panel)}onCopy(){(0,f.YQ)(this.panel).copyPanel(this.panel)}onChangeName(Ke){(0,ke.dJ)(this.panel,Ke)}createMultiSelectedElement(Ke){return new Be(Ke)}scrollIntoView(){(this.panel.parent instanceof He.X||this.panel.parent instanceof Re.U)&&this.panel.parent.scrollIntoView()}}const _e=({panel:ge})=>(0,d.jsx)(I.B,{alignItems:"center",width:"100%",children:(0,d.jsx)(N.$n,{onClick:()=>{B.Ny.partial({editPanel:(0,f.Cs)(ge)})},icon:"sliders-v-alt",fullWidth:!0,size:"sm",tooltip:(0,s.t)("dashboard.viz-panel.options.configure-button-tooltip","Edit queries and visualization options"),children:(0,d.jsx)(s.x6,{i18nKey:"dashboard.new-panel.configure-button",children:"Configure"})})});function Xe(){return(0,n.A)("grafana.dashboards.edit-pane.isCollapsed",!1)}function le(ge){if(ge){if(T(ge))return ge;if(ge instanceof l.Eb)return new We(ge);if(ge instanceof l.tI)return new E(ge);if(ge instanceof o.H$)return new Me(ge);if(ge instanceof l.Pj)return new ie(ge);if(ge instanceof l.xc)return new j(ge);if((0,A.VD)(ge))return new _(ge)}}class ye extends a.x{static{this.type="new-object-added-to-canvas"}}class pe extends a.x{static{this.type="object-removed-from-canvas"}}class ve extends a.x{static{this.type="objects-reordered-on-canvas"}}class be extends a.x{static{this.type="conditional-rendering-changed"}}class Oe extends a.x{static{this.type="dashboard-edit-action"}}class we extends a.x{static{this.type="dashboard-state-changed"}}const ze={edit(ge){ge.source.publishEvent(new Oe(ge),!0)},addElement(ge){const{addedObject:Ke,source:qe,perform:ot,undo:lt}=ge,mt=le(Ke);if(!mt)throw new Error("Added object is not an editable element");const Lt=mt.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.add","Add {{typeName}}",{typeName:Lt}),addedObject:Ke,source:qe,perform:ot,undo:lt})},removeElement(ge){const{removedObject:Ke,source:qe,perform:ot,undo:lt}=ge,mt=le(Ke);if(!mt)throw new Error("Removed object is not an editable element");const Lt=mt.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.remove","Remove {{typeName}}",{typeName:Lt}),removedObject:Ke,source:qe,perform:ot,undo:lt})},addVariable({source:ge,addedObject:Ke}){const qe=[...ge.state.variables];ze.addElement({source:ge,addedObject:Ke,perform(){ge.setState({variables:[...qe,Ke]})},undo(){ge.setState({variables:[...qe]})}})},removeVariable({source:ge,removedObject:Ke}){const qe=[...ge.state.variables];ze.removeElement({source:ge,removedObject:Ke,perform(){ge.setState({variables:qe.filter(ot=>ot!==Ke)})},undo(){ge.setState({variables:qe})}})},changeTitle({source:ge,oldTitle:Ke,newTitle:qe}){ze.edit({description:(0,s.t)("dashboard.title.action","Change dashboard title"),source:ge,perform:()=>{ge.setState({title:qe})},undo:()=>{ge.setState({title:Ke})}})},changeDescription({source:ge,oldDescription:Ke,newDescription:qe}){ze.edit({description:(0,s.t)("dashboard.description.action","Change dashboard description"),source:ge,perform:()=>{ge.setState({description:qe})},undo:()=>{ge.setState({description:Ke})}})},moveElement(ge){const{movedObject:Ke,source:qe,perform:ot,undo:lt}=ge,mt=le(Ke);if(!mt)throw new Error("Moved object is not an editable element");const Lt=mt.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.move","Move {{typeName}}",{typeName:Lt}),movedObject:Ke,source:qe,perform:ot,undo:lt})}};function Ve(ge){return ge.relatedTarget&&(ge.relatedTarget.id===P.Qk||ge.relatedTarget.id===P.aS)}},34273:(Z,R,e)=>{"use strict";e.d(R,{W:()=>s});var n=e(95004);function a(){const l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o="abcdefghijklmnopqrstuvwxyz",d=l.length,i=new Map;return c=>{const m=i.get(c);if(m!=null)return m;const p=[...c].map(h=>h.toLowerCase()&&h!==h.toUpperCase()?o.charAt(Math.floor(Math.random()*d)):h.toUpperCase()&&h!==h.toUpperCase()?l.charAt(Math.floor(Math.random()*d)):h).join("");return i.set(c,p),p}}function s(l,o){if(!(o.labels||o.names||o.values))return l;const d=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),i=a();return l.map(c=>{let{schema:m,data:p}=c;if(m&&p){if(o.labels){for(const h of m.fields)if(h.labels){const r={};for(const[g,y]of Object.entries(h.labels))r[g]=i(y);h.labels=r}}if(o.names)for(const h of m.fields)h.name?.length&&!d.has(h.name.toLowerCase())&&(h.name=i(h.name));o.values&&m.fields.forEach((h,r)=>{if(h.type===n.PU.string&&p){const g=p.values[r].map(y=>i(String(y)));p.values[r]=g}})}return{schema:m,data:p}})}},41644:(Z,R,e)=>{"use strict";e.d(R,{m6:()=>j,sP:()=>M});var n=e(92138),a=e(92745),s=e(68143),l=e(36490),o=e(43173),d=e(36674),i=e(64975),c=e(5114),m=e(47797),p=e(60017),h=e(75735),r=e(50803),g=e(95407),y=e(60171),v=e(48600),x=e(22429),f=e(83127),u=e(95710),b=e(6262),E=e(84019),D=e(31119),C=e(9683),P=e(17788),T=e(75570);const O=500,I="loadDashboardScene",j="__grafana_home_uid__";class W extends c.Q{constructor(){super(...arguments),this.cache={}}getCache(){return this.cache}async fetchHomeDashboard(){const A=await(0,s.AI)().get("/api/dashboards/home");if((0,b.U)(A)){const U=n.I.stripBaseFromUrl(A.redirectUri);return l.Ny.replace(U),null}return(0,y.aK)(A.dashboard)&&(A.dashboard=(0,r.Sb)(A.dashboard,{name:"",generation:0,resourceVersion:"0",creationTimestamp:""})),A?.meta&&(A.meta.canSave=!1,A.meta.canShare=!1,A.meta.canStar=!1),A}async loadHomeDashboard(){const A=await this.fetchHomeDashboard();return A?(0,C.wM)(A):null}async loadSnapshot(A){try{const U=await this.loadSnapshotScene(A);this.setState({dashboard:U,isLoading:!1})}catch(U){const F=(0,m.do)(U),V=(0,m.q6)(U),K=(0,m.rE)(U);if(this.setState({isLoading:!1,loadError:{status:F,message:V,messageId:K}}),U instanceof g.P)throw U}}async loadProvisioningDashboard(A,U){const V=new URLSearchParams(window.location.search).get("ref")??void 0,K=`${i.C}/repositories/${A}/files/${U}`;return(0,s.AI)().get(K,V?{ref:V}:void 0).then(G=>{const H=G.resource.dryRun;return H?H.apiVersion.startsWith("dashboard.grafana.app")?this.processDashboardFromProvisioning(A,U,H,{file:K,ref:V,repo:A}):Promise.reject("unexpected resource type: "+H.apiVersion):Promise.reject("failed to read provisioned dashboard")})}processDashboardFromProvisioning(A,U,F,V){if(F.apiVersion.split("/")[1]==="v2alpha1")return{...F,kind:"DashboardWithAccessInfo",access:{canStar:!1,isSnapshot:!1,canShare:!1,canDelete:!0,canSave:!0,canEdit:!0}};let K=F.metadata.annotations;return K||(F.metadata.annotations={}),K[h.LH]="repo",K[h.Jw]=A,K[h.Y_]=V.ref?U+"#"+V.ref:U,{meta:{canStar:!1,isSnapshot:!1,canShare:!1,canDelete:!0,canSave:!0,canEdit:!0,k8s:F.metadata,provisioning:V},dashboard:F.spec}}async loadDashboard(A){try{(0,p.j)(I);const U=await this.loadScene(A);if(!U)return;o.$.featureToggles.preserveDashboardStateWhenNavigating&&A.uid&&(0,P.Gq)(U),this.setState({dashboard:U,isLoading:!1});const F=(0,p.z)(I),V=d.jh.getQueryController(U);(0,u.Dd)(U,F?.duration),V?.startProfile("DashboardScene"),A.route!==b.Z4.New&&(0,f.B)({meta:U.state.meta,uid:U.state.uid,title:U.state.title,id:U.state.id})}catch(U){const F=(0,m.do)(U),V=(0,m.q6)(U),K=(0,m.rE)(U);if(this.setState({isLoading:!1,loadError:{status:F,message:V,messageId:K}}),(0,s.NF)(U)||console.error("Error loading dashboard:",U),U instanceof g.P)throw U}}async loadScene(A){if(this.setState({dashboard:void 0,isLoading:!0}),A.route===b.Z4.Home)return await this.loadHomeDashboard();const U=await this.fetchDashboard(A);return U?this.transformResponseToScene(U,A):null}getDashboardFromCache(A){const U=this.dashboardCache;return U&&U.cacheKey===A&&Date.now()-U?.ts<O?U.dashboard:null}clearState(){(0,x.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(A,U){this.dashboardCache={dashboard:U,ts:Date.now(),cacheKey:A}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(A){return this.cache[A]}setSceneCache(A,U){this.cache[A]=U}clearSceneCache(){this.cache={}}}class B extends W{transformResponseToScene(A,U){const F=this.getSceneFromCache(U.uid);if(F&&F.state.version===A?.dashboard.version&&F.state.meta.created===A?.meta.created)return F;if(A?.dashboard){const V=(0,C.wM)(A);return U.uid&&this.setSceneCache(U.uid,V),V}throw new Error("Dashboard not found")}async loadSnapshotScene(A){const U=await v.np.loadSnapshot(A);if(U?.dashboard)return(0,C.wM)(U);throw new Error("Snapshot not found")}async fetchDashboard({type:A,slug:U,uid:F,route:V,urlFolderUid:K}){const G=V===b.Z4.Home?j:F,H=this.getDashboardFromCache(G);if(H)return H;let _;try{switch(V){case b.Z4.Home:const k=await this.fetchHomeDashboard();if(!k)return null;_=k;break;case b.Z4.New:_=await(0,E.X)(K);break;case b.Z4.Provisioning:return this.loadProvisioningDashboard(U||"",F);case b.Z4.Public:return await v.np.loadDashboard("public","",F);default:_=await v.np.loadDashboard(A||"db",U||"",F),V===b.Z4.Embedded&&(_.meta.isEmbedded=!0)}if(_.meta.url&&V===b.Z4.Normal){const k=n.I.stripBaseFromUrl(_.meta.url),J=l.Ny.getLocation().pathname;k!==J&&(l.Ny.replace({...l.Ny.getLocation(),pathname:k}),console.log("not correct url correcting",k,J))}_.meta.folderUid&&await(0,T.Q)(_.meta.folderUid),this.setDashboardCache(G,_)}catch(k){if((0,s.NF)(k)&&k.cancelled)return null;throw k}return _}async reloadDashboard(A){const U=this.state.dashboard;if(!U||!U.state.uid)return;const F=U.state.uid;try{this.setState({isLoading:!0});const V=await v.np.loadDashboard("db",U.state.meta.slug,F,A),K=this.getSceneFromCache(F);if(K&&K.state.version===V?.dashboard.version&&K.state.version===this.state.dashboard?.state.version){this.setState({isLoading:!1});return}if(!V?.dashboard){this.setState({isLoading:!1,loadError:{status:404,message:(0,a.t)("dashboard-scene.dashboard-scene-page-state-manager.message.dashboard-not-found","Dashboard not found")}});return}const G=(0,C.wM)(V);o.$.featureToggles.preserveDashboardStateWhenNavigating&&F&&(0,P.Gq)(G),this.setSceneCache(F,G),this.setState({dashboard:G,isLoading:!1})}catch(V){const K=(0,m.do)(V),G=(0,m.q6)(V);if(this.setState({isLoading:!1,loadError:{message:G,status:K}}),V instanceof g.P)throw V}}}class S extends W{constructor(){super(...arguments),this.dashboardLoader=new v.t0}async loadSnapshotScene(A){const U=await this.dashboardLoader.loadSnapshot(A);if(U?.spec)return(0,D.dj)(U);throw new Error("Snapshot not found")}transformResponseToScene(A,U){const F=this.getSceneFromCache(U.uid);if(F&&F.state.version===A?.metadata.generation)return F;if(A){const V=(0,D.dj)(A);return U.uid&&this.setSceneCache(U.uid,V),V}throw new Error("Dashboard not found")}async fetchDashboard({type:A,slug:U,uid:F,route:V,urlFolderUid:K}){const G=V===b.Z4.Home?j:F,H=this.getDashboardFromCache(G);if(H)return H;let _;try{switch(V){case b.Z4.New:_=await(0,E.V)(K);break;case b.Z4.Provisioning:return await this.loadProvisioningDashboard(U||"",F);case b.Z4.Public:return await this.dashboardLoader.loadDashboard("public","",F);default:if(_=await this.dashboardLoader.loadDashboard(A||"db",U||"",F),V===b.Z4.Embedded)throw new Error("Method not implemented.")}if(_.access.url&&V===b.Z4.Normal){const k=n.I.stripBaseFromUrl(_.access.url),J=l.Ny.getLocation().pathname;k!==J&&(l.Ny.replace({...l.Ny.getLocation(),pathname:k}),console.log("not correct url correcting",k,J))}_.metadata.annotations?.[h.ew]&&await(0,T.Q)(_.metadata.annotations?.[h.ew]),this.setDashboardCache(G,_)}catch(k){if((0,s.NF)(k)&&k.cancelled)return null;throw k}return _}async reloadDashboard(A){const U=this.state.dashboard;if(!U||!U.state.uid)return;const F=U.state.uid;try{this.setState({isLoading:!0});const V=await this.dashboardLoader.loadDashboard("db",U.state.meta.slug,F,A),K=this.getSceneFromCache(F);if(K&&K.state.version===V?.metadata.generation&&K.state.version===this.state.dashboard?.state.version){this.setState({isLoading:!1});return}if(!V?.spec){this.setState({isLoading:!1,loadError:{status:404,message:(0,a.t)("dashboard-scene.dashboard-scene-page-state-manager-v2.message.dashboard-not-found","Dashboard not found")}});return}const G=(0,D.dj)(V);o.$.featureToggles.preserveDashboardStateWhenNavigating&&F&&(0,P.Gq)(G),this.setSceneCache(F,G),this.setState({dashboard:G,isLoading:!1})}catch(V){const K=(0,m.do)(V),G=(0,m.q6)(V);if(this.setState({isLoading:!1,loadError:{message:G,status:K}}),V instanceof g.P)throw V}}}class w extends W{constructor(A){super(A),this.v1Manager=new B(A),this.v2Manager=new S(A),this.activeManager=this.v1Manager}async withVersionHandling(A){try{return await A(this.activeManager)}catch(U){if(U instanceof g.P){const F=U.data.storedVersion==="v2alpha1"?this.v2Manager:this.v1Manager;return this.activeManager=F,await A(F)}else throw U}finally{this.setState(this.activeManager.state)}}async fetchDashboard(A){return this.withVersionHandling(U=>U.fetchDashboard(A))}async reloadDashboard(A){return this.withVersionHandling(U=>U.reloadDashboard.call(this,A))}getDashboardFromCache(A){return this.activeManager.getDashboardFromCache(A)}transformResponseToScene(A,U){return A?(0,y.HG)(A)?(this.activeManager=this.v2Manager,this.v2Manager.transformResponseToScene(A,U)):this.v1Manager.transformResponseToScene(A,U):null}async loadSnapshotScene(A){try{return await this.v1Manager.loadSnapshotScene(A)}catch(U){if(U instanceof g.P&&U.data.storedVersion==="v2alpha1")return await this.v2Manager.loadSnapshotScene(A);throw new Error("Snapshot not found")}}async loadSnapshot(A){return this.withVersionHandling(U=>U.loadSnapshot(A))}clearDashboardCache(){this.v1Manager.clearDashboardCache(),this.v2Manager.clearDashboardCache()}clearSceneCache(){this.v1Manager.clearSceneCache(),this.v2Manager.clearSceneCache(),this.cache={}}getSceneFromCache(A){return this.activeManager.getSceneFromCache(A)}setSceneCache(A,U){this.activeManager.setSceneCache(A,U)}getCache(){return this.activeManager.getCache()}setDashboardCache(A,U){(0,y.HG)(U)?this.v2Manager.setDashboardCache(A,U):this.v1Manager.setDashboardCache(A,U)}async loadDashboard(A){if(A.route===b.Z4.New){const U=o.$.featureToggles.dashboardNewLayouts?"v2":"v1";this.setActiveManager(U)}return this.withVersionHandling(U=>U.loadDashboard.call(this,A))}setActiveManager(A){A==="v1"?this.activeManager=this.v1Manager:this.activeManager=this.v2Manager}resetActiveManager(){this.setActiveManager("v1")}}const N={v1:void 0,v2:void 0,unified:void 0};function M(L){return L==="v1"?(N.v1||(N.v1=new B({})),N.v1):L==="v2"?(N.v2||(N.v2=new S({})),N.v2):(N.unified||(N.unified=new w({})),N.unified)}},75570:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>o});var n=e(6890),a=e(83873),s=e(66198),l=e(8535);async function o(d){try{const i=await a.IB.getFolderByUid(d);l.M_.dispatch((0,n.Vz)((0,s.R4)(i)))}catch(i){console.warn("Error fetching parent folder",d,"for dashboard",i)}}},80849:(Z,R,e)=>{"use strict";e.d(R,{p:()=>c});var n=e(74848),a=e(51898),s=e(92745),l=e(31286),o=e(41654),d=e(66404),i=e(45861);function c(m){return(0,n.jsx)(l.a,{alignItems:"center",padding:4,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(d.E,{element:"h3",textAlignment:"center",children:(0,n.jsx)(s.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,n.jsx)(d.E,{element:"p",textAlignment:"center","data-testid":a.Tp.components.Transforms.noTransformationsMessage,children:(0,n.jsxs)(s.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,n.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,n.jsx)(i.$n,{icon:"plus",variant:"primary",size:"md",onClick:m.onShowPicker,"data-testid":a.Tp.components.Transforms.addTransformationButton,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.empty-transformations-message.add-transformation",children:"Add transformation"})})]})})}},89451:(Z,R,e)=>{"use strict";e.d(R,{L:()=>xt});var n=e(2543),a=e(92745),s=e(36490),l=e(43173),o=e(36674),d=e(68373),i=e(77731),c=e(30124),m=e(33143),p=e(3204),h=e(17862),r=e(29700),g=e(3688),y=e(70030),v=e(8285);class x extends o.Bs{constructor(St){super({source:St.source,data:St.source.resolve().state.data}),this.addActivationHandler(()=>{this._subs.add(this.state.source.resolve().subscribeToState((jt,Qt)=>{jt.data!==Qt.data&&this.setState({data:jt.data})}))})}setContainerWidth(St){this.state.source.resolve().setContainerWidth?.(St)}isDataReadyToDisplay(){return this.state.source.resolve().isDataReadyToDisplay?.()??!0}cancelQuery(){this.state.source.resolve().cancelQuery?.()}getResultsStream(){return this.state.source.resolve().getResultsStream()}}var f=e(74848),u=e(22803),b=e(51898),E=e(63142),D=e(54314),C=e(92807),P=e(13941),T=e(32881),O=e(65642),I=e(73427),j=e(54),W=e(52161),B=e(34999),S=e(6975),w=e(60208),N=e(22971),M=e(21764),L=e(77256),A=e(54148),U=e(16817),F=e(83175),V=e(25992),K=e(45861),G=e(74268),H=e(20437);const _=({panel:dt,className:St})=>{const jt=(0,A.zy)(),{loading:Qt,value:Jt}=(0,U.A)(()=>(0,H.J6)(dt),[dt]);if(Qt)return(0,f.jsx)(K.$n,{disabled:!0,children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.new-alert-rule",children:"New alert rule"})});if(!Jt)return(0,f.jsx)(B.F,{severity:"info",title:(0,a.t)("dashboard-scene.scenes-new-rule-from-panel-button.title-no-alerting-capable-query-found","No alerting capable query found"),children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.body-no-alerting-capable-query-found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."})});const ln=async()=>{(0,V.fH)(G.le.alertRuleFromPanel);const fn=await(0,H.J6)(dt),gn=F.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(fn),returnTo:jt.pathname+jt.search});s.Ny.push(gn)};return(0,f.jsx)(K.$n,{icon:"bell",onClick:ln,className:St,"data-testid":"create-alert-rule-button",children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.new-alert-rule",children:"New alert rule"})})};var k=(dt=>(dt.Queries="queries",dt.Transformations="transformations",dt.Alert="alert",dt))(k||{});class J extends o.Bs{constructor(){super(...arguments),this.tabId=k.Alert}static{this.Component=z}renderTab(St){return(0,f.jsx)(X,{model:this,...St},this.getTabLabel())}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-alerting-tab.tab-label","Alert")}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,v.YQ)(this)}getLegacyPanelId(){return(0,v.Cs)(this.state.panelRef.resolve())}getCanCreateRules(){const St=(0,j.Wd)("grafana");return l.$.unifiedAlerting&&this.getDashboard().state.meta.canSave&&I.TP.hasPermission(St.create)}}function z({model:dt}){const St=(0,E.of)(Y),{errors:jt,loading:Qt,rules:Jt}=(0,M.S)({dashboardUID:dt.getDashboardUID(),panelId:dt.getLegacyPanelId()}),ln=jt.length?(0,f.jsx)(B.F,{title:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.alert.title-errors-loading-rules","Errors loading rules"),severity:"error",children:jt.map((Rt,bt)=>(0,f.jsx)("div",{children:(0,f.jsxs)(a.x6,{i18nKey:"dashboard-scene.panel-data-alerting-tab-rendered.error-failed-to-load",values:{errorToDisplay:(0,L.JZ)(Rt)},children:["Failed to load Grafana rules state: ","{{errorToDisplay}}"]})},bt))}):null;if(Qt&&!Jt.length)return(0,f.jsxs)(f.Fragment,{children:[ln,(0,f.jsx)(S._,{text:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.text-loading-rules","Loading rules...")})]});const fn=dt.state.panelRef.resolve(),gn=dt.getCanCreateRules();if(Jt.length)return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(N.sF,{rules:Jt}),gn&&(0,f.jsx)(_,{className:St.newButton,panel:fn})]});const vn=!dt.getDashboardUID(),wn=dt.getDashboard();return(0,f.jsxs)("div",{className:St.noRulesWrapper,children:[!vn&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{children:(0,f.jsx)(a.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.no-rules",children:"There are no alert rules linked to this panel."})}),gn&&(0,f.jsx)(_,{panel:fn})]}),vn&&!!wn.state.meta.canSave&&(0,f.jsx)(B.F,{severity:"info",title:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.title-dashboard-not-saved","Dashboard not saved"),children:(0,f.jsx)(a.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.dashboard-not-saved",children:"Dashboard must be saved before alerts can be added."})})]})}const Y=dt=>({newButton:(0,u.css)({marginTop:dt.spacing(3)}),noRulesWrapper:(0,u.css)({margin:dt.spacing(2),backgroundColor:dt.colors.background.secondary,padding:dt.spacing(3)})});function X(dt){const{model:St}=dt,{rules:jt}=(0,M.S)({dashboardUID:St.getDashboardUID(),panelId:St.getLegacyPanelId(),poll:!1});return(0,f.jsx)(w.o,{label:St.getTabLabel(),icon:"bell",counter:jt.length,active:dt.active,onChangeTab:dt.onChangeTab})}var Q=e(48480),q=e(1906),te=e(78282),ne=e(41654),se=e(1404),ue=e(7078),de=e(29328),ie=e(52900),he=e(82779),me=e(23117),ce=e(65966),Pe=e(32154),Ie=e(57204),Se=e(73601),Me=e(18615),Te=e(98838),Ge=e(4651),Qe=e(28998),tt=e(81657),ke=e(22175);class He extends o.Bs{constructor(St){super(St),this.tabId=k.Queries,this.onOpenInspector=()=>{const jt=this.state.panelRef.resolve(),Qt=(0,v.Cs)(jt);s.Ny.partial({inspect:Qt,inspectTab:"query"})},this.onChangeDataSource=async(jt,Qt)=>{const{dsSettings:Jt}=this.state,ln=this.queryRunner,fn=Jt?await(0,te.l)().get({uid:Jt.uid}):void 0,gn=await(0,te.l)().get({uid:jt.uid}),vn=ln.state.queries,wn=Qt||await(0,Ie.y)(gn,jt.uid,vn,fn);ln.setState({datasource:(0,Q.p$)(jt),queries:wn}),Qt&&ln.runQueries(),this.loadDataSource()},this.onQueryOptionsChange=jt=>{const Qt=this.state.panelRef.resolve(),Jt=this.queryRunner,ln={},fn={};jt.maxDataPoints!==Jt.state.maxDataPoints&&(ln.maxDataPoints=jt.maxDataPoints??void 0),jt.minInterval!==Jt.state.minInterval&&(ln.minInterval=jt.minInterval??void 0);const gn=jt.timeRange?.from??void 0,vn=jt.timeRange?.shift??void 0,wn=jt.timeRange?.hide;gn!==void 0||vn!==void 0?(fn.$timeRange=new tt.v({timeFrom:gn,timeShift:vn,hideTimeOverride:wn}),fn.hoverHeader=(0,ke.$7)(Qt.state.title,fn.$timeRange)):(fn.$timeRange=void 0,fn.hoverHeader=(0,ke.$7)(Qt.state.title,void 0)),jt.cacheTimeout!==Jt?.state.cacheTimeout&&(ln.cacheTimeout=jt.cacheTimeout),jt.queryCachingTTL!==Jt?.state.queryCachingTTL&&(ln.queryCachingTTL=jt.queryCachingTTL),Qt.setState(fn),Jt.setState(ln),Jt.runQueries()},this.onQueriesChange=jt=>{this.queryRunner.setState({queries:jt})},this.onRunQueries=()=>{this.queryRunner.runQueries()},this.addQueryClick=()=>{const jt=this.getQueries();this.onQueriesChange((0,se.U7)(jt,this.newQuery()))},this.onAddQuery=jt=>{const Qt=this.getQueries(),Jt=this.state.dsSettings;this.onQueriesChange((0,se.U7)(Qt,jt,Jt?(0,Q.p$)(Jt):{type:void 0,uid:void 0}))},this.onAddExpressionOfType=jt=>{const Qt=this.getQueries(),ln={...de.Ex.newQuery(),type:jt},fn=(0,he.rV)(ln);this.onQueriesChange((0,se.U7)(Qt,fn))},this.addActivationHandler(()=>this.onActivate())}static{this.Component=Re}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-queries-tab.tab-label","Queries")}getItemsCount(){return this.getQueries().length}renderTab(St){return(0,f.jsx)(Ae,{model:this,...St},this.getTabLabel())}onActivate(){this.loadDataSource()}async loadDataSource(){if(!this.state.panelRef.resolve().state.$data)return;let Qt=this.queryRunner.state.datasource;try{let Jt,ln;if(Qt)Jt=await(0,te.l)().get(Qt),ln=(0,te.l)().getInstanceSettings(Qt);else{const gn=(0,v.YQ)(this).state.uid??"",vn=(0,i.CW)(gn);vn?.datasourceUid!==null&&(ln=(0,te.l)().getInstanceSettings({uid:vn?.datasourceUid}),ln&&(Jt=await(0,te.l)().get({uid:vn?.datasourceUid,type:ln.type}),this.queryRunner.setState({datasource:{...(0,Q.p$)(ln),uid:vn?.datasourceUid}})))}Jt&&ln&&(this.setState({datasource:Jt,dsSettings:ln}),(0,ue.tw)((0,Q.p$)(ln)||{default:!0}))}catch(Jt){const ln=await(0,te.l)().get(l.$.defaultDatasource),fn=(0,te.l)().getInstanceSettings(l.$.defaultDatasource);ln&&fn&&(this.setState({datasource:ln,dsSettings:fn}),this.queryRunner.setState({datasource:(0,Q.p$)(fn)})),console.error(Jt)}}buildQueryOptions(){const St=this.state.panelRef.resolve(),jt=(0,v.un)(St),Qt=o.jh.getTimeRange(St);let Jt={from:void 0,shift:void 0,hide:void 0};Qt instanceof tt.v&&(Jt={from:Qt.state.timeFrom,shift:Qt.state.timeShift,hide:Qt.state.hideTimeOverride});let ln=jt.state.queries;const fn=this.state.dsSettings;return{cacheTimeout:fn?.meta.queryOptions?.cacheTimeout?jt.state.cacheTimeout:void 0,queryCachingTTL:fn?.cachingConfig?.enabled?jt.state.queryCachingTTL:void 0,dataSource:{default:fn?.isDefault,...fn?(0,Q.p$)(fn):{type:void 0,uid:void 0}},queries:ln,maxDataPoints:jt.state.maxDataPoints,minInterval:jt.state.minInterval,timeRange:Jt}}getQueries(){return this.queryRunner.state.queries}newQuery(){const{dsSettings:St,datasource:jt}=this.state;let Qt;return St?.meta.mixed?jt?.meta.mixed?Qt=(0,te.l)().getInstanceSettings(l.$.defaultDatasource):Qt=jt:Qt=St,{...jt?.getDefaultQuery?.(q.Jk.PanelEditor),datasource:{uid:Qt?.uid,type:Qt?.type}}}isExpressionsSupported(St){return(St.meta.backend||St.meta.alerting||St.meta.mixed)===!0}renderExtraActions(){return me.m.getAllExtraRenderAction().map((St,jt)=>St({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:jt})).filter(Boolean)}get queryRunner(){return(0,v.un)(this.state.panelRef.resolve())}}function Re({model:dt}){const{datasource:St,dsSettings:jt}=dt.useState(),{data:Qt,queries:Jt}=dt.queryRunner.useState(),{openDrawer:ln,queryLibraryEnabled:fn}=(0,Te.Y)();if(!St||!jt||!Qt)return null;const gn=!(0,Se.k)(jt.name),vn=async wn=>{const Rt=Jt.map(Vt=>Vt.datasource?Vt:{...Vt,datasource:St.getRef()}),bt=(0,se.U7)(Rt,wn);if(dt.onQueriesChange(bt),wn.datasource?.uid){const Dt={uid:new Set(bt.map(Ln=>Ln.datasource?.uid).filter(Ln=>Ln!==Ge.Uj)).size>1?Me.uv:wn.datasource.uid};if(St.uid!==Dt.uid){const Ln=(0,Qe.tR)().getInstanceSettings(Dt);Ln&&await dt.onChangeDataSource(Ln)}}};return(0,f.jsxs)("div",{"data-testid":b.Tp.components.QueryTab.content,children:[(0,f.jsx)(Pe.K,{data:Qt,dsSettings:jt,dataSource:St,options:dt.buildQueryOptions(),onDataSourceChange:dt.onChangeDataSource,onOptionsChange:dt.onQueryOptionsChange,onOpenQueryInspector:dt.onOpenInspector}),(0,f.jsx)(ce.L,{data:Qt,queries:Jt,dsSettings:jt,onAddQuery:dt.onAddQuery,onQueriesChange:dt.onQueriesChange,onRunQueries:dt.onRunQueries}),(0,f.jsxs)(ne.B,{gap:2,children:[gn&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(K.$n,{icon:"plus",onClick:dt.addQueryClick,variant:"secondary","data-testid":b.Tp.components.QueryTab.addQuery,children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-queries-tab-rendered.add-query",children:"Add query"})}),fn&&(0,f.jsx)(K.$n,{icon:"plus",onClick:()=>ln(Ne(St,Jt),vn),variant:"secondary","data-testid":b.Tp.components.QueryTab.addQueryFromLibrary,children:(0,f.jsx)(a.x6,{i18nKey:"dashboards.panel-queries.add-query-from-library",children:"Add query from library"})})]}),l.$.expressionsEnabled&&dt.isExpressionsSupported(jt)&&(0,f.jsx)(ie.m,{handleOnSelect:dt.onAddExpressionOfType,children:(0,f.jsx)(K.$n,{icon:"plus",variant:"secondary","data-testid":b.Tp.components.QueryTab.addExpression,children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-queries-tab-rendered.expression",children:"Expression\xA0"})})}),dt.renderExtraActions()]})]})}function Ne(dt,St){if(dt.uid==="-- Mixed --"){const jt=(0,te.l)();return St.map(Qt=>jt.getInstanceSettings(Qt.datasource)?.name).filter(Qt=>Qt!==void 0)}else return[dt.name]}function Ae(dt){const{model:St}=dt,jt=St.queryRunner.useState();return(0,f.jsx)(w.o,{label:St.getTabLabel(),icon:"database",counter:jt.queries.length,active:dt.active,onChangeTab:dt.onChangeTab})}var Ue=e(89332),Be=e(96540),We=e(93256),_e=e(71599),Xe=e(47350),le=e(80849),ye=e(8642),pe=e(76319),ve=e(9284),be=e(34176);function Oe(dt){const{isOpen:St,series:jt,onClose:Qt,onTransformationAdd:Jt}=dt,[ln,fn]=(0,Be.useState)({search:"",showIllustrations:!0}),gn=Kt=>fn({...ln,search:Kt.currentTarget.value}),vn=Kt=>fn({...ln,showIllustrations:Kt}),wn=Kt=>fn({...ln,selectedFilter:Kt}),Rt=(0,Be.useMemo)(()=>ye.h.list().sort((Kt,Dt)=>Kt.name>Dt.name?1:Dt.name>Kt.name?-1:0),[]),bt=Rt.filter(Kt=>ln.selectedFilter&&ln.selectedFilter!==be.e&&!Kt.categories?.has(ln.selectedFilter)?!1:Kt.name.toLocaleLowerCase().includes(ln.search.toLocaleLowerCase())||Kt.description?.toLocaleLowerCase().includes(ln.search.toLocaleLowerCase())),Vt=(0,f.jsxs)(f.Fragment,{children:[bt.length," / ",Rt.length," \xA0\xA0",(0,f.jsx)(pe.K,{name:"times",onClick:()=>{fn({...ln,search:""})},tooltip:(0,a.t)("dashboard-scene.transformations-drawer.search-box-suffix.tooltip-clear-search","Clear search")})]});if(St)return(0,f.jsx)(ve.R,{data:jt,onTransformationAdd:Jt,xforms:bt,search:ln.search,noTransforms:!1,suffix:ln.search!==""?Vt:(0,f.jsx)(f.Fragment,{}),selectedFilter:ln.selectedFilter,onSearchChange:gn,onSearchKeyDown:()=>{},showIllustrations:ln.showIllustrations,onShowIllustrationsChange:vn,onSelectedFilterChange:wn,onClose:Qt})}class we extends o.Bs{constructor(){super(...arguments),this.tabId=k.Transformations}static{this.Component=ze}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-transformations-tab.tab-label","Transformations")}renderTab(St){return(0,f.jsx)(Ke,{model:this,...St},this.getTabLabel())}getQueryRunner(){return(0,v.un)(this.state.panelRef.resolve())}getDataTransformer(){const St=this.state.panelRef.resolve().state.$data;if(!St||!(St instanceof o.Es))throw new Error("Could not find SceneDataTransformer for panel");return St}onChangeTransformations(St){const jt=this.getDataTransformer();jt.setState({transformations:St}),jt.reprocessTransformations()}}function ze({model:dt}){const St=(0,E.of)(ge),jt=dt.getQueryRunner().useState(),{data:Qt,transformations:Jt}=dt.getDataTransformer().useState(),ln=Jt,[fn,gn]=(0,Be.useState)(!1),[vn,wn]=(0,Be.useState)(!1),Rt=()=>gn(!0),bt=()=>gn(!1);if(!Qt||!jt.data)return;const Vt=(0,f.jsx)(Oe,{onClose:bt,onTransformationAdd:Kt=>{Kt.value!==void 0&&(dt.onChangeTransformations([...ln,{id:Kt.value,options:{}}]),bt())},isOpen:fn,series:Qt.series});return ln.length<1?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(le.p,{onShowPicker:Rt}),Vt]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Ve,{data:jt.data,transformations:ln,model:dt}),(0,f.jsxs)(We.e,{children:[(0,f.jsx)(K.$n,{icon:"plus",variant:"secondary",onClick:Rt,"data-testid":b.Tp.components.Transforms.addTransformationButton,children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-transformations-tab-rendered.add-another-transformation",children:"Add another transformation"})}),(0,f.jsx)(K.$n,{"data-testid":b.Tp.components.Transforms.removeAllTransformationsButton,className:St.removeAll,icon:"times",variant:"secondary",onClick:()=>wn(!0),children:(0,f.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-transformations-tab-rendered.delete-all-transformations",children:"Delete all transformations"})})]}),(0,f.jsx)(_e.u,{isOpen:vn,title:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.title-delete-all-transformations","Delete all transformations?"),body:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.body-delete-all-transformations","By deleting all transformations, you will go back to the main selection screen."),confirmText:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.confirmText-delete-all","Delete all"),onConfirm:()=>{dt.onChangeTransformations([]),wn(!1)},onDismiss:()=>wn(!1)}),Vt]})}function Ve({transformations:dt,model:St,data:jt}){const Qt=dt.map((ln,fn)=>({id:`${fn} - ${ln.id}`,transformation:ln})),Jt=ln=>{if(!ln||!ln.destination)return;const fn=ln.source.index,gn=ln.destination.index;if(fn===gn)return;const vn=Array.from(Qt),[wn]=vn.splice(fn,1);vn.splice(gn,0,wn),St.onChangeTransformations(vn.map(Rt=>Rt.transformation))};return(0,f.jsx)(Ue.JY,{onDragEnd:Jt,children:(0,f.jsx)(Ue.gL,{droppableId:"transformations-list",direction:"vertical",children:ln=>(0,f.jsxs)("div",{ref:ln.innerRef,...ln.droppableProps,children:[(0,f.jsx)(Xe.A,{onChange:(fn,gn)=>{const vn=dt.slice();vn[fn]=gn,St.onChangeTransformations(vn)},onRemove:fn=>{const gn=dt.slice();gn.splice(fn,1),St.onChangeTransformations(gn)},configs:Qt,data:jt}),ln.placeholder]})})})}const ge=dt=>({removeAll:(0,u.css)({marginLeft:dt.spacing(2)})});function Ke(dt){const{model:St}=dt,jt=St.getDataTransformer().useState();return(0,f.jsx)(w.o,{label:St.getTabLabel(),icon:"process",counter:jt.transformations.length,active:dt.active,onChangeTab:dt.onChangeTab})}class qe extends o.Bs{constructor(){super(...arguments),this._urlSync=new o.So(this,{keys:["tab"]}),this.onChangeTab=St=>{this.setState({tab:St.tabId})}}static{this.Component=ot}static createFor(St){const jt=St.getRef(),Qt=[new He({panelRef:jt}),new we({panelRef:jt})];return lt(St.state.pluginId)&&Qt.push(new J({panelRef:jt})),new qe({panelRef:jt,tabs:Qt,tab:k.Queries})}getUrlState(){return{tab:this.state.tab}}updateFromUrl(St){St.tab&&typeof St.tab=="string"&&this.setState({tab:St.tab})}}function ot({model:dt}){const{tab:St,tabs:jt}=dt.useState(),Qt=(0,E.of)(mt);if(!jt||!jt.length)return;const Jt=jt.find(ln=>ln.tabId===St);return(0,f.jsxs)("div",{className:Qt.dataPane,"data-testid":b.Tp.components.PanelEditor.DataPane.content,children:[(0,f.jsx)(D.U,{className:Qt.tabsBar,children:jt.map(ln=>ln.renderTab({active:ln.tabId===St,onChangeTab:()=>dt.onChangeTab(ln)}))}),(0,f.jsx)(C.P,{backgroundColor:"primary",children:(0,f.jsx)(P.J,{className:Qt.tabContent,children:(0,f.jsx)(T.mc,{children:Jt&&(0,f.jsx)(Jt.Component,{model:Jt})})})})]})}function lt(dt){const{unifiedAlertingEnabled:St=!1}=(0,O.zj)(),jt=I.TP.hasPermission((0,j.Wd)(W.hY).read);return St&&jt?dt==="graph"||dt==="timeseries":!1}function mt(dt){return{dataPane:(0,u.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,u.css)({padding:dt.spacing(2),border:`1px solid ${dt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:dt.shape.radius.default,flexGrow:1}),tabsBar:(0,u.css)({flexShrink:0,paddingLeft:dt.spacing(2)})}}var Lt=e(7895),Tt=e(68079),It=e(66483),Mt=e(12161),Ut=e(17732),an=e(82754);function cn({model:dt}){const St=(0,v.YQ)(dt),{optionsPane:jt}=dt.useState(),Qt=(0,E.of)(yn),[Jt,ln]=(0,m.dt)(),{containerProps:fn,primaryProps:gn,secondaryProps:vn,splitterProps:wn,splitterState:Rt,onToggleCollapse:bt}=(0,an.L)({direction:"row",dragPosition:"end",initialSize:330,usePixels:!0,collapsed:Jt,collapseBelowPixels:250});return(0,Be.useEffect)(()=>{ln(Rt.collapsed)},[Rt.collapsed,ln]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(It.c,{dashboard:St}),(0,f.jsxs)("div",{...fn,className:(0,u.cx)(fn.className,Qt.content),"data-testid":b.Tp.components.PanelEditor.General.content,children:[(0,f.jsx)("div",{...gn,className:(0,u.cx)(gn.className,Qt.body),children:(0,f.jsx)(un,{model:dt})}),(0,f.jsx)("div",{...wn}),(0,f.jsxs)("div",{...vn,className:(0,u.cx)(vn.className,Qt.optionsPane),children:[Rt.collapsed&&(0,f.jsx)("div",{className:Qt.expandOptionsWrapper,children:(0,f.jsx)(Lt.I,{tooltip:(0,a.t)("dashboard-scene.panel-editor-renderer.tooltip-open-options-pane","Open options pane"),icon:"arrow-to-right",onClick:bt,variant:"canvas",className:Qt.rotate180,"aria-label":(0,a.t)("dashboard-scene.panel-editor-renderer.aria-label-open-options-pane","Open options pane")})}),!Rt.collapsed&&jt&&(0,f.jsx)(jt.Component,{model:jt}),!Rt.collapsed&&!jt&&(0,f.jsx)(Tt.y,{})]})]})]})}function un({model:dt}){const St=(0,v.YQ)(dt),{dataPane:jt,showLibraryPanelSaveModal:Qt,showLibraryPanelUnlinkModal:Jt,tableView:ln}=dt.useState(),fn=dt.getPanel(),gn=(0,v.iL)(fn),{controls:vn}=St.useState(),wn=(0,E.of)(yn),{containerProps:Rt,primaryProps:bt,secondaryProps:Vt,splitterProps:Kt,splitterState:Dt,onToggleCollapse:Zt}=(0,an.L)({direction:"column",dragPosition:"start",initialSize:.5,collapseBelowPixels:150});return Rt.className=(0,u.cx)(Rt.className,wn.container),jt||(bt.style.flexGrow=1),(0,f.jsxs)("div",{className:(0,u.cx)(wn.pageContainer,vn&&wn.pageContainerWithControls),children:[vn&&(0,f.jsx)("div",{className:wn.controlsWrapper,children:(0,f.jsx)(vn.Component,{model:vn})}),(0,f.jsxs)("div",{...Rt,children:[(0,f.jsx)("div",{...bt,children:(0,f.jsx)(On,{panel:fn,tableView:ln})}),Qt&&gn&&(0,f.jsx)(Ut.Z,{libraryPanel:gn,onDismiss:dt.onDismissLibraryPanelSaveModal,onConfirm:dt.onConfirmSaveLibraryPanel,onDiscard:dt.onDiscard}),Jt&&gn&&(0,f.jsx)(Mt.l,{onDismiss:dt.onDismissUnlinkLibraryPanelModal,onConfirm:dt.onConfirmUnlinkLibraryPanel,isOpen:!0}),jt&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{...Kt}),(0,f.jsxs)("div",{...Vt,children:[Dt.collapsed&&(0,f.jsx)("div",{className:wn.expandDataPane,children:(0,f.jsx)(K.$n,{tooltip:(0,a.t)("dashboard-scene.viz-and-data-pane.tooltip-open-query-pane","Open query pane"),icon:"arrow-to-right",onClick:Zt,variant:"secondary",size:"sm",className:wn.openDataPaneButton,"aria-label":(0,a.t)("dashboard-scene.viz-and-data-pane.aria-label-open-query-pane","Open query pane")})}),!Dt.collapsed&&(0,f.jsx)(jt.Component,{model:jt})]})]})]})]})}function On({panel:dt,tableView:St}){const jt=(0,E.of)(yn),Qt=St??dt;return(0,f.jsx)("div",{className:jt.vizWrapper,children:(0,f.jsx)(Qt.Component,{model:Qt})})}function yn(dt){return{pageContainer:(0,u.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,u.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),container:(0,u.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,u.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,u.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,u.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,u.css)({flexDirection:"column",borderLeft:`1px solid ${dt.colors.border.weak}`,background:dt.colors.background.primary,marginTop:dt.spacing(2),borderTop:`1px solid ${dt.colors.border.weak}`,borderTopLeftRadius:dt.shape.radius.default}),expandOptionsWrapper:(0,u.css)({display:"flex",flexDirection:"column",padding:dt.spacing(2,1)}),expandDataPane:(0,u.css)({display:"flex",flexDirection:"row",padding:dt.spacing(1),borderTop:`1px solid ${dt.colors.border.weak}`,borderRight:`1px solid ${dt.colors.border.weak}`,background:dt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,u.css)({rotate:"180deg"}),controlsWrapper:(0,u.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls"}),openDataPaneButton:(0,u.css)({width:dt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}}),vizWrapper:(0,u.css)({height:"100%",width:"100%",paddingLeft:dt.spacing(2)})}}var En=e(42941),Bn=e(69168),fa=e(27489),Fn=e(37386),Ea=e(12737),gt=e(41097),Ht=e(52193),wt=e(25531),Yt=e(56424),rn=e(7094);const Xt=Be.memo(({panel:dt,searchQuery:St,listMode:jt,data:Qt})=>{const{options:Jt,fieldConfig:ln,_pluginInstanceState:fn}=dt.useState(),gn=(0,Be.useMemo)(()=>(0,ke.yH)(dt),[dt]),vn=(0,Be.useMemo)(()=>{const Kt=dt.getPlugin();if(Kt)return(0,Yt.Z4)({panel:dt,data:Qt,plugin:Kt,eventBus:dt.getPanelContext().eventBus,instanceState:fn})},[Qt,dt,Jt,ln,fn]),wn=(0,Be.useMemo)(()=>{if(dt instanceof o.Eb&&(0,v.ME)(dt)){const Kt=(0,v.iL)(dt);return Kt instanceof rn.u?(0,Yt.tN)(Kt):void 0}},[dt]),Rt=(0,Be.useMemo)(()=>(0,wt.v)(ln,dt.getPlugin()?.fieldConfigRegistry,Qt?.series??[],St,Kt=>{dt.onFieldConfigChange(Kt,!0)}),[Qt,St,dt,ln]),bt=St.length>0,Vt=[];if(bt)Vt.push((0,d.Po)([gn,...wn?[wn]:[],...vn??[]],Rt,St));else switch(jt){case d.gs.All:wn&&Vt.push(wn.render()),Vt.push(gn.render());for(const Kt of vn??[])Vt.push(Kt.render());for(const Kt of Rt)Vt.push(Kt.render());break;case d.gs.Overrides:for(const Kt of Rt)Vt.push(Kt.render());default:break}return Vt});Xt.displayName="PanelOptions";var on=e(78685),pn=e(77824),Un=e(95943),In=e(62667),Gn=e(82472),Wa=e(72165),za=e(33380);const Oa="dashboards_panel_plugin_picker_clicked",ss={TOGGLE_DROPDOWN:"toggle_panel_plugin_picker",SELECT_PANEL_PLUGIN:"select_panel_plugin",CHANGE_TAB:"change_tab",SEARCH:"search"};function La({panel:dt,data:St,onChange:jt,onClose:Qt}){const Jt=(0,E.of)(Ca),[ln,fn]=(0,Be.useState)(""),gn=(0,Be.useMemo)(()=>(0,n.debounce)((Qn,va)=>{Qn&&(0,fa.rR)(Oa,{item:ss.SEARCH,query:Qn,result_count:va,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),vn=Qn=>{fn(Qn)},wn=Un.wV,Rt=In.__.Visualizations,bt=(0,Be.useMemo)(()=>new za.R(dt),[dt]),Vt=(0,Be.useMemo)(()=>new Set([In.__.Visualizations,In.__.Suggestions]),[]),[Kt,Dt]=(0,on.A)(wn,Rt),Zt=Qn=>{(0,fa.rR)(Oa,{item:ss.CHANGE_TAB,tab:In.__[Qn],creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),Dt(Qn)};(0,Be.useEffect)(()=>{Kt&&!Vt.has(Kt)&&Dt(Rt)},[Rt,Kt,Dt,Vt]);const Ln=[{label:(0,a.t)("dashboard-scene.panel-viz-type-picker.radio-options.label.visualizations","Visualizations"),value:In.__.Visualizations},{label:(0,a.t)("dashboard-scene.panel-viz-type-picker.radio-options.label.suggestions","Suggestions"),value:In.__.Suggestions}];return(0,f.jsxs)("div",{className:Jt.wrapper,children:[(0,f.jsxs)("div",{className:Jt.searchRow,children:[(0,f.jsx)(Ea.Z,{className:Jt.filter,value:ln,onChange:vn,autoFocus:!0,placeholder:(0,a.t)("dashboard-scene.panel-viz-type-picker.placeholder-search-for","Search for...")}),(0,f.jsx)(K.$n,{title:(0,a.t)("dashboard-scene.panel-viz-type-picker.title-close","Close"),variant:"secondary",icon:"angle-up",className:Jt.closeButton,"data-testid":b.Tp.components.PanelEditor.toggleVizPicker,onClick:Qt})]}),(0,f.jsx)(Fn.D,{className:Jt.customFieldMargin,children:(0,f.jsx)(pn.z,{options:Ln,value:Kt,onChange:Zt,fullWidth:!0})}),(0,f.jsxs)(C.P,{children:[Kt===In.__.Visualizations&&(0,f.jsx)(Wa.G,{pluginId:dt.state.pluginId,searchQuery:ln,trackSearch:gn,onChange:jt}),Kt===In.__.Suggestions&&(0,f.jsx)(Gn.a,{onChange:jt,trackSearch:gn,searchQuery:ln,panel:bt,data:St})]})]})}const Ca=dt=>({wrapper:(0,u.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:dt.spacing(2,1),height:"100%",gap:dt.spacing(2),border:`1px solid ${dt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:dt.shape.radius.default}),searchRow:(0,u.css)({display:"flex",marginBottom:dt.spacing(1)}),closeButton:(0,u.css)({marginLeft:dt.spacing(1)}),customFieldMargin:(0,u.css)({marginBottom:dt.spacing(1)}),filter:(0,u.css)({minHeight:dt.spacing(4)})});class Ka extends o.Bs{constructor(){super(...arguments),this._cachedPluginOptions={},this.onToggleVizPicker=()=>{(0,fa.rR)(Oa,{item:ss.TOGGLE_DROPDOWN,open:!this.state.isVizPickerOpen}),this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onChangePanelPlugin=St=>{const jt=this.state.panelRef.resolve(),{options:Qt,fieldConfig:Jt,pluginId:ln}=jt.state,fn=St.pluginId;(0,fa.rR)(Oa,{item:ss.SELECT_PANEL_PLUGIN,plugin_id:fn});let gn={defaults:{...Jt.defaults,custom:{}},overrides:(0,Bn.aW)(Jt.overrides,Bn.nx)};this._cachedPluginOptions[ln]={options:Qt,fieldConfig:Jt};const vn=this._cachedPluginOptions[fn]?.options,wn=this._cachedPluginOptions[fn]?.fieldConfig;wn&&(gn=(0,Bn.H9)(gn,wn)),jt.changePluginType(fn,vn,gn),St.options&&jt.onOptionsChange(St.options,!0),St.fieldConfig&&jt.onFieldConfigChange(St.fieldConfig,!0),this.onToggleVizPicker()},this.onSetSearchQuery=St=>{this.setState({searchQuery:St})},this.onSetListMode=St=>{this.setState({listMode:St})},this.onOpenPanelJSON=St=>{s.Ny.partial({inspect:St.state.key,inspectTab:"json"})}}getOptionRadioFilters(){return[{label:d.gs.All,value:d.gs.All},{label:d.gs.Overrides,value:d.gs.Overrides}]}static{this.Component=({model:St})=>{const{isVizPickerOpen:jt,searchQuery:Qt,listMode:Jt,panelRef:ln}=St.useState(),fn=ln.resolve(),{pluginId:gn}=fn.useState(),{data:vn}=o.jh.getData(fn).useState(),wn=(0,E.of)(As),bt=!(Qt.length>0)&&!fn.getPlugin()?.fieldConfigRegistry.isEmpty(),[Vt,Kt]=(0,En.A)(!1),Dt=Jt===d.gs.Overrides;return(0,f.jsxs)(f.Fragment,{children:[!jt&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:wn.top,children:[(0,f.jsx)(Fn.D,{label:(0,a.t)("dashboard.panel-edit.visualization-button-label","Visualization"),className:wn.vizField,children:(0,f.jsxs)(ne.B,{gap:1,children:[(0,f.jsx)(Ia,{pluginId:gn,onOpen:St.onToggleVizPicker}),(0,f.jsx)(K.$n,{icon:"search",variant:"secondary",onClick:Kt,tooltip:(0,a.t)("dashboard.panel-edit.visualization-button-tooltip","Search options")}),bt&&(0,f.jsx)(Lt.I,{icon:"filter",tooltip:(0,a.t)("dashboard.panel-edit.only-overrides-button-tooltip","Show only overrides"),variant:Dt?"active":"canvas",onClick:()=>{St.onSetListMode(Dt?d.gs.All:d.gs.Overrides)}})]})}),Vt&&(0,f.jsx)(Ea.Z,{className:wn.searchOptions,value:Qt,placeholder:(0,a.t)("dashboard.panel-edit.placeholder-search-options","Search options"),onChange:St.onSetSearchQuery,autoFocus:!0,onBlur:()=>{Qt.length===0&&Kt(!1)}})]}),(0,f.jsx)(C.P,{children:(0,f.jsx)(Xt,{panel:fn,searchQuery:Qt,listMode:Jt,data:vn})})]}),jt&&(0,f.jsx)(La,{panel:fn,onChange:St.onChangePanelPlugin,onClose:St.onToggleVizPicker,data:vn})]})}}}function As(dt){return{top:(0,u.css)({display:"flex",flexDirection:"column",padding:dt.spacing(1,2,2,2),gap:dt.spacing(2)}),searchOptions:(0,u.css)({minHeight:dt.spacing(4)}),searchWrapper:(0,u.css)({padding:dt.spacing(2,2,2,0)}),vizField:(0,u.css)({marginBottom:dt.spacing(0)}),rotateIcon:(0,u.css)({rotate:"180deg"})}}function Ia({pluginId:dt,onOpen:St}){const jt=(0,E.of)(_s);let Qt=(0,Be.useMemo)(()=>(0,Ht.A4)().filter(Jt=>Jt.id===dt)[0],[dt]);return Qt||(Qt=(0,gt.$)(`Panel plugin not found (${dt})`,!0).meta),(0,f.jsx)(Lt.I,{className:jt.vizButton,tooltip:(0,a.t)("dashboard-scene.visualization-button.tooltip-click-to-change-visualization","Click to change visualization"),imgSrc:Qt.info.logos.small,onClick:St,"data-testid":b.Tp.components.PanelEditor.toggleVizPicker,"aria-label":(0,a.t)("dashboard-scene.visualization-button.aria-label-change-visualization","Change visualization"),variant:"canvas",isOpen:!1,fullWidth:!0,children:Qt.name})}function _s(dt){return{vizButton:(0,u.css)({textAlign:"left"})}}class Fa extends o.Bs{constructor(St){super(St),this._changesHaveBeenMade=!1,this.debounceSaveModelDiff=!0,this.onDiscard=()=>{this.setState({isDirty:!1});const Jt=this.state.panelRef.resolve();this.state.isNewPanel?(0,v.YQ)(this).removePanel(Jt):this._layoutItem.setState(this._layoutItemState),s.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{(0,c.DW)(this.state.panelRef.resolve()),this.setState({isDirty:!1}),s.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{const Jt=(0,v.iL)(this.getPanel());Jt&&(Jt.unlink(),this.setState({showLibraryPanelUnlinkModal:!1}))},this.onToggleTableView=()=>{if(this.state.tableView){this.setState({tableView:void 0});return}const ln=this.state.panelRef.resolve().state.$data;ln&&this.setState({tableView:o.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(new x({source:ln.getRef()})).build()})};const Qt=this.state.panelRef.resolve().parent;if(!Qt||!(0,g.y)(Qt))throw new Error("Panel must have a parent of type DashboardLayoutItem");this._layoutItem=Qt,this.setOriginalState(this.state.panelRef),this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=cn}_activationHandler(){const St=this.state.panelRef.resolve();St.state.pluginId===r.r&&St.changePluginType("timeseries"),this._subs.add(this._layoutItem.subscribeToEvent(m.BF,({payload:Qt})=>{Qt.perform()}));const jt=(0,v.sf)(St);return this.waitForPlugin(),()=>{this._layoutItem.editingCompleted?.(this.state.isDirty||this._changesHaveBeenMade),jt&&jt()}}waitForPlugin(St=0){const jt=this.getPanel(),Qt=jt.getPlugin();if(!Qt||Qt.meta.id!==jt.state.pluginId){St<100?setTimeout(()=>this.waitForPlugin(St+1),St*10):this.setState({pluginLoadErrror:"Failed to load panel plugin"});return}this.gotPanelPlugin(Qt)}setOriginalState(St){const jt=St.resolve();this._originalSaveModel=(0,y.Z6)(jt),this._layoutItemState=o.Go.cloneSceneObjectState(this._layoutItem.state)}_setupChangeDetection(){const St=this.state.panelRef.resolve(),jt=()=>{const{hasChanges:ln}=(0,h.yO)(this._originalSaveModel,(0,y.Z6)(St));this.setState({isDirty:ln})},Qt=this.debounceSaveModelDiff?(0,n.debounce)(jt,250):jt,Jt=ln=>{p.l.isUpdatingPersistedState(ln)&&Qt()};this._subs.add(this._layoutItem.subscribeToEvent(o.bZ,Jt))}getPanel(){return this.state.panelRef?.resolve()}gotPanelPlugin(St){const jt=this.getPanel();this.state.isInitializing?(this.setOriginalState(this.state.panelRef),this._layoutItem.editingStarted?.(),this._setupChangeDetection(),this._updateDataPane(St),this._subs.add(jt.subscribeToState((Qt,Jt)=>{Qt.pluginId!==Jt.pluginId&&this.waitForPlugin()})),this.setState({optionsPane:new Ka({panelRef:this.state.panelRef,searchQuery:"",listMode:d.gs.All}),isInitializing:!1})):this._updateDataPane(St)}_updateDataPane(St){const jt=St.meta.skipDataQuery,Qt=this.state.panelRef.resolve();if(jt&&(this.state.dataPane&&(s.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),Qt.state.$data&&Qt.setState({$data:void 0})),!jt&&(this.state.dataPane||this.setState({dataPane:qe.createFor(this.getPanel())}),!Qt.state.$data)){let Jt=(0,i.CW)((0,v.YQ)(this).state.uid)?.datasourceUid;Jt||(Jt=l.$.defaultDatasource),Qt.setState({$data:new o.Es({$data:new o.dt({datasource:{uid:Jt},queries:[{refId:"A"}]}),transformations:[]})})}}getUrlKey(){return this.getPanelId().toString()}getPanelId(){return(0,v.Cs)(this.state.panelRef.resolve())}getPageNav(St,jt){const Qt=(0,v.YQ)(this);return{text:(0,a.t)("dashboard-scene.panel-editor.text.edit-panel","Edit panel"),parentItem:Qt.getPageNav(St,jt)}}dashboardSaved(){this.setOriginalState(this.state.panelRef),this.setState({isDirty:!1}),this._changesHaveBeenMade=!0}}function xt(dt,St=!1){return new Fa({isInitializing:!0,panelRef:dt.getRef(),isNewPanel:St})}},17732:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>g});var n=e(74848),a=e(96540),s=e(16817),l=e(40996),o=e(92745),d=e(63142),i=e(22787),c=e(63527),m=e(30703),p=e(45861),h=e(30124),r=e(37666);const g=({libraryPanel:y,isUnsavedPrompt:v,onDismiss:x,onConfirm:f,onDiscard:u})=>{const[b,E]=(0,a.useState)(""),D=(0,s.A)(async()=>{const j=await(0,h.xV)(y.state.uid);return j.length>0?j.map(W=>W.title):[]},[y.state.uid]),[C,P]=(0,a.useState)([]);(0,l.A)(()=>D.value?P(D.value.filter(j=>j.toLowerCase().includes(b.toLowerCase()))):P([]),300,[D.value,b]);const T=(0,d.of)(r.o),O=(0,a.useCallback)(()=>{u()},[u]),I=v?"Unsaved library panel changes":"Save library panel";return(0,n.jsx)(i.a,{title:I,icon:"save",onDismiss:x,isOpen:!0,children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:T.textInfo,children:(0,n.jsxs)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.affected-dashboards",count:y.state._loadedPanel?.meta?.connectedDashboards,children:["This update will affect ",(0,n.jsxs)("strong",{children:["{{count}}"," dashboards."]})," The following dashboards using the panel will be affected:"]})}),(0,n.jsx)(c.p,{className:T.dashboardSearch,prefix:(0,n.jsx)(m.I,{name:"search"}),placeholder:(0,o.t)("dashboard-scene.save-library-viz-panel-modal.placeholder-search-affected-dashboards","Search affected dashboards"),value:b,onChange:j=>E(j.currentTarget.value)}),D.loading?(0,n.jsx)("p",{children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.loading-connected-dashboards",children:"Loading connected dashboards..."})}):(0,n.jsxs)("table",{className:T.myTable,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.dashboard-name",children:"Dashboard name"})})})}),(0,n.jsx)("tbody",{children:C.map((j,W)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:j})},`dashrow-${W}`))})]}),(0,n.jsxs)(i.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:x,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.cancel",children:"Cancel"})}),v&&(0,n.jsx)(p.$n,{variant:"destructive",onClick:O,children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.discard",children:"Discard"})}),(0,n.jsx)(p.$n,{onClick:()=>{f()},children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.update-all",children:"Update all"})})]})]})})}},22175:(Z,R,e)=>{"use strict";e.d(R,{$7:()=>S,R4:()=>j,dF:()=>I,dJ:()=>B,m:()=>O,yH:()=>P});var n=e(74848),a=e(96540),s=e(1906),l=e(51898),o=e(92745),d=e(43173),i=e(96822),c=e(63527),m=e(87105),p=e(21285),h=e(22055),r=e(76623),g=e(25797),y=e(51156),v=e(82345),x=e(33143),f=e(81657),u=e(20246),b=e(3688),E=e(70030),D=e(1682),C=e(8285);function P(w){const N=new g.C({title:(0,o.t)("dashboard-scene.get-panel-frame-options.descriptor.title.panel-options","Panel options"),id:"Panel options",isOpenDefault:!0}),M=D.b4.getPanelLinks(w),L=M?.state.rawLinks??[],A=(0,C.YQ)(w),U=w.parent;return N.addItem(new y.v({title:(0,o.t)("dashboard-scene.get-panel-frame-options.title.title","Title"),id:"PanelFrameTitle",value:w.state.title,popularRank:1,render:function(V){return(0,n.jsx)(O,{id:V.props.id,panel:w})},addon:d.$.featureToggles.dashgpt&&(0,n.jsx)(r.h,{onGenerate:F=>B(w,F),panel:(0,E.Z6)(w),dashboard:(0,E.Uy)(A)})})).addItem(new y.v({title:(0,o.t)("dashboard-scene.get-panel-frame-options.title.description","Description"),id:"description-text-area",value:w.state.description,render:function(V){return(0,n.jsx)(I,{id:V.props.id,panel:w})},addon:d.$.featureToggles.dashgpt&&(0,n.jsx)(h.t,{onGenerate:F=>w.setState({description:F}),panel:(0,E.Z6)(w)})})).addItem(new y.v({title:(0,o.t)("dashboard-scene.get-panel-frame-options.title.transparent-background","Transparent background"),id:"transparent-background",render:function(V){return(0,n.jsx)(j,{id:V.props.id,panel:w})}})).addCategory(new g.C({title:(0,o.t)("dashboard-scene.get-panel-frame-options.title.panel-links","Panel links"),id:"Panel links",isOpenDefault:!1,itemsCount:L?.length}).addItem(new y.v({title:(0,o.t)("dashboard-scene.get-panel-frame-options.title.panel-links","Panel links"),render:()=>(0,n.jsx)(T,{panelLinks:M??void 0})}))),(0,b.y)(U)&&U.getOptions?.().forEach(F=>N.addCategory(F)),N}function T({panelLinks:w}){const{rawLinks:N}=w?w.useState():{rawLinks:[]};return(0,n.jsx)(i.e,{links:N,onChange:M=>w?.setState({rawLinks:M}),getSuggestions:v.Fq,data:[]})}function O({panel:w,isNewElement:N,id:M}){const{title:L}=w.useState(),A=w.getPanelContext().app!==s.Jk.PanelEditor,[U,F]=a.useState(w.state.title);let V=(0,u.z4)({autoFocus:A&&N});return(0,n.jsx)(c.p,{ref:V,"data-testid":l.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:M,value:L,onFocus:()=>F(L),onBlur:()=>B(w,L,U),onChange:K=>W(w,K.currentTarget.value)})}function I({panel:w,id:N}){const{description:M}=w.useState(),[L,A]=a.useState(w.state.description);return(0,n.jsx)(m.f,{id:N,value:M,onChange:U=>w.setState({description:U.currentTarget.value}),onFocus:()=>A(w.state.description),onBlur:()=>{x.cc.edit({description:(0,o.t)("dashboard.edit-actions.panel-description","Change panel description"),source:w,perform:()=>w.setState({description:M}),undo:()=>w.setState({description:L})})}})}function j({panel:w,id:N}){const{displayMode:M="default"}=w.useState(),L=()=>{const A=M==="default"?"transparent":"default";x.cc.edit({description:(0,o.t)("dashboard.edit-actions.panel-background","Change panel background"),source:w,perform:()=>w.setState({displayMode:A}),undo:()=>w.setState({displayMode:M})})};return(0,n.jsx)(p.d,{value:M==="transparent",id:N,onChange:L})}function W(w,N){w.setState({title:N,hoverHeader:S(N,w.state.$timeRange)})}function B(w,N,M=w.state.title){N!==M&&x.cc.edit({description:(0,o.t)("dashboard.edit-actions.panel-title","Change panel title"),source:w,perform:()=>W(w,N),undo:()=>W(w,M)})}function S(w,N){return!(w!==""||N instanceof f.v&&!N.state.hideTimeOverride&&(N.state.timeFrom||N.state.timeShift))}},82754:(Z,R,e)=>{"use strict";e.d(R,{L:()=>s});var n=e(96540),a=e(93008);function s({direction:l,initialSize:o,dragPosition:d,collapseBelowPixels:i,collapsed:c,handleSize:m,usePixels:p}){const[h,r]=(0,n.useState)({collapsed:c??!1,snapSize:c?0:void 0}),g=(0,n.useCallback)((E,D,C)=>{E<=0&&D<=0&&C<=0||(h.collapsed&&C>i&&r({collapsed:!1}),!h.collapsed&&C<i&&r({collapsed:!0}))},[h,i]),y=(0,n.useCallback)((E,D,C)=>{if(E<=0&&D<=0&&C<=0)return;const P=h.snapSize===0;if(h.collapsed&&!P)r({snapSize:0,collapsed:h.collapsed});else if(h.collapsed&&P)if(p){const T=Math.max(C,o??200);r({snapSize:T,collapsed:!h.collapsed})}else{const T=Math.max(1-(o??.5),1-E);r({snapSize:T,collapsed:!h.collapsed})}},[h,o,p]),v=(0,n.useCallback)(()=>{r({collapsed:!h.collapsed})},[h.collapsed]),{containerProps:x,primaryProps:f,secondaryProps:u,splitterProps:b}=(0,a.h)({direction:l,dragPosition:d,handleSize:m,initialSize:o,usePixels:p,onResizing:g,onSizeChanged:y});return u.style.overflow="hidden",u.style.minWidth="unset",u.style.minHeight="unset",h.snapSize?p?u.style.flexBasis=`${h.snapSize}px`:(f.style={...f.style,flexGrow:1-h.snapSize},u.style.flexGrow=h.snapSize):h.snapSize===0&&(u.style.minWidth="min-content",u.style.minHeight="min-content",u.style.overflow="unset",p?u.style.flexBasis="0px":(f.style.flexGrow=1,u.style.flexGrow=0)),{containerProps:x,primaryProps:f,secondaryProps:u,splitterProps:b,splitterState:h,onToggleCollapse:v}}},3204:(Z,R,e)=>{"use strict";e.d(R,{l:()=>P});var n=e(2543),a=e(36674),s=e(81041);const l=()=>new s.c(new URL(e.p+e.u(7061),e.b));var o=e(73816),d=e(55793),i=e(91135),c=e(75904),m=e(49e3),p=e(79595),h=e(72746),r=e(7094),g=e(32540),y=e(81657),v=e(25953),x=e(8835),f=e(93389),u=e(97335),b=e(97883),E=e(92769),D=e(37365),C=e(44741);class P{constructor(I){this._dashboard=I}static isUpdatingPersistedState({payload:I}){return Object.keys(I.partialUpdate).length===0?!1:!!(I.changedObject instanceof a.Eb||I.changedObject instanceof f.U||I.changedObject instanceof y.v||I.changedObject instanceof a.dt&&!Object.prototype.hasOwnProperty.call(I.partialUpdate,"data")||I.changedObject instanceof a.Es&&!Object.prototype.hasOwnProperty.call(I.partialUpdate,"data")||I.changedObject instanceof g.$||I.changedObject instanceof a.WM&&(Object.prototype.hasOwnProperty.call(I.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(I.partialUpdate,"refresh"))||I.changedObject instanceof r.u&&Object.prototype.hasOwnProperty.call(I.partialUpdate,"name")||I.changedObject instanceof a.Gg.K2||I.changedObject instanceof a.kh||I.changedObject instanceof f.U||I.changedObject instanceof a.hy||I.changedObject instanceof h.H$&&Object.keys(I.partialUpdate).some(j=>h.vk.includes(j))||I.changedObject instanceof a.JZ||I.changedObject instanceof p.x&&Object.prototype.hasOwnProperty.call(I.partialUpdate,"hideTimeControls")||I.changedObject instanceof a.Pj||I.changedObject instanceof m.g&&!Object.prototype.hasOwnProperty.call(I.partialUpdate,"data")||I.changedObject instanceof a.Gg.en||(0,C.c7)(I.changedObject)||I.changedObject instanceof b.V||I.changedObject instanceof u.o||I.changedObject instanceof D.K||I.changedObject instanceof E.V||I.changedObject instanceof x.X2||I.changedObject instanceof v.X||I.changedObject instanceof c.H||I.changedObject instanceof i.K||I.changedObject instanceof d.M||I.changedObject instanceof o.t)}detectSaveModelChanges(){const I=this._dashboard.getSaveModel(),j=this._dashboard.getInitialSaveModel(),W=typeof I=="object"?JSON.parse(JSON.stringify(I)):I,B=typeof j=="object"?JSON.parse(JSON.stringify(j)):j;this._changesWorker?.postMessage({initial:B,changed:W})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(I){I||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=l()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=j=>{this.updateIsDirty(!!j.data.hasChanges)};const I=T(this.detectSaveModelChanges.bind(this));this._changeTrackerSub=this._dashboard.subscribeToEvent(a.bZ,j=>{P.isUpdatingPersistedState(j)&&I()})}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}function T(O){return(0,n.debounce)(O,250)}},17862:(Z,R,e)=>{"use strict";e.d(R,{AM:()=>c,Cj:()=>p,yO:()=>v});var n=e(50803),a=e(60171),s=e(84500),l=e(61371);function o(x,f){try{let u=x;for(const b of f)u=u[b];return u}catch{return}}function d(x,f){return typeof x==typeof f&&(typeof x=="string"&&x===f||Array.isArray(x)&&x.length===f.length&&x.every((u,b)=>u===f[b]))}function i(x,f){return x===f||x&&f&&x.selected===f.selected&&d(x.text,f.text)&&d(x.value,f.value)}function c(x,f,u,b,E){const D=m(x),C=f,P=h(C.timeSettings,D.timeSettings),T=g(C,D,b),O=C.timeSettings.autoRefresh!==D.timeSettings.autoRefresh;u||(C.timeSettings.from=D.timeSettings.from,C.timeSettings.to=D.timeSettings.to),E||(C.timeSettings.autoRefresh=D.timeSettings.autoRefresh);const I=(0,l.G4)(x,C),j=Object.values(I).reduce((W,B)=>W+B.length,0);return{changedSaveModel:C,initialSaveModel:D,diffs:I,diffCount:j,hasChanges:j>0,hasTimeChanges:P,hasVariableValueChanges:T,hasRefreshChange:O,hasMigratedToV2:!(0,a.aK)(x)}}function m(x){if((0,a.aK)(x))return x;const f={dashboard:x,meta:{}};return n.Op.ensureV2Response(f).spec}function p(x,f,u,b,E){const D=x,C=f,P=h(C.time,D.time),T=y(C,D,b),O=C.refresh!==D.refresh;u||(C.time=D.time),E||(C.refresh=D.refresh);const I=(0,l.G4)(D,C),j=Object.values(I).reduce((W,B)=>W+B.length,0);return{changedSaveModel:C,initialSaveModel:D,diffs:I,diffCount:j,hasChanges:j>0,hasTimeChanges:P,isNew:C.version===0,hasVariableValueChanges:T,hasRefreshChange:O}}function h(x={},f={}){return x.from!==f.from||x.to!==f.to}function r(x,f){if(x===void 0&&f===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(x===void 0&&f!==void 0||f===void 0&&x!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(x?.length!==f?.length)return!1;for(let u=0;u<(x?.length??0);u++){const b=x?.[u],E=f?.[u];if(b?.key!==E?.key||b?.operator!==E?.operator||b?.value!==E?.value)return!1}return!0}function g(x,f,u){const b=f.variables??[],E=x.variables??[];let D=!1;for(const C of E){const P=I=>I.kind==="QueryVariable"||I.kind==="CustomVariable"||I.kind==="DatasourceVariable"||I.kind==="ConstantVariable"||I.kind==="IntervalVariable"||I.kind==="TextVariable"||I.kind==="GroupByVariable",T=I=>I.kind==="QueryVariable"||I.kind==="CustomVariable"||I.kind==="DatasourceVariable"||I.kind==="IntervalVariable"||I.kind==="GroupByVariable",O=b.find(({spec:I,kind:j})=>I.name===C.spec.name&&j===C.kind);O&&((P(C)&&P(O)&&!i(C.spec.current,O.spec.current)||C.kind==="AdhocVariable"&&O.kind==="AdhocVariable"&&!r(C.spec.filters,O.spec.filters))&&(D=!0),u||(C.kind==="AdhocVariable"?C.spec.filters=O.spec.filters:(P(C)&&P(O)&&(C.spec.current=O.spec.current),T(C)&&T(O)&&(C.spec.options=O.spec.options))))}return D}function y(x,f,u){const b=f.templating?.list??[],E=x.templating?.list??[];let D=!1;for(const C of E){const P=b.find(({name:T,type:O})=>T===C.name&&O===C.type);if(P&&(P.current&&delete P.current.selected,i(C.current,P.current)?C.type==="adhoc"&&!r((0,s.Gs)(C?.filters),(0,s.Gs)(P?.filters))&&(D=!0):D=!0,!u)){const T=C;T.type==="adhoc"?T.filters=P.filters:(C.current=P.current,C.options=P.options)}}return D}function v(x,f){const u=(0,l.G4)(f,x),b=Object.values(u).reduce((E,D)=>E+D.length,0);return{changedSaveModel:x,initialSaveModel:f,diffs:u,diffCount:b,hasChanges:b>0}}},99454:(Z,R,e)=>{"use strict";e.d(R,{a:()=>s,r:()=>a});var n=e(92745);function a(l,o){return o&&o!==l?.branch?"write":l?.workflows?.[0]}function s(l,o){return l?l.type==="local"?[{label:"Save",value:"write"}]:(!o&&l.branch&&(o=l.branch),l.workflows.map(d=>{switch(d){case"write":return{label:o?`Push to ${o}`:"Save",value:d};case"branch":return{label:(0,n.t)("dashboard-scene.get-workflow-options.label.push-to-a-new-branch","Push to a new branch"),value:d}}return{label:d,value:d}})):[]}},2522:(Z,R,e)=>{"use strict";e.d(R,{S:()=>m});var n=e(96540),a=e(74101),s=e(75735),l=e(55266),o=e(99454);function d({timestamp:p,pathFromAnnotation:h,slug:r,folderPath:g=""}){let y="";if(h){const x=h.indexOf("#");return x>0?h.substring(0,x):h}return y=`${r||`new-dashboard-${p}`}.json`,g?`${g}/${y}`:y}var i=e(57512);function c({meta:p,defaultTitle:h,defaultDescription:r,loadedFromRef:g}){const y=p.k8s?.annotations,v=y?.[s.LH],x=y?.[s.Jw],f=y?.[s.Y_],{repository:u,folder:b,isLoading:E}=(0,l.T)({name:v==="repo"?x:void 0,folderName:p.folderUid}),D=(0,i.g)(),C=b?.metadata?.annotations?.[s.Y_],P=d({timestamp:D,pathFromAnnotation:f,slug:p.slug,folderPath:C});return E||!u?null:{values:{ref:`dashboard/${D}`,path:P,repo:x||u?.name||"",comment:"",folder:{uid:p.folderUid,title:""},title:h,description:r??"",workflow:(0,o.r)(u,g)},isNew:!p.k8s?.name,isGitHub:u?.type==="github",repository:u}}function m(p){const{meta:h,title:r,description:g}=p.useState(),[y]=(0,a.z)(),[v,x]=(0,n.useState)(!1),f=y.get("ref")??void 0,u=c({meta:h,defaultTitle:r,defaultDescription:g,loadedFromRef:f});if(!u)return{isReady:!1,isLoading:v,setIsLoading:x,defaultValues:null,repository:void 0,loadedFromRef:f,workflowOptions:[],isNew:!1,isGitHub:!1,readOnly:!0};const{values:b,isNew:E,isGitHub:D,repository:C}=u,P=(0,o.a)(C,f),T=!C?.workflows?.length;return{isReady:!0,defaultValues:b,repository:C,loadedFromRef:f,workflowOptions:P,isNew:E,isGitHub:D,readOnly:T,isLoading:v,setIsLoading:x}}},57512:(Z,R,e)=>{"use strict";e.d(R,{g:()=>l});var n=e(97677),a=e.n(n),s=e(25229);function l(){const o=new n.Chance;return`${(0,s.KQ)().format("YYYY-MM-DD")}-${o.string({length:5,alpha:!0})}`}},7498:(Z,R,e)=>{"use strict";e.d(R,{C:()=>C,S:()=>P});var n=e(65474),a=e(81160),s=e(739),l=e(76190),o=e(41119),d=e(28105),i=e(43173),c=e(36674),m=e(6890),p=e(64762),h=e(73427),r=e(47797),g=e(70327),y=e(78467),v=e(95443),x=e(52161),f=e(29609),u=e(8535),b=e(11257),E=e(24619),D=e(8285);class C extends c.VE{constructor(O){super({isEnabled:!0,...O,isHidden:!0}),this.hasAlertRules=!0,this.topic=s.QR.AlertStates,this.handleError=I=>{const j=(0,p.gi)("AlertStatesDataLayer",(0,r.q6)(I));(0,u.JD)((0,m.dx)(j))}}onEnable(){const O=c.jh.getTimeRange(this);this._timeRangeSub=O.subscribeToState(()=>{this.runWithTimeRange(O)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const O=c.jh.getTimeRange(this);this.runWithTimeRange(O)}async runWithTimeRange(O){const I=(0,D.YQ)(this),{uid:j,id:W}=I.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(O))return;const B=async()=>{const N=await(0,u.JD)(g.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:x.hY,dashboardUid:j},{forceRefetch:!0}));if(N.error)throw new Error("Unexpected alert rules response.");return N.data},w=(0,n.H)(B()).pipe((0,a.T)(N=>(0,y.Kw)(N))).pipe((0,a.T)(N=>{this.hasAlertRules=!1;const M={};return N.forEach(L=>L.rules.forEach(A=>{if(f.R$.alertingRule(A)&&A.annotations?.[v.YH.panelID]){this.hasAlertRules=!0;const U=Number(A.annotations[v.YH.panelID]),F=P(A.state);M[U]?F===l.O.Alerting&&M[U].state!==l.O.Alerting?M[U].state=l.O.Alerting:F===l.O.Pending&&M[U].state!==l.O.Alerting&&M[U].state!==l.O.Pending&&(M[U].state=l.O.Pending):M[U]={state:F,id:Object.keys(M).length,panelId:U,dashboardId:W}}})),Object.values(M)}));this.querySub=w.subscribe({next:N=>{const M=(0,o.Vc)(N);this.publishResults({state:d.Gu.Done,series:[{...M,meta:{...M.meta,dataTopic:s.QR.AlertStates}}],timeRange:O.state.value})},error:N=>{this.handleError(N),this.publishResults({state:d.Gu.Error,series:[],errors:[{message:(0,r.q6)(N)}],timeRange:O.state.value})}})}canWork(O){const I=(0,D.YQ)(this),{uid:j}=I.state;return!(!j||i.$.publicDashboardAccessToken||O.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(h.TP.hasPermission(b.w.AlertingRuleRead)&&h.TP.hasPermission(b.w.AlertingRuleExternalRead)))}}function P(T){return T===E.cF.Firing?l.O.Alerting:T===E.cF.Pending?l.O.Pending:l.O.OK}},49e3:(Z,R,e)=>{"use strict";e.d(R,{g:()=>i});var n=e(22592),a=e(27359),s=e(739),l=e(43173),o=e(36674),d=e(42942);class i extends o.tV.g{async resolveDataSource(m){return l.$.publicDashboardAccessToken?new d.X:super.resolveDataSource(m)}processEvents(m,p){if(l.$.publicDashboardAccessToken){const h={series:[],timeRange:(0,n.E2)(),state:p.state},r=(0,a.I)(p.events);return r.meta={...r.meta,dataTopic:s.QR.Annotations},h.annotations=[r],h}else return super.processEvents(m,p)}}},79595:(Z,R,e)=>{"use strict";e.d(R,{x:()=>E});var n=e(74848),a=e(22803),s=e(7389),l=e(51898),o=e(36674),d=e(63142),i=e(31286),c=e(41654),m=e(92745),p=e(21285);function h({panelEditor:T}){const{tableView:O,dataPane:I}=T.useState();return(0,n.jsx)(n.Fragment,{children:I&&(0,n.jsx)(p.K,{label:(0,m.t)("dashboard-scene.panel-edit-controls.table-view-label-table-view","Table view"),showLabel:!0,id:"table-view",value:!!O,onClick:T.onToggleTableView,"aria-label":(0,m.t)("dashboard-scene.panel-edit-controls.table-view-aria-label-toggletableview","Toggle table view"),"data-testid":l.Tp.components.PanelEditor.toggleTableView})})}var r=e(8285),g=e(63704),y=e(45967),v=e(4137),x=e(82345),f=e(86871);function u({links:T,dashboard:O}){o.jh.getTimeRange(O).useState();const I=O.state.uid;return!T||!I?null:(0,n.jsx)(n.Fragment,{children:T.map((j,W)=>{const B=(0,x.mQ)().getAnchorInfo(j),S=`${j.title}-$${W}`;if(j.type==="dashboards")return(0,n.jsx)(v.aK,{link:j,linkInfo:B,dashboardUID:I},S);const w=f.G[j.icon],N=(0,n.jsx)(v.Zx,{icon:w,href:(0,g.Jf)(B.href),target:j.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":l.Tp.components.DashboardLinks.link,children:B.title});return(0,n.jsx)("div",{"data-testid":l.Tp.components.DashboardLinks.container,children:j.tooltip?(0,n.jsx)(y.m,{content:B.tooltip,children:N}):N},S)})})}var b=e(18303);class E extends o.Bs{constructor(O){super({timePicker:O.timePicker??new o.KE({}),refreshPicker:O.refreshPicker??new o.WM({}),...O}),this._variableDependency=new o.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new o.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let I;return this.state.hideTimeControls&&(I=this.state.refreshPicker.activate()),()=>{I&&I()}})}static{this.Component=D}getUrlState(){return{}}updateFromUrl(O){const{hideTimeControls:I,hideVariableControls:j,hideLinksControls:W}=this.state,B=S=>O[S]==="true"||O[S]==="";!I&&B("_dash.hideTimePicker")&&this.setState({hideTimeControls:!0}),!j&&B("_dash.hideVariables")&&this.setState({hideVariableControls:!0}),!W&&B("_dash.hideLinks")&&this.setState({hideLinksControls:!0})}_onAnyVariableChanged(){(0,r.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const O=o.jh.getVariables(this)?.state.variables.some(w=>w.state.hide!==s.zL.hideVariable),I=o.jh.getDataLayers(this).some(w=>w.state.isEnabled&&!w.state.isHidden),j=(0,r.YQ)(this).state.links?.length>0,W=this.state.hideLinksControls||!j,B=this.state.hideVariableControls||!I&&!O,S=this.state.hideTimeControls;return!(B&&W&&S)}}function D({model:T}){const{refreshPicker:O,timePicker:I,hideTimeControls:j,hideVariableControls:W,hideLinksControls:B}=T.useState(),S=(0,r.YQ)(T),{links:w,editPanel:N}=S.useState(),M=(0,d.of)(P),L=window.location.search.includes("scene-debugger");return T.hasControls()?(0,n.jsxs)("div",{"data-testid":l.Tp.pages.Dashboard.Controls,className:(0,a.cx)(M.controls,N&&M.controlsPanelEdit),children:[(0,n.jsxs)(c.B,{grow:1,wrap:"wrap",children:[!W&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.v,{dashboard:S}),(0,n.jsx)(C,{dashboard:S})]}),(0,n.jsx)(i.a,{grow:1}),!B&&!N&&(0,n.jsx)(u,{links:w,dashboard:S}),N&&(0,n.jsx)(h,{panelEditor:N})]}),!j&&(0,n.jsxs)(c.B,{justifyContent:"flex-end",children:[(0,n.jsx)(I.Component,{model:I}),(0,n.jsx)(O.Component,{model:O})]}),L&&(0,n.jsx)(o.or,{scene:T},"scene-debugger")]}):(0,n.jsx)(i.a,{padding:1})}function C({dashboard:T}){const O=o.jh.getDataLayers(T,!0);return(0,n.jsx)(n.Fragment,{children:O.map(I=>(0,n.jsx)(I.Component,{model:I},I.state.key))})}function P(T){return{controls:(0,a.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:T.spacing(1),padding:T.spacing(2),flexDirection:"row",flexWrap:"nowrap",position:"relative",width:"100%",marginLeft:"auto",[T.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),controlsPanelEdit:(0,a.css)({paddingRight:0}),embedded:(0,a.css)({background:"unset",position:"unset"})}}},88632:(Z,R,e)=>{"use strict";e.d(R,{s:()=>s});var n=e(74848),a=e(36674);class s extends a.ps{constructor(o){super({...o,name:o.name??"Data layers",annotationLayers:o.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((o,d)=>{o.annotationLayers!==d.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(o){this.setState({annotationLayers:[...this.state.annotationLayers,o]})}getAllLayers(){const o=[...this.state.annotationLayers];return this.state.alertStatesLayer&&o.push(this.state.alertStatesLayer),o}static{this.Component=({model:o})=>{const{annotationLayers:d}=o.useState();return(0,n.jsx)(n.Fragment,{children:d.map(i=>(0,n.jsx)(i.Component,{model:i},i.state.key))})}}}},36605:(Z,R,e)=>{"use strict";e.d(R,{L:()=>o});var n=e(36674),a=e(9931),s=e(18615),l=e(8285);class o extends n.Bs{constructor(i){super(i),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const i=this.parent;let c,m,p;if(!(i instanceof n.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(!this.containsDashboardDSQueries(i))return;try{p=(0,l.YQ)(i)}catch{return}const h=i.state.queries.find(u=>u.panelId!==void 0);if(!h)return;const r=h.panelId,g=(0,l.XA)(r),y=(0,l.EX)(p,g);if(!(y instanceof n.Eb))return;const v=(0,l.iL)(y);if(v&&!v.state.isLoaded){c=v.subscribeToState(u=>{this.handleLibPanelStateUpdates(u,i,y)});return}const x=(0,l.un)(y);if(!x)throw new Error("Could not find SceneQueryRunner for panel");const f=x.parent;return f instanceof n.Es&&f.state.transformations.length&&(m=f.subscribeToState((u,b)=>{u.data!==b.data&&i.runQueries()})),this.prevRequestId&&this.prevRequestId!==x.state.data?.request?.requestId&&i.runQueries(),()=>{this.prevRequestId=x?.state.data?.request?.requestId,c&&c.unsubscribe(),m&&m.unsubscribe()}}containsDashboardDSQueries(i){return i.state.datasource?.uid===a.K?!0:i.state.datasource?.uid===s.uv&&i.state.queries.some(c=>c.datasource?.uid===a.K)}handleLibPanelStateUpdates(i,c,m){if(i&&i?.isLoaded){if(!((0,l.un)(m)instanceof n.dt))throw new Error("Could not find SceneQueryRunner for library panel");c.runQueries()}}}},88499:(Z,R,e)=>{"use strict";e.d(R,{M:()=>l});var n=e(36674),a=e(8285);class s{constructor(d,i){this._sceneObject=i,this.state={name:d,type:"dashboard_macro"}}getValue(d){const i=(0,a.YQ)(this._sceneObject);switch(d){case"uid":return i.state.uid||"";case"title":case"name":case"id":default:return i.state.title}}getValueText(){return""}}function l(){const o=n.Go.registerVariableMacro("__dashboard",s);return()=>o()}},44804:(Z,R,e)=>{"use strict";e.d(R,{s:()=>i});var n=e(2543),a=e.n(n),s=e(36674),l=e(60379),o=e(41644),d=e(72746);class i extends s.Bs{constructor(m){super(m),this._log=(0,l.h)("DashboardReloadBehavior"),this.reloadDashboard=(0,n.debounce)(this.reloadDashboard).bind(this);const p=!!this.state.uid&&!!this.state.reloadOnParamsChange;this.addActivationHandler(()=>{p&&(this._dashboardScene=s.jh.getAncestor(this,d.H$),this._variableDependency=new s.Sh(this,{onAnyVariableChanged:h=>{this._log.logger("onAnyVariableChanged",h.state.name,JSON.stringify(h.getValue())),this.reloadDashboard()},dependsOnScopes:!0}))})}getCurrentState(){const m=s.jh.getScopes(this)??[],p=s.jh.getTimeRange(this).state.value;return{scopes:m.map(h=>h.metadata.name),from:p.from.toISOString(),to:p.to.toISOString(),...s.Go.getUrlState(this._dashboardScene?.state.$variables),version:this._dashboardScene?.state.version}}isEditing(){return!!this._dashboardScene?.state.isEditing}isWaitingForVariables(){const m=s.jh.getVariables(this.parent);return m.state.variables.some(p=>m.isVariableLoadingOrWaitingToUpdate(p))}reloadDashboard(){if(this.isEditing()||this.isWaitingForVariables()){this._log.logger("DashboardReloadBehavior reloadDashboard isEditing or waiting for variables, skipping reload");return}const m=this.getCurrentState(),p=this._prevState??{};p.from=m.from,p.to=m.to;const h=!(0,n.isEqual)(m,this._prevState);this._log.logger(`DashboardReloadBehavior reloadDashboard stateChanged ${h?"true":"false"}`,this._prevState,m),h&&(this._prevState=m,setTimeout(()=>{(0,o.sP)().reloadDashboard(m)}))}}},72746:(Z,R,e)=>{"use strict";e.d(R,{H$:()=>vt,vk:()=>et});var n=e(92138),a=e(1906),s=e(92745),l=e(36490),o=e(43173),d=e(75234),i=e(36674),c=e(45229),m=e(95943),p=e(84057),h=e(29043),r=e(10605),g=e(22429),y=e(7817),v=e(82612),x=e(79718),f=e(88813),u=e(87745),b=e(75735),E=e(3688),D=e(3371),C=e(8285);function P(fe){return"onDelete"in fe}var T=e(73427);class O{constructor(ae){this._elements=ae,this.isEditableDashboardElement=!0}useEditPaneOptions(){return[]}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.objects","Objects"),icon:"folder",instanceName:""}}onConfirmDelete(){T.lE.publish(new u.bY({title:(0,s.t)("dashboard.edit-pane.elements.multiple-elements","Multiple elements"),text:(0,s.t)("dashboard.edit-pane.elements.multiple-elements-delete-text","Are you sure you want to delete these elements?"),onConfirm:()=>this.onDelete()}))}onDelete(){this._elements.forEach(ae=>ae.onDelete())}}var I=e(33143);class j{constructor(ae){this._isNewElement=!1,this.selectedObjects=new Map(ae),this._isMultiSelection=ae.length>1,this.isMultiSelection&&(this.sameType=this.checkSameType())}markAsNewElement(){this._isNewElement=!0}isNewElement(){return this._isNewElement}checkSameType(){const ae=this.selectedObjects.values(),xe=ae.next().value?.resolve().constructor.name;if(!xe)return!1;for(let Le of ae??[])if(Le.resolve().constructor.name!==xe)return!1;return!0}hasValue(ae){return this.selectedObjects.has(ae)}removeValue(ae){this.selectedObjects.delete(ae),this.selectedObjects.size<2&&(this.sameType=void 0,this._isMultiSelection=!1)}getStateWithValue(ae,xe,Le){const Ze=xe.getRef();let at=[{id:ae}],ut=[[ae,Ze]];const Et=this.getSelectionEntries()??[],Wt=Et.map(([_t])=>({id:_t}));return Le&&(ut=[[ae,Ze],...Et],at=[{id:ae},...Wt]),{selection:ut,contextItems:at}}getStateWithoutValueAt(ae){this.removeValue(ae);const xe=this.getSelectionEntries()??[],Le=xe.map(([Ze])=>({id:Ze}));return{entries:xe,contextItems:Le}}getSelection(){return this.isMultiSelection?this.getSceneObjects():this.getFirstObject()}getSelectionEntries(){return Array.from(this.selectedObjects.entries())}getFirstObject(){return this.selectedObjects.values().next().value?.resolve()}get isMultiSelection(){return this._isMultiSelection}getSceneObjects(){return Array.from(this.selectedObjects.values()??[]).map(ae=>ae.resolve())}createSelectionElement(){const ae=this.getSceneObjects();if(ae.length===0)return;const xe=(0,I.wT)(ae[0]);if(!xe)return;if(ae.length===1)return xe;if(this.sameType&&xe.createMultiSelectedElement){const Ze=ae.map(at=>(0,I.wT)(at));return xe.createMultiSelectedElement(Ze)}const Le=[];for(const Ze of ae){const at=(0,I.wT)(Ze);at&&P(at)&&Le.push(at)}if(Le.length)return new O(Le)}}class W extends i.Bs{constructor(){super({selectionContext:{enabled:!1,selected:[],onSelect:(ae,xe)=>this.selectElement(ae,xe),onClear:()=>this.clearSelection()},undoStack:[],redoStack:[]}),this.addActivationHandler(this.onActivate.bind(this))}onActivate(){const ae=(0,C.YQ)(this);this._subs.add(ae.subscribeToEvent(I.BF,({payload:xe})=>{this.handleEditAction(xe)})),this._subs.add(ae.subscribeToEvent(I.jO,({payload:xe})=>{this.newObjectAddedToCanvas(xe)})),this._subs.add(ae.subscribeToEvent(I.ck,({payload:xe})=>{this.clearSelection()})),this._subs.add(ae.subscribeToEvent(I.su,({payload:xe})=>{this.forceRender()})),this._subs.add(ae.subscribeToEvent(I.N4,({payload:xe})=>{this.forceRender()}))}handleEditAction(ae){if(this.state.redoStack.length>0&&this.setState({redoStack:[]}),this.performAction(ae),this.setState({undoStack:[...this.state.undoStack,ae]}),ae.source instanceof i.Eb){const xe=ae.source.parent;(0,E.y)(xe)&&xe.editingCompleted&&xe.editingCompleted(!0)}}undoAction(){const ae=this.state.undoStack.slice(),xe=ae.pop();xe&&(xe.undo(),xe.source.publishEvent(new I.WG({source:xe.source}),!0),xe.addedObject&&this.clearSelection(),xe.movedObject&&this.selectObject(xe.movedObject,xe.movedObject.state.key,{force:!0}),xe.removedObject&&this.newObjectAddedToCanvas(xe.removedObject),this.setState({undoStack:ae,redoStack:[...this.state.redoStack,xe]}))}performAction(ae){ae.perform(),ae.source.publishEvent(new I.WG({source:ae.source}),!0),ae.addedObject&&this.newObjectAddedToCanvas(ae.addedObject),ae.movedObject&&this.selectObject(ae.movedObject,ae.movedObject.state.key,{force:!0}),ae.removedObject&&this.clearSelection()}redoAction(){const ae=this.state.redoStack.slice(),xe=ae.pop();xe&&(this.performAction(xe),this.setState({redoStack:ae,undoStack:[...this.state.undoStack,xe]}))}enableSelection(){this.setState({selectionContext:{...this.state.selectionContext,enabled:!0}})}disableSelection(){this.setState({selectionContext:{...this.state.selectionContext,selected:[],enabled:!1},selection:void 0})}selectElement(ae,xe){if((0,D.uc)(ae.id)){if(xe.multi)return;this.clearSelection();return}let Le=i.jh.findByKey(this,ae.id);if(Le){if(Le instanceof i.Eb&&(0,D.ag)((0,D.Dq)(ae.id))){const Ze=(0,C.Uv)(this,ae.id);Ze&&(Le=Ze)}this.selectObject(Le,ae.id,xe)}}getSelection(){return this.state.selection?.getSelection()}selectObject(ae,xe,{multi:Le,force:Ze}={}){if(!Ze){if(Le){if(this.state.selection?.hasValue(xe)){this.removeMultiSelectedObject(xe);return}}else if(this.state.selection?.getFirstObject()===ae){this.clearSelection();return}}const at=this.state.selection??new j([[xe,ae.getRef()]]),{selection:ut,contextItems:Et}=at.getStateWithValue(xe,ae,!!Le);this.updateSelection(new j(ut),Et)}removeMultiSelectedObject(ae){if(!this.state.selection)return;const{entries:xe,contextItems:Le}=this.state.selection.getStateWithoutValueAt(ae);if(xe.length===0){this.clearSelection();return}this.updateSelection(new j([...xe]),Le)}updateSelection(ae,xe){document.activeElement instanceof HTMLElement&&document.activeElement.blur(),this.setState({selection:ae,selectionContext:{...this.state.selectionContext,selected:xe}})}clearSelection(){this.state.selection&&this.updateSelection(void 0,[])}newObjectAddedToCanvas(ae){this.selectObject(ae,ae.state.key),this.state.selection?.markAsNewElement()}}var B=e(3204),S=e(74848),w=e(54314),N=e(60208),M=e(8207),L=e(30906),A=e(55266);function U(fe){const xe=new URLSearchParams(window.location.search).get("folderUid")||void 0,{repository:Le,isInstanceManaged:Ze}=(0,A.T)({folderName:xe});return o.$.featureToggles.provisioning?fe.isManagedRepository()||!!Le||Ze:!1}var F=e(76459),V=e.n(F),K=e(96540),G=e(49785),H=e(51898),_=e(45861),k=e(34999),J=e(41654),z=e(37386),Y=e(63527),X=e(87105),Q=e(21285),q=e(31286),te=e(72636),ne=e(91156),se=e(89223),ue=e(87161),de=e(8535);async function ie(fe){if(!fe||!o.$.featureToggles.provisioning)return{};const xe=(await(0,de.JD)(ue.Z.endpoints.getFolder.initiate({name:fe})).unwrap()).metadata.annotations?.[b.Jw];return xe?{k8s:{annotations:{[b.Jw]:xe,[b.LH]:b.Sf.Repo}}}:{}}var he=e(68143);function me(fe){return(0,he.NF)(fe)&&fe.data&&fe.data.status==="version-mismatch"}function ce(fe){return(0,he.NF)(fe)&&fe.data&&fe.data.status==="name-exists"}function Pe(fe){return(0,he.NF)(fe)&&fe.data&&fe.data.status==="plugin-dashboard"}function Ie({cancelButton:fe,saveButton:ae}){return o.$.featureToggles.restoreDashboards?(0,S.jsxs)(k.F,{title:(0,s.t)("save-dashboards.name-exists.title","Dashboard name already exists"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,S.jsxs)(k.F,{title:(0,s.t)("dashboard-scene.name-already-exists-error.title-name-already-exists","Name already exists"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.name-already-exists-error.body-name-already-exists",children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsxs)(J.B,{alignItems:"center",children:[fe,ae(!0)]})})]})}function Se({overwrite:fe,isLoading:ae,isValid:xe,onSave:Le}){return(0,S.jsx)(_.$n,{disabled:!xe||ae,icon:ae?"spinner":void 0,onClick:()=>Le(fe),variant:fe?"destructive":"primary","data-testid":H.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:ae?(0,s.t)("dashboard-scene.save-button.saving","Saving..."):fe?(0,s.t)("dashboard-scene.save-button.save-and-overwrite","Save and overwrite"):(0,s.t)("dashboard-scene.save-button.save","Save")})}var Me=e(41053),Te=e(27489),Ge=e(64762),Qe=e(38206),tt=e(18346),ke=e(52763),He=e(77731);function Re(fe=!1){const ae=(0,ke.wA)(),xe=(0,Ge._2)(),[Le]=(0,tt.e8)(),[Ze,at]=(0,Me.A)(async(ut,Et)=>{{let Wt=Et.rawDashboardJSON??ut.getSaveModel();Et.saveAsCopy&&(Wt=ut.getSaveAsModel({isNew:Et.isNew,title:Et.title,description:Et.description,copyTags:Et.copyTags}));const _t=await Le({dashboard:Wt,folderUid:Et.folderUid,message:Et.message,overwrite:Et.overwrite,showErrorAlert:!1,k8s:Et.k8s});if("error"in _t)throw _t.error;const nn=_t.data;ut.saveCompleted(Wt,nn,Et.folderUid),c.A.publish(new u.Eu),xe.success((0,s.t)("dashboard-scene.use-save-dashboard.message-dashboard-saved","Dashboard saved")),(0,He.ko)(nn.uid),fe?(0,Te.rR)("grafana_dashboard_copied",{name:Wt.title,url:nn.url}):(0,Te.rR)(`grafana_dashboard_${nn.uid?"saved":"created"}`,{name:Wt.title,url:nn.url});const dn=l.Ny.getLocation(),Pn=n.I.stripBaseFromUrl(nn.url);return Pn!==dn.pathname&&setTimeout(()=>{l.Ny.push({pathname:Pn,search:dn.search})}),ut.state.meta.isStarred&&ae((0,Qe.TU)({id:nn.uid,title:ut.state.title,url:Pn})),_t.data}},[ae,xe]);return{state:Ze,onSaveDashboard:at}}function Ne({dashboard:fe,changeInfo:ae}){const{changedSaveModel:xe}=ae,{register:Le,handleSubmit:Ze,setValue:at,formState:ut,getValues:Et,watch:Wt}=(0,G.mN)({mode:"onBlur",defaultValues:{title:ae.isNew?xe.title:`${xe.title} Copy`,description:xe.description??"",folder:{uid:fe.state.meta.folderUid,title:fe.state.meta.folderTitle},copyTags:!1}}),{errors:_t,isValid:nn}=ut,dn=Wt(),{state:Pn,onSaveDashboard:Nn}=Re(!1),[Cn,Tn]=(0,K.useState)({}),[_n,ka]=(0,K.useState)(!1),ja=async gs=>{const ts=Et();(await Nn(fe,{overwrite:gs,folderUid:ts.folder.uid,rawDashboardJSON:xe,saveAsCopy:!0,isNew:ae.isNew,copyTags:ts.copyTags,title:ts.title,description:ts.description})).status==="success"?fe.closeModal():Tn({title:ts.title,folderUid:ts.folder.uid})},ds=(0,S.jsx)(_.$n,{variant:"secondary",onClick:()=>fe.closeModal(),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-as-form.cancel-button.cancel",children:"Cancel"})}),da=gs=>{const ts=!nn&&_n?!0:nn;return(0,S.jsx)(Se,{isValid:ts,isLoading:Pn.loading,onSave:ja,overwrite:gs})};function _a(gs){const ts=dn.title.trim()===Cn.title&&dn.folder.uid===Cn.folderUid;return ce(gs)&&ts?(0,S.jsx)(Ie,{cancelButton:ds,saveButton:da}):(0,S.jsxs)(S.Fragment,{children:[gs&&ts&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.save-dashboard-as-form.render-footer.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:gs.message&&(0,S.jsx)("p",{children:gs.message})}),(0,S.jsxs)(J.B,{alignItems:"center",children:[ds,da(!1)]})]})}return(0,S.jsxs)("form",{onSubmit:Ze(()=>ja(!1)),children:[(0,S.jsx)(z.D,{label:(0,S.jsx)(Ae,{onChange:at}),invalid:!!_t.title,error:_t.title?.message,children:(0,S.jsx)(Y.p,{...Le("title",{required:"Required",validate:Be}),"aria-label":(0,s.t)("dashboard-scene.save-dashboard-as-form.aria-label-save-dashboard-title-field","Save dashboard title field"),"data-testid":H.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:V()(async gs=>{at("title",gs.target.value,{shouldValidate:!0})},400)})}),(0,S.jsx)(z.D,{label:(0,S.jsx)(Ue,{onChange:at}),invalid:!!_t.description,error:_t.description?.message,children:(0,S.jsx)(X.f,{...Le("description",{required:!1}),"aria-label":(0,s.t)("dashboard-scene.save-dashboard-as-form.aria-label-save-dashboard-description-field","Save dashboard description field"),autoFocus:!0})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.save-dashboard-as-form.label-folder","Folder"),children:(0,S.jsx)(ne.d,{onChange:async(gs,ts)=>{at("folder",{uid:gs,title:ts});const Mr=fe.state.meta.folderUid;ka(gs!==Mr);const si=await ie(gs);fe.setState({meta:{...si,folderUid:gs}})},value:dn.folder?.uid})}),!ae.isNew&&(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.save-dashboard-as-form.label-copy-tags","Copy tags"),children:(0,S.jsx)(Q.d,{...Le("copyTags")})}),(0,S.jsx)(q.a,{paddingTop:2,children:_a(Pn.error)})]})}function Ae(fe){return(0,S.jsx)(J.B,{justifyContent:"space-between",children:(0,S.jsx)(te.J,{htmlFor:"description",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.title-field-label.title",children:"Title"})})})}function Ue(fe){return(0,S.jsx)(J.B,{justifyContent:"space-between",children:(0,S.jsx)(te.J,{htmlFor:"description",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.description-label.description",children:"Description"})})})}async function Be(fe,ae){if(fe===ae.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await se.P.validateNewDashboardName(ae.folder.uid??"general",fe),!0}catch(xe){return xe instanceof Error?xe.message:"Dashboard name is invalid"}}var We=e(32635);function _e({dashboard:fe,drawer:ae,changeInfo:xe}){const{hasChanges:Le,hasMigratedToV2:Ze,changedSaveModel:at}=xe,{state:ut,onSaveDashboard:Et}=Re(!1),[Wt,_t]=(0,K.useState)({folderUid:fe.state.meta.folderUid,k8s:{...fe.serializer.getK8SMetadata()}}),nn=async Tn=>{(await Et(fe,{...Wt,rawDashboardJSON:at,overwrite:Tn})).status==="success"&&(fe.closeModal(),ae.state.onSaveSuccess?.())},dn=(0,S.jsx)(_.$n,{variant:"secondary",onClick:()=>fe.closeModal(),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.cancel-button.cancel",children:"Cancel"})}),Pn=Tn=>(0,S.jsx)(Se,{isValid:Le,isLoading:ut.loading,onSave:nn,overwrite:Tn}),Nn=Tn=>Tn&&Tn.length>500;function Cn(Tn){if(Nn(Wt.message)){const _n=Wt.message?.length??0;return(0,S.jsx)(k.F,{title:(0,s.t)("save-dashboards.message-length.title","Message too long"),severity:"error",children:(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"save-dashboards.message-length.info",children:["The message is ",{messageLength:_n}," characters, which exceeds the maximum length of 500 characters. Please shorten it before saving."]})})})}return me(Tn)?(0,S.jsxs)(k.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-someone-else-has-updated-this-dashboard","Someone else has updated this dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.would-still-dashboard",children:"Would you still like to save this dashboard?"})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsxs)(J.B,{alignItems:"center",children:[dn,Pn(!0)]})})]}):ce(Tn)?(0,S.jsx)(Ie,{cancelButton:dn,saveButton:Pn}):Pe(Tn)?(0,S.jsxs)(k.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-plugin-dashboard","Plugin dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin. Use ",(0,S.jsx)("strong",{children:"Save as"})," to create custom version."]})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsxs)(J.B,{alignItems:"center",children:[dn,Pn(!0)]})})]}):(0,S.jsxs)(S.Fragment,{children:[Tn&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:(0,S.jsx)("p",{children:Tn.message})}),(0,S.jsxs)(J.B,{alignItems:"center",children:[dn,Pn(!1),!Le&&(0,S.jsx)("div",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.no-changes-to-save",children:"No changes to save"})})]})]})}return(0,S.jsxs)(J.B,{gap:2,direction:"column",children:[(0,S.jsx)(Xe,{drawer:ae,changeInfo:xe}),Ze&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.title-dashboard-drastically-changed","Dashboard irreversibly changed"),severity:"warning",children:(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.body-dashboard-drastically-changed",children:"The dashboard will be saved using the new experimental Grafana dashboard schema. This action can\u2019t be reverted and could result in the irreversible loss of data. We recommend that you save this dashboard as a copy instead. If you\u2019re seeing this message in a production environment, contact Support to have the feature disabled."})})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.save-dashboard-form.label-message","Message"),children:(0,S.jsx)(X.f,{"aria-label":(0,s.t)("dashboard-scene.save-dashboard-form.aria-label-message","message"),value:Wt.message??"",onChange:Tn=>{_t({...Wt,message:Tn.currentTarget.value})},placeholder:(0,s.t)("dashboard-scene.save-dashboard-form.placeholder-describe-changes-optional","Add a note to describe your changes (optional)."),autoFocus:!0,rows:5})}),Cn(ut.error)]})}function Xe({drawer:fe,changeInfo:ae}){const{saveVariables:xe=!1,saveTimeRange:Le=!1,saveRefresh:Ze=!1}=fe.useState(),{hasTimeChanges:at,hasVariableValueChanges:ut,hasRefreshChange:Et}=ae;return(0,S.jsxs)(J.B,{direction:"column",alignItems:"flex-start",children:[at&&(0,S.jsx)(We.S,{id:"save-timerange",checked:Le,onChange:fe.onToggleSaveTimeRange,label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-timerange-label-update-default-time-range","Update default time range"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-timerange-description-current-range-default","Will make current time range the new default"),"data-testid":H.Tp.pages.SaveDashboardModal.saveTimerange}),Et&&(0,S.jsx)(We.S,{id:"save-refresh",label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-refresh-label-update-default-refresh-value","Update default refresh value"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-refresh-description-current-refresh-default","Will make the current refresh the new default"),checked:Ze,onChange:fe.onToggleSaveRefresh,"data-testid":H.Tp.pages.SaveDashboardModal.saveRefresh}),ut&&(0,S.jsx)(We.S,{id:"save-variables",label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-variables-label-update-default-variable-values","Update default variable values"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-variables-description-current-values-default","Will make the current values the new default"),checked:xe,onChange:fe.onToggleSaveVariables,"data-testid":H.Tp.pages.SaveDashboardModal.saveVariables})]})}var le=e(22803),ye=e(4213),pe=e.n(ye),ve=e(70713),be=e(89640),Oe=e(50992),we=e(47931);function ze({dashboard:fe,drawer:ae,changeInfo:xe}){const Le=(0,K.useMemo)(()=>JSON.stringify(xe.changedSaveModel,null,2),[xe]),Ze=(0,K.useCallback)(()=>{const at=new Blob([Le],{type:"application/json;charset=utf-8"});(0,ye.saveAs)(at,xe.changedSaveModel.title+"-"+new Date().getTime()+".json")},[xe.changedSaveModel,Le]);return(0,S.jsx)("div",{className:Ve.container,children:(0,S.jsxs)(J.B,{direction:"column",gap:2,grow:1,children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cannot-be-saved",children:"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source."}),(0,S.jsx)("br",{}),(0,S.jsx)("i",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.see-docs",children:["See"," ",(0,S.jsx)(be.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,S.jsx)("br",{})," ",(0,S.jsx)("br",{}),(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.file-path",values:{filePath:fe.state.meta.provisionedExternalId},children:[(0,S.jsx)("strong",{children:"File path:"})," ","{{filePath}}"]})]}),(0,S.jsx)(Xe,{drawer:ae,changeInfo:xe}),(0,S.jsx)("div",{className:Ve.json,children:(0,S.jsx)(ve.Ay,{disableWidth:!0,children:({height:at})=>(0,S.jsx)(Oe.B,{width:"100%",height:at,language:"json",showLineNumbers:!0,showMiniMap:Le.length>100,value:Le,readOnly:!0})})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsxs)(J.B,{gap:2,children:[(0,S.jsx)(_.$n,{variant:"secondary",onClick:ae.onClose,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cancel",children:"Cancel"})}),(0,S.jsx)(we.b,{icon:"copy",getText:()=>Le,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.copy-json-to-clipboard",children:"Copy JSON to clipboard"})}),(0,S.jsx)(_.$n,{type:"submit",onClick:Ze,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.save-json-to-file",children:"Save JSON to file"})})]})})]})})}const Ve={container:(0,le.css)({height:"100%",display:"flex"}),json:(0,le.css)({flexGrow:1,maxHeight:"800px"})};var ge=e(54148),Ke=e(32899),qe=e(77197),ot=e(91555),lt=e(33680);function mt(fe){const[ae,xe]=(0,lt.tj)(),[Le,Ze]=(0,lt.XM)();return[(0,K.useCallback)(ut=>(fe?Le:ae)(ut),[ae,fe,Le]),fe?Ze:xe]}var Lt=e(89314),Tt=e(52043),It=e(11480);function Mt({defaultValues:fe,dashboard:ae,drawer:xe,changeInfo:Le,isNew:Ze,loadedFromRef:at,isGitHub:ut,workflowOptions:Et,readOnly:Wt}){const _t=(0,ge.Zp)(),nn=(0,d.J7)(),{isDirty:dn,editPanel:Pn}=ae.useState(),[Nn,Cn]=mt(Ze?void 0:fe.path),Tn=(0,G.mN)({defaultValues:fe}),{handleSubmit:_n,watch:ka,control:ja,reset:ds,register:da}=Tn,[_a]=ka(["workflow"]);(0,K.useEffect)(()=>{ds(fe)},[fe,ds]);const gs=gr=>{nn.publish({type:Ke.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.api-error","Error saving dashboard"),gr]})},ts=()=>{Pn?.onDiscard(),xe.onClose(),l.Ny.partial({viewPanel:null,editPanel:null})},Mr=gr=>{Pn?.onDiscard(),xe.onClose();const xo=n.I.assureBaseUrl((0,Tt.u)({uid:gr.metadata.name,slug:qe.A.slugifyForUrl(gr.spec.title??""),currentQueryParams:window.location.search}));_t(xo)},si=(gr,xo)=>{Pn?.onDiscard(),xe.onClose(),_t(`${ot.mL}/${fe.repo}/dashboard/preview/${xo}?ref=${gr}`)};(0,It.J)({dashboard:ae,request:Cn,workflow:_a,handlers:{onBranchSuccess:({ref:gr,path:xo})=>si(gr,xo),onWriteSuccess:ts,onNewDashboardSuccess:Mr,onError:gs},isNew:Ze});const Kl=async({title:gr,description:xo,repo:Di,path:Ci,comment:Sr,ref:so})=>{if(!Di||!Ci){console.error("Missing required fields for saving:",{repo:Di,path:Ci});return}_a==="write"&&(so=at);const ri=ae.getSaveResource({isNew:Ze,title:gr,description:xo});Nn({ref:so,name:Di,path:Ci,message:Sr,body:ri})};return(0,S.jsx)(G.Op,{...Tn,children:(0,S.jsx)("form",{onSubmit:_n(Kl),name:"save-provisioned-form",children:(0,S.jsxs)(J.B,{direction:"column",gap:2,children:[Wt&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.copy-json-message",children:"If you have direct access to the target, copy the JSON and paste it there."})}),Ze&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-title","Title"),invalid:!!Tn.formState.errors.title,error:Tn.formState.errors.title?.message,children:(0,S.jsx)(Y.p,{id:"dashboard-title",...da("title",{required:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-required","Dashboard title is required"),validate:Ut})})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-description","Description"),invalid:!!Tn.formState.errors.description,error:Tn.formState.errors.description?.message,children:(0,S.jsx)(X.f,{id:"dashboard-description",...da("description")})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-target-folder","Target folder"),children:(0,S.jsx)(G.xI,{control:ja,name:"folder",render:({field:{ref:gr,value:xo,onChange:Di,...Ci}})=>(0,S.jsx)(ne.d,{onChange:async(Sr,so)=>{Di({uid:Sr,title:so}),an("folderUid",Sr);const ri=await ie(Sr);ae.setState({meta:{...ri,folderUid:Sr}})},value:xo.uid,...Ci})})})]}),!Ze&&!Wt&&(0,S.jsx)(Xe,{drawer:xe,changeInfo:Le}),(0,S.jsx)(Lt.x,{resourceType:"dashboard",readOnly:Wt,workflow:_a,workflowOptions:Et,isGitHub:ut,isNew:Ze}),(0,S.jsxs)(J.B,{gap:2,children:[(0,S.jsx)(_.$n,{variant:"primary",type:"submit",disabled:Cn.isLoading||!dn||Wt,children:Cn.isLoading?(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.saving","Saving..."):(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.save","Save")}),(0,S.jsx)(_.$n,{variant:"secondary",onClick:xe.onClose,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cancel",children:"Cancel"})})]})]})})})}async function Ut(fe,ae){if(fe===ae.folder.title?.trim())return(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-same-as-folder","Dashboard name cannot be the same as the folder name");try{return await se.P.validateNewDashboardName(ae.folder.uid??"general",fe),!0}catch(xe){return xe instanceof Error?xe.message:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-validation-failed","Dashboard title validation failed.")}}function an(fe,ae){if(!ae)return;const xe=new URL(window.location.href);xe.searchParams.set(fe,ae),window.history.replaceState({},"",xe)}var cn=e(2522);function un({drawer:fe,changeInfo:ae,dashboard:xe}){const{isNew:Le,defaultValues:Ze,loadedFromRef:at,isGitHub:ut,workflowOptions:Et,readOnly:Wt}=(0,cn.S)(xe);return Ze?(0,S.jsx)(Mt,{dashboard:xe,drawer:fe,changeInfo:ae,isNew:Le,defaultValues:Ze,loadedFromRef:at,isGitHub:ut,workflowOptions:Et,readOnly:Wt}):null}class On extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{const ae=this.state.dashboardRef.resolve(),xe=ae.getDashboardChanges();ae.setState({overlay:void 0,meta:xe.isNew?ae.getInitialState()?.meta:ae.state.meta})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:ae})=>{const{showDiff:xe,saveAsCopy:Le,saveTimeRange:Ze,saveVariables:at,saveRefresh:ut}=ae.useState(),Et=ae.state.dashboardRef.resolve().getDashboardChanges(Ze,at,ut),{changedSaveModel:Wt,initialSaveModel:_t,diffs:nn,diffCount:dn,hasFolderChanges:Pn,hasMigratedToV2:Nn}=Et,Cn=dn+(Pn?1:0),Tn=ae.state.dashboardRef.resolve(),{meta:_n}=Tn.useState(),{provisioned:ka,folderTitle:ja}=_n,ds=Tn.managedResourceCannotBeEdited(),da=U(Tn),_a=(0,S.jsxs)(w.U,{children:[(0,S.jsx)(N.o,{label:(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.label-details","Details"),active:!xe,onChangeTab:()=>ae.setState({showDiff:!1})}),Cn>0&&!ds&&(0,S.jsx)(N.o,{label:(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.label-changes","Changes"),active:xe,onChangeTab:()=>ae.setState({showDiff:!0}),counter:Cn})]});let gs=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title","Save dashboard");Le?gs=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title-copy","Save dashboard copy"):(ka||da)&&(gs=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title-provisioned","Provisioned dashboard"));const ts=()=>xe?(0,S.jsx)(L.l,{diff:nn,oldValue:_t,newValue:Wt,hasFolderChanges:Pn,hasMigratedToV2:Nn,oldFolder:Tn.getInitialState()?.meta.folderTitle,newFolder:ja}):da?(0,S.jsx)(un,{dashboard:Tn,changeInfo:Et,drawer:ae}):Le||Et.isNew?(0,S.jsx)(Ne,{dashboard:Tn,changeInfo:Et}):ka||ds?(0,S.jsx)(ze,{dashboard:Tn,changeInfo:Et,drawer:ae}):(0,S.jsx)(_e,{dashboard:Tn,changeInfo:Et,drawer:ae});return(0,S.jsx)(M._,{title:gs,subtitle:Tn.state.title,onClose:ae.onClose,tabs:_a,children:ts()})}}}var yn=e(60171),En=e(65635),Bn=e(95710),fa=e(17862),Fn=e(3392),Ea=e(13241),gt=e(70030),Ht=e(62265);class wt{constructor(){this.elementPanelMap=new Map,this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set}}initializeElementMapping(ae){this.elementPanelMap.clear(),!(!ae||!ae.panels)&&ae.panels?.forEach(xe=>{if(xe.id){const Le=(0,C.XA)(xe.id);this.elementPanelMap.set(Le,xe.id)}})}getElementPanelMapping(){return this.elementPanelMap}initializeDSReferencesMapping(ae){return{}}getDSReferencesMapping(){return this.defaultDsReferencesMap}getPanelIdForElement(ae){return this.elementPanelMap.get(ae)}getElementIdForPanel(ae){for(const[Le,Ze]of this.elementPanelMap.entries())if(Ze===ae)return Le;const xe=(0,C.XA)(ae);return this.elementPanelMap.set(xe,ae),xe}getSaveModel(ae){return(0,gt.Uy)(ae)}getSaveAsModel(ae,xe){const Le=this.getSaveModel(ae);return{...Le,id:null,uid:"",title:xe.title||"",description:xe.description||void 0,tags:xe.isNew||xe.copyTags?Le.tags:[]}}getDashboardChangesFromScene(ae,xe){const Le=this.getSaveModel(ae),Ze=(0,fa.Cj)(this.initialSaveModel,Le,xe.saveTimeRange,xe.saveVariables,xe.saveRefresh),at=ae.getInitialState()?.meta.folderUid!==ae.state.meta.folderUid;return{...Ze,hasFolderChanges:at,hasChanges:Ze.hasChanges||at,hasMigratedToV2:!1}}onSaveComplete(ae,xe){this.initialSaveModel={...ae,id:xe.id,uid:xe.uid,version:xe.version},this.metadata={...this.metadata,k8s:{...this.metadata?.k8s,generation:xe.version}}}getK8SMetadata(){return this.metadata?.k8s}getTrackingInformation(){const ae=this.initialSaveModel?.panels?.map(Ze=>Ze.type)||[],xe=(0,Bn.GC)(ae),Le=(0,Bn.wM)(this.initialSaveModel?.templating?.list||[]);if(this.initialSaveModel)return{uid:this.initialSaveModel.uid,title:this.initialSaveModel.title,schemaVersion:this.initialSaveModel.schemaVersion,panels_count:this.initialSaveModel.panels?.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...xe,...Le}}getSnapshotUrl(){return this.initialSaveModel?.snapshot?.originalUrl}async makeExportableExternally(ae){const xe=this.getSaveModel(ae),Le=new y.G(xe,void 0,{getVariablesFromState:()=>(0,Ea.E)(window.__grafanaSceneContext)});return await(0,Fn.E)(Le)}}class Yt{constructor(){this.elementPanelMap=new Map,this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set}}getElementPanelMapping(){return this.elementPanelMap}initializeElementMapping(ae){if(this.elementPanelMap.clear(),!ae||!ae.elements)return;Object.keys(ae.elements).forEach(Le=>{const Ze=ae.elements[Le];Ze.kind==="Panel"&&this.elementPanelMap.set(Le,Ze.spec.id)})}initializeDSReferencesMapping(ae){if(ae===void 0||ae&&!(0,yn.aK)(ae))return;if(this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set},Object.keys(ae?.elements||{}).forEach(Le=>{const Ze=ae?.elements[Le];if(Ze?.kind==="Panel"){const at=Ze.spec.data.spec.queries;for(const ut of at)if(!ut.spec.datasource){const Et=this.getElementIdForPanel(Ze.spec.id);this.defaultDsReferencesMap.panels.has(Et)||this.defaultDsReferencesMap.panels.set(Et,new Set),this.defaultDsReferencesMap.panels.get(Et).add(ut.spec.refId)}}}),ae?.variables)for(const Le of ae.variables)Le.kind==="QueryVariable"&&!Le.spec.datasource&&this.defaultDsReferencesMap.variables.add(Le.spec.name);if(ae?.annotations)for(const Le of ae.annotations)Le.spec.datasource||this.defaultDsReferencesMap.annotations.add(Le.spec.name)}getDSReferencesMapping(){return this.defaultDsReferencesMap}getPanelIdForElement(ae){return this.elementPanelMap.get(ae)}getElementIdForPanel(ae){for(const[Le,Ze]of this.elementPanelMap.entries())if(Ze===ae)return Le;const xe=(0,C.XA)(ae);return this.elementPanelMap.set(xe,ae),xe}getSaveModel(ae){return(0,Ht.Xl)(ae)}getSaveAsModel(ae,xe){const Le=this.getSaveModel(ae);return{...Le,title:xe.title||"",description:xe.description||"",tags:xe.isNew||xe.copyTags?Le.tags:[]}}getDashboardChangesFromScene(ae,xe){const Le=this.getSaveModel(ae),Ze=(0,fa.AM)(this.initialSaveModel,Le,xe.saveTimeRange,xe.saveVariables,xe.saveRefresh),at=ae.getInitialState()?.meta.folderUid!==ae.state.meta.folderUid,ut=!ae.getInitialState()?.uid;return{...Ze,hasFolderChanges:at,hasChanges:Ze.hasChanges||at,isNew:ut,hasMigratedToV2:!!Ze.hasMigratedToV2}}onSaveComplete(ae,xe){this.initialSaveModel={...ae},this.metadata&&(this.metadata={...this.metadata,generation:xe.version})}getK8SMetadata(){return this.metadata}getTrackingInformation(ae){if(!this.initialSaveModel)return;const xe="elements"in this.initialSaveModel?Object.values(this.initialSaveModel.elements).filter(at=>at.kind==="Panel").map(at=>at.spec.vizConfig.kind):[],Le=(0,Bn.GC)(xe),Ze="variables"in this.initialSaveModel?(0,Bn.z9)(this.initialSaveModel.variables):[];return{schemaVersion:En.O2,uid:ae.state.uid,title:this.initialSaveModel.title,panels_count:xe.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...Le,...Ze}}getSnapshotUrl(){return this.metadata?.annotations?.[b.UL]}async makeExportableExternally(ae){return await(0,Fn.j)(this.getSaveModel(ae))}}function rn(fe){return fe==="v2"?new Yt:new wt}var Xt=e(4974),on=e(17340),pn=e(67350),Un=e(9683),In=e(19161),Gn=e(64423),Wa=e(19379),za=e(84229),Oa=e(80011),ss=e(88632),La=e(99392),Ca=e(33380);class Ka{constructor(ae){this._scene=ae,this.events=new Wa.o,this._subs=new Gn.yU;const xe=i.jh.getTimeRange(ae);this.formatDate=this.formatDate.bind(this),this._subs.add(xe.subscribeToState((Le,Ze)=>{Le.value!==Ze.value&&this.events.publish(new d.sR(Le.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return i.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const ae=i.jh.getTimeRange(this._scene);return{from:ae.state.from,to:ae.state.to}}get panels(){return As(this._scene,xe=>xe instanceof i.Eb).map(xe=>new Ca.R(xe))}get annotations(){const ae={list:[]};return this._scene.state.$data instanceof ss.s&&(ae.list=(0,La.O)(this._scene.state.$data.state.annotationLayers)),ae}getTimezone(){return i.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const ae of this._scene.state.$behaviors)if(ae instanceof i.Gg.K2)return ae.state.sync}return za.y.Off}otherPanelInFullscreen(ae){return!1}formatDate(ae,xe){return(0,Oa.LE)(ae,{format:xe,timeZone:this.getTimezone()})}getPanelById(ae){const xe=(0,C.vL)(this._scene,(0,C.XA)(ae));return xe?new Ca.R(xe):null}removePanel(ae){const xe=(0,C.vL)(this._scene,(0,C.XA)(ae.id));if(!xe){console.error("Trying to remove a panel that was not found in scene",ae);return}this._scene.removePanel(xe)}canEditAnnotations(ae){return this._scene.canEditDashboard()?ae?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function As(fe,ae){let xe=[];return fe.forEachChild(Le=>{ae(Le)?xe.push(Le):xe=xe.concat(As(Le,ae))}),xe}var Ia=e(1682);function _s(fe){let ae=5381;for(let xe=0;xe<fe.length;xe++)ae=ae*33^fe.charCodeAt(xe);return ae>>>0}var Fa=e(22079),xt=e(63142);class dt extends i.Bs{constructor(ae){super({...ae,jsonText:""}),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onSave=()=>{},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getJsonText(){const ae=this.state.dashboardRef.resolve();return JSON.stringify((0,Ht.Xl)(ae),null,2)}static{this.Component=({model:ae})=>{const{jsonText:xe}=ae.useState(),Le=(0,xt.of)(St),Ze=()=>(0,S.jsxs)("div",{className:Le.wrapper,children:[(0,S.jsx)(Oe.B,{width:"100%",value:xe,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Le.codeEditor,onBlur:at=>ae.setState({jsonText:at})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsx)(_.$n,{onClick:ae.onSave,disabled:!0,children:"Update dashboard"})})]});return(0,S.jsx)(M._,{title:"[DEV] Schema V2 editor",subtitle:"Allows editing dashboard using v2 schema. Changes are not persisted in db.",onClose:ae.onClose,children:Ze()})}}}const St=fe=>({wrapper:(0,le.css)({display:"flex",height:"100%",flexDirection:"column",gap:fe.spacing(2)}),codeEditor:(0,le.css)({flexGrow:1})});var jt=e(24438),Qt=e(7094);class Jt extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,C.YQ)(this).closeModal()},this.onAddLibraryPanel=ae=>{const xe=(0,C.YQ)(this),Le=(0,C.O8)();Le.setState({title:ae.model.title,hoverHeader:!ae.model.title,$behaviors:[new Qt.u({uid:ae.uid,name:ae.name})]});const Ze=this.state.panelToReplaceRef?.resolve();if(Ze){const at=Ze.parent;at&&(0,E.y)(at)&&(Le.setState({key:Ze.state.key}),at.setElementBody(Le))}else xe.addPanel(Le);this.onClose()}}static{this.Component=({model:ae})=>{const xe=(0,s.t)("library-panel.add-widget.title","Add panel from panel library");return(0,S.jsx)(M._,{title:xe,onClose:ae.onClose,children:(0,S.jsx)(jt.j,{onClick:ae.onAddLibraryPanel,variant:jt.s.Tight,showPanelFilter:!0})})}}}var ln=e(36324);function fn(fe){return"isDashboardDropTarget"in fe&&fe.isDashboardDropTarget===!0}class gn extends i.Bs{constructor(){super({}),this._sourceDropTarget=null,this._lastDropTarget=null,this._pointerDistance=(0,ln.b)(),this._isSelectedObject=!1,this._onPointerMove=this._onPointerMove.bind(this),this._stopDraggingSync=this._stopDraggingSync.bind(this),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return()=>{document.body.removeEventListener("pointermove",this._onPointerMove),document.body.removeEventListener("pointerup",this._stopDraggingSync)}}startDraggingSync(ae,xe){this._pointerDistance.set(ae),this._isSelectedObject=!1;const Le=i.jh.findObject(xe,fn);!Le||!fn(Le)||(this._sourceDropTarget=Le,this._lastDropTarget=Le,document.body.addEventListener("pointermove",this._onPointerMove),document.body.addEventListener("pointerup",this._stopDraggingSync),this.setState({draggingPanel:xe.getRef()}))}_stopDraggingSync(ae){const xe=this.state.draggingPanel?.resolve();this._sourceDropTarget!==this._lastDropTarget&&setTimeout(()=>{this._sourceDropTarget?.draggedPanelOutside?.(xe),this._lastDropTarget?.draggedPanelInside?.(xe)}),document.body.removeEventListener("pointermove",this._onPointerMove),document.body.removeEventListener("pointerup",this._stopDraggingSync),this.setState({draggingPanel:void 0})}_onPointerMove(ae){if(!this._isSelectedObject&&this.state.draggingPanel&&this._pointerDistance.check(ae)){this._isSelectedObject=!0;const Le=this.state.draggingPanel?.resolve();this._getDashboard().state.editPane.selectObject(Le,Le.state.key,{force:!0,multi:!1})}const xe=this._getDropTargetUnderMouse(ae)??this._sourceDropTarget;xe&&xe!==this._lastDropTarget&&(this._lastDropTarget?.setIsDropTarget?.(!1),this._lastDropTarget=xe,xe!==this._sourceDropTarget&&xe.setIsDropTarget?.(!0))}_getDashboard(){if(!(this.parent instanceof vt))throw new Error("Parent is not a DashboardScene");return this.parent}_getDropTargetUnderMouse(ae){const xe=document.elementsFromPoint(ae.clientX,ae.clientY);if(xe.some(ut=>ut.getAttribute("data-dashboard-drop-target-key")===this._sourceDropTarget?.state.key))return null;const Ze=xe?.find(ut=>ut.getAttribute("data-dashboard-drop-target-key"))?.getAttribute("data-dashboard-drop-target-key");if(!Ze)return null;const at=i.jh.findByKey(this._getDashboard(),Ze);return!at||!fn(at)?null:at}}var vn=e(75683),wn=e(69896),Rt=e(13791),bt=e(92293),Vt=e(56887),Kt=e(94076),Dt=e(82754),Zt=e(66483),Ln=e(33149),Qn=e(78685),va=e(93008),Wn=e(7895),ia=e(66404),kn=e(30703),na=e(92807);function Ga(fe){const[ae,xe]=(0,K.useState)({}),Le=Wt=>{fe.onChangeName&&xe({isRenaming:!0,originalName:fe.getEditableElementInfo().instanceName})},Ze=()=>{ae.error&&fe.onChangeName(ae.originalName),xe({})},at=(0,K.useMemo)(()=>Wt=>{Wt?.focus(),Wt?.select()},[]),ut=Wt=>{const _t=fe.onChangeName(Wt.target.value);_t?.errorMessage?xe({...ae,error:_t.errorMessage}):ae.error&&xe({...ae,error:void 0})},Et=Wt=>{Wt.key==="Enter"&&Ze()};return{isRenaming:ae.isRenaming,onNameDoubleClicked:Le,renameInputRef:at,onChangeName:ut,onInputBlur:Ze,onInputKeyDown:Et}}function Ps({editPane:fe}){const ae=(0,C.YQ)(fe);return(0,S.jsx)(q.a,{padding:1,gap:0,display:"flex",direction:"column",element:"ul",role:"tree",position:"relative",children:(0,S.jsx)(ls,{sceneObject:ae,editPane:fe,depth:0})})}function ls({sceneObject:fe,editPane:ae,depth:xe}){const Le=(0,xt.of)(Ta),{key:Ze}=fe.useState(),[at,ut]=(0,K.useState)(xe>0),{isSelected:Et,onSelect:Wt}=(0,Vt.y)(Ze),_t=(0,K.useMemo)(()=>(0,D.uc)(Ze),[Ze]),nn=(0,K.useMemo)(()=>(0,I.wT)(fe),[fe]),dn=(0,s.t)("dashboard.outline.tree-item.no-title","<no title>"),Pn=nn.getOutlineChildren?.()??[],Nn=nn.getEditableElementInfo(),Cn=Nn.instanceName===""?dn:Nn.instanceName,Tn=Ga(nn),_n=!!nn.getOutlineChildren,ka=ds=>{ds.stopPropagation(),Et||Wt?.(ds),nn.scrollIntoView?.()},ja=ds=>{ds.stopPropagation(),ut(!at)};return(0,S.jsxs)("li",{role:"treeitem","aria-selected":Et,className:Le.container,onClick:ka,style:{"--depth":xe},children:[(0,S.jsxs)("div",{className:(0,le.cx)(Le.row,{[Le.rowSelected]:Et}),children:[(0,S.jsx)("div",{className:Le.indentation}),_n&&(0,S.jsx)("button",{className:Le.angleButton,onClick:ja,"data-testid":H.Tp.components.PanelEditor.Outline.node(Cn),children:(0,S.jsx)(kn.I,{name:at?"angle-right":"angle-down"})}),(0,S.jsxs)("button",{className:(0,le.cx)(Le.nodeName,{[Le.nodeNameClone]:_t}),onDoubleClick:Tn.onNameDoubleClicked,"data-testid":H.Tp.components.PanelEditor.Outline.item(Cn),children:[(0,S.jsx)(kn.I,{size:"sm",name:Nn.icon}),Tn.isRenaming?(0,S.jsx)("input",{ref:Tn.renameInputRef,type:"text",value:Nn.instanceName,className:Le.outlineInput,onChange:Tn.onChangeName,onBlur:Tn.onInputBlur,onKeyDown:Tn.onInputKeyDown}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(J.B,{direction:"row",gap:.5,alignItems:"center",grow:1,children:[(0,S.jsx)("span",{children:Cn}),Nn.isHidden&&(0,S.jsx)(kn.I,{name:"eye-slash",size:"sm",className:Le.hiddenIcon})]}),_t&&(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard.outline.repeated-item",children:"Repeat"})})]})]})]}),_n&&!at&&(0,S.jsx)("ul",{className:Le.nodeChildren,role:"group",children:Pn.length>0?Pn.map(ds=>(0,S.jsx)(ls,{sceneObject:ds,editPane:ae,depth:xe+1},ds.state.key)):(0,S.jsx)(ia.E,{color:"secondary",element:"li",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard.outline.tree-item.empty",children:"(empty)"})})})]})}function Ta(fe){return{container:(0,le.css)({display:"flex",gap:fe.spacing(.5),flexGrow:1,flexDirection:"column",borderRadius:fe.shape.radius.default,color:fe.colors.text.secondary}),containerSelected:(0,le.css)({outline:`1px dashed ${fe.colors.primary.border} !important`,outlineOffset:"0px",color:fe.colors.text.primary}),row:(0,le.css)({display:"flex",gap:fe.spacing(.5),borderRadius:fe.shape.radius.default,"&:hover":{color:fe.colors.text.primary,outline:`1px dashed ${fe.colors.border.strong}`,backgroundColor:fe.colors.emphasize(fe.colors.background.primary,.05)}}),rowSelected:(0,le.css)({color:fe.colors.text.primary,outline:`1px dashed ${fe.colors.primary.border} !important`,backgroundColor:fe.colors.emphasize(fe.colors.background.primary,.05)}),indentation:(0,le.css)({marginLeft:`calc(var(--depth) * ${fe.spacing(3)})`}),angleButton:(0,le.css)({boxShadow:"none",border:"none",background:"transparent",borderRadius:fe.shape.radius.default,padding:0,color:"inherit",lineHeight:0}),nodeName:(0,le.css)({boxShadow:"none",border:"none",background:"transparent",padding:0,borderRadius:fe.shape.radius.default,color:"inherit",display:"flex",flexGrow:1,alignItems:"center",gap:fe.spacing(.5),overflow:"hidden","> span":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}),hiddenIcon:(0,le.css)({color:fe.colors.text.secondary,marginLeft:fe.spacing(1)}),nodeNameClone:(0,le.css)({color:fe.colors.text.secondary,cursor:"not-allowed"}),outlineInput:(0,le.css)({border:`1px solid ${fe.components.input.borderColor}`,height:fe.spacing(3),borderRadius:fe.shape.radius.default,"&:focus":{outline:"none",boxShadow:"none"}}),nodeChildren:(0,le.css)({display:"flex",flexDirection:"column",position:"relative",gap:fe.spacing(.5),"&::before":{content:'""',position:"absolute",width:"1px",height:"100%",pointerEvents:"none",zIndex:1,background:fe.colors.border.weak,marginLeft:`calc(11px + ${fe.spacing(3)} * var(--depth))`}})}}var aa=e(76319),Gs=e(88559),Os=e(87063);function Zs({element:fe,editPane:ae}){const xe=fe.getEditableElementInfo(),Le=(0,xt.of)(lr),Ze=fe.onCopy?.bind(fe),at=fe.onDuplicate?.bind(fe),ut=fe.onDelete?.bind(fe),Et=fe.onConfirmDelete?.bind(fe),Wt=()=>ae.clearSelection(),_t=ae.state.selection;return(0,S.jsxs)("div",{className:Le.wrapper,children:[(0,S.jsxs)(J.B,{direction:"row",gap:.5,children:[_t&&(0,S.jsx)(aa.K,{name:"arrow-left",size:"lg",onClick:Wt,tooltip:(0,s.t)("grafana.dashboard.edit-pane.go-back","Go back"),"aria-label":(0,s.t)("grafana.dashboard.edit-pane.go-back","Go back"),"data-testid":H.Tp.components.EditPaneHeader.backButton}),(0,S.jsx)(ia.E,{children:xe.typeName})]}),(0,S.jsxs)(J.B,{direction:"row",gap:1,children:[fe.renderActions&&fe.renderActions(),(Ze||at)&&(0,S.jsx)(Gs.m,{overlay:(0,S.jsxs)(Os.W,{children:[Ze?(0,S.jsx)(Os.W.Item,{icon:"copy",label:(0,s.t)("dashboard.layout.common.copy","Copy"),onClick:Ze}):null,at?(0,S.jsx)(Os.W.Item,{icon:"file-copy-alt",label:(0,s.t)("dashboard.layout.common.duplicate","Duplicate"),onClick:at}):null]}),children:(0,S.jsx)(_.$n,{tooltip:(0,s.t)("dashboard.layout.common.copy-or-duplicate","Copy or Duplicate"),tooltipPlacement:"bottom",variant:"secondary",size:"sm",icon:"copy","data-testid":H.Tp.components.EditPaneHeader.copyDropdown,children:(0,S.jsx)(kn.I,{name:"angle-down"})})}),(ut||Et)&&(0,S.jsx)(_.$n,{onClick:Et||ut,size:"sm",variant:"destructive",fill:"outline",icon:"trash-alt",tooltip:(0,s.t)("dashboard.layout.common.delete","Delete"),"data-testid":H.Tp.components.EditPaneHeader.deleteButton})]})]})}function lr(fe){return{wrapper:(0,le.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:fe.spacing(1,2),borderBottom:`1px solid ${fe.colors.border.weak}`})}}function Xs({element:fe,editPane:ae,isNewElement:xe}){const Le=fe.useEditPaneOptions?fe.useEditPaneOptions(xe):[],Ze=(0,xt.of)(jo);return(0,S.jsxs)("div",{className:Ze.wrapper,children:[(0,S.jsx)(Zs,{element:fe,editPane:ae}),(0,S.jsx)(na.P,{showScrollIndicators:!0,children:(0,S.jsx)("div",{className:Ze.categories,children:Le.map(at=>at.render())})})]})}function jo(fe){return{wrapper:(0,le.css)({display:"flex",flexDirection:"column",flex:"1 1 0",height:"100%"}),categories:(0,le.css)({display:"flex",flexDirection:"column",borderBottom:`1px solid ${fe.colors.border.weak}`})}}function ci(fe,ae){return(0,K.useMemo)(()=>{if(!fe){const xe=(0,C.YQ)(ae);return new j([[xe.state.uid,xe.getRef()]]).createSelectionElement()}return fe.createSelectionElement()},[fe,ae])}function Xr({editPane:fe,isCollapsed:ae,onToggleCollapse:xe,openOverlay:Le}){const{selection:Ze}=(0,i.gn)(fe,{shouldActivateOrKeepAlive:!0}),at=(0,xt.of)(vs),ut=(0,xt.of)(_.my),Et=ci(Ze,fe),Wt=Ze?.getFirstObject(),_t=Ze?.isNewElement()??!1,[nn,dn]=(0,Qn.A)("grafana.dashboard.edit-pane.outline.collapsed",!0),[Pn=.4,Nn]=(0,Qn.A)("grafana.dashboard.edit-pane.outline.size",.4),Cn=(0,va.h)({direction:"column",handleSize:"sm",initialSize:1-Pn,dragPosition:"middle",onSizeChanged:Tn=>{Nn(1-Tn)}});return Et?ae?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:at.expandOptionsWrapper,children:(0,S.jsx)(Wn.I,{tooltip:(0,s.t)("dashboard.edit-pane.open","Open options pane"),icon:"arrow-to-right",onClick:xe,variant:"canvas",narrow:!0,className:at.rotate180,"aria-label":(0,s.t)("dashboard.edit-pane.open","Open options pane")})}),Le&&(0,S.jsx)(Ln.c,{className:at.overlayWrapper,defaultSize:{height:"100%",width:"300px"},children:(0,S.jsx)(Xs,{element:Et,editPane:fe,isNewElement:_t},Wt?.state.key)})]}):(nn?(Cn.primaryProps.style.flexGrow=1,Cn.primaryProps.style.minHeight="unset",Cn.secondaryProps.style.flexGrow=0,Cn.secondaryProps.style.minHeight="min-content"):(Cn.primaryProps.style.minHeight="unset",Cn.secondaryProps.style.minHeight="unset"),(0,S.jsx)("div",{className:at.wrapper,children:(0,S.jsxs)("div",{...Cn.containerProps,children:[(0,S.jsx)("div",{...Cn.primaryProps,className:(0,le.cx)(Cn.primaryProps.className,at.paneContent),children:(0,S.jsx)(Xs,{element:Et,editPane:fe,isNewElement:_t},Wt?.state.key)}),(0,S.jsx)("div",{...Cn.splitterProps,className:(0,le.cx)(Cn.splitterProps.className,at.splitter),"data-edit-pane-splitter":!0}),(0,S.jsxs)("div",{...Cn.secondaryProps,className:(0,le.cx)(Cn.secondaryProps.className,at.paneContent),children:[(0,S.jsxs)("button",{type:"button",onClick:()=>dn(!nn),className:(0,le.cx)(ut,at.outlineCollapseButton),"data-testid":H.Tp.components.PanelEditor.Outline.section,children:[(0,S.jsx)(ia.E,{weight:"medium",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-edit-pane-renderer.outline",children:"Outline"})}),(0,S.jsx)(kn.I,{name:nn?"angle-up":"angle-down"})]}),!nn&&(0,S.jsx)("div",{className:at.outlineContainer,children:(0,S.jsx)(na.P,{showScrollIndicators:!0,children:(0,S.jsx)(Ps,{editPane:fe})})})]})]})})):null}function vs(fe){return{wrapper:(0,le.css)({display:"flex",flexDirection:"column",flex:"1 1 0",marginTop:fe.spacing(2),borderLeft:`1px solid ${fe.colors.border.weak}`,borderTop:`1px solid ${fe.colors.border.weak}`,background:fe.colors.background.primary,borderTopLeftRadius:fe.shape.radius.default}),overlayWrapper:(0,le.css)({right:0,bottom:0,top:fe.spacing(2),position:"absolute !important",background:fe.colors.background.primary,borderLeft:`1px solid ${fe.colors.border.weak}`,borderTop:`1px solid ${fe.colors.border.weak}`,boxShadow:fe.shadows.z3,zIndex:fe.zIndex.navbarFixed,flexGrow:1}),paneContent:(0,le.css)({overflow:"hidden",display:"flex",flexDirection:"column"}),rotate180:(0,le.css)({rotate:"180deg"}),tabsbar:(0,le.css)({padding:fe.spacing(0,1),margin:fe.spacing(.5,0)}),expandOptionsWrapper:(0,le.css)({display:"flex",flexDirection:"column",padding:fe.spacing(2,1,2,0)}),splitter:(0,le.css)({"&::after":{background:"transparent",transform:"unset",width:"100%",height:"1px",top:"100%",left:"0"}}),outlineCollapseButton:(0,le.css)({display:"flex",padding:fe.spacing(.5,2),gap:fe.spacing(1),justifyContent:"space-between",alignItems:"center",background:fe.colors.background.secondary,"&:hover":{background:fe.colors.action.hover}}),outlineContainer:(0,le.css)({display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"})}}function ks({dashboard:fe,isEditing:ae,body:xe,controls:Le}){const Ze=(0,bt.k)(),{editPane:at}=fe.state,ut=(0,xt.of)(Ys,Ze??0),[Et,Wt]=(0,I.dt)();if(!o.$.featureToggles.dashboardNewLayouts)return(0,S.jsx)(Kt.A,{onSetScrollRef:fe.onSetScrollRef,children:(0,S.jsxs)("div",{className:ut.canvasWrappperOld,children:[(0,S.jsx)(Zt.c,{dashboard:fe}),(0,S.jsx)("div",{className:ut.controlsWrapperSticky,children:Le}),(0,S.jsx)("div",{className:ut.body,children:xe})]})});const{containerProps:_t,primaryProps:nn,secondaryProps:dn,splitterProps:Pn,splitterState:Nn,onToggleCollapse:Cn}=(0,Dt.L)({direction:"row",dragPosition:"end",initialSize:330,handleSize:"sm",usePixels:!0,collapseBelowPixels:250,collapsed:Et});(0,K.useEffect)(()=>{Wt(Nn.collapsed)},[Nn.collapsed,Wt]),(0,K.useEffect)(()=>{ae?at.enableSelection():at.disableSelection()},[ae,at]);const{selectionContext:Tn}=(0,i.gn)(at,{shouldActivateOrKeepAlive:!0}),_n={};ae||(nn.style.flexGrow=1,nn.style.width="100%",nn.style.minWidth="unset",_n.overflow="unset");const ka=ja=>{ja&&fe.onSetScrollRef(new Kt.X(ja))};return(0,S.jsx)("div",{..._t,style:_n,children:(0,S.jsxs)(Vt._.Provider,{value:Tn,children:[(0,S.jsxs)("div",{...nn,className:(0,le.cx)(nn.className,ut.canvasWithSplitter),onPointerDown:ja=>{ja.shiftKey||at.clearSelection()},children:[(0,S.jsx)(Zt.c,{dashboard:fe}),(0,S.jsx)("div",{className:(0,le.cx)(!ae&&ut.controlsWrapperSticky),children:Le}),(0,S.jsx)("div",{className:ut.bodyWrapper,children:(0,S.jsx)("div",{className:(0,le.cx)(ut.body,ae&&ut.bodyEditing),"data-testid":H.Tp.components.DashboardEditPaneSplitter.primaryBody,ref:ka,children:xe})})]}),ae&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{...Pn,className:(0,le.cx)(Pn.className,ut.splitter),"data-edit-pane-splitter":!0}),(0,S.jsx)("div",{...dn,className:(0,le.cx)(dn.className,ut.editPane),children:(0,S.jsx)(Xr,{editPane:at,isCollapsed:Et,onToggleCollapse:Cn,openOverlay:Tn.selected.length>0})})]})]})})}function Ys(fe,ae){return{canvasWrappperOld:(0,le.css)({label:"canvas-wrapper-old",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitter:(0,le.css)({overflow:"unset",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitterEditing:(0,le.css)({overflow:"unset"}),bodyWrapper:(0,le.css)({label:"body-wrapper",display:"flex",flexDirection:"column",flexGrow:1,position:"relative"}),body:(0,le.css)({label:"body",display:"flex",flexGrow:1,gap:fe.spacing(1),boxSizing:"border-box",flexDirection:"column",padding:fe.spacing(.125,2,2,2)}),bodyEditing:(0,le.css)({position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto",scrollbarWidth:"thin",scrollbarGutter:"stable",paddingRight:fe.spacing(1)}),editPane:(0,le.css)({flexDirection:"column"}),splitter:(0,le.css)({"&:after":{display:"none"}}),controlsWrapperSticky:(0,le.css)({[fe.breakpoints.up("md")]:{position:"sticky",zIndex:fe.zIndex.activePanel,background:fe.colors.background.canvas,top:ae}})}}var Lo=e(46942),rs=e.n(Lo),Vs=e(93389),Hs=e(1131),yr=e(39765);const qr="--panels-per-row";function xr({dashboard:fe,panelSearch:ae="",panelsPerRow:xe}){const{body:Le}=fe.state,Ze=[],at=(0,xt.of)(Br),[ut,Et]=(0,K.useState)(""),Wt=Le instanceof Hs.D?Le.state.grid:null;if(!Wt)return(0,S.jsx)(s.x6,{i18nKey:"panel-search.unsupported-layout",children:"Unsupported layout"});for(const _t of Wt.state.children)if(_t instanceof Vs.U)Tr(_t,fe,ae,Ze,Et);else if(_t instanceof i.tI)for(const nn of _t.state.children)nn instanceof Vs.U&&Tr(nn,fe,ae,Ze,Et);return Ze.length>0?(0,S.jsx)("div",{className:rs()(at.grid,{[at.perRow]:xe!==void 0}),style:{[qr]:xe},children:Ze.map(_t=>(0,S.jsx)(Ws,{panel:_t},_t.state.key))}):(0,S.jsx)("p",{className:at.noHits,children:(0,S.jsx)(s.x6,{i18nKey:"panel-search.no-matches",children:"No matches found"})})}function Ws({panel:fe}){return(0,K.useEffect)(()=>{const ae=(0,C.zo)(fe);return()=>{ae?.()}},[fe]),(0,S.jsx)(fe.Component,{model:fe})}function Br(fe){return{grid:(0,le.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:fe.spacing(1),gridAutoRows:"320px"}),perRow:(0,le.css)({gridTemplateColumns:`repeat(var(${qr}, 3), 1fr)`}),noHits:(0,le.css)({display:"grid",placeItems:"center"})}}function Tr(fe,ae,xe,Le,Ze){const at=i.jh.interpolate(ae,xe).toLowerCase();if(fe.state.variableName&&!fe.isActive){const Et=fe.state.body;Et.interpolate(Et.state.title,void 0,"text").toLowerCase().includes(at)&&(fe.subscribeToEvent(yr.d,_t=>{_t.payload.source instanceof Vs.U&&Ze(_t.payload.source.state.key??"")}),fe.activate())}const ut=fe.state.repeatedPanels??[fe.state.body];for(const Et of ut)Et.interpolate(Et.state.title,void 0,"text").toLowerCase().includes(at)&&Le.push(Et);return Le}function uo({model:fe}){const{controls:ae,overlay:xe,editview:Le,editPanel:Ze,viewPanelScene:at,panelSearch:ut,panelsPerRow:Et,isEditing:Wt,layoutOrchestrator:_t}=fe.useState(),{type:nn}=(0,ge.g)(),dn=(0,ge.zy)(),Pn=(0,K.useContext)(wn.j),Nn=(0,ke.d4)(ds=>ds.navIndex),Cn=fe.getPageNav(dn,Nn),Tn=fe.getBodyToRender(),_n=(0,p.tc)(Nn,`dashboards/${nn==="snapshot"?"snapshots":"browse"}`),ka=Le!==void 0;if((0,K.useMemo)(()=>{(at||ka||Ze)&&fe.rememberScrollPos()},[ka,Ze,at,fe]),(0,K.useEffect)(()=>{!at&&!ka&&!Ze&&fe.restoreScrollPos()},[ka,Ze,at,fe]),(0,K.useEffect)(()=>{if(Pn&&Wt)return Pn.setReadOnly(!0),()=>{Pn.setReadOnly(!1)}},[Pn,Wt]),Le)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Le.Component,{model:Le}),xe&&(0,S.jsx)(xe.Component,{model:xe})]});function ja(){return!at&&(ut||Et)?(0,S.jsx)(xr,{panelSearch:ut,panelsPerRow:Et,dashboard:fe}):(0,S.jsx)(Tn.Component,{model:Tn})}return(0,S.jsxs)(S.Fragment,{children:[_t&&(0,S.jsx)(_t.Component,{model:_t}),(0,S.jsxs)(Rt.Y,{navModel:_n,pageNav:Cn,layout:vn.k.Custom,children:[Ze&&(0,S.jsx)(Ze.Component,{model:Ze}),!Ze&&(0,S.jsx)(ks,{dashboard:fe,isEditing:Wt,controls:ae&&(0,S.jsx)(ae.Component,{model:ae}),body:ja()}),xe&&(0,S.jsx)(xe.Component,{model:xe})]})]})}var eo=e(6262),Xo=e(14252),Ur=e(61215),or=e(26689),fr=e(991),to=e(68079),ho=e(18857),zr=e(15130),Gr=e(11257),fo=e(55386),Bo=e(5114),Hr=e(2543),po=e(77154),Uo=e(739),hs=e(28105),qo=e(8095),ys=e(34273);function At(fe){const ae=[];if(fe?.series)for(const xe of fe.series)ae.push((0,po.Nw)(xe));if(fe?.annotations)for(const xe of fe.annotations){const Le=(0,po.Nw)(xe);Le.schema?.meta||(Le.schema.meta={}),Le.schema.meta.dataTopic=Uo.QR.Annotations,ae.push(Le)}return ae}function bn(fe,ae){const xe={panelType:fe.state.pluginId,datasource:"??"},Le=o.$.buildInfo.versionString;let Ze=`| Key | Value |
|--|--|
| Panel | ${xe.panelType} @ ${fe.state.pluginVersion??Le} |
| Grafana | ${Le} // ${o.$.buildInfo.edition} |
`;return ae&&(Ze+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+ae+"\n```\n</details>"),Ze}async function An(fe,ae,xe){let Le={type:""};const Ze=fe.parent;(0,C.ME)(fe)?Le={...(0,gt.ZB)(Ze),...(0,gt.Z6)(fe)}:Le=(0,gt.ZB)(Ze);const at=(0,Hr.cloneDeep)(Zn),ut={panelType:fe.state.pluginId,datasource:"??"},Et=(0,C.un)(fe);if(!Et.state.data)return;const Wt=Et.state.data,_t=Et?.state.datasource,nn=(0,ys.W)(At(Wt),ae),dn=o.$.buildInfo.versionString,Pn=Et.state.queries??[],Nn=Wt.annotations?Wt.annotations.reduce((Tn,_n)=>_n.length+Tn,0):0,Cn=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${ut.panelType} @ ${Le.pluginVersion??dn}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Pn.map(Tn=>{const _n=Tn.datasource??_t;return`${Tn.refId}[${_n?.type}]`}).join(", ")}</td>
    </tr>
    ${pa(Le)}
    ${zn(Wt,nn)}
    ${la(Wt)}
    <tr>
      <th>Grafana</th>
      <td>${dn} // ${o.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(at.panels[0]={...Le,...at.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:qo.nj.Snapshot,snapshot:nn}]},delete at.panels[0].libraryPanel,Le.transformations?.length){const Tn=at.panels[at.panels.length-1];Tn.title=Tn.title+" (after transformations)";const _n=(0,Hr.cloneDeep)(Tn);_n.id=100,_n.title="Data (before transformations)",_n.gridPos.w=24,_n.targets[0].withTransforms=!1,at.panels.push(_n)}return Nn>0&&at.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:Uo.QR.Annotations,refId:"A"}]}),at.panels[1].options.content=Cn,at.panels[2].options.content=JSON.stringify(Le,null,2),at.title=`Debug: ${Le.title} // ${(0,Oa.LE)(new Date)}`,at.tags=["debug",`debug-${ut.panelType}`],at.time={from:xe.from.toISOString(),to:xe.to.toISOString()},at}function pa(fe){return fe.transformations?`<tr>
      <th>Transform</th>
      <td>${fe.transformations.map(ae=>ae.id).join(", ")}</td>
  </tr>`:""}function zn(fe,ae){let xe=fe.series.length??0,Le=0,Ze=0;for(const at of fe.series)Le+=at.fields.length,Ze+=at.length;return`<tr><th>Data</th><td>${fe.state!==hs.Gu.Done?fe.state:""} ${xe} frames, ${Le} fields, ${Ze} rows </td></tr>`}function la(fe){return fe.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${fe.annotations.reduce((ae,xe)=>xe.length+ae,0)}</td>
</tr>`:""}const Zn={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Vn=(fe=>(fe[fe.Support=0]="Support",fe[fe.Data=1]="Data",fe))(Vn||{}),Hn=(fe=>(fe[fe.PanelSnapshot=0]="PanelSnapshot",fe[fe.GithubComment=1]="GithubComment",fe))(Hn||{});class Ja extends Bo.Q{constructor(ae){super({panel:ae,panelTitle:i.jh.interpolate(ae,ae.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:(0,s.t)("dashboard-scene.support-snapshot-service.label.git-hub-comment","GitHub comment"),description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:(0,s.t)("dashboard-scene.support-snapshot-service.label.panel-support-snapshot","Panel support snapshot"),description:(0,s.t)("dashboard-scene.support-snapshot-service.description.dashboard-troubleshoot-visualization-issues","Dashboard JSON used to help troubleshoot visualization issues"),value:0}]}),this.onCurrentTabChange=xe=>{this.setState({currentTab:xe})},this.onShowMessageChange=xe=>{this.setState({showMessage:xe.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:xe}=this.state,Le=Math.pow(1024,2)*1.5;return xe.length>Le?(this.setState({error:{title:(0,s.t)("dashboard-scene.support-snapshot-service.title.copy-to-clipboard-failed","Copy to clipboard failed"),message:"Snapshot is too large, consider download and attaching a file instead"}}),""):xe},this.onDownloadDashboard=()=>{const{snapshotText:xe,panelTitle:Le}=this.state,Ze=new Blob([xe],{type:"text/plain"}),at=`debug-${Le}-${(0,Oa.LE)(new Date)}.json.txt`;pe()(Ze,at)},this.onSetSnapshotText=xe=>{this.setState({snapshotText:xe})},this.onToggleRandomize=xe=>{const{randomize:Le}=this.state;this.setState({randomize:{...Le,[xe]:!Le[xe]}})}}async buildDebugDashboard(){const{panel:ae,randomize:xe,snapshotUpdate:Le}=this.state,Ze=await An(ae,xe,i.jh.getTimeRange(ae).state.value),at=JSON.stringify(Ze,null,2),ut=bn(ae,at),Et=(0,fo.cN)((0,fo.j_)("bytes")(at?.length??0));let Wt;if(Ze)try{Wt=(0,Un.wM)({dashboard:Ze,meta:{isEmbedded:!0}}).state.body}catch(_t){console.log("Error creating scene:",_t)}this.setState({snapshot:Ze,snapshotText:at,markdownText:ut,snapshotSize:Et,snapshotUpdate:Le+1,scene:Wt})}}function Ua({panel:fe,onClose:ae}){const xe=(0,xt.of)(Ha),Le=(0,K.useMemo)(()=>new Ja(fe),[fe]),Ze=fe.getPlugin(),{currentTab:at,loading:ut,error:Et,options:Wt,showMessage:_t,snapshotSize:nn,markdownText:dn,snapshotText:Pn,randomize:Nn,panelTitle:Cn,scene:Tn}=Le.useState();if((0,K.useEffect)(()=>{Le.buildDebugDashboard()},[Le,Ze,Nn]),!Ze)return null;const _n=[{label:(0,s.t)("dashboard-scene.help-wizard.tabs.label.snapshot","Snapshot"),value:Vn.Support},{label:(0,s.t)("dashboard-scene.help-wizard.tabs.label.data","Data"),value:Vn.Data}],ka=o.$.supportBundlesEnabled&&zr.TP.hasPermission(Gr.w.ActionSupportBundlesCreate);return(0,S.jsxs)(M._,{title:(0,s.t)("dashboard-scene.help-wizard.title-get-help-with-this-panel","Get help with this panel"),size:"lg",onClose:ae,subtitle:(0,S.jsxs)(J.B,{direction:"column",gap:1,children:[(0,S.jsxs)(J.B,{direction:"row",gap:1,children:[(0,S.jsx)(fr.y,{featureState:a.Ay.beta}),(0,S.jsx)(be.Y,{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",external:!0,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.troubleshooting-docs",children:"Troubleshooting docs"})})]}),(0,S.jsx)("span",{className:"muted",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.troubleshooting-request-help",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."})}),ka&&(0,S.jsx)("span",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene-help-wizard.support-bundle",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,S.jsx)(be.Y,{href:"/support-bundles",children:"support bundles section"}),"."]})})]}),tabs:(0,S.jsx)(w.U,{children:_n.map((ja,ds)=>(0,S.jsx)(N.o,{label:ja.label,active:ja.value===at,onChangeTab:()=>Le.onCurrentTabChange(ja.value)},`${ja.value}-${ds}`))}),children:[ut&&(0,S.jsx)(to.y,{}),Et&&(0,S.jsx)(k.F,{title:Et.title,children:Et.message}),at===Vn.Data&&(0,S.jsxs)("div",{className:xe.code,children:[(0,S.jsxs)("div",{className:xe.opts,children:[(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-template","Template"),className:xe.field,children:(0,S.jsx)(ho.l6,{options:Wt,value:_t,onChange:Le.onShowMessageChange})}),_t===Hn.GithubComment?(0,S.jsx)(we.b,{icon:"copy",getText:Le.onGetMarkdownForClipboard,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.copy-to-clipboard",children:"Copy to clipboard"})}):(0,S.jsx)(_.$n,{icon:"download-alt",onClick:Le.onDownloadDashboard,children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.help-wizard.download-snapshot",children:["Download (",{snapshotSize:nn},")"]})})]}),(0,S.jsx)(ve.Ay,{disableWidth:!0,children:({height:ja})=>(0,S.jsx)(Oe.B,{width:"100%",height:ja,language:_t===Hn.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:_t===Hn.GithubComment?dn:Pn,readOnly:!1,onBlur:Le.onSetSnapshotText})})]}),at===Vn.Support&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-randomize-data","Randomize data"),description:(0,s.t)("dashboard-scene.help-wizard.description-randomize-data","Modify the original data to hide sensitive information. Note the lengths will stay the same, and duplicate values will be equal."),children:(0,S.jsxs)(J.B,{children:[(0,S.jsx)(Q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-labels-label-labels","Labels"),id:"randomize-labels",showLabel:!0,value:!!Nn.labels,onChange:()=>Le.onToggleRandomize("labels")}),(0,S.jsx)(Q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-field-names-label-field-names","Field names"),id:"randomize-field-names",showLabel:!0,value:!!Nn.names,onChange:()=>Le.onToggleRandomize("names")}),(0,S.jsx)(Q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-string-values-label-string-values","String values"),id:"randomize-string-values",showLabel:!0,value:!!Nn.values,onChange:()=>Le.onToggleRandomize("values")})]})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-support-snapshot","Support snapshot"),description:(0,s.t)("dashboard-scene.help-wizard.description-support-snapshot","Panel: {{panelTitle}}",{panelTitle:Cn}),children:(0,S.jsxs)(J.B,{children:[(0,S.jsx)(_.$n,{icon:"download-alt",onClick:Le.onDownloadDashboard,children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.help-wizard.download-dashboard",children:["Dashboard (",{snapshotSize:nn},")"]})}),(0,S.jsx)(we.b,{icon:"github",getText:Le.onGetMarkdownForClipboard,title:(0,s.t)("dashboard-scene.help-wizard.title-complete-git-hub-comment-clipboard","Copy a complete GitHub comment to the clipboard"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.copy-to-clipboard",children:"Copy to clipboard"})})]})}),(0,S.jsx)("div",{style:{height:"100%",overflow:"auto",display:"flex"},children:Tn&&(0,S.jsx)(Tn.Component,{model:Tn})})]})]})}const Ha=fe=>({code:(0,le.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,le.css)({width:"100%"}),opts:(0,le.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:fe.spacing(1)}})});var ha=e(42836);class Ba extends i.Bs{constructor(ae){super({...ae,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=xe=>{this.setState({options:xe})}}getTabLabel(){return(0,s.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return or.q.Data}static{this.Component=({model:ae})=>{const{options:xe}=ae.useState(),Le=ae.state.panelRef.resolve(),Ze=i.jh.getData(Le),{data:at}=xs(Ze,xe.withTransforms).useState(),ut=i.jh.getTimeRange(Le);return at||s.x6,(0,S.jsx)(ha.q,{isLoading:at?.state===hs.Gu.Loading,data:at?.series,options:xe,hasTransformations:ya(Ze),timeZone:ut.getTimeZone(),panelPluginId:Le.state.pluginId,dataName:i.jh.interpolate(Le,Le.state.title),fieldConfig:Le.state.fieldConfig,onOptionsChange:ae.onOptionsChange})}}}function ya(fe){return fe instanceof i.Es?fe.state.transformations.length>0:!1}function xs(fe,ae){return!ae&&fe instanceof i.Es&&fe.state.$data?fe.state.$data:fe}var Za=e(98314),os=e(89460),Xn=e(8419),Pa=e(67497);class wa extends i.Bs{constructor(ae){super({...ae,source:"panel-json",jsonText:Yn("panel-json",ae.panelRef.resolve())}),this.onChangeSource=xe=>{this.setState({source:xe.value,jsonText:Yn(xe.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const xe=this.state.panelRef.resolve(),Le=(0,C.YQ)(xe),Ze=JSON.parse(this.state.jsonText),at=new v.a9(Ze),ut=(0,Un.tt)(at),Et=i.Go.cloneSceneObjectState(ut.state);if(!(xe.parent instanceof Vs.U)){console.error("Cannot update state of panel",xe,ut);return}this.state.onClose(),Le.state.isEditing||Le.onEnterEditMode(),xe.parent.setState(Et),(0,Pa.B9)(or.q.JSON,"apply",{panel_type_changed:xe.state.pluginId!==at.type,panel_id_changed:(0,C.Cs)(xe)!==at.id,panel_grid_pos_changed:ps(xe.parent.state,Et),panel_targets_changed:ga((0,C.un)(xe),(0,C.un)(Et.$data))})},this.onCodeEditorBlur=xe=>{this.setState({jsonText:xe})}}getTabLabel(){return(0,s.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return or.q.JSON}getOptions(){const ae=this.state.panelRef.resolve(),xe=ae.state.$data??ae.parent?.state.$data,Le=[{label:(0,s.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,s.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return xe&&(Le.push({label:(0,s.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,s.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),Le.push({label:(0,s.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,s.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),Le}isEditable(){if(this.state.source!=="panel-json")return!1;const ae=this.state.panelRef.resolve();return(0,C.ME)(ae)||(0,yn.aK)((0,C.YQ)(ae).getSaveModel())||ae.parent instanceof Vs.U&&ae.parent.isRepeated()?!1:(0,C.YQ)(ae).state.meta.canEdit}static{this.Component=({model:ae})=>{const{source:xe,jsonText:Le}=ae.useState(),Ze=(0,xt.of)(os.A),at=ae.getOptions();return(0,S.jsxs)("div",{className:Ze.wrap,children:[(0,S.jsxs)("div",{className:Ze.toolbar,"data-testid":H.Tp.components.PanelInspector.Json.content,children:[(0,S.jsx)(z.D,{label:(0,s.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,S.jsx)(ho.l6,{inputId:"select-source-dropdown",options:at,value:at.find(ut=>ut.value===xe)??at[0].value,onChange:ae.onChangeSource})}),ae.isEditable()&&(0,S.jsx)(_.$n,{className:Ze.toolbarItem,onClick:ae.onApplyChange,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.inspect-json-tab.apply",children:"Apply"})})]}),(0,S.jsx)("div",{className:Ze.content,children:(0,S.jsx)(ve.Ay,{disableWidth:!0,children:({height:ut})=>(0,S.jsx)(Oe.B,{width:"100%",height:ut,language:"json",showLineNumbers:!0,showMiniMap:Le.length>100,value:Le,readOnly:!ae.isEditable(),onBlur:ae.onCodeEditorBlur})})})]})}}}function Yn(fe,ae){let xe={};switch(fe){case"panel-json":{(0,Pa.B9)(or.q.JSON,"panelData");const Le=(0,C.ME)(ae),Ze=ae.parent;if(Le){xe=Ra(ae);break}if((0,yn.aK)((0,C.YQ)(ae).getSaveModel())){xe=(0,Ht.GB)(ae);break}else Ze instanceof Vs.U&&(xe=(0,gt.ZB)(Ze));break}case"panel-data":{(0,Pa.B9)(or.q.JSON,"panelJSON");const Le=i.jh.getData(ae);Le.state.data&&(xe=ae.applyFieldConfig(Le.state.data));break}case"data-frames":{(0,Pa.B9)(or.q.JSON,"dataFrame");const Le=i.jh.getData(ae);Le.state.data&&(Le instanceof i.Es&&Le.state.$data?.state.data?xe=(0,Za.B6)(Le.state.$data.state.data):xe=(0,Za.B6)(Le.state.data))}}return(0,Xn.p)(xe)}function Ra(fe){if(!(0,C.ME)(fe))throw"Panel not a library panel";const ae=fe.parent;if(!(ae instanceof Vs.U))throw"LibraryPanel not child of DashboardGridItem";const xe={x:ae.state.x||0,y:ae.state.y||0,h:ae.state.height||0,w:ae.state.width||0},Le=ns(fe),Ze=(0,gt.Z6)(fe.clone({$behaviors:void 0}),xe,!1,ae);return{libraryPanel:{...Le},...Ze}}function ns(fe){if(!(0,C.ME)(fe))throw new Error("Panel not a Library panel");const ae=(0,C.iL)(fe);if(!ae)throw new Error("Library panel behavior not found");if(!ae.state._loadedPanel)throw new Error("Library panel not loaded");return ae.state._loadedPanel}function ps(fe,ae){return fe.x!==ae.x||fe.y!==ae.y||fe.width!==ae.width||fe.height!==ae.height}function ga(fe,ae){return fe===void 0||ae===void 0?!1:!(0,Hr.isEqual)(fe.state.queries,ae.state.queries)}class Va extends i.Bs{getTabLabel(){return(0,s.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return or.q.Meta}static{this.Component=({model:ae})=>{const{panelRef:xe,dataSource:Le}=ae.state,Ze=i.jh.getData(xe.resolve()),at=Le.components?.MetadataInspector;return!Ze.state.data||!at?null:(0,S.jsx)(at,{datasource:Le,data:Ze.state.data.series})}}}var is=e(96065);class nr extends i.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const ae=(0,C.un)(this.state.panelRef.resolve());ae&&ae.runQueries()}}getTabLabel(){return(0,s.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return or.q.Query}static{this.Component=({model:ae})=>{const xe=i.jh.getData(ae.state.panelRef.resolve()).useState();return xe.data?(0,S.jsx)(is.e,{data:xe.data,onRefreshQuery:ae.onRefreshQuery}):null}}}var Aa=e(55072);class Xa extends i.Bs{getTabLabel(){return(0,s.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return or.q.Stats}static{this.Component=({model:ae})=>{const xe=i.jh.getData(ae.state.panelRef.resolve()).useState(),Le=i.jh.getTimeRange(ae.state.panelRef.resolve());return xe.data?(0,S.jsx)(Aa.N,{data:xe.data,timeZone:Le.getTimeZone()}):null}}}class qn extends i.Bs{constructor(ae){super(ae),this.onClose=()=>{js((0,C.YQ)(this))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Ma}_activationHandler(){this.buildTabs(0)}async buildTabs(ae){const xe=this.state.panelRef,Le=xe.resolve()?.getPlugin(),Ze=[];if(Le||(ae<2e3?setTimeout(()=>this.buildTabs(ae+100),100):this.setState({pluginNotLoaded:!0})),xe){if((0,Ur.$)(Le)){const at=i.jh.getData(xe.resolve());Ze.push(new Ba({panelRef:xe})),Ze.push(new Xa({panelRef:xe})),Ze.push(new nr({panelRef:xe}));const ut=await(0,Xo.BN)(at.state.data);ut&&Ze.push(new Va({panelRef:xe,dataSource:ut}))}Ze.push(new wa({panelRef:xe,onClose:this.onClose}))}this.setState({tabs:Ze})}getDrawerTitle(){const ae=this.state.panelRef?.resolve();return ae?i.jh.interpolate(ae,`Inspect: ${ae.state.title}`):"Inspect panel"}}function Ma({model:fe}){const{tabs:ae,pluginNotLoaded:xe,panelRef:Le}=fe.useState(),Ze=(0,ge.zy)(),at=new URLSearchParams(Ze.search);if(!ae)return null;const ut=at.get("inspectTab"),Et=ae.find(_t=>_t.getTabValue()===ut)??ae[0],Wt=Le.resolve();return ut===or.q.Help?(0,S.jsx)(Ua,{panel:Wt,onClose:fe.onClose}):(0,S.jsxs)(M._,{title:fe.getDrawerTitle(),onClose:fe.onClose,size:"md",tabs:(0,S.jsx)(w.U,{children:ae.map(_t=>(0,S.jsx)(N.o,{label:_t.getTabLabel(),active:_t===Et,href:n.I.getUrlForPartial(Ze,{inspectTab:_t.getTabValue()})},_t.state.key))}),children:[xe&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.panel-inspect-renderer.title-panel-plugin-not-loaded","Panel plugin not loaded"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.panel-inspect-renderer.body-panel-plugin-not-loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."})}),Et&&Et.Component&&(0,S.jsx)(Et.Component,{model:Et})]})}function js(fe){const ae=fe.state.meta,xe=!fe.state.uid&&l.Ny.getLocation().pathname==="/dashboard/new";l.Ny.push((0,Tt.u)({uid:fe.state.uid,slug:fe.state.meta.slug,currentQueryParams:l.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null},isHomeDashboard:!ae.url&&!ae.slug&&!xe}))}var cr=e(89451),Qs=e(48480),qa=e(78282),bs=e(49e3);class Es{constructor(ae){this._scene=ae}getKeys(){return["editIndex"]}getUrlState(){const ae=this._scene.state;return{editIndex:ae.editIndex!==void 0?String(ae.editIndex):void 0}}updateFromUrl(ae){let xe={};typeof ae.editIndex=="string"?xe={editIndex:Number(ae.editIndex)}:xe={editIndex:void 0},Object.keys(xe).length>0&&this._scene.setState(xe)}}var qs=e(16817),Er=e(16780),Wo=e(38669),di=e(76478),No=e(76792);const ui="New annotation",Qr=({annotation:fe,editIndex:ae,panels:xe,onUpdate:Le,onBackToList:Ze,onDelete:at})=>{const ut=(0,xt.of)(Pr),Et=(0,K.useMemo)(()=>fe.filter?fe.filter.exclude?2:1:0,[fe.filter]),{value:Wt}=(0,qs.A)(()=>(0,qa.l)().get(fe.datasource),[fe.datasource]),_t=(0,qa.l)().getInstanceSettings(fe.datasource),nn=da=>{Le({...fe,name:da.currentTarget.value},ae)},dn=da=>{const _a=(0,Qs.p$)(da);fe.datasource?.type!==_a.type?Le({datasource:_a,builtIn:fe.builtIn,enable:fe.enable,iconColor:fe.iconColor,name:fe.name,hide:fe.hide,filter:fe.filter,mappings:fe.mappings,type:fe.type},ae):Le({...fe,datasource:_a},ae)},Pn=da=>{const _a=da.currentTarget;Le({...fe,[_a.name]:_a.type==="checkbox"?_a.checked:_a.value},ae)},Nn=da=>{Le({...fe,iconColor:da},ae)},Cn=da=>{let _a=da.value===0?void 0:{exclude:da.value===2,ids:fe.filter?.ids??[]};Le({...fe,filter:_a},ae)},Tn=da=>{if(!Array.isArray(da))return;const _a={exclude:Et===2,ids:[]};da.forEach(gs=>gs.value&&_a.ids.push(gs.value)),Le({...fe,filter:_a},ae)},_n=()=>{at(ae),Ze()},ka=fe.name===ui,ja=(da,_a)=>da.label&&_a.label?da.label.toLowerCase().localeCompare(_a.label.toLowerCase()):-1,ds=(0,K.useMemo)(()=>xe.filter(da=>o.$.panels[da.state.pluginId]).map(da=>({value:(0,C.Cs)(da),label:da.state.title??`Panel ${(0,C.Cs)(da)}`,description:da.state.description,imgUrl:o.$.panels[da.state.pluginId].info.logos.small})).sort(ja)??[],[xe]);return(0,S.jsxs)("div",{children:[(0,S.jsxs)(Er.n,{className:ut.settingsForm,children:[(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-name","Name"),children:(0,S.jsx)(Y.p,{"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:ka,value:fe.name,onChange:nn})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-data-source","Data source"),htmlFor:"data-source-picker",children:(0,S.jsx)(No.s,{annotations:!0,variables:!0,current:fe.datasource,onChange:dn})}),!Wt?.meta.annotations&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.annotation-settings-edit.title-annotation-support-source","No annotation support for this data source"),severity:"error",children:(0,S.jsx)(s.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-enabled","Enabled"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-enabled-annotation-query-issued-every-dashboard","When enabled the annotation query is issued every dashboard refresh"),children:(0,S.jsx)(We.S,{name:"enable",id:"enable",value:fe.enable,onChange:Pn,"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-hidden","Hidden"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-hidden","Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."),children:(0,S.jsx)(We.S,{name:"hide",id:"hide",value:fe.hide,onChange:Pn,"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-color","Color"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-color-annotation-event-markers","Color to use for the annotation event markers"),children:(0,S.jsx)(J.B,{children:(0,S.jsx)(Wo.a,{value:fe?.iconColor,onChange:Nn})})}),(0,S.jsx)(z.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-show-in","Show in"),"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ho.l6,{options:_i,value:Et,onChange:Cn,"data-testid":H.Tp.components.Annotations.annotationsTypeInput}),Et!==0&&(0,S.jsx)(ho.KF,{options:ds,value:ds.filter(da=>fe.filter?.ids.includes(da.value)),onChange:Tn,isClearable:!0,placeholder:(0,s.t)("dashboard-scene.annotation-settings-edit.placeholder-choose-panels","Choose panels"),width:100,closeMenuOnSelect:!1,className:ut.select,"data-testid":H.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,S.jsxs)(Er.n,{children:[(0,S.jsx)("h3",{className:"page-heading",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.query",children:"Query"})}),Wt?.annotations&&_t&&(0,S.jsx)(di.A,{datasource:Wt,datasourceInstanceSettings:_t,annotation:fe,onChange:da=>Le(da,ae)})]}),(0,S.jsxs)(J.B,{children:[!fe.builtIn&&(0,S.jsx)(_.$n,{variant:"destructive",onClick:_n,"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.delete",children:"Delete"})}),(0,S.jsx)(_.$n,{variant:"secondary",onClick:Ze,"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.back-to-list",children:"Back to list"})})]})]})},Pr=fe=>({settingsForm:(0,le.css)({maxWidth:fe.spacing(60),marginBottom:fe.spacing(2)}),select:(0,le.css)({marginTop:"8px"})});var Ri=(fe=>(fe[fe.AllPanels=0]="AllPanels",fe[fe.IncludePanels=1]="IncludePanels",fe[fe.ExcludePanels=2]="ExcludePanels",fe))(Ri||{});const _i=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Ai=e(44458),_r=e(50201),kr=e(39302);const ki="Add annotation query",Yi=({annotations:fe,onNew:ae,onEdit:xe,onMove:Le,onDelete:Ze})=>{const at=(0,xt.of)(Ko),ut=fe.length===0||fe.length===1&&fe[0].builtIn,Et=_t=>_t.enable===!1?(0,S.jsx)("em",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.disabled",values:{annoName:_t.name},children:["(Disabled) ","{{annoName}}"]})}):_t.builtIn?(0,S.jsx)("em",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.built-in",values:{annoName:_t.name},children:["{{annoName}}"," (Built-in)"]})}):(0,S.jsx)(S.Fragment,{children:_t.name}),Wt=(0,qa.l)();return(0,S.jsxs)(J.B,{direction:"column",children:[fe.length>0&&(0,S.jsx)("div",{className:at.table,children:(0,S.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.query-name",children:"Query name"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.data-source",children:"Data source"})}),(0,S.jsx)("th",{colSpan:3})]})}),(0,S.jsx)("tbody",{"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:fe.map((_t,nn)=>(0,S.jsxs)("tr",{children:[_t.builtIn?(0,S.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>xe(nn),children:(0,S.jsx)(_.$n,{size:"sm",fill:"text",variant:"secondary",children:Et(_t)})}):(0,S.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>xe(nn),children:(0,S.jsx)(_.$n,{size:"sm",fill:"text",variant:"secondary",children:Et(_t)})}),(0,S.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>xe(nn),children:Wt.getInstanceSettings(_t.datasource)?.name||_t.datasource?.uid}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:nn!==0&&(0,S.jsx)(aa.K,{name:"arrow-up",onClick:()=>Le(nn,Fo.UP),tooltip:(0,s.t)("dashboard-scene.annotation-settings-list.tooltip-move-up","Move up")})}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:fe.length>1&&nn!==fe.length-1?(0,S.jsx)(aa.K,{name:"arrow-down",onClick:()=>Le(nn,Fo.DOWN),tooltip:(0,s.t)("dashboard-scene.annotation-settings-list.tooltip-move-down","Move down")}):null}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!_t.builtIn&&(0,S.jsx)(Ai.e,{size:"sm",onConfirm:()=>Ze(nn),"aria-label":(0,s.t)("dashboard-scene.annotation-settings-list.delete-aria-label",'Delete query with title "{{title}}"',{title:_t.name})})})]},`${_t.name}-${nn}`))})]})}),ut&&(0,S.jsx)(J.B,{direction:"column",children:(0,S.jsxs)(_r.p,{variant:"call-to-action",button:(0,S.jsx)(_.$n,{"data-testid":H.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:ae,size:"lg",children:(0,S.jsx)(s.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,s.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,S.jsx)(s.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,S.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,S.jsxs)(s.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,S.jsx)(be.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!ut&&(0,S.jsx)(kr.d,{"data-testid":H.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:ae,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.new-query",children:"New query"})})]})},Ko=()=>({table:(0,le.css)({width:"100%",overflowX:"auto"})});var Fo=(fe=>(fe[fe.UP=-1]="UP",fe[fe.DOWN=1]="DOWN",fe))(Fo||{});class ji extends i.Bs{constructor(){super(...arguments),this._urlSync=new Es(this),this.getDataSourceRefForAnnotation=()=>{const ae=(0,qa.l)().getInstanceSettings(null);if(!ae||!ae.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,Qs.p$)(ae)},this.onNew=async()=>{const ae={name:ui,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},xe=new bs.g({query:ae,name:ae.name,isEnabled:!!ae.enable,isHidden:!!ae.hide}),Le=Ia.b4.getDataLayers(this._dashboard);Le.addAnnotationLayer(xe),this.setState({editIndex:Le.state.annotationLayers.length-1})},this.onEdit=ae=>{this.setState({editIndex:ae})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(ae,xe)=>{const Le=Ia.b4.getDataLayers(this._dashboard),Ze=[...Le.state.annotationLayers],[at]=Ze.splice(ae,1);Ze.splice(ae+xe,0,at),Le.setState({annotationLayers:Ze})},this.onDelete=ae=>{const xe=Ia.b4.getDataLayers(this._dashboard),Le=[...xe.state.annotationLayers];Le.splice(ae,1),xe.setState({annotationLayers:Le})},this.onUpdate=(ae,xe)=>{const Le=this.getDataLayer(xe);Le.setState({name:ae.name,isEnabled:!!ae.enable,isHidden:!!ae.hide,query:ae}),Le.runLayer()}}static{this.Component=ei}getUrlKey(){return"annotations"}get _dashboard(){return(0,C.YQ)(this)}getDataLayer(ae){const Le=Ia.b4.getDataLayers(this._dashboard).state.annotationLayers[ae];if(!(Le instanceof i.tV.g))throw new Error("AnnotationsDataLayer not found at index "+ae);return Le}getDashboard(){return this._dashboard}}function ei({model:fe}){const ae=fe.getDashboard(),{annotationLayers:xe}=Ia.b4.getDataLayers(ae).useState(),{navModel:Le,pageNav:Ze}=Ls(ae,fe.getUrlKey()),{editIndex:at}=fe.useState(),ut=Ia.b4.getVizPanels(ae),Et=(0,La.O)(xe);return at!=null&&at<xe.length?(0,S.jsx)(wo,{annotationLayer:fe.getDataLayer(at),pageNav:Ze,panels:ut,editIndex:at,navModel:Le,dashboard:ae,onUpdate:fe.onUpdate,onBackToList:fe.onBackToList,onDelete:fe.onDelete}):(0,S.jsxs)(Rt.Y,{navModel:Le,pageNav:Ze,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:ae}),(0,S.jsx)(Yi,{annotations:Et,onNew:fe.onNew,onEdit:fe.onEdit,onDelete:fe.onDelete,onMove:fe.onMove})]})}function wo({annotationLayer:fe,pageNav:ae,navModel:xe,panels:Le,editIndex:Ze,dashboard:at,onUpdate:ut,onBackToList:Et,onDelete:Wt}){const{name:_t,query:nn}=fe.useState(),dn={text:_t,parentItem:ae};return(0,S.jsxs)(Rt.Y,{navModel:xe,pageNav:dn,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:at}),(0,S.jsx)(Qr,{annotation:nn,editIndex:Ze,panels:Le,onUpdate:ut,onBackToList:Et,onDelete:Wt})]})}var Wr=e(46635),io=e(39468),Ji=e(88898),go=e(86871);class Zi extends i.Bs{constructor(){super(...arguments),this._urlSync=new Es(this),this.onNewLink=()=>{this.links=[...this.links,go.q],this.setState({editIndex:this.links.length-1})},this.onDelete=ae=>{this.links=[...this.links.slice(0,ae),...this.links.slice(ae+1)],this.setState({editIndex:void 0})},this.onDuplicate=ae=>{this.links=[...this.links,{...ae}]},this.onOrderChange=(ae,xe)=>{this.links=Wr.moveItemImmutably(this.links,ae,ae+xe)},this.onEdit=ae=>{this.setState({editIndex:ae})},this.onUpdateLink=ae=>{const xe=this.state.editIndex;xe!==void 0&&(this.links=[...this.links.slice(0,xe),ae,...this.links.slice(xe+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=pr}getUrlKey(){return"links"}get dashboard(){return(0,C.YQ)(this)}get links(){return this.dashboard.state.links}set links(ae){this.dashboard.setState({links:ae})}}function pr({model:fe}){const{editIndex:ae}=fe.useState(),xe=(0,C.YQ)(fe),{links:Le}=xe.useState(),{navModel:Ze,pageNav:at}=Ls(xe,fe.getUrlKey()),ut=ae!==void 0?Le[ae]:void 0;return ut?(0,S.jsx)(Xi,{pageNav:at,navModel:Ze,link:ut,dashboard:xe,onChange:fe.onUpdateLink,onGoBack:fe.onGoBack}):(0,S.jsxs)(Rt.Y,{navModel:Ze,pageNav:at,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:xe}),(0,S.jsx)(Ji.X,{links:Le,onNew:fe.onNewLink,onEdit:fe.onEdit,onDelete:fe.onDelete,onDuplicate:fe.onDuplicate,onOrderChange:fe.onOrderChange})]})}function Xi({pageNav:fe,link:ae,navModel:xe,dashboard:Le,onChange:Ze,onGoBack:at}){const ut={text:(0,s.t)("dashboard-scene.edit-link-view.edit-link-page-nav.text.edit-link","Edit link"),parentItem:fe};return(0,S.jsxs)(Rt.Y,{navModel:xe,pageNav:ut,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:Le}),(0,S.jsx)(io.d,{link:ae,onUpdate:Ze,onGoBack:at})]})}var Co=e(10928),mo=e(77824),Vo=e(74475),To=e(56291),Li=e(42357),ti=e(70969),Nr=e(75570),Bi=e(13542);function Ui({dashboard:fe,defaultValues:ae,loadedFromRef:xe,readOnly:Le,isGitHub:Ze,isNew:at,workflowOptions:ut,targetFolderUID:Et,targetFolderTitle:Wt,onDismiss:_t,onSuccess:nn}){const dn=(0,G.mN)({defaultValues:ae}),{editPanel:Pn}=fe.useState(),{handleSubmit:Nn,watch:Cn}=dn,Tn=(0,d.J7)(),[_n,ka]=Cn(["ref","workflow"]),{data:ja,isLoading:ds}=(0,lt.Kw)({name:ae.repo,path:ae.path}),{data:da}=(0,ue.k)({name:Et},{skip:!Et}),[_a,gs]=(0,lt.tj)(),[ts,Mr]=(0,lt.Qo)(),[si,Kl]=(0,K.useState)(""),gr=(0,ge.Zp)();(0,K.useEffect)(()=>{const so=ja?.resource?.dryRun?.metadata?.annotations?.[b.Y_];if(!Et||!da||!so)return;const Tl=(da.metadata.annotations||{})[b.Y_]||Wt,sr=so.split("/").pop(),Go=`${Tl}/${sr}`;Kl(Go)},[ja,da,Et,Wt]);const xo=async({repo:so,path:ri,comment:Tl})=>{if(!ja?.resource?.file){Tn.publish({type:Ke.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.current-file-not-found","Current dashboard file could not be found")]});return}const sr=ka==="write"?xe:_n,Go=Tl||`Move dashboard: ${fe.state.title}`;try{await _a({name:so,path:si,ref:sr,message:Go,body:ja.resource.file}).unwrap(),await ts({name:so,path:ri,ref:sr,message:Go}).unwrap()}catch(Ml){gs.isSuccess&&!Mr.isSuccess&&Tn.publish({type:Ke.r1.alertWarning.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.partial-failure-warning","Dashboard was created at new location but could not be deleted from original location. Please manually remove the old file.")]}),Tn.publish({type:Ke.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.api-error","Failed to move dashboard"),Ml]})}},Di=()=>{Pn?.onDiscard(),Et&&Wt&&nn(Et,Wt),gr("/dashboards")},Ci=()=>{Pn?.onDiscard(),gr(`/dashboards?new_pull_request_url=${gs.data?.urls?.newPullRequestURL}`)};(0,It.J)({dashboard:fe,request:gs,workflow:ka,handlers:{onBranchSuccess:Ci,onWriteSuccess:Di}});const Sr=gs.isLoading||Mr.isLoading;return(0,S.jsx)(M._,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.drawer-title","Move Provisioned Dashboard"),subtitle:fe.state.title,onClose:_t,children:(0,S.jsx)(G.Op,{...dn,children:(0,S.jsx)("form",{onSubmit:Nn(xo),children:(0,S.jsxs)(J.B,{direction:"column",gap:2,children:[Le&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.move-provisioned-dashboard-form.move-read-only-message",children:"This dashboard cannot be moved directly from Grafana because the repository is read-only. To move this dashboard, please move the file in your Git repository."})}),ds&&(0,S.jsxs)(J.B,{alignItems:"center",gap:2,children:[(0,S.jsx)(to.y,{}),(0,S.jsx)("div",{children:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.loading-file-data","Loading dashboard data")})]}),ja?.errors?.length&&ja.errors.length>0&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.file-load-error","Error loading dashboard"),severity:"error",children:ja.errors.map((so,ri)=>(0,S.jsx)("div",{children:so},ri))}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.target-path-label","Target path"),children:(0,S.jsx)(Y.p,{readOnly:!0,value:si})}),(0,S.jsx)(Lt.x,{resourceType:"dashboard",isNew:at,readOnly:Le,workflow:ka,workflowOptions:ut,isGitHub:Ze}),(0,S.jsxs)(J.B,{gap:2,children:[(0,S.jsx)(_.$n,{variant:"primary",type:"submit",disabled:Sr||Le||!ja||ds,children:Sr?(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.moving","Moving..."):(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.move-action","Move dashboard")}),(0,S.jsx)(_.$n,{variant:"secondary",onClick:_t,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.move-provisioned-dashboard-form.cancel-action",children:"Cancel"})})]})]})})})})}function hi({dashboard:fe,targetFolderUID:ae,targetFolderTitle:xe,onDismiss:Le,onSuccess:Ze}){const{defaultValues:at,loadedFromRef:ut,readOnly:Et,isGitHub:Wt,workflowOptions:_t,isNew:nn}=(0,cn.S)(fe);return at?(0,S.jsx)(Ui,{dashboard:fe,defaultValues:at,loadedFromRef:ut,readOnly:Et,isGitHub:Wt,isNew:nn,workflowOptions:_t,targetFolderUID:ae,targetFolderTitle:xe,onDismiss:Le,onSuccess:Ze}):null}class qi extends i.Bs{constructor(){super(...arguments),this.onTitleChange=ae=>{this._dashboard.setState({title:ae})},this.onDescriptionChange=ae=>{this._dashboard.setState({description:ae})},this.onTagsChange=ae=>{this._dashboard.setState({tags:ae})},this.onFolderChange=async(ae,xe)=>{const Le={...this._dashboard.state.meta,folderUid:ae||this._dashboard.state.meta.folderUid,folderTitle:xe||this._dashboard.state.meta.folderTitle};Le.folderUid&&await(0,Nr.Q)(Le.folderUid),this._dashboard.setState({meta:Le})},this.onEditableChange=ae=>{this._dashboard.setState({editable:ae})},this.onTimeZoneChange=ae=>{this.getTimeRange().setState({timeZone:ae})},this.onWeekStartChange=ae=>{this.getTimeRange().setState({weekStart:ae})},this.onRefreshIntervalChange=ae=>{this.getRefreshPicker()?.setState({intervals:ae})},this.onNowDelayChange=ae=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:ae})},this.onHideTimePickerChange=ae=>{this.getDashboardControls()?.setState({hideTimeControls:ae})},this.onLiveNowChange=ae=>{try{const xe=this.getLiveNowTimer();ae?xe.enable():xe.disable()}catch(xe){console.error(xe)}},this.onTooltipChange=ae=>{this.getCursorSync()?.setState({sync:ae})},this.onPreloadChange=ae=>{this._dashboard.setState({preload:ae})},this.onDeleteDashboard=()=>{},this.onProvisionedFolderChange=async(ae,xe)=>{ae!==this._dashboard.state.meta.folderUid&&this.setState({showMoveModal:!0,moveModalProps:{targetFolderUID:ae,targetFolderTitle:xe}})},this.onMoveModalDismiss=()=>{this.setState({showMoveModal:!1,moveModalProps:void 0})},this.onMoveSuccess=(ae,xe)=>{const Le={...this._dashboard.state.meta,folderUid:ae,folderTitle:xe};this._dashboard.setState({meta:Le}),this.onMoveModalDismiss()}}get _dashboard(){return(0,C.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ia.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const ae=i.jh.findObject(this._dashboard,xe=>xe instanceof i.Gg.en);if(ae instanceof i.Gg.en)return ae;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:ae})=>{const xe=ae.getDashboard(),{navModel:Le,pageNav:Ze}=Ls(xe,ae.getUrlKey()),{title:at,description:ut,tags:Et,meta:Wt,editable:_t}=xe.useState(),{showMoveModal:nn,moveModalProps:dn}=ae.useState(),{sync:Pn}=ae.getCursorSync()?.useState()||{},{timeZone:Nn,weekStart:Cn,UNSAFE_nowDelay:Tn}=ae.getTimeRange().useState(),{intervals:_n}=ae.getRefreshPicker().useState(),{hideTimeControls:ka}=ae.getDashboardControls().useState(),{enabled:ja}=ae.getLiveNowTimer().useState(),ds=[{label:(0,s.t)("dashboard-scene.general-settings-edit-view.editable_options.label.editable","Editable"),value:!0},{label:(0,s.t)("dashboard-scene.general-settings-edit-view.editable_options.label.readonly","Read-only"),value:!1}],da=[{value:0,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.default","Default")},{value:1,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.shared-crosshair","Shared crosshair")},{value:2,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.shared-tooltip","Shared tooltip")}];return(0,S.jsxs)(Rt.Y,{navModel:Le,pageNav:Ze,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:xe}),(0,S.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,S.jsxs)(q.a,{display:"flex",direction:"column",gap:2,marginBottom:5,children:[(0,S.jsx)(z.D,{noMargin:!0,label:(0,S.jsxs)(J.B,{justifyContent:"space-between",children:[(0,S.jsx)(te.J,{htmlFor:"title-input",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),o.$.featureToggles.dashgpt&&(0,S.jsx)(ti.Z,{onGenerate:_a=>ae.onTitleChange(_a)})]}),children:(0,S.jsx)(Y.p,{id:"title-input",name:"title",value:at,onChange:_a=>ae.onTitleChange(_a.target.value)})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,S.jsxs)(J.B,{justifyContent:"space-between",children:[(0,S.jsx)(te.J,{htmlFor:"description-input",children:(0,s.t)("dashboard-settings.general.description-label","Description")}),o.$.featureToggles.dashgpt&&(0,S.jsx)(Li.V,{onGenerate:_a=>ae.onDescriptionChange(_a)})]}),children:(0,S.jsx)(X.f,{id:"description-input",name:"description",value:ut,onChange:_a=>ae.onDescriptionChange(_a.target.value)})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.tags-label","Tags"),children:(0,S.jsx)(Co.u,{id:"tags-input",tags:Et,onChange:ae.onTagsChange,width:40})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.folder-label","Folder"),children:(0,S.jsx)(ne.d,{value:Wt.folderUid,onChange:xe.isManagedRepository()?ae.onProvisionedFolderChange:ae.onFolderChange})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.editable-label","Editable"),description:(0,s.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,S.jsx)(mo.z,{value:_t,options:ds,onChange:ae.onEditableChange})})]}),(0,S.jsx)(To.p,{onTimeZoneChange:ae.onTimeZoneChange,onWeekStartChange:ae.onWeekStartChange,onRefreshIntervalChange:ae.onRefreshIntervalChange,onNowDelayChange:ae.onNowDelayChange,onHideTimePickerChange:ae.onHideTimePickerChange,onLiveNowChange:ae.onLiveNowChange,refreshIntervals:_n,timePickerHidden:ka,nowDelay:Tn||"",liveNow:ja,timezone:Nn||"",weekStart:Cn}),(0,S.jsx)(Vo.M,{label:(0,s.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:(0,S.jsxs)(J.B,{direction:"column",gap:2,children:[(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,s.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,S.jsx)(mo.z,{onChange:ae.onTooltipChange,options:da,value:Pn})}),(0,S.jsx)(z.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,s.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,S.jsx)(Q.d,{id:"preload-panels-dashboards-toggle",value:xe.state.preload,onChange:_a=>ae.onPreloadChange(_a.currentTarget.checked)})})]})}),(0,S.jsx)(q.a,{marginTop:3,children:Wt.canDelete&&(0,S.jsx)(Bi.c,{dashboard:xe})})]}),nn&&dn&&(0,S.jsx)(hi,{dashboard:xe,targetFolderUID:dn.targetFolderUID,targetFolderTitle:dn.targetFolderTitle,onDismiss:ae.onMoveModalDismiss,onSuccess:ae.onMoveSuccess})]})}}}var Mo=e(13956),Wi=e(31119);class Ni extends i.Bs{constructor(ae){super({...ae,jsonText:""}),this.onCodeEditorBlur=xe=>{this.setState({jsonText:xe})},this.onSaveSuccess=async xe=>{const Le=JSON.parse(this.state.jsonText),Ze=this.getDashboard(),at=(0,yn.aK)(Le);let ut;if(at){const Et=await(0,Mo.n)("v2").getDashboardDTO(xe.uid);ut=(0,Wi.dj)(Et);const Wt=i.Go.cloneSceneObjectState(ut.state);Ze.pauseTrackingChanges(),Ze.setInitialSaveModel(Et.spec,Et.metadata),Ze.setState(Wt)}else{Le.version=xe.version,ut=(0,Un.wM)({dashboard:Le,meta:Ze.state.meta});const Et=i.Go.cloneSceneObjectState(ut.state);Ze.pauseTrackingChanges(),Ze.setInitialSaveModel(Le,Ze.state.meta),Ze.setState(Et)}this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,C.YQ)(this)}getSaveModel(){return this.getDashboard().getSaveModel()}getJsonText(){const ae=this.getSaveModel();return(0,Xn.p)(ae)}static{this.Component=({model:ae})=>{const{state:xe,onSaveDashboard:Le}=Re(!1),[Ze,at]=(0,K.useState)(!1),ut=ae.getDashboard(),{navModel:Et,pageNav:Wt}=Ls(ut,ae.getUrlKey()),_t=ut.useState().meta.canSave,{jsonText:nn}=ae.useState(),dn=async _n=>{const ka=await Le(ut,{folderUid:ut.state.meta.folderUid,overwrite:_n,rawDashboardJSON:JSON.parse(ae.state.jsonText),k8s:ut.state.meta.k8s});at(!0),ka.status==="success"?(await ae.onSaveSuccess(ka),at(!1)):at(!0)},Pn=_n=>(0,S.jsx)(_.$n,{type:"submit",onClick:()=>{dn(_n)},variant:_n?"destructive":"primary",children:_n?(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.save-and-overwrite",children:"'Save and overwrite'"}):(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Nn=(0,S.jsx)(_.$n,{variant:"secondary",onClick:()=>at(!1),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.cancel-button.cancel",children:"Cancel"})}),Cn=(0,xt.of)(el);function Tn(_n){if(_n&&Ze){if(me(_n))return(0,S.jsxs)(k.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-someone-else-has-updated-this-dashboard","Someone else has updated this dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.render-save-button-and-error.would-still-dashboard",children:"Would you still like to save this dashboard?"})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsxs)(J.B,{alignItems:"center",children:[Nn,Pn(!0)]})})]});if(ce(_n))return(0,S.jsx)(Ie,{saveButton:Pn,cancelButton:Nn});if(Pe(_n))return(0,S.jsxs)(k.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-plugin-dashboard","Plugin dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.render-save-button-and-error.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin. Use ",(0,S.jsx)("strong",{children:"Save as"})," to create custom version."]})}),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsx)(J.B,{alignItems:"center",children:Pn(!0)})})]})}return(0,S.jsxs)(S.Fragment,{children:[_n&&Ze&&(0,S.jsx)(k.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:(0,S.jsx)("p",{children:_n.message})}),(0,S.jsx)(J.B,{alignItems:"center",children:Pn(!1)})]})}return(0,S.jsxs)(Rt.Y,{navModel:Et,pageNav:Wt,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:ut}),(0,S.jsxs)("div",{className:Cn.wrapper,children:[(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,S.jsx)(Oe.B,{width:"100%",value:nn,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Cn.codeEditor,onBlur:ae.onCodeEditorBlur}),_t&&(0,S.jsx)(q.a,{paddingTop:2,children:Tn(xe.error)})]})]})}}}const el=fe=>({wrapper:(0,le.css)({display:"flex",height:"100%",flexDirection:"column",gap:fe.spacing(2)}),codeEditor:(0,le.css)({flexGrow:1})});var tl=e(17159);class So extends i.Bs{static{this.Component=fi}get _dashboard(){return(0,C.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function fi({model:fe}){const ae=fe.getDashboard(),{uid:xe}=ae.useState(),{navModel:Le,pageNav:Ze}=Ls(ae,fe.getUrlKey()),at=T.TP.hasPermission(Gr.w.DashboardsPermissionsWrite);return(0,S.jsxs)(Rt.Y,{navModel:Le,pageNav:Ze,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:ae}),(0,S.jsx)(tl.x,{resource:"dashboards",resourceId:xe??"",canSetPermissions:at})]})}var pi=e(62635),$o=e(47969);const Rr=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function Ki(fe){return fe.map(ae=>({id:ae.state.name,label:`${ae.state.name}`}))}function sa(fe,ae){return fe.filter(xe=>ae.some(Le=>Le.from===xe.id||Le.to===xe.id))}const es=fe=>{const ae=[];for(const xe of fe)for(const Le of fe){if(xe===Le)continue;xe.variableDependency?.hasDependencyOn(Le.state.name)&&ae.push({from:xe.state.name,to:Le.state.name})}return ae};function gi(fe,ae){if(!ae)return[];let xe=[];for(const Le of fe){const Ze=Le.state.name,at=(0,$o.Jx)(Ze,{key:"model",value:ae},{});Object.keys(at).length&&xe.push({variable:Le,tree:at})}return xe}function ni(fe){const ae=[];for(const xe of fe){const{variable:Le,tree:Ze}=xe,at={variable:Le,nodes:[{id:"dashboard",label:(0,s.t)("dashboard-scene.transform-usages-to-network.result.label.dashboard","dashboard")}],edges:[],showGraph:!1};ae.push(mi(at,{id:"dashboard",value:Ze}))}return ae}const mi=(fe,ae)=>{const{id:xe,value:Le}=ae,{nodes:Ze,edges:at}=fe;if(Le&&typeof Le=="string"){const ut=`${ae.id}-${Le}`;return Ze.push({id:ut,label:Le}),at.push({from:ut,to:xe}),fe}if(vi(Le)){const ut=Object.keys(Le);for(const Et of ut){const Wt=`${ae.id}-${Et}`;Ze.push({id:Wt,label:Et}),at.push({from:Wt,to:xe}),fe=mi(fe,{id:Wt,value:Le[Et]})}return fe}return fe},Oo=(fe,ae)=>{const xe=ae.find(Le=>Le.variable.state.name===fe);return xe&&vi(xe.tree)?vo(xe.tree):0},vo=fe=>Object.values(fe).reduce((xe,Le)=>typeof Le=="object"?xe+vo(Le):xe+1,0);async function Io(fe,ae){return new Promise((xe,Le)=>{setTimeout(()=>{try{const Ze=nl(fe,ae);xe(ni(Ze))}catch(Ze){Le(Ze)}},200)})}function nl(fe,ae){if(!ae)return[];let xe=[];const Le=br(fe,ae);for(const Ze of Le){const at=(0,$o.Jx)(Ze,{key:"model",value:ae},{});Object.keys(at).length&&xe.push({variable:Ze,tree:at})}return xe}const br=(fe,ae)=>{Rr.lastIndex=0;const xe=[],Ze=(0,pi.MA)(ae,2).match(Rr);if(!Ze)return xe;for(const at of Ze){if(!at||at.indexOf("$__")!==-1||at.indexOf("${__")!==-1||at.indexOf("$hashKey")!==-1)continue;const ut=vl(at);fe.some(Et=>Et.state.name===ut)||xe.find(Et=>Et===ut)||ut&&xe.push(ut)}return xe};function vl(fe){const ae=ws(fe);if(!ae)return;const xe=ae.slice(1).find(Le=>Le!==void 0);if(!(xe in{}))return xe}const ws=fe=>(Rr.lastIndex=0,Rr.exec(fe));function vi(fe){return typeof fe=="object"&&fe!==null&&!Array.isArray(fe)}var al=e(75505),sl=e(59857),er=e(8515),Kr=e(71599),Fi=e(6975),ai=e(29),wi=e(32442),Ro=e(25379),yi=e(49602),Vi=e(18387),ct=e(73829),ft=e(68577),Nt=e(44741);function tn({onChange:fe,type:ae}){const xe=(0,K.useMemo)(()=>(0,Nt.B$)(),[]),Le=(0,K.useMemo)(()=>xe.find(Ze=>Ze.value===ae)??xe[0],[xe,ae]);return(0,S.jsx)(ft.v,{name:(0,s.t)("dashboard-scene.variable-type-select.name-variable-type","Variable type"),value:Le,options:xe,onChange:fe,testId:H.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function mn({variable:fe,onTypeChange:ae,onGoBack:xe,onDelete:Le}){const Ze=(0,xt.of)(Dn),[at,ut]=(0,K.useState)(),{name:Et,type:Wt,label:_t,description:nn,hide:dn}=fe.useState(),Pn=(0,Nt.bZ)(Wt)?(0,Nt.CD)(Wt):void 0,[Nn,Cn]=(0,Me.A)(async()=>{await(0,al.s)(fe.validateAndUpdate())},[fe]),Tn=ts=>{ts.value&&ae(ts.value)},_n=(0,K.useCallback)(ts=>{const Mr=(0,Nt.c$)(fe,ts.currentTarget.value);Mr.errorMessage!==at&&ut(Mr.errorMessage)},[fe,at]),ka=ts=>{at||fe.setState({name:ts.currentTarget.value})},ja=ts=>fe.setState({label:ts.currentTarget.value}),ds=ts=>fe.setState({description:ts.currentTarget.value}),da=ts=>fe.setState({hide:ts}),_a=(0,Nt.n_)(fe),gs=ts=>()=>{(0,Te.rR)("Delete variable"),Le(Et),ts()};return(0,S.jsxs)("form",{"aria-label":(0,s.t)("dashboard-scene.variable-editor-form.aria-label-variable-editor-form","Variable editor form"),children:[(0,S.jsx)(tn,{onChange:Tn,type:Wt}),(0,S.jsx)(wi.Y,{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.general",children:"General"})}),(0,S.jsx)(yi._,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-name","Name"),description:(0,s.t)("dashboard-scene.variable-editor-form.description-template-variable-characters","The name of the template variable. (Max. 50 characters)"),placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-variable-name","Variable name"),defaultValue:Et??"",onChange:_n,onBlur:ka,testId:H.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:ct.M.MaxSize,required:!0,invalid:!!at,error:at}),(0,S.jsx)(yi._,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-label","Label"),description:(0,s.t)("dashboard-scene.variable-editor-form.description-optional-display-name","Optional display name"),placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-label-name","Label name"),defaultValue:_t??"",onBlur:ja,testId:H.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,S.jsx)(Ro.Z,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-description","Description"),defaultValue:nn??"",placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-descriptive-text","Descriptive text"),onBlur:ds,width:52}),(0,S.jsx)(ai.D,{onChange:da,hide:dn||sl.rw.hide,type:Wt}),Pn&&(0,S.jsx)(Pn,{variable:fe,onRunQuery:Cn}),_a&&(0,S.jsx)(Vi.j,{options:fe.getOptionsForSelect(!1)}),(0,S.jsx)("div",{className:Ze.buttonContainer,children:(0,S.jsxs)(J.B,{gap:2,children:[(0,S.jsx)(er.$s,{children:({showModal:ts,hideModal:Mr})=>(0,S.jsx)(_.$n,{variant:"destructive",fill:"outline",onClick:()=>{ts(Kr.u,{title:(0,s.t)("dashboard-scene.variable-editor-form.title.delete-variable","Delete variable"),body:`Are you sure you want to delete: ${Et}?`,confirmText:(0,s.t)("dashboard-scene.variable-editor-form.confirmText.delete-variable","Delete variable"),onConfirm:gs(Mr),onDismiss:Mr,isOpen:!0})},children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.delete",children:"Delete"})})}),(0,S.jsx)(_.$n,{variant:"secondary","data-testid":H.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:xe,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.back-to-list",children:"Back to list"})}),_a&&(0,S.jsx)(_.$n,{disabled:Nn.loading,variant:"secondary","data-testid":H.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:Cn,children:Nn.loading?(0,S.jsx)(Fi._,{className:Ze.loadingPlaceHolder,text:(0,s.t)("dashboard-scene.variable-editor-form.text-running-query","Running query...")}):(0,s.t)("dashbaord-scene.variable-editor-form.run-query","Run query")})]})})]})}const Dn=fe=>({buttonContainer:(0,le.css)({marginTop:fe.spacing(2)}),loadingPlaceHolder:(0,le.css)({marginBottom:0})});var Rn=e(89332),Kn=e(84500),ra=e(27690);const ca=({variables:fe})=>{const ae=(0,K.useMemo)(()=>Ki(fe),[fe]),xe=(0,K.useMemo)(()=>es(fe),[fe]);return xe.length?(0,S.jsx)(ra.i,{show:!1,title:(0,s.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:sa(ae,xe),edges:xe,children:({showModal:Le})=>(0,S.jsx)(_.$n,{onClick:()=>{(0,Te.rR)("Show variable dependencies"),Le()},icon:"channel-add",variant:"secondary",children:(0,S.jsx)(s.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};var ba=e(45967);const Sa=({id:fe,usages:ae,isAdhoc:xe})=>{const Le=(0,K.useMemo)(()=>ae.find(at=>(typeof at.variable=="string"?at.variable:at.variable.state.name)===fe),[ae,fe]);if(ae.length===0||xe||!Le)return null;const Ze=Le.nodes.map(at=>at.label.includes(`$${fe}`)?{...at,color:"#FB7E81"}:at);return(0,S.jsx)(ra.i,{show:!1,title:(0,s.t)("dashboard-scene.variable-usages-button.title-show-usages","Showing usages for: {{variableId}}",{variableId:`$${fe}`}),nodes:Ze,edges:Le.edges,children:({showModal:at})=>(0,S.jsx)(aa.K,{onClick:()=>{(0,Te.rR)("Show variable usages"),at()},name:"code-branch",tooltip:(0,s.t)("dashboard-scene.variable-usages-button.tooltip-show-usages","Show usages")})})};function cs({index:fe,variable:ae,usageTree:xe,usagesNetwork:Le,onEdit:Ze,onDuplicate:at,onDelete:ut}){const Et=(0,xt.$j)(),Wt=(0,xt.of)(Qa),_t=(0,Nt.Ao)(ae),nn=ae.state,dn=nn.name,Nn=Oo(dn,xe)>0||nn.type==="adhoc",[Cn,Tn]=(0,K.useState)(!1),_n=ja=>()=>{Tn(ja)},ka=()=>{(0,Te.rR)("Delete variable"),ut(dn)};return(0,S.jsx)(Rn.sx,{draggableId:JSON.stringify(dn),index:fe,children:(ja,ds)=>(0,S.jsxs)("tr",{ref:ja.innerRef,...ja.draggableProps,style:{userSelect:ds.isDragging?"none":"auto",background:ds.isDragging?Et.colors.background.secondary:void 0,...ja.draggableProps.style},children:[(0,S.jsx)("td",{role:"gridcell",className:Wt.column,children:(0,S.jsx)(_.$n,{size:"xs",fill:"text",onClick:da=>{da.preventDefault(),Ze(dn)},className:Wt.nameLink,"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(nn.name),children:nn.name})}),(0,S.jsx)("td",{role:"gridcell",className:Wt.definitionColumn,onClick:da=>{da.preventDefault(),Ze(dn)},"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(nn.name),children:_t}),(0,S.jsx)("td",{role:"gridcell",className:Wt.column,children:(0,S.jsxs)("div",{className:Wt.icons,children:[(0,S.jsx)(fs,{passed:Nn}),(0,S.jsx)(Sa,{id:nn.name,isAdhoc:nn.type==="adhoc",usages:Le}),(0,S.jsx)(aa.K,{onClick:da=>{da.preventDefault(),(0,Te.rR)("Duplicate variable"),at(dn)},name:"copy",tooltip:(0,s.t)("dashboard-scene.variable-editor-list-row.tooltip-duplicate-variable","Duplicate variable"),"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(nn.name)}),(0,S.jsx)(aa.K,{onClick:da=>{da.preventDefault(),Tn(!0)},name:"trash-alt",tooltip:(0,s.t)("dashboard-scene.variable-editor-list-row.tooltip-remove-variable","Remove variable"),"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(nn.name)}),(0,S.jsx)(Kr.u,{isOpen:Cn,title:(0,s.t)("dashboard-scene.variable-editor-list-row.title-delete-variable","Delete variable"),body:(0,s.t)("dashboard-scene.variable-editor-list-row.body-delete-variable","Are you sure you want to delete: {{variable}}?",{variable:nn.name}),confirmText:(0,s.t)("dashboard-scene.variable-editor-list-row.confirmText-delete-variable","Delete variable"),onConfirm:ka,onDismiss:_n(!1)}),(0,S.jsx)("div",{...ja.dragHandleProps,className:Wt.dragHandle,children:(0,S.jsx)(kn.I,{name:"draggabledots",size:"lg"})})]})})]})})}function fs({passed:fe}){const ae=(0,xt.of)(Qa);return fe?(0,S.jsx)(ba.m,{content:(0,s.t)("dashboard-scene.variable-check-indicator.content-variable-referenced-other-variables-dashboard","This variable is referenced by other variables or dashboard."),children:(0,S.jsx)(kn.I,{name:"check",className:ae.iconPassed,"aria-label":(0,s.t)("dashboard-scene.variable-check-indicator.aria-label-variable-referenced-other-variables-dashboard","This variable is referenced by other variables or dashboard.")})}):(0,S.jsx)(ba.m,{content:(0,s.t)("dashboard-scene.variable-check-indicator.content-variable-not-referenced-other-variables-dashboard","This variable is not referenced by other variables or dashboard."),children:(0,S.jsx)(kn.I,{name:"exclamation-triangle",className:ae.iconFailed,"aria-label":(0,s.t)("dashboard-scene.variable-check-indicator.aria-label-variable-referenced-dashboard","This variable is not referenced by any variable or dashboard.")})})}function Qa(fe){return{dragHandle:(0,le.css)({cursor:"grab",marginLeft:fe.spacing(1)}),column:(0,le.css)({width:"1%"}),nameLink:(0,le.css)({cursor:"pointer",color:fe.colors.primary.text}),definitionColumn:(0,le.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,le.css)({color:fe.v1.palette.greenBase,marginRight:fe.spacing(2)}),iconFailed:(0,le.css)({color:fe.v1.palette.orange,marginRight:fe.spacing(2)}),icons:(0,le.css)({display:"flex",gap:fe.spacing(2),alignItems:"center"})}}function Ns({variables:fe,usages:ae,usagesNetwork:xe,onChangeOrder:Le,onDelete:Ze,onDuplicate:at,onAdd:ut,onEdit:Et}){const Wt=(0,xt.of)(zs),_t=dn=>{!dn.destination||!dn.source||((0,Te.rR)("Variable drag and drop"),Le(dn.source.index,dn.destination.index))};return fe.filter(Kn.Ru).length<=0?(0,S.jsx)($s,{onAdd:ut}):(0,S.jsxs)(J.B,{direction:"column",gap:3,children:[(0,S.jsxs)("table",{className:rs()("filter-table","filter-table--hover",Wt.tableContainer),"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.variable",children:"Variable"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.definition",children:"Definition"})}),(0,S.jsx)("th",{colSpan:5})]})}),(0,S.jsx)(Rn.JY,{onDragEnd:_t,children:(0,S.jsx)(Rn.gL,{droppableId:"variables-list",direction:"vertical",children:dn=>(0,S.jsxs)("tbody",{ref:dn.innerRef,...dn.droppableProps,children:[fe.map((Pn,Nn)=>{if(!(0,Kn.Ru)(Pn))return null;const Cn=Pn.state;return(0,S.jsx)(cs,{index:Nn,variable:Pn,onDelete:Ze,onDuplicate:at,onEdit:Et,usageTree:ae,usagesNetwork:xe},`${Cn.name}-${Nn}`)}),dn.placeholder]})})})]}),(0,S.jsxs)(J.B,{children:[(0,S.jsx)(ca,{variables:fe}),(0,S.jsx)(_.$n,{"data-testid":H.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:ut,icon:"plus",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.new-variable",children:"New variable"})})]})]})}function $s({onAdd:fe}){return(0,S.jsx)(J.B,{direction:"column",children:(0,S.jsxs)(_r.p,{variant:"call-to-action",button:(0,S.jsx)(_.$n,{"data-testid":H.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:fe,size:"lg",children:(0,S.jsx)(s.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,s.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,S.jsxs)(s.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,S.jsx)(be.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const zs=()=>({tableContainer:(0,le.css)({overflow:"auto"})}),Ds=1e3;function as({variables:fe,dashboard:ae}){const[xe,Le]=(0,K.useState)(!1),[Ze,at]=(0,K.useState)(0),ut=(0,xt.of)(jr);(0,K.useEffect)(()=>at(dn=>dn+1),[fe,ae]);const[{loading:Et,value:Wt},_t]=(0,Me.A)(async()=>{const dn=Date.now(),Pn=await Io(fe,ae),Cn=Date.now()-dn;return Cn>=Ds&&(0,Te.rR)("Slow unknown variables expansion",{elapsed:Cn}),at(0),Pn},[fe,ae]),nn=dn=>{dn&&((0,Te.rR)("Unknown variables section expanded"),Ze>0&&_t()),Le(dn)};return(0,S.jsx)("div",{className:ut.container,children:(0,S.jsx)(Vo.M,{label:(0,S.jsx)(Ar,{}),isOpen:xe,onToggle:nn,children:Et||!Wt?(0,S.jsx)(J.B,{justifyContent:"center",direction:"column",children:(0,S.jsxs)(J.B,{justifyContent:"center",children:[(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.loading",children:"Loading..."})}),(0,S.jsx)(to.y,{})]})}):Wt.length>0?(0,S.jsx)(Dr,{usages:Wt}):(0,S.jsx)(Yr,{})})})}function Ar(){const fe=(0,xt.of)(jr);return(0,S.jsxs)("h5",{children:[(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.renamed-or-missing-variables",children:"Renamed or missing variables"}),(0,S.jsx)(ba.m,{content:(0,s.t)("variables.unknown-table.tooltip-renamed-or-missing-variables","Click to expand a list with all variable references that have been renamed or are missing from the dashboard."),children:(0,S.jsx)(kn.I,{name:"info-circle",className:fe.infoIcon})})]})}function Yr(){return(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.no-unknowns",children:"No renamed or missing variables found."})})}function Dr({usages:fe}){const ae=(0,xt.of)(jr);return(0,S.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.variable",children:"Variable"})}),(0,S.jsx)("th",{colSpan:5})]})}),(0,S.jsx)("tbody",{children:fe.map(xe=>{const Le=typeof xe.variable=="string"?xe.variable:xe.variable.state.name;return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:ae.firstColumn,children:(0,S.jsx)("span",{children:Le})}),(0,S.jsx)("td",{className:ae.defaultColumn}),(0,S.jsx)("td",{className:ae.defaultColumn}),(0,S.jsx)("td",{className:ae.defaultColumn}),(0,S.jsx)("td",{className:ae.lastColumn,children:(0,S.jsx)(Sa,{id:Le,usages:fe,isAdhoc:!1})})]},Le)})})]})}const jr=fe=>({container:(0,le.css)({marginTop:fe.spacing(4),paddingTop:fe.spacing(4)}),infoIcon:(0,le.css)({marginLeft:fe.spacing(1)}),defaultColumn:(0,le.css)({width:"1%"}),firstColumn:(0,le.css)({width:"1%",verticalAlign:"top",color:fe.colors.text.maxContrast}),lastColumn:(0,le.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"right"})});class Ks extends i.Bs{constructor(){super(...arguments),this._urlSync=new Es(this),this.getVariableIndex=ae=>this.getVariables().findIndex(Le=>Le.state.name===ae),this.replaceEditVariable=ae=>{const xe=this.state.editIndex??-1,{variables:Le}=this.getVariableSet().state;if(!Le[xe]){console.error("Variable not found");return}const at=[...Le.slice(0,xe),ae,...Le.slice(xe+1)];this.getVariableSet().setState({variables:at})},this.onDelete=ae=>{const xe=this.getVariableIndex(ae),{variables:Le}=this.getVariableSet().state;if(xe===-1){console.error("Variable not found");return}const Ze=[...Le.slice(0,xe),...Le.slice(xe+1)];this.getVariableSet().setState({variables:Ze}),this.setState({editIndex:void 0})},this.onDuplicated=ae=>{const xe=this.getVariableIndex(ae),Le=this.getVariableSet().state.variables;if(xe===-1){console.error("Variable not found");return}const Ze=Le[xe];let at=0,ut=`copy_of_${Ze.state.name}`;for(;Le.some(_t=>_t.state.name===ut);)at++,ut=`copy_of_${Ze.state.name}_${at}`;const Et=Ze.clone(Ze.state);Et.setState({name:ut});const Wt=[...Le.slice(0,xe+1),Et,...Le.slice(xe+1)];this.getVariableSet().setState({variables:Wt})},this.onOrderChanged=(ae,xe)=>{const Le=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(ae<0||ae>=Le.length||xe<0||xe>=Le.length){console.error("Invalid index");return}const Ze=[...Le],at=Ze.splice(ae,1);Ze.splice(xe,0,at[0]),this.getVariableSet().setState({variables:Ze})},this.onEdit=ae=>{const xe=this.getVariableIndex(ae);if(xe===-1){console.error("Variable not found");return}this.setState({editIndex:xe})},this.onAdd=()=>{const ae=this.getVariables(),xe=ae.length,Le=(0,Nt.kh)(ae);this.getVariableSet().setState({variables:[...this.getVariables(),Le]}),this.setState({editIndex:xe})},this.onTypeChange=ae=>{const xe=this.state.editIndex??-1,{variables:Le}=this.getVariableSet().state,Ze=Le[xe];if(!Ze){console.error("Variable not found");return}const{name:at,label:ut}=Ze.state,Et=(0,Nt.No)(ae,{name:at,label:ut});this.replaceEditVariable(Et)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(ae,xe)=>{let Le=null;Nt.cH.test(ae)||(Le="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Nt.mJ.test(ae)||(Le="Only word characters are allowed in variable names");const Ze=this.getVariableSet().getByName(ae)?.state;return Ze&&Ze.key!==xe&&(Le="Variable with the same name already exists"),Le?[!0,Le]:[!1,null]},this.getSaveModel=()=>(0,gt.Uy)(this.getDashboard()),this.getUsages=()=>{const ae=this.getSaveModel();return gi(this.getVariables(),ae)},this.getUsagesNetwork=()=>{const ae=this.getUsages();return ni(ae)}}static{this.Component=ir}getUrlKey(){return"variables"}getDashboard(){return(0,C.YQ)(this)}getVariableSet(){return i.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function ir({model:fe}){const ae=fe.getDashboard(),{navModel:xe,pageNav:Le}=Ls(ae,fe.getUrlKey()),{onDelete:Ze,onDuplicated:at,onOrderChanged:ut,onEdit:Et,onTypeChange:Wt,onGoBack:_t,onAdd:nn}=fe,{variables:dn}=fe.getVariableSet().useState(),{editIndex:Pn}=fe.useState(),Nn=(0,K.useMemo)(()=>fe.getUsagesNetwork(),[fe]),Cn=(0,K.useMemo)(()=>fe.getUsages(),[fe]),Tn=fe.getSaveModel();if(Pn!==void 0&&dn[Pn]){const _n=dn[Pn];if(_n)return(0,S.jsx)(ar,{variable:_n,onTypeChange:Wt,onGoBack:_t,pageNav:Le,navModel:xe,dashboard:ae,onDelete:Ze})}return(0,S.jsxs)(Rt.Y,{navModel:xe,pageNav:Le,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:ae}),(0,S.jsx)(Ns,{variables:dn,usages:Cn,usagesNetwork:Nn,onDelete:Ze,onDuplicate:at,onChangeOrder:ut,onAdd:nn,onEdit:Et}),(0,S.jsx)(as,{variables:dn,dashboard:Tn})]})}function ar({variable:fe,pageNav:ae,navModel:xe,dashboard:Le,onTypeChange:Ze,onGoBack:at,onDelete:ut}){const{name:Et}=fe.useState(),Wt={text:Et,parentItem:ae};return(0,S.jsxs)(Rt.Y,{navModel:xe,pageNav:Wt,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:Le}),(0,S.jsx)(mn,{variable:fe,onTypeChange:Ze,onGoBack:at,onDelete:ut},fe.state.key)]})}var yo=e(10685),Cs=e(34753),no=e(1199),dr=e(23289);const ao=({hideModal:fe,onRestore:ae,version:xe})=>{const Le=(0,Ge._2)(),Ze=async()=>{await ae(xe)?(Le.success("Dashboard restored",`Restored from version ${xe.version}`),dr.c.versionRestoreClicked({version:xe.version,confirm:!0})):Le.error("Dashboard restore failed",`Failed to restore from version ${xe.version}`),fe()};return(0,S.jsx)(Kr.u,{isOpen:!0,title:(0,s.t)("dashboard-scene.revert-dashboard-modal.title-restore-version","Restore version"),icon:"history",onDismiss:fe,onConfirm:Ze,body:(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.revert-dashboard-modal.body-restore-version",values:{version:xe.version},children:["Are you sure you want to restore the dashboard to version ","{{version}}","? All unsaved changes will be lost."]})}),confirmText:(0,s.t)("dashboard-scene.revert-dashboard-modal.confirmText-restore-version","Yes, restore to version {{version}}",{version:xe.version})})};var lo=e(61371);const rl=({baseInfo:fe,newInfo:ae,diffData:xe,isNewLatest:Le,onRestore:Ze})=>{const at=(0,lo.G4)(xe.lhs,xe.rhs),ut=(0,xt.of)($i);return(0,S.jsxs)(J.B,{direction:"column",gap:1,children:[(0,S.jsxs)(J.B,{justifyContent:"space-between",alignItems:"center",children:[(0,S.jsxs)(J.B,{alignItems:"center",children:[(0,S.jsxs)("span",{className:(0,le.cx)(ut.versionInfo,ut.noMarginBottom),children:[(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history-comparison.old-version-updated",values:{version:fe.version,editor:fe.createdBy,timeAgo:fe.ageString},children:[(0,S.jsxs)("strong",{children:["Version ","{{version}}"]})," updated by ","{{editor}}"," ","{{timeAgo}}"]}),fe.message]}),(0,S.jsx)(kn.I,{name:"arrow-right",size:"sm"}),(0,S.jsxs)("span",{className:ut.versionInfo,children:[(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history-comparison.new-version-updated",values:{version:ae.version,editor:ae.createdBy,timeAgo:ae.ageString},children:[(0,S.jsxs)("strong",{children:["Version ","{{version}}"]})," updated by ","{{editor}}"," ","{{timeAgo}}"]}),ae.message]})]}),Le&&(0,S.jsx)(er.$s,{children:({showModal:Et,hideModal:Wt})=>(0,S.jsx)(_.$n,{variant:"destructive",icon:"history",onClick:()=>{Et(ao,{version:fe,onRestore:Ze,hideModal:Wt})},children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history.comparison.button-restore",values:{version:fe.version},children:["Restore to version ","{{version}}"]})})})]}),Object.entries(at).map(([Et,Wt])=>(0,S.jsx)(Cs.D,{diffs:Wt,title:Et},Et)),(0,S.jsx)(q.a,{paddingTop:2,children:(0,S.jsx)(Vo.M,{isOpen:!1,label:(0,s.t)("dashboard-scene.version-history-comparison.label-view-json-diff","View JSON diff"),children:(0,S.jsx)(no.M,{oldValue:JSON.stringify(xe.lhs,null,2),newValue:JSON.stringify(xe.rhs,null,2)})})})]})},$i=fe=>({versionInfo:(0,le.css)({color:fe.colors.text.secondary,fontSize:fe.typography.bodySmall.fontSize}),noMarginBottom:(0,le.css)({marginBottom:0})});var jl=e(7923),xi=e(94018);const zo=({versions:fe,canCompare:ae,onCheck:xe,onRestore:Le})=>{const Ze=(0,xt.of)(Ll);return(0,S.jsx)("div",{className:Ze.margin,children:(0,S.jsxs)("table",{className:(0,le.cx)("filter-table",Ze.table),children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"width-4"}),(0,S.jsx)("th",{className:"width-4",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.version",children:"Version"})}),(0,S.jsx)("th",{className:"width-14",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.date",children:"Date"})}),(0,S.jsx)("th",{className:"width-10",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.updated-by",children:"Updated by"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.notes",children:"Notes"})}),(0,S.jsx)("th",{})]})}),(0,S.jsx)("tbody",{children:fe.map((at,ut)=>(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{children:(0,S.jsx)(We.S,{"aria-label":(0,s.t)("dashboard-scene.version-history-table.aria-label-toggle-selection","Toggle selection of version {{version}}",{version:at.version}),className:(0,le.css)({display:"inline"}),checked:at.checked,onChange:Et=>xe(Et,at.id),disabled:!at.checked&&ae})}),(0,S.jsx)("td",{children:at.version}),(0,S.jsx)("td",{children:at.createdDateString}),(0,S.jsx)("td",{children:at.createdBy}),(0,S.jsx)("td",{children:at.message}),(0,S.jsx)("td",{className:"text-right",children:ut===0?(0,S.jsx)(xi.v,{name:(0,s.t)("dashboard-scene.version-history-table.name-latest","Latest"),colorIndex:17}):(0,S.jsx)(er.$s,{children:({showModal:Et,hideModal:Wt})=>(0,S.jsx)(_.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{Et(ao,{version:at,hideModal:Wt,onRestore:Le}),dr.c.versionRestoreClicked({version:at.version,index:ut,confirm:!1,version_date:at.created})},children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.restore",children:"Restore"})})})})]},at.id))})]})})};function Ll(fe){return{margin:(0,le.css)({marginBottom:fe.spacing(4)}),table:(0,le.css)({td:{whiteSpace:"normal !important"}})}}const zi=10;class Bl extends i.Bs{constructor(ae){super({...ae,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=zi,this._start=0,this._continueToken="",this.fetchVersions=(xe=!1)=>{const Le=this._dashboard.state.uid;if(!Le)return;this.setState({isAppending:xe});const Ze=this._continueToken?{limit:this._limit,start:this._start,continueToken:this._continueToken}:{limit:this._limit,start:this._start};In.w.getHistoryList(Le,Ze).then(at=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(at.versions)]}),this._start+=this._limit,this._continueToken=at.continueToken??""}).catch(at=>console.log(at)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const xe=this.versions.filter(Wt=>Wt.checked),[Le,Ze]=xe,at=Le.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;let ut,Et;o.$.featureToggles.kubernetesClientDashboardsFolders?(ut=await In.w.getDashboardVersion(this._dashboard.state.uid,Ze.id),Et=await In.w.getDashboardVersion(this._dashboard.state.uid,Le.id)):(ut=await In.w.getDashboardVersion(this._dashboard.state.uid,Ze.version),Et=await In.w.getDashboardVersion(this._dashboard.state.uid,Le.version)),this.setState({baseInfo:Ze,isLoading:!1,isNewLatest:at,newInfo:Le,viewMode:"compare",diffData:{lhs:ut.data,rhs:Et.data}})},this.reset=()=>{this._continueToken="",this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(xe=>({...xe,checked:!1})),viewMode:"list"})},this.onCheck=(xe,Le)=>{this.setState({versions:this.versions.map(Ze=>Ze.id===Le?{...Ze,checked:xe.currentTarget.checked}:Ze)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Ul}get _dashboard(){return(0,C.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}get continueToken(){return this._continueToken}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}decorateVersions(ae){const xe=this.getTimeRange().getTimeZone();return ae.map(Le=>({...Le,createdDateString:(0,Oa.LE)(Le.created,{timeZone:xe}),ageString:(0,Oa.fq)(Le.created,{timeZone:xe}),checked:!1}))}}function Ul({model:fe}){const ae=fe.getDashboard(),{isLoading:xe,isAppending:Le,viewMode:Ze,baseInfo:at,newInfo:ut,isNewLatest:Et}=fe.useState(),{navModel:Wt,pageNav:_t}=Ls(ae,fe.getUrlKey()),nn=fe.versions.filter(_n=>_n.checked).length===2,dn=fe.versions.length>1,Pn=fe.versions.length>=fe.limit;let Nn=fe.versions.find(_n=>_n.version===1)||fe.versions.length%fe.limit!==0;o.$.featureToggles.kubernetesClientDashboardsFolders&&(Nn=Nn||fe.continueToken==="");const Cn=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(jl.m,{onClick:fe.reset,baseVersion:at?.version,newVersion:ut?.version,isNewLatest:Et}),xe?(0,S.jsx)(ol,{msg:"Fetching changes\u2026"}):(0,S.jsx)(rl,{newInfo:ut,baseInfo:at,isNewLatest:Et,diffData:fe.diffData,onRestore:ae.onRestore})]}),Tn=(0,S.jsxs)(S.Fragment,{children:[xe?(0,S.jsx)(ol,{msg:"Fetching history list\u2026"}):(0,S.jsx)(zo,{versions:fe.versions,onCheck:fe.onCheck,canCompare:nn,onRestore:ae.onRestore}),Le&&(0,S.jsx)(ol,{msg:"Fetching more entries\u2026"}),dn&&(0,S.jsx)(yo.r,{hasMore:Pn,canCompare:nn,getVersions:fe.fetchVersions,getDiff:fe.getDiff,isLastPage:!!Nn})]});return(0,S.jsxs)(Rt.Y,{navModel:Wt,pageNav:_t,layout:vn.k.Standard,children:[(0,S.jsx)(Zt.c,{dashboard:ae}),Ze==="compare"?Cn:Tn]})}const ol=({msg:fe})=>(0,S.jsxs)(J.B,{children:[(0,S.jsx)(to.y,{}),(0,S.jsx)("em",{children:fe})]});function Ls(fe,ae){const xe=(0,ge.zy)(),Le=(0,ke.d4)(Et=>Et.navIndex),Ze=(0,p.tc)(Le,"dashboards/browse"),at=fe.getPageNav(xe,Le),ut={text:(0,s.t)("dashboard-scene.use-dashboard-edit-page-nav.page-nav.text.settings","Settings"),url:n.I.getUrlForPartial(xe,{editview:"settings",editIndex:null}),children:[],parentItem:at};return fe.state.meta.canEdit&&(ut.children.push({text:(0,s.t)("dashboard-settings.general.title","General"),url:n.I.getUrlForPartial(xe,{editview:"settings",editIndex:null}),active:ae==="settings"}),ut.children.push({text:(0,s.t)("dashboard-settings.annotations.title","Annotations"),url:n.I.getUrlForPartial(xe,{editview:"annotations",editIndex:null}),active:ae==="annotations"}),ut.children.push({text:(0,s.t)("dashboard-settings.variables.title","Variables"),url:n.I.getUrlForPartial(xe,{editview:"variables",editIndex:null}),active:ae==="variables"}),ut.children.push({text:(0,s.t)("dashboard-settings.links.title","Links"),url:n.I.getUrlForPartial(xe,{editview:"links",editIndex:null}),active:ae==="links"})),fe.state.uid&&fe.state.meta.canSave&&ut.children.push({text:(0,s.t)("dashboard-settings.versions.title","Versions"),url:n.I.getUrlForPartial(xe,{editview:"versions",editIndex:null}),active:ae==="versions"}),fe.state.uid&&fe.state.meta.canAdmin&&T.TP.hasPermission(Gr.w.DashboardsPermissionsRead)&&ut.children.push({text:(0,s.t)("dashboard-settings.permissions.title","Permissions"),url:n.I.getUrlForPartial(xe,{editview:"permissions",editIndex:null}),active:ae==="permissions"}),ut.children.push({text:(0,s.t)("dashboard-settings.json-editor.title","JSON Model"),url:n.I.getUrlForPartial(xe,{editview:"json-model",editIndex:null}),active:ae==="json-model"}),{navModel:Ze,pageNav:ut}}function il(fe){switch(fe){case"annotations":return new ji({});case"variables":return new Ks({});case"links":return new Zi({});case"versions":return new Bl({});case"json-model":return new Ni({});case"permissions":return new So({});case"settings":default:return new qi({})}}var Ei=e(25494),yl=e(99949);class xl extends i.Bs{constructor(ae){super(ae),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const ae=this.state.panelRef.resolve();return(0,C.sf)(ae)}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:ae})=>{const{panelRef:xe}=ae.useState(),Le=xe.resolve();return(0,S.jsx)(Le.Component,{model:Le})}}}class El{constructor(ae){this._scene=ae}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk","shareView"]}getUrlState(){const ae=this._scene.state;return{inspect:ae.inspectPanelKey,autofitpanels:this.getAutoFitPanels(),viewPanel:ae.viewPanelScene?.getUrlKey(),editview:ae.editview?.getUrlKey(),editPanel:ae.editPanel?.getUrlKey()||void 0,kiosk:ae.kioskMode===eo.d9.Full?"":void 0,shareView:ae.shareView,orgId:T.TP.user.orgId.toString()}}getAutoFitPanels(){if(this._scene.state.body instanceof Hs.D)return this._scene.state.body.state.grid.state.UNSAFE_fitPanels?"true":void 0}updateFromUrl(ae){const{inspectPanelKey:xe,viewPanelScene:Le,isEditing:Ze,editPanel:at,shareView:ut}=this._scene.state,Et={};if(typeof ae.editview=="string"&&this._scene.canEditDashboard()?(Et.editview=il(ae.editview),Ze||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):Et.editview=void 0)):ae.hasOwnProperty("editview")&&(Et.editview=void 0),typeof ae.inspect=="string"){let _t=(0,C.vL)(this._scene,ae.inspect);if(!_t){if((0,D.ag)(ae.inspect)){this._handleInspectRepeatClone(ae.inspect);return}c.A.emit(Ke.r1.alertError,["Panel not found"]),l.Ny.partial({inspect:null});return}Et.inspectPanelKey=ae.inspect,Et.overlay=new qn({panelRef:_t.getRef()})}else xe&&(Et.inspectPanelKey=void 0,Et.overlay=void 0);if(typeof ae.viewPanel=="string"){const _t=(0,C.vL)(this._scene,ae.viewPanel);if(!_t){if((0,D.ag)(ae.viewPanel)){this._handleViewRepeatClone(ae.viewPanel);return}c.A.emit(Ke.r1.alertError,["Panel not found"]),l.Ny.partial({viewPanel:null});return}Et.viewPanelScene=new xl({panelRef:_t.getRef()})}else Le&&ae.viewPanel===null&&(Et.viewPanelScene=void 0);if(typeof ae.editPanel=="string"){const _t=(0,C.Uv)(this._scene,ae.editPanel);if(!_t){console.warn(`Panel ${ae.editPanel} not found`);return}this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),Ze||this._scene.onEnterEditMode();const nn=(0,C.iL)(_t);if(nn&&!nn?.state.isLoaded){this._waitForLibPanelToLoadBeforeEnteringPanelEdit(_t,nn);return}Et.editPanel=(0,cr.L)(_t)}else at&&ae.editPanel===null&&(Et.editPanel=void 0);typeof ae.shareView=="string"?(Et.shareView=ae.shareView,Et.overlay=o.$.featureToggles.newDashboardSharingComponent?new Ei.j({shareView:ae.shareView}):new yl.Z({activeTab:ae.shareView})):ut&&ae.shareView===null&&(Et.overlay=void 0,Et.shareView=void 0);const Wt=this._scene.state.body;if(Wt instanceof Hs.D){const _t=typeof ae.autofitpanels=="string";!!Wt.state.grid.state.UNSAFE_fitPanels!==_t&&Wt.state.grid.setState({UNSAFE_fitPanels:_t})}typeof ae.kiosk=="string"&&(ae.kiosk==="true"||ae.kiosk==="")&&(Et.kioskMode=eo.d9.Full),Object.keys(Et).length>0&&this._scene.setState(Et)}_handleInspectRepeatClone(ae){this._inspectEventSub||(this._inspectEventSub=this._scene.subscribeToEvent(yr.d,()=>{const xe=(0,C.vL)(this._scene,ae);xe&&(this._inspectEventSub?.unsubscribe(),this._scene.setState({inspectPanelKey:ae,overlay:new qn({panelRef:xe.getRef()})}))}))}_handleViewRepeatClone(ae){this._viewEventSub||(this._viewEventSub=this._scene.subscribeToEvent(yr.d,()=>{const xe=(0,C.vL)(this._scene,ae);xe&&(this._viewEventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new xl({panelRef:xe.getRef()})}))}))}_waitForLibPanelToLoadBeforeEnteringPanelEdit(ae,xe){const Le=xe.subscribeToState(Ze=>{Ze.isLoaded&&(this._scene.setState({editPanel:(0,cr.L)(ae)}),Le.unsubscribe())})}}var Pl=e(57852),bl=e(12469);class Pi{constructor(){this._binds=[]}addBinding(ae){bl.R.bind(ae.key,xe=>{xe.preventDefault(),xe.stopPropagation(),xe.returnValue=!1,ae.onTrigger()},ae.type??"keydown"),this._binds.push({...ae,type:ae.type??"keydown"})}removeAll(){this._binds.forEach(ae=>{bl.R.unbind(ae.key,ae.type)}),this._binds=[]}}var bi=e(58662),ll=e(37040);function cl(fe){const ae=new Pi;let xe=null;const Le=fe.canEditDashboard(),Ze=c.A.subscribe(Pl.Tp,ut=>{typeof ut.payload.panelId=="string"&&(xe=ut.payload.panelId)});function at(ut,Et){return()=>{const Wt=i.jh.findObject(ut,_t=>_t.state.key===xe);if(Wt&&Wt instanceof i.Eb){Et(Wt);return}}}return ae.addBinding({key:"v",onTrigger:at(fe,ut=>{if(fe.state.viewPanelScene)l.Ny.push(n.I.getUrlForPartial(l.Ny.getLocation(),{viewPanel:void 0}));else{const Et=n.I.stripBaseFromUrl((0,Fa.r7)(ut));l.Ny.push(Et)}})}),o.$.featureToggles.newDashboardSharingComponent?(ae.addBinding({key:"p u",onTrigger:at(fe,async ut=>{const Et=new Ei.j({shareView:bi.wr.link,panelRef:ut.getRef()});fe.showModal(Et)})}),ae.addBinding({key:"p e",onTrigger:at(fe,async ut=>{const Et=new Ei.j({shareView:bi.wr.embed,panelRef:ut.getRef()});fe.showModal(Et)})}),zr.TP.isSignedIn&&o.$.snapshotEnabled&&zr.TP.hasPermission(Gr.w.SnapshotsCreate)&&ae.addBinding({key:"p s",onTrigger:at(fe,async ut=>{const Et=new Ei.j({shareView:bi.wr.snapshot,panelRef:ut.getRef()});fe.showModal(Et)})})):ae.addBinding({key:"p s",onTrigger:at(fe,async ut=>{fe.showModal(new yl.Z({panelRef:ut.getRef()}))})}),ae.addBinding({key:"i",onTrigger:at(fe,async ut=>{fe.state.inspectPanelKey?l.Ny.push(n.I.getUrlForPartial(l.Ny.getLocation(),{inspect:void 0})):l.Ny.push(n.I.stripBaseFromUrl((0,Fa.Uu)(ut)))})}),ae.addBinding({key:"p x",onTrigger:at(fe,async ut=>{const Et=await(0,Fa.Lp)(ut);Et&&l.Ny.push(Et)})}),ae.addBinding({key:"p l",onTrigger:at(fe,ll.vR)}),ae.addBinding({key:"d r",onTrigger:()=>i.jh.getTimeRange(fe).onRefresh()}),ae.addBinding({key:"t z",onTrigger:()=>{Dl(fe)}}),ae.addBinding({key:"ctrl+z",onTrigger:()=>{Dl(fe)}}),ae.addBinding({key:"t a",onTrigger:()=>{Ia.b4.getTimePicker(fe)?.toAbsolute()}}),ae.addBinding({key:"t left",onTrigger:()=>{Cl(fe,"left")}}),ae.addBinding({key:"t right",onTrigger:()=>{Cl(fe,"right")}}),Le&&(ae.addBinding({key:"e",onTrigger:at(fe,async ut=>{if(ut.getRoot()instanceof vt){const Wt=(0,C.Cs)(ut);if(fe.state.editPanel)l.Ny.push(n.I.getUrlForPartial(l.Ny.getLocation(),{editPanel:void 0}));else{const _t=n.I.stripBaseFromUrl((0,Fa.e0)(Wt));l.Ny.push(_t)}}})}),ae.addBinding({key:"d s",onTrigger:fe.onOpenSettings}),ae.addBinding({key:"mod+s",onTrigger:()=>fe.openSaveDrawer({})}),ae.addBinding({key:"p r",onTrigger:at(fe,ut=>{fe.state.isEditing&&(0,ll.MI)(fe,ut)})}),ae.addBinding({key:"p d",onTrigger:at(fe,ut=>{fe.state.isEditing&&fe.duplicatePanel(ut)})}),ae.addBinding({key:"d shift+c",onTrigger:()=>{fe.state.body instanceof Hs.D&&fe.state.body.collapseAllRows()}}),ae.addBinding({key:"d shift+e",onTrigger:()=>{fe.state.body instanceof Hs.D&&fe.state.body.expandAllRows()}})),()=>{ae.removeAll(),Ze.unsubscribe()}}function Dl(fe){Ia.b4.getTimePicker(fe)?.onZoom()}function Cl(fe,ae){const xe=Ia.b4.getTimePicker(fe);xe&&(ae==="left"&&xe.onMoveBackward(),ae==="right"&&xe.onMoveForward())}var Wl=e(25953),Nl=e(17084),Ee=e(48492);const et=["title","description","tags","editable","graphTooltip","links","meta","preload"],nt="systemPanelFilterVar",Ct="systemDynamicRowSizeVar";class vt extends i.Bs{constructor(ae,xe="v1"){super({title:(0,s.t)("dashboard-scene.dashboard-scene.title.dashboard","Dashboard"),meta:{},editable:!0,$timeRange:ae.$timeRange??new i.JZ({}),body:ae.body??Hs.D.fromVizPanels(),links:ae.links??[],...ae,editPane:new W,layoutOrchestrator:new gn}),this._urlSync=new El(this),this._variableDependency=new Pt(this),this._renderBeforeActivation=!0,this.onEnterEditMode=()=>{this._initialState=i.Go.cloneSceneObjectState(this.state),this._initialUrlState=l.Ny.getLocation(),this.setState({isEditing:!0}),this.state.body.editModeChanged?.(!0),this._changeTracker.startTrackingChanges()},this.onRestore=async Le=>{let Ze;if(o.$.featureToggles.kubernetesClientDashboardsFolders?Ze=await In.w.restoreDashboard(Le.uid,Le.id):Ze=await In.w.restoreDashboard(Le.uid,Le.version),!Number.isInteger(Ze.version))return!1;const at={dashboard:new y.G(Le.data),meta:this.state.meta},ut=(0,Un.wM)(at),Et=i.Go.cloneSceneObjectState(ut.state);return Et.version=Ze.version,this.setState(Et),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{l.Ny.partial({editview:"settings"})},this.getSnapshotUrl=()=>this.serializer.getSnapshotUrl(),this.onSetScrollRef=Le=>{this._scrollRef=Le},this.serializer=rn(xe==="v2"?"v2":"v1"),this._changeTracker=new B.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=uo}_activationHandler(){let ae=window.__grafanaSceneContext;const xe=l.Ny.getLocation().pathname==="/dashboard/new";window.__grafanaSceneContext=this,this._initializePanelSearch(),this.state.isEditing&&(this._initialUrlState=l.Ny.getLocation(),this._changeTracker.startTrackingChanges()),xe&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&x.t.watch(this.state.uid);let Le=()=>{};o.$.publicDashboardAccessToken||(Le=cl(this));const Ze=new Ka(this);return(0,g.UA)().setCurrent(Ze),()=>{window.__grafanaSceneContext=ae,Le(),this._changeTracker.terminate(),Ze.destroy(),x.t.leave()}}_initializePanelSearch(){const ae=i.jh.lookupVariable(nt,this)?.getValue();typeof ae=="string"&&this.setState({panelSearch:ae});const xe=i.jh.lookupVariable(Ct,this)?.getValue();if(typeof xe=="string"){const Le=Number.parseInt(xe,10);this.setState({panelsPerRow:Number.isInteger(Le)?Le:void 0})}}saveCompleted(ae,xe,Le){this.serializer.onSaveComplete(ae,xe),this._changeTracker.stopTrackingChanges(),this.setState({version:xe.version,isDirty:!1,uid:xe.uid,id:xe.id,meta:{...this.state.meta,uid:xe.uid,url:xe.url,slug:xe.slug,folderUid:Le,version:xe.version},overlay:void 0}),this.state.editPanel?.dashboardSaved(),this._initialState=i.Go.cloneSceneObjectState(this.state),this._initialUrlState=l.Ny.getLocation(),this._changeTracker.startTrackingChanges()}exitEditMode({skipConfirm:ae,restoreInitialState:xe}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||ae||this.managedResourceCannotBeEdited()){this.exitEditModeConfirmed(xe||this.state.isDirty);return}c.A.publish(new u.bY({title:(0,s.t)("dashboard-scene.dashboard-scene.title.discard-changes-to-dashboard","Discard changes to dashboard?"),text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:()=>{this.exitEditModeConfirmed()}}))}exitEditModeConfirmed(ae=!0){this._changeTracker.stopTrackingChanges();const xe=n.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null,shareView:null});l.Ny.replace(n.I.stripBaseFromUrl(xe)),ae?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.state.body.editModeChanged?.(!1)}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:ae,onSaveSuccess:xe}){this.state.isEditing&&this.setState({overlay:new On({dashboardRef:this.getRef(),saveAsCopy:ae,onSaveSuccess:xe})})}openV2SchemaEditor(){this.setState({overlay:new dt({dashboardRef:this.getRef()})})}getPageNav(ae,xe){const{meta:Le,viewPanelScene:Ze,editPanel:at,title:ut,uid:Et}=this.state,Wt=!Et;let _t={text:ut,url:(0,Tt.u)({uid:Et,slug:Le.slug,currentQueryParams:ae.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null,shareView:null},isHomeDashboard:!Le.url&&!Le.slug&&!Wt&&!Le.isSnapshot,isSnapshot:Le.isSnapshot})};const{folderUid:nn}=Le;if(nn){const dn=(0,p.tc)(xe,`folder-dashboards-${nn}`).main;dn.id!=="not-found"&&(_t={..._t,parentItem:dn})}return Ze&&(_t={text:(0,s.t)("dashboard-scene.dashboard-scene.text.view-panel","View panel"),parentItem:_t,url:(0,Fa.r7)(Ze.state.panelRef.resolve())}),at&&(_t={text:(0,s.t)("dashboard-scene.dashboard-scene.text.edit-panel","Edit panel"),parentItem:_t}),_t}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addPanel(ae){this.state.isEditing||this.onEnterEditMode(),this.state.body.addPanel(ae)}createLibraryPanel(ae,xe){const Le=ae.clone({$behaviors:[new Qt.u({uid:xe.uid,name:xe.name})]}),Ze=ae.parent;if(!(Ze instanceof Vs.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");Ze.setState({body:Le})}duplicatePanel(ae){(0,C.h$)(ae).duplicatePanel?.(ae)}copyPanel(ae){if(o.$.featureToggles.dashboardNewLayouts){const Ze=ae.parent;if(Ze instanceof Wl.X){const at=(0,pn.V6)(Ze,this),ut=(0,Xt.zd)(Ze);(0,Ee.G2)(),h.A.set(m.tH,JSON.stringify({elements:at,gridItem:ut}))}else if(Ze instanceof Vs.U){const at=(0,pn.V6)(Ze,this),ut=(0,on.i2)(Ze);(0,Ee.G2)(),h.A.set(m.tH,JSON.stringify({elements:at,gridItem:ut}))}else throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");return}if(!ae.parent)return;let xe=ae.parent;if(!(xe instanceof Vs.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const Le=(0,gt.ZB)(xe);(0,Ee.G2)(),h.A.set(m.tH,JSON.stringify(Le))}pastePanel(){const ae=h.A.get(m.tH),xe=JSON.parse(ae),Le=new v.a9(xe),at=(0,Un.tt)(Le).state.body;this.addPanel(at),h.A.delete(m.tH)}removePanel(ae){(0,C.h$)(ae).removePanel?.(ae)}unlinkLibraryPanel(ae){if(!ae.parent)return;const xe=ae.parent;if(!(xe instanceof Vs.U)){console.error("Trying to unlink a lib panel in a layout that is not DashboardGridItem");return}xe.state.body.setState({$behaviors:void 0})}showModal(ae){this.setState({overlay:ae})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:ae,uid:xe}=this.state;if(xe)try{const Le=await(0,g.UA)().starDashboard(xe,!!ae.isStarred);this.setState({meta:{...ae,isStarred:Le}})}catch(Le){console.error("Failed to star dashboard",Le)}}onShowAddLibraryPanelDrawer(ae){this.setState({overlay:new Jt({panelToReplaceRef:ae})})}onCreateNewRow(){return(0,Nl.t)(this.state.body)}onCreateNewPanel(){const ae=(0,C.O8)();return this.addPanel(ae),ae}switchLayout(ae){const xe=this.state.body;I.cc.edit({description:(0,s.t)("dashboard.edit-actions.switch-layout","Switch layout"),source:this,perform:()=>this.setState({body:ae}),undo:()=>this.setState({body:xe})})}getLayout(){return this.state.body}enrichDataRequest(ae){const xe=(0,C.YQ)(ae);let Le=(0,C.xz)(ae);xe.state.isEditing&&xe.state.editPanel&&(Le=xe.state.editPanel.state.panelRef.resolve());let Ze=0;return Le&&Le.state.key&&((0,D.uc)(Le.state.key)?Ze=_s(Le?.state.key):Ze=(0,C.Cs)(Le)),{app:a.Jk.Dashboard,dashboardUID:this.state.uid,panelId:Ze,panelName:Le?.state?.title,panelPluginId:Le?.state.pluginId,dashboardTitle:this.state.title}}canEditDashboard(){const{meta:ae}=this.state;return!!(ae.canEdit||ae.canMakeEditable)}getInitialSaveModel(){return this.serializer.initialSaveModel}setInitialSaveModel(ae,xe,Le){this.serializer.initializeElementMapping(ae),this.serializer.initializeDSReferencesMapping(ae);const Ze=(0,r.v)(ae);this.serializer.initialSaveModel=Ze,this.serializer.metadata=xe,this.serializer.apiVersion=Le}getTrackingInformation(){return this.serializer.getTrackingInformation(this)}async onDashboardDelete(){this.setState({isDirty:!1}),l.Ny.replace("/")}getDashboardPanels(){return Ia.b4.getVizPanels(this)}rememberScrollPos(){this._prevScrollPos=this._scrollRef?.scrollTop}restoreScrollPos(){this._prevScrollPos!==void 0&&this._scrollRef?.scrollTo(0,this._prevScrollPos)}getSaveModel(){return this.serializer.getSaveModel(this)}getSaveResource(ae){const{meta:xe}=this.state,Le=this.getSaveAsModel(ae);return{apiVersion:`dashboard.grafana.app/${this.serializer instanceof Yt?"v2alpha1":"v1beta1"}`,kind:"Dashboard",metadata:{...xe.k8s,name:xe.uid??xe.k8s?.name,generateName:ae.isNew?"d":void 0},spec:Le}}getSaveAsModel(ae){return this.serializer.getSaveAsModel(this,ae)}getDashboardChanges(ae,xe,Le){return this.serializer.getDashboardChangesFromScene(this,{saveTimeRange:ae,saveVariables:xe,saveRefresh:Le})}getManagerKind(){return this.state.meta.k8s?.annotations?.[b.LH]}isManaged(){return!!this.getManagerKind()}isManagedRepository(){return o.$.featureToggles.provisioning?this.getManagerKind()===b.Sf.Repo:!1}managedResourceCannotBeEdited(){return this.isManaged()&&!this.isManagedRepository()&&!this.state.meta.k8s?.annotations?.[b.Ms]}getPath(){return this.state.meta.k8s?.annotations?.[b.Y_]}}class Pt{constructor(ae){this._dashboard=ae,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(ae,xe){if(xe&&(c.A.publish(new f.og({refreshAll:!0,panelIds:[]})),this._dashboard.publishEvent(new d._)),ae.state.name===nt){const Le=ae.getValue();typeof Le=="string"&&this._dashboard.setState({panelSearch:Le})}else if(ae.state.name===Ct){const Le=ae.getValue();if(typeof Le=="string"){const Ze=Number.parseInt(Le,10);this._dashboard.setState({panelsPerRow:Number.isInteger(Ze)?Ze:void 0})}}}}},7094:(Z,R,e)=>{"use strict";e.d(R,{u:()=>x});var n=e(74848),a=e(16207),s=e(92745),l=e(43173),o=e(36674),d=e(41654),i=e(82612),c=e(30124),m=e(18789),p=e(8285),h=e(32540),r=e(37040),g=e(66251),y=e(81657),v=e(93389);class x extends o.Bs{static{this.LOADING_VIZ_PANEL_PLUGIN_ID="library-panel-loading-plugin"}constructor(E){super(E),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.isLoaded||this.loadLibraryPanelFromPanelModel()}setPanelFromLibPanel(E){if(this.state._loadedPanel?.version===E.version)return;const D=this.parent;if(!(D instanceof o.Eb))return;const C=new i.a9(E.model),P=(0,p.Cs)(D);C.id=P;const T=[];T.push(new h.$({rawLinks:C.links,menu:new h.m({$behaviors:[r.oV]})})),T.push(new g.W);let O;l.$.featureToggles.preferLibraryPanelTitle?O=C.title??D.state.title:O=D.state.title??C.title;const I={title:O,options:C.options??{},fieldConfig:C.fieldConfig,pluginId:C.type,pluginVersion:C.pluginVersion,displayMode:C.transparent?"transparent":void 0,description:C.description,titleItems:T,$data:(0,m.w)(C)};(C.timeFrom||C.timeShift)&&(I.$timeRange=new y.v({timeFrom:C.timeFrom,timeShift:C.timeShift,hideTimeOverride:C.hideTimeOverride})),D.setState(I),D.changePluginType(C.type,I.options,I.fieldConfig),this.setState({_loadedPanel:E,isLoaded:!0,name:E.name});const j=D.parent;C.repeat&&j instanceof v.U&&(j.setState({variableName:C.repeat,repeatDirection:C.repeatDirection==="h"?"h":"v",maxPerRow:C.maxPerRow,itemHeight:j.state.height??10}),j.performRepeat())}unlink(){const E=this.parent;E instanceof o.Eb&&E.setState({$behaviors:E.state.$behaviors?.filter(D=>D!==this)})}async loadLibraryPanelFromPanelModel(){let E=this.parent;if(E instanceof o.Eb)try{const D=await(0,c.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(D)}catch{E.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}const f=new a.m(u);function u(b){return(0,n.jsx)(d.B,{direction:"column",justifyContent:"space-between",children:(0,n.jsx)(s.x6,{i18nKey:"library-panels.loading-panel-text",children:"Loading library panel"})})}o.Go.registerRuntimePanelPlugin({pluginId:x.LOADING_VIZ_PANEL_PLUGIN_ID,plugin:f})},66483:(Z,R,e)=>{"use strict";e.d(R,{c:()=>Me});var n=e(74848),a=e(96540),s=e(22803),l=e(78012),o=e(51898),d=e(92745),i=e(43173),c=e(36490),m=e(63142),p=e(7895),h=e(30703),r=e(88559),g=e(87063),y=e(45861),v=e(93256),x=e(36219),f=e(43707),u=e(5423),b=e(65642),E=e(95943),D=e(73427),C=e(22429),P=e(4590),T=e(52763),O=e(58662),I=e(25508),j=e(33680);const W=[],B=j.PP.endpoints.listRepository.select({}),S=(0,I.Mz)(B,He=>He.data?.items||W),w=(0,I.Mz)(S,(He,Re)=>Re,(He,Re)=>{if(Re)return He.find(Ne=>Ne.metadata?.name===Re)}),N=(0,I.Mz)(S,(He,Re)=>Re,(He,Re)=>He.find(Ne=>Ne.metadata?.name===Re));var M=e(89451),L=e(55867);const A=o.Tp.pages.Dashboard.DashNav.NewExportButton;function U({dashboard:He}){const[Re,Ne]=(0,a.useState)(!1),Ae=(0,a.useCallback)(Be=>{Ne(Be)},[]),Ue=()=>(0,n.jsx)(L.A,{dashboard:He});return(0,n.jsx)(v.e,{"data-testid":A.container,children:(0,n.jsx)(r.m,{overlay:Ue,placement:"bottom-end",onVisibleChange:Ae,children:(0,n.jsxs)(y.$n,{"data-testid":A.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,d.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,n.jsx)(d.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,n.jsx)(h.I,{name:Re?"angle-up":"angle-down",size:"sm"})]})})})}var F=e(41053),V=e(23289),K=e(16001),G=e(12434);const H=o.Tp.pages.Dashboard.DashNav.newShareButton;function _({dashboard:He,panel:Re}){const Ne=(0,m.of)(k),[Ae,Ue]=(0,a.useState)(!1),[Be,We]=(0,F.A)(async()=>(V.c.toolbarShareClick(),await(0,G.Xe)(He,Re)),[He]),_e=(0,a.useCallback)(le=>{le&&V.c.toolbarShareDropdownClick(),Ue(le)},[]),Xe=()=>(0,n.jsx)(K.Ay,{dashboard:He});return(0,n.jsxs)(v.e,{"data-testid":H.container,className:Ne.container,children:[(0,n.jsx)(y.$n,{"data-testid":H.shareLink,size:"sm",tooltip:(0,d.t)("share-dashboard.share-button-tooltip","Copy link"),onClick:We,children:(0,n.jsx)(d.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,n.jsx)(r.m,{overlay:Xe,placement:"bottom-end",onVisibleChange:_e,children:(0,n.jsx)(y.$n,{"aria-label":(0,d.t)("dashboard-scene.share-button.aria-label-sharedropdownmenu","Toggle share menu"),"data-testid":H.arrowMenu,size:"sm",icon:Ae?"angle-up":"angle-down"})})]})}function k(He){return{container:(0,s.css)({gap:1})}}var J=e(75541),z=e(8285),Y=e(63704),X=e(71599),Q=e(45229),q=e(87745);function te(He){return(0,n.jsx)(p.I,{"data-testid":"button-snapshot",tooltip:(0,d.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>ne(He.originalURL)},"button-snapshot")}const ne=He=>{const Re=He??"",Ne=Y.sQ.sanitizeUrl(Re);try{const Ae=new URL(Ne,i.$.appUrl),Ue=new URL(i.$.appUrl);Ae.host!==Ue.host?Q.A.publish(new q.S8({component:X.u,props:{title:(0,d.t)("dashboard-scene.on-open-snapshot-original-dashboard.title.proceed-to-external-site","Proceed to external site?"),modalClass:(0,s.css)({width:"max-content",maxWidth:"80vw"}),body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:Re})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:(0,d.t)("dashboard-scene.on-open-snapshot-original-dashboard.confirmText.proceed","Proceed"),onConfirm:()=>{window.location.href=Ae.href}}})):c.Ny.push(Ne)}catch(Ae){console.error("Failed to open original dashboard",Ae)}};var se=e(99887),ue=e(75735);function de({meta:He}){const Re=He.k8s;if(!Re?.annotations)return;let Ne="Provisioned";const Ae=Re.annotations?.[ue.LH],Ue=Re.annotations?.[ue.Jw];switch(Ae){case ue.Sf.Terraform:Ne="Terraform";break;case ue.Sf.Kubectl:Ne="Kubectl";break;case ue.Sf.Plugin:Ne=`Plugin: ${Ue}`;break}return(0,n.jsx)(se.E,{color:"purple",icon:"exchange-alt",tooltip:Ne},"provisioned-dashboard-button-badge")}const ie=({dashboard:He})=>{if(!He.state.meta.k8s?.annotations)return null;let Re="Provisioned";const Ne=He.state.meta.k8s.annotations[ue.LH],Ae=He.state.meta.k8s.annotations[ue.Jw];switch(Ne){case ue.Sf.Terraform:Re="Terraform";break;case ue.Sf.Kubectl:Re="Kubectl";break;case ue.Sf.Plugin:Re=`Plugin: ${Ae}`;break;case ue.Sf.Repo:Re="Repository";break}return(0,n.jsx)(se.E,{color:"purple",icon:"exchange-alt",tooltip:Re},"provisioned-dashboard-button-badge")},he=({dashboard:He})=>(0,n.jsx)(te,{originalURL:He.getSnapshotUrl()??""});var me=e(98036);const ce=({dashboard:He})=>(0,n.jsx)(p.I,{tooltip:He.state.meta.isStarred?(0,d.t)("dashboard.toolbar.new.unmark-favorite","Unmark as favorite"):(0,d.t)("dashboard.toolbar.new.mark-favorite","Mark as favorite"),icon:(0,n.jsx)(h.I,{name:He.state.meta.isStarred?"favorite":"star",size:"lg",type:He.state.meta.isStarred?"mono":"default"}),"data-testid":o.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{V.c.toolbarFavoritesClick(),He.onStarDashboard()}});var Pe=e(12991);const Ie=({dashboard:He})=>{const{editview:Re,editPanel:Ne,isEditing:Ae,uid:Ue,meta:Be,viewPanelScene:We}=He.useState(),_e=!!Re,Xe=!!We,le=!!Ae,ye=!!Ne,pe=!!Ue,ve=!!Be.canEdit,be=!!Be.canStar,Oe=!!Be.isSnapshot,we=!_e&&!Xe&&!ye,ze=(0,Pe.g)([...(0,Pe.f)(J.C.left,"left-dynamic",!ye),{key:"star-button",component:ce,group:"actions",condition:pe&&be&&we&&!le},{key:"public-dashboard-badge",component:me.d,group:"actions",condition:pe&&be&&we&&!le},{key:"managed-dashboard-badge",component:ie,group:"actions",condition:He.isManaged()&&ve},{key:"open-snapshot-origin-button",component:he,group:"actions",condition:Oe&&!le}],He);return ze.length===0?null:(0,n.jsx)(x.U,{alignment:"left",children:ze})};var Se=e(95395);const Me=(0,a.memo)(({dashboard:He})=>i.$.featureToggles.dashboardNewLayouts&&i.$.featureToggles.newDashboardSharingComponent?(0,n.jsx)(f.H,{breadcrumbActions:(0,n.jsx)(Ie,{dashboard:He}),actions:(0,n.jsx)(Se.GA,{dashboard:He})}):(0,n.jsx)(f.H,{actions:(0,n.jsx)(Te,{dashboard:He})}));Me.displayName="NavToolbarActions";function Te({dashboard:He}){const{isEditing:Re,viewPanelScene:Ne,isDirty:Ae,uid:Ue,meta:Be,editview:We,editPanel:_e,editable:Xe}=He.useState(),{isPlaying:le}=P._o.useState(),[ye,pe]=(0,a.useState)(!1),ve=D.TP.hasEditPermissionInFolders,be=[],Oe=(0,m.of)(ke),we=!!_e,ze=!!Ne,Ve=tt(_e),ge=_e&&(0,z.ME)(_e.state.panelRef.resolve()),Ke=!(Ue||He.isManaged()),qe=l.M.exists(E.tH),ot=!We&&!ze&&!we,lt=Re&&ot,mt=(0,T.d4)(Mt=>w(Mt,Be.folderUid)),Lt=!!(He.isManagedRepository()||mt),Tt=b.Ay.viewersCanEdit;we||Qe(be,J.C.left,"left-actions"),be.push({group:"icon-actions",condition:Ue&&!!Be.canStar&&ot&&!Re,render:()=>{let Mt=Be.isStarred?(0,d.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,d.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,n.jsx)(p.I,{tooltip:Mt,icon:(0,n.jsx)(h.I,{name:Be.isStarred?"favorite":"star",size:"lg",type:Be.isStarred?"mono":"default"}),"data-testid":o.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{V.c.toolbarFavoritesClick(),He.onStarDashboard()}},"star-dashboard-button")}}),be.push({group:"icon-actions",condition:Ue&&!!Be.canStar&&ot&&!Re,render:()=>(0,n.jsx)(me.d,{dashboard:He},"public-dashboard-badge")}),He.isManaged()&&Be.canEdit&&be.push({group:"icon-actions",condition:!0,render:()=>(0,n.jsx)(de,{meta:Be},"managed-dashboard-badge")}),be.push({group:"icon-actions",condition:Be.isSnapshot&&!Re,render:()=>(0,n.jsx)(te,{originalURL:He.getSnapshotUrl()??""},"go-to-snapshot-origin")}),!we&&!Re&&Qe(be,J.C.right,"icon-actions"),be.push({group:"add-panel",condition:lt,render:()=>(0,n.jsx)(r.m,{onVisibleChange:Mt=>{pe(Mt),V.c.toolbarAddClick()},overlay:()=>(0,n.jsxs)(g.W,{children:[(0,n.jsx)(g.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,d.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Mt=He.onCreateNewPanel();V.c.toolbarAddButtonClicked({item:"add_visualization"}),He.setState({editPanel:(0,M.L)(Mt,!0)})}},"add-visualization"),(0,n.jsx)(g.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,d.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{He.onShowAddLibraryPanelDrawer(),V.c.toolbarAddButtonClicked({item:"add_library_panel"})},disabled:He.isManagedRepository()},"add-panel-lib"),(0,n.jsx)(g.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,d.t)("dashboard.add-menu.row","Row"),onClick:()=>{He.onCreateNewRow(),V.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,n.jsx)(g.W.Item,{disabled:!qe,testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,d.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{He.pastePanel(),V.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,n.jsxs)(y.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":o.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(h.I,{name:ye?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),be.push({group:"playlist-actions",condition:le&&ot&&!Re,render:()=>(0,n.jsx)(p.I,{"data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,d.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>P._o.prev()},"play-list-prev")}),be.push({group:"playlist-actions",condition:le&&ot&&!Re,render:()=>(0,n.jsx)(p.I,{onClick:()=>P._o.stop(),"data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),be.push({group:"playlist-actions",condition:le&&ot&&!Re,render:()=>(0,n.jsx)(p.I,{"data-testid":o.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,d.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>P._o.next(),narrow:!0},"play-list-next")}),be.push({group:"back-button",condition:(ze||we)&&!ge,render:()=>(0,n.jsx)(y.$n,{onClick:()=>{c.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":o.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")}),be.push({group:"back-button",condition:!!We,render:()=>(0,n.jsx)(y.$n,{onClick:()=>{c.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":o.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")});const It=Ue&&!Re&&!Be.isSnapshot&&!le;return be.push({group:"main-buttons",condition:!i.$.featureToggles.newDashboardSharingComponent&&It,render:()=>(0,n.jsx)(y.$n,{tooltip:(0,d.t)("dashboard.toolbar.share.tooltip","Share dashboard"),size:"sm",className:Oe.buttonWithExtraMargin,fill:"outline",onClick:()=>{V.c.toolbarShareClick(),c.Ny.partial({shareView:O.wr.link})},"data-testid":o.Tp.components.NavToolbar.shareDashboard,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.share.label",children:"Share"})},"share-dashboard-button")}),be.push({group:"main-buttons",condition:!Re&&(He.canEditDashboard()||Tt)&&!ze&&!le&&Xe,render:()=>(0,n.jsx)(y.$n,{onClick:()=>{He.onEnterEditMode()},tooltip:(0,d.t)("dashboard.toolbar.edit.tooltip","Enter edit mode"),className:Oe.buttonWithExtraMargin,variant:i.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.edit.label",children:"Edit"})},"edit")}),be.push({group:"main-buttons",condition:!Re&&He.canEditDashboard()&&!ze&&!le&&!Xe,render:()=>(0,n.jsx)(y.$n,{onClick:()=>{He.onEnterEditMode(),He.setState({editable:!0,meta:{...Be,canEdit:!0}})},tooltip:(0,d.t)("dashboard.toolbar.enter-edit-mode.tooltip","This dashboard was marked as read only"),className:Oe.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.enter-edit-mode.label",children:"Make editable"})},"edit")}),be.push({group:"new-share-dashboard-buttons",condition:i.$.featureToggles.newDashboardSharingComponent&&It,render:()=>(0,n.jsx)(U,{dashboard:He},"new-export-dashboard-button")}),be.push({group:"new-share-dashboard-buttons",condition:i.$.featureToggles.newDashboardSharingComponent&&It,render:()=>(0,n.jsx)(_,{dashboard:He},"new-share-dashboard-button")}),be.push({group:"settings",condition:Re&&He.canEditDashboard()&&ot,render:()=>(0,n.jsx)(y.$n,{onClick:()=>{He.onOpenSettings()},tooltip:(0,d.t)("dashboard.toolbar.dashboard-settings.tooltip","Dashboard settings"),fill:"text",size:"sm",variant:"secondary","data-testid":o.Tp.components.NavToolbar.editDashboard.settingsButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.dashboard-settings.label",children:"Settings"})},"settings")}),be.push({group:"main-buttons",condition:Re&&!Ke&&ot,render:()=>(0,n.jsx)(y.$n,{onClick:()=>He.exitEditMode({skipConfirm:!1}),tooltip:(0,d.t)("dashboard.toolbar.exit-edit-mode.tooltip","Exits edit mode and discards unsaved changes"),size:"sm",fill:"text",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.exitButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.exit-edit-mode.label",children:"Exit edit"})},"discard")}),be.push({group:"main-buttons",condition:we&&!ge&&!We&&!ze,render:()=>(0,n.jsx)(y.$n,{onClick:_e?.onDiscard,tooltip:_e?.state.isNewPanel?(0,d.t)("dashboard.toolbar.discard-panel-new","Discard panel"):(0,d.t)("dashboard.toolbar.discard-panel","Discard panel changes"),size:"sm",disabled:!Ve,fill:"outline",variant:"destructive","data-testid":o.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:_e?.state.isNewPanel?(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.discard-panel-new",children:"Discard panel"}):(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.discard-panel",children:"Discard panel changes"})},"discard")}),be.push({group:"main-buttons",condition:we&&ge&&!We&&!ze,render:()=>(0,n.jsx)(y.$n,{onClick:_e?.onDiscard,tooltip:(0,d.t)("dashboard.toolbar.discard-library-panel-changes","Discard library panel changes"),size:"sm",fill:"outline",variant:"destructive","data-testid":o.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.discard-library-panel-changes",children:"Discard library panel changes"})},"discardLibraryPanel")}),be.push({group:"main-buttons",condition:we&&ge&&!We&&!ze,render:()=>(0,n.jsx)(y.$n,{onClick:_e?.onUnlinkLibraryPanel,tooltip:(0,d.t)("dashboard.toolbar.unlink-library-panel","Unlink library panel"),size:"sm",fill:"outline",variant:"secondary","data-testid":o.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.unlink-library-panel",children:"Unlink library panel"})},"unlinkLibraryPanel")}),be.push({group:"main-buttons",condition:we&&ge&&!We&&!ze,render:()=>(0,n.jsx)(y.$n,{onClick:_e?.onSaveLibraryPanel,tooltip:(0,d.t)("dashboard.toolbar.save-library-panel","Save library panel"),size:"sm",fill:"outline",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.save-library-panel",children:"Save library panel"})},"saveLibraryPanel")}),be.push({group:"main-buttons",condition:Re&&!ge&&(Be.canSave||ve),render:()=>{if(Ke)return(0,n.jsx)(y.$n,{onClick:()=>{He.openSaveDrawer({})},className:Oe.buttonWithExtraMargin,tooltip:(0,d.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm",variant:"primary","data-testid":o.Tp.components.NavToolbar.editDashboard.saveButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})},"save");if(ve&&!Be.canSave&&!Be.canMakeEditable&&!Lt)return(0,n.jsx)(y.$n,{onClick:()=>{He.openSaveDrawer({saveAsCopy:!0})},className:Oe.buttonWithExtraMargin,tooltip:(0,d.t)("dashboard.toolbar.save-dashboard-copy.tooltip","Save as copy"),size:"sm",variant:Ae?"primary":"secondary",children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.save-dashboard-copy.label",children:"Save as copy"})},"save");const Mt=(0,n.jsxs)(g.W,{children:[(0,n.jsx)(g.W.Item,{label:(0,d.t)("dashboard.toolbar.save-dashboard-short","Save"),icon:"save",onClick:()=>{He.openSaveDrawer({})}}),(0,n.jsx)(g.W.Item,{label:(0,d.t)("dashboard.toolbar.save-dashboard-copy.label","Save as copy"),icon:"copy",onClick:()=>{He.openSaveDrawer({saveAsCopy:!0})}})]});return(0,n.jsxs)(v.e,{className:Oe.buttonWithExtraMargin,children:[(0,n.jsx)(y.$n,{onClick:()=>{He.openSaveDrawer({})},tooltip:(0,d.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm","data-testid":o.Tp.components.NavToolbar.editDashboard.saveButton,variant:Ae?"primary":"secondary",children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})}),(0,n.jsx)(r.m,{overlay:Mt,children:(0,n.jsx)(y.$n,{"aria-label":(0,d.t)("dashboard.toolbar.more-save-options","More save options"),icon:"angle-down",variant:Ae?"primary":"secondary",size:"sm"})})]},"save")}}),(0,n.jsx)(x.U,{alignment:"right",children:Ge(be)})}function Ge(He){const Re=[];let Ne="";for(const Ae of He)Ae.condition&&(Ne&&Ne!==Ae.group&&Ne&&Re.push((0,n.jsx)(u.K,{},`${Ae.group}-separator`)),Re.push(Ae.render()),Ne=Ae.group);return Re}function Qe(He,Re,Ne){if(Re.length>0)for(const Ae of Re){const Ue={dashboard:(0,C.UA)().getCurrent()};if(Ae.show(Ue)){const Be=Ae.component;He.push({group:Ne,condition:!0,render:()=>(0,a.createElement)(Be,{...Ue,key:He.length})})}}}function tt(He){const[Re,Ne]=(0,a.useState)();return(0,a.useEffect)(()=>{if(He){const Ae=He.subscribeToState(Ue=>{Ue.isDirty!==Re&&Ne(Ue.isDirty)});return()=>Ae.unsubscribe()}},[He,Re]),Re}function ke(He){return{hiddenElementsContainer:(0,s.css)({display:"flex",padding:0,gap:He.spacing(1),whiteSpace:"nowrap"}),buttonWithExtraMargin:(0,s.css)({margin:He.spacing(0,.5)}),publicBadge:(0,s.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},32540:(Z,R,e)=>{"use strict";e.d(R,{$:()=>p,m:()=>r});var n=e(74848),a=e(92745),s=e(36674),l=e(67522),o=e(30703),d=e(88559),i=e(7895),c=e(87063),m=e(37040);class p extends s.Bs{constructor(){super(...arguments),this._variableDependency=new s.Sh(this,{onAnyVariableChanged:()=>{this.state.rawLinks&&this.state.rawLinks.length>0&&this.forceRender()}})}static{this.Component=h}}function h({model:y}){const{menu:v,rawLinks:x}=y.useState();if(s.jh.getTimeRange(y).useState(),!(y.parent instanceof s.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!x||x.length===0)return null;if(x.length===1){const f=(0,m.eQ)(y.parent)[0];return(0,n.jsx)(l.NR.TitleItem,{href:f.href,onClick:f.onClick,target:f.target,title:f.title,children:(0,n.jsx)(o.I,{name:"external-link-alt",size:"md"})})}return(0,n.jsx)(d.m,{overlay:()=>(0,n.jsx)(v.Component,{model:v},v.state.key),children:(0,n.jsx)(i.I,{icon:"external-link-alt",iconSize:"md","aria-label":(0,a.t)("dashboard-scene.viz-panel-links-renderer.aria-label-panel-links","Panel links")})})}class r extends s.Bs{static{this.Component=g}}function g({model:y}){const{links:v}=y.useState();return v?(0,n.jsx)(c.W,{children:v?.map((x,f)=>(0,n.jsx)(c.W.Item,{label:x.title,url:x.href,target:x.target,onClick:x.onClick},f))}):null}},37040:(Z,R,e)=>{"use strict";e.d(R,{eQ:()=>k,MI:()=>z,oV:()=>_,_i:()=>K,vR:()=>X});var n=e(54092),a=e(60188),s=e(83175),l=e(92745),o=e(43173),d=e(36490),i=e(36674),c=e(45229),m=e(64762),p=e(12066),h=e(15130),r=e(47797),g=e(54),y=e(20437),v=e(58662),x=e(26689),f=e(302),u=e(8001),b=e(63629),E=e(3260),D=e(8535),C=e(11257),P=e(87745),T=e(25494),O=e(99949),I=e(3371),j=e(23289),W=e(22079),B=e(8285),S=e(72746),w=e(32540),N=e(74848),M=e(12161);class L extends i.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,B.YQ)(this).closeModal()},this.onConfirm=()=>{const ne=(0,B.YQ)(this);ne.unlinkLibraryPanel(this.state.panelRef.resolve()),ne.closeModal()}}static{this.Component=A}}function A({model:te}){return(0,N.jsx)(M.l,{isOpen:!0,onConfirm:()=>{te.onConfirm(),te.onDismiss()},onDismiss:te.onDismiss})}let U;function F(){return U||(U=(0,u.dp)(b.qm),U)}const V="metrics-drilldown";function K(te){(async()=>{const se=te.parent,ue=se.getPlugin(),de=[],ie=[],he=(0,B.YQ)(se),{isEmbedded:me}=he.state.meta,ce=await G(se),Pe=(0,I.uc)(se.state.key);if(me){ce&&te.setState({items:[ce]});return}const Ie=!!he.state.editPanel;if(Ie||de.push({text:(0,l.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,W.r7)(se)}),he.canEditDashboard()&&he.state.editable&&!Pe&&!Ie&&de.push({text:(0,l.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,W.e0)((0,B.Cs)(se))}),o.$.featureToggles.newDashboardSharingComponent){const Te=[];Te.push({text:(0,l.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{j.c.sharingCategoryClicked({item:v.wr.link,shareResource:(0,v.hD)(se?.getRef())});const Ge=new T.j({shareView:v.wr.link,panelRef:se.getRef()});he.showModal(Ge)}}),Te.push({text:(0,l.t)("share-panel.menu.share-embed-title","Share embed"),iconClassName:"arrow",shortcut:"p e",onClick:()=>{j.c.sharingCategoryClicked({item:v.wr.embed,shareResource:(0,v.hD)(se.getRef())});const Ge=new T.j({shareView:v.wr.embed,panelRef:se.getRef()});he.showModal(Ge)}}),h.TP.isSignedIn&&o.$.snapshotEnabled&&h.TP.hasPermission(C.w.SnapshotsCreate)&&Te.push({text:(0,l.t)("share-panel.menu.share-snapshot-title","Share snapshot"),iconClassName:"camera",shortcut:"p s",onClick:()=>{j.c.sharingCategoryClicked({item:v.wr.snapshot,shareResource:(0,v.hD)(se.getRef())});const Ge=new T.j({shareView:v.wr.snapshot,panelRef:se.getRef()});he.showModal(Ge)}}),de.push({type:"submenu",text:(0,l.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:Te,onClick:Ge=>{Ge.preventDefault()}})}else de.push({text:(0,l.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{he.showModal(new O.Z({panelRef:se.getRef()}))},shortcut:"p s"});he.state.isEditing&&!Pe&&!Ie&&ie.push({text:(0,l.t)("panel.header-menu.duplicate","Duplicate"),iconClassName:"file-copy-alt",onClick:()=>{he.duplicatePanel(se)},shortcut:"p d"}),Ie||ie.push({text:(0,l.t)("panel.header-menu.copy","Copy"),iconClassName:"copy",onClick:()=>{he.copyPanel(se)}}),he.state.isEditing&&!Pe&&!Ie&&((0,B.ME)(se)?(ie.push({text:(0,l.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),iconClassName:"link-broken",onClick:()=>{he.showModal(new L({panelRef:se.getRef()}))}}),ie.push({text:(0,l.t)("panel.header-menu.replace-library-panel","Replace library panel"),iconClassName:"library-panel",onClick:()=>{he.onShowAddLibraryPanelDrawer(se.getRef())}})):o.$.featureToggles.newDashboardSharingComponent?ie.push({text:(0,l.t)("share-panel.menu.new-library-panel-title","New library panel"),iconClassName:"plus-square",onClick:()=>{const Te=new T.j({shareView:v.wr.libraryPanel,panelRef:se.getRef()});he.showModal(Te)}}):ie.push({text:(0,l.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{he.showModal(new O.Z({panelRef:se.getRef(),activeTab:v.wr.libraryPanel}))}})),(0,g.q0)()&&ie.push({text:(0,l.t)("panel.header-menu.new-alert-rule","New alert rule"),iconClassName:"bell",onClick:Te=>Y(se)}),Q(se.state.options)&&!Ie&&ie.push({text:se.state.options.legend.showLegend?(0,l.t)("panel.header-menu.hide-legend","Hide legend"):(0,l.t)("panel.header-menu.show-legend","Show legend"),iconClassName:se.state.options.legend.showLegend?"legend-hide":"legend-show",onClick:Te=>{Te.preventDefault(),X(se)},shortcut:"p l"}),he.canEditDashboard()&&ue&&!ue.meta.skipDataQuery&&!Pe&&ie.push({text:(0,l.t)("panel.header-menu.get-help","Get help"),iconClassName:"question-circle",onClick:Te=>{Te.preventDefault(),q(se,x.q.Help)}}),ce&&de.push(ce),de.push(H(ue,se,he)),F();const{extensions:Me}=U({extensionPointId:n.S.DashboardPanelMenu,context:J(se,he),limitPerPlugin:3});if(Me.length>0&&!he.state.isEditing){const Te=Me.filter(tt=>tt.type===n.u.link),[Ge,Qe]=Te.reduce(([tt,ke],He)=>(He.category===V?tt.push(He):ke.push(He),[tt,ke]),[[],[]]);Ge.length>0&&de.push({text:(0,l.t)("dashboard-scene.panel-menu-behavior.async-func.text.metrics-drilldown","Metrics drilldown"),iconClassName:"code-branch",type:"submenu",subMenu:(0,E.N9)(Ge)}),Qe.length>0&&de.push({text:(0,l.t)("dashboard-scene.panel-menu-behavior.async-func.text.extensions","Extensions"),iconClassName:"plug",type:"submenu",subMenu:(0,E.N9)(Qe)})}ie.length&&de.push({type:"submenu",text:(0,l.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:ie,onClick:Te=>{Te.preventDefault()}}),he.state.isEditing&&!Pe&&!Ie&&(de.push({text:"",type:"divider"}),de.push({text:(0,l.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{z(he,se)},shortcut:"p r"})),te.setState({items:de})})()}async function G(te){const ne=await(0,W.Lp)(te);if(ne)return{text:(0,l.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:ne}}function H(te,ne,se){const ue=[];return te&&!te.meta.skipDataQuery&&(ue.push({text:(0,l.t)("panel.header-menu.inspect-data","Data"),href:(0,W.Uu)(ne,x.q.Data),onClick:de=>{de.preventDefault(),d.Ny.partial({inspect:ne.state.key,inspectTab:x.q.Data})}}),se instanceof S.H$&&se.state.meta.canEdit&&ue.push({text:(0,l.t)("panel.header-menu.query","Query"),href:(0,W.Uu)(ne,x.q.Query),onClick:de=>{de.preventDefault(),d.Ny.partial({inspect:ne.state.key,inspectTab:x.q.Query})}})),ue.push({text:(0,l.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,W.Uu)(ne,x.q.JSON),onClick:de=>{de.preventDefault(),d.Ny.partial({inspect:ne.state.key,inspectTab:x.q.JSON})}}),{text:(0,l.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,W.Uu)(ne),onClick:de=>{de.isDefaultPrevented()||d.Ny.partial({inspect:ne.state.key,inspectTab:x.q.Data})},subMenu:ue.length>0?ue:void 0}}function _(te){if(!(te.parent instanceof w.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const ne=te.parent.parent;if(!(ne instanceof i.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");te.setState({links:k(ne)})}function k(te){const ne=(de,ie)=>i.jh.interpolate(te,de,ie),se=(0,f.CH)(te,ne);if(!se)return[];const ue=se.getLinks(ne);return ue.map(de=>({...de,onClick:(he,me)=>{j.c.panelLinkClicked({has_multiple_links:ue.length>1}),de.onClick?.(he,me)}}))}function J(te,ne){const se=i.jh.getTimeRange(te);let ue=(0,B.un)(te);const de=ue?.state.queries,ie=(0,B.Cs)(te);let he={};if(te.state.$variables&&te.state.$variables.state.variables.forEach(me=>{me instanceof i.xc&&(he={...he,[me.state.name]:{value:me.getValue(),text:me.getValueText()}})}),te.parent?.parent instanceof i.tI){const me=te.parent.parent;me.state.$variables&&me.state.$variables.state.variables.forEach(ce=>{ce instanceof i.xc&&(he={...he,[ce.state.name]:{value:ce.getValue(),text:ce.getValueText()}})})}return{id:ie,pluginId:te.state.pluginId,title:te.state.title,timeRange:se.state.value.raw,timeZone:(0,a.O)({timeZone:se.getTimeZone()}),dashboard:{uid:ne.state.uid,title:ne.state.title,tags:ne.state.tags||[]},targets:de,scopedVars:he,data:ue?.state.data}}function z(te,ne){c.A.publish(new P.bY({title:(0,l.t)("dashboard-scene.on-remove-panel.title.remove-panel","Remove panel"),text:(0,l.t)("dashboard-scene.on-remove-panel.text.remove-panel","Are you sure you want to remove this panel?"),icon:"trash-alt",yesText:"Remove",onConfirm:()=>te.removePanel(ne)}))}const Y=async te=>{try{const ne=await(0,y.J6)(te),se=s.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(ne),returnTo:window.location.pathname+window.location.search});d.Ny.push(se)}catch(ne){const se=`Error getting rule values from the panel: ${(0,r.q6)(ne)}`;(0,D.JD)((0,p.dx)((0,m.gi)(se)));return}};function X(te){const ne=te.state.options;Q(ne)&&typeof ne.legend.showLegend=="boolean"&&te.onOptionsChange({legend:{showLegend:!ne.legend.showLegend}})}function Q(te){return te!=null&&typeof te=="object"&&"legend"in te}const q=(te,ne)=>{d.Ny.partial({inspect:te.state.key,inspectTab:ne})}},66251:(Z,R,e)=>{"use strict";e.d(R,{W:()=>o});var n=e(74848),a=e(36674),s=e(46429),l=e(8285);class o extends a.Bs{constructor(){super({}),this.onActivate=()=>{const c=this.parent;if(!c||!(c instanceof a.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=d}getPanel(){const c=this.parent;return c&&c instanceof a.Eb?c:null}}function d({model:i}){const c=i.getPanel(),p=a.jh.getData(i).useState();if(!c)return null;const h=(0,l.Cs)(c);return p.data?.series?(0,n.jsx)(s.Z,{frames:p.data?.series,panelId:h}):null}},81657:(Z,R,e)=>{"use strict";e.d(R,{v:()=>r});var n=e(74848),a=e(22803),s=e(22592),l=e(17548),o=e(33239),d=e(36674),i=e(63142),c=e(45967),m=e(91867),p=e(67522),h=e(30703);class r extends d.XQ{constructor(x={}){super({...x,from:"now-6h",to:"now",value:(0,s.E2)()}),this._variableDependency=new d.Sh(this,{statePaths:["timeFrom","timeShift"]}),this.addActivationHandler(()=>this._onActivate())}static{this.Component=g}_onActivate(){this._subs.add(this.subscribeToState(f=>{const{timeInfo:u,timeRange:b}=this.getTimeOverride(this.getAncestorTimeRange().state.value);f.timeInfo!==u&&this.setState({timeInfo:u,value:b})}));const{timeRange:x}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({value:x,from:x.raw.from.toString(),to:x.raw.to.toString()})}ancestorTimeRangeChanged(x){const f=this.getTimeOverride(x.value);this.setState({value:f.timeRange,timeInfo:f.timeInfo})}getTimeOverride(x){const{timeFrom:f,timeShift:u}=this.state,b={timeInfo:"",timeRange:x};if(f){const E=d.jh.interpolate(this,this.state.timeFrom),D=l.describeTextRange(E);if(D.invalid)return b.timeInfo="invalid time override",b;if(l.isRelativeTimeRange(x.raw)){const C=this.getTimeZone();b.timeInfo=D.display,b.timeRange={from:o.parse(D.from,void 0,C),to:o.parse(D.to,void 0,C),raw:{from:D.from,to:D.to}}}}if(u){const E=d.jh.interpolate(this,this.state.timeShift);if(l.describeTextRange(E).invalid)return b.timeInfo="invalid timeshift",b;const C="-"+E;b.timeInfo+=" timeshift "+C;const P=o.parseDateMath(C,b.timeRange.from,!1),T=o.parseDateMath(C,b.timeRange.to,!0);if(!P||!T)return b.timeInfo="invalid timeshift",b;b.timeRange={from:P,to:T,raw:{from:P,to:T}}}return b}}function g({model:v}){const{timeInfo:x,hideTimeOverride:f}=v.useState(),u=(0,i.of)(y);return!x||f?null:(0,n.jsx)(c.m,{content:(0,n.jsx)(m.xS,{timeRange:v.state.value,timeZone:v.getTimeZone()}),children:(0,n.jsxs)(p.NR.TitleItem,{className:u.timeshift,children:[(0,n.jsx)(h.I,{name:"clock-nine",size:"sm"})," ",x]})})}const y=v=>({timeshift:(0,a.css)({color:v.colors.text.link,gap:v.spacing(.5),whiteSpace:"nowrap"})})},29700:(Z,R,e)=>{"use strict";e.d(R,{r:()=>v});var n=e(74848),a=e(96540),s=e(16207),l=e(92745),o=e(36490),d=e(36674),i=e(87063),c=e(41654),m=e(31286),p=e(93256),h=e(45861),r=e(88559),g=e(8285),y=e(72746);const v="__unconfigured-panel",x=new s.m(f);function f(u){const[b,E]=(0,a.useState)(!1),D=(0,a.useCallback)(O=>{E(O)},[]),C=()=>{o.Ny.partial({editPanel:u.id})},P=()=>{const O=window.__grafanaSceneContext;if(!(O instanceof y.H$))throw new Error("DashboardScene not found");const I=(0,g.vL)(O,(0,g.XA)(u.id));if(!I)throw new Error("Panel not found");O.onShowAddLibraryPanelDrawer(I.getRef())},T=()=>(0,n.jsxs)(i.W,{children:[(0,n.jsx)(i.W.Item,{icon:"pen",label:(0,l.t)("dashboard.new-panel.menu-open-panel-editor","Configure"),onClick:C}),(0,n.jsx)(i.W.Item,{icon:"library-panel",label:(0,l.t)("dashboard.new-panel.menu-use-library-panel","Use library panel"),onClick:P})]});return(0,n.jsx)(c.B,{direction:"row",alignItems:"center",height:"100%",justifyContent:"center",children:(0,n.jsx)(m.a,{paddingBottom:2,children:(0,n.jsxs)(p.e,{children:[(0,n.jsx)(h.$n,{icon:"sliders-v-alt",onClick:C,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.new-panel.configure-button",children:"Configure"})}),(0,n.jsx)(r.m,{overlay:T,placement:"bottom-end",onVisibleChange:D,children:(0,n.jsx)(h.$n,{"aria-label":(0,l.t)("dashboard.new-panel.configure-button-menu","Toggle menu"),icon:b?"angle-up":"angle-down"})})]})})})}d.Go.registerRuntimePanelPlugin({pluginId:v,plugin:x})},12161:(Z,R,e)=>{"use strict";e.d(R,{l:()=>l});var n=e(74848),a=e(92745),s=e(71599);const l=({isOpen:o,onConfirm:d,onDismiss:i})=>(0,n.jsx)(s.u,{title:(0,a.t)("dashboard-scene.unlink-modal.title-really-unlink-panel","Do you really want to unlink this panel?"),icon:"question-circle",body:(0,a.t)("dashboard-scene.unlink-modal.body-unlink-panel","If you unlink this panel, you will be able to edit it without affecting any other dashboards. However, once you make a change you will not be able to revert to its original reusable panel."),confirmText:(0,a.t)("dashboard-scene.unlink-modal.confirmText-yes-unlink","Yes, unlink"),onConfirm:()=>{d(),i()},onDismiss:i,isOpen:o})},18303:(Z,R,e)=>{"use strict";e.d(R,{v:()=>c});var n=e(74848),a=e(22803),s=e(7389),l=e(51898),o=e(36674),d=e(56887),i=e(63142);function c({dashboard:r}){const g=o.jh.getVariables(r).useState();return(0,n.jsx)(n.Fragment,{children:g.variables.map(y=>(0,n.jsx)(m,{variable:y},y.state.key))})}function m({variable:r}){const g=(0,o.gn)(r,{shouldActivateOrKeepAlive:!0}),{isSelected:y,onSelect:v,isSelectable:x}=(0,d.y)(r.state.key),f=(0,i.of)(h);if(g.hide===s.zL.hideVariable)return r.UNSAFE_renderAsHidden?(0,n.jsx)(r.Component,{model:r}):null;const u=b=>{if(x){if(b.target instanceof Element&&!b.target.closest("label")){b.stopPropagation();return}x&&v&&(b.stopPropagation(),v(b))}};return(0,n.jsxs)("div",{className:(0,a.cx)(f.container,y&&"dashboard-selected-element",x&&!y&&"dashboard-selectable-element"),onPointerDown:u,"data-testid":l.Tp.pages.Dashboard.SubMenu.submenuItem,children:[(0,n.jsx)(p,{variable:r,className:(0,a.cx)(x&&f.labelSelectable)}),(0,n.jsx)(r.Component,{model:r})]})}function p({variable:r,className:g}){const{state:y}=r;if(r.state.hide===s.zL.hideLabel)return null;const v=y.label||y.name,x=`var-${y.key}`;return(0,n.jsx)(o.Zx,{htmlFor:x,isLoading:y.loading,onCancel:()=>r.onCancel?.(),label:v,error:y.error,layout:"horizontal",description:y.description??void 0,className:g})}const h=r=>({container:(0,a.css)({display:"flex","> :nth-child(2)":(0,a.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"})}),labelWrapper:(0,a.css)({display:"flex",alignItems:"center"}),labelSelectable:(0,a.css)({cursor:"pointer"})})},3392:(Z,R,e)=>{"use strict";e.d(R,{E:()=>g,j:()=>y});var n=e(2543),a=e(7389),s=e(78282),l=e(65642),o=e(30124),d=e(99305),i=e(75515),c=e(97583),m=e(67933);function p(v,x){switch(v.kind){case"GridLayout":{const f=v.spec.items||[];v.spec.items=f.filter(u=>u.spec.element.name!==x);break}case"AutoGridLayout":{const f=v.spec.items||[];v.spec.items=f.filter(u=>u.kind==="AutoGridLayoutItem"&&u.spec.element.name!==x);break}case"RowsLayout":{const f=v.spec.rows||[];v.spec.rows=f.filter(u=>(p(u.spec.layout,x),!h(u.spec.layout)));break}case"TabsLayout":{const f=v.spec.tabs||[];v.spec.tabs=f.filter(u=>(p(u.spec.layout,x),!h(u.spec.layout)));break}}}function h(v){if(!v||!v.spec)return!0;switch(v.kind){case"GridLayout":return(v.spec.items||[]).length===0;case"AutoGridLayout":return(v.spec.items||[]).length===0;case"RowsLayout":return(v.spec.rows||[]).length===0;case"TabsLayout":return(v.spec.tabs||[]).length===0;default:return!0}}function r(v){return!!(v.libraryPanel?.name&&v.libraryPanel?.uid)}async function g(v){v.cleanUpRepeats();const x=v.getSaveModelCloneOld();x.id=null,v.processRepeats();const f=[],u={},b={},E={},D=new Map;for(const O of x.getVariables())E[O.name]=O;const C=(O,I)=>{if(O.datasource===void 0){O.datasource=I;return}let j=O.datasource,W=null;const B=j?.uid,S=B&&d.SY.exec(B);if(S){const w=S[1]||S[2]||S[4];W=E[w],W&&W.current&&(j=W.current.value)}return(0,s.l)().get(j).then(w=>{if(w.meta?.builtIn||(u["datasource"+w.meta?.id]={type:"datasource",id:w.meta.id,name:w.meta.name,version:w.meta.info.version||"1.0.0"},W))return;const N=O.libraryPanel,M=N?"-for-library-panel":"";let L="DS_"+w.name.replace(" ","_").toUpperCase()+M.toUpperCase();if(b[L]={name:L,label:w.name,description:"",type:"datasource",pluginId:w.meta?.id,pluginName:w.meta?.name,usage:b[L]?.usage},N){const A=b[L]?.usage?.libraryPanels||[];A.push({name:N.name,uid:N.uid}),b[L].usage={libraryPanels:A}}O.datasource={type:w.meta.id,uid:"${"+L+"}"}})},P=async O=>{if(O.type!=="row"){if(await C(O),O.targets)for(const j of O.targets)await C(j,O.datasource);const I=l.Ay.panels[O.type];I&&(u["panel"+I.id]={type:"panel",id:I.id,name:I.name,version:I.info.version})}},T=async O=>{if((0,i.X)(O)){const{name:I,uid:j}=O.libraryPanel;let W=O.libraryPanel.model;W||(W=(await(0,o.Yr)(j,!0)).model),await C(W);const{gridPos:B,id:S,...w}=W;D.has(j)||D.set(j,{name:I,uid:j,kind:c.i.Panel,model:w})}};try{for(const j of x.panels)if(await P(j),j.collapsed!==void 0&&j.collapsed===!0&&j.panels)for(const W of j.panels)await P(W);for(const j of x.getVariables())j.type==="query"?(await C(j),j.options=[],j.current={},j.refresh=j.refresh!==a.CO.never?j.refresh:a.CO.onDashboardLoad):j.type==="datasource"?j.current={}:j.type==="adhoc"&&await C(j);for(const j of x.annotations.list)await C(j);u.grafana={type:"grafana",id:"grafana",name:"Grafana",version:l.Ay.buildInfo.version};for(const j of x.panels)if(await T(j),j.collapsed!==void 0&&j.collapsed===!0&&j.panels)for(const W of j.panels)await T(W);(0,n.each)(b,j=>{f.push(j)});for(const j of x.getVariables())if((0,m.VO)(j)){const W="VAR_"+j.name.replace(" ","_").toUpperCase();f.push({name:W,type:"constant",label:j.label||j.name,value:j.query,description:""}),j.query="${"+W+"}",j.current={value:j.query,text:j.query,selected:!1},j.options=[j.current]}const O=[...D.entries()].reduce((j,[W,B])=>(j[W]=B,j),{}),I=(0,n.defaults)({__inputs:f,__elements:O,__requires:(0,n.sortBy)(u,["id"])},x);for(let j=0;j<I.panels.length;j++){const W=I.panels[j];r(W)&&(I.panels[j]={gridPos:W.gridPos,id:W.id,libraryPanel:{uid:W.libraryPanel.uid,name:W.libraryPanel.name}})}return I}catch(O){return console.error("Export failed:",O),{error:O}}}async function y(v){const x={},f=v.variables.filter(E=>E.kind==="DatasourceVariable");for(const E of v.variables)x[E.spec.name]=E.spec;const u=E=>{const D=E.datasource?.uid;if(D?.startsWith("${")&&D?.endsWith("}")){const C=D.slice(2,-1);if(f.find(T=>T.spec.name===C))return}E.datasource=void 0},b=E=>{if(E.spec.data.spec.queries)for(const D of E.spec.data.spec.queries)u(D.spec)};try{const E=v.elements,D=v.layout;for(const[C,P]of Object.entries(E))P.kind==="Panel"?b(P):P.kind==="LibraryPanel"&&(delete E[C],p(D,C));for(const C of v.variables)C.kind==="QueryVariable"?(u(C.spec),C.spec.options=[],C.spec.current={text:"",value:""}):C.kind==="DatasourceVariable"&&(C.spec.current={text:"",value:""});for(const C of v.annotations)u(C.spec);return v}catch(E){return console.error("Export failed:",E),{error:E}}}},25953:(Z,R,e)=>{"use strict";e.d(R,{X:()=>O});var n=e(2543),a=e(96540),s=e(36674),l=e(57558),o=e(3371),d=e(8285),i=e(41667),c=e(39765),m=e(74848),p=e(92745),h=e(25797),r=e(51156),g=e(31819),y=e(46415),v=e(33143);function x(I){const j=new h.C({title:(0,p.t)("dashboard.auto-grid.item-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new r.v({title:(0,p.t)("dashboard.auto-grid.item-options.repeat.variable.title","Repeat by variable"),id:"repeat-by-variable-select",description:(0,p.t)("dashboard.auto-grid.item-options.repeat.variable.description","Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard."),render:B=>(0,m.jsx)(f,{id:B.props.id,item:I})})),W=(0,y.h)(I.state.conditionalRendering);return[j,W]}function f({item:I,id:j}){const{variableName:W}=I.useState();return(0,m.jsx)(g.U,{id:j,sceneContext:I,repeat:W,onChange:B=>{v.cc.edit({description:(0,p.t)("dashboard.edit-actions.panel-repeat-variable","Panel repeat by"),source:I,perform:()=>I.setRepeatByVariable(B),undo:()=>I.setRepeatByVariable(W)})}})}var u=e(22803),b=e(63142),E=e(41116),D=e(39242);function C({model:I}){const{body:j,repeatedPanels:W,key:B}=I.useState(),{draggingKey:S}=I.getParentGrid().useState(),{isEditing:w}=(0,d.TN)(I),[N,M,L]=(0,E.H)(I),A=(0,b.of)(P);if(N&&!w)return null;const U=!!S,F=S===B;return W?(0,m.jsx)(m.Fragment,{children:W.map(V=>(0,m.jsxs)("div",{className:(0,u.cx)(M,A.wrapper),children:[(0,m.jsx)(V.Component,{model:V}),L]},V.state.key))}):(0,m.jsxs)("div",{ref:I.containerRef,"data-auto-grid-item-drop-target":U?B:void 0,children:[F&&(0,m.jsx)("div",{className:A.draggedPlaceholder}),(0,m.jsxs)("div",{className:(0,u.cx)(!F&&M,A.wrapper,F&&A.draggedWrapper),children:[(0,m.jsx)(j.Component,{model:j}),L]})]})}const P=I=>({container:(0,u.css)({width:"100%",height:"100%"}),wrapper:(0,u.css)({width:"100%",height:"100%",position:"relative"}),draggedWrapper:(0,u.css)({position:"absolute",zIndex:1e3,top:`var(${D.hM})`,left:`var(${D.PS})`,width:`var(${D.MS})`,height:`var(${D.PP})`,opacity:.8}),draggedPlaceholder:(0,u.css)({width:"100%",height:"100%",boxShadow:`0 0 ${I.spacing(.5)} ${I.colors.primary.border}`,background:`${I.colors.primary.transparent}`,zIndex:-1})});var T=e(29425);class O extends s.Bs{constructor(j){super({...j,conditionalRendering:j?.conditionalRendering??l.p.createEmpty()}),this._variableDependency=new s.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:()=>this.performRepeat()}),this.isDashboardLayoutItem=!0,this.containerRef=a.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=C}_activationHandler(){this.state.variableName&&this.performRepeat();const j=this.state.conditionalRendering?.activate();return()=>{j&&j()}}getOptions(){return x(this)}setElementBody(j){this.setState({body:j})}performRepeat(){if(!this.state.variableName||s.jh.hasVariableDependencyInLoadingState(this))return;const j=s.jh.lookupVariable(this.state.variableName,this)??new s.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(j instanceof s.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:W,texts:B}=(0,d.a7)(j);if((0,n.isEqual)(this._prevRepeatValues,W))return;const S=this.state.body,w=[],N={values:[""],texts:j.hasAllValue()?["All"]:["None"]},M=W.length?W:N.values,L=B.length?B:N.texts;for(let A=0;A<M.length;A++){const U={$variables:new s.Pj({variables:[new s.xc({name:j.state.name,value:M[A],text:String(L[A])})]}),key:(0,o.lv)(S.state.key,A)},F=S.clone(U);w.push(F)}this.setState({repeatedPanels:w}),this._prevRepeatValues=W,this.publishEvent(new c.d({source:this}),!0)}setRepeatByVariable(j){const W={variableName:j};this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this._variableDependency.setVariableNames(j?[j]:[]),this.setState(W),this.performRepeat()}getParentGrid(){if(!(this.parent instanceof T.o))throw new Error("Parent is not a AutoGridLayout");return this.parent}getBoundingBox(){const j=this.containerRef.current.getBoundingClientRect();return{width:j.width,height:j.height,top:this.containerRef.current.offsetTop,left:this.containerRef.current.offsetLeft}}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??0)>1&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(j){j&&(this._prevRepeatValues=void 0),this.performRepeat()}scrollIntoView(){(0,i.d)(this,this.containerRef)}}},29425:(Z,R,e)=>{"use strict";e.d(R,{o:()=>v});var n=e(96540),a=e(36674),s=e(8285),l=e(25953),o=e(74848),d=e(22803),i=e(63142),c=e(3371),m=e(6607),p=e(1837),h=e(8835);function r({model:x}){const{children:f,isHidden:u,isLazy:b}=x.useState(),E=(0,c.Qp)(x),D=(0,i.of)(g,x.state),{layoutOrchestrator:C,isEditing:P}=(0,s.TN)(x),T=a.jh.getAncestor(x,h.X2),{fillScreen:O}=T.useState();if(u||!C)return null;const I=!E&&P;return(0,o.jsxs)("div",{className:(0,d.cx)(D.container,O&&D.containerFillScreen,P&&D.containerEditing),ref:x.containerRef,children:[f.map(j=>b?(0,o.jsx)(a.w1,{className:D.container,children:(0,o.jsx)(j.Component,{model:j},j.state.key)},j.state.key):(0,o.jsx)(j.Component,{model:j},j.state.key)),I&&(0,o.jsx)(m.f,{layoutManager:T})]})}const g=(x,f)=>({container:(0,d.css)({display:"grid",position:"relative",gridTemplateColumns:f.templateColumns,gridTemplateRows:f.templateRows||"unset",gridAutoRows:f.autoRows||"unset",rowGap:x.spacing(f.rowGap??1),columnGap:x.spacing(f.columnGap??1),justifyItems:f.justifyItems||"unset",alignItems:f.alignItems||"unset",justifyContent:f.justifyContent||"unset",[x.breakpoints.down("md")]:f.md?{gridTemplateRows:f.md.templateRows,gridTemplateColumns:f.md.templateColumns,rowGap:f.md.rowGap?x.spacing(f.md.rowGap??1):void 0,columnGap:f.md.columnGap?x.spacing(f.md.rowGap??1):void 0,justifyItems:f.md.justifyItems,alignItems:f.md.alignItems,justifyContent:f.md.justifyContent}:void 0,...p.u}),containerFillScreen:(0,d.css)({flexGrow:1}),containerEditing:(0,d.css)({paddingBottom:x.spacing(5),position:"relative"}),wrapper:(0,d.css)({display:"grid",position:"relative",width:"100%",height:"100%"}),dragging:(0,d.css)({position:"fixed",top:0,left:0,zIndex:x.zIndex.portal+1,pointerEvents:"none"})});var y=e(39242);class v extends a.Bs{constructor(f){super({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:f.autoRows??"320px",children:f.children??[],...f}),this.containerRef=(0,n.createRef)(),this._draggedGridItem=null,this._initialGridItemPosition=null,this._onDragStart=this._onDragStart.bind(this),this._onDragEnd=this._onDragEnd.bind(this),this._onDrag=this._onDrag.bind(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=r}_activationHandler(){return()=>{this._resetPanelPositionAndSize(),document.body.removeEventListener("pointermove",this._onDrag),document.body.removeEventListener("pointerup",this._onDragEnd),document.body.classList.remove("dashboard-draggable-transparent-selection")}}isDraggable(){return this.state.isDraggable??!1}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}getDragHooks(){return{onDragStart:this._onDragStart}}_canDrag(f){return!this.isDraggable()||!(f.target instanceof Element)?!1:!!f.target.closest(`.${this.getDragClass()}`)&&!f.target.closest(`.${this.getDragClassCancel()}`)}_onDragStart(f,u){if(!this._canDrag(f))return;if(f.preventDefault(),f.stopPropagation(),!(u.parent instanceof l.X))throw new Error("Dragging wrong item");this._draggedGridItem=u.parent;const{top:b,left:E,width:D,height:C}=this._draggedGridItem.getBoundingBox();this._initialGridItemPosition={pageX:f.pageX,pageY:f.pageY,top:b,left:E},this._updatePanelSize(D,C),this._updatePanelPosition(b,E),this.setState({draggingKey:this._draggedGridItem.state.key}),document.body.addEventListener("pointermove",this._onDrag),document.body.addEventListener("pointerup",this._onDragEnd),document.body.classList.add("dashboard-draggable-transparent-selection"),(0,s.wP)(this)?.startDraggingSync(f,u)}_onDragEnd(){window.getSelection()?.removeAllRanges(),this._draggedGridItem=null,this._initialGridItemPosition=null,this._resetPanelPositionAndSize(),this.setState({draggingKey:void 0}),document.body.removeEventListener("pointermove",this._onDrag),document.body.removeEventListener("pointerup",this._onDragEnd),document.body.classList.remove("dashboard-draggable-transparent-selection")}_onDrag(f){if(!this._draggedGridItem||!this._initialGridItemPosition){this._onDragEnd();return}this._updatePanelPosition(this._initialGridItemPosition.top+(f.pageY-this._initialGridItemPosition.pageY),this._initialGridItemPosition.left+(f.pageX-this._initialGridItemPosition.pageX));const u=document.elementsFromPoint(f.clientX,f.clientY)?.find(b=>{const E=b.getAttribute("data-auto-grid-item-drop-target");return!!E&&E!==this._draggedGridItem.state.key})?.getAttribute("data-auto-grid-item-drop-target");u&&this._onDragOverItem(u)}_onDragOverItem(f){const u=[...this.state.children],b=u.findIndex(D=>D===this._draggedGridItem),E=u.findIndex(D=>D.state.key===f);b===-1||E===-1||(u.splice(b,1),u.splice(E,0,this._draggedGridItem),this.setState({children:u}))}_updatePanelPosition(f,u){this._setContainerStyle(y.hM,`${f}px`),this._setContainerStyle(y.PS,`${u}px`)}_updatePanelSize(f,u){this._setContainerStyle(y.MS,`${Math.floor(f)}px`),this._setContainerStyle(y.PP,`${Math.floor(u)}px`)}_resetPanelPositionAndSize(){this._removeContainerStyle(y.hM),this._removeContainerStyle(y.PS),this._removeContainerStyle(y.MS),this._removeContainerStyle(y.PP)}_setContainerStyle(f,u){this.containerRef.current?.style.setProperty(f,u)}_removeContainerStyle(f){this.containerRef.current?.style.removeProperty(f)}}},8835:(Z,R,e)=>{"use strict";e.d(R,{j:()=>w,YL:()=>N,X2:()=>M,jo:()=>V,Kf:()=>A});var n=e(74848),a=e(92745),s=e(36674),l=e(95943),o=e(33143),d=e(4974),i=e(3371),c=e(1682),m=e(8285),p=e(93389),h=e(48492),r=e(25953),g=e(29425),y=e(22803),v=e(2543),x=e(96540),f=e(51898),u=e(63142),b=e(41654),E=e(37386),D=e(43243),C=e(63527),P=e(45861),T=e(21285),O=e(51156);function I(K){const G=[];return G.push(new O.v({title:(0,a.t)("dashboard-scene.get-edit-options.title.column-options","Column options"),skipField:!0,render:()=>(0,n.jsx)(j,{layoutManager:K})})),G.push(new O.v({title:(0,a.t)("dashboard-scene.get-edit-options.title.row-height-options","Row height options"),skipField:!0,render:()=>(0,n.jsx)(W,{layoutManager:K})})),G}function j({layoutManager:K}){const{maxColumnCount:G,columnWidth:H}=K.useState(),[_,k]=x.useState(null),[J,z]=x.useState(!1),[Y,X]=x.useState(!1),Q=(0,u.of)(B);(0,x.useEffect)(()=>{J&&_&&(_.focus(),z(!1))},[J,_]);const q=["narrow","standard","wide","custom"].map(he=>({label:(0,v.capitalize)(he),value:he})),te=typeof H=="string",ne=te?(0,a.t)("dashboard.auto-grid.options.min-width","Min column width"):(0,a.t)("dashboard.auto-grid.options.min-width-custom","Custom min width"),se=["1","2","3","4","5","6","7","8","9","10"].map(he=>({label:he,value:he})),ue=he=>{const me=parseInt(he.target.value,10);if(isNaN(me)||me<50||me>2e3){X(!0);return}else Y&&X(!1);K.onColumnWidthChanged(me)},de=he=>{he.value==="custom"&&z(!0),K.onColumnWidthChanged(he.value)},ie=()=>{Y&&X(!1),K.onColumnWidthChanged("standard")};return(0,n.jsxs)(b.B,{columnGap:2,rowGap:0,wrap:!0,children:[(0,n.jsx)(E.D,{label:ne,invalid:Y,error:Y?(0,a.t)("dashboard.auto-grid.options.min-width-error","A number between 50 and 2000 is required"):void 0,className:Q.wideSelector,children:te?(0,n.jsx)(D.G,{id:"min-column-width",options:q,value:H,onChange:de,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.minColumnWidth}):(0,n.jsx)(C.p,{id:"min-column-width",defaultValue:H,onBlur:ue,ref:he=>k(he),type:"number",min:50,max:2e3,invalid:Y,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.customMinColumnWidth,suffix:(0,n.jsx)(P.$n,{size:"sm",fill:"text",icon:"times",tooltip:(0,a.t)("dashboard.auto-grid.options.min-width-custom-clear","Back to standard min column width"),onClick:ie,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.clearCustomMinColumnWidth,children:(0,a.t)("dashboard.auto-grid.options.custom-min-width.clear","Clear")})})}),(0,n.jsx)(E.D,{label:(0,a.t)("dashboard.auto-grid.options.max-columns","Max columns"),className:Q.narrowSelector,children:(0,n.jsx)(D.G,{id:"max-columns",options:se,value:String(G),onChange:({value:he})=>K.onMaxColumnCountChanged(parseInt(he,10)),width:6.5,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.maxColumns})})]})}function W({layoutManager:K}){const{rowHeight:G,fillScreen:H}=K.useState(),[_,k]=x.useState(null),[J,z]=x.useState(!1),[Y,X]=x.useState(!1),Q=(0,u.of)(B);(0,x.useEffect)(()=>{J&&_&&(_.focus(),z(!1))},[J,_]);const q=["short","standard","tall","custom"].map(ie=>({label:(0,v.capitalize)(ie),value:ie})),te=typeof G=="string",ne=G?(0,a.t)("dashboard.auto-grid.options.min-height","Row height"):(0,a.t)("dashboard.auto-grid.options.min-height-custom","Custom row height"),se=ie=>{const he=parseInt(ie.target.value,10);if(isNaN(he)||he<50||he>2e3){X(!0);return}else Y&&X(!1);K.onRowHeightChanged(he)},ue=ie=>{ie.value==="custom"&&z(!0),K.onRowHeightChanged(ie.value)},de=()=>{Y&&X(!1),K.onRowHeightChanged("standard")};return(0,n.jsxs)(b.B,{columnGap:2,rowGap:0,wrap:!0,children:[(0,n.jsx)(E.D,{label:ne,invalid:Y,error:Y?(0,a.t)("dashboard.auto-grid.options.min-height-error","A number between 50 and 2000 is required"):void 0,className:Q.wideSelector,children:te?(0,n.jsx)(D.G,{id:"min-height",options:q,value:G,onChange:ue,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.rowHeight}):(0,n.jsx)(C.p,{id:"min-height",defaultValue:G,onBlur:se,ref:ie=>k(ie),type:"number",min:50,max:2e3,invalid:Y,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.customRowHeight,suffix:(0,n.jsx)(P.$n,{size:"sm",fill:"text",icon:"times",tooltip:(0,a.t)("dashboard.auto-grid.options.min-width-custom-clear","Back to standard min column width"),onClick:de,"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.clearCustomRowHeight,children:(0,a.t)("dashboard.auto-grid.options.custom-min-height.clear","Clear")})})}),(0,n.jsx)(E.D,{label:(0,a.t)("dashboard.auto-grid.options.height-fill","Fill screen"),className:Q.narrowSelector,children:(0,n.jsx)(T.K,{id:"fill-screen-toggle",value:H,onChange:()=>K.onFillScreenChanged(!H),"data-testid":f.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.fillScreen})})]})}const B=K=>({wideSelector:(0,y.css)({minWidth:K.spacing(14),flex:`1 1 ${K.spacing(14)}`}),narrowSelector:(0,y.css)({width:K.spacing(10)})}),S=3,w="standard",N="standard";class M extends s.Bs{constructor(G){const H=G.maxColumnCount??S,_=G.columnWidth??w,k=G.rowHeight??N,J=G.fillScreen??!1;super({...G,maxColumnCount:H,columnWidth:_,rowHeight:k,fillScreen:J,layout:G.layout??new g.o({isDraggable:!0,templateColumns:A(H,_),autoRows:V(k,J)})}),this.isDashboardLayoutManager=!0,this.descriptor=M.descriptor}static{this.Component=L}static{this.descriptor={get name(){return(0,a.t)("dashboard.auto-grid.name","Auto grid")},get description(){return(0,a.t)("dashboard.auto-grid.description","Panels resize to fit and form uniform grids")},id:"AutoGridLayout",createFromLayout:M.createFromLayout,isGridLayout:!0,icon:"apps"}}serialize(){return(0,d.K4)(this)}getOutlineChildren(){return this.state.layout.state.children.map(H=>H.state.body)}addPanel(G){const H=c.b4.getNextPanelId(this);G.setState({key:(0,m.XA)(H)}),G.clearParent();const _=new r.X({body:G});o.cc.addElement({addedObject:G,source:this,perform:()=>{this.state.layout.setState({children:[...this.state.layout.state.children,_]})},undo:()=>{this.state.layout.setState({children:this.state.layout.state.children.filter(k=>k!==_)})}})}pastePanel(){const G=(0,h.dp)((0,m.YQ)(this));this.state.layout.setState({children:[...this.state.layout.state.children,G]}),this.publishEvent(new o.jO(G),!0),(0,h.G2)()}removePanel(G){const H=G.parent;if(!(H instanceof r.X))return;const _=this.state.layout.state.children.indexOf(H);o.cc.removeElement({removedObject:G,source:this,perform:()=>{this.state.layout.setState({children:this.state.layout.state.children.filter(k=>k!==H)})},undo:()=>{this.state.layout.setState({children:[...this.state.layout.state.children.slice(0,_),H,...this.state.layout.state.children.slice(_)]})}})}duplicate(){const G=this.state.layout.state.children,H=[];if(G.length){let _=c.b4.getNextPanelId(G[0].state.body);G.forEach(k=>{const J=k.clone({key:void 0,body:k.state.body.clone({key:(0,m.XA)(_)})});H.push(J),_++})}return this.clone({key:void 0,layout:this.state.layout.clone({key:void 0,children:H})})}duplicatePanel(G){const H=G.parent;if(!(H instanceof r.X)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}const _=c.b4.getNextPanelId(this),k=this.state.layout,J=G.clone({key:(0,m.XA)(_)}),z=H.clone({key:(0,m.ty)(_),body:J}),Y=k.state.children.indexOf(H),X=[...k.state.children];X.splice(Y+1,0,z),k.setState({children:X}),this.publishEvent(new o.jO(J),!0)}getVizPanels(){const G=[];for(const H of this.state.layout.state.children)H instanceof r.X&&G.push(H.state.body);return G}editModeChanged(G){this.state.layout.setState({isDraggable:G}),(0,m.X0)(this.state.layout,!0)}cloneLayout(G,H){return this.clone({layout:this.state.layout.clone({isDraggable:H&&this.state.layout.state.isDraggable,children:this.state.layout.state.children.map(_=>{if(_ instanceof r.X){const k=(0,m.Cs)(_.state.body),J=(0,i.ed)(G,(0,m.ty)(k));return _.clone({key:J,body:_.state.body.clone({key:(0,i.ed)(J,(0,m.XA)(k))})})}throw new Error("Unexpected child type")})})})}getOptions(){return I(this)}onMaxColumnCountChanged(G){this.setState({maxColumnCount:G}),this.state.layout.setState({templateColumns:A(G,this.state.columnWidth)})}onColumnWidthChanged(G){G==="custom"&&(G=U(this.state.columnWidth)),this.setState({columnWidth:G}),this.state.layout.setState({templateColumns:A(this.state.maxColumnCount,this.state.columnWidth)})}onFillScreenChanged(G){this.setState({fillScreen:G}),this.state.layout.setState({autoRows:V(this.state.rowHeight,G)})}onRowHeightChanged(G){G==="custom"&&(G=F(this.state.rowHeight)),this.setState({rowHeight:G}),this.state.layout.setState({autoRows:V(G,this.state.fillScreen)})}static createEmpty(){return new M({})}static createFromLayout(G){const H=G.getVizPanels(),_=[];for(let J of H){const z=J.parent instanceof p.U?J.parent.state.variableName:void 0;_.push(new r.X({body:J.clone(),variableName:z}))}const k=M.createEmpty();return k.state.layout.setState({children:_,isDraggable:(0,m.YQ)(G).state.isEditing}),k}}function L({model:K}){return(0,n.jsx)(K.state.layout.Component,{model:K.state.layout})}function A(K,G){return`repeat(auto-fit, minmax(min(max(100% / ${K} - ${l.dU}px, ${U(G)}px), 100%), 1fr))`}function U(K){if(typeof K=="number")return K;switch(K){case"narrow":return 192;case"wide":return 768;case"custom":case"standard":default:return 448}}function F(K){if(typeof K=="number")return K;switch(K){case"short":return 168;case"tall":return 512;case"custom":case"standard":default:return 320}}function V(K,G){const H=F(K),_=G?"auto":`${H}px`;return`minmax(${H}px, ${_})`}},39242:(Z,R,e)=>{"use strict";e.d(R,{MS:()=>s,PP:()=>l,PS:()=>a,hM:()=>n});const n="--responsive-grid-dragged-item-top",a="--responsive-grid-dragged-item-left",s="--responsive-grid-dragged-item-width",l="--responsive-grid-dragged-item-height"},93389:(Z,R,e)=>{"use strict";e.d(R,{U:()=>j});var n=e(2543),a=e(96540),s=e(36674),l=e(95943),o=e(3371),d=e(8285),i=e(41667),c=e(39765),m=e(74848),p=e(92745),h=e(77824),r=e(18857),g=e(25797),y=e(51156),v=e(31819),x=e(33143);function f(W){return[new g.C({title:(0,p.t)("dashboard.default-layout.item-options.repeat.title","Repeat options"),id:"Repeat options",isOpenDefault:!1}).addItem(new y.v({title:(0,p.t)("dashboard.default-layout.item-options.repeat.variable.title","Repeat by variable"),id:"repeat-by-variable-select",description:(0,p.t)("dashboard.default-layout.item-options.repeat.variable.description","Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard."),render:S=>(0,m.jsx)(E,{id:S.props.id,gridItem:W})})).addItem(new y.v({title:(0,p.t)("dashboard.default-layout.item-options.repeat.direction.title","Repeat direction"),useShowIf:()=>{const{variableName:S}=W.useState();return!!S},render:()=>(0,m.jsx)(u,{gridItem:W})})).addItem(new y.v({title:(0,p.t)("dashboard.default-layout.item-options.repeat.max","Max per row"),useShowIf:()=>{const{variableName:S,repeatDirection:w}=W.useState();return!!S&&w==="h"},render:()=>(0,m.jsx)(b,{gridItem:W})}))]}function u({gridItem:W}){const{repeatDirection:B}=W.useState(),S=[{label:(0,p.t)("dashboard.default-layout.item-options.repeat.direction.horizontal","Horizontal"),value:"h"},{label:(0,p.t)("dashboard.default-layout.item-options.repeat.direction.vertical","Vertical"),value:"v"}];return(0,m.jsx)(h.z,{options:S,value:B??"h",onChange:w=>{x.cc.edit({description:(0,p.t)("dashboard.edit-actions.panel-repeat-direction","Repeat direction"),source:W,perform:()=>W.setRepeatDirection(w),undo:()=>W.setRepeatDirection(B??"h")})}})}function b({gridItem:W}){const{maxPerRow:B}=W.useState(),S=[2,3,4,6,8,12].map(w=>({label:w.toString(),value:w}));return(0,m.jsx)(r.l6,{options:S,value:B??4,onChange:w=>{x.cc.edit({description:(0,p.t)("dashboard.edit-actions.panel-max-repeats-per-row","Max repeats per row"),source:W,perform:()=>W.setMaxPerRow(w.value),undo:()=>W.setMaxPerRow(B??4)})}})}function E({gridItem:W,id:B}){const{variableName:S,width:w}=W.useState(),N=(0,a.useCallback)(L=>{W.setRepeatByVariable(L),W.handleVariableName(),w!==24&&(W.setState({width:24}),s.jh.getAncestor(W,s.hy).forceRender())},[W,w]),M=(0,a.useCallback)(L=>{L!==S&&x.cc.edit({description:(0,p.t)("dashboard.edit-actions.panel-repeat-variable","Panel repeat by"),source:W,perform:()=>N(L),undo:()=>N(S)})},[W,N,S]);return(0,m.jsx)(v.U,{id:B,sceneContext:W,repeat:S,onChange:M})}var D=e(22803),C=e(43173);function P({model:W}){const{repeatedPanels:B,itemHeight:S,variableName:w,body:N}=W.useState(),M=B?.length??0,L=T(W.getRepeatDirection(),M,W.getMaxPerRow(),S??10);return!w&&N instanceof s.Eb?(0,m.jsx)("div",{className:O,ref:W.containerRef,children:(0,m.jsx)(N.Component,{model:N},N.state.key)}):B?(0,m.jsx)("div",{className:L,ref:W.containerRef,children:B.map(A=>(0,m.jsx)("div",{className:O,children:(0,m.jsx)(A.Component,{model:A},A.state.key)},A.state.key))}):null}function T(W,B,S,w){return(0,a.useMemo)(()=>{const N=C.$.theme2,M=w*l.sD*B+(B-1)*l.dU;if(W==="h"){const L=Math.ceil(B/S),A=Math.min(B,S);return(0,D.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${A}, 1fr)`,gridTemplateRows:`repeat(${L}, 1fr)`,gridColumnGap:N.spacing(1),gridRowGap:N.spacing(1),[N.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:M}})}return(0,D.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:N.spacing(1),[N.breakpoints.down("md")]:{height:M}})},[W,B,S,w])}const O=(0,D.css)({display:"flex",flexGrow:1,position:"relative",width:"100%",height:"100%"});class I{constructor(B){this._gridItem=B}getNames(){return this._gridItem.state.variableName?new Set([this._gridItem.state.variableName]):new Set}hasDependencyOn(B){return this._gridItem.state.variableName===B}variableUpdateCompleted(B){this._gridItem.state.variableName===B.state.name&&this._gridItem.performRepeat()}}class j extends s.Bs{constructor(B){super(B),this._variableDependency=new I(this),this.isDashboardLayoutItem=!0,this.containerRef=a.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=P}_activationHandler(){return this.handleVariableName(),()=>{this._handleGridSizeUnsubscribe()}}_handleGridSizeSubscribe(){this._gridSizeSub||(this._gridSizeSub=this.subscribeToState((B,S)=>this._handleGridResize(B,S)))}_handleGridSizeUnsubscribe(){this._gridSizeSub&&(this._gridSizeSub.unsubscribe(),this._gridSizeSub=void 0)}_handleGridResize(B,S){if(B.height===S.height)return;const w=this.state.repeatedPanels?.length??1,N={};if(this.getRepeatDirection()==="v")N.itemHeight=Math.ceil(B.height/w);else{const M=Math.ceil(w/this.getMaxPerRow());N.itemHeight=Math.ceil(B.height/M)}N.itemHeight!==this.state.itemHeight&&this.setState(N)}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}getOptions(){return f(this)}setElementBody(B){this.setState({body:B})}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??!1)&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(B){B&&(this._prevRepeatValues=void 0),this.state.variableName&&this.state.repeatDirection==="h"&&this.state.width!==l.cV&&this.setState({width:l.cV})}performRepeat(){if(!this.state.variableName||s.jh.hasVariableDependencyInLoadingState(this))return;const B=s.jh.lookupVariable(this.state.variableName,this)??new s.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(B instanceof s.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:S,texts:w}=(0,d.a7)(B);if((0,n.isEqual)(this._prevRepeatValues,S))return;const N=this.state.body,M=[],L={values:[""],texts:B.hasAllValue()?["All"]:["None"]},A=S.length?S:L.values,U=w.length?w:L.texts;for(let _=0;_<A.length;_++){const k={$variables:new s.Pj({variables:[new s.xc({name:B.state.name,value:A[_],text:String(U[_]),isMulti:B.state.isMulti,includeAll:B.state.includeAll})]}),key:(0,o.lv)(N.state.key,_)},J=N.clone(k);M.push(J)}const F=this.getRepeatDirection(),V={repeatedPanels:M},K=this.state.itemHeight??10,G=this.state.height,H=this.getMaxPerRow();if(F==="h"){const _=Math.ceil(M.length/H);V.height=_*K}else V.height=M.length*K;if(this.setState(V),G!==this.state.height){const _=s.jh.getLayout(this);_ instanceof s.hy&&_.forceRender()}this._prevRepeatValues=S,this.publishEvent(new c.d({source:this}),!0)}handleVariableName(){this.state.variableName?this._handleGridSizeSubscribe():this._handleGridSizeUnsubscribe(),this.performRepeat()}setRepeatByVariable(B){const S={variableName:B};B&&!this.state.repeatDirection&&(S.repeatDirection="h"),this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this.setState(S)}getMaxPerRow(){return this.state.maxPerRow??4}setMaxPerRow(B){this.setState({maxPerRow:B})}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}setRepeatDirection(B){this.setState({repeatDirection:B})}isRepeated(){return this.state.variableName!==void 0}scrollIntoView(){const B=document.querySelector(`[data-griditem-key="${this.state.key}"`);B instanceof HTMLElement?(0,i.R)(B):(0,i.d)(this,this.containerRef)}}},1131:(Z,R,e)=>{"use strict";e.d(R,{D:()=>j});var n=e(74848),a=e(22803),s=e(92745),l=e(43173),o=e(36674),d=e(63142),i=e(95943),c=e(84403),m=e(33143),p=e(17340),h=e(3371),r=e(1682),g=e(8285),y=e(25953),v=e(6607),x=e(48492),f=e(1837),u=e(93389),b=e(87308);const E=8,D=6,C=12,P=8;function T(S){const w=new Set;let N=0;function M(L){for(let A=0;A<L.state.width;A++)for(let U=0;U<L.state.height;U++){const F=`${L.state.x+A},${L.state.y+U}`;w.add(F),L.state.y+L.state.height>N&&(N=L.state.y+L.state.height)}}for(const L of S.state.children)if(M(L),L instanceof o.tI)for(const A of L.state.children)M(A);for(let L=0;L<1/0;L++){for(let A=0;A<=i.cV-E;A++){let U=!0;for(let F=0;F<E;F++){for(let V=0;V<D;V++){const K=`${A+F},${L+V}`;if(w.has(K)){U=!1;break}}if(!U)break}if(U)return O(w,{x:A,y:L,width:E,height:D},N)}if(L>N+D)break}return{x:0,y:N,width:C,height:P}}function O(S,w,N){if(w.y>=N)return w.width=C,w.height=P,w;for(let M=w.x+w.width+1;M<=i.cV;M++){let L=!0;for(let A=w.y;A<w.y+w.height;A++){const U=`${M},${A}`;if(S.has(U)){L=!1;break}}if(L)w.width=M-w.x;else break}for(let M=w.y+w.height+1;M<=N;M++){let L=!0;if(w.height>=20)break;for(let A=w.x;A<w.x+w.width;A++){const U=`${A},${M}`;if(S.has(U)){L=!1;break}}if(L)w.height=M-w.y;else break}return w}var I=e(18178);class j extends o.Bs{constructor(w){super(w),this.isDashboardLayoutManager=!0,this.descriptor=j.descriptor,this.addActivationHandler(()=>this._activationHandler())}static{this.Component=W}static{this.descriptor={get name(){return(0,s.t)("dashboard.default-layout.name","Custom")},get description(){return(0,s.t)("dashboard.default-layout.description","Position and size each panel individually")},id:"GridLayout",createFromLayout:j.createFromLayout,isGridLayout:!0,icon:"window-grid"}}serialize(){return(0,p.SW)(this)}_activationHandler(){l.$.featureToggles.dashboardNewLayouts&&this._subs.add(this.subscribeToEvent(o.V$,({payload:{evt:w,panel:N}})=>(0,g.wP)(this)?.startDraggingSync(w,N))),this._subs.add(this.state.grid.subscribeToState(({children:w},{children:N})=>{w.length===N.length&&this.publishEvent(new m.su(this.state.grid),!0)}))}addPanel(w){const N=r.b4.getNextPanelId(this);if(w.setState({key:(0,g.XA)(N)}),w.clearParent(),l.$.featureToggles.dashboardNewLayouts){const M=T(this.state.grid),L=new u.U({...M,body:w,key:(0,g.ty)(N)});m.cc.addElement({addedObject:w,source:this,perform:()=>{this.state.grid.setState({children:[...this.state.grid.state.children,L]})},undo:()=>{this.state.grid.setState({children:this.state.grid.state.children.filter(A=>A!==L)})}})}else{const M=new u.U({height:g.sw,width:g.vm,x:0,y:0,body:w,key:(0,g.ty)(N)});this.state.grid.setState({children:[M,...this.state.grid.state.children]})}}pastePanel(){const w=T(this.state.grid),N=(0,x.qY)((0,g.YQ)(this),w);l.$.featureToggles.dashboardNewLayouts?m.cc.edit({description:(0,s.t)("dashboard.edit-actions.paste-panel","Paste panel"),addedObject:N.state.body,source:this,perform:()=>{this.state.grid.setState({children:[...this.state.grid.state.children,N]})},undo:()=>{this.state.grid.setState({children:this.state.grid.state.children.filter(M=>M!==N)})}}):this.state.grid.setState({children:[...this.state.grid.state.children,N]}),(0,x.G2)()}removePanel(w){const N=w.parent;if(!(N instanceof u.U))throw new Error("Trying to remove panel that is not inside a DashboardGridItem");const M=this.state.grid;let L;try{L=o.jh.getAncestor(N,o.tI)}catch{L=void 0}if(L){L.setState({children:L.state.children.filter(A=>A!==N)}),M.forceRender();return}if(!l.$.featureToggles.dashboardNewLayouts){M.setState({children:M.state.children.filter(A=>A!==N)});return}m.cc.removeElement({removedObject:N.state.body,source:this,perform:()=>M.setState({children:M.state.children.filter(A=>A!==N)}),undo:()=>M.setState({children:[...M.state.children,N]})})}duplicatePanel(w){const N=w.parent;if(!(N instanceof u.U)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}let M,L,A;const U=r.b4.getNextPanelId(this),F=this.state.grid;N instanceof u.U?(M=o.Go.cloneSceneObjectState(N.state.body.state),L=o.jh.getData(N.state.body).clone()):(M=o.Go.cloneSceneObjectState(w.state),L=o.jh.getData(w).clone()),delete L.state.data?.alertState;const V=new o.Eb({...M,$data:L,key:(0,g.XA)(U)});if(A=new u.U({x:N.state.x,y:N.state.y,height:N.state.height,itemHeight:N.state.height,width:N.state.width,variableName:N.state.variableName,repeatDirection:N.state.repeatDirection,maxPerRow:N.state.maxPerRow,key:(0,g.ty)(U),body:V}),N.parent instanceof o.tI){const K=N.parent;K.setState({children:[...K.state.children,A]}),F.forceRender();return}F.setState({children:[...F.state.children,A]}),this.publishEvent(new m.jO(V),!0)}duplicate(){const w=this.state.grid.state.children,N=w.find(A=>A instanceof u.U),M=[];if(w.length){let A=N?r.b4.getNextPanelId(N.state.body):1;w.forEach(U=>{if(U instanceof u.U){const F=U.clone({key:void 0,body:U.state.body.clone({key:(0,g.XA)(A)})});M.push(F),A++}else M.push(U.clone({key:void 0}))})}return this.clone({key:void 0,grid:this.state.grid.clone({key:void 0,children:M})})}getVizPanels(){const w=[];return this.state.grid.forEachChild(N=>{if(!(N instanceof u.U)&&!(N instanceof o.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");N instanceof u.U&&N.state.body instanceof o.Eb?w.push(N.state.body):N instanceof o.tI&&N.forEachChild(M=>{M instanceof u.U&&M.state.body instanceof o.Eb&&w.push(M.state.body)})}),w}addNewRow(){const w=r.b4.getNextPanelId(this),N=new o.tI({key:(0,g.XA)(w),title:(0,s.t)("dashboard-scene.default-grid-layout-manager.row.title.row-title","Row title"),actions:new I.u({}),y:0}),M=this.state.grid,L=M.state.children.findIndex(U=>U instanceof o.tI),A=M.state.children.splice(0,L===-1?M.state.children.length:L).map(U=>U.clone());return A&&N.setState({children:A}),M.setState({children:[N,...M.state.children]}),this.publishEvent(new m.jO(N),!0),N}editModeChanged(w){const N=()=>{this.state.grid.setState({isDraggable:w,isResizable:w}),(0,g.X0)(this.state.grid,!0)};if(l.$.featureToggles.dashboardNewLayouts){setTimeout(N,10);return}N()}activateRepeaters(){this.isActive||this.activate(),this.state.grid.isActive||this.state.grid.activate(),this.state.grid.forEachChild(w=>{if(w instanceof u.U&&!w.isActive){w.activate();return}if(w instanceof o.tI&&w.state.$behaviors){for(const N of w.state.$behaviors)if(N instanceof b.L&&!w.isActive){w.activate();break}w.state.children.forEach(N=>{if(N instanceof u.U&&!N.isActive){N.activate();return}})}})}getOutlineChildren(){const w=[];for(const N of this.state.grid.state.children)N instanceof u.U&&(N.state.repeatedPanels?w.push(...N.state.repeatedPanels):w.push(N.state.body));return w}cloneLayout(w,N){return this.clone({grid:this.state.grid.clone({isResizable:N&&this.state.grid.state.isResizable,isDraggable:N&&this.state.grid.state.isDraggable,children:this.state.grid.state.children.reduce((M,L)=>{if(L instanceof u.U){const A=(0,h.ed)(w,(0,g.ty)(M.panelId)),U=L.clone({key:A,body:L.state.body.clone({key:(0,h.ed)(A,(0,g.XA)(M.panelId++))}),isDraggable:N&&L.state.isDraggable,isResizable:N&&L.state.isResizable});return M.children.push(U),M}if(L instanceof o.tI){const A=(0,h.ed)(w,(0,g.XA)(M.panelId++)),U=L.clone({key:A,children:L.state.children.reduce((F,V)=>{if((0,h.Ry)(V.state.key))return F;if(!(V instanceof u.U))return F.push(V.clone()),F;const K=(0,h.ed)(A,(0,g.ty)(M.panelId)),G=V.clone({key:K,isDraggable:N&&V.state.isDraggable,isResizable:N&&V.state.isResizable,body:V.state.body.clone({key:(0,h.ed)(K,(0,g.XA)(M.panelId++))})});return F.push(G),F},[]),isDraggable:N&&L.state.isDraggable,isResizable:N&&L.state.isResizable});return M.children.push(U),M}return M.children.push(L.clone()),M},{panelId:0,children:[]}).children})})}removeRow(w,N=!1){const M=this.state.grid,L=M.state.children.filter(A=>A.state.key!==w.state.key);if(!N){const A=w.state.children.map(F=>F.clone()),U=M.state.children.findIndex(F=>F.state.key===w.state.key);L.splice(U,0,...A)}this.publishEvent(new m.ck(w),!0),M.setState({children:L})}collapseAllRows(){this.state.grid.state.children.forEach(w=>{w instanceof o.tI&&(w.state.isCollapsed||this.state.grid.toggleRow(w))})}expandAllRows(){this.state.grid.state.children.forEach(w=>{w instanceof o.tI&&w.state.isCollapsed&&this.state.grid.toggleRow(w)})}static createFromLayout(w){const N=w.getVizPanels();return j.fromVizPanels(N)}static fromVizPanels(w=[]){const N=[],L=i.cV/3;let A=0,U=0;for(let F of w){const V=F.parent instanceof y.X?F.parent.state.variableName:void 0;F.clearParent(),N.push(new u.U({key:(0,g.ty)((0,g.Cs)(F)),x:U,y:A,width:L,height:10,itemHeight:10,body:F,variableName:V})),U+=L,U+L>i.cV&&(U=0,A+=10)}return new j({grid:new o.hy({children:N,isDraggable:!0,isResizable:!0})})}static fromGridItems(w,N,M){const L=w.reduce((A,U)=>(U.clearParent(),A.push(U),A),[]);return new j({grid:new o.hy({children:L,isDraggable:N,isResizable:M})})}}function W({model:S}){const{children:w}=(0,o.gn)(S.state.grid,{shouldActivateOrKeepAlive:!0}),N=(0,g.MZ)(S),{isEditing:M}=N.useState(),L=(0,h.Qp)(S),A=(0,d.of)(B),U=M&&l.$.featureToggles.dashboardNewLayouts&&!L;return S.parent===N&&w.length===0?(0,n.jsx)(c.A,{dashboard:N,canCreate:!!N.state.meta.canEdit},"dashboard-empty-state"):(0,n.jsxs)("div",{className:(0,a.cx)(A.container,M&&A.containerEditing),children:[S.state.grid.Component&&(0,n.jsx)(S.state.grid.Component,{model:S.state.grid}),U&&(0,n.jsx)("div",{className:A.actionsWrapper,children:(0,n.jsx)(v.f,{layoutManager:S})})]})}function B(S){return{container:(0,a.css)({width:"100%",display:"flex",flexGrow:1,flexDirection:"column"}),containerEditing:(0,a.css)({"> div:first-child":{flexGrow:"0 !important",minHeight:"250px"},...f.u}),actionsWrapper:(0,a.css)({position:"relative",paddingBottom:S.spacing(5)})}}},87308:(Z,R,e)=>{"use strict";e.d(R,{L:()=>i});var n=e(2543),a=e.n(n),s=e(36674),l=e(3371),o=e(8285),d=e(39765);class i extends s.Bs{constructor(g){super(g),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat();const g=this._getLayout(),y=this._getRow(),v=y.state.children.filter(f=>!(0,l.Ry)(f.state.key)),x=g.subscribeToState(()=>{const f=g.state.children.filter(u=>(0,l.oX)(u.state.key,y.state.key));for(const u of f){if(!(u instanceof s.tI))continue;const b=u.state.children.filter(D=>!(0,l.Ry)(D.state.key));if(b.length===v.length)continue;const E=b.find(D=>!(0,l.ag)(D.state.key));if(E){const D=E.clone();if(u.setState({children:u.state.children.filter(C=>C!==E)}),y.state.children.find(C=>C.state.key===D.state.key))return;y.setState({children:[...y.state.children,D]}),this.performRepeat(!0)}}});return()=>{x.unsubscribe()}}_getRow(){if(!(this.parent instanceof s.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const g=s.jh.getLayout(this);if(!(g instanceof s.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return g}performRepeat(g=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const y=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!y){console.error("RepeatedRowBehavior: Variable not found");return}if(!(y instanceof s.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const v=this._getRow(),x=this._getLayout(),{values:f,texts:u}=(0,o.a7)(y);if((0,n.isEqual)(this._prevRepeatValues,f)&&!g)return;this._prevRepeatValues=f,this._clonedRows=[];const b=v.state.children,E=c(b);let D=0;const C={values:[""],texts:y.hasAllValue()?["All"]:["None"]},P=f.length?f:C.values,T=u.length?u:C.texts;for(let O=0;O<P.length;O++){const j=O===0?v:v.clone({y:(v.state.y??0)+E*O+O,$behaviors:[],actions:void 0}),W=(0,l.lv)(v.state.key,O);j.setState({key:W,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:P[O],text:String(T[O]),isMulti:y.state.isMulti,includeAll:y.state.includeAll})]}),children:[]});const B=[];for(const S of b){const w=S.state.y??0,N=(0,l.ed)(W,(0,l.Dq)(S.state.key)),M=w+(E+1)*O,L=O>0?S.clone({isDraggable:!1,isResizable:!1}):S;L.setState({key:N,y:M}),O>0&&h(L,N),B.push(L),D<M+L.state.height&&(D=M+L.state.height)}j.setState({children:B}),this._clonedRows.push(j)}m(x,this._clonedRows,D,v.state.key),this.publishEvent(new d.d({source:this}),!0)}removeBehavior(){const g=this._getRow(),y=this._getLayout(),v=p(y,g.state.key);y.setState({children:v}),g.setState({$behaviors:g.state.$behaviors.filter(x=>x!==this),$variables:void 0})}}function c(r){let g=0,y=Number.MAX_VALUE;if(r.length===0)return 0;for(const v of r)v.state.y+v.state.height>g&&(g=v.state.y+v.state.height),v.state.y<y&&(y=v.state.y);return g-y}function m(r,g,y,v){const x=p(r,v),f=x.findIndex(b=>b instanceof s.tI&&(0,l.d9)(b.state.key)===(0,l.d9)(v));if(f===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const u=[...x.slice(0,f),...g,...x.slice(f+1)];if(x.length>f+1){const b=x.slice(f+1),E=b[0].state.y,D=y-E;for(const C of b)if(C.setState({y:C.state.y+D}),C instanceof s.tI)for(const P of C.state.children)P.setState({y:P.state.y+D})}r.setState({children:u})}function p(r,g){return r.state.children.filter(y=>!(y instanceof s.tI)||!(0,l.oX)((0,l.Dq)(y.state.key),g))}function h(r,g){r.forEachChild(y=>{const v=(0,l.ed)(g,y.state.key);y.setState({key:v}),h(y,v)})}},18178:(Z,R,e)=>{"use strict";e.d(R,{u:()=>N});var n=e(92745),a=e(36674),s=e(45229),l=e(87745),o=e(1131),d=e(87308),i=e(74848),c=e(22803),m=e(96540),p=e(63142),h=e(30703),r=e(9931),g=e(18615),y=e(8285),v=e(93389),x=e(8515),f=e(22787),u=e(49785),b=e(51898),E=e(37386),D=e(63527),C=e(34999),P=e(89640),T=e(45861),O=e(31819);const I=({repeat:M,title:L,sceneContext:A,isUsingDashboardDS:U,onUpdate:F,onCancel:V})=>{const[K,G]=(0,m.useState)(M),H=(0,m.useCallback)(z=>G(z),[G]),{handleSubmit:_,register:k}=(0,u.mN)({defaultValues:{title:L}}),J=z=>{F(z.title,K)};return(0,i.jsxs)("form",{onSubmit:_(J),children:[(0,i.jsx)(E.D,{label:(0,n.t)("dashboard.default-layout.row-options.form.title","Title"),children:(0,i.jsx)(D.p,{...k("title"),type:"text"})}),(0,i.jsx)(E.D,{label:(0,n.t)("dashboard.default-layout.row-options.form.repeat-for.label","Repeat for"),children:(0,i.jsx)(O.U,{sceneContext:A,repeat:K,onChange:H})}),U&&(0,i.jsx)(C.F,{"data-testid":b.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:(0,i.jsxs)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.warning.text",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:r.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,i.jsx)(P.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,i.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.learn-more",children:"Learn more"})})]})}),(0,i.jsxs)(f.a.ButtonRow,{children:[(0,i.jsx)(T.$n,{type:"button",variant:"secondary",onClick:V,fill:"outline",children:(0,i.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.cancel",children:"Cancel"})}),(0,i.jsx)(T.$n,{type:"submit",children:(0,i.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.update",children:"Update"})})]})]})},j=({repeat:M,title:L,parent:A,onDismiss:U,onUpdate:F,isUsingDashboardDS:V})=>{const K=(0,p.of)(W);return(0,i.jsx)(f.a,{isOpen:!0,title:(0,n.t)("dashboard.default-layout.row-options.modal.title","Row options"),onDismiss:U,className:K.modal,children:(0,i.jsx)(I,{sceneContext:A,repeat:M,title:L,onCancel:U,onUpdate:F,isUsingDashboardDS:V})})},W=()=>({modal:(0,c.css)({label:"RowOptionsModal",width:"500px"})}),B=({repeat:M,title:L,parent:A,onUpdate:U,isUsingDashboardDS:F})=>(0,i.jsx)(x.$s,{children:({showModal:V,hideModal:K})=>(0,i.jsx)("button",{type:"button",className:"pointer","aria-label":(0,n.t)("dashboard.default-layout.row-options.button.label","Row options"),onClick:()=>{V(j,{title:L,repeat:M,parent:A,onDismiss:K,onUpdate:(G,H)=>{U(G,H),K()},isUsingDashboardDS:F})},children:(0,i.jsx)(h.I,{name:"cog"})})});B.displayName="RowOptionsButton";function S({model:M}){const L=M.getParent(),{title:A,children:U}=L.useState(),F=(0,y.MZ)(M),{meta:V,isEditing:K}=(0,y.TN)(M),G=(0,p.of)(w),H=(0,m.useMemo)(()=>U.some(k=>{if(!(k instanceof v.U))return!1;if(k.state.body instanceof a.Eb){const J=(0,y.un)(k.state.body);return J?.state.datasource?.uid===r.K||J?.state.datasource?.uid===g.uv&&J?.state.queries.some(z=>z.datasource?.uid===r.K)}return!1}),[U]),_=L.state.$behaviors?.find(k=>k instanceof d.L);return(0,i.jsx)(i.Fragment,{children:V.canEdit&&K&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:G.rowActions,children:[(0,i.jsx)(B,{title:A,repeat:_ instanceof d.L?_.state.variableName:void 0,parent:F,onUpdate:(k,J)=>M.onUpdate(k,J),isUsingDashboardDS:H}),(0,i.jsx)("button",{type:"button",onClick:()=>M.onDelete(),"aria-label":(0,n.t)("dashboard.default-layout.row-actions.delete","Delete row"),children:(0,i.jsx)(h.I,{name:"trash-alt"})})]})})})}const w=M=>({rowActions:(0,c.css)({color:M.colors.text.secondary,lineHeight:"27px",button:{color:M.colors.text.secondary,paddingLeft:M.spacing(2),background:"transparent",border:"none","&:hover":{color:M.colors.text.maxContrast}}})});class N extends a.Bs{static{this.Component=S}getParent(){if(!(this.parent instanceof a.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}removeRow(L){a.jh.getAncestor(this,o.D).removeRow(this.getParent(),L)}onUpdate(L,A){const U=this.getParent();let F;if(U.state.$behaviors)for(let V of U.state.$behaviors)V instanceof d.L&&(F=V);L!==U.state.title&&U.setState({title:L}),A?(F&&F.removeBehavior(),F=new d.L({variableName:A}),U.setState({$behaviors:[...U.state.$behaviors??[],F]})):F?.removeBehavior()}onDelete(){s.A.publish(new l.bY({title:(0,n.t)("dashboard.default-layout.row-actions.modal.title","Delete row"),text:(0,n.t)("dashboard.default-layout.row-actions.modal.text","Are you sure you want to remove this row and all its panels?"),altActionText:(0,n.t)("dashboard.default-layout.row-actions.modal.alt-action","Delete row only"),icon:"trash-alt",onConfirm:()=>this.removeRow(!0),onAltAction:()=>this.removeRow()}))}}},97335:(Z,R,e)=>{"use strict";e.d(R,{o:()=>de});var n=e(96540),a=e(92745),s=e(36674),l=e(45229),o=e(95943),d=e(29043),i=e(77197),c=e(87745),m=e(57558),p=e(76584),h=e(67350),r=e(8285),g=e(8835),y=e(48492),v=e(41667),x=e(74848),f=e(51898),u=e(37386),b=e(63527),E=e(21285),D=e(34999),C=e(89640),P=e(25797),T=e(51156),O=e(31819),I=e(9931),j=e(18615),W=e(46415),B=e(44802),S=e(20246);function w(ie,he){const{layout:me}=ie.useState(),ce=(0,n.useMemo)(()=>new P.C({title:"",id:"row-options"}).addItem(new T.v({title:"",skipField:!0,render:()=>(0,x.jsx)(N,{row:ie,isNewElement:he})})).addItem(new T.v({title:(0,a.t)("dashboard.rows-layout.row-options.row.fill-screen","Fill screen"),render:()=>(0,x.jsx)(L,{row:ie})})).addItem(new T.v({title:(0,a.t)("dashboard.rows-layout.row-options.row.hide-header","Hide row header"),render:()=>(0,x.jsx)(M,{row:ie})})),[ie,he]),Pe=(0,n.useMemo)(()=>new P.C({title:(0,a.t)("dashboard.rows-layout.row-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new T.v({title:(0,a.t)("dashboard.rows-layout.row-options.repeat.variable.title","Repeat by variable"),description:(0,a.t)("dashboard.rows-layout.row-options.repeat.variable.description","Repeat this row for each value in the selected variable."),render:()=>(0,x.jsx)(A,{row:ie})})),[ie]),Ie=(0,B.W)(me),Se=[ce,...Ie,Pe],Me=(0,n.useMemo)(()=>(0,W.h)(ie.state.conditionalRendering),[ie]);return Me&&Se.push(Me),Se}function N({row:ie,isNewElement:he}){const{title:me}=ie.useState(),ce=(0,S.z4)({autoFocus:he}),Pe=ie.hasUniqueTitle();return(0,x.jsx)(u.D,{label:(0,a.t)("dashboard.rows-layout.row-options.row.title","Title"),invalid:!Pe,error:Pe?void 0:(0,a.t)("dashboard.rows-layout.row-options.title-not-unique","Title should be unique"),children:(0,x.jsx)(b.p,{ref:ce,title:(0,a.t)("dashboard.rows-layout.row-options.title-option","Title"),value:me,onChange:Ie=>ie.onChangeTitle(Ie.currentTarget.value)})})}function M({row:ie}){const{hideHeader:he=!1}=ie.useState();return(0,x.jsx)(E.d,{value:he,onChange:()=>ie.onHeaderHiddenToggle()})}function L({row:ie}){const{fillScreen:he}=ie.useState();return(0,x.jsx)(E.d,{value:he,onChange:()=>ie.onChangeFillScreen(!he)})}function A({row:ie}){const{layout:he}=ie.useState(),me=(0,r.MZ)(ie),ce=he.getVizPanels().some(Pe=>{const Ie=(0,r.un)(Pe);return Ie?.state.datasource?.uid===I.K||Ie?.state.datasource?.uid===j.uv&&Ie?.state.queries.some(Se=>Se.datasource?.uid===I.K)});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(O.U,{sceneContext:me,repeat:ie.state.repeatByVariable,onChange:Pe=>ie.onChangeRepeat(Pe)}),ce?(0,x.jsxs)(D.F,{"data-testid":f.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,x.jsx)("p",{children:(0,x.jsxs)(a.x6,{i18nKey:"dashboard.rows-layout.row.repeat.warning",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:I.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,x.jsx)(C.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,x.jsx)(a.x6,{i18nKey:"dashboard.rows-layout.row.repeat.learn-more",children:"Learn more"})})]}):void 0]})}var U=e(22803),F=e(89332),V=e(56887),K=e(63142),G=e(45861),H=e(36324),_=e(30703),k=e(45967),J=e(41116),z=e(3371),Y=e(72746);function X({model:ie}){const{layout:he,collapse:me,fillScreen:ce,hideHeader:Pe,isDropTarget:Ie,key:Se}=ie.useState(),Me=(0,z.Lv)(ie),{isEditing:Te}=(0,r.TN)(ie),[Ge,Qe,tt]=(0,J.H)(ie),{isSelected:ke,onSelect:He,isSelectable:Re}=(0,V.y)(Se),Ne=(0,r.hg)(ie),{rows:Ae}=ie.getParentLayout().useState(),Ue=(0,K.of)(Q),Be=(0,K.of)(G.my),We=ie.parent?.parent instanceof Y.H$,_e=(0,H.C)(),Xe=Ae.findIndex(ze=>ze===ie),le=!me&&ce,ye=Ge&&!Te,[pe,ve]=(0,n.useState)(!1),be=(0,n.useCallback)(()=>ve(!0),[]),Oe=(0,n.useCallback)(()=>ve(!1),[]),we=!Me&&Te;return ye?null:(0,x.jsx)(F.sx,{draggableId:Se,index:Xe,isDragDisabled:!we,children:(ze,Ve)=>(0,x.jsxs)("div",{ref:ge=>{ze.innerRef(ge),ie.containerRef.current=ge},"data-dashboard-drop-target-key":ie.state.key,className:(0,U.cx)(Ue.wrapper,!me&&Ue.wrapperNotCollapsed,Ve.isDragging&&Ue.dragging,me&&Ue.wrapperCollapsed,le&&Ue.wrapperGrow,Qe,!Me&&ke&&"dashboard-selected-element",!Me&&!ke&&pe&&"dashboard-selectable-element",Ie&&"dashboard-drop-target"),onPointerDown:ge=>{ge.stopPropagation(),_e.set(ge)},onPointerUp:ge=>{if(ke&&ge.target instanceof Element&&ge.target.closest("button")){ge.stopPropagation();return}_e.check(ge)||setTimeout(()=>He?.(ge))},...ze.draggableProps,children:[(!Pe||Te)&&(0,x.jsxs)("div",{className:(0,U.cx)(Ue.rowHeader,"dashboard-row-header"),onMouseEnter:Re?be:void 0,onMouseLeave:Re?Oe:void 0,...ze.dragHandleProps,children:[(0,x.jsxs)("button",{onClick:()=>ie.onCollapseToggle(),className:(0,U.cx)(Be,Ue.rowTitleButton),"aria-label":me?(0,a.t)("dashboard.rows-layout.row.expand","Expand row"):(0,a.t)("dashboard.rows-layout.row.collapse","Collapse row"),"data-testid":f.Tp.components.DashboardRow.title(Ne),children:[(0,x.jsx)(_.I,{name:me?"angle-right":"angle-down"}),(0,x.jsxs)("span",{className:(0,U.cx)(Ue.rowTitle,Pe&&Ue.rowTitleHidden,!We&&Ue.rowTitleNested,me&&Ue.rowTitleCollapsed),children:[!ie.hasUniqueTitle()&&(0,x.jsx)(k.m,{content:(0,a.t)("dashboard.rows-layout.row-warning.title-not-unique","This title is not unique"),children:(0,x.jsx)(_.I,{name:"exclamation-triangle"})}),Ne,Pe&&(0,x.jsx)(k.m,{content:(0,a.t)("dashboard.rows-layout.header-hidden-tooltip","Row header only visible in edit mode"),children:(0,x.jsx)(_.I,{name:"eye-slash"})})]})]}),we&&(0,x.jsx)(_.I,{name:"draggabledots",className:"dashboard-row-header-drag-handle"})]}),!me&&(0,x.jsx)(he.Component,{model:he}),tt]})},Se)}function Q(ie){return{rowHeader:(0,U.css)({display:"flex",gap:ie.spacing(1),padding:ie.spacing(.5,.5,.5,0),alignItems:"center",justifyContent:"space-between",marginBottom:ie.spacing(1),"& .dashboard-row-header-drag-handle":(0,U.css)({opacity:0,[ie.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.25s"}}),"&:hover":(0,U.css)({"& .dashboard-row-header-drag-handle":(0,U.css)({opacity:1})})}),rowTitleButton:(0,U.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",minWidth:0,gap:ie.spacing(1)}),rowTitle:(0,U.css)({display:"flex",alignItems:"center",gap:ie.spacing(2),...ie.typography.h5,fontWeight:ie.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flexGrow:1,minWidth:0}),rowTitleHidden:(0,U.css)({textDecoration:"line-through",opacity:.6,"&:hover":(0,U.css)({opacity:1})}),rowTitleNested:(0,U.css)({fontSize:ie.typography.body.fontSize,fontWeight:ie.typography.fontWeightRegular}),rowTitleCollapsed:(0,U.css)({color:ie.colors.text.secondary}),wrapper:(0,U.css)({display:"flex",flexDirection:"column",minHeight:ie.spacing(2.75+1+1+.125)}),wrapperNotCollapsed:(0,U.css)({"> div:nth-child(2)":{marginLeft:ie.spacing(3),position:"relative",width:"auto","&:before":{content:'""',position:"absolute",top:"-8px",bottom:0,left:"-16px",width:"1px",backgroundColor:ie.colors.border.weak}}}),dragging:(0,U.css)({cursor:"move"}),wrapperGrow:(0,U.css)({flexGrow:1}),wrapperCollapsed:(0,U.css)({flexGrow:0,borderBottom:`1px solid ${ie.colors.border.weak}`,minHeight:"unset",".dashboard-row-header":{marginBottom:ie.spacing(0)}}),rowActions:(0,U.css)({display:"flex",opacity:0}),checkboxWrapper:(0,U.css)({display:"flex",alignItems:"center",paddingLeft:ie.spacing(1)})}}var q=e(32635);function te(ie){return[new P.C({title:"",id:"rows-options"}).addItem(new T.v({title:(0,a.t)("dashboard.edit-pane.row.header.title","Row header"),render:()=>(0,x.jsx)(ne,{model:ie})}))]}function ne({model:ie}){const he=ie.getRows();let me=!1,ce=!1;for(let Pe=0;Pe<he.length;Pe++){const{hideHeader:Ie}=he[Pe].useState(),Se=he[Pe-1];ce=ce||Se&&!!Se.state.hideHeader!=!!Ie,me=me||!!Ie}return(0,x.jsx)(q.S,{label:(0,a.t)("dashboard.edit-pane.row.header.hide","Hide"),value:me,indeterminate:ce,onChange:()=>ie.onHeaderHiddenToggle(me,ce)})}class se{constructor(he){this._rows=he,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.rows","Rows"),icon:"folder",instanceName:""}}useEditPaneOptions(){return te(this)}getRows(){return this._rows}onDelete(){this._rows.forEach(he=>he.onDelete())}onHeaderHiddenToggle(he,me){this._rows.forEach(ce=>ce.onHeaderHiddenToggle(me?!0:!he))}}var ue=e(97883);class de extends s.Bs{constructor(he){super({...he,title:he?.title??(0,a.t)("dashboard.rows-layout.row.new","New row"),layout:he?.layout??g.X2.createEmpty(),conditionalRendering:he?.conditionalRendering??m.p.createEmpty()}),this._variableDependency=new s.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.isDashboardDropTarget=!0,this.containerRef=n.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=X}_activationHandler(){const he=this.state.conditionalRendering?.activate();return()=>{he&&he()}}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.row","Row"),instanceName:s.jh.interpolate(this,this.state.title,void 0,"text"),icon:"list-ul"}}getOutlineChildren(){return this.state.layout.getOutlineChildren()}getLayout(){return this.state.layout}getSlug(){return i.A.slugifyForUrl(s.jh.interpolate(this,this.state.title??"Row"))}switchLayout(he){this.setState({layout:he})}useEditPaneOptions(he){return w(this,he)}onDelete(){this.getParentLayout().removeRow(this)}onConfirmDelete(){if(this.getLayout().getVizPanels().length===0){this.onDelete();return}if(this.getParentLayout().shouldUngroup()){this.onDelete();return}l.A.publish(new c.bY({title:(0,a.t)("dashboard.rows-layout.delete-row-title","Delete row?"),text:(0,a.t)("dashboard.rows-layout.delete-row-text","Deleting this row will also remove all panels. Are you sure you want to continue?"),yesText:(0,a.t)("dashboard.rows-layout.delete-row-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}createMultiSelectedElement(he){return new se(he.filter(me=>me instanceof de))}onDuplicate(){this.getParentLayout().duplicateRow(this)}duplicate(){return this.clone({key:void 0,layout:this.getLayout().duplicate()})}serialize(){return(0,p.HQ)(this)}onCopy(){const he=(0,h.IC)(this.getLayout(),(0,r.YQ)(this));(0,y.G2)(),d.A.set(o.rt,JSON.stringify({elements:he,row:this.serialize()}))}setIsDropTarget(he){!!this.state.isDropTarget!==he&&this.setState({isDropTarget:he})}draggedPanelOutside(he){this.getLayout().removePanel?.(he),this.setIsDropTarget(!1)}draggedPanelInside(he){he.clearParent(),this.getLayout().addPanel(he),this.setIsDropTarget(!1)}onChangeTitle(he){this.setState({title:he})}onChangeName(he){this.onChangeTitle(he)}onHeaderHiddenToggle(he=!this.state.hideHeader){this.setState({hideHeader:he})}onChangeFillScreen(he){this.setState({fillScreen:he})}onChangeRepeat(he){he?this.setState({repeatByVariable:he}):this.setState({repeatedRows:void 0,$variables:void 0,repeatByVariable:void 0})}onCollapseToggle(){this.setState({collapse:!this.state.collapse})}getParentLayout(){return s.jh.getAncestor(this,ue.V)}scrollIntoView(){(0,v.d)(this,this.containerRef)}getCollapsedState(){return this.state.collapse??!1}setCollapsedState(he){this.setState({collapse:he})}hasUniqueTitle(){return!this.getParentLayout().duplicateTitles().has(this.state.title)}}},97883:(Z,R,e)=>{"use strict";e.d(R,{V:()=>N});var n=e(92745),a=e(36674),s=e(33143),l=e(76584),o=e(3371),d=e(8285),i=e(93389),c=e(1131),m=e(87308),p=e(34031),h=e(37365),r=e(48492),g=e(20246),y=e(97335),v=e(74848),x=e(22803),f=e(89332),u=e(51898),b=e(63142),E=e(45861),D=e(61659),C=e(2543),P=e(96540),T=e(68079),O=e(39765);function I({row:M,variable:L}){const{repeatedRows:A}=M.useState();return(0,P.useEffect)(()=>{j(L,M,!1);const U=L.subscribeToState(V=>j(L,M,!1)),F=M.subscribeToEvent(s.WG,V=>j(L,M,!0));return()=>{F.unsubscribe(),U.unsubscribe()}},[L,M]),A===void 0||a.jh.hasVariableDependencyInLoadingState(L)||L.state.loading?(d.xp.logger("RowItemRepeater",!1,"Variable is loading, showing spinner"),(0,v.jsx)(T.y,{})):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(M.Component,{model:M},M.state.key),A?.map(U=>(0,v.jsx)(U.Component,{model:U},U.state.key))]})}function j(M,L,A){if(a.jh.hasVariableDependencyInLoadingState(M)){d.xp.logger("RowItemRepeater",!1,"Skipped dependency in loading state");return}if(M.state.loading){d.xp.logger("RowItemRepeater",!1,"Skipped, variable is loading");return}const{values:U,texts:F}=(0,d.a7)(M),V=W(L,M.state.name);if(!A&&(0,C.isEqual)(V,U)){d.xp.logger("RowItemRepeater",!1,"Skipped, values the same");return}A?d.xp.logger("RowItemRepeater",!1,"Performing repeats, contentChanged"):d.xp.logger("RowItemRepeater",!1,"Performing repeats, variable values changed",U);const K=U.length?U:[""],G=F.length?F:M.hasAllValue()?["All"]:["None"],H=[];for(let _=0;_<K.length;_++){const k=_===0,J=(0,o.lv)(L.state.key,_),z=k?L:L.clone({repeatByVariable:void 0,repeatedRows:void 0,layout:void 0}),Y=k?L.getLayout():L.getLayout().cloneLayout(J,!1);z.setState({key:J,$variables:new a.Pj({variables:[new a.xc({name:M.state.name,value:K[_],text:String(G[_]),isMulti:M.state.isMulti,includeAll:M.state.includeAll})]}),layout:Y}),k||H.push(z)}L.setState({repeatedRows:H}),L.publishEvent(new O.d({source:L}),!0)}function W(M,L){const A=[];if(!M.state.repeatedRows)return[];function U(F){const V=a.jh.lookupVariable(L,F);if(V){const K=V.getValue();K!=null&&!Array.isArray(K)&&A.push(K)}}U(M);for(const F of M.state.repeatedRows)U(F);return A}function B({model:M}){const{rows:L,key:A}=M.useState(),{isEditing:U}=(0,d.TN)(M),F=(0,b.of)(w),{hasCopiedRow:V}=(0,D.x)();return(0,v.jsx)(f.JY,{onBeforeDragStart:K=>M.forceSelectRow(K.draggableId),onDragEnd:K=>{K.destination&&K.destination.index!==K.source.index&&M.moveRow(K.draggableId,K.source.index,K.destination.index)},children:(0,v.jsx)(f.gL,{droppableId:A,direction:"vertical",children:K=>(0,v.jsxs)("div",{className:F.wrapper,ref:K.innerRef,...K.droppableProps,children:[L.map(G=>(0,v.jsx)(S,{row:G,manager:M},G.state.key)),K.placeholder,U&&(0,v.jsxs)("div",{className:"dashboard-canvas-add-button",children:[(0,v.jsx)(E.$n,{icon:"plus",variant:"primary",fill:"text",onClick:()=>M.addNewRow(),"data-testid":u.Tp.components.CanvasGridAddActions.addRow,children:(0,v.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.new-row",children:"New row"})}),V&&(0,v.jsx)(E.$n,{icon:"clipboard-alt",variant:"primary",fill:"text",onClick:()=>M.pasteRow(),"data-testid":u.Tp.components.CanvasGridAddActions.pasteRow,children:(0,v.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.paste-row",children:"Paste row"})})]})]})})})}function S({row:M,manager:L}){const{repeatByVariable:A}=(0,a.gn)(M,{shouldActivateOrKeepAlive:!0});if(A){const U=a.jh.lookupVariable(A,L);if(U instanceof a.n8)return(0,v.jsx)(I,{row:M,manager:L,variable:U},M.state.key)}return(0,v.jsx)(M.Component,{model:M},M.state.key)}function w(M){return{wrapper:(0,x.css)({display:"flex",flexDirection:"column",gap:M.spacing(1),flexGrow:1,width:"100%"})}}class N extends a.Bs{constructor(){super(...arguments),this.isDashboardLayoutManager=!0,this.descriptor=N.descriptor}static{this.Component=B}static{this.descriptor={get name(){return(0,n.t)("dashboard.rows-layout.name","Rows")},get description(){return(0,n.t)("dashboard.rows-layout.description","Collapsable panel groups with headings")},id:"RowsLayout",createFromLayout:N.createFromLayout,isGridLayout:!1,icon:"list-ul"}}serialize(){return(0,l.aL)(this)}addPanel(L){}getVizPanels(){const L=[];for(const A of this.state.rows){const U=A.getLayout().getVizPanels();L.push(...U)}return L}cloneLayout(L,A){return this.clone({rows:this.state.rows.map(U=>{const F=(0,o.ed)(L,U.state.key);return U.clone({key:F,layout:U.state.layout.cloneLayout(F,A)})})})}duplicate(){const L=this.state.rows.map(A=>A.duplicate());return this.clone({rows:L,key:void 0})}duplicateRow(L){const A=L.duplicate();this.addNewRow(A)}addNewRow(L){const A=L??new y.o({}),U=new Set(this.state.rows.map(V=>V.state.title).filter(V=>V!==void 0)),F=(0,g.BK)(A.state.title,U);return F!==A.state.title&&A.setState({title:F}),s.cc.addElement({addedObject:A,source:this,perform:()=>this.setState({rows:[...this.state.rows,A]}),undo:()=>this.setState({rows:this.state.rows.filter(V=>V!==A)})}),A}editModeChanged(L){this.state.rows.forEach(A=>A.getLayout().editModeChanged?.(L))}pasteRow(){const L=(0,d.YQ)(this),A=(0,r.$v)(L);this.addNewRow(A)}shouldUngroup(){return this.state.rows.length===1}getOutlineChildren(){const L=[];for(const A of this.state.rows)if(L.push(A),A.state.repeatedRows)for(const U of A.state.repeatedRows)L.push(U);return L}removeRow(L){if(this.shouldUngroup()){(0,g.f)(this,L.state.layout);return}const A=this.state.rows.findIndex(U=>U===L);s.cc.removeElement({removedObject:L,source:this,perform:()=>this.setState({rows:this.state.rows.filter(U=>U!==L)}),undo:()=>{const U=[...this.state.rows];U.splice(A,0,L),this.setState({rows:U})}})}moveRow(L,A,U){const F=[...this.state.rows],[V]=F.splice(A,1);F.splice(U,0,V),this.setState({rows:F}),this.publishEvent(new s.su(this),!0)}forceSelectRow(L){const A=this.state.rows.findIndex(V=>V.state.key===L),U=this.state.rows[A];if(!U)return;(0,d.YQ)(this).state.editPane.selectObject(U,L,{force:!0,multi:!1})}static createEmpty(){return new N({rows:[new y.o]})}static createFromLayout(L){let A=[];if(L instanceof h.K)for(const U of L.state.tabs){if((0,o.Ry)(U.state.key))continue;const F=U.state.conditionalRendering;F?.clearParent();const V=U.state.$behaviors?.find(K=>K instanceof p.T);A.push(new y.o({layout:U.state.layout.clone(),title:U.state.title,conditionalRendering:F,repeatByVariable:V?.state.variableName}))}else if(L instanceof c.D){const U=[];let F;L.state.grid.forEachChild(V=>{if(!(V instanceof i.U)&&!(V instanceof a.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");if(V instanceof a.tI){if(!(0,o.Ry)(V.state.key)){const K=V.state.$behaviors?.find(G=>G instanceof m.L);U.push({title:V.state.title,isCollapsed:!!V.state.isCollapsed,isDraggable:V.state.isDraggable,isResizable:V.state.isResizable,children:V.state.children,repeat:K?.state.variableName}),F=void 0}}else F||(F=[],U.push({children:F})),F.push(V)}),A=U.map(V=>new y.o({title:V.title,collapse:!!V.isCollapsed,repeatByVariable:V.repeat,layout:c.D.fromGridItems(V.children,V.isDraggable??L.state.grid.state.isDraggable,V.isResizable??L.state.grid.state.isResizable)}))}else A=[new y.o({layout:L.clone()})];return A.length===0&&(A=[new y.o]),new N({rows:A})}duplicateTitles(){const L=new Map,A=new Set;return this.state.rows.forEach(U=>{const F=a.jh.interpolate(U,U.state.title),V=(L.get(F)??0)+1;L.set(F,V),V>1&&F&&A.add(F)}),A}}},92769:(Z,R,e)=>{"use strict";e.d(R,{V:()=>ue});var n=e(96540),a=e(92745),s=e(36674),l=e(95943),o=e(73427),d=e(29043),i=e(77197),c=e(87745),m=e(57558),p=e(6461),h=e(67350),r=e(8285),g=e(8835),y=e(48492),v=e(41667),x=e(74848),f=e(51898),u=e(37386),b=e(63527),E=e(34999),D=e(89640),C=e(25797),P=e(51156),T=e(31819),O=e(9931),I=e(18615),j=e(46415),W=e(44802),B=e(20246);function S(de,ie){const{layout:he}=de.useState(),me=(0,n.useMemo)(()=>new C.C({title:"",id:"tab-item-options"}).addItem(new P.v({title:(0,a.t)("dashboard.tabs-layout.tab-options.title-option","Title"),render:()=>(0,x.jsx)(w,{tab:de,isNewElement:ie})})),[de,ie]),ce=(0,n.useMemo)(()=>new C.C({title:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new P.v({title:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.variable.title","Repeat by variable"),description:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.variable.description","Repeat this tab for each value in the selected variable."),render:()=>(0,x.jsx)(N,{tab:de})})),[de]),Pe=(0,W.W)(he),Ie=[me,...Pe,ce],Se=(0,n.useMemo)(()=>(0,j.h)(de.state.conditionalRendering),[de]);return Se&&Ie.push(Se),Ie}function w({tab:de,isNewElement:ie}){const{title:he}=de.useState(),me=(0,B.z4)({autoFocus:ie}),ce=de.hasUniqueTitle();return(0,x.jsx)(u.D,{invalid:!ce,error:ce?void 0:(0,a.t)("dashboard.tabs-layout.tab-options.title-not-unique","Title should be unique"),children:(0,x.jsx)(b.p,{ref:me,title:(0,a.t)("dashboard.tabs-layout.tab-options.title-option","Title"),value:he,onChange:Pe=>de.onChangeTitle(Pe.currentTarget.value)})})}function N({tab:de}){const{layout:ie}=de.useState(),he=(0,r.MZ)(de),me=ie.getVizPanels().some(ce=>{const Pe=(0,r.un)(ce);return Pe?.state.datasource?.uid===O.K||Pe?.state.datasource?.uid===I.uv&&Pe?.state.queries.some(Ie=>Ie.datasource?.uid===O.K)});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(T.U,{sceneContext:he,repeat:de.getRepeatVariable(),onChange:ce=>de.onChangeRepeat(ce)}),me?(0,x.jsxs)(E.F,{"data-testid":f.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,x.jsx)("p",{children:(0,x.jsxs)(a.x6,{i18nKey:"dashboard.tabs-layout.tab.repeat.warning",children:["Panels in this tab use the ",{SHARED_DASHBOARD_QUERY:O.K}," data source. These panels will reference the panel in the original tab, not the ones in the repeated tabs."]})}),(0,x.jsx)(D.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-tabs",children:(0,x.jsx)(a.x6,{i18nKey:"dashboard.tabs-layout.tab.repeat.learn-more",children:"Learn more"})})]}):void 0]})}var M=e(22803),L=e(89332),A=e(96014),U=e(63704),F=e(92138),V=e(56887),K=e(63142),G=e(36324),H=e(60208),_=e(31286),k=e(45967),J=e(30703),z=e(41116),Y=e(3371);function X({model:de}){const{title:ie,key:he,isDropTarget:me}=de.useState(),ce=de.getParentLayout(),{tabs:Pe,currentTabIndex:Ie}=ce.useState(),Se=s.jh.interpolate(de,ie,void 0,"text"),{isSelected:Me,onSelect:Te,isSelectable:Ge}=(0,V.y)(he),{isEditing:Qe}=(0,r.TN)(de),tt=de.getSlug(),ke=ce.getUrlKey(),He=Pe.findIndex(ye=>ye===de),Re=He===Ie,Ne=(0,A.zy)(),Ae=U.sQ.sanitize(F.I.getUrlForPartial(Ne,{[ke]:tt})),Ue=(0,K.of)(q),Be=(0,G.C)(),[We]=(0,z.H)(de),Xe=!(0,Y.Lv)(de)&&Qe;if(We&&!Qe&&!Re)return null;let le={};return de.hasUniqueTitle()||(le={icon:"exclamation-triangle",tooltip:(0,a.t)("dashboard.tabs-layout.tab-warning.title-not-unique","This title is not unique")}),(0,x.jsx)(L.sx,{draggableId:he,index:He,isDragDisabled:!Xe,children:(ye,pe)=>(0,x.jsx)("div",{ref:ve=>ye.innerRef(ve),className:(0,M.cx)(pe.isDragging&&Ue.dragging),...ye.draggableProps,...ye.dragHandleProps,children:(0,x.jsx)(H.o,{ref:de.containerRef,truncate:!0,className:(0,M.cx)(We&&Ue.hidden,Me&&"dashboard-selected-element",Ge&&!Me&&"dashboard-selectable-element",me&&"dashboard-drop-target"),active:Re,title:Se,suffix:We?Q:void 0,href:Ae,"aria-selected":Re,onPointerDown:ve=>{ve.stopPropagation(),Be.set(ve)},onPointerUp:ve=>{ve.stopPropagation(),!(!Ge||Be.check(ve))&&Te?.(ve)},label:Se,"data-dashboard-drop-target-key":de.state.key,...le})})},he)}function Q(){return(0,x.jsx)(_.a,{paddingLeft:1,display:"inline",children:(0,x.jsx)(k.m,{content:(0,a.t)("dashboard.conditional-rendering.overlay.tooltip","Element is hidden due to conditional rendering."),children:(0,x.jsx)(J.I,{name:"eye-slash"})})})}const q=()=>({dragging:(0,M.css)({cursor:"move"}),hidden:(0,M.css)({opacity:.4,"&:hover":(0,M.css)({opacity:1})})});var te=e(34031);class ne{constructor(ie){this._tabs=ie,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.tabs","Tabs"),icon:"folder",instanceName:""}}useEditPaneOptions(){return[]}getTabs(){return this._tabs}onDelete(){this._tabs.forEach(ie=>ie.onDelete())}}var se=e(37365);class ue extends s.Bs{constructor(ie){super({...ie,title:ie?.title??(0,a.t)("dashboard.tabs-layout.tab.new","New tab"),layout:ie?.layout??g.X2.createEmpty(),conditionalRendering:ie?.conditionalRendering??m.p.createEmpty()}),this._variableDependency=new s.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.isDashboardDropTarget=!0,this.containerRef=n.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=X}_activationHandler(){const ie=this.state.conditionalRendering?.activate();return()=>{ie&&ie()}}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.tab","Tab"),instanceName:s.jh.interpolate(this,this.state.title,void 0,"text"),icon:"layers"}}getOutlineChildren(){return this.state.layout.getOutlineChildren()}getLayout(){return this.state.layout}getSlug(){return i.A.slugifyForUrl(s.jh.interpolate(this,this.state.title??"Tab"))}switchLayout(ie){this.setState({layout:ie})}useEditPaneOptions(ie){return S(this,ie)}onDelete(){this.getParentLayout().removeTab(this)}onConfirmDelete(){const ie=this.getParentLayout();if(ie.shouldUngroup()){ie.removeTab(this);return}if(this.getLayout().getVizPanels().length===0){this.onDelete();return}o.lE.publish(new c.bY({title:(0,a.t)("dashboard.tabs-layout.delete-tab-title","Delete tab?"),text:(0,a.t)("dashboard.tabs-layout.delete-tab-text","Deleting this tab will also remove all panels. Are you sure you want to continue?"),yesText:(0,a.t)("dashboard.tabs-layout.delete-tab-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}serialize(){return(0,p.Yz)(this)}onCopy(){const ie=(0,h.IC)(this.getLayout(),(0,r.YQ)(this));(0,y.G2)(),d.A.set(l.Gk,JSON.stringify({elements:ie,tab:this.serialize()}))}createMultiSelectedElement(ie){return new ne(ie.filter(he=>he instanceof ue))}onDuplicate(){this.getParentLayout().duplicateTab(this)}duplicate(){return this.clone({key:void 0,layout:this.getLayout().duplicate()})}onAddPanel(ie=(0,r.O8)()){this.getLayout().addPanel(ie)}onAddTab(){this.getParentLayout().addNewTab()}onChangeTitle(ie){this.setState({title:ie})}onChangeName(ie){this.onChangeTitle(ie)}onChangeRepeat(ie){let he=this._getRepeatBehavior();ie?(he&&he.removeBehavior(),he=new te.T({variableName:ie}),this.setState({$behaviors:[...this.state.$behaviors??[],he]}),he.activate()):he?.removeBehavior()}setIsDropTarget(ie){!!this.state.isDropTarget!==ie&&this.setState({isDropTarget:ie})}draggedPanelOutside(ie){this.getLayout().removePanel?.(ie),this.setIsDropTarget(!1)}draggedPanelInside(ie){ie.clearParent(),this.getLayout().addPanel(ie),this.setIsDropTarget(!1);const he=this.getParentLayout(),me=he.state.tabs.findIndex(ce=>ce===this);me!==he.state.currentTabIndex&&he.setState({currentTabIndex:me})}getRepeatVariable(){return this._getRepeatBehavior()?.state.variableName}getParentLayout(){return s.jh.getAncestor(this,se.K)}scrollIntoView(){const ie=this.getParentLayout();ie.getCurrentTab()!==this&&ie.switchToTab(this),(0,v.d)(this,this.containerRef)}hasUniqueTitle(){return!this.getParentLayout().duplicateTitles().has(this.state.title)}_getRepeatBehavior(){return this.state.$behaviors?.find(ie=>ie instanceof te.T)}}},34031:(Z,R,e)=>{"use strict";e.d(R,{T:()=>m});var n=e(2543),a=e.n(n),s=e(36674),l=e(3371),o=e(8285),d=e(39765),i=e(92769),c=e(37365);class m extends s.Bs{constructor(g){super(g),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getTab(){if(!(this.parent instanceof i.V))throw new Error("RepeatedTabItemBehavior: Parent is not a TabItem");return this.parent}_getLayout(){const g=this._getTab().parent;if(!(g instanceof c.K))throw new Error("RepeatedTabItemBehavior: Layout is not a TabsLayoutManager");return g}performRepeat(g=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const y=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!y){console.error("RepeatedTabItemBehavior: Variable not found");return}if(!(y instanceof s.n8)){console.error("RepeatedTabItemBehavior: Variable is not a MultiValueVariable");return}const v=this._getTab(),x=this._getLayout(),{values:f,texts:u}=(0,o.a7)(y);if((0,n.isEqual)(this._prevRepeatValues,f)&&!g)return;this._prevRepeatValues=f,this._clonedTabs=[];const b=v.getLayout(),E={values:[""],texts:y.hasAllValue()?["All"]:["None"]},D=f.length?f:E.values,C=u.length?u:E.texts;for(let P=0;P<D.length;P++){const T=P===0,O=T?v:v.clone({$behaviors:[]}),I=(0,l.lv)(v.state.key,P);O.setState({key:I,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:D[P],text:String(C[P]),isMulti:y.state.isMulti,includeAll:y.state.includeAll})]}),layout:b.cloneLayout?.(I,T)}),this._clonedTabs.push(O)}p(x,this._clonedTabs,v.state.key),this.publishEvent(new d.d({source:this}),!0)}removeBehavior(){const g=this._getTab(),y=this._getLayout(),v=h(y,g.state.key);y.setState({tabs:v}),g.setState({$behaviors:g.state.$behaviors.filter(x=>x!==this),$variables:void 0})}}function p(r,g,y){const v=h(r,y),x=v.findIndex(f=>f.state.key.includes(y));if(x===-1)throw new Error("TabItemRepeaterBehavior: Tab not found in layout");r.setState({tabs:[...v.slice(0,x),...g,...v.slice(x+1)]})}function h(r,g){return r.state.tabs.filter(y=>!(0,l.oX)(y.state.key,g))}},37365:(Z,R,e)=>{"use strict";e.d(R,{K:()=>I});var n=e(92745),a=e(36674),s=e(33143),l=e(6461),o=e(3371),d=e(8285),i=e(97335),c=e(97883),m=e(48492),p=e(20246),h=e(92769),r=e(34031),g=e(74848),y=e(22803),v=e(89332),x=e(51898),f=e(63142),u=e(54314),b=e(45861),E=e(13941),D=e(41116),C=e(1837),P=e(61659);function T({model:j}){const W=(0,f.of)(O),{tabs:B,key:S}=j.useState(),w=j.getCurrentTab(),{layout:N}=w.useState(),M=(0,d.YQ)(j),{isEditing:L}=M.useState(),{hasCopiedTab:A}=(0,P.x)(),[U,F,V]=(0,D.H)(w);return(0,g.jsxs)("div",{className:W.tabLayoutContainer,children:[(0,g.jsx)(u.U,{className:W.tabsBar,children:(0,g.jsx)(v.JY,{onBeforeDragStart:K=>j.forceSelectTab(K.draggableId),onDragEnd:K=>{K.destination&&K.destination.index!==K.source.index&&j.moveTab(K.source.index,K.destination.index)},children:(0,g.jsxs)("div",{className:W.tabsRow,children:[(0,g.jsx)(v.gL,{droppableId:S,direction:"horizontal",children:K=>(0,g.jsxs)("div",{className:W.tabsContainer,ref:K.innerRef,...K.droppableProps,children:[B.map(G=>(0,g.jsx)(G.Component,{model:G},G.state.key)),K.placeholder]})}),L&&(0,g.jsxs)("div",{className:"dashboard-canvas-add-button",children:[(0,g.jsx)(b.$n,{icon:"plus",variant:"primary",fill:"text",onClick:()=>j.addNewTab(),"data-testid":x.Tp.components.CanvasGridAddActions.addTab,children:(0,g.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.new-tab",children:"New tab"})}),A&&(0,g.jsx)(b.$n,{icon:"clipboard-alt",variant:"primary",fill:"text",onClick:()=>j.pasteTab(),"data-testid":x.Tp.components.CanvasGridAddActions.pasteTab,children:(0,g.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.paste-tab",children:"Paste tab"})})]})]})})}),L&&(0,g.jsxs)(E.J,{className:(0,y.cx)(W.tabContentContainer,F),children:[w&&(0,g.jsx)(N.Component,{model:N}),V]}),!L&&(0,g.jsx)(E.J,{className:W.tabContentContainer,children:w&&(0,g.jsx)(N.Component,{model:N})})]})}const O=j=>({tabLayoutContainer:(0,y.css)({display:"flex",flexDirection:"column",flex:"1 1 auto"}),tabsBar:(0,y.css)(C.u),tabsRow:(0,y.css)({display:"flex",width:"100%",alignItems:"center"}),tabsContainer:(0,y.css)({display:"flex",justifyContent:"flex-start",alignItems:"flex-end",overflowX:"auto",overflowY:"hidden",paddingInline:j.spacing(.125),paddingTop:"1px"}),tabContentContainer:(0,y.css)({backgroundColor:"transparent",position:"relative",display:"flex",flexDirection:"column",flex:1,minHeight:j.spacing(1+.125),paddingTop:j.spacing(1)})});class I extends a.Bs{constructor(W){super({...W,tabs:W.tabs??[new h.V],currentTabIndex:W.currentTabIndex??0}),this.isDashboardLayoutManager=!0,this.descriptor=I.descriptor,this._urlSync=new a.So(this,{keys:()=>[this.getUrlKey()]})}static{this.Component=T}static{this.descriptor={get name(){return(0,n.t)("dashboard.tabs-layout.name","Tabs")},get description(){return(0,n.t)("dashboard.tabs-layout.description","Organize panels into horizontal tabs")},id:"TabsLayout",createFromLayout:I.createFromLayout,isGridLayout:!1,icon:"window"}}serialize(){return(0,l.lX)(this)}duplicate(){throw new Error("Method not implemented.")}duplicateTab(W){const B=W.duplicate();this.addNewTab(B)}getUrlState(){return{[this.getUrlKey()]:this.getCurrentTab().getSlug()}}updateFromUrl(W){const B=this.getUrlKey(),S=W[B];if(S&&typeof W[B]=="string"){const w=this.state.tabs.findIndex(N=>N.getSlug()===S);w!==-1&&this.setState({currentTabIndex:w})}}switchToTab(W){this.setState({currentTabIndex:this.state.tabs.indexOf(W)})}getCurrentTab(){return this.state.tabs.length>this.state.currentTabIndex?this.state.tabs[this.state.currentTabIndex]:this.state.tabs[0]}addPanel(W){this.getCurrentTab().getLayout().addPanel(W)}getVizPanels(){const W=[];for(const B of this.state.tabs){const S=B.getLayout().getVizPanels();W.push(...S)}return W}cloneLayout(W,B){return this.clone({tabs:this.state.tabs.map(S=>{const w=(0,o.ed)(W,S.state.key);return S.clone({key:w,layout:S.state.layout.cloneLayout(w,B)})})})}getOutlineChildren(){return this.state.tabs}addNewTab(W){const B=W??new h.V({}),S=new Set(this.state.tabs.map(N=>N.state.title).filter(N=>N!==void 0)),w=(0,p.BK)(B.state.title,S);return w!==B.state.title&&B.setState({title:w}),s.cc.addElement({addedObject:B,source:this,perform:()=>this.setState({tabs:[...this.state.tabs,B],currentTabIndex:this.state.tabs.length}),undo:()=>{const N=this.state.tabs.findIndex(M=>M===B);this.setState({tabs:this.state.tabs.filter(M=>M!==B),currentTabIndex:this.state.currentTabIndex===N?Math.max(0,this.state.currentTabIndex-1):this.state.currentTabIndex})}}),B}editModeChanged(W){this.state.tabs.forEach(B=>B.getLayout().editModeChanged?.(W))}pasteTab(){const W=(0,d.YQ)(this),B=(0,m.sN)(W);this.addNewTab(B)}activateRepeaters(){this.state.tabs.forEach(W=>{W.isActive||W.activate();const B=(W.state.$behaviors??[]).find(S=>S instanceof r.T);B?.isActive||B?.activate(),W.getLayout().activateRepeaters?.()})}shouldUngroup(){return this.state.tabs.length===1}removeTab(W){if(this.shouldUngroup()){(0,p.f)(this,W.state.layout);return}if(this.getCurrentTab()===W){const N=this.state.currentTabIndex,M=this.state.tabs.findIndex(A=>A===W),L=N>0?N-1:0;s.cc.removeElement({removedObject:W,source:this,perform:()=>this.setState({tabs:this.state.tabs.filter(A=>A!==W),currentTabIndex:N===M?L:N}),undo:()=>{const A=[...this.state.tabs];A.splice(M,0,W),this.setState({tabs:A,currentTabIndex:N})}});return}const S=this.state.tabs.filter(N=>N!==W),w=S.length===0?[new h.V]:S;this.setState({tabs:w,currentTabIndex:0})}moveTab(W,B){const S=this.state.tabs[W];s.cc.moveElement({source:this,movedObject:S,perform:()=>{this.rearrangeTabs(W,B)},undo:()=>{this.rearrangeTabs(B,W)}})}rearrangeTabs(W,B){const S=[...this.state.tabs],[w]=S.splice(W,1);S.splice(B,0,w),this.setState({tabs:S,currentTabIndex:B}),this.publishEvent(new s.su(this),!0)}forceSelectTab(W){const B=this.state.tabs.findIndex(N=>N.state.key===W),S=this.state.tabs[B];if(!S)return;(0,d.YQ)(this).state.editPane.selectObject(S,W,{force:!0,multi:!1}),this.setState({currentTabIndex:B})}static createEmpty(){const W=new h.V;return new I({tabs:[W]})}static createFromLayout(W){let B=[];if(W instanceof c.V)for(const S of W.state.rows){if((0,o.Ry)(S.state.key))continue;const w=S.state.conditionalRendering;w?.clearParent();const N=S.state.repeatByVariable?[new r.T({variableName:S.state.repeatByVariable})]:void 0;B.push(new h.V({layout:S.state.layout.clone(),title:S.state.title,conditionalRendering:w,$behaviors:N}))}else W.clearParent(),B.push(new h.V({layout:W}));return new I({tabs:B})}getUrlKey(){let W=this.parent,B="dtab";for(;W;)W instanceof h.V&&(B=`${W.getSlug()}-${B}`),W instanceof i.o&&(B=`${W.getSlug()}-${B}`),W=W.parent;return B}duplicateTitles(){const W=new Map,B=new Set;return this.state.tabs.forEach(S=>{const w=a.jh.interpolate(S,S.state.title),N=(W.get(w)??0)+1;W.set(w,N),N>1&&B.add(w)}),B}}},6607:(Z,R,e)=>{"use strict";e.d(R,{f:()=>f});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(63142),d=e(45861),i=e(88559),c=e(87063),m=e(1682),p=e(8285),h=e(72746),r=e(97883),g=e(37365),y=e(17084),v=e(61659),x=e(20246);function f({layoutManager:C}){const P=(0,o.of)(D),{hasCopiedPanel:T}=(0,v.x)();return(0,n.jsxs)("div",{className:(0,a.cx)(P.addAction,"dashboard-canvas-add-button"),children:[(0,n.jsx)(d.$n,{variant:"primary",fill:"text",icon:"plus","data-testid":s.Tp.components.CanvasGridAddActions.addPanel,onClick:()=>C.addPanel((0,p.O8)()),children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.canvas-actions.add-panel",children:"Add panel"})}),(0,n.jsx)(i.m,{overlay:(0,n.jsxs)(c.W,{children:[(0,n.jsx)(c.W.Item,{icon:"list-ul",label:(0,l.t)("dashboard.canvas-actions.group-into-row","Group into row"),onClick:()=>{(0,y.t)(C)}}),(0,n.jsx)(c.W.Item,{icon:"layers",label:(0,l.t)("dashboard.canvas-actions.group-into-tab","Group into tab"),onClick:()=>{(0,y.A)(C)}})]}),children:(0,n.jsx)(d.$n,{variant:"primary",fill:"text",icon:"layers","data-testid":s.Tp.components.CanvasGridAddActions.groupPanels,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.canvas-actions.group-panels",children:"Group panels"})})}),u(C),T&&C.pastePanel&&(0,n.jsx)(d.$n,{variant:"primary",fill:"text",icon:"clipboard-alt",onClick:()=>{C.pastePanel?.()},children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.canvas-actions.paste-panel",children:"Paste panel"})})]})}function u(C){if(C.parent instanceof h.H$)return null;const T=m.b4.getLayoutManagerFor(C.parent),O=()=>{(0,x.f)(T,C)};return T instanceof g.K?(0,n.jsx)(b,{parentLayout:T,onClick:O}):T instanceof r.V?(0,n.jsx)(E,{parentLayout:T,onClick:O}):null}function b({parentLayout:C,onClick:P}){const{tabs:T}=C.useState();return T.length>1?null:(0,n.jsx)(d.$n,{variant:"primary",fill:"text",icon:"layers-slash",onClick:P,"data-testid":s.Tp.components.CanvasGridAddActions.ungroup,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.canvas-actions.un-group-panels",children:"Ungroup"})})}function E({parentLayout:C,onClick:P}){const{rows:T}=C.useState();return T.length>1?null:(0,n.jsx)(d.$n,{variant:"primary",fill:"text",icon:"layers-slash",onClick:P,"data-testid":s.Tp.components.CanvasGridAddActions.ungroup,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.canvas-actions.un-group-panels",children:"Ungroup"})})}const D=C=>({addAction:(0,a.css)({position:"absolute",padding:C.spacing(1,0),height:C.spacing(5),bottom:0,left:0,right:0,opacity:0,[C.transitions.handleMotion("no-preference","reduce")]:{transition:C.transitions.create("opacity")}})})},44802:(Z,R,e)=>{"use strict";e.d(R,{W:()=>x});var n=e(74848),a=e(96540),s=e(92745),l=e(31286),o=e(77824),d=e(25797),i=e(51156),c=e(15759),m=e(42954),p=e(8835),h=e(1131),r=e(97883),g=e(37365);const y=new m.O(()=>[h.D.descriptor,p.X2.descriptor,r.V.descriptor,g.K.descriptor]);function v({layoutManager:f}){const u=f.descriptor.isGridLayout,b=y.list().filter(C=>C.isGridLayout===u),E=(0,a.useCallback)(C=>{const P=f.parent;P&&(0,c.l)(P)&&P.switchLayout(C.createFromLayout(f))},[f]),D=b.map(C=>({value:C,label:C.name,icon:C.icon,description:C.description,ariaLabel:`layout-selection-option-${C.name}`}));return(0,n.jsx)(l.a,{paddingBottom:2,display:"flex",grow:1,alignItems:"center",children:(0,n.jsx)(o.z,{fullWidth:!0,value:f.descriptor,options:D,onChange:E})})}function x(f){return(0,a.useMemo)(()=>{const u=f.descriptor.isGridLayout,b=new d.C({title:(0,s.t)("dashboard.layout.common.group-layout","Group layout"),id:"group-layout-category",isOpenDefault:!1}),E=new d.C({title:(0,s.t)("dashboard.layout.common.panel-layout","Panel layout"),id:"grid-layout-category",isOpenDefault:!1});if(E.addItem(new i.v({title:"",skipField:!0,render:()=>(0,n.jsx)(v,{layoutManager:f})})),u?b.props.disabledText=(0,s.t)("dashboard.layout.common.group-layout-disabled","No groups exists on this level"):(b.addItem(new i.v({title:"",skipField:!0,render:()=>(0,n.jsx)(v,{layoutManager:f})})),E.props.disabledText=(0,s.t)("dashboard.layout.common.panel-layout-disabled","Select a row or tab to change panel layout options")),f.getOptions)for(const D of f.getOptions())E.addItem(D);return[b,E]},[f])}},17084:(Z,R,e)=>{"use strict";e.d(R,{A:()=>i,t:()=>c});var n=e(43173),a=e(33143),s=e(1131),l=e(97883),o=e(37365),d=e(15759);function i(m){const p=m.parent;if(!(0,d.l)(p))throw new Error("Parent layout is not a LayoutParent");if(m instanceof o.K)return m.addNewTab();const h=o.K.createEmpty();h.state.tabs[0].setState({layout:m.clone()}),p.switchLayout(h);const r=h.state.tabs[0];return m.publishEvent(new a.jO(r),!0),r}function c(m){if(!n.$.featureToggles.dashboardNewLayouts){if(m instanceof s.D)return m.addNewRow();throw new Error("New dashboard layouts feature not enabled but new layout found")}if(m instanceof l.V)return m.addNewRow();if(m instanceof o.K){const g=m.getCurrentTab();return c(g.state.layout)}const p=m.parent;if(!(0,d.l)(p))throw new Error("Parent layout is not a LayoutParent");const h=l.V.createFromLayout(p.getLayout());p.switchLayout(h);const r=h.state.rows[0];return m.publishEvent(new a.jO(r),!0),r}},48492:(Z,R,e)=>{"use strict";e.d(R,{$v:()=>h,G2:()=>p,dp:()=>y,qY:()=>v,sN:()=>r});var n=e(95943),a=e(29043),s=e(4974),l=e(17340),o=e(76584),d=e(6461),i=e(1682),c=e(25953),m=e(93389);function p(){a.A.delete(n.tH),a.A.delete(n.rt),a.A.delete(n.Gk)}function h(f){const u=a.A.get(n.rt),b=JSON.parse(u);p();const E=x(i.b4.getNextPanelId(f));let D;try{D=(0,o.g5)(b.row,b.elements,!1,E)}catch{throw new Error("Error pasting row from clipboard, please try to copy again")}return D}function r(f){const u=a.A.get(n.Gk),b=JSON.parse(u);p();const E=x(i.b4.getNextPanelId(f));let D;try{D=(0,d.zE)(b.tab,b.elements,!1,E)}catch{throw new Error("Error pasting tab from clipboard, please try to copy again")}return D}function g(f){const u=a.A.get(n.tH),{elements:b,gridItem:E}=JSON.parse(u);return E.kind==="GridLayoutItem"?(0,l.ve)(E,b,x(i.b4.getNextPanelId(f))):(0,s.i6)(E,b,x(i.b4.getNextPanelId(f)))}function y(f){const u=g(f);return u instanceof c.X?u:new c.X({body:u.state.body,key:u.state.key,variableName:u.state.variableName})}function v(f,u){const b=g(f);return b instanceof m.U?b:new m.U({...u,body:b.state.body,key:b.state.key,variableName:b.state.variableName})}function x(f){let u=f;return()=>u++}},41667:(Z,R,e)=>{"use strict";e.d(R,{R:()=>d,d:()=>o});var n=e(36674),a=e(97335),s=e(92769),l=e(37365);function o(i,c){if(c.current?.isConnected){d(c.current);return}let m=i.parent;for(;m;){if(m instanceof a.o&&m.state.collapse&&m.onCollapseToggle(),m instanceof n.tI&&m.state.isCollapsed&&m.onCollapseToggle(),m instanceof s.V){const p=m.parent;p instanceof l.K&&p.getCurrentTab()!==m&&p.switchToTab(m)}m=m.parent}setTimeout(()=>{c.current?.isConnected&&d(c.current)},10)}function d(i){i.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},1837:(Z,R,e)=>{"use strict";e.d(R,{u:()=>n});const n={"&:hover,:focus-within":{".dashboard-canvas-add-button":{opacity:1,filter:"unset"}}}},61659:(Z,R,e)=>{"use strict";e.d(R,{x:()=>l});var n=e(96540),a=e(95943),s=e(29043);function l(){const[o,d]=(0,n.useState)(s.A.exists(a.tH)),[i,c]=(0,n.useState)(s.A.exists(a.rt)),[m,p]=(0,n.useState)(s.A.exists(a.Gk));return(0,n.useEffect)(()=>{const h=s.A.subscribe(a.tH,()=>{d(s.A.exists(a.tH))}),r=s.A.subscribe(a.rt,()=>{c(s.A.exists(a.rt))}),g=s.A.subscribe(a.Gk,()=>{p(s.A.exists(a.Gk))});return()=>{h(),r(),g()}},[]),{hasCopiedPanel:o,hasCopiedRow:i,hasCopiedTab:m}}},20246:(Z,R,e)=>{"use strict";e.d(R,{BK:()=>o,f:()=>d,z4:()=>l});var n=e(96540),a=e(15759);function s(i){let c=i.parent;for(;c;){if(isDashboardLayoutManager(c))return c;c=c.parent}return null}function l({autoFocus:i}={}){const c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{c.current&&i&&setTimeout(()=>c.current?.focus(),200)},[i]),c}function o(i,c){const m=i??"";if(c.has(m)){const p=m.match(/^(.*?)(\d+)$/);if(p){const h=p[1],r=parseInt(p[2],10);let g=`${h}${r+1}`;for(;c.has(g);){const y=parseInt(g.match(/\d+$/)[0],10)+1;g=`${h}${y}`}return g}else{let h=1,r=`${m} ${h}`;for(;c.has(r);)h++,r=`${m} ${h}`;return r}}return m}function d(i,c){const m=i.parent;(0,a.l)(m)&&(c.clearParent(),m.switchLayout(c))}},95395:(Z,R,e)=>{"use strict";e.d(R,{GA:()=>te,aS:()=>ue,Qk:()=>ne});var n=e(74848),a=e(22803),s=e(63142),l=e(36219),o=e(7895),d=e(15130),i=e(4590),c=e(75541),m=e(8285),p=e(51898),h=e(92745),r=e(36490),g=e(45861);const y=({dashboard:he})=>(0,n.jsx)(g.$n,{onClick:()=>r.Ny.partial(he.state.editview?{editview:null}:{viewPanel:null,editPanel:null}),tooltip:"",fill:he.state.editview?"text":void 0,variant:"secondary",size:"sm",icon:"arrow-left","data-testid":p.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.back-to-dashboard",children:"Back to dashboard"})});var v=e(30703);const x=({dashboard:he})=>(0,n.jsx)(o.I,{tooltip:(0,h.t)("dashboard.toolbar.new.dashboard-settings.tooltip","Dashboard settings"),icon:(0,n.jsx)(v.I,{name:"cog",size:"lg",type:"default"}),onClick:()=>he.onOpenSettings(),"data-testid":p.Tp.components.NavToolbar.editDashboard.settingsButton}),f=({dashboard:he})=>(0,n.jsx)(g.$n,{onClick:()=>he.state.editPanel?.onDiscard(),tooltip:(0,h.t)("dashboard.toolbar.new.discard-library-panel-changes","Discard library panel changes"),size:"sm",fill:"outline",variant:"destructive","data-testid":p.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.discard-library-panel-changes",children:"Discard library panel changes"})});var u=e(96540);const b=({dashboard:he})=>{const me=E(he.state.editPanel);return(0,n.jsx)(g.$n,{onClick:()=>he.state.editPanel?.onDiscard(),tooltip:he.state.editPanel?.state.isNewPanel?(0,h.t)("dashboard.toolbar.new.discard-panel-new","Discard panel"):(0,h.t)("dashboard.toolbar.new.discard-panel","Discard panel changes"),size:"sm",disabled:!me,fill:"outline",variant:"destructive","data-testid":p.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:he.state.editPanel?.state.isNewPanel?(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.discard-panel-new",children:"Discard panel"}):(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.discard-panel",children:"Discard panel changes"})})};function E(he){const[me,ce]=(0,u.useState)();return(0,u.useEffect)(()=>{if(he){const Pe=he.subscribeToState(Ie=>{Ie.isDirty!==me&&ce(Ie.isDirty)});return()=>Pe.unsubscribe()}},[he,me]),me}var D=e(45967);const C=({icon:he,label:me,checked:ce,checkedIcon:Pe,checkedLabel:Ie,disabled:Se,onClick:Me,"data-testid":Te})=>{const Ge=(0,s.of)(P),Qe=ce&&Ie?Ie:me,tt=ce&&Pe?Pe:he;return(0,n.jsx)(D.m,{content:Qe,children:(0,n.jsx)("button",{"aria-label":Qe,className:(0,a.cx)({[Ge.container]:!0,[Ge.containerChecked]:ce,[Ge.containerDisabled]:Se}),"data-testid":Te,onClick:Se?void 0:Me,children:(0,n.jsx)("div",{className:(0,a.cx)(Ge.box,ce&&Ge.boxChecked),children:(0,n.jsx)(v.I,{name:tt,size:"xs"})})})})},P=he=>({container:(0,a.css)({border:`1px solid ${he.components.input.borderColor}`,padding:he.spacing(.25),backgroundColor:he.components.input.background,borderRadius:he.shape.radius.default,width:he.spacing(5.5),height:he.spacing(3),cursor:"pointer",display:"flex",flexDirection:"row",alignItems:"center",[he.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease-in-out"},"&:hover":{borderColor:he.components.input.borderHover}}),containerChecked:(0,a.css)({backgroundColor:he.colors.primary.main,borderColor:"transparent","&:hover":{backgroundColor:he.colors.primary.shade,borderColor:"transparent"}}),containerDisabled:(0,a.css)({cursor:"initial",background:he.colors.action.disabledBackground,borderColor:he.colors.border.weak}),box:(0,a.css)({background:he.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center",width:he.spacing(2.5),height:he.spacing(2.5),borderRadius:he.shape.radius.default,transform:"translateX(0)",position:"relative",[he.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease-in-out"},"&:after":(0,a.css)({content:"''",position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:he.shape.radius.default,background:he.colors.secondary.main,border:`1px solid ${he.colors.secondary.border}`})}),boxChecked:(0,a.css)({transform:`translateX(calc(100% - ${he.spacing(.25)}))`})}),T=({dashboard:he})=>(0,n.jsx)(C,{checked:!!he.state.isEditing,icon:"pen",label:(0,h.t)("dashboard.toolbar.new.edit-toggle.enter.label","Enter edit mode"),checkedLabel:(0,h.t)("dashboard.toolbar.new.edit-toggle.exit.label","Exit edit mode"),disabled:i._o.state.isPlaying,"data-testid":p.Tp.components.NavToolbar.editDashboard.editButton,onClick:me=>{me.preventDefault(),me.stopPropagation(),he.state.isEditing?he.exitEditMode({skipConfirm:!1}):he.onEnterEditMode()}});var O=e(43173),I=e(58662),j=e(55867),W=e(23289),B=e(93256),S=e(88559),w=e(45229),N=e(87745);const M=({dashboard:he,menu:me,onMenuVisibilityChange:ce,groupTestId:Pe,buttonLabel:Ie,buttonTooltip:Se,buttonTestId:Me,onButtonClick:Te,arrowLabel:Ge,arrowTestId:Qe,variant:tt="secondary"})=>{const[ke,He]=(0,u.useState)(!1);return(0,n.jsxs)(B.e,{"data-testid":Pe,onPointerDown:Re=>{he.state.isEditing&&he.state.isDirty&&(Re.preventDefault(),Re.stopPropagation(),w.A.publish(new N.bY({title:(0,h.t)("dashboard.toolbar.new.share-export.modal.title","Save changes to dashboard?"),text:(0,h.t)("dashboard.toolbar.new.share-export.modal.text","You have unsaved changes to this dashboard. You need to save them before you can share it."),icon:"exclamation-triangle",noText:(0,h.t)("dashboard.toolbar.new.share-export.modal.noText","Discard"),yesText:(0,h.t)("dashboard.toolbar.new.share-export.modal.yesText","Save"),yesButtonVariant:"primary",onConfirm:()=>he.openSaveDrawer({})})))},children:[(0,n.jsx)(g.$n,{"data-testid":Me,size:"sm",tooltip:Se,variant:tt,onClick:Te,children:Ie}),(0,n.jsx)(S.m,{overlay:me,placement:"bottom-end",onVisibleChange:Re=>{he.state.isEditing&&he.state.isDirty||(ce?.(Re),He(Re))},children:(0,n.jsx)(g.$n,{"aria-label":Ge,"data-testid":Qe,size:"sm",icon:ke?"angle-up":"angle-down",variant:tt})})]})},L=p.Tp.pages.Dashboard.DashNav.NewExportButton,A=({dashboard:he})=>{const me=O.$.featureToggles.kubernetesDashboards?(0,h.t)("dashboard.toolbar.new.export.tooltip.as-code","Export as code"):(0,h.t)("dashboard.toolbar.new.export.tooltip.json","Export as JSON");return(0,n.jsx)(M,{menu:()=>(0,n.jsx)(j.A,{dashboard:he}),groupTestId:L.container,buttonLabel:(0,h.t)("dashboard.toolbar.new.export.title","Export"),buttonTooltip:me,buttonTestId:L.container,onButtonClick:()=>{r.Ny.partial({shareView:I.wr.export}),W.c.sharingCategoryClicked({item:I.wr.export,shareResource:(0,I.hD)()})},arrowLabel:(0,h.t)("dashboard.toolbar.new.export.arrow","Export"),arrowTestId:L.arrowMenu,dashboard:he})},U=({dashboard:he})=>(0,n.jsx)(g.$n,{disabled:i._o.state.isPlaying,onClick:()=>{he.onEnterEditMode(),he.setState({editable:!0,meta:{...he.state.meta,canEdit:!0}})},tooltip:(0,h.t)("dashboard.toolbar.new.enter-edit-mode.tooltip","This dashboard was marked as read only"),variant:"secondary",size:"sm","data-testid":p.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.enter-edit-mode.label",children:"Make editable"})}),F=({})=>(0,n.jsx)(o.I,{"data-testid":p.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,h.t)("dashboard.toolbar.new.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>i._o.next(),narrow:!0}),V=({})=>(0,n.jsx)(o.I,{"data-testid":p.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,h.t)("dashboard.toolbar.new.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>i._o.prev()}),K=({})=>(0,n.jsx)(o.I,{onClick:()=>i._o.stop(),"data-testid":p.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.playlist-stop",children:"Stop playlist"})});var G=e(87063);const H=({dashboard:he})=>{const{meta:me,isDirty:ce,uid:Pe}=he.state,Ie=!(Pe||he.isManaged()),Se=he.isManaged();return Ie?(0,n.jsx)(g.$n,{onClick:()=>he.openSaveDrawer({}),tooltip:(0,h.t)("dashboard.toolbar.new.save-dashboard.tooltip","Save changes"),size:"sm",variant:"primary","data-testid":p.Tp.components.NavToolbar.editDashboard.saveButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard.label",children:"Save"})}):d.TP.hasEditPermissionInFolders&&!me.canSave&&!me.canMakeEditable&&!Se?(0,n.jsx)(g.$n,{onClick:()=>he.openSaveDrawer({saveAsCopy:!0}),tooltip:(0,h.t)("dashboard.toolbar.new.save-dashboard-copy.tooltip","Save as copy"),size:"sm",variant:ce?"primary":"secondary",children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard-copy.label",children:"Save as copy"})}):(0,n.jsxs)(B.e,{children:[(0,n.jsx)(g.$n,{onClick:()=>he.openSaveDrawer({}),tooltip:(0,h.t)("dashboard.toolbar.new.save-dashboard.tooltip","Save changes"),size:"sm","data-testid":p.Tp.components.NavToolbar.editDashboard.saveButton,variant:ce?"primary":"secondary",children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard.label",children:"Save"})}),(0,n.jsx)(S.m,{overlay:(0,n.jsxs)(G.W,{children:[(0,n.jsx)(G.W.Item,{label:(0,h.t)("dashboard.toolbar.new.save-dashboard-short","Save"),icon:"save",onClick:()=>he.openSaveDrawer({})}),(0,n.jsx)(G.W.Item,{label:(0,h.t)("dashboard.toolbar.new.save-dashboard-copy.label","Save as copy"),icon:"copy",onClick:()=>he.openSaveDrawer({saveAsCopy:!0})})]}),children:(0,n.jsx)(g.$n,{"aria-label":(0,h.t)("dashboard.toolbar.new.more-save-options","More save options"),icon:"angle-down",variant:ce?"primary":"secondary",size:"sm"})})]})},_=({dashboard:he})=>(0,n.jsx)(g.$n,{onClick:()=>he.state.editPanel?.onSaveLibraryPanel(),tooltip:(0,h.t)("dashboard.toolbar.new.save-library-panel","Save library panel"),size:"sm",fill:"outline",variant:"primary","data-testid":p.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.save-library-panel",children:"Save library panel"})});var k=e(41053),J=e(16001),z=e(12434);const Y=p.Tp.pages.Dashboard.DashNav.newShareButton,X=({dashboard:he})=>{const[me,ce]=(0,k.A)(async()=>(W.c.toolbarShareClick(),await(0,z.Xe)(he)),[he]);return(0,n.jsx)(M,{menu:()=>(0,n.jsx)(J.Ay,{dashboard:he}),onMenuVisibilityChange:Pe=>{Pe&&W.c.toolbarShareDropdownClick()},groupTestId:Y.shareLink,buttonLabel:(0,h.t)("dashboard.toolbar.new.share.title","Share"),buttonTooltip:(0,h.t)("dashboard.toolbar.new.share.tooltip","Copy link"),buttonTestId:Y.container,onButtonClick:ce,arrowLabel:(0,h.t)("dashboard.toolbar.new.share.arrow","Share"),arrowTestId:Y.arrowMenu,dashboard:he,variant:he.state.isEditing?"secondary":"primary"})},Q=({dashboard:he})=>(0,n.jsx)(g.$n,{onClick:()=>he.state.editPanel?.onUnlinkLibraryPanel(),tooltip:(0,h.t)("dashboard.toolbar.new.unlink-library-panel","Unlink library panel"),size:"sm",fill:"outline",variant:"secondary","data-testid":p.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:(0,n.jsx)(h.x6,{i18nKey:"dashboard.toolbar.new.unlink-library-panel",children:"Unlink library panel"})});var q=e(12991);const te=({dashboard:he})=>{const{editPanel:me,editable:ce,editview:Pe,isEditing:Ie,uid:Se,meta:Me,viewPanelScene:Te}=he.useState(),{isPlaying:Ge}=i._o.useState(),Qe=(0,s.of)(ie),tt=!!ce,ke=!!Me.canSave,He=!!Se,Re=!!Ie,Ne=!!Pe,Ae=!!me,Ue=!!Te,Be=Ae&&(0,m.ME)(me.state.panelRef.resolve()),We=!Ne&&!Ue&&!Ae,_e=Re&&We,Xe=!!Me.isSnapshot,le=d.TP.hasEditPermissionInFolders,ye=Ae&&!Ne&&!Ue,pe=Ge&&We&&!Re,ve=He&&!Xe&&!Ge&&!Ae;return(0,n.jsx)(l.U,{alignment:"right",className:Qe.container,children:(0,q.g)([...(0,q.f)(c.C.right,"",!Ae&&!Re),{key:"play-list-previous-button",component:V,group:"playlist",condition:pe},{key:"play-list-stop-button",component:K,group:"playlist",condition:pe},{key:"play-list-next-button",component:F,group:"playlist",condition:pe},{key:"back-to-dashboard-button",component:y,group:"panel",condition:Ne||(Ue||Ae)&&!Be},{key:"discard-panel-button",component:b,group:"panel",condition:ye&&!Be},{key:"discard-library-panel-button",component:f,group:"panel",condition:ye&&Be},{key:"unlink-library-panel-button",component:Q,group:"panel",condition:ye&&Be},{key:"save-library-panel-button",component:_,group:"panel",condition:ye&&Be},{key:"dashboard-undo",component:se,group:"dashboard",condition:_e&&he.canEditDashboard()},{key:"dashboard-redo",component:de,group:"dashboard",condition:_e&&he.canEditDashboard()},{key:"dashboard-settings",component:x,group:"dashboard",condition:_e&&he.canEditDashboard()},{key:"save-dashboard",component:H,group:"save-edit",condition:Re&&!Be&&(ke||le)},{key:"make-dashboard-editable-button",component:U,group:"save-edit",condition:!Ie&&he.canEditDashboard()&&!Ue&&!tt&&!Ge},{key:"edit-dashboard-switch",component:T,group:"save-edit",condition:he.canEditDashboard()&&!Ae&&!Be&&!Ue&&tt&&!Ge&&!Ae},{key:"new-export-dashboard-button",component:A,group:"export-share",condition:ve},{key:"new-share-dashboard-button",component:X,group:"export-share",condition:ve}],he)})},ne="undo-button";function se({dashboard:he}){const me=he.state.editPane,{undoStack:ce}=me.useState(),Pe=ce[ce.length-1],Ie=`Undo${Pe?.description?` '${Pe.description}'`:""}`;return(0,n.jsx)(o.I,{id:ne,icon:"corner-up-left",disabled:ce.length===0,onClick:()=>me.undoAction(),tooltip:Ie})}const ue="redo-button";function de({dashboard:he}){const me=he.state.editPane,{redoStack:ce}=me.useState(),Pe=ce[ce.length-1],Ie=`Redo${Pe?.description?` '${Pe.description}'`:""}`;return(0,n.jsx)(o.I,{id:ue,icon:"corner-up-right",disabled:ce.length===0,tooltip:Ie,onClick:()=>me.redoAction()})}const ie=he=>({container:(0,a.css)({paddingLeft:he.spacing(.5)})})},98036:(Z,R,e)=>{"use strict";e.d(R,{d:()=>c,u:()=>m});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(63142),d=e(99887),i=e(62905);const c=({dashboard:r})=>r.state.uid?(0,n.jsx)(p,{uid:r.state.uid}):null,m=p;function p({uid:r}){const{data:g}=(0,i.Bs)(r),y=(0,o.of)(h);return g?(0,n.jsx)(d.E,{color:"blue",text:(0,l.t)("dashboard.toolbar.new.public-dashboard","Public"),className:y.badge,"data-testid":s.Tp.pages.Dashboard.DashNav.publicDashboardTag}):null}const h=()=>({badge:(0,a.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})})},12991:(Z,R,e)=>{"use strict";e.d(R,{f:()=>o,g:()=>l});var n=e(74848),a=e(5423),s=e(22429);function l(d,i){const c=[];let m="";for(const p of d)p.condition&&(p.group&&m&&m!==p.group&&c.push((0,n.jsx)(a.K,{},`${p.group}-separator`)),c.push((0,n.jsx)(p.component,{dashboard:i},p.key)),m=p.group);return c}function o(d,i,c){const m=(0,s.UA)().getCurrent();return d.reduce((p,h)=>{const r={dashboard:m};return h.show(r)&&p.push({key:p.length.toString(),group:i,condition:c,component:()=>(0,n.jsx)(h.component,{...r})}),p},[])}},35718:(Z,R,e)=>{"use strict";e.d(R,{C:()=>m});var n=e(1906),a=e(57852),s=e(43173),l=e(78282),o=e(36674),d=e(78767),i=e(1682),c=e(8285);function m(y,v){const x=(0,c.YQ)(y);v.app=x.state.editPanel?n.Jk.PanelEditor:n.Jk.Dashboard,x.subscribeToState(f=>{f.editPanel?v.app=n.Jk.PanelEditor:v.app=n.Jk.Dashboard}),v.canAddAnnotations=()=>{const f=(0,c.YQ)(y);return!p(f)||!s.$.featureToggles.annotationPermissionUpdate&&!f.canEditDashboard()?!1:!!f.state.meta.annotationsPermissions?.dashboard.canAdd},v.canEditAnnotations=f=>{const u=(0,c.YQ)(y);return!s.$.featureToggles.annotationPermissionUpdate&&!u.canEditDashboard()?!1:f?!!u.state.meta.annotationsPermissions?.dashboard.canEdit:!!u.state.meta.annotationsPermissions?.organization.canEdit},v.canDeleteAnnotations=f=>{const u=(0,c.YQ)(y);return!s.$.featureToggles.annotationPermissionUpdate&&!u.canEditDashboard()?!1:f?!!u.state.meta.annotationsPermissions?.dashboard.canDelete:!!u.state.meta.annotationsPermissions?.organization.canDelete},v.onAnnotationCreate=async f=>{const u=(0,c.YQ)(y),b=f.from!==f.to,E={dashboardUID:u.state.uid,panelId:(0,c.Cs)(y),isRegion:b,time:f.from,timeEnd:b?f.to:0,tags:f.tags,text:f.description};await(0,d.vJ)(E),h(u),v.eventBus.publish(new a.We(E))},v.onAnnotationUpdate=async f=>{const u=(0,c.YQ)(y),b=f.from!==f.to,E={id:f.id,dashboardUID:u.state.uid,panelId:(0,c.Cs)(y),isRegion:b,time:f.from,timeEnd:b?f.to:0,tags:f.tags,text:f.description};await(0,d.rJ)(E),h(u),v.eventBus.publish(new a.We(E))},v.onAnnotationDelete=async f=>{await(0,d.Xm)({id:f}),h((0,c.YQ)(y)),v.eventBus.publish(new a.We({id:f}))},v.onAddAdHocFilter=f=>{const u=(0,c.YQ)(y),b=(0,c.un)(y);if(!b)return;const E=r(u,b.state.datasource);g(E,f)},v.onUpdateData=f=>Promise.resolve(!0)}function p(y){const v=i.b4.getDataLayers(y);for(const x of v.state.annotationLayers)if(x instanceof o.tV.g&&x.state.isEnabled&&x.state.query.builtIn)return x}function h(y){const v=p(y);v&&v.runLayer()}function r(y,v){const x=o.jh.getVariables(y);for(const u of x.state.variables)if(o.Go.isAdHocVariable(u)){const b=u.state.datasource;if(b===v||b?.uid===v?.uid)return u}const f=new o.H9({name:"Filters",datasource:v,supportsMultiValueOperators:!!(0,l.l)().getInstanceSettings(v)?.meta.multiValueFilterOperators,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0});return x.setState({variables:[...x.state.variables,f]}),f}function g(y,v){const x=y.state.filters.findIndex(f=>f.key===v.key&&f.value===v.value&&f.operator!==v.operator);if(x>=0){const f=y.state.filters.slice();f.splice(x,1,v),y.updateFilters(f);return}y.updateFilters([...y.state.filters,v])}},3688:(Z,R,e)=>{"use strict";e.d(R,{y:()=>n});function n(a){return"isDashboardLayoutItem"in a}},39765:(Z,R,e)=>{"use strict";e.d(R,{d:()=>a});var n=e(68388);class a extends n.x{static{this.type="dashboard-repeats-processed"}}},15759:(Z,R,e)=>{"use strict";e.d(R,{l:()=>n});function n(a){return"switchLayout"in a}},84019:(Z,R,e)=>{"use strict";e.d(R,{V:()=>c,X:()=>i});var n=e(92745),a=e(43173),s=e(59857),l=e(78947),o=e(75735),d=e(28998);async function i(m){let p=s.Ye.templating?.list;if(a.$.featureToggles.newDashboardWithFiltersAndGroupBy){const r=await(0,d.tR)().get();if(r.getTagKeys){const g={type:r.meta.id,uid:r.uid},y={datasource:g,filters:[],name:"Filter",type:"adhoc"},v={datasource:g,name:"Group by",type:"groupby"};p=(p||[]).concat([y,v])}}const h={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...s.Ye,uid:"",title:(0,n.t)("dashboard-scene.build-new-dashboard-save-model.data.title.new-dashboard","New dashboard"),panels:[],timezone:a.$.bootData.user?.timezone||s.Ye.timezone}};return p&&(h.dashboard.templating={list:p}),m&&(h.meta.folderUid=m),h}async function c(m){let p=(0,l.xE)().variables;if(a.$.featureToggles.newDashboardWithFiltersAndGroupBy){const r=await(0,d.tR)().get();if(r.getTagKeys){const g={type:r.meta.id,uid:r.uid},y={kind:"AdhocVariable",spec:{...(0,l.IP)(),name:"Filter",datasource:g}},v={kind:"GroupByVariable",spec:{...(0,l.Bj)(),datasource:g,name:"Group by"}};p=(p||[]).concat([y,v])}}const h={apiVersion:"v2alpha1",kind:"DashboardWithAccessInfo",spec:{...(0,l.xE)(),title:(0,n.t)("dashboard-scene.build-new-dashboard-save-model-v2.data.title.new-dashboard","New dashboard"),timeSettings:{...(0,l.ft)(),timezone:a.$.bootData.user?.timezone||(0,l.ft)().timezone}},access:{canStar:!1,canShare:!1,canDelete:!1},metadata:{name:"",resourceVersion:"0",creationTimestamp:"0",annotations:{[o.ew]:""}}};return p&&(h.spec.variables=p),m&&h.metadata.annotations&&(h.metadata.annotations[o.ew]=m),h}},78320:(Z,R,e)=>{"use strict";e.d(R,{o:()=>a,x:()=>n});const n={name:"grafana",uid:"grafana"},a=1},39557:(Z,R,e)=>{"use strict";e.d(R,{B:()=>o});var n=e(74848),a=e(62467),s=e(81160),l=e(36674);class o extends l.n8{constructor(i){super({name:"",type:"snapshot",isReadOnly:!0,query:"",value:"",text:"",options:[],...i}),this._variableDependency=new l.Sh(this,{statePaths:[]})}getValueOptions(i){const p=(l.jh.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g)??[]).map(h=>{h=h.replace(/\\,/g,",");const r=/^(.+)\s:\s(.+)$/g.exec(h)??[];if(r.length===3){const[,g,y]=r;return{label:g.trim(),value:y.trim()}}else return{label:h.trim(),value:h.trim()}});return(0,a.of)(p)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,s.T)(i=>(this.state.options!==i&&this._updateValueGivenNewOptions(i),{})))}static{this.Component=({model:i})=>(0,n.jsx)(l.WY,{model:i})}_updateValueGivenNewOptions(i){const{value:c,text:m}=this.state,p={options:i,loading:!1,value:c??[],text:m??[]};this.setState(p)}}},99392:(Z,R,e)=>{"use strict";e.d(R,{O:()=>a});var n=e(36674);function a(s){const l=[];for(const o of s){if(!(o instanceof n.tV.g))continue;const d={...o.state.query,enable:!!o.state.isEnabled,hide:!!o.state.isHidden};l.push(d)}return l}},4974:(Z,R,e)=>{"use strict";e.d(R,{Dr:()=>p,K4:()=>c,i6:()=>g,zd:()=>m});var n=e(78947),a=e(25953),s=e(29425),l=e(8835),o=e(1682),d=e(8285),i=e(67350);function c(y){const{maxColumnCount:v,fillScreen:x,columnWidth:f,rowHeight:u,layout:b}=y.state,E=(0,n.kH)();return{kind:"AutoGridLayout",spec:{maxColumnCount:v,fillScreen:x===E.fillScreen?void 0:x,...h(f),...r(u),items:b.state.children.map(m)}}}function m(y){const x={kind:"AutoGridLayoutItem",spec:{element:{kind:"ElementReference",name:o.b4.getElementIdentifierForVizPanel(y.state?.body)}}},f=y.state.conditionalRendering?.serialize();return f?.spec.items.length&&(x.spec.conditionalRendering=f),y.state.variableName&&(x.spec.repeat={mode:"variable",value:y.state.variableName}),x}function p(y,v,x,f){if(y.kind!=="AutoGridLayout")throw new Error("Invalid layout kind");const u=(0,n.kH)(),{maxColumnCount:b,columnWidthMode:E,columnWidth:D,rowHeightMode:C,rowHeight:P,fillScreen:T}=y.spec,O=y.spec.items.map(W=>g(W,v,f)),I=E==="custom"?D:E,j=C==="custom"?P:C;return new l.X2({maxColumnCount:b,columnWidth:I,rowHeight:j,fillScreen:T??u.fillScreen,layout:new s.o({templateColumns:(0,l.Kf)(b??u.maxColumnCount,I??l.j),autoRows:(0,l.jo)(j??l.YL,T??!1),children:O})})}function h(y){return{columnWidthMode:typeof y=="number"?"custom":y,columnWidth:typeof y=="number"?y:void 0}}function r(y){return{rowHeightMode:typeof y=="number"?"custom":y,rowHeight:typeof y=="number"?y:void 0}}function g(y,v,x){const f=v[y.spec.element.name];if(!f)throw new Error(`Panel with uid ${y.spec.element.name} not found in the dashboard elements`);let u;return x&&(u=x()),new a.X({key:(0,d.ty)(u??f.spec.id),body:f.kind==="LibraryPanel"?(0,i.kB)(f,u):(0,i.Gl)(f,u),variableName:y.spec.repeat?.value,conditionalRendering:(0,i.Xy)(y)})}},17340:(Z,R,e)=>{"use strict";e.d(R,{SW:()=>c,i2:()=>h,v2:()=>m,ve:()=>v});var n=e(36674),a=e(73427),s=e(93389),l=e(1131),o=e(1682),d=e(8285),i=e(67350);function c(x,f){return{kind:"GridLayout",spec:{items:p(x,f)}}}function m(x,f,u,b){if(x.kind!=="GridLayout")throw new Error("Invalid layout kind");return new l.D({grid:new n.hy({isLazy:!(u||a.TP.user.authenticatedBy==="render"),children:g(x,f,b)})})}function p(x,f){let u=[];for(const b of x.state.grid.state.children)b instanceof s.U&&(b.state.variableName?u=u.concat(r(b,f)):u.push(h(b)));return u}function h(x,f){let u,b=0,E=0,D=0,C=0,P=x;if(!(P.state.body instanceof n.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");C=(P.state.variableName?P.state.itemHeight:P.state.height)??0,b=P.state.x??0,E=P.state.y??0,D=P.state.width??0;const T=P.state.variableName;let O=o.b4.getElementIdentifierForVizPanel(P.state.body);if(u={kind:"GridLayoutItem",spec:{x:b,y:f??E,width:D,height:C,element:{kind:"ElementReference",name:O}}},T){const I={mode:"variable",value:T};P.state.maxPerRow&&(I.maxPerRow=P.getMaxPerRow()),P.state.repeatDirection&&(I.direction=P.getRepeatDirection()),u.spec.repeat=I}if(!u)throw new Error("Unsupported grid item type");return u}function r(x,f=!1){if(f){if(x.state.body instanceof n.Eb&&(0,d.ME)(x.state.body))return[];if(x.state.repeatedPanels){const{h:u,w:b,columnCount:E}=(0,d.bR)(x);return x.state.repeatedPanels.map((C,P)=>{let T=0,O=0;x.state.repeatDirection==="v"?(T=x.state.x,O=P*u):(T=P%E*b,O=x.state.y+Math.floor(P/E)*u);const I={x:T,y:O,w:b,h:u};return{kind:"GridLayoutItem",spec:{x:I.x,y:I.y,width:I.w,height:I.h,repeat:{mode:"variable",value:x.state.variableName,maxPerRow:x.getMaxPerRow(),direction:x.state.repeatDirection},element:{kind:"ElementReference",name:C.state.key}}}})}return[]}else return[h(x)]}function g(x,f,u){return x.spec.items.map(E=>{if(E.kind==="GridLayoutItem")return v(E,f,u);throw new Error(`Unknown layout element kind: ${E.kind}`)})}function y(x,f,u,b){let E;return f.kind==="Panel"?E=(0,i.Gl)(f,b):E=(0,i.kB)(f,b),new s.U({key:`grid-item-${b??f.spec.id}`,x:x.x,y:u??x.y,width:x.repeat?.direction==="h"?24:x.width,height:x.height,itemHeight:x.height,body:E,variableName:x.repeat?.value,repeatDirection:x.repeat?.direction,maxPerRow:x.repeat?.maxPerRow})}function v(x,f,u){const b=f[x.spec.element.name];if(!b)throw new Error(`Panel with uid ${x.spec.element.name} not found in the dashboard elements`);let E;return u&&(E=u()),y(x.spec,b,void 0,E)}},76584:(Z,R,e)=>{"use strict";e.d(R,{HQ:()=>i,Vf:()=>c,aL:()=>d,g5:()=>m});var n=e(97335),a=e(97883),s=e(3371),l=e(59006),o=e(67350);function d(p){return{kind:"RowsLayout",spec:{rows:p.state.rows.filter(h=>!(0,s.Ry)(h.state.key)).map(i)}}}function i(p){const h=p.state.layout.serialize(),r={kind:"RowsLayoutRow",spec:{title:p.state.title,collapse:p.state.collapse,layout:h,fillScreen:p.state.fillScreen,hideHeader:p.state.hideHeader,...p.state.repeatByVariable&&{repeat:{mode:"variable",value:p.state.repeatByVariable}}}},g=p.state.conditionalRendering?.serialize();return g?.spec.items.length&&(r.spec.conditionalRendering=g),r}function c(p,h,r,g){if(p.kind!=="RowsLayout")throw new Error("Invalid layout kind");const y=p.spec.rows.map(v=>m(v,h,r,g));return new a.V({rows:y})}function m(p,h,r,g){const y=p.spec.layout;return new n.o({title:p.spec.title,collapse:p.spec.collapse,hideHeader:p.spec.hideHeader,fillScreen:p.spec.fillScreen,repeatByVariable:p.spec.repeat?.value,layout:l.j.get(y.kind).deserialize(y,h,r,g),conditionalRendering:(0,o.Xy)(p)})}},6461:(Z,R,e)=>{"use strict";e.d(R,{Yz:()=>c,lX:()=>i,wm:()=>m,zE:()=>p});var n=e(92769),a=e(34031),s=e(37365),l=e(3371),o=e(59006),d=e(67350);function i(h){return{kind:"TabsLayout",spec:{tabs:h.state.tabs.filter(r=>!(0,l.Ry)(r.state.key)).map(c)}}}function c(h){const r=h.state.layout.serialize(),g={kind:"TabsLayoutTab",spec:{title:h.state.title,layout:r}},y=h.state.conditionalRendering?.serialize();if(y?.spec.items.length&&(g.spec.conditionalRendering=y),h.state.$behaviors){for(const v of h.state.$behaviors)if(v instanceof a.T){if(g.spec.repeat)throw new Error("Multiple repeaters are not supported");g.spec.repeat={value:v.state.variableName,mode:"variable"}}}return g}function m(h,r,g,y){if(h.kind!=="TabsLayout")throw new Error("Invalid layout kind");const v=h.spec.tabs.map(x=>p(x,r,g,y));return new s.K({tabs:v})}function p(h,r,g,y){const v=h.spec.layout,x=h.spec.repeat?[new a.T({variableName:h.spec.repeat.value})]:void 0;return new n.V({title:h.spec.title,layout:o.j.get(v.kind).deserialize(v,r,g,y),$behaviors:x,conditionalRendering:(0,d.Xy)(h)})}},59006:(Z,R,e)=>{"use strict";e.d(R,{j:()=>d});var n=e(42954),a=e(4974),s=e(17340),l=e(76584),o=e(6461);const d=new n.O(()=>[{id:"GridLayout",name:"Grid Layout",deserialize:s.v2},{id:"AutoGridLayout",name:"Auto Grid Layout",deserialize:a.Dr},{id:"RowsLayout",name:"Rows Layout",deserialize:l.Vf},{id:"TabsLayout",name:"Tabs Layout",deserialize:o.wm}])},67350:(Z,R,e)=>{"use strict";e.d(R,{Gl:()=>u,IC:()=>W,Kq:()=>C,V6:()=>B,Xy:()=>j,kB:()=>b});var n=e(43173),a=e(36674),s=e(18615),l=e(57558),o=e(55793),d=e(84655),i=e(36605),c=e(7094),m=e(32540),p=e(37040),h=e(66251),r=e(81657),g=e(35718),y=e(8285),v=e(62265),x=e(3281),f=e(39508);function u(S,w){const N=[];N.push(new m.$({rawLinks:S.spec.links,menu:new m.m({$behaviors:[p.oV]})})),N.push(new h.W);const M=S.spec.data.spec.queryOptions,L=(M.timeFrom||M.timeShift)&&!M.hideTimeOverride,A={key:(0,y.XA)(w??S.spec.id),title:S.spec.title?.substring(0,5e3),description:S.spec.description,pluginId:S.spec.vizConfig.kind,options:S.spec.vizConfig.spec.options,fieldConfig:(0,x.So)(S.spec.vizConfig.spec.fieldConfig),pluginVersion:S.spec.vizConfig.spec.pluginVersion,displayMode:S.spec.transparent?"transparent":"default",hoverHeader:!S.spec.title&&!L,hoverHeaderOffset:0,seriesLimit:n.$.panelSeriesLimit,$data:E(S),titleItems:N,$behaviors:[],extendPanelContext:g.C};return n.$.publicDashboardAccessToken||(A.menu=new a.Lw({$behaviors:[p._i]})),(M.timeFrom||M.timeShift)&&(A.$timeRange=new r.v({timeFrom:M.timeFrom,timeShift:M.timeShift,hideTimeOverride:M.hideTimeOverride})),new a.Eb(A)}function b(S,w){const N=[];N.push(new m.$({rawLinks:[],menu:new m.m({$behaviors:[p.oV]})})),N.push(new h.W);const M={key:(0,y.XA)(w??S.spec.id),titleItems:N,seriesLimit:n.$.panelSeriesLimit,$behaviors:[new c.u({uid:S.spec.libraryPanel.uid,name:S.spec.libraryPanel.name})],extendPanelContext:g.C,pluginId:c.u.LOADING_VIZ_PANEL_PLUGIN_ID,title:S.spec.title,options:{},fieldConfig:{defaults:{},overrides:[]}};return n.$.publicDashboardAccessToken||(M.menu=new a.Lw({$behaviors:[p._i]})),new a.Eb(M)}function E(S){const w=S.spec,N=w.data?.spec.queries??[];if(!N?.length||n.$.panels[w.vizConfig.kind]?.skipDataQuery)return;let M;const L=D(S);return M=new a.dt({datasource:L,queries:N.map(O),maxDataPoints:w.data.spec.queryOptions.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:w.data.spec.queryOptions.cacheTimeout,queryCachingTTL:w.data.spec.queryOptions.queryCachingTTL,minInterval:w.data.spec.queryOptions.interval??void 0,dataLayerFilter:{panelId:w.id},$behaviors:[new i.L({})]}),new a.Es({$data:M,transformations:w.data.spec.transformations.map(A=>({...A.spec,topic:(0,f.MM)(A.spec.topic)}))})}function D(S){if(!S.spec.data?.spec.queries?.length)return;let w,N=!1;return S.spec.data.spec.queries.forEach(M=>{w?(w.uid!==M.spec.datasource?.uid||w.type!==M.spec.datasource?.type)&&(N=!0):M.spec.datasource?.uid?w=M.spec.datasource:w=P(M)}),N?{type:"mixed",uid:s.uv}:w}function C(S){return T(S.spec.datasource,S.spec.query.kind)}function P(S){return T(S.spec.datasource,S.spec.query.kind)}function T(S,w){if(S?.uid)return S;const N=n.$.bootData.settings.defaultDatasource,M=n.$.bootData.settings.datasources;if(M&&M[N]&&M[N].meta.id===w)return{uid:M[N].uid||M[N].name,type:M[N].meta.id};const L=M&&Object.values(M).find(A=>A.meta.id===w);if(L)return{uid:L.uid,type:L.meta.id};if(M&&M[N])return console.warn(`Could not find datasource for query kind ${w}, defaulting to ${M[N].meta.id}`),{uid:M[N].uid||M[N].name,type:M[N].meta.id}}function O(S){return{refId:S.spec.refId,datasource:P(S),hide:S.spec.hidden,...S.spec.query.spec}}function I(S){return S.serialize()}function j(S){if(!S.spec.conditionalRendering)return l.p.createEmpty();const w=d.k.get(S.spec.conditionalRendering.kind).deserialize(S.spec.conditionalRendering);if(w&&!(w instanceof o.M))throw new Error("Conditional rendering must always start with a root group");return new l.p({rootGroup:w})}function W(S,w){const N=S.getVizPanels(),M=w.serializer.getDSReferencesMapping(),L=N.map(A=>(0,v.GB)(A,M));return(0,v.Cy)(L,w)}function B(S,w){return(0,v.Cy)([(0,v.GB)(S.state.body,w.serializer.getDSReferencesMapping())],w)}},84500:(Z,R,e)=>{"use strict";e.d(R,{$o:()=>h,CN:()=>m,Gs:()=>r,Ru:()=>g});var n=e(43173),a=e(36674),s=e(59857),l=e(21275),o=e(78947),d=e(8285),i=e(62265),c=e(39508);function m(y,v){const x=[];for(const f of y.state.variables){const u={name:f.state.name,label:f.state.label,description:f.state.description??void 0,skipUrlSync:!!f.state.skipUrlSync,hide:f.state.hide||s.zL.dontHide,type:f.state.type};if(a.Go.isQueryVariable(f)){let b=[];((0,c.qJ)(f.state.refresh)==="never"||v)&&(b=p(f.state)),x.push({...u,current:{value:f.state.value,text:f.state.text},options:b,query:f.state.query,definition:f.state.definition,datasource:(0,i.AB)(y,f,"variable"),sort:f.state.sort,refresh:f.state.refresh,regex:f.state.regex,allValue:f.state.allValue,includeAll:f.state.includeAll,multi:f.state.isMulti,allowCustomValue:f.state.allowCustomValue,skipUrlSync:f.state.skipUrlSync})}else if(a.Go.isCustomVariable(f))x.push({...u,current:{text:f.state.value,value:f.state.value},options:p(f.state),query:f.state.query,multi:f.state.isMulti,allValue:f.state.allValue,includeAll:f.state.includeAll,allowCustomValue:f.state.allowCustomValue});else if(a.Go.isDataSourceVariable(f))x.push({...u,current:{value:f.state.value,text:f.state.text},options:[],regex:f.state.regex,refresh:l.CO.onDashboardLoad,query:f.state.pluginId,multi:f.state.isMulti,allValue:f.state.allValue,includeAll:f.state.includeAll,allowCustomValue:f.state.allowCustomValue});else if(a.Go.isConstantVariable(f))x.push({...u,current:{value:f.state.value,text:f.state.value},query:f.state.value,hide:s.zL.hideVariable});else if(a.Go.isIntervalVariable(f)){const b=(0,d.bx)(f.state.intervals);x.push({...u,current:{text:f.state.value,value:f.state.value},query:b,refresh:f.state.refresh,options:f.state.intervals.map(E=>({value:E,text:E,selected:E===f.state.value})),auto:f.state.autoEnabled,auto_min:f.state.autoMinInterval,auto_count:f.state.autoStepCount})}else if(a.Go.isTextBoxVariable(f)){const b={text:f.state.value,value:f.state.value};x.push({...u,current:b,options:[{...b,selected:!0}],query:f.state.value})}else if(a.Go.isGroupByVariable(f)&&n.$.featureToggles.groupByVariable){const b=f.state.defaultValue?{value:f.state.defaultValue.value,text:f.state.defaultValue.text}:void 0;x.push({...u,datasource:f.state.datasource,options:f.state.defaultOptions?.map(E=>({text:E.text,value:String(E.value)})),current:{text:f.state.text,value:f.state.value},defaultValue:b,allowCustomValue:f.state.allowCustomValue})}else if(a.Go.isAdHocVariable(f))x.push({...u,datasource:f.state.datasource,allowCustomValue:f.state.allowCustomValue,baseFilters:f.state.baseFilters||[],filters:[...r(f.state.originFilters),...f.state.filters],defaultKeys:f.state.defaultKeys});else if(f.state.type!=="system")throw new Error("Unsupported variable type")}for(const f of x)f.hide===s.zL.dontHide&&delete f.hide,f.skipUrlSync||delete f.skipUrlSync,f.label===""&&delete f.label,f.multi||delete f.multi,f.sort===l.ZG.disabled&&delete f.sort;return x}function p(y){return y.options.map(v=>({value:String(v.value),text:v.label,selected:Array.isArray(y.value)?y.value.includes(v.value):y.value===v.value}))}function h(y,v,x){let f=[];for(const u of y.state.variables){const b={name:u.state.name,label:u.state.label,description:u.state.description??void 0,skipUrlSync:!!u.state.skipUrlSync,hide:(0,c.NB)(u.state.hide)||(0,o.SR)()},E={value:u.state.value,text:u.state.text};let D=[];if(a.Go.isQueryVariable(u)){((0,c.qJ)(u.state.refresh)==="never"||v)&&(D=p(u.state));const C=u.state.query;let P;typeof C!="string"?P={kind:u.state.datasource?.type??(0,i.lD)(C),spec:(0,i.c8)(C)}:P={kind:u.state.datasource?.type??(0,i.lD)(C),spec:{[c.sB]:C}};const T={kind:"QueryVariable",spec:{...b,current:E,options:D,query:P,definition:u.state.definition,datasource:(0,i.AB)(y,u,"variable",void 0,x),sort:(0,c.LY)(u.state.sort),refresh:(0,c.qJ)(u.state.refresh),regex:u.state.regex,allValue:u.state.allValue,includeAll:u.state.includeAll||!1,multi:u.state.isMulti||!1,skipUrlSync:u.state.skipUrlSync||!1,allowCustomValue:u.state.allowCustomValue??!0}};f.push(T)}else if(a.Go.isCustomVariable(u)){D=p(u.state);const C={kind:"CustomVariable",spec:{...b,current:E,options:D,query:u.state.query,multi:u.state.isMulti||!1,allValue:u.state.allValue,includeAll:u.state.includeAll??!1,allowCustomValue:u.state.allowCustomValue??!0}};f.push(C)}else if(a.Go.isDataSourceVariable(u)){const C={kind:"DatasourceVariable",spec:{...b,current:E,options:[],regex:u.state.regex,refresh:"onDashboardLoad",pluginId:u.state.pluginId,multi:u.state.isMulti||!1,includeAll:u.state.includeAll||!1,allowCustomValue:u.state.allowCustomValue??!0}};u.state.allValue!==void 0&&(C.spec.allValue=u.state.allValue),f.push(C)}else if(a.Go.isConstantVariable(u)){const C={kind:"ConstantVariable",spec:{...b,current:{...E,text:String(u.state.value)},query:u.state.value}};f.push(C)}else if(a.Go.isIntervalVariable(u)){const C=(0,d.bx)(u.state.intervals),P={kind:"IntervalVariable",spec:{...b,current:{...E,text:u.state.value},query:C,refresh:"onTimeRangeChanged",options:u.state.intervals.map(T=>({value:T,text:T,selected:T===u.state.value})),auto:u.state.autoEnabled,auto_min:u.state.autoMinInterval,auto_count:u.state.autoStepCount}};f.push(P)}else if(a.Go.isTextBoxVariable(u)){const C={text:u.state.value,value:u.state.value},P={kind:"TextVariable",spec:{...b,current:C,query:u.state.value}};f.push(P)}else if(a.Go.isGroupByVariable(u)&&n.$.featureToggles.groupByVariable){D=p(u.state);const C=u.state.defaultValue?{value:u.state.defaultValue.value,text:u.state.defaultValue.text}:void 0,P={kind:"GroupByVariable",spec:{...b,datasource:u.state.datasource||{},options:u.state.defaultOptions?.map(T=>({text:T.text,value:String(T.value)}))||[],current:E,defaultValue:C,multi:u.state.isMulti||!1}};f.push(P)}else if(a.Go.isAdHocVariable(u)){const C={kind:"AdhocVariable",spec:{...b,name:u.state.name,datasource:u.state.datasource||{},baseFilters:r(u.state.baseFilters)||[],filters:[...r(u.state.originFilters),...r(u.state.filters)],defaultKeys:u.state.defaultKeys||[],allowCustomValue:u.state.allowCustomValue??!0}};f.push(C)}else if(u.state.type!=="system")throw new Error("Unsupported variable type: "+u.state.type)}return f}function r(y){return y?.filter(v=>!v.origin||v.origin==="dashboard")||[]}function g(y){return y.state.type!=="system"}},31119:(Z,R,e)=>{"use strict";e.d(R,{dj:()=>T});var n=e(2543),a=e.n(n),s=e(43173),l=e(78282),o=e(36674),d=e(78947),i=e(8255),c=e(75735),m=e(11968),p=e(49e3),h=e(79595),r=e(88632),g=e(88499),y=e(44804),v=e(72746),x=e(8285),f=e(39557),u=e(59006),b=e(67350),E=e(9683),D=e(3281),C=e(39508);const P="default";function T(A){const{spec:U,metadata:F,apiVersion:V}=A,K=L(U);K&&U.annotations.unshift(K);const G=U.annotations.map(X=>{let Q=X.spec;return Q?.legacyOptions&&(Q={...Q,...Q.legacyOptions}),new p.g({key:(0,n.uniqueId)("annotations-"),query:{...Q,builtIn:X.spec.builtIn?1:0},name:X.spec.name,isEnabled:!!X.spec.enable,isHidden:!!X.spec.hide})}),H=!!U.editable,_=A.access.canSave!==!1;let k;F.labels?.[c.Y5]&&(k=parseInt(F.labels[c.Y5],10));const J={canShare:A.access.canShare!==!1,canSave:_,canStar:A.access.canStar!==!1,canEdit:A.access.canEdit!==!1,canDelete:A.access.canDelete!==!1,canAdmin:A.access.canAdmin!==!1,url:A.access.url,slug:A.access.slug,annotationsPermissions:A.access.annotationsPermissions,created:F.creationTimestamp,createdBy:F.annotations?.[c.hc],updated:F.annotations?.[c.xU],updatedBy:F.annotations?.[c.Qu],folderUid:F.annotations?.[c.ew],isSnapshot:!!F.annotations?.[c.qw],showSettings:!!A.access.canEdit,canMakeEditable:_&&!H,hasUnsavedFolderChange:!1,version:F.generation,k8s:F};H||(J.canEdit=!1,J.canDelete=!1,J.canSave=!1);const z=u.j.get(U.layout.kind).deserialize(U.layout,U.elements,U.preload),Y=new v.H$({description:U.description,editable:U.editable,preload:U.preload,id:k,isDirty:!1,links:U.links,meta:J,tags:U.tags,title:U.title,uid:F.name,version:F.generation,body:z,$timeRange:new o.JZ({from:U.timeSettings.from,to:U.timeSettings.to,fiscalYearStartMonth:U.timeSettings.fiscalYearStartMonth,timeZone:U.timeSettings.timezone,weekStart:U.timeSettings.weekStart,UNSAFE_nowDelay:U.timeSettings.nowDelay}),$variables:O(U,J.isSnapshot??!1),$behaviors:[new o.Gg.K2({sync:(0,D.Y_)(U.cursorSync)}),new o.Gg.Hf,g.M,E.A2,new o.Gg.en({enabled:U.liveNow}),m.U,new y.s({reloadOnParamsChange:s.$.featureToggles.reloadDashboardsOnParamsChange&&!1,uid:k?.toString()})],$data:new r.s({annotationLayers:G}),controls:new h.x({timePicker:new o.KE({quickRanges:U.timeSettings.quickRanges,defaultQuickRanges:s.$.quickRanges}),refreshPicker:new o.WM({refresh:U.timeSettings.autoRefresh,intervals:U.timeSettings.autoRefreshIntervals,withText:!0}),hideTimeControls:U.timeSettings.hideTimepicker})},"v2");return Y.setInitialSaveModel(A.spec,A.metadata,V),Y}function O(A,U){let F;return U?F=S(A):F=I(A),F}function I(A){const U=A.variables.map(F=>{try{return j(F)}catch(V){return console.error(V),null}}).filter(F=>!!F);return s.$.featureToggles.scopeFilters&&U.push(new o.Kg({enable:!0})),new o.Pj({variables:U})}function j(A){const U={name:A.spec.name,label:A.spec.label,description:A.spec.description};if(A.kind===(0,d.l_)().kind)return new o.H9({...U,description:A.spec.description,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide),datasource:A.spec.datasource,applyMode:"auto",filters:A.spec.filters??[],baseFilters:A.spec.baseFilters??[],defaultKeys:A.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,l.l)().getInstanceSettings(A.spec.datasource)?.meta.multiValueFilterOperators});if(A.kind===(0,d.ns)().kind)return new o.yP({...U,value:A.spec.current?.value??"",text:A.spec.current?.text??"",query:A.spec.query,isMulti:A.spec.multi,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)});if(A.kind===(0,d.m6)().kind)return new o.fS({...U,value:A.spec.current?.value??"",text:A.spec.current?.text??"",query:W(A),datasource:(0,b.Kq)(A),sort:(0,D.ES)(A.spec.sort),refresh:(0,D.tH)(A.spec.refresh),regex:A.spec.regex,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,isMulti:A.spec.multi,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide),definition:A.spec.definition});if(A.kind===(0,d.X1)().kind)return new o.mI({...U,value:A.spec.current?.value??"",text:A.spec.current?.text??"",regex:A.spec.regex,pluginId:A.spec.pluginId,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,skipUrlSync:A.spec.skipUrlSync,isMulti:A.spec.multi,hide:(0,D.cc)(A.spec.hide),defaultOptionEnabled:A.spec.current?.value===P&&A.spec.current?.text==="default"});if(A.kind===(0,d.pK)().kind){const F=(0,x.Sm)(A.spec.query),V=B(A,F);return new o.Yj({...U,value:V,intervals:F,autoEnabled:A.spec.auto,autoStepCount:A.spec.auto_count,autoMinInterval:A.spec.auto_min,refresh:(0,D.tH)(A.spec.refresh),skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)})}else{if(A.kind===(0,d.ET)().kind)return new o.x0({...U,value:A.spec.query,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)});if(A.kind===(0,d.t1)().kind){let F;return A?.spec.current?.value?typeof A.spec.current.value=="string"?F=A.spec.current.value:F=A.spec.current.value[0]:F=A.spec.query,new o.TS({...U,value:F,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)})}else{if(s.$.featureToggles.groupByVariable&&A.kind===(0,d.uB)().kind)return new o.ZG({...U,datasource:A.spec.datasource,value:A.spec.current?.value||[],text:A.spec.current?.text||[],skipUrlSync:A.spec.skipUrlSync,isMulti:A.spec.multi,hide:(0,D.cc)(A.spec.hide),defaultOptions:A.options});throw new Error(`Scenes: Unsupported variable type ${A.kind}`)}}}function W(A){return C.sB in A.spec.query.spec?A.spec.query.spec[C.sB]??"":{...A.spec.query.spec,refId:A.spec.query.spec.refId??"A"}}function B(A,U){const F=Array.isArray(A.spec.current.value)?A.spec.current.value[0]:A.spec.current.value;return F.startsWith("$__auto_interval_")?"$__auto":U.includes(F)?F:U[0]}function S(A){const U=A.variables.map(F=>{try{return F.kind==="AdhocVariable"?new o.H9({name:F.spec.name,label:F.spec.label,readOnly:!0,description:F.spec.description,skipUrlSync:F.spec.skipUrlSync,hide:(0,D.cc)(F.spec.hide),datasource:F.spec.datasource,applyMode:"auto",filters:F.spec.filters??[],baseFilters:F.spec.baseFilters??[],defaultKeys:F.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,l.l)().getInstanceSettings(F.spec.datasource)?.meta.multiValueFilterOperators}):w(F)}catch(V){return console.error(V),null}}).filter(F=>!!F);return new o.Pj({variables:U})}function w(A){let U,F;if(A.kind==="IntervalVariable"){const V=(0,x.Sm)(A.spec.query),K=B(A,V);return U=new f.B({name:A.spec.name,label:A.spec.label,description:A.spec.description,value:K,text:K,hide:(0,D.cc)(A.spec.hide)}),U}return A.kind==="ConstantVariable"||A.kind==="AdhocVariable"?F={value:"",text:""}:F={value:A.spec.current?.value??"",text:A.spec.current?.text??""},U=new f.B({name:A.spec.name,label:A.spec.label,description:A.spec.description,value:F?.value??"",text:F?.text??"",hide:(0,D.cc)(A.spec.hide)}),U}function N(A,U){return A.elements[U].kind==="Panel"?A.elements[U]:void 0}function M(A,U){return A.elements[U].kind==="LibraryPanel"?A.elements[U]:void 0}function L(A){return A.annotations.some(V=>V.spec.builtIn)?void 0:{kind:"AnnotationQuery",spec:{datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",iconColor:i.Mk,enable:!0,hide:!0,builtIn:!0}}}},9683:(Z,R,e)=>{"use strict";e.d(R,{tt:()=>k,EH:()=>_,A2:()=>J,wM:()=>F});var n=e(2543),a=e(43173),s=e(27489),l=e(25992),o=e(36674),d=e(5857),i=e(73427),c=e(45173),m=e(7817),p=e(82612),h=e(11968),r=e(7498),g=e(49e3),y=e(79595),v=e(88632),x=e(88499),f=e(44804),u=e(72746),b=e(7094),E=e(32540),D=e(37040),C=e(66251),P=e(81657),T=e(93389),O=e(1131),I=e(87308),j=e(18178),W=e(97335),B=e(97883),S=e(35718),w=e(18789),N=e(23289),M=e(8285),L=e(55211);function A(Q){return function(te,ne){if(ne.angularPanelCtrl){te.options={angularOptions:Q.getOptionsToRemember()};return}if(!Q.options||Object.keys(Q.options).length===0){(0,n.defaults)(te,Q.getOptionsToRemember());const se=(0,n.cloneDeep)(Q.targets);Object.defineProperty(te,"targets",{get:function(){return console.warn("Accessing the targets property when migrating a panel plugin is deprecated. Changes to this property will be ignored."),se}})}if(Q.autoMigrateFrom){const se=p.NB[Q.autoMigrateFrom]!=null,ue=Q.getOptionsToRemember(),de=Q.autoMigrateFrom;if(ne.onPanelTypeChanged){const ie=se?{angular:ue}:ue.options;Object.assign(te.options,ne.onPanelTypeChanged(te,de,ie,te.fieldConfig))}}}}var U=e(78320);function F(Q){const q=new m.G(Q.dashboard,Q.meta),te=_(q,Q.dashboard),ne=a.$.featureToggles.kubernetesDashboards?`${c._.group}/${c._.version}`:void 0;return te.setInitialSaveModel(Q.dashboard,Q.meta,ne),te}function V(Q){const q=[];let te=null,ne=[];for(const se of Q)se.type==="row"?!te&&ne.length===0?te=se:te?(q.push(H(te,ne)),ne=[],te=se):(q.push(new W.o({title:"",collapse:se.collapsed,layout:new O.D({grid:new o.hy({children:ne})}),hideHeader:!0,$behaviors:[]})),ne=[],te=se):ne.push(k(se));return te&&q.push(H(te,ne)),new B.V({rows:q})}function K(Q){const q=[];let te=null,ne=[];for(const se of Q)if(se.type==="row")te?te.id!==se.id&&(q.push(G(te,ne)),se.collapsed?(q.push(G(se,[])),te=null):te=se,ne=[]):se.collapsed?q.push(G(se,[])):te=se;else{se.snapshotData&&Y(se);const ue=k(se);te?ne.push(ue):q.push(ue)}return te&&q.push(G(te,ne)),q}function G(Q,q){Q.collapsed&&Q.panels&&(q=Q.panels.map(se=>(se instanceof p.a9||(se=new p.a9(se)),k(se))));let te,ne=q;return Q.repeat&&(te=[new I.L({variableName:Q.repeat})]),new o.tI({key:(0,M.XA)(Q.id),title:Q.title,y:Q.gridPos.y,isCollapsed:Q.collapsed,children:ne,$behaviors:te,actions:new j.u({})})}function H(Q,q){return new W.o({key:(0,M.XA)(Q.id),title:Q.title,collapse:Q.collapsed,layout:new O.D({grid:new o.hy({children:(Q.panels?.map(ne=>k(ne))??[]).concat(q)})}),repeatByVariable:Q.repeat})}function _(Q,q){let te,ne=[],se;const ue=Q.uid,de=a.$.featureToggles.dashboardNewLayouts?"v2":"v1";Q.meta.isSnapshot?te=(0,L.HN)(Q):te=(0,L.bc)(Q),Q.annotations?.list?.length&&!Q.isSnapshot()&&(ne=Q.annotations?.list.map(Ie=>new g.g({key:(0,n.uniqueId)("annotations-"),query:Ie,name:Ie.name,isEnabled:!!Ie.enable,isHidden:!!Ie.hide})));let ie=a.$.unifiedAlertingEnabled;ie||Q.panels.find(Ie=>!!Ie.alert)&&(ie=!0),ie&&(se=new r.C({key:"alert-states",name:"Alert States"}));const he=a.$.featureToggles.scopeFilters&&Q.scopeMeta?{trait:Q.scopeMeta.trait,groups:Q.scopeMeta.groups}:void 0,me=[new o.Gg.K2({sync:Q.graphTooltip}),new o.Gg.Hf({enableProfiling:a.$.dashboardPerformanceMetrics.findIndex(Ie=>Ie==="*"||Ie===Q.uid)!==-1,onProfileComplete:X(Q.uid,Q.title)}),x.M,J,new o.Gg.en({enabled:Q.liveNow}),h.U,new f.s({reloadOnParamsChange:a.$.featureToggles.reloadDashboardsOnParamsChange&&Q.meta.reloadOnParamsChange,uid:ue})];let ce;return a.$.featureToggles.dashboardNewLayouts&&Q.panels.some(Ie=>Ie.type==="row")?ce=V(Q.panels):ce=new O.D({grid:new o.hy({isLazy:!(q.preload||i.TP.user.authenticatedBy==="render"),children:K(Q.panels)})}),new u.H$({uid:ue,description:Q.description,editable:Q.editable,preload:q.preload??!1,id:Q.id,isDirty:!1,links:Q.links||[],meta:Q.meta,tags:Q.tags||[],title:Q.title,version:Q.version,scopeMeta:he,body:ce,$timeRange:new o.JZ({from:Q.time.from,to:Q.time.to,fiscalYearStartMonth:Q.fiscalYearStartMonth,timeZone:Q.timezone,weekStart:(0,d.rE)(Q.weekStart)?Q.weekStart:void 0,UNSAFE_nowDelay:Q.timepicker?.nowDelay}),$variables:te,$behaviors:me,$data:new v.s({annotationLayers:ne,alertStatesLayer:se}),controls:new y.x({timePicker:new o.KE({quickRanges:Q.timepicker.quick_ranges,defaultQuickRanges:a.$.quickRanges}),refreshPicker:new o.WM({refresh:Q.refresh,intervals:Q.timepicker.refresh_intervals,withText:!0}),hideTimeControls:Q.timepicker.hidden})},de)}function k(Q){const q=Q.repeat?{variableName:Q.repeat,repeatDirection:Q.repeatDirection==="v"?"v":"h"}:{},te=[];te.push(new E.$({rawLinks:Q.links,menu:new E.m({$behaviors:[D.oV]})})),te.push(new C.W);const ne=(Q.timeFrom||Q.timeShift)&&!Q.hideTimeOverride,se={key:(0,M.XA)(Q.id),title:Q.title?.substring(0,5e3),description:Q.description,pluginId:Q.type??"timeseries",options:Q.options??{},fieldConfig:Q.fieldConfig,pluginVersion:Q.pluginVersion,seriesLimit:a.$.panelSeriesLimit,displayMode:Q.transparent?"transparent":void 0,hoverHeader:!Q.title&&!ne,hoverHeaderOffset:0,$data:(0,w.w)(Q),titleItems:te,$behaviors:[],extendPanelContext:S.C,_UNSAFE_customMigrationHandler:A(Q)};Q.libraryPanel&&(se.$behaviors.push(new b.u({uid:Q.libraryPanel.uid,name:Q.libraryPanel.name})),se.pluginId=b.u.LOADING_VIZ_PANEL_PLUGIN_ID,se.$data=void 0),a.$.publicDashboardAccessToken||(se.menu=new o.Lw({$behaviors:[D._i]})),(Q.timeFrom||Q.timeShift)&&(se.$timeRange=new P.v({timeFrom:Q.timeFrom,timeShift:Q.timeShift,hideTimeOverride:Q.hideTimeOverride}));const ue=new o.Eb(se);return new T.U({key:`grid-item-${Q.id}`,x:Q.gridPos.x,y:Q.gridPos.y,width:q.repeatDirection==="h"?24:Q.gridPos.w,height:Q.gridPos.h,itemHeight:Q.gridPos.h,body:ue,maxPerRow:Q.maxPerRow,...q})}function J(Q){Q.subscribeToEvent(o.Kw,q=>{const{interaction:te}=q.payload;switch(te){case"panel-status-message-clicked":N.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":N.c.panelCancelQueryClicked();break}})}const z=Q=>Q.map(q=>({data:{values:q.fields.map(te=>te.values).filter(te=>te!==void 0)},schema:{fields:q.fields.map(te=>({name:te.name,type:te.type,config:te.config}))}})),Y=Q=>{Q.snapshotData&&(Q.datasource=U.x,Q.targets=[{refId:Q.snapshotData[0]?.refId??"",datasource:Q.datasource,queryType:"snapshot",snapshot:z(Q.snapshotData)}],Q.snapshotData=[])};function X(Q,q){return te=>{let ne="";te.origin==="SceneTimeRange"?ne="time-range-change":te.origin==="SceneRefreshPicker"?ne="refresh":te.origin==="DashboardScene"?ne="view":te.origin.indexOf("Variable")>-1&&(ne="variable-change"),(0,s.rR)("dashboard-render",{interactionType:ne,duration:te.duration,networkDuration:te.networkDuration,totalJSHeapSize:te.totalJSHeapSize,usedJSHeapSize:te.usedJSHeapSize,jsHeapSizeLimit:te.jsHeapSizeLimit}),(0,l.l$)(`dashboard.${ne}`,{duration:te.duration,networkDuration:te.networkDuration,totalJSHeapSize:te.totalJSHeapSize,usedJSHeapSize:te.usedJSHeapSize,jsHeapSizeLimit:te.jsHeapSizeLimit,timeSinceBoot:performance.measure("time_since_boot","frontend_boot_js_done_time_seconds").duration},{dashboard:Q,title:q})}}},70030:(Z,R,e)=>{"use strict";e.d(R,{Uy:()=>C,Z6:()=>T,ZB:()=>P,c:()=>W});var n=e(2543),a=e.n(n),s=e(3594),l=e(36674),o=e(59857),d=e(21275),i=e(10605),c=e(98314),m=e(65635),p=e(8095),h=e(88632),r=e(81657),g=e(93389),y=e(1131),v=e(87308),x=e(3371),f=e(1682),u=e(8285),b=e(78320),E=e(99392),D=e(84500);function C(S,w=!1){const N=S.state,M=N.$timeRange.state,L=N.$data,A=N.$variables,U=N.body;let F=[],V=[];if(U instanceof y.D){for(const Y of U.state.grid.state.children)if(Y instanceof g.U&&(Y.state.variableName?F=F.concat(I(Y,w)):F.push(P(Y,w))),Y instanceof l.tI){if((0,x.Ry)(Y.state.key)&&!w)continue;j(Y,F,w)}}let K=[];L instanceof h.s&&(K=(0,E.O)(L.state.annotationLayers)),A instanceof l.Pj&&(V=(0,D.CN)(A));const G=N.controls?.state,H=G?.refreshPicker,_=B({refresh_intervals:H?.state.intervals,hidden:G?.hideTimeControls,nowDelay:M.UNSAFE_nowDelay,quick_ranges:G?.timePicker.state.quickRanges},o.lt),k=N.$behaviors?.find(Y=>Y instanceof l.Gg.K2)?.state.sync??o.Ye.graphTooltip,J=N.$behaviors?.find(Y=>Y instanceof l.Gg.en)?.isEnabled||void 0,z={...o.Ye,title:N.title,description:N.description||void 0,uid:N.uid,id:N.id,editable:N.editable,preload:N.preload,time:{from:M.from,to:M.to},timepicker:_,panels:F,annotations:{list:K},templating:{list:V},version:N.version,timezone:M.timeZone,fiscalYearStartMonth:M.fiscalYearStartMonth,weekStart:M.weekStart,tags:N.tags,links:N.links,graphTooltip:k,liveNow:J,schemaVersion:m.O2,refresh:H?.state.refresh,scopeMeta:N.scopeMeta};return(0,i.v)(z,!0)}function P(S,w=!1){let N,M=0,L=0,A=0,U=0,F=S;if(!(F.state.body instanceof l.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(N=F.state.body,M=F.state.x??0,L=F.state.y??0,A=F.state.width??0,U=(F.state.variableName?F.state.itemHeight:F.state.height)??0,!N)throw new Error("Unsupported grid item type");return T(N,{x:M,y:L,h:U,w:A},w,F)}function T(S,w,N=!1,M){let L;if((0,u.ME)(S)){const F=(0,u.iL)(S);return L={id:(0,u.Cs)(S),title:S.state.title,gridPos:w,libraryPanel:{name:F.state.name,uid:F.state.uid},type:"library-panel-ref"},L}else L={id:(0,u.Cs)(S),type:S.state.pluginId,title:S.state.title,description:S.state.description??void 0,gridPos:w,fieldConfig:S.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:S.state.displayMode==="transparent",pluginVersion:S.state.pluginVersion,...O(S,N)};if(S.state.options){const{angularOptions:F,...V}=S.state.options;L.options=V,F&&(0,n.defaults)(L,F)}const A=S.state.$timeRange;A instanceof r.v&&(L.timeFrom=A.state.timeFrom,L.timeShift=A.state.timeShift,L.hideTimeOverride=A.state.hideTimeOverride),M instanceof g.U&&(M.state.variableName&&(L.repeat=M.state.variableName),M.state.maxPerRow&&(L.maxPerRow=M.state.maxPerRow),M.state.repeatDirection&&(L.repeatDirection=M.getRepeatDirection()));const U=f.b4.getPanelLinks(S);return L.links=U?.state.rawLinks??[],L.links.length===0&&delete L.links,L.transformations?.length===0&&delete L.transformations,L.transparent||delete L.transparent,L}function O(S,w=!1){const N=S.state.$data,M={},L=(0,u.un)(S);if(L&&(M.targets=L.state.queries,M.maxDataPoints=L.state.maxDataPoints,M.datasource=L.state.datasource,L.state.cacheTimeout&&(M.cacheTimeout=L.state.cacheTimeout),L.state.queryCachingTTL&&(M.queryCachingTTL=L.state.queryCachingTTL),L.state.minInterval&&(M.interval=L.state.minInterval)),N instanceof l.Es&&(M.transformations=N.state.transformations),N&&w){M.datasource=b.x;let A=(0,c.B6)(N.state.data);N instanceof l.Es&&(A=(0,c.B6)(N.state.$data.state.data)),M.targets=[{refId:"A",datasource:M.datasource,queryType:p.nj.Snapshot,snapshot:A}]}return M}function I(S,w=!1){if(w){if(S.state.body instanceof l.Eb&&(0,u.ME)(S.state.body)){const{x:N=0,y:M=0,width:L=0,height:A=0}=S.state;return[T(S.state.body,{x:N,y:M,w:L,h:A},w)]}if(S.state.repeatedPanels){const{h:N,w:M,columnCount:L}=(0,u.bR)(S);return S.state.repeatedPanels.map((U,F)=>{let V=0,K=0;S.state.repeatDirection==="v"?(V=S.state.x,K=F*N):(V=F%L*M,K=S.state.y+Math.floor(F/L)*N);const G={x:V,y:K,w:M,h:N},H=U.state.$variables.getByName(S.state.variableName);return{id:(0,u.Cs)(U),type:U.state.pluginId,title:U.state.title,gridPos:G,options:U.state.options,fieldConfig:U.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:U.state.displayMode==="transparent",scopedVars:{[S.state.variableName]:{text:H?.state.text,value:H?.state.value}},...O(U,w)}})}return[]}else return[P(S)]}function j(S,w,N=!1){const M=!!S.state.isCollapsed,L={type:"row",id:(0,u.Cs)(S),title:S.state.title,gridPos:{x:S.state.x??0,y:S.state.y??0,w:S.state.width??24,h:S.state.height??1},collapsed:M,panels:[]};if(S.state.$behaviors?.length){const U=S.state.$behaviors[0];U instanceof v.L&&(L.repeat=U.state.variableName)}if(N&&S.state.$variables){const F=S.state.$variables.state.variables.reduce((V,K)=>({...V,[K.state.name]:{text:K.state.text,value:K.state.value}}),{});L.scopedVars=F}w.push(L);let A=[];N?S.state.children.forEach(U=>{U instanceof g.U&&(U.state.variableName?A=A.concat(I(U,!M)):A.push(P(U,!M)))}):A=S.state.children.map(U=>{if(!(U instanceof g.U))throw new Error("Row child expected to be DashboardGridItem");return P(U)}),S.state.isCollapsed?L.panels=A:w.push(...A)}function W(S,w,N,M){let L={...N,title:S,time:{from:w.from.toISOString(),to:w.to.toISOString()},links:[]};if(M){const A=N.panels?.find(U=>U.id===(0,u.Cs)(M));A&&(A.gridPos={w:24,x:0,y:0,h:20},L={...L,panels:[A]})}if(L.panels?.forEach(A=>{"links"in A&&(A.links=[])}),L.annotations){const U=(L.annotations.list?.filter(F=>F.enable)||[]).map(F=>({name:F.name,enable:F.enable,iconColor:F.iconColor,type:F.type,builtIn:F.builtIn,hide:F.hide,snapshotData:[]}));L.annotations.list=U}return L.templating&&L.templating.list?.forEach(A=>{"query"in A&&(A.query=""),"options"in A&&(A.options=A.current&&!(0,s.R)(A.current)?[A.current]:[]),"refresh"in A&&(A.refresh=d.CO.never)}),L}function B(S,w){const N={...S};for(const M in w)(0,n.isEqual)(N[M],w[M])&&delete N[M];return N}},62265:(Z,R,e)=>{"use strict";e.d(R,{AB:()=>G,Cy:()=>T,GB:()=>f,Ic:()=>W,Xl:()=>g,c8:()=>D,lD:()=>E});var n=e(2543),a=e.n(n),s=e(43173),l=e(36674),o=e(10605),d=e(78947),i=e(88632),c=e(81657),m=e(1682),p=e(8285),h=e(84500),r=e(39508);function g(H,_=!1){const k=H.state,J=k.$timeRange.state,z=k.controls?.state,Y=z?.refreshPicker,X=H.serializer.getDSReferencesMapping(),Q={title:k.title,description:k.description,cursorSync:y(k),liveNow:v(k),preload:k.preload??(0,d.xE)().preload,editable:k.editable??(0,d.xE)().editable,links:k.links??(0,d.xE)().links,tags:k.tags??(0,d.xE)().tags,timeSettings:{timezone:J.timeZone,from:J.from,to:J.to,autoRefresh:Y?.state.refresh||"",autoRefreshIntervals:Y?.state.intervals,hideTimepicker:z?.hideTimeControls??!1,weekStart:J.weekStart,fiscalYearStartMonth:J.fiscalYearStartMonth,nowDelay:J.UNSAFE_nowDelay,quickRanges:z?.timePicker.state.quickRanges},variables:O(k,X),elements:x(H,X),annotations:I(k,X),layout:k.body.serialize()};try{if(B(Q))return(0,o.v)(Q,!0);throw new Error("Error we could transform the dashboard to schema v2: "+Q)}catch(q){throw console.error("Error transforming dashboard to schema v2: "+q,Q),new Error("Error transforming dashboard to schema v2: "+q)}}function y(H){const _=H.$behaviors?.find(k=>k instanceof l.Gg.K2)?.state.sync;return(0,r.k6)(_)}function v(H){const _=H.$behaviors?.find(k=>k instanceof l.Gg.en)?.isEnabled||void 0;return _===void 0?!!(0,d.xE)().liveNow:!!_}function x(H,_){const J=(H.state.body.getVizPanels()??[]).map(z=>f(z,_));return T(J,H)}function f(H,_){if((0,p.ME)(H)){const ne=(0,p.iL)(H);return{kind:"LibraryPanel",spec:{id:(0,p.Cs)(H),title:H.state.title,libraryPanel:{uid:ne.state.uid,name:ne.state.name}}}}const k=H.state.fieldConfig.defaults.color;let J;if(k){const ne=(0,r.Jc)(k.mode);ne&&(J={...k,mode:ne})}const z=H.state.fieldConfig.defaults.decimals??void 0,Y=H.state.fieldConfig.defaults.min??void 0,X=H.state.fieldConfig.defaults.max??void 0,Q=Object.fromEntries(Object.entries({...H.state.fieldConfig.defaults,decimals:z,min:Y,max:X,color:J}).filter(([ne,se])=>Array.isArray(se)?se.length>0:se!==void 0)),q={...H.state.fieldConfig,defaults:Q};return{kind:"Panel",spec:{id:(0,p.Cs)(H),title:H.state.title,description:H.state.description??"",links:u(H),transparent:H.state.displayMode==="transparent"?!0:void 0,data:{kind:"QueryGroup",spec:{queries:b(H,_),transformations:C(H),queryOptions:P(H)}},vizConfig:{kind:H.state.pluginId,spec:{pluginVersion:H.state.pluginVersion??"",options:H.state.options,fieldConfig:q??(0,d.bt)()}}}}}function u(H){const _=m.b4.getPanelLinks(H);return _?_.state.rawLinks??[]:[]}function b(H,_){const k=[],J=(0,p.un)(H),z=J?.state.queries;return z&&z.forEach(Y=>{const X=G(H,Y,"panel",J,_),Q={kind:E(Y,J),spec:(0,n.omit)(Y,"datasource","refId","hide")},q={datasource:X,query:Q,refId:Y.refId,hidden:!!Y.hide};k.push({kind:"PanelQuery",spec:q})}),k}function E(H,_){return typeof H=="string"?W()?.type||"":H.datasource?.type?H.datasource.type:_?.state.datasource?.type?_.state.datasource.type:W()?.type||""}function D(H){return H}function C(H){let _=[];const k=H.state.$data;if(k instanceof l.Es){const J=k.state.transformations;if(J.length===0)return[];for(const z of J){const Y=z;if("id"in Y){const X={id:Y.id,disabled:Y.disabled,filter:Y.filter,...Y.topic&&{topic:Y.topic},options:Y.options};_.push({kind:Y.id,spec:X})}else throw new Error("Unsupported transformation type")}}return _}function P(H){let _={};const k=(0,p.un)(H);k&&(_.maxDataPoints=k.state.maxDataPoints,k.state.cacheTimeout&&(_.cacheTimeout=k.state.cacheTimeout),k.state.queryCachingTTL&&(_.queryCachingTTL=k.state.queryCachingTTL),k.state.minInterval&&(_.interval=k.state.minInterval));const J=H.state.$timeRange;return J instanceof c.v&&(_.timeFrom=J.state.timeFrom,_.timeShift=J.state.timeShift,_.hideTimeOverride=J.state.hideTimeOverride),_}function T(H,_){return H.reduce((k,J)=>{let z=_.serializer.getElementIdForPanel(J.spec.id);return k[z]=J,k},{})}function O(H,_){const k=H.$variables;let J=[];return k instanceof l.Pj&&(J=(0,h.$o)(k,!1,_)),J}function I(H,_){const k=H.$data;if(!(k instanceof i.s))return[];const J=[];for(const z of k.state.annotationLayers){if(!(z instanceof l.tV.g))continue;const Y={kind:"AnnotationQuery",spec:{builtIn:!!z.state.query.builtIn,name:z.state.query.name,datasource:G(z,z.state.query,"annotation",void 0,_),enable:!!z.state.isEnabled,hide:!!z.state.isHidden,iconColor:z.state.query.iconColor}};z.state.query.target&&!z.state.query.query?z.state.query.builtIn?Y.spec.query={kind:"grafana",spec:{...z.state.query.target}}:Y.spec.query={kind:j(z.state.query),spec:{...z.state.query.target}}:z.state.query.query?.kind&&(Y.spec.query={kind:z.state.query.query.kind,spec:{...z.state.query.query.spec}});let X=(0,n.omit)(z.state.query,"type","target","builtIn","name","datasource","iconColor","enable","hide","filter","query");if(Object.keys(X).length>0){const{legacyOptions:Q,...q}=X;Y.spec.legacyOptions={...Q,...q}}z.state.query.filter?.ids?.length&&(Y.spec.filter=z.state.query.filter),J.push(Y)}return J}function j(H){if(H.datasource?.type)return H.datasource.type;{const _=W();return _?_.type:"grafana"}}function W(){const H=s.$.bootData.settings.defaultDatasource,k=s.$.bootData.settings.datasources[H];return{type:k.meta.id,uid:k.name}}function B(H){if(typeof H!="object"||H===null||Array.isArray(H))throw new Error("Dashboard is not an object or is null");if(!("title"in H)||typeof H.title!="string")throw new Error("Title is not a string");if(!("timeSettings"in H)||typeof H.timeSettings!="object"||H.timeSettings===null)throw new Error("TimeSettings is not an object or is null");if(!("variables"in H)||!Array.isArray(H.variables))throw new Error("Variables is not an array");if(!("elements"in H)||typeof H.elements!="object"||H.elements===null)throw new Error("Elements is not an object or is null");if(!("annotations"in H)||!Array.isArray(H.annotations))throw new Error("Annotations is not an array");if(!("layout"in H)||typeof H.layout!="object"||H.layout===null)throw new Error("Layout is not an object or is null");if("description"in H&&H.description!==void 0&&typeof H.description!="string")throw new Error("Description is not a string");if("cursorSync"in H&&H.cursorSync!==void 0){const k=["Off","Crosshair","Tooltip"];if(typeof H.cursorSync!="string"||!k.includes(H.cursorSync))throw new Error("CursorSync is not a valid value")}if("liveNow"in H&&H.liveNow!==void 0&&typeof H.liveNow!="boolean")throw new Error("LiveNow is not a boolean");if("preload"in H&&H.preload!==void 0&&typeof H.preload!="boolean")throw new Error("Preload is not a boolean");if("editable"in H&&H.editable!==void 0&&typeof H.editable!="boolean")throw new Error("Editable is not a boolean");if("links"in H&&H.links!==void 0&&!Array.isArray(H.links))throw new Error("Links is not an array");if("tags"in H&&H.tags!==void 0&&!Array.isArray(H.tags))throw new Error("Tags is not an array");if("id"in H&&H.id!==void 0&&typeof H.id!="number")throw new Error("ID is not a number");const _=H.timeSettings;if(!("from"in _)||typeof _.from!="string")throw new Error("From is not a string");if(!("to"in _)||typeof _.to!="string")throw new Error("To is not a string");if(!("autoRefresh"in _)||typeof _.autoRefresh!="string")throw new Error("AutoRefresh is not a string");if(!("hideTimepicker"in _)||typeof _.hideTimepicker!="boolean")throw new Error("HideTimepicker is not a boolean");if("autoRefreshIntervals"in _&&_.autoRefreshIntervals!==void 0&&!Array.isArray(_.autoRefreshIntervals))throw new Error("AutoRefreshIntervals is not an array");if("timezone"in _&&_.timezone!==void 0&&typeof _.timezone!="string")throw new Error("Timezone is not a string");if("quickRanges"in _&&_.quickRanges!==void 0&&!Array.isArray(_.quickRanges))throw new Error("QuickRanges is not an array");if("weekStart"in _&&_.weekStart!==void 0&&(typeof _.weekStart!="string"||!["saturday","sunday","monday"].includes(_.weekStart)))throw new Error('WeekStart should be one of "saturday", "sunday" or "monday"');if("nowDelay"in _&&_.nowDelay!==void 0&&typeof _.nowDelay!="string")throw new Error("NowDelay is not a string");if("fiscalYearStartMonth"in _&&_.fiscalYearStartMonth!==void 0&&typeof _.fiscalYearStartMonth!="number")throw new Error("FiscalYearStartMonth is not a number");if(!("kind"in H.layout))throw new Error("Layout kind is required");return H.layout.kind==="GridLayout"?S(H.layout):H.layout.kind==="RowsLayout"&&w(H.layout),!0}function S(H){if(typeof H!="object"||H===null)throw new Error("Layout is not an object or is null");if(!("kind"in H)||H.kind!=="GridLayout")throw new Error("Layout kind is not GridLayout");if(!("spec"in H)||typeof H.spec!="object"||H.spec===null)throw new Error("Layout spec is not an object or is null");if(!("items"in H.spec)||!Array.isArray(H.spec.items))throw new Error("Layout spec items is not an array")}function w(H){if(typeof H!="object"||H===null)throw new Error("Layout is not an object or is null");if(!("kind"in H)||H.kind!=="RowsLayout")throw new Error("Layout kind is not RowsLayout");if(!("spec"in H)||typeof H.spec!="object"||H.spec===null)throw new Error("Layout spec is not an object or is null");if(!("rows"in H.spec)||!Array.isArray(H.spec.rows))throw new Error("Layout spec items is not an array")}function N(H,_,k){if(!k)return new Set;if(_==="panels"&&A(H)){const J=m.b4.getElementIdentifierForVizPanel(H);return k.panels.get(J)||new Set}if(_==="variables")return k.variables;if(_==="annotations")return k.annotations;throw new Error(`Invalid type ${_} for getAutoAssignedDSRef`)}function M(H,_,k,J){const z=L(H,k);if(!_?.has(z)){if(k==="query")return"datasource"in H&&H.datasource?H.datasource:J?.state?.datasource;if(k==="variable"&&"state"in H&&"datasource"in H.state)return H.state.datasource||{};if(k==="annotation"&&"datasource"in H)return H.datasource||{}}}function L(H,_){if(_==="query")return"refId"in H?H.refId:"";if(_==="variable")return"state"in H&&"name"in H.state?H.state.name:"";if(_==="annotation")return"name"in H?H.name:"";throw new Error(`Invalid type ${_} for getElementIdentifier`)}function A(H){return"pluginId"in H.state}function U(H){return!("pluginId"in H.state)&&("variables"in H.state||"getValue"in H)}function F(H){return"refId"in H&&!("state"in H)}function V(H){return"datasource"in H&&"name"in H}function K(H){return"state"in H&&"name"in H.state}function G(H,_,k,J,z){let Y;if(k==="panel"){if(!J||!A(H)||!F(_))return;const X=N(H,"panels",z);Y=M(_,X,"query",J)}if(k==="variable"){if(!U(H)||!K(_))return;const X=N(H,"variables",z);Y=M(_,X,"variable")}if(k==="annotation"){if(!V(_))return;const X=N(H,"annotations",z);Y=M(_,X,"annotation")}return Object.keys(Y||{}).length>0?Y:void 0}},3281:(Z,R,e)=>{"use strict";e.d(R,{ES:()=>d,So:()=>m,Y_:()=>i,cc:()=>o,tH:()=>l});var n=e(18600),a=e(21275),s=e(59857);function l(p){switch(p){case"never":return a.CO.never;case"onDashboardLoad":return a.CO.onDashboardLoad;case"onTimeRangeChanged":return a.CO.onTimeRangeChanged;default:return a.CO.never}}function o(p){switch(p){case"dontHide":return s.zL.dontHide;case"hideLabel":return s.zL.hideLabel;case"hideVariable":return s.zL.hideVariable;default:return s.zL.dontHide}}function d(p){switch(p){case"disabled":return a.ZG.disabled;case"numericalAsc":return a.ZG.numericalAsc;case"alphabeticalCaseInsensitiveAsc":return a.ZG.alphabeticalCaseInsensitiveAsc;case"alphabeticalCaseInsensitiveDesc":return a.ZG.alphabeticalCaseInsensitiveDesc;case"numericalDesc":return a.ZG.numericalDesc;case"naturalAsc":return a.ZG.naturalAsc;case"naturalDesc":return a.ZG.naturalDesc;case"alphabeticalAsc":return a.ZG.alphabeticalAsc;case"alphabeticalDesc":return a.ZG.alphabeticalDesc;default:return a.ZG.disabled}}function i(p){switch(p){case"Crosshair":return a.yV.Crosshair;case"Tooltip":return a.yV.Tooltip;case"Off":return a.yV.Off;default:return a.$C}}function c(p){switch(p){case"true":return n.W.True;case"false":return n.W.False;case"null":return n.W.Null;case"nan":return n.W.NaN;case"null+nan":return n.W.NullAndNaN;case"empty":return n.W.Empty;default:throw new Error(`Unknown match type: ${p}`)}}function m(p){const h=g=>{switch(g){case"absolute":return a.Ol.Absolute;case"percentage":return a.Ol.Percentage;default:return a.Ol.Absolute}},r={...p.defaults};return p.defaults.mappings&&(r.mappings=p.defaults.mappings.map(g=>{switch(g.type){case"value":return{...g,type:a.dM.ValueToText};case"range":return{...g,type:a.dM.RangeToText};case"regex":return{...g,type:a.dM.RegexToText};case"special":return{...g,options:{...g.options,match:c(g.options.match)},type:a.dM.SpecialValue};default:return g}})),p.defaults.thresholds&&(r.thresholds={...p.defaults.thresholds,mode:h(p.defaults.thresholds.mode)}),{...p,defaults:r}}},39508:(Z,R,e)=>{"use strict";e.d(R,{Jc:()=>p,LY:()=>c,MM:()=>m,NB:()=>i,k6:()=>o,qJ:()=>d,sB:()=>l});var n=e(739),a=e(21275),s=e(78947);const l="__legacyStringValue";function o(h){switch(h){case 0:return"Off";case 1:return"Crosshair";case 2:return"Tooltip";default:return(0,s.xE)().cursorSync}}function d(h){switch(h){case 0:return"never";case 1:return"onDashboardLoad";case 2:return"onTimeRangeChanged";default:return(0,s.FM)()}}function i(h){switch(h){case 0:return"dontHide";case 1:return"hideLabel";case 2:return"hideVariable";default:return(0,s.SR)()}}function c(h){switch(h){case 0:return"disabled";case 1:return"alphabeticalAsc";case 2:return"alphabeticalDesc";case 3:return"numericalAsc";case 4:return"numericalDesc";default:return(0,s.G9)()}}function m(h){switch(h){case"annotations":return n.QR.Annotations;case"alertStates":return n.QR.AlertStates;case"series":return n.QR.Series;default:return}}function p(h){switch(h){case a.Yb.Thresholds:return"thresholds";case a.Yb.PaletteClassic:return"palette-classic";case a.Yb.PaletteClassicByName:return"palette-classic-by-name";case a.Yb.ContinuousGrYlRd:return"continuous-GrYlRd";case a.Yb.ContinuousRdYlGr:return"continuous-RdYlGr";case a.Yb.ContinuousBlYlRd:return"continuous-BlYlRd";case a.Yb.ContinuousYlRd:return"continuous-YlRd";case a.Yb.ContinuousBlPu:return"continuous-BlPu";case a.Yb.ContinuousYlBl:return"continuous-YlBl";case a.Yb.ContinuousBlues:return"continuous-blues";case a.Yb.ContinuousReds:return"continuous-reds";case a.Yb.ContinuousGreens:return"continuous-greens";case a.Yb.ContinuousPurples:return"continuous-purples";case a.Yb.Fixed:return"fixed";case a.Yb.Shades:return"shades";default:return}}},13542:(Z,R,e)=>{"use strict";e.d(R,{c:()=>B,h:()=>S});var n=e(74848),a=e(42941),s=e(41053),l=e(51898),o=e(92745),d=e(27489),i=e(43173),c=e(45861),m=e(71599),p=e(66404),h=e(35137),r=e(22787),g=e(89640),y=e(18346),v=e(2522),x=e(49785),f=e(54148),u=e(32899),b=e(75234),E=e(8207),D=e(41654),C=e(34999),P=e(33680),T=e(91555),O=e(89314),I=e(11480);function j({dashboard:N,defaultValues:M,loadedFromRef:L,readOnly:A,isGitHub:U,isNew:F,workflowOptions:V,onDismiss:K}){const G=(0,x.mN)({defaultValues:M}),{editPanel:H}=N.useState(),{handleSubmit:_,watch:k}=G,[J,z]=k(["ref","workflow"]),[Y,X]=(0,P.Qo)(),Q=async({repo:ue,path:de,comment:ie})=>{if(!ue||!de){console.error("Missing required fields for deletion:",{repo:ue,path:de});return}const he=z==="write"?L:J,me=ie||`Delete dashboard: ${N.state.title}`;Y({name:ue,path:de,ref:he,message:me})},q=(0,f.Zp)(),te=ue=>{(0,b.J7)().publish({type:u.r1.alertError.name,payload:[(0,o.t)("dashboard-scene.delete-provisioned-dashboard-form.api-error","Failed to delete dashboard"),ue]})},ne=()=>{H?.onDiscard(),K(),window.location.href="/dashboards"},se=(ue,de)=>{H?.onDiscard(),K(),q(`${T.mL}/${M.repo}/dashboard/preview/${ue}?pull_request_url=${de?.newPullRequestURL}`)};return(0,I.J)({dashboard:N,request:X,workflow:z,handlers:{onBranchSuccess:({path:ue,urls:de})=>se(ue,de),onWriteSuccess:ne,onError:te}}),(0,n.jsx)(E._,{title:(0,o.t)("dashboard-scene.delete-provisioned-dashboard-form.drawer-title","Delete Provisioned Dashboard"),subtitle:N.state.title,onClose:K,children:(0,n.jsx)(x.Op,{...G,children:(0,n.jsx)("form",{onSubmit:_(Q),children:(0,n.jsxs)(D.B,{direction:"column",gap:2,children:[A&&(0,n.jsx)(C.F,{title:(0,o.t)("dashboard-scene.delete-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.delete-provisioned-dashboard-form.delete-read-only-file-message",children:"This dashboard cannot be deleted directly from Grafana because the repository is read-only. To delete this dashboard, please remove the file from your Git repository."})}),(0,n.jsx)(O.x,{resourceType:"dashboard",isNew:F,readOnly:A,workflow:z,workflowOptions:V,isGitHub:U}),(0,n.jsxs)(D.B,{gap:2,children:[(0,n.jsx)(c.$n,{variant:"destructive",type:"submit",disabled:X.isLoading||A,children:X.isLoading?(0,o.t)("dashboard-scene.delete-provisioned-dashboard-form.deleting","Deleting..."):(0,o.t)("dashboard-scene.delete-provisioned-dashboard-form.delete-action","Delete dashboard")}),(0,n.jsx)(c.$n,{variant:"secondary",onClick:K,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.delete-provisioned-dashboard-form.cancel-action",children:"Cancel"})})]})]})})})})}function W({dashboard:N,onDismiss:M}){const{defaultValues:L,loadedFromRef:A,readOnly:U,isGitHub:F,workflowOptions:V,isNew:K}=(0,v.S)(N);return L?(0,n.jsx)(j,{dashboard:N,defaultValues:L,loadedFromRef:A,readOnly:U,isGitHub:F,isNew:K,workflowOptions:V,onDismiss:M}):null}function B({dashboard:N}){const[M,L]=(0,a.A)(!1),[A]=(0,y.uz)(),[,U]=(0,s.A)(async()=>{(0,d.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:!!i.$.featureToggles.restoreDashboards}),L(),N.state.uid&&await A({selectedItems:{dashboard:{[N.state.uid]:!0},folder:{}}}),await N.onDashboardDelete()},[N,L]);return N.isManagedRepository()&&M?(0,n.jsx)(W,{dashboard:N,onDismiss:L}):N.state.meta.provisioned&&M?(0,n.jsx)(w,{dashboardId:N.state.meta.provisionedExternalId,onClose:L}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$n,{variant:"destructive",onClick:L,"data-testid":l.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),M&&(0,n.jsx)(S,{dashboardTitle:N.state.title,onConfirm:U,onClose:L})]})}function S({dashboardTitle:N,onConfirm:M,onClose:L}){return(0,n.jsx)(m.u,{isOpen:!0,body:(0,n.jsxs)(n.Fragment,{children:[i.$.featureToggles.restoreDashboards&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.E,{element:"p",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-restore-dashboards-text",children:"This action will mark the dashboard for deletion in 30 days. Your organization administrator can restore it anytime before the 30 days expire."})}),(0,n.jsx)(h.$,{v:1})]}),(0,n.jsx)(p.E,{element:"p",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-text",children:"Do you want to delete this dashboard?"})}),(0,n.jsx)(p.E,{element:"p",children:N}),(0,n.jsx)(h.$,{v:2})]}),onConfirm:M,onDismiss:L,title:(0,o.t)("dashboard-settings.delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,o.t)("dashboard-settings.delete-modal.delete-button","Delete"),confirmationText:(0,o.t)("dashboard-settings.delete-modal.confirmation-text","Delete")})}function w({dashboardId:N,onClose:M}){return(0,n.jsxs)(r.a,{isOpen:!0,title:(0,o.t)("dashboard-scene.provisioned-delete-modal.title-cannot-delete-provisioned-dashboard","Cannot delete provisioned dashboard"),icon:"trash-alt",onDismiss:M,children:[(0,n.jsx)("p",{children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.cannot-be-deleted",children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."})}),(0,n.jsxs)("p",{children:[(0,n.jsx)("i",{children:(0,n.jsxs)(o.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.see-docs",children:["See"," ",(0,n.jsx)(g.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,n.jsx)("br",{}),(0,n.jsxs)(o.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.file-path",children:["File path: ",{dashboardId:N}]})]}),(0,n.jsx)(r.a.ButtonRow,{children:(0,n.jsx)(c.$n,{variant:"primary",onClick:M,children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.ok",children:"OK"})})})]})}},39468:(Z,R,e)=>{"use strict";e.d(R,{d:()=>r});var n=e(74848),a=e(92745),s=e(37386),l=e(63527),o=e(18857),d=e(10928),i=e(74475),c=e(32635),m=e(45861),p=e(86871);const h=Object.keys(p.G).map(g=>({label:g,value:g}));function r({link:g,onUpdate:y,onGoBack:v}){const x=[{value:"dashboards",label:(0,a.t)("dashboard-scene.dashboard-link-form.link-type-options.label.dashboards","Dashboards")},{value:"link",label:(0,a.t)("dashboard-scene.dashboard-link-form.link-type-options.label.link","Link")}],f=C=>{y({...g,tags:C})},u=C=>{const P={...g,type:C.value};P.type==="dashboards"?(P.url="",P.tooltip=""):P.tags=[],y(P)},b=C=>{y({...g,icon:C.value})},E=C=>{const P=C.currentTarget;y({...g,[P.name]:P.type==="checkbox"?P.checked:P.value})},D=g.title===p.q.title;return(0,n.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-title","Title"),children:(0,n.jsx)(l.p,{name:"title",id:"title",value:g.title,onChange:E,autoFocus:D})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-type","Type"),children:(0,n.jsx)(o.l6,{inputId:"link-type-input",value:g.type,options:x,onChange:u})}),g.type==="dashboards"&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-with-tags","With tags"),children:(0,n.jsx)(d.u,{tags:g.tags,onChange:f})})}),g.type==="link"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-url","URL"),children:(0,n.jsx)(l.p,{name:"url",value:g.url,onChange:E})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-tooltip","Tooltip"),children:(0,n.jsx)(l.p,{name:"tooltip",value:g.tooltip,onChange:E,placeholder:(0,a.t)("dashboard-scene.dashboard-link-form.placeholder-open-dashboard","Open dashboard")})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-icon","Icon"),children:(0,n.jsx)(o.l6,{value:g.icon,options:h,onChange:b})})]}),(0,n.jsxs)(i.M,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-options","Options"),isOpen:!0,children:[g.type==="dashboards"&&(0,n.jsx)(s.D,{children:(0,n.jsx)(c.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-show-as-dropdown","Show as dropdown"),name:"asDropdown",value:g.asDropdown,onChange:E})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(c.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-include-current-time-range","Include current time range"),name:"keepTime",value:g.keepTime,onChange:E})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(c.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-include-current-template-variable-values","Include current template variable values"),name:"includeVars",value:g.includeVars,onChange:E})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(c.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-open-link-in-new-tab","Open link in new tab"),name:"targetBlank",value:g.targetBlank,onChange:E})})]}),(0,n.jsx)(m.$n,{variant:"secondary",onClick:v,children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.dashboard-link-form.back-to-list",children:"Back to list"})})]})}},88898:(Z,R,e)=>{"use strict";e.d(R,{X:()=>g});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(41654),d=e(50201),i=e(45861),c=e(89640),m=e(30703),p=e(37658),h=e(76319),r=e(44458);function g({links:v,onNew:x,onOrderChange:f,onEdit:u,onDuplicate:b,onDelete:E}){const D=(0,l.of)(y);return v.length===0?(0,n.jsx)(o.B,{direction:"column",children:(0,n.jsx)(d.p,{variant:"call-to-action",button:(0,n.jsx)(i.$n,{onClick:x,size:"lg",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,s.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,n.jsx)(c.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.type",children:"Type"})}),(0,n.jsx)("th",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.info",children:"Info"})}),(0,n.jsx)("th",{colSpan:3})]})}),(0,n.jsx)("tbody",{children:v.map((P,T)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>u(T),children:[(0,n.jsx)(m.I,{name:"external-link-alt"})," \xA0 ",P.type]}),(0,n.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>u(T),children:(0,n.jsxs)(o.B,{children:[P.title&&(0,n.jsx)("span",{className:D.titleWrapper,children:P.title}),P.type==="link"&&(0,n.jsx)("span",{className:D.urlWrapper,children:P.url}),P.type==="dashboards"&&(0,n.jsx)(p.L,{tags:P.tags??[]})]})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:T!==0&&(0,n.jsx)(h.K,{name:"arrow-up",onClick:()=>f(T,-1),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-move-link-up","Move link up")})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:v.length>1&&T!==v.length-1?(0,n.jsx)(h.K,{name:"arrow-down",onClick:()=>f(T,1),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-move-link-down","Move link down")}):null}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(h.K,{name:"copy",onClick:()=>b(P),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-copy-link","Copy link")})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(r.e,{"aria-label":(0,s.t)("dashboard-scene.dashboard-link-list.delete-aria-label",'Delete link with title "{{title}}"',{title:P.title}),size:"sm",onConfirm:()=>E(T)})})]},`${P.title}-${T}`))})]}),(0,n.jsx)(i.$n,{className:D.newLinkButton,icon:"plus",onClick:x,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.new-link",children:"New link"})})]})}const y=v=>({titleWrapper:(0,a.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,a.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,a.css)({marginTop:v.spacing(3)})})},86871:(Z,R,e)=>{"use strict";e.d(R,{G:()=>a,q:()=>n});const n={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},a={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},99584:(Z,R,e)=>{"use strict";e.d(R,{Q:()=>v});var n=e(74848),a=e(96540),s=e(68125),l=e(51898),o=e(92745),d=e(30048),i=e(31286),c=e(34999),m=e(37386),p=e(21285),h=e(50992),r=e(76792),g=e(69076),y=e(32442);function v({datasource:x,infoText:f,allowCustomValue:u,onDataSourceChange:b,onDefaultKeysChange:E,onAllowCustomValueChange:D,defaultKeys:C,inline:P,datasourceSupported:T}){const O=(0,a.useCallback)(I=>{const j=(0,s.Jh)(`key,value
`+I)[0],W=[];for(let B=0;B<j.length;B++)W.push({text:j.fields[0].values[B],value:j.fields[1].values[B]});E?.(W)},[E]);return(0,n.jsxs)(n.Fragment,{children:[!P&&(0,n.jsx)(y.Y,{children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.ad-hoc-variable-form.adhoc-options",children:"Ad-hoc options"})}),(0,n.jsx)(i.a,{marginBottom:2,children:(0,n.jsx)(d.c,{label:(0,o.t)("dashboard-scene.ad-hoc-variable-form.label-data-source","Data source"),htmlFor:"data-source-picker",tooltip:f,children:(0,n.jsx)(r.s,{current:x,onChange:b,width:30,variables:!0,noDefault:!0})})}),T===!1?(0,n.jsx)(c.F,{title:(0,o.t)("dashboard-scene.ad-hoc-variable-form.alert-not-supported","This data source does not support ad hoc filters"),severity:"warning","data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,T&&E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.D,{label:(0,o.t)("dashboard-scene.ad-hoc-variable-form.label-use-static-key-dimensions","Use static key dimensions"),description:(0,o.t)("dashboard-scene.ad-hoc-variable-form.description-provide-dimensions-as-csv-dimension-name-dimension-id","Provide dimensions as CSV: {{name}}, {{value}}",{name:"dimensionName",value:"dimensionId"}),children:(0,n.jsx)(p.d,{"data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:C!==void 0,onChange:I=>{E(C===void 0?[]:void 0)}})}),C!==void 0&&(0,n.jsx)(h.B,{height:300,language:"csv",value:C.map(I=>`${I.text},${I.value}`).join(`
`),onBlur:O,onSave:O,showMiniMap:!1,showLineNumbers:!0})]}),T&&D&&(0,n.jsx)(g.c,{value:u??!0,name:(0,o.t)("dashboard-scene.ad-hoc-variable-form.name-allow-custom-values","Allow custom values"),description:(0,o.t)("dashboard-scene.ad-hoc-variable-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:D,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}},23675:(Z,R,e)=>{"use strict";e.d(R,{d:()=>d});var n=e(74848),a=e(51898),s=e(92745),l=e(32442),o=e(49602);function d({onChange:i,constantValue:c}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.constant-variable-form.constant-options",children:"Constant options"})}),(0,n.jsx)(o._,{defaultValue:c,name:"Value",placeholder:(0,s.t)("dashboard-scene.constant-variable-form.placeholder-your-metric-prefix","Your metric prefix"),onBlur:i,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},70430:(Z,R,e)=>{"use strict";e.d(R,{w:()=>m});var n=e(74848),a=e(51898),s=e(92745),l=e(36674),o=e(51156),d=e(32442),i=e(25379),c=e(52847);function m({query:r,multi:g,allValue:y,includeAll:v,allowCustomValue:x,onQueryChange:f,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:E,onAllowCustomValueChange:D}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.custom-variable-form.custom-options",children:"Custom options"})}),(0,n.jsx)(i.Z,{name:(0,s.t)("dashboard-scene.custom-variable-form.name-values-separated-comma","Values separated by comma"),defaultValue:r,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:f,required:!0,width:52,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,n.jsx)(d.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.custom-variable-form.selection-options",children:"Selection options"})}),(0,n.jsx)(c.B,{multi:g,includeAll:v,allValue:y,allowCustomValue:x,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:E,onAllowCustomValueChange:D})]})}function p(r){return r instanceof CustomVariable?[new OptionsPaneItemDescriptor({title:t("dashboard.edit-pane.variable.custom-options.values","Values separated by comma"),render:()=>jsx(h,{variable:r})})]:[]}function h({variable:r}){const{query:g}=r.useState(),y=async v=>{r.setState({query:v.currentTarget.value}),await lastValueFrom(r.validateAndUpdate())};return jsx(TextArea,{rows:2,defaultValue:g,onBlur:y,placeholder:t("dashboard.edit-pane.variable.custom-options.values-placeholder","1, 10, mykey : myvalue, myvalue, escaped,value"),required:!0,"data-testid":selectors.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput})}},42272:(Z,R,e)=>{"use strict";e.d(R,{y:()=>c});var n=e(74848),a=e(51898),s=e(92745),l=e(52847),o=e(32442),d=e(68577),i=e(49602);function c({query:m,regex:p,optionTypes:h,allowCustomValue:r,onChange:g,onRegExBlur:y,multi:v,includeAll:x,allValue:f,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:E,onAllowCustomValueChange:D}){const C=h.find(P=>P.value===m);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.data-source-options",children:"Data source options"})}),(0,n.jsx)(d.v,{name:(0,s.t)("dashboard-scene.data-source-variable-form.name-type","Type"),value:C,options:h,onChange:g,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,n.jsx)(i._,{defaultValue:p,name:(0,s.t)("dashboard-scene.data-source-variable-form.name-instance-name-filter","Instance name filter"),placeholder:"/.*-(.*)-.*/",onBlur:y,description:(0,n.jsxs)("div",{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.description-instance-name-filter",children:"Regex filter for which data source instances to choose from in the variable value list. Leave empty for all."}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.example-instance-name-filter",components:{codeExample:(0,n.jsx)("code",{children:"/^prod/"})},children:["Example: ","<codeExample />"]})]})}),(0,n.jsx)(o.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.selection-options",children:"Selection options"})}),(0,n.jsx)(l.B,{multi:v,includeAll:x,allValue:f,allowCustomValue:r,onMultiChange:u,onIncludeAllChange:b,onAllValueChange:E,onAllowCustomValueChange:D})]})}},1096:(Z,R,e)=>{"use strict";e.d(R,{s:()=>p});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(63142),d=e(69076),i=e(32442),c=e(68577),m=e(49602);function p({intervals:r,onIntervalsChange:g,onAutoEnabledChange:y,onAutoMinIntervalChanged:v,onAutoCountChanged:x,autoEnabled:f,autoMinInterval:u,autoStepCount:b,inline:E=!1}){const D=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(T=>({label:`${T}`,value:T})),C=(0,o.of)(h),P=D.find(T=>T.value===b)??D[0];return(0,n.jsxs)(n.Fragment,{children:[!E&&(0,n.jsx)(i.Y,{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.interval-variable-form.interval-options",children:"Interval options"})}),(0,n.jsx)(m._,{defaultValue:r,name:(0,l.t)("dashboard-scene.interval-variable-form.name-values","Values"),placeholder:"1m,10m,1h,6h,1d,7d",onBlur:g,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,n.jsx)(d.c,{value:f,name:(0,l.t)("dashboard-scene.interval-variable-form.name-auto-option","Auto option"),description:(0,l.t)("dashboard-scene.interval-variable-form.description-auto-option","Dynamically calculates interval by dividing time range by the count specified"),onChange:y,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),f&&(0,n.jsxs)("div",{className:C.autoFields,children:[(0,n.jsx)(c.v,{name:(0,l.t)("dashboard-scene.interval-variable-form.name-step-count","Step count"),description:(0,l.t)("dashboard-scene.interval-variable-form.description-step-count","How many times the current time range should be divided to calculate the value"),value:P,options:D,onChange:x,width:9,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,n.jsx)(m._,{value:u,name:(0,l.t)("dashboard-scene.interval-variable-form.name-min-interval","Min interval"),description:(0,l.t)("dashboard-scene.interval-variable-form.description-calculated-value-below-threshold","The calculated value will not go below this threshold"),placeholder:"10s",onChange:v,width:11,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const h=r=>({autoFields:(0,a.css)({marginTop:r.spacing(2),display:"flex",flexDirection:"column"})})},66698:(Z,R,e)=>{"use strict";e.d(R,{w:()=>c});var n=e(74848),a=e(28105),s=e(92745),l=e(2863),o=e(31286),d=e(66404),i=e(67933);function c({query:m,datasource:p,VariableQueryEditor:h,onLegacyQueryChange:r,onQueryChange:g,timeRange:y}){let v;return typeof m=="string"?v=m||(p.variables?.getDefaultQuery?.()??""):v={...p.variables?.getDefaultQuery?.(),...m},h&&(0,i.VN)(h,p)?(0,n.jsxs)(o.a,{marginBottom:2,children:[(0,n.jsx)(d.E,{variant:"bodySmall",weight:"medium",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.query-editor.query",children:"Query"})}),(0,n.jsx)(o.a,{marginTop:.25,children:(0,n.jsx)(h,{datasource:p,query:v,templateSrv:(0,l.w)(),onChange:r},p.uid)})]}):h&&(0,i.CH)(h,p)?(0,n.jsx)(o.a,{marginBottom:2,children:(0,n.jsx)(o.a,{marginTop:.25,children:(0,n.jsx)(h,{datasource:p,query:v,onChange:g,onRunQuery:()=>{},data:{series:[],state:a.Gu.Done,timeRange:y},range:y,onBlur:()=>{},history:[]},p.uid)})}):null}},28799:(Z,R,e)=>{"use strict";e.d(R,{u:()=>x});var n=e(74848),a=e(16817),s=e(51898),l=e(92745),o=e(78282),d=e(37386),i=e(89640),c=e(66698),m=e(52847),p=e(76792),h=e(38681),r=e(56620),g=e(83501),y=e(32442),v=e(25379);function x({datasource:f,onDataSourceChange:u,query:b,onQueryChange:E,onLegacyQueryChange:D,timeRange:C,regex:P,onRegExChange:T,sort:O,onSortChange:I,refresh:j,onRefreshChange:W,isMulti:B,onMultiChange:S,allowCustomValue:w,onAllowCustomValueChange:N,includeAll:M,onIncludeAllChange:L,allValue:A,onAllValueChange:U}){const{value:F}=(0,a.A)(async()=>{const G=await(0,o.l)().get(f??""),H=await(0,h.y)(G),_=G?.variables?.getDefaultQuery?.();if(!b&&_){const k=typeof _=="string"?_:{..._,refId:_.refId??"A"};E(k)}return{datasource:G,VariableQueryEditor:H}},[f]),{datasource:V,VariableQueryEditor:K}=F??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Y,{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.query-options",children:"Query options"})}),(0,n.jsx)(d.D,{label:(0,l.t)("dashboard-scene.query-variable-editor-form.label-data-source","Data source"),htmlFor:"data-source-picker",children:(0,n.jsx)(p.s,{current:f,onChange:u,variables:!0,width:30})}),V&&K&&(0,n.jsx)(c.w,{onQueryChange:E,onLegacyQueryChange:D,datasource:V,query:b,VariableQueryEditor:K,timeRange:C}),(0,n.jsx)(v.Z,{defaultValue:P??"",name:(0,l.t)("dashboard-scene.query-variable-editor-form.name-regex","Regex"),description:(0,n.jsxs)("div",{children:[(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-optional",children:"Optional, if you want to extract part of a series name or metric node segment."}),(0,n.jsx)("br",{}),(0,n.jsxs)(l.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-examples",children:["Named capture groups can be used to separate the display text and value (",(0,n.jsx)(i.Y,{href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",external:!0,children:"see examples"}),")."]})]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:T,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,n.jsx)(g.z,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:I,sort:O}),(0,n.jsx)(r.U,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:W,refresh:j}),(0,n.jsx)(y.Y,{children:(0,n.jsx)(l.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.selection-options",children:"Selection options"})}),(0,n.jsx)(m.B,{multi:!!B,includeAll:!!M,allowCustomValue:w,allValue:A,onMultiChange:S,onIncludeAllChange:L,onAllValueChange:U,onAllowCustomValueChange:N})]})}},52847:(Z,R,e)=>{"use strict";e.d(R,{B:()=>i});var n=e(74848),a=e(51898),s=e(92745),l=e(41654),o=e(69076),d=e(49602);function i({multi:c,allowCustomValue:m,includeAll:p,allValue:h,onMultiChange:r,onAllowCustomValueChange:g,onIncludeAllChange:y,onAllValueChange:v}){return(0,n.jsxs)(l.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,n.jsx)(o.c,{value:c,name:(0,s.t)("dashboard-scene.selection-options-form.name-multi-value","Multi-value"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-multiple-values-selected","Enables multiple values to be selected at the same time"),onChange:r,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),g&&(0,n.jsx)(o.c,{value:m??!0,name:(0,s.t)("dashboard-scene.selection-options-form.name-allow-custom-values","Allow custom values"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:g,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch}),(0,n.jsx)(o.c,{value:p,name:(0,s.t)("dashboard-scene.selection-options-form.name-include-all-option","Include All option"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-option-include-variables","Enables an option to include all values"),onChange:y,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),p&&(0,n.jsx)(d._,{defaultValue:h??"",onBlur:v,name:(0,s.t)("dashboard-scene.selection-options-form.name-custom-all-value","Custom all value"),testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},69076:(Z,R,e)=>{"use strict";e.d(R,{c:()=>l});var n=e(74848),a=e(92145),s=e(32635);function l({value:o,name:d,description:i,onChange:c,ariaLabel:m,testId:p}){const h=(0,a.Bi)();return(0,n.jsx)(s.S,{id:h,label:d,description:i,value:o,onChange:c,"aria-label":m,"data-testid":p})}},29:(Z,R,e)=>{"use strict";e.d(R,{D:()=>i});var n=e(74848),a=e(96540),s=e(7389),l=e(92745),o=e(37386),d=e(77824);function i({onChange:c,hide:m,type:p}){const h=(0,a.useMemo)(()=>[{label:(0,l.t)("dashboard-scene.variable-hide-select.hide_options.label.nothing","Nothing"),value:s.zL.dontHide},{label:(0,l.t)("dashboard-scene.variable-hide-select.hide_options.label.variable","Variable"),value:s.zL.hideVariable},{label:(0,l.t)("dashboard-scene.variable-hide-select.hide_options.label.label","Label"),value:s.zL.hideLabel}],[]),r=(0,a.useMemo)(()=>h.find(g=>g.value===m)?.value??h[0].value,[m,h]);return p==="constant"?null:(0,n.jsx)(o.D,{label:(0,l.t)("dashboard-scene.variable-hide-select.label","Hide"),children:(0,n.jsx)(d.z,{options:h,onChange:c,value:r})})}},32442:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(53487);function o({className:i,...c}){const m=(0,s.of)(d);return(0,n.jsx)(l.s,{...c,className:(0,a.cx)(m.legend,i)})}function d(i){return{legend:(0,a.css)({marginTop:i.spacing(3),marginBottom:i.spacing(1)})}}},68577:(Z,R,e)=>{"use strict";e.d(R,{v:()=>i});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(37386),d=e(18857);function i({name:m,description:p,value:h,options:r,onChange:g,testId:y,width:v}){const x=(0,l.of)(c),f=(0,s.useId)(),u=`variable-select-input-${m}-${f}`;return(0,n.jsx)(o.D,{label:m,description:p,htmlFor:u,children:(0,n.jsx)(d.l6,{"data-testid":y,inputId:u,onChange:g,value:h,width:v??30,options:r,className:x.selectContainer})})}function c(m){return{selectContainer:(0,a.css)({marginRight:m.spacing(.5)})}}},25379:(Z,R,e)=>{"use strict";e.d(R,{$:()=>c,Z:()=>i});var n=e(74848),a=e(22803),s=e(92145),l=e(63142),o=e(37386),d=e(87105);function i({value:m,defaultValue:p,name:h,description:r,placeholder:g,onChange:y,onBlur:v,ariaLabel:x,required:f,width:u,testId:b}){const E=(0,l.of)(c),D=(0,s.Bi)();return(0,n.jsx)(o.D,{label:h,description:r,htmlFor:D,children:(0,n.jsx)(d.f,{id:D,rows:2,value:m,defaultValue:p,onChange:y,onBlur:v,placeholder:g,required:f,"aria-label":x,cols:u,className:E.textarea,"data-testid":b})})}function c(m){return{textarea:(0,a.css)({whiteSpace:"pre-wrap",minHeight:m.spacing(4),height:"auto",overflow:"auto",padding:`${m.spacing(.75)} ${m.spacing(1)}`,width:"inherit",[m.breakpoints.down("sm")]:{width:"100%"}})}}},49602:(Z,R,e)=>{"use strict";e.d(R,{_:()=>o});var n=e(74848),a=e(92145),s=e(37386),l=e(63527);function o({value:d,defaultValue:i,name:c,placeholder:m="",onChange:p,testId:h,width:r,required:g,onBlur:y,grow:v,description:x,invalid:f,error:u,maxLength:b}){const E=(0,a.Bi)(c);return(0,n.jsx)(s.D,{label:c,description:x,invalid:f,error:u,htmlFor:E,children:(0,n.jsx)(l.p,{type:"text",id:E,placeholder:m,value:d,defaultValue:i,onChange:p,onBlur:y,width:v?void 0:r??30,"data-testid":h,maxLength:b,required:g})})}},18387:(Z,R,e)=>{"use strict";e.d(R,{j:()=>h});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(66404),c=e(97095),m=e(79233),p=e(45861);const h=({options:g})=>{const[y,v]=(0,s.useState)(20),[x,f]=(0,s.useState)([]),u=(0,s.useCallback)(E=>{E.preventDefault(),v(y+20)},[y,v]),b=(0,d.of)(r);return(0,s.useEffect)(()=>f(g.slice(0,y)),[y,g]),x.length?(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,n.jsx)(i.E,{variant:"bodySmall",weight:"medium",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.variable-values-preview.preview-of-values",children:"Preview of values"})}),(0,n.jsx)(c.C,{children:x.map((E,D)=>(0,n.jsx)(c.C,{className:b.optionContainer,children:(0,n.jsx)(m.c,{"data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,n.jsx)("div",{className:b.label,children:E.label})})},`${E.value}-${D}`))}),g.length>y&&(0,n.jsx)(c.C,{className:b.optionContainer,children:(0,n.jsx)(p.$n,{onClick:u,variant:"secondary",size:"sm",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.variable-values-preview.show-more",children:"Show more"})})})]}):null};h.displayName="VariableValuesPreview";function r(g){return{wrapper:(0,a.css)({display:"flex",flexDirection:"column",marginTop:g.spacing(2)}),optionContainer:(0,a.css)({marginLeft:g.spacing(.5),marginBottom:g.spacing(.5)}),label:(0,a.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},44741:(Z,R,e)=>{"use strict";e.d(R,{cH:()=>we,mJ:()=>ze,Ao:()=>pe,IO:()=>Ae,e_:()=>le,e4:()=>ve,kh:()=>Xe,CD:()=>We,No:()=>_e,B$:()=>Be,n_:()=>ye,bZ:()=>Re,VD:()=>be,c7:()=>Oe,c$:()=>Ve});var n=e(2543),a=e(43173),s=e(78282),l=e(36674),o=e(59857),d=e(8285),i=e(74848),c=e(16817),m=e(48480),p=e(51156),h=e(99584);function r(ge){const{variable:Ke}=ge,{datasource:qe,defaultKeys:ot,allowCustomValue:lt}=Ke.useState(),{value:mt}=(0,c.A)(async()=>await(0,s.l)().get(qe),[qe]),Lt=mt?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters.",Tt=Ut=>{const an=(0,m.p$)(Ut);Ke.setState({datasource:an,supportsMultiValueOperators:Ut.meta.multiValueFilterOperators})},It=Ut=>{Ke.setState({defaultKeys:Ut})},Mt=Ut=>{Ke.setState({allowCustomValue:Ut.currentTarget.checked})};return(0,i.jsx)(h.Q,{datasource:qe??void 0,infoText:Lt,allowCustomValue:lt,onDataSourceChange:Tt,defaultKeys:ot,onDefaultKeysChange:It,onAllowCustomValueChange:Mt,inline:ge.inline,datasourceSupported:!!mt?.getTagKeys})}function g(ge){return ge instanceof l.H9?[new p.v({render:()=>(0,i.jsx)(r,{variable:ge,onRunQuery:n.noop,inline:!0})})]:(console.warn("getAdHocFilterOptions: variable is not an AdHocFiltersVariable"),[])}var y=e(75505),v=e(92745),x=e(63527),f=e(23675);function u({variable:ge}){const{value:Ke}=ge.useState(),qe=ot=>{ge.setState({value:ot.currentTarget.value})};return(0,i.jsx)(f.d,{constantValue:Ke.toString(),onChange:qe})}function b(ge){return ge instanceof l.x0?[new p.v({title:(0,v.t)("dashboard-scene.constant-variable-form.label-value","Value"),render:()=>(0,i.jsx)(E,{variable:ge})})]:(console.warn("getConstantVariableOptions: variable is not a ConstantVariable"),[])}function E({variable:ge}){const{value:Ke}=ge.useState(),qe=async ot=>{ge.setState({value:ot.currentTarget.value}),await(0,y.s)(ge.validateAndUpdate())};return(0,i.jsx)(x.p,{defaultValue:Ke.toString(),onBlur:qe,placeholder:(0,v.t)("dashboard-scene.constant-variable-form.placeholder-your-metric-prefix","Your metric prefix")})}var D=e(51898),C=e(87105),P=e(70430);function T({variable:ge,onRunQuery:Ke}){const{query:qe,isMulti:ot,allValue:lt,includeAll:mt,allowCustomValue:Lt}=ge.useState(),Tt=cn=>{ge.setState({isMulti:cn.currentTarget.checked})},It=cn=>{ge.setState({includeAll:cn.currentTarget.checked})},Mt=cn=>{ge.setState({query:cn.currentTarget.value}),Ke()},Ut=cn=>{ge.setState({allValue:cn.currentTarget.value})},an=cn=>{ge.setState({allowCustomValue:cn.currentTarget.checked})};return(0,i.jsx)(P.w,{query:qe??"",multi:!!ot,allValue:lt??"",includeAll:!!mt,allowCustomValue:Lt,onMultiChange:Tt,onIncludeAllChange:It,onQueryChange:Mt,onAllValueChange:Ut,onAllowCustomValueChange:an})}function O(ge){return ge instanceof l.yP?[new p.v({title:(0,v.t)("dashboard.edit-pane.variable.custom-options.values","Values separated by comma"),render:()=>(0,i.jsx)(I,{variable:ge})})]:[]}function I({variable:ge}){const{query:Ke}=ge.useState(),qe=async ot=>{ge.setState({query:ot.currentTarget.value}),await(0,y.s)(ge.validateAndUpdate())};return(0,i.jsx)(C.f,{rows:2,defaultValue:Ke,onBlur:qe,placeholder:(0,v.t)("dashboard.edit-pane.variable.custom-options.values-placeholder","1, 10, mykey : myvalue, myvalue, escaped,value"),required:!0,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput})}var j=e(43243),W=e(42272);function B({variable:ge,onRunQuery:Ke}){const{pluginId:qe,regex:ot,isMulti:lt,allValue:mt,includeAll:Lt,allowCustomValue:Tt}=ge.useState(),It=ve(),Mt=yn=>{ge.setState({pluginId:yn.value}),Ke()},Ut=yn=>{ge.setState({regex:yn.currentTarget.value}),Ke()},an=yn=>{ge.setState({isMulti:yn.currentTarget.checked})},cn=yn=>{ge.setState({includeAll:yn.currentTarget.checked})},un=yn=>{ge.setState({allValue:yn.currentTarget.value})},On=yn=>{ge.setState({allowCustomValue:yn.currentTarget.checked})};return(0,i.jsx)(W.y,{query:qe,regex:ot,multi:lt||!1,allValue:mt,includeAll:Lt||!1,optionTypes:It,allowCustomValue:Tt,onChange:Mt,onRegExBlur:Ut,onMultiChange:an,onIncludeAllChange:cn,onAllValueChange:un,onAllowCustomValueChange:On})}function S(ge){return ge instanceof l.mI?[new p.v({title:(0,v.t)("dashboard.edit-pane.variable.datasource-options.type","Type"),render:()=>(0,i.jsx)(w,{variable:ge})}),new p.v({title:(0,v.t)("dashboard.edit-pane.variable.datasource-options.name-filter","Name filter"),description:(0,v.t)("dashboard.edit-pane.variable.datasource-options.name-filter-description","Regex filter for which data source instances to include. Leave empty for all."),render:()=>(0,i.jsx)(N,{variable:ge})})]:[]}function w({variable:ge}){const{pluginId:Ke}=ge.useState(),qe=ve(),ot=async lt=>{ge.setState({pluginId:lt.value}),await(0,y.s)(ge.validateAndUpdate())};return(0,i.jsx)(j.G,{options:qe,value:Ke,onChange:ot,placeholder:(0,v.t)("dashboard.edit-pane.variable.datasource-options.type-placeholder","Choose data source type"),"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect})}function N({variable:ge}){const{regex:Ke}=ge.useState(),qe=async ot=>{ge.setState({regex:ot.currentTarget.value}),await(0,y.s)(ge.validateAndUpdate())};return(0,i.jsx)(x.p,{defaultValue:Ke,onBlur:qe,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.nameFilter,placeholder:(0,v.t)("dashboard.edit-pane.variable.datasource-options.name-filter-placeholder","Example: /^prod/")})}var M=e(96540),L=e(68125),A=e(30048),U=e(31286),F=e(34999),V=e(37386),K=e(21285),G=e(50992),H=e(76792),_=e(69076),k=e(32442);function J({datasource:ge,defaultOptions:Ke,infoText:qe,onDataSourceChange:ot,onDefaultOptionsChange:lt,allowCustomValue:mt,onAllowCustomValueChange:Lt,inline:Tt,datasourceSupported:It}){const Mt=(0,M.useCallback)(Ut=>{const an=(0,L.Jh)(`key,value
`+Ut)[0],cn=[];for(let un=0;un<an.length;un++)cn.push({text:an.fields[0].values[un],value:an.fields[1].values[un]});lt(cn)},[lt]);return(0,i.jsxs)(i.Fragment,{children:[!Tt&&(0,i.jsx)(k.Y,{children:(0,i.jsx)(v.x6,{i18nKey:"dashboard-scene.group-by-variable-form.group-by-options",children:"Group by options"})}),(0,i.jsx)(U.a,{marginBottom:2,children:(0,i.jsx)(A.c,{label:(0,v.t)("dashboard-scene.group-by-variable-form.label-data-source","Data source"),htmlFor:"data-source-picker",tooltip:qe,children:(0,i.jsx)(H.s,{current:ge,onChange:ot,width:30,variables:!0,noDefault:!0})})}),It?null:(0,i.jsx)(F.F,{title:(0,v.t)("dashboard-scene.group-by-variable-form.alert-not-supported","This data source does not support group by variables"),severity:"warning","data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}),It&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.D,{label:(0,v.t)("dashboard-scene.group-by-variable-form.label-use-static-group-by-dimensions","Use static group dimensions"),description:(0,v.t)("dashboard-scene.group-by-variable-form.description-provide-dimensions-as-csv-dimension-name-dimension-id","Provide dimensions as CSV: {{name}}, {{value}}",{name:"dimensionName",value:"dimensionId"}),children:(0,i.jsx)(K.d,{"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:Ke!==void 0,onChange:Ut=>{lt(Ke===void 0?[]:void 0)}})}),Ke!==void 0&&(0,i.jsx)(G.B,{height:300,language:"csv",value:Ke.map(Ut=>`${Ut.text},${Ut.value}`).join(`
`),onBlur:Mt,onSave:Mt,showMiniMap:!1,showLineNumbers:!0})]}),It&&!Tt&&Lt&&(0,i.jsx)(_.c,{value:mt,name:(0,v.t)("dashboard-scene.group-by-variable-form.name-allow-custom-values","Allow custom values"),description:(0,v.t)("dashboard-scene.group-by-variable-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:Lt,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}function z(ge){const{variable:Ke,onRunQuery:qe,inline:ot}=ge,{datasource:lt,defaultOptions:mt,allowCustomValue:Lt=!0}=Ke.useState(),{value:Tt}=(0,c.A)(async()=>await(0,s.l)().get(lt),[Ke.state]),It=Tt?.getTagKeys!==void 0,Mt=It?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",Ut=async un=>{const On=(0,m.p$)(un);Ke.setState({datasource:On}),qe()},an=async un=>{Ke.setState({defaultOptions:un}),qe()},cn=un=>{Ke.setState({allowCustomValue:un.currentTarget.checked})};return(0,i.jsx)(J,{defaultOptions:mt,datasource:lt??void 0,infoText:lt?Mt:void 0,onDataSourceChange:Ut,onDefaultOptionsChange:an,allowCustomValue:Lt,onAllowCustomValueChange:cn,inline:ot,datasourceSupported:It})}function Y(ge){return ge instanceof l.ZG?[new p.v({render:()=>(0,i.jsx)(z,{variable:ge,onRunQuery:n.noop,inline:!0})})]:(console.warn("getAdHocFilterOptions: variable is not an AdHocFiltersVariable"),[])}var X=e(1096);function Q({variable:ge,onRunQuery:Ke,inline:qe}){const{intervals:ot,autoStepCount:lt,autoEnabled:mt,autoMinInterval:Lt,value:Tt}=ge.useState(),It=(0,d.bx)(ot),Mt=un=>{const On=(0,d.Sm)(un.currentTarget.value),yn=On.includes(Tt)?Tt:On[0];ge.setState({intervals:On,value:yn}),Ke()},Ut=un=>{ge.setState({autoStepCount:un.value})},an=un=>{ge.setState({autoEnabled:un.target.checked})},cn=un=>{ge.setState({autoMinInterval:un.currentTarget.value})};return(0,i.jsx)(X.s,{intervals:It,autoStepCount:lt,autoEnabled:mt,onAutoCountChanged:Ut,onIntervalsChange:Mt,onAutoEnabledChange:an,onAutoMinIntervalChanged:cn,autoMinInterval:Lt,inline:qe})}function q(ge){return ge instanceof l.Yj?[new p.v({render:()=>(0,i.jsx)(Q,{variable:ge,onRunQuery:n.noop,inline:!0})})]:(console.warn("getIntervalVariableOptions: variable is not an IntervalVariable"),[])}var te=e(45861),ne=e(22787),se=e(89640),ue=e(66698),de=e(38681),ie=e(56620),he=e(83501),me=e(28799),ce=e(25379),Pe=e(18387);function Ie({variable:ge,onRunQuery:Ke}){const{datasource:qe,regex:ot,sort:lt,refresh:mt,isMulti:Lt,includeAll:Tt,allValue:It,query:Mt,allowCustomValue:Ut}=ge.useState(),{value:an}=l.jh.getTimeRange(ge).useState(),cn=gt=>{ge.setState({regex:gt.currentTarget.value})},un=gt=>{ge.setState({sort:gt.value})},On=gt=>{ge.setState({refresh:gt})},yn=gt=>{ge.setState({isMulti:gt.currentTarget.checked})},En=gt=>{ge.setState({includeAll:gt.currentTarget.checked})},Bn=gt=>{ge.setState({allValue:gt.currentTarget.value})},fa=gt=>{ge.setState({allowCustomValue:gt.currentTarget.checked})},Fn=gt=>{const Ht=(0,m.p$)(gt);if((ge.state.datasource?.type||"")!==Ht.type){ge.setState({datasource:Ht,query:"",definition:""});return}ge.setState({datasource:Ht})},Ea=gt=>{ge.setState({query:gt,definition:Ge(gt)}),Ke()};return(0,i.jsx)(me.u,{datasource:qe??void 0,onDataSourceChange:Fn,query:Mt,onQueryChange:Ea,onLegacyQueryChange:Ea,timeRange:an,regex:ot,onRegExChange:cn,sort:lt,onSortChange:un,refresh:mt,onRefreshChange:On,isMulti:!!Lt,onMultiChange:yn,includeAll:!!Tt,onIncludeAllChange:En,allValue:It??"",onAllValueChange:Bn,allowCustomValue:Ut,onAllowCustomValueChange:fa})}function Se(ge){return ge instanceof l.fS?[new p.v({render:()=>(0,i.jsx)(Me,{variable:ge})})]:(console.warn("getQueryVariableOptions: variable is not a QueryVariable"),[])}function Me({variable:ge}){const[Ke,qe]=(0,M.useState)(!1),ot=()=>{ge.refreshOptions()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(U.a,{display:"flex",direction:"column",paddingBottom:1,children:(0,i.jsx)(te.$n,{tooltip:(0,v.t)("dashboard.edit-pane.variable.open-editor-tooltip","For more variable options open variable editor"),onClick:()=>qe(!0),size:"sm",fullWidth:!0,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsOpenButton,children:(0,i.jsx)(v.x6,{i18nKey:"dashboard.edit-pane.variable.open-editor",children:"Open variable editor"})})}),(0,i.jsxs)(ne.a,{title:(0,v.t)("dashboard.edit-pane.variable.query-options.modal-title","Query Variable"),isOpen:Ke,onDismiss:()=>qe(!1),children:[(0,i.jsx)(Te,{variable:ge}),(0,i.jsxs)(ne.a.ButtonRow,{children:[(0,i.jsx)(te.$n,{variant:"primary",fill:"outline",onClick:ot,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.previewButton,children:(0,i.jsx)(v.x6,{i18nKey:"dashboard.edit-pane.variable.query-options.preview",children:"Preview"})}),(0,i.jsx)(te.$n,{variant:"secondary",fill:"outline",onClick:()=>qe(!1),"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.closeButton,children:(0,i.jsx)(v.x6,{i18nKey:"dashboard.edit-pane.variable.query-options.close",children:"Close"})})]})]})]})}function Te({variable:ge}){const{datasource:Ke,sort:qe,refresh:ot,query:lt,regex:mt}=ge.useState(),{value:Lt}=l.jh.getTimeRange(ge).useState(),{value:Tt}=(0,c.A)(async()=>{const En=await(0,s.l)().get(Ke??""),Bn=await(0,de.y)(En),fa=En?.variables?.getDefaultQuery?.();if(!lt&&fa){const Fn=typeof fa=="string"?fa:{...fa,refId:fa.refId??"A"};an(Fn)}return{datasource:En,VariableQueryEditor:Bn}},[Ke]),{datasource:It,VariableQueryEditor:Mt}=Tt??{},Ut=En=>{const Bn=(0,m.p$)(En);if((ge.state.datasource?.type||"")!==Bn.type){ge.setState({datasource:Bn,query:"",definition:""});return}ge.setState({datasource:Bn})},an=En=>{ge.setState({query:En,definition:Ge(En)})},cn=En=>{ge.setState({regex:En.currentTarget.value})},un=En=>{ge.setState({sort:En.value})},On=En=>{ge.setState({refresh:En})},yn=ye(ge);return(0,i.jsxs)("div",{"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.editor,children:[(0,i.jsx)(V.D,{label:(0,v.t)("dashboard-scene.query-variable-editor-form.label-target-data-source","Target data source"),htmlFor:"data-source-picker",children:(0,i.jsx)(H.s,{current:It,onChange:Ut,variables:!0,width:30})}),It&&Mt&&(0,i.jsx)(ue.w,{onQueryChange:an,onLegacyQueryChange:an,datasource:It,query:lt,VariableQueryEditor:Mt,timeRange:Lt}),(0,i.jsx)(ce.Z,{defaultValue:mt??"",name:(0,v.t)("dashboard-scene.query-variable-editor-form.name-regex","Regex"),description:(0,i.jsxs)("div",{children:[(0,i.jsx)(v.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-optional",children:"Optional, if you want to extract part of a series name or metric node segment."}),(0,i.jsx)("br",{}),(0,i.jsxs)(v.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-examples",children:["Named capture groups can be used to separate the display text and value (",(0,i.jsx)(se.Y,{href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",external:!0,children:"see examples"}),")."]})]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:cn,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,i.jsx)(he.z,{testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:un,sort:qe}),(0,i.jsx)(ie.U,{testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:On,refresh:ot}),yn&&(0,i.jsx)(Pe.j,{options:ge.getOptionsForSelect(!1)})]})}function Ge(ge){return typeof ge=="string"?ge:ge.hasOwnProperty("query")&&typeof ge.query=="string"?ge.query:""}var Qe=e(49602);function tt({defaultValue:ge,value:Ke,onChange:qe,onBlur:ot,inline:lt}){return(0,i.jsxs)(i.Fragment,{children:[!lt&&(0,i.jsx)(k.Y,{children:(0,i.jsx)(v.x6,{i18nKey:"dashboard-scene.text-box-variable-form.text-options",children:"Text options"})}),(0,i.jsx)(Qe._,{value:Ke,defaultValue:ge,name:lt?void 0:(0,v.t)("dashboard-scene.text-box-variable.name-default-value","Default value"),placeholder:(0,v.t)("dashboard-scene.text-box-variable-form.placeholder-default-value-if-any","(optional)"),onChange:qe,onBlur:ot,width:30,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function ke({variable:ge,inline:Ke}){const{value:qe}=ge.useState(),ot=lt=>{ge.setState({value:lt.currentTarget.value})};return(0,i.jsx)(tt,{defaultValue:qe,onBlur:ot,inline:Ke})}function He(ge){return ge instanceof l.TS?[new p.v({title:(0,v.t)("dashboard-scene.textbox-variable-form.label-value","Value"),render:()=>(0,i.jsx)(ke,{onChange:n.noop,variable:ge,inline:!0})})]:(console.warn("getTextBoxVariableOptions: variable is not a TextBoxVariable"),[])}function Re(ge){return ge!=="system"}const Ne={custom:{name:"Custom",description:"Values are static and defined manually",editor:T,getOptions:O},query:{name:"Query",description:"Values are fetched from a data source query",editor:Ie,getOptions:Se},constant:{name:"Constant",description:"A hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:u,getOptions:b},interval:{name:"Interval",description:"Values are timespans, ex 1m, 1h, 1d",editor:Q,getOptions:q},datasource:{name:"Data source",description:"Dynamically switch the data source for multiple panels",editor:B,getOptions:S},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:r,getOptions:g},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:z,getOptions:Y},textbox:{name:"Textbox",description:"Users can enter any arbitrary strings in a textbox",editor:ke,getOptions:He}};function Ae(ge){const Ke=Ne[ge];if(!Ke)throw new Error(`Variable type ${ge} not found`);return Ke}const Ue=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function Be(){const ge=Ue.map(Ke=>({label:Ne[Ke].name,value:Ke,description:Ne[Ke].description}));return a.$.featureToggles.groupByVariable?ge:ge.filter(Ke=>Ke.value!=="groupby")}function We(ge){return Ne[ge].editor}function _e(ge,Ke){switch(ge){case"custom":return new l.yP(Ke);case"query":return new l.fS(Ke);case"constant":return new l.x0({...Ke,hide:o.zL.hideVariable});case"interval":return new l.Yj(Ke);case"datasource":return new l.mI(Ke);case"adhoc":return new l.H9({...Ke,layout:a.$.featureToggles.newFiltersUI?"combobox":void 0});case"groupby":return new l.ZG(Ke);case"textbox":return new l.TS(Ke)}}function Xe(ge){const qe=le("query",ge);return new l.fS({name:qe})}function le(ge,Ke){let qe=0,ot=`${ge}${qe}`;for(;Ke.find(lt=>lt.state.name===ot);)ot=`${ge}${++qe}`;return ot}function ye(ge){return"options"in ge.state||"intervals"in ge.state}function pe(ge){let Ke="";return ge instanceof l.fS?Ke=ge.state.definition||(typeof ge.state.query=="string"?ge.state.query:""):ge instanceof l.mI?Ke=String(ge.state.pluginId):ge instanceof l.yP?Ke=ge.state.query:ge instanceof l.Yj?Ke=(0,d.bx)(ge.state.intervals):(ge instanceof l.TS||ge instanceof l.x0)&&(Ke=String(ge.state.value)),Ke}function ve(){const ge=(0,s.l)().getList({metrics:!0,variables:!0});return(0,n.chain)(ge).uniqBy("meta.id").map(qe=>({label:qe.meta.name,value:qe.meta.id})).value()}function be(ge){return"type"in ge.state&&"getValue"in ge}function Oe(ge){return be(ge)?l.Go.isAdHocVariable(ge)||l.Go.isConstantVariable(ge)||l.Go.isCustomVariable(ge)||l.Go.isDataSourceVariable(ge)||l.Go.isIntervalVariable(ge)||l.Go.isQueryVariable(ge)||l.Go.isTextBoxVariable(ge)||l.Go.isGroupByVariable(ge):!1}const we=/^(?!__).*$/,ze=/^\w+$/;function Ve(ge,Ke){const qe=ge.parent;if(!(qe instanceof l.Pj))throw new Error("Variable parent is not a SceneVariableSet");if(!we.test(Ke))return{isValid:!1,errorMessage:"Template names cannot begin with '__', that's reserved for Grafana's global variables"};if(!ze.test(Ke))return{isValid:!1,errorMessage:"Only word characters are allowed in variable names"};const ot=qe.getByName(Ke);return ot&&ot!==ge?{isValid:!1,errorMessage:"Variable with the same name already exists"}:{isValid:!0}}},34753:(Z,R,e)=>{"use strict";e.d(R,{D:()=>r});var n=e(74848),a=e(22803),s=e(2543),l=e(63142),o=e(30703);const d=({diff:y})=>{const v=(0,l.of)(i),x=!(0,s.isUndefined)(y.originalValue)&&!(0,s.isArray)(y.originalValue)&&!(0,s.isObject)(y.originalValue),f=!(0,s.isUndefined)(y.value)&&!(0,s.isArray)(y.value)&&!(0,s.isObject)(y.value);return(0,n.jsxs)(n.Fragment,{children:[x&&(0,n.jsx)("span",{className:v,children:String(y.originalValue)}),x&&f?(0,n.jsx)(o.I,{name:"arrow-right"}):null,f&&(0,n.jsx)("span",{className:v,children:String(y.value)})]})},i=y=>(0,a.css)({backgroundColor:y.colors.action.hover,borderRadius:y.shape.radius.default,color:y.colors.text.primary,fontSize:y.typography.body.fontSize,margin:y.spacing(0,.5),padding:y.spacing(.25,.5)});var c=e(61371);const m={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},p=({diff:y,title:v})=>{const x=(0,l.of)(h);return y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.I,{type:"mono",name:"circle",className:x[y.op],size:"xs"})," ",(0,n.jsx)("span",{className:x.embolden,children:v})," ",(0,n.jsx)("span",{children:(0,c.Fl)(y,y.path?.length>1)})," ",(0,n.jsx)(d,{diff:y})]}):(0,n.jsxs)("div",{className:x.withoutDiff,children:[(0,n.jsx)(o.I,{type:"mono",name:"circle",className:x.replace,size:"xs"})," ",(0,n.jsx)("span",{className:x.embolden,children:v})," ",(0,n.jsx)("span",{children:(0,c.Fl)(m,!1)})]})},h=y=>({embolden:(0,a.css)({fontWeight:y.typography.fontWeightBold}),add:(0,a.css)({color:y.colors.success.main}),replace:(0,a.css)({color:y.colors.warning.main}),move:(0,a.css)({color:y.colors.warning.main}),copy:(0,a.css)({color:y.colors.success.main}),_get:(0,a.css)({color:y.colors.success.main}),test:(0,a.css)({color:y.colors.success.main}),remove:(0,a.css)({color:y.colors.error.main}),withoutDiff:(0,a.css)({marginBottom:y.spacing(1)})}),r=({diffs:y,title:v})=>{const x=(0,l.of)(g);return y.length===1?(0,n.jsx)("div",{className:x.container,"data-testid":"diffGroup",children:(0,n.jsx)(p,{title:v,diff:y[0]})}):(0,n.jsxs)("div",{className:x.container,"data-testid":"diffGroup",children:[(0,n.jsx)(p,{title:v}),(0,n.jsx)("ul",{className:x.list,children:y.map((f,u)=>(0,n.jsxs)("li",{className:x.listItem,children:[(0,n.jsx)("span",{children:(0,c.Fl)(f)})," ",(0,n.jsx)(d,{diff:f})]},`${(0,s.last)(f.path)}__${u}`))})]})},g=y=>({container:(0,a.css)({}),list:(0,a.css)({marginLeft:y.spacing(4)}),listItem:(0,a.css)({marginBottom:y.spacing(1),"&:last-child":{marginBottom:0}})})},1199:(Z,R,e)=>{"use strict";e.d(R,{M:()=>i});var n=e(74848),a=e(22803),s=e(82514),l=e.n(s),o=e(84140),d=e(63142);const i=({oldValue:c,newValue:m,...p})=>{const h=(0,d.$j)(),r={variables:{dark:{diffViewerBackground:h.colors.background.canvas,diffViewerColor:h.colors.text.primary,addedBackground:(0,o.A)(h.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,o.A)(h.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,o.A)(h.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,o.A)(h.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,o.A)(h.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,o.A)(h.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:h.colors.background.primary,gutterBackgroundDark:h.colors.background.primary,highlightBackground:(0,o.A)(h.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,o.A)(h.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:h.colors.background.secondary,codeFoldBackground:h.colors.background.secondary,emptyLineBackground:h.colors.background.secondary,gutterColor:h.colors.text.disabled,addedGutterColor:h.colors.text.primary,removedGutterColor:h.colors.text.primary,codeFoldContentColor:h.colors.text.disabled,diffViewerTitleBackground:h.colors.background.secondary,diffViewerTitleColor:h.colors.text.disabled,diffViewerTitleBorderColor:h.colors.border.strong}},codeFold:{fontSize:h.typography.bodySmall.fontSize},gutter:{pre:{color:(0,o.A)(h.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,n.jsx)("div",{className:(0,a.css)({fontSize:h.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,n.jsx)(l(),{styles:r,oldValue:c,newValue:m,splitView:!1,compareMethod:s.DiffMethod.CSS,useDarkTheme:h.isDark,...p})})}},19161:(Z,R,e)=>{"use strict";e.d(R,{w:()=>s});var n=e(68143);class a{getHistoryList(o,d){return typeof o!="string"?Promise.resolve([]):(0,n.AI)().get(`api/dashboards/uid/${o}/versions`,d)}getDashboardVersion(o,d){return typeof o!="string"?Promise.resolve({}):(0,n.AI)().get(`api/dashboards/uid/${o}/versions/${d}`)}restoreDashboard(o,d){if(typeof o!="string")return Promise.resolve({});const i=`api/dashboards/uid/${o}/restore`;return(0,n.AI)().post(i,{version:d})}}const s=new a},10685:(Z,R,e)=>{"use strict";e.d(R,{r:()=>i});var n=e(74848),a=e(92745),s=e(41654),l=e(45861),o=e(45967),d=e(23289);const i=({hasMore:c,canCompare:m,getVersions:p,getDiff:h,isLastPage:r})=>(0,n.jsxs)(s.B,{children:[c&&(0,n.jsx)(l.$n,{type:"button",onClick:()=>{p(!0),d.c.showMoreVersionsClicked()},variant:"secondary",disabled:r,children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.versions-history-buttons.show-more-versions",children:"Show more versions"})}),(0,n.jsx)(o.m,{content:(0,a.t)("dashboard-scene.versions-history-buttons.content-select-two-versions-to-start-comparing","Select two versions to start comparing"),placement:"bottom",children:(0,n.jsx)(l.$n,{type:"button",disabled:!m,onClick:h,icon:"code-branch",children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.versions-history-buttons.compare-versions",children:"Compare versions"})})})]})},7923:(Z,R,e)=>{"use strict";e.d(R,{m:()=>m});var n=e(74848),a=e(22803),s=e(2543),l=e.n(s),o=e(92745),d=e(63142),i=e(76319),c=e(30703);const m=({onClick:h=s.noop,baseVersion:r=0,newVersion:g=0,isNewLatest:y=!1})=>{const v=(0,d.of)(p);return(0,n.jsxs)("h3",{className:v.header,children:[(0,n.jsx)(i.K,{name:"arrow-left",size:"xl",onClick:h,tooltip:(0,o.t)("dashboard-scene.version-history-header.tooltip-reset-version","Reset version")}),(0,n.jsxs)("span",{children:[(0,n.jsxs)(o.x6,{i18nKey:"dashboard-scene.version-history-header.compare-versions",children:["Comparing ",{baseVersion:r}," ",(0,n.jsx)(c.I,{name:"arrows-h"})," ",{newVersion:g}]})," ",y&&(0,n.jsx)("cite",{className:"muted",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.version-history-header.latest",children:"(Latest)"})})]})]})},p=h=>({header:(0,a.css)({fontSize:h.typography.h3.fontSize,display:"flex",gap:h.spacing(2),marginBottom:h.spacing(2)})})},61371:(Z,R,e)=>{"use strict";e.d(R,{Fl:()=>d,G4:()=>o});var n=e(16111),a=e(25504),s=e(2543),l=e.n(s);const o=(m,p)=>{const h=(0,n.UD)(m,p),r=a.stringify(m,null,2),g=a.stringify(p,null,2),y=f=>f.map(u=>{let b,E,D=0,C=0;const P=(0,s.tail)(u.path.split("/"));return u.op==="replace"&&g.pointers[u.path]&&(b=(0,s.get)(m,P),E=u.value,D=g.pointers[u.path].value.line,C=g.pointers[u.path].valueEnd.line),u.op==="add"&&g.pointers[u.path]&&(E=u.value,D=g.pointers[u.path].value.line,C=g.pointers[u.path].valueEnd.line),u.op==="remove"&&r.pointers[u.path]&&(b=(0,s.get)(m,P),D=r.pointers[u.path].value.line,C=r.pointers[u.path].valueEnd.line),{op:u.op,value:E,path:P,originalValue:b,startLineNumber:D,endLineNumber:C}}),v=f=>(0,s.sortBy)(f,"startLineNumber"),x=f=>f.reduce((u,b)=>{const E=b.path[0];return u[E]||(u[E]=[]),u[E].push(b),u},{});return(0,s.flow)([y,v,x])(h)},d=(m,p=!0)=>{const h=(0,s.last)(m.path),r=i(h),g=m.op==="remove"?m.originalValue:m.value;let y=c(m.op);return p&&(r?y+=` item ${h}`:(0,s.isArray)(g)&&!(0,s.isEmpty)(g)?y+=` ${g.length} ${h}`:y+=` ${h}`),y},i=m=>!(0,s.isNaN)((0,s.toNumber)(m)),c=m=>m==="add"?"added":m==="remove"?"deleted":"changed"},55867:(Z,R,e)=>{"use strict";e.d(R,{A:()=>g,i:()=>r});var n=e(74848),a=e(96540),s=e(51898),l=e(92745),o=e(36490),d=e(43173),i=e(87063),c=e(58662),m=e(23289);const p=s.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,h=[];function r(y){h.push(y)}function g({dashboard:y}){const v=u=>{o.Ny.partial({shareView:u})},x=(0,a.useCallback)(()=>{const u=[];h.forEach(E=>u.push(E));const b=d.$.featureToggles.kubernetesDashboards?(0,l.t)("dashboard.toolbar.new.export.tooltip.as-code","Export as code"):(0,l.t)("share-dashboard.menu.export-json-title","Export as JSON");return u.push({shareId:c.wr.export,testId:p.exportAsJson,icon:"arrow",label:b,renderCondition:!0,onClick:()=>v(c.wr.export)}),u.filter(E=>E.renderCondition)},[]),f=u=>{m.c.sharingCategoryClicked({item:u.shareId,shareResource:(0,c.hD)()}),u.onClick(y)};return(0,n.jsx)(i.W,{"data-testid":p.container,children:x().map(u=>(0,n.jsx)(i.W.Item,{testId:u.testId,label:u.label,icon:u.icon,description:u.description,onClick:()=>f(u)},u.label))})}},84330:(Z,R,e)=>{"use strict";e.d(R,{i:()=>m,j:()=>p});var n=e(74848),a=e(92745),s=e(41654),l=e(72636),o=e(77824),d=e(21285),i=e(34999),c=e(89640),m=(h=>(h.Classic="classic",h.V1Resource="v1-resource",h.V2Resource="v2-resource",h))(m||{});function p({dashboardJson:h,isSharingExternally:r,exportMode:g,isViewingYAML:y,onExportModeChange:v,onShareExternallyChange:x,onViewYAML:f}){const u=h.value?.hasLibraryPanels,b=h.value?.initialSaveModelVersion,E=h.value?.json&&"spec"in h.value.json&&"elements"in h.value.json.spec,D=E&&r&&u,C=g==="v2-resource"?(0,a.t)("export.json.export-remove-ds-refs","Remove deployment details"):(0,a.t)("share-modal.export.share-externally-label","Export for sharing externally"),P=(0,a.t)("export.json.export-mode","Model"),T=(0,a.t)("export.json.export-format","Format");return(0,n.jsxs)(s.B,{gap:2,direction:"column",children:[(0,n.jsxs)(s.B,{gap:1,direction:"column",children:[b==="v1"&&(0,n.jsxs)(s.B,{alignItems:"center",children:[(0,n.jsx)(l.J,{children:P}),(0,n.jsx)(o.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.classic","Classic"),value:"classic"},{label:(0,a.t)("dashboard-scene.resource-export.label.v1-resource","V1 Resource"),value:"v1-resource"},{label:(0,a.t)("dashboard-scene.resource-export.label.v2-resource","V2 Resource"),value:"v2-resource"}],value:g,onChange:O=>v(O)})]}),b==="v2"&&(0,n.jsxs)(s.B,{alignItems:"center",children:[(0,n.jsx)(l.J,{children:P}),(0,n.jsx)(o.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.v2-resource","V2 Resource"),value:"v2-resource"},{label:(0,a.t)("dashboard-scene.resource-export.label.v1-resource","V1 Resource"),value:"v1-resource"}],value:g,onChange:O=>v(O)})]}),g!=="classic"&&(0,n.jsxs)(s.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(l.J,{children:T}),(0,n.jsx)(o.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.json","JSON"),value:"json"},{label:(0,a.t)("dashboard-scene.resource-export.label.yaml","YAML"),value:"yaml"}],value:y?"yaml":"json",onChange:f})]}),(E||g==="classic"||b==="v2"&&g==="v1-resource")&&(0,n.jsxs)(s.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(l.J,{children:C}),(0,n.jsx)(d.d,{label:C,value:r,onChange:x})]})]}),D&&(0,n.jsx)(i.F,{title:(0,a.t)("dashboard-scene.save-dashboard-form.schema-v2-library-panels-export-title","Dashboard Schema V2 does not support exporting library panels to be used in another instance yet"),severity:"warning",children:(0,n.jsxs)(a.x6,{i18nKey:"dashboard-scene.save-dashboard-form.schema-v2-library-panels-export",children:["The dynamic dashboard functionality is experimental, and has not full feature parity with current dashboards behaviour. It is based on a new schema format, that does not support library panels. This means that when exporting the dashboard to use it in another instance, we will not include library panels. We intend to support them as we progress in the feature"," ",(0,n.jsx)(c.Y,{external:!0,href:"https://grafana.com/docs/release-life-cycle/",children:"life cycle"}),"."]})})]})}},16001:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>f,Hl:()=>v});var n=e(74848),a=e(96540),s=e(51898),l=e(92745),o=e(36490),d=e(43173),i=e(87063),c=e(73427),m=e(11257),p=e(24313),h=e(58662),r=e(23289);const g=s.Tp.pages.Dashboard.DashNav.newShareButton.menu;let y=[];function v(u){y.push(u)}function x(){y=[]}function f({dashboard:u,panel:b}){const E=P=>{o.Ny.partial({shareView:P})},D=(0,a.useCallback)(()=>{const P=[];return P.push({shareId:h.wr.link,testId:g.shareInternally,icon:"building",label:(0,l.t)("share-dashboard.menu.share-internally-title","Share internally"),renderCondition:!0,onClick:()=>E(h.wr.link)}),P.push({shareId:h.wr.publicDashboard,testId:g.shareExternally,icon:"share-alt",label:(0,l.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!b&&(0,p.iR)(),onClick:()=>{E(h.wr.publicDashboard)}}),P.push({shareId:h.wr.snapshot,testId:g.shareSnapshot,icon:"camera",label:(0,l.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:c.TP.isSignedIn&&d.$.snapshotEnabled&&c.TP.hasPermission(m.w.SnapshotsCreate),onClick:()=>{E(h.wr.snapshot)}}),y.forEach(T=>P.push(T)),P.filter(T=>T.renderCondition)},[b]),C=P=>{r.c.sharingCategoryClicked({item:P.shareId,shareResource:(0,h.hD)(b?.getRef())}),P.onClick(u)};return(0,n.jsx)(i.W,{"data-testid":g.container,children:D().map(P=>(0,n.jsxs)(a.Fragment,{children:[P.renderDividerAbove&&(0,n.jsx)(i.W.Divider,{}),(0,n.jsx)(i.W.Item,{testId:P.testId,label:P.label,icon:P.icon,description:P.description,component:P.component,className:P.className,onClick:()=>C(P)})]},P.shareId))})}},12434:(Z,R,e)=>{"use strict";e.d(R,{F7:()=>m,Xe:()=>d,yk:()=>c});var n=e(71673),a=e(58662),s=e(29043),l=e(23289);const o={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},d=async(p,h)=>{const{useAbsoluteTimeRange:r,useShortUrl:g,theme:y}=c();return l.c.shareLinkCopied({currentTimeRange:r,theme:y,shortenURL:g,shareResource:(0,a.hD)(h?.getRef())}),await(0,n.Sp)(p,{useAbsoluteTimeRange:r,theme:y,useShortUrl:g})},i="grafana.dashboard.link.shareConfiguration";function c(){return s.A.exists(i)&&s.A.getObject(i)||o}function m(p){s.A.setObject(i,p)}},25494:(Z,R,e)=>{"use strict";e.d(R,{j:()=>gn,K:()=>fn});var n=e(74848),a=e(36490),s=e(36674),l=e(8207),o=e(58662),d=e(8285),i=e(22803),c=e(20382),m=e(16817),p=e(70713),h=e(51898),r=e(92745),g=e(43173),y=e(63142),v=e(41654),x=e(21285),f=e(72636),u=e(50992),b=e(68079),E=e(45861),D=e(47931),C=e(6890),P=e(64762),T=e(8535),O=e(23289),I=e(56445),j=e(84330);const W=h.Tp.pages.ExportDashboardDrawer.ExportAsJson;class B extends I.N{static{this.Component=S}getTabLabel(){return(0,r.t)("export.json.title","Export dashboard")}}function S({model:bt}){const Vt=(0,y.of)(w),{isSharingExternally:Kt,isViewingYAML:Dt,exportMode:Zt}=bt.useState(),Ln=(0,m.A)(async()=>await bt.getExportableDashboardJson(),[Kt,Zt]),Qn=JSON.stringify(Ln.value?.json,null,2),va=c.Ay.dump(Ln.value?.json,{skipInvalid:!0}),Wn=Dt?va:Qn,ia=async()=>{await bt.onSaveAsFile();const na=(0,r.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,T.JD)((0,C.dx)((0,P.tZ)(na)))},kn=(0,r.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,n.jsxs)("div",{"data-testid":W.container,className:Vt.container,children:[(0,n.jsx)("p",{children:(0,n.jsx)(r.x6,{i18nKey:"export.json.info-text",children:"Copy or download a file containing the definition of your dashboard"})}),g.$.featureToggles.kubernetesDashboards?(0,n.jsx)(j.j,{dashboardJson:Ln,isSharingExternally:Kt??!1,exportMode:Zt??j.i.Classic,isViewingYAML:Dt??!1,onExportModeChange:bt.onExportModeChange,onShareExternallyChange:bt.onShareExternallyChange,onViewYAML:bt.onViewYAML}):(0,n.jsxs)(v.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(x.d,{label:kn,"data-testid":W.exportExternallyToggle,id:"export-externally-toggle",value:!!Kt,onChange:bt.onShareExternallyChange}),(0,n.jsx)(f.J,{children:kn})]}),(0,n.jsx)("div",{className:Vt.codeEditorBox,children:(0,n.jsx)(p.Ay,{"data-testid":W.codeEditor,children:({width:na,height:Ga})=>Wn?(0,n.jsx)(u.B,{value:Wn,language:Dt?"yaml":"json",showLineNumbers:!0,showMiniMap:!1,height:Ga,width:na,readOnly:!0}):Ln.loading&&(0,n.jsx)(b.y,{})})}),(0,n.jsx)("div",{className:Vt.buttonsContainer,children:(0,n.jsxs)(v.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(E.$n,{"data-testid":W.saveToFileButton,variant:"primary",icon:"download-alt",onClick:ia,children:(0,n.jsx)(r.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,n.jsx)(D.b,{"data-testid":W.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:Ln.loading,getText:()=>Wn??"",onClipboardCopy:()=>{O.c.exportCopyJsonClicked()},children:(0,n.jsx)(r.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,n.jsx)(E.$n,{"data-testid":W.cancelButton,variant:"secondary",onClick:bt.useState().onDismiss,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function w(bt){return{container:(0,i.css)({height:"100%"}),codeEditorBox:(0,i.css)({margin:`${bt.spacing(2,0)}`,height:"75%"}),buttonsContainer:(0,i.css)({paddingBottom:bt.spacing(2)})}}var N=e(96540),M=e(3271),L=e(73427),A=e(62905),U=e(82298),F=e(24313),V=e(11257),K=e(2416);const G=(0,N.createContext)(void 0),H=()=>{const bt=(0,N.useContext)(G);if(bt===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return bt};var _=e(49785),k=e(16780),J=e(37386),z=e(45967),Y=e(30703),X=e(63527),Q=e(66404),q=e(83692);const te=h.Tp.pages.ShareDashboardDrawer.ShareExternally.Configuration;function ne(){const bt=(0,y.of)(se),{dashboard:Vt}=H(),[Kt,{isLoading:Dt}]=(0,A.T2)(),{data:Zt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(Vt.state.uid),Ln=L.TP.hasPermission(V.w.DashboardsPublicWrite),Qn=Dt||!Ln,Wn=s.jh.getTimeRange(Vt).useState(),{handleSubmit:ia,setValue:kn,control:na}=(0,_.mN)({defaultValues:{isAnnotationsEnabled:Zt?.annotationsEnabled,isTimeSelectionEnabled:Zt?.timeSelectionEnabled}}),Ga=async(ls,Ta)=>{kn(ls,Ta),await ia(aa=>Ps({...aa,[ls]:Ta}))()},Ps=ls=>{const{isAnnotationsEnabled:Ta,isTimeSelectionEnabled:aa}=ls;Kt({dashboard:Vt,payload:{...Zt,annotationsEnabled:Ta,timeSelectionEnabled:aa}})};return(0,n.jsxs)(v.B,{direction:"column",gap:2,children:[(0,n.jsx)(Q.E,{element:"p",children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,n.jsxs)(v.B,{justifyContent:"space-between",children:[(0,n.jsx)("form",{onSubmit:ia(Ps),children:(0,n.jsx)(k.n,{disabled:Qn,children:(0,n.jsxs)(v.B,{direction:"column",gap:2,children:[(0,n.jsxs)(v.B,{gap:1,children:[(0,n.jsx)(_.xI,{render:({field:{ref:ls,...Ta}})=>(0,n.jsx)(x.d,{...Ta,"data-testid":te.enableTimeRangeSwitch,onChange:aa=>{O.c.publicDashboardTimeSelectionChanged({enabled:aa.currentTarget.checked}),Ga("isTimeSelectionEnabled",aa.currentTarget.checked)},label:(0,r.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:na,name:"isTimeSelectionEnabled"}),(0,n.jsx)(f.J,{description:(0,r.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,n.jsxs)(v.B,{gap:1,children:[(0,n.jsx)(_.xI,{render:({field:{ref:ls,...Ta}})=>(0,n.jsx)(x.d,{...Ta,"data-testid":te.enableAnnotationsSwitch,onChange:aa=>{O.c.publicDashboardAnnotationsSelectionChanged({enabled:aa.currentTarget.checked}),Ga("isAnnotationsEnabled",aa.currentTarget.checked)},label:(0,r.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:na,name:"isAnnotationsEnabled"}),(0,n.jsx)(f.J,{style:{flex:1},description:(0,r.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this dashboard"),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,n.jsxs)(v.B,{gap:1,alignItems:"flex-start",children:[(0,n.jsx)("div",{className:bt.timeRange,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.configuration.time-range-label",children:"Time range"})}),(0,n.jsx)("div",{className:(0,i.cx)(bt.timeRange,bt.timeRangeValue),children:(0,n.jsx)(q.f,{value:Wn.value})}),(0,n.jsx)(z.m,{placement:"right",content:(0,r.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(Y.I,{name:"info-circle",size:"md"})})]})]})})}),Dt&&(0,n.jsx)(b.y,{})]})]})}const se=bt=>({timeRange:(0,i.css)({fontSize:bt.typography.bodySmall.fontSize,fontWeight:bt.typography.bodySmall.fontWeight}),timeRangeValue:(0,i.css)({color:bt.colors.text.secondary})});var ue=e(87063),de=e(88559),ie=e(76319);const he=h.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,me=({onDelete:bt,onReshare:Vt})=>(0,n.jsxs)(ue.W,{children:[(0,n.jsx)(ue.W.Item,{label:(0,r.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:Vt}),(0,n.jsx)(ue.W.Item,{label:(0,r.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:bt})]}),ce=({recipients:bt,dashboardUid:Vt,publicDashboard:Kt})=>{const Dt=(0,y.of)(Ie),[Zt,{isLoading:Ln}]=(0,A.$L)(),[Qn,{isLoading:va}]=(0,A.NA)(),Wn=Ln||va,ia=(na,Ga)=>{O.c.revokePublicDashboardEmailClicked(),Zt({recipientUid:na,recipientEmail:Ga,dashboardUid:Vt,uid:Kt.uid})},kn=na=>{O.c.resendPublicDashboardEmailClicked(),Qn({recipientUid:na,uid:Kt.uid})};return(0,n.jsx)("table",{"data-testid":he.EmailSharingList,className:Dt.table,children:(0,n.jsx)("tbody",{children:bt.map((na,Ga)=>(0,n.jsxs)("tr",{className:Dt.listItem,children:[(0,n.jsx)("td",{className:Dt.user,children:(0,n.jsxs)(v.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{className:Dt.icon,children:(0,n.jsx)(Y.I,{name:"user"})}),(0,n.jsx)(Q.E,{children:na.recipient})]})}),(0,n.jsx)("td",{children:Wn&&(0,n.jsx)(b.y,{})}),(0,n.jsx)("td",{children:(0,n.jsx)(de.m,{overlay:(0,n.jsx)(me,{onDelete:()=>ia(na.uid,na.recipient),onReshare:()=>kn(na.uid)}),children:(0,n.jsx)(ie.K,{name:"ellipsis-v","aria-label":(0,r.t)("dashboard-scene.email-list.aria-label-emailmenu","Toggle email menu"),variant:"secondary",size:"lg"})})})]},na.uid))})})},Pe=({dashboard:bt})=>{const Vt=(0,y.of)(Ie),{data:Kt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(bt.state.uid);return(0,n.jsx)(J.D,{label:(0,r.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,r.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:Vt.listField,children:Kt?.recipients?.length?(0,n.jsx)("div",{className:Vt.listContainer,children:(0,n.jsx)(ce,{recipients:Kt.recipients,dashboardUid:bt.state.uid,publicDashboard:Kt})}):(0,n.jsx)(n.Fragment,{})})},Ie=bt=>({listField:(0,i.css)({marginBottom:0}),listContainer:(0,i.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,i.css)({width:"100%"}),listItem:(0,i.css)({display:"flex",alignItems:"center",gap:bt.spacing(.5),padding:bt.spacing(.75,1),color:bt.colors.text.secondary}),user:(0,i.css)({flex:1}),icon:(0,i.css)({border:`${bt.spacing(.25)} solid ${bt.colors.text.secondary}`,padding:bt.spacing(.125,.5),borderRadius:bt.shape.radius.circle,color:bt.colors.text.secondary})}),Se=h.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Me=()=>{const{dashboard:bt}=H(),{data:Vt,isError:Kt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(bt.state.uid),[Dt,{isLoading:Zt}]=(0,A.NY)(),Ln=L.TP.hasPermission(V.w.DashboardsPublicWrite),{register:Qn,handleSubmit:va,formState:{errors:Wn,isValid:ia},reset:kn}=(0,_.mN)({defaultValues:{email:""},mode:"onSubmit"}),na=async Ga=>{O.c.publicDashboardEmailInviteClicked(),await Dt({recipient:Ga.email,uid:Vt.uid,dashboardUid:bt.state.uid}).unwrap(),kn({email:""})};return(0,n.jsxs)("div",{children:[(0,n.jsx)("form",{onSubmit:va(na),children:(0,n.jsx)(k.n,{disabled:!Ln||Kt,children:(0,n.jsx)(J.D,{label:(0,n.jsxs)(v.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,n.jsx)(z.m,{placement:"right",content:(0,r.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,n.jsx)(Y.I,{name:"info-circle",size:"sm"})})]}),description:(0,r.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:Wn.email?.message,invalid:!!Wn.email?.message,children:(0,n.jsxs)(v.B,{direction:"row",children:[(0,n.jsx)(X.p,{placeholder:(0,r.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:Zt,...Qn("email",{required:(0,r.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:F._l,message:(0,r.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":Se.EmailSharingInput}),(0,n.jsx)(E.$n,{type:"submit",variant:"primary",disabled:Zt||!ia,"data-testid":Se.EmailSharingInviteButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,n.jsx)(Pe,{dashboard:bt}),(0,n.jsx)(M.c,{}),(0,n.jsx)(ne,{})]})};var Te=e(32635),Ge=e(34999);const Qe="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#share-externally-with-specific-people",tt=h.Tp.pages.ShareDashboardDrawer.ShareExternally;function ke(){return(0,n.jsx)(Ge.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":tt.emailSharingAlert,children:(0,n.jsxs)(v.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:()=>window.open(Qe,"_blank"),type:"button",children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const He=h.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation,Re=({hasError:bt})=>{const{dashboard:Vt,onDismiss:Kt}=H(),Dt=(0,y.of)(Ne),[Zt,{isLoading:Ln,isError:Qn}]=(0,A.U9)(),va=L.TP.hasPermission(V.w.DashboardsPublicWrite),Wn=!va||Ln||Qn||bt,{handleSubmit:ia,register:kn,formState:{isValid:na}}=(0,_.mN)({mode:"onChange"}),Ga=()=>{O.c.generatePublicDashboardUrlClicked({share:F.Xo.EMAIL}),Zt({dashboard:Vt,payload:{share:F.Xo.EMAIL,isEnabled:!0}})};return(0,n.jsxs)(n.Fragment,{children:[va&&(0,n.jsx)(ke,{}),(0,n.jsx)("form",{onSubmit:ia(Ga),children:(0,n.jsxs)(k.n,{disabled:Wn,children:[(0,n.jsx)("div",{className:Dt.checkbox,children:(0,n.jsx)(Te.S,{...kn("billAcknowledgment",{required:!0}),label:(0,r.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,n.jsxs)(v.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(E.$n,{type:"submit",disabled:!na,"data-testid":He.EmailShare.createButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:Kt,"data-testid":He.EmailShare.cancelButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),Ln&&(0,n.jsx)(b.y,{})]})]})})]})},Ne=bt=>({checkbox:(0,i.css)({marginBottom:bt.spacing(2)})}),Ae=()=>{const{dashboard:bt}=H(),{data:Vt,isError:Kt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(bt.state.uid);return(0,n.jsx)(n.Fragment,{children:Vt?(0,n.jsx)(Me,{}):(0,n.jsx)(Re,{hasError:Kt})})},Ue="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards",Be=h.Tp.pages.ShareDashboardDrawer.ShareExternally,We=()=>(0,n.jsx)(Ge.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Be.publicAlert,children:(0,n.jsxs)(v.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:()=>window.open(Ue,"_blank"),type:"button",children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})}),_e=h.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation;function Xe({hasError:bt}){const{dashboard:Vt,onDismiss:Kt}=H(),Dt=(0,y.of)(le),Zt=L.TP.hasPermission(V.w.DashboardsPublicWrite),{handleSubmit:Ln,register:Qn,formState:{isValid:va}}=(0,_.mN)({mode:"onChange"}),[Wn,{isLoading:ia,isError:kn}]=(0,A.U9)(),na=()=>{O.c.generatePublicDashboardUrlClicked({share:F.Xo.PUBLIC}),Wn({dashboard:Vt,payload:{share:F.Xo.PUBLIC,isEnabled:!0}})},Ga=!Zt||ia||kn||bt;return(0,n.jsxs)(n.Fragment,{children:[Zt&&(0,n.jsx)(We,{}),(0,n.jsx)("form",{onSubmit:Ln(na),children:(0,n.jsxs)(k.n,{disabled:Ga,children:[(0,n.jsx)("div",{className:Dt.checkbox,children:(0,n.jsx)(Te.S,{...Qn("publicAcknowledgment",{required:!0}),label:(0,r.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*"),"data-testid":_e.willBePublicCheckbox})}),(0,n.jsxs)(v.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(E.$n,{type:"submit",disabled:!va,"data-testid":_e.PublicShare.createButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:Kt,"data-testid":_e.PublicShare.cancelButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),ia&&(0,n.jsx)(b.y,{})]})]})})]})}const le=bt=>({checkbox:(0,i.css)({marginBottom:bt.spacing(2)})});function ye(){const{dashboard:bt}=H(),{data:Vt,isError:Kt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(bt.state.uid);return(0,n.jsx)(n.Fragment,{children:Vt?(0,n.jsx)(ne,{}):(0,n.jsx)(Xe,{hasError:Kt})})}var pe=e(37672),ve=e(44173),be=e(35195),Oe=e(71748);function we({publicDashboard:bt}){const{dashboard:Vt}=H(),Kt=L.TP.hasPermission(V.w.DashboardsPublicWrite),Dt=(0,Oe.b)(Vt),Zt=(Vt.state.$variables?.state.variables.length??0)>0;return(0,n.jsxs)(n.Fragment,{children:[Kt&&Zt&&(0,n.jsx)(ve.D,{showDescription:!1}),!Kt&&(0,n.jsx)(be.t,{mode:bt?"edit":"create"}),Kt&&!!Dt?.length&&(0,n.jsx)(pe.s,{unsupportedDataSources:Dt.join(", ")}),bt?.share===F.Xo.EMAIL&&(0,F.AY)()&&(0,n.jsx)(ke,{}),bt?.share===F.Xo.PUBLIC&&(0,n.jsx)(We,{})]})}var ze=e(30360),Ve=e(18857);const ge=()=>({label:(0,r.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,r.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:F.Xo.PUBLIC,icon:"globe"}),Ke=()=>({label:(0,r.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,r.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:F.Xo.EMAIL,icon:"users-alt"}),qe=h.Tp.pages.ShareDashboardDrawer.ShareExternally;function ot({setShareType:bt,options:Vt,value:Kt}){const{dashboard:Dt}=H(),Zt=(0,y.of)(lt),{data:Ln}=A.Sm.endpoints?.getPublicDashboard.useQueryState(Dt.state.uid),[Qn,{isLoading:va}]=(0,A.ft)(),Wn=L.TP.hasPermission(V.w.DashboardsPublicWrite),ia=ge(),kn=na=>{if(!Ln)return;O.c.publicDashboardShareTypeChange({shareType:na===F.Xo.EMAIL?"email":"public"});const Ga={dashboard:Dt,payload:{...Ln,share:na}};Qn(Ga)};return(0,n.jsxs)("div",{children:[(0,n.jsxs)(v.B,{justifyContent:"space-between",children:[(0,n.jsx)(f.J,{description:Kt.description,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),va&&(0,n.jsx)(b.y,{})]}),(0,F.AY)()?(0,n.jsx)(Ve.l6,{"data-testid":qe.shareTypeSelect,options:Vt,value:Kt,disabled:!Wn,onChange:na=>{bt(na),kn(na.value)},className:Zt.select}):(0,n.jsxs)(v.B,{gap:1,alignItems:"center",children:[(0,ze.Uo)(ia.icon)&&(0,n.jsx)(Y.I,{name:(0,ze.Uo)(ia.icon)}),(0,n.jsx)(Q.E,{children:ia.label})]})]})}const lt=()=>({select:(0,i.css)({flex:1})}),mt=h.Tp.pages.ShareDashboardDrawer.ShareExternally,Lt=()=>(0,F.AY)()?[Ke(),ge()]:[ge()];class Tt extends s.Bs{static{this.Component=It}getTabLabel(){return(0,r.t)("share-dashboard.menu.share-externally-title","Share externally")}}function It({model:bt}){const[Vt,Kt]=(0,N.useState)(!1),Dt=(0,y.of)(an),Zt=(0,d.YQ)(bt),{data:Ln,isLoading:Qn}=(0,A.Bs)(Zt.state.uid),[va,{isLoading:Wn}]=(0,A.bN)(),ia=()=>{Kt(!0)},kn=async()=>{O.c.revokePublicDashboardClicked(),await va({dashboard:Zt,uid:Ln.uid,dashboardUid:Zt.state.uid}).unwrap(),Kt(!1)};return Qn?(0,n.jsx)(U.a,{}):Vt?(0,n.jsx)(K.Z,{title:(0,r.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,r.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:kn,onDismiss:()=>Kt(!1),description:(0,r.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:Wn}):(0,n.jsx)("div",{className:Dt.container,children:(0,n.jsx)(Mt,{publicDashboard:Ln,onRevokeClick:ia})})}function Mt({publicDashboard:bt,onRevokeClick:Vt}){const Kt=Lt(),Dt=(0,N.useMemo)(()=>bt&&(0,F.AY)()?Kt.find(Wn=>Wn.value===bt?.share)??Kt[0]:Kt[0],[bt,Kt]),[Zt,Ln]=(0,N.useState)(Dt),Qn=(0,N.useMemo)(()=>Zt.value===F.Xo.EMAIL&&(0,F.AY)()?(0,n.jsx)(Ae,{}):(0,n.jsx)(ye,{}),[Zt]);return(0,n.jsxs)(v.B,{direction:"column",gap:2,"data-testid":mt.container,children:[(0,n.jsx)(we,{publicDashboard:bt}),(0,n.jsx)(ot,{setShareType:Ln,value:Zt,options:Kt}),Qn,bt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.c,{spacing:0}),(0,n.jsx)(Ut,{publicDashboard:bt,onRevokeClick:Vt})]})]})}function Ut({publicDashboard:bt,onRevokeClick:Vt}){const{dashboard:Kt}=H(),[Dt,{isLoading:Zt}]=(0,A.eq)(),Ln=(0,y.of)(an),Qn=L.TP.hasPermission(V.w.DashboardsPublicWrite);function va(){O.c.publicDashboardUrlCopied()}const Wn=async()=>{O.c.publicDashboardPauseSharingClicked({paused:!bt.isEnabled}),Dt({dashboard:Kt,payload:{...bt,isEnabled:!bt.isEnabled}})};return(0,n.jsxs)(v.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,n.jsx)("div",{className:Ln.actionsContainer,children:(0,n.jsxs)(v.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(D.b,{"data-testid":mt.Configuration.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,F.mL)(bt.accessToken),onClipboardCopy:va,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,n.jsx)(E.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:Zt||!Qn,onClick:Vt,"data-testid":mt.Configuration.revokeAccessButton,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,n.jsx)(E.$n,{icon:bt.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:bt.isEnabled?(0,r.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:Wn,disabled:Zt||!Qn,"data-testid":mt.Configuration.toggleAccessButton,children:bt.isEnabled?(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),Zt&&(0,n.jsx)(b.y,{})]})}const an=bt=>({container:(0,i.css)({paddingBottom:bt.spacing(2)}),actionsContainer:(0,i.css)({width:"100%"})});var cn=e(29216);const un=h.Tp.pages.ShareDashboardDrawer.ShareInternally;function On({useLockedTime:bt,onToggleLockedTime:Vt,useShortUrl:Kt,onUrlShorten:Dt,onChangeTheme:Zt,selectedTheme:Ln,isLoading:Qn}){return(0,n.jsxs)(v.B,{justifyContent:"space-between",children:[(0,n.jsxs)(v.B,{gap:2,direction:"column",children:[(0,n.jsxs)(v.B,{gap:1,direction:"column",children:[(0,n.jsxs)(v.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(x.d,{label:(0,r.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:bt,onChange:Vt,"data-testid":un.lockTimeRangeSwitch}),(0,n.jsx)(f.J,{description:(0,r.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,n.jsx)(r.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,n.jsxs)(v.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(x.d,{id:"share-short-url",value:Kt,label:(0,r.t)("link.share.short-url-label","Shorten link"),onChange:Dt,"data-testid":un.shortenUrlSwitch}),(0,n.jsx)(f.J,{children:(0,n.jsx)(r.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,n.jsx)(cn.w,{selectedTheme:Ln,onChange:Zt})]}),Qn&&(0,n.jsx)(b.y,{})]})}var yn=e(8655),En=e(12434);const Bn=h.Tp.pages.ShareDashboardDrawer.ShareInternally;class fa extends yn.R{static{this.Component=Fn}constructor(Vt){const{useAbsoluteTimeRange:Kt,useShortUrl:Dt,theme:Zt}=(0,En.yk)();super({...Vt,useLockedTime:Kt,useShortUrl:Dt,selectedTheme:Zt}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}getTabLabel(){return(0,r.t)("share-dashboard.menu.share-internally-title","Share internally")}async onToggleLockedTime(){const Vt=!this.state.useLockedTime;(0,En.F7)({useAbsoluteTimeRange:Vt,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const Vt=!this.state.useShortUrl;(0,En.F7)({useShortUrl:Vt,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(Vt){(0,En.F7)({theme:Vt,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(Vt)}}function Fn({model:bt}){const Vt=(0,y.of)(Ea),{useLockedTime:Kt,useShortUrl:Dt,selectedTheme:Zt,isBuildUrlLoading:Ln}=bt.useState();return(0,n.jsxs)("div",{className:Bn.container,children:[(0,n.jsx)(Ge.F,{severity:"info",title:(0,r.t)("link.share.config-alert-title","Link settings"),children:(0,n.jsx)(r.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes. Please note that these settings are saved within your current browser scope."})}),(0,n.jsx)("div",{className:Vt.configDescription,children:(0,n.jsx)(Q.E,{variant:"body",children:(0,n.jsx)(r.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,n.jsx)(On,{useLockedTime:Kt,onToggleLockedTime:bt.onToggleLockedTime,useShortUrl:Dt,onUrlShorten:bt.onUrlShorten,selectedTheme:Zt,onChangeTheme:bt.onThemeChange,isLoading:Ln}),(0,n.jsx)(M.c,{spacing:1}),(0,n.jsx)(v.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Ln,getText:bt.getShareUrl,onClipboardCopy:bt.onCopy,className:Vt.copyButtonContainer,"data-testid":Bn.copyUrlButton,children:(0,n.jsx)(r.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})})]})}const Ea=bt=>({configDescription:(0,i.css)({marginBottom:bt.spacing(2)}),copyButtonContainer:(0,i.css)({marginTop:bt.spacing(2)})});var gt=e(5805),Ht=e(89640),wt=e(15130),Yt=e(51155),rn=e(77824);const Xt="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#share-a-snapshot",on="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#panel-snapshot";function pn({name:bt,onNameChange:Vt,onExpireChange:Kt,selectedExpireOption:Dt,panelRef:Zt,disableInputs:Ln,children:Qn}){const va=(0,y.of)(Un);return(0,n.jsxs)("div",{className:va.container,children:[(0,n.jsx)(Ge.F,{severity:"info",title:"",children:(0,n.jsxs)(v.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(Q.E,{children:Zt?(0,n.jsx)(r.x6,{i18nKey:"snapshot.share-panel.info-alert",children:"A Grafana panel snapshot publicly shares a panel while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."}):(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:()=>window.open(Zt?on:Xt,"_blank"),type:"button",children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,n.jsxs)("fieldset",{disabled:Ln,children:[(0,n.jsx)(J.D,{label:(0,r.t)("snapshot.share.name-label","Snapshot name"),children:(0,n.jsx)(X.p,{id:"snapshot-name-input",value:bt,onChange:Wn=>Vt(Wn.currentTarget.value)})}),(0,n.jsx)(J.D,{label:(0,r.t)("snapshot.share.expiration-label","Expires in"),children:(0,n.jsx)(rn.z,{id:"expire-select-input",options:(0,Yt.u)(),value:Dt?.value,onChange:Kt})})]}),(0,n.jsx)(M.c,{}),Qn]})}const Un=bt=>({container:(0,i.css)({paddingBottom:bt.spacing(2)})}),In=h.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class Gn extends Yt.l{static{this.Component=Wa}getTabLabel(){return(0,r.t)("share-dashboard.menu.share-snapshot-title","Share snapshot")}}function Wa({model:bt}){const[Vt,Kt]=(0,N.useState)(!1),[Dt,Zt]=(0,N.useState)(!1),[Ln,Qn]=(0,N.useState)(1),{snapshotName:va,snapshotSharingOptions:Wn,selectedExpireOption:ia,panelRef:kn,onDismiss:na,dashboardRef:Ga}=bt.useState(),[Ps,ls]=(0,gt.default)(async(lr=!1)=>{const Xs=await bt.onSnapshotCreate(lr);return Qn(2),Xs}),[Ta,aa]=(0,gt.default)(async lr=>{const Xs=await bt.onSnapshotDelete(lr);return Qn(1),Kt(!1),Zt(!0),Xs}),Gs=()=>{na?.()},Os=()=>{bt.onSnasphotNameChange(Ga.resolve().state.title),Qn(1)},Zs=async()=>{await aa(Ps.value?.deleteUrl),Os()};return Vt?(0,n.jsx)(K.Z,{title:(0,r.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,r.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:Zs,onDismiss:()=>Kt(!1),description:(0,r.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:Ta.loading}):(0,n.jsx)("div",{"data-testid":In.container,children:(0,n.jsxs)(n.Fragment,{children:[Ln===1&&Dt&&(0,n.jsx)(Ge.F,{severity:"info",title:"",onRemove:()=>Zt(!1),children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Snapshot deleted. It could take an hour to be cleared from CDN caches."})}),(0,n.jsx)(pn,{name:va??"",selectedExpireOption:ia,onNameChange:bt.onSnasphotNameChange,onExpireChange:bt.onExpireChange,disableInputs:Ln===2,panelRef:kn,children:(0,n.jsxs)(v.B,{justifyContent:"space-between",gap:{xs:2},direction:{xs:"column",xl:"row"},children:[Ln===1?(0,n.jsx)(za,{onCreateClick:ls,isLoading:Ps.loading,onCancelClick:Gs,sharingOptions:Wn}):Ln===2&&Ps.value&&(0,n.jsx)(Oa,{url:Ps.value.url,onDeleteClick:()=>Kt(!0),onNewSnapshotClick:Os}),(0,n.jsx)(Ht.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",external:!0,children:(0,r.t)("snapshot.share.view-all-button","View all snapshots")})]})})]})})}const za=({isLoading:bt,onCreateClick:Vt,onCancelClick:Kt,sharingOptions:Dt})=>(0,n.jsxs)(v.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(E.$n,{variant:"primary",disabled:bt,onClick:()=>Vt(),"data-testid":In.publishSnapshot,children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),Dt?.externalEnabled&&(0,n.jsx)(E.$n,{variant:"secondary",disabled:bt,onClick:()=>Vt(!0),children:Dt?.externalSnapshotName}),(0,n.jsx)(E.$n,{variant:"secondary",fill:"outline",onClick:Kt,children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),bt&&(0,n.jsx)(b.y,{})]}),Oa=({url:bt,onDeleteClick:Vt,onNewSnapshotClick:Kt})=>{const Dt=wt.TP.hasPermission(V.w.SnapshotsDelete),Zt=Dt?"":(0,r.t)("snapshot.share.delete-permission-tooltip","You don't have permission to delete snapshots");return(0,n.jsxs)(v.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>bt,"data-testid":In.copyUrlButton,children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,n.jsx)(E.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:Vt,disabled:!Dt,tooltip:Zt,children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,n.jsx)(E.$n,{variant:"secondary",fill:"solid",onClick:Kt,children:(0,n.jsx)(r.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]})};var ss=e(89752),La=e(42656),Ca=e(4213),Ka=e.n(Ca),As=e(41053),Ia=e(75505),_s=e(68143),Fa=e(47327);const xt=h.Tp.pages.ShareDashboardDrawer.ShareInternally.SharePanel;function dt({title:bt,imageUrl:Vt,buildUrl:Kt,disabled:Dt,theme:Zt}){const Ln=(0,y.of)(St),{handleSubmit:Qn,register:va,watch:Wn,formState:{errors:ia,isValid:kn}}=(0,_.mN)({mode:"onChange",defaultValues:{width:1e3,height:500,scaleFactor:1}});(0,N.useEffect)(()=>{Kt({width:Wn("width"),height:Wn("height"),scale:Wn("scaleFactor")})},[Kt,Wn]);const[{loading:na,value:Ga,error:Ps},ls]=(0,As.A)(async Os=>{const Zs=await(0,Ia.s)((0,_s.AI)().fetch({url:Os,responseType:"blob"}));return new Blob([Zs.data],{type:"image/png"})},[]),Ta=async Os=>{const{width:Zs,height:lr,scaleFactor:Xs}=Os;O.c.generatePanelImageClicked({width:Zs,height:lr,scaleFactor:Xs,theme:Zt,shareResource:"panel"}),await ls(Vt)},aa=()=>{O.c.downloadPanelImageClicked({shareResource:"panel"}),Ka()(Ga,`${bt}.png`)},Gs=()=>{Kt({width:Wn("width"),height:Wn("height"),scale:Wn("scaleFactor")})};return(0,n.jsx)("div",{"data-testid":xt.preview,children:(0,n.jsxs)(v.B,{gap:2,direction:"column",children:[(0,n.jsx)(Q.E,{element:"h4",children:(0,n.jsx)(r.x6,{i18nKey:"share-panel-image.preview.title",children:"Panel preview"})}),(0,n.jsx)("form",{onSubmit:Qn(Ta),children:(0,n.jsxs)(k.n,{disabled:!g.$.rendererAvailable,label:(0,n.jsxs)(v.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(Q.E,{element:"h5",children:(0,n.jsx)(r.x6,{i18nKey:"share-panel-image.settings.title",children:"Image settings"})}),(0,n.jsx)(z.m,{content:(0,r.t)("share-panel-image.settings.max-warning","Setting maximums are limited by the image renderer service"),children:(0,n.jsx)(Y.I,{name:"info-circle",size:"sm"})})]}),children:[(0,n.jsxs)(v.B,{gap:1,justifyContent:"space-between",direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(J.D,{label:(0,r.t)("share-panel-image.settings.width-label","Width"),className:Ln.imageConfigurationField,required:!0,invalid:!!ia.width,error:ia.width?.message,children:(0,n.jsx)(X.p,{...va("width",{required:(0,r.t)("share-panel-image.settings.width-required","Width is required"),min:{value:1,message:(0,r.t)("share-panel-image.settings.width-min","Width must be equal or greater than 1")},valueAsNumber:!0,onChange:Gs}),placeholder:(0,r.t)("share-panel-image.settings.width-placeholder","1000"),type:"number",suffix:"px","data-testid":xt.widthInput})}),(0,n.jsx)(J.D,{label:(0,r.t)("share-panel-image.settings.height-label","Height"),className:Ln.imageConfigurationField,required:!0,invalid:!!ia.height,error:ia.height?.message,children:(0,n.jsx)(X.p,{...va("height",{required:(0,r.t)("share-panel-image.settings.height-required","Height is required"),min:{value:1,message:(0,r.t)("share-panel-image.settings.height-min","Height must be equal or greater than 1")},valueAsNumber:!0,onChange:Gs}),placeholder:(0,r.t)("share-panel-image.settings.height-placeholder","500"),type:"number",suffix:"px","data-testid":xt.heightInput})}),(0,n.jsx)(J.D,{label:(0,r.t)("share-panel-image.settings.scale-factor-label","Scale factor"),className:Ln.imageConfigurationField,required:!0,invalid:!!ia.scaleFactor,error:ia.scaleFactor?.message,children:(0,n.jsx)(X.p,{...va("scaleFactor",{required:(0,r.t)("share-panel-image.settings.scale-factor-required","Scale factor is required"),min:{value:1,message:(0,r.t)("share-panel-image.settings.scale-factor-min","Scale factor must be equal or greater than 1")},valueAsNumber:!0,onChange:Gs}),placeholder:(0,r.t)("share-panel-image.settings.scale-factor-placeholder","1"),type:"number","data-testid":xt.scaleFactorInput})})]}),(0,n.jsxs)(v.B,{gap:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(E.$n,{icon:"gf-layout-simple",variant:"secondary",fill:"solid",type:"submit",disabled:Dt||na||!kn,"data-testid":xt.generateImageButton,children:(0,n.jsx)(r.x6,{i18nKey:"link.share-panel.render-image",children:"Generate image"})}),(0,n.jsx)(E.$n,{onClick:aa,icon:"download-alt",variant:"secondary",disabled:!Ga||na||Dt,"data-testid":xt.downloadImageButton,children:(0,n.jsx)(r.x6,{i18nKey:"link.share-panel.download-image",children:"Download image"})})]})]})}),na&&(0,n.jsxs)("div",{children:[(0,n.jsx)(Fa.G,{width:128}),(0,n.jsx)("div",{className:Ln.imageLoadingContainer,children:(0,n.jsx)(Q.E,{variant:"body",children:bt||""})})]}),Ga&&!na&&(0,n.jsx)("img",{src:URL.createObjectURL(Ga),alt:"panel-preview-img",className:Ln.image}),Ps&&!na&&(0,n.jsx)(Ge.F,{severity:"error",title:(0,r.t)("link.share-panel.render-image-error","Failed to render panel image"),children:(0,_s.NF)(Ps)?Ps.statusText:(0,r.t)("link.share-panel.render-image-error-description","An error occurred when generating the image")})]})})}const St=bt=>({imageConfigurationField:(0,i.css)({flex:1}),image:(0,i.css)({maxWidth:"100%",width:"max-content"}),imageLoadingContainer:(0,i.css)({maxWidth:"100%",height:362,border:`1px solid ${bt.components.input.borderColor}`,padding:bt.spacing(1)})});class jt extends yn.R{static{this.Component=Qt}constructor(Vt){super(Vt)}getTabLabel(){return(0,r.t)("share-panel.drawer.share-link-title","Link settings")}}function Qt({model:bt}){const Vt=(0,y.of)(Jt),{useLockedTime:Kt,useShortUrl:Dt,selectedTheme:Zt,isBuildUrlLoading:Ln,imageUrl:Qn,panelRef:va}=bt.useState(),Wn=va?.resolve().state.title,kn=!!(0,d.YQ)(bt).state.uid;return(0,n.jsxs)("div",{children:[(0,n.jsx)(Q.E,{variant:"body",children:(0,n.jsx)(r.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})}),(0,n.jsxs)("div",{className:Vt.configurationContainer,children:[(0,n.jsx)(On,{useLockedTime:Kt,onToggleLockedTime:bt.onToggleLockedTime,useShortUrl:Dt,onUrlShorten:bt.onUrlShorten,selectedTheme:Zt,onChangeTheme:bt.onThemeChange,isLoading:Ln}),(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Ln,getText:bt.getShareUrl,onClipboardCopy:bt.onCopy,children:(0,n.jsx)(r.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]}),(0,n.jsx)(M.c,{spacing:2}),(0,n.jsxs)(v.B,{gap:2,direction:"column",children:[!kn&&(0,n.jsx)(Ge.F,{severity:"info",title:(0,r.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(r.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!g.$.rendererAvailable&&(0,n.jsx)(Ge.F,{severity:"info",title:(0,r.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(r.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})}),(0,n.jsx)(dt,{title:Wn||"",buildUrl:bt.buildUrl,imageUrl:Qn,disabled:!kn,theme:Zt})]})]})}const Jt=bt=>({configurationContainer:(0,i.css)({marginTop:bt.spacing(2)})}),ln=[];function fn(bt){ln.push(bt)}class gn extends s.Bs{constructor(Vt){super({...Vt}),this.onDismiss=()=>{this.state.activeShare?.onDismiss?this.state.activeShare.onDismiss():this.state.panelRef?(0,d.YQ)(this).closeModal():a.Ny.partial({shareView:null})},this.addActivationHandler(()=>this.buildActiveShare(Vt.shareView))}static{this.Component=vn}buildActiveShare(Vt){const{panelRef:Kt}=this.state,Dt=(0,d.YQ)(this),Zt=Kt?Rt(Vt,this.onDismiss,Dt.getRef(),Kt):wn(Vt,this.onDismiss,Dt.getRef(),Kt);this.setState({activeShare:Zt})}}function vn({model:bt}){const{activeShare:Vt}=bt.useState(),Kt=(0,d.YQ)(bt);return(0,n.jsx)(l._,{title:Vt?.getTabLabel(),onClose:bt.onDismiss,size:"md",children:(0,n.jsx)(G.Provider,{value:{dashboard:Kt,onDismiss:bt.onDismiss},children:Vt&&(0,n.jsx)(Vt.Component,{model:Vt})})})}function wn(bt,Vt,Kt,Dt){const Zt=ln.find(Ln=>Ln.id===bt);if(Zt)return new Zt.shareOption({onDismiss:Vt});switch(bt){case o.wr.link:return new fa({onDismiss:Vt});case o.wr.publicDashboard:return new Tt({onDismiss:Vt});case o.wr.snapshot:return new Gn({dashboardRef:Kt,panelRef:Dt,onDismiss:Vt});case o.wr.export:return new B({onDismiss:Vt});default:return new fa({onDismiss:Vt})}}function Rt(bt,Vt,Kt,Dt){switch(bt){case o.wr.link:return new jt({panelRef:Dt,onDismiss:Vt});case o.wr.snapshot:return new Gn({dashboardRef:Kt,panelRef:Dt,onDismiss:Vt});case o.wr.embed:return new La.c({panelRef:Dt,onDismiss:Vt});case o.wr.libraryPanel:return new ss.S({panelRef:Dt,onDismiss:Vt});default:return new jt({panelRef:Dt,onDismiss:Vt})}}},2416:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>p});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(41654),d=e(76319),i=e(66404),c=e(68079),m=e(70735);function p({onConfirm:r,onDismiss:g,description:y,confirmButtonLabel:v,title:x,isActionLoading:f}){const u=(0,l.of)(h),b=()=>(0,n.jsx)("div",{className:u.bodyContainer,children:(0,n.jsxs)(o.B,{justifyContent:"space-between",children:[(0,n.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(d.K,{size:"xl",name:"angle-left","aria-label":(0,s.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:g}),(0,n.jsx)(i.E,{variant:"h4",children:x})]}),f&&(0,n.jsx)(c.y,{})]})});return(0,n.jsx)(m.k,{body:(0,n.jsx)(b,{}),description:y,confirmButtonLabel:v,confirmButtonVariant:"destructive",dismissButtonLabel:(0,s.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:r,onDismiss:g})}const h=r=>({bodyContainer:(0,a.css)({marginBottom:r.spacing(2)})})},56445:(Z,R,e)=>{"use strict";e.d(R,{N:()=>N});var n=e(74848),a=e(4213),s=e.n(a),l=e(20382),o=e(2543),d=e.n(o),i=e(16817),c=e(70713),m=e(92745),p=e(43173),h=e(36674),r=e(41654),g=e(37386),y=e(21285),v=e(22787),x=e(45861),f=e(50992),u=e(47931),b=e(50803),E=e(60171),D=e(45173),C=e(99828),P=e(58662),T=e(7817),O=e(3392),I=e(70030),j=e(62265),W=e(13241),B=e(23289),S=e(8285),w=e(84330);class N extends h.Bs{constructor(U){super({...U,isSharingExternally:!1,isViewingJSON:!1,exportMode:p.$.featureToggles.kubernetesDashboards?w.i.Classic:void 0}),this.tabId=P.wr.export,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onExportModeChange=F=>{this.setState({exportMode:F}),F===w.i.Classic&&this.setState({isViewingYAML:!1})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.onViewYAML=()=>{this.setState({isViewingYAML:!this.state.isViewingYAML})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:F,exportMode:V}=this.state,K=(0,S.YQ)(this),G=await K.serializer.makeExportableExternally(K),H=K.getInitialSaveModel(),_=H&&(0,E.aK)(H)?"v2":"v1",k=K.serializer.getSaveModel(K),J=F?G:k,z=M(K,!!F);if((0,E.aK)(k)&&"elements"in J&&_==="v2"&&V!==w.i.V1Resource)return this.setState({exportMode:w.i.V2Resource}),{json:{apiVersion:K.serializer.apiVersion??"",kind:"Dashboard",metadata:z,spec:J,status:{}},initialSaveModelVersion:_,hasLibraryPanels:Object.values(k.elements).some(Y=>Y.kind==="LibraryPanel")};if(V===w.i.V1Resource)if((0,E.aK)(k)&&_==="v2")try{const Y=(0,j.Xl)(K),X=M(K,!!F),Q=(0,b.Sb)(Y,{name:X.name??"",generation:X.generation??0,resourceVersion:X.resourceVersion??"0",creationTimestamp:X.creationTimestamp??""});let q;if(F){const te=new T.G(Q,void 0,{getVariablesFromState:()=>(0,W.E)(window.__grafanaSceneContext)});q=await(0,O.E)(te)}else q=Q;return{json:{apiVersion:`${D._.group}/${D._.version}`,kind:"Dashboard",metadata:X,spec:q,status:{}},initialSaveModelVersion:_,hasLibraryPanels:void 0}}catch(Y){return{json:{error:`Failed to convert dashboard to v1. ${Y}`},initialSaveModelVersion:_,hasLibraryPanels:void 0}}else{const Y=(0,I.Uy)(K);return{json:{apiVersion:`${D._.group}/${D._.version}`,kind:"Dashboard",metadata:z,spec:Y,status:{}},initialSaveModelVersion:_,hasLibraryPanels:void 0}}if(V===w.i.V2Resource){const Y=(0,j.Xl)(K),X=JSON.parse(JSON.stringify(Y)),Q=await(0,O.j)(X),q=F?Q:Y;return{json:{apiVersion:`${C.P.group}/${C.P.version}`,kind:"Dashboard",metadata:z,spec:q,status:{}},initialSaveModelVersion:_}}if(_==="v1"&&(0,E.aK)(k)&&H&&"panels"in H){const Y=new T.G(H,void 0,{getVariablesFromState:()=>(0,W.E)(window.__grafanaSceneContext)});return{json:F?await(0,O.E)(Y):H,hasLibraryPanels:void 0,initialSaveModelVersion:_}}return{json:J,hasLibraryPanels:void 0,initialSaveModelVersion:_}},this.onSaveAsFile=async()=>{const F=await this.getExportableDashboardJson(),V=JSON.stringify(F.json,null,2),{isSharingExternally:K,isViewingYAML:G}=this.state,H=new Blob([G?l.Ay.dump(F.json):V],{type:"application/json;charset=utf-8"}),_=new Date().getTime();let k="dashboard";"title"in F.json&&F.json.title&&(k=F.json.title);const J=G?"yaml":"json";s()(H,`${k}-${_}.${J}`),B.c.exportDownloadJsonClicked({externally:K})}}static{this.Component=L}getTabLabel(){return(0,m.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function M(A,U){let F={};if(A.serializer.metadata&&("k8s"in A.serializer.metadata?F=A.serializer.metadata.k8s?(0,o.cloneDeep)(A.serializer.metadata.k8s):{}:"annotations"in A.serializer.metadata&&(F=(0,o.cloneDeep)(A.serializer.metadata))),"managedFields"in F&&delete F.managedFields,U){"uid"in F&&delete F.uid,delete F.resourceVersion,delete F.namespace;for(const V in F.labels)V.startsWith("grafana.app/")&&delete F.labels[V];for(const V in F.annotations)V.startsWith("grafana.app/")&&delete F.annotations[V]}return F}function L({model:A}){const{isSharingExternally:U,isViewingJSON:F,modalRef:V,exportMode:K,isViewingYAML:G}=A.useState(),H=(0,i.A)(async()=>await A.getExportableDashboardJson(),[F,U,K]),_=JSON.stringify(H.value?.json,null,2),k=l.Ay.dump(H.value?.json,{skipInvalid:!0}),J=G?k:_,z=(0,m.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[!F&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),p.$.featureToggles.kubernetesDashboards?(0,n.jsx)(w.j,{dashboardJson:H,isSharingExternally:U??!1,exportMode:K??w.i.Classic,isViewingYAML:G??!1,onExportModeChange:A.onExportModeChange,onShareExternallyChange:A.onShareExternallyChange,onViewYAML:A.onViewYAML}):(0,n.jsx)(r.B,{gap:2,direction:"column",children:(0,n.jsx)(g.D,{label:z,children:(0,n.jsx)(y.d,{id:"share-externally-toggle",value:U,onChange:A.onShareExternallyChange})})}),(0,n.jsxs)(v.a.ButtonRow,{children:[(0,n.jsx)(x.$n,{variant:"secondary",onClick:()=>{V?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),G?(0,n.jsx)(x.$n,{variant:"secondary",icon:"brackets-curly",onClick:A.onViewJSON,children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.view-button-yaml",children:"View YAML"})}):(0,n.jsx)(x.$n,{variant:"secondary",icon:"brackets-curly",onClick:A.onViewJSON,children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(x.$n,{variant:"primary",icon:"save",onClick:()=>A.onSaveAsFile(),children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),F&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Ay,{disableHeight:!0,children:({width:Y})=>H.value?(0,n.jsx)(f.B,{value:J,showLineNumbers:!0,language:G?"yaml":"json",showMiniMap:!1,height:"500px",width:Y}):H.loading?(0,n.jsxs)("div",{children:[" ",(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.loading",children:"Loading..."})]}):null}),(0,n.jsxs)(v.a.ButtonRow,{children:[(0,n.jsx)(x.$n,{variant:"secondary",fill:"outline",onClick:A.onViewJSON,icon:"arrow-left",children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,n.jsx)(u.b,{variant:"secondary",icon:"copy",disabled:H.loading,getText:()=>J??"",children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,n.jsx)(x.$n,{variant:"primary",icon:"save",disabled:H.loading,onClick:()=>A.onSaveAsFile(),children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},89752:(Z,R,e)=>{"use strict";e.d(R,{S:()=>r});var n=e(74848),a=e(92745),s=e(43173),l=e(36674),o=e(65241),d=e(58662),i=e(7817),c=e(82612),m=e(93389),p=e(70030),h=e(8285);class r extends l.Bs{constructor(){super(...arguments),this.tabId=d.wr.libraryPanel}static{this.Component=g}getTabLabel(){return s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.new-library-panel-title","New library panel"):(0,a.t)("share-modal.tab-title.library-panel","Library panel")}}function g({model:y}){const{panelRef:v,modalRef:x}=y.useState();if(!v)return null;const f=v.resolve(),u=f.parent;if(u instanceof m.U){const b=(0,h.YQ)(y),E=(0,p.ZB)(u),D=new c.a9(E),C=(0,p.Uy)(b),P=new i.G(C);return(0,n.jsx)(o.j,{initialFolderUid:b.state.meta.folderUid,dashboard:P,panel:D,onDismiss:()=>{x?x.resolve().onDismiss():b.closeModal()},onCreateLibraryPanel:T=>b.createLibraryPanel(f,T)})}return null}},8655:(Z,R,e)=>{"use strict";e.d(R,{R:()=>E});var n=e(74848),a=e(25229),s=e(51898),l=e(92745),o=e(43173),d=e(36674),i=e(16780),c=e(37386),m=e(21285),p=e(63527),h=e(47931),r=e(30703),g=e(34999),y=e(71673),v=e(29216),x=e(58662),f=e(52043),u=e(23289),b=e(8285);class E extends d.Bs{constructor(T){super({...T,useLockedTime:T.useLockedTime??!0,useShortUrl:T.useShortUrl??!1,selectedTheme:T.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=x.wr.link,this.buildUrl=async O=>{this.setState({isBuildUrlLoading:!0});const{panelRef:I,useLockedTime:j,useShortUrl:W,selectedTheme:B}=this.state,S=(0,b.YQ)(this),w=I?.resolve(),N={useAbsoluteTimeRange:j,theme:B,useShortUrl:W};let M=(0,y.VN)(S,N,w);W&&(M=await(0,y.fn)(M));const L=d.jh.getTimeRange(w??S),A=(0,y.$l)(N,L,w);let U=A;w&&(delete U.viewPanel,U.panelId=w.state.key,U["__feature.dashboardSceneSolo"]=!0);const F=(0,f.u)({uid:S.state.uid,currentQueryParams:window.location.search,updateQuery:{...A,...O,panelId:w?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:C(L.getTimeZone())});this.setState({shareUrl:M,imageUrl:F,isBuildUrlLoading:!1})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{u.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,x.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=D}getTabLabel(){return(0,l.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const T=!this.state.useLockedTime;this.setState({useLockedTime:T}),await this.buildUrl()}async onUrlShorten(){const T=!this.state.useShortUrl;this.setState({useShortUrl:T}),await this.buildUrl()}async onThemeChange(T){this.setState({selectedTheme:T}),await this.buildUrl()}}function D({model:P}){const T=P.useState(),{panelRef:O}=T,I=(0,b.YQ)(P),j=O?.resolve(),B=d.jh.getTimeRange(j??I).state.to==="now",{useLockedTime:S,useShortUrl:w,selectedTheme:N,shareUrl:M,imageUrl:L}=T,A=s.Tp.pages.SharePanelModal,U=!!I.state.uid,F=(0,l.t)("share-modal.link.time-range-label","Lock time range"),V=(0,l.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),K=(0,l.t)("share-modal.link.shorten-url","Shorten URL"),G=(0,l.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(i.n,{children:[(0,n.jsx)(c.D,{label:F,description:B?V:"",children:(0,n.jsx)(m.d,{id:"share-current-time-range",value:S,onChange:P.onToggleLockedTime})}),(0,n.jsx)(v.w,{selectedTheme:N,onChange:P.onThemeChange}),(0,n.jsx)(c.D,{label:K,children:(0,n.jsx)(m.d,{id:"share-shorten-url",value:w,onChange:P.onUrlShorten})}),(0,n.jsx)(c.D,{label:G,children:(0,n.jsx)(p.p,{id:"link-url-input",value:M,readOnly:!0,addonAfter:(0,n.jsx)(h.b,{icon:"copy",variant:"primary",getText:P.getShareUrl,onClipboardCopy:P.onCopy,children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),j&&o.$.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[U&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsxs)("a",{href:L,target:"_blank",rel:"noreferrer","aria-label":A.linkToRenderedImage,children:[(0,n.jsx)(r.I,{name:"camera"}),"\xA0",(0,n.jsx)(l.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!U&&(0,n.jsx)(g.F,{severity:"info",title:(0,l.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),j&&!o.$.rendererAvailable&&(0,n.jsx)(g.F,{severity:"info",title:(0,l.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(l.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function C(P){const T="UTC"+encodeURIComponent((0,a.KQ)().format("Z"));if(P==="utc")return"UTC";if(P==="browser"){if(!window.Intl)return T;const I=window.Intl.DateTimeFormat().resolvedOptions();return I.timeZone?I.timeZone:T}return P}},99949:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>F,m:()=>U});var n=e(74848),a=e(92745),s=e(36490),l=e(43173),o=e(36674),d=e(52792),i=e(22787),c=e(13941),m=e(73427),p=e(24313),h=e(11257),r=e(58662),g=e(23289),y=e(8285),v=e(56445),x=e(89752),f=e(8655),u=e(42656),b=e(51155),E=e(62905),D=e(82298),C=e(22803),P=e(63142),T=e(72973),O=e(71599);class I extends o.Bs{static{this.Component=j}constructor(G){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...G})}onDismiss(){}}function j({model:K}){const G=K.useState();return(0,n.jsx)(O.u,{...G})}var W=e(71748);function B({model:K,publicDashboard:G,isGetLoading:H}){const _=(0,P.of)(S),k=m.TP.hasPermission(h.w.DashboardsPublicWrite),J=(0,y.YQ)(K),{isDirty:z}=J.useState(),[Y]=(0,E.bN)(),X=(J.state.$variables?.state.variables.length??0)>0,Q=(0,W.b)(J),te=o.jh.getTimeRange(K).useState();return(0,n.jsx)(T.b,{dashboard:J,publicDashboard:G,unsupportedDatasources:Q,onRevoke:()=>{J.showModal(new I({isOpen:!0,title:(0,a.t)("dashboard-scene.config-public-dashboard.title.revoke-public-url","Revoke public URL"),icon:"trash-alt",confirmText:(0,a.t)("dashboard-scene.config-public-dashboard.confirmText.revoke-public-url","Revoke public URL"),body:(0,n.jsx)("p",{className:_.description,children:(0,n.jsx)(a.x6,{i18nKey:"public-dashboard.config.revoke-body",children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."})}),onDismiss:()=>{J.showModal(new F({activeTab:r.wr.publicDashboard}))},onConfirm:()=>{Y({dashboard:J,dashboardUid:J.state.uid,uid:G.uid}),J.closeModal()}}))},timeRange:te.value,showSaveChangesAlert:k&&z,hasTemplateVariables:X})}const S=K=>({description:(0,C.css)({fontSize:K.typography.body.fontSize})});var w=e(58375);function N({model:K}){const G=(0,y.YQ)(K),H=(0,W.b)(G),_=(G.state.$variables?.state.variables.length??0)>0;return(0,n.jsx)(w.D,{dashboard:G,unsupportedDatasources:H,unsupportedTemplateVariables:_})}class M extends o.Bs{constructor(){super(...arguments),this.tabId=r.wr.publicDashboard}static{this.Component=L}getTabLabel(){return(0,a.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function L({model:K}){const{data:G,isLoading:H}=(0,E.Bs)((0,y.YQ)(K).state.uid);return(0,n.jsx)(n.Fragment,{children:H?(0,n.jsx)(D.a,{}):(0,p.lI)(G)?(0,n.jsx)(B,{model:K,publicDashboard:G,isGetLoading:H}):(0,n.jsx)(N,{model:K})})}const A=[];function U(K){A.push(K)}class F extends o.Bs{constructor(G){super({activeTab:"link",...G}),this.onDismiss=()=>{this.state.panelRef?(0,y.YQ)(this).closeModal():s.Ny.partial({shareView:null})},this.onChangeTab=H=>{g.c.sharingCategoryClicked({item:H.value,shareResource:(0,r.hD)(this.state.panelRef)}),this.setState({activeTab:H.value})},this.addActivationHandler(()=>this.buildTabs(G.activeTab))}static{this.Component=V}buildTabs(G){const{panelRef:H}=this.state,_=this.getRef(),k=[new f.R({panelRef:H,modalRef:_})],J=(0,y.YQ)(this);if(H||k.push(new v.N({modalRef:_})),m.TP.isSignedIn&&l.$.snapshotEnabled&&m.TP.hasPermission(h.w.SnapshotsCreate)&&k.push(new b.l({panelRef:H,dashboardRef:J.getRef(),modalRef:_})),H){k.push(new u.c({panelRef:H}));const Y=H.resolve();Y instanceof o.Eb&&((0,y.ME)(Y)||k.push(new x.S({panelRef:H,modalRef:_})))}H||(k.push(...A.map(Y=>new Y({modalRef:_}))),(0,p.iR)()&&k.push(new M({modalRef:_})));const z=k.find(Y=>Y.tabId===G);this.setState({activeTab:z?.tabId??k[0].tabId,tabs:k})}}function V({model:K}){const{panelRef:G,tabs:H,activeTab:_}=K.useState(),k=G?(0,a.t)("share-modal.panel.title","Share Panel"):(0,a.t)("share-modal.dashboard.title","Share");if(!H)return;const J=H?.map(X=>({label:X.getTabLabel(),value:X.tabId})),z=(0,n.jsx)(d.J,{title:k,icon:"share-alt",tabs:J,activeTab:_,onChangeTab:K.onChangeTab}),Y=H.find(X=>X.tabId===_);return(0,n.jsx)(i.a,{isOpen:!0,title:z,onDismiss:K.onDismiss,children:(0,n.jsx)(c.J,{children:Y&&(0,n.jsx)(Y.Component,{model:Y})})})}},42656:(Z,R,e)=>{"use strict";e.d(R,{c:()=>p});var n=e(74848),a=e(92745),s=e(43173),l=e(36674),o=e(24209),d=e(58662),i=e(81657),c=e(52043),m=e(8285);class p extends l.Bs{constructor(y){super(y),this.tabId=d.wr.embed}static{this.Component=h}getTabLabel(){return s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.share-embed-title","Share embed"):(0,a.t)("share-modal.tab-title.panel-embed","Embed")}}function h({model:g}){const{panelRef:y}=g.useState(),v=y.resolve(),x=(0,m.YQ)(g),{uid:f}=x.useState(),u=(0,m.Cs)(v),b=l.jh.getTimeRange(v),E=b instanceof i.v?b.state.timeFrom:void 0;return(0,n.jsx)(o.D,{panel:{id:u,timeFrom:E},range:b.state.value,dashboard:{uid:f??"",time:b.state.value},buildIframe:r(x),onCancelClick:()=>x.closeModal()})}const r=g=>(y,v,x,f,u)=>{const b=(0,d.XV)({useCurrentTimeRange:y,selectedTheme:x,panel:f,range:u}),E=b.get("editPanel")??b.get("viewPanel")??"";return b.set("panelId",E),b.delete("editPanel"),b.delete("viewPanel"),b.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,c.u)({absolute:!0,soloRoute:!0,uid:g.state.uid,slug:g.state.meta.slug,currentQueryParams:b.toString()})}" width="450" height="200" frameborder="0"></iframe>`}},51155:(Z,R,e)=>{"use strict";e.d(R,{l:()=>T,u:()=>C});var n=e(74848),a=e(5805),s=e(51898),l=e(92745),o=e(68143),d=e(36674),i=e(37386),c=e(63527),m=e(77824),p=e(22787),h=e(45861),r=e(41654),g=e(47931),y=e(6890),v=e(64762),x=e(58662),f=e(8735),u=e(8535),b=e(70030),E=e(23289);const D=s.Tp.pages.ShareDashboardModal.SnapshotScene,C=()=>{const I={label:(0,l.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,l.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,l.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},I,{label:(0,l.t)("share-modal.snapshot.expire-never","Never"),value:0}]},P=()=>C()[2];class T extends d.Bs{constructor(j){super({...j,snapshotName:j.dashboardRef.resolve().state.title,selectedExpireOption:P()}),this.tabId=x.wr.snapshot,this.onSnasphotNameChange=W=>{this.setState({snapshotName:W})},this.onExpireChange=W=>{this.setState({selectedExpireOption:C().find(B=>B.value===W)})},this.onSnapshotCreate=async(W=!1)=>{const{selectedExpireOption:B}=this.state,S=this.prepareSnapshot(),w={dashboard:S,name:S.title,expires:B?.value,external:W};try{const N=await(0,f.s)().create(w);return(0,u.JD)((0,y.dx)((0,v.tZ)((0,l.t)("snapshot.share.success-creation","Your snapshot has been created")))),N}finally{W?E.c.publishSnapshotClicked({expires:w.expires,shareResource:(0,x.hD)(this.state.panelRef)}):E.c.publishSnapshotLocalClicked({expires:w.expires,shareResource:(0,x.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async W=>{const B=await(0,o.AI)().get(W);return(0,u.JD)((0,y.dx)((0,v.tZ)((0,l.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),B},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=O}_onActivate(){(0,f.s)().getSharingOptions().then(j=>{this.isActive&&this.setState({snapshotSharingOptions:j})})}getTabLabel(){return(0,l.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const j=d.jh.getTimeRange(this),{dashboardRef:W,panelRef:B}=this.state,S=(0,b.Uy)(W.resolve(),!0);return(0,b.c)(this.state.snapshotName.trim()||"",j.state.value,S,B?.resolve())}}function O({model:I}){const{snapshotName:j,selectedExpireOption:W,modalRef:B,snapshotSharingOptions:S}=I.useState(),[w,N]=(0,a.default)(async(A=!1)=>I.onSnapshotCreate(A)),[M,L]=(0,a.default)(async A=>await(0,o.AI)().get(A));return M.value?(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,n.jsxs)(n.Fragment,{children:[!w.value&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{children:(0,n.jsxs)(l.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(i.D,{label:(0,l.t)("share-modal.snapshot.name","Snapshot name"),children:(0,n.jsx)(c.p,{id:"snapshot-name-input",width:30,defaultValue:j,onBlur:A=>I.onSnasphotNameChange(A.target.value)})}),(0,n.jsx)(i.D,{label:(0,l.t)("share-modal.snapshot.expire","Expire"),children:(0,n.jsx)(m.z,{id:"expire-select-input",options:C(),value:W?.value,onChange:I.onExpireChange})}),(0,n.jsxs)(p.a.ButtonRow,{children:[(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>{B?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),S?.externalEnabled&&(0,n.jsx)(h.$n,{variant:"secondary",disabled:w.loading,onClick:()=>N(!0),children:S?.externalSnapshotName}),(0,n.jsx)(h.$n,{variant:"primary",disabled:w.loading,onClick:()=>N(),"data-testid":D.PublishSnapshot,children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),w.value&&(0,n.jsxs)(r.B,{direction:"column",gap:0,children:[(0,n.jsx)(i.D,{label:(0,l.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(c.p,{"data-testid":D.CopyUrlInput,id:"snapshot-url-input",value:w.value.url,readOnly:!0,addonAfter:(0,n.jsx)(g.b,{"data-testid":D.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>w.value.url,children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(h.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{L(w.value.deleteUrl)},children:(0,n.jsx)(l.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},71748:(Z,R,e)=>{"use strict";e.d(R,{b:()=>m});var n=e(16817),a=e(36580),s=e(35143),l=e(28998),o=e(8285);const d=async p=>{let h=new Set;for(const r of p)s.z.has(r)&&await(0,l.tR)().get(r)instanceof a.iy||h.add(r);return Array.from(h)};function i(p){const h=new Set,r=p.state.body.getVizPanels();for(const g of r){const y=c(g);for(const v of y)h.add(v)}return Array.from(h).sort()}function c(p){const h=new Set,r=(0,o.un)(p);if(r)for(const g of r.state.queries)h.add(g.datasource?.type??"");return Array.from(h)}function m(p){const{value:h}=(0,n.A)(async()=>{const r=i(p);return d(r)},[]);return h}},33380:(Z,R,e)=>{"use strict";e.d(R,{R:()=>s});var n=e(36674),a=e(8285);class s{constructor(o){this._vizPanel=o}get id(){const o=(0,a.Cs)(this._vizPanel);return isNaN(o)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):o}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof n.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const o=(0,a.un)(this._vizPanel);return o?o.state.queries:[]}get datasource(){return(0,a.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},3371:(Z,R,e)=>{"use strict";e.d(R,{Dq:()=>h,Lv:()=>y,Qp:()=>v,Ry:()=>c,ag:()=>g,d9:()=>i,ed:()=>r,lv:()=>d,oX:()=>m,uc:()=>p});var n=e(72746);const a="-clone-",s="/",l=new RegExp(`${a}[1-9][0-9]*$`),o=new RegExp(`${a}\\d+$`);function d(x,f){const u=x.split(s).slice(0,-1),b=i(h(x));return[...u,`${b}${a}${f}`].join(s)}function i(x){return h(x).replace(o,"")}function c(x){return l.test(h(x))}function m(x,f){return c(x)&&i(x)===i(f)}function p(x){return x.split(s).some(c)}function h(x){return x.split(s).pop()??""}function r(...x){return x.filter(Boolean).join(s)}function g(x){return x.includes(a)}function y(x){const{key:f}=x.useState();return c(f)}function v(x){return c(x.state.key)?!0:!x.parent||x.parent instanceof n.H$?!1:v(x.parent)}},18789:(Z,R,e)=>{"use strict";e.d(R,{w:()=>l});var n=e(43173),a=e(36674),s=e(36605);function l(o){if(!o.targets?.length||n.$.panels[o.type]?.skipDataQuery)return;let d;return d=new a.dt({datasource:o.datasource??void 0,queries:o.targets,maxDataPoints:o.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:o.cacheTimeout,queryCachingTTL:o.queryCachingTTL,minInterval:o.interval??void 0,dataLayerFilter:{panelId:o.id},$behaviors:[new s.L({})]}),new a.Es({$data:d,transformations:o.transformations||[]})}},1682:(Z,R,e)=>{"use strict";e.d(R,{b4:()=>v});var n=e(36674),a=e(88632),s=e(32540),l=e(3371),o=e(8285);function d(x){return x.state.controls?.state.timePicker}function i(x){return x.state.controls?.state.refreshPicker}function c(x){return x.state.titleItems&&Array.isArray(x.state.titleItems)?x.state.titleItems.find(u=>u instanceof s.$)??null:null}function m(x){return x.state.body.getVizPanels()}function p(x){let f=0;return n.jh.findAllObjects(x.getRoot(),u=>u instanceof n.Eb||u instanceof n.tI).forEach(u=>{if((0,l.Ry)(u.state.key))return;const b=(0,o.Cs)(u);b>f&&(f=b)}),f+1}function h(x){const f=n.jh.getData(x);if(!(f instanceof a.s))throw new Error("DashboardDataLayerSet not found");return f}function r(x){return(0,o.YQ)(x).state.editPane.state.selection?.getSelectionEntries().map(([,f])=>f.resolve())??[]}function g(x){const f=x.state.$behaviors?.find(u=>u instanceof n.Gg.K2);if(f instanceof n.Gg.K2)return f}function y(x){const f=(0,o.YQ)(x),u=(0,o.Cs)(x);let b=f.serializer.getElementIdForPanel(u);return b||(b=(0,o.XA)(u)),b}const v={getTimePicker:d,getRefreshPicker:i,getPanelLinks:c,getVizPanels:m,getDataLayers:h,getAllSelectedObjects:r,getCursorSync:g,getLayoutManagerFor:o.h$,getNextPanelId:p,getElementIdentifierForVizPanel:y}},17788:(Z,R,e)=>{"use strict";e.d(R,{Gq:()=>o,zf:()=>d});var n=e(83175),a=e(36490),s=e(43173);const l="grafana.dashboard.preservedUrlFiltersState";function o(i){const c=window.sessionStorage.getItem(l);if(c){const m=new URLSearchParams(c),p=a.Ny.getSearch(),h=new URLSearchParams;m.forEach((g,y)=>{(!p.has(y)||p.get(y)==="")&&p.append(y,g)}),p.forEach((g,y)=>{g!==""&&h.append(y,g)});for(const g of Array.from(h.keys()))g.startsWith("var-")&&(i.state.$variables?.getByName(g.replace("var-",""))||h.delete(g));const r=h.toString();r&&a.Ny.replace({search:r})}}function d(i,c){if(!s.$.featureToggles.preserveDashboardStateWhenNavigating||!c)return;const m={};i.forEach((r,g)=>{m[g]=r});const p=Object.fromEntries(Object.entries(m).filter(([r])=>r.startsWith("var-")||r==="from"||r==="to"||r==="timezone")),h=Object.fromEntries(Object.entries(p).filter(([r,g])=>!(Array.isArray(g)&&g.length===0)));Object.keys(h).length>0?window.sessionStorage.setItem(l,n.kM.renderUrl("",h)):window.sessionStorage.removeItem(l)}},52043:(Z,R,e)=>{"use strict";e.d(R,{u:()=>l});var n=e(83175),a=e(36490),s=e(43173);function l(o){let d=`/d/${o.uid}`;o.uid||(d="/dashboard/new"),o.isSnapshot&&(d=`/dashboard/snapshot/${o.uid}`),o.soloRoute&&(d=`/d-solo/${o.uid}`),o.slug&&(d+=`/${o.slug}`),o.subPath&&(d+=o.subPath),o.render&&(d="/render"+d,o.updateQuery={...o.updateQuery,width:o.updateQuery?.width||1e3,height:o.updateQuery?.height||500,tz:o.timeZone}),o.isHomeDashboard&&(d="/");const i=o.currentQueryParams?(0,a.SE)(o.currentQueryParams):{};if(delete i.shareView,o.updateQuery)for(const m in o.updateQuery)o.updateQuery[m]===null||o.updateQuery[m]===void 0?delete i[m]:i[m]=o.updateQuery[m];const c=n.kM.renderUrl(d,i);return o.absolute?s.$.appUrl+c.slice(1):c}},13241:(Z,R,e)=>{"use strict";e.d(R,{E:()=>s});var n=e(36674),a=e(84500);function s(l){const o=n.jh.getVariables(l);return(0,a.CN)(o,!0)}},23289:(Z,R,e)=>{"use strict";e.d(R,{c:()=>s});var n=e(27489);let a=!1;const s={dashboardInitialized:o=>{l("init_dashboard_completed",{...o})},panelLinkClicked:o=>{l("panelheader_datalink_clicked",o)},panelStatusMessageClicked:o=>{l("panelheader_statusmessage_clicked",o)},panelCancelQueryClicked:o=>{l("panelheader_cancelquery_clicked",o)},toolbarFavoritesClick:()=>{l("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{l("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{l("toolbar_actions_clicked",{item:"share"})},toolbarShareDropdownClick:()=>{l("toolbar_actions_clicked",{item:"share_dropdown"})},toolbarAddClick:()=>{l("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:o=>{l("sharing_category_clicked",o)},shareLinkCopied:o=>{l("sharing_link_copy_clicked",o)},embedSnippetCopy:o=>{l("sharing_embed_copy_clicked",o)},generatePanelImageClicked:o=>{l("sharing_link_generate_image_clicked",o)},downloadPanelImageClicked:o=>{l("sharing_link_download_image_clicked",o)},publishSnapshotClicked:o=>{l("sharing_snapshot_publish_clicked",o)},publishSnapshotLocalClicked:o=>{l("sharing_snapshot_local_clicked",o)},exportDownloadJsonClicked:o=>{l("sharing_export_download_json_clicked",o)},exportCopyJsonClicked:o=>{l("sharing_export_copy_json_clicked",o)},exportSaveJsonClicked:o=>{l("sharing_export_save_json_clicked",o)},exportViewJsonClicked:o=>{l("sharing_export_view_json_clicked",o)},generatePublicDashboardUrlClicked:o=>{l("sharing_public_generate_url_clicked",o)},revokePublicDashboardEmailClicked:o=>{l("sharing_public_email_revoke_clicked",o)},resendPublicDashboardEmailClicked:o=>{l("sharing_public_email_resend_clicked",o)},publicDashboardEmailInviteClicked:o=>{l("sharing_public_email_invite_clicked",o)},publicDashboardShareTypeChange:o=>{l("sharing_public_can_view_clicked",o)},publicDashboardTimeSelectionChanged:o=>{l("sharing_public_time_picker_clicked",o)},publicDashboardAnnotationsSelectionChanged:o=>{l("sharing_public_annotations_clicked",o)},publicDashboardUrlCopied:o=>{l("sharing_public_copy_url_clicked",o)},publicDashboardPauseSharingClicked:o=>{l("sharing_public_pause_clicked",o)},revokePublicDashboardClicked:o=>{l("sharing_public_revoke_clicked",o)},emptyDashboardButtonClicked:o=>{l("emptydashboard_clicked",o)},toolbarAddButtonClicked:o=>{l("toolbar_add_clicked",o)},setScenesContext:()=>(a=!0,()=>{a=!1}),versionRestoreClicked:o=>{l("version_restore_clicked",o)},showMoreVersionsClicked:()=>{l("show_more_versions_clicked")}},l=(o,d)=>{const i=a?{scenesView:!0}:{};d?(0,n.rR)(`dashboards_${o}`,{...d,...i}):(0,n.rR)(`dashboards_${o}`)}},75541:(Z,R,e)=>{"use strict";e.d(R,{C:()=>n,Y:()=>a});const n={left:[],right:[]};function a(s,l){n[s].push(l)}},22079:(Z,R,e)=>{"use strict";e.d(R,{Lp:()=>p,Uu:()=>m,e0:()=>c,r7:()=>i});var n=e(92138),a=e(36490),s=e(36674),l=e(73427),o=e(62635),d=e(8285);function i(h){return n.I.getUrlForPartial(a.Ny.getLocation(),{viewPanel:h.state.key,editPanel:void 0})}function c(h){return n.I.getUrlForPartial(a.Ny.getLocation(),{editPanel:h,viewPanel:void 0})}function m(h,r){const g=h.state.key?.replace("-view","");return n.I.getUrlForPartial(a.Ny.getLocation(),{inspect:g,inspectTab:r})}function p(h){const r=h.getPlugin(),g=(0,d.un)(h);if(!l.TP.hasAccessToExplore()||r?.meta.skipDataQuery||!g)return Promise.resolve(void 0);const y=s.jh.getTimeRange(h);return(0,o.Xe)({queries:g.state.queries,dsRef:g.state.datasource,timeRange:y.state.value,scopedVars:{__sceneObject:{value:h}},adhocFilters:g.state.data?.request?.filters})}},11480:(Z,R,e)=>{"use strict";e.d(R,{J:()=>o});var n=e(96540),a=e(32899),s=e(92745),l=e(75234);function o({dashboard:d,request:i,workflow:c,handlers:m,isNew:p}){(0,n.useEffect)(()=>{if(i.isError){m.onError?.(i.error);return}if(i.isSuccess&&i.data){d.setState({isDirty:!1});const{ref:h,path:r,urls:g,resource:y}=i.data;if(c==="branch"&&h&&r){m.onBranchSuccess?.({ref:h,path:r,urls:g});return}if((0,l.J7)().publish({type:a.r1.alertSuccess.name,payload:[(0,s.t)("dashboard-scene.edit-provisioned-dashboard-form.success","Dashboard changes saved successfully")]}),p&&y?.upsert&&m.onNewDashboardSuccess){m.onNewDashboardSuccess(y.upsert);return}m.onWriteSuccess?.()}},[i,c,m,p,d])}},8285:(Z,R,e)=>{"use strict";e.d(R,{sw:()=>f,vm:()=>u,sf:()=>V,bR:()=>F,xp:()=>X,Uv:()=>O,EX:()=>P,vL:()=>D,zo:()=>K,X0:()=>I,xz:()=>M,pk:()=>S,YQ:()=>N,O8:()=>L,ty:()=>_,Sm:()=>W,bx:()=>B,h$:()=>H,wP:()=>Y,iL:()=>U,a7:()=>j,Cs:()=>E,un:()=>w,XA:()=>b,ME:()=>A,MZ:()=>k,TN:()=>J,hg:()=>z});var n=e(48480),a=e(92745),s=e(43173),l=e(78282),o=e(36674),d=e(60379),i=e(98732),c=e(36605),m=e(72746),p=e(7094),h=e(32540),r=e(37040),g=e(29700),y=e(35718);function v(Q){return"isDashboardLayoutManager"in Q}var x=e(3371);const f=8,u=12;function b(Q){return`panel-${Q}`}function E(Q){return parseInt((0,x.d9)(Q.state.key).replace("panel-",""),10)}function D(Q,q){if(!q)return null;const te=C(Q,q);if(te)return te;const ne=parseInt(q,10);return isNaN(ne)?null:C(Q,b(ne))}function C(Q,q){if(!q)return null;const te=o.jh.findObject(Q,ne=>ne.state.key===q?!0:(ne instanceof o.Eb,!1));if(te){if(te instanceof o.Eb)return te;throw new Error(`Found panel with key ${q} but it was not a VizPanel`)}return null}function P(Q,q){if(!q)return null;let te=T(Q,q);if(te)return te;const ne=parseInt(q,10);if(isNaN(ne))return null;const se=b(ne);return te=C(Q,se),te||(te=T(Q,se),te)}function T(Q,q){if(!q)return null;const te=o.jh.findObject(Q,ne=>{const se=ne.state.key;return se===q||!(0,x.uc)(se)&&(0,x.d9)(se)===(0,x.d9)(q)?!0:(ne instanceof o.Eb,!1)});if(te){if(te instanceof o.Eb)return te;throw new Error(`Found panel with key ${q} but it was not a VizPanel`)}return null}function O(Q,q){if(!q)return null;let te=P(Q,q);if(!te||!te.state.key)return null;const ne=(0,x.Dq)(te.state.key);if((0,x.ag)(ne)){const se=(0,x.d9)(ne);te=o.jh.findObject(te.parent??Q,ue=>{if(!ue.state.key||(0,x.uc)(ue.state.key))return!1;const de=(0,x.Dq)(ue.state.key);return(0,x.ag)(de)?!1:(0,x.d9)(de)===se})}return te instanceof o.Eb?te:null}function I(Q,q){Q.forEachChild(te=>{te.isActive&&(te.forceRender(),I(te,q))})}function j(Q){const{value:q,text:te,options:ne}=Q.state;return Q.hasAllValue()?{values:ne.map(se=>se.value),texts:ne.map(se=>se.label)}:{values:Array.isArray(q)?q:[q],texts:Array.isArray(te)?te:[te]}}function W(Q){const q=Q.match(/(["'])(.*?)\1|\w+/g);if(!q)return i.Ez.query?.split(",")??[];const te=new Set,ne=q.reduce((se,ue)=>{const de=ue.replace(/["']+/g,"");return de.startsWith("$__auto_interval_")||se.add(de),se},te);return Array.from(ne)}function B(Q){return Array.isArray(Q)?Q.join(","):""}function S(Q,q){const te=Array.isArray(Q.current.value)?Q.current.value[0]:Q.current.value;return te.startsWith("$__auto_interval_")||te==="$__auto"?"$__auto":q.includes(te)?te:q[0]}function w(Q){if(!Q)return;const q=Q.state.$data??Q.parent?.state.$data;if(q instanceof o.dt)return q;if(q instanceof o.Es)return w(q)}function N(Q){const q=Q.getRoot();if(q instanceof m.H$)return q;throw new Error("SceneObject root is not a DashboardScene")}function M(Q){return Q instanceof o.Eb?Q:Q.parent?M(Q.parent):null}function L(){const Q=s.$.featureToggles.dashboardNewLayouts?g.r:"timeseries",q=(0,a.t)("dashboard.new-panel-title","New panel");return new o.Eb({title:q,pluginId:Q,seriesLimit:s.$.panelSeriesLimit,titleItems:[new h.$({menu:new h.m({})})],hoverHeaderOffset:0,$behaviors:[],extendPanelContext:y.C,menu:new o.Lw({$behaviors:[r._i]}),$data:new o.Es({$data:new o.dt({queries:[{refId:"A"}],datasource:(0,n.p$)((0,l.l)().getInstanceSettings(null)),$behaviors:[new c.L({})]}),transformations:[]})})}function A(Q){return U(Q)!==void 0}function U(Q){const q=Q.state.$behaviors?.find(te=>te instanceof p.u);if(q)return q}function F(Q){const q=Math.ceil(Q.state.repeatedPanels.length/Q.getMaxPerRow()),te=Math.ceil(Q.state.repeatedPanels.length/q),ne=24/te;return{h:Q.state.itemHeight??10,w:ne,columnCount:te}}function V(Q){let q,te;return Q.isActive?q:(Q.parent&&(te=V(Q.parent)),q=Q.activate(),()=>{te?.(),q()})}function K(Q){let q,te;return Q.parent&&(te=K(Q.parent)),Q.isActive?()=>{te?.(),q?.()}:(q=Q.activate(),()=>{te?.(),q?.()})}const G=null;function H(Q){let q=Q.parent;for(;q;){if(v(q))return q;q=q.parent}throw new Error("Could not find layout manager for scene object")}function _(Q){return`grid-item-${Q}`}function k(Q){return N(Q)}function J(Q){return k(Q).useState()}function z(Q){const{title:q}=Q.useState();return q?o.jh.interpolate(Q,q,void 0,"text"):""}function Y(Q){return N(Q).state.layoutOrchestrator}const X=(0,d.h)("Dashboard")},55211:(Z,R,e)=>{"use strict";e.d(R,{HN:()=>c,bc:()=>i});var n=e(43173),a=e(78282),s=e(36674),l=e(39557),o=e(8285);const d="default";function i(h){const r=h.templating.list.map(g=>{try{return p(g)}catch(y){return console.error(y),null}}).filter(g=>!!g);return n.$.featureToggles.scopeFilters&&r.push(new s.Kg({enable:!0})),new s.Pj({variables:r})}function c(h){const r=h.templating.list.map(g=>{try{return g.type==="adhoc"?new s.H9({name:g.name,label:g.label,readOnly:!0,description:g.description,skipUrlSync:g.skipUrlSync,hide:g.hide,datasource:g.datasource,applyMode:"auto",filters:g.filters??[],baseFilters:g.baseFilters??[],defaultKeys:g.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,a.l)().getInstanceSettings(g.datasource)?.meta.multiValueFilterOperators}):m(g)}catch(y){return console.error(y),null}}).filter(g=>!!g);return new s.Pj({variables:r})}function m(h){let r,g;if(h.type==="interval"){const y=(0,o.Sm)(h.query),v=(0,o.pk)(h,y);return r=new l.B({name:h.name,label:h.label,description:h.description,value:v,text:v,hide:h.hide}),r}return h.type==="system"||h.type==="constant"||h.type==="adhoc"?g={value:"",text:""}:g={value:h.current?.value??"",text:h.current?.text??""},r=new l.B({name:h.name,label:h.label,description:h.description,value:g?.value??"",text:g?.text??"",hide:h.hide}),r}function p(h){const r={name:h.name,label:h.label,description:h.description};if(h.type==="adhoc"){const g=[],y=[];return h.filters?.forEach(v=>v.origin?g.push(v):y.push(v)),new s.H9({...r,description:h.description,skipUrlSync:h.skipUrlSync,hide:h.hide,datasource:h.datasource,applyMode:"auto",originFilters:g,filters:y,baseFilters:h.baseFilters??[],defaultKeys:h.defaultKeys,allowCustomValue:h.allowCustomValue,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,a.l)().getInstanceSettings(h.datasource)?.meta.multiValueFilterOperators})}if(h.type==="custom")return new s.yP({...r,value:h.current?.value??"",text:h.current?.text??"",query:h.query,isMulti:h.multi,allValue:h.allValue||void 0,includeAll:h.includeAll,defaultToAll:!!h.includeAll,skipUrlSync:h.skipUrlSync,hide:h.hide,allowCustomValue:h.allowCustomValue});if(h.type==="query")return new s.fS({...r,value:h.current?.value??"",text:h.current?.text??"",query:h.query,datasource:h.datasource,sort:h.sort,refresh:h.refresh,regex:h.regex,allValue:h.allValue||void 0,includeAll:h.includeAll,defaultToAll:!!h.includeAll,isMulti:h.multi,skipUrlSync:h.skipUrlSync,hide:h.hide,definition:h.definition,allowCustomValue:h.allowCustomValue});if(h.type==="datasource")return new s.mI({...r,value:h.current?.value??"",text:h.current?.text??"",regex:h.regex,pluginId:h.query,allValue:h.allValue||void 0,includeAll:h.includeAll,defaultToAll:!!h.includeAll,skipUrlSync:h.skipUrlSync,isMulti:h.multi,hide:h.hide,defaultOptionEnabled:h.current?.value===d&&h.current?.text==="default",allowCustomValue:h.allowCustomValue});if(h.type==="interval"){const g=(0,o.Sm)(h.query),y=(0,o.pk)(h,g);return new s.Yj({...r,value:y,intervals:g,autoEnabled:h.auto,autoStepCount:h.auto_count,autoMinInterval:h.auto_min,refresh:h.refresh,skipUrlSync:h.skipUrlSync,hide:h.hide})}else{if(h.type==="constant")return new s.x0({...r,value:h.query,skipUrlSync:h.skipUrlSync,hide:h.hide});if(h.type==="textbox"){let g;return h?.current?.value?typeof h.current.value=="string"?g=h.current.value:g=h.current.value[0]:g=h.query,new s.TS({...r,value:g,skipUrlSync:h.skipUrlSync,hide:h.hide})}else{if(n.$.featureToggles.groupByVariable&&h.type==="groupby")return new s.ZG({...r,datasource:h.datasource,value:h.current?.value||[],text:h.current?.text||[],skipUrlSync:h.skipUrlSync,hide:h.hide,defaultOptions:h.options,defaultValue:h.defaultValue,allowCustomValue:h.allowCustomValue});throw new Error(`Scenes: Unsupported variable type ${h.type}`)}}}},50803:(Z,R,e)=>{"use strict";e.d(R,{Op:()=>y,Sb:()=>F});var n=e(43173),a=e(21275),s=e(78947),l=e(5857),o=e(75735),d=e(78320),i=e(84500),c=e(62265),m=e(3281),p=e(39508),h=e(60171);function r(V){if((0,h.HG)(V))return V;let K;(0,h.b_)(V)?K=V.spec:K=V.dashboard;const G=(0,s.ft)(),H=(0,s.xE)(),[_,k]=v(K.panels||[]),J=j(K.templating?.list||[]),z=W(K.annotations?.list||[]);let Y,X,Q,q;(0,h.b_)(V)?(Y=V.access,X={...V.metadata.annotations,[o.hm]:K.gnetId??void 0},q=V.metadata.creationTimestamp,Q={[o.Y5]:V.metadata.labels?.[o.Y5]}):(Y={url:V.meta.url,slug:V.meta.slug,canSave:V.meta.canSave,canEdit:V.meta.canEdit,canDelete:V.meta.canDelete,canShare:V.meta.canShare,canStar:V.meta.canStar,canAdmin:V.meta.canAdmin,annotationsPermissions:V.meta.annotationsPermissions},X={[o.hc]:V.meta.createdBy,[o.Qu]:V.meta.updatedBy,[o.xU]:V.meta.updated,[o.ew]:V.meta.folderUid,[o.hX]:V.meta.slug},K.gnetId&&(X[o.hm]=K.gnetId),V.meta.isSnapshot&&(X[o.qw]="true"),q=V.meta.created,Q={[o.Y5]:K.id?.toString()??void 0}),X?.[o.qw]&&(X[o.UL]=K.snapshot?.originalUrl);const te={title:K.title,description:K.description,tags:K.tags??[],cursorSync:(0,p.k6)(K.graphTooltip),preload:K.preload||H.preload,liveNow:K.liveNow,editable:K.editable,revision:K.revision,timeSettings:{from:K.time?.from||G.from,to:K.time?.to||G.to,timezone:K.timezone||G.timezone,autoRefresh:K.refresh||G.autoRefresh,autoRefreshIntervals:K.timepicker?.refresh_intervals||G.autoRefreshIntervals,fiscalYearStartMonth:K.fiscalYearStartMonth||G.fiscalYearStartMonth,hideTimepicker:K.timepicker?.hidden||G.hideTimepicker,quickRanges:K.timepicker?.quick_ranges,weekStart:u(K.weekStart,G.weekStart),nowDelay:K.timepicker?.nowDelay||G.nowDelay},links:K.links||[],annotations:z,variables:J,elements:_,layout:k};return{apiVersion:"v2alpha1",kind:"DashboardWithAccessInfo",metadata:{creationTimestamp:q||"",name:K.uid,resourceVersion:K.version?.toString()||"0",annotations:X,labels:Q},spec:te,access:Y}}function g(V){if(!(0,h.b_)(V))return V;const K=V.spec;return(0,h._5)(K)?{meta:{...V.access,isNew:!1,isFolder:!1,uid:V.metadata.name,k8s:V.metadata,version:V.metadata.generation},dashboard:K}:{meta:{created:V.metadata.creationTimestamp,createdBy:V.metadata.annotations?.[o.hc]??"",updated:V.metadata.annotations?.[o.xU],updatedBy:V.metadata.annotations?.[o.Qu],folderUid:V.metadata.annotations?.[o.ew],slug:V.metadata.annotations?.[o.hX],url:V.access.url,canAdmin:V.access.canAdmin,canDelete:V.access.canDelete,canEdit:V.access.canEdit,canSave:V.access.canSave,canShare:V.access.canShare,canStar:V.access.canStar,annotationsPermissions:V.access.annotationsPermissions},dashboard:F(K,V.metadata)}}const y={ensureV2Response:r,ensureV1Response:g};function v(V){const K={},G={kind:"GridLayout",spec:{items:[]}};if(!V)return[K,G];if(V.some(f))return x(V);for(const H of V){const[_,k]=C(H);K[k]=_,G.spec.items.push(E(H,k))}return[K,G]}function x(V){let K=null,G=0;const H={},_={kind:"RowsLayout",spec:{rows:[]}};for(const k of V)if(f(k)){G=k.gridPos.y,K&&_.spec.rows.push(K);const J=[];for(const z of k.panels||[]){const[Y,X]=C(z);H[X]=Y,J.push(E(z,X,D(z,G)))}K=b(k,J)}else{const[J,z]=C(k);if(H[z]=J,K)if(K.spec.layout.kind==="GridLayout")K.spec.layout.spec.items.push(E(k,z,D(k,G)));else throw new Error("RowsLayoutRow from legacy row must have a GridLayout");else{const Y={kind:"GridLayout",spec:{items:[E(k,z)]}};G=-1,K={kind:"RowsLayoutRow",spec:{collapse:!1,title:"",hideHeader:!0,layout:Y}}}}return K&&_.spec.rows.push(K),[H,_]}function f(V){return V.type==="row"}function u(V,K){return!V||!(0,l.rE)(V)?K:V}function b(V,K){return{kind:"RowsLayoutRow",spec:{collapse:V.collapsed,title:V.title??"",repeat:V.repeat?{value:V.repeat,mode:"variable"}:void 0,layout:{kind:"GridLayout",spec:{items:K}}}}}function E(V,K,G){return{kind:"GridLayoutItem",spec:{x:V.gridPos.x,y:G??V.gridPos.y,width:V.gridPos.w,height:V.gridPos.h,repeat:V.repeat?{value:V.repeat,mode:"variable",direction:V.repeatDirection,maxPerRow:V.maxPerRow}:void 0,element:{kind:"ElementReference",name:K}}}}function D(V,K){return V.gridPos.y-K-d.o}function C(V){const K=`panel-${V.id}`;if(V.libraryPanel)return[{kind:"LibraryPanel",spec:{libraryPanel:{uid:V.libraryPanel.uid,name:V.libraryPanel.name},id:V.id,title:V.title??""}},K];{const G=O(V.targets||[],V.datasource||T()),H=I(V.transformations||[]);return[{kind:"Panel",spec:{title:V.title||"",description:V.description||"",vizConfig:{kind:V.type,spec:{fieldConfig:V.fieldConfig||(0,s.bt)(),options:V.options,pluginVersion:V.pluginVersion}},links:V.links?.map(k=>({title:k.title,url:k.url||"",targetBlank:k.targetBlank}))||[],id:V.id,data:{kind:"QueryGroup",spec:{queries:G,transformations:H,queryOptions:{cacheTimeout:V.cacheTimeout,maxDataPoints:V.maxDataPoints,interval:V.interval,hideTimeOverride:V.hideTimeOverride,queryCachingTTL:V.queryCachingTTL,timeFrom:V.timeFrom,timeShift:V.timeShift}}}}},K]}}function P(){return(0,c.Ic)()?.type??"grafana"}function T(){const V=(0,c.Ic)()??{type:"grafana",uid:"-- Grafana --"};if(V.uid&&!V.apiVersion){const K=n.$.bootData.settings.datasources[V.uid];V.apiVersion=K.apiVersion??void 0}return{apiVersion:V.apiVersion,type:V.type,uid:V.uid}}function O(V,K){return V.map(G=>{const{refId:H,hide:_,datasource:k,...J}=G;return{kind:"PanelQuery",spec:{refId:G.refId,hidden:G.hide??!1,datasource:G.datasource?G.datasource:K,query:{kind:G.datasource?.type||K.type,spec:{...J}}}}})}function I(V){return V.map(K=>({kind:K.id,spec:{...K,topic:(0,p.MM)(K.topic)}}))}function j(V){const K=[];for(const G of V){const H={name:G.name,label:G.label,...G.description&&{description:G.description},skipUrlSync:!!G.skipUrlSync,hide:(0,p.NB)(G.hide)};switch(G.type){case"query":let _=G.query||{};typeof _=="string"&&(console.warn("Query variable query is a string which is deprecated in the schema v2. It should extend DataQuery"),_={[p.sB]:_});const k={kind:"QueryVariable",spec:{...H,multi:!!G.multi,includeAll:!!G.includeAll,...G.allValue&&{allValue:G.allValue},current:{value:G.current?.value,text:G.current?.text},options:G.options||[],refresh:(0,p.qJ)(G.refresh),...G.datasource&&{datasource:G.datasource},regex:G.regex||"",sort:(0,p.LY)(G.sort),query:{kind:G.datasource?.type||P(),spec:_},allowCustomValue:G.allowCustomValue??!0}};K.push(k);break;case"datasource":let J=P();G.query&&typeof G.query=="string"&&(J=G.query);const z={kind:"DatasourceVariable",spec:{...H,multi:!!G.multi,includeAll:!!G.includeAll,...G.allValue&&{allValue:G.allValue},current:{value:G.current.value,text:G.current.text},options:G.options||[],refresh:(0,p.qJ)(G.refresh),pluginId:J,regex:G.regex||"",allowCustomValue:G.allowCustomValue??!0}};K.push(z);break;case"custom":const Y={kind:"CustomVariable",spec:{...H,query:G.query,current:{value:G.current.value,text:G.current.text},options:G.options,multi:G.multi,includeAll:G.includeAll,...G.allValue&&{allValue:G.allValue},allowCustomValue:G.allowCustomValue??!0}};K.push(Y);break;case"adhoc":const X={kind:"AdhocVariable",spec:{...H,datasource:G.datasource||T(),baseFilters:(0,i.Gs)(G.baseFilters)||[],filters:(0,i.Gs)(G.filters)||[],defaultKeys:G.defaultKeys||[],allowCustomValue:G.allowCustomValue??!0}};K.push(X);break;case"constant":const Q={kind:"ConstantVariable",spec:{...H,current:{value:G.current.value,text:G.current.value},query:G.query}};K.push(Q);break;case"interval":const q={kind:"IntervalVariable",spec:{...H,current:{value:G.current.value,text:G.current.value},query:G.query,refresh:"onTimeRangeChanged",options:G.options,auto:G.auto,auto_min:G.auto_min,auto_count:G.auto_count}};K.push(q);break;case"textbox":const te={kind:"TextVariable",spec:{...H,current:{value:G.current.value,text:G.current.value},query:G.query}};K.push(te);break;case"groupby":const ne={kind:"GroupByVariable",spec:{...H,datasource:G.datasource||T(),options:G.options,current:{value:G.current.value,text:G.current.text},multi:G.multi}};K.push(ne);break;default:console.error(`Variable transformation not implemented: ${G.type}`)}}return K}function W(V){return V.map(K=>({kind:"AnnotationQuery",spec:{name:K.name,...K.datasource&&{datasource:K.datasource},enable:K.enable,hide:!!K.hide,iconColor:K.iconColor,builtIn:!!K.builtIn,query:{kind:K.datasource?.type||P(),spec:{...K.target}},filter:K.filter}}))}function B(V){const K=[];for(const G of V){const H={name:G.spec.name,label:G.spec.label,...G.spec.description&&{description:G.spec.description},skipUrlSync:G.spec.skipUrlSync,hide:(0,m.cc)(G.spec.hide),type:U(G)};switch(G.kind){case"QueryVariable":const _={...H,current:G.spec.current,options:G.spec.options,query:p.sB in G.spec.query.spec?G.spec.query.spec[p.sB]:G.spec.query.spec,datasource:G.spec.datasource,sort:(0,m.ES)(G.spec.sort),refresh:(0,m.tH)(G.spec.refresh),regex:G.spec.regex,allValue:G.spec.allValue,includeAll:G.spec.includeAll,multi:G.spec.multi,definition:G.spec.definition};K.push(_);break;case"DatasourceVariable":const k={...H,current:G.spec.current,options:[],regex:G.spec.regex,refresh:(0,m.tH)(G.spec.refresh),query:G.spec.pluginId,multi:G.spec.multi,allValue:G.spec.allValue,includeAll:G.spec.includeAll};K.push(k);break;case"CustomVariable":const J={...H,current:{text:G.spec.current.value,value:G.spec.current.value},options:G.spec.options,query:G.spec.query,multi:G.spec.multi,allValue:G.spec.allValue,includeAll:G.spec.includeAll};K.push(J);break;case"ConstantVariable":const z={...H,current:{text:G.spec.current.value,value:G.spec.current.value},hide:(0,m.cc)(G.spec.hide),query:G.spec.current.value};K.push(z);break;case"IntervalVariable":const Y={...H,current:{text:G.spec.current.value,value:G.spec.current.value},hide:(0,m.cc)(G.spec.hide),query:G.spec.query,refresh:(0,m.tH)(G.spec.refresh),options:G.spec.options,auto:G.spec.auto,auto_min:G.spec.auto_min,auto_count:G.spec.auto_count};K.push(Y);break;case"TextVariable":const X={text:G.spec.current.value,value:G.spec.current.value},Q={...H,current:{text:G.spec.current.value,value:G.spec.current.value},options:[{...X,selected:!0}],query:G.spec.query};K.push(Q);break;case"GroupByVariable":const q={...H,datasource:G.spec.datasource,current:G.spec.current,options:G.spec.options};K.push(q);break;case"AdhocVariable":const te={...H,datasource:G.spec.datasource,baseFilters:G.spec.baseFilters,filters:G.spec.filters,defaultKeys:G.spec.defaultKeys};K.push(te);break;default:console.error(`Variable transformation not implemented: ${G}`)}}return K}function S(V){return V.map(K=>({name:K.spec.name,datasource:K.spec.datasource,enable:K.spec.enable,hide:K.spec.hide,iconColor:K.spec.iconColor,builtIn:K.spec.builtIn?1:0,target:K.spec.query?.spec,filter:K.spec.filter}))}function w(V,K){const G=[];let H=0;if(K.kind!=="GridLayout")throw new Error("Cannot convert non-GridLayout layout to v1");for(const _ of K.spec.items){const k=V[_.spec.element.name],J=N(k,_);G.push(J),(J.id??0>H)&&(H=J.id??0)}for(const _ of G)_.type==="row"&&_.id===-1&&(_.id=++H);return G}function N(V,K,G){const{x:H,y:_,width:k,height:J,repeat:z}=K?.spec||{x:0,y:0,width:0,height:0},Y={x:H,y:G??_,w:k,h:J};if(V.kind==="Panel"){const X=V.spec;return{id:X.id,type:X.vizConfig.kind,title:X.title,description:X.description,fieldConfig:M(X.vizConfig.spec.fieldConfig),options:X.vizConfig.spec.options,pluginVersion:X.vizConfig.spec.pluginVersion,links:X.links?.map(Q=>({title:Q.title,url:Q.url,...Q.targetBlank&&{targetBlank:Q.targetBlank}}))||[],targets:X.data.spec.queries.map(Q=>({refId:Q.spec.refId,hide:Q.spec.hidden,datasource:Q.spec.datasource,...Q.spec.query.spec})),transformations:X.data.spec.transformations.map(Q=>Q.spec),gridPos:Y,cacheTimeout:X.data.spec.queryOptions.cacheTimeout,maxDataPoints:X.data.spec.queryOptions.maxDataPoints,interval:X.data.spec.queryOptions.interval,hideTimeOverride:X.data.spec.queryOptions.hideTimeOverride,queryCachingTTL:X.data.spec.queryOptions.queryCachingTTL,timeFrom:X.data.spec.queryOptions.timeFrom,timeShift:X.data.spec.queryOptions.timeShift,transparent:X.transparent,...z?.value&&{repeat:z.value},...z?.direction&&{repeatDirection:z.direction},...z?.maxPerRow&&{maxPerRow:z.maxPerRow}}}else if(V.kind==="LibraryPanel"){const X=V.spec;return{id:X.id,title:X.title,gridPos:Y,libraryPanel:{uid:X.libraryPanel.uid,name:X.libraryPanel.name},type:"library-panel-ref"}}else throw new Error(`Unknown element kind: ${V}`)}function M(V){const K=H=>{switch(H){case"absolute":return a.Ol.Absolute;case"percentage":return a.Ol.Percentage;default:return a.Ol.Absolute}},G={...V.defaults};return V.defaults.mappings&&(G.mappings=V.defaults.mappings.map(H=>{switch(H.type){case"value":return{...H,type:a.dM.ValueToText};case"range":return{...H,type:a.dM.RangeToText};case"regex":return{...H,type:a.dM.RegexToText};case"special":return{...H,options:{...H.options,match:A(H.options.match)},type:a.dM.SpecialValue};default:return H}})),V.defaults.thresholds&&(G.thresholds={...V.defaults.thresholds,mode:K(V.defaults.thresholds.mode)}),V.defaults.color?.mode&&(G.color={...V.defaults.color,mode:L(V.defaults.color.mode)}),{...V,defaults:G}}function L(V){switch(V){case"thresholds":return a.Yb.Thresholds;case"palette-classic":return a.Yb.PaletteClassic;case"palette-classic-by-name":return a.Yb.PaletteClassicByName;case"continuous-GrYlRd":return a.Yb.ContinuousGrYlRd;case"continuous-RdYlGr":return a.Yb.ContinuousRdYlGr;case"continuous-BlYlRd":return a.Yb.ContinuousBlYlRd;case"continuous-YlRd":return a.Yb.ContinuousYlRd;case"continuous-BlPu":return a.Yb.ContinuousBlPu;case"continuous-YlBl":return a.Yb.ContinuousYlBl;case"continuous-blues":return a.Yb.ContinuousBlues;case"continuous-reds":return a.Yb.ContinuousReds;case"continuous-greens":return a.Yb.ContinuousGreens;case"continuous-purples":return a.Yb.ContinuousPurples;case"fixed":return a.Yb.Fixed;case"shades":return a.Yb.Shades;default:return a.Yb.Thresholds}}function A(V){switch(V){case"true":return a.WL.True;case"false":return a.WL.False;case"null":return a.WL.Null;case"nan":return a.WL.NaN;case"null+nan":return a.WL.NullAndNan;case"empty":return a.WL.Empty;default:throw new Error(`Unknown match type: ${V}`)}}function U(V){switch(V.kind){case"QueryVariable":return"query";case"DatasourceVariable":return"datasource";case"CustomVariable":return"custom";case"ConstantVariable":return"constant";case"IntervalVariable":return"interval";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";case"AdhocVariable":return"adhoc";default:throw new Error(`Unknown variable type: ${V}`)}}function F(V,K){const G=S(V.annotations),H=B(V.variables),_=w(V.elements,V.layout);return{uid:K.name,title:V.title,description:V.description,tags:V.tags,schemaVersion:40,graphTooltip:(0,m.Y_)(V.cursorSync),preload:V.preload,liveNow:V.liveNow,editable:V.editable,gnetId:K.annotations?.[o.hm],revision:V.revision,time:{from:V.timeSettings.from,to:V.timeSettings.to},timezone:V.timeSettings.timezone,refresh:V.timeSettings.autoRefresh,timepicker:{refresh_intervals:V.timeSettings.autoRefreshIntervals,hidden:V.timeSettings.hideTimepicker,quick_ranges:V.timeSettings.quickRanges,nowDelay:V.timeSettings.nowDelay},fiscalYearStartMonth:V.timeSettings.fiscalYearStartMonth,weekStart:V.timeSettings.weekStart,version:K.generation,links:V.links,annotations:{list:G},panels:_,templating:{list:H}}}},13956:(Z,R,e)=>{"use strict";e.d(R,{n:()=>v});var n=e(66402),a=e(95407),s=e(60171),l=e(45173),o=e(99828);class d{constructor(){this.v1Client=new l.P,this.v2Client=new o.L}async getDashboardDTO(f){try{return await this.v1Client.getDashboardDTO(f)}catch(u){if(u instanceof a.P&&u.data.storedVersion==="v2alpha1")return await this.v2Client.getDashboardDTO(f);throw u}}async saveDashboard(f){if((0,s.mi)(f))return await this.v2Client.saveDashboard(f);if((0,s.rL)(f))return await this.v1Client.saveDashboard(f);throw new Error("Invalid dashboard command")}async deleteDashboard(f,u){return await this.v1Client.deleteDashboard(f,u)}async listDeletedDashboards(f){const u=await this.v1Client.listDeletedDashboards(f),b=u.items.filter(C=>!(0,s.QX)(C,"v2"));if(b.length===u.items.length)return u;const E=await this.v2Client.listDeletedDashboards(f),D=E.items.filter(C=>!(0,s.QX)(C,"v1"));return{...E,items:[...b,...D]}}async restoreDashboard(f){if((0,s.aK)(f.spec)&&(0,n.N)(f))return await this.v2Client.restoreDashboard(f);if((0,n.N)(f))return await this.v1Client.restoreDashboard(f);throw new Error("Invalid dashboard resource for restore operation")}}var i=e(32899),c=e(92745),m=e(68143),p=e(45229),h=e(79718);class r{constructor(){}saveDashboard(f){return h.t.ignoreNextSave(),(0,m.AI)().post("/api/dashboards/db/",{dashboard:f.dashboard,message:f.message??"",overwrite:f.overwrite??!1,folderUid:f.folderUid})}deleteDashboard(f,u){return(0,m.AI)().delete(`/api/dashboards/uid/${f}`,void 0,{showSuccessAlert:u,validatePath:!0})}async getDashboardDTO(f,u){const b=await(0,m.AI)().get(`/api/dashboards/uid/${f}`,u,void 0,{validatePath:!0});if(b.meta.isFolder)throw p.A.emit(i.r1.alertError,["Dashboard not found"]),{status:404,config:{url:`/api/dashboards/uid/${f}`},data:{message:(0,c.t)("dashboard.legacy-dashboard-api.fetch-error.message.dashboard-not-found","Dashboard not found")}};return b}listDeletedDashboards(f){return Promise.resolve({apiVersion:"v1",kind:"List",metadata:{resourceVersion:"0"},items:[]})}restoreDashboard(f){return Promise.reject(new Error("Restore functionality not supported in legacy API"))}}let g;function y(x){throw new Error("dashboardAPI can be only overridden in test environment")}function v(x){const f=(0,s.GV)(x);if(g||(g={legacy:new r,v1:new l.P,v2:new o.L,unified:new d}),!g[f])throw new Error(`Unknown Dashboard API version: ${f}`);return g[f]}},62905:(Z,R,e)=>{"use strict";e.d(R,{$L:()=>b,AK:()=>D,Bs:()=>g,Ht:()=>h,NA:()=>E,NY:()=>u,Sm:()=>r,T2:()=>v,U9:()=>y,_e:()=>f,bN:()=>x,eq:()=>T,ft:()=>O,g9:()=>P,kd:()=>C});var n=e(75816),a=e(92745),s=e(68143),l=e(43173),o=e(73892),d=e(6890),i=e(64762),c=e(24313),m=e(72746);function p(I){return typeof I=="object"&&I!=null&&"error"in I}const h=I=>({error:(0,s.NF)(I)&&I.data.messageId!=="publicdashboards.notFound"?I:null}),r=(0,n.xP)({reducerPath:"publicDashboardApi",baseQuery:(0,o.W)({baseURL:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:I=>({getPublicDashboard:I.query({query:j=>({url:`/dashboards/uid/${j}/public-dashboards`,manageError:h,showErrorAlert:!1}),async onQueryStarted(j,{dispatch:W,queryFulfilled:B}){try{await B}catch(S){p(S)&&(0,s.NF)(S.error)&&W((0,d.dx)((0,i.gi)(S.error.data.message)))}},providesTags:(j,W,B)=>[{type:"PublicDashboard",id:B}]}),createPublicDashboard:I.mutation({query:j=>({url:`/dashboards/uid/${j.dashboard instanceof m.H$?j.dashboard.state.uid:j.dashboard.uid}/public-dashboards`,method:"POST",body:j.payload}),async onQueryStarted({dashboard:j,payload:{share:W}},{dispatch:B,queryFulfilled:S}){const{data:w}=await S;let N=(0,a.t)("public-dashboard.sharing.success-creation","Dashboard is public!");l.$.featureToggles.newDashboardSharingComponent&&(N=W===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,a.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),B((0,d.dx)((0,i.tZ)(N))),j instanceof m.H$?j.setState({meta:{...j.state.meta,publicDashboardEnabled:w.isEnabled}}):j.updateMeta({publicDashboardEnabled:w.isEnabled})},invalidatesTags:(j,W,{dashboard:B})=>[{type:"PublicDashboard",id:B instanceof m.H$?B.state.uid:B.uid}]}),updatePublicDashboard:I.mutation({query:({payload:j,dashboard:W})=>({url:`/dashboards/uid/${W instanceof m.H$?W.state.uid:W.uid}/public-dashboards/${j.uid}`,method:"PATCH",body:j}),async onQueryStarted({dashboard:j},{dispatch:W,queryFulfilled:B}){await B,W((0,d.dx)((0,i.tZ)(l.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(j,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:I.mutation({query:({payload:j,dashboard:W})=>({url:`/dashboards/uid/${W instanceof m.H$?W.state.uid:W.uid}/public-dashboards/${j.uid}`,method:"PATCH",body:j}),async onQueryStarted({dashboard:j,payload:{isEnabled:W}},{dispatch:B,queryFulfilled:S}){const{data:w}=await S;let N=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");l.$.featureToggles.newDashboardSharingComponent&&(N=W?(0,a.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,a.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),B((0,d.dx)((0,i.tZ)(N))),j instanceof m.H$?j.setState({meta:{...j.state.meta,publicDashboardEnabled:w.isEnabled}}):j.updateMeta?.({publicDashboardEnabled:w.isEnabled})},invalidatesTags:(j,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:I.mutation({query:({payload:j,dashboard:W})=>({url:`/dashboards/uid/${W instanceof m.H$?W.state.uid:W.uid}/public-dashboards/${j.uid}`,method:"PATCH",body:j}),async onQueryStarted({dashboard:j,payload:{share:W}},{dispatch:B,queryFulfilled:S}){await S;let w=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");l.$.featureToggles.newDashboardSharingComponent&&(w=W===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,a.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access updated: Only specific people can now access with the link")),B((0,d.dx)((0,i.tZ)(w)))},invalidatesTags:(j,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:I.mutation({query:()=>({url:""})}),deleteRecipient:I.mutation({query:()=>({url:""})}),reshareAccessToRecipient:I.mutation({query:()=>({url:""})}),getActiveUsers:I.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:I.query({query:()=>({url:""}),providesTags:(j,W,B)=>[{type:"ActiveUserDashboards",id:B}]}),listPublicDashboards:I.query({query:(j=1)=>({url:`/dashboards/public-dashboards?page=${j}&perpage=8`}),transformResponse:j=>({...j,totalPages:Math.ceil(j.totalCount/j.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:I.mutation({query:j=>({url:`/dashboards/uid/${j.dashboardUid}/public-dashboards/${j.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:j},{dispatch:W,queryFulfilled:B}){await B,W((0,d.dx)((0,i.tZ)(l.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,a.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),W(r.util?.resetApiState()),j instanceof m.H$?j.setState({meta:{...j.state.meta,publicDashboardEnabled:!1}}):j?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(j,W,{dashboardUid:B})=>[{type:"PublicDashboard",id:B},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:I.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:g,useCreatePublicDashboardMutation:y,useUpdatePublicDashboardMutation:v,useDeletePublicDashboardMutation:x,useListPublicDashboardsQuery:f,useAddRecipientMutation:u,useDeleteRecipientMutation:b,useReshareAccessToRecipientMutation:E,useGetActiveUsersQuery:D,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:P,usePauseOrResumePublicDashboardMutation:T,useUpdatePublicDashboardAccessMutation:O}=r},95407:(Z,R,e)=>{"use strict";e.d(R,{P:()=>n});class n extends Error{constructor(s,l="Dashboard version mismatch"){super(l),this.name="DashboardVersionError",this.status=200,this.data={storedVersion:s,message:l}}}},60171:(Z,R,e)=>{"use strict";e.d(R,{GV:()=>s,HG:()=>i,QX:()=>h,_5:()=>d,aK:()=>o,b_:()=>l,mi:()=>m,rL:()=>c});var n=e(43173),a=e(36490);function s(r){const g=n.$.featureToggles.dashboardScene,y=n.$.featureToggles.kubernetesDashboards,v=a.Ny.getSearch().get("scenes")==="false";if(!g||v){if(r==="v2")throw new Error("v2 is not supported for legacy architecture");return y?"v1":"legacy"}if(y)return r==="v1"?"v1":r==="v2"?"v2":"unified";if(r==="v2")throw new Error("v2 is not supported if kubernetes dashboards are disabled");return"legacy"}function l(r){return r?"kind"in r&&r.kind==="DashboardWithAccessInfo":!1}function o(r){return"elements"in r}function d(r){return!o(r)}function i(r){return l(r)&&o(r.spec)}function c(r){return!o(r.dashboard)}function m(r){return o(r.dashboard)}function p(r){return r.status?.conversion?.failed?r.status.conversion.storedVersion:void 0}function h(r,g){const y=p(r);return!!y&&y.startsWith(g)}},45173:(Z,R,e)=>{"use strict";e.d(R,{P:()=>h,_:()=>p});var n=e(92138),a=e(92745),s=e(83873),l=e(47797),o=e(77197),d=e(54115),i=e(75735),c=e(52043),m=e(95407);const p={group:"dashboard.grafana.app",version:"v1beta1",resource:"dashboards"};class h{constructor(){this.client=new d.ws(p)}saveDashboard(g){const y=g.dashboard,v={metadata:{...g?.k8s},spec:{...y,title:y.title??"",uid:y.uid??""}};return g.message?v.metadata.annotations={...v.metadata.annotations,[i.fY]:g.message}:v.metadata.annotations&&delete v.metadata.annotations[i.fY],g.folderUid&&(v.metadata.annotations={...v.metadata.annotations,[i.ew]:g.folderUid}),y.uid?(v.metadata.name=y.uid,delete v.metadata.resourceVersion,this.client.update(v,{fieldValidation:"Ignore"}).then(x=>this.asSaveDashboardResponseDTO(x))):(v.metadata.annotations={...v.metadata.annotations,[i.AI]:"default"},this.client.create(v,{fieldValidation:"Ignore"}).then(x=>this.asSaveDashboardResponseDTO(x)))}asSaveDashboardResponseDTO(g){const y=n.I.assureBaseUrl((0,c.u)({uid:g.metadata.name,currentQueryParams:"",slug:o.A.slugifyForUrl(g.spec.title.trim())}));return{uid:g.metadata.name,version:g.metadata.generation??0,id:g.spec.id??0,status:"success",url:y,slug:""}}deleteDashboard(g,y){return this.client.delete(g,y).then(v=>({id:0,message:v.message,title:(0,a.t)("dashboard.k8s-dashboard-api.title.deleted","deleted")}))}async getDashboardDTO(g){try{const y=await this.client.subresource(g,"dto");if(y.status?.conversion?.failed&&y.status.conversion.storedVersion==="v2alpha1")throw new m.P(y.status.conversion.storedVersion,y.status.conversion.error);const v={meta:{...y.access,isNew:!1,isFolder:!1,uid:y.metadata.name,k8s:y.metadata,version:y.metadata.generation,created:y.metadata.creationTimestamp},dashboard:{...y.spec,version:y.metadata.generation,uid:y.metadata.name}},x=y.metadata.annotations??{},f=x[i.LH];if(f&&(v.meta.provisioned=x[i.Ms]==="true"||f===i.Sf.Repo,v.meta.provisionedExternalId=x[i.Y_]),y.metadata.labels?.[i.Y5]&&(v.dashboard.id=parseInt(y.metadata.labels[i.Y5],10)),y.metadata.annotations?.[i.ew])try{const u=await s.IB.getFolderByUid(y.metadata.annotations[i.ew]);v.meta.folderTitle=u.title,v.meta.folderUrl=u.url,v.meta.folderUid=u.uid,v.meta.folderId=u.id}catch{throw new Error("Failed to load folder")}return v}catch(y){const v=(0,l.do)(y);throw(0,l.q6)(y).includes("not found")&&v!==404&&(y.status=404,y.data.message="Dashboard not found"),y}}async listDeletedDashboards(g){return await this.client.list({...g,labelSelector:"grafana.app/get-trash=true"})}restoreDashboard(g){return g.metadata.resourceVersion="",this.client.create(g)}}},99828:(Z,R,e)=>{"use strict";e.d(R,{L:()=>r,P:()=>h});var n=e(92138),a=e(92745),s=e(83873),l=e(47797),o=e(77197),d=e(54115),i=e(75735),c=e(52043),m=e(95407),p=e(60171);const h={group:"dashboard.grafana.app",version:"v2alpha1",resource:"dashboards"};class r{constructor(){this.client=new d.ws(h)}async getDashboardDTO(y){try{const v=await this.client.subresource(y,"dto");if(!(0,p.aK)(v.spec)&&v.status?.conversion?.failed&&(v.status.conversion.storedVersion==="v1alpha1"||v.status.conversion.storedVersion==="v1beta1"||v.status.conversion.storedVersion==="v0alpha1"))throw new m.P(v.status.conversion.storedVersion,v.status.conversion.error);if(v.metadata.annotations&&v.metadata.annotations[i.ew])try{const x=await s.IB.getFolderByUid(v.metadata.annotations[i.ew]);v.metadata.annotations[i.w2]=x.title,v.metadata.annotations[i.D1]=x.url}catch{throw new Error("Failed to load folder")}else v.metadata.annotations&&!v.metadata.annotations[i.ew]&&(v.metadata.annotations[i.ew]="");return v}catch(v){const x=(0,l.do)(v);throw(0,l.q6)(v).includes("not found")&&x!==404&&(v.status=404,v.data.message="Dashboard not found"),v}}deleteDashboard(y,v){return this.client.delete(y,v).then(x=>({id:0,message:x.message,title:(0,a.t)("dashboard.k8s-dashboard-v2api.title.deleted","deleted")}))}async saveDashboard(y){const v=y.dashboard,x={metadata:{...y?.k8s},spec:{...v}};return y.message?x.metadata.annotations={...x.metadata.annotations,[i.fY]:y.message}:x.metadata.annotations&&delete x.metadata.annotations[i.fY],y.folderUid&&(delete x.metadata.annotations?.[i.w2],delete x.metadata.annotations?.[i.D1],x.metadata.annotations={...x.metadata.annotations,[i.ew]:y.folderUid}),x.metadata.name?(delete x.metadata.resourceVersion,this.client.update(x).then(f=>this.asSaveDashboardResponseDTO(f))):(x.metadata.annotations={...x.metadata.annotations,[i.AI]:"default"},await this.client.create(x).then(f=>this.asSaveDashboardResponseDTO(f)))}asSaveDashboardResponseDTO(y){const v=n.I.assureBaseUrl((0,c.u)({uid:y.metadata.name,currentQueryParams:"",slug:o.A.slugifyForUrl(y.spec.title.trim())}));let x=0;return y.metadata.labels?.[i.Y5]&&(x=parseInt(y.metadata.labels[i.Y5],10)),{uid:y.metadata.name,version:y.metadata.generation??0,id:x,status:"success",url:v,slug:""}}listDeletedDashboards(y){return this.client.list({...y,labelSelector:"grafana.app/get-trash=true"})}restoreDashboard(y){return y.metadata.resourceVersion="",this.client.create(y)}}},25157:(Z,R,e)=>{"use strict";e.d(R,{UP:()=>ne,fP:()=>se,Ay:()=>de});var n=e(74848),a=e(96540),s=e(22803),l=e(71468),o=e(54148),d=e(63704),i=e(92745),c=e(36490),m=e(79104),p=e(71599),h=e(93256),r=e(7895),g=e(8515),y=e(36219),v=e(6890),x=e(43707),f=e(5423),u=e(65642),b=e(64762),E=e(73427),D=e(94232),C=e(38206),P=e(43550),T=e(51898),O=e(88559),I=e(45861),j=e(30703),W=e(87063),B=e(77731),S=e(23289),w=e(52763),N=e(37918);const L=({dashboard:he})=>{const me=(0,a.useMemo)(()=>(0,B._u)(),[]),ce=(0,w.wA)(),Pe=(0,w.d4)(Ie=>Ie.dashboard.initialDatasource);return(0,n.jsxs)(W.W,{children:[(0,n.jsx)(W.W.Item,{testId:T.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,i.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Ie=(0,B.OK)(he,Pe);S.c.toolbarAddButtonClicked({item:"add_visualization"}),c.Ny.partial({editPanel:Ie}),ce((0,N.Ub)(void 0))}},"add-visualisation"),(0,n.jsx)(W.W.Item,{testId:T.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,i.t)("dashboard.add-menu.row","Row"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"add_row"}),(0,B.SD)(he)}},"add-row"),(0,n.jsx)(W.W.Item,{testId:T.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,i.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,B.s3)(he)}},"add-panel-lib"),(0,n.jsx)(W.W.Item,{testId:T.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,i.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,B.no)(he,me)},disabled:!me},"add-panel-clipboard")]})},U=({dashboard:he,onToolbarAddMenuOpen:me})=>{const[ce,Pe]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{ce&&me&&me()},[ce,me]),(0,n.jsx)(O.m,{overlay:()=>(0,n.jsx)(L,{dashboard:he}),placement:"bottom",offset:[0,6],onVisibleChange:Pe,children:(0,n.jsxs)(I.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":T.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(i.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(j.I,{name:ce?"angle-up":"angle-down",size:"lg"})]})})};var F=e(37010),V=e(22429),K=e(98036),G=e(4590),H=e(69289),_=e(87745),k=e(75541),J=e(34339),z=e(74618),Y=e(58662);const X=({dashboard:he})=>(0,n.jsx)(I.$n,{"data-testid":T.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{S.c.toolbarShareClick(),c.Ny.partial({shareView:Y.wr.link})},children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),Q={removeNavIndex:P.Im,setStarred:C.ci,updateTimeZoneForSession:H.Cj,updateNavIndex:v.Vz},q=he=>({navIndex:he.navIndex}),te=(0,l.connect)(q,Q);function ne(he){(0,k.Y)("left",he)}function se(he){(0,k.Y)("right",he)}const ue=(0,a.memo)(he=>{(0,o.zy)();const me=(0,m.C)();(0,D.u)(he.dashboard.events,_.Cf);const ce=he.dashboard.snapshot?.originalUrl??"",Pe=()=>{window.location.href=d.sQ.sanitizeUrl(he.dashboard.snapshot.originalUrl)},Ie=(0,b._2)(),Se=()=>{try{const Be=new URL(d.sQ.sanitizeUrl(ce),u.Ay.appUrl),We=new URL(u.Ay.appUrl);Be.host!==We.host?E.lE.publish(new _.S8({component:p.u,props:{title:(0,i.t)("dashboard.dash-nav.on-open-snapshot-original.title.proceed-to-external-site","Proceed to external site?"),modalClass:ie,body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:ce})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:(0,i.t)("dashboard.dash-nav.on-open-snapshot-original.confirmText.proceed","Proceed"),onConfirm:Pe}})):Pe()}catch(Be){Ie.error("Invalid URL",Be instanceof Error?Be.message:void 0)}},Me=()=>{S.c.toolbarFavoritesClick();const Be=(0,V.UA)(),{dashboard:We,navIndex:_e,removeNavIndex:Xe,setStarred:le,updateNavIndex:ye}=he;Be.starDashboard(We.uid,!!We.meta.isStarred).then(pe=>{le({id:We.uid,title:We.title,url:We.meta.url??"",isStarred:pe});const ve=_e.starred;if(pe)ve.children?.push({id:C.L1+We.uid,text:We.title,url:We.meta.url??"",parentItem:ve});else{Xe(C.L1+We.uid);const be=ve.children?.findIndex(Oe=>Oe.id===C.L1+We.uid);be&&ve.children?.splice(be,1)}ye(ve),We.meta.isStarred=pe,me()})},Te=()=>{S.c.toolbarSettingsClick(),c.Ny.partial({editview:"settings"})},Ge=()=>{G._o.prev()},Qe=()=>{G._o.next()},tt=()=>{G._o.stop(),me()},ke=(Be,We)=>{Be.map((_e,Xe)=>{const le=_e.component,ye=(0,a.createElement)(le,{...he,key:`button-custom-${Xe}`});typeof _e.index=="number"?We.splice(_e.index,0,ye):We.push(ye)})},He=()=>G._o.state.isPlaying,Re=()=>{const Be=u.Ay.buildInfo.env==="development",{dashboard:We,kioskMode:_e}=he,{canStar:Xe,isStarred:le}=We.meta,ye=[];if(_e||He())return[];if(Xe){let pe=le?(0,i.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,i.t)("dashboard.toolbar.mark-favorite","Mark as favorite");ye.push((0,n.jsx)(J._,{tooltip:pe,icon:le?"favorite":"star",iconType:le?"mono":"default",iconSize:"lg",onClick:Me},"button-star"))}return We.uid&&ye.push((0,n.jsx)(K.u,{uid:We.uid},"public-dashboard-badge")),Be&&u.Ay.featureToggles.dashboardScene&&ye.push((0,n.jsx)(J._,{tooltip:(0,i.t)("dashboard.dash-nav.render-left-actions.tooltip-view-as-scene","View as Scene"),icon:"apps",onClick:()=>{c.Ny.partial({scenes:!0})}},"button-scenes")),ke(k.C.left,ye),ye},Ne=()=>(0,n.jsxs)(h.e,{children:[(0,n.jsx)(r.I,{tooltip:(0,i.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:Ge,narrow:!0}),(0,n.jsx)(r.I,{onClick:tt,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,n.jsx)(r.I,{tooltip:(0,i.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Qe,narrow:!0})]},"playlist-buttons"),Ae=()=>{const{dashboard:Be,updateTimeZoneForSession:We,hideTimePicker:_e}=he;return _e?null:(0,n.jsx)(z.$,{dashboard:Be,onChangeTimeZone:We},"time-controls")},Ue=()=>{const{dashboard:Be,isFullscreen:We,hideTimePicker:_e}=he,{canSave:Xe,canEdit:le,showSettings:ye,canShare:pe}=Be.meta,{snapshot:ve}=Be,be=ve&&ve.originalUrl,Oe=[];return He()?[Ne(),Ae()]:(be&&Oe.push((0,n.jsx)(r.I,{tooltip:(0,i.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Se,icon:"link"},"button-snapshot")),Xe&&!We&&Oe.push((0,n.jsx)(g.$s,{children:({showModal:we,hideModal:ze})=>(0,n.jsx)(r.I,{tooltip:(0,i.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{we(F.$,{dashboard:Be,onDismiss:ze})}})},"button-save")),ke(k.C.right,Oe),ye&&Oe.push((0,n.jsx)(r.I,{tooltip:(0,i.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Te},"button-settings")),le&&!We&&Oe.push((0,n.jsx)(U,{onToolbarAddMenuOpen:S.c.toolbarAddClick,dashboard:Be},"panel-add-dropdown")),pe&&Oe.push((0,n.jsx)(X,{dashboard:Be},"button-share")),_e||Oe.push((0,n.jsx)(f.K,{},"toolbar-separator")),Oe.push(Ae()),Oe)};return(0,n.jsx)(x.H,{actions:(0,n.jsxs)(n.Fragment,{children:[Re(),(0,n.jsx)(f.K,{leftActionsSeparator:!0}),(0,n.jsx)(y.U,{alignment:"right",children:Ue()})]})})});ue.displayName="DashNav";const de=te(ue),ie=(0,s.css)({width:"max-content",maxWidth:"80vw"})},34339:(Z,R,e)=>{"use strict";e.d(R,{_:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(76319);const o=({icon:i,iconType:c,iconSize:m,tooltip:p,onClick:h,children:r})=>{const g=(0,s.of)(d);return(0,n.jsxs)("div",{className:g.noBorderContainer,children:[i&&(0,n.jsx)(l.K,{name:i,size:m,iconType:c,tooltip:p,tooltipPlacement:"bottom",onClick:h}),r]})},d=i=>({noBorderContainer:(0,a.css)({padding:`0 ${i.spacing(.5)}`,display:"flex"})})},74618:(Z,R,e)=>{"use strict";e.d(R,{$:()=>g});var n=e(74848),a=e(96540),s=e(33239),l=e(92745),o=e(75234),d=e(90811),i=e(5857),c=e(51158),m=e(73427),p=e(15130),h=e(75421),r=e(87745);class g extends a.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=v=>{(0,h.jG)().setAutoRefresh(v),this.forceUpdate()},this.onRefresh=()=>((0,h.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{m.lE.publish(new r.Io({direction:r.xL.Left}))},this.onMoveForward=()=>{m.lE.publish(new r.Io({direction:r.xL.Right}))},this.onChangeTimePicker=v=>{const{dashboard:x}=this.props,f=x.timepicker,u=f.nowDelay&&v.raw.to==="now",b=s.isMathString(v.raw.from)?v.raw.from:v.from,E=s.isMathString(v.raw.to)?v.raw.to:v.to,D={from:b,to:u?"now-"+f.nowDelay:E};(0,h.jG)().setTime(D)},this.onChangeTimeZone=v=>{this.props.dashboard.timezone=v,this.props.onChangeTimeZone(v),this.onRefresh()},this.onChangeFiscalYearStartMonth=v=>{this.props.dashboard.fiscalYearStartMonth=v,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),m.lE.publish(new r.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(o.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:v,isOnCanvas:x}=this.props,{quick_ranges:f,refresh_intervals:u}=v.timepicker,b=(0,h.jG)().getValidIntervals(u||d.cb),E=(0,h.jG)().timeRange(),D=v.getTimezone(),C=v.fiscalYearStartMonth,P=v.panelInEdit?.isEditing,T=v.weekStart;let O;return v.refresh===p.SM&&(O=(0,h.jG)().getAutoRefreshInteval().interval),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.mR,{value:E,onChange:this.onChangeTimePicker,timeZone:D,fiscalYearStartMonth:C,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:x,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:(0,i.rE)(T)?T:void 0,quickRanges:f}),(0,n.jsx)(d.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:v.refresh,intervals:b,isOnCanvas:x,tooltip:(0,l.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:P,showAutoInterval:!0,text:O})]})}}},39302:(Z,R,e)=>{"use strict";e.d(R,{d:()=>o});var n=e(74848),a=e(22803),s=e(63142),l=e(45861);const o=({children:i,...c})=>{const m=(0,s.of)(d);return(0,n.jsx)("div",{className:m.buttonWrapper,children:(0,n.jsx)(l.$n,{icon:"plus",...c,children:i})})},d=i=>({buttonWrapper:(0,a.css)({padding:`${i.spacing(3)} 0`})})},56291:(Z,R,e)=>{"use strict";e.d(R,{p:()=>u});var n=e(74848),a=e(2543),s=e(96540),l=e(17548),o=e(51898),d=e(92745),i=e(74475),c=e(37386),m=e(59310),p=e(5857),h=e(63527),r=e(21285),g=e(90811),y=e(75421);const v=({refreshIntervals:b,onRefreshIntervalChange:E,getIntervalsFunc:D=f,validateIntervalsFunc:C=x})=>{const[P,T]=(0,s.useState)(D(b??g.cb)),[O,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{const S=D(b??g.cb);T(S)},[D,b]);const j=(0,s.useMemo)(()=>Array.isArray(P)?P.join(","):"",[P]),W=(0,s.useCallback)(S=>{const w=S.currentTarget.value?S.currentTarget.value.split(","):[];T(w)},[T]),B=(0,s.useCallback)(S=>{const w=C(P);w===null&&E(D(P)),I(w)},[D,P,E,C]);return(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,d.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:O,invalid:!!O,children:(0,n.jsx)(h.p,{id:"auto-refresh-input",invalid:!!O,value:j,onChange:W,onBlur:B})})},x=(b,E={getTimeSrv:y.jG})=>{try{return f(b,E),null}catch(D){return D instanceof Error?D.message:"Invalid intervals"}},f=(b,E={getTimeSrv:y.jG})=>{const D=b.filter(C=>C.trim()!=="").map(C=>C.replace(/\s+/g,""));return[...new Set(E.getTimeSrv().getValidIntervals(D))]};class u extends s.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=E=>{const D=E.currentTarget.value;if((0,a.isEmpty)(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);if(l.isValidTimeSpan(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=E=>{typeof E=="string"&&this.props.onTimeZoneChange(E)},this.onWeekStartChange=E=>{this.props.onWeekStartChange(E)}}render(){return(0,n.jsxs)(i.M,{label:(0,d.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":o.Tp.components.TimeZonePicker.containerV2,children:(0,n.jsx)(m.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":o.Tp.components.WeekStartPicker.containerV2,children:(0,n.jsx)(p.l6,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,n.jsx)(v,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,d.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,n.jsx)(h.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,n.jsx)(r.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,n.jsx)(c.D,{label:(0,d.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,d.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously update panels when the time range includes the current time"),children:(0,n.jsx)(r.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},16200:(Z,R,e)=>{"use strict";e.d(R,{n:()=>V,C:()=>F});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(45861),d=e(66404),i=e(59243),c=e(68079),m=e(45967),p=e(92745),h=e(34999),r=e(41654),g=e(63527),y=e(30703),v=e(89640),x=e(76319);const f=({currentPage:G,numberOfPages:H,onNavigate:_,hideWhenSinglePage:k,className:J})=>{const z=(0,l.of)(u);return k&&H<=1?null:(0,n.jsxs)("div",{className:(0,a.cx)(z.wrapper,J),children:[(0,n.jsx)(x.K,{name:"angle-left",size:"md",tooltip:(0,p.t)("dashboard.minimalistic-pagination.tooltip-previous","Previous"),onClick:()=>_(G-1),disabled:G===1}),(0,n.jsxs)(p.x6,{i18nKey:"dashboard.minimalistic-pagination.page-count",children:[{currentPage:G}," of ",{numberOfPages:H}]}),(0,n.jsx)(x.K,{name:"angle-right",size:"md",tooltip:(0,p.t)("dashboard.minimalistic-pagination.tooltip-next","Next"),onClick:()=>_(G+1),disabled:G===H})]})},u=G=>({wrapper:(0,a.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),b=({history:G,index:H,onNavigate:_})=>{const k=(0,l.of)(E),J=G.length;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:k.contentWrapper,children:(0,n.jsx)(d.E,{element:"p",color:"secondary",children:G[H-1]})}),(0,n.jsx)(f,{currentPage:H,numberOfPages:J,onNavigate:_,hideWhenSinglePage:!1,className:k.paginationWrapper})]})},E=G=>({paginationWrapper:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,a.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:G.colors.background.secondary,border:`1px solid ${G.colors.border.weak}`,padding:G.spacing(1),minHeight:60})});var D=e(66769);const C=({onSuggestionClick:G,isGenerating:H})=>{const _=(0,l.of)(P);return(0,n.jsxs)("div",{className:_.quickSuggestionsWrapper,children:[(0,n.jsx)(o.$n,{onClick:()=>G(D.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:H,children:D.HG.Shorter}),(0,n.jsx)(o.$n,{onClick:()=>G(D.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:H,children:D.HG.MoreDescriptive}),(0,n.jsx)(o.$n,{onClick:()=>G(D.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:H,children:"Regenerate"})]})},P=G=>({quickSuggestionsWrapper:(0,a.css)({display:"flex",flexDirection:"row",gap:8})});var T=e(16817),O=e(87056),I=e(25992),j=e(64762);const W=(0,I.DW)("features.dashboards.genai");var B=(G=>(G.IDLE="idle",G.GENERATING="generating",G.COMPLETED="completed",G))(B||{});const S=1e4,w={model:D.ys,temperature:1};function N({model:G,temperature:H,onResponse:_}=w){const[k,J]=(0,s.useState)([]),[z,Y]=(0,s.useState)(""),[X,Q]=(0,s.useState)("idle"),[q,te]=(0,s.useState)(),{error:ne}=(0,j._2)();let se="";const ue=(0,s.useCallback)(Pe=>{Q("idle"),J([]),te(Pe),ne("Failed to generate content using LLM","Please try again or if the problem persists, contact your organization admin."),console.error(Pe),W.logError(Pe,{messages:JSON.stringify(k),model:G,temperature:String(H)})},[k,G,H,ne]);(0,s.useEffect)(()=>{k.length>0&&Y("")},[k]);const{error:de,value:ie}=(0,T.A)(async()=>await(0,D.QX)(),[D.QX]),{error:he,value:me}=(0,T.A)(async()=>{if(!ie||!k.length)return{enabled:ie};Q("generating"),te(void 0);const Pe=O.qH({model:G,temperature:H,messages:k}).pipe(O.qA());return{enabled:ie,stream:Pe.subscribe({next:Ie=>{se=Ie},error:ue,complete:()=>{Y(se),Q("completed"),_?.(se),J([]),te(void 0)}})}},[k,ie]);(0,s.useEffect)(()=>()=>{me?.stream?.unsubscribe()},[me]);const ce=(0,s.useCallback)(()=>{me?.stream?.unsubscribe(),Q("idle"),te(void 0),J([])},[me]);return(0,s.useEffect)(()=>{let Pe;return X==="generating"&&z===""&&(Pe=setTimeout(()=>{ue(new Error(`LLM stream timed out after ${S}ms`))},S)),()=>{clearTimeout(Pe)}},[X,z,ue]),(he||de)&&te(he||de),{setMessages:J,stopGeneration:ce,messages:k,reply:z,streamStatus:X,error:q,value:me}}var M=e(37680);const L=.5,A=({eventTrackingSrc:G,history:H,messages:_,onApplySuggestion:k,updateHistory:J})=>{const z=(0,l.of)(U),[Y,X]=(0,s.useState)(1),[Q,q]=(0,s.useState)(""),te=(0,s.useCallback)(He=>{J((0,D.Kb)(He))},[J]),{setMessages:ne,stopGeneration:se,reply:ue,streamStatus:de,error:ie}=N({model:D.ys,temperature:L,onResponse:te}),he=(He,Re)=>(0,M.XX)(G,He,Re),me=He=>{Se(He),he(M.KR.customFeedback,{customFeedback:He})},ce=()=>{se(),ue&&te(ue)},Pe=()=>{k(H[Y-1])},Ie=He=>{X(He),he(He>Y?M.KR.backHistoryItem:M.KR.forwardHistoryItem)},Se=He=>{ne(Re=>[...Re,...(0,D.To)(H[Y-1],He)]),He in D.HG&&he(M.KR.quickFeedback,{quickFeedbackItem:He})},Me=He=>He.key==="Enter"&&me(Q),Te=He=>q(He.currentTarget.value),Ge=()=>me(Q),Qe=()=>he(M.KR.linkToDocs),tt=de===B.GENERATING,ke=ie&&!tt;return(0,n.jsxs)("div",{className:z.container,children:[ke&&(0,n.jsx)(h.F,{title:"",children:(0,n.jsx)(r.B,{direction:"column",children:(0,n.jsx)("p",{children:(0,n.jsx)(p.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,n.jsx)(b,{history:H,index:Y,onNavigate:Ie}),(0,n.jsx)("div",{className:z.actionButtons,children:(0,n.jsx)(C,{onSuggestionClick:Se,isGenerating:tt})}),(0,n.jsx)(g.p,{placeholder:(0,p.t)("dashboard.gen-aihistory.placeholder-tell-ai-what-to-do-next","Tell AI what to do next..."),suffix:(0,n.jsx)(o.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":(0,p.t)("dashboard.gen-aihistory.aria-label-send-custom-feedback","Send custom feedback"),onClick:Ge,disabled:!Q,children:(0,n.jsx)(p.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:Q,onChange:Te,onKeyDown:Me}),(0,n.jsx)("div",{className:z.applySuggestion,children:(0,n.jsx)(r.B,{justifyContent:"flex-end",direction:"row",children:tt?(0,n.jsx)(o.$n,{icon:"fa fa-spinner",onClick:ce,children:F}):(0,n.jsx)(o.$n,{icon:"check",onClick:Pe,children:(0,n.jsx)(p.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,n.jsxs)("div",{className:z.footer,children:[(0,n.jsx)(y.I,{name:"exclamation-circle",className:z.infoColor}),(0,n.jsx)(d.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsxs)(p.x6,{i18nKey:"dashboard.gen-aihistory.footer-text",children:["This content is AI-generated using the"," ",(0,n.jsx)(v.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Qe,children:"Grafana LLM plugin"})]})})]})]})},U=G=>({container:(0,a.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,a.css)({paddingTop:G.spacing(2)}),actions:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,a.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:G.spacing(1),paddingLeft:G.spacing(2),alignItems:"center",gap:G.spacing(1),borderTop:`1px solid ${G.colors.border.weak}`,marginTop:G.spacing(2)}),infoColor:(0,a.css)({color:G.colors.info.main}),actionButtons:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),F="Stop generating",V=({text:G="Auto-generate",toggleTipTitle:H="",onClick:_,model:k=D.ys,messages:J,onGenerate:z,temperature:Y=1,eventTrackingSrc:X,disabled:Q,tooltip:q})=>{const te=(0,l.of)(K),[ne,se]=(0,s.useState)([]),ue=(0,s.useCallback)(Xe=>{se(le=>[Xe,...le])},[]),de=(0,s.useCallback)(Xe=>{const le=(0,D.Kb)(Xe);z(le),ue(le)},[z,ue]),{setMessages:ie,stopGeneration:he,value:me,error:ce,streamStatus:Pe}=N({model:k,temperature:Y,onResponse:de}),[Ie,Se]=(0,s.useState)(!1),Me=ne.length>0,Te=!Me,Ge=Pe===B.GENERATING,Qe=Q||me&&!me.enabled&&!ce,tt=(0,s.useCallback)(Xe=>(0,M.XX)(X,Xe),[X]),ke=ce||q?void 0:!1,He=ce?"Failed to generate content using LLM. Please try again or if the problem persists, contact your organization admin.":q||"",Re=Xe=>{Pe===B.GENERATING?he():Me?Se(!0):(_?.(Xe),ie(We()));const le=ce?M.KR.erroredRetryButton:Ge?M.KR.stopGenerationButton:Te?M.KR.autoGenerateButton:M.KR.improveButton;tt(le)};if(!me?.enabled)return null;const Ne=Xe=>{tt(M.KR.applySuggestion),z(Xe),Se(!1)},Ae=()=>{if(!Ge)return ce||me&&!me.enabled?"exclamation-circle":"ai"},Ue=()=>{let Xe=G;return ce&&(Xe="Retry"),Ge&&(Xe=F),Me&&(Xe="Improve"),Xe},Be=(0,n.jsx)(o.$n,{icon:Ae(),onClick:Re,fill:"text",size:"sm",disabled:Qe,variant:ce?"destructive":"primary",children:Ue()}),We=()=>typeof J=="function"?J():J,_e=()=>{if(Me){const Xe=(0,n.jsx)(d.E,{element:"p",children:H});return(0,n.jsx)(i.G,{title:Xe,content:(0,n.jsx)(A,{history:ne,messages:We(),onApplySuggestion:Ne,updateHistory:ue,eventTrackingSrc:X}),placement:"left-start",fitContent:!0,show:Ie,onClose:()=>Se(!1),onOpen:()=>Se(!0),children:Be})}return Be};return(0,n.jsxs)("div",{className:te.wrapper,children:[Ge&&(0,n.jsx)(c.y,{size:"sm",className:te.spinner}),Te?(0,n.jsx)(m.m,{show:ke,interactive:!0,content:He,children:Be}):_e()]})},K=G=>({wrapper:(0,a.css)({display:"flex"}),spinner:(0,a.css)({color:G.colors.text.link})})},42357:(Z,R,e)=>{"use strict";e.d(R,{V:()=>c});var n=e(74848),a=e(22429),s=e(16200),l=e(37680),o=e(66769);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,c=({onGenerate:p})=>{const h=(0,a.UA)().getCurrent(),r=(0,o.N3)(h);return(0,n.jsx)(s.n,{messages:m(h),onGenerate:p,eventTrackingSrc:l.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:r.length===0,tooltip:r.length===0?o.ZN:void 0})};function m(p){return[{content:i,role:o.Xh.system},{content:`The title of the dashboard is "${p.title}"
${(0,o.BB)(p)}`,role:o.Xh.user}]}},70969:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>c});var n=e(74848),a=e(22429),s=e(16200),l=e(37680),o=e(66769);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,c=({onGenerate:p})=>{const h=(0,a.UA)().getCurrent(),r=(0,o.N3)(h);return(0,n.jsx)(s.n,{messages:m(h),onGenerate:p,eventTrackingSrc:l.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:r.length===0,tooltip:r.length===0?o.ZN:void 0})};function m(p){return[{content:i,role:o.Xh.system},{content:`The panels in the dashboard are: ${(0,o.BB)(p)}`,role:o.Xh.user}]}},22055:(Z,R,e)=>{"use strict";e.d(R,{t:()=>c});var n=e(74848),a=e(22429),s=e(16200),l=e(37680),o=e(66769);const i=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,c=({onGenerate:p,panel:h})=>(0,n.jsx)(s.n,{messages:()=>m(h),onGenerate:p,eventTrackingSrc:l.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function m(p){const h=(0,a.UA)().getCurrent(),r=(0,o.hn)(p);return[{content:i,role:o.Xh.system},{content:`The panel is part of a dashboard with the title: ${h.title}
The panel is part of a dashboard with the description: ${h.description}
This is the JSON which defines the panel: ${r}`,role:o.Xh.user}]}},76623:(Z,R,e)=>{"use strict";e.d(R,{h:()=>i});var n=e(74848),a=e(16200),s=e(37680),l=e(66769);const d="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",i=({onGenerate:m,panel:p,dashboard:h})=>(0,n.jsx)(a.n,{messages:()=>c(p,h),onGenerate:m,eventTrackingSrc:s.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function c(m,p){const h=(0,l.hn)(m);return[{content:d,role:l.Xh.system},{content:`The panel is part of a dashboard with the title: ${p.title}
The panel is part of a dashboard with the description: ${p.description}
Use this JSON object which defines the panel: ${h}`,role:l.Xh.user}]}},37680:(Z,R,e)=>{"use strict";e.d(R,{KR:()=>l,XX:()=>o,ec:()=>s});var n=e(27489);const a="dashboards_autogenerate_clicked";var s=(d=>(d.panelDescription="panel-description",d.panelTitle="panel-title",d.dashboardChanges="dashboard-changes",d.dashboardTitle="dashboard-title",d.dashboardDescription="dashboard-description",d.unknown="unknown",d))(s||{}),l=(d=>(d.autoGenerateButton="auto-generate-button",d.erroredRetryButton="errored-retry-button",d.stopGenerationButton="stop-generating-button",d.improveButton="improve-button",d.backHistoryItem="back-history-item",d.forwardHistoryItem="forward-history-item",d.quickFeedback="quick-feedback",d.linkToDocs="link-to-docs",d.customFeedback="custom-feedback",d.applySuggestion="apply-suggestion",d))(l||{});function o(d,i,c){(0,n.rR)(a,{src:d,item:i,...c})}},66769:(Z,R,e)=>{"use strict";e.d(R,{ZN:()=>I,ys:()=>u,HG:()=>f,Xh:()=>x,Yy:()=>E,BB:()=>T,To:()=>P,hn:()=>O,N3:()=>j,QX:()=>C,Kb:()=>b});var n=e(2543),a=e(87056),s=e(43173),l=e(77731),o=e(18795),d=e(7817);function i(B,S){return B===S?S:Array.isArray(B)&&Array.isArray(S)?p(B,S):c(B)&&c(S)?m(B,S):S}function c(B){return typeof B=="object"&&!Array.isArray(B)&&B!==null}function m(B,S){const w=Object.keys(B),N={};for(const M of w)S.hasOwnProperty(M)&&(Array.isArray(B[M])&&Array.isArray(S[M])||typeof B[M]=="object"&&typeof S[M]=="object"?N[M]=i(B[M],S[M]):N[M]=S[M]);return N}function p(B,S){const w=new Array(B.length).fill(void 0),N=new Set([...Array(B.length).keys()]),M=new Set([...Array(S.length).keys()]);for(let L=0;L<B.length&&M.size!==0;L++){let A=B[L];for(let U=0;U<S.length;U++){if(!M.has(U))continue;let F=S[U];F=i(A,F),JSON.stringify(A)===JSON.stringify(F)&&(N.delete(L),M.delete(U),w[L]=F)}}return h(B,S,w,N,M),w.filter(L=>L!==void 0)}function h(B,S,w,N,M){let L={};M.forEach(U=>{let F=S[U];if(typeof F!="object"||Array.isArray(F)){w.push(F),M.delete(U);return}N.forEach(V=>{let K=B[V];if(typeof K!="object"||Array.isArray(K)){N.delete(V);return}let G=0;for(const H in K){let _=K[H];if(!F.hasOwnProperty(H))continue;let k=F[H];typeof _!="string"&&typeof _!="number"||typeof _!=typeof k||_===k&&(H==="id"&&(G+=1e3),G++)}G!==0&&(L[G]===void 0&&(L[G]=[]),L[G].push([V,U]))})});const A=Object.keys(L).map(Number);A.sort((U,F)=>F-U);for(const U of A){let F=L[U];for(const V of F){const[K,G]=V;N.has(K)&&M.has(G)&&(w[K]=S[G],N.delete(K),M.delete(G))}}for(const U of M)w.push(S[U])}function r(B){const S=B.split(`
`);let w=B[0].startsWith("Index")?4:3,N=S.slice(0,w);const M=/("title"|Title|\{|\}|\[|\])/i;for(let L=w;L<S.length;L++){let A=S[L];(M.test(A)||A.startsWith("+")||A.startsWith("-"))&&N.push(A)}return N.join(`
`)+`
`}function g(B){if(B===null||B==="")return null;if(Array.isArray(B)){const w=B.map(N=>g(N)).filter(N=>N!==null);return w.length>0?w:null}if(typeof B!="object")return B;const S={};for(const w in B){const N=g(B[w]);if(N!==null){if(Array.isArray(N)&&N.length===0||typeof N=="object"&&Object.keys(N).length===0)continue;S[w]=N}}return Object.keys(S).length>0?S:null}function y(B){return JSON.parse(JSON.stringify(B,null,2))}function v(B){let S=y(B.getOriginalDashboard()),w=y(new d.G(S).getSaveModelClone()),N=y(B.getSaveModelClone());w=g(i(S,w)),N=g(i(w,N)),S=g(S);let M=(0,o.ss)("Before migration changes","After migration changes",JSON.stringify(S,null,2),JSON.stringify(w,null,2),"","",{context:20}),L=(0,o.ss)("Before user changes","After user changes",JSON.stringify(w,null,2),JSON.stringify(N,null,2),"","",{context:20});return M=r(M),L=r(L),{migrationDiff:M,userDiff:L}}var x=(B=>(B.system="system",B.user="user",B))(x||{}),f=(B=>(B.Shorter="Even shorter",B.MoreDescriptive="More descriptive",B.Regenerate="Please, regenerate",B))(f||{});const u=a.Kx.LARGE,b=B=>B.replace(/^"|"$/g,"");function E(B){const{migrationDiff:S,userDiff:w}=v(B);return{userChanges:w,migrationChanges:S}}let D;async function C(){return s.$.apps["grafana-llm-app"]?D||(D=new Promise(B=>{a.vK().then(S=>{S.ok||(D=void 0),B(S.ok)})}),D):!1}const P=(B,S)=>[{role:"system",content:`Your previous response was: ${B}. The user has provided the following feedback: ${S}. Re-generate your response according to the provided feedback.`}];function T(B){const S=j(B);let w;if(S.length<=10)w=`The panels in the dashboard are:
${S.join(`
`)}`;else{const N=B.panels.filter(A=>A.description),M=B.panels.filter(A=>!A.description);let L;N.length>=10?L=N.slice(10).map(W).join(`
`):(L=N.map(W).join(`
`),L+=`
`,L+=M.slice(10-N.length).map(W).join("n")),w=`There are ${S.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${L}`}return w}function O(B){const S=["datasource","title","description","targets","type"],w={...(0,n.pick)(B,S),options:(0,n.pick)(B.options,["content"])};return JSON.stringify(w,null,2)}const I="To generate this content your dashboard must contain at least one panel with a valid title or description.";function j(B){return B.panels.filter(w=>w.title.length>0&&w.title!==l.LH||w.description&&w.description.length>0).map(W)}const W=(B,S)=>`- Panel ${S}
- Title: ${B.title}${B.description?`
- Description: ${B.description}`:""}`},98314:(Z,R,e)=>{"use strict";e.d(R,{B6:()=>r,E_:()=>y,jD:()=>g});var n=e(2543),a=e.n(n),s=e(72985),l=e(77154),o=e(739),d=e(80011),i=e(28105),c=e(92745),m=e(43173),p=e(34273),h=e(8095);function r(b){const E=[];if(b?.series)for(const D of b.series)E.push((0,l.Nw)(D));if(b?.annotations)for(const D of b.annotations){const C=(0,l.Nw)(D);C.schema?.meta||(C.schema.meta={}),C.schema.meta.dataTopic=o.QR.Annotations,E.push(C)}return E}function g(b,E){const D=b.getSaveModel(),C={panelType:D.type,datasource:"??"},P=m.$.buildInfo.versionString;let T=`| Key | Value |
|--|--|
| Panel | ${C.panelType} @ ${D.pluginVersion??P} |
| Grafana | ${P} // ${m.$.buildInfo.edition} |
`;return E&&(T+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+E+"\n```\n</details>"),T}async function y(b,E,D){const C=b.getSaveModel(),P=(0,n.cloneDeep)(u),T={panelType:C.type,datasource:"??"},O=await(0,s._)(b.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),I=b.datasource,j=(0,p.W)(r(O),E),W=m.$.buildInfo.versionString,B=C?.targets??[],S=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${T.panelType} @ ${C.pluginVersion??W}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${B.map(w=>{const N=w.datasource??I;return`${w.refId}[${N?.type}]`}).join(", ")}</td>
    </tr>
    ${v(C)}
    ${x(O,j)}
    ${f(O)}
    <tr>
      <th>Grafana</th>
      <td>${W} // ${m.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(P.panels[0]={...C,...P.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:h.nj.Snapshot,snapshot:j}]},C.transformations?.length){const w=P.panels[P.panels.length-1];w.title=w.title+" (after transformations)";const N=(0,n.cloneDeep)(w);N.id=100,N.title="Data (before transformations)",N.gridPos.w=24,N.targets[0].withTransforms=!1,P.panels.push(N)}return O.annotations?.length&&P.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:(0,c.t)("dashboard.get-debug-dashboard.title.annotations","Annotations"),datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:o.QR.Annotations,refId:"A"}]}),P.panels[1].options.content=S,P.panels[2].options.content=JSON.stringify(C,null,2),P.title=`Debug: ${C.title} // ${(0,d.LE)(new Date)}`,P.tags=["debug",`debug-${T.panelType}`],P.time={from:D.from.toISOString(),to:D.to.toISOString()},P}function v(b){return b.transformations?`<tr>
      <th>Transform</th>
      <td>${b.transformations.map(E=>E.id).join(", ")}</td>
  </tr>`:""}function x(b,E){let D=b.series.length??0,C=0,P=0;for(const T of b.series)C+=T.fields.length,P+=T.length;return`<tr><th>Data</th><td>${b.state!==i.Gu.Done?b.state:""} ${D} frames, ${C} fields, ${P} rows </td></tr>`}function f(b){return b.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${b.annotations.map((E,D)=>`<span>${E.length}</span>`)}</td>
</tr>`:""}const u={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},14252:(Z,R,e)=>{"use strict";e.d(R,{BN:()=>c,kx:()=>m,sd:()=>i});var n=e(96540),a=e(24705),s=e(92745),l=e(78282),o=e(26689),d=e(61215);const i=p=>(0,a.A)(async()=>c(p),[p]).value;async function c(p){const h=p?.request?.targets||[];if(p&&p.series&&h.length){for(const r of p.series)if(r.meta&&r.meta.custom){const g=await(0,l.l)().get(h[0].datasource);if(g&&g.components?.MetadataInspector)return g}}}const m=(p,h,r,g,y)=>(0,n.useMemo)(()=>{const v=[];return(0,d.$)(r)&&(v.push({label:(0,s.t)("dashboard.inspect.data-tab","Data"),value:o.q.Data}),v.push({label:(0,s.t)("dashboard.inspect.stats-tab","Stats"),value:o.q.Stats})),y&&v.push({label:(0,s.t)("dashboard.inspect.meta-tab","Meta data"),value:o.q.Meta}),v.push({label:(0,s.t)("dashboard.inspect.json-tab","JSON"),value:o.q.JSON}),g&&v.push({label:(0,s.t)("dashboard.inspect.error-tab","Error"),value:o.q.Error}),h.meta.canEdit&&(0,d.$)(r)&&v.push({label:(0,s.t)("dashboard.inspect.query-tab","Query"),value:o.q.Query}),v},[r,y,h,g])},74098:(Z,R,e)=>{"use strict";e.d(R,{D:()=>y});var n=e(74848),a=e(22803),s=e(96540),l=e(78685),o=e(51898),d=e(72489),i=e(63142),c=e(45967),m=e(30703),p=e(45861),h=e(70958),r=e(42795);const g="showCategory",y=s.memo(({id:f,title:u,children:b,forceOpen:E,isOpenDefault:D=!0,renderTitle:C,className:P,itemsCount:T,isNested:O=!1,sandboxId:I,disabledText:j})=>{const[W,B]=(0,l.A)(x(f),{isExpanded:D}),S=E||(W?.isExpanded??D),[w,N]=(0,s.useState)(S),M=(0,s.useRef)(null),[L,A]=(0,h.s)(),U=L[g]===f;(0,s.useEffect)(()=>{(E||U)&&!w&&(N(!0),setTimeout(()=>{M.current?.scrollIntoView()},200))},[w,U,E]);const F=(0,s.useCallback)(()=>{A({[g]:w?void 0:f},!0),B({isExpanded:!w}),N(!w)},[A,w,f,B]);C||(C=function(k){return k||T===void 0||T===0?u:(0,n.jsxs)("span",{children:[u," ",(0,n.jsx)(d.p,{value:T})]})});const V=(0,i.of)(v),K=(0,a.cx)({[V.box]:!0,[V.boxNestedExpanded]:O&&w},P),G=(0,a.cx)(V.header,{[V.headerExpanded]:w,[V.headerNested]:O}),H=(0,a.cx)(V.body,{[V.bodyNested]:O});return j?(0,n.jsx)("div",{className:K,"data-plugin-sandbox":I,"data-testid":o.Tp.components.OptionsGroup.group(f),ref:M,children:(0,n.jsx)(c.m,{content:j,children:(0,n.jsxs)("div",{className:G,children:[(0,n.jsx)("h6",{id:`button-${f}`,className:(0,a.cx)(V.title,V.titleDisabled),children:C(w)}),(0,n.jsx)(m.I,{size:"sm",name:"ban",className:V.disabledIcon})]})})}):(0,n.jsxs)("div",{className:K,"data-plugin-sandbox":I,"data-testid":o.Tp.components.OptionsGroup.group(f),ref:M,children:[(0,n.jsxs)("div",{className:G,onClick:F,children:[(0,n.jsx)("h6",{id:`button-${f}`,className:(0,a.cx)(V.title,w&&V.titleExpanded),children:C(w)}),(0,n.jsx)(p.$n,{"data-testid":o.Tp.components.OptionsGroup.toggle(f),type:"button",fill:"text",size:"md",variant:"secondary","aria-expanded":w,className:V.toggleButton,icon:w?"angle-up":"angle-down",onClick:F})]}),w&&(0,n.jsx)("div",{className:H,id:f,"aria-labelledby":`button-${f}`,children:b})]})}),v=f=>({box:(0,a.css)({borderTop:`1px solid ${f.colors.border.weak}`}),boxNestedExpanded:(0,a.css)({marginBottom:f.spacing(2)}),title:(0,a.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",fontWeight:f.typography.fontWeightMedium,margin:0,color:f.colors.text.secondary}),titleExpanded:(0,a.css)({color:f.colors.text.primary}),header:(0,a.css)({display:"flex",alignItems:"center",padding:f.spacing(.5,1.5),color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,cursor:"pointer","&:hover":{background:f.colors.emphasize(f.colors.background.primary,.03)}}),toggleButton:(0,a.css)({alignSelf:"baseline"}),headerExpanded:(0,a.css)({color:f.colors.text.primary}),headerNested:(0,a.css)({padding:f.spacing(.5,0,.5,0)}),body:(0,a.css)({padding:f.spacing(1,2,1,2)}),titleDisabled:(0,a.css)({color:f.colors.text.disabled,cursor:"not-allowed"}),disabledIcon:(0,a.css)({color:f.colors.text.disabled,marginRight:f.spacing(1)}),bodyNested:(0,a.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"1px",width:"1px",height:"100%",background:f.colors.border.weak}})}),x=f=>`${r.wi}.optionGroup[${f}]`},25797:(Z,R,e)=>{"use strict";e.d(R,{C:()=>l});var n=e(74848),a=e(31286),s=e(74098);class l{constructor(d){this.props=d,this.items=[],this.categories=[]}addItem(d){return d.parent=this,this.items.push(d),this}addCategory(d){return d.props.isNested=!0,d.parent=this,this.categories.push(d),this}getCategory(d){let i=this.categories.find(c=>c.props.id===d);return i||(i=new l({title:d,id:d}),this.addCategory(i)),i}render(d){return this.props.customRender?this.props.customRender():this.props.title===""?(0,n.jsx)(a.a,{padding:2,paddingBottom:1,children:this.items.map(i=>i.render(d))},this.props.title):(0,n.jsxs)(s.D,{...this.props,children:[this.items.map(i=>i.render(d)),this.categories.map(i=>i.render(d))]},this.props.title)}}},51156:(Z,R,e)=>{"use strict";e.d(R,{v:()=>r});var n=e(74848),a=e(22803),s=e(23257),l=e.n(s),o=e(51898),d=e(37386),i=e(72636),c=e(63142),m=e(45967);function p({overrides:u}){const b=(0,c.of)(h);return(0,n.jsx)("div",{className:b.wrapper,children:u.map((E,D)=>(0,n.jsx)(m.m,{content:E.tooltip,placement:"top",children:(0,n.jsx)("div",{"aria-label":E.description,className:b[E.type]})},D.toString()))})}const h=u=>{const b={width:8,height:8,borderRadius:u.shape.radius.circle,marginLeft:u.spacing(1),top:"-1px"};return{wrapper:(0,a.css)({display:"flex"}),rule:(0,a.css)({...b,position:"relative",backgroundColor:u.colors.primary.main}),data:(0,a.css)({...b,position:"relative",backgroundColor:u.colors.warning.main})}};class r{constructor(b){this.props=b}render(b){return(0,n.jsx)(g,{itemDescriptor:this,searchQuery:b},this.props.title)}useShowIf(){return this.props.useShowIf?this.props.useShowIf():this.props.showIf?this.props.showIf():!0}}function g({itemDescriptor:u,searchQuery:b}){const{title:E,description:D,id:C,render:P,skipField:T}=u.props,O=`${u.parent.props.id} ${E}`;return u.useShowIf()?T?P(u):(0,n.jsx)(d.D,{label:y(u,b),description:D,"aria-label":o.Tp.components.PanelEditor.OptionsPane.fieldLabel(O),htmlFor:C,children:P(u)},O):null}function y(u,b){const{title:E,description:D,overrides:C,id:P,addon:T}=u.props;if(!E)return null;if(!b)return u.parent.props.title===E&&!C?.length?null:(0,n.jsx)(x,{title:E,description:D,overrides:C,addon:T,htmlFor:P});const O=[];return u.parent.parent&&O.push(v(u.parent.parent.props.title,b)),u.parent.props.title!==E&&O.push(v(u.parent.props.title,b)),(0,n.jsxs)(i.J,{description:D&&v(D,b),category:O,htmlFor:P,children:[v(E,b),C&&C.length>0&&(0,n.jsx)(p,{overrides:C})]})}function v(u,b){return(0,n.jsx)(l(),{textToHighlight:u,searchWords:[b],highlightClassName:"search-fragment-highlight"})}function x({title:u,description:b,overrides:E,addon:D,htmlFor:C}){const P=(0,c.of)(f);return(0,n.jsxs)("div",{className:P.container,children:[(0,n.jsxs)(i.J,{description:b,htmlFor:C,children:[u,E&&E.length>0&&(0,n.jsx)(p,{overrides:E})]}),D]})}function f(u){return{container:(0,a.css)({display:"flex",justifyContent:"space-between"})}}},68373:(Z,R,e)=>{"use strict";e.d(R,{gs:()=>A,Ff:()=>M,Po:()=>U});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(12737),i=e(77824),c=e(92807),m=e(75515),p=e(74098),h=e(25531),r=e(63527);const g=({panel:V,formatDate:K})=>{const G=(0,o.of)(y),H=V.libraryPanel?.meta;return H?(0,n.jsxs)("div",{className:G.info,children:[(0,n.jsx)("div",{className:G.libraryPanelInfo,children:(0,n.jsxs)(l.x6,{i18nKey:"library-panels.library-panel-info.usage-count",count:H.connectedDashboards,children:["Used on ","{{count}}"," dashboards"]})}),(0,n.jsx)("div",{className:G.libraryPanelInfo,children:(0,n.jsxs)(l.x6,{i18nKey:"library-panels.library-panel-info.last-edited",values:{timeAgo:K?.(H.updated,"L")??H.updated},components:{person:(0,n.jsxs)(n.Fragment,{children:[H.updatedBy.avatarUrl&&(0,n.jsx)("img",{width:"22",height:"22",className:G.userAvatar,src:H.updatedBy.avatarUrl,alt:`Avatar for ${H.updatedBy.name}`}),H.updatedBy.name]})},children:["Last edited on ","{{timeAgo}}"," by","<person />"]})})]}):null},y=V=>({info:(0,a.css)({lineHeight:1}),libraryPanelInfo:(0,a.css)({color:V.colors.text.secondary,fontSize:V.typography.bodySmall.fontSize}),userAvatar:(0,a.css)({borderRadius:V.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:V.spacing(1),paddingRight:V.spacing(1)})});var v=e(25797),x=e(51156);function f(V){const{panel:K,onPanelConfigChange:G,dashboard:H}=V,_=new v.C({title:(0,l.t)("dashboard.get-library-panel-options-category.descriptor.title.library-panel-options","Library panel options"),id:"Library panel options",isOpenDefault:!0});return(0,m.X)(K)&&_.addItem(new x.v({title:(0,l.t)("dashboard.get-library-panel-options-category.title.name","Name"),value:K.libraryPanel.name,popularRank:1,render:function(){return(0,n.jsx)(r.p,{id:"LibraryPanelFrameName",defaultValue:K.libraryPanel.name,onBlur:J=>G("libraryPanel",{...K.libraryPanel,name:J.currentTarget.value})})}})).addItem(new x.v({title:(0,l.t)("dashboard.get-library-panel-options-category.title.information","Information"),render:function(){return(0,n.jsx)(g,{panel:K,formatDate:H.formatDate})}})),_}var u=e(51898),b=e(43173),E=e(87105),D=e(21285),C=e(96822),P=e(18857),T=e(82345),O=e(22055),I=e(76623),j=e(31819);function W(V){const{dashboard:K,panel:G,onPanelConfigChange:H}=V,_=new v.C({title:(0,l.t)("dashboard.get-panel-frame-category.descriptor.title.panel-options","Panel options"),id:"Panel options",isOpenDefault:!0}),k=z=>{const Y=document.getElementById("PanelFrameTitle");Y instanceof HTMLInputElement&&(Y.value=z,H("title",z))},J=z=>{const Y=document.getElementById("description-text-area");Y instanceof HTMLTextAreaElement&&(Y.value=z,H("description",z))};return _.addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.title","Title"),id:"PanelFrameTitle",value:G.title,popularRank:1,render:function(Y){return(0,n.jsx)(r.p,{"data-testid":u.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:Y.props.id,defaultValue:G.title,onBlur:X=>H("title",X.currentTarget.value)})},addon:b.$.featureToggles.dashgpt&&(0,n.jsx)(I.h,{onGenerate:k,panel:G.getSaveModel(),dashboard:K.getSaveModelClone()})})).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.description","Description"),id:"description-text-area",description:G.description,value:G.description,render:function(Y){return(0,n.jsx)(E.f,{"data-testid":u.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:Y.props.id,defaultValue:G.description,onBlur:X=>H("description",X.currentTarget.value)})},addon:b.$.featureToggles.dashgpt&&(0,n.jsx)(O.t,{onGenerate:J,panel:G.getSaveModel()})})).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.transparent-background","Transparent background"),id:"transparent-background",render:function(Y){return(0,n.jsx)(D.d,{"data-testid":u.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:G.transparent,id:Y.props.id,onChange:X=>H("transparent",X.currentTarget.checked)})}})).addCategory(new v.C({title:(0,l.t)("dashboard.get-panel-frame-category.title.panel-links","Panel links"),id:"Panel links",isOpenDefault:!1,itemsCount:G.links?.length}).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.panel-links","Panel links"),render:function(){return(0,n.jsx)(C.e,{links:G.links,onChange:Y=>H("links",Y),getSuggestions:T.Fq,data:[]})}}))).addCategory(new v.C({title:(0,l.t)("dashboard.get-panel-frame-category.title.repeat-options","Repeat options"),id:"Repeat options",isOpenDefault:!1}).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.repeat-by-variable","Repeat by variable"),id:"repeat-by-variable-select",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(Y){return(0,n.jsx)(j.G,{id:Y.props.id,repeat:G.repeat,onChange:X=>{H("repeat",X)}})}})).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.repeat-direction","Repeat direction"),showIf:()=>!!G.repeat,render:function(){const Y=[{label:(0,l.t)("dashboard.get-panel-frame-category.direction-options.label.horizontal","Horizontal"),value:"h"},{label:(0,l.t)("dashboard.get-panel-frame-category.direction-options.label.vertical","Vertical"),value:"v"}];return(0,n.jsx)(i.z,{options:Y,value:G.repeatDirection||"h",onChange:X=>H("repeatDirection",X)})}})).addItem(new x.v({title:(0,l.t)("dashboard.get-panel-frame-category.title.max-per-row","Max per row"),showIf:()=>!!(G.repeat&&G.repeatDirection==="h"),render:function(){const Y=[2,3,4,6,8,12].map(X=>({label:X.toString(),value:X}));return(0,n.jsx)(P.l6,{options:Y,value:G.maxPerRow,onChange:X=>H("maxPerRow",X.value)})}})))}var B=e(56424);class S{constructor(K,G){this.categories=K,this.overrides=G}search(K){const G=new RegExp(K,"i"),_=this.collectHits(this.categories,G,[]).sort(w).map(z=>z.item),J=this.collectHits(this.overrides,G,[]).sort(w).map(z=>z.item);return{optionHits:_,overrideHits:this.buildOverrideHitCategories(J),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(K,G,H){for(const _ of K){const k=G.test(_.props.title);for(const J of _.items){if(G.test(J.props.title||"")){H.push({item:J,rank:1});continue}if(J.props.description&&G.test(J.props.description)){H.push({item:J,rank:2});continue}k&&H.push({item:J,rank:3})}_.categories.length>0&&this.collectHits(_.categories,G,H)}return H}getAllOptionsCount(K){let G=0;for(const H of K)G+=H.items.length,H.categories.length>0&&(G+=this.getAllOptionsCount(H.categories));return G}buildOverrideHitCategories(K){const G={};for(const H of K){let _=G[H.parent.props.title];_||(_=G[H.parent.props.title]=new v.C(H.parent.props),_.addItem(H.parent.items[0])),_.items[0].props.title!==H.props.title&&_.addItem(H)}return Object.values(G)}}function w(V,K){return V.rank-K.rank}function N(V){const K=[];for(const G of V)for(const H of G.items)H.props.title==="Unit"&&(H.props.popularRank=2),H.props.title==="Min"&&(H.props.popularRank=3),H.props.title==="Max"&&(H.props.popularRank=4),H.props.title==="Display name"&&(H.props.popularRank=5),H.props.popularRank&&K.push(H);return K.sort((G,H)=>G.props.popularRank-H.props.popularRank)}const M=V=>{const{plugin:K,panel:G}=V,[H,_]=(0,s.useState)(""),[k,J]=(0,s.useState)("All"),z=(0,o.of)(F),[Y,X,Q]=(0,s.useMemo)(()=>[W(V),(0,B.Zm)(V),f(V)],[G.configRev,V.data,V.instanceState,H]),q=(0,s.useMemo)(()=>(0,h.v)(V.panel.fieldConfig,V.plugin.fieldConfigRegistry,V.data?.series??[],H,V.onFieldConfigsChange),[G.configRev,V.data,V.instanceState,H]),te=[],ne=H.length>0,se=(0,s.useMemo)(L,[]),ue=(0,m.X)(G)?[Q,Y,...X]:[Y,...X];if(ne)te.push(U(ue,q,H));else switch(k){case"All":(0,m.X)(G)&&te.push(Q.render()),te.push(Y.render());for(const ie of X)te.push(ie.render());for(const ie of q)te.push(ie.render());break;case"Overrides":for(const ie of q)te.push(ie.render());break;case"Recent":te.push((0,n.jsx)(p.D,{id:"Recent options",title:(0,l.t)("dashboard.options-pane-options.Recent options-title-recent-options","Recent options"),forceOpen:!0,children:N(ue).map(ie=>ie.render())},"Recent options"));break}const de=!ne&&!K.fieldConfigRegistry.isEmpty();return(0,n.jsxs)("div",{className:z.wrapper,children:[(0,n.jsxs)("div",{className:z.formBox,children:[(0,n.jsx)("div",{className:z.formRow,children:(0,n.jsx)(d.Z,{width:0,value:H,onChange:_,placeholder:(0,l.t)("dashboard.options-pane-options.placeholder-search-options","Search options")})}),de&&(0,n.jsx)("div",{className:z.formRow,children:(0,n.jsx)(i.z,{options:se,value:k,fullWidth:!0,onChange:J})})]}),(0,n.jsx)(c.P,{children:(0,n.jsx)("div",{className:z.mainBox,children:te})})]})};function L(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var A=(V=>(V.All="All",V.Overrides="Overrides",V.Recent="Recent",V))(A||{});function U(V,K,G){const H=new S(V,K),{optionHits:_,totalCount:k,overrideHits:J}=H.search(G);return(0,n.jsxs)("div",{children:[(0,n.jsx)(p.D,{id:"Found options",title:(0,l.t)("dashboard.options-pane-options.title-matched","Matched {{count}}/{{totalCount}} options",{count:_.length,totalCount:k}),forceOpen:!0,children:_.map(z=>z.render(G))},"Normal options"),J.map(z=>z.render(G))]},"search results")}const F=V=>({wrapper:(0,a.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:V.colors.warning.text,background:"transparent"}}),searchBox:(0,a.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,a.css)({marginBottom:V.spacing(1)}),formBox:(0,a.css)({padding:V.spacing(1),background:V.colors.background.primary,border:`1px solid ${V.components.panel.borderColor}`,borderTopLeftRadius:V.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,a.css)({marginLeft:V.spacing(1)}),searchHits:(0,a.css)({padding:V.spacing(1,1,0,1)}),searchNotice:(0,a.css)({fontSize:V.typography.size.sm,color:V.colors.text.secondary,padding:V.spacing(1),textAlign:"center"}),mainBox:(0,a.css)({background:V.colors.background.primary,border:`1px solid ${V.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,a.css)({padding:V.spacing(1)})})},25531:(Z,R,e)=>{"use strict";e.d(R,{v:()=>W});var n=e(74848),a=e(22803),s=e(2543),l=e(36638),o=e(83340),d=e(92745),i=e(63152),c=e(59695),m=e(63142),p=e(82345),h=e(96540),r=e(23257),g=e.n(r),y=e(32881),v=e(72636),x=e(72489),f=e(76319),u=e(37386),b=e(74098);const E=({property:N,context:M,registry:L,onChange:A,onRemove:U,isSystemOverride:F,searchQuery:V})=>{const K=(0,m.of)(D),G=L?.getIfExists(N.id),H=(0,h.useId)();if(!G)return null;const _=Array.isArray(N.value)||N.id===o.uo.Thresholds||N.id===o.uo.Links||N.id===o.uo.Mappings,k=G.category?.filter(Y=>Y!==G.name);let J;const z=(Y=!0,X=!1)=>(Q=!1)=>(0,n.jsxs)(y.Gy,{justify:"space-between",children:[(0,n.jsxs)(v.J,{category:k,description:Y?G.description:void 0,htmlFor:H,children:[(0,n.jsx)(g(),{textToHighlight:G.name,searchWords:[V],highlightClassName:"search-fragment-highlight"}),!Q&&X&&G.getItemsCount&&(0,n.jsx)(x.p,{value:G.getItemsCount(N.value)})]}),!F&&(0,n.jsx)("div",{children:(0,n.jsx)(f.K,{name:"times",onClick:U,tooltip:(0,d.t)("dashboard.dynamic-config-value-editor.render-label.tooltip-remove-property","Remove property")})})]});return _?J=(0,n.jsx)(b.D,{id:G.name,renderTitle:z(!1,!0),className:(0,a.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:N.value!==void 0,children:(0,n.jsx)(G.override,{value:N.value,onChange:Y=>{A(Y)},item:G,context:M})}):J=(0,n.jsx)("div",{children:(0,n.jsx)(u.D,{label:z()(),description:G.description,children:(0,n.jsx)(G.override,{value:N.value,onChange:Y=>{A(Y)},item:G,context:M,id:H})})}),(0,n.jsx)("div",{className:(0,a.cx)(_&&K.collapsibleOverrideEditor,!_&&"dynamicConfigValueEditor--nonCollapsible"),children:J})},D=N=>({collapsibleOverrideEditor:(0,a.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:N.spacing(1)}})});var C=e(25797),P=e(51156),T=e(45861),O=e(30703);const I=({isExpanded:N,registry:M,matcherUi:L,overrideName:A,override:U,onOverrideRemove:F})=>{const V=(0,m.of)(j),G=U.properties.map(_=>M.getIfExists(_.id)).filter(_=>!!_).map(_=>_?.name).join(", "),H=L.optionsToLabel(U.matcher.options);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(y.Gy,{justify:"space-between",children:[(0,n.jsx)("div",{children:A}),(0,n.jsx)(T.$n,{variant:"secondary",fill:"text",icon:"trash-alt",onClick:F,tooltip:(0,d.t)("dashboard.override-category-title.tooltip-remove-override","Remove override"),"aria-label":(0,d.t)("dashboard.override-category-title.aria-label-remove-override","Remove override")})]}),!N&&(0,n.jsx)("div",{className:V.overrideDetails,children:(0,n.jsxs)("div",{className:V.options,title:H,children:[H," ",(0,n.jsx)(O.I,{name:"angle-right"})," ",G]})})]})};I.displayName="OverrideTitle";const j=N=>({matcherUi:(0,a.css)({padding:N.spacing(1)}),propertyPickerWrapper:(0,a.css)({marginTop:N.spacing(2)}),overrideDetails:(0,a.css)({fontSize:N.typography.bodySmall.fontSize,color:N.colors.text.secondary,fontWeight:N.typography.fontWeightRegular}),options:(0,a.css)({overflow:"hidden",paddingRight:N.spacing(4)}),unknownLabel:(0,a.css)({marginBottom:0})});function W(N,M,L,A,U){const F=[],V=N;if(!M||M.isEmpty())return[];const K=(k,J)=>{let z=(0,s.cloneDeep)(V.overrides);z[k]=J,U({...V,overrides:z})},G=k=>{let J=(0,s.cloneDeep)(V.overrides);J.splice(k,1),U({...V,overrides:J})},H=k=>{const J=l.sJ.get(k.value);J&&U({...V,overrides:[...V.overrides,{matcher:{id:J.id,options:J.defaultOptions},properties:[]}]})},_={data:L,getSuggestions:k=>(0,p.Hf)(L,k),isOverride:!0};for(let k=0;k<V.overrides.length;k++){const J=V.overrides[k],z=(0,d.t)("dashboard.get-field-override-categories.override-name","Override {{overrideNum}}",{overrideNum:k+1}),Y=i.g.get(J.matcher.id),X=B(M),Q=(0,o.Ow)(J),q=J.properties.length===0,te=new C.C({title:z,id:z,forceOpen:q,renderTitle:function(de){return(0,n.jsx)(I,{override:J,isExpanded:de,registry:M,overrideName:z,matcherUi:Y,onOverrideRemove:()=>G(k)})}}),ne=ue=>{K(k,{...J,matcher:{...J.matcher,options:ue}})},se=(ue,de)=>{const ie=M.get(de.value),he={id:ie.id,value:ie.defaultValue},me=ue.properties??[];me.push(he),K(k,{...ue,properties:me})};te.addItem(new P.v({title:Y.name,render:function(){return(0,n.jsx)(Y.component,{id:`${Y.matcher.id}-${k}`,matcher:Y.matcher,data:L??[],options:J.matcher.options,onChange:ne})}}));for(let ue=0;ue<J.properties.length;ue++){const de=J.properties[ue],ie=M.getIfExists(de.id);if(!ie)continue;const he=ce=>{K(k,{...J,properties:J.properties.map((Pe,Ie)=>Ie===ue?{...Pe,value:ce}:Pe)})},me=()=>{K(k,{...J,properties:J.properties.filter((ce,Pe)=>Pe!==ue)})};te.addItem(new P.v({title:ie.name,skipField:!0,render:function(){return(0,n.jsx)(E,{isSystemOverride:Q,onChange:he,onRemove:me,property:de,registry:M,context:_,searchQuery:A},`${de.id}/${ue}`)}}))}!Q&&J.matcher.options&&te.addItem(new P.v({title:"----------",skipField:!0,render:function(){return(0,n.jsx)(c.i,{label:(0,d.t)("dashboard.get-field-override-categories.label-add-override-property","Add override property"),variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:X,onChange:de=>se(J,de)},"Add override property")}})),F.push(te)}return F.push(new C.C({title:(0,d.t)("dashboard.get-field-override-categories.title.add-button","add button"),id:"add button",customRender:function(){return(0,n.jsx)(S,{children:(0,n.jsx)(c.i,{icon:"plus",label:(0,d.t)("dashboard.get-field-override-categories.label-add-field-override","Add field override"),variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:i.g.list().filter(J=>!J.excludeFromPicker).map(J=>({label:J.name,value:J.id,description:J.description})),onChange:J=>H(J)})},"Add override")}})),F}function B(N){return N.list().filter(M=>!M.hideFromOverrides).map(M=>{let L=M.name;return M.category&&(L=[...M.category,M.name].join(" > ")),{label:L,value:M.id,description:M.description}})}function S({children:N}){const M=(0,m.of)(w);return(0,n.jsx)("div",{className:M,children:N})}function w(N){return(0,a.css)({borderTop:`1px solid ${N.colors.border.weak}`,padding:`${N.spacing(2)}`,display:"flex"})}},56424:(Z,R,e)=>{"use strict";e.d(R,{g5:()=>C,tN:()=>E,Zm:()=>b,Z4:()=>D});var n=e(74848),a=e(2543),s=e(52205),l=e(92745),o=e(63527),d=e(22803),i=e(80011),c=e(63142);const m=({libraryPanel:P})=>{const T=(0,c.of)(p),O=P.useState(),I=O.$timeRange?.getTimeZone(),j=O._loadedPanel?.meta;return j?(0,n.jsxs)("div",{className:T.info,children:[(0,n.jsx)("div",{className:T.libraryPanelInfo,children:(0,n.jsxs)(l.x6,{i18nKey:"dashboard-scene.library-viz-panel-info.usage-count",count:j.connectedDashboards,children:["Used on ","{{count}}"," dashboards"]})}),(0,n.jsx)("div",{className:T.libraryPanelInfo,children:(0,n.jsxs)(l.x6,{i18nKey:"dashboard-scene.library-viz-panel-info.last-edited",values:{timeAgo:(0,i.LE)(j.updated,{format:"L",timeZone:I})},components:{person:(0,n.jsxs)(n.Fragment,{children:[j.updatedBy.avatarUrl&&(0,n.jsx)("img",{className:T.userAvatar,src:j.updatedBy.avatarUrl,alt:`Avatar for ${j.updatedBy.name}`}),j.updatedBy.name]})},children:["{{timeAgo}}"," by","<person />"]})})]}):null},p=P=>({info:(0,d.css)({lineHeight:1}),libraryPanelInfo:(0,d.css)({color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize}),userAvatar:(0,d.css)({borderRadius:P.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})});var h=e(82345),r=e(25797),g=e(51156);const y="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",v="An override rule exists for this property";function x(P,T,O){const I=[];if(O){for(const W of O)for(const B of W.fields)if((0,a.get)(B.config,P.path)!=null){I.push({type:"data",description:y,tooltip:y});break}}return T.overrides.some(W=>W.properties.some(B=>B.id===P.id))&&I.push({type:"rule",description:v,tooltip:v}),I}var f=e(61215);function u({data:P,replaceVariables:T,options:O,eventBus:I,instanceState:j}){const W=P?.series??[];return{data:W,replaceVariables:T,options:O,eventBus:I,getSuggestions:S=>(0,h.Hf)(W,S),instanceState:j,annotations:P?.annotations}}function b(P){const{plugin:T,panel:O,onPanelOptionsChanged:I,onFieldConfigsChange:j,data:W,dashboard:B,instanceState:S}=P,w=O.getOptions(),N=O.fieldConfig,M={},L=u({data:W,replaceVariables:O.replaceVariables,options:w,eventBus:B.events,instanceState:S}),A=F=>{const V=(F&&F[0])??`${T.meta.name}`,K=M[V];return K||(M[V]=new r.C({title:V,id:V,sandboxId:T.meta.id}))},U={getValue:F=>(0,a.get)(w,F),onChange:(F,V)=>{const K=(0,f.Sf)(w,F,V);I(K)}};C(T.getPanelOptionsSupplier(),U,A,L);for(const F of T.fieldConfigRegistry.list()){if(F.isCustom){if(F.showIf&&!F.showIf(N.defaults.custom,W?.series,W?.annotations))continue}else if(F.showIf&&!F.showIf(N.defaults,W?.series,W?.annotations))continue;if(F.hideFromDefaults)continue;const V=A(F.category),K=F.editor,G=N.defaults,H=F.isCustom?G.custom?(0,a.get)(G.custom,F.path):void 0:(0,a.get)(G,F.path);F.getItemsCount&&(V.props.itemsCount=F.getItemsCount(H)),V.addItem(new g.v({title:F.name,description:F.description,overrides:x(F,N,W?.series),render:function(){const k=J=>{j((0,f.EQ)(N,F.path,J,F.isCustom))};return(0,n.jsx)(K,{value:H,onChange:k,item:F,context:L,id:F.id})}}))}return Object.values(M)}function E(P){const T=new r.C({title:(0,l.t)("dashboard.get-library-viz-panel-options-category.descriptor.title.library-panel-options","Library panel options"),id:"Library panel options",isOpenDefault:!0});return T.addItem(new g.v({title:(0,l.t)("dashboard.get-library-viz-panel-options-category.title.name","Name"),value:P,popularRank:1,render:function(){return(0,n.jsx)(o.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:P.state.name,onBlur:I=>P.setState({name:I.currentTarget.value})})}})).addItem(new g.v({title:(0,l.t)("dashboard.get-library-viz-panel-options-category.title.information","Information"),render:function(){return(0,n.jsx)(m,{libraryPanel:P})}})),T}function D(P){const{plugin:T,panel:O,data:I,eventBus:j,instanceState:W}=P,B={},S=A=>{const U=A?.[0]??T.meta.name,F=B[U];return F||(B[U]=new r.C({title:U,id:U,sandboxId:T.meta.id}))},w=O.state.options,N={getValue:A=>(0,a.get)(w,A),onChange:(A,U)=>{const F=(0,f.Sf)(w,A,U);O.onOptionsChange(F)}},M=u({data:I,replaceVariables:O.interpolate,options:w,eventBus:j,instanceState:W});C(T.getPanelOptionsSupplier(),N,S,M);const L=O.state.fieldConfig;for(const A of T.fieldConfigRegistry.list()){const U=A.showIf&&(A.isCustom?!A.showIf(L.defaults.custom,I?.series,I?.annotations):!A.showIf(L.defaults,I?.series,I?.annotations));if(A.hideFromDefaults||U)continue;const F=S(A.category),V=A.editor,K=L.defaults,G=A.isCustom?K.custom?(0,a.get)(K.custom,A.path):void 0:(0,a.get)(K,A.path);A.getItemsCount&&(F.props.itemsCount=A.getItemsCount(G)),F.addItem(new g.v({title:A.name,description:A.description,overrides:x(A,L,I?.series),render:function(){const _=k=>{O.onFieldConfigChange((0,f.EQ)(L,A.path,k,A.isCustom),!0)};return(0,n.jsx)(V,{value:G,onChange:_,item:A,context:M,id:A.id})}}))}return Object.values(B)}function C(P,T,O,I,j){const W=new s.pv;P(W,I);for(const B of W.getItems()){if(B.showIf&&!B.showIf(I.options,I.data,I.annotations))continue;let S=j;if(S?B.category?.[0]?.length&&(S=S.getCategory(B.category[0])):S=O(B.category),(0,s.iF)(B)){const N=B.getNestedValueAccess(T),M=N.getContext?N.getContext(I):{...I,options:T.getValue(B.path)};C(B.getBuilder(),N,O,M,S);continue}const w=B.editor;S.addItem(new g.v({title:B.name,description:B.description,render:function(){return(0,n.jsx)(w,{value:T.getValue(B.path),onChange:M=>{T.onChange(B.path,M)},item:B,context:I,id:B.id})}}))}}},42795:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>b,GU:()=>h,MJ:()=>g,Ox:()=>y,eK:()=>x,fR:()=>v,kw:()=>f,wi:()=>i});var n=e(65307),a=e(28105),s=e(22592),l=e(29043),o=e(82612),d=e(62667);const i="grafana.dashboard.editor.ui",c={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:d.q5.Fill},m=()=>{const E=l.A.getObject(i,c);let D={...E};return typeof E.topPaneSize=="string"&&(D={...E,topPaneSize:parseFloat(E.topPaneSize)/100}),{getPanel:()=>new o.a9({}),getSourcePanel:()=>new o.a9({}),getData:()=>({state:a.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...c,...D}}},p=(0,n.Z0)({name:"panelEditor",initialState:m(),reducers:{updateEditorInitState:(E,D)=>{E.getPanel=()=>D.payload.panel,E.getSourcePanel=()=>D.payload.sourcePanel,E.initDone=!0,E.isOpen=!0,E.shouldDiscardChanges=!1},setEditorPanelData:(E,D)=>{E.getData=()=>D.payload},setDiscardChanges:(E,D)=>{E.shouldDiscardChanges=D.payload},setPanelEditorUIState:(E,D)=>{E.ui={...E.ui,...D.payload},!E.ui.isPanelOptionsVisible&&E.isVizPickerOpen&&(E.isVizPickerOpen=!1)},toggleVizPicker:(E,D)=>{E.isVizPickerOpen=D.payload,E.isVizPickerOpen&&(E.ui.isPanelOptionsVisible=!0)},toggleTableView(E){E.tableViewEnabled=!E.tableViewEnabled},closeEditor:E=>{E.getPanel=()=>new o.a9({}),E.getSourcePanel=()=>new o.a9({}),E.isOpen=!1,E.initDone=!1,E.isVizPickerOpen=!1,E.tableViewEnabled=!1}}}),{updateEditorInitState:h,setEditorPanelData:r,setDiscardChanges:g,closeEditor:y,setPanelEditorUIState:v,toggleVizPicker:x,toggleTableView:f}=p.actions,b={panelEditor:p.reducer}},62667:(Z,R,e)=>{"use strict";e.d(R,{M8:()=>n,Nt:()=>l,__:()=>d,q5:()=>a});var n=(i=>(i.Query="query",i.Transform="transform",i.Visualize="visualize",i.Alert="alert",i))(n||{}),a=(i=>(i[i.Fill=0]="Fill",i[i.Fit=1]="Fit",i[i.Exact=2]="Exact",i))(a||{}),s=(i=>(i[i.Off=0]="Off",i[i.Table=1]="Table",i))(s||{});const l=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],o=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var d=(i=>(i[i.Visualizations=0]="Visualizations",i[i.LibraryPanels=1]="LibraryPanels",i[i.Suggestions=2]="Suggestions",i))(d||{})},61215:(Z,R,e)=>{"use strict";e.d(R,{$:()=>d,A:()=>o,EQ:()=>i,Sf:()=>c});var n=e(2543),a=e.n(n),s=e(95943),l=e(62667);function o(m,p,h,r){if(m===l.q5.Fill)return{width:p,height:h};const g=8*6,x=(window.innerWidth-60-s.dU*4)/s.cV*r.gridPos.w,f=s.sD*r.gridPos.h+g,u=Math.min(p/x,h/f);return x<=p&&f<=h?{width:x,height:f}:{width:x*u,height:f*u}}function d(m){return m?.meta.skipDataQuery===!1}const i=(m,p,h,r)=>{let g={...m.defaults};const y=h==null||h==="";return r?g.custom?y?g.custom=(0,n.omit)(g.custom,p):g.custom=c(g.custom,p,h):y||(g.custom=c(g.custom,p,h)):y?g=(0,n.omit)(g,p):g=c(g,p,h),{...m,defaults:g}};function c(m,p,h){const r=Array.isArray(p)?p:p.split("."),g=r.shift();if(g.endsWith("]")){const v=g.lastIndexOf("["),x=+g.substring(v+1,g.length-1),f=g.substring(0,v);let u=m[f];const b=Array.isArray(u)?[...u]:[];return r.length&&(u=b[x],(u==null||typeof u!="object")&&(u={}),h=c(u,r,h)),b[x]=h,{...m,[f]:b}}if(!r.length)return{...m,[g]:h};let y=m[g];return(y==null||typeof y!="object")&&(y={}),{...m,[g]:c(y,r,h)}}},45004:(Z,R,e)=>{"use strict";e.d(R,{P:()=>h,Q:()=>r});var n=e(74848),a=e(22803),s=e(63142),l=e(12326),o=e(71542);const d="https://grafana.com/?src=grafananet&cnt=public-dashboards",i=o,c=l,m="grafana-logo",p=y=>{const v=(0,s.$j)(),x=(0,s.of)(g),{footerHide:f,footerText:u,footerLink:b,footerLogo:E,headerLogoHide:D}=y||{footerHide:!1,footerText:"Powered by",footerLogo:m,footerLink:d,headerLogoHide:!1};return{footerHide:f,footerText:(0,n.jsx)("span",{className:x.text,children:u}),footerLogo:E===m?v.isDark?i:c:E,footerLink:b,headerLogoHide:D}};let h=()=>p();function r(y){h=()=>p(y)}const g=y=>({text:(0,a.css)({color:y.colors.text.secondary,fontSize:y.typography.body.fontSize})})},31819:(Z,R,e)=>{"use strict";e.d(R,{G:()=>m,U:()=>p});var n=e(74848),a=e(96540),s=e(92745),l=e(36674),o=e(18857),d=e(43243),i=e(52763),c=e(93612);const m=({repeat:h,onChange:r,id:g})=>{const y=(0,i.d4)(f=>(0,c.SS)((0,c.y7)(f),f)),v=(0,a.useMemo)(()=>{const f=y.map(u=>({label:u.name,value:u.name}));return f.length===0&&f.unshift({label:(0,s.t)("dashboard.repeat-row-select.variable-options.label.no-template-variables-found","No template variables found"),value:null}),f.unshift({label:(0,s.t)("dashboard.repeat-row-select.variable-options.label.disable-repeating","Disable repeating"),value:null}),f},[y]),x=(0,a.useCallback)(f=>r(f.value),[r]);return(0,n.jsx)(o.l6,{inputId:g,value:h,onChange:x,options:v})},p=({sceneContext:h,repeat:r,id:g,onChange:y})=>{const x=(0,a.useMemo)(()=>l.jh.getVariables(h.getRoot()),[h]).useState().variables,f=(0,a.useMemo)(()=>{const E=x.map(D=>({label:D.state.name,value:D.state.name}));return E.unshift({label:(0,s.t)("dashboard.repeat-row-select2.variable-options.label.disable-repeating","Disable repeating"),value:""}),E},[x]),u=(0,a.useCallback)(E=>E&&y(E.value),[y]),b=!r&&f.length<=1;return(0,n.jsx)(d.G,{id:g,value:r,onChange:u,options:f,disabled:b,placeholder:b?(0,s.t)("dashboard.repeat-row-select2.variable-options.label.no-template-variables-found","No template variables found"):(0,s.t)("dashboard.repeat-row-select2.placeholder","Choose")})}},78159:(Z,R,e)=>{"use strict";e.d(R,{C:()=>c,m:()=>m});var n=e(74848),a=e(51898),s=e(92745),l=e(27489),o=e(8515),d=e(45861),i=e(37010);const c=({dashboard:p,onSaveSuccess:h,size:r})=>(0,n.jsx)(o.$s,{children:({showModal:g,hideModal:y})=>(0,n.jsx)(d.$n,{size:r,onClick:()=>{g(i.$,{dashboard:p,onSaveSuccess:h,onDismiss:y})},"aria-label":a.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-button.save-dashboard",children:"Save dashboard"})})}),m=({dashboard:p,onClick:h,onSaveSuccess:r,variant:g,size:y})=>(0,n.jsx)(o.$s,{children:({showModal:v,hideModal:x})=>(0,n.jsx)(d.$n,{size:y,onClick:()=>{(0,l.rR)("grafana_dashboard_save_as_clicked"),h?.(),v(i.$,{dashboard:p,onSaveSuccess:r,onDismiss:x,isCopy:!0})},variant:g,"aria-label":a.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-button.save-as",children:"Save as"})})})},30906:(Z,R,e)=>{"use strict";e.d(R,{l:()=>p});var n=e(74848),a=e(16817),s=e(92745),l=e(41654),o=e(31286),d=e(34999),i=e(68079),c=e(34753),m=e(1199);const p=({diff:h,oldValue:r,newValue:g,hasFolderChanges:y,oldFolder:v,newFolder:x,hasMigratedToV2:f})=>{const u=(0,a.A)(async()=>{const E=JSON.stringify(r??{},null,2),D=JSON.stringify(g??{},null,2);let C;const P=[];let T=0;if(h)for(const[O,I]of Object.entries(h)){const j=(0,n.jsx)(c.D,{diffs:I,title:O},O);O==="schemaVersion"?C=j:P.push(j),T+=I.length}return{schemaChange:C,diffs:P,count:T,showDiffs:T<15,jsonView:(0,n.jsx)(m.M,{oldValue:E,newValue:D})}},[h,r,g]),{value:b}=u;return(0,n.jsxs)(l.B,{direction:"column",gap:1,children:[f&&(0,n.jsx)(o.a,{paddingTop:1,children:(0,n.jsx)(d.F,{title:(0,s.t)("dashboard.save-dashboard-diff.title-because-dashboard-migrated-grafana-format","The diff is hard to read because the dashboard has been migrated to the new Grafana dashboard format"),severity:"info"})}),y&&(0,n.jsx)(c.D,{diffs:[{op:"replace",value:x,originalValue:v,path:[],startLineNumber:0,endLineNumber:0}],title:(0,s.t)("dashboard.save-dashboard-diff.title-folder","folder")},"folder"),(!b||!r)&&(0,n.jsx)(i.y,{}),b&&b.count>=1?(0,n.jsxs)(n.Fragment,{children:[!f&&b&&b.schemaChange&&b.schemaChange,b&&b.showDiffs&&b.diffs,(0,n.jsxs)(o.a,{paddingTop:1,children:[(0,n.jsx)("h4",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-diff.full-json-diff",children:"Full JSON diff"})}),b.jsonView]})]}):(0,n.jsx)(o.a,{paddingTop:1,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-diff.no-changes-in-the-dashboard-json",children:"No changes in the dashboard JSON"})})]})}},37010:(Z,R,e)=>{"use strict";e.d(R,{$:()=>Be});var n=e(74848),a=e(96540),s=e(92745),l=e(68143),o=e(43173),d=e(8207),i=e(54314),c=e(60208),m=e(61371),p=e(22803),h=e(16817),r=e(63142),g=e(34999),y=e(83873);function v({dashboard:We}){const _e=(0,r.of)(x),{loading:Xe,value:le,error:ye}=(0,h.A)(async()=>{const ve=We.getSaveModelCloneOld();return y.IB.validateDashboard(ve).catch(Oe=>{if(Oe.status>=500)throw Oe;return Oe.data})},[We]);let pe;if(Xe)pe=(0,n.jsx)(g.F,{severity:"info",title:(0,s.t)("dashboard.dashboard-validation.title-checking-dashboard-validity","Checking dashboard validity")});else if(le)le.isValid||(pe=(0,n.jsxs)(g.F,{severity:"warning",title:(0,s.t)("dashboard.dashboard-validation.title-dashboard-failed-schema-validation","Dashboard failed schema validation"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.dashboard-validation.body-dashboard-failed-schema-validation",children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"})}),(0,n.jsx)("div",{className:_e.error,children:le.message})]}));else{const ve=ye?.message??"Unknown error";pe=(0,n.jsx)(g.F,{severity:"info",title:(0,s.t)("dashboard.dashboard-validation.title-error-checking-dashboard-validity","Error checking dashboard validity"),children:(0,n.jsx)("p",{className:_e.error,children:ve})})}return pe?(0,n.jsx)("div",{className:_e.root,children:pe}):null}const x=We=>({root:(0,p.css)({marginTop:We.spacing(1)}),error:(0,p.css)({fontFamily:We.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),f=v;var u=e(30906),b=e(71599),E=e(22787),D=e(45861),C=e(78159),P=e(2543),T=e(41053),O=e(92138),I=e(27489),j=e(36490),W=e(45229),B=e(64762),S=e(38206),w=e(18346),N=e(87745),M=e(52763),L=e(77731);const A=async(We,_e,Xe,le)=>{const ye=await le({dashboard:We,folderUid:_e.folderUid??Xe.meta.folderUid??We.meta?.folderUid,message:_e.message,overwrite:_e.overwrite,k8s:Xe.meta.k8s});if("error"in ye)throw ye.error;return ye.data},U=(We=!1)=>{const _e=(0,M.wA)(),Xe=(0,B._2)(),[le]=(0,w.e8)(),[ye,pe]=(0,T.A)(async(ve,be,Oe)=>{try{const we=await A(ve,be,Oe,le);Oe.version=we.version,ve=(0,P.cloneDeep)(ve),ve.version=we.version,Oe.clearUnsavedChanges(ve,be),W.A.publish(new N.Eu),Xe.success((0,s.t)("dashboard.save-dashboard.message-dashboard-saved","Dashboard saved")),(0,L.ko)(we.uid),We?(0,I.rR)("grafana_dashboard_copied",{name:Oe.title,url:we.url}):(0,I.rR)(`grafana_dashboard_${Oe.id?"saved":"created"}`,{name:Oe.title,url:we.url});const ze=j.Ny.getLocation().pathname,Ve=O.I.stripBaseFromUrl(we.url);return Ve!==ze&&we.url&&setTimeout(()=>j.Ny.replace(Ve)),Oe.meta.isStarred&&_e((0,S.TU)({id:Oe.uid,title:Oe.title,url:Ve})),we}catch(we){throw we instanceof Error&&Xe.error(we.message??"Error saving dashboard"),we}},[_e,Xe]);return{state:ye,onDashboardSave:pe}},F=({dashboard:We,dashboardSaveModel:_e,error:Xe,onDismiss:le,setErrorIsHandled:ye})=>{const{onDashboardSave:pe}=U(),ve=o.$.featureToggles.restoreDashboards;return(0,n.jsxs)(n.Fragment,{children:[Xe.data&&Xe.data.status==="version-mismatch"&&(0,n.jsx)(b.u,{isOpen:!0,title:(0,s.t)("dashboard.save-dashboard-error-proxy.title-version-mismatch","Conflict"),body:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-dashboard-error-proxy.body-version-mismatch",children:["Someone else has updated this dashboard",(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]})}),confirmText:(0,s.t)("dashboard.save-dashboard-error-proxy.confirmText-save-and-overwrite","Save and overwrite"),onConfirm:async()=>{await pe(_e,{overwrite:!0},We),le()},onDismiss:le}),Xe.data&&Xe.data.status==="name-exists"&&(0,n.jsx)(n.Fragment,{children:ve?(0,n.jsxs)(E.a,{isOpen:!0,title:(0,s.t)("save-dashboards.name-exists.title","Dashboard name already exists"),onDismiss:le,children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,n.jsx)(b.u,{isOpen:!0,title:(0,s.t)("dashboard.save-dashboard-error-proxy.title-name-exists","Conflict"),body:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-dashboard-error-proxy.body-name-exists",children:["A dashboard with the same name in selected folder already exists.",(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]})}),confirmText:(0,s.t)("dashboard.save-dashboard-error-proxy.confirmText-save-and-overwrite","Save and overwrite"),onConfirm:async()=>{await pe(_e,{overwrite:!0},We),le()},onDismiss:le})}),Xe.data&&Xe.data.status==="plugin-dashboard"&&(0,n.jsx)(V,{dashboard:We,onDismiss:()=>{ye(!0),le()}})]})},V=({onDismiss:We,dashboard:_e})=>{const{onDashboardSave:Xe}=U(),le=(0,r.of)(G);return(0,n.jsxs)(E.a,{className:le.modal,title:(0,s.t)("dashboard.confirm-plugin-dashboard-save-modal.title-plugin-dashboard","Plugin dashboard"),icon:"copy",isOpen:!0,onDismiss:We,children:[(0,n.jsx)("div",{className:le.modalText,children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin.",(0,n.jsx)("br",{}),(0,n.jsxs)("small",{children:["Use ",(0,n.jsx)("strong",{children:"Save As"})," to create custom version."]})]})}),(0,n.jsxs)(E.a.ButtonRow,{children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:We,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.cancel",children:"Cancel"})}),(0,n.jsx)(C.m,{onClick:We,dashboard:_e,onSaveSuccess:We}),(0,n.jsx)(D.$n,{variant:"destructive",onClick:async()=>{await Xe(_e.getSaveModelClone(),{overwrite:!0},_e),We()},children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.overwrite",children:"Overwrite"})})]})]})},K=We=>{switch(We){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},G=We=>({modal:(0,p.css)({width:"500px"}),modalText:(0,p.css)({fontSize:We.typography.h4.fontSize,color:We.colors.text.primary,marginBottom:We.spacing(4),paddingTop:We.spacing(2)}),modalButtonRow:(0,p.css)({marginBottom:"14px","a, button":{marginRight:We.spacing(2)}})});var H=e(50426),_=e(26987),k=e(37386),J=e(41654),z=e(72636),Y=e(63527),X=e(87105),Q=e(21285),q=e(91156),te=e(89223),ne=e(42357),se=e(70969);const ue=We=>{const _e=We.getSaveModelClone();return _e.id=null,_e.uid="",_e.title+=" Copy",_e.editable=!0,We.id>0&&_e.panels&&_e.panels.forEach(Xe=>{Xe.type==="graph"&&Xe.alert&&delete Xe.thresholds,delete Xe.alert}),_e},de=({dashboard:We,isLoading:_e,isNew:Xe,onSubmit:le,onCancel:ye,onSuccess:pe})=>{const ve={title:Xe?We.title:`${We.title} Copy`,description:We.description,$folder:{uid:We.meta.folderUid,title:We.meta.folderTitle},copyTags:!1},be=Oe=>async we=>{if(we&&we===Oe().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await te.P.validateNewDashboardName(Oe().$folder.uid??"general",we),!0}catch(ze){return ze instanceof Error?ze.message:"Dashboard name is invalid"}};return(0,n.jsx)(H.l,{defaultValues:ve,onSubmit:async Oe=>{if(!le)return;const we=ue(We);we.title=Oe.title,we.description=Oe.description,!Xe&&!Oe.copyTags&&(we.tags=[]),(await le(we,{folderUid:Oe.$folder.uid},We)).status==="success"&&pe()},children:({register:Oe,control:we,errors:ze,getValues:Ve})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_.e,{render:({field:{ref:ge,...Ke}})=>(0,n.jsx)(k.D,{label:(0,n.jsxs)(J.B,{justifyContent:"space-between",children:[(0,n.jsx)(z.J,{htmlFor:"title",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.title",children:"Title"})}),o.$.featureToggles.dashgpt&&Xe&&(0,n.jsx)(se.Z,{onGenerate:qe=>Ke.onChange(qe)})]}),invalid:!!ze.title,error:ze.title?.message,children:(0,n.jsx)(Y.p,{...Ke,onChange:qe=>Ke.onChange(qe.target.value),"aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-title-field","Save dashboard title field"),autoFocus:!0})}),control:we,name:"title",rules:{validate:be(Ve)}}),(0,n.jsx)(_.e,{render:({field:{ref:ge,...Ke}})=>(0,n.jsx)(k.D,{label:(0,n.jsxs)(J.B,{justifyContent:"space-between",children:[(0,n.jsx)(z.J,{htmlFor:"description",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.description",children:"Description"})}),o.$.featureToggles.dashgpt&&Xe&&(0,n.jsx)(ne.V,{onGenerate:qe=>Ke.onChange(qe)})]}),invalid:!!ze.description,error:ze.description?.message,children:(0,n.jsx)(X.f,{...Ke,onChange:qe=>Ke.onChange(qe.target.value),"aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-description-field","Save dashboard description field"),autoFocus:!0})}),control:we,name:"description"}),(0,n.jsx)(k.D,{label:(0,s.t)("dashboard.save-dashboard-as-form.label-folder","Folder"),children:(0,n.jsx)(_.e,{render:({field:{ref:ge,...Ke}})=>(0,n.jsx)(q.d,{...Ke,onChange:(qe,ot)=>Ke.onChange({uid:qe,title:ot}),value:Ke.value?.uid}),control:we,name:"$folder"})}),!Xe&&(0,n.jsx)(k.D,{label:(0,s.t)("dashboard.save-dashboard-as-form.label-copy-tags","Copy tags"),children:(0,n.jsx)(Q.d,{...Oe("copyTags")})}),(0,n.jsxs)(J.B,{children:[(0,n.jsx)(D.$n,{type:"button",variant:"secondary",onClick:ye,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.cancel",children:"Cancel"})}),(0,n.jsx)(D.$n,{disabled:_e,type:"submit","aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-button","Save dashboard button"),children:_e?(0,s.t)("dashboard.save-dashboard-as-form.saving","Saving..."):(0,s.t)("dashboard.save-dashboard-as-form.save","Save")})]})]})})};var ie=e(51898),he=e(32635),me=e(87056),ce=e(16200),Pe=e(37680),Ie=e(66769);const Se=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),Me=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),Te=({dashboard:We,onGenerate:_e,disabled:Xe})=>{const le=(0,a.useCallback)(()=>Ge(We),[We]);return(0,n.jsx)(ce.n,{messages:le,onGenerate:_e,temperature:0,model:me.Kx.BASE,eventTrackingSrc:Pe.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:Xe})};function Ge(We){let{userChanges:_e,migrationChanges:Xe}=(0,Ie.Yy)(We);return _e.length>8e3&&(_e="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),Xe.split(`
`).length<10?Xe="No significant migration changes":Xe.length>8e3&&(Xe="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:Se,role:Ie.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${_e}`,role:Ie.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:Ie.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${Xe}`,role:Ie.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:Ie.Xh.system},{content:Me,role:Ie.Xh.system}]}const Qe=({dashboard:We,isLoading:_e,saveModel:Xe,options:le,onSubmit:ye,onCancel:pe,onSuccess:ve,onOptionsChange:be})=>{const Oe=(0,a.useMemo)(()=>We.hasTimeChanged(),[We]),we=(0,a.useMemo)(()=>We.hasVariablesChanged(),[We]),[ze,Ve]=(0,a.useState)(!1),[ge,Ke]=(0,a.useState)(le.message),qe=(0,r.of)(tt);return(0,n.jsx)("form",{onSubmit:async ot=>{if(ot.preventDefault(),!ye)return;Ve(!0),le={...le,message:ge},(await ye(Xe.clone,le,We)).status==="success"?ve():Ve(!1)},style:{maxWidth:600},children:(0,n.jsxs)(J.B,{gap:2,direction:"column",alignItems:"flex-start",children:[Oe&&(0,n.jsx)(he.S,{checked:!!le.saveTimerange,onChange:()=>be({...le,saveTimerange:!le.saveTimerange}),label:(0,s.t)("dashboard.save-dashboard-form.label-current-range-dashboard-default","Save current time range as dashboard default"),"aria-label":ie.Tp.pages.SaveDashboardModal.saveTimerange}),we&&(0,n.jsx)(he.S,{checked:!!le.saveVariables,onChange:()=>be({...le,saveVariables:!le.saveVariables}),label:(0,s.t)("dashboard.save-dashboard-form.label-current-variable-values-dashboard-default","Save current variable values as dashboard default"),"aria-label":ie.Tp.pages.SaveDashboardModal.saveVariables}),(0,n.jsxs)("div",{className:qe.message,children:[o.$.featureToggles.aiGeneratedDashboardChanges&&(0,n.jsx)(Te,{dashboard:We,onGenerate:ot=>{be({...le,message:ot}),Ke(ot)},disabled:!Xe.hasChanges}),(0,n.jsx)(X.f,{value:ge,onChange:ot=>{be({...le,message:ot.currentTarget.value}),Ke(ot.currentTarget.value)},placeholder:(0,s.t)("dashboard.save-dashboard-form.placeholder-describe-changes","Add a note to describe your changes."),autoFocus:!0,rows:5})]}),(0,n.jsxs)(J.B,{alignItems:"center",children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:pe,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(D.$n,{type:"submit",disabled:!Xe.hasChanges||_e,icon:ze?"spinner":void 0,"aria-label":ie.Tp.pages.SaveDashboardModal.save,children:_e?(0,s.t)("dashboard.save-dashboard-form.saving","Saving..."):(0,s.t)("dashboard.save-dashboard-form.save","Save")}),!Xe.hasChanges&&(0,n.jsx)("div",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-form.no-changes-to-save",children:"No changes to save"})})]})]})})};function tt(We){return{message:(0,p.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var ke=e(4213),He=e(89640),Re=e(32881),Ne=e(47931);const Ae=({dashboard:We,onCancel:_e})=>{const[Xe,le]=(0,a.useState)(()=>{const pe=We.getSaveModelClone();return delete pe.id,JSON.stringify(pe,null,2)}),ye=(0,a.useCallback)(()=>{const pe=new Blob([Xe],{type:"application/json;charset=utf-8"});(0,ke.saveAs)(pe,We.title+"-"+new Date().getTime()+".json")},[We.title,Xe]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(J.B,{direction:"column",gap:2,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.cannot-be-saved",children:"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source."}),(0,n.jsx)("br",{}),(0,n.jsx)("i",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.see-docs",children:["See"," ",(0,n.jsx)(He.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,n.jsx)("br",{})," ",(0,n.jsx)("br",{}),(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.file-path",values:{filePath:We.meta.provisionedExternalId},children:[(0,n.jsx)("strong",{children:"File path:"})," ","{{filePath}}"]})]}),(0,n.jsx)(X.f,{spellCheck:!1,value:Xe,onChange:pe=>{le(pe.currentTarget.value)},className:Ue.json}),(0,n.jsxs)(Re.Gy,{children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:_e,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(Ne.b,{icon:"copy",getText:()=>Xe,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.copy-json-to-clipboard",children:"Copy JSON to clipboard"})}),(0,n.jsx)(D.$n,{type:"submit",onClick:ye,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.save-json-to-file",children:"Save JSON to file"})})]})]})})},Ue={json:(0,p.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Be=({dashboard:We,onDismiss:_e,onSaveSuccess:Xe,isCopy:le})=>{const[ye,pe]=(0,a.useState)({}),ve=We.getOriginalDashboard(),be=We.meta.provisioned,Oe=We.version===0,we=!!We.meta.hasUnsavedFolderChange,[ze,Ve]=(0,a.useState)(!1),ge=(0,a.useMemo)(()=>{const It=We.getSaveModelClone({saveTimerange:!!ye.saveTimerange,saveVariables:!!ye.saveVariables});if(!ve)return{clone:It,diff:{},diffCount:0,hasChanges:!1};const Mt=(0,m.G4)(ve,It);let Ut=0;for(const an of Object.values(Mt))Ut+=an.length;return{clone:It,diff:Mt,diffCount:Ut,hasChanges:(Ut>0||we)&&!Oe}},[We,ve,ye,Oe,we]),[Ke,qe]=(0,a.useState)(!1),{state:ot,onDashboardSave:lt}=U(le),mt=Xe?()=>{_e(),Xe()}:_e,Lt=()=>Ke?(0,n.jsx)(u.l,{diff:ge.diff,oldValue:ve,newValue:ge.clone}):Oe||le?(0,n.jsx)(de,{dashboard:We,isLoading:ot.loading,onCancel:_e,onSuccess:mt,onSubmit:lt,isNew:Oe}):be?(0,n.jsx)(Ae,{dashboard:We,onCancel:_e,onSuccess:mt}):(0,n.jsx)(Qe,{dashboard:We,isLoading:ot.loading,saveModel:ge,onCancel:_e,onSuccess:mt,onSubmit:lt,options:ye,onOptionsChange:pe});if(ot.error&&!ze&&(0,l.NF)(ot.error)&&K(ot.error.data.status))return(0,n.jsx)(F,{error:ot.error,dashboard:We,dashboardSaveModel:ge.clone,onDismiss:_e,setErrorIsHandled:Ve});let Tt=(0,s.t)("dashboard.save-dashboard-drawer.title","Save dashboard");return le?Tt=(0,s.t)("dashboard.save-dashboard-drawer.title-copy","Save dashboard copy"):be&&(Tt=(0,s.t)("dashboard.save-dashboard-drawer.title-provisioned","Provisioned dashboard")),(0,n.jsxs)(d._,{title:Tt,onClose:_e,subtitle:We.title,tabs:(0,n.jsxs)(i.U,{children:[(0,n.jsx)(c.o,{label:(0,s.t)("dashboard.save-dashboard-drawer.label-details","Details"),active:!Ke,onChangeTab:()=>qe(!1)}),ge.hasChanges&&(0,n.jsx)(c.o,{label:(0,s.t)("dashboard.save-dashboard-drawer.label-changes","Changes"),active:Ke,onChangeTab:()=>qe(!0),counter:ge.diffCount})]}),children:[Lt(),o.$.featureToggles.showDashboardValidationWarnings&&(0,n.jsx)(f,{dashboard:We})]})}},24209:(Z,R,e)=>{"use strict";e.d(R,{D:()=>x});var n=e(74848),a=e(96540),s=e(92745),l=e(43173),o=e(47931),d=e(37386),i=e(41654),c=e(21285),m=e(72636),p=e(87105),h=e(45861),r=e(22787),g=e(23289),y=e(29216),v=e(58662);function x({panel:f,dashboard:u,range:b,onCancelClick:E,buildIframe:D=v.CF}){const[C,P]=(0,a.useState)(!0),[T,O]=(0,a.useState)("current"),[I,j]=(0,a.useState)("");(0,a.useEffect)(()=>{const N=D(C,u.uid,T,f,b);j(N)},[T,C,u,f,b,D]);const W=N=>{j(N.currentTarget.value)},B=()=>{P(N=>!N)},S=N=>{O(N)},w=(0,n.jsx)(o.b,{icon:"copy",variant:"primary",getText:()=>I,onClipboardCopy:()=>{g.c.embedSnippetCopy({currentTimeRange:C,theme:T,shareResource:(0,v.hD)(f)})},children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel"})}),(0,n.jsx)(d.D,{children:(0,n.jsxs)(i.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(c.d,{label:(0,s.t)("share-modal.embed.time-range","Lock time range"),id:"share-current-time-range",value:C,onChange:B}),(0,n.jsx)(m.J,{description:(0,s.t)("embed.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,n.jsx)(s.x6,{i18nKey:"embed.share.time-range-label",children:"Lock time range"})})]})}),(0,n.jsx)(y.w,{selectedTheme:T,onChange:S}),(0,n.jsx)(d.D,{label:(0,s.t)("share-modal.embed.html","Embed HTML"),description:(0,s.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the users viewing that page need to be signed into Grafana for the graph to load."),children:(0,n.jsx)(p.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:I,onChange:W})}),l.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(i.B,{gap:1,justifyContent:"start",children:[w,(0,n.jsx)(h.$n,{variant:"secondary",fill:"outline",onClick:E,children:(0,n.jsx)(s.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})})]}):(0,n.jsx)(r.a.ButtonRow,{children:w})]})}},65241:(Z,R,e)=>{"use strict";e.d(R,{j:()=>i});var n=e(74848),a=e(96540),s=e(92745),l=e(27489),o=e(43652),d=e(58662);const i=({panel:c,initialFolderUid:m,onCreateLibraryPanel:p,onDismiss:h})=>((0,a.useEffect)(()=>{(0,l.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,d.hD)(c)})},[c]),c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,n.jsx)(o.b,{panel:c,initialFolderUid:m,onCreateLibraryPanel:p,onDismiss:h})]}):null)},23753:(Z,R,e)=>{"use strict";e.d(R,{Zy:()=>Ie,mJ:()=>ie});var n=e(74848),a=e(96540),s=e(92745),l=e(52792),o=e(22787),d=e(13941),i=e(63142),c=e(65642),m=e(73427),p=e(82298),h=e(24313),r=e(23289),g=e(75515),y=e(11257),v=e(24209),x=e(4213),f=e(37386),u=e(21285),b=e(45861),E=e(2543),D=e(7389),C=e(78282),P=e(30124),T=e(99305),O=e(97583),I=e(67933);function j(Se){return!!(Se.libraryPanel?.name&&Se.libraryPanel?.uid)}class W{async makeExportable(Me){Me.cleanUpRepeats();const Te=Me.getSaveModelCloneOld();Te.id=null,Me.processRepeats();const Ge=[],Qe={},tt={},ke={},He=new Map;for(const Ue of Te.getVariables())ke[Ue.name]=Ue;const Re=(Ue,Be)=>{if(Ue.datasource===void 0){Ue.datasource=Be;return}let We=Ue.datasource,_e=null;const Xe=We?.uid,le=Xe&&T.SY.exec(Xe);if(le){const ye=le[1]||le[2]||le[4];_e=ke[ye],_e&&_e.current&&(We=_e.current.value)}return(0,C.l)().get(We).then(ye=>{if(ye.meta?.builtIn||(Qe["datasource"+ye.meta?.id]={type:"datasource",id:ye.meta.id,name:ye.meta.name,version:ye.meta.info.version||"1.0.0"},_e))return;const pe=Ue.libraryPanel,ve=pe?"-for-library-panel":"";let be="DS_"+ye.name.replace(" ","_").toUpperCase()+ve.toUpperCase();if(tt[be]={name:be,label:ye.name,description:"",type:"datasource",pluginId:ye.meta?.id,pluginName:ye.meta?.name,usage:tt[be]?.usage},pe){const Oe=tt[be]?.usage?.libraryPanels||[];Oe.push({name:pe.name,uid:pe.uid}),tt[be].usage={libraryPanels:Oe}}Ue.datasource={type:ye.meta.id,uid:"${"+be+"}"}})},Ne=async Ue=>{if(Ue.type!=="row"){if(await Re(Ue),Ue.targets)for(const We of Ue.targets)await Re(We,Ue.datasource);const Be=c.Ay.panels[Ue.type];Be&&(Qe["panel"+Be.id]={type:"panel",id:Be.id,name:Be.name,version:Be.info.version})}},Ae=async Ue=>{if((0,g.X)(Ue)){const{name:Be,uid:We}=Ue.libraryPanel;let _e=Ue.libraryPanel.model;_e||(_e=(await(0,P.Yr)(We,!0)).model),await Re(_e);const{gridPos:Xe,id:le,...ye}=_e;He.has(We)||He.set(We,{name:Be,uid:We,kind:O.i.Panel,model:ye})}};try{for(const We of Te.panels)if(await Ne(We),We.collapsed!==void 0&&We.collapsed===!0&&We.panels)for(const _e of We.panels)await Ne(_e);for(const We of Te.getVariables())We.type==="query"?(await Re(We),We.options=[],We.current={},We.refresh=We.refresh!==D.CO.never?We.refresh:D.CO.onDashboardLoad):We.type==="datasource"&&(We.current={});for(const We of Te.annotations.list)await Re(We);Qe.grafana={type:"grafana",id:"grafana",name:"Grafana",version:c.Ay.buildInfo.version};for(const We of Te.panels)if(await Ae(We),We.collapsed!==void 0&&We.collapsed===!0&&We.panels)for(const _e of We.panels)await Ae(_e);(0,E.each)(tt,We=>{Ge.push(We)});for(const We of Te.getVariables())if((0,I.VO)(We)){const _e="VAR_"+We.name.replace(" ","_").toUpperCase();Ge.push({name:_e,type:"constant",label:We.label||We.name,value:We.query,description:""}),We.query="${"+_e+"}",We.current={value:We.query,text:We.query,selected:!1},We.options=[We.current]}const Ue=[...He.entries()].reduce((We,[_e,Xe])=>(We[_e]=Xe,We),{}),Be=(0,E.defaults)({__inputs:Ge,__elements:Ue,__requires:(0,E.sortBy)(Qe,["id"])},Te);for(let We=0;We<Be.panels.length;We++){const _e=Be.panels[We];j(_e)&&(Be.panels[We]={gridPos:_e.gridPos,id:_e.id,libraryPanel:{uid:_e.libraryPanel.uid,name:_e.libraryPanel.name}})}return Be}catch(Ue){return console.error("Export failed:",Ue),{error:Ue}}}}var B=e(3392),S=e(87745),w=e(70713),N=e(50992),M=e(47931);function L({json:Se,onDismiss:Me}){const Te=(0,a.useCallback)(()=>Se,[Se]);return(0,n.jsxs)(o.a,{title:(0,s.t)("dashboard.view-json-modal.title-json","JSON"),onDismiss:Me,onClickBackdrop:Me,isOpen:!0,children:[(0,n.jsx)(w.Ay,{disableHeight:!0,children:({width:Ge})=>(0,n.jsx)(N.B,{value:Se,language:"json",showMiniMap:!1,height:"500px",width:Ge})}),(0,n.jsx)(o.a.ButtonRow,{children:(0,n.jsx)(M.b,{icon:"copy",getText:Te,onClipboardCopy:()=>{r.c.exportCopyJsonClicked()},children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var A=e(58662);class U extends a.PureComponent{constructor(Me){super(Me),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:Te}=this.props,{shareExternally:Ge}=this.state;r.c.exportSaveJsonClicked({externally:Ge,shareResource:(0,A.hD)(this.props.panel)}),Ge?(0,B.E)(Te).then(Qe=>{this.openSaveAsDialog(Qe)}):this.openSaveAsDialog(Te.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:Te}=this.props,{shareExternally:Ge}=this.state;r.c.exportViewJsonClicked({externally:Ge,shareResource:(0,A.hD)(this.props.panel)}),Ge?this.exporter.makeExportable(Te).then(Qe=>{this.openJsonModal(Qe)}):this.openJsonModal(Te.getSaveModelClone())},this.openSaveAsDialog=Te=>{const Ge=JSON.stringify(Te,null,2),Qe=new Blob([Ge],{type:"application/json;charset=utf-8"}),tt=new Date().getTime();(0,x.saveAs)(Qe,`${Te.title}-${tt}.json`)},this.openJsonModal=Te=>{m.lE.publish(new S.S8({props:{json:JSON.stringify(Te,null,2)},component:L})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new W}render(){const{onDismiss:Me}=this.props,{shareExternally:Te}=this.state,Ge=(0,s.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,n.jsx)(f.D,{label:Ge,children:(0,n.jsx)(u.d,{id:"share-externally-toggle",value:Te,onChange:this.onShareExternallyChange})}),(0,n.jsxs)(o.a.ButtonRow,{children:[(0,n.jsx)(b.$n,{variant:"secondary",onClick:Me,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(b.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var F=e(65241),V=e(51898),K=e(16780),G=e(63527),H=e(89640),_=e(34999),k=e(29216);class J extends a.PureComponent{constructor(Me){super(Me),this.buildUrl=async()=>{const{panel:Te,dashboard:Ge}=this.props,{useCurrentTimeRange:Qe,useShortUrl:tt,selectedTheme:ke}=this.state,He=await(0,A.Xe)(Qe,ke,Te,tt),Re=(0,A.Lb)(Qe,Ge.uid,ke,Te);this.setState({shareUrl:He,imageUrl:Re})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=Te=>{this.setState({selectedTheme:Te})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{r.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,A.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(Me,Te){const{useCurrentTimeRange:Ge,useShortUrl:Qe,selectedTheme:tt}=this.state;(Te.useCurrentTimeRange!==Ge||Te.selectedTheme!==tt||Te.useShortUrl!==Qe)&&this.buildUrl()}render(){const{panel:Me,dashboard:Te}=this.props,Ge=Te?Te.time.to==="now":!1,{useCurrentTimeRange:Qe,useShortUrl:tt,selectedTheme:ke,shareUrl:He,imageUrl:Re}=this.state,Ne=V.Tp.pages.SharePanelModal,Ae=!!Te.id,Ue=(0,s.t)("share-modal.link.time-range-label","Lock time range"),Be=(0,s.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),We=(0,s.t)("share-modal.link.shorten-url","Shorten URL"),_e=(0,s.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(K.n,{children:[(0,n.jsx)(f.D,{label:Ue,description:Ge?Be:"",children:(0,n.jsx)(u.d,{id:"share-current-time-range",value:Qe,onChange:this.onUseCurrentTimeRangeChange})}),(0,n.jsx)(k.w,{selectedTheme:ke,onChange:this.onThemeChange}),(0,n.jsx)(f.D,{label:We,children:(0,n.jsx)(u.d,{id:"share-shorten-url",value:tt,onChange:this.onUrlShorten})}),(0,n.jsx)(f.D,{label:_e,children:(0,n.jsx)(G.p,{id:"link-url-input",value:He,readOnly:!0,addonAfter:(0,n.jsx)(M.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),Me&&c.Ay.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[Ae&&(0,n.jsx)(H.Y,{href:Re,external:!0,icon:"camera","aria-label":Ne.linkToRenderedImage,children:(0,s.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Ae&&(0,n.jsx)(_.F,{severity:"info",title:(0,s.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),Me&&!c.Ay.rendererAvailable&&(0,n.jsx)(_.F,{severity:"info",title:(0,s.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(s.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)(H.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var z=e(3594),Y=e(68143),X=e(18857),Q=e(41654),q=e(68079),te=e(75421),ne=e(8735);class se extends a.PureComponent{constructor(Me){super(Me),this.createSnapshot=Te=>()=>{const{timeoutSeconds:Ge}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,Te)},Ge*1e3)},this.saveSnapshot=async(Te,Ge)=>{const{snapshotExpires:Qe,timeoutSeconds:tt}=this.state,ke=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(ke);const He={dashboard:ke,name:ke.title,expires:Qe,external:Ge};try{const Re=await(0,ne.s)().create(He);this.setState({deleteUrl:Re.deleteUrl,snapshotUrl:Re.url,step:2})}finally{Ge?r.c.publishSnapshotClicked({expires:Qe,timeout:tt,shareResource:(0,A.hD)(this.props.panel)}):r.c.publishSnapshotLocalClicked({expires:Qe,timeout:tt,shareResource:(0,A.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=Te=>{const{panel:Ge}=this.props,{snapshotName:Qe}=this.state;Te.title=Qe,Te.time=(0,te.jG)().timeRange(),Te.links=[],Te.panels.forEach(ke=>{ke.targets=[],ke.links=[],ke.datasource=null});const tt=Te.annotations.list.filter(ke=>ke.enable);if(Te.annotations.list=tt.map(ke=>({name:ke.name,enable:ke.enable,iconColor:ke.iconColor,snapshotData:ke.snapshotData,type:ke.type,builtIn:ke.builtIn,hide:ke.hide})),Te.getVariables().forEach(ke=>{"query"in ke&&(ke.query=""),"options"in ke&&(ke.options=ke.current&&!(0,z.R)(ke.current)?[ke.current]:[]),"refresh"in ke&&(ke.refresh=D.CO.never)}),Ge){const ke=Ge.getSaveModel();ke.gridPos.w=24,ke.gridPos.x=0,ke.gridPos.y=0,ke.gridPos.h=20,Te.panels=[ke]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(ke=>{delete ke.snapshotData}),this.dashboard.annotations.list.forEach(ke=>{delete ke.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:Te}=this.state;await(0,Y.AI)().get(Te),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=Te=>{this.setState({snapshotName:Te.target.value})},this.onTimeoutChange=Te=>{this.setState({timeoutSeconds:Number(Te.target.value)})},this.onExpireChange=Te=>{this.setState({selectedExpireOption:Te,snapshotExpires:Te.value})},this.dashboard=Me.dashboard,this.expireOptions=[{label:(0,s.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,s.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,s.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,s.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:Me.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const Me=await(0,ne.s)().getSharingOptions();this.setState({sharingButtonText:Me.externalSnapshotName,externalEnabled:Me.externalEnabled})}renderStep1(){const{onDismiss:Me}=this.props,{snapshotName:Te,selectedExpireOption:Ge,timeoutSeconds:Qe,isLoading:tt,sharingButtonText:ke,externalEnabled:He}=this.state,Re=(0,s.t)("share-modal.snapshot.name","Snapshot name"),Ne=(0,s.t)("share-modal.snapshot.expire","Expire"),Ae=(0,s.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Ue=(0,s.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{children:(0,n.jsxs)(s.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(f.D,{label:Re,children:(0,n.jsx)(G.p,{id:"snapshot-name-input",width:30,value:Te,onChange:this.onSnapshotNameChange})}),(0,n.jsx)(f.D,{label:Ne,children:(0,n.jsx)(X.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:Ge,onChange:this.onExpireChange})}),(0,n.jsx)(f.D,{label:Ae,description:Ue,children:(0,n.jsx)(G.p,{id:"timeout-input",type:"number",width:21,value:Qe,onChange:this.onTimeoutChange})}),(0,n.jsxs)(o.a.ButtonRow,{children:[(0,n.jsx)(b.$n,{variant:"secondary",onClick:Me,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),He&&(0,n.jsx)(b.$n,{variant:"secondary",disabled:tt,onClick:this.createSnapshot(!0),children:ke}),(0,n.jsx)(b.$n,{variant:"primary",disabled:tt,onClick:this.createSnapshot(),children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:Me}=this.state;return(0,n.jsxs)(Q.B,{direction:"column",gap:0,children:[(0,n.jsx)(f.D,{label:(0,s.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(G.p,{id:"snapshot-url-input",value:Me,readOnly:!0,addonAfter:(0,n.jsx)(M.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(b.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})}render(){const{isLoading:Me,step:Te}=this.state;return(0,n.jsxs)(n.Fragment,{children:[Te===1&&this.renderStep1(),Te===2&&this.renderStep2(),Te===3&&this.renderStep3(),Me&&(0,n.jsx)(q.y,{inline:!0})]})}}const ue=[],de=[];function ie(Se){ue.push(Se)}function he(Se){de.push(Se)}function me(Se,Me,Te){const Qe=[{label:(0,s.t)("share-modal.tab-title.link","Link"),value:A.wr.link,component:J}];if(m.TP.isSignedIn&&c.$W.snapshotEnabled&&m.TP.hasPermission(y.w.SnapshotsCreate)){const ke=(0,s.t)("share-modal.tab-title.snapshot","Snapshot");Qe.push({label:ke,value:A.wr.snapshot,component:se})}if(Me){const ke=(0,s.t)("share-modal.tab-title.embed","Embed");if(Qe.push({label:ke,value:A.wr.embed,component:v.D}),!(0,g.X)(Me)){const He=(0,s.t)("share-modal.tab-title.library-panel","Library panel");Qe.push({label:He,value:A.wr.libraryPanel,component:F.j})}Qe.push(...de)}else{const ke=(0,s.t)("share-modal.tab-title.export","Export");Qe.push({label:ke,value:A.wr.export,component:U}),Qe.push(...ue),(0,h.iR)()&&Qe.push({label:(0,s.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:A.wr.publicDashboard,component:p.b})}const tt=Qe.find(ke=>ke.value===Te);return{tabs:Qe,activeTab:tt?.value??Qe[0].value}}function ce(Se){const{tabs:Me,activeTab:Te}=me(Se.dashboard.canEditDashboard(),Se.panel,Se.activeTab);return{tabs:Me,activeTab:Te}}class Pe extends a.Component{constructor(Me){super(Me),this.onSelectTab=Te=>{this.setState(Ge=>({...Ge,activeTab:Te.value})),r.c.sharingCategoryClicked({item:Te.value,shareResource:(0,A.hD)(this.props.panel)})},this.state=ce(Me)}getActiveTab(){const{tabs:Me,activeTab:Te}=this.state;return Me.find(Ge=>Ge.value===Te)}renderTitle(){const{panel:Me}=this.props,{activeTab:Te}=this.state,Ge=Me?(0,s.t)("share-modal.panel.title","Share Panel"):(0,s.t)("share-modal.dashboard.title","Share"),Qe=this.props.dashboard.canEditDashboard(),tt=me(Qe,this.props.panel,this.state.activeTab).tabs;return(0,n.jsx)(l.J,{title:Ge,icon:"share-alt",tabs:tt,activeTab:Te,onChangeTab:this.onSelectTab})}render(){const{dashboard:Me,panel:Te}=this.props,Qe=this.getActiveTab().component;return(0,n.jsx)(o.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,n.jsx)(d.J,{children:(0,n.jsx)(Qe,{dashboard:Me,panel:Te,onDismiss:this.props.onDismiss})})})}}const Ie=(0,i.cV)(Pe)},72973:(Z,R,e)=>{"use strict";e.d(R,{K:()=>me,b:()=>he});var n=e(74848),a=e(22803),s=e(49785),l=e(51898),o=e(92745),d=e(63142),i=e(37386),c=e(63527),m=e(47931),p=e(41654),h=e(21285),r=e(72636),g=e(32881),y=e(45861),v=e(8515),x=e(62905),f=e(90593),u=e(23289),b=e(61730),E=e(11257),D=e(52763),C=e(15130),P=e(52908);const T=()=>{const{width:Pe}=(0,P.A)();return Pe>1024};var O=e(23753),I=e(58662),j=e(35195),W=e(34999);const B=()=>(0,n.jsx)(W.F,{title:(0,o.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var S=e(37672),w=e(44173),N=e(24313),M=e(16780),L=e(56265);const A=l.Tp.pages.ShareDashboardModal.PublicDashboard,U=({disabled:Pe,onChange:Ie,register:Se,timeRange:Me})=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(M.n,{disabled:Pe,children:(0,n.jsxs)(g.gW,{spacing:"md",children:[(0,n.jsxs)(p.B,{direction:"column",gap:.5,justifyContent:"space-between",children:[(0,n.jsx)(r.J,{description:(0,o.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,n.jsx)(L.b,{value:Me,disabled:!0,onChange:()=>{}})]}),(0,n.jsxs)(p.B,{direction:"row",gap:.5,children:[(0,n.jsx)(h.d,{...Se("isTimeSelectionEnabled"),"data-testid":A.EnableTimeRangeSwitch,onChange:Te=>{Ie("isTimeSelectionEnabled",Te.currentTarget.checked),u.c.publicDashboardTimeSelectionChanged({enabled:Te.currentTarget.checked})}}),(0,n.jsx)(r.J,{description:(0,o.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,n.jsxs)(p.B,{direction:"row",gap:.5,children:[(0,n.jsx)(h.d,{...Se("isAnnotationsEnabled"),onChange:Te=>{Ie("isAnnotationsEnabled",Te.currentTarget.checked),u.c.publicDashboardAnnotationsSelectionChanged({enabled:Te.currentTarget.checked})},"data-testid":A.EnableAnnotationsSwitch}),(0,n.jsx)(r.J,{description:(0,o.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var F=e(93256),V=e(77824),K=e(68079),G=e(72746);const H=l.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,_=({recipients:Pe,dashboardUid:Ie,publicDashboardUid:Se})=>{const Me=(0,d.of)(J),[Te,{isLoading:Ge}]=(0,x.$L)(),[Qe,{isLoading:tt}]=(0,x.NA)(),ke=Ge||tt,He=(Ne,Ae)=>{u.c.revokePublicDashboardEmailClicked(),Te({recipientUid:Ne,recipientEmail:Ae,dashboardUid:Ie,uid:Se})},Re=Ne=>{u.c.resendPublicDashboardEmailClicked(),Qe({recipientUid:Ne,uid:Se})};return(0,n.jsx)("table",{className:Me.table,"data-testid":H.EmailSharingList,children:(0,n.jsx)("tbody",{children:Pe.map((Ne,Ae)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:Ne.recipient}),(0,n.jsx)("td",{children:(0,n.jsxs)(F.e,{className:Me.tableButtonsContainer,children:[(0,n.jsx)(y.$n,{type:"button",variant:"destructive",fill:"text",title:(0,o.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:ke,onClick:()=>He(Ne.uid,Ne.recipient),"data-testid":`${H.DeleteEmail}-${Ae}`,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,n.jsx)(y.$n,{type:"button",variant:"primary",fill:"text",title:(0,o.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:ke,onClick:()=>Re(Ne.uid),"data-testid":`${H.ReshareLink}-${Ae}`,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},Ne.uid))})})},k=({dashboard:Pe})=>{const{width:Ie}=(0,P.A)(),Se=(0,d.of)(J),Me=Pe instanceof G.H$?Pe.state.uid:Pe.uid,{data:Te}=(0,x.Bs)(Me),[Ge]=(0,x.ft)(),[Qe,{isLoading:tt}]=(0,x.NY)(),ke=C.TP.hasPermission(E.w.DashboardsPublicWrite),{register:He,setValue:Re,control:Ne,watch:Ae,handleSubmit:Ue,formState:{errors:Be},reset:We}=(0,s.mN)({defaultValues:{shareType:Te?.share||N.Xo.PUBLIC,email:""},mode:"onSubmit"}),_e=le=>{const ye={dashboard:Pe,payload:{...Te,share:le}};Ge(ye)},Xe=async le=>{u.c.publicDashboardEmailInviteClicked(),await Qe({recipient:le.email,uid:Te.uid,dashboardUid:Me}).unwrap(),We({email:"",shareType:N.Xo.EMAIL})};return(0,n.jsx)("form",{onSubmit:Ue(Xe),children:(0,n.jsxs)(M.n,{disabled:!ke,"data-testid":H.Container,className:Se.container,children:[(0,n.jsx)(i.D,{label:(0,o.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:Se.field,children:(0,n.jsx)(s.xI,{name:"shareType",control:Ne,render:({field:le})=>{const{ref:ye,...pe}=le,ve=[{label:(0,o.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:N.Xo.PUBLIC},{label:(0,o.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:N.Xo.EMAIL}];return(0,n.jsx)(V.z,{...pe,size:Ie<480?"sm":"md",options:ve,onChange:be=>{u.c.publicDashboardShareTypeChange({shareType:be===N.Xo.EMAIL?"email":"public"}),Re("shareType",be),_e(be)}})}})}),Ae("shareType")===N.Xo.EMAIL&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.D,{label:(0,o.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,o.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Be.email?.message,invalid:!!Be.email?.message||void 0,className:Se.field,children:(0,n.jsxs)("div",{className:Se.emailContainer,children:[(0,n.jsx)(c.p,{className:Se.emailInput,placeholder:"me@example.com",autoCapitalize:"none",...He("email",{required:(0,o.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:N._l,message:(0,o.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":H.EmailSharingInput}),(0,n.jsxs)(y.$n,{type:"submit",variant:"primary",disabled:tt,"data-testid":H.EmailSharingInviteButton,children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),tt&&(0,n.jsx)(K.y,{})]})]})}),!!Te?.recipients?.length&&(0,n.jsx)(_,{recipients:Te.recipients,dashboardUid:Me,publicDashboardUid:Te.uid})]})]})})},J=Pe=>({container:(0,a.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:Pe.spacing(3)}),field:(0,a.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,a.css)({label:"emailContainer",display:"flex",gap:Pe.spacing(1)}),emailInput:(0,a.css)({label:"emailInput",flexGrow:1}),table:(0,a.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:Pe.spacing(.5,1),":nth-child(odd)":{background:Pe.colors.background.secondary}}}),tableButtonsContainer:(0,a.css)({display:"flex",justifyContent:"end"})});var z=e(96540),Y=e(44019),X=e(76319);function Q({headerElement:Pe,isContentVisible:Ie=!1,onRowToggle:Se,title:Me,...Te}){const Ge=(0,d.of)(q),Qe=Pe&&Y.renderOrCallToRender(Pe,{className:Ge.summaryWrapper});return(0,n.jsx)("div",{className:Ge.wrapper,children:(0,n.jsxs)("div",{className:Ge.header,children:[(0,n.jsx)(X.K,{name:Ie?"angle-down":"angle-right",tooltip:Ie?(0,o.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,o.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Ge.collapseIcon,onClick:Se,"aria-expanded":Ie,...Te}),Me&&(0,n.jsx)("div",{className:Ge.titleWrapper,onClick:Se,children:(0,n.jsx)("span",{className:Ge.title,children:Me})}),Qe]})})}Q.displayName="SettingsBarHeader";function q(Pe){return{wrapper:(0,a.css)({label:"header",padding:Pe.spacing(.5,.5),borderRadius:Pe.shape.radius.default,background:Pe.colors.background.secondary,minHeight:Pe.spacing(4),"&:focus":{outline:"none"}}),header:(0,a.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,a.css)({marginLeft:Pe.spacing(.5),color:Pe.colors.text.disabled}),titleWrapper:(0,a.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${Pe.spacing(.5)}`,[Pe.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,a.css)({fontWeight:Pe.typography.fontWeightBold,marginLeft:Pe.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",[Pe.breakpoints.down("sm")]:{flex:"2 2"}})}}function te({children:Pe,title:Ie,headerElement:Se,...Me}){const Te=(0,d.of)(ne),[Ge,Qe]=(0,z.useState)(!1);function tt(){Qe(ke=>!ke)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q,{onRowToggle:tt,isContentVisible:Ge,title:Ie,headerElement:Se,...Me}),Ge&&(0,n.jsx)("div",{className:Te.content,children:Pe})]})}te.displayName="SettingsBar";const ne=Pe=>({content:(0,a.css)({marginTop:Pe.spacing(1),marginLeft:Pe.spacing(4)})});var se=e(83692);function ue({className:Pe,isDataLoading:Ie=!1,timeRange:Se,timeSelectionEnabled:Me,annotationsEnabled:Te}){const Ge=(0,d.of)(de),Qe=(0,o.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),tt=(0,o.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),ke=(0,o.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),He=(0,o.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return Ie?(0,n.jsx)("div",{className:(0,a.cx)(Ge.summaryWrapper,Pe),children:(0,n.jsx)(K.y,{className:Ge.summary,inline:!0,size:"sm"})}):(0,n.jsxs)("div",{className:(0,a.cx)(Ge.summaryWrapper,Pe),children:[(0,n.jsxs)("span",{className:Ge.summary,children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,n.jsx)(se.f,{className:Ge.timeRange,value:Se})]}),(0,n.jsx)("span",{className:Ge.summary,children:Me?Qe:tt}),(0,n.jsx)("span",{className:Ge.summary,children:Te?ke:He})]})}ue.displayName="SettingsSummary";const de=Pe=>({summaryWrapper:(0,a.css)({display:"flex"}),summary:(0,a.css)({label:"collapsedText",marginLeft:`${Pe.spacing.gridSize*2}px`,fontSize:Pe.typography.bodySmall.fontSize,color:Pe.colors.text.secondary}),timeRange:(0,a.css)({display:"inline-block"})}),ie=l.Tp.pages.ShareDashboardModal.PublicDashboard;function he({onRevoke:Pe,timeRange:Ie,hasTemplateVariables:Se=!1,showSaveChangesAlert:Me=!1,unsupportedDatasources:Te=[],publicDashboard:Ge,dashboard:Qe}){const tt=(0,d.of)(ce),ke=T(),[He,{isLoading:Re}]=(0,x.T2)(),[Ne,{isLoading:Ae}]=(0,x.eq)(),Ue=C.TP.hasPermission(E.w.DashboardsPublicWrite),Be=!Ue||Re||Ae,{handleSubmit:We,setValue:_e,register:Xe}=(0,s.mN)({defaultValues:{isAnnotationsEnabled:Ge?.annotationsEnabled,isTimeSelectionEnabled:Ge?.timeSelectionEnabled,isPaused:!Ge?.isEnabled}}),le=async Oe=>{const{isAnnotationsEnabled:we,isTimeSelectionEnabled:ze,isPaused:Ve}=Oe;He({dashboard:Qe,payload:{...Ge,annotationsEnabled:we,timeSelectionEnabled:ze,isEnabled:!Ve}})},ye=async Oe=>{const{isAnnotationsEnabled:we,isTimeSelectionEnabled:ze,isPaused:Ve}=Oe;Ne({dashboard:Qe,payload:{...Ge,annotationsEnabled:we,timeSelectionEnabled:ze,isEnabled:!Ve}})},pe=async(Oe,we)=>{_e(Oe,we),await We(ze=>le(ze))()},ve=async Oe=>{_e("isPaused",Oe),await We(we=>ye(we))()};function be(){u.c.publicDashboardUrlCopied()}return(0,n.jsxs)("div",{className:tt.configContainer,children:[Me&&(0,n.jsx)(B,{}),!Ue&&(0,n.jsx)(j.t,{mode:"edit"}),Se&&(0,n.jsx)(w.D,{}),Te.length>0&&(0,n.jsx)(S.s,{unsupportedDataSources:Te.join(", ")}),(0,N.AY)()&&(0,n.jsx)(k,{dashboard:Qe}),(0,n.jsx)(i.D,{label:(0,o.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:tt.fieldSpace,children:(0,n.jsx)(c.p,{value:(0,N.mL)(Ge.accessToken),readOnly:!0,disabled:!Ge?.isEnabled,"data-testid":ie.CopyUrlInput,addonAfter:(0,n.jsx)(m.b,{"data-testid":ie.CopyUrlButton,variant:"primary",disabled:!Ge?.isEnabled,getText:()=>(0,N.mL)(Ge.accessToken),onClipboardCopy:be,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,n.jsx)(i.D,{className:tt.fieldSpace,children:(0,n.jsxs)(p.B,{children:[(0,n.jsx)(h.d,{...Xe("isPaused"),disabled:Be,onChange:Oe=>{u.c.publicDashboardPauseSharingClicked({paused:Oe.currentTarget.checked}),ve(Oe.currentTarget.checked)},"data-testid":ie.PauseSwitch}),(0,n.jsx)(r.J,{className:(0,a.css)({marginBottom:0}),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,n.jsx)(i.D,{className:tt.fieldSpace,children:(0,n.jsx)(te,{title:(0,o.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:Oe})=>(0,n.jsx)(ue,{className:Oe,isDataLoading:Re,timeRange:Ie,timeSelectionEnabled:Ge?.timeSelectionEnabled,annotationsEnabled:Ge?.annotationsEnabled}),"data-testid":ie.SettingsDropdown,children:(0,n.jsx)(U,{disabled:Be,onChange:pe,register:Xe,timeRange:Ie})})}),(0,n.jsx)(p.B,{direction:ke?"row":"column",justifyContent:ke?"flex-end":"flex-start",alignItems:ke?"center":"stretch",children:(0,n.jsx)(g.Gy,{justify:"flex-end",children:(0,n.jsx)(y.$n,{title:(0,o.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:Pe,type:"button",disabled:Be,"data-testid":ie.DeleteButton,variant:"destructive",fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function me({publicDashboard:Pe,unsupportedDatasources:Ie}){const Me=(0,D.d4)(He=>He.dashboard).getModel(),Te=(0,f.z)(Me.getDefaultTime(),Me),Ge=C.TP.hasPermission(E.w.DashboardsPublicWrite),Qe=(0,N.kD)(Me.getVariables()),[tt]=(0,x.bN)(),ke=He=>{tt({dashboard:Me,uid:Pe.uid,dashboardUid:Me.uid}),He()};return(0,n.jsx)(v.$s,{children:({showModal:He,hideModal:Re})=>(0,n.jsx)(he,{publicDashboard:Pe,dashboard:Me,unsupportedDatasources:Ie,timeRange:Te,showSaveChangesAlert:Ge&&Me.hasUnsavedChanges(),hasTemplateVariables:Qe,onRevoke:()=>{u.c.revokePublicDashboardClicked(),He(b.m,{onConfirm:()=>ke(Re),onDismiss:()=>{He(O.Zy,{dashboard:Me,onDismiss:Re,activeTab:I.wr.publicDashboard})}})}})})}const ce=Pe=>({configContainer:(0,a.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:Pe.spacing(3)}),fieldSpace:(0,a.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,a.css)({display:"inline-block"})})},58375:(Z,R,e)=>{"use strict";e.d(R,{M:()=>j,D:()=>I});var n=e(74848),a=e(22803),s=e(49785),l=e(51898),o=e(92745),d=e(63142),i=e(45861),c=e(68079),m=e(15130),p=e(62905),h=e(23289),r=e(11257),g=e(52763),y=e(35195),v=e(37672),x=e(44173),f=e(24313),u=e(55066),b=e(16780),E=e(32881),D=e(32635);const C=l.Tp.pages.ShareDashboardModal.PublicDashboard,P=({disabled:B,register:S})=>{const w=(0,d.of)(T),N=[{type:"publicAcknowledgment",description:(0,o.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:C.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,o.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,o.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:C.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,o.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,o.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:C.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,o.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:w.title,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,n.jsx)(b.n,{disabled:B,children:(0,n.jsx)(E.gW,{spacing:"md",children:N.map(M=>(0,n.jsxs)(E.Gy,{spacing:"none",align:"center",children:[(0,n.jsx)(D.S,{...S(M.type,{required:!0}),label:M.description,"data-testid":M.testId}),(0,n.jsx)(i.z9,{variant:"primary",href:M.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:M.info.tooltip})]},M.type))})})]})},T=B=>({title:(0,a.css)({fontWeight:B.typography.fontWeightBold})}),O=l.Tp.pages.ShareDashboardModal.PublicDashboard,I=({unsupportedDatasources:B=[],unsupportedTemplateVariables:S=!1,dashboard:w,hasError:N=!1})=>{const M=(0,d.of)(W),L=m.TP.hasPermission(r.w.DashboardsPublicWrite),[A,{isLoading:U,isError:F}]=(0,p.U9)(),V=()=>{A({dashboard:w,payload:{isEnabled:!0}}),h.c.generatePublicDashboardUrlClicked({})},{handleSubmit:K,register:G,formState:{isValid:H}}=(0,s.mN)({mode:"onChange"}),_=!L||U||F||N;return(0,n.jsxs)("div",{className:M.container,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:M.title,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,n.jsx)("p",{className:M.description,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!L&&(0,n.jsx)(y.t,{mode:"create"}),S&&(0,n.jsx)(x.D,{}),B.length>0&&(0,n.jsx)(v.s,{unsupportedDataSources:B.join(", ")}),(0,n.jsxs)("form",{onSubmit:K(V),children:[(0,n.jsx)("div",{className:M.checkboxes,children:(0,n.jsx)(P,{disabled:_,register:G})}),(0,n.jsx)("div",{className:M.buttonContainer,children:(0,n.jsxs)(i.$n,{type:"submit",disabled:_||!H,"data-testid":O.CreateButton,children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),U&&(0,n.jsx)(c.y,{className:M.loadingSpinner})]})})]})]})};function j({hasError:B}){const w=(0,g.d4)(L=>L.dashboard).getModel(),{unsupportedDataSources:N}=(0,u.Z)(w),M=(0,f.kD)(w.getVariables());return(0,n.jsx)(I,{dashboard:w,unsupportedDatasources:N,unsupportedTemplateVariables:M,hasError:B})}const W=B=>({container:(0,a.css)({display:"flex",flexDirection:"column",gap:B.spacing(4)}),title:(0,a.css)({fontSize:B.typography.h4.fontSize,margin:B.spacing(0,0,2)}),description:(0,a.css)({color:B.colors.text.secondary,marginBottom:B.spacing(0)}),checkboxes:(0,a.css)({margin:B.spacing(0,0,4)}),buttonContainer:(0,a.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,a.css)({marginLeft:B.spacing(1)})})},35195:(Z,R,e)=>{"use strict";e.d(R,{t:()=>i});var n=e(74848),a=e(51898),s=e(92745),l=e(43173),o=e(34999);const d=a.Tp.pages.ShareDashboardModal.PublicDashboard,i=({mode:c})=>{const m=l.$.featureToggles.newDashboardSharingComponent?(0,s.t)("public-dashboard.share-externally.no-upsert-perm-alert-title","You don\u2019t have permission to {{ action }} a shared dashboard",{action:c}):(0,s.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ action }} a public dashboard",{action:c});return(0,n.jsx)(o.F,{severity:"warning",title:m,"data-testid":d.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:l.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(s.x6,{i18nKey:"public-dashboard.share-externally.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{action:c}," shared dashboards"]}):(0,n.jsxs)(s.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{action:c}," public dashboards"]})})}},37672:(Z,R,e)=>{"use strict";e.d(R,{s:()=>h});var n=e(74848),a=e(22803),s=e(46942),l=e.n(s),o=e(51898),d=e(92745),i=e(43173),c=e(63142),m=e(34999);const p=o.Tp.pages.ShareDashboardModal.PublicDashboard,h=({unsupportedDataSources:g})=>{const y=(0,c.of)(r);return(0,n.jsxs)(m.F,{severity:"warning",title:(0,d.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":p.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,n.jsx)("p",{className:y.unsupportedDataSourceDescription,children:i.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(d.x6,{i18nKey:"public-dashboard.share-externally.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for shared dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:g},"."]}):(0,n.jsxs)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:g},"."]})}),(0,n.jsx)("a",{href:i.$.featureToggles.newDashboardSharingComponent?"https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#supported-data-sources":"https://grafana.com/docs/grafana/v11.2/dashboards/dashboard-public/#supported-data-sources",target:"blank",className:l()("text-link",y.unsupportedDataSourceDescription),children:(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},r=g=>({unsupportedDataSourceDescription:(0,a.css)({color:g.colors.text.secondary,marginBottom:g.spacing(1)})})},44173:(Z,R,e)=>{"use strict";e.d(R,{D:()=>d});var n=e(74848),a=e(51898),s=e(92745),l=e(34999);const o=a.Tp.pages.ShareDashboardModal.PublicDashboard,d=({showDescription:i=!0})=>(0,n.jsx)(l.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":o.TemplateVariablesWarningAlert,bottomSpacing:0,children:i&&(0,n.jsx)(s.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},82298:(Z,R,e)=>{"use strict";e.d(R,{a:()=>g,b:()=>y});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(68079),d=e(62905),i=e(24313),c=e(52763),m=e(40203),p=e(72973),h=e(58375),r=e(55066);const g=()=>{const x=(0,l.of)(v);return(0,n.jsx)(m.G,{className:x.loadingContainer,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard.share-public-dashboard-loader.loading-configuration",children:"Loading configuration"}),(0,n.jsx)(o.y,{size:"lg",className:x.spinner})]})})},y=x=>{const{data:f,isLoading:u,isError:b}=(0,d.Bs)(x.dashboard.uid),D=(0,c.d4)(P=>P.dashboard).getModel(),{unsupportedDataSources:C}=(0,r.Z)(D);return(0,n.jsx)(n.Fragment,{children:u?(0,n.jsx)(g,{}):(0,i.lI)(f)?(0,n.jsx)(p.K,{publicDashboard:f,unsupportedDatasources:C}):(0,n.jsx)(h.M,{hasError:b})})},v=x=>({loadingContainer:(0,a.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:x.spacing(1)}),spinner:(0,a.css)({marginBottom:x.spacing(0)})})},24313:(Z,R,e)=>{"use strict";e.d(R,{AY:()=>x,Xo:()=>c,_A:()=>h,_l:()=>y,gN:()=>g,iR:()=>v,kD:()=>m,lI:()=>p,mL:()=>r});var n=e(36580),a=e(43173),s=e(62061),l=e(65642),o=e(28998),d=e(58662),i=e(35143),c=(f=>(f.PUBLIC="public",f.EMAIL="email",f))(c||{});const m=f=>f.length>0,p=f=>f?.uid!==""&&f?.uid!==void 0,h=async f=>{let u=new Set;for(const b of f)for(const E of b.targets){const D=E?.datasource?.type;D&&(i.z.has(D)&&await(0,o.tR)().get(E.datasource)instanceof n.iy||u.add(D))}return Array.from(u).sort()},r=f=>`${(0,l.zj)().appUrl}public-dashboards/${f}`,g=(f,u)=>`/d/${f}/${u}?shareView=${d.wr.publicDashboard}`,y=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,v=()=>a.$.publicDashboardsEnabled,x=()=>v()&&!!a.$.featureToggles.publicDashboardsEmailSharing&&(0,s.a)("publicDashboardsEmailSharing")},35143:(Z,R,e)=>{"use strict";e.d(R,{z:()=>n});const n=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","arabian9ts-mux-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","criblcloud-search-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-adobeanalytics-datasource","grafana-amazonprometheus-datasource","grafana-athena-datasource","grafana-aurora-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-cloudflare-datasource","grafana-cockroachdb-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-pagerduty-datasource","grafana-postgresql-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-vercel-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","grafana-yugabyte-datasource","grafana-zendesk-datasource","graphite","gridprotectionalliance-osisoftpi-datasource","hadesarchitect-cassandra-datasource","ibm-aql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","maormil-rabbitmq-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","victoriametrics-logs-datasource","victoriametrics-metrics-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},55066:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>s});var n=e(96540),a=e(24313);const s=l=>{const[o,d]=(0,n.useState)([]);return(0,n.useEffect)(()=>{(async()=>await(0,a._A)(l.panels))().then(c=>{d(c)})},[l.panels]),{unsupportedDataSources:o}}},29216:(Z,R,e)=>{"use strict";e.d(R,{w:()=>o});var n=e(74848),a=e(92745),s=e(37386),l=e(77824);const o=({selectedTheme:d="current",onChange:i,description:c})=>{const m=[{label:(0,a.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,a.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,a.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,n.jsx)(s.D,{label:(0,a.t)("share-modal.theme-picker.field-name","Theme"),description:c,children:(0,n.jsx)(l.z,{options:m,value:d,onChange:i})})}},58662:(Z,R,e)=>{"use strict";e.d(R,{CF:()=>g,Lb:()=>r,P_:()=>m,XV:()=>c,Xe:()=>p,hD:()=>v,wr:()=>x});var n=e(17548),a=e(83175),s=e(92138),l=e(25229),o=e(43173),d=e(71673),i=e(75421);function c({useCurrentTimeRange:f,selectedTheme:u,panel:b,search:E=window.location.search,range:D=(0,i.jG)().timeRange(),orgId:C=o.$.bootData.user.orgId}){const P=new URLSearchParams(E),T=b?.timeFrom;if(T){const{from:O,to:I}=n.describeTextRange(T);P.set("from",O),P.set("to",I)}else P.set("from",String(D.from.valueOf())),P.set("to",String(D.to.valueOf()));return P.set("orgId",String(C)),f||(P.delete("from"),P.delete("to")),u!=="current"&&P.set("theme",u),b&&!P.has("editPanel")&&P.set("viewPanel",String(b.id)),P.delete("auth_token"),P.delete("shareView"),P}function m(){let f=window.location.href;const u=f.indexOf("?");return u!==-1&&(f=f.substring(0,u)),f}async function p(f,u,b,E){const D=m(),C=c({useCurrentTimeRange:f,selectedTheme:u,panel:b}),P=a.kM.appendQueryToUrl(D,C.toString());return E?await(0,d.fn)(P):P}function h(f,u,b,E,D){const C=m(),P=c({useCurrentTimeRange:f,selectedTheme:b,panel:E,range:D});let T=C.replace(o.$.appSubUrl+"/dashboard/",o.$.appSubUrl+"/dashboard-solo/");T=T.replace(o.$.appSubUrl+"/d/",o.$.appSubUrl+"/d-solo/"),s.I.stripBaseFromUrl(C)==="/"&&(T=`${o.$.appUrl}d-solo/${u}`);const I=P.get("editPanel")??P.get("viewPanel")??"";return P.set("panelId",I),P.delete("editPanel"),P.delete("viewPanel"),a.kM.appendQueryToUrl(T,P.toString())}function r(f,u,b,E){let C=h(f,u,b,E).replace(o.$.appSubUrl+"/dashboard-solo/",o.$.appSubUrl+"/render/dashboard-solo/");return C=C.replace(o.$.appSubUrl+"/d-solo/",o.$.appSubUrl+"/render/d-solo/"),C+=`&width=${o.$.rendererDefaultImageWidth}&height=${o.$.rendererDefaultImageHeight}&scale=${o.$.rendererDefaultImageScale}`+y(),C}function g(f,u,b,E,D){return`<iframe src="${h(f,u,b,E,D)}" width="450" height="200" frameborder="0"></iframe>`}function y(){const f="&tz=UTC"+encodeURIComponent((0,l.KQ)().format("Z"));if(!window.Intl)return f;const u=window.Intl.DateTimeFormat();if(!u.resolvedOptions)return f;const b=u.resolvedOptions();return b.timeZone?"&tz="+encodeURIComponent(b.timeZone):f}const v=f=>f?"panel":"dashboard",x={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard",inviteUser:"invite_user"}},4137:(Z,R,e)=>{"use strict";e.d(R,{Zx:()=>C,aK:()=>f});var n=e(74848),a=e(22803),s=e(96540),l=e(16817),o=e(63704),d=e(51898),i=e(92745),c=e(63142),m=e(87063),p=e(92807),h=e(88559),r=e(30703),g=e(45861),y=e(83873),v=e(82345);function x({dashboardUID:P,link:T}){const O=(0,c.of)(D),I=u({dashboardUID:P,link:T});return!I||E.length===0?null:(0,n.jsx)(m.W,{children:(0,n.jsx)("div",{className:O.dropdown,children:(0,n.jsx)(p.P,{maxHeight:"inherit",children:I.map((j,W)=>(0,n.jsx)(m.W.Item,{url:j.url,target:T.targetBlank?"_blank":void 0,label:j.title,testId:d.Tp.components.DashboardLinks.link,"aria-label":(0,i.t)("dashboard.dashboard-links-menu.aria-label-dashboard-name","{{dashboardName}} dashboard",{dashboardName:j.title})},`dashlinks-dropdown-item-${j.uid}-${W}`))})})})}const f=P=>{const{link:T,linkInfo:O,dashboardUID:I}=P,j=u(P),W=(0,c.of)(D);return T.asDropdown?(0,n.jsx)(h.m,{overlay:(0,n.jsx)(x,{link:T,dashboardUID:I}),children:(0,n.jsxs)(C,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":d.Tp.components.DashboardLinks.dropDown,children:[(0,n.jsx)(r.I,{"aria-hidden":!0,name:"bars",className:W.iconMargin}),(0,n.jsx)("span",{children:O.title})]})}):(0,n.jsx)(n.Fragment,{children:j.length>0&&j.map((B,S)=>(0,n.jsx)(C,{icon:"apps",variant:"secondary",fill:"outline",href:B.url,target:T.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":d.Tp.components.DashboardLinks.link,children:B.title},`dashlinks-list-item-${B.uid}-${S}`))})},u=({link:P,dashboardUID:T})=>{const{tags:O}=P,I=(0,l.A)(()=>b(O),[O]);return I.value?E(T,P,I.value):[]};async function b(P,T={getBackendSrv:y.AI}){return await T.getBackendSrv().search({tag:P,limit:100})}function E(P,T,O,I={getLinkSrv:v.mQ,sanitize:o.aj,sanitizeUrl:o.Jf}){return O.filter(j=>j.uid!==P).map(j=>{const W=j.uid,B=I.sanitize(j.title),S=I.getLinkSrv().getLinkUrl({...T,url:j.url}),w=I.sanitizeUrl(S);return{uid:W,title:B,url:w}})}function D(P){return{iconMargin:(0,a.css)({marginRight:P.spacing(.5)}),dropdown:(0,a.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh"}),button:(0,a.css)({color:P.colors.text.primary}),dashButton:(0,a.css)({fontSize:P.typography.bodySmall.fontSize,paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})}}const C=(0,s.forwardRef)(({className:P,...T},O)=>{const I=(0,c.of)(D),j=T.href?g.z9:g.$n;return(0,n.jsx)(j,{...T,variant:"secondary",fill:"outline",className:(0,a.cx)(P,I.dashButton),ref:O})});C.displayName="DashboardLinkButton"},47350:(Z,R,e)=>{"use strict";e.d(R,{A:()=>A});var n=e(74848),a=e(8642),s=e(96540),l=e(42941),o=e(69862),d=e(57866),i=e(36638),c=e(2197),m=e(51898),p=e(92745),h=e(27489),r=e(2863),g=e(71599),y=e(43260),v=e(85348),x=e(65642),f=e(85622),u=e(22803),b=e(63142),E=e(8207),D=e(50275),C=e(30703);const P=({input:U,output:F,debugMode:V,index:K,uiConfig:G,configs:H,onChange:_,toggleShowDebug:k})=>{const J=(0,b.of)(T),z=(0,s.useMemo)(()=>H[K],[H,K]),Y=(0,s.useMemo)(()=>(0,s.createElement)(G.editor,{options:{...G.transformation.defaultOptions,...z.transformation.options},input:U,onChange:X=>{_(K,{...z.transformation,options:X})}}),[G.editor,G.transformation.defaultOptions,z.transformation,U,_,K]);return(0,n.jsxs)("div",{"data-testid":m.Tp.components.TransformTab.transformationEditor(G.name),children:[Y,V&&(0,n.jsx)(E._,{title:(0,p.t)("dashboard.transformation-editor.title-debug-transformation","Debug transformation"),subtitle:G.name,onClose:k,children:(0,n.jsxs)("div",{className:J.debugWrapper,"data-testid":m.Tp.components.TransformTab.transformationEditorDebugger(G.name),children:[(0,n.jsxs)("div",{className:J.debug,children:[(0,n.jsx)("div",{className:J.debugTitle,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.transformation-editor.input-data",children:"Input data"})}),(0,n.jsx)("div",{className:J.debugJson,children:(0,n.jsx)(D.B,{json:U})})]}),(0,n.jsx)("div",{className:J.debugSeparator,children:(0,n.jsx)(C.I,{name:"arrow-right"})}),(0,n.jsxs)("div",{className:J.debug,children:[(0,n.jsx)("div",{className:J.debugTitle,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.transformation-editor.output-data",children:"Output data"})}),(0,n.jsx)("div",{className:J.debugJson,children:F&&(0,n.jsx)(D.B,{json:F})})]})]})})]})},T=U=>({debugWrapper:(0,u.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,u.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${U.spacing(.5)}`,color:U.colors.primary.text}),debugTitle:(0,u.css)({padding:`${U.spacing(1)} ${U.spacing(.25)}`,fontFamily:U.typography.fontFamilyMonospace,fontSize:U.typography.bodySmall.fontSize,color:U.colors.text.primary,borderBottom:`1px solid ${U.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,u.css)({marginTop:U.spacing(1),padding:`0 ${U.spacing(1,1,1)}`,border:`1px solid ${U.colors.border.weak}`,background:`${U.isLight?U.v1.palette.white:U.v1.palette.gray05}`,borderRadius:U.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,u.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:U.spacing(.5)})});var O=e(68805),I=e(84510);const j=({isOpen:U,onCloseClick:F,transformer:V})=>{const{transformation:{name:K},help:G}=V,H=G||(0,I.$n)(),_=(0,n.jsx)(E._,{title:K,subtitle:"Transformation help",onClose:()=>F(!1),children:(0,n.jsx)(O.j,{markdown:H,styleOverrides:{borderTop:"2px solid"}})});return U?_:null};var W=e(739),B=e(37386),S=e(18857),w=e(42240);const N=({index:U,annotations:F,config:V,onChange:K,data:G})=>{const H=(0,b.of)(M),_=(0,s.useMemo)(()=>({context:{data:G},showTopic:!0,showFilter:V.topic!==W.QR.Annotations,source:[{value:W.QR.Series,label:"Query and Transformation results"},{value:W.QR.Annotations,label:"Annotation data"}]}),[G,F?.length,V.topic]);return(0,n.jsx)("div",{className:H.wrapper,children:(0,n.jsx)(B.D,{label:(0,p.t)("dashboard.transformation-filter.label-apply-transformation-to","Apply transformation to"),children:(0,n.jsxs)(n.Fragment,{children:[_.showTopic&&(0,n.jsx)(S.l6,{isClearable:!0,options:_.source,value:_.source.find(k=>k.value===V.topic),placeholder:_.source[0].label,className:H.padded,onChange:k=>{K(U,{...V,topic:k?.value})}}),_.showFilter&&(0,n.jsx)(w.M,{value:V.filter,context:_.context,onChange:k=>K(U,{...V,filter:k})})]})})})},M=U=>{const F=U.shape.radius.default;return{wrapper:(0,u.css)({padding:U.spacing(2),border:`2px solid ${U.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${F} ${F}`,position:"relative",top:"-4px"}),padded:(0,u.css)({marginBottom:U.spacing(1)})}},L=({onRemove:U,index:F,id:V,data:K,configs:G,uiConfig:H,onChange:_})=>{const[k,J]=(0,l.A)(!1),[z,Y]=(0,l.A)(!1),[X,Q]=(0,l.A)(!1),q=!!G[F].transformation.disabled,te=G[F].transformation.topic,ne=G[F].transformation.filter!=null||te!=null,se=ne||K.series.length>0||(K.annotations?.length??0)>0,[ue,de]=(0,s.useState)([]),[ie,he]=(0,s.useState)([]),[me,ce]=(0,s.useState)([]),Pe=(0,s.useCallback)(Te=>{const Ge=G[Te].transformation;_(Te,{...Ge,disabled:Ge.disabled?void 0:!0})},[_,G]),Ie=(0,s.useCallback)(()=>{let Te={...G[F].transformation};Te.filter?delete Te.filter:Te.filter={id:d.jR.byRefId,options:""},_(F,Te)},[_,F,G]),Se=(0,s.useCallback)((Te,Ge,Qe)=>tt=>{let ke="panel_editor_tabs_transformations_toggle";x.Ay.featureToggles.transformationsRedesign&&(ke="transformations_redesign_"+ke),(0,h.rR)(ke,{action:Qe?"off":"on",toggleId:Ge,transformationId:G[F].transformation.id}),Te(tt)},[G,F]);(0,s.useEffect)(()=>{const Te=G[F].transformation,Ge=Te.filter?.options?(0,i.Dq)(Te.filter):void 0,Qe=F-1;let tt=[],ke=[];Qe>=0&&(tt=G.slice(0,Qe).map(We=>We.transformation),ke=G.slice(Qe,F).map(We=>We.transformation));const He=G.slice(0,F).map(We=>We.transformation),Re=G.slice(F,F+1).map(We=>We.transformation),Ne={interpolate:We=>(0,r.w)().replace(We)},Ae=(0,c.m)(He,K.series,Ne).subscribe(We=>{Ge&&(We=We.filter(_e=>Ge(_e))),de(We)}),Ue=(0,c.m)(He,K.series,Ne).pipe((0,o.Z)(We=>(0,c.m)(Re,We,Ne))).subscribe(he),Be=(0,c.m)(tt,K.series,Ne).pipe((0,o.Z)(We=>(0,c.m)(ke,We,Ne))).subscribe(ce);return function(){Ae.unsubscribe(),Ue.unsubscribe(),Be.unsubscribe()}},[F,K,G]);const Me=()=>(0,n.jsxs)(n.Fragment,{children:[H.state&&(0,n.jsx)(f.p,{state:H.state}),(0,n.jsx)(y.A,{title:(0,p.t)("dashboard.transformation-operation-row.render-actions.title-show-transform-help","Show transform help"),icon:"info-circle",onClick:Se(Q,"help",X),active:X}),se&&(0,n.jsx)(y.A,{title:(0,p.t)("dashboard.transformation-operation-row.render-actions.title-filter","Filter"),icon:"filter",onClick:Se(Ie,"filter",ne),active:ne}),(0,n.jsx)(y.A,{title:(0,p.t)("dashboard.transformation-operation-row.render-actions.title-debug","Debug"),icon:"bug",onClick:Se(Y,"debug",z),active:z}),(0,n.jsx)(y.A,{title:(0,p.t)("dashboard.transformation-operation-row.render-actions.title-disable-transformation","Disable transformation"),icon:q?"eye-slash":"eye",onClick:Se(()=>Pe(F),"disabled",q),active:q,dataTestId:m.Tp.components.Transforms.disableTransformationButton}),(0,n.jsx)(y.q,{title:(0,p.t)("dashboard.transformation-operation-row.render-actions.title-remove","Remove"),icon:"trash-alt",onClick:()=>x.Ay.featureToggles.transformationsRedesign?J(!0):U(F)}),x.Ay.featureToggles.transformationsRedesign&&(0,n.jsx)(g.u,{isOpen:k,title:(0,p.t)("dashboard.transformation-operation-row.title-delete","Delete {{name}}?",{name:H.name}),body:(0,p.t)("dashboard.transformation-operation-row.body-delete","Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen."),confirmText:(0,p.t)("dashboard.transformation-operation-row.render-actions.confirmText-delete","Delete"),onConfirm:()=>{J(!1),U(F)},onDismiss:()=>J(!1)})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(v.u,{id:V,index:F,title:`${F+1} - ${H.name}`,draggable:!0,actions:Me,disabled:q,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[ne&&(0,n.jsx)(N,{data:me,index:F,config:G[F].transformation,annotations:K.annotations,onChange:_}),(0,n.jsx)(P,{input:ue,output:ie,debugMode:z,index:F,configs:G,uiConfig:H,onChange:_,toggleShowDebug:Y})]}),(0,n.jsx)(j,{transformer:H,isOpen:X,onCloseClick:Q})]})},A=({data:U,onChange:F,onRemove:V,configs:K})=>(0,n.jsx)(n.Fragment,{children:K.map((G,H)=>{const _=a.h.getIfExists(G.transformation.id);return _?(0,n.jsx)(L,{index:H,id:`${G.id}`,data:U,configs:K,uiConfig:_,onRemove:V,onChange:F},`${G.id}`):null})})},9284:(Z,R,e)=>{"use strict";e.d(R,{R:()=>C});var n=e(74848),a=e(22803),s=e(96540),l=e(79319),o=e(64761),d=e(8642),i=e(51898),c=e(92745),m=e(63142),p=e(8207),h=e(63527),r=e(21285),g=e(34343),y=e(8073),v=e(76319),x=e(65642),f=e(85622),u=e(72598);const D=[["viewAll","View all"],...Object.entries(u.eJ)];function C(B){const S=(0,m.of)(P),{suffix:w,xforms:N,search:M,onSearchChange:L,onSearchKeyDown:A,showIllustrations:U,onTransformationAdd:F,selectedFilter:V,data:K,onClose:G,onShowIllustrationsChange:H,onSelectedFilterChange:_}=B,k=(0,s.useCallback)(J=>{J?.click()},[]);return(0,n.jsxs)(p._,{size:"md",onClose:()=>{G&&G()},title:(0,c.t)("dashboard.transformation-picker-ng.title-add-another-transformation","Add another transformation"),children:[(0,n.jsxs)("div",{className:S.searchWrapper,children:[(0,n.jsx)(h.p,{"data-testid":i.Tp.components.Transforms.searchInput,className:S.searchInput,value:M??"",placeholder:(0,c.t)("dashboard.transformation-picker-ng.placeholder-search-for-transformation","Search for transformation"),onChange:L,onKeyDown:A,suffix:w,ref:k,autoFocus:!0}),(0,n.jsxs)("div",{className:S.showImages,children:[(0,n.jsx)("span",{className:S.illustationSwitchLabel,children:(0,n.jsx)(c.x6,{i18nKey:"dashboard.transformation-picker-ng.show-images",children:"Show images"})})," ",(0,n.jsx)(r.d,{value:U,onChange:()=>H&&H(!U)})]})]}),(0,n.jsx)("div",{className:S.filterWrapper,children:D.map(([J,z])=>(0,n.jsx)(g.m,{onClick:()=>_&&_(J),label:z,selected:V===J},J))}),(0,n.jsx)(T,{showIllustrations:U,transformations:N,data:K,onClick:J=>{F({value:J})}})]})}function P(B){return{showImages:(0,a.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,a.css)({fontSize:"16px",marginBottom:`${B.spacing(2)}`}),pickerInformationLineHighlight:(0,a.css)({verticalAlign:"middle"}),searchWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,a.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,a.css)({whiteSpace:"nowrap"}),filterWrapper:(0,a.css)({padding:`${B.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${B.spacing(1)}`,columnGap:`${B.spacing(.5)}`})}}function T({showIllustrations:B,transformations:S,onClick:w,data:N}){const M=(0,m.of)(O);return(0,n.jsx)("div",{className:M.grid,children:S.map(L=>{let A=l.M.Applicable;L.transformation.isApplicable!==void 0&&(A=L.transformation.isApplicable(N));const U=A>0;let F=null;L.transformation.isApplicableDescription!==void 0&&(typeof L.transformation.isApplicableDescription=="function"?F=L.transformation.isApplicableDescription(N):F=L.transformation.isApplicableDescription);let V=M.newCard;return U||(V=(0,a.cx)(M.newCard,M.cardDisabled)),(0,n.jsxs)(y.Z,{className:V,"data-testid":i.Tp.components.TransformTab.newTransform(L.name),onClick:()=>w(L.id),children:[(0,n.jsxs)(y.Z.Heading,{className:M.heading,children:[(0,n.jsx)("span",{children:L.name}),(0,n.jsx)("span",{className:M.pluginStateInfoWrapper,children:(0,n.jsx)(f.p,{state:L.state})})]}),(0,n.jsxs)(y.Z.Description,{className:M.description,children:[(0,n.jsx)("span",{children:W(L.id)}),B&&(0,n.jsx)("span",{children:(0,n.jsx)("img",{className:M.image,src:I(L.id,!U),alt:L.name})}),!U&&F!==null&&(0,n.jsx)(v.K,{className:M.cardApplicableInfo,name:"info-circle",tooltip:F})]})]},L.id)})})}function O(B){return{heading:(0,a.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,a.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,a.css)({display:"block",maxEidth:"100%`",marginTop:`${B.spacing(2)}`}),grid:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${B.spacing(2)} ${B.spacing(1)}`,width:"100%"}),cardDisabled:(0,a.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${B.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,a.css)({position:"absolute",bottom:`${B.spacing(1)}`,right:`${B.spacing(1)}`}),newCard:(0,a.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,a.css)({marginLeft:"5px"})}}const I=(B,S)=>`public/build/img/transformations/${x.Ay.theme2.isDark?"dark":"light"}/${B}.svg`,j={[o.F.concatenate]:"Combine all fields into a single frame.",[o.F.configFromData]:"Set unit, min, max and more.",[o.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[o.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[o.F.filterByRefId]:"Remove rows from the data based on origin query",[o.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[o.F.groupBy]:"Group data by a field value and create aggregate data.",[o.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[o.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[o.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[o.F.merge]:"Merge multiple series. Values will be combined into one row.",[o.F.organize]:"Re-order, hide, or rename fields.",[o.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[o.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[o.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[o.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[o.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},W=B=>j[B]||d.h.getIfExists(B)?.description||""},34176:(Z,R,e)=>{"use strict";e.d(R,{o:()=>V,e:()=>U});var n=e(74848),a=e(89332),s=e(96540),l=e(8642),o=e(51898),d=e(92745),i=e(27489),c=e(76319),m=e(45861),p=e(71599),h=e(93256),r=e(92807),g=e(32881),y=e(63142),v=e(65642),x=e(80849),f=e(36490),u=e(41654),b=e(62667);function E({message:K}){const G=(0,s.useCallback)(()=>{f.Ny.partial({tab:b.M8.Query})},[]);return(0,n.jsx)("div",{style:{marginTop:"100px"},children:(0,n.jsx)(u.B,{direction:"row",justifyContent:"center",children:(0,n.jsxs)(u.B,{direction:"column",gap:2,children:[(0,n.jsx)("h2",{children:K}),(0,n.jsx)("div",{children:(0,n.jsx)(m.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:G,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.panel-not-supported.go-back-to-queries",children:"Go back to Queries"})})})]})})})}var D=e(47350),C=e(22803),P=e(28882),T=e(34999),O=e(63527),I=e(8073),j=e(36321);const W={[P.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[P.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[P.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},B=K=>W[K];var S=e(85622);const w="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function N(K){const{noTransforms:G,search:H,xforms:_,onSearchChange:k,onSearchKeyDown:J,onTransformationAdd:z,suffix:Y}=K;return(0,n.jsxs)(g.gW,{children:[G&&(0,n.jsx)(g.mc,{grow:1,children:(0,n.jsx)(j.b,{storageKey:w,defaultValue:!1,children:(X,Q)=>X?null:(0,n.jsxs)(T.F,{title:(0,d.t)("dashboard.transformation-picker.title-transformations","Transformations"),severity:"info",onRemove:()=>{Q(!0)},children:[(0,n.jsxs)("p",{children:[(0,n.jsx)(d.x6,{i18nKey:"dashboard.transformation-picker.info",children:"Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized."}),(0,n.jsx)("br",{}),(0,n.jsx)(d.x6,{i18nKey:"dashboard.transformation-picker.info-graph-not-suitable",children:"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data."}),(0,n.jsx)("br",{}),(0,n.jsxs)(d.x6,{i18nKey:"dashboard.transformation-picker.info-switch-to-table",children:["It can help to switch to the Table visualization to understand what a transformation is doing."," "]})]}),(0,n.jsx)("a",{href:B(P.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.transformation-picker.read-more",children:"Read more"})})]})})}),(0,n.jsx)(O.p,{"data-testid":o.Tp.components.Transforms.searchInput,value:H??"",autoFocus:!G,placeholder:(0,d.t)("dashboard.transformation-picker.placeholder-search-for-transformation","Search for transformation"),onChange:k,onKeyDown:J,suffix:Y}),_.map(X=>(0,n.jsx)(M,{transform:X,onClick:()=>{z({value:X.id})}},X.name))]})}function M({transform:K,onClick:G}){const H=(0,y.of)(L);return(0,n.jsxs)(I.Z,{className:H.card,"data-testid":o.Tp.components.TransformTab.newTransform(K.name),onClick:G,children:[(0,n.jsx)(I.Z.Heading,{children:K.name}),(0,n.jsx)(I.Z.Description,{children:K.description}),K.state&&(0,n.jsx)(I.Z.Tags,{children:(0,n.jsx)(S.p,{state:K.state})})]})}function L(K){return{card:(0,C.css)({margin:"0",padding:`${K.spacing(1)}`})}}var A=e(9284);const U="viewAll";class F extends s.PureComponent{constructor(G){super(G),this.onSearchChange=k=>{this.setState({search:k.target.value})},this.onSearchKeyDown=k=>{if(k.key==="Enter"){const{search:J}=this.state;if(J){const z=J.toLowerCase(),Y=l.h.list().filter(X=>(X.name+X.description).toLowerCase().indexOf(z)>=0);Y.length>0&&this.onTransformationAdd({value:Y[0].id})}}else k.keyCode===27&&(this.setState({search:"",showPicker:!1}),k.stopPropagation())},this.getTransformationNextId=k=>{const{transformations:J}=this.state;let z=0;const Y=J.filter(X=>X.id.startsWith(k)).map(X=>X.id);return Y.length!==0&&(z=Math.max(...Y.map(X=>parseInt(X.match(/\d+/)[0],10)))+1),`${k}-${z}`},this.onTransformationAdd=k=>{let J="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(J="transformations_redesign_"+J),(0,i.rR)(J,{action:"add",transformationId:k.value});const{transformations:z}=this.state,Y=this.getTransformationNextId(k.value);this.setState({search:"",showPicker:!1}),this.onChange([...z,{id:Y,transformation:{id:k.value,options:{}}}])},this.onTransformationChange=(k,J)=>{const{transformations:z}=this.state,Y=Array.from(z);let X="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(X="transformations_redesign_"+X),(0,i.rR)(X,{action:"change",transformationId:Y[k].transformation.id}),Y[k].transformation=J,this.onChange(Y)},this.onTransformationRemove=k=>{const{transformations:J}=this.state,z=Array.from(J);let Y="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(Y="transformations_redesign_"+Y),(0,i.rR)(Y,{action:"remove",transformationId:z[k].transformation.id}),z.splice(k,1),this.onChange(z)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=k=>{const{transformations:J}=this.state;if(!k||!k.destination)return;const z=k.source.index,Y=k.destination.index;if(z===Y)return;const X=Array.from(J),[Q]=X.splice(z,1);X.splice(Y,0,Q),this.onChange(X)},this.renderEmptyMessage=()=>(0,n.jsx)(x.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:k,transformations:J}=this.state;return(0,n.jsx)(a.JY,{onDragEnd:this.onDragEnd,children:(0,n.jsx)(a.gL,{droppableId:"transformations-list",direction:"vertical",children:z=>(0,n.jsxs)("div",{ref:z.innerRef,...z.droppableProps,children:[(0,n.jsx)(D.A,{configs:J,data:k,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),z.placeholder]})})})};const H=G.panel.transformations||[],_=this.buildTransformationIds(H);this.state={transformations:H.map((k,J)=>({transformation:k,id:_[J]})),data:{series:[]},search:"",selectedFilter:U,showIllustrations:!0},this.ref=(0,s.createRef)()}buildTransformationIds(G){const H={},_=[];for(let k=0;k<G.length;k++){const J=G[k];H[J.id]===void 0?H[J.id]=0:H[J.id]+=1,_.push(`${G[k].id}-${H[G[k].id]}`)}return _}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:G=>this.setState({data:G})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(G,H){if(v.Ay.featureToggles.transformationsRedesign){const k=!(H.transformations.length>0)||H.showPicker,z=!(this.state.transformations.length>0)||this.state.showPicker;if(k!==z){const Y=Math.random()/2;this.setState({scrollTop:z?Y:Number.MAX_SAFE_INTEGER})}}H.scrollTop!==this.state.scrollTop&&this.ref.current?.scrollTo({top:this.state.scrollTop})}onChange(G){this.setState({transformations:G}),this.props.panel.setTransformations(G.map(H=>H.transformation))}renderTransformsPicker(){let{showPicker:G}=this.state;const{transformations:H,search:_}=this.state,{transformationsRedesign:k}=v.Ay.featureToggles,J=!H?.length,z=H.length>0;let Y=null,X=l.h.list().sort((ne,se)=>ne.name>se.name?1:se.name>ne.name?-1:0);if(!k&&J&&(G=!0),this.state.selectedFilter!==U&&(X=X.filter(ne=>ne.categories&&this.state.selectedFilter&&ne.categories.has(this.state.selectedFilter))),_){const ne=_.toLowerCase(),se=X.filter(ue=>(ue.name+ue.description).toLowerCase().indexOf(ne)>=0);Y=(0,n.jsxs)(n.Fragment,{children:[se.length," / ",X.length," \xA0\xA0",(0,n.jsx)(c.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:(0,d.t)("dashboard.un-themed-transformations-editor.tooltip-clear-search","Clear search")})]}),X=se}!Y&&G&&!J&&(Y=(0,n.jsx)(c.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:(0,d.t)("dashboard.un-themed-transformations-editor.tooltip-close-picker","Close picker")}));let Q=null,q=null;k?(Q=(0,n.jsx)(A.R,{noTransforms:J,search:_,suffix:Y,xforms:X,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:ne=>this.setState({selectedFilter:ne}),onShowIllustrationsChange:ne=>this.setState({showIllustrations:ne}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),q=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.un-themed-transformations-editor.delete-all-transformations",children:"Delete all transformations"})}),(0,n.jsx)(p.u,{isOpen:!!this.state.showRemoveAllModal,title:(0,d.t)("dashboard.un-themed-transformations-editor.title-delete-all-transformations","Delete all transformations?"),body:(0,d.t)("dashboard.un-theme-transformations-editor.body-delete-all-transformations","By deleting all transformations, you will go back to the main selection screen."),confirmText:(0,d.t)("dashboard.un-themed-transformations-editor.confirmText-delete-all","Delete all"),onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):Q=(0,n.jsx)(N,{noTransforms:J,search:_,suffix:Y,xforms:X,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const te=(0,n.jsxs)(h.e,{children:[(0,n.jsx)(m.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":o.Tp.components.Transforms.addTransformationButton,children:(0,n.jsx)(d.x6,{i18nKey:"dashboard.un-themed-transformations-editor.actions.add-another-transformation",children:"Add another transformation"})}),q]});return(0,n.jsxs)(n.Fragment,{children:[G&&Q,k&&z&&te||!k&&!G&&z&&te]})}render(){const{panel:{alert:G}}=this.props,{transformations:H}=this.state,_=H.length>0;if(G){const k=_?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,n.jsx)(E,{message:k})}return(0,n.jsx)(r.P,{ref:this.ref,minHeight:"100%",children:(0,n.jsx)(g.mc,{padding:"lg",children:(0,n.jsxs)("div",{"data-testid":o.Tp.components.TransformTab.content,children:[!_&&v.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),_&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const V=(0,y.SL)(F)},84403:(Z,R,e)=>{"use strict";e.d(R,{A:()=>u});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(36490),d=e(63142),i=e(41654),c=e(31286),m=e(66404),p=e(45861),h=e(77731),r=e(89451),g=e(72746),y=e(23289),v=e(52763),x=e(37918);const u=({dashboard:E,canCreate:D})=>{const C=(0,d.of)(b),P=(0,v.wA)(),T=(0,v.d4)(W=>W.dashboard.initialDatasource),O=()=>{let W;if(E instanceof g.H$){const B=E.onCreateNewPanel();E.setState({editPanel:(0,r.L)(B,!0)}),o.Ny.partial({firstPanel:!0})}else W=(0,h.OK)(E,T),P((0,x.Ub)(void 0)),o.Ny.partial({editPanel:W,firstPanel:!0});y.c.emptyDashboardButtonClicked({item:"add_visualization"})},I=()=>{y.c.emptyDashboardButtonClicked({item:"import_from_library"}),E instanceof g.H$?E.onShowAddLibraryPanelDrawer():(0,h.s3)(E)},j=E instanceof g.H$&&E.isManagedRepository();return(0,n.jsx)(i.B,{alignItems:"center",justifyContent:"center",children:(0,n.jsx)("div",{className:C.wrapper,children:(0,n.jsxs)(i.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,n.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,n.jsxs)(i.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(m.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,n.jsx)(c.a,{marginBottom:2,paddingX:4,children:(0,n.jsx)(m.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,n.jsx)(p.$n,{size:"lg",icon:"plus","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:O,disabled:!D,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,n.jsxs)(i.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[(0,n.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(m.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,n.jsx)(c.a,{marginBottom:2,children:(0,n.jsx)(m.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,n.jsx)(p.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:I,disabled:!D||j,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,n.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(m.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,n.jsx)(c.a,{marginBottom:2,children:(0,n.jsx)(m.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsxs)(l.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,n.jsx)(p.$n,{icon:"upload",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{y.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,h.VF)()},disabled:!D,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function b(E){return{wrapper:(0,a.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:E.spacing.gridSize*4,paddingTop:E.spacing(2),[E.breakpoints.up("sm")]:{paddingTop:E.spacing(12)}})}}},46429:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>r});var n=e(74848),a=e(96540),s=e(36490),l=e(22803),o=e(63142),d=e(7895),i=e(30703),c=e(45967),m=e(35484);const p=({notice:g,onClick:y})=>{const v=(0,o.of)(h),x=g.severity==="error"||g.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return g.inspect&&y?(0,n.jsx)(d.I,{className:v.notice,icon:x,iconSize:"md",tooltip:g.text,onClick:f=>y(f,g.inspect)},g.severity):g.link?(0,n.jsx)("a",{className:v.notice,"aria-label":g.text,href:g.link,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(i.I,{name:x,style:{marginRight:"8px"},size:"md"})}):(0,n.jsx)(c.m,{content:g.text,children:(0,n.jsx)("span",{className:v.iconTooltip,children:(0,n.jsx)(i.I,{name:x,size:"md"})})},g.severity)},h=g=>({notice:(0,l.css)({background:"inherit",border:"none",borderRadius:g.shape.radius.default}),iconTooltip:(0,l.css)({color:`${g.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${g.shape.radius.default}`,padding:`${g.spacing(0,1)}`,height:` ${g.spacing(g.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,m.getFocusStyles)(g),zIndex:1},"&: focus:not(:focus-visible)":(0,m.getMouseFocusStyles)(g),"&:hover ":{boxShadow:`${g.shadows.z1}`,color:`${g.colors.text.primary}`,background:`${g.colors.background.secondary}`}})}),r=({frames:g,panelId:y})=>{const v=(0,a.useCallback)((f,u)=>{f.stopPropagation(),s.Ny.partial({inspect:y,inspectTab:u})},[y]),x={};for(const f of g)if(!(!f.meta||!f.meta.notices))for(const u of f.meta.notices)x[u.severity]=u;return(0,n.jsx)(n.Fragment,{children:Object.values(x).map(f=>(0,n.jsx)(p,{notice:f,onClick:v},f.severity))})}},78013:(Z,R,e)=>{"use strict";e.d(R,{M:()=>p});var n=e(83340),a=e(4575),s=e(57866),l=e(95004),o=e(16515),d=e(36638),i=e(49256);const c="hideSeriesFrom",m=(0,n.ZW)(c);function p(f,u,b,E){const{overrides:D}=b,C=f,P=D.findIndex(m);if(P<0){if(u===i.B.ToggleSelection){const B=h([C,...x(D,E)]);return{...b,overrides:[...b.overrides,B]}}const j=v(E,C),W=h(j);return{...b,overrides:[...b.overrides,W]}}const T=Array.from(D),[O]=T.splice(P,1);if(u===i.B.ToggleSelection){let j=g(O);const W=x(T,E);if(W.length>0&&(j=j.filter(S=>W.indexOf(S)<0)),j[0]===C&&j.length===1)return{...b,overrides:T};const B=h([C,...W]);return{...b,overrides:[...T,B]}}const I=r(O,C);return y(I,E)?{...b,overrides:T}:{...b,overrides:[...T,I]}}function h(f,u=a.PP.exclude,b){return b=b??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:c,matcher:{id:s.Ct.byNames,options:{mode:u,names:f,prefix:u===a.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...b,value:{viz:!0,legend:!1,tooltip:!1}}]}}const r=(f,u,b=a.PP.exclude)=>{const E=f.properties.find(P=>P.id==="custom.hideFrom"),D=g(f),C=D.findIndex(P=>P===u);return C<0?D.push(u):D.splice(C,1),h(D,b,E)},g=f=>{const u=f.matcher.options?.names;return Array.isArray(u)?[...u]:[]},y=(f,u)=>g(f).length===v(u).length,v=(f,u)=>{const b=new Set;for(const E of f)for(const D of E.fields){if(D.type!==l.PU.number)continue;const C=(0,o.Ct)(D,E,f);C!==u&&b.add(C)}return Array.from(b)},x=(f,u)=>{let b=[];for(const E of f){const D=E.properties.find(C=>C.id==="custom.hideFrom");if(D!==void 0&&D.value?.legend===!0){const P=d.sJ.get(E.matcher.id).get(E.matcher.options);for(const T of u)for(const O of T.fields){if(O.type!==l.PU.number)continue;const I=(0,o.Ct)(O,T,u);P(O,T,u)&&b.push(I)}}}return b}},4405:(Z,R,e)=>{"use strict";e.d(R,{a:()=>c});var n=e(49426),a=e(25229),s=e(33239);const l=100;class o{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new n.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const p=Date.now();this.budget=(p-this.lastUpdate)/l;const h=this.ok.getValue(),r=this.budget<=this.threshold;if(h!==r&&this.ok.next(r),this.lastUpdate=p,this.isLive&&this.ok.getValue()&&this.timeRange){let g;for(const y of this.listeners){if(!y.panel.props.isInView)continue;if(p-y.last>=y.intervalMs){if(!g){const{raw:x}=this.timeRange;g={raw:x,from:(0,a.KQ)(p-this.liveTimeOffset),to:(0,a.KQ)(p)}}y.panel.liveTimeChanged(g),y.last=p}}}}}setLiveTimeRange(p){if(this.timeRange=p,this.isLive=p?.raw?.to==="now",this.isLive){const h=s.parse(p.raw.from,!1)?.valueOf(),r=s.parse(p.raw.to,!0)?.valueOf();this.liveTimeOffset=r-h;for(const g of this.listeners)g.intervalMs=i(this.liveTimeOffset,g.panel.props.width)}}listen(p){this.listeners.push({last:this.lastUpdate,panel:p,intervalMs:i(6e4,p.props.width)})}remove(p){this.listeners=this.listeners.filter(h=>h.panel!==p)}updateInterval(p){if(!(!this.timeRange||!this.isLive)){for(const h of this.listeners)if(h.panel===p){h.intervalMs=i(this.liveTimeOffset,h.panel.props.width);return}}}}const d=5*60*1e3;function i(m,p){const h=Math.ceil(m/p/100)*100;return h>d?d:h}const c=new o;setInterval(c.measure,l)},48600:(Z,R,e)=>{"use strict";e.d(R,{np:()=>O,t0:()=>T});var n=e(34796),a=e.n(n),s=e(2543),l=e.n(s),o=e(95093),d=e.n(o),i=e(32899),c=e(33239),m=e(68143),p=e(36490),h=e(83873),r=e(67020),g=e(77197),y=e(41644),v=e(28998),x=e(73427),f=e(50803),u=e(13956),b=e(95407),E=e(22429),D=e(8735);class C{loadScriptedDashboard(W){const B="public/dashboards/"+W.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,m.AI)().get(B,void 0,void 0,{validatePath:!0}).then(this.executeScript.bind(this)).then(S=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:S.data}),S=>{throw console.error("Script dashboard error "+S),x.lE.emit(i.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),S})}executeScript(W){const B={dashboardSrv:(0,E.UA)(),datasourceSrv:(0,v.tR)()},w=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",W)(p.Ny.getSearchObject(),g.A,c,l(),d(),window,document,a(),a(),B);return(0,s.isFunction)(w)?new Promise(N=>{w(M=>{N({data:M})})}):{data:w}}}class P extends C{loadDashboard(W,B,S,w){const N=(0,y.sP)("v1");let M;if(W==="script"&&B)M=this.loadScriptedDashboard(B);else if(W==="snapshot"&&B)M=(0,D.s)().getSnapshot(B);else if(W==="public"&&S)M=h.IB.getPublicDashboardByUid(S).then(L=>L);else if(S){if(!w){const L=N.getDashboardFromCache(S);if(L)return Promise.resolve(L)}M=(0,u.n)("v1").getDashboardDTO(S,w).then(L=>L).catch(L=>{throw(0,m.NF)(L)&&!(L instanceof b.P)&&(console.error("Failed to load dashboard",L),L.isHandled=!0,L.status===404&&x.lE.emit(i.r1.alertError,["Dashboard not found"])),L})}else throw new Error("Dashboard uid or slug required");return M.then(L=>(r.A.addDashboardImpression(L.dashboard.uid),L)),M}loadSnapshot(W){const B=(0,D.s)().getSnapshot(W);return B.then(S=>(r.A.addDashboardImpression(S.dashboard.uid),S)),B}}class T extends C{loadDashboard(W,B,S,w){const N=(0,y.sP)("v2");let M;if(W==="script"&&B)M=this.loadScriptedDashboard(B).then(L=>f.Op.ensureV2Response(L));else if(W==="public"&&S)M=h.IB.getPublicDashboardByUid(S).then(L=>f.Op.ensureV2Response(L));else if(S){if(!w){const L=N.getDashboardFromCache(S);if(L)return Promise.resolve(L)}M=(0,u.n)("v2").getDashboardDTO(S,w).then(L=>L).catch(L=>{throw(0,m.NF)(L)&&!(L instanceof b.P)&&(console.error("Failed to load dashboard",L),L.isHandled=!0,L.status===404&&x.lE.emit(i.r1.alertError,["Dashboard not found"])),L})}else throw new Error("Dashboard uid or slug required");return M.then(L=>(r.A.addDashboardImpression(L.metadata.name),L)),M}loadSnapshot(W){const B=(0,D.s)().getSnapshot(W).then(S=>f.Op.ensureV2Response(S));return B.then(S=>(r.A.addDashboardImpression(S.metadata.name),S)),B}}let O=new P;const I=j=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},22429:(Z,R,e)=>{"use strict";e.d(R,{UA:()=>r});var n=e(32899),a=e(92745),s=e(45229),l=e(83873),o=e(13956),d=e(87745),i=e(7817),c=e(17097);class m{constructor(){this.onRemovePanel=y=>{const v=this.getCurrent();v&&(0,c.FC)(v,v.getPanelById(y),!0)},s.l.subscribe(d.Vz,y=>this.onRemovePanel(y.payload))}create(y,v){return new i.G(y,v)}setCurrent(y){this.dashboard=y}getCurrent(){return this.dashboard}saveJSONDashboard(y){const v=JSON.parse(y);return(0,o.n)().saveDashboard({dashboard:v,folderUid:this.dashboard?.meta.folderUid||v.folderUid,message:(0,a.t)("dashboard.dashboard-srv.message.edit-dashboard-json","Edit Dashboard JSON"),k8s:this.dashboard?.meta.k8s})}saveDashboard(y,v){return(0,o.n)().saveDashboard({message:y.message,folderUid:y.folderUid,dashboard:y.dashboard.getSaveModelClone(),showErrorAlert:v?.showErrorAlert})}starDashboard(y,v){const x=(0,l.AI)(),f={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+y,method:v?"DELETE":"POST"};return x.request(f).then(()=>{const u=!v;this.dashboard?.uid===y&&(this.dashboard.meta.isStarred=u);const b=u?(0,a.t)("notifications.starred-dashboard","Dashboard starred"):(0,a.t)("notifications.unstarred-dashboard","Dashboard unstarred");return s.l.emit(n.r1.alertSuccess,[b]),u})}}let p;function h(g){p=g}function r(){return p||(p=new m),p}},8735:(Z,R,e)=>{"use strict";e.d(R,{s:()=>m});var n=e(75505),a=e(81160),s=e(68143),l=e(43173),o=e(73427),d=e(85618);const i={create:p=>(0,s.AI)().post("/api/snapshots",p),getSnapshots:()=>(0,s.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,s.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:p=>(0,s.AI)().delete("/api/snapshots/"+p),getSnapshot:async p=>{try{const h=await(0,s.AI)().get("/api/snapshots/"+p);return h.meta.canShare=!1,h}catch(h){throw h}}};class c{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${(0,d.Ge)()}/dashboardsnapshots`}async create(h){return(0,s.AI)().post(this.url+"/create",h)}async getSnapshots(){return(await(0,s.AI)().get(this.url)).items.map(r=>({key:r.metadata.name,name:r.spec.title,external:r.spec.externalUrl!=null,externalUrl:r.spec.externalUrl}))}deleteSnapshot(h){return(0,s.AI)().delete(this.url+"/"+h)}async getSharingOptions(){return(0,s.AI)().get("/api/snapshot/shared-options")}async getSnapshot(h){const r={};if(!o.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const g=`??? TODO, get anon token for snapshots (${o.TP.user?.name}) ???`;r.Authorization=`Bearer ${g}`}return(0,n.s)((0,s.AI)().fetch({url:this.url+"/"+h+"/body",method:"GET",headers:r}).pipe((0,a.T)(g=>({dashboard:g.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function m(){return l.$.featureToggles.kubernetesSnapshots?new c:i}},75421:(Z,R,e)=>{"use strict";e.d(R,{jG:()=>D});var n=e(2543),a=e(25229),s=e(22592),l=e(17548),o=e(32899),d=e(33239),i=e(92745),c=e(36490),m=e(36674),p=e(45229),h=e(65642),r=e(15130),g=e(23237),y=e(90593),v=e(87745),x=e(90811);function f({urlRefresh:C,currentRefresh:P,isAllowedIntervalFn:T,minRefreshInterval:O,refreshIntervals:I=x.cb}){if(!C)return P;const j=T(C),W=I.find(B=>B===C);if(!j||!W){const B=O?I.find(w=>w===O):void 0,S=I?.length?I[0]:void 0;return B??S??P}return C||P}class u{constructor(P){this.contextSrv=P,this.timeRangeForUrl=()=>{const T=this.timeRange().raw;return(0,a.Ar)(T.from)&&(T.from=T.from.valueOf().toString()),(0,a.Ar)(T.to)&&(T.to=T.to.valueOf().toString()),T},this.time=(0,s.E2)().raw,this.timeAtLoad=(0,s.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),p.A.subscribe(v.U0,T=>{this.zoomOut(T.payload.scale,T.payload.updateUrl)}),p.A.subscribe(v.Io,T=>{this.shiftTime(T.payload.direction,T.payload.updateUrl)}),p.A.subscribe(v.Rh,T=>{this.makeAbsoluteTime(T.payload.updateUrl)}),p.A.subscribe(v.Bt,()=>{this.copyTimeRangeToClipboard()}),p.A.subscribe(v.VZ,T=>{this.pasteTimeRangeFromClipboard(T.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(P){this.timeModel=P,this.time=P.time,this.refresh=P.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,n.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(P){return this.contextSrv.getValidIntervals(P)}parseTime(){(0,n.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,a.KQ)(this.time.from).utc()),(0,n.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,a.KQ)(this.time.to).utc())}parseUrlParam(P,T){if(P.indexOf("now")!==-1)return P;if(P.length===8){const O=(0,a.yT)(P,"YYYYMMDD");if(O.isValid())return O}else if(P.length===15){const O=(0,a.yT)(P,"YYYYMMDDTHHmmss");if(O.isValid())return O}if(!isNaN(Number(P))){const O=parseInt(P,10);return T?(0,a.oZ)(T,O):(0,a.yT)(O)}return null}getTimeWindow(P,T){const O=parseInt(P,10);let I;return T.match(/^\d+$/)&&parseInt(T,10)?I=parseInt(T,10):I=l.intervalToMs(T),{from:(0,a.yT)(O-I/2),to:(0,a.yT)(O+I/2)}}initTimeFromUrl(){if(h.$W.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const P=c.Ny.getSearch();P.get("time")&&P.get("time.window")&&(this.time=this.getTimeWindow(P.get("time"),P.get("time.window")));const T=this.timeModel?.getTimezone();P.get("from")&&(this.time.from=this.parseUrlParam(P.get("from"),T)||this.time.from),P.get("to")&&(this.time.to=this.parseUrlParam(P.get("to"),T)||this.time.to),P.get("to")&&P.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=f({urlRefresh:P.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:h.$W.minRefreshInterval})}updateTimeRangeFromUrl(){const P=c.Ny.getSearch();if(P.get("left"))return;const T=this.timeRangeForUrl(),O=P.get("from"),I=P.get("to");O&&I?(O!==T.from||I!==T.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(P){this.timeModel&&(this.timeModel.refresh=P),this.stopAutoRefresh();const T=c.Ny.getSearchObject();if(!P){T.refresh&&c.Ny.partial({refresh:null},!0);return}let O=P,I=60*1e3;P===r.SM?I=this.getAutoRefreshInteval().intervalMs:(O=this.contextSrv.getValidInterval(P),I=l.intervalToMs(O)),this.refreshMS=I,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(I),this.refreshTimeModel()},I),T.refresh!==O&&c.Ny.partial({refresh:O},!0)}getAutoRefreshInteval(){const P=window?.innerWidth??2e3;return l.calculateInterval(this.timeRange(),P,h.$W.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(P){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(P),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},P)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(P,T=!0){if((0,n.extend)(this.time,P),(0,a.Ar)(P.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),T===!0){const O=this.timeRangeForUrl(),I=c.Ny.getSearchObject();if(I.from===O.from.toString()&&I.to===O.to.toString())return;I.from=O.from.toString(),I.to=O.to.toString(),c.Ny.partial(I)}this.timeModel?.refresh===r.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(r.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?m.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,y.z)(this.time,this.timeModel)}zoomOut(P,T=!0){const O=this.timeRange(),{from:I,to:j}=(0,g.Zk)(O,P);this.setTime({from:(0,a.yT)(I),to:(0,a.yT)(j)},T)}shiftTime(P,T=!0){const O=this.timeRange(),{from:I,to:j}=(0,g.Wb)(P,O);this.setTime({from:(0,a.yT)(I),to:(0,a.yT)(j)},T)}makeAbsoluteTime(P){const{from:T,to:O}=this.timeRange();this.setTime({from:T,to:O},P)}copyTimeRangeToClipboard(){const{raw:P}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:P.from,to:P.to})),p.A.emit(o.r1.alertSuccess,[(0,i.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(P=!0){const{range:T,isError:O}=await(0,g.zG)();if(O===!0){p.A.emit(o.r1.alertError,[(0,i.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,i.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:T})]);return}const{from:I,to:j}=T;this.setTime({from:I,to:j},P)}isRefreshOutsideThreshold(P,T=.05){const O=this.timeRange();if(d.isMathString(O.raw.from)){const I=O.to.diff(O.from),j=Date.now()-P,W=I*T;return j>=W}return!1}}let b;function E(C){b=C}function D(){return b||(b=new u(r.TP)),b}},65635:(Z,R,e)=>{"use strict";e.d(R,{O2:()=>A,SW:()=>U,og:()=>_});var n=e(2543),a=e(53543),s=e(3594),l=e(7389),o=e(48480),d=e(83175),i=e(38036),c=e(18600),m=e(36394),p=e(57866),h=e(95004),r=e(79184),g=e(33023),y=e(78282),v=e(739),x=e(74198),f=e(83162),u=e(65642),b=e(95943);function E(te){return Array.from(new Array(te+1),(ne,se)=>se).filter(ne=>te%ne===0)}var D=e(77197),C=e(28998),P=e(67933),T=e(78763),O=e(18615),I=e(71843),j=e(75663),W=e(39796),B=e(51515);function S(te,ne){const se=[];if(te?.statistics&&te?.statistics.length){te.statistic=te.statistics[0];for(const ue of te.statistics.splice(1))se.push({...te,statistic:ue})}for(const ue of se)ue.refId=(0,W.M)(ne),delete ue.statistics,ne.push(ue);return delete te.statistics,se}function w(te){const ne=[];if(te&&"statistics"in te&&te?.statistics?.length){for(const se of te.statistics.splice(1)){const{statistics:ue,name:de,...ie}=te;ne.push({...ie,statistic:se,name:`${de} - ${se}`})}te.statistic=te.statistics[0],ne.length!==0&&(te.name=`${te.name} - ${te.statistic}`),delete te.statistics}return ne}function N(te){te.hasOwnProperty("metricQueryType")||(te.metricQueryType=B.d$.Search),te.hasOwnProperty("metricEditorMode")||(te.metricQueryType===B.d$.Insights?te.metricEditorMode=B.Rx.Code:te.metricEditorMode=te.expression?B.Rx.Code:B.Rx.Builder)}var M=e(82612),L=e(56623);a.D.setInit(f.H),a.G.setInit(f.u);const A=41;class U{constructor(ne){this.dashboard=ne,(0,y.l)()||(0,y.h)(new C.xq)}updateSchema(ne){let se,ue,de,ie;const he=this.dashboard.schemaVersion,me=[];if(this.dashboard.schemaVersion=A,he!==this.dashboard.schemaVersion){if(he<2&&(ne.services&&ne.services.filter&&(this.dashboard.time=ne.services.filter.time,this.dashboard.templating.list=ne.services.filter.list||[]),me.push(ce=>(ce.type==="graphite"&&(ce.type="graph"),ce.type!=="graph"||((0,n.isBoolean)(ce.legend)&&(ce.legend={show:ce.legend}),ce.grid&&(ce.grid.min&&(ce.grid.leftMin=ce.grid.min,delete ce.grid.min),ce.grid.max&&(ce.grid.leftMax=ce.grid.max,delete ce.grid.max)),ce.y_format&&(ce.y_formats||(ce.y_formats=[]),ce.y_formats[0]=ce.y_format,delete ce.y_format),ce.y2_format&&(ce.y_formats||(ce.y_formats=[]),ce.y_formats[1]=ce.y2_format,delete ce.y2_format)),ce))),he<3){let ce=this.dashboard.getNextPanelId();me.push(Pe=>(Pe.id||(Pe.id=ce,ce+=1),Pe))}if(he<4&&me.push(ce=>(ce.type!=="graph"||((0,n.each)(ce.aliasYAxis,(Pe,Ie)=>{ce.seriesOverrides=[{alias:Ie,yaxis:Pe}]}),delete ce.aliasYAxis),ce)),he<6){const ce=(0,n.find)(ne.pulldowns,{type:"annotations"});for(ce&&(this.dashboard.annotations={list:ce.annotations||[]}),se=0;se<this.dashboard.templating.list.length;se++){const Pe=this.dashboard.templating.list[se];Pe.datasource===void 0&&(Pe.datasource=null),Pe.type==="filter"&&(Pe.type="query"),Pe.type===void 0&&(Pe.type="query"),Pe.allFormat===void 0&&delete Pe.allFormat}}if(he<7&&(ne.nav&&ne.nav.length&&(this.dashboard.timepicker=ne.nav[0]),me.push(ce=>((0,n.each)(ce.targets,Pe=>{Pe.refId||(Pe.refId=ce.getNextQueryLetter&&ce.getNextQueryLetter())}),ce))),he<8&&me.push(ce=>((0,n.each)(ce.targets,Pe=>{Pe.fields&&Pe.tags&&Pe.groupBy&&(Pe.rawQuery?(delete Pe.fields,delete Pe.fill):(Pe.select=(0,n.map)(Pe.fields,Ie=>{const Se=[];return Se.push({type:"field",params:[Ie.name]}),Se.push({type:Ie.func,params:[]}),Ie.mathExpr&&Se.push({type:"math",params:[Ie.mathExpr]}),Ie.asExpr&&Se.push({type:"alias",params:[Ie.asExpr]}),Se}),delete Pe.fields,(0,n.each)(Pe.groupBy,Ie=>{Ie.type==="time"&&Ie.interval&&(Ie.params=[Ie.interval],delete Ie.interval),Ie.type==="tag"&&Ie.key&&(Ie.params=[Ie.key],delete Ie.key)}),Pe.fill&&(Pe.groupBy.push({type:"fill",params:[Pe.fill]}),delete Pe.fill)))}),ce)),he<9&&me.push(ce=>{if(ce.type!=="singlestat"&&ce.thresholds!=="")return ce;if(ce.thresholds){const Pe=ce.thresholds.split(",");Pe.length>=3&&(Pe.shift(),ce.thresholds=Pe.join(","))}return ce}),he<10&&me.push(ce=>(ce.type!=="table"||(0,n.each)(ce.styles,Pe=>{if(Pe.thresholds&&Pe.thresholds.length>=3){const Ie=Pe.thresholds;Ie.shift(),Pe.thresholds=Ie}}),ce)),he<12&&(0,n.each)(this.dashboard.getVariables(),ce=>{"refresh"in ce&&(ce.refresh&&(ce.refresh=1),ce.refresh||(ce.refresh=0)),"hideVariable"in ce&&ce.hideVariable?ce.hide=2:"hideLabel"in ce&&ce.hideLabel&&(ce.hide=1)}),he<12&&me.push(ce=>(ce.type!=="graph"||!ce.grid||ce.yaxes||(ce.yaxes=[{show:ce["y-axis"],min:ce.grid.leftMin,max:ce.grid.leftMax,logBase:ce.grid.leftLogBase,format:ce.y_formats[0],label:ce.leftYAxisLabel},{show:ce["y-axis"],min:ce.grid.rightMin,max:ce.grid.rightMax,logBase:ce.grid.rightLogBase,format:ce.y_formats[1],label:ce.rightYAxisLabel}],ce.xaxis={show:ce["x-axis"]},delete ce.grid.leftMin,delete ce.grid.leftMax,delete ce.grid.leftLogBase,delete ce.grid.rightMin,delete ce.grid.rightMax,delete ce.grid.rightLogBase,delete ce.y_formats,delete ce.leftYAxisLabel,delete ce.rightYAxisLabel,delete ce["y-axis"],delete ce["x-axis"]),ce)),he<13&&me.push(ce=>{if(ce.type!=="graph"||!ce.grid)return ce;ce.thresholds||(ce.thresholds=[]);const Pe={},Ie={};return ce.grid.threshold1!==null&&(Pe.value=ce.grid.threshold1,ce.grid.thresholdLine?(Pe.line=!0,Pe.lineColor=ce.grid.threshold1Color,Pe.colorMode="custom"):(Pe.fill=!0,Pe.fillColor=ce.grid.threshold1Color,Pe.colorMode="custom")),ce.grid.threshold2!==null&&(Ie.value=ce.grid.threshold2,ce.grid.thresholdLine?(Ie.line=!0,Ie.lineColor=ce.grid.threshold2Color,Ie.colorMode="custom"):(Ie.fill=!0,Ie.fillColor=ce.grid.threshold2Color,Ie.colorMode="custom")),(0,n.isNumber)(Pe.value)&&((0,n.isNumber)(Ie.value)?Pe.value>Ie.value?(Pe.op=Ie.op="lt",ce.thresholds.push(Pe),ce.thresholds.push(Ie)):(Pe.op=Ie.op="gt",ce.thresholds.push(Pe),ce.thresholds.push(Ie)):(Pe.op="gt",ce.thresholds.push(Pe))),delete ce.grid.threshold1,delete ce.grid.threshold1Color,delete ce.grid.threshold2,delete ce.grid.threshold2Color,delete ce.grid.thresholdLine,ce}),he<14&&(this.dashboard.graphTooltip=ne.sharedCrosshair?1:0),he<16&&this.upgradeToGridLayout(ne),he<17&&me.push(ce=>{if(ce.minSpan){const Pe=b.cV/ce.minSpan,Ie=E(b.cV);ce.maxPerRow=Ie[(0,n.findIndex)(Ie,Se=>Se>Pe)-1]}return delete ce.minSpan,ce}),he<18&&me.push(ce=>(ce["options-gauge"]&&(ce.options=ce["options-gauge"],ce.options.valueOptions={unit:ce.options.unit,stat:ce.options.stat,decimals:ce.options.decimals,prefix:ce.options.prefix,suffix:ce.options.suffix},ce.options.thresholds&&ce.options.thresholds.reverse(),delete ce.options.options,delete ce.options.unit,delete ce.options.stat,delete ce.options.decimals,delete ce.options.prefix,delete ce.options.suffix,delete ce["options-gauge"]),ce)),he<19&&me.push(ce=>(ce.links&&(0,n.isArray)(ce.links)&&(ce.links=ce.links.map(K)),ce)),he<20){const ce=Pe=>({...Pe,url:G(Pe.url)});me.push(Pe=>(Pe.options&&Pe.options.dataLinks&&(0,n.isArray)(Pe.options.dataLinks)&&(Pe.options.dataLinks=Pe.options.dataLinks.map(ce)),Pe.options&&Pe.options.fieldOptions&&Pe.options.fieldOptions.defaults&&(Pe.options.fieldOptions.defaults.links&&(0,n.isArray)(Pe.options.fieldOptions.defaults.links)&&(Pe.options.fieldOptions.defaults.links=Pe.options.fieldOptions.defaults.links.map(ce)),Pe.options.fieldOptions.defaults.title&&(Pe.options.fieldOptions.defaults.title=G(Pe.options.fieldOptions.defaults.title))),Pe))}if(he<21){const ce=Pe=>({...Pe,url:Pe.url.replace(/__series.labels/g,"__field.labels")});me.push(Pe=>(Pe.options&&Pe.options.dataLinks&&(0,n.isArray)(Pe.options.dataLinks)&&(Pe.options.dataLinks=Pe.options.dataLinks.map(ce)),Pe.options&&Pe.options.fieldOptions&&Pe.options.fieldOptions.defaults&&Pe.options.fieldOptions.defaults.links&&(0,n.isArray)(Pe.options.fieldOptions.defaults.links)&&(Pe.options.fieldOptions.defaults.links=Pe.options.fieldOptions.defaults.links.map(ce)),Pe))}if(he<22&&me.push(ce=>(ce.type!=="table"||(0,n.each)(ce.styles,Pe=>{Pe.align="auto"}),ce)),he<23)for(const ce of this.dashboard.templating.list){if(!(0,P.iv)(ce))continue;const{multi:Pe,current:Ie}=ce;(0,s.R)(Ie)||(ce.current=(0,T.C)(Ie,Pe))}if(he<24&&me.push(ce=>{const Pe=ce.type==="table";if(Pe&&!ce.styles)return ce;const Ie=ce.table==="table2";if(!Pe||Ie)return ce;if(ce.type=Pe?"table-old":"table",ce.type==="table-old"){const Se=(0,L.p)(ce);Se&&(ce.autoMigrateFrom=ce.type,ce.type=Se)}return ce}),he<25,he<26&&me.push(ce=>(ce.type==="text2"&&(ce.type="text",delete ce.options.angular),ce)),he<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(ce=>{if(!(0,P.VO)(ce))return ce;const Pe={...ce};return Pe.current={selected:!0,text:Pe.query??"",value:Pe.query??""},Pe.options=[Pe.current],Pe.hide===l.zL.dontHide||Pe.hide===l.zL.hideLabel?{...Pe,type:"textbox"}:Pe})),he<28){me.push(ce=>ce.type==="singlestat"?H(ce):ce);for(const ce of this.dashboard.templating.list)ce.tags&&delete ce.tags,ce.tagsQuery&&delete ce.tagsQuery,ce.tagValuesQuery&&delete ce.tagValuesQuery,ce.useTags&&delete ce.useTags}if(he<29)for(const ce of this.dashboard.templating.list)ce.type==="query"&&(ce.refresh!==1&&ce.refresh!==2&&(ce.refresh=1),ce.options?.length&&(ce.options=[]));if(he<30&&(me.push(J),me.push(Q)),he<31&&me.push(ce=>{if(ce.transformations){for(const Pe of ce.transformations)if(Pe.id===r.V.id)return k(ce,r.V.id,{id:g.o.id,options:{}})}return ce}),he<32,he<33&&me.push(ce=>{if(ce.datasource=_(ce.datasource,{returnDefaultAsNull:!0}),!ce.targets)return ce;for(const Pe of ce.targets){const Ie=_(Pe.datasource,{returnDefaultAsNull:!0});Ie!=null&&(Pe.datasource=Ie)}return ce}),he<34&&(me.push(ce=>(this.migrateCloudWatchQueries(ce),ce)),this.migrateCloudWatchAnnotationQuery()),he<35&&me.push(q),he<36){for(const Pe of this.dashboard.annotations.list)Pe.datasource=_(Pe.datasource,{returnDefaultAsNull:!1});const ce=(0,y.l)().getInstanceSettings(null);if(ce){for(const Pe of this.dashboard.templating.list)Pe.type==="query"&&Pe.datasource===null&&(Pe.datasource=(0,o.p$)(ce));me.push(Pe=>{if(Pe.targets){let Ie=!1;Pe.datasource==null&&Pe.targets.length>0&&(Pe.datasource=(0,o.p$)(ce),Ie=!0);for(const Se of Pe.targets)(Se.datasource==null||Se.datasource.uid==null)&&(Pe.datasource?.uid!==O.uv?Se.datasource={...Pe.datasource}:Se.datasource=_(Se.datasource,{returnDefaultAsNull:!1})),Ie&&Se.datasource?.uid!=="__expr__"&&(Pe.datasource=Se.datasource)}return Pe})}}if(he<37&&me.push(ce=>(ce.options?.legend&&typeof ce.options.legend=="object"&&(ce.options.legend.displayMode==="hidden"||ce.options.legend.showLegend===!1?(ce.options.legend.displayMode="list",ce.options.legend.showLegend=!1):ce.options.legend={...ce.options.legend,showLegend:!0}),ce)),he<38&&me.push(ce=>{if(ce.type==="table"&&ce.fieldConfig!==void 0){const Pe=ce.fieldConfig.defaults?.custom?.displayMode;if(Pe!==void 0&&(ce.fieldConfig.defaults.custom.cellOptions=(0,x.o7)(Pe),delete ce.fieldConfig.defaults.custom.displayMode),ce.fieldConfig?.overrides)for(const Ie of ce.fieldConfig.overrides)for(let Se=0;Se<(Ie.properties?.length||0);Se++){let Me=Ie.properties[Se].value;Ie.properties[Se].id==="custom.displayMode"&&(Ie.properties[Se].id="custom.cellOptions",Ie.properties[Se].value=(0,x.o7)(Me))}}return ce}),he<39&&me.push(ce=>(ce.transformations?.forEach(Pe=>{if(Pe.id==="timeSeriesTable"&&Pe.options!==void 0&&Pe.options.refIdToStat!==void 0){let Ie={};for(const[Se,Me]of Object.entries(Pe.options.refIdToStat)){let Te={};Te.stat=Me,Ie[Se]=Te}Pe.options=Ie}}),ce)),he<40&&typeof this.dashboard.refresh!="string"&&(this.dashboard.refresh=""),he<41&&"time_options"in this.dashboard.timepicker&&delete this.dashboard.timepicker.time_options,me.length!==0)for(ue=0;ue<this.dashboard.panels.length;ue++)for(de=0;de<me.length;de++){this.dashboard.panels[ue]=me[de].call(this,this.dashboard.panels[ue]);const ce=this.dashboard.panels[ue].panels;if(ce)for(ie=0;ie<ce.length;ie++)ce[ie]=me[de].call(this,ce[ie])}}}removeRepeatedPanels(){const ne=[];for(const se of this.dashboard.panels)se.repeatPanelId||se.repeatByRow||(se.type==="row"&&Array.isArray(se.panels)&&(se.panels=se.panels.filter(ue=>!ue.repeatPanelId)),ne.push(se));this.dashboard.panels=ne}migrateCloudWatchQueries(ne){for(const se of ne.targets||[])if(z(se)&&(N(se),se.hasOwnProperty("statistics"))){const ue=S(se,[...ne.targets]);for(const de of ue)ne.targets.push(de)}}migrateCloudWatchAnnotationQuery(){for(const ne of this.dashboard.annotations.list)if(Y(ne)){const se=w(ne);for(const ue of se)this.dashboard.annotations.list.push(ue)}}upgradeToGridLayout(ne){let se=0;const ue=b.cV/12;let ie=(0,n.max)((0,n.flattenDeep)((0,n.map)(ne.rows,me=>(0,n.map)(me.panels,"id"))))+1;if(!ne.rows)return;const he=(0,n.some)(ne.rows,me=>me.collapse||me.showTitle||me.repeat);for(const me of ne.rows){if(me.repeatIteration)continue;const ce=me.height||b.bJ,Pe=F(ce),Ie={};let Se;he&&(Ie.id=ie,Ie.type="row",Ie.title=me.title,Ie.collapsed=me.collapse,Ie.repeat=me.repeat,Ie.panels=[],Ie.gridPos={x:0,y:se,w:b.cV,h:Pe},Se=new M.a9(Ie),ie++,se++);const Me=new V(Pe,b.cV,se);for(const Te of me.panels){Te.span=Te.span||b.o9,Te.minSpan&&(Te.minSpan=Math.min(b.cV,b.cV/12*Te.minSpan));const Ge=Math.floor(Te.span)*ue,Qe=Te.height?F(Te.height):Pe,tt=Me.getPanelPosition(Qe,Ge);se=Me.yPos,Te.gridPos={x:tt.x,y:se+tt.y,w:Ge,h:Qe},Me.addPanel(Te.gridPos),delete Te.span,Se&&Ie.collapsed?Se.panels?.push(Te):this.dashboard.panels.push(new M.a9(Te))}Se&&this.dashboard.panels.push(Se),Se&&Ie.collapsed||(se+=Pe)}}}function F(te){return(0,n.isString)(te)&&(te=parseInt(te.replace("px",""),10)),te<b.cx&&(te=b.cx),Math.ceil(te/(b.sD+b.dU))}class V{constructor(ne,se=b.cV,ue=0){this.area=new Array(se).fill(0),this.yPos=ue,this.height=ne}reset(){this.area.fill(0)}addPanel(ne){for(let se=ne.x;se<ne.x+ne.w;se++)(!this.area[se]||ne.y+ne.h-this.yPos>this.area[se])&&(this.area[se]=ne.y+ne.h-this.yPos);return this.area}getPanelPosition(ne,se,ue=!1){let de,ie,he;for(let me=this.area.length-1;me>=0&&this.height-this.area[me]>0;me--)if(ie===void 0)ie=me;else if(me<this.area.length-1&&this.area[me]<=this.area[me+1])de=me;else break;if(de!==void 0&&ie!==void 0&&ie-de>=se-1){const me=(0,n.max)(this.area.slice(de));he={x:de,y:me}}else return ue?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(ne,se,!0));return he}}function K(te){let ne=te.url;return!ne&&te.dashboard&&(ne=`dashboard/db/${D.A.slugifyForUrl(te.dashboard)}`),!ne&&te.dashUri&&(ne=`dashboard/${te.dashUri}`),ne||(ne="/"),te.keepTime&&(ne=d.kM.appendQueryToUrl(ne,`$${i.c.keepTime}`)),te.includeVars&&(ne=d.kM.appendQueryToUrl(ne,`$${i.c.includeVars}`)),te.params&&(ne=d.kM.appendQueryToUrl(ne,te.params)),{url:ne,title:te.title,targetBlank:te.targetBlank}}function G(te){const ne=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return te.replace(ne,(se,ue,de,ie,he,me)=>ue?"__series.name":de?"${__series.name}":ie?"__value.time":he?"__field.name":me?"${__field.name}":se)}function H(te){if(u.$W.panels["grafana-singlestat-panel"])return te.type="grafana-singlestat-panel",te;let ne=!1;return te.changePlugin||(ne=!0,te=new M.a9(te)),te.plugin={angularPanelCtrl:{}},te.gauge?.show?(I.plugin.meta=u.$W.panels.gauge,te.changePlugin(I.plugin)):(j.plugin.meta=u.$W.panels.stat,te.changePlugin(j.plugin)),ne?te.getSaveModel():te}function _(te,ne){if(ne.returnDefaultAsNull&&(te==null||te==="default"))return null;if((0,o.fN)(te))return te;const se=(0,y.l)().getInstanceSettings(te);return se?(0,o.p$)(se):{uid:te||void 0}}function k(te,ne,se){if(te.transformations){const ue=[];for(const de of te.transformations)ue.push(de),de.id===ne&&ue.push({...se});te.transformations=ue}return te}function J(te){const ne=te.fieldConfig;if(!ne)return te;if(ne.defaults&&ne.defaults.mappings&&(ne.defaults.mappings=X(ne.defaults.mappings,ne.defaults.thresholds)),Array.isArray(ne.overrides))for(const se of ne.overrides)for(const ue of se.properties)ue.id==="mappings"&&(ue.value=X(ue.value));return te}function z(te){return te.hasOwnProperty("dimensions")&&te.hasOwnProperty("namespace")&&te.hasOwnProperty("region")&&te.hasOwnProperty("metricName")}function Y(te){return te.hasOwnProperty("dimensions")&&te.hasOwnProperty("namespace")&&te.hasOwnProperty("region")&&te.hasOwnProperty("prefixMatching")&&te.hasOwnProperty("statistics")}function X(te,ne){if(!te)return;const se={type:c.d.ValueToText,options:{}},ue=[];for(const de of te){if(de.type&&de.options){de.type===c.d.ValueToText?se.options={...se.options,...de.options}:ue.push(de);continue}let ie;const he=parseFloat(de.text);if(ne&&!isNaN(he)){const me=(0,m.yQ)(he,ne.steps);me&&me.color&&(ie=me.color)}switch(de.type){case 1:de.value!=null&&(de.value==="null"?ue.push({type:c.d.SpecialValue,options:{match:c.W.Null,result:{text:de.text,color:ie}}}):se.options[String(de.value)]={text:de.text,color:ie});break;case 2:ue.push({type:c.d.RangeToText,options:{from:+de.from,to:+de.to,result:{text:de.text,color:ie}}});break}}return Object.keys(se.options).length>0&&ue.unshift(se),ue}function Q(te){return(te.type==="timeseries"||te.type==="xychart"||te.type==="xychart2")&&te.options.tooltipOptions&&(te.options={...te.options,tooltip:te.options.tooltipOptions},delete te.options.tooltipOptions),te}function q(te){return te.type==="timeseries"&&te.fieldConfig?.defaults.custom?.axisPlacement===v.vM.Hidden&&(te.fieldConfig={...te.fieldConfig,overrides:[...te.fieldConfig.overrides,{matcher:{id:p.Ct.byType,options:h.PU.time},properties:[{id:"custom.axisPlacement",value:v.vM.Auto}]}]}),te}},7817:(Z,R,e)=>{"use strict";e.d(R,{G:()=>B});var n=e(2543),a=e(64423),s=e(19379),l=e(80011),o=e(25229),d=e(75234),i=e(43173),c=e(8255),m=e(95943),p=e(15130),h=e(10605),r=e(54742),g=e(39167),y=e(93612),v=e(87745),x=e(73427),f=e(8535),u=e(88813),b=e(99305),E=e(75421),D=e(82612);const C=new Set(["gridPos","title","description","transparent"]);function P(N,M){const L=[],A={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:L};let U=0;const F=new Map;for(let V of M){let{id:K}=V;K||(U||(U=O([N,M])),K=U++,V={...V,id:K}),F.set(K,V)}for(const V of N){const K=F.get(V.id);if(!K){A.changed=!0,A.actions.remove.push(V.id),V.destroy();continue}if(F.delete(V.id),K===V){L.push(V),A.actions.noop.push(V.id);continue}if(V.type===K.type){const H=V.getSaveModel();let _=!0,k=!1;for(const[J,z]of Object.entries(K))if(!(0,n.isEqualWith)(z,H[J],T))if(A.changed=!0,_=!1,C.has(J))V[J]=z,k=!0;else{k=!1;break}if(_){L.push(V),A.actions.noop.push(V.id);continue}if(k){L.push(V),A.actions.update.push(V.id);continue}}V.destroy();const G=new D.a9(K);G.key=`${G.id}-update-${Date.now()}`,L.push(G),A.changed=!0,A.actions.replace.push(V.id)}for(const V of F.values())L.push(new D.a9(V)),A.changed=!0,A.actions.add.push(V.id);return A}function T(N,M){if(N==null&&(M===1/0||M===-1/0||M==null)||M==null&&(N===1/0||N===-1/0||N==null))return!0}function O(N){let M=0;for(const L of N)for(const A of L)A.id>M&&(M=A.id);return M+1}var I=e(65635);function j(N,M){return N.repeatDirection===m.HG?!1:M.gridPos.x>=N.gridPos.x+N.gridPos.w&&M.gridPos.y===N.gridPos.y}function W(N){for(const M of N)if(delete M.scopedVars,M.panels?.length)for(const L of M.panels)delete L.scopedVars}class B{constructor(M,L,A){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=A?.getVariablesFromState??y.SS,this.events=new s.o,this.id=M.id||null,this.uid=M.uid||L?.uid||null,this.revision=M.revision??void 0,this.title=M.title??"No Title",this.description=M.description,this.tags=M.tags??[],this.timezone=M.timezone??"",this.weekStart=M.weekStart??"",this.editable=M.editable!==!1,this.graphTooltip=M.graphTooltip||0,this.time=M.time??{from:"now-6h",to:"now"},this.timepicker=M.timepicker??{},this.liveNow=M.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(M.templating)),this.annotations=this.ensureListExist(M.annotations),this.refresh=M.refresh,this.snapshot=M.snapshot,this.schemaVersion=M.schemaVersion??0,this.fiscalYearStartMonth=M.fiscalYearStartMonth??0,this.version=M.version??0,this.links=M.links??[],this.gnetId=M.gnetId||null,this.panels=(0,n.map)(M.panels??[],U=>new D.a9(U)),this.scopeMeta=M.scopeMeta,this.originalDashboard=(0,n.cloneDeep)(M),this.originalTemplating=(0,n.cloneDeep)(this.templating),this.originalTime=(0,n.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(L),this.updateSchema(M),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new a.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(x.lE.subscribe(u.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(x.lE.subscribe(u.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(x.lE.subscribe(u.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(L=>L.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:c.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(M){M=M||{},M.canShare=M.canShare!==!1,M.canSave=M.canSave!==!1,M.canStar=M.canStar!==!1,M.canEdit=M.canEdit!==!1,M.canDelete=M.canDelete!==!1,M.showSettings=M.canEdit,M.canMakeEditable=M.canSave&&!this.editable,M.hasUnsavedFolderChange=!1,this.editable||(M.canEdit=!1,M.canDelete=!1,M.canSave=!1),this.meta=M}getSaveModelCloneOld(M){const L=(0,n.defaults)(M||{},{saveVariables:!0,saveTimerange:!0});let A={};for(const U in this)B.nonPersistedProperties[U]||!this.hasOwnProperty(U)||(A[U]=(0,n.cloneDeep)(this[U]));return A.templating=this.getTemplatingSaveModel(L),L.saveTimerange||(A.time=this.originalTime),A.panels=this.getPanelSaveModels(),A=(0,h.v)(A),A.getVariables=()=>A.templating.list,A}getSaveModelClone(M){const L=this.getSaveModelCloneOld(M),A=JSON.stringify(L);return JSON.parse(A)}updatePanels(M){const L=P(this.panels,M??[]);return L.changed&&(this.panels=L.panels??[],this.sortPanelsByGridPos(),this.events.publish(new v.Q$)),L}getPanelSaveModels(){return this.panels.filter(M=>this.isSnapshotTruthy()||!(M.repeatPanelId||M.repeatedByRow)).map(M=>{if(M.libraryPanel){const{id:L,title:A,libraryPanel:U,gridPos:F}=M;return{id:L,title:A,gridPos:F,libraryPanel:{uid:U.uid,name:U.name}}}return this.panelInEdit&&this.panelInEdit.id===M.id?this.panelInEdit.getSaveModel():M.getSaveModel()}).map(M=>(this.isSnapshotTruthy()||(delete M.scopedVars,M.type==="row"&&M.panels&&M.panels.length>0&&(M.panels=M.panels.filter(L=>!L.repeatPanelId).map(L=>(delete L.scopedVars,L)))),M))}getTemplatingSaveModel(M){const L=this.originalTemplating?.list??[],U=this.getVariablesFromState(this.uid).map(V=>{const K=r.B.get(V.type).getSaveModel(V,M.saveVariables);if(!M.saveVariables){const G=L.find(({name:H,type:_})=>H===V.name&&_===V.type);if(!G)return K;V.type==="adhoc"?K.filters=G.filters:(K.current=G.current,K.options=G.options)}return K});return{list:(0,h.v)(U)}}timeRangeUpdated(M){this.events.publish(new d.sR(M)),(0,f.JD)((0,g.RK)(this.uid,M)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(M={refreshAll:!0,panelIds:[]}){if(this.events.publish(new d._),this.lastRefresh=Date.now(),this.panelInEdit&&(M.refreshAll||M.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const L=this.panels.filter(A=>!this.otherPanelInFullscreen(A)&&(M.refreshAll||M.panelIds.includes(A.id)));if(!this.isSnapshot())for(const A of L)A.refreshWhenInView=!0;for(const A of L)A.refresh()}render(){this.events.publish(new v.XM);for(const M of this.panels)M.render()}panelInitialized(M){const L=M.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(M)&&!L&&M.refresh()}otherPanelInFullscreen(M){return(this.panelInEdit||this.panelInView)&&!(M.isViewing||M.isEditing)}initEditPanel(M){return(0,E.jG)().stopAutoRefresh(),this.panelInEdit=M.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,E.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(M){this.panelInView=M,this.timeRangeUpdatedDuringEditOrView=!1,M.setIsViewing(!0)}exitViewPanel(M){this.panelInView=void 0,M.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const M=new Set;let L=this.getNextPanelId();for(const A of this.panelIterator())(!A.id||M.has(A.id))&&(A.id=L++),M.add(A.id)}removeNullValuesFromVariables(M){if(!M.list.length)return M;for(const L of M.list)L.current&&(L.current.value===null||Array.isArray(L.current.value)&&L.current.value.includes(null))&&(L.current=void 0);return M}ensureListExist(M={}){return M.list??=[],M}getNextPanelId(){let M=0;for(const L of this.panelIterator())L.id>M&&(M=L.id);return M+1}*panelIterator(){for(const M of this.panels){yield M;const L=M.panels??[];for(const A of L)yield A}}forEachPanel(M){for(let L=0;L<this.panels.length;L++)M(this.panels[L],L)}getPanelById(M,L=!1){if(this.panelInEdit&&this.panelInEdit.id===M)return this.panelInEdit;if(L){for(const A of this.panelIterator())if(A.id===M)return A;return null}else return this.panels.find(A=>A.id===M)??null}canEditPanel(M){return!!(this.meta.canEdit&&M&&!M.repeatPanelId&&M.type!=="row")}canEditPanelById(M){return this.canEditPanel(this.getPanelById(M))}addPanel(M){M.id=this.getNextPanelId(),this.panels.unshift(new D.a9(M)),this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}updateMeta(M){this.meta={...this.meta,...M},this.events.publish(new v.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((M,L)=>M.gridPos.y===L.gridPos.y?M.gridPos.x-L.gridPos.x:M.gridPos.y-L.gridPos.y)}clearUnsavedChanges(M,L){for(const A of this.panels)A.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=M,this.originalTemplating=M.templating,L.saveTimerange&&(this.originalTime=M.time)}hasUnsavedChanges(){return!!this.panels.find(L=>L.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;W(this.panels);const M=this.panels.filter(L=>(!L.repeat||L.repeatedByRow)&&L.repeatPanelId);(0,n.pull)(this.panels,...M),M.map(L=>L.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let M=0;M<this.panels.length;M++){const L=this.panels[M];L.repeat&&this.repeatPanel(L,M)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}}cleanUpRowRepeats(M){const L=M.map(U=>U.id),A=M.filter(U=>!U.repeat&&U.repeatPanelId&&L.includes(U.repeatPanelId));(0,n.pull)(M,...A),(0,n.pull)(this.panels,...A)}processRowRepeats(M){if(this.isSnapshotTruthy()||!this.hasVariables())return;let L=M.panels??[];if(!M.collapsed){const A=this.panels.findIndex(U=>U.id===M.id);L=this.getRowPanels(A)}this.cleanUpRowRepeats(L);for(const A of L)if(A.repeat){const U=this.panels.findIndex(F=>F.id===A.id);this.repeatPanel(A,U)}}getPanelRepeatClone(M,L,A){if(L===0)return M;const U=M.getSaveModel();U.id=this.getNextPanelId();const F=new D.a9(U);return this.panels.splice(A+L,0,F),F.repeatPanelId=M.id,F.repeat=void 0,this.panelInView?.id===F.id&&(F.setIsViewing(!0),this.panelInView=F),F}getRowRepeatClone(M,L,A){if(L===0){if(!M.collapsed){const K=this.getRowPanels(A);M.panels=K}return M}const U=new D.a9(M.getSaveModel());let F,V;return M.collapsed?(F=(0,n.cloneDeep)(M.panels)??[],U.panels=F,V=A+L):(F=this.getRowPanels(A),U.panels=F.map(K=>K.getSaveModel()),V=A+(F.length+1)*L),this.panels.splice(V,0,U),this.updateRepeatedPanelIds(U),U}repeatPanel(M,L){const A=this.getPanelRepeatVariable(M);if(!A)return;if(M.type==="row"){this.repeatRow(M,L,A);return}const U=this.getSelectedVariableOptions(A),F=M.maxPerRow||4;let V=0,K=M.gridPos.y;for(let H=0;H<U.length;H++){const _=U[H];let k;k=this.getPanelRepeatClone(M,H,L),k.scopedVars??={},k.scopedVars[A.name]=_,M.repeatDirection===m.Pz?(H>0&&(K+=k.gridPos.h),k.gridPos.y=K):(k.gridPos.w=Math.max(m.cV/U.length,m.cV/F),k.gridPos.x=V,k.gridPos.y=K,V+=k.gridPos.w,V+k.gridPos.w>m.cV&&(V=0,K+=k.gridPos.h))}const G=K-M.gridPos.y;if(G>0){const H=L+U.length;for(const _ of this.panels.slice(H))j(M,_)||(_.gridPos.y+=G)}}repeatRow(M,L,A){const U=this.getSelectedVariableOptions(A);for(let F=0;F<U.length;F++){const V=U[F],K=this.getRowRepeatClone(M,F,L);w(K,A,V);const G=this.getRowHeight(K),H=K.panels||[];let _;if(M.collapsed){for(const k of H)w(k,A,V),F>0&&this.updateRepeatedPanelIds(k,!0);K.gridPos.y+=F,_=L+F+1}else{const k=L+(H.length+1)*F+1;H.forEach((J,z)=>{if(w(J,A,V),F>0){const Y=new D.a9(J);this.updateRepeatedPanelIds(Y,!0),Y.gridPos.y+=G*F,this.panels.splice(k+z,0,Y)}}),K.panels=[],K.gridPos.y+=G*F,_=k+H.length}if(U.length>1)for(const k of this.panels.slice(_))k.gridPos.y+=G}}updateRepeatedPanelIds(M,L){return M.repeatPanelId=M.id,M.id=this.getNextPanelId(),L?M.repeatedByRow=!0:M.repeat=void 0,M}getSelectedVariableOptions(M){let L;return(0,b.ML)(M)?L=M.options.slice(1,M.options.length):L=(0,n.filter)(M.options,{selected:!0}),L}getRowHeight(M){if(!M.panels||M.panels.length===0)return 0;if(M.collapsed)return 1;const L=(0,n.maxBy)(M.panels,({gridPos:A})=>A.y+A.h).gridPos;return L.y+L.h-M.gridPos.y}removePanel(M){this.panels=this.panels.filter(L=>L!==M),M.destroy(),this.events.publish(new v.Q$)}removeRow(M,L){(!L&&M.collapsed||L&&!M.collapsed)&&this.toggleRow(M),this.removePanel(M)}expandRows(){const M=this.panels.filter(L=>L.type==="row"&&L.collapsed);for(const L of M)this.toggleRow(L)}collapseRows(){const M=this.panels.filter(L=>L.type==="row"&&!L.collapsed);for(const L of M)this.toggleRow(L)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(M=>M.hide!==2)||this.annotations.list.some(M=>!M.hide)}getPanelInfoById(M){const L=this.panels.findIndex(A=>A.id===M);return L>=0?{panel:this.panels[L],index:L}:null}duplicatePanel(M){const L=M.getSaveModel();return L.id=this.getNextPanelId(),delete L.repeat,delete L.repeatIteration,delete L.repeatPanelId,delete L.scopedVars,L.alert&&delete L.thresholds,delete L.alert,M.gridPos.x+M.gridPos.w*2<=m.cV?L.gridPos.x+=M.gridPos.w:L.gridPos.y+=M.gridPos.h,this.addPanel(L),L}formatDate(M,L){return(0,l.LE)(M,{format:L,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const M of this.panels)M.destroy()}toggleRow(M){const L=(0,n.indexOf)(this.panels,M);if(!M.collapsed){const V=this.getRowPanels(L);(0,n.pull)(this.panels,...V),M.panels=V.map(K=>K.getSaveModel()),M.collapsed=!0,V.some(K=>K.hasChanged)&&M.configRev++,this.events.publish(new v.Q$);return}M.collapsed=!1;const A=M.panels??[],U=A.some(V=>V.repeat),F=M.repeat;if(A.length>0){const K=(A[0].gridPos.y??M.gridPos.y)-(M.gridPos.y+M.gridPos.h);let G=L+1,H=M.gridPos.y;for(const k of A){if(F){const J=this.getPanelRepeatVariable(M);if(k.scopedVars??={},J){const z=this.getSelectedVariableOptions(J);k.scopedVars={...k.scopedVars,[J.name]:z[0]}}}k.gridPos.y??(k.gridPos.y=M.gridPos.y),k.gridPos.y-=K,this.panels.splice(G,0,new D.a9(k)),G+=1,H=Math.max(H,k.gridPos.y+k.gridPos.h)}const _=H-M.gridPos.y-1;for(const k of this.panels.slice(G))k.gridPos.y+=_;M.panels=[],U&&this.processRowRepeats(M)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}getRowPanels(M){const L=this.panels.slice(M+1),A=L.findIndex(F=>F.type==="row");return L.slice(0,A>=0?A:this.panels.length)}on(M,L){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(M,L)}off(M,L){console.log("DashboardModel.off is deprecated"),this.events.off(M,L)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(M){return(0,l.fq)(M,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:p.TP?.user?.timezone}updateSchema(M){new I.SW(this).updateSchema(M)}hasTimeChanged(){const{time:M,originalTime:L}=this;return!((0,n.isEqual)(M,L)||(0,n.isEqual)((0,o.KQ)(M?.from),(0,o.KQ)(L?.from))&&(0,n.isEqual)((0,o.KQ)(M?.to),(0,o.KQ)(L?.to)))}autoFitPanels(M,L){const A=Math.max(...this.panels.map(H=>H.gridPos.h+H.gridPos.y)),U=55;let V=M-U-20;L&&(V+=U);const K=Math.floor(V/(m.sD+m.dU)),G=A/K;for(const H of this.panels)H.gridPos.y=Math.round(H.gridPos.y/G)||1,H.gridPos.h=Math.round(H.gridPos.h/G)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(v.bG)}getPanelByUrlId(M){const L=parseInt(M??"0",10),A=this.panels.filter(U=>U.collapsed);for(const U of A)U.panels?.some(V=>V.id===L)&&this.toggleRow(U);return this.getPanelById(L)}toggleLegendsForAll(){const M=this.panels.filter(S),L=M.filter(F=>F.legend.show).length,A=M.length-L,U=L>=A;for(const F of M)F.legend.show=!U,F.render()}toggleExemplarsForAll(){for(const M of this.panels)for(const L of M.targets){if(!(L.datasource&&(L.datasource.type==="prometheus"||L.datasource.type==="grafana-amazonprometheus-datasource"||L.datasource.type==="grafana-azureprometheus-datasource")))continue;const A=L;A.exemplar=!A.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(M){let L=!0;return M?L=!!this.meta.annotationsPermissions?.dashboard.canEdit:L=!!this.meta.annotationsPermissions?.organization.canEdit,(i.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&L}canDeleteAnnotations(M){let L=!0;return M?L=!!this.meta.annotationsPermissions?.dashboard.canDelete:L=!!this.meta.annotationsPermissions?.organization.canDelete,i.$.featureToggles.annotationPermissionUpdate?L:L&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(L=>L.builtIn===1)?.enable===!1?!1:i.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(M,L){!(0,n.isEqual)(M?.gridPos,L?.gridPos)&&this.events.publish(new v.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(M){return this.getVariablesFromState(this.uid).find(L=>L.name===M.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const M=this.originalTemplating?.list??[],L=this.getTemplatingSaveModel({saveVariables:!0}).list;return M.length!==L.length?!1:!(0,n.isEqual)(L,M)}variablesTimeRangeProcessDoneHandler(M){const L=M.payload.variableIds.length>0;this.variablesChangedHandler(new u.og({panelIds:[],refreshAll:!0}),L)}variablesChangedHandler(M,L=!0){if(L&&this.processRepeats(),M.payload.refreshAll||(0,E.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=M.payload.panelIds.filter(A=>A!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(M.payload)}variablesChangedInUrlHandler(M){this.templateVariableValueUpdated(),this.startRefresh(M.payload)}getOriginalDashboard(){return this.originalDashboard}}function S(N){return!!N.legend}function w(N,M,L){N.scopedVars??={},N.scopedVars[M.name]=L}},82612:(Z,R,e)=>{"use strict";e.d(R,{NB:()=>u,a9:()=>b,tw:()=>D});var n=e(2543),a=e.n(n),s=e(24726),l=e(19379),o=e(39796),d=e(1906),i=e(69168),c=e(75234),m=e(2863),p=e(65642),h=e(62635),r=e(87745),g=e(96215),y=e(56623);const v={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},x={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},f={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},u={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap","natel-discrete-panel":"state-timeline"};class b{constructor(P){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new l.o,this.restoreModel(P),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,s.A)()}restoreModel(P){for(const O in this)v[O]||!this.hasOwnProperty(O)||P[O]||typeof this[O]!="function"&&typeof this[O]!="symbol"&&delete this[O];for(const O in P)this[O]=P[O];const T=(0,y.p)(this);T&&(this.autoMigrateFrom=this.type,this.type=T),(0,n.defaultsDeep)(this,(0,n.cloneDeep)(f)),this.ensureQueryIds()}generateNewKey(){this.key=(0,s.A)()}ensureQueryIds(){if(this.targets&&(0,n.isArray)(this.targets))for(const P of this.targets)P.refId||(P.refId=(0,o.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(P){this.options=P,this.configRev++,this.events.publish(new r.PR),this.render()}updateFieldConfig(P){this.fieldConfig=P,this.configRev++,this.events.publish(new r.PR),this.resendLastResult(),this.render()}getSaveModel(){const P={};for(const T in this)v[T]||!this.hasOwnProperty(T)||(0,n.isEqual)(this[T],f[T])||(P[T]=(0,n.cloneDeep)(this[T]));return this.type==="row"&&this.panels&&this.panels.length>0&&(P.panels=this.panels.map(T=>{if(T.libraryPanel){const{id:O,title:I,libraryPanel:j,gridPos:W}=T;return{id:O,title:I,gridPos:W,libraryPanel:{uid:j.uid,name:j.name}}}return T})),P}setIsViewing(P){this.isViewing=P}updateGridPos(P,T=!0){P.x===this.gridPos.x&&P.y===this.gridPos.y&&P.h===this.gridPos.h&&P.w===this.gridPos.w||(this.gridPos.x=P.x,this.gridPos.y=P.y,this.gridPos.w=P.w,this.gridPos.h=P.h,T&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:P,dashboardTimezone:T,timeData:O,width:I,dashboardTitle:j}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelName:this.title,panelPluginId:this.type,dashboardUID:P,dashboardTitle:j,timezone:T,timeRange:O.timeRange,timeInfo:O.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(I),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?d.Jk.PanelEditor:this.isViewing?d.Jk.PanelViewer:d.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new c._)}render(){this.hasRefreshed?this.events.publish(new r.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((P,T)=>v[T]||x[T]?P:{...P,[T]:this[T]},{})}restorePanelOptions(P){const T=this.cachedPluginOptions[P];T&&(Object.keys(T.properties).map(O=>{this[O]=T.properties[O]}),this.fieldConfig=(0,i.H9)(this.fieldConfig,T.fieldConfig))}applyPluginOptionDefaults(P,T){const O=(0,i.F)({plugin:P,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:T});this.fieldConfig=O.fieldConfig,this.options=O.options}async pluginLoaded(P){this.plugin=P;const T=E(P);if(this.autoMigrateFrom){const O=u[this.autoMigrateFrom]!=null,I=this.getOptionsToRemember(),j=this.autoMigrateFrom,W=this.type;this.clearPropertiesBeforePluginChange(),this.type=W,this.plugin=P,this.callPanelTypeChangeHandler(P,j,I,O)}if(P.onPanelMigration&&T!==this.pluginVersion){const O=P.onPanelMigration(this);this.options=await O,this.pluginVersion=T}this.applyPluginOptionDefaults(P,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const P in this)x[P]||delete this[P];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,i.aW)(this.fieldConfig.overrides,i.nx)}}callPanelTypeChangeHandler(P,T,O,I){if(P.onPanelTypeChanged){const j=I?{angular:O}:O.options;Object.assign(this.options,P.onPanelTypeChanged(this,T,j,this.fieldConfig))}}changePlugin(P){const T=P.meta.id,O=this.getOptionsToRemember(),I=this.fieldConfig,j=this.type,W=this.isAngularPlugin()||!!u[j];this.cachedPluginOptions[j]={properties:O,fieldConfig:I},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(T),this.callPanelTypeChangeHandler(P,j,O,W),this.type=T,this.plugin=P,this.configRev++,this.applyPluginOptionDefaults(P,!0),P.onPanelMigration&&(this.pluginVersion=E(P))}updateQueries(P){const{dataSource:T}=P;this.datasource=T,this.cacheTimeout=P.cacheTimeout,this.queryCachingTTL=P.queryCachingTTL,this.timeFrom=P.timeRange?.from,this.timeShift=P.timeRange?.shift,this.hideTimeOverride=P.timeRange?.hide,this.interval=P.minInterval,this.maxDataPoints=P.maxDataPoints,this.targets=P.queries,this.configRev++,this.events.publish(new r.zq)}addQuery(P){P=P||{refId:"A"},P.refId=(0,o.M)(this.targets),this.targets.push(P),this.configRev++}changeQuery(P,T){P.refId=this.targets[T].refId,this.configRev++,this.targets=this.targets.map((O,I)=>I===T?P:O)}getEditClone(){const P=this.getSaveModel(),T=new b(P);T.isEditing=!0,T.plugin=this.plugin;const O=this.getQueryRunner();return T.getQueryRunner().useLastResultFrom(O),T}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:p.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new g.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(P){this.transformations=P,this.resendLastResult(),this.configRev++,this.events.publish(new r.JI)}setProperty(P,T){this[P]=T,this.configRev++,P==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(P,T,O){const I=this.getQueryRunner().getLastRequest(),j=Object.assign({},this.scopedVars,I?.scopedVars,T);return(0,m.w)().replace(P,j,O)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(P){for(const[T,O]of Object.entries(P.model)){switch(T){case"id":case"gridPos":case"libraryPanel":continue}this[T]=O}this.libraryPanel=P}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function E(C){return C&&C.meta.info.version?C.meta.info.version:p.Ay.buildInfo.version}function D(C){const P={};return Object.entries(C).filter(([T,O])=>!v[T]&&C.hasOwnProperty(T)&&!(0,n.isEqual)(O,f[T])).forEach(([T,O])=>{P[T]=O}),(0,h.MA)(P)}},83127:(Z,R,e)=>{"use strict";e.d(R,{B:()=>s});var n=e(33749),a=e(27489);function s(l){const o={dashboardId:l.id,dashboardName:l.title,dashboardUid:l.uid,folderName:l.meta.folderTitle,eventName:n.n_.DashboardView};(0,a.G$)(o)}},56623:(Z,R,e)=>{"use strict";e.d(R,{p:()=>a});var n=e(82612);function a(s){return s.type==="graph"?s.xaxis?.mode==="series"?s.legend?.values?"bargauge":"barchart":s.xaxis?.mode==="histogram"?"histogram":"timeseries":n.NB[s.type]}},37918:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>x,O9:()=>p,Ub:()=>y,X1:()=>h,ig:()=>m,p0:()=>r,xS:()=>c});var n=e(65307),a=e(92745),s=e(59857),l=e(6262),o=e(7817);const d={initPhase:l._g.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},i=(0,n.Z0)({name:"dashboard",initialState:d,reducers:{dashboardInitFetching:f=>{f.initPhase=l._g.Fetching},dashboardInitServices:f=>{f.initPhase=l._g.Services},dashboardInitCompleted:(f,u)=>{f.getModel=()=>u.payload,f.initPhase=l._g.Completed},dashboardInitFailed:(f,u)=>{f.initPhase=l._g.Failed,f.initError=u.payload,f.getModel=()=>new o.G({...s.Ye,title:(0,a.t)("dashboard.dashboard-slice.title.dashboard-init-failed","Dashboard init failed")},{canSave:!1,canEdit:!1})},cleanUpDashboard:f=>{f.initPhase=l._g.NotStarted,f.initError=null,f.getModel=()=>null},addPanel:(f,u)=>{},setInitialDatasource:(f,u)=>{f.initialDatasource=u.payload}}}),{dashboardInitFetching:c,dashboardInitFailed:m,dashboardInitCompleted:p,dashboardInitServices:h,cleanUpDashboard:r,addPanel:g,setInitialDatasource:y}=i.actions,x={dashboard:i.reducer}},77731:(Z,R,e)=>{"use strict";e.d(R,{B1:()=>E,CW:()=>u,LH:()=>m,OK:()=>p,SD:()=>r,VF:()=>g,_u:()=>x,dH:()=>D,ko:()=>b,no:()=>v,s3:()=>y});var n=e(2543),a=e.n(n),s=e(92745),l=e(36490),o=e(65642),d=e(95943),i=e(29043),c=e(17097);const m="New panel";function p(P,T){const O={type:"timeseries",title:m,gridPos:(0,c.Ft)(P),datasource:T?{uid:T}:null,isNew:!0};return P.addPanel(O),O.id}function h(P,T){const O={type:T,title:t("dashboard.on-create-new-widget-panel.new-panel.title.widget-title","Widget title"),gridPos:calculateNewPanelGridPos(P),datasource:null,isNew:!0};return P.addPanel(O),O.id}function r(P){const T={type:"row",title:(0,s.t)("dashboard.on-create-new-row.new-row.title.row-title","Row title"),gridPos:{x:0,y:0}};P.addPanel(T)}function g(){l.Ny.push("/dashboard/import")}function y(P){const T={type:"add-library-panel",gridPos:(0,c.Ft)(P)};P.addPanel(T)}function v(P,T){if(!T)return;const O=(0,c.Ft)(P),I={type:T.id,title:m,gridPos:{x:O.x,y:O.y,w:T.defaults.gridPos.w,h:T.defaults.gridPos.h}};T.defaults&&((0,n.defaults)(I,T.defaults),I.title=T.defaults.title,i.A.delete(d.tH)),P.addPanel(I)}function x(){const P=(0,n.chain)(o.Ay.panels).filter({hideFromList:!1}).map(O=>O).value(),T=i.A.get(d.tH);if(T){const O=JSON.parse(T),I=(0,n.find)(P,{id:O.type});if(I){const j=(0,n.cloneDeep)(I);return j.name=O.title,j.sort=-1,{...j,defaults:{...O}}}}}const f="grafana.dashboards.panelEdit.lastUsedDatasource";function u(P){if(i.A.exists(f)){const T=i.A.getObject(f);if(T?.dashboardUid===P)return T}}function b(P){if(!i.A.exists(f))return;const O=i.A.getObject(f)?.datasourceUid??"";C(P,O)}function E(P){i.A.setObject(f,{dashboardUid:P,datasourceUid:""})}function D(P,T){const O=u(P);if(!O)C(P,T);else{const I=O?.dashboardUid??"";C(I,T)}}function C(P,T){i.A.setObject(f,{dashboardUid:P,datasourceUid:T})}},17097:(Z,R,e)=>{"use strict";e.d(R,{ET:()=>j,FC:()=>E,Ft:()=>w,KJ:()=>C,Mc:()=>P,ZY:()=>O,d7:()=>T,iU:()=>D,nk:()=>W});var n=e(2543),a=e.n(n),s=e(32899),l=e(17548),o=e(25229),d=e(33239),i=e(92745),c=e(2863),m=e(45229),p=e(65642),h=e(95943),r=e(29043),g=e(23753),y=e(82612),v=e(12161),x=e(43652),f=e(87390),u=e(8535),b=e(87745);const E=(N,M,L)=>{if(L!==!1){const A=M.alert?"YES":void 0;m.A.publish(new b.bY({title:(0,i.t)("dashboard.remove-panel.title.remove-panel","Remove panel"),text:(0,i.t)("dashboard.remove-panel.text.remove-panel","Are you sure you want to remove this panel?"),icon:"trash-alt",confirmText:A,yesText:"Remove",onConfirm:()=>E(N,M,!1)}));return}N.removePanel(M),(0,u.JD)((0,f.O6)(M.key))},D=(N,M)=>{N.duplicatePanel(M)},C=N=>{let M=N;N instanceof y.a9&&(M=N.getSaveModel()),r.A.set(h.tH,JSON.stringify(M)),m.A.emit(s.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},P=(N,M)=>{m.A.publish(new b.S8({component:g.Zy,props:{dashboard:N,panel:M}}))},T=(N,M)=>{m.A.publish(new b.S8({component:x.o,props:{panel:M,initialFolderUid:N.meta.folderUid,isOpen:!0}}))},O=N=>{m.A.publish(new b.S8({component:v.l,props:{onConfirm:()=>N.unlinkLibraryPanel(),isOpen:!0}}))},I=N=>{N.refresh()},j=N=>{const M={...N.options};M.legend.showLegend===!0?M.legend.showLegend=!1:M.legend.showLegend=!0,N.updateOptions(M)};function W(N,M){const L={timeInfo:"",timeRange:M};if(N.timeFrom){const A=(0,c.w)().replace(N.timeFrom,N.scopedVars),U=l.describeTextRange(A);if(U.invalid)return L.timeInfo="invalid time override",L;if((0,n.isString)(M.raw.from)){const F=(0,o.AN)(M.from).tz(),V=(0,o.AN)(M.to).tz(),K=d.parse(U.from,void 0,F);L.timeInfo=U.display,L.timeRange={from:K,to:d.parse(U.to,void 0,V),raw:{from:U.from,to:U.to}}}}if(N.timeShift){const A=(0,c.w)().replace(N.timeShift,N.scopedVars);if(l.describeTextRange(A).invalid)return L.timeInfo="invalid timeshift",L;const F="-"+A;L.timeInfo+=" timeshift "+F;const V=d.parseDateMath(F,L.timeRange.from,!1),K=d.parseDateMath(F,L.timeRange.to,!0);L.timeRange={from:V,to:K,raw:{from:V,to:K}}}return N.hideTimeOverride&&(L.timeInfo=""),L}function B(N){const L=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return N.maxDataPoints?N.maxDataPoints:Math.ceil(L*(N.gridPos.w/24))}function S(N,M){const L=N.plugin&&N.plugin.noPadding?0:config.theme.panelPadding*2,A=N.hasTitle()?config.theme.panelHeaderHeight:0;return M-A-L-PANEL_BORDER}function w(N){for(const L of N.panelIterator())L.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},90593:(Z,R,e)=>{"use strict";e.d(R,{z:()=>s});var n=e(25229),a=e(33239);const s=(l,o)=>{const d={from:(0,n.Ar)(l.from)?(0,n.KQ)(l.from):l.from,to:(0,n.Ar)(l.to)?(0,n.KQ)(l.to):l.to},i=o?o.getTimezone():void 0;return{from:a.parse(d.from,!1,i,o?.fiscalYearStartMonth),to:a.parse(d.to,!0,i,o?.fiscalYearStartMonth),raw:d}}},95710:(Z,R,e)=>{"use strict";e.d(R,{Dd:()=>s,GC:()=>l,dM:()=>a,wM:()=>o,z9:()=>i});var n=e(23289);function a(p,h,r){const g=o(p.templating.list),y=l(p.panels.map(v=>v.type));n.c.dashboardInitialized({uid:p.uid,title:p.title,theme:p.style,schemaVersion:p.schemaVersion,version_before_migration:r,panels_count:p.panels.length,...y,...g,settings_nowdelay:p.timepicker.nowDelay,settings_livenow:!!p.liveNow,duration:h,isScene:!1})}function s(p,h){const r=p.getTrackingInformation();n.c.dashboardInitialized({theme:void 0,duration:h,isScene:!0,...r})}function l(p){return p.reduce((h,r)=>(h[m(r)]=1+h[m(r)]||1,h),{})}function o(p){return p.map(h=>h.type).reduce((h,r)=>(h[c(r)]=1+h[c(r)]||1,h),{})}function d(p){switch(p){case"AdhocVariable":return"adhoc";case"CustomVariable":return"custom";case"QueryVariable":return"query";case"IntervalVariable":return"interval";case"ConstantVariable":return"constant";case"DatasourceVariable":return"datasource";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";default:return}}function i(p){return p.map(h=>d(h.kind)).filter(h=>h!==void 0).reduce((h,r)=>(h[c(r)]=1+h[c(r)]||1,h),{})}const c=p=>`variable_type_${p}_count`,m=p=>`panel_type_${p}_count`},44515:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>n,o:()=>a});const n={"text/plain":[".csv",".txt"],"application/json":[".json"]},a=5e5},4735:(Z,R,e)=>{"use strict";e.d(R,{v:()=>l});var n=e(88483),a=e(41119),s=e(68125);function l(o){return new n.c(d=>{let i=0;o.forEach(c=>{const m=new FileReader;m.readAsArrayBuffer(c),m.onload=()=>{const p=m.result;if(p&&p instanceof ArrayBuffer){const r=new TextDecoder("utf-8").decode(p);if(c.type==="application/json"){const g=JSON.parse(r);d.next({dataFrames:[(0,a.Vc)(g)],file:c})}else d.next({dataFrames:(0,s.Jh)(r),file:c});++i>=o.length&&d.complete()}}})})}},6079:(Z,R,e)=>{"use strict";e.d(R,{r:()=>c});var n=e(74848),a=e(92138),s=e(92745),l=e(45861),o=e(73427),d=e(26437),i=e(11257);function c({variant:m,onClick:p}){const h=o.TP.hasPermission(i.w.DataSourcesCreate),r=a.I.assureBaseUrl(d.b.DataSourcesNew);return(0,n.jsx)(l.z9,{variant:m||"primary",href:r,disabled:!h,tooltip:h?void 0:(0,s.t)("datasources.add-new-data-source-button.tooltip-no-permission","You do not have permission to configure new data sources"),onClick:p,target:"_blank",children:(0,n.jsx)(s.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},85032:(Z,R,e)=>{"use strict";e.d(R,{A:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(8073),o=e(37658);function d({ds:c,onClick:m,selected:p,description:h,...r}){const g=(0,s.$j)(),y=i(g,c.meta.builtIn);return(0,n.jsxs)(l.Z,{onClick:m,className:(0,a.cx)(y.card,p?y.selected:void 0),...r,children:[(0,n.jsx)(l.Z.Heading,{className:y.heading,children:(0,n.jsxs)("div",{className:y.headingContent,children:[(0,n.jsxs)("span",{className:y.name,children:[c.name," ",c.isDefault?(0,n.jsx)(o.L,{tags:["default"]}):null]}),(0,n.jsx)("small",{className:y.type,children:h||c.meta.name})]})}),(0,n.jsx)(l.Z.Figure,{className:y.logo,children:(0,n.jsx)("img",{src:c.meta.info.logos.small,alt:`${c.meta.name} Logo`})})]},c.uid)}function i(c,m=!1){return{card:(0,a.css)({cursor:"pointer",backgroundColor:"transparent",marginBottom:0,padding:c.spacing(1),"&:hover":{backgroundColor:c.colors.action.hover}}),heading:(0,a.css)({width:"100%",overflow:"hidden","> button":{width:"100%"}}),headingContent:(0,a.css)({color:c.colors.text.secondary,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"}),logo:(0,a.css)({width:"32px",height:"32px",padding:c.spacing(0,1),display:"flex",alignItems:"center","> img":{maxHeight:"100%",minWidth:"24px",filter:`invert(${m&&c.isLight?1:0})`}}),name:(0,a.css)({color:c.colors.text.primary,display:"flex",gap:c.spacing(2)}),type:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center"}),separator:(0,a.css)({margin:c.spacing(0,1),color:c.colors.border.weak}),selected:(0,a.css)({background:c.colors.action.selected,"&::before":{backgroundImage:c.colors.gradients.brandVertical,borderRadius:c.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:c.spacing(.5),left:0}}),meta:(0,a.css)({display:"block",overflowWrap:"unset",whiteSpace:"nowrap",width:"100%",overflow:"hidden",textOverflow:"ellipsis"})}}},93602:(Z,R,e)=>{"use strict";e.d(R,{S:()=>r});var n=e(74848),a=e(22803),s=e(96540),l=e(51898),o=e(92745),d=e(2863),i=e(63142),c=e(42227),m=e(6079),p=e(85032),h=e(7078);function r(f){const u=(0,s.useRef)(null),[b,E]=(0,c.dR)({keyboardEvents:f.keyboardEvents,containerRef:u}),D=(0,i.$j)(),C=x(D,E),{className:P,current:T,onChange:O,enableKeyboardNavigation:I,onClickEmptyStateCTA:j}=f,W=(0,c.Kr)({alerting:f.alerting,annotations:f.annotations,dashboard:f.dashboard,logs:f.logs,metrics:f.metrics,mixed:f.mixed,pluginId:f.pluginId,tracing:f.tracing,type:f.type,variables:f.variables}),[B,S]=(0,c.TX)(),w=f.filter?W.filter(f.filter):W;return(0,n.jsxs)("div",{ref:u,className:(0,a.cx)(P,C.container),"data-testid":l.Tp.components.DataSourcePicker.dataSourceList,children:[w.length===0&&(0,n.jsx)(g,{className:C.emptyState,onClickCTA:j}),w.sort((0,h.Tj)(T,B,v())).map(N=>(0,n.jsx)(p.A,{"data-testid":"data-source-card",ds:N,onClick:()=>{S(N),O(N)},selected:(0,h.Df)(N,T),...I?b:{}},N.uid))]})}function g({className:f,onClickCTA:u}){const b=(0,i.of)(y);return(0,n.jsxs)("div",{className:(0,a.cx)(f,b.container),children:[(0,n.jsx)("p",{className:b.message,children:(0,n.jsx)(o.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,n.jsx)(m.r,{onClick:u})]})}function y(f){return{container:(0,a.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),message:(0,a.css)({marginBottom:f.spacing(3)})}}function v(){return(0,d.w)().getVariables().filter(u=>u.type==="datasource").map(u=>`\${${u.id}}`)}function x(f,u){return{container:(0,a.css)({display:"flex",flexDirection:"column",padding:f.spacing(.5),[`${u}`]:{backgroundColor:f.colors.background.secondary}}),emptyState:(0,a.css)({height:"100%",flex:1})}}},41776:(Z,R,e)=>{"use strict";e.d(R,{p:()=>I});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(92745),d=e(27489),i=e(43173),c=e(63142),m=e(22787),p=e(63527),h=e(30703),r=e(92807),g=e(40279),y=e(44515),v=e(22747),x=e(42227),f=e(6079),u=e(51898),b=e(85032),E=e(7078);function D(W){switch(W){case"grafana":return(0,o.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,o.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,o.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function C({className:W,current:B,onChange:S,tracing:w,dashboard:N,mixed:M,metrics:L,type:A,annotations:U,variables:F,alerting:V,pluginId:K,logs:G,filter:H}){const k=(0,x.Kr)({tracing:w,dashboard:N,mixed:M,metrics:L,type:A,annotations:U,variables:F,alerting:V,pluginId:K,logs:G}).filter(J=>(H?H?.(J):!0)&&!!J.meta.builtIn);return(0,n.jsx)("div",{className:W,"data-testid":u.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:k.map(J=>(0,n.jsx)(b.A,{ds:J,description:D(J.uid),selected:(0,E.Df)(J,B),onClick:()=>S(J)},J.uid))})}var P=e(93602);const T="dashboards_dspickermodal_clicked",O={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function I({tracing:W,dashboard:B,mixed:S,metrics:w,type:N,annotations:M,variables:L,alerting:A,pluginId:U,logs:F,uploadFile:V,filter:K,onChange:G,current:H,onDismiss:_,reportedInteractionFrom:k}){const J=(0,c.of)(j),[z,Y]=(0,l.useState)(""),X=k||"modal",Q=()=>{_(),(0,d.rR)(T,{item:O.DISMISS,src:X})},q=de=>{G(de),(0,d.rR)(T,{item:O.SELECT_DS,ds_type:de.type,src:X})},te=(0,l.useMemo)(()=>(0,s.once)(()=>{(0,d.rR)(T,{item:"search",src:X})}),[X]),ne=(0,x.ps)("-- Grafana --"),se=(0,v.j)((de,ie)=>{ne&&(G(ne,[de]),(0,d.rR)(T,{item:O.UPLOAD_FILE,src:X}),ie.length<1&&_())}),ue=({className:de})=>(0,n.jsx)(C,{className:de,onChange:q,current:H,filter:K,variables:L,tracing:W,metrics:w,type:N,annotations:M,alerting:A,pluginId:U,logs:F,dashboard:B,mixed:S});return(0,n.jsxs)(m.a,{title:(0,o.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:J.modal,contentClassName:J.modalContent,onClickBackdrop:Q,onDismiss:Q,children:[(0,n.jsxs)("div",{className:J.leftColumn,children:[(0,n.jsx)(p.p,{type:"search",autoFocus:!0,className:J.searchInput,value:z,prefix:(0,n.jsx)(h.I,{name:"search"}),placeholder:(0,o.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:de=>{Y(de.currentTarget.value),te()}}),(0,n.jsxs)(r.P,{children:[(0,n.jsx)(P.S,{onChange:q,current:H,onClickEmptyStateCTA:()=>(0,d.rR)(T,{item:O.CONFIG_NEW_DS_EMPTY_STATE,src:X}),filter:de=>(K?K?.(de):!0)&&(0,E.Zn)(de,z)&&!de.meta.builtIn,variables:L,tracing:W,metrics:w,type:N,annotations:M,alerting:A,pluginId:U,logs:F,dashboard:B,mixed:S}),(0,n.jsx)(ue,{className:J.appendBuiltInDataSourcesList})]})]}),(0,n.jsxs)("div",{className:J.rightColumn,children:[(0,n.jsxs)("div",{className:J.builtInDataSources,children:[(0,n.jsx)("div",{className:J.builtInDataSourcesList,children:(0,n.jsx)(r.P,{children:(0,n.jsx)(ue,{})})}),V&&i.$.featureToggles.editPanelCSVDragAndDrop&&(0,n.jsx)(g.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:y.o,multiple:!1,accept:y.Z,onDrop:se},children:(0,n.jsx)(g.wI,{})})]}),(0,n.jsxs)("div",{className:J.newDSSection,children:[(0,n.jsx)("span",{className:J.newDSDescription,children:(0,n.jsx)(o.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,n.jsx)(f.r,{variant:"secondary",onClick:()=>{(0,d.rR)(T,{item:O.CONFIG_NEW_DS,src:X}),_()}})]})]})]})}function j(W){return{modal:(0,a.css)({width:"80%",height:"80%",maxWidth:"1200px",maxHeight:"900px",[W.breakpoints.down("md")]:{width:"100%"}}),modalContent:(0,a.css)({display:"flex",flexDirection:"row",height:"100%",[W.breakpoints.down("md")]:{flexDirection:"column"}}),leftColumn:(0,a.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",paddingRight:W.spacing(4),borderRight:`1px solid ${W.colors.border.weak}`,[W.breakpoints.down("md")]:{width:"100%",borderRight:0,paddingRight:0,flex:1,overflowY:"auto"}}),rightColumn:(0,a.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",justifyItems:"space-evenly",alignItems:"stretch",paddingLeft:W.spacing(4),[W.breakpoints.down("md")]:{width:"100%",paddingLeft:0,flex:0}}),builtInDataSources:(0,a.css)({flex:"1 1",marginBottom:W.spacing(4),[W.breakpoints.down("md")]:{flex:0}}),builtInDataSourcesList:(0,a.css)({[W.breakpoints.down("md")]:{display:"none",marginBottom:0},marginBottom:W.spacing(4)}),appendBuiltInDataSourcesList:(0,a.css)({[W.breakpoints.up("md")]:{display:"none"}}),newDSSection:(0,a.css)({display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",alignItems:"center"}),newDSDescription:(0,a.css)({flex:"1 0",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:W.colors.text.secondary}),searchInput:(0,a.css)({width:"100%",minHeight:"32px",marginBottom:W.spacing(1)})}}},76792:(Z,R,e)=>{"use strict";e.d(R,{s:()=>M});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(18828),i=e(42211),c=e(93225),m=e(2543),p=e(96540),h=e(51898),r=e(92745),g=e(27489),y=e(63142),v=e(63527),x=e(30703),f=e(15245),u=e(92807),b=e(8515),E=e(45861),D=e(65642),C=e(5478),P=e(8095),T=e(42227),O=e(93602);function I(K){const{dataSource:G}=K,H=(0,y.$j)(),_=W(H,G?.meta.builtIn);return G?(0,n.jsx)("img",{className:_.pickerDSLogo,alt:`${G.meta.name} logo`,src:G.meta.info.logos.small}):j()}function j(){const K=(0,y.of)(W);return(0,n.jsx)("div",{className:K.pickerDSLogo})}function W(K,G=!1){return{pickerDSLogo:(0,a.css)({height:"20px",width:"20px",filter:`invert(${G&&K.isLight?1:0})`})}}var B=e(41776),S=e(7078);const w="dashboards_dspicker_clicked",N={SEARCH:"search",OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function M(K){const{current:G,onChange:H,hideTextValue:_=!1,width:k,inputId:J,noDefault:z=!1,disabled:Y=!1,placeholder:X="Select data source",...Q}=K,q=(0,y.of)(L,K),[te,ne]=(0,p.useState)(!1),[se,ue]=(0,p.useState)(!1),[de,ie]=(0,p.useState)(""),{onKeyDown:he,keyboardEvents:me}=(0,C.d)(),ce=(0,p.useRef)(null),Pe=(0,p.useMemo)(()=>(0,m.debounce)(ve=>{(0,g.rR)(w,{item:N.SEARCH,query:ve,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),[Ie,Se]=(0,p.useState)(),[Me,Te]=(0,p.useState)(),Ge=(0,T.ps)(G),Qe=(0,T.ps)("-- Grafana --"),tt=!G&&z?void 0:Ge,ke=de&&te?(0,n.jsx)(j,{}):(0,n.jsx)(I,{dataSource:tt}),He=[(0,s.cY)(4),(0,s.Ej)({apply({availableHeight:ve,elements:be}){be.floating.style.maxHeight=`${Math.max(200,ve-20)}px`,be.floating.style.minHeight="200px"}}),(0,s.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:Re,floatingStyles:Ne}=(0,l.we)({open:te,placement:"bottom-start",onOpenChange:ne,middleware:He,whileElementsMounted:o.ll,strategy:"fixed"}),Ae=(0,p.useCallback)(ve=>{Re.setReference(ve),Se(ve)},[Re]),Ue=(0,p.useCallback)(()=>{ie(""),ne(!1),Ie?.focus()},[ne,Ie]),{overlayProps:Be,underlayProps:We}=(0,c.e)({onClose:Ue,isDismissable:!0,isOpen:te,shouldCloseOnInteractOutside:ve=>Ie?!Ie.isSameNode(ve):!1},ce),{dialogProps:_e}=(0,d.s)({"aria-label":"Opened data source picker list"},ce);function Xe(){ne(!0),Ie?.focus()}function le(){Qe&&H(Qe,[P.dx])}function ye(ve){ve.key==="Tab"&&!ve.shiftKey&&te&&(ve.preventDefault(),Me?.focus()),ve.key==="Tab"&&ve.shiftKey&&te&&Ue(),he(ve)}function pe(ve){ve.shiftKey?(ve.preventDefault(),Ie?.focus()):Ue()}return(0,p.useEffect)(()=>{const ve=me.subscribe({next:be=>{switch(be?.code){case"ArrowDown":Xe(),be.preventDefault();break;case"ArrowUp":Xe(),be.preventDefault();break;case"Escape":Ue(),be.preventDefault();break}}});return()=>ve.unsubscribe()}),(0,n.jsxs)("div",{className:q.container,"data-testid":h.Tp.components.DataSourcePicker.container,children:[(0,n.jsx)("div",{className:q.trigger,onClick:()=>{Xe(),(0,g.rR)(w,{item:N.OPEN_DROPDOWN,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},children:(0,n.jsx)(v.p,{id:J||"data-source-picker",className:se?void 0:q.input,"data-testid":h.Tp.components.DataSourcePicker.inputV2,"aria-label":(0,r.t)("datasources.data-source-picker.aria-label-select-a-data-source","Select a data source"),autoComplete:"off",prefix:tt?ke:void 0,suffix:(0,n.jsx)(x.I,{name:te?"search":"angle-down"}),placeholder:_?"":(0,S.q7)(tt)||X,onFocus:()=>{ue(!0)},onBlur:()=>{ue(!1)},onKeyDown:ye,value:de,onChange:ve=>{Xe(),ie(ve.currentTarget.value),ve.currentTarget.value&&Pe(ve.currentTarget.value)},ref:Ae,disabled:Y})}),te?(0,n.jsxs)(f.ZL,{children:[(0,n.jsx)("div",{...We}),(0,n.jsx)("div",{ref:ce,...Be,..._e,children:(0,n.jsx)(A,{...Q,style:Ne,ref:Re.setFloating,footerRef:Te,current:tt,filterTerm:de,keyboardEvents:me,onChange:(ve,be)=>{Ue(),ve.uid!==tt?.uid&&(H(ve,be),(0,g.rR)(w,{item:N.SELECT_DS,ds_type:ve.type}))},onClose:Ue,onClickAddCSV:le,onDismiss:Ue,onNavigateOutsiteFooter:pe})})]}):null]})}function L(K,G){return{container:(0,a.css)({position:"relative",cursor:G.disabled?"not-allowed":"pointer",width:K.spacing(G.width||"auto")}),trigger:(0,a.css)({cursor:"pointer",pointerEvents:G.disabled?"none":"auto"}),input:(0,a.css)({"input::placeholder":{color:G.disabled?K.colors.action.disabledText:K.colors.text.primary}})}}const A=p.forwardRef((K,G)=>{const{filterTerm:H,onChange:_,onClose:k,onClickAddCSV:J,current:z,filter:Y}=K,X=(0,p.useCallback)(te=>{_(te)},[_]),Q=(0,p.useCallback)(()=>{J?.(),k(),(0,g.rR)(w,{item:N.ADD_FILE})},[J,k]),q=(0,y.of)(U);return(0,n.jsxs)("div",{style:K.style,ref:G,className:q.container,children:[(0,n.jsx)(u.P,{showScrollIndicators:!0,children:(0,n.jsx)(O.S,{...K,enableKeyboardNavigation:!0,className:q.dataSourceList,current:z,onChange:X,filter:te=>(Y?Y?.(te):!0)&&(0,S.Zn)(te,H),onClickEmptyStateCTA:()=>(0,g.rR)(w,{item:N.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,n.jsx)(i.n1,{children:(0,n.jsx)(F,{...K,onClickAddCSV:Q,onChange:X,onNavigateOutsiteFooter:K.onNavigateOutsiteFooter})})]})});A.displayName="PickerContent";function U(K){return{container:(0,a.css)({display:"flex",flexDirection:"column",background:K.colors.background.elevated,borderRadius:K.shape.radius.default,boxShadow:K.shadows.z3,overflow:"hidden"}),picker:(0,a.css)({background:K.colors.background.secondary}),dataSourceList:(0,a.css)({flex:1}),footer:(0,a.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:K.spacing(1.5),borderTop:`1px solid ${K.colors.border.weak}`,backgroundColor:K.colors.background.secondary})}}function F({onClose:K,onChange:G,onClickAddCSV:H,..._}){const k=(0,y.of)(V),J=_.uploadFile&&D.Ay.featureToggles.editPanelCSVDragAndDrop,z=X=>{X.key==="Tab"&&_.onNavigateOutsiteFooter(X)},Y=X=>{X.key==="Tab"&&X.shiftKey&&_.onNavigateOutsiteFooter(X)};return(0,n.jsxs)("div",{className:k.footer,children:[(0,n.jsx)(b.$s,{children:({showModal:X,hideModal:Q})=>(0,n.jsxs)(E.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{K(),X(B.p,{reportedInteractionFrom:"ds_picker",tracing:_.tracing,dashboard:_.dashboard,mixed:_.mixed,metrics:_.metrics,type:_.type,annotations:_.annotations,variables:_.variables,alerting:_.alerting,pluginId:_.pluginId,logs:_.logs,filter:_.filter,uploadFile:_.uploadFile,current:_.current,onDismiss:Q,onChange:(q,te)=>{G(q,te),Q()}}),(0,g.rR)(w,{item:N.OPEN_ADVANCED_DS_PICKER})},ref:_.footerRef,onKeyDown:J?Y:z,children:[(0,n.jsx)(r.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,n.jsx)(x.I,{name:"arrow-right"})]})}),J&&(0,n.jsx)(E.$n,{variant:"secondary",size:"sm",onClick:H,onKeyDown:z,children:(0,n.jsx)(r.x6,{i18nKey:"datasources.footer.add-csv-or-spreadsheet",children:"Add csv or spreadsheet"})})]})}function V(K){return{footer:(0,a.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:K.spacing(1.5),borderTop:`1px solid ${K.colors.border.weak}`,backgroundColor:K.colors.background.secondary})}}},7078:(Z,R,e)=>{"use strict";e.d(R,{Df:()=>l,Tj:()=>d,Zn:()=>i,q7:()=>o,tw:()=>c});var n=e(22429),a=e(77731),s=e(18615);function l(m,p){return!m||!p?!1:typeof p=="string"?m.uid===p:m.uid===p.uid}function o(m){if(m){if(typeof m=="string")return`${m} - not found`;if("name"in m)return m.name;if(m.uid)return`${m.uid} - not found`}}function d(m,p,h){return(g,y)=>{const v=g.name.toUpperCase(),x=y.name.toUpperCase();if(m&&l(g,m))return-1;if(m&&l(y,m))return 1;const f=p.indexOf(g.uid),u=p.indexOf(y.uid);if(f>-1&&f>u)return-1;if(u>-1&&u>f)return 1;const b=h.includes(g.uid),E=h.includes(y.uid);return b&&!E?-1:E&&!b||g.meta.builtIn&&!y.meta.builtIn?1:y.meta.builtIn&&!g.meta.builtIn||v<x?-1:1}}function i(m,p=""){return m.name.toLowerCase().includes(p.toLowerCase())}function c(m){if(!m.uid)return;const p=(0,n.UA)().getCurrent()?.uid??"";if(m.uid===s.uv)return(0,a.B1)(p);(0,a.dH)(p,m.uid)}},37946:(Z,R,e)=>{"use strict";e.d(R,{I:()=>n});const n={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},42227:(Z,R,e)=>{"use strict";e.d(R,{Kr:()=>d,TX:()=>o,dR:()=>c,ps:()=>i});var n=e(96540),a=e(78685),s=e(78282);const l="grafana.features.datasources.components.picker.DataSourceDropDown.history";function o(){const[m=[],p]=(0,a.A)(l,[]),h=(0,n.useCallback)(r=>{r.meta.builtIn||(m.includes(r.uid)?(m.splice(m.findIndex(g=>r.uid===g),1),p([...m,r.uid])):p([...m,r.uid].slice(1,6)))},[m,p]);return[m,h]}function d(m){return(0,s.l)().getList(m)}function i(m){const p=(0,s.l)();return p.getInstanceSettings(m)}function c(m){const{keyboardEvents:p,containerRef:h}=m,r=(0,n.useRef)(0),g="data-role",y="keyboardSelectableItem",v={[g]:y},x=`[${g}="${y}"`,f="data-selectedItem",u=`[${f}="true"]`,b=(0,n.useCallback)(D=>{const C=h?.current?.querySelectorAll(x),P=C?.item(D%C?.length);C?.forEach(T=>T.setAttribute(f,"false")),P&&(P.scrollIntoView({block:"center"}),P.setAttribute(f,"true"))},[h,x]),E=(0,n.useCallback)(()=>{h?.current?.querySelector(u)?.querySelector("button")?.click()},[h,u]);return(0,n.useEffect)(()=>{if(!p)return;const D=p.subscribe({next:C=>{switch(C?.code){case"ArrowDown":{b(++r.current),C.preventDefault();break}case"ArrowUp":r.current=r.current>0?r.current-1:r.current,b(r.current),C.preventDefault();break;case"Enter":E();break}}});return()=>D.unsubscribe()},[p,b,E]),(0,n.useEffect)(()=>{const D=new MutationObserver(C=>{C.some(T=>T.addedNodes&&T.addedNodes.length>0||T.removedNodes&&T.removedNodes.length>0)&&b(0)});return h.current&&D.observe(h.current,{childList:!0}),()=>{D.disconnect()}},[h,x,b]),[v,u]}},18548:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>O,Bs:()=>h,C_:()=>v,E1:()=>i,Gc:()=>m,IJ:()=>u,Ks:()=>b,QZ:()=>D,TN:()=>d,Tk:()=>x,UP:()=>P,eB:()=>g,f$:()=>p,gZ:()=>c,jz:()=>o,lg:()=>C,qR:()=>E,rb:()=>y});var n=e(65307),a=e(78479),s=e(92745);const l={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:a.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},o=(0,n.VP)("dataSources/dataSourceLoaded"),d=(0,n.VP)("dataSources/dataSourcesLoad"),i=(0,n.VP)("dataSources/dataSourcesLoaded"),c=(0,n.VP)("dataSources/dataSourceMetaLoaded"),m=(0,n.VP)("dataSources/dataSourcePluginsLoad"),p=(0,n.VP)("dataSources/dataSourcePluginsLoaded"),h=(0,n.VP)("dataSources/setDataSourcesSearchQuery"),r=(0,n.VP)("dataSources/setDataSourcesLayoutMode"),g=(0,n.VP)("dataSources/setDataSourceTypeSearchQuery"),y=(0,n.VP)("dataSources/setDataSourceName"),v=(0,n.VP)("dataSources/setIsDefault"),x=(0,n.VP)("dataSources/setIsSortAscending"),f=(I=l,j)=>d.match(j)?{...I,isLoadingDataSources:!0}:i.match(j)?{...I,isLoadingDataSources:!1,dataSources:j.payload,dataSourcesCount:j.payload.length}:o.match(j)?{...I,dataSource:j.payload}:h.match(j)?{...I,searchQuery:j.payload}:r.match(j)?{...I,layoutMode:j.payload}:m.match(j)?{...I,plugins:[],isLoadingDataSourcePlugins:!0}:p.match(j)?{...I,plugins:j.payload.plugins,categories:j.payload.categories,isLoadingDataSourcePlugins:!1}:g.match(j)?{...I,dataSourceTypeSearchQuery:j.payload}:c.match(j)?{...I,dataSourceMeta:j.payload}:y.match(j)?{...I,dataSource:{...I.dataSource,name:j.payload}}:v.match(j)?{...I,dataSource:{...I.dataSource,isDefault:j.payload}}:x.match(j)?{...I,isSortAscending:j.payload}:I,u={testingStatus:{},loadError:null,loading:!0,plugin:null},b=(0,n.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),E=(0,n.VP)("dataSourceSettings/initDataSourceSettingsFailed"),D=(0,n.VP)("dataSourceSettings/testDataSourceStarting"),C=(0,n.VP)("dataSourceSettings/testDataSourceSucceeded"),P=(0,n.VP)("dataSourceSettings/testDataSourceFailed"),O={dataSources:f,dataSourceSettings:(I=u,j)=>b.match(j)?{...I,plugin:j.payload,loadError:null,loading:!1}:E.match(j)?{...I,plugin:null,loadError:j.payload.message,loading:!1}:D.match(j)?{...I,testingStatus:{message:(0,s.t)("datasources.data-source-settings-reducer.message.testing-could-couple-minutes","Testing... this could take up to a couple of minutes"),status:"info"}}:C.match(j)?{...I,testingStatus:{status:j.payload?.status,message:j.payload?.message,details:j.payload?.details}}:P.match(j)?{...I,testingStatus:{status:"error",message:j.payload?.message,details:j.payload?.details}}:I}},54825:(Z,R,e)=>{"use strict";e.d(R,{K:()=>o});var n=e(76637),a=e(79118),s=e(11576),l=e(32503);function o(i,c,m){return d((0,l.UI)(i,c.field),c,m)}function d(i,c,m){if(!i){const r=m.visualization.getColorByName(c.fixed??"grey");return{isAssumed:!!c.field?.length||!c.fixed,fixed:r,value:()=>r,get:g=>r}}const p=(0,n.Qi)(i);if(p.isByValue||i.config.mappings?.length){const r=(0,a.xg)(i,!0);r!==i.config&&(i={...i,config:r},i.state=void 0);const g=(0,s.J)({field:i,theme:m}),y=v=>g(v).color??"#ccc";return{field:i,get:v=>y(i.values[v]),value:()=>y((0,l.sB)(i))}}const h=p.getCalculator(i,m)(0,0);return{fixed:h,value:()=>h,get:r=>h,field:i}}},71451:(Z,R,e)=>{"use strict";e.d(R,{n:()=>f});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(45861),i=e(97095),c=e(18027),m=e(63527),p=e(43533),h=e(2381),r=e(14226),g=e(30868),y=e(20012),v=e(4896),x=e(73304);const f=E=>{const{value:D,src:C,name:P,placeholder:T,onChange:O,onClear:I,mediaType:j,folderName:W,size:B,color:S,maxFiles:w}=E,N=(0,o.of)(b),M=(0,o.$j)(),L=(0,s.useRef)(null),A=G=>(0,n.jsx)(x.i,{onChange:O,value:D,mediaType:j,folderName:W,maxFiles:w,hidePopper:G.hidePopper});let U=C;!U&&D&&(U=(0,y.D)(D));const F=S&&{fill:M.visualization.getColorByName(S)},V=()=>D&&U?(0,n.jsx)(g.y,{src:U,className:N.icon,style:{...F}}):(0,n.jsx)(d.z9,{variant:"primary",fill:"text",size:"sm",children:(0,n.jsx)(l.x6,{i18nKey:"dimensions.resource-picker.render-small-resource-picker.set-icon",children:"Set icon"})}),K=()=>(0,n.jsx)(i.C,{children:(0,n.jsx)(c.I,{label:null,grow:!0,children:(0,n.jsx)(m.p,{value:u(C,P),placeholder:T,readOnly:!0,prefix:U&&(0,n.jsx)(g.y,{src:U,className:N.icon,style:{...F}}),suffix:(0,n.jsx)(d.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:I})})})});return(0,n.jsx)(p.I,{content:A,children:(G,H,_)=>(0,n.jsxs)(n.Fragment,{children:[L.current&&(0,n.jsx)(h.A,{..._,referenceElement:L.current,onMouseEnter:G,onKeyDown:k=>{(0,r.Q)(k,H)},hidePopper:H}),(0,n.jsxs)("div",{ref:L,className:N.pointer,onClick:G,onKeyDown:k=>{k.key==="Enter"&&G()},role:"button",tabIndex:0,children:[B===v.Iy.SMALL&&V(),B===v.Iy.NORMAL&&K()]})]})})};function u(E,D){if(E?.startsWith("public/build/img/icons")){const C=D?.lastIndexOf(".svg")??0;if(C>0)return D.substring(0,C)}return D}const b=E=>({pointer:(0,a.css)({cursor:"pointer","input[readonly]":{cursor:"pointer"}}),icon:(0,a.css)({verticalAlign:"middle",display:"inline-block",fill:"currentColor",width:"25px"})})},73304:(Z,R,e)=>{"use strict";e.d(R,{i:()=>U});var n=e(74848),a=e(22803),s=e(18828),l=e(42211),o=e(93225),d=e(96540),i=e(92745),c=e(68143),m=e(63142),p=e(45861),h=e(65642),r=e(4896),g=e(37386),y=e(40279),v=e(30868);function x({secondaryText:V="Drag and drop here or browse"}){const K=(0,m.of)(u);return(0,n.jsxs)("div",{className:K.iconWrapper,children:[(0,n.jsx)("small",{className:K.small,children:V}),(0,n.jsx)(p.$n,{type:"button",icon:"upload",children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.file-dropzone-custom-children.upload",children:"Upload"})})]})}const f=({mediaType:V,setFormData:K,setUpload:G,error:H})=>{const _=(0,m.of)(u),[k,J]=(0,d.useState)(!1),[z,Y]=(0,d.useState)(""),X=()=>(0,n.jsx)(g.D,{label:(0,i.t)("dimensions.file-uploader.preview.label-preview","Preview"),children:(0,n.jsxs)("div",{className:_.iconPreview,children:[V===r.zu.Icon&&(0,n.jsx)(v.y,{src:z,className:_.img}),V===r.zu.Image&&(0,n.jsx)("img",{src:z,alt:"Preview of the uploaded file",className:_.img})]})}),Q=te=>{fetch(`/api/storage/delete/upload/${te.file.name}`,{method:"DELETE"}).catch(ne=>console.error("cannot delete file",ne))},q=V==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,n.jsx)(y.gH,{readAs:"readAsBinaryString",onFileRemove:Q,options:{accept:q,multiple:!1,onDrop:te=>{let ne=new FormData;ne.append("file",te[0]),Y(URL.createObjectURL(te[0])),J(!0),K(ne),G(!0)}},children:H.message!==""&&k?(0,n.jsx)("p",{children:H.message}):k?(0,n.jsx)(X,{}):(0,n.jsx)(x,{})})};function u(V,K){return{container:(0,a.css)({display:"flex",flexDirection:"column",width:"100%"}),dropzone:(0,a.css)({display:"flex",flex:1,flexDirection:"column",alignItems:"center",padding:V.spacing(6),borderRadius:V.shape.radius.default,border:`2px dashed ${V.colors.border.medium}`,backgroundColor:K?V.colors.background.secondary:V.colors.background.primary,cursor:"pointer"}),iconWrapper:(0,a.css)({display:"flex",flexDirection:"column",alignItems:"center"}),acceptMargin:(0,a.css)({margin:V.spacing(2,0,1)}),small:(0,a.css)({color:V.colors.text.secondary,marginBottom:V.spacing(2)}),iconContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,a.css)({width:"238px",height:"198px",border:`1px solid ${V.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,a.css)({width:"147px",height:"147px",fill:V.colors.text.primary})}}var b=e(18857),E=e(12737),D=e(28998),C=e(70713),P=e(97222);const T=(0,d.memo)(function(K){const{columnIndex:G,rowIndex:H,style:_,data:k}=K,{cards:J,columnCount:z,onChange:Y,selected:X}=k,Q=G+H*z,q=J[Q],te=(0,m.of)(I);return(0,n.jsx)("div",{style:_,children:q&&(0,n.jsxs)("div",{className:X===q.value?(0,a.cx)(te.card,te.selected):te.card,onClick:()=>Y(q.value),onKeyDown:ne=>{ne.key==="Enter"&&Y(q.value)},role:"button",tabIndex:0,children:[q.imgUrl.endsWith(".svg")?(0,n.jsx)(v.y,{src:q.imgUrl,className:te.img}):(0,n.jsx)("img",{src:q.imgUrl,alt:"",className:te.img}),(0,n.jsx)("h6",{className:te.text,children:q.label.slice(0,-4)})]},q.value)})},P.t7),O=V=>{const{onChange:K,cards:G,value:H}=V,_=(0,m.of)(I);return(0,n.jsx)(C.Ay,{defaultWidth:680,children:({width:k,height:J})=>{const X=Math.floor(k/90),Q=Math.ceil(G.length/X);return(0,n.jsx)(P.yi,{width:k,height:J,columnCount:X,columnWidth:90,rowCount:Q,rowHeight:90,itemData:{cards:G,columnCount:X,onChange:K,selected:H},className:_.grid,children:T})}})},I=V=>({card:(0,a.css)({display:"inline-block",width:"90px",height:"90px",margin:"0.75rem",marginLeft:"15px",textAlign:"center",cursor:"pointer",position:"relative",backgroundColor:"transparent",border:"1px solid transparent",borderRadius:V.shape.radius.default,paddingTop:"6px",":hover":{borderColor:V.colors.action.hover,boxShadow:V.shadows.z2}}),selected:(0,a.css)({border:`2px solid ${V.colors.primary.main}`,":hover":{borderColor:V.colors.primary.main}}),img:(0,a.css)({width:"40px",height:"40px",objectFit:"cover",verticalAlign:"middle",fill:V.colors.text.primary}),text:(0,a.css)({color:V.colors.text.primary,whiteSpace:"nowrap",fontSize:"12px",textOverflow:"ellipsis",display:"block",overflow:"hidden"}),grid:(0,a.css)({border:`1px solid ${V.colors.border.medium}`})}),j=V=>V===r.zu.Icon?[r.Iu.Icon,r.Iu.IOT,r.Iu.Marker]:[r.Iu.BG],W=(V,K)=>V.find(G=>K.startsWith(G.value))??V[0],B=V=>{const{value:K,mediaType:G,folderName:H,newValue:_,setNewValue:k,maxFiles:J}=V,z=(0,m.of)(S),Y=j(G).map(he=>({label:he,value:he})),[X,Q]=(0,d.useState)(),[q,te]=(0,d.useState)(W(Y,K?.length?K:H)),[ne,se]=(0,d.useState)([]),[ue,de]=(0,d.useState)([]),ie=he=>{he?(he=he.toLowerCase(),de(ne.filter(me=>me.search.includes(he)))):de(ne)};return(0,d.useEffect)(()=>{const he=q?.value;if(he){const me=G===r.zu.Icon?ce=>ce.name.endsWith(".svg"):ce=>ce.name.endsWith(".png")||ce.name.endsWith(".gif");(0,D.tR)().get("-- Grafana --").then(ce=>{ce.listFiles(he,J).subscribe({next:Pe=>{const Ie=[];Pe.forEach(Se=>{if(me(Se)){const Me=Se.name.lastIndexOf(".");Ie.push({value:`${he}/${Se.name}`,label:Se.name,search:(Me?Se.name.substring(0,Me):Se.name).toLowerCase(),imgUrl:`public/${he}/${Se.name}`})}}),se(Ie),de(Ie)}})})}},[G,q,J]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{children:(0,n.jsx)(b.l6,{options:Y,onChange:te,value:q,menuShouldPortal:!1})}),(0,n.jsx)(g.D,{children:(0,n.jsx)(E.Z,{value:X??"",placeholder:(0,i.t)("dimensions.folder-picker-tab.placeholder-search","Search"),onChange:he=>{ie(he),Q(he)}})}),ue&&(0,n.jsx)("div",{className:z.cardsWrapper,children:(0,n.jsx)(O,{cards:ue,onChange:he=>k(he),value:_})})]})},S=V=>({cardsWrapper:(0,a.css)({height:"30vh",minHeight:"50px",marginTop:"5px",maxWidth:"680px"})});var w=e(63527),N=e(72636),M=e(20012);const L=V=>{const{newValue:K,setNewValue:G,mediaType:H}=V,_=(0,m.of)(A),k=(0,M.D)(K);let J=K?.substring(K.lastIndexOf("/")+1,K.lastIndexOf("."));return J.length>20&&(J=J.substring(0,20)+"..."),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{children:(0,n.jsx)(w.p,{onChange:z=>G(z.currentTarget.value),value:K})}),(0,n.jsxs)("div",{className:_.iconContainer,children:[(0,n.jsx)(g.D,{label:(0,i.t)("dimensions.urlpicker-tab.label-preview","Preview"),children:(0,n.jsxs)("div",{className:_.iconPreview,children:[H===r.zu.Icon&&(0,n.jsx)(v.y,{src:k,className:_.img}),H===r.zu.Image&&K&&(0,n.jsx)("img",{src:k,alt:"Preview of the selected URL",className:_.img})]})}),(0,n.jsx)(N.J,{children:J})]})]})},A=V=>({iconContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,a.css)({width:"238px",height:"198px",border:`1px solid ${V.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,a.css)({width:"147px",height:"147px",fill:V.colors.text.primary})}),U=V=>{const{value:K,onChange:G,mediaType:H,folderName:_,maxFiles:k,hidePopper:J}=V,z=(0,m.of)(F),Y=()=>{G(K),J?.()},X=(0,d.useRef)(null),{dialogProps:Q}=(0,s.s)({},X),{overlayProps:q}=(0,o.e)({onClose:Y,isDismissable:!0,isOpen:!0},X),te=K&&K.includes("://"),[ne,se]=(0,d.useState)(K??""),[ue,de]=(0,d.useState)(te?r.QC.URL:r.QC.Folder),[ie,he]=(0,d.useState)(new FormData),[me,ce]=(0,d.useState)(!1),[Pe,Ie]=(0,d.useState)({message:""}),Se=tt=>`${z.resourcePickerPopoverTab} ${ue===tt&&z.resourcePickerPopoverActiveTab}`,Me=()=>(0,n.jsx)(B,{value:K,mediaType:H,folderName:_,newValue:ne,setNewValue:se,maxFiles:k}),Te=()=>(0,n.jsx)(L,{newValue:ne,setNewValue:se,mediaType:H}),Ge=()=>(0,n.jsx)(f,{mediaType:H,setFormData:he,setUpload:ce,newValue:ne,error:Pe}),Qe=()=>{switch(ue){case r.QC.Folder:return Me();case r.QC.URL:return Te();case r.QC.Upload:return Ge();default:return Me()}};return(0,n.jsx)(l.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{ref:X,...q,...Q,children:(0,n.jsxs)("div",{className:z.resourcePickerPopover,children:[(0,n.jsxs)("div",{className:z.resourcePickerPopoverTabs,children:[(0,n.jsx)("button",{className:Se(r.QC.Folder),onClick:()=>de(r.QC.Folder),children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.resource-picker-popover.folder",children:"Folder"})}),(0,n.jsx)("button",{className:Se(r.QC.URL),onClick:()=>de(r.QC.URL),children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.resource-picker-popover.url",children:"URL"})})]}),(0,n.jsxs)("div",{className:z.resourcePickerPopoverContent,children:[Qe(),(0,n.jsxs)("div",{className:z.buttonRow,children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:()=>Y(),fill:"outline",children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.resource-picker-popover.cancel",children:"Cancel"})}),(0,n.jsx)(p.$n,{variant:ne&&ne!==K?"primary":"secondary",onClick:()=>{me?fetch("/api/storage/upload",{method:"POST",body:ie}).then(tt=>{if(tt.status>=400){tt.json().then(ke=>Ie(ke));return}else return tt.json()}).then(tt=>{(0,c.AI)().get(`api/storage/read/${tt.path}`).then(()=>se(`${h.$W.appUrl}api/storage/read/${tt.path}`)).then(()=>G(`${h.$W.appUrl}api/storage/read/${tt.path}`)).then(()=>J?.())}).catch(tt=>console.error(tt)):(G(ne),J?.())},children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.resource-picker-popover.select",children:"Select"})})]})]})]})})})},F=V=>({resourcePickerPopover:(0,a.css)({borderRadius:V.shape.radius.default,boxShadow:V.shadows.z3,background:V.colors.background.primary,border:`1px solid ${V.colors.border.weak}`}),resourcePickerPopoverTab:(0,a.css)({width:"50%",textAlign:"center",padding:V.spacing(1,0),background:V.colors.background.secondary,color:V.colors.text.secondary,fontSize:V.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}}),resourcePickerPopoverActiveTab:(0,a.css)({color:V.colors.text.primary,fontWeight:V.typography.fontWeightMedium,background:V.colors.background.primary}),resourcePickerPopoverContent:(0,a.css)({width:"315px",fontSize:V.typography.bodySmall.fontSize,minHeight:"184px",padding:V.spacing(1),display:"flex",flexDirection:"column"}),resourcePickerPopoverTabs:(0,a.css)({display:"flex",width:"100%",borderRadius:`${V.shape.radius.default} ${V.shape.radius.default} 0 0`}),buttonRow:(0,a.css)({display:"flex",justifyContent:"center",gap:V.spacing(2),padding:V.spacing(1)})})},20012:(Z,R,e)=>{"use strict";e.d(R,{$:()=>l,D:()=>s});var n=e(739),a=e(32503);function s(o){return o?o.indexOf(":/")>0?o:window.__grafana_public_path__+o:""}function l(o,d){const i=d.mode??n.q_.Fixed;if(i===n.q_.Fixed){const p=s(d.fixed);return{isAssumed:!p,fixed:p,value:()=>p,get:h=>p}}const c=(0,a.UI)(o,d.field);if(!c){const p="";return{isAssumed:!0,fixed:p,value:()=>p,get:h=>p}}if(i===n.q_.Mapping){const p=h=>s(`${h}`);return{field:c,get:h=>p(c.values[h]),value:()=>p((0,a.sB)(c))}}const m=p=>{if(c&&c.display){const h=c.display(p).icon;return s(h??"")}return""};return{field:c,get:p=>m(c.values[p]),value:()=>m((0,a.sB)(c))}}},57444:(Z,R,e)=>{"use strict";e.d(R,{H:()=>s});var n=e(739),a=e(32503);function s(o,d){return l((0,a.UI)(o,d?.field),d)}function l(o,d){if(!o){const m=d.fixed??0;return{isAssumed:!!d.field?.length||!d.fixed,fixed:m,value:()=>m,get:()=>m}}let i=m=>m%d.max;return d.mode===n.WQ.Clamped&&(i=m=>m<d.min?d.min:m>d.max?d.max:m),{field:o,get:m=>{const p=o.values[m];return p===null||typeof p!="number"?0:i(p)},value:()=>(0,a.sB)(o)}}},10392:(Z,R,e)=>{"use strict";e.d(R,{Nn:()=>d,Ru:()=>i,hX:()=>l});var n=e(79118),a=e(739),s=e(32503);function l(c,m){return o((0,s.UI)(c,m?.field),m)}function o(c,m,p){if(!c){const x=m.fixed??0;return{isAssumed:!!m.field?.length||!m.fixed,fixed:x,value:()=>x,get:()=>x}}const h=(0,n.AP)(c),r=m.max-m.min;if(c.values.length<1||r<=0||h.delta<=0)return{fixed:m.min,value:()=>m.min,get:()=>m.min};let y=x=>m.min+x*r;if(p===a.QH.Quad){const x=Math.PI*(m.max/2)**2,f=Math.PI*(m.min/2)**2,u=x-f;y=b=>{let E=f+u*b;return Math.sqrt(E/Math.PI)*2}}const v=x=>{const f=c.values[x];let u=0;return f!==-1/0&&(u=(f-h.min)/h.delta),u>1?u=1:u<0&&(u=0),y(u)};return{get:v,value:()=>v((0,s.sB)(c)),field:c}}function d(c){return c||(c={min:0,max:1}),c.min==null&&(c.min=0),c.max==null&&(c.max=1),c}function i(c,m){let{min:p,max:h}=d(m);if(c||(c={}),c.max==null&&(c.max=h),c.min==null&&(c.min=p),c.min>c.max){const r=c.max;c.max=c.min,c.min=r}return c.min<p&&(c.min=p),c.max>h&&(c.max=h),c.fixed==null&&(c.fixed=c.min+(c.max-c.min)/2),c.field||(c.fixed>h?c.fixed=h:c.fixed<p&&(c.fixed=p)),c}},28807:(Z,R,e)=>{"use strict";e.d(R,{E:()=>o});var n=e(95004),a=e(55386),s=e(739),l=e(32503);function o(i,c){const m=c.field?(0,l.UI)(i,c.field):i?.fields.find(p=>p.type===n.PU.string);return d(m,c)}function d(i,c){let m=c.fixed;const p=c.mode??s.RU.Fixed;if(p===s.RU.Fixed)return{isAssumed:!m,fixed:m,value:()=>m,get:r=>m};if(p===s.RU.Template){const r=g=>`TEMPLATE[${c.fixed} // ${g}]`;return i?{field:i,get:g=>r(i.values[g]),value:()=>r((0,l.sB)(i))}:(m=r(""),{isAssumed:!0,fixed:m,value:()=>m,get:g=>m})}if(!i)return{isAssumed:!0,fixed:m,value:()=>m,get:r=>m};let h=r=>(0,a.cN)(i.display(r));return{field:i,get:r=>h(i.values[r]),value:()=>h((0,l.sB)(i))}}},4896:(Z,R,e)=>{"use strict";e.d(R,{Iu:()=>s,Iy:()=>d,QC:()=>o,nG:()=>a,zu:()=>l});var n=e(739);const a=Object.freeze({fixed:"",mode:n.RU.Field,field:""});var s=(i=>(i.Icon="img/icons/unicons",i.IOT="img/icons/iot",i.Marker="img/icons/marker",i.BG="img/bg",i))(s||{}),l=(i=>(i.Icon="icon",i.Image="image",i))(l||{}),o=(i=>(i.Folder="folder",i.URL="url",i.Upload="upload",i))(o||{}),d=(i=>(i.SMALL="small",i.NORMAL="normal",i))(d||{})},32503:(Z,R,e)=>{"use strict";e.d(R,{B_:()=>r,UI:()=>y,Wb:()=>m,XV:()=>p,b5:()=>h,gG:()=>v,sB:()=>x,wv:()=>g});var n=e(16515),a=e(46644),s=e(43173),l=e(54825),o=e(20012),d=e(57444),i=e(10392),c=e(28807);function m(f,u){if(f?.series&&u.field)for(const b of f.series){const E=(0,l.K)(b,u,s.$.theme2);if(!E.isAssumed||f.series.length===1)return E}return(0,l.K)(void 0,u,s.$.theme2)}function p(f,u){if(f?.series&&u.field)for(const b of f.series){const E=(0,i.hX)(b,u);if(!E.isAssumed||f.series.length===1)return E}return(0,i.hX)(void 0,u)}function h(f,u){if(f?.series&&u.field)for(const b of f.series){const E=(0,d.H)(b,u);if(!E.isAssumed||f.series.length===1)return E}return(0,d.H)(void 0,u)}function r(f,u){if(f?.series&&u.field)for(const b of f.series){const E=(0,o.$)(b,u);if(!E.isAssumed||f.series.length===1)return E}return(0,o.$)(void 0,u)}function g(f,u){if(f?.series&&u.field)for(const b of f.series){const E=(0,c.E)(b,u);if(!E.isAssumed||f.series.length===1)return E}return(0,c.E)(void 0,u)}function y(f,u){const b=v(u,f);return b==null?void 0:f.fields[b]}function v(f,u,b){if(!(!u||!f?.length))for(let E=0;E<u.fields.length;E++){const D=u.fields[E];if(f===D.name)return E;const C=(0,n.Ct)(D,u,b);if(f===C)return E}}function x(f){const u=f.state?.calcs;if(u){const D=u[a.gy.lastNotNull];if(D!=null)return D}const b=f.values;let E=b.length-1;for(;E>=0;){const D=b[E--];if(D!=null)return D}}},97486:(Z,R,e)=>{"use strict";e.d(R,{k:()=>P});var n=e(74848),a=e(2543),s=e(96540),l=e(37297),o=e(64394),d=e(60519),i=e(16515),c=e(84229),m=e(60311),p=e(739),h=e(63142),r=e(64400),g=e(12241),y=e(78013),v=e(89381),x=e(1932);function f(T,O,I){return(0,x.jM)(T,j=>{j.defaults.custom===void 0&&(j.defaults.custom={}),j.defaults.max=I;const{custom:W}=j.defaults;switch(W.stacking===void 0&&(W.stacking={group:"A"}),O){case"lines":W.drawStyle=p.GR.Line,W.stacking.mode=p.gs.None,W.fillOpacity=0;break;case"bars":W.drawStyle=p.GR.Bars,W.stacking.mode=p.gs.None,W.fillOpacity=100;break;case"points":W.drawStyle=p.GR.Points,W.stacking.mode=p.gs.None,W.fillOpacity=0;break;case"stacked_lines":W.drawStyle=p.GR.Line,W.stacking.mode=p.gs.Normal,W.fillOpacity=100,W.axisSoftMin=0;break;case"stacked_bars":W.drawStyle=p.GR.Bars,W.stacking.mode=p.gs.Normal,W.fillOpacity=100,W.axisSoftMin=0;break;default:{const B=O;throw new Error(`Invalid graph-style: ${B}`)}}})}function u(T,O,I){return(0,x.jM)(T,j=>{j.defaults.thresholds=I,j.defaults.custom=j.defaults.custom??{},j.defaults.custom.thresholdsStyle=O})}var b=e(56737),E=e(84596),D=e(76732);function C(T){const[O,{inc:I}]=(0,b.A)(1),j=(0,E.A)(T);return(0,s.useMemo)(()=>{j&&!(0,D.J3)(T,j,D.bW)&&I()},[T,j,I]),O}function P({data:T,height:O,width:I,timeZone:j,timeRange:W,onChangeTime:B,loadingState:S,annotations:w,onHiddenSeriesChanged:N,splitOpenFn:M,graphStyle:L,tooltipDisplayMode:A=p.$N.Single,anchorToZero:U=!1,yAxisMaximum:F,thresholdsConfig:V,thresholdsStyle:K,eventBus:G,vizLegendOverrides:H,toggleLegendRef:_}){const k=(0,h.$j)(),J=(0,s.useMemo)(()=>(0,l.O)((0,g.V)(g.S),"Explore"),[]),[z,Y]=(0,s.useState)({defaults:{min:U?0:void 0,max:F||void 0,unit:"short",color:{mode:o.Y.PaletteClassic},custom:{drawStyle:p.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),X=(0,s.useMemo)(()=>{const he=f(z,L,F);return u(he,K,V)},[z,L,F,V,K]),Q=(0,v.h)(M,W),q=(0,s.useMemo)(()=>(0,d.we)({fieldConfig:X,data:T,timeZone:j,replaceVariables:he=>he,theme:k,fieldConfigRegistry:J,dataLinkPostProcessor:Q}),[J,T,j,k,X,Q]),te=(0,s.useMemo)(()=>(0,d.we)({fieldConfig:{defaults:{},overrides:[]},data:w,timeZone:j,replaceVariables:he=>he,theme:k,dataLinkPostProcessor:Q}),[w,j,k,Q]),ne=C(q),se=(0,s.useRef)(void 0);(0,s.useEffect)(()=>{if(!N)return;const he=[];q.forEach(me=>{me.fields.map(Pe=>Pe.config?.custom?.hideFrom?.viz).every(a.identity)&&he.push((0,i.Ri)(me))}),(se.current===void 0||!(0,a.isEqual)((0,a.sortBy)(he),(0,a.sortBy)(se.current)))&&(se.current=he,N(he))},[q,N]);const ue={eventsScope:"explore",eventBus:G,sync:()=>c.y.Off,onToggleSeriesVisibility(he,me){Y((0,y.M)(he,me,z,T))},dataLinkPostProcessor:Q};function de(he,me){if(!he){Y({...z,overrides:[]});return}Y((0,y.M)(he,me,z,T))}_&&(_.current=de);const ie=(0,s.useMemo)(()=>({tooltip:{mode:A,sort:p.xB.None},legend:{displayMode:p.lm.List,showLegend:!0,placement:"bottom",calcs:[],...H}}),[A,H]);return(0,n.jsx)(r.XF,{value:ue,children:(0,n.jsx)(m.m,{data:{series:q,timeRange:W,state:S,annotations:te,structureRev:ne},pluginId:"timeseries",title:"",width:I,height:O,onChangeTimeRange:B,timeZone:j,options:ie})})}},5929:(Z,R,e)=>{"use strict";e.d(R,{y:()=>E});var n=e(74848),a=e(96540),s=e(42941),l=e(92745),o=e(67522),d=e(15757),i=e(83953),c=e(97486),m=e(77824),p=e(72265);const h=p.sG.map(D=>({value:D,label:D[0].toUpperCase()+D.slice(1).replace(/_/," ")}));function r(D){const{graphStyle:C,onChangeGraphStyle:P}=D;return(0,n.jsx)(m.z,{size:"sm",options:h,value:C,onChange:P})}var g=e(29043);const y="grafana.explore.style.graph",v=D=>{store.set(y,D)},x=()=>u(g.A.get(y)),f="lines",u=D=>p.sG.find(P=>P===D)??f,b=20,E=({data:D,eventBus:C,height:P,width:T,timeRange:O,timeZone:I,annotations:j,onChangeTime:W,splitOpenFn:B,thresholdsConfig:S,thresholdsStyle:w,loadingState:N,statusMessage:M})=>{const[L,A]=(0,s.A)(!1),[U,F]=(0,a.useState)(x),V=(0,a.useCallback)(G=>{(0,i.ng)(G),F(G)},[]),K=(0,a.useMemo)(()=>L?D:D.slice(0,b),[D,L]);return(0,n.jsx)(o.NR,{title:(0,l.t)("graph.container.title","Graph"),titleItems:[!L&&b<D.length&&(0,n.jsx)(d.m,{toggleShowAllSeries:A,info:(0,n.jsxs)(l.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:b}," series"]}),buttonLabel:(0,n.jsxs)(l.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:D.length}]}),tooltip:(0,l.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},"disclaimer")].filter(Boolean),width:T,height:P,loadingState:N,statusMessage:M,actions:(0,n.jsx)(r,{graphStyle:U,onChangeGraphStyle:V}),children:(G,H)=>(0,n.jsx)(c.k,{graphStyle:U,data:K,height:H,width:G,timeRange:O,onChangeTime:W,timeZone:I,annotations:j,splitOpenFn:B,loadingState:N,thresholdsConfig:S,thresholdsStyle:w,eventBus:C})})}},15757:(Z,R,e)=>{"use strict";e.d(R,{m:()=>i});var n=e(74848),a=e(22803),s=e(63142),l=e(30703),o=e(45967),d=e(45861);function i(m){const{toggleShowAllSeries:p,info:h,tooltip:r,buttonLabel:g}=m,y=(0,s.of)(c);return(0,n.jsxs)("div",{className:y.disclaimer,children:[(0,n.jsxs)("span",{className:y.warningMessage,children:[(0,n.jsx)(l.I,{name:"exclamation-triangle","aria-hidden":"true"}),h]}),(0,n.jsx)(o.m,{content:r,children:(0,n.jsx)(d.$n,{variant:"secondary",size:"sm",onClick:p,children:g})})]},"disclaimer")}const c=m=>({disclaimer:(0,a.css)({label:"series-disclaimer",display:"flex",alignItems:"center",gap:m.spacing(1)}),warningMessage:(0,a.css)({display:"flex",alignItems:"center",gap:m.spacing(.5),color:m.colors.warning.main,fontSize:m.typography.bodySmall.fontSize})})},67155:(Z,R,e)=>{"use strict";e.d(R,{O:()=>y,v:()=>x});var n=e(74848),a=e(96540),s=e(75505),l=e(41119),o=e(739),d=e(60519),i=e(95004),c=e(2197),m=e(39443),p=e(43173),h=e(24343),r=e(36100),g=e(78529);function y(E){const{timeZone:D,splitOpen:C,range:P,logsSortOrder:T,width:O,dataFrame:I,columnsWithMeta:j,logsFrame:W}=E,[B,S]=(0,a.useState)(void 0),w=W?.timeField.index,N=(0,a.useCallback)(L=>{if(!L.length)return L;const A=(0,l.ES)(L,w,T===o.uH.Descending),[U]=(0,d.we)({data:[A],timeZone:D,theme:p.$.theme2,replaceVariables:F=>F,fieldConfig:{defaults:{custom:{}},overrides:[]}});for(const F of U.fields)F.getLinks=V=>(0,g.QL)({field:F,rowIndex:V.valueRowIndex,splitOpenFn:C,range:P,dataFrame:A}),F.config={...F.config,custom:{inspect:!0,filterable:!0,width:b(F),...F.config.custom},filterable:v(F,W?.bodyField.name??"",W?.timeField.name??"")},F.type=F.type===i.PU.string?(0,l.dF)(F)??i.PU.string:F.type;return U},[T,D,C,P,W?.bodyField.name,W?.timeField.name,w]);if((0,a.useEffect)(()=>{(async()=>{if(!W?.timeField.name||!W?.bodyField.name){S(void 0);return}const A=x(I);let U=f(j);const F=u(U);if(F?A.push(F):A.push({id:"organize",options:{indexByName:{[W.bodyField.name]:0,[W.timeField.name]:1},includeByName:{[W.bodyField.name]:!0,[W.timeField.name]:!0}}}),A.length>0){const V=await(0,s.s)((0,c.m)(A,[I])),K=N(V[0]);S(K)}else S(N(I))})()},[j,I,T,N,W?.bodyField.name,W?.timeField.name]),!B)return null;const M=L=>{const{value:A,key:U,operator:F}=L,{onClickFilterLabel:V,onClickFilterOutLabel:K}=E;!V||!K||(F===r.mc&&V(U,A,I),F===r.Zi&&K(U,A,I))};return(0,n.jsx)(h.X,{data:B,width:O,onCellFilterAdded:E.onClickFilterLabel&&E.onClickFilterOutLabel?M:void 0,height:E.height,footerOptions:{show:!0,reducer:["count"],countRows:!0},initialSortBy:[{displayName:W?.timeField.name||"",desc:T===o.uH.Descending}]})}const v=(E,D,C)=>!(!D||!C||D===E.name||C===E.name||E.config.links?.length);function x(E){return E.fields.filter(D=>{const C=D.typeInfo?.frame==="json.RawMessage"&&D.name==="labels"&&E?.meta?.type!==m.m.LogLines,P=D.name==="labels"&&D.type===i.PU.other&&E?.meta?.type===m.m.LogLines;return C||P}).flatMap(D=>[{id:"extractFields",options:{format:"json",keepTime:!1,replace:!1,source:D.name}}])}function f(E){let D={};return Object.keys(E).filter(C=>E[C].active).forEach(C=>{const P=E[C].index;P!==void 0&&(D[C]=P)}),D}function u(E){let D={};for(const C in E)D[C]=!0;return Object.keys(E).length>0?{id:"organize",options:{indexByName:E,includeByName:D}}:null}function b(E){if(E.type===i.PU.time)return 200}},44720:(Z,R,e)=>{"use strict";e.d(R,{a:()=>i,d:()=>c});var n=e(74848),a=e(22803),s=e(34734),l=e(63142),o=e(3642);const d=(m,p)=>({valueNavigation:(0,a.css)({width:o.QH,fontWeight:"bold"}),valueNavigationWrapper:(0,a.css)({display:"flex",justifyContent:"flex-end"}),itemLabelsWrap:(0,a.css)({borderBottom:p?`1px solid ${m.colors.border.medium}`:""})}),i=m=>m.includes(s.gs)?m.replace(s.gs,""):m,c=({valueLabels:m,expanded:p})=>{const h=(0,l.of)(d,p);return(0,n.jsx)("div",{className:h.itemLabelsWrap,children:(0,n.jsx)("div",{className:h.valueNavigationWrapper,children:m.map((r,g)=>(0,n.jsx)("span",{className:h.valueNavigation,children:i(r.name)},r.name))})})}},3642:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>C,QH:()=>f,Jd:()=>u});var n=e(74848),a=e(22803),s=e(73287),l=e(92745),o=e(31200),d=e(27489),i=e(63142),c=e(76319),m=e(44720),p=e(53593);const h=(P,T)=>({rowWrapper:(0,a.css)({position:"relative",minWidth:f,paddingRight:"5px"}),rowValue:(0,a.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",display:"block",paddingRight:"10px","&::-webkit-scrollbar":{display:"none"},"&:before":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - 25px), ${P.colors.background.primary})`}}),rowValuesWrap:(0,a.css)({paddingLeft:u,width:`calc(${T} * ${f})`,display:"flex"})}),r=({totalNumberOfValues:P,values:T,hideFieldsWithoutValues:O})=>{const I=(0,i.of)(h,P);return(0,n.jsx)("div",{role:"cell",className:I.rowValuesWrap,children:T?.map(j=>O&&(j.value===void 0||j.value===p.M)?null:(0,n.jsx)("span",{className:I.rowWrapper,children:(0,n.jsx)("span",{className:I.rowValue,children:j.value})},j.key))})},g=P=>{const T=P.isDark?"#ce9178":"#a31515",O=P.isDark?"#73bf69":"#56a64b";return{metricName:(0,a.css)({color:O}),metricValue:(0,a.css)({color:T}),expanded:(0,a.css)({display:"block",textIndent:"1em"})}},v=({value:P,index:T,length:O,isExpandedView:I})=>{const j=(0,i.of)(g),W=P.key,B=P.value;return(0,n.jsxs)("span",{className:I?j.expanded:"",children:[(0,n.jsx)("span",{className:j.metricName,children:W}),(0,n.jsx)("span",{children:"="}),(0,n.jsx)("span",{children:'"'}),(0,n.jsx)("span",{className:j.metricValue,children:B}),(0,n.jsx)("span",{children:'"'}),T<O-1&&(0,n.jsx)("span",{children:", "})]},T)},x="20px",f="80px",u="25px",b=(P,T,O)=>({rowWrapper:(0,a.css)({borderBottom:`1px solid ${P.colors.border.medium}`,display:"flex",position:"relative",paddingLeft:"22px",alignItems:O?"":"center",height:O?"":"100%"}),copyToClipboardWrapper:(0,a.css)({position:"absolute",left:0,bottom:O?"":"0",top:O?"4px":"0",margin:"auto",zIndex:1,height:"16px",width:"16px"}),rowLabelWrapWrap:(0,a.css)({position:"relative",width:`calc(100% - (${T} * ${f}) - ${u})`}),rowLabelWrap:(0,a.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",paddingRight:x,"&::-webkit-scrollbar":{display:"none"},"&:after":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - ${x}), ${P.colors.background.primary})`}})});function E(P){let T=[],O=[];for(const I in P)I in P&&P[I]&&!I.includes("Value")?T.push({key:I,value:P[I]}):I in P&&P[I]&&I.includes("Value")&&O.push({key:I,value:P[I]});return{values:O,attributeValues:T}}const C=({listItemData:P,listKey:T,totalNumberOfValues:O,valueLabels:I,isExpandedView:j})=>{const{__name__:W,...B}=P,S=(0,o.Rq)(W),[w,N]=(0,s.A)(),M=I?.length??O,L=(0,i.of)(b,M,j),{values:A,attributeValues:U}=E(B),F=G=>G==="\u221E"||G==="Infinity"?"+Inf":G,V=`${S?W:""}{${S?"":`"${W}", `}${U.map(G=>`${(0,o.Nc)(G.key)}="${F(G.value)}"`)}}`,K=!!(I&&I?.length);return(0,n.jsxs)(n.Fragment,{children:[I!==void 0&&j&&(0,n.jsx)(m.d,{valueLabels:I,expanded:j}),(0,n.jsxs)("div",{className:L.rowWrapper,children:[(0,n.jsx)("span",{className:L.copyToClipboardWrapper,children:(0,n.jsx)(c.K,{tooltip:(0,l.t)("explore.raw-list-item.tooltip-copy-to-clipboard","Copy to clipboard"),onClick:()=>{(0,d.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),N(V)},name:"copy"})}),(0,n.jsx)("span",{role:"cell",className:L.rowLabelWrapWrap,children:(0,n.jsxs)("div",{className:L.rowLabelWrap,children:[S&&(0,n.jsx)("span",{children:W}),(0,n.jsx)("span",{children:"{"}),!S&&W!==""&&(0,n.jsxs)("span",{children:['"',W,'"',", "]}),(0,n.jsx)("span",{children:U.map((G,H)=>(0,n.jsx)(v,{isExpandedView:j,value:G,index:H,length:U.length},H))}),(0,n.jsx)("span",{children:"}"})]})}),(0,n.jsx)(r,{hideFieldsWithoutValues:K,totalNumberOfValues:M,values:A})]},T)]})}},53593:(Z,R,e)=>{"use strict";e.d(R,{E:()=>s,M:()=>a});var n=e(55386);const a=" ",s=l=>{const o={},d=[],i=l.fields.filter(p=>!["Time"].includes(p.name));let c=i.find(p=>p.name==="__name__")?.values??[];!c.length&&i.length&&i[0].values.length&&(c=Array(i[0].values.length).fill(""));const m=l.fields.filter(p=>!["__name__"].includes(p.name));return c.forEach(function(p,h){o[p]={};const r=o[p][h]??{};for(const g of m){const y=g.name;if(y!=="Time")if(typeof g?.display=="function"){const v=g?.display(g.values[h]);if(!isNaN(v.numeric))r[y]=v.numeric.toString(10);else{const x=(0,n.cN)(v);x?r[y]=x:y.includes("Value #")&&(r[y]=a)}}else console.warn("Field display method is missing!")}d.push({...r,__name__:p})}),d}},52830:(Z,R,e)=>{"use strict";e.d(R,{YZ:()=>c,sz:()=>i,tU:()=>o});var n=e(74848),a=e(96540),s=e(52763),l=e(20718),o=(m=>(m.RichHistory="Query history",m.Starred="Starred",m.Settings="Settings",m))(o||{});const d=(0,a.createContext)({selectedTab:"Query history",setSelectedTab:()=>{},drawerOpened:!1,setDrawerOpened:()=>{}});function i(){return(0,a.useContext)(d)}function c({children:m}){const[p,h]=(0,a.useState)("Query history"),[r,g]=(0,a.useState)(!1),y=(0,s.d4)(l.i6);return(0,a.useEffect)(()=>{y&&h(y.starredTabAsFirstTab?"Starred":"Query history")},[y,h]),(0,n.jsx)(d.Provider,{value:{selectedTab:p,setSelectedTab:h,drawerOpened:r,setDrawerOpened:g},children:m})}},98838:(Z,R,e)=>{"use strict";e.d(R,{L:()=>a,Y:()=>s});var n=e(96540);const a=(0,n.createContext)({openDrawer:()=>{},closeDrawer:()=>{},isDrawerOpen:!1,openAddQueryModal:()=>{},closeAddQueryModal:()=>{},renderSaveQueryButton:()=>null,queryLibraryEnabled:!1});function s(){return(0,n.useContext)(a)}},55555:(Z,R,e)=>{"use strict";e.d(R,{g:()=>s});var n=e(74848),a=e(25229);const s=({timeInMs:o,className:d,humanize:i})=>(0,n.jsx)("span",{className:d,children:l(o,i)}),l=(o,d=!1)=>{const i=o/1e3;if(!d)return`${i.toFixed(1)}s`;const c=(0,a.Ah)(i,"seconds"),m=c.hours(),p=c.minutes(),h=c.seconds();return m?`${m}h ${p}m ${h}s`:p?`${p}m ${h}s`:`${h}s`}},49987:(Z,R,e)=>{"use strict";e.d(R,{H:()=>A});var n=e(74848),a=e(2543),s=e(96540),l=e(49785),o=e(92745),d=e(27489),i=e(37386),c=e(77824),m=e(34999),p=e(22787),h=e(45861),r=e(95506),g=e(73427),y=e(11257),v=e(92138),x=e(43173),f=e(36490),u=e(29043),b=e(65635),E=e(6262),D=(U=>(U.UNKNOWN="unknown-error",U.NAVIGATION="navigation-error",U))(D||{}),C=(U=>(U.FETCH_DASHBOARD="fetch-dashboard",U.SET_DASHBOARD_LS="set-dashboard-ls-error",U))(C||{});function P({panel:U,dashboardUid:F,openInNewTab:V,timeRange:K}){let G={meta:{},dashboard:{title:"",uid:"",panels:[U],schemaVersion:b.O2}};if(K){const _=K.raw;G.dashboard.time={from:typeof _.from=="string"?_.from:_.from.toISOString(),to:typeof _.to=="string"?_.to:_.to.toISOString()}}try{u.A.setObject(E.us,G)}catch{return{error:"set-dashboard-ls-error",message:(0,o.t)("dashboard-scene.add-to-dashboard.message.could-panel-dashboard-please-again","Could not add panel to dashboard. Please try again.")}}const H=T(F);if(V)return!e.g.open(x.$.appUrl+H,"_blank")?(u.A.delete(E.us),{error:"navigation-error",message:(0,o.t)("dashboard-scene.add-to-dashboard.message.could-navigate-selected-dashboard-please-again","Could not navigate to the selected dashboard. Please try again.")}):void 0;f.Ny.push(v.I.stripBaseFromUrl(H))}function T(U){return U?`d/${U}`:"dashboard/new"}var O=(U=>(U.NewDashboard="new-dashboard",U.ExistingDashboard="existing-dashboard",U))(O||{});function I({onClose:U,buildPanel:F,timeRange:V,options:K,children:G}){const[H,_]=(0,s.useState)(),{handleSubmit:k,control:J,formState:{errors:z},watch:Y}=(0,l.mN)({defaultValues:{saveTarget:"new-dashboard"}}),X=g.TP.hasPermission(y.w.DashboardsCreate),Q=g.TP.hasPermission(y.w.DashboardsWrite),q=[];X&&q.push({label:(0,o.t)("dashboard-scene.add-to-dashboard-form.label.new-dashboard","New dashboard"),value:"new-dashboard"}),Q&&q.push({label:(0,o.t)("dashboard-scene.add-to-dashboard-form.label.existing-dashboard","Existing dashboard"),value:"existing-dashboard"});const te=q.length>1?Y("saveTarget"):q[0].value,ne=(se,ue)=>{_(void 0);const de=ue.saveTarget==="existing-dashboard"?ue.dashboardUid:void 0,ie=F(K);(0,d.rR)("e_2_d_submit",{newTab:se,saveTarget:ue.saveTarget,queries:ie.targets});const he=P({dashboardUid:de,panel:ie,openInNewTab:se,timeRange:V});if(he){_(he);return}U()};return(0,s.useEffect)(()=>{(0,d.rR)("e_2_d_open")},[]),(0,n.jsxs)("form",{children:[G,q.length>1&&(0,n.jsx)(l.xI,{control:J,render:({field:{ref:se,...ue}})=>(0,n.jsx)(i.D,{label:(0,o.t)("dashboard-scene.add-to-dashboard-form.label-target-dashboard","Target dashboard"),description:(0,o.t)("dashboard-scene.add-to-dashboard-form.description-choose-where-to-add-the-panel","Choose where to add the panel."),children:(0,n.jsx)(c.z,{options:q,...ue,id:"e2d-save-target"})}),name:"saveTarget"}),te==="existing-dashboard"&&(0,n.jsx)(l.xI,{render:({field:{ref:se,value:ue,onChange:de,...ie}})=>(0,n.jsx)(i.D,{label:(0,o.t)("dashboard-scene.add-to-dashboard-form.label-dashboard","Dashboard"),description:(0,o.t)("dashboard-scene.add-to-dashboard-form.description-select-which-dashboard-panel-created","Select in which dashboard the panel will be created."),error:z.dashboardUid?.message,invalid:!!z.dashboardUid,children:(0,n.jsx)(r.b,{...ie,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:he=>de(he?.uid)})}),control:J,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:(0,o.t)("dashboard-scene.add-to-dashboard-form.message.this-field-is-required","This field is required.")}}}),H&&(0,n.jsx)(m.F,{severity:"error",title:(0,o.t)("dashboard-scene.add-to-dashboard-form.title-error-adding-the-panel","Error adding the panel"),children:H.message}),(0,n.jsxs)(p.a.ButtonRow,{children:[(0,n.jsx)(h.$n,{type:"reset",onClick:U,fill:"outline",variant:"secondary",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(h.$n,{type:"submit",variant:"secondary",onClick:k((0,a.partial)(ne,!0)),icon:"external-link-alt",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.open-in-new-tab",children:"Open in new tab"})}),(0,n.jsx)(h.$n,{type:"submit",variant:"primary",onClick:k((0,a.partial)(ne,!1)),icon:"apps",children:(0,n.jsx)(o.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.open-dashboard",children:"Open dashboard"})})]})]})}function j(U){}var W=e(52763),B=e(20718);function S(U,F){let V=[];return U==="table"&&F.panelState?.logs?.columns&&(F.panelState.logs?.labelFieldName&&V.push({id:"extractFields",options:{source:F.panelState.logs.labelFieldName}}),V.push({id:"organize",options:{indexByName:Object.values(F.panelState.logs.columns).reduce((K,G,H)=>({...K,[G]:H}),{}),includeByName:Object.values(F.panelState.logs.columns).reduce((K,G)=>({...K,[G]:!0}),{})}})),V}function w(U){const F=L(U.queries,U.queryResponse,U?.panelState);return{targets:U.queries,type:F,title:(0,o.t)("explore.build-dashboard-panel-from-explore-state.title.new-panel","New Panel"),gridPos:{x:0,y:0,w:12,h:8},datasource:U.datasource,transformations:S(F,U)}}const N=U=>!U.hide,M=U=>F=>F.refId===U;function L(U,F,V){for(const{refId:K}of U.filter(N)){const G=M(K);if(F.flameGraphFrames.some(G))return"flamegraph";if(F.graphFrames.some(G))return"timeseries";if(F.logsFrames.some(G))return V?.logs?.visualisationType?V.logs.visualisationType:"logs";if(F.nodeGraphFrames.some(G))return"nodeGraph";if(F.traceFrames.some(G))return"traces";if(F.customFrames.some(G))return F.customFrames.find(G)?.meta?.preferredVisualisationPluginId??"table"}return"table"}function A(U){const{exploreId:F,onClose:V}=U,K=(0,W.d4)((0,B.qq)(F)),G=()=>w({datasource:K.datasourceInstance?.getRef(),queries:K.queries,queryResponse:K.queryResponse,panelState:K?.panelsState});return(0,n.jsx)(I,{onClose:V,buildPanel:G,timeRange:K.range,options:void 0})}},39338:(Z,R,e)=>{"use strict";e.d(R,{t:()=>s});var n=e(15130),a=e(11257);function s(){const l=n.TP.hasPermission(a.w.DashboardsCreate),o=n.TP.hasPermission(a.w.DashboardsWrite);return l&&!o?"Add panel to new dashboard":o&&!l?"Add panel to existing dashboard":"Add panel to dashboard"}},20806:(Z,R,e)=>{"use strict";e.d(R,{s:()=>c});var n=e(74848),a=e(92138),s=e(92745),l=e(36490),o=e(22787),d=e(41654),i=e(45861);function c(m){const{onDismiss:p,path:h,title:r}=m,g=()=>{e.g.open(a.I.assureBaseUrl(h),"_blank"),p()},y=()=>l.Ny.push(h);return(0,n.jsxs)(o.a,{title:r,isOpen:!0,onDismiss:p,children:[(0,n.jsx)(d.B,{direction:"column",gap:1,children:(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.new-tab",children:"Do you want to proceed in the current tab or open a new tab?"})})}),(0,n.jsxs)(o.a.ButtonRow,{children:[(0,n.jsx)(i.$n,{onClick:p,fill:"outline",variant:"secondary",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.cancel",children:"Cancel"})}),(0,n.jsx)(i.$n,{type:"submit",variant:"secondary",onClick:g,icon:"external-link-alt",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.open-in-new-tab",children:"Open in new tab"})}),(0,n.jsx)(i.$n,{type:"submit",variant:"primary",onClick:y,icon:"apps",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.open",children:"Open"})})]})]})}},9860:(Z,R,e)=>{"use strict";e.d(R,{w:()=>o});var n=e(74848),a=e(96540),s=e(87063),l=e(3260);function o({extensions:c,onSelect:m}){const{categorised:p,uncategorised:h}=i(c),r=h.length>0&&Object.keys(p).length>0;return(0,n.jsx)(s.W,{children:(0,n.jsxs)(n.Fragment,{children:[Object.keys(p).map(g=>(0,n.jsx)(s.W.Group,{label:(0,l.pL)(g,25),children:d(p[g],m)},g)),r&&(0,n.jsx)(s.W.Divider,{},"divider"),d(h,m)]})})}function d(c,m){return c.map(p=>(0,n.jsx)(s.W.Item,{ariaLabel:p.title,icon:p?.icon||"plug",label:(0,l.pL)(p.title,25),onClick:h=>{if(p.path)return m(p);p.onClick?.(h)}},p.id))}function i(c){return(0,a.useMemo)(()=>{const m=[],p={};for(const h of c){if(!h.category){m.push(h);continue}Array.isArray(p[h.category])||(p[h.category]=[]),p[h.category].push(h)}return{uncategorised:m,categorised:p}},[c])}},89381:(Z,R,e)=>{"use strict";e.d(R,{h:()=>s});var n=e(96540),a=e(78529);const s=(l,o)=>(0,n.useMemo)(()=>(0,a.YV)(l,o),[l,o])},55133:(Z,R,e)=>{"use strict";e.d(R,{m:()=>z,s:()=>X});var n=e(96540),a=e(27963),s=e(64762),l=e(52763),o=e(20718),d=e(2513);const i={parse:Q=>{if(!Q.left&&!Q.right)return{to:{left:{datasource:null,queries:[],range:{from:d.k.from,to:d.k.to}},schemaVersion:0},error:!1};let q,te,ne,se;return typeof Q.left=="string"&&([q,ne]=h(Q.left)),typeof Q.right=="string"?[te,se]=h(Q.right):Q.right&&(te=p,se=!0),q||(q=p),{to:{schemaVersion:0,left:q,...te&&{right:te}},error:!!ne||!!se}}},c=(Q,...q)=>q.some(te=>Q.hasOwnProperty(te));var m=(Q=>(Q[Q.RangeFrom=0]="RangeFrom",Q[Q.RangeTo=1]="RangeTo",Q[Q.Datasource=2]="Datasource",Q[Q.SegmentsStart=3]="SegmentsStart",Q))(m||{});const p={datasource:null,queries:[],range:d.k};function h(Q){let q;try{q=JSON.parse(Q)}catch{return[p,!0]}if(!Array.isArray(q))return[{queries:[],range:d.k,...q},!1];if(q.length<=3)return[p,!0];const te={from:q[0],to:q[1]},ne=q[2],se=q.slice(3),ue=se.filter(ie=>!c(ie,"ui","mode","__panelsState")),de=se.find(ie=>c(ie,"__panelsState"))?.__panelsState;return[{datasource:ne,queries:ue,range:te,panelsState:de},!1]}var r=e(62635),g=e(8692);const y={parse:Q=>{if(!Q||!Q.panes||typeof Q.panes!="string")return{to:{schemaVersion:1,panes:{[(0,r.o$)()]:v}},error:!1};let q;try{q=JSON.parse(Q.panes)}catch{}if(q==null||typeof q!="object")return{to:{schemaVersion:1,panes:{[(0,r.o$)()]:v}},error:!0};const te=Object.entries(q).map(([ne,se])=>[ne,x(se)]).reduce((ne,[se,ue])=>{let de=se;return(de.length!==3||/^\d+$/.test(de)||de.split("").some(ie=>r.WP.indexOf(ie)===-1))&&(de=(0,r.o$)()),{...ne,[de]:ue}},{});return Object.keys(te).length||(te[(0,r.o$)()]=v),{to:{schemaVersion:1,panes:te},error:!1}},migrate:Q=>({schemaVersion:1,panes:{[(0,r.o$)()]:Q.left,...Q.right&&{[(0,r.o$)()]:Q.right}}})},v={datasource:null,queries:[],range:d.k};function x(Q){return!Q||typeof Q!="object"?v:{...v,...(0,g.C)("queries",Q)&&Array.isArray(Q.queries)&&{queries:Q.queries},...(0,g.C)("datasource",Q)&&typeof Q.datasource=="string"&&{datasource:Q.datasource},...(0,g.C)("panelsState",Q)&&!!Q.panelsState&&typeof Q.panelsState=="object"&&{panelsState:Q.panelsState},...(0,g.C)("range",Q)&&!!Q.range&&typeof Q.range=="object"&&(0,g.C)("from",Q.range)&&(0,g.C)("to",Q.range)&&typeof Q.range.from=="string"&&typeof Q.range.to=="string"&&{range:{from:Q.range.from,to:Q.range.to}}}}const f=Q=>b(Q),u=[i,y],b=Q=>{const q=E(Q),[te,...ne]=u.slice(q),{error:se,to:ue}=te.parse(Q);return[ne.reduce((ie,he)=>he.migrate?he.migrate(ie):ie,ue),se]};function E(Q){return!Q||!("schemaVersion"in Q)||!Q.schemaVersion?0:typeof Q.schemaVersion=="number"?Q.schemaVersion:typeof Q.schemaVersion=="string"?Number.parseInt(Q.schemaVersion,10):0}var D=e(2543),C=e(19379),P=e(707),T=e(51845),O=e(35231),I=e(19050),j=e(94543),W=e(83953),B=e(80144),S=e(28105),w=e(1906),N=e(28998),M=e(18615);const L=(Q,q)=>{const te=!(0,D.isEqual)(q?.datasource,Q?.datasource),ne=!(0,D.isEqual)(q?.queries,Q?.queries),se=!(0,D.isEqual)(q?.range||d.k,Q?.range||d.k),ue=!(0,D.isEqual)(q?.panelsState,Q?.panelsState);return{datasource:te,queries:ne,range:se,panelsState:ue}};async function A(Q,q,te){if(Q)try{return await(0,N.tR)().get(Q)}catch{}const ne=[...new Set(q.map(se=>se.datasource).filter(S.zz).map(se=>typeof se=="string"?se:se.uid))];try{if(ne.length>=1){const se=(await Promise.allSettled(ne.map(ue=>(0,N.tR)().get(ue)))).filter(g.s);if(se.length>1)return await(0,N.tR)().get(M.uv);if(se.length===1)return await(0,N.tR)().get(ne[0])}}catch{}return(0,N.tR)().get((0,r.HQ)(te)).catch(()=>(0,N.tR)().get()).catch(()=>{})}function U(Q){return{...Q.getDefaultQuery?.(w.Jk.Explore),refId:"A",datasource:Q.getRef()}}function F(Q){return Q.name===M.uv}function V(Q){return Q&&F(Q)?q=>!!q.datasource:q=>q.datasource?typeof q.datasource=="string"?q.datasource===Q?.uid||q.datasource===Q?.name:q.datasource.uid===Q?.uid:!0}async function K(Q){return(await Promise.allSettled(Q.map(te=>(0,N.tR)().get(te.datasource).then(ne=>({query:te,ds:ne}))))).filter(g.s).map(({value:te})=>te.query)}function G(Q,q,te){const ne=Object.values(Q.panes);if(ne.length>1){const se=ne.some(({range:ue},de,[{range:ie}])=>!(0,D.isEqual)(ue,ie));te((0,O.qz)({syncedTimes:!se}))}Object.entries(Q.panes).forEach(async([se,ue],de)=>{const{datasource:ie,queries:he,range:me,panelsState:ce}=ue,Pe=q[se];if(Pe!==void 0){const Ie=L(ue,z(Pe));Promise.resolve().then(async()=>{Ie.datasource&&ie&&await te((0,P.wh)({exploreId:se,datasource:ie}))}).then(async()=>{Ie.range&&te((0,j.JA)({exploreId:se,rawRange:(0,W.Z9)(me)})),Ie.queries&&te((0,I.h9)({exploreId:se,queries:(0,B.v)(he)})),(Ie.queries||Ie.range)&&(await te((0,I.hS)(se)),te((0,I.Od)({exploreId:se}))),Ie.panelsState&&ce&&te((0,T.fx)({exploreId:se,panelsState:ce}))})}else te((0,T.Gd)({exploreId:se,datasource:ie||"",queries:(0,B.v)(he),range:(0,W.Z9)(me),panelsState:ce,position:de,eventBridge:new C.o}))}),Object.keys(q).filter(se=>!Object.keys(Q.panes).includes(se)).forEach(se=>te((0,O.J8)(se)))}function H(Q,q,te,ne,se){ne((0,O.Ve)()),Promise.all(Object.entries(Q.panes).map(([ue,{datasource:de,queries:ie,range:he,panelsState:me}])=>A(de,ie,te).then(ce=>Promise.resolve(ce?ie.length?(0,B.v)(ie).filter(V(ce)).map(F(ce)?D.identity:Pe=>({...Pe,datasource:ce.getRef()})):(0,N.tR)().get(F(ce)?void 0:ce.getRef()).then(Pe=>[U(Pe)]):[]).then(async Pe=>{let Ie=await K(Pe);return!Ie.length&&ce&&(Ie=[U(F(ce)?await(0,N.tR)().get():ce)]),{exploreId:ue,range:he,panelsState:me,queries:Ie,datasource:ce}})))).then(async ue=>{const de=await Promise.all(ue.map(({exploreId:Pe,range:Ie,panelsState:Se,queries:Me,datasource:Te})=>ne((0,T.Gd)({exploreId:Pe,datasource:Te,queries:Me,range:(0,W.Z9)(Ie),panelsState:Se,eventBridge:new C.o})).unwrap()));if(de.length>1){const Pe=de.some(({state:Ie},Se,[{state:Me}])=>!(0,D.isEqual)(Ie.range.raw,Me.range.raw));ne((0,O.qz)({syncedTimes:!Pe}))}const ie=de.reduce((Pe,{exploreId:Ie,state:Se})=>({...Pe,[Ie]:z(Se)}),{}),he=se.getSearchObject();let me={};for(const[Pe,Ie]of Object.entries(he).filter(([Se])=>!["schemaVersion","panes","orgId","left","right"].includes(Se)))me[Pe]=Ie;const ce=new URLSearchParams({schemaVersion:`${Q.schemaVersion}`,panes:JSON.stringify(ie),orgId:`${te}`,...me});se.replace({pathname:se.getLocation().pathname,search:ce.toString()}),q.current="done"})}function _(Q,q){return Q.current=P.wh.pending.type===q.type,[O.J8.type,O.ve.fulfilled.type,I.Od.pending.type,j.eM.type,T.fx.type,P.wh.fulfilled.type].includes(q.type)&&!Q.current}function k(Q,q,te,ne){const se=Object.entries(Q.panes).reduce((ue,[de,ie])=>ie?{...ue,[de]:z(ie)}:ue,{});if(!(0,D.isEqual)(q.current.panes,JSON.stringify(se))){const ue=!!q.current.panes&&Object.values(q.current.panes).filter(Boolean).length===0||te.current==="pending";q.current={panes:JSON.stringify(se)},ne.partial({panes:q.current.panes},ue)}}var J=e(83175);function z(Q){return{datasource:Q.datasourceInstance?.uid||"",queries:Q.queries.map(r.w4),range:(0,J.sQ)(Q.range.raw),panelsState:Y(Q.panelsState)}}function Y(Q){let q=(0,D.mapValues)(Q,te=>(0,D.isObject)(te)?Y(te):te);if(q=(0,D.omitBy)(q,D.isEmpty),!(0,D.isEmpty)(q))return q}function X(Q){const{location:q}=(0,a.Il)(),te=(0,l.wA)(),ne=(0,l.d4)(o.Qb),se=(0,n.useRef)(ne),ue=(0,l.d4)(ce=>ce.user.orgId),de=(0,n.useRef)(Q),ie=(0,n.useRef)("notstarted"),he=(0,n.useRef)(!1),{warning:me}=(0,s._2)();(0,n.useEffect)(()=>{Q.panes||(ie.current="notstarted",de.current=Q)},[Q]),(0,n.useEffect)(()=>{const ce=te((0,l.ch)({predicate:Pe=>_(he,Pe),effect:async(Pe,{cancelActiveListeners:Ie,delay:Se,getState:Me})=>{Ie(),await Se(200),k(Me().explore,de,ie,q)}}));return()=>ce()},[te,q]),(0,n.useEffect)(()=>{se.current=ne},[ne]),(0,n.useEffect)(()=>{const ce=de.current?.panes!==Q.panes,[Pe,Ie]=f(Q);Ie&&me("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!ce&&ie.current==="notstarted"&&(ie.current="pending",H(Pe,ie,ue,te,q)),de.current=Q,ce&&ie.current==="done"&&G(Pe,se.current,te)},[te,ue,q,Q,me])}},8692:(Z,R,e)=>{"use strict";e.d(R,{C:()=>a,s:()=>n});const n=s=>s.status==="fulfilled";function a(s,l){return s in l}},2513:(Z,R,e)=>{"use strict";e.d(R,{k:()=>a});var n=e(43173);const a={from:`now-${n.$.exploreDefaultTimeOffset}`,to:"now"}},80763:(Z,R,e)=>{"use strict";e.d(R,{M:()=>h,v:()=>g});var n=e(88483),a=e(78282),s=e(27489),l=e(6890),o=e(64762),d=e(6219),i=e(8535),c=e(51845),m=e(35231),p=e(19050);const h=y=>new n.c(v=>{const x=i.M_.getState().explore.panes[y]?.correlations;if(x)v.next(x),v.complete();else{const f=i.M_.subscribe(()=>{const u=i.M_.getState().explore.panes[y]?.correlations;u&&(f(),v.next(u),v.complete())})}});function r(y){return async(v,x)=>{const f=x().explore.panes[y];if(f.datasourceInstance?.uid!==void 0){let u=f.datasourceInstance.meta.mixed?f.queries.map(E=>E.datasource?.uid).filter(E=>E!==null):[f.datasourceInstance.uid];const b=await(0,d.J6)(u);v((0,c.Fb)({exploreId:y,correlations:b.correlations||[]}))}}}function g(y,v,x){return async(f,u)=>{const b=Object.keys(u().explore?.panes),E=u().explore?.panes[b[0]],D=u().explore?.panes[b[1]];if(!E||!D)return;const C=E.datasourceInstance?.meta.mixed?E.queries[0].datasource:E.datasourceInstance?.getRef(),P=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),[T,O]=await Promise.all([(0,a.l)().get(C),(0,a.l)().get(P)]);if(T?.uid&&O?.uid&&D.correlationEditorHelperData?.resultField){const I={sourceUID:T.uid,targetUID:O.uid,label:y||await(0,d.tZ)(E,D),description:v,type:"query",config:{field:D.correlationEditorHelperData.resultField,target:D.queries[0],transformations:x}};await(0,d.$q)(T.uid,I).then(async()=>{f((0,m.J8)(b[1])),await f(r(b[0])),await f((0,p.Od)({exploreId:b[0]})),(0,s.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:T.type,targetDataSourceType:O.type})}).catch(j=>{f((0,l.dx)((0,o.gi)("Error creating correlation",j))),console.error(j)})}}}},707:(Z,R,e)=>{"use strict";e.d(R,{YR:()=>y,wh:()=>g});var n=e(65307),a=e(27489),s=e(90811),l=e(62635),o=e(6219),d=e(52763),i=e(10951),c=e(51845),m=e(19050),p=e(94543),h=e(83953);const r=(0,n.VP)("explore/updateDatasourceInstance"),g=(0,d.zD)("explore/changeDatasource",async({datasource:v,exploreId:x,options:f},{getState:u,dispatch:b})=>{const E=u().user.orgId,{history:D,instance:C}=await(0,h.BE)(E,v),P=u().explore.panes[x].datasourceInstance;(0,a.rR)("explore_change_ds",{from:(P?.meta?.mixed?"mixed":P?.type)||"unknown",to:C.meta.mixed?"mixed":C.type,exploreId:x}),b(r({exploreId:x,datasourceInstance:C,history:D}));const T=u().explore.panes[x].queries,O=(0,h.dq)(C.uid,T),I=await(0,o.J6)(O);b((0,c.Fb)({exploreId:x,correlations:I.correlations||[]})),f?.importQueries&&await b((0,m.y2)(x,T,P,C)),u().explore.panes[x].isLive&&b((0,p.hO)({exploreId:x,refreshInterval:s.cC.offOption.value})),f?.importQueries&&b((0,m.Od)({exploreId:x}))}),y=(v,x)=>{if(r.match(x)){const{datasourceInstance:f,history:u}=x.payload;return(0,l._u)(v.querySubscription),{...v,datasourceInstance:f,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,i.Ez)(),queryResponse:(0,h.RA)(),queryKeys:[],history:u}}return v}},51845:(Z,R,e)=>{"use strict";e.d(R,{EA:()=>r,Fb:()=>x,Gd:()=>u,LJ:()=>b,QZ:()=>f,fx:()=>h,nE:()=>g});var n=e(65307),a=e(62635),s=e(6219),l=e(34984),o=e(52763),d=e(707),i=e(19050),c=e(94543),m=e(83953);const p=(0,n.VP)("explore/changeSize"),h=(0,n.VP)("explore/changePanels");function r(E,D,C){return async(P,T)=>{const O=T().explore.panes[E];if(O===void 0)return;const{panelsState:I}=O;P(h({exploreId:E,panelsState:{...I,[D]:C}}))}}const g=(0,n.VP)("explore/changeCorrelationHelperData"),y=(0,n.VP)("explore/initializeExploreAction"),v=(0,n.VP)("explore/setUrlReplaced"),x=(0,n.VP)("explore/saveCorrelationsAction");function f(E,{width:D}){return p({exploreId:E,width:D})}const u=(0,o.zD)("explore/initializeExplore",async({exploreId:E,datasource:D,queries:C,range:P,panelsState:T,correlationHelperData:O,eventBridge:I},{dispatch:j,getState:W,fulfillWithValue:B})=>{let S,w=[];if(D){const N=W().user.orgId,M=await(0,m.BE)(N,D);S=M.instance,w=M.history}if(j(y({exploreId:E,queries:C,range:(0,m.eO)(P,(0,l.O)(W().user)),datasourceInstance:S,history:w,eventBridge:I})),T!==void 0&&j(h({exploreId:E,panelsState:T})),j((0,c.JA)({exploreId:E})),S){const N=(0,m.dq)(S.uid,C),M=await(0,s.J6)(N);j(x({exploreId:E,correlations:M.correlations||[]})),j((0,i.Od)({exploreId:E}))}return O!==void 0&&W().explore.correlationEditorDetails?.editorMode&&j(g({exploreId:E,correlationEditorHelperData:O})),B({exploreId:E,state:W().explore.panes[E]})}),b=(E=(0,m.HZ)(),D)=>{if(E=(0,i.JQ)(E,D),E=(0,d.YR)(E,D),E=(0,c.QP)(E,D),p.match(D)){const C=D.payload.width;return{...E,containerWidth:C}}if(h.match(D)){const{panelsState:C}=D.payload;return{...E,panelsState:C}}if(g.match(D)){const{correlationEditorHelperData:C}=D.payload;return{...E,correlationEditorHelperData:C}}if(x.match(D))return{...E,correlations:D.payload.correlations};if(y.match(D)){const{queries:C,range:P,datasourceInstance:T,history:O,eventBridge:I}=D.payload;return{...E,range:P,queries:C,initialized:!0,eventBridge:I,queryKeys:(0,a.dY)(C),datasourceInstance:T,history:O,queryResponse:(0,m.RA)(),cache:[],correlations:[]}}return E}},11280:(Z,R,e)=>{"use strict";e.d(R,{Bj:()=>f,H9:()=>m,PA:()=>v,Uu:()=>g,VM:()=>p,fP:()=>x,jX:()=>r,ri:()=>i,s1:()=>h,sh:()=>c,wk:()=>y});var n=e(65307),a=e(81970),s=e(53222),l=e(35231);const o=(0,n.VP)("explore/historyUpdated"),d=({updatedQuery:u,deletedId:b})=>async(E,D)=>{const C=D().explore.richHistory,P=C.map(O=>O.id===u?.id?u:O).filter(O=>O.id!==b),T=C.length-P.length;E((0,l.U2)({richHistoryResults:{richHistory:P,total:D().explore.richHistoryTotal-T}}))},i=(u,b,E,D,C)=>async(P,T)=>{const O=C?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!T().explore.richHistoryStorageFull,limitExceededWarning:!T().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:I,limitExceeded:j}=await(0,a.l0)({localOverride:u,datasource:{uid:b,name:E},queries:D,starred:!1,showNotif:O});C||(I&&P((0,l.fj)()),j&&P((0,l.D)()))},c=(u,b)=>async(E,D)=>{const C=await(0,a.oU)(u,b);E(d({updatedQuery:C}))},m=(u,b)=>async E=>{const D=await(0,a.cX)(u,b);E(d({updatedQuery:D}))},p=u=>async b=>{const E=await(0,a.NC)(u);b(d({deletedId:E}))},h=()=>async u=>{await(0,a.X1)(),u((0,l.U2)({richHistoryResults:{richHistory:[],total:0}})),u((0,l.U2)({richHistoryResults:{richHistory:[],total:0}}))},r=()=>async(u,b)=>{const E=b().explore.richHistorySearchFilters;if(E){const D=await(0,a.DI)(E);u((0,l.U2)({richHistoryResults:D}))}},g=()=>async(u,b)=>{const E=b().explore.richHistorySearchFilters,D=b().explore.richHistory;if(E&&D){const C={...E,page:(E?.page||1)+1},P=await(0,a.DI)(C),T=[...D,...P.richHistory];u((0,l.Ju)({filters:C})),u((0,l.U2)({richHistoryResults:{richHistory:T,total:P.total}}))}},y=()=>async u=>{u((0,l.Ju)({filters:void 0})),u((0,l.U2)({richHistoryResults:{richHistory:[],total:0}}))},v=()=>async(u,b)=>{let E=b().explore.richHistorySettings;E||(E=await(0,a.Gx)(),u((0,l.bZ)(E)))},x=u=>async b=>{b((0,l.bZ)(u)),await(0,a.rs)(u)},f=u=>async(b,E)=>{await b((0,l.Ju)({filters:{...u}}));const D=E().explore.richHistorySettings;(0,s.gQ)().lastUsedDataSourcesAvailable&&await b(x({...D,lastUsedDatasourceFilters:u.datasourceFilters}))}},35231:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>M,D:()=>f,J8:()=>P,JA:()=>C,Ju:()=>b,U2:()=>v,Ve:()=>O,am:()=>W,bZ:()=>u,fj:()=>x,nD:()=>E,ow:()=>B,qz:()=>y,tP:()=>D,ve:()=>I});var n=e(65307),a=e(2543),s=e.n(a),l=e(19379),o=e(92138),d=e(36490),i=e(62635),c=e(59373),m=e(52763),p=e(80144),h=e(2513),r=e(51845),g=e(83953);const y=(0,n.VP)("explore/syncTimes"),v=(0,n.VP)("explore/richHistoryUpdated"),x=(0,n.VP)("explore/richHistoryStorageFullAction"),f=(0,n.VP)("explore/richHistoryLimitExceededAction"),u=(0,n.VP)("explore/richHistorySettingsUpdated"),b=(0,n.VP)("explore/richHistorySearchFiltersUpdatedAction"),E=(0,n.VP)("explore/splitSizeUpdateAction"),D=(0,n.VP)("explore/maximizePaneAction"),C=(0,n.VP)("explore/evenPaneResizeAction"),P=(0,n.VP)("explore/splitClose"),T=(0,n.VP)("explore/setPaneState"),O=(0,n.VP)("explore/clearPanes"),I=(0,m.zD)("explore/splitOpen",async(L,{getState:A,dispatch:U})=>{const F=Object.values(A().explore.panes)[0],V=L?.queries??F?.queries??[];Object.keys(A().explore.panes).forEach((H,_)=>{_>=1&&U(P(H))});const K=L?.range||F?.range.raw||h.k;let G=(0,i.o$)();for(;A().explore.panes[G];)G=(0,i.o$)();await U(j({exploreId:G,datasource:L?.datasourceUid||F?.datasourceInstance?.getRef(),queries:(0,p.v)(V),range:K,panelsState:L?.panelsState||F?.panelsState,correlationHelperData:L?.correlationHelperData,eventBridge:new l.o})),F?.range&&await U(y({syncedTimes:(0,a.isEqual)(F.range.raw,K)}))}),j=(0,m.zD)("explore/createNewSplitOpen",async(L,{dispatch:A})=>{await A((0,r.Gd)(L))}),W=(0,n.VP)("explore/changeCorrelationEditorDetails"),B=(L,A)=>async U=>{const{timeRange:F,getExploreUrl:V,openInNewWindow:K}=A,G=await V({queries:L.targets,dsRef:L.datasource,scopedVars:L.scopedVars,timeRange:F,adhocFilters:(0,c.w)().getAdhocFilters(L.datasource?.uid??"",!0)});if(K&&G){K(G);return}d.Ny.push(o.I.stripBaseFromUrl(G))},S=()=>(0,g.HZ)(),w={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},M={explore:(L=w,A)=>{if(P.match(A)){const{[A.payload]:F,...V}={...L.panes};return{...L,panes:V,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(E.match(A)){const{largerExploreId:F}=A.payload;return{...L,largerExploreId:F,maxedExploreId:void 0,evenSplitPanes:F===void 0}}if(D.match(A)){const{exploreId:F}=A.payload;return{...L,largerExploreId:F,maxedExploreId:F,evenSplitPanes:!1}}if(C.match(A))return{...L,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(y.match(A))return{...L,syncedTimes:A.payload.syncedTimes};if(x.match(A))return{...L,richHistoryStorageFull:!0};if(f.match(A))return{...L,richHistoryLimitExceededWarningShown:!0};if(u.match(A)){const F=A.payload;return{...L,richHistorySettings:F}}if(v.match(A)){const{richHistory:F,total:V}=A.payload.richHistoryResults;return{...L,richHistory:F,richHistoryTotal:V}}if(b.match(A)){const F=A.payload.filters;return{...L,richHistorySearchFilters:F}}if(j.pending.match(A))return{...L,panes:{...L.panes,[A.meta.arg.exploreId]:S()}};if(r.Gd?.pending.match(A)){const F=Object.entries(L.panes),V=F.slice(0,A.meta.arg.position),K=F.slice(V.length),G=[...V,[A.meta.arg.exploreId,S()],...K].reduce((H,[_,k])=>({...H,[_]:k}),{});return{...L,panes:G}}if(O.match(A))return{...L,panes:{}};if(W.match(A)){const{editorMode:F,label:V,description:K,canSave:G,correlationDirty:H,queryEditorDirty:_,isExiting:k,postConfirmAction:J,transformations:z}=A.payload;return{...L,correlationEditorDetails:{editorMode:!!(F??L.correlationEditorDetails?.editorMode),canSave:!!(G??L.correlationEditorDetails?.canSave),label:V??L.correlationEditorDetails?.label,description:K??L.correlationEditorDetails?.description,transformations:z??L.correlationEditorDetails?.transformations,correlationDirty:!!(H??L.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(_??L.correlationEditorDetails?.queryEditorDirty),isExiting:!!(k??L.correlationEditorDetails?.isExiting),postConfirmAction:J}}}const U=A.payload?.exploreId;return typeof U=="string"?{...L,panes:Object.entries(L.panes).reduce((F,[V,K])=>({...F,[V]:V===U?(0,r.LJ)(K,A):K}),{})}:L}}},19050:(Z,R,e)=>{"use strict";e.d(R,{_0:()=>Ve,He:()=>yn,hS:()=>ge,bO:()=>ot,IL:()=>En,rR:()=>ve,y2:()=>lt,Az:()=>Bn,PD:()=>mt,JQ:()=>Fn,S6:()=>Mt,Od:()=>It,GI:()=>On,q9:()=>Oe,h1:()=>Ge,qk:()=>pe,Rk:()=>un,h9:()=>le,TO:()=>fa});var n=e(65307),a=e(32017),s=e.n(a),l=e(2543),o=e(49510),d=e(62467),i=e(58307),c=e(69862),m=e(99165),p=e(28105),h=e(46933),r=e(25229),g=e(67770),y=e(94644),v=e(76732),x=e(39443),f=e(95004);function u(gt,Ht){const wt=b({data:gt.series},{data:Ht.series}).data;return{...gt,series:wt}}function b(gt,Ht){if(!gt)return T(Ht);Ht.data.forEach(Xt=>{const on=gt.data.find(pn=>I(pn,Xt));if(!on){gt.data.push(O(Xt));return}E(on,Xt)});const wt=[...gt.errors??[],...Ht.errors??[]];wt.length>0&&(gt.errors=wt);const Yt=gt.error??Ht.error;Yt!=null&&(gt.error=Yt);const rn=[...gt.traceIds??[],...Ht.traceIds??[]];return rn.length>0&&(gt.traceIds=rn),gt}function E(gt,Ht){const wt=Math.max(gt.fields.length,Ht.fields.length);for(let Yt=0;Yt<wt;Yt++){if(!gt.fields[Yt])continue;const rn=D(gt.fields[Yt],Ht.fields,Yt);if(rn&&(gt.fields[Yt].values=[].concat.apply(rn.values,gt.fields[Yt].values),rn.nanos)){const Xt=gt.fields[Yt].nanos?.slice()||[];gt.fields[Yt].nanos=Ht.fields[Yt].nanos?.concat(Xt)}}gt.length+=Ht.length,gt.meta={...gt.meta,stats:P(gt.meta?.stats??[],Ht.meta?.stats??[])}}function D(gt,Ht,wt){const Yt=Ht.filter(rn=>rn.name===gt.name);return Yt.length===1?Yt[0]:gt.labels?Yt.find(rn=>(0,v.ab)(gt.labels??{},rn.labels??{})):Ht[wt]}const C="Summary: total bytes processed";function P(gt,Ht){const wt=gt.find(Xt=>Xt.displayName===C),Yt=Ht.find(Xt=>Xt.displayName===C);if(Yt!=null&&wt!=null)return[{value:Yt.value+wt.value,displayName:C,unit:wt.unit}];const rn=Yt??wt;return rn!=null?[rn]:[]}function T(gt){return{...gt,data:gt.data.map(O)}}function O(gt){return{...gt,fields:gt.fields.map(Ht=>({...Ht,values:Ht.values}))}}function I(gt,Ht){if(gt.refId!==Ht.refId||gt.name!==Ht.name)return!1;const wt=gt.meta?.type,Yt=Ht.meta?.type;if(wt!==Yt)return!1;if(wt===x.m.TimeSeriesMulti){const on=gt.fields.find(Un=>Un.type===f.PU.number),pn=Ht.fields.find(Un=>Un.type===f.PU.number);return on===void 0||pn===void 0?!1:(0,v.ab)(on.labels??{},pn.labels??{})}const rn=gt.meta?.custom?.frameType,Xt=Ht.meta?.custom?.frameType;return rn==="LabeledTimeValues"&&Xt==="LabeledTimeValues"?!0:rn===Xt}var j=e(78282),W=e(43173),B=e(62635),S=e(23237),w=e(6219),N=e(28998),M=e(34984),L=e(12282),A=e(18615),U=e(52763),F=e(6890),V=e(64762),K=e(71393),G=e(81160),H=e(11576),_=e(79609),k=e(96702),J=e(41119),z=e(37234),Y=e(74746),X=e(92391);const Q=gt=>{const Ht=[],wt=[],Yt=[],rn=[],Xt=[],on=[],pn=[],Un=[];for(const In of gt.series){if(he(In)){Un.push(In);continue}switch(In.meta?.preferredVisualisationType){case"logs":rn.push(In);break;case"graph":Ht.push(In);break;case"trace":Xt.push(In);break;case"table":wt.push(In);break;case"rawPrometheus":Yt.push(In);break;case"nodeGraph":on.push(In);break;case"flamegraph":pn.push(In);break;default:ie(In)&&Ht.push(In),wt.push(In)}}return{...gt,graphFrames:Ht,tableFrames:wt,logsFrames:rn,traceFrames:Xt,nodeGraphFrames:on,customFrames:Un,flameGraphFrames:pn,rawPrometheusFrames:Yt,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},q=({showCorrelationEditorLinks:gt,queries:Ht,correlations:wt,defaultTargetDatasource:Yt})=>rn=>{if(gt&&Yt)for(const Xt of rn.series)for(const on of Xt.fields){on.config.links=[],on.display=on.display||(0,H.H)();const pn={};Xt.fields.map(Un=>{pn[`${Un.name}`]=`\${__data.fields.['${Un.name}']}`}),on.config.links.push({url:"",origin:_.x0.ExploreCorrelationsEditor,title:`Correlate with ${on.name}`,internal:{datasourceUid:Yt.uid,datasourceName:Yt.name,query:{datasource:{uid:Yt.uid}}},meta:{correlationData:{resultField:on.name,vars:pn,origVars:pn}}})}else if(Ht?.length&&wt?.length){const Xt=(0,l.mapValues)((0,l.groupBy)(Ht,"refId"),"0.datasource.uid");(0,w.cA)(rn.series,wt,Xt)}return rn},te=gt=>gt.graphFrames.length?{...gt,graphResult:gt.graphFrames}:{...gt,graphResult:null},ne=gt=>{if(gt.tableFrames.length===0)return(0,d.of)({...gt,tableResult:null});gt.tableFrames.sort((rn,Xt)=>{const on=rn.refId,pn=Xt.refId;return on>pn?1:on<pn?-1:0});const Ht=gt.tableFrames.every(rn=>ie(rn)),wt={interpolate:rn=>rn};return(Ht?(0,d.of)(gt.tableFrames).pipe(k.c.joinByFieldTransformer.operator({},wt)):(0,d.of)(gt.tableFrames).pipe(k.c.mergeTransformer.operator({},wt))).pipe((0,G.T)(rn=>{for(const Xt of rn)for(const on of Xt.fields)on.display=on.display??(0,H.J)({field:on,theme:W.$.theme2,timeZone:gt.request?.timezone??"browser"});return{...gt,tableResult:rn}}))},se=gt=>{const Ht=gt.rawPrometheusFrames;if(!Ht||Ht.length===0)return(0,d.of)({...gt,tableResult:null});Ht.sort((Xt,on)=>{const pn=Xt.refId,Un=on.refId;return pn>Un?1:pn<Un?-1:0});const wt=Ht.every(Xt=>ie(Xt)),Yt={interpolate:Xt=>Xt};return(wt?(0,d.of)(Ht).pipe(k.c.joinByFieldTransformer.operator({},Yt)):(0,d.of)(Ht).pipe(k.c.mergeTransformer.operator({},Yt))).pipe((0,G.T)(Xt=>{const on=Xt[0];for(const pn of on.fields)pn.display=pn.display??(0,H.J)({field:pn,theme:W.$.theme2,timeZone:gt.request?.timezone??"browser"});return{...gt,rawPrometheusResult:on}}))},ue=(gt={})=>Ht=>{if(Ht.logsFrames.length===0)return{...Ht,logsResult:null};const wt=Ht.request?.intervalMs,Yt=(0,z.HT)(Ht.logsFrames,wt,gt.absoluteRange,gt.queries,gt.deduplicate),rn=(0,B.uE)(gt.refreshInterval),Xt=(0,Y.zy)(Yt,rn),on=Xt.rows,pn=Xt.series,Un={...Xt,rows:on,series:pn};return{...Ht,logsResult:Un}};function de(gt,Ht,wt,Yt,rn,Xt,on){return(0,d.of)(gt).pipe((0,G.T)(pn=>(0,J.N$)(pn,Ht)),(0,G.T)(q({defaultTargetDatasource:on,showCorrelationEditorLinks:Xt,queries:Yt,correlations:rn})),(0,G.T)(Q),(0,G.T)(te),(0,G.T)(wt),(0,c.Z)(se),(0,c.Z)(ne))}function ie(gt){const Ht=(0,l.groupBy)(gt.fields,wt=>wt.type);return!!(Object.keys(Ht).length===2&&Ht[f.PU.time]?.length===1&&Ht[f.PU.number])}function he(gt){return gt.meta?.preferredVisualisationPluginId?(0,X.oZ)(gt.meta?.preferredVisualisationPluginId):!1}var me=e(10951),ce=e(80763),Pe=e(51845),Ie=e(11280),Se=e(35231),Me=e(94543),Te=e(83953);const Ge=gt=>Ht=>{const wt=Ht.explore.panes[gt];return wt&&wt.queryResponse?wt.queryResponse.state===p.Gu.Loading||wt.queryResponse.state===p.Gu.Streaming:!1},Qe=(0,n.VP)("explore/addQueryRow"),tt=(0,n.VP)("explore/changeQueries"),ke=(0,n.VP)("explore/cancelQueries"),He=(0,n.VP)("explore/queriesImported"),Re=(0,n.VP)("explore/queryStoreSubscription"),Ne=(0,n.VP)("explore/setSupplementaryQueryEnabledAction"),Ae=(0,n.VP)("explore/storeSupplementaryQueryDataProviderAction"),Ue=(0,n.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Be=(0,n.VP)("explore/cleanSupplementaryQueryAction"),We=(0,n.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),_e=(0,n.VP)("explore/updateSupplementaryQueryDataAction"),Xe=(0,n.VP)("explore/queryStreamUpdated"),le=(0,n.VP)("explore/setQueries"),ye=(0,n.VP)("changeLoadingState"),pe=(0,n.VP)("explore/setPausedState"),ve=(0,n.VP)("explore/clearLogs"),be=(0,n.VP)("explore/scanStart"),Oe=(0,n.VP)("explore/scanStop"),we=(0,n.VP)("explore/addResultsToCache"),ze=(0,n.VP)("explore/clearCache");function Ve(gt,Ht){return async(wt,Yt)=>{const rn=Yt().explore.panes[gt];let Xt;rn.datasourceInstance?.meta.mixed?Xt=(0,l.findLast)(rn.queries,pn=>!!pn.datasource)?.datasource||void 0:Xt=rn.datasourceInstance?.getRef();const on=await(0,B.Ll)(rn.queries,Ht,Xt);wt(Qe({exploreId:gt,index:Ht,query:on}))}}function ge(gt){return(Ht,wt)=>{Ht(Oe({exploreId:gt})),Ht(ke({exploreId:gt}));const Yt=wt().explore.panes[gt].supplementaryQueries;for(const rn of me.VW)Ht(Ue({exploreId:gt,type:rn})),Yt[rn]?.data?.state!==p.Gu.Done&&Ht(Be({exploreId:gt,type:rn}))}}const Ke=(gt,Ht)=>{const wt=gt.getRef();return Ht.map(Yt=>({...Yt,datasource:wt}))},qe=async(gt,Ht,wt)=>{let Yt=[];if(Ht.meta?.id===gt.meta?.id)Yt=wt;else if((0,h.Ee)(Ht)&&(0,h.FL)(gt)){const rn=await Ht.exportToAbstractQueries(wt);Yt=await gt.importFromAbstractQueries(rn)}else gt.importQueries&&(Yt=await gt.importQueries(wt,Ht));return Ke(gt,Yt)},ot=(0,U.zD)("explore/changeQueries",async({queries:gt,exploreId:Ht},{getState:wt,dispatch:Yt})=>{let rn=!1;const Xt=wt().explore.panes[Ht].queries,on=wt().explore.panes[Ht].datasourceInstance?.uid,pn=wt().explore.correlationEditorDetails,Un=pn?.editorMode||!1;!(Object.keys(wt().explore.panes)[0]===Ht)&&Un&&!pn?.queryEditorDirty&&Yt((0,Se.am)({queryEditorDirty:!0}));for(const Gn of gt)for(const Wa of Xt){if(Gn.refId===Wa.refId&&Gn.datasource?.type!==Wa.datasource?.type){const za=await(0,j.l)().get(Wa.datasource),Oa=await(0,j.l)().get({uid:Gn.datasource?.uid});await Yt(lt(Ht,Xt,za,Oa,Gn.refId)),rn=!0}if(on===A.uv&&Gn.refId===Wa.refId&&Gn.datasource?.uid!==Wa.datasource?.uid){const za=(0,Te.dq)(A.uv,gt),Oa=await(0,w.J6)(za);Yt((0,Pe.Fb)({exploreId:Ht,correlations:Oa.correlations||[]}))}}rn||Yt(tt({queries:gt,exploreId:Ht})),gt.length<Xt.length&&Yt(It({exploreId:Ht}))}),lt=(gt,Ht,wt,Yt,rn)=>async Xt=>{if(!wt){Xt(He({exploreId:gt,queries:Ht}));return}let on=Ht;if(Yt.uid===A.uv)on=Ht.map(Un=>({...Un,datasource:wt.getRef()}));else if(wt.uid===A.uv){const Un=(0,l.groupBy)(Ht,Gn=>Gn.datasource?.uid),In=await Promise.all(Object.keys(Un).map(async Gn=>{const Wa=await(0,j.l)().get({uid:Gn});return await qe(Yt,Wa,Un[Gn])}));on=(0,l.flatten)(In.filter(Gn=>Gn.length>0))}else{let Un=Ht;if(rn!==void 0){const In=Ht.find(Gn=>Gn.refId===rn);In&&(Un=[In])}on=await qe(Yt,wt,Un)}let pn=await(0,B.di)(on,Yt.getRef());if(rn!==void 0){on.length===0&&(on=[await(0,B.Ll)([],void 0,Yt.getRef())]);const Un=Ht.findIndex(Gn=>Gn.refId===rn),In={...pn[0],refId:Ht[Un].refId};pn=[...Ht],pn[Un]=In}return Xt(He({exploreId:gt,queries:pn})),pn};function mt(gt,Ht,wt){return async(Yt,rn)=>{const Xt=rn().explore.panes[gt],{queries:on}=Xt,Un=(await Promise.all(on.map(In=>wt({...In},Ht)))).map((In,Gn)=>(0,B.eF)(In,on,Gn));Yt(le({exploreId:gt,queries:Un})),Ht.preventSubmit||Yt(It({exploreId:gt}))}}function Lt(gt,Ht){if(!(gt.filterQuery&&!gt.filterQuery(Ht)))return Ht}async function Tt(gt,Ht,wt,Yt){const Xt=(await Promise.all(Yt.map(async on=>{if(on.datasource?.uid===wt.uid)return Lt(wt,on);{const pn=await(0,N.tR)().get(on.datasource);return Lt(pn,on)}}))).filter(on=>!!on);Xt.length>0&&(gt((0,Ie.ri)(!0,wt.uid,wt.name,Xt,W.$.queryHistoryEnabled)),W.$.queryHistoryEnabled&&gt((0,Ie.ri)(!1,wt.uid,wt.name,Xt,!1)),await gt((0,Ie.jX)()))}const It=(0,U.zD)("explore/runQueries",async({exploreId:gt,preserveCache:Ht},{dispatch:wt,getState:Yt})=>{Yt().explore?.panes[gt]?.scanning||wt(ge(gt));const{defaultCorrelationEditorDatasource:rn,scopedVars:Xt,showCorrelationEditorLinks:on}=await(0,Te.aj)(Yt(),gt),pn=(0,ce.M)(gt);wt((0,Me.JA)({exploreId:gt})),Ht!==!0&&wt(En(gt));const In=Yt().explore.panes[gt],{datasourceInstance:Gn,containerWidth:Wa,isLive:za,range:Oa,scanning:ss,queryResponse:La,querySubscription:Ca,refreshInterval:Ka,absoluteRange:As,cache:Ia,supplementaryQueries:_s}=In;let Fa,xt;const dt=In.queries.map(jt=>({...jt,datasource:jt.datasource||Gn?.getRef()}));Gn!=null&&Tt(wt,Yt().explore,Gn,dt);const St=(0,Te.rk)(Ia,As);if(St)Fa=(0,o.z)([(0,d.of)(St),pn]).pipe((0,c.Z)(([jt,Qt])=>de(jt,La,ue({absoluteRange:As,refreshInterval:Ka,queries:dt}),dt,Qt,on,rn))),xt=Fa.subscribe(jt=>{wt(Xe({exploreId:gt,response:jt}))});else{if(!(0,B.zT)(dt)||!Gn)return;const jt=Gn?.interval;(0,B._u)(Ca);const Qt={minInterval:jt,maxDataPoints:Wa,liveStreaming:za},Jt=(0,M.O)(Yt().user),ln=(0,B.bI)(gt,dt,Qt,Oa,ss,Jt,Xt);if(wt(ye({exploreId:gt,loadingState:p.Gu.Loading})),Fa=(0,o.z)([(0,K.BN)(Gn,ln.request).pipe(za?(0,m.c)(500):i.D),pn]).pipe((0,c.Z)(([fn,gn])=>de(fn,La,ue({absoluteRange:As,refreshInterval:Ka,queries:dt}),dt,gn,on,rn))),xt=Fa.subscribe({next(fn){const gn=Yt().explore.panes[gt];if(wt(Xe({exploreId:gt,response:fn})),gn.scanning)if(console.log(fn.series),fn.state===p.Gu.Done&&fn.series.length===0){const vn=(0,S.Wb)(-1,gn.range);wt((0,Me.JA)({exploreId:gt,absoluteRange:vn})),wt(It({exploreId:gt}))}else(fn.series[0]?.length>0||fn.state===p.Gu.Done)&&wt(Oe({exploreId:gt}))},error(fn){wt((0,F.dx)((0,V.gi)("Query processing error",fn))),wt(ye({exploreId:gt,loadingState:p.Gu.Error})),console.error(fn)},complete(){Yt().explore.panes[gt].queryResponse.state===p.Gu.Loading&&wt(ye({exploreId:gt,loadingState:p.Gu.Done}))}}),za)for(const fn of me.VW)wt(Ue({exploreId:gt,type:fn})),wt(Be({exploreId:gt,type:fn}));else wt(an({exploreId:gt,datasourceInstance:Gn,transaction:ln,newQuerySource:Fa,supplementaryQueries:_s,queries:dt,absoluteRange:As}))}wt(Re({exploreId:gt,querySubscription:xt}))}),Mt=(0,U.zD)("explore/runLoadMoreQueries",async({exploreId:gt,absoluteRange:Ht},{dispatch:wt,getState:Yt})=>{wt(ge(gt));const{datasourceInstance:rn,containerWidth:Xt,queryResponse:on}=Yt().explore.panes[gt],{defaultCorrelationEditorDatasource:pn,scopedVars:Un,showCorrelationEditorLinks:In}=await(0,Te.aj)(Yt(),gt),Gn=(0,ce.M)(gt);let Wa;const za=on.logsResult?.queries||[],Oa=on.logsFrames.map(Ia=>Ia.refId),ss=za.filter(Ia=>Oa.includes(Ia.refId)).map(Ia=>({...Ia,datasource:Ia.datasource||rn?.getRef(),refId:Ia.refId,supportingQueryType:L.Q$.InfiniteScroll}));if(!(0,B.zT)(ss)||!rn)return;const La={minInterval:rn?.interval,maxDataPoints:Xt},Ca=(0,M.O)(Yt().user),Ka=(0,B.zq)(Ca,{from:(0,r.oZ)(Ca,Ht.from),to:(0,r.oZ)(Ca,Ht.to)},(0,M.q)(Yt().user)),As=(0,B.bI)(gt,ss,La,Ka,!1,Ca,Un);wt(ye({exploreId:gt,loadingState:p.Gu.Loading})),Wa=(0,o.z)([(0,K.BN)(rn,As.request),Gn]).pipe((0,c.Z)(([Ia,_s])=>Ia.state!==p.Gu.Done?(0,d.of)({...on,state:p.Gu.Loading}):de(u(on,Ia),on,ue({absoluteRange:Ht,queries:za,deduplicate:!0}),ss,_s,In,pn))),Wa.subscribe({next(Ia){wt(Xe({exploreId:gt,response:Ia}))},error(Ia){wt((0,F.dx)((0,V.gi)("Query processing error",Ia))),wt(ye({exploreId:gt,loadingState:p.Gu.Error})),console.error(Ia)},complete(){wt(ye({exploreId:gt,loadingState:p.Gu.Done}))}})}),Ut=async(gt,Ht)=>{const wt=gt.filter(rn=>rn.datasource?.uid!==A.uv),Yt=(0,l.groupBy)(wt,"datasource.uid");return await Promise.all(Object.values(Yt).map(async rn=>({datasource:await(0,j.l)().get(rn[0].datasource,Ht),targets:rn})))},an=(0,U.zD)("explore/handleSupplementaryQueries",async({datasourceInstance:gt,exploreId:Ht,transaction:wt,newQuerySource:Yt,supplementaryQueries:rn,queries:Xt,absoluteRange:on},{dispatch:pn})=>{let Un;gt.meta.mixed?Un=await Ut(wt.request.targets,wt.request.scopedVars):Un=[{datasource:gt,targets:wt.request.targets}];for(const In of me.VW){const Gn=(0,me.Pm)(Un,In,{...wt.request,requestId:`${wt.request.requestId}_${(0,l.snakeCase)(In)}`},Yt);Gn?(pn(Ae({exploreId:Ht,type:In,dataProvider:Gn})),cn(rn[In].data,Xt,on)||(pn(Be({exploreId:Ht,type:In})),rn[In].enabled&&pn(Bn(Ht,In)))):pn(Ue({exploreId:Ht,type:In}))}});function cn(gt,Ht,wt){if(!gt)return!1;const Yt=(0,l.zipObject)((0,l.map)(Ht,"refId"),Ht),rn=(0,l.mapValues)((0,l.groupBy)(gt.data.map(Un=>Un.meta?.custom?.sourceQuery),"refId"),l.head),Xt=gt.data.every(Un=>Un.meta?.custom?.logsVolumeType===g.Aj.FullRange),on=s()(Yt,rn),pn=gt.data.every(Un=>{const In=Un.meta?.custom?.absoluteRange;return In?In&&In.from<=wt.from&&wt.to<=In.to:!0});return Xt&&on&&pn}function un(gt,Ht){return(wt,Yt)=>{const rn=Yt().explore.panes[gt].queries,Xt=Ht.map((on,pn)=>(0,B.eF)(on,rn,pn));wt(le({exploreId:gt,queries:Xt})),wt(It({exploreId:gt}))}}function On(gt){return(Ht,wt)=>{Ht(be({exploreId:gt}));const Yt=(0,S.Wb)(-1,wt().explore.panes[gt].range);Ht((0,Me.JA)({exploreId:gt,absoluteRange:Yt})),Ht(It({exploreId:gt}))}}function yn(gt){return(Ht,wt)=>{const Yt=wt().explore.panes[gt].queryResponse,rn=wt().explore.panes[gt].absoluteRange,Xt=(0,Te.O2)(rn);Yt.state===p.Gu.Done&&Ht(we({exploreId:gt,cacheKey:Xt,queryResponse:Yt}))}}function En(gt){return(Ht,wt)=>{Ht(ze({exploreId:gt}))}}function Bn(gt,Ht){return(wt,Yt)=>{const{supplementaryQueries:rn}=Yt().explore.panes[gt],Xt=rn[Ht].dataProvider;if(Xt){const on=Xt.subscribe({next:pn=>{wt(_e({exploreId:gt,type:Ht,data:pn}))}});wt(We({exploreId:gt,type:Ht,dataSubscription:on}))}}}function fa(gt,Ht,wt){return(Yt,rn)=>{Yt(Ne({exploreId:gt,enabled:Ht,type:wt})),(0,me.Oi)(Ht,wt),Ht&&Yt(Bn(gt,wt))}}const Fn=(gt,Ht)=>{if(Qe.match(Ht)){const{queries:wt}=gt,{index:Yt,query:rn}=Ht.payload,Xt=[...wt.slice(0,Yt+1),{...rn},...wt.slice(Yt+1)];return{...gt,queries:Xt,queryKeys:(0,B.dY)(Xt)}}if(tt.match(Ht)){const{queries:wt}=Ht.payload;return{...gt,queries:wt}}if(ke.match(Ht))return(0,B._u)(gt.querySubscription),{...gt,...gt.queryResponse?{queryResponse:{...gt.queryResponse,state:p.Gu.Done}}:{}};if(le.match(Ht)){const{queries:wt}=Ht.payload;return{...gt,queries:wt.slice(),queryKeys:(0,B.dY)(wt)}}if(Re.match(Ht)){const{querySubscription:wt}=Ht.payload;return{...gt,querySubscription:wt}}if(Ne.match(Ht)){const{enabled:wt,type:Yt}=Ht.payload,{supplementaryQueries:rn}=gt,Xt=rn[Yt].dataSubscription;!wt&&Xt&&Xt.unsubscribe();const on={...rn,[Yt]:{...rn[Yt],enabled:wt,data:void 0}};return{...gt,supplementaryQueries:on}}if(Ae.match(Ht)){const{dataProvider:wt,type:Yt}=Ht.payload,{supplementaryQueries:rn}=gt,Xt=rn[Yt];Xt?.dataSubscription&&Xt.dataSubscription.unsubscribe();const on={...rn,[Yt]:{...Xt,dataProvider:wt,dataSubscription:void 0}};return{...gt,supplementaryQueries:on}}if(Ue.match(Ht)){const{type:wt}=Ht.payload,{supplementaryQueries:Yt}=gt,rn=Yt[wt];rn?.dataSubscription&&rn.dataSubscription.unsubscribe();const Xt={...Yt,[wt]:{...rn,dataProvider:void 0,dataSubscription:void 0}};return{...gt,supplementaryQueries:Xt}}if(Be.match(Ht)){const{type:wt}=Ht.payload,{supplementaryQueries:Yt}=gt,rn={...Yt,[wt]:{...Yt[wt],data:void 0}};return{...gt,supplementaryQueries:rn}}if(We.match(Ht)){const{dataSubscription:wt,type:Yt}=Ht.payload,{supplementaryQueries:rn}=gt,Xt={...rn,[Yt]:{...rn[Yt],dataSubscription:wt}};return{...gt,supplementaryQueries:Xt}}if(_e.match(Ht)){let{data:wt,type:Yt}=Ht.payload;const{supplementaryQueries:rn}=gt,Xt={...rn,[Yt]:{...rn[Yt],data:wt}};return{...gt,supplementaryQueries:Xt}}if(Xe.match(Ht))return Ea(gt,Ht);if(He.match(Ht)){const{queries:wt}=Ht.payload;return{...gt,queries:wt,queryKeys:(0,B.dY)(wt)}}if(ye.match(Ht)){const{loadingState:wt}=Ht.payload;return{...gt,queryResponse:{...gt.queryResponse,state:wt}}}if(pe.match(Ht)){const{isPaused:wt}=Ht.payload;return{...gt,isPaused:wt}}if(be.match(Ht))return{...gt,scanning:!0};if(Oe.match(Ht))return{...gt,scanning:!1,scanRange:void 0};if(we.match(Ht)){const{cache:Yt}=gt,{queryResponse:rn,cacheKey:Xt}=Ht.payload;let on=[...Yt];return on.some(Un=>Un.key===Xt)||(on=[{key:Xt,value:rn},...on].slice(0,5)),{...gt,cache:on}}if(ze.match(Ht))return{...gt,cache:[]};if(ve.match(Ht)){if(!gt.logsResult)return{...gt,clearedAtIndex:null};if(gt.queryResponse.state===p.Gu.Loading)return{...gt,clearedAtIndex:null,logsResult:{...gt.logsResult,rows:[]}};const wt=gt.clearedAtIndex?gt.clearedAtIndex+gt.logsResult.rows.length:gt.logsResult.rows.length-1;return{...gt,clearedAtIndex:wt,logsResult:{...gt.logsResult,rows:[]}}}return gt},Ea=(gt,Ht)=>{const{response:wt}=Ht.payload,{request:Yt,error:rn,graphResult:Xt,logsResult:on,tableResult:pn,rawPrometheusResult:Un,traceFrames:In,nodeGraphFrames:Gn,flameGraphFrames:Wa,rawPrometheusFrames:za,customFrames:Oa}=wt;return rn&&(rn.type===y.v2.Timeout||rn.type===y.v2.Cancelled)?{...gt}:Yt?{...gt,queryResponse:wt,graphResult:Xt,tableResult:pn,rawPrometheusResult:Un,logsResult:gt.isLive&&on?{...on,rows:(0,Te.pg)(gt.clearedAtIndex,on.rows)}:on,showLogs:!!on,showMetrics:!!Xt,showTable:!!pn?.length,showTrace:!!In.length,showNodeGraph:!!Gn.length,showRawPrometheus:!!za.length,showFlameGraph:!!Wa.length,showCustom:!!Oa?.length,clearedAtIndex:gt.isLive?gt.clearedAtIndex:null}:{...gt}}},20718:(Z,R,e)=>{"use strict";e.d(R,{Jr:()=>p,K6:()=>i,Kl:()=>g,Qb:()=>l,i6:()=>d,pF:()=>c,qq:()=>h,st:()=>m,vC:()=>r});var n=e(25508),a=e(2543),s=e.n(a);const l=y=>y.explore.panes,o=y=>y.explore,d=y=>y.explore.richHistorySettings,i=(0,n.Mz)(l,Object.entries),c=(0,n.Mz)(i,y=>y.length>1),m=(0,n.Mz)(i,y=>y.some(v=>v[1].correlationEditorHelperData!==void 0)),p=y=>(0,n.Mz)(l,v=>Object.keys(v)[0]===y),h=y=>(0,n.Mz)(l,v=>v[y]),r=(0,n.Mz)(o,y=>y.correlationEditorDetails),g=(0,n.Mz)(i,y=>{const v=y.map(([u,b])=>{const E=[b?.datasourceInstance?.getRef()],D=b?.queries.map(P=>P.datasource)||[],C=[...E,...D].filter(P=>!!P);if(!(C===void 0||C.length===0))return{exploreId:u,datasources:(0,a.uniqBy)(C,P=>P.uid)}}).filter(u=>!!u),f=(0,a.uniqBy)((0,a.flatten)(v.map(u=>u.datasources)),u=>u.uid).map(u=>{let b=[];return v.forEach(E=>{E.datasources.some(D=>D.uid===u.uid)&&b.push(E.exploreId)}),{datasource:u,exploreIds:b}});return{exploreToDS:v,dsToExplore:f}})},94543:(Z,R,e)=>{"use strict";e.d(R,{$_:()=>P,GA:()=>j,GH:()=>u,Iy:()=>T,JA:()=>E,QP:()=>W,Xk:()=>I,eM:()=>x,hO:()=>f,iO:()=>D,ke:()=>O,zY:()=>b});var n=e(65307),a=e(25229),s=e(32899),l=e(28105),o=e(92745),d=e(2863),i=e(90811),c=e(45229),m=e(62635),p=e(23237),h=e(75421),r=e(74746),g=e(34984),y=e(35231),v=e(19050);const x=(0,n.VP)("explore/changeRange"),f=(0,n.VP)("explore/changeRefreshInterval"),u=B=>(S,w)=>{const{syncedTimes:N}=w().explore;N?Object.keys(w().explore.panes).forEach(M=>{S(E({...B,exploreId:M})),S((0,v.Od)({exploreId:M,preserveCache:!0}))}):(S(E({...B})),S((0,v.Od)({exploreId:B.exploreId,preserveCache:!0})))},b=B=>S=>{S((0,v.S6)({...B}))},E=B=>(S,w)=>{const{exploreId:N,absoluteRange:M,rawRange:L}=B,A=w().explore.panes[N],U=(0,g.O)(w().user),F=(0,g.q)(w().user),{range:V}=A;let K=V.raw;M&&(K={from:(0,a.oZ)(U,M.from),to:(0,a.oZ)(U,M.to)}),L&&(K=L);const G=(0,m.zq)(U,K,F),H={from:G.from.valueOf(),to:G.to.valueOf()};(0,h.jG)().init({timepicker:{},getTimezone:()=>U,timeRangeUpdated(_){},time:G.raw}),(0,d.w)().updateTimeRange(G),S(x({exploreId:N,range:G,absoluteRange:H}))};function D(B){return(S,w)=>{const N=w().explore.panes[B].range.raw;Object.keys(w().explore.panes).filter(L=>L!==B).forEach(L=>{S(u({exploreId:L,rawRange:N}))});const M=w().explore.syncedTimes;S((0,y.qz)({syncedTimes:!M}))}}function C(B){return(S,w)=>{const N=(0,g.O)(w().user),M=(0,g.q)(w().user);Object.entries(w().explore.panes).forEach(([L,A])=>{const U=(0,m.zq)(N,A.range.raw,M);B(L,A,U,S)})}}function P(){return C((B,S,w,N)=>{const M={from:w.from.valueOf(),to:w.to.valueOf()};N(u({exploreId:B,absoluteRange:M}))})}function T(B){return C((S,w,N,M)=>{const L=(0,p.Wb)(B,N);M(u({exploreId:S,absoluteRange:L}))})}function O(B){return C((S,w,N,M)=>{const L=(0,p.Zk)(N,B);M(u({exploreId:S,absoluteRange:L}))})}function I(){return(B,S)=>{const w=S().explore.panes[Object.keys(S().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(w)),c.A.emit(s.r1.alertSuccess,[(0,o.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function j(){return async(B,S)=>{const{range:w,isError:N}=await(0,p.zG)();if(N===!0){c.A.emit(s.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:w})]);return}if(S().explore.syncedTimes){B(u({exploreId:Object.keys(S().explore.panes)[0],rawRange:w})),B(u({exploreId:Object.keys(S().explore.panes)[1],rawRange:w}));return}B(u({exploreId:Object.keys(S().explore.panes)[0],rawRange:w}))}}const W=(B,S)=>{if(f.match(S)){const{refreshInterval:w}=S.payload,N=i.cC.isLive(w),M=(0,m.uE)(w),L=(0,r.zy)(B.logsResult,M);return i.cC.isLive(B.refreshInterval)&&!N&&(0,m._u)(B.querySubscription),{...B,refreshInterval:w,queryResponse:{...B.queryResponse,state:N?l.Gu.Streaming:l.Gu.Done},isLive:N,isPaused:N?!1:B.isPaused,logsResult:L}}if(x.match(S)){const{range:w,absoluteRange:N}=S.payload;return{...B,range:w,absoluteRange:N}}return B}},83953:(Z,R,e)=>{"use strict";e.d(R,{BE:()=>D,HZ:()=>b,O2:()=>C,RA:()=>E,Z9:()=>O,aj:()=>B,dq:()=>W,eO:()=>T,ng:()=>u,pg:()=>j,rk:()=>P});var n=e(2543),a=e.n(n),s=e(28105),l=e(22592),o=e(33239),d=e(25229),i=e(78282),c=e(53222),m=e(80977),p=e(18615),h=e(29043),r=e(62635),g=e(28998),y=e(10951),v=e(2513);const x=100,f="grafana.explore.style.graph",u=S=>{h.A.set(f,S)},b=S=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:v.k},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:E(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,y.Ez)(),panelsState:{},correlations:void 0,...S}),E=()=>({state:s.Gu.NotStarted,series:[],timeRange:(0,l.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function D(S,w){let N;try{N=await(0,g.tR)().get(w)}catch{N=await(0,g.tR)().get()}if(N.init)try{N.init()}catch(U){console.error(U)}let M=[];const L=(0,c.tU)(),A=await L.getRichHistory({search:"",sortOrder:m.x.Ascending,datasourceFilters:[N.name],starred:!1});if((A.total||0)>0&&A.richHistory.forEach(U=>{U.queries.forEach(F=>{M.push({ts:parseInt(U.id,10),query:F})})}),M.length<x){const U=await L.getRichHistory({search:"",sortOrder:m.x.Ascending,datasourceFilters:[p.uv],starred:!1});(U.total||0)>0&&U.richHistory.forEach(F=>{F.queries.forEach(V=>{V?.datasource?.uid===N.uid&&M.push({ts:parseInt(F.id,10),query:V})})})}if(M.length<x){const U=`grafana.explore.history.${N.meta?.id}`;M=[...M,...h.A.getObject(U,[])]}return M.length>x&&(M.length=x),(0,r.dr)(S,N.uid),{history:M,instance:N}}function C(S){const w={from:S.from,to:S.to};return Object.entries(w).map(([M,L])=>`${encodeURIComponent(M)}=${encodeURIComponent(L.toString())}`).join("&")}function P(S,w){const N=C(w),M=S.findIndex(A=>A.key===N);return M>=0?S[M].value:void 0}function T(S,w){return{from:o.parse(S.from,!1,w),to:o.parse(S.to,!0,w),raw:S}}function O(S){let w=v.k,N={from:I(S.from),to:I(S.to)};return N.from!==null&&N.to!==null&&(w={from:N.from,to:N.to}),w}function I(S){if(S===null)return null;if((0,d.Ar)(S))return S;if(typeof S!="string")return null;const w=S;if(w.indexOf("now")!==-1)return w;if(w.length===8)return(0,d.yT)(w,"YYYYMMDD");if(w.length===15)return(0,d.yT)(w,"YYYYMMDDTHHmmss");if(w.length===19)return(0,d.yT)(w,"YYYY-MM-DD HH:mm:ss");if(w.match(/^\d+$/)){const M=parseInt(w,10);return(0,d.yT)(M)}const N=(0,d.yT)(w);return N.isValid()?N:null}const j=(S,w)=>w?S?w.slice(S+1):w:[],W=(S,w)=>S===p.uv?(0,n.uniq)(w.map(N=>N.datasource?.uid).filter(N=>!!N)):[S];async function B(S,w){const N=S.explore.panes[w].correlationEditorHelperData,M=S.explore.correlationEditorDetails?.editorMode||!1,L=Object.keys(S.explore.panes)[0]===w,A=M&&L,U=A?await(0,i.l)().get():void 0,F=M&&!L&&N!==void 0;let V={};return F&&N!==void 0&&Object.entries(N?.vars).forEach(K=>{V[K[0]]={value:K[1]}}),{defaultCorrelationEditorDatasource:U,scopedVars:V,showCorrelationEditorLinks:A}}},78529:(Z,R,e)=>{"use strict";e.d(R,{JQ:()=>T,O1:()=>I,QL:()=>C,YV:()=>D,_O:()=>B});var n=e(2543),a=e.n(n),s=e(96540),l=e(7102),o=e(39443),d=e(79609),i=e(1906),c=e(38036),m=e(83175),p=e(92745),h=e(2863),r=e(27489),g=e(15130),y=e(70191),v=e(46072),x=e(82345),f=e(55133);const b=[S=>!S.internal||g.TP.hasAccessToExplore()],E="grafana_data_link_clicked",D=(S,w)=>M=>{const{field:L,dataLinkScopedVars:A,frame:U,link:F,linkModel:V}=M,{valueRowIndex:K}=M.config;if(K===void 0)return V;const G=C({field:L,rowIndex:K,splitOpenFn:S,range:w,vars:A,dataFrame:U,linksToProcess:[F]});return G.length?(0,n.first)(G):void 0},C=S=>{const{field:w,vars:N,splitOpenFn:M,range:L,rowIndex:A,dataFrame:U}=S,F={...N||{}};F.__value={value:{raw:w.values[A]},text:(0,p.t)("explore.get-field-links-for-explore.text.raw-value","Raw value")};let V;if(U){if(V=(0,l.F)({frame:U,rowIndex:A}),F.__data={value:{name:U.name,refId:U.refId,fields:V},text:(0,p.t)("explore.get-field-links-for-explore.text.data","Data")},U.meta?.type===o.m.LogLines){const H=(0,v.ww)(U)?.getLogFrameLabels();H!=null&&Object.entries(H[A]).forEach(_=>{F[_[0]]={value:_[1]}})}U.fields.forEach(G=>{V&&V[G.name]&&(F[G.name]={value:V[G.name]})}),F.__targetField={value:V[w.name]}}const K=S.linksToProcess||w.config.links;return K?K.filter(_=>b.every(k=>k(_,F))).map(_=>{let k={};_.meta?.transformations&&_.meta?.transformations.forEach(X=>{let Q;X.field?Q=U?.fields.find(te=>te.name===X.field)?.values[A]:Q=w.values[A],k={...k,...(0,y.k)(X,Q,w.name)}});const J={...F,...k},z=I(_,J);let Y=[];if(z.variables.length===0){const X=w.name.toString();Y.push({variableName:X,value:"",match:""})}else Y=z.variables;if(z.allVariablesDefined)if(_.internal){const X=q=>{(0,r.rR)(E,{origin:_.origin||d.x0.Datasource,app:i.Jk.Explore,internal:!0}),M?.(q)};return{...(0,c.u)({link:_,internalLink:_.internal,scopedVars:J,range:L,field:w,onClickFn:S.splitOpenFn?q=>X(q):void 0,replaceVariables:(0,h.w)().replace.bind((0,h.w)())}),variables:Y}}else{const X=(q,te)=>(0,h.w)().replace(q,{...te,...J,...F}),Q=(0,x.mQ)().getDataLinkUIModel(_,X,w);return Q.title||(Q.title=P(Q.href)),Q.target=Q.target??"_blank",{...Q,variables:Y}}else return}).filter(_=>!!_):[]};function P(S){S.indexOf("://")<0&&(S=`http://${S}`);let w;try{w=new URL(S).hostname}catch{w=S}return w}function T(S,w){return(0,s.useCallback)((N,M)=>N.fields.flatMap(L=>L.config?.links&&L.config?.links.length?C({field:L,rowIndex:M,range:S,dataFrame:N,splitOpenFn:w}):[]),[S,w])}const O=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function I(S,w){let N=[];return(0,h.w)().replace.bind((0,h.w)())(j(S),w,void 0,N),N=(0,n.uniqBy)(N,"variableName"),{variables:N,allVariablesDefined:N.filter(L=>!O.includes(L.variableName)).every(L=>L.found)}}function j(S){let w="",N;for(N in S)typeof S[N]=="string"?w+=" "+S[N]:typeof S[N]=="object"&&(w+=" "+j(S[N]));return w}const W=S=>S[1]!==void 0,B=S=>{const w=Object.entries(S).filter(W).map(([N,M])=>{const L=(0,f.m)(M);return L.range={to:M.range.to.valueOf().toString(),from:M.range.from.valueOf().toString()},[N,L]}).reduce((N,[M,L])=>({...N,[M]:L}),{});return m.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(w)})}},80144:(Z,R,e)=>{"use strict";e.d(R,{v:()=>a});var n=e(39796);function a(s){const l=new Set(s.map(o=>o.refId).filter(Boolean));return l.size===s.length?s:(l.clear(),s.map(o=>{if(o.refId&&!l.has(o.refId))return l.add(o.refId),o;const d=(0,n.M)(s);return l.add(d),{...o,refId:d}}))}},10951:(Z,R,e)=>{"use strict";e.d(R,{Ez:()=>y,Oi:()=>g,Pm:()=>f,VW:()=>h});var n=e(2543),a=e.n(n),s=e(88483),l=e(44240),o=e(6276),d=e(29405),i=e(67770),c=e(28105),m=e(29043),p=e(37234);const h=[i.cF.LogsVolume,i.cF.LogsSample],r=u=>`grafana.explore.logs.enable${u}`,g=(u,b)=>{m.A.set(r(b),u?"true":"false")},y=()=>{let u={[i.cF.LogsVolume]:{enabled:!0},[i.cF.LogsSample]:{enabled:!1}};for(const b of h){if(b===i.cF.LogsSample)continue;m.A.get(r(b))==="false"&&(u[b]={enabled:!1})}return u},v=(u,b,E)=>new s.c(D=>u.subscribe(C=>{if(C.logsResult&&C.logsResult.rows&&C.logsResult.visibleRange&&C.logsResult.bucketSize!==void 0&&C.state===c.Gu.Done){const P=C.logsResult.bucketSize,T=b.map(j=>j.refId),O=(0,n.groupBy)(C.logsResult.rows,"dataFrame.refId");let I=[];T.forEach(j=>{if(O[j]?.length){const W=(0,p.J9)(O[j],P);I=[...I,...W];const B={logsVolumeType:i.Aj.Limited,absoluteRange:C.logsResult?.visibleRange,datasourceName:E,sourceQuery:b.find(S=>S.refId===j)};D.next({data:I.map(S=>{const w=S.meta?.custom||{};return{...S,meta:{custom:{...w,...B}}}}),state:C.state})}}),D.complete()}})),x=(u,b,E,D)=>{if(u===i.cF.LogsVolume)return v(b,E,D)},f=(u,b,E,D)=>{const P=u.map(({datasource:T,targets:O},I)=>{const j=(0,n.cloneDeep)(E);if(j.requestId=`${j.requestId||""}_${I}`,j.targets=O,(0,i.Nc)(T,b)){if(T.getDataProvider)return T.getDataProvider(b,j);if(T.getSupplementaryRequest){const W=T.getSupplementaryRequest(b,j);return W?b===i.cF.LogsVolume?(0,p.sg)(T,W,{targets:j.targets}):(0,p.Wr)(T,W):void 0}else return}else return x(b,D,O,T.name)}).filter(c.zz);if(P.length!==0)return P.length===1?P[0]:(0,l.h)(...P).pipe((0,d.S)((T,O)=>T.errors&&T.errors.length||O.state===c.Gu.NotStarted?T:O.state===c.Gu.Loading&&T.state===c.Gu.NotStarted?{...T,state:c.Gu.Loading}:O.state&&O.state!==c.Gu.Done?T:{...T,data:[...T.data,...O.data],state:c.Gu.Done},{data:[],state:c.Gu.NotStarted}),(0,o.d)())}},29328:(Z,R,e)=>{"use strict";e.d(R,{Ex:()=>N,$i:()=>w});var n=e(65474),a=e(69862),s=e(11594),l=e(36580),o=e(2863),d=e(78282),i=e(19729),c=e(74848),m=e(22803),p=e(96540),h=e(92745),r=e(63142),g=e(18027),y=e(45861),v=e(76319),x=e(91073),f=e(52900),u=e(18203),b=e(89931),E=e(4652),D=e(32576),C=e(38610),P=e(4651),T=e(82779);const O=15,I=M=>{const L=P.uQ.find(({value:A})=>A===M)?.description;switch(M){case P.Tz.sql:return(0,c.jsx)(h.x6,{i18nKey:"expressions.expression-query-editor.helper-text-sql",children:'Run MySQL-dialect SQL against the tables returned from your data sources. Data source queries (ie "A", "B") are available as tables and referenced by query-name. Fields are available as columns, as returned from the data source.'});default:return L??""}};function j(){const M=(0,p.useRef)({}),L=(0,p.useCallback)(U=>{switch(U){case P.Tz.math:case P.Tz.reduce:case P.Tz.resample:case P.Tz.threshold:case P.Tz.sql:return M.current[U];case P.Tz.classic:return}},[]),A=(0,p.useCallback)((U,F)=>{switch(U){case P.Tz.math:M.current.math=F;break;case P.Tz.reduce:case P.Tz.resample:case P.Tz.threshold:M.current.reduce=F,M.current.resample=F,M.current.threshold=F;break;case P.Tz.sql:M.current.sql=F}},[]);return{getCachedExpression:L,setCachedExpression:A}}function W(M){const{query:L,queries:A,onRunQuery:U,onChange:F,app:V}=M,{getCachedExpression:K,setCachedExpression:G}=j(),H=(0,r.of)(B);(0,p.useEffect)(()=>{G(L.type,L.expression)},[L.expression,L.type,G]);const _=(0,p.useCallback)(z=>{const Y=K(z),X=(0,T.rV)({...L,type:z});F({...X,expression:Y??X.expression})},[L,F,K]),k=()=>{const z=A.filter(Y=>L.refId!==Y.refId).map(Y=>({value:Y.refId,label:Y.refId}));switch(L.type){case P.Tz.math:return(0,c.jsx)(u.z,{onChange:F,query:L,labelWidth:O,onRunQuery:U});case P.Tz.reduce:return(0,c.jsx)(b.Z,{refIds:z,onChange:F,labelWidth:O,query:L,app:V});case P.Tz.resample:return(0,c.jsx)(E.C,{query:L,labelWidth:O,onChange:F,refIds:z});case P.Tz.classic:return(0,c.jsx)(x.z,{onChange:F,query:L,refIds:z});case P.Tz.threshold:return(0,c.jsx)(C.O,{onChange:F,query:L,labelWidth:O,refIds:z});case P.Tz.sql:return(0,c.jsx)(D.k,{onChange:F,query:L,refIds:z})}},J=I(L.type);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:H.operationRow,children:[(0,c.jsx)(g.I,{label:(0,h.t)("expressions.expression-query-editor.label-operation","Operation"),labelWidth:O,children:(0,c.jsx)(f.m,{handleOnSelect:_,children:(0,c.jsx)(y.$n,{fill:"outline",icon:"angle-down",iconPlacement:"right",variant:"secondary",children:P.uQ.find(({value:z})=>z===L.type)?.label})})}),J&&(0,c.jsx)(v.K,{className:H.infoIcon,name:"info-circle",tooltip:J})]}),k()]})}const B=M=>({operationRow:(0,m.css)({display:"flex",alignItems:"center",gap:M.spacing(1)}),infoIcon:(0,m.css)({marginBottom:M.spacing(.5)})});class S extends l.iy{constructor(L){super(L),this.instanceSettings=L}applyTemplateVariables(L,A){const U=(0,o.w)();return{...L,expression:U.replace(L.expression,A),window:U.replace(L.window,A)}}getCollapsedText(L){return`Expression: ${L.type}`}query(L){let A=L.targets.map(async F=>{const V=await(0,d.l)().get(F.datasource);return V.interpolateVariablesInQueries?V?.interpolateVariablesInQueries([F],L.scopedVars,L.filters)[0]:F});return(0,n.H)(Promise.all(A)).pipe((0,a.Z)(F=>super.query({...L,targets:F})))}newQuery(L){return{refId:"--",datasource:l.dR,type:L?.type??P.Tz.math,...L}}}const w={id:-100,uid:P.Uj,name:l.dR.name,type:l.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:s.QE.datasource,name:l.dR.type,id:l.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:i,large:i},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},N=new S(w);N.meta={id:l.dR.type,info:{logos:{small:i,large:i}}},N.components={QueryEditor:W}},91073:(Z,R,e)=>{"use strict";e.d(R,{z:()=>E});var n=e(74848),a=e(92745),s=e(97095),l=e(18027),o=e(45861),d=e(30703),i=e(82779),c=e(22803),m=e(63142),p=e(41654),h=e(15356),r=e(18857),g=e(63527),y=e(2954);const v=y.A.reducerTypes.map(D=>({label:D.text,value:D.value})),x=y.A.evalOperators.map(D=>({label:D.text,value:D.value})),f=y.A.evalFunctions.map(D=>({label:D.text,value:D.value})),u=({condition:D,index:C,onChange:P,onRemoveCondition:T,refIds:O})=>{const I=(0,m.of)(b),j=L=>{P({...D,operator:{type:L.value}})},W=L=>{P({...D,reducer:{type:L.value,params:[]}})},B=L=>{P({...D,query:{params:[L.value]}})},S=L=>{P({...D,evaluator:{params:D.evaluator.params,type:L.value}})},w=(L,A)=>{const U=parseFloat(L.currentTarget.value),F=[...D.evaluator.params];F[A]=U,P({...D,evaluator:{...D.evaluator,params:F}})},N=(0,c.css)({width:"75px"}),M=D.evaluator.type===y.p.IsWithinRange||D.evaluator.type===y.p.IsOutsideRange||D.evaluator.type===y.p.IsOutsideRangeIncluded||D.evaluator.type===y.p.IsWithinRangeIncluded;return(0,n.jsxs)(p.B,{children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsxs)(s.C,{children:[C===0?(0,n.jsx)("div",{className:(0,c.cx)(I.button,N),children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.when",children:"WHEN"})}):(0,n.jsx)(h.f,{className:(0,c.cx)(I.buttonSelectText,N),options:x,onChange:j,value:x.find(L=>L.value===D.operator.type)}),(0,n.jsx)(r.l6,{options:v,onChange:W,width:20,value:v.find(L=>L.value===D.reducer.type)}),(0,n.jsx)("div",{className:I.button,children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.of",children:"OF"})}),(0,n.jsx)(r.l6,{onChange:B,options:O,width:"auto",value:O.find(L=>L.value===D.query.params[0])})]}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(h.f,{className:I.buttonSelectText,options:f,onChange:S,value:f.find(L=>L.value===D.evaluator.type)}),M?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.p,{type:"number",width:10,onChange:L=>w(L,0),value:D.evaluator.params[0]}),(0,n.jsx)("div",{className:I.button,children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.to",children:"TO"})}),(0,n.jsx)(g.p,{type:"number",width:10,onChange:L=>w(L,1),value:D.evaluator.params[1]})]}):D.evaluator.type!==y.p.HasNoValue?(0,n.jsx)(g.p,{type:"number",width:10,onChange:L=>w(L,0),value:D.evaluator.params[0]}):null]})]}),(0,n.jsx)(o.$n,{variant:"secondary",type:"button",onClick:()=>T(C),children:(0,n.jsx)(d.I,{name:"trash-alt"})})]})},b=D=>{const C=(0,c.css)({color:D.colors.primary.text,fontSize:D.typography.bodySmall.fontSize});return{buttonSelectText:C,button:(0,c.cx)((0,c.css)({display:"flex",alignItems:"center",borderRadius:D.shape.radius.default,fontWeight:D.typography.fontWeightMedium,border:`1px solid ${D.colors.border.weak}`,whiteSpace:"nowrap",padding:`0 ${D.spacing(1)}`,backgroundColor:D.colors.background.canvas}),C)}},E=({onChange:D,query:C,refIds:P})=>{const T=(j,W)=>{C.conditions&&D({...C,conditions:[...C.conditions.slice(0,W),j,...C.conditions.slice(W+1)]})},O=()=>{if(C.conditions){const j=C.conditions.at(-1)?.query?.params??[],W={...i.P0,query:{params:j}};D({...C,conditions:C.conditions.length>0?[...C.conditions,W]:[W]})}},I=j=>{if(C.conditions){const W=C.conditions[j],B=C.conditions.filter(S=>S!==W).map((S,w)=>w===0?{...S,operator:{type:"when"}}:S);D({...C,conditions:B})}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(l.I,{label:(0,a.t)("expressions.classic-conditions.label-conditions","Conditions"),labelWidth:14,children:(0,n.jsx)("div",{children:C.conditions?.map((j,W)=>{if(j)return(0,n.jsx)(u,{index:W,condition:j,onChange:B=>T(B,W),onRemoveCondition:I,refIds:P},W)})})})}),(0,n.jsx)(o.$n,{variant:"secondary",type:"button",onClick:O,children:(0,n.jsx)(d.I,{name:"plus-circle"})})]})}},52900:(Z,R,e)=>{"use strict";e.d(R,{m:()=>y});var n=e(74848),a=e(22803),s=e(96540),l=e(1906),o=e(63142),d=e(87063),i=e(30703),c=e(991),m=e(45967),p=e(88559),h=e(4651);const r={[h.Tz.math]:"calculator-alt",[h.Tz.reduce]:"compress-arrows",[h.Tz.resample]:"sync",[h.Tz.classic]:"cog",[h.Tz.threshold]:"sliders-v-alt",[h.Tz.sql]:"database"},g=(0,s.memo)(({item:x,onSelect:f})=>{const{value:u,label:b,description:E}=x,D=(0,o.of)(v),C=(0,s.useCallback)(()=>f(u),[u,f]);return(0,n.jsx)(d.W.Item,{component:()=>(0,n.jsxs)("div",{className:D.expressionTypeItem,role:"menuitem",children:[(0,n.jsxs)("div",{className:D.expressionTypeItemContent,"data-testid":`expression-type-${u}`,children:[(0,n.jsx)(i.I,{className:D.icon,name:r[u],"aria-hidden":"true"}),b,u===h.Tz.sql&&(0,n.jsx)(c.y,{featureState:l.Ay.new})]}),(0,n.jsx)(m.m,{placement:"right",content:E,children:(0,n.jsx)(i.I,{className:D.infoIcon,name:"info-circle"})})]}),label:"",onClick:C},u)});g.displayName="ExpressionMenuItem";const y=(0,s.memo)(({handleOnSelect:x,children:f})=>{const u=(0,s.useMemo)(()=>h.uQ.map(E=>(0,n.jsx)(g,{item:E,onSelect:x},E.value)),[x]),b=(0,s.useMemo)(()=>(0,n.jsx)(d.W,{role:"menu",children:u}),[u]);return(0,n.jsx)(p.m,{placement:"bottom-start",overlay:b,children:f})});y.displayName="ExpressionTypeDropdown";const v=x=>({expressionTypeItem:(0,a.css)({width:"100%",display:"flex",alignItems:"center",gap:x.spacing(1)}),expressionTypeItemContent:(0,a.css)({flexGrow:1,display:"flex",alignItems:"center",gap:x.spacing(1)}),icon:(0,a.css)({color:x.colors.text.secondary,flexShrink:0}),infoIcon:(0,a.css)({opacity:.7,color:x.colors.text.secondary,flexShrink:0})})},18203:(Z,R,e)=>{"use strict";e.d(R,{z:()=>g});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(41654),d=e(18027),i=e(79233),c=e(59243),m=e(30703),p=e(89640),h=e(87105);const r="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",g=({labelWidth:f,onChange:u,query:b,onRunQuery:E})=>{const D=T=>{u({...b,expression:T.target.value})},C=(0,l.of)(v),P=()=>{b.expression&&E()};return(0,n.jsx)(o.B,{children:(0,n.jsx)(d.I,{label:(0,n.jsx)(i.c,{width:"auto",children:(0,n.jsx)(c.G,{fitContent:!0,content:(0,n.jsxs)("div",{className:C.documentationContainer,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"expressions.math.run-math-operations",values:{refExample:"${refId}",ref1:"$A",ref2:"$B",ref3:"$C",example:"$A + $B"},children:["Run math operations on one or more queries. You reference the query by ","{{refExample}}"," ie."," ","{{ref1}}",", ","{{ref2}}",", ","{{ref3}}","etc.",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)("code",{children:"{{example}}"})]})}),(0,n.jsx)("header",{className:C.documentationHeader,children:(0,n.jsx)(s.x6,{i18nKey:"expressions.math.available-math-functions",children:"Available math functions"})}),(0,n.jsxs)("div",{className:C.documentationFunctions,children:[(0,n.jsx)(y,{name:"abs",description:(0,s.t)("expression.math.description-abs","Returns the absolute value of its argument which can be a number or a series")}),(0,n.jsx)(y,{name:"is_inf",description:(0,s.t)("expression.math.description-is-inf","Returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(y,{name:"is_nan",description:(0,s.t)("expression.math.description-is-nan","Returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(y,{name:"is_null",description:(0,s.t)("expression.math.description-is-null","Returns 1 for null values and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(y,{name:"is_number",description:(0,s.t)("expression.math.description-is-number","Returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values.")}),(0,n.jsx)(y,{name:"log",description:(0,s.t)("expression.math.description-log","Returns the natural logarithm of its argument, which can be a number or a series")}),(0,n.jsx)(y,{name:"inf, infn, nan, and null",description:(0,s.t)("expression.math.description-inf-nan-null","The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name.")}),(0,n.jsx)(y,{name:"round",description:(0,s.t)("expression.math.description-round","Returns a rounded integer value. It's able to operate on series or escalar values.")}),(0,n.jsx)(y,{name:"ceil",description:(0,s.t)("expression.math.description-ceil","Rounds the number up to the nearest integer value. It's able to operate on series or escalar values.")}),(0,n.jsx)(y,{name:"floor",description:(0,s.t)("expression.math.description-floor","Rounds the number down to the nearest integer value. It's able to operate on series or escalar values.")})]})]}),title:(0,n.jsxs)(o.B,{gap:1,direction:"row",children:[(0,n.jsx)(m.I,{name:"book-open"})," ",(0,n.jsx)(s.x6,{i18nKey:"expressions.math.tooltip-title",children:"Math operator"})]}),footer:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"expressions.math.tooltip-footer",children:["See our additional documentation on"," ",(0,n.jsx)(p.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",children:"Math expressions"}),"."]})}),closeButton:!0,placement:"bottom-start",children:(0,n.jsxs)("div",{className:C.info,children:[(0,n.jsx)(s.x6,{i18nKey:"expressions.math.tooltip-trigger",children:"Expression"})," ",(0,n.jsx)(m.I,{name:"info-circle"})]})})}),labelWidth:f,grow:!0,shrink:!0,children:(0,n.jsx)(h.f,{value:b.expression,onChange:D,rows:1,placeholder:r,onBlur:P,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},y=({name:f,description:u})=>{const b=(0,l.of)(x);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:b.name,children:f}),(0,n.jsx)("span",{className:b.description,children:u})]})},v=f=>({documentationHeader:(0,a.css)({fontSize:f.typography.h5.fontSize,fontWeight:f.typography.h5.fontWeight}),documentationContainer:(0,a.css)({display:"flex",flex:1,flexDirection:"column",gap:f.spacing(2),padding:f.spacing(1,2)}),documentationFunctions:(0,a.css)({display:"grid",gridTemplateColumns:"max-content auto",columnGap:f.spacing(2)}),info:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",gap:f.spacing(1)})}),x=f=>({name:(0,a.css)({fontWeight:f.typography.fontWeightBold}),description:(0,a.css)({fontSize:f.typography.bodySmall.fontSize,color:f.colors.text.disabled})})},89931:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>h});var n=e(74848),a=e(1906),s=e(92745),l=e(18027),o=e(63527),d=e(34999),i=e(89640),c=e(97095),m=e(18857),p=e(4651);const h=({labelWidth:r="auto",onChange:g,app:y,refIds:v,query:x})=>{const f=p.Cu.find(I=>I.value===x.reducer),u=I=>{g({...x,expression:I.value})},b=I=>{g({...x,reducer:I.value})},E=I=>{g({...x,settings:I})},D=I=>{let j;switch(I.value){case p.Mt.Strict:j={mode:p.Mt.Strict};break;case p.Mt.ReplaceNonNumbers:let W=0;x.settings?.mode===p.Mt.ReplaceNonNumbers&&(W=x.settings?.replaceWithValue??0),j={mode:p.Mt.ReplaceNonNumbers,replaceWithValue:W};break;default:j={mode:I.value}}E(j)},C=I=>{const j=I.currentTarget.valueAsNumber;E({mode:p.Mt.ReplaceNonNumbers,replaceWithValue:j??0})},P=x.settings?.mode??p.Mt.Strict,T=()=>{if(P===p.Mt.ReplaceNonNumbers)return(0,n.jsx)(l.I,{label:(0,s.t)("expressions.reduce.replace-with-number.label-replace-with","Replace with"),labelWidth:r,children:(0,n.jsx)(o.p,{type:"number",width:10,onChange:C,value:x.settings?.replaceWithValue??0})})},O=()=>{const I=y===a.Jk.UnifiedAlerting;return P!==p.Mt.Strict||I?null:(0,n.jsx)(d.F,{title:(0,s.t)("reduce.strictMode.title","Strict Mode Behaviour"),severity:"info",children:(0,n.jsxs)(s.x6,{i18nKey:"reduce.strictMode.description",children:["When ",(0,n.jsx)("code",{children:"Reduce Strict mode"})," is used, the ",(0,n.jsx)("code",{children:"fill(null)"})," function (InfluxQL) will result in"," ",(0,n.jsx)("code",{children:"NaN"}),"."," ",(0,n.jsx)(i.Y,{href:"https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/expression-queries/#reduction-modes",children:"See the documentation for more details."})]})})};return(0,n.jsxs)(n.Fragment,{children:[O(),(0,n.jsx)(c.C,{children:(0,n.jsx)(l.I,{label:(0,s.t)("expressions.reduce.label-input","Input"),labelWidth:r,children:(0,n.jsx)(m.l6,{onChange:u,options:v,value:x.expression,width:"auto"})})}),(0,n.jsxs)(c.C,{children:[(0,n.jsx)(l.I,{label:(0,s.t)("expressions.reduce.label-function","Function"),labelWidth:r,children:(0,n.jsx)(m.l6,{options:p.Cu,value:f,onChange:b,width:20})}),(0,n.jsx)(l.I,{label:(0,s.t)("expressions.reduce.label-mode","Mode"),labelWidth:r,children:(0,n.jsx)(m.l6,{onChange:D,options:p.HZ,value:P,width:25})}),T()]})]})}},4652:(Z,R,e)=>{"use strict";e.d(R,{C:()=>c});var n=e(74848),a=e(92745),s=e(97095),l=e(18027),o=e(18857),d=e(63527),i=e(4651);const c=({labelWidth:m="auto",onChange:p,refIds:h,query:r})=>{const g=i.PN.find(b=>b.value===r.downsampler),y=i.iX.find(b=>b.value===r.upsampler),v=b=>{p({...r,window:b.target.value})},x=b=>{p({...r,expression:b.value})},f=b=>{p({...r,downsampler:b.value})},u=b=>{p({...r,upsampler:b.value})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(l.I,{label:(0,a.t)("expressions.resample.label-input","Input"),labelWidth:m,children:(0,n.jsx)(o.l6,{onChange:x,options:h,value:r.expression,width:20})})}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(l.I,{label:(0,a.t)("expressions.resample.label-resample-to","Resample to"),labelWidth:m,tooltip:(0,a.t)("expressions.resample.tooltip-s-m-h","10s, 1m, 30m, 1h"),children:(0,n.jsx)(d.p,{onChange:v,value:r.window,width:15})}),(0,n.jsx)(l.I,{label:(0,a.t)("expressions.resample.label-downsample","Downsample"),children:(0,n.jsx)(o.l6,{options:i.PN,value:g,onChange:f,width:25})}),(0,n.jsx)(l.I,{label:(0,a.t)("expressions.resample.label-upsample","Upsample"),children:(0,n.jsx)(o.l6,{options:i.iX,value:y,onChange:u,width:25})})]})]})}},32576:(Z,R,e)=>{"use strict";e.d(R,{k:()=>c});var n=e(74848),a=e(22803),s=e(96540),l=e(97504),o=e(63142);const d=2,i={id:"mysql"},c=({onChange:p,refIds:h,query:r,alerting:g=!1})=>{const v=`SELECT *
  FROM ${(0,s.useMemo)(()=>h.map(D=>D.value),[h])[0]}
  LIMIT 10`,x=(0,o.of)(m),f=(0,s.useRef)(null),[u,b]=(0,s.useState)({height:0}),E=D=>{p({...r,expression:D,format:g?"alerting":void 0})};return(0,s.useEffect)(()=>{if(!f.current)return;const D=new ResizeObserver(C=>{const{height:P}=C[0].contentRect;b({height:P})});return D.observe(f.current),()=>D.disconnect()},[]),(0,s.useEffect)(()=>{r.expression||E(v)},[]),(0,n.jsx)("div",{ref:f,className:x.editorContainer,children:(0,n.jsx)(l.Y,{query:r.expression||v,onChange:E,height:u.height-d,language:i})})},m=()=>({editorContainer:(0,a.css)({height:"240px",resize:"vertical",overflow:"auto",minHeight:"100px"})})},38610:(Z,R,e)=>{"use strict";e.d(R,{O:()=>W});var n=e(74848),a=e(22803),s=e(2543),l=e(96540),o=e(92745),d=e(63142),i=e(97095),c=e(18027),m=e(18857),p=e(63527),h=e(21285),r=e(41654),g=e(2954),y=e(4651),v=e(81988),x=e(66258),f=e(65307);const u=(0,f.VP)("thresold/updateRefId"),b=(0,f.VP)("thresold/updateThresholdType"),E=(0,f.VP)("thresold/updateThresholdParams"),D=(0,f.VP)("thresold/updateHysteresis"),C=(0,f.VP)("thresold/updateUnloadParams"),P=(0,f.vy)({type:y.Tz.threshold,refId:"",conditions:[]},w=>{w.addCase(u,(N,M)=>{N.expression=M.payload}),w.addCase(b,(N,M)=>{const L=M.payload.evalFunction,A=M.payload.onError;if(N.conditions[0].evaluator.type=L,!!N.conditions[0].unloadEvaluator){const F=T(N.conditions[0].evaluator.type);A&&A(void 0),N.conditions[0].evaluator.type=L;const V={type:F,params:N.conditions[0].evaluator?.params??[0,0]};N.conditions[0].unloadEvaluator=V}}),w.addCase(E,(N,M)=>{const{param:L,index:A}=M.payload;N.conditions[0].evaluator.params[A]=L}),w.addCase(D,(N,M)=>{const{hysteresisChecked:L,onError:A}=M.payload;L?N.conditions[0].unloadEvaluator={type:T(N.conditions[0].evaluator.type),params:N.conditions[0].evaluator?.params??[0,0]}:(N.conditions[0].unloadEvaluator=void 0,A&&A(void 0))}),w.addCase(C,(N,M)=>{const{param:L,index:A,onError:U}=M.payload;N.conditions[0].unloadEvaluator?N.conditions[0].unloadEvaluator.params[A]=L:N.conditions[0].unloadEvaluator={type:T(N.conditions[0].evaluator.type),params:N.conditions[0].evaluator?.params??[0,0]};const F=O(N.conditions[0]),{errorMsg:V,errorMsgFrom:K,errorMsgTo:G}=F??{};U&&U(V||K||G)})});function T(w){return w===g.p.IsAbove?g.p.IsBelow:w===g.p.IsBelow?g.p.IsAbove:w===g.p.IsEqual?g.p.IsNotEqual:w===g.p.IsNotEqual?g.p.IsEqual:w===g.p.IsGreaterThanEqual?g.p.IsLessThanEqual:w===g.p.IsLessThanEqual?g.p.IsGreaterThanEqual:w===g.p.IsWithinRange?g.p.IsOutsideRange:w===g.p.IsOutsideRange?g.p.IsWithinRange:w===g.p.IsWithinRangeIncluded?g.p.IsOutsideRangeIncluded:w===g.p.IsOutsideRangeIncluded?g.p.IsWithinRangeIncluded:g.p.IsBelow}function O(w){const{unloadEvaluator:N,evaluator:M}=w;if(!M)return;if(N?.params[0]===void 0||Number.isNaN(N?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:L,params:A}=M,{params:U}=N;if(L===g.p.IsWithinRange||L===g.p.IsOutsideRange||L===g.p.IsWithinRangeIncluded||L===g.p.IsOutsideRangeIncluded){if(U[0]===void 0||Number.isNaN(U[0]))return{errorMsgFrom:"This value cannot be empty"};if(U[1]===void 0||Number.isNaN(U[1]))return{errorMsgTo:"This value cannot be empty"}}const[F,V]=N.params,[K,G]=A;switch(L){case g.p.IsAbove:if(F>K)return{errorMsg:`Enter a number less than or equal to ${K}`};break;case g.p.IsBelow:if(F<K)return{errorMsg:`Enter a number more than or equal to ${K}`};break;case g.p.IsEqual:if(F===K)return{errorMsg:`Enter a different number than ${K}`};break;case g.p.IsNotEqual:if(F!==K)return{errorMsg:`Enter the same number as ${K}`};break;case g.p.IsGreaterThanEqual:if(F>=K)return{errorMsg:`Enter a number less than ${K}`};break;case g.p.IsLessThanEqual:if(F<=K)return{errorMsg:`Enter a number more than ${K}`};break;case g.p.IsOutsideRange:if(F<K)return{errorMsgFrom:`Enter a number more than or equal to ${K}`};if(V>G)return{errorMsgTo:`Enter a number less than or equal to ${G}`};break;case g.p.IsWithinRange:if(F>K)return{errorMsgFrom:`Enter a number less than or equal to ${K}`};if(V<G)return{errorMsgTo:`Enter a number be more than or equal to ${G}`};break;case g.p.IsOutsideRangeIncluded:if(F<=K)return{errorMsgFrom:`Enter a number more than ${K}`};if(V>=G)return{errorMsgTo:`Enter a number less than ${G}`};break;case g.p.IsWithinRangeIncluded:if(F>=K)return{errorMsgFrom:`Enter a number less than ${K}`};if(V<=G)return{errorMsgTo:`Enter a number be more than ${G}`};break;default:throw new Error(`evaluator function type ${L} not supported.`)}}const I=g.p.IsAbove,j={type:"query",evaluator:{type:I,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},W=({labelWidth:w,onChange:N,refIds:M,query:L,onError:A,useHysteresis:U=!1})=>{const F=(0,d.of)(S),V={...L,conditions:L.conditions?.length?L.conditions:[j]},[K,G]=(0,l.useReducer)(P,V),H=K.conditions[0],_=y.zd.find(q=>q.value===K.conditions[0].evaluator?.type),k=q=>{G(u(q.value))};(0,l.useEffect)(()=>{K&&N(K)},[K]);const J=q=>{G(b({evalFunction:q.value??I,onError:A}))},z=(q,te)=>{G(E({param:parseFloat(q.currentTarget.value),index:te}))},Y=H.evaluator.type===g.p.IsWithinRange||H.evaluator.type===g.p.IsOutsideRange||H.evaluator.type===g.p.IsOutsideRangeIncluded||H.evaluator.type===g.p.IsWithinRangeIncluded,X=(0,s.uniqueId)("threshold-");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.C,{children:(0,n.jsx)(c.I,{label:(0,o.t)("expressions.threshold.label-input","Input"),labelWidth:w,htmlFor:X,children:(0,n.jsx)(m.l6,{inputId:X,onChange:k,options:M,value:L.expression,width:20})})}),(0,n.jsxs)(i.C,{children:[(0,n.jsx)(v.E,{onChange:J,value:_}),Y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.p,{type:"number",width:10,onChange:q=>z(q,0),defaultValue:H.evaluator.params[0]}),(0,n.jsx)(x.Y,{}),(0,n.jsx)(p.p,{type:"number",width:10,onChange:q=>z(q,1),defaultValue:H.evaluator.params[1]})]}):(0,n.jsx)(p.p,{type:"number",width:10,onChange:q=>z(q,0),defaultValue:H.evaluator.params[0]||0})]}),U&&(0,n.jsx)(Q,{isRange:Y,onError:A})]});function Q({isRange:q,onError:te}){const ne=!!H.unloadEvaluator,se=ie=>{G(D({hysteresisChecked:ie.currentTarget.checked,onError:te})),ue.current=!0},ue=l.useRef(!0),de=()=>{ue.current=!1};return(0,n.jsxs)("div",{className:F.hysteresis,children:[(0,n.jsx)("div",{onMouseDown:de,children:(0,n.jsx)(h.K,{showLabel:!0,label:(0,o.t)("alerting.rule-form.threshold.recovery.title","Custom recovery threshold"),value:ne,onChange:se,className:F.switch})}),ne&&(0,n.jsx)(B,{isRange:q,condition:H,onError:te,dispatch:G,allowOnblur:ue})]})}};function B({isRange:w,condition:N,onError:M,dispatch:L,allowOnblur:A}){const U=(0,d.of)(S),F=(J,z)=>{const Y=parseFloat(J.currentTarget.value);L(C({param:Y,index:z,onError:M}))},V=O(N),{errorMsg:K,errorMsgFrom:G,errorMsgTo:H}=V??{};if(w)return(0,n.jsx)(_,{allowOnblur:A});return(0,n.jsx)(k,{allowOnblur:A});function _({allowOnblur:J}){switch(N.evaluator.type){case g.p.IsWithinRange:if(N.evaluator.type===g.p.IsWithinRange)return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting (or pending state) when outside range"),labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!G,error:G,className:U.noMargin,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,0),defaultValue:N.unloadEvaluator?.params[0]})})}),(0,n.jsx)(x.Y,{}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!H,error:H,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,1),defaultValue:N.unloadEvaluator?.params[1]})})})]})})});case g.p.IsOutsideRange:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting (or pending state) when inside range"),labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!G,error:G,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,0),defaultValue:N.unloadEvaluator?.params[0]})})}),(0,n.jsx)(x.Y,{}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!H,error:H,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,1),defaultValue:N.unloadEvaluator?.params[1]})})})]})})});case g.p.IsOutsideRangeIncluded:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting (or pending state) when inside range"),labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!G,error:G,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,0),defaultValue:N.unloadEvaluator?.params[0]})})}),(0,n.jsx)(x.Y,{}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!H,error:H,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,1),defaultValue:N.unloadEvaluator?.params[1]})})})]})})});case g.p.IsWithinRangeIncluded:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting (or pending state) when outside range"),labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!G,error:G,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,0),defaultValue:N.unloadEvaluator?.params[0]})})}),(0,n.jsx)(x.Y,{}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(c.I,{invalid:!!H,error:H,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>J.current&&F(z,1),defaultValue:N.unloadEvaluator?.params[1]})})})]})})});default:return null}}function k({allowOnblur:J}){switch(N.evaluator.type){case g.p.IsAbove:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-bellow","Stop alerting (or pending state) when below"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});case g.p.IsBelow:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-above","Stop alerting (or pending state) when above"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});case g.p.IsEqual:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-equal","Stop alerting (or pending state) when equal to"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});case g.p.IsNotEqual:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-not-equal","Stop alerting (or pending state) when not equal to"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});case g.p.IsGreaterThanEqual:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-less","Stop alerting (or pending state) when less than"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});case g.p.IsLessThanEqual:return(0,n.jsx)(i.C,{className:U.hysteresis,children:(0,n.jsx)(c.I,{label:(0,o.t)("alerting.rule-form.threshold.recovery.stop-alerting-more","Stop alerting (or pending state) when more than"),labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(p.p,{type:"number",width:10,onBlur:z=>{J.current&&F(z,0)},defaultValue:N.unloadEvaluator?.params[0]})})});default:return null}}}const S=w=>({range:(0,a.css)({width:"min-content"}),hysteresis:(0,a.css)({marginTop:w.spacing(2)}),switch:(0,a.css)({paddingLeft:w.spacing(1)}),noMargin:(0,a.css)({margin:0})})},81988:(Z,R,e)=>{"use strict";e.d(R,{E:()=>d});var n=e(74848),a=e(22803),s=e(63142),l=e(15356),o=e(4651);function d({onChange:c,value:m}){const p=(0,s.of)(i);return(0,n.jsx)(l.f,{className:p.buttonSelectText,options:o.zd,onChange:c,value:m})}const i=c=>({buttonSelectText:(0,a.css)({color:c.colors.primary.text,fontSize:c.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${c.spacing(1)}`})})},66258:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>o});var n=e(74848),a=e(22803),s=e(92745),l=e(63142);function o(){const i=(0,l.of)(d);return(0,n.jsx)("div",{className:i.button,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.threshold.to",children:"TO"})})}const d=i=>({button:(0,a.css)({height:"32px",color:i.colors.primary.text,fontSize:i.typography.bodySmall.fontSize,display:"flex",alignItems:"center",fontWeight:i.typography.fontWeightBold,padding:`0 ${i.spacing(1)}`})})},44022:(Z,R,e)=>{"use strict";e.d(R,{f:()=>s,z:()=>l});var n=e(36580),a=e(4651);const s=o=>{if(!o)return!1;if((0,n.s9)(o.datasource))return!0;const d=o;return typeof d.type!="string"?!1:Object.values(a.Tz).includes(d.type)};function l(o){return["avg","min","max","sum","count","last","median","diff","diff_abs","percent_diff","percent_diff_abs","count_non_null"].includes(o)}},4651:(Z,R,e)=>{"use strict";e.d(R,{Cu:()=>c,HZ:()=>p,Mt:()=>m,NI:()=>d,PN:()=>h,Tz:()=>o,Uj:()=>l,iX:()=>r,uQ:()=>i,zd:()=>g});var n=e(46644),a=e(65642),s=e(2954);const l="__expr__";var o=(y=>(y.math="math",y.reduce="reduce",y.resample="resample",y.classic="classic_conditions",y.threshold="threshold",y.sql="sql",y))(o||{});const d=y=>{switch(y){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},i=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports MySQL syntax."}].filter(y=>y.value==="sql"?a.$W?.featureToggles?.sqlExpressions:!0),c=[{value:n.gy.min,label:"Min",description:"Get the minimum value"},{value:n.gy.max,label:"Max",description:"Get the maximum value"},{value:n.gy.mean,label:"Mean",description:"Get the average value"},{value:n.gy.median,label:"Median",description:"Get the median value"},{value:n.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:n.gy.count,label:"Count",description:"Get the number of values"},{value:n.gy.last,label:"Last",description:"Get the last value"}];var m=(y=>(y.Strict="",y.ReplaceNonNumbers="replaceNN",y.DropNonNumbers="dropNN",y))(m||{});const p=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],h=[{value:n.gy.last,label:"Last",description:"Fill with the last value"},{value:n.gy.min,label:"Min",description:"Fill with the minimum value"},{value:n.gy.max,label:"Max",description:"Fill with the maximum value"},{value:n.gy.mean,label:"Mean",description:"Fill with the average value"},{value:n.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],r=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],g=[{value:s.p.IsAbove,label:"Is above"},{value:s.p.IsBelow,label:"Is below"},{value:s.p.IsEqual,label:"Is equal to"},{value:s.p.IsNotEqual,label:"Is not equal to"},{value:s.p.IsGreaterThanEqual,label:"Is above or equal to"},{value:s.p.IsLessThanEqual,label:"Is below or equal to"},{value:s.p.IsWithinRange,label:"Is within range"},{value:s.p.IsOutsideRange,label:"Is outside range"},{value:s.p.IsWithinRangeIncluded,label:"Is within range included"},{value:s.p.IsOutsideRangeIncluded,label:"Is outside range included"}]},82779:(Z,R,e)=>{"use strict";e.d(R,{D5:()=>m,H3:()=>i,OC:()=>c,P0:()=>d,hJ:()=>h,rV:()=>o,sk:()=>p});var n=e(46644),a=e(2954),s=e(44022),l=e(4651);const o=r=>{switch(r.type){case l.Tz.reduce:r.reducer||(r.reducer=n.gy.mean);break;case l.Tz.resample:r.downsampler||(r.downsampler=n.gy.mean),r.upsampler||(r.upsampler="fillna"),r.reducer=void 0;break;case l.Tz.math:r.expression=void 0;break;case l.Tz.classic:r.conditions||(r.conditions=[d]);break;default:r.reducer=void 0}return r},d={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:a.p.IsAbove}};function i(r){if((0,s.z)(r))return r}function c(r){if(!m(r))return!1;const g=r.settings?.mode;return g===l.Mt.Strict||g===void 0}function m(r){return r.type===l.Tz.reduce}function p(r){return r.type===l.Tz.threshold}function h(r){return r===a.p.IsWithinRange||r===a.p.IsOutsideRange||r===a.p.IsOutsideRangeIncluded||r===a.p.IsWithinRangeIncluded}},66198:(Z,R,e)=>{"use strict";e.d(R,{Cg:()=>i,Fk:()=>m,R4:()=>r,Rj:()=>d,pq:()=>c});var n=e(92745),a=e(43173),s=e(15130),l=e(18832),o=e(11257);const d="manage-folder",i=y=>`folder-dashboards-${y}`,c=y=>`folder-library-panels-${y}`,m=y=>`folder-alerting-${y}`,p=y=>`folder-permissions-${y}`,h=y=>`folder-settings-${y}`;function r(y,v){const x=v??("parents"in y?y.parents:void 0),f={icon:"folder",id:d,subTitle:(0,l.o)("manage-folder"),url:y.url,text:y.title,children:[{active:!1,icon:"apps",id:i(y.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:y.url}]};if(x&&x.length>0){const u=x[x.length-1],b=x.slice(0,x.length-1);f.parentItem=r(u,b)}return f.children.push({active:!1,icon:"library-panel",id:c(y.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${y.url}/library-panels`}),s.TP.hasPermission(o.w.AlertingRuleRead)&&a.$.unifiedAlertingEnabled&&f.children.push({active:!1,icon:"bell",id:m(y.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${y.url}/alerting`}),f}function g(y){const v=r({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:t("folders.get-loading-nav.main.title.loading","Loading"),url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return v.children[y].active=!0,{main:v,node:v.children[y]}}},17621:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>m,jl:()=>d});var n=e(65307),a=e(18346);const s={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},l=(p,h)=>({...p,...h.payload,hasChanged:!1}),o=(0,n.Z0)({name:"folder",initialState:s,reducers:{loadFolder:l,setFolderTitle:(p,h)=>({...p,title:h.payload,hasChanged:h.payload.trim().length>0})},extraReducers:p=>{p.addMatcher(a.vZ.getFolder.matchFulfilled,l)}}),{loadFolder:d,setFolderTitle:i}=o.actions,m={folder:o.reducer}},93139:(Z,R,e)=>{"use strict";e.d(R,{G:()=>m});var n=e(74848),a=e(22803),s=e(96540),l=e(63142),o=e(18857),d=e(34999),i=e(46189);const c=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:i.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],m=({value:h,onChange:r,context:g,item:y})=>{const v=(0,l.of)(p),[x,f]=(0,s.useState)(),u=y.settings;(0,s.useEffect)(()=>{async function D(){const C=await(0,i.q3)(h);f(C)}D()},[h,f]);const{current:b,options:E}=(0,s.useMemo)(()=>{let D=u?.options?[...u.options]:[...c],C=D?.find(P=>P.value===x?.path);return!C&&x&&(C={label:x.path,value:x.path},D.push(C)),{options:D,current:C}},[x,u?.options]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.l6,{value:b,options:E,onChange:D=>r(D.value),allowCustomValue:!0,formatCreateLabel:D=>`Load from URL: ${D}`}),x&&(0,n.jsxs)(n.Fragment,{children:[x.error&&(0,n.jsx)(d.F,{title:x.error,severity:"warning"}),x.count&&(0,n.jsxs)("div",{className:v.keys,children:[(0,n.jsxs)("b",{children:["(",x.count,")"]}),x.examples(10).map(D=>(0,n.jsxs)("span",{children:[D,","]},D)),x.count>10&&" ..."]})]})]})},p=h=>({keys:(0,a.css)({marginTop:h.spacing(.5),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap","> span":{marginLeft:h.spacing(.5)}})})},90267:(Z,R,e)=>{"use strict";e.d(R,{G:()=>u});var n=e(95004),a=e(92745),s=e(739),l=e(93139),o=e(74848),d=e(22803),i=e(96540),c=e(51898),m=e(63142),p=e(34999),h=e(30703),r=e(18857),g=e(32881),y=e(87039);const v="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",x=({value:b,onChange:E,context:D,item:C})=>{const[P,T]=(0,i.useState)(),O=[{value:s.aG.Auto,label:(0,a.t)("geo.location-more-editor.mode-options.label-auto","Auto"),ariaLabel:c.Tp.components.Transforms.SpatialOperations.location.autoOption,description:(0,a.t)("geo.location-more-editor.mode-options.description-auto","Automatically identify location data based on default field names")},{value:s.aG.Coords,label:(0,a.t)("geo.location-more-editor.mode-options.label-coords","Coords"),ariaLabel:c.Tp.components.Transforms.SpatialOperations.location.coords.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-coords","Specify latitude and longitude fields")},{value:s.aG.Geohash,label:(0,a.t)("geo.location-more-editor.mode-options.label-geohash","Geohash"),ariaLabel:c.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-geohash","Specify geohash field")},{value:s.aG.Lookup,label:(0,a.t)("geo.location-more-editor.mode-options.label-lookup","Lookup"),ariaLabel:c.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-lookup","Specify Gazetteer and lookup field")}];(0,i.useEffect)(()=>{C.settings?.source&&C.settings?.data?.length&&C.settings.data[0]&&(0,y.nE)(C.settings.source).then(W=>{C.settings&&C.settings.data&&T((0,y.FM)(C.settings.data[0],W))})},[C.settings]);const I=(0,m.of)(f),j=()=>{if(P){if(P.warning)return(0,o.jsx)(p.F,{title:P.warning,severity:"warning",buttonContent:(0,o.jsx)(h.I,{name:"question-circle",size:"xl"}),className:I.alert,onRemove:()=>{const W=window.open(v,"_blank","noopener,noreferrer");W&&(W.opener=null)}});if(b===s.aG.Auto&&P.description)return(0,o.jsx)("span",{children:P.description})}return null};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.l6,{options:O,value:b,onChange:W=>{E(W.value)}}),(0,o.jsx)(g.Gy,{className:I.hGroup,children:j()})]})},f=b=>({alert:(0,d.css)({"& div":{padding:b.spacing(.5)},marginBottom:"0px",marginTop:"5px",padding:b.spacing(.25)}),hGroup:(0,d.css)({"& div":{width:"100%"}})});function u(b,E,D,C,P){switch(D.addCustomEditor({id:"modeEditor",path:`${E}mode`,name:(0,a.t)("geo.location-editor.name-location-mode","Location Mode"),editor:x,settings:{data:P,source:C}}),C?.mode){case s.aG.Coords:D.addFieldNamePicker({path:`${E}latitude`,name:(0,a.t)("geo.location-editor.name-latitude-field","Latitude field"),settings:{filter:T=>T.type===n.PU.number,noFieldsMessage:(0,a.t)("geo.location-editor.latitude-field.no-fields-message","No numeric fields found")}}).addFieldNamePicker({path:`${E}longitude`,name:(0,a.t)("geo.location-editor.name-longitude-field","Longitude field"),settings:{filter:T=>T.type===n.PU.number,noFieldsMessage:(0,a.t)("geo.location-editor.longitude-field.no-fields-message","No numeric fields found")}});break;case s.aG.Geohash:D.addFieldNamePicker({path:`${E}geohash`,name:(0,a.t)("geo.location-editor.name-geohash-field","Geohash field"),settings:{filter:T=>T.type===n.PU.string,noFieldsMessage:(0,a.t)("geo.location-editor.geohash-field.no-fields-message","No strings fields found")}});break;case s.aG.Lookup:D.addFieldNamePicker({path:`${E}lookup`,name:(0,a.t)("geo.location-editor.name-lookup-field","Lookup field"),settings:{filter:T=>T.type===n.PU.string,noFieldsMessage:(0,a.t)("geo.location-editor.lookup-field.no-fields-message","No strings fields found")}}).addCustomEditor({id:"gazetteer",path:`${E}gazetteer`,name:(0,a.t)("geo.location-editor.name-gazetteer","Gazetteer"),editor:l.G})}}},98643:(Z,R,e)=>{"use strict";e.d(R,{RA:()=>r,XR:()=>g,Dc:()=>h,qy:()=>m,Pz:()=>p});var n=e(44294),a=e(34338),s=e(11217),l=e(22796),o=e(95004),d=e(78089);function i(v){if(!v?.length)return;const x=[16,8,4,2,1],f="0123456789bcdefghjkmnpqrstuvwxyz";let u=!0;const b=[],E=[];b[0]=-90,b[1]=90,E[0]=-180,E[1]=180;let D;v.split("").forEach(T=>{D=f.indexOf(T),x.forEach(O=>{c(u?E:b,D,O),u=!u})});const C=(b[0]+b[1])/2;return[(E[0]+E[1])/2,C]}function c(v,x,f){x&f?v[0]=(v[0]+v[1])/2:v[1]=(v[0]+v[1])/2}function m(v){return{name:v.name??"Point",type:o.PU.geo,values:v.values.map(x=>{const f=i(x);if(f)return new n.A((0,l.Rb)(f))}),config:y}}function p(v,x){const f=new Array(v.values.length);for(let u=0;u<v.values.length;u++){const b=v.values[u],E=x.values[u];b===null||E===null||(f[u]=new n.A((0,l.Rb)([b,E])))}return{name:"Point",type:o.PU.geo,values:f,config:y}}function h(v,x){const f=x.values.length,u=new Array(f);for(let b=0;b<f;b++)u[b]=v.find(x.values[b])?.geometry();return{name:"Geometry",type:o.PU.geo,values:u,config:y}}function r(v,x){const f=v.values,u=x.values;if(!f||!u)throw"missing src/dest";if(f.length!==u.length)throw"Source and destination field lengths do not match";const b=v.values.length,E=new Array(b);for(let D=0;D<b;D++){const C=f[D],P=u[D];C&&P?E[D]=new a.A([C,P]):C?E[D]=C:P&&(E[D]=P)}return{name:"Geometry",type:o.PU.geo,values:E,config:y}}function g(v,x){const f=v.values,u=x.values;if(!f||!u)throw"missing src/dest";if(f.length!==u.length)throw"Source and destination field lengths do not match";const b=v.values.length,E=new Array(b);for(let D=0;D<b;D++){const C=f[D],P=u[D];C&&P&&(E[D]=new s.A([(0,d.EX)(C),(0,d.EX)(P)]))}return{name:"Geometry",type:o.PU.geo,values:E,config:y}}const y=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},46189:(Z,R,e)=>{"use strict";e.d(R,{fx:()=>v,q3:()=>x});var n=e(70915),a=e(44294),s=e(41119),l=e(95004),o=e(68143),d=e(11365);function i(f){const u=new d.A().readFeatures(f,{featureProjection:"EPSG:3857"}),b=u.length,E=new Array(b).fill(null),D=[],C=new Map,P=j=>{let W=C.get(j);return W||(W={types:new Set,values:new Array(b).fill(null),count:0},D.push(j),C.set(j,W)),W},T=(...j)=>{for(const W of j)if(!C.has(W))return W;return"___"+j[0]},O={types:new Set,values:new Array(b).fill(null),count:0};for(let j=0;j<b;j++){const W=u[j];E[j]=W.getGeometry();const B=W.getId();B!=null&&(O.values[j]=B,O.types.add((0,s.oE)(B)),O.count++);for(const S of W.getKeys()){const w=W.get(S);if(w===E[j]||w==null)continue;const N=P(S);N.values[j]=w,N.types.add((0,s.oE)(w)),N.count++}}const I=[];if(O.count>0){const j=c(O);I.push({name:T("id","_id","__id"),type:j,values:O.values,config:{}})}I.push({name:T("geo","geometry"),type:l.PU.geo,values:E,config:{}});for(const j of D){const W=C.get(j);if(!W)continue;const B=c(W);I.push({name:j,type:B,values:W.values,config:{}})}return{fields:I,length:b}}function c(f){return f.count<1?l.PU.other:f.types.size>1?(f.values=f.values.map(u=>u!=null?`${u}`:u),l.PU.string):f.types.values().next().value??l.PU.other}var m=e(98643),p=e(22796);function h(f,u){let b=0;const E=new Map;for(const D of u){const C=new a.A((0,p.Rb)([D.longitude,D.latitude])),P={point:()=>C,geometry:()=>C};if(D.name&&(E.set(D.name,P),E.set(D.name.toUpperCase(),P)),D.key&&(E.set(D.key,P),E.set(D.key.toUpperCase(),P)),D.keys)for(const T of D.keys)E.set(T,P),E.set(T.toUpperCase(),P);b++}return{path:f,find:D=>{let C=E.get(D);return!C&&typeof D=="string"&&(C=E.get(D.toUpperCase())),C},count:b,examples:D=>{const C=[];if(E.size<1)C.push("no values found");else for(const P of E.keys())if(C.push(P),C.length>=D)break;return C}}}function r(f,u){let b;if(Array.isArray(u)){const E=u[0];if(E.latitude&&E.longitude&&(E.key||E.keys))return h(f,u)}else Array.isArray(u?.features)&&u?.type==="FeatureCollection"&&(b=i(u));if(!b)try{b=(0,s.Vc)(u)}catch(E){return{path:f,error:`${E}`,find:D=>{},examples:D=>[]}}return g(b,{path:f})}function g(f,u){const b=[];let E,D,C,P,T;for(const j of f.fields)if(j.type===l.PU.geo&&(E=j),!T&&j.type===l.PU.string&&(T=j),j.name){u.keys&&u.keys.includes(j.name)&&b.push(j);const W=j.name.toUpperCase();switch(W){case"LAT":case"LATITUTE":D=j;break;case"LON":case"LNG":case"LONG":case"LONGITUE":C=j;break;case"GEOHASH":P=j;break;case"ID":case"UID":case"KEY":case"CODE":u.keys||b.push(j);break;default:u.keys||(W.endsWith("_ID")||W.endsWith("_CODE"))&&b.push(j)}}!b.length&&T&&b.push(T);let O=!1;E?O=E.values[0]?.getType()==="Point":P?(E=(0,m.qy)(P),O=!0):D&&C&&(E=(0,m.Pz)(C,D),O=!0);const I=new Map;return b.forEach(j=>{j.values.forEach((W,B)=>{const S=`${W}`;I.set(S.toUpperCase(),B),I.set(S,B)})}),{path:u.path,find:j=>{const W=I.get(j);if(W!=null){const B=E?.values[W];return{frame:f,index:W,point:()=>!B||O?B:new a.A((0,n.q1)(B.getExtent())),geometry:()=>B}}},examples:j=>{const W=[];for(let B of I.keys())if(W.push(B),W.length>j)break;return W},frame:()=>f,count:f.length}}const y={},v="public/gazetteer/countries.json";async function x(f){f||(f=v);let u=y[f];if(!u){try{const b=await(0,o.AI)().get(f);u=r(f,b)}catch(b){console.warn("Error loading placename lookup",f,b),u={path:f,error:"Error loading URL",find:E=>{},examples:E=>[]}}y[f]=u}return u}},87039:(Z,R,e)=>{"use strict";e.d(R,{FM:()=>y,nE:()=>r});var n=e(16515),a=e(95004),s=e(36638),l=e(57866),o=e(92745),d=e(739),i=e(98643),c=e(46189);function m(v){return x=>{for(const f of x.fields)if(v(f,x,[]))return f}}function p(v){return x=>{for(const f of x.fields){if(v.has(f.name.toLowerCase()))return f;const u=(0,n.Ct)(f,x);if(v.has(u))return f}}}const h={mode:d.aG.Auto,geohash:p(new Set(["geohash"])),latitude:p(new Set(["latitude","lat"])),longitude:p(new Set(["longitude","lon","lng"])),h3:p(new Set(["h3"])),wkt:p(new Set(["wkt"])),lookup:p(new Set(["lookup"])),geo:v=>v.fields.find(x=>x.type===a.PU.geo)};async function r(v){const x={...h,mode:v?.mode??d.aG.Auto};switch(x.gazetteer=await(0,c.q3)(v?.gazetteer),x.mode){case d.aG.Geohash:v?.geohash?x.geohash=m((0,s.NS)({id:l.Ct.byName,options:v.geohash})):x.geohash=()=>{};break;case d.aG.Lookup:const f=v?.lookup?.length?(0,s.NS)({id:l.Ct.byName,options:v.lookup}):(0,s.NS)({id:l.Ct.byType,options:a.PU.string});x.lookup=m(f);break;case d.aG.Coords:v?.latitude?x.latitude=m((0,s.NS)({id:l.Ct.byName,options:v.latitude})):x.latitude=()=>{},v?.longitude?x.longitude=m((0,s.NS)({id:l.Ct.byName,options:v.longitude})):x.longitude=()=>{};break}return x}function g(v,x){const f={mode:x.mode??d.aG.Auto};if(f.mode===d.aG.Auto){if(f.geo=x.geo(v),f.geo)return f;if(f.latitude=x.latitude(v),f.longitude=x.longitude(v),f.latitude&&f.longitude)return f.mode=d.aG.Coords,f;if(f.geohash=x.geohash(v),f.geohash)return f.mode=d.aG.Geohash,f;if(f.lookup=x.lookup(v),f.lookup)return f.mode=d.aG.Lookup,f}switch(f.mode){case d.aG.Coords:f.latitude=x.latitude(v),f.longitude=x.longitude(v);break;case d.aG.Geohash:f.geohash=x.geohash(v);break;case d.aG.Lookup:f.lookup=x.lookup(v);break}return f}function y(v,x){const f=g(v,x);switch(f.mode){case d.aG.Auto:return f.geo?{field:f.geo}:{warning:(0,o.t)("geo.get-geometry-field.warning-unable-to-find","Unable to find location fields")};case d.aG.Coords:return f.latitude&&f.longitude?{field:(0,i.Pz)(f.longitude,f.latitude),derived:!0,description:`${f.mode}: ${f.latitude.name}, ${f.longitude.name}`}:{warning:(0,o.t)("geo.get-geometry-field.warning-select-lat-long","Select latitude/longitude fields")};case d.aG.Geohash:return f.geohash?{field:(0,i.qy)(f.geohash),derived:!0,description:`${f.mode}`}:{warning:(0,o.t)("geo.get-geometry-field.warning-select-geohash","Select geohash field")};case d.aG.Lookup:return f.lookup?x.gazetteer?{field:(0,i.Dc)(x.gazetteer,f.lookup),derived:!0,description:`${f.mode}: ${x.gazetteer.path}`}:{warning:(0,o.t)("geo.get-geometry-field.warning-gazetteer-not-found","Gazetteer not found")}:{warning:(0,o.t)("geo.get-geometry-field.warning-select-lookup","Select lookup field")}}return{warning:(0,o.t)("geo.get-geometry-field.warning-no-geometry","unable to find geometry")}}},42836:(Z,R,e)=>{"use strict";e.d(R,{q:()=>S});var n=e(74848),a=e(2543),s=e(96540),l=e(70713),o=e(64761),d=e(2197),i=e(60519),c=e(51898),m=e(92745),p=e(27489),h=e(2863),r=e(45861),g=e(68079),y=e(24343),v=e(65642),x=e(37234),f=e(16515),u=e(63142),b=e(32881),E=e(37386),D=e(18857),C=e(21285),P=e(85348),T=e(22803);const O=N=>(0,T.css)({padding:N.spacing(0,2),fontSize:N.typography.bodySmall.fontSize,color:N.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis"}),I=({children:N})=>{const M=(0,u.of)(O);return(0,n.jsx)("div",{className:M,children:N})};var j=e(89460);const W=({options:N,actions:M,formattedDataDescription:L,onOptionsChange:A,hasTransformations:U,data:F,dataFrames:V,transformationOptions:K,selectedDataFrame:G,onDataFrameChange:H,downloadForExcel:_,toggleDownloadForExcel:k})=>{const J=(0,u.of)(j.A);let z=V;G===o.F.joinByField&&(z=F);const Y=z.map((q,te)=>({value:te,label:`${(0,f.Ri)(q)} (${te})`})),X=[...K,...Y];function Q(){let q="";if(!F)return q;const te=[];return G===o.F.joinByField?te.push((0,m.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):F.length>1&&te.push((0,f.Ri)(F[G])),(N.withTransforms||N.withFieldConfig)&&(N.withTransforms&&te.push((0,m.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),N.withTransforms&&N.withFieldConfig,N.withFieldConfig&&te.push((0,m.t)("dashboard.inspect-data.formatted","Formatted data"))),_&&te.push((0,m.t)("dashboard.inspect-data.excel-header","Excel header")),te.join(", ")}return(0,n.jsx)("div",{className:J.dataDisplayOptions,children:(0,n.jsx)(P.u,{id:"Data options",index:0,title:(0,m.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,n.jsx)(I,{children:Q()}),isOpen:!1,actions:M,children:(0,n.jsx)("div",{className:J.options,"data-testid":"dataOptions",children:(0,n.jsxs)(b.gW,{spacing:"none",children:[F.length>1&&(0,n.jsx)(E.D,{label:(0,m.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,n.jsx)(D.l6,{options:X,value:G,onChange:H,width:30,"aria-label":(0,m.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,n.jsxs)(b.Gy,{children:[U&&A&&(0,n.jsx)(E.D,{label:(0,m.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,m.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,n.jsx)(C.d,{value:!!N.withTransforms,onChange:()=>A({...N,withTransforms:!N.withTransforms})})}),A&&(0,n.jsx)(E.D,{label:(0,m.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:L||(0,m.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,n.jsx)(C.d,{id:"formatted-data-toggle",value:!!N.withFieldConfig,onChange:()=>A({...N,withFieldConfig:!N.withFieldConfig})})}),(0,n.jsx)(E.D,{label:(0,m.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,m.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,n.jsx)(C.d,{id:"excel-toggle",value:_,onChange:k})})]})]})})})})};var B=e(54334);class S extends s.PureComponent{constructor(M){super(M),this.onExportLogsAsTxt=()=>{const{data:L,dataName:A,app:U}=this.props;(0,p.rR)("grafana_logs_download_logs_clicked",{app:U,format:"logs",area:"inspector"});const F=(0,x.HT)(L||[]);(0,B.Zy)(F,A)},this.onExportTracesAsJson=()=>{const{data:L,dataName:A,app:U}=this.props;if(L)for(const F of L){if(F.meta?.preferredVisualisationType!=="trace")continue;const V=(0,B.ek)(F,A+"-traces");(0,p.rR)("grafana_traces_download_traces_clicked",{app:U,grafana_version:v.$W.buildInfo.version,trace_format:V,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:L,dataName:A,app:U}=this.props;(0,p.rR)("grafana_traces_download_service_graph_clicked",{app:U,grafana_version:v.$W.buildInfo.version,location:"inspector"}),L&&(0,B.ny)(L,A)},this.onDataFrameChange=L=>{this.setState({transformId:L.value===o.F.joinByField?o.F.joinByField:o.F.noop,dataFrameIndex:typeof L.value=="number"?L.value:0,selectedDataFrame:L.value})},this.onToggleDownloadForExcel=()=>{this.setState(L=>({downloadForExcel:!L.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:o.F.noop,transformationOptions:w(),transformedData:M.data??[],downloadForExcel:!1}}componentDidUpdate(M,L){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(M.data!==this.props.data||L.transformId!==this.state.transformId){const A=this.state.transformationOptions.find(U=>U.value===this.state.transformId);if(A&&A.transformer.id!==o.F.noop){const U=this.state.selectedDataFrame,F=this.state.dataFrameIndex,V=(0,d.m)([A.transformer],this.props.data).subscribe(K=>{this.setState({transformedData:K,selectedDataFrame:U,dataFrameIndex:F},()=>V.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(M,L){const{dataName:A}=this.props,{transformId:U}=this.state,F=M[this.state.dataFrameIndex];L&&(0,p.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,B.EM)(F,A,{useExcelHeader:this.state.downloadForExcel},U)}getProcessedData(){const{options:M,panelPluginId:L,fieldConfig:A,timeZone:U}=this.props,F=this.state.transformedData;if(!M.withFieldConfig)return(0,i.K3)(F);let V=A??{defaults:{},overrides:[]};return L==="table"&&A&&(V=this.cleanTableConfigFromFieldConfig(A)),(0,i.we)({data:F,theme:v.$W.theme2,fieldConfig:V,timeZone:U,replaceVariables:(K,G,H)=>(0,h.w)().replace(K,G,H)})}cleanTableConfigFromFieldConfig(M){M=(0,a.cloneDeep)(M),M.defaults.custom={};for(const L of M.overrides)for(const A of L.properties)if(A.id.startsWith("custom.")){const U=L.properties.indexOf(A);L.properties.slice(U,1)}return M}renderActions(M,L,A,U){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.$n,{variant:"primary",onClick:()=>this.exportCsv(M,L),size:"sm",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),L&&!v.$W.exploreHideLogsDownload&&(0,n.jsx)(r.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),A&&(0,n.jsx)(r.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),U&&(0,n.jsx)(r.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:M,options:L,data:A,formattedDataDescription:U,onOptionsChange:F,hasTransformations:V}=this.props,{dataFrameIndex:K,transformationOptions:G,selectedDataFrame:H,downloadForExcel:_}=this.state,k=(0,j.c)();if(M)return(0,n.jsxs)("div",{children:[(0,n.jsx)(g.y,{inline:!0})," ",(0,n.jsx)(m.x6,{i18nKey:"inspector.inspect-data-tab.loading",children:"Loading"})]});const J=this.getProcessedData();if(!J||!J.length)return(0,n.jsx)("div",{children:(0,n.jsx)(m.x6,{i18nKey:"inspector.inspect-data-tab.no-data",children:"No data"})});const z=J[K]?K:0,Y=J[z],X=J.some(te=>te?.meta?.preferredVisualisationType==="logs"),Q=J.some(te=>te?.meta?.preferredVisualisationType==="trace"),q=J.some(te=>te?.meta?.preferredVisualisationType==="nodeGraph");return(0,n.jsxs)("div",{className:k.wrap,"aria-label":c.Tp.components.PanelInspector.Data.content,children:[(0,n.jsx)("div",{className:k.toolbar,children:(0,n.jsx)(W,{data:A,hasTransformations:V,options:L,dataFrames:J,transformationOptions:G,selectedDataFrame:H,downloadForExcel:_,formattedDataDescription:U,onOptionsChange:F,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(J,X,Q,q)})}),(0,n.jsx)("div",{className:k.content,children:(0,n.jsx)(l.Ay,{children:({width:te,height:ne})=>te===0?null:(0,n.jsx)(y.X,{width:te,height:ne,data:Y,showTypeIcons:!0})})})]})}}function w(){return[{value:o.F.joinByField,label:(0,m.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:o.F.joinByField,options:{byField:void 0}}}]}},55072:(Z,R,e)=>{"use strict";e.d(R,{N:()=>y});var n=e(74848),a=e(22803),s=e(51898),l=e(92745),o=e(11576),d=e(95004),i=e(55386),c=e(63142);const m=({timeZone:x,name:f,stats:u})=>{const b=(0,c.$j)(),E=(0,c.of)(h);return!u||!u.length?null:(0,n.jsxs)("div",{className:E.wrapper,children:[(0,n.jsx)("div",{className:E.heading,children:f}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:u.map((D,C)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:D.displayName}),(0,n.jsx)("td",{className:E.cell,children:p(D,x,b)})]},`${D.displayName}-${C}`))})})]})};function p(x,f,u){const b=(0,o.J)({field:{type:d.PU.number,config:x},theme:u,timeZone:f});return(0,i.cN)(b(x.value))}const h=x=>({heading:(0,a.css)({fontSize:x.typography.body.fontSize,marginBottom:x.spacing(1)}),wrapper:(0,a.css)({paddingBottom:x.spacing(2)}),cell:(0,a.css)({textAlign:"right"})}),r=({name:x,traceIds:f})=>{const u=(0,c.of)(g);return f.length===0?null:(0,n.jsxs)("div",{className:u.wrapper,children:[(0,n.jsx)("div",{className:u.heading,children:x}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:f.map((b,E)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:b})},`${b}-${E}`))})})]})},g=x=>({heading:(0,a.css)({fontSize:x.typography.body.fontSize,marginBottom:x.spacing(1)}),wrapper:(0,a.css)({paddingBottom:x.spacing(2)}),cell:(0,a.css)({textAlign:"right"})}),y=({data:x,timeZone:f})=>{if(!x.request)return null;let u=[];const b=x.request.endTime?x.request.endTime-x.request.startTime:-1,E=x.timings?.dataProcessingTime||-1;let D=0;for(const I of x.series)D+=I.length;b>0&&u.push({displayName:(0,l.t)("dashboard.inspect-stats.request-time","Total request time"),value:b,unit:"ms"}),E>0&&u.push({displayName:(0,l.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:E,unit:"ms"}),u.push({displayName:(0,l.t)("dashboard.inspect-stats.queries","Number of queries"),value:x.request.targets?.length??0}),u.push({displayName:(0,l.t)("dashboard.inspect-stats.rows","Total number rows"),value:D});let C=[];for(const I of x.series)I.meta&&I.meta.stats&&(C=C.concat(I.meta.stats));const P=(0,l.t)("dashboard.inspect-stats.table-title","Stats"),T=(0,l.t)("dashboard.inspect-stats.data-title","Data source stats"),O=(0,l.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,n.jsxs)("div",{"aria-label":s.Tp.components.PanelInspector.Stats.content,className:v,children:[(0,n.jsx)(m,{timeZone:f,name:P,stats:u}),(0,n.jsx)(m,{timeZone:f,name:T,stats:C}),(0,n.jsx)(r,{name:O,traceIds:x.traceIds??[]})]})},v=(0,a.css)({height:"100%",overflowY:"scroll"})},96065:(Z,R,e)=>{"use strict";e.d(R,{e:()=>f});var n=e(74848),a=e(22803),s=e(96540),l=e(64423),o=e(28105),d=e(51898),i=e(92745),c=e(43173),m=e(41654),p=e(45861),h=e(47931),r=e(35137),g=e(6975),y=e(50275),v=e(83873),x=e(89460);class f extends s.PureComponent{constructor(b){super(b),this.subs=new l.yU,this.setFormattedJson=E=>{this.formattedJson=E},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(E=>({...E,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(E=>({...E,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(v.IB.getInspectorStream().subscribe({next:b=>{let E=!0;if(this.props.instanceId&&b?.requestId&&(E=b.requestId.startsWith(this.props.instanceId)),E)return this.onDataSourceResponse(b.response)}}))}componentDidUpdate(b){this.props.data!==b.data&&this.updateQueryList()}updateQueryList(){const{data:b}=this.props,E=b.series,D=[];if(E?.length){let C;E.forEach((P,T)=>{const O=P.meta?.executedQueryString;if(O){const I=P.refId||"?";C?.refId===I?(C.frames++,C.rows+=P.length):(C={refId:I,frames:0,rows:P.length,query:O},D.push(C))}})}this.setState({executedQueries:D})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(b){b.config?.hideFromInspector||(b={...b},b.headers&&delete b.headers,b.config&&(b.request=b.config,delete b.config,delete b.request.transformRequest,delete b.request.transformResponse,delete b.request.paramSerializer,delete b.request.jsonpCallbackParam,delete b.request.headers,delete b.request.requestId,delete b.request.inspect,delete b.request.retry,delete b.request.timeout),b.data&&(b.response=b.data,delete b.config,delete b.data,delete b.status,delete b.statusText,delete b.ok,delete b.url,delete b.redirected,delete b.type,delete b.$$config),this.setState({response:b}))}renderExecutedQueries(b){if(!b.length)return null;const E={refId:(0,a.css)({fontWeight:c.$.theme.typography.weight.semibold,color:c.$.theme.colors.textBlue,marginRight:"8px"})};return(0,n.jsx)("div",{children:b.map(D=>(0,n.jsxs)(m.B,{gap:1,direction:"column",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:E.refId,children:[D.refId,":"]}),D.frames>1&&(0,n.jsx)("span",{children:(0,n.jsxs)(i.x6,{i18nKey:"inspector.query-inspector.count-frames",count:D.frames,children:["{{count}}"," frames,"," "]})}),(0,n.jsx)("span",{children:(0,n.jsxs)(i.x6,{i18nKey:"inspector.query-inspector.count-rows",count:D.rows,children:["{{count}}"," rows"]})})]}),(0,n.jsx)("pre",{children:D.query})]},D.refId))})}render(){const{allNodesExpanded:b,executedQueries:E,response:D}=this.state,{onRefreshQuery:C,data:P}=this.props,T=this.getNrOfOpenNodes(),O=(0,x.A)(c.$.theme2),I=Object.keys(D).length>0,j=P.state===o.Gu.Loading;return(0,n.jsxs)("div",{className:O.wrap,children:[(0,n.jsxs)("div",{"aria-label":d.Tp.components.PanelInspector.Query.content,children:[(0,n.jsx)("h3",{className:O.heading,children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query-inspector.query-inspector",children:"Query inspector"})}),(0,n.jsx)("p",{className:"small muted",children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(E),(0,n.jsxs)(m.B,{direction:"row",gap:2,justifyContent:"flex-start",wrap:!0,children:[(0,n.jsx)(p.$n,{icon:"sync",onClick:C,"aria-label":d.Tp.components.PanelInspector.Query.refreshButton,children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),I&&b&&(0,n.jsx)(p.$n,{icon:"minus",variant:"secondary",onClick:this.onToggleExpand,children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),I&&!b&&(0,n.jsx)(p.$n,{icon:"plus",variant:"secondary",onClick:this.onToggleExpand,children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),I&&(0,n.jsx)(h.b,{getText:this.getTextForClipboard,icon:"copy",variant:"secondary",children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})})]}),(0,n.jsx)(r.$,{v:2}),(0,n.jsxs)("div",{className:O.content,children:[j&&(0,n.jsx)(g._,{text:(0,i.t)("inspector.query-inspector.text-loading-query-inspector","Loading query inspector...")}),!j&&I&&(0,n.jsx)(y.B,{json:D,open:T,onDidRender:this.setFormattedJson}),!j&&!I&&(0,n.jsx)("p",{className:"muted",children:(0,n.jsx)(i.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},89460:(Z,R,e)=>{"use strict";e.d(R,{A:()=>o,c:()=>l});var n=e(22803),a=e(65240),s=e(65642);const l=(0,a.N)(()=>o(s.$W.theme2)),o=d=>({heading:(0,n.css)({fontSize:d.typography.body.fontSize,marginBottom:d.spacing(1)}),wrap:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,n.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:d.v1.spacing.sm}),toolbarItem:(0,n.css)({marginLeft:d.v1.spacing.md}),content:(0,n.css)({flexGrow:1,height:"100%"}),editor:(0,n.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,n.css)({overflow:"scroll"}),dataFrameSelect:(0,n.css)({flexGrow:2}),leftActions:(0,n.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,n.css)({paddingTop:d.v1.spacing.sm}),dataDisplayOptions:(0,n.css)({flexGrow:1,minWidth:"300px",marginRight:d.v1.spacing.sm}),selects:(0,n.css)({display:"flex","> *":{marginRight:d.v1.spacing.sm}})})},26689:(Z,R,e)=>{"use strict";e.d(R,{q:()=>n});var n=(a=>(a.Data="data",a.Meta="meta",a.Error="error",a.Stats="stats",a.JSON="json",a.Query="query",a.Help="help",a))(n||{})},54334:(Z,R,e)=>{"use strict";e.d(R,{ny:()=>M,EM:()=>N,Zy:()=>w,ek:()=>L});var n=e(4213),a=e.n(n),s=e(25229),l=e(80011),o=e(64761),d=e(68125),i=e(18700),c=e(25192),m=e(2543);const h=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function r(){return defaultConfig}function g(A){return _get(r(),A)}function y(A){let U;const F=new Set(A.map(({spanID:V})=>V));for(let V=0;V<A.length;V++){if(A[V].references&&A[V].references.some(({traceID:_,spanID:k})=>_===A[V].traceID&&F.has(k)))continue;if(!U){U=A[V];continue}const G=A[V].references&&A[V].references.length||0,H=U.references&&U.references.length||0;(G<H||G===H&&A[V].startTime<U.startTime)&&(U=A[V])}return U?`${U.process.serviceName}: ${U.operationName}`:""}const v=(0,m.memoize)(y,A=>A.length?A[0].traceID:0);function x(A){const U=new Map,F=A.reduce((K,G)=>(K.some(H=>H.key===G.key&&H.value===G.value)?U.set(`${G.key}:${G.value}`,`Duplicate tag "${G.key}:${G.value}"`):K.push(G),K),[]),V=Array.from(U.values());return{dedupedTags:F,warnings:V}}function f(A,U){const F=A?.slice()??[],V=(U||[]).map(K=>K.toLowerCase());return F.sort((K,G)=>{const H=K.key.toLowerCase(),_=G.key.toLowerCase();for(let k=0;k<V.length;k++){const J=V[k];if(H.startsWith(J)&&!_.startsWith(J))return-1;if(!H.startsWith(J)&&_.startsWith(J))return 1}return H>_?1:H<_?-1:0}),F}function u(A){if(!A?.traceID)return null;const U=A.traceID.toLowerCase();let F=0,V=Number.MAX_SAFE_INTEGER;const K=new Map,G=new Map;A.spans=A.spans.filter(X=>!!X.startTime),A.processes=Object.entries(A.processes).reduce((X,[Q,q])=>(X[Q]={...q,tags:f(q.tags)},X),{});const H=A.spans.length;for(let X=0;X<H;X++){const Q=A.spans[X],{startTime:q,duration:te,processID:ne}=Q;let se=Q.spanID;q<V&&(V=q),q+te>F&&(F=q+te);const ue=K.get(se);ue!=null?(console.warn(`Dupe spanID, ${ue+1} x ${se}`,Q,G.get(se)),_isEqual(Q,G.get(se))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),K.set(se,ue+1),se=`${se}_${ue}`,Q.spanID=se):K.set(se,1),Q.process=A.processes[ne],G.set(se,Q)}const _=getTraceSpanIdsAsTree(A,G),k=[],J={};_.walk((X,Q,q=0)=>{if(X==="__root__"||typeof X!="string")return;const te=G.get(X);if(!te)return;const{serviceName:ne}=te.process;J[ne]=(J[ne]||0)+1,te.relativeStartTime=te.startTime-V,te.depth=q-1,te.hasChildren=Q.children.length>0,te.childSpanCount=Q.children.length,te.warnings=te.warnings||[],te.tags=te.tags||[],te.references=te.references||[],te.childSpanIds=Q.children.slice().sort((ue,de)=>{const ie=G.get(ue.value),he=G.get(de.value);return he.startTime+he.duration-(ie.startTime+ie.duration)}).map(ue=>ue.value);const se=x(te.tags);te.tags=f(se.dedupedTags,getConfigValue("topTagPrefixes")),te.warnings=te.warnings.concat(se.warnings),te.references.forEach((ue,de)=>{const ie=G.get(ue.spanID);ie&&(ue.span=ie,de>0&&(ie.subsidiarilyReferencedBy=ie.subsidiarilyReferencedBy||[],ie.subsidiarilyReferencedBy.push({spanID:X,traceID:U,span:te,refType:ue.refType})))}),k.push(te)});const z=getTraceName(k);return{services:Object.keys(J).map(X=>({name:X,numberOfSpans:J[X]})),spans:k,traceID:U,traceName:z,processes:A.processes,duration:F-V,startTime:V,endTime:F}}function b(A){const U=A.spans.map(V=>E(V,A.processes)),F=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const V of U)F.add(V);return F}function E(A,U){const F=A.references?.find(V=>V.refType==="CHILD_OF")?.spanID;return{spanID:A.spanID,traceID:A.traceID,parentSpanID:F,operationName:A.operationName,startTime:A.startTime/1e3,duration:A.duration/1e3,logs:A.logs.map(V=>({...V,timestamp:V.timestamp/1e3})),tags:A.tags,warnings:A.warnings??void 0,stackTraces:A.stackTraces,references:A.references?.filter(V=>V.spanID!==F)??[],serviceName:U[A.processID].serviceName,serviceTags:U[A.processID].tags}}function D(A,U){const F=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),V=A.map(C).sort((K,G)=>G?.startTime-K?.startTime);for(const K of V)F.add(K);return F}function C(A){const U=transformTraceData(A);if(U)return{traceID:U.traceID,startTime:U.startTime/1e3,duration:U.duration,traceName:U.traceName}}function P(A){let U={traceID:"",spans:[],processes:{},warnings:null},F=[];for(let V=0;V<A.length;V++){const K=A.get(V);U.traceID||(U.traceID=K.traceID),F.find(G=>G===K.serviceName)||(F.push(K.serviceName),U.processes[`p${F.length}`]={serviceName:K.serviceName,tags:K.serviceTags}),U.spans.push({traceID:K.traceID,spanID:K.spanID,duration:K.duration*1e3,references:K.parentSpanID?[{refType:"CHILD_OF",spanID:K.parentSpanID,traceID:K.traceID}]:[],flags:0,logs:K.logs.map(G=>({...G,timestamp:G.timestamp*1e3})),operationName:K.operationName,processID:Object.keys(U.processes).find(G=>U.processes[G].serviceName===K.serviceName)||"",startTime:K.startTime*1e3,tags:K.tags,warnings:K.warnings?K.warnings:null})}return{data:[U],total:0,limit:0,offset:0,errors:null}}function T(A){const U=A.map(O),F=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const V of U)F.add(V);return F}function O(A){const U={traceID:A.traceId,spanID:A.id,parentSpanID:A.parentId,operationName:A.name,serviceName:A.localEndpoint?.serviceName||A.remoteEndpoint?.serviceName||"unknown",serviceTags:j(A),startTime:A.timestamp/1e3,duration:A.duration/1e3,logs:A.annotations?.map(I)??[],tags:Object.keys(A.tags||{}).reduce((F,V)=>V==="error"?(F.push({key:"error",value:!0}),F.push({key:"errorValue",value:A.tags.error}),F):(F.push({key:V,value:A.tags[V]}),F),[])};return A.kind&&(U.tags=[{key:"kind",value:A.kind},...U.tags??[]]),A.shared&&(U.tags=[{key:"shared",value:A.shared},...U.tags??[]]),U}function I(A){return{timestamp:A.timestamp,fields:[{key:"annotation",value:A.value}]}}function j(A){const U=A.localEndpoint||A.remoteEndpoint;return U?[W("ipv4",U.ipv4),W("ipv6",U.ipv6),W("port",U.port),W("endpointType",A.localEndpoint?"local":"remote")].filter(F=>!!F):[]}function W(A,U){if(U)return{key:A,value:U}}const B=A=>{let U=[];for(let F=0;F<A.length;F++){const V=A.get(F);U.push({traceId:V.traceID,parentId:V.parentSpanID,name:V.operationName,id:V.spanID,timestamp:V.startTime*1e3,duration:V.duration*1e3,...S(V),annotations:V.logs.length?V.logs.map(K=>({timestamp:K.timestamp,value:K.fields[0].value})):void 0,tags:V.tags.length?V.tags.filter(K=>K.key!=="kind"&&K.key!=="endpointType"&&K.key!=="shared").reduce((K,G)=>G.key==="error"?{...K,[G.key]:V.tags.find(H=>H.key==="errorValue").value||""}:{...K,[G.key]:G.value},{}):void 0,kind:V.tags.find(K=>K.key==="kind")?.value,shared:V.tags.find(K=>K.key==="shared")?.value})}return U},S=A=>{const U=A.serviceTags.find(F=>F.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return A.serviceName!=="unknown"?{[U]:{serviceName:A.serviceName,ipv4:A.serviceTags.find(F=>F.key==="ipv4")?.value,ipv6:A.serviceTags.find(F=>F.key==="ipv6")?.value,port:A.serviceTags.find(F=>F.key==="port")?.value}}:void 0};function w(A,U=""){let F="";A.meta?.forEach(G=>{const H=`${G.label}: ${JSON.stringify(G.value)}
`;F=F+H}),F=F+`

`,A.rows.forEach(G=>{const H=G.timeEpochMs+"	"+(0,s.KQ)(G.timeEpochMs).toISOString()+"	"+G.entry+`
`;F=F+H});const V=new Blob([F],{type:"text/plain;charset=utf-8"}),K=`${U?`${U}-logs`:"Logs"}-${(0,l.LE)(new Date)}.txt`;a()(V,K)}function N(A,U,F,V=o.F.noop){const K=(0,d._O)([A],F),G=F?.useExcelHeader?"\uFEFF":"",H=new Blob([G,K],{type:"text/csv;charset=utf-8"}),_=V!==o.F.noop?"-as-"+V.toLocaleLowerCase():"",k=`${U}-data${_}-${(0,l.LE)(new Date)}.csv`;a()(H,k)}function M(A,U){const F=new Blob([JSON.stringify(A)],{type:"application/json"}),V=`${U}-${(0,l.LE)(new Date)}.json`;a()(F,V)}function L(A,U){let F="otlp";switch(A.meta?.custom?.traceFormat){case"jaeger":{let V=P(new i.k(A));M(V,U),F="jaeger";break}case"zipkin":{let V=B(new i.k(A));M(V,U),F="zipkin";break}case"otlp":default:{let V=(0,c.xw)(new i.k(A));M(V,U);break}}return F}},8419:(Z,R,e)=>{"use strict";e.d(R,{p:()=>s});var n=e(32899),a=e(45229);function s(o){let d="";try{d=JSON.stringify(o,l(),2)}catch(i){i instanceof Error&&(i.toString().includes("RangeError")||i.toString().includes("allocation size overflow"))?a.A.emit(n.r1.alertError,[i.toString(),"Cannot display JSON, the object is too big."]):a.A.emit(n.r1.alertError,[i instanceof Error?i.toString():i])}return d}function l(){const o=new WeakSet;return(d,i)=>{if(d==="__dataContext"||d==="__sceneObject")return"Filtered out in JSON serialization";if(typeof i=="object"&&i!==null){if(o.has(i))return;o.add(i)}return i}}},61666:(Z,R,e)=>{"use strict";e.d(R,{G7:()=>o,KU:()=>d,eb:()=>i});var n=e(68143),a=e(73427),s=e(11257),l=e(52763);const o=(0,l.zD)("users/fetchInvitees",async()=>a.TP.hasPermission(s.w.OrgUsersAdd)?await(0,n.AI)().get("/api/org/invites"):[]),d=(0,l.zD)("users/addInvitee",async(c,{dispatch:m})=>{await(0,n.AI)().post("/api/org/invites",c),await m(o())}),i=(0,l.zD)("users/revokeInvite",async c=>(await(0,n.AI)().patch(`/api/org/invites/${c}/revoke`,{}),c))},38748:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>c,Tp:()=>l});var n=e(65307),a=e(61666);const s=(0,n.pU)({selectId:m=>m.code}),l=s.getSelectors(),o=s.getInitialState({status:"idle"}),c={invites:(0,n.Z0)({name:"invites",initialState:o,reducers:{},extraReducers:m=>{m.addCase(a.G7.pending,p=>{p.status="loading"}).addCase(a.G7.fulfilled,(p,{payload:h})=>{s.setAll(p,h),p.status="succeeded"}).addCase(a.G7.rejected,p=>{p.status="failed"}).addCase(a.eb.fulfilled,(p,{payload:h})=>{s.removeOne(p,h),p.status="succeeded"})}}).reducer}},43652:(Z,R,e)=>{"use strict";e.d(R,{b:()=>x,o:()=>f});var n=e(74848),a=e(96540),s=e(40996),l=e(16817),o=e(92745),d=e(68143),i=e(43173),c=e(37386),m=e(63527),p=e(41654),h=e(45861),r=e(22787),g=e(91156),y=e(30124),v=e(12048);const x=({panel:u,initialFolderUid:b,onCreateLibraryPanel:E,onDismiss:D})=>{const[C,P]=(0,a.useState)(b),[T,O]=(0,a.useState)(u.title),[I,j]=(0,a.useState)(u.title),[W,B]=(0,a.useState)(!1);(0,a.useEffect)(()=>B(!0),[T]),(0,s.A)(()=>j(T),350,[T]);const{saveLibraryPanel:S}=(0,v.b)(),w=(0,a.useCallback)(()=>{u.libraryPanel={uid:"",name:T},S(u,C).then(L=>{(0,d.NF)(L)?u.libraryPanel=void 0:(D?.(),E?.(L))})},[u,T,S,C,D,E]),N=(0,l.A)(async()=>{try{return!(await(0,y.e9)(T)).some(L=>L.folderUid===C)}catch(L){return(0,d.NF)(L)&&(L.isHandled=!0),!0}finally{B(!1)}},[I,C]),M=!N?.value&&N.value!==void 0&&T===I&&!W;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.D,{label:(0,o.t)("library-panel.add-modal.name","Library panel name"),invalid:M,error:M?(0,o.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,n.jsx)(m.p,{id:"share-panel-library-panel-name-input",name:"name",value:T,onChange:L=>O(L.currentTarget.value)})}),(0,n.jsx)(c.D,{label:(0,o.t)("library-panel.add-modal.folder","Save in folder"),description:(0,o.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,n.jsx)(g.d,{onChange:L=>P(L),value:C})}),i.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(p.B,{gap:1,justifyContent:"start",children:[(0,n.jsx)(h.$n,{onClick:w,disabled:M,children:(0,n.jsx)(o.x6,{i18nKey:"share-panel.new-library-panel.create-button",children:"Create library panel"})}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"share-panel.new-library-panel.cancel-button",children:"Cancel"})})]}):(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(h.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,n.jsx)(h.$n,{onClick:w,disabled:M,children:(0,n.jsx)(o.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},f=({isOpen:u=!1,panel:b,initialFolderUid:E,...D})=>(0,n.jsx)(r.a,{title:(0,o.t)("library-panels.add-library-panel-modal.title-create-library-panel","Create library panel"),isOpen:u,onDismiss:D.onDismiss,children:(0,n.jsx)(x,{panel:b,initialFolderUid:E,onDismiss:D.onDismiss})})},70905:(Z,R,e)=>{"use strict";e.d(R,{E:()=>S});var n=e(74848),a=e(22803),s=e(96540),l=e(70255),o=e(92745),d=e(43173),i=e(63142),c=e(30703),m=e(20941),p=e(21348),h=e(41097),r=e(54044),g=e(28105),y=e(22787),v=e(45861),x=e(37666),f=e(55290),u=e(30124),b=e(65307);const E={loadingState:g.Gu.Loading,dashboardTitles:[]},D=(0,b.VP)("libraryPanels/delete/searchCompleted"),C=(M=E,L)=>D.match(L)?{...M,dashboardTitles:L.payload.dashboards.map(A=>A.title),loadingState:g.Gu.Done}:M;function P(M){return async function(L){const A=await(0,u.xV)(M.uid);L(D({dashboards:A}))}}const T=({libraryPanel:M,onDismiss:L,onConfirm:A})=>{const U=(0,i.of)(x.o),[{dashboardTitles:F,loadingState:V},K]=(0,s.useReducer)(C,E),G=(0,s.useMemo)(()=>(0,f.QC)(K),[K]);(0,s.useEffect)(()=>{G(P(M))},[G,M]);const H=!!F.length,_=V===g.Gu.Done;return(0,n.jsxs)(y.a,{className:U.modal,title:(0,o.t)("library-panels.delete-library-panel-modal.title-delete-library-panel","Delete library panel"),icon:"trash-alt",onDismiss:L,isOpen:!0,children:[_?null:(0,n.jsx)(O,{}),_?(0,n.jsxs)("div",{children:[H?(0,n.jsx)(j,{dashboardTitles:F}):null,H?null:(0,n.jsx)(I,{}),(0,n.jsxs)(y.a.ButtonRow,{children:[(0,n.jsx)(v.$n,{variant:"secondary",onClick:L,fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.delete-library-panel-modal.cancel",children:"Cancel"})}),(0,n.jsx)(v.$n,{variant:"destructive",onClick:A,disabled:H,children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.delete-library-panel-modal.delete",children:"Delete"})})]})]}):null]})},O=()=>(0,n.jsx)("span",{children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.loading-indicator.loading-library-panel",children:"Loading library panel..."})}),I=()=>{const M=(0,i.of)(x.o);return(0,n.jsx)("div",{className:M.modalText,children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.confirm.delete-panel",children:"Do you want to delete this panel?"})})},j=({dashboardTitles:M})=>{const L=(0,i.of)(x.o),A=M.length===1?"dashboard.":"dashboards.",U=`${M.length} ${A}`;return M.length===0?null:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:L.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,n.jsx)("strong",{children:U})," Remove the library panel from the dashboards listed below and retry."]}),(0,n.jsxs)("table",{className:L.myTable,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.has-connected-dashboards.dashboard-name",children:"Dashboard name"})})})}),(0,n.jsx)("tbody",{children:M.map((F,V)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:F})},`dash-title-${V}`))})]})]})},W=({libraryPanel:M,onClick:L,onDelete:A,showSecondaryActions:U})=>{const[F,V]=(0,s.useState)(!1),K=()=>{A?.(M),V(!1)},G=d.$.panels[M.model.type]??(0,h.$)(M.model.type).meta;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.b,{isCurrent:!1,title:M.name,description:M.description,plugin:G,onClick:()=>L?.(M),onDelete:U?()=>V(!0):void 0,children:(0,n.jsx)(w,{libraryPanel:M})}),F&&(0,n.jsx)(T,{libraryPanel:M,onConfirm:K,onDismiss:()=>V(!1)})]})},B=({showSecondaryActions:M,rootProps:L})=>{const A=(0,i.of)(N);return(0,n.jsx)(r.b.Skeleton,{hasDelete:M,...L,children:(0,n.jsx)(l.A,{containerClassName:A.metaContainer,width:80})})},S=(0,p.j)(W,B);function w({libraryPanel:M}){const L=(0,i.of)(N);return!M.meta?.folderUid&&!M.meta?.folderName?null:M.meta.folderUid?(0,n.jsx)("span",{className:L.metaContainer,children:(0,n.jsxs)(m.N,{href:`/dashboards/f/${M.meta.folderUid}`,children:[(0,n.jsx)(c.I,{name:"folder-upload",size:"sm"}),(0,n.jsx)("span",{children:M.meta.folderName})]})}):(0,n.jsxs)("span",{className:L.metaContainer,children:[(0,n.jsx)(c.I,{name:"folder",size:"sm"}),(0,n.jsx)("span",{children:(0,n.jsx)(o.x6,{i18nKey:"library-panels.folder-link.dashboards",children:"Dashboards"})})]})}function N(M){return{metaContainer:(0,a.css)({display:"flex",alignItems:"center",color:M.colors.text.secondary,fontSize:M.typography.bodySmall.fontSize,paddingTop:M.spacing(.5),svg:{marginRight:M.spacing(.5),marginBottom:3}})}}},24438:(Z,R,e)=>{"use strict";e.d(R,{j:()=>j,s:()=>I});var n=e(74848),a=e(22803),s=e(96540),l=e(40996),o=e(92745),d=e(63142),i=e(32881),c=e(12737),m=e(76459),p=e.n(m),h=e(45861),r=e(18857),g=e(30703),y=e(65642),v=e(83873),x=e(55860),f=e(83458),u=e(70590);function b({onChange:w,maxMenuHeight:N}){const M=(0,d.of)(D),[L,A]=(0,s.useState)(!1),U=(0,s.useCallback)(H=>E(H,A),[]),F=(0,s.useMemo)(()=>p()(U,300),[U]),[V,K]=(0,s.useState)([]),G=(0,s.useCallback)(H=>{const _=H.filter(k=>!!k.value).map(k=>k.value);w(_),K(H)},[w]);return(0,n.jsxs)("div",{className:M.container,children:[V.length>0&&(0,n.jsx)(h.$n,{size:"xs",icon:"trash-alt",fill:"text",className:M.clear,onClick:()=>w([]),children:(0,n.jsx)(o.x6,{i18nKey:"folder-filter.clear-folder-button",children:"Clear folders"})}),(0,n.jsx)(r.Iv,{value:V,onChange:G,isLoading:L,loadOptions:F,maxMenuHeight:N,placeholder:(0,o.t)("folder-filter.select-placeholder","Filter by folder"),noOptionsMessage:(0,o.t)("folder-filter.noOptionsMessage-no-folders-found","No folders found"),prefix:(0,n.jsx)(g.I,{name:"filter"}),"aria-label":(0,o.t)("folder-filter.select-aria-label","Folder filter"),defaultOptions:!0})]})}async function E(w,N){if(N(!0),y.$W.featureToggles.unifiedStorageSearchUI){const V=(await(0,x.S)().search({query:w,kind:["folder"],limit:100,permission:u.RG.View})).view.map(K=>({label:K.name,value:{uid:K.uid,title:K.name}}));return(!w||"dashboards".includes(w.toLowerCase()))&&V.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),N(!1),V}const M={query:w,type:f.G.DashFolder,permission:u.RG.View},A=(await(0,v.AI)().search(M)).map(U=>({label:U.title,value:{uid:U.uid,title:U.title}}));return(!w||"dashboards".includes(w.toLowerCase()))&&A.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),N(!1),A}function D(w){return{container:(0,a.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,a.css)({label:"clear",fontSize:w.spacing(1.5),position:"absolute",top:-w.spacing(4.5),right:0})}}var C=e(92100),P=e(18552),T=e(95943),O=e(90232),I=(w=>(w.Tight="tight",w.Spacious="spacious",w))(I||{});const j=({onClick:w,variant:N="spacious",currentPanelId:M,currentFolderUID:L,perPage:A=T.FG,showPanelFilter:U=!1,showFolderFilter:F=!1,showSort:V=!1,showSecondaryActions:K=!1})=>{const G=(0,d.of)(W,N),[H,_]=(0,s.useState)(""),[k,J]=(0,s.useState)("");(0,l.A)(()=>J(H),200,[H]);const[z,Y]=(0,s.useState)({}),[X,Q]=(0,s.useState)(L?[L]:[]),[q,te]=(0,s.useState)([]),ne=V||U||F,se=N==="tight"?"lg":"xs";return(0,n.jsx)("div",{className:G.container,children:(0,n.jsxs)(i.gW,{spacing:se,children:[(0,n.jsxs)("div",{className:(0,a.cx)(G.gridContainer,{[G.tightLayout]:N==="tight"}),children:[(0,n.jsx)("div",{className:G.filterInputWrapper,children:(0,n.jsx)(c.Z,{value:H,onChange:_,placeholder:(0,o.t)("library-panels.library-panels-search.placeholder-search-by-name-or-description","Search by name, description or folder name"),width:0,escapeRegex:!1})}),ne&&(0,n.jsx)(B,{showSort:V,showPanelFilter:U,showFolderFilter:F,onSortChange:Y,onFolderFilterChange:Q,onPanelFilterChange:te,sortDirection:z.value,variant:N})]}),(0,n.jsx)("div",{className:G.libraryPanelsView,children:(0,n.jsx)(O.y,{onClickCard:w,searchString:k,sortDirection:z.value,panelFilter:q,folderFilter:X,currentPanelId:M,showSecondaryActions:K,perPage:A})})]})})};function W(w,N){return{filterInputWrapper:(0,a.css)({flexGrow:N==="tight"?1:"initial"}),container:(0,a.css)({width:"100%",overflowY:"auto",padding:w.spacing(1)}),libraryPanelsView:(0,a.css)({width:"100%"}),gridContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:w.spacing(1),rowGap:w.spacing(1),paddingBottom:w.spacing(2)}),tightLayout:(0,a.css)({flexDirection:"row",rowGap:w.spacing(1)})}}const B=(0,s.memo)(({variant:w="spacious",showSort:N,showPanelFilter:M,showFolderFilter:L,sortDirection:A,onSortChange:U,onFolderFilterChange:F,onPanelFilterChange:V})=>{const K=(0,d.of)(S),G=(0,s.useCallback)(_=>V(_.map(k=>k.id)),[V]),H=(0,s.useCallback)(_=>F(_.map(k=>k.uid??"")),[F]);return(0,n.jsxs)("div",{className:(0,a.cx)(K.container,{[K.containerTight]:w==="tight"}),children:[N&&(0,n.jsx)(P.r,{value:A,onChange:U,filter:["alpha-asc","alpha-desc"]}),(L||M)&&(0,n.jsxs)("div",{className:(0,a.cx)(K.filterContainer,{[K.filterContainerTight]:w==="tight"}),children:[L&&(0,n.jsx)(b,{onChange:H}),M&&(0,n.jsx)(C.$,{onChange:G})]})]})});B.displayName="SearchControls";function S(w){return{container:(0,a.css)({display:"flex",gap:w.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,a.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,a.css)({display:"flex",flexDirection:"row",gap:w.spacing(1)}),filterContainerTight:(0,a.css)({flexDirection:"column",marginLeft:"initial"})}}},90232:(Z,R,e)=>{"use strict";e.d(R,{y:()=>v});var n=e(74848),a=e(22803),s=e(96540),l=e(40996),o=e(28105),d=e(92745),i=e(63142),c=e(50201),m=e(89640),p=e(41654),h=e(34213),r=e(70905),g=e(55290),y=e(24381);const v=({onClickCard:f,searchString:u,sortDirection:b,panelFilter:E,folderFilter:D,showSecondaryActions:C,currentPanelId:P,perPage:T=40})=>{const O=(0,i.of)(x),[{libraryPanels:I,page:j,perPage:W,numberOfPages:B,loadingState:S,currentPanelId:w},N]=(0,s.useReducer)(y.w_,{...y.Xb,currentPanelId:P,perPage:T}),M=(0,s.useMemo)(()=>(0,g.QC)(N),[N]);(0,l.A)(()=>M((0,g.IF)({searchString:u,sortDirection:b,panelFilter:E,folderFilterUIDs:D,page:j,perPage:W,currentPanelId:w})),300,[u,b,E,D,j,M]);const L=({uid:F})=>M((0,g.h4)(F,{searchString:u,sortDirection:b,panelFilter:E,folderFilterUIDs:D,page:j,perPage:W})),A=F=>M((0,y.yd)({page:F}));return!(u||E?.length||D?.length)&&S===o.Gu.Done&&I.length<1?(0,n.jsx)(c.p,{variant:"call-to-action",message:(0,d.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,n.jsxs)(d.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,n.jsx)(m.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,n.jsxs)(p.B,{direction:"column",wrap:"nowrap",children:[S===o.Gu.Loading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.E.Skeleton,{showSecondaryActions:C}),(0,n.jsx)(r.E.Skeleton,{showSecondaryActions:C}),(0,n.jsx)(r.E.Skeleton,{showSecondaryActions:C})]}):I.length<1?(0,n.jsx)(c.p,{variant:"not-found",message:(0,d.t)("library-panels.empty-state.message","No library panels found")}):I?.map((F,V)=>(0,n.jsx)(r.E,{libraryPanel:F,onDelete:L,onClick:f,showSecondaryActions:C},`library-panel=${V}`)),I.length?(0,n.jsx)("div",{className:O.pagination,children:(0,n.jsx)(h.d,{currentPage:j,numberOfPages:B,onNavigate:A,hideWhenSinglePage:!0})}):null]})},x=f=>({pagination:(0,a.css)({alignSelf:"center",marginTop:f.spacing(1)})})},55290:(Z,R,e)=>{"use strict";e.d(R,{IF:()=>y,QC:()=>x,h4:()=>v});var n=e(64423),a=e(65474),s=e(62467),l=e(44240),o=e(39697),d=e(69862),i=e(66847),c=e(69850),m=e(1005),p=e(65961),h=e(67791),r=e(30124),g=e(24381);function y(f){return function(u){const b=new n.yU,E=(0,a.H)((0,r.dq)({searchString:f.searchString,perPage:f.perPage,page:f.page,excludeUid:f.currentPanelId,sortDirection:f.sortDirection,typeFilter:f.panelFilter,folderFilterUIDs:f.folderFilterUIDs})).pipe((0,d.Z)(D=>{const{elements:C}=D;return(0,s.of)({...D,elements:C})}),(0,d.Z)(({perPage:D,elements:C,page:P,totalCount:T})=>(0,s.of)((0,g.c4)({libraryPanels:C,page:P,perPage:D,totalCount:T}))),(0,i.W)(D=>(console.error(D),(0,s.of)((0,g.c4)({...g.Xb,page:f.page,perPage:f.perPage})))),(0,c.j)(()=>b.unsubscribe()),(0,m.u)());b.add((0,l.h)((0,o.O)(50).pipe((0,p.u)((0,g.d9)()),(0,h.Q)(E)),E).subscribe(u))}}function v(f,u){return async function(b){try{await(0,r.h4)(f),y(u)(b)}catch(E){console.error(E)}}}function x(f){return function(u){return u instanceof Function?u(f):f(u)}}},24381:(Z,R,e)=>{"use strict";e.d(R,{Xb:()=>s,c4:()=>o,d9:()=>l,w_:()=>i,yd:()=>d});var n=e(65307),a=e(28105);const s={loadingState:a.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},l=(0,n.VP)("libraryPanels/view/initSearch"),o=(0,n.VP)("libraryPanels/view/searchCompleted"),d=(0,n.VP)("libraryPanels/view/changePage"),i=(c,m)=>{if(l.match(m))return{...c,loadingState:a.Gu.Loading};if(o.match(m)){const{libraryPanels:p,page:h,perPage:r,totalCount:g}=m.payload,y=Math.ceil(g/r);return{...c,libraryPanels:p,perPage:r,totalCount:g,loadingState:a.Gu.Done,numberOfPages:y,page:h>y?h-1:h}}return d.match(m)?{...c,page:m.payload.page}:c}},75515:(Z,R,e)=>{"use strict";e.d(R,{X:()=>n});function n(a){return!!a.libraryPanel?.uid}},30124:(Z,R,e)=>{"use strict";e.d(R,{DW:()=>b,GN:()=>v,Yr:()=>p,d7:()=>r,dq:()=>m,e9:()=>h,h4:()=>y,jc:()=>g,xV:()=>x});var n=e(75505),a=e(59857),s=e(7817),l=e(93389),o=e(70030),d=e(8285),i=e(83873),c=e(97583);async function m({searchString:E="",perPage:D=100,page:C=1,excludeUid:P="",sortDirection:T="",typeFilter:O=[],folderFilterUIDs:I=[]}={}){const j=new URLSearchParams;j.append("searchString",E),j.append("sortDirection",T),j.append("typeFilter",O.join(",")),j.append("folderFilterUIDs",I.join(",")),j.append("excludeUid",P),j.append("perPage",D.toString(10)),j.append("page",C.toString(10)),j.append("kind",c.i.Panel.toString(10));const{result:W}=await(0,i.AI)().get(`/api/library-elements?${j.toString()}`);return W}async function p(E,D=!1){const C=await(0,n.s)((0,i.AI)().fetch({method:"GET",url:`/api/library-elements/${E}`,showSuccessAlert:!D,showErrorAlert:!D})),{result:P}=C.data,T=new s.G({...a.Ye,schemaVersion:35,panels:[P.model]}),{scopedVars:O,...I}=T.panels[0].getSaveModel();return delete I.gridPos,delete I.id,delete I.libraryPanel,T.destroy(),{...P,model:I}}async function h(E){const{result:D}=await(0,i.AI)().get(`/api/library-elements/name/${E}`,void 0,void 0,{validatePath:!0});return D}async function r(E,D){const{result:C}=await(0,i.AI)().post("/api/library-elements",{folderUid:D,name:E.libraryPanel.name,model:E,kind:c.i.Panel});return C}async function g(E){const{libraryPanel:D,...C}=E,{uid:P,name:T,version:O,folderUid:I}=D,j=c.i.Panel,{result:W}=await(0,i.AI)().patch(`/api/library-elements/${P}`,{folderUid:I,name:T,model:C,version:O,kind:j});return W}function y(E){return(0,i.AI)().delete(`/api/library-elements/${E}`)}async function v(E){const{result:D}=await(0,i.AI)().get(`/api/library-elements/${E}/connections`);return D}async function x(E){const D=await v(E);return D.length===0?[]:await(0,i.AI)().search({dashboardUIDs:D.map(P=>P.connectionUid)})}function f(E){const D=(0,d.iL)(E),{uid:C,name:P,_loadedPanel:T}=D.state;let O=E.parent;if(!O||!(O instanceof l.U))throw new Error("Trying to save a library panel that does not have a DashboardGridItem parent");return{...T,uid:C,name:P,type:E.state.pluginId,model:(0,o.Z6)(E.clone({$behaviors:void 0}),{x:O.state.x??0,y:O.state.y??0,w:O.state.width??0,h:O.state.height??0},!1,O),kind:c.i.Panel,version:T?.version||0}}async function u(E){const{uid:D,folderUid:C,name:P,model:T,version:O,kind:I}=f(E),{result:j}=await(0,i.AI)().patch(`/api/library-elements/${D}`,{folderUid:C,name:P,model:T,version:O,kind:I});return j}async function b(E){const D=await u(E),C=(0,d.iL)(E);if(!C)throw new Error("Could not find library panel behavior for panel");C.setPanelFromLibPanel(D)}},37666:(Z,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(22803);function a(s){return{myTable:(0,n.css)({maxHeight:"204px",overflowY:"auto",marginTop:"11px",marginBottom:"28px",borderRadius:s.shape.radius.default,border:`1px solid ${s.colors.action.hover}`,background:s.colors.background.primary,color:s.colors.text.secondary,fontSize:s.typography.h6.fontSize,width:"100%",thead:{color:"#538ade",fontSize:s.typography.bodySmall.fontSize},"th, td":{padding:"6px 13px",height:s.spacing(4)},"tbody > tr:nth-child(odd)":{background:s.colors.background.secondary}}),noteTextbox:(0,n.css)({marginBottom:s.spacing(4)}),textInfo:(0,n.css)({color:s.colors.text.secondary,fontSize:s.typography.size.sm}),dashboardSearch:(0,n.css)({marginTop:s.spacing(2)}),modal:(0,n.css)({width:"500px"}),modalText:(0,n.css)({fontSize:s.typography.h4.fontSize,color:s.colors.text.primary,marginBottom:s.spacing(4),paddingTop:s.spacing(2)})}}},97583:(Z,R,e)=>{"use strict";e.d(R,{i:()=>n});var n=(s=>(s[s.Panel=1]="Panel",s))(n||{}),a=(s=>(s[s.Dashboard=1]="Dashboard",s))(a||{})},12048:(Z,R,e)=>{"use strict";e.d(R,{b:()=>p});var n=e(5805),a=e(92745),s=e(68143),l=e(64762),o=e(30124);async function d(h,r){const g=i(h),y=await m(g,r);return c(h,y),y}function i(h){let{scopedVars:r,...g}=h.getSaveModel();return g={libraryPanel:{name:h.title,uid:void 0},...g},g}function c(h,r){h.restoreModel({...r.model,configRev:0,libraryPanel:r,title:h.title}),h.hasSavedPanelEditChange=!0,h.refresh()}function m(h,r){return h.libraryPanel?h.libraryPanel&&h.libraryPanel.uid===""?(0,o.d7)(h,r):(0,o.jc)(h):Promise.reject()}const p=()=>{const h=(0,l._2)(),[r,g]=(0,n.default)(async(y,v)=>{try{const x=await d(y,v);return h.success((0,a.t)("library-panels.save.success","Library panel saved")),x}catch(x){throw(0,s.NF)(x)&&(x.isHandled=!0,h.error((0,a.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:x.message??x.data.message}))),x}},[]);return{state:r,saveLibraryPanel:g}}},79718:(Z,R,e)=>{"use strict";e.d(R,{t:()=>E});var n=e(24726),a=e(38619),s=e(32899),l=e(33184),o=e(36490),d=e(73427),i=e(87745),c=e(22429),m=e(74848),p=e(22803),h=e(92745),r=e(63142),g=e(22787),y=e(45861),v=(D=>(D.Saved="saved",D.EditingStarted="editing-started",D.EditingCanceled="editing-cancelled",D.Deleted="deleted",D))(v||{});function x({onDismiss:D,event:C}){const P=(0,r.of)(f),T=()=>{if(C?.action===v.Deleted){o.Ny.push("/");return}E.reloadPage(),D()};return(0,m.jsxs)(g.a,{isOpen:!0,title:(0,h.t)("live.dashboard-changed-modal.title-dashboard-changed","Dashboard changed"),icon:"copy",onDismiss:D,onClickBackdrop:()=>{},className:P.modal,children:[(0,m.jsx)("div",{className:P.description,children:(0,m.jsx)(h.x6,{i18nKey:"live.dashboard-changed-modal.description",children:"The dashboard has been updated by another session. Do you want to continue editing or discard your local changes?"})}),(0,m.jsxs)(g.a.ButtonRow,{children:[(0,m.jsx)(y.$n,{onClick:D,variant:"secondary",fill:"outline",children:(0,m.jsx)(h.x6,{i18nKey:"live.dashboard-changed-modal.continue-editing",children:"Continue editing"})}),(0,m.jsx)(y.$n,{onClick:T,variant:"destructive",children:(0,m.jsx)(h.x6,{i18nKey:"live.dashboard-changed-modal.discard-local-changes",children:"Discard local changes"})})]})]})}const f=D=>({modal:(0,p.css)({width:"600px"}),description:(0,p.css)({color:D.colors.text.secondary,paddingBottom:D.spacing(1)})}),u=(0,n.A)();class b{constructor(){this.editing=!1,this.observer={next:C=>{if((0,a.ew)(C)&&this.editing&&C.state===a.ZF.Connected&&this.sendEditingState(),(0,a.Z7)(C)){if(C.message.sessionId===u)return;const{action:P}=C.message;switch(P){case v.EditingStarted:case v.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const T=(0,c.UA)().getCurrent();if(T?.uid!==C.message.uid){console.log("dashboard event for different dashboard?",C,T);return}const O=this.editing||T.hasUnsavedChanges();if(P===v.Saved)O?d.lE.publish(new i.S8({component:x,props:{event:C}})):(d.lE.emit(s.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(O&&P===v.EditingStarted&&!this.hasSeenNotice){const I=C.message,j=this.getRecentEditingEvent();(!j||j.message!==I.message)&&(this.hasSeenNotice=!0,d.lE.emit(s.r1.alertWarning,["Another session is editing this dashboard",I.message])),this.lastEditing=I}return}}}}}}setEditingState(C){const P=this.editing=C;this.editing=C,this.hasSeenNotice=!1,P&&d.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:C,uid:P}=this;C&&P&&(0,l.oF)().publish(C,{sessionId:u,uid:P,action:this.editing?v.EditingStarted:v.EditingCanceled,timestamp:Date.now()})}watch(C){const P=(0,l.oF)();P&&C!==this.uid&&(this.channel={scope:a.qD.Grafana,namespace:"dashboard",path:`uid/${C}`},this.leave(),C&&(this.subscription=P.getStream(this.channel).subscribe(this.observer)),this.uid=C)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){o.Ny.reload()}}const E=new b},46383:(Z,R,e)=>{"use strict";e.d(R,{_w:()=>a,o$:()=>d,ot:()=>s});var n=e(41119),a=(i=>(i.NewValuesSameSchema="NewValuesSameSchema",i.FullFrame="FullFrame",i))(a||{});const s=(i,c)=>"type"in i&&i.type===c,l=Object.values(a),o=i=>"type"in i&&l.includes(i.type),d=i=>(0,n.ci)(i)&&"packetInfo"in i},62215:(Z,R,e)=>{"use strict";e.d(R,{FE:()=>c,jE:()=>d,qE:()=>i});var n=e(2543),a=e.n(n),s=e(92745),l=e(62635),o=e(46072);const d=(r,g)=>c(r,g),i=r=>{let g=[];return r.forEach(y=>{y.links?.forEach(v=>{if("variables"in v&&v.variables.length>0){const x={href:v.href,title:v.title,origin:v.origin,onClick:v.onClick,target:v.target},f=v.variables.map(b=>{const E=b.variableName,D=b.fieldPath?`.${b.fieldPath}`:"";return`${E}${D}`}),u=v.variables.map(b=>b.found?b.value:"");g.push({keys:f,values:u,links:[x],fieldIndex:y.fieldIndex})}})}),g},c=(r,g)=>h(r).map(v=>{const x={__labels:{text:(0,s.t)("logs.get-dataframe-fields.vars.text.labels","Labels"),value:{tags:{...r.labels}}}},f=g?g(v,r.rowIndex,r.dataFrame,x):[],u=v.values[r.rowIndex],b=typeof u=="string"||typeof u=="number"?u.toString():(0,l.MA)(u);return{keys:[v.name],values:[b],links:f,fieldIndex:v.index}});function m(r,g){const y=(0,o.Os)(r);if(y===null)return new Set;const v=new Set(y.extraFields.map(x=>x.index));return y.severityField!==null&&v.add(y.severityField.index),g.keepBody&&v.add(y.bodyField.index),g.keepTimestamp&&v.add(y.timeField.index),v}function p(r,g){const y=r.fields.map((u,b)=>({...u,index:b})),v=m(r,g??{}),[x,f]=partition(y,u=>u.config.custom?.hidden?!1:(u.config.links??[]).length>0?!0:v.has(u.index));return{visible:x,hidden:f}}function h(r,g){const y=r.dataFrame,v=m(y,g??{}),x=[];for(let f=0;f<y.fields.length;f++){const u=y.fields[f];u.values[r.rowIndex]!=null&&(u.config.custom?.hidden||(u.config.links&&u.config.links.length>0||v.has(f))&&x.push({...u,index:f}))}return x}},46072:(Z,R,e)=>{"use strict";e.d(R,{nC:()=>g,ww:()=>y,Os:()=>v});var n=e(10279),a=e(95004),s=e(39443);function l(x,f){const u=x.labels;if(u!==void 0){const b=new Array(f);return b.fill(u),b}else return null}function o(x,f,u){const b=x.getFieldByName("labels");if(b!==void 0&&b.type===a.PU.other){const E=b.values.map(g);return[b,()=>E]}else return[null,()=>l(f,u.length)]}function d(x){const f=new n.L(x),u=f.getFirstFieldOfType(a.PU.time),b=f.getFirstFieldOfType(a.PU.string);if(u===void 0||b===void 0)return null;const E=f.getFieldByName("tsNs")??null,D=f.getFieldByName("level")??f.getFieldByName("detected_level")??null,C=f.getFieldByName("id")??null,[P,T]=o(f,b,x),O=f.fields.filter((I,j)=>j!==u.index&&j!==b.index&&j!==E?.index&&j!==D?.index&&j!==C?.index&&j!==P?.index);return{timeField:u,bodyField:b,timeNanosecondField:E,severityField:D,idField:C,getLogFrameLabels:T,getLogFrameLabelsAsLabels:T,getLabelFieldName:()=>P?.name??null,extraFields:O}}function i(x,f,u){const b=x.getFieldByName(f);if(b!==void 0)return b.type===u?b:void 0}const c="timestamp",m="body",p="severity",h="id",r="labels";function g(x){let f=!1;for(const u in x)if(typeof x[u]!="string"){f=!0;break}if(f){let u={};for(const b in x){const E=x[b];u[b]=typeof E=="string"?E:JSON.stringify(E)}return u}return x}function y(x){const f=new n.L(x),u=i(f,c,a.PU.time),b=i(f,m,a.PU.string);if(u===void 0||b===void 0)return null;const E=i(f,p,a.PU.string)??null,D=i(f,h,a.PU.string)??null,C=i(f,r,a.PU.other)??null,P=C===null?null:C.values,T=f.fields.filter((O,I)=>I!==u.index&&I!==b.index&&I!==E?.index&&I!==D?.index&&I!==C?.index);return{timeField:u,bodyField:b,severityField:E,idField:D,getLogFrameLabels:()=>P,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>P!==null?P.map(g):null,getLabelFieldName:()=>C!==null?C.name:null,extraFields:T}}function v(x){return x.meta?.type===s.m.LogLines?y(x):d(x)}},37234:(Z,R,e)=>{"use strict";e.d(R,{yR:()=>W,cZ:()=>S,HT:()=>H,M0:()=>V,f8:()=>de,J9:()=>K,Wr:()=>se,sg:()=>ne});var n=e(88838),a=e(2543),s=e(88483),l=e(50832),o=e(65474),d=e(67770),i=e(739),c=e(41119),m=e(10279),p=e(95004),h=e(64394),r=e(25229),g=e(71642),y=e(63704),v=e(80011),x=e(17548),f=e(28105),u=e(50204),b=e(92745),E=e(43173),D=e(8255),C=e(65642);function P(ie,he){return C.Ay.bootData?.user?.lightTheme?he:ie}var T=e(12282),O=e(46072),I=e(74746);const j="Line limit",W="Common labels",B="Total lines",S={[d.$b.critical]:D.Tj[7],[d.$b.error]:D.Tj[4],[d.$b.warning]:D.Tj[1],[d.$b.info]:D.Tj[0],[d.$b.debug]:D.Tj[5],[d.$b.trace]:D.Tj[2],[d.$b.unknown]:P("#8e8e8e","#bdc4cd")},w=1,N=1e3*w,M=60*N,L=60*M,A=24*L,U=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function F(ie,he,me){switch(me){case i.fY.exact:return ie.entry.replace(U,"")===he.entry.replace(U,"");case i.fY.numbers:return ie.entry.replace(/\d/g,"")===he.entry.replace(/\d/g,"");case i.fY.signature:return ie.entry.replace(/\w/g,"")===he.entry.replace(/\w/g,"");default:return!1}}function V(ie,he){return he===i.fY.none?ie:ie.reduce((me,ce,Pe)=>{const Ie=me[me.length-1];return Pe>0&&F(ce,Ie,he)?Ie.duplicates++:me.push({...ce,duplicates:0}),me},[])}function K(ie,he){const me={},ce=[];for(const Pe of ie){let Ie=me[Pe.logLevel];Ie||(me[Pe.logLevel]=Ie={lastTs:null,datapoints:[],target:Pe.logLevel,color:S[Pe.logLevel]},ce.push(Ie));const Se=Math.floor(Pe.timeEpochMs/he)*he;Se===Ie.lastTs?Ie.datapoints[Ie.datapoints.length-1][0]++:(Ie.datapoints.push([1,Se]),Ie.lastTs=Se);for(const Me of ce)Me!==Ie&&Me.lastTs!==Se&&(Me.datapoints.push([0,Se]),Me.lastTs=Se)}return ce.map((Pe,Ie)=>{Pe.datapoints.sort((Ge,Qe)=>Ge[1]-Qe[1]);const Se=(0,c.Vc)(Pe),Te=new m.L(Se).getFirstFieldOfType(p.PU.number);return Se.fields[Te.index].config.min=0,Se.fields[Te.index].config.decimals=0,Se.fields[Te.index].config.color={mode:h.Y.Fixed,fixedColor:Pe.color},Se.fields[Te.index].config.custom={drawStyle:i.GR.Bars,barAlignment:i.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:Pe.color,pointColor:Pe.color,fillColor:Pe.color,lineWidth:0,fillOpacity:100,stacking:{mode:i.gs.Normal,group:"A"}},Se})}function G(ie){return ie.fields.some(he=>he.type===p.PU.time)&&ie.fields.some(he=>he.type===p.PU.string)}function H(ie,he,me,ce,Pe){const{logSeries:Ie}=k(ie),Se=z(Ie,ce,!!Pe);if(Se){if(Se.queries=ce,he&&Se.rows.length>0){const Me=Se.rows.sort(I.M1),{visibleRange:Te,bucketSize:Ge,visibleRangeMs:Qe,requestedRangeMs:tt}=_(Me,he,me);Se.visibleRange=Te,Se.bucketSize=Ge,Se.series=K(Me,Ge),Se.meta&&(Se.meta=Y(Se,Qe,tt))}else Se.series=[];return Se}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:ce}}function _(ie,he,me,ce=20,Pe=1e3){let Ie=me,Se=he,Me=Math.max(Se*ce,Pe),Te,Ge;if(me){const Qe=ie[0].timeEpochMs,tt=ie[ie.length-1].timeEpochMs,ke=Qe<tt?Qe:tt,He=me.to-ke;if(Ge=me.to-me.from,Te=Math.abs(Qe-tt),Te>0){const Re=He/Ge;Se*=Re,Me=Math.max(Math.ceil(Se*ce),Pe),Ie={from:Math.floor(ke/Me)*Me,to:me.to}}else Te=1}return{bucketSize:Me,visibleRange:Ie,visibleRangeMs:Te,requestedRangeMs:Ge}}function k(ie){const he=[],me=[];for(const ce of ie){if(G(ce)||!ce.fields.length){me.push(ce);continue}ce.length>0&&he.push(ce)}return{logSeries:me,metricSeries:he}}function J(ie,he,me){const ce=ie.values[me],Ie=(0,r.yT)(ce).valueOf();if(he)return{ts:ce,timeEpochMs:Ie,timeEpochNs:he.values[me]};if(ie.nanos!==void 0){const Se=ie.nanos[me].toString().padStart(6,"0"),Me=`${Ie}${Se}`;return{ts:ce,timeEpochMs:Ie,timeEpochNs:Me}}return{ts:ce,timeEpochMs:Ie,timeEpochNs:Ie+"000000"}}function z(ie,he=[],me=!1){if(ie.length===0)return;const ce=[];let Pe=[];const Ie=ie.filter(We=>We.fields.length);Ie.length&&Ie.forEach(We=>{const _e=(0,O.Os)(We);if(_e!=null){const Xe=_e.getLogFrameLabelsAsLabels()??void 0,le={rawFrame:We,logsFrame:_e,frameLabels:Xe};Pe.push(le),Xe&&Xe.length>0&&ce.push(Xe)}});const Se=ce.flat(),Me=Se.length>0?(0,g.yO)(Se):{};let Te=[],Ge=!1;const Qe=(0,I.kA)();for(const We of Pe){const{logsFrame:_e,rawFrame:Xe,frameLabels:le}=We,{timeField:ye,timeNanosecondField:pe,bodyField:ve,severityField:be,idField:Oe}=_e;for(let we=0;we<Xe.length;we++){const{ts:ze,timeEpochMs:Ve,timeEpochNs:ge}=J(ye,pe??void 0,we),Ke=ve.values[we]??"",qe=typeof Ke=="string"?Ke:JSON.stringify(Ke),ot=y.sQ.hasAnsiCodes(qe),lt=!!qe.match(/\\n|\\t|\\r/),mt=Xe.meta?.custom?.searchWords??Xe.meta?.searchWords??[],Lt=ot?n.Ay.strip(qe):qe,Tt=le?.[we],It=(0,g.s6)(Tt,Me);Object.keys(It).length>0&&(Ge=!0);let Mt=d.$b.unknown;const Ut=be&&be.values[we]||(Tt?.level??Tt?.detected_level);typeof Ut=="number"||typeof Ut=="string"?Mt=(0,I.EK)(Ut):Mt=(0,I.XM)(Lt);const an=he.find(yn=>yn.refId===Xe.refId)?.datasource,cn=an?.type,un=an?.uid,On={entryFieldIndex:ve.index,rowIndex:we,dataFrame:Xe,logLevel:Mt,timeFromNow:(0,v.fq)(ze),timeEpochMs:Ve,timeEpochNs:ge,timeLocal:(0,v.LE)(ze,{timeZone:"browser"}),timeUtc:(0,v.LE)(ze,{timeZone:"utc"}),uniqueLabels:It,hasAnsi:ot,hasUnescapedContent:lt,searchWords:mt,entry:Lt,raw:qe,labels:Tt||{},uid:`${Xe.refId}_${Oe?Oe.values[we]:we.toString()}`,datasourceType:cn,datasourceUid:un};Oe!==null&&(On.rowId=Oe.values[we]),!(me&&Qe(On))&&Te.push(On)}}const tt=[],He=ie.filter(We=>We?.meta?.custom?.limit??We?.meta?.limit).reduce((We,_e)=>(We[_e.refId??""]=_e.meta?.custom?.limit??_e.meta?.limit??0,We),{}),Re=Object.values(He).reduce((We,_e)=>We+=_e,0);Re>0&&tt.push({label:j,value:Re,kind:d.tG.Number});const Ne=ie.reduce((We,_e)=>We+=_e.meta?.custom?.total,0);Ne>0&&tt.push({label:B,value:Ne,kind:d.tG.Number});let Ae=0;const Ue={};let Be=!1;for(const We of ie){const _e=We.meta?.custom?.lokiQueryStatKey,{refId:Xe}=We;if(!Be&&We.meta?.custom?.error&&(tt.push({label:"",value:We.meta?.custom.error,kind:d.tG.Error}),Be=!0),Xe&&!Ue[Xe]){if(_e&&We.meta?.stats){const le=We.meta.stats.find(ye=>ye.displayName===_e);le&&(Ae+=le.value)}Ue[Xe]=!0}}if(Ae>0){const{text:We,suffix:_e}=(0,u.rT)("B")(Ae);tt.push({label:(0,b.t)("logs.log-series-to-logs-model.label.total-bytes-processed","Total bytes processed"),value:`${We} ${_e}`,kind:d.tG.String})}return(0,a.size)(Me)>0&&tt.push({label:W,value:Me,kind:d.tG.LabelsMap}),{hasUniqueLabels:Ge,meta:tt,rows:Te}}function Y(ie,he,me){if(!ie.meta)return[];let ce=[...ie.meta];const Pe=ce.findIndex(Se=>Se.label===j),Ie=Pe>=0&&ce[Pe]?.value;if(Ie&&typeof Ie=="number"&&Ie>0){let Se;if(Ie===ie.rows.length&&he&&me){if(Se=`${Ie} reached`,!ie.queries?.some(Te=>"direction"in Te&&Te.direction===T.ti.Scan)){const Te=(he/me*100).toFixed(2);Se=`${Ie} lines shown \u2014 ${Te}% (${x.msRangeToTimeString(he)}) of ${x.msRangeToTimeString(me)}`}}else{const Me=E.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";Se=`${ie.rows.length} ${ie.rows.length>1?"lines":"line"} ${Me}`}ce[Pe]={label:"",value:Se,kind:d.tG.String}}return ce}function X(ie,he){const me=he&&ie===d.$b.unknown?"logs":ie,ce=S[ie];return{displayNameFromDS:me,color:{mode:h.Y.Fixed,fixedColor:ce},custom:{drawStyle:i.GR.Bars,barAlignment:i.Nj.Center,lineColor:ce,pointColor:ce,fillColor:ce,lineWidth:1,fillOpacity:100,stacking:{mode:i.gs.Normal,group:"A"}}}}const Q=(ie,he,me)=>(ie.fields=ie.fields.map(ce=>(ce.type===p.PU.number&&(ce.config={...ce.config,...X(he(ie),me)}),ce)),ie);function q(ie){let he;try{he=new m.L(ie).getFirstFieldOfType(p.PU.number)}catch{}return he?.labels?te(he.labels):d.$b.unknown}function te(ie){const he=ie.level??ie.detected_level??ie.lvl??ie.loglevel??"";return he?(0,I.EK)(he):d.$b.unknown}function ne(ie,he,me){const ce=he.range,Pe=me.targets,Ie=q,Se=ce.to.valueOf()-ce.from.valueOf(),Me=ue(he.scopedVars,Se);return he.interval=Me.interval,he.scopedVars.__interval={value:Me.interval,text:Me.interval},Me.intervalMs!==void 0&&(he.intervalMs=Me.intervalMs,he.scopedVars.__interval_ms={value:Me.intervalMs,text:Me.intervalMs}),he.hideFromInspector=!0,new s.c(Te=>{let Ge=[];Te.next({state:f.Gu.Loading,error:void 0,data:[]});const Qe=ie.query(he),ke=((0,l.A)(Qe)?Qe:(0,o.H)(Qe)).subscribe({complete:()=>{Te.complete()},next:He=>{const{error:Re}=He;if(Re!==void 0)Te.next({state:f.Gu.Error,error:Re,data:He.data}),Te.error(Re);else{const Ne=(0,a.groupBy)(He.data,"refId");Ge=He.data.map(Ae=>{if(Ae.meta?.dataTopic===i.QR.Annotations)return Ae;let Ue=Ae.refId||"";Ue.startsWith("log-volume-")&&(Ue=Ue.substr(11));const Be={logsVolumeType:d.Aj.FullRange,absoluteRange:{from:ce.from.valueOf(),to:ce.to.valueOf()},datasourceName:ie.name,sourceQuery:Pe.find(We=>We.refId===Ue)};return Ae.meta={...Ae.meta,custom:{...Ae.meta?.custom,...Be}},Q(Ae,Ie,Ne[Ae.refId].length===1)}),Te.next({state:He.state,error:void 0,data:Ge})}},error:He=>{Te.next({state:f.Gu.Error,error:He,data:[]}),Te.error(He)}});return()=>{ke?.unsubscribe()}})}function se(ie,he){return he.hideFromInspector=!0,new s.c(me=>{let ce=[];me.next({state:f.Gu.Loading,error:void 0,data:[]});const Pe=ie.query(he),Se=((0,l.A)(Pe)?Pe:(0,o.H)(Pe)).subscribe({complete:()=>{me.next({state:f.Gu.Done,error:void 0,data:ce}),me.complete()},next:Me=>{const{error:Te}=Me;Te!==void 0?(me.next({state:f.Gu.Error,error:Te,data:[]}),me.error(Te)):ce=Me.data.map(Ge=>{const Qe=(0,c.Vc)(Ge),{timeIndex:tt}=(0,c.KR)(Qe);return(0,c.ES)(Qe,tt)})},error:Me=>{me.next({state:f.Gu.Error,error:Me,data:[]}),me.error(Me)}});return()=>{Se?.unsubscribe()}})}function ue(ie,he){if(ie.__interval_ms){let me=ie.__interval_ms.value,ce="";return he<N*5?(me=w,ce="1ms"):me>L?(me=A,ce="1d"):me>M?(me=L,ce="1h"):me>N?(me=M,ce="1m"):(me=N,ce="1s"),{interval:ce,intervalMs:me}}else return{interval:"$__interval"}}function de(ie){const he=ie.dataFrame;return he.length===0||he.length<=ie.rowIndex?null:(0,c.EI)({fields:he.fields.map(ce=>({...ce,values:[ce.values[ie.rowIndex]]})),refId:he.refId})}},74746:(Z,R,e)=>{"use strict";e.d(R,{Ck:()=>se,Dk:()=>_,Dm:()=>G,Dx:()=>V,EK:()=>I,Ei:()=>L,Hw:()=>U,K7:()=>ie,M1:()=>S,PO:()=>ne,R:()=>k,Tj:()=>j,Vu:()=>ue,XM:()=>O,a8:()=>z,dO:()=>Q,e3:()=>H,kA:()=>Y,oR:()=>M,oT:()=>K,qR:()=>A,s:()=>de,s2:()=>W,tX:()=>J,zy:()=>N});var n=e(4213),a=e.n(n),s=e(2543),l=e.n(s),o=e(75505),d=e(81160),i=e(67770),c=e(739),m=e(25229),p=e(18700),h=e(95004),r=e(83175),g=e(92138),y=e(22592),v=e(10279),x=e(16515),f=e(80011),u=e(2197),b=e(41119),E=e(92745),D=e(65642),C=e(67155),P=e(54334),T=e(62215);function O(me){if(!me)return i.$b.unknown;let ce=i.$b.unknown,Pe;for(const[Ie,Se]of Object.entries(i.$b)){const Te=new RegExp(`\\b${Ie}\\b`,"i").exec(me);Te&&(Pe===void 0||Te.index<Pe)&&(ce=Se,Pe=Te.index)}return ce}function I(me){const ce=i.$b[me.toString().toLowerCase()];if(ce)return ce;if(typeof me=="string"){const Pe=parseInt(me,10);if(me.length===Pe.toString().length)return i.s5[me]||i.$b.unknown}else if(typeof me=="number")return i.s5[me]||i.$b.unknown;return i.$b.unknown}function j(me,ce){const Pe=me.filter(Me=>Me.labels[ce]!==void 0),Ie=Pe.length,Se=(0,s.countBy)(Pe,Me=>Me.labels[ce]);return B(Se,Ie)}function W(me){const ce=me.filter(Ie=>Ie!=null),Pe=(0,s.countBy)(ce);return B(Pe,ce.length)}const B=(me,ce)=>(0,s.chain)(me).map((Pe,Ie)=>({count:Pe,value:Ie,proportion:Pe/ce})).sortBy("count").reverse().value(),S=(me,ce)=>me.timeEpochMs<ce.timeEpochMs?-1:me.timeEpochMs>ce.timeEpochMs?1:me.timeEpochNs<ce.timeEpochNs?-1:me.timeEpochNs>ce.timeEpochNs?1:0,w=(me,ce)=>me.timeEpochMs>ce.timeEpochMs?-1:me.timeEpochMs<ce.timeEpochMs?1:me.timeEpochNs>ce.timeEpochNs?-1:me.timeEpochNs<ce.timeEpochNs?1:0,N=(me,ce)=>{const Pe=me?M(me.rows,ce):[];return me?{...me,rows:Pe}:{hasUniqueLabels:!1,rows:Pe}},M=(me,ce)=>ce===c.uH.Ascending?me.sort(S):me.sort(w),L=me=>me.labels.__error__,A=me=>{if(me.labels.__adaptive_logs_sampled__)return me.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${me.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`},U=me=>me.replace(/\\r\\n|\\n|\\t|\\r/g,ce=>ce.slice(1)==="t"?"	":`
`);function F(me){return me.map(ce=>{const Pe=(0,T.FE)(ce).reduce((Ie,Se)=>{const Me=Se.keys[0];return Ie[Me]=Se.values[0],Ie},{});return{line:ce.entry,timestamp:ce.timeEpochNs,date:(0,m.KQ)(ce.timeEpochMs).toISOString(),fields:{...Pe,...ce.labels}}})}const V=me=>{let ce={from:1/0,to:-1/0};return me.forEach(Pe=>{const Ie=Pe.meta?.custom||{};Ie.absoluteRange?.from&&Ie.absoluteRange?.to&&(ce={from:Math.min(ce.from,Ie.absoluteRange.from),to:Math.max(ce.to,Ie.absoluteRange.to)})}),ce},K=me=>{if(me.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const ce={},Pe={};let Ie=-1/0;const Se={};let Me=[];return me.forEach(Te=>{const{level:Ge,valueField:Qe,timeField:tt}=J(Te,me);if(!(!tt||!Qe)){Se[Ge]={meta:Te.meta,valueFieldConfig:Qe?.config??{},timeFieldConfig:tt?.config??{}};for(let ke=0;ke<Te.length;ke++){const He=tt.values[ke],Re=Qe.values[ke];ce[Ge]??={},ce[Ge][He]=(ce[Ge][He]||0)+Re,Pe[He]=(Pe[He]||0)+Re,Pe[He]>Ie&&(Ie=Pe[He])}}}),Object.keys(ce).forEach(Te=>{const Ge=new p.k,{meta:Qe,timeFieldConfig:tt,valueFieldConfig:ke}=Se[Te];Ge.name=Te,Ge.meta=Qe,Ge.addField({name:"Time",type:h.PU.time,config:tt}),Ge.addField({name:"Value",type:h.PU.number,config:ke}),Object.entries(ce[Te]).sort((He,Re)=>Number(He[0])-Number(Re[0])).forEach(([He,Re])=>{Ge.add({Time:Number(He),Value:Re})}),Me.push(Ge)}),{dataFrames:Me,maximum:Ie}},G=me=>{const ce=me[0]?.meta?.custom;return ce&&ce.datasourceName?{name:ce.datasourceName}:null},H=me=>me[0]?.meta?.custom?.logsVolumeType===i.Aj.Limited,_=async(me,ce)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(me);{const Pe=document.createElement("textarea");ce.current?.appendChild(Pe),Pe.value=me,Pe.focus(),Pe.select(),document.execCommand("copy"),Pe.remove()}};async function k(me,ce,Pe,Ie){if(Pe&&(me.nativeEvent.ctrlKey||me.nativeEvent.metaKey||me.nativeEvent.shiftKey)){const Se=window.open("about:blank"),Me=await Pe(ce,void 0,!1);if(Me&&Se){const Te=r.kM.renderUrl(g.I.assureBaseUrl(`${(0,D.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:Me.datasource,queries:[Me],range:(0,y.E2)()})});Se.location=Te;return}Se?.close()}Ie(ce)}function J(me,ce){const Pe=new v.L(me),Ie=Pe.getFirstFieldOfType(h.PU.time),Se=Pe.getFirstFieldOfType(h.PU.number);return Ie||console.error("Time field missing in data frame"),Se||console.error("Value field missing in data frame"),{level:Se?(0,x.Ct)(Se,me,ce):"logs",valueField:Se,timeField:Ie}}function z(me){return me instanceof Element}function Y(){const me=new Set;return function(ce){let Pe=`${ce.dataFrame.refId}_${ce.rowId?ce.rowId:`${ce.timeEpochNs}_${ce.entry}`}`;return me.has(Pe)?!0:(me.add(Pe),!1)}}function X(me,ce,Pe){const Ie=ce.fields.find(Se=>Se.name==="labelTypes")?.values[Pe];return Ie?Ie[me]??null:null}function Q(me,ce,Pe=!1){if(!ce.datasourceType)return null;const Ie=X(me,ce.dataFrame,ce.rowIndex);return Ie?q(Ie,ce.datasourceType,Pe):null}function q(me,ce,Pe){switch(ce){case"loki":switch(me){case"I":return(0,E.t)("logs.fields.type.loki.indexed-label","Indexed label",{count:Pe?2:1});case"S":return(0,E.t)("logs.fields.type.loki.structured-metadata","Structured metadata",{count:Pe?2:1});case"P":return(0,E.t)("logs.fields.type.loki.parsedl-label","Parsed field",{count:Pe?2:1});default:return null}default:return null}}const te="logs.popover.disabled";function ne(){localStorage.setItem(te,"true")}function se(){localStorage.removeItem(te)}function ue(){return!!localStorage.getItem(te)}var de=(me=>(me.Text="text",me.Json="json",me.CSV="csv",me))(de||{});const ie=async(me,ce,Pe)=>{switch(me){case"text":(0,P.Zy)({meta:Pe,rows:ce});break;case"json":const Ie=F(ce),Se=new Blob([JSON.stringify(Ie)],{type:"application/json;charset=utf-8"}),Me=`Logs-${(0,f.LE)(new Date)}.json`;a()(Se,Me);break;case"csv":const Te=new Map;ce.forEach(Ge=>{Ge.dataFrame?.refId&&!Te.has(Ge.dataFrame?.refId)&&Te.set(Ge.dataFrame?.refId,Ge.dataFrame)}),Te.forEach(async Ge=>{const Qe=(0,C.v)(Ge);Qe.push({id:"organize",options:{excludeByName:{labels:!0,labelTypes:!0}}},he);const tt=await(0,o.s)((0,u.m)(Qe,[Ge]));(0,P.EM)(tt[0],`Logs-${Ge.refId}`)})}},he=()=>me=>me.pipe((0,d.T)(ce=>ce.map(Pe=>{const Ie=(0,b.KR)(Pe),Se={name:"Date",values:Ie.timeField?Ie.timeField?.values.map(Me=>(0,m.KQ)(Me).toISOString()):[],type:h.PU.other,config:{}};return{...Pe,fields:[Se,...Pe.fields]}})))},61730:(Z,R,e)=>{"use strict";e.d(R,{m:()=>c});var n=e(74848),a=e(22803),s=e(92745),l=e(43173),o=e(63142),d=e(71599);const i=()=>{const p=(0,o.of)(m);return(0,n.jsx)("p",{className:p.description,children:l.$.featureToggles.newDashboardSharingComponent?(0,s.t)("shared-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this access? The dashboard can no longer be shared."):(0,s.t)("public-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public.")})},c=({onConfirm:p,onDismiss:h})=>{const r=l.$.featureToggles.newDashboardSharingComponent?(0,s.t)("shared-dashboard.delete-modal.revoke-title","Revoke access"):(0,s.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,n.jsx)(d.u,{isOpen:!0,body:(0,n.jsx)(i,{}),onConfirm:p,onDismiss:h,title:r,icon:"trash-alt",confirmText:r})},m=p=>({title:(0,a.css)({marginBottom:p.spacing(1)}),description:(0,a.css)({fontSize:p.typography.body.fontSize})})},89223:(Z,R,e)=>{"use strict";e.d(R,{P:()=>l});var n=e(55860);class a extends Error{constructor(d,i){super(i),this.type=d}}class s{constructor(){this.rootName="general"}validateNewDashboardName(d,i){return this.validate(d,i,"A dashboard or a folder with the same name already exists")}validateNewFolderName(d){return this.validate(this.rootName,d,"A folder or dashboard in the general folder with the same name already exists")}async validate(d,i,c){i=(i||"").trim();const m=i.toLowerCase();if(i.length===0)throw new a("REQUIRED","Name is required");if(m===this.rootName)throw new a("EXISTING","This is a reserved name and cannot be used for a folder.");const h=await(0,n.S)().search({kind:["dashboard"],query:i,location:d||"general"});for(const r of h.view)if(m===r.name.toLowerCase())throw new a("EXISTING",c)}}const l=new s},2559:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>x,J7:()=>o,NZ:()=>l,Rp:()=>p,SN:()=>c,V9:()=>d,dW:()=>r,dd:()=>h,f7:()=>y,oQ:()=>g,qx:()=>s,y3:()=>m});var n=e(65307),a=e(28105),s=(f=>(f[f.Gcom=0]="Gcom",f[f.Json=1]="Json",f))(s||{}),l=(f=>(f.DataSource="datasource",f.Constant="constant",f.LibraryPanel="libraryPanel",f))(l||{}),o=(f=>(f.New="new",f.Exists="exists",f.Different="different",f))(o||{});const d={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:a.Gu.NotStarted},i=(0,n.Z0)({name:"manageDashboards",initialState:d,reducers:{setGcomDashboard:(f,u)=>{f.dashboard={...u.payload.json,id:null},f.meta={updatedAt:u.payload.updatedAt,orgName:u.payload.orgName},f.source=0,f.state=a.Gu.Done},setJsonDashboard:(f,u)=>{f.dashboard={...u.payload,id:null},f.meta=d.meta,f.source=1,f.state=a.Gu.Done},clearDashboard:f=>{f.dashboard={},f.state=a.Gu.NotStarted},setInputs:(f,u)=>{f.inputs={dataSources:u.payload.filter(b=>b.type==="datasource"),constants:u.payload.filter(b=>b.type==="constant"),libraryPanels:f.inputs.libraryPanels||[]}},setLibraryPanelInputs:(f,u)=>{f.inputs.libraryPanels=u.payload},fetchFailed:f=>{f.dashboard={},f.state=a.Gu.Error},fetchDashboard:f=>{f.state=a.Gu.Loading}}}),{clearDashboard:c,setInputs:m,setGcomDashboard:p,setJsonDashboard:h,setLibraryPanelInputs:r,fetchFailed:g,fetchDashboard:y}=i.actions,x={importDashboard:i.reducer}},2495:(Z,R,e)=>{"use strict";e.d(R,{O5:()=>D,r3:()=>r,dX:()=>f,hZ:()=>i,ri:()=>p,WH:()=>u,AC:()=>c,YX:()=>x,bM:()=>b,A_:()=>E,u:()=>P,D0:()=>v,SM:()=>d,M8:()=>y,YD:()=>h,aD:()=>g});var n=e(59253),a=e(73892),s=e(75816);const o=(0,s.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:(0,a.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:T=>({getSessionList:T.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:T.mutation({query:O=>({url:"/cloudmigration/migration",method:"POST",body:O.cloudMigrationSessionRequestDto})}),deleteSession:T.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}`,method:"DELETE"})}),getSession:T.query({query:O=>({url:`/cloudmigration/migration/${O.uid}`})}),createSnapshot:T.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot`,method:"POST",body:O.createSnapshotRequestDto})}),getSnapshot:T.query({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}`,params:{resultPage:O.resultPage,resultLimit:O.resultLimit,resultSortColumn:O.resultSortColumn,resultSortOrder:O.resultSortOrder,errorsOnly:O.errorsOnly}})}),cancelSnapshot:T.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:T.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}/upload`,method:"POST"})}),getShapshotList:T.query({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshots`,params:{page:O.page,limit:O.limit,sort:O.sort}})}),getResourceDependencies:T.query({query:()=>({url:"/cloudmigration/resources/dependencies"})}),getCloudMigrationToken:T.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:T.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:T.mutation({query:O=>({url:`/cloudmigration/token/${O.uid}`,method:"DELETE"})}),getDashboardByUid:T.query({query:O=>({url:`/dashboards/uid/${O.uid}`})}),getLibraryElementByUid:T.query({query:O=>({url:`/library-elements/${O.libraryElementUid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:d,useCreateSessionMutation:i,useDeleteSessionMutation:c,useGetSessionQuery:m,useCreateSnapshotMutation:p,useGetSnapshotQuery:h,useCancelSnapshotMutation:r,useUploadSnapshotMutation:g,useGetShapshotListQuery:y,useGetResourceDependenciesQuery:v,useGetCloudMigrationTokenQuery:x,useCreateCloudMigrationTokenMutation:f,useDeleteCloudMigrationTokenMutation:u,useGetDashboardByUidQuery:b,useGetLibraryElementByUidQuery:E}=o,D=o.injectEndpoints({endpoints:T=>({getLocalPluginList:T.query({queryFn:async()=>{try{return{data:await(0,n.Gd)()}}catch(O){return(0,a.s)(O)}}})})}).enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot","cloud-migration-resource-dependencies"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getResourceDependencies:{providesTags:["cloud-migration-resource-dependencies"]},getDashboardByUid:C,getLibraryElementByUid:C,getLocalPluginList:C}});function C(T){if(!T.query)return;const O=T.query;T.query=(...I)=>{const j=O(...I);return j.showErrorAlert=!1,j}}const{useGetLocalPluginListQuery:P}=D},93922:(Z,R,e)=>{"use strict";e.d(R,{EC:()=>i,L_:()=>o,YS:()=>l,bA:()=>d,wV:()=>c});var n=e(68143),a=e(6890),s=e(74396);function l(m={getBackendSrv:n.AI}){return async p=>{const h=await m.getBackendSrv().get("/api/org");return p((0,s.bK)(h)),h}}function o(m={getBackendSrv:n.AI}){return async(p,h)=>{const r=h().organization.organization;await m.getBackendSrv().put("/api/org",{name:r.name}),p((0,a.YA)(r.name)),p(l(m))}}function d(m,p={getBackendSrv:n.AI}){return async h=>{const r=await p.getBackendSrv().post("/api/user/using/"+m);h((0,a.YA)(r.name))}}function i(m,p={getBackendSrv:n.AI}){return async h=>{const r=await p.getBackendSrv().post("/api/orgs/",m);h(d(r.orgId))}}function c(m={getBackendSrv:n.AI}){return async p=>{const h=await m.getBackendSrv().get("/api/user/orgs");return p((0,s.Bz)(h)),h}}},74396:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>c,Bz:()=>d,bK:()=>o,n:()=>l});var n=e(65307);const a={organization:{},userOrgs:[]},s=(0,n.Z0)({name:"organization",initialState:a,reducers:{organizationLoaded:(m,p)=>({...m,organization:p.payload}),setOrganizationName:(m,p)=>({...m,organization:{...m.organization,name:p.payload}}),userOrganizationsLoaded:(m,p)=>({...m,userOrgs:p.payload})}}),{setOrganizationName:l,organizationLoaded:o,userOrganizationsLoaded:d}=s.actions,c={organization:s.reducer}},88642:(Z,R,e)=>{"use strict";e.d(R,{a:()=>T});var n=e(74848),a=e(22803),s=e(38919),l=e(1906),o=e(51898),d=e(92745),i=e(36490),c=e(36674),m=e(63142),p=e(64400),h=e(96540),r=e(30703);const g=h.forwardRef(({icon:j,children:W,onClick:B,...S},w)=>{const N=(0,m.of)(y);return(0,n.jsxs)("button",{...S,className:N.action,onClick:B,children:[(0,n.jsx)(r.I,{name:j,size:"xl"}),W]})});g.displayName="CardButton";const y=j=>({action:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:j.colors.background.secondary,borderRadius:j.shape.radius.default,color:j.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:j.colors.emphasize(j.colors.background.secondary)}})});var v=e(95943),x=e(29043),f=e(42795),u=e(62667),b=e(22429),E=e(72746),D=e(8285),C=e(52763),P=e(87390);function T(j){const W=(0,m.of)(I),B=(0,p.d2)(),S=new s.v2(j.data),{dataSummary:w}=S,N=O(j,w),M=(0,C.wA)(),L=window.__grafanaSceneContext;let A;L instanceof E.H$?A=(0,D.vL)(L,(0,D.XA)(j.panelId)):A=(0,b.UA)().getCurrent()?.getPanelById(j.panelId);const U=()=>{if(x.A.setObject(v.wV,u.__.Suggestions),L){L.state.editPanel?.state.optionsPane?.onToggleVizPicker();return}M((0,f.eK)(!0))},F=()=>{if(A){if(A instanceof c.Eb){A.changePluginType("table");return}M((0,P.gW)({panel:A,pluginId:"table"}))}},V=K=>{A&&(A instanceof c.Eb?A.changePluginType(K.pluginId,K.options,K.fieldConfig):M((0,P.gW)({...K,panel:A})),K.transformations&&setTimeout(()=>{i.Ny.partial({tab:"transform"})},100))};return(0,n.jsxs)("div",{className:W.wrapper,children:[(0,n.jsx)("div",{className:W.message,"data-testid":o.Tp.components.Panels.Panel.PanelDataErrorMessage,children:N}),B.app===l.Jk.PanelEditor&&w.hasData&&A&&(0,n.jsxs)("div",{className:W.actions,children:[j.suggestions&&(0,n.jsx)(n.Fragment,{children:j.suggestions.map(K=>(0,n.jsx)(g,{icon:"process",onClick:()=>V(K),children:K.name},K.name))}),(0,n.jsx)(g,{icon:"table",onClick:F,children:(0,n.jsx)(d.x6,{i18nKey:"panel.panel-data-error-view.switch-to-table",children:"Switch to table"})}),(0,n.jsx)(g,{icon:"chart-line",onClick:U,children:(0,n.jsx)(d.x6,{i18nKey:"panel.panel-data-error-view.open-visualization-suggestions",children:"Open visualization suggestions"})})]})]})}function O({data:j,fieldConfig:W,message:B,needsNumberField:S,needsTimeField:w,needsStringField:N},M){return B||(!j.series||j.series.length===0||j.series.every(L=>L.length===0)?W?.defaults.noValue??(0,d.t)("panel.panel-data-error-view.no-value.default","No data"):N&&!M.hasStringField?(0,d.t)("panel.panel-data-error-view.missing-value.string","Data is missing a string field"):S&&!M.hasNumberField?(0,d.t)("panel.panel-data-error-view.missing-value.number","Data is missing a number field"):w&&!M.hasTimeField?(0,d.t)("panel.panel-data-error-view.missing-value.time","Data is missing a time field"):(0,d.t)("panel.panel-data-error-view.missing-value.unknown","Cannot visualize data"))}const I=j=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,a.css)({textAlign:"center",color:j.colors.text.secondary,fontSize:j.typography.size.lg,width:"100%"}),actions:(0,a.css)({marginTop:j.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:j.spacing(1),rowGap:j.spacing(1),width:"100%",maxWidth:"600px"})})},41097:(Z,R,e)=>{"use strict";e.d(R,{$:()=>h,W:()=>p});var n=e(74848),a=e(96540),s=e(16207),l=e(11594),o=e(92745),d=e(34999),i=e(96221),c=e(42581);class m extends a.PureComponent{constructor(g){super(g)}render(){const g={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,n.jsx)("div",{style:g,children:(0,n.jsx)(d.F,{severity:i.Qd.Error,...this.props})})}}function p(r,g){const y=class extends a.PureComponent{render(){const f=(0,n.jsxs)(o.x6,{i18nKey:"panel.panel-plugin-error.text-load-error",children:["Check the server startup logs for more information. ",(0,n.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,n.jsx)(m,{title:(0,o.t)("panel.panel-plugin-error.title-load-error","Error loading: {{panelId}}",{panelId:r.id}),text:f})}},v=new s.m(y);return v.meta=r,v.loadError=!0,v}function h(r,g){const y=class extends a.PureComponent{render(){return(0,n.jsx)(m,{title:(0,o.t)("panel.panel-plugin-error.title-not-found","Panel plugin not found: {{id}}",{id:r})})}},v=new s.m(g?()=>null:y);return v.meta={id:r,name:r,sort:100,type:l.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:c},screenshots:[],updated:"",version:""}},v}},35307:(Z,R,e)=>{"use strict";e.d(R,{m:()=>v});var n=e(74848),a=e(96540),s=e(60188),l=e(60519),o=e(20877),d=e(69168),i=e(92745),c=e(2863),m=e(63142),p=e(64400),h=e(36303),r=e(73427),g=e(92391);const y={defaults:{},overrides:[]};function v(f){const{pluginId:u,data:b,timeZone:E=(0,s.O)(),options:D={},width:C,height:P,title:T,onOptionsChange:O=()=>{},onChangeTimeRange:I=()=>{},onFieldConfigChange:j=()=>{},fieldConfig:W=y}=f,B=(0,m.$j)(),S=(0,c.w)(),w=(0,a.useMemo)(()=>S.replace.bind(S),[S]),[N,M]=(0,a.useState)((0,g.PY)(u)),[L,A]=(0,a.useState)(),U=x(N,D,W),{dataLinkPostProcessor:F}=(0,p.d2)(),V=(0,l.rJ)(N,U?.fieldConfig,b,E,B,w,F);if((0,a.useEffect)(()=>{N&&N.hasPluginId(u)||(0,g.TV)(u).then(G=>M(G)).catch(G=>{A(G.message)})},[u,N]),L)return(0,n.jsx)("div",{children:(0,n.jsxs)(i.x6,{i18nKey:"panel.panel-renderer.failed-to-load-plugin",children:["Failed to load plugin: ",{error:L}]})});if(!N||!N.hasPluginId(u))return(0,n.jsx)("div",{children:(0,n.jsx)(i.x6,{i18nKey:"panel.panel-renderer.loading-plugin-panel",children:"Loading plugin panel..."})});if(!N.panel)return(0,n.jsx)("div",{children:(0,n.jsx)(i.x6,{i18nKey:"panel.panel-renderer.no-panel-component",children:"Seems like the plugin you are trying to load does not have a panel component."})});if(!V)return(0,n.jsx)("div",{children:(0,n.jsx)(i.x6,{i18nKey:"panel.panel-renderer.no-panel-data",children:"No panel data"})});const K=N.panel;return(0,n.jsx)(h.Xw,{dependencies:[N,b],children:(0,n.jsx)(o.a,{meta:N.meta,children:(0,n.jsx)(K,{id:1,data:V,title:T,timeRange:V.timeRange,timeZone:E,options:U.options,fieldConfig:W,transparent:!1,width:C,height:P,renderCounter:0,replaceVariables:G=>G,onOptionsChange:O,onFieldConfigChange:j,onChangeTimeRange:I,eventBus:r.lE})})})}function x(f,u,b){return(0,a.useMemo)(()=>{if(f)return(0,d.F)({plugin:f,currentOptions:u,currentFieldConfig:b,isAfterPluginChange:!1})},[f,b,u])}},54044:(Z,R,e)=>{"use strict";e.d(R,{b:()=>x});var n=e(74848),a=e(22803),s=e(70255),l=e(11594),o=e(29246),d=e(51898),i=e(92745),c=e(63142),m=e(76319),p=e(63509),h=e(21348),r=e(85622);const g=38,y=({isCurrent:E,title:D,plugin:C,onClick:P,onDelete:T,disabled:O,showBadge:I,description:j,children:W})=>{const B=(0,c.of)(u),S=O||C.state===l.pn.deprecated,w=(0,a.cx)({[B.item]:!0,[B.itemDisabled]:S,[B.current]:E});return(0,n.jsxs)("div",{className:w,"aria-label":d.Tp.components.PluginVisualization.item(C.name),"data-testid":d.Tp.components.PluginVisualization.item(C.name),onClick:S?void 0:P,title:E?(0,i.t)("panel.panel-type-card.title-click-to-close","Click again to close this section"):C.name,children:[(0,n.jsx)("img",{className:(0,a.cx)(B.img,{[B.disabled]:S}),src:C.info.logos.small,alt:""}),(0,n.jsxs)("div",{className:(0,a.cx)(B.itemContent,{[B.disabled]:S}),children:[(0,n.jsx)("div",{className:B.name,children:D}),j?(0,n.jsx)("span",{className:B.description,children:j}):null,W]}),I&&(0,n.jsx)("div",{className:(0,a.cx)(B.badge,{[B.disabled]:S}),children:(0,n.jsx)(b,{plugin:C})}),T&&(0,n.jsx)(m.K,{name:"trash-alt",onClick:N=>{N.stopPropagation(),T()},className:B.deleteButton,"aria-label":(0,i.t)("panel.panel-type-card.aria-label-delete-button-on-panel-type-card","Delete button on panel type card"),tooltip:(0,i.t)("panel.panel-type-card.tooltip-delete","Delete")})]})};y.displayName="PanelTypeCard";const v=({children:E,hasDescription:D,hasDelete:C,rootProps:P})=>{const T=(0,c.of)(u),O=(0,c.of)(f);return(0,n.jsxs)("div",{className:T.item,...P,children:[(0,n.jsx)(s.A,{className:(0,a.cx)(T.img,O.image),width:g,height:g}),(0,n.jsxs)("div",{className:T.itemContent,children:[(0,n.jsx)("div",{className:T.name,children:(0,n.jsx)(s.A,{width:160})}),D?(0,n.jsx)(s.A,{containerClassName:T.description,width:80}):null,E]}),C&&(0,n.jsx)(s.A,{containerClassName:(0,a.cx)(T.deleteButton,O.deleteButton),width:16,height:16})]})},x=(0,h.j)(y,v),f=()=>({deleteButton:(0,a.css)({lineHeight:1}),image:(0,a.css)({lineHeight:1})}),u=E=>({item:(0,a.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:E.colors.background.secondary,borderRadius:E.shape.radius.default,boxShadow:E.shadows.z1,border:`1px solid ${E.colors.background.secondary}`,alignItems:"center",padding:E.spacing(1),width:"100%",overflow:"hidden",[E.transitions.handleMotion("no-preference","reduce")]:{transition:E.transitions.create(["background"],{duration:E.transitions.duration.short})},"&:hover":{background:E.colors.emphasize(E.colors.background.secondary,.03)}}),itemContent:(0,a.css)({overflow:"hidden",position:"relative",padding:E.spacing(0,1)}),itemDisabled:(0,a.css)({cursor:"default","&, &:hover":{background:E.colors.action.disabledBackground}}),current:(0,a.css)({label:"currentVisualizationItem",border:`1px solid ${E.colors.primary.border}`,background:E.colors.action.selected}),disabled:(0,a.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,a.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:E.typography.size.sm,fontWeight:E.typography.fontWeightMedium,width:"100%"}),description:(0,a.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:E.colors.text.secondary,fontSize:E.typography.bodySmall.fontSize,fontWeight:E.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,a.css)({maxHeight:g,width:g,display:"flex",alignItems:"center"}),badge:(0,a.css)({background:E.colors.background.primary}),deleteButton:(0,a.css)({cursor:"pointer",marginLeft:"auto"})}),b=({plugin:E})=>(0,o.x)(E.signature)?(0,n.jsx)(p.B,{status:E.signature}):(0,n.jsx)(r.p,{state:E.state});b.displayName="PanelPluginBadge"},82472:(Z,R,e)=>{"use strict";e.d(R,{a:()=>E});var n=e(74848),a=e(22803),s=e(96540),l=e(16817),o=e(70713),d=e(92745),i=e(63142),c=e(38919),m=e(43173),p=e(92391);const h=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function r(P,T){const O=new c.v2(P,T);for(const j of h){const B=(await(0,p.TV)(j)).getSuggestionsSupplier();B&&B.getSuggestionsForData(O)}const I=O.getList();if(O.dataSummary.fieldCount===0)for(const j of Object.values(m.$.panels))!j.skipDataQuery||j.hideFromList||I.push({name:j.name,pluginId:j.id,description:j.info.description,cardOptions:{imgSrc:j.info.logos.small}});return I.sort((j,W)=>{if(O.dataSummary.preferredVisualisationType){if(j.pluginId===O.dataSummary.preferredVisualisationType)return-1;if(W.pluginId===O.dataSummary.preferredVisualisationType)return 1}return(W.score??c.nQ.OK)-(j.score??c.nQ.OK)})}var g=e(2543),y=e(51898),v=e(45967),x=e(35307);function f({data:P,suggestion:T,onChange:O,width:I}){const j=(0,i.of)(u),{innerStyles:W,outerStyles:B,renderWidth:S,renderHeight:w}=b(I),N=T.cardOptions??{},M={"aria-label":T.name,className:j.vizBox,"data-testid":y.Tp.components.VisualizationPreview.card(T.name),style:B,onClick:()=>{O({pluginId:T.pluginId,options:T.options,fieldConfig:T.fieldConfig})}};if(N.imgSrc)return(0,n.jsx)(v.m,{content:T.description??T.name,children:(0,n.jsxs)("button",{...M,className:(0,a.cx)(j.vizBox,j.imgBox),children:[(0,n.jsx)("div",{className:j.name,children:T.name}),(0,n.jsx)("img",{className:j.img,src:N.imgSrc,alt:T.name})]})});let L=T;return T.cardOptions?.previewModifier&&(L=(0,g.cloneDeep)(T),T.cardOptions.previewModifier(L)),(0,n.jsx)("button",{...M,children:(0,n.jsx)(v.m,{content:T.name,children:(0,n.jsxs)("div",{style:W,className:j.renderContainer,children:[(0,n.jsx)(x.m,{title:"",data:P,pluginId:T.pluginId,width:S,height:w,options:L.options,fieldConfig:L.fieldConfig}),(0,n.jsx)("div",{className:j.hoverPane})]})})})}const u=P=>({hoverPane:(0,a.css)({position:"absolute",top:0,right:0,left:0,borderRadius:P.spacing(2),bottom:0}),vizBox:(0,a.css)({position:"relative",background:"none",borderRadius:P.shape.radius.default,cursor:"pointer",border:`1px solid ${P.colors.border.medium}`,[P.transitions.handleMotion("no-preference","reduce")]:{transition:P.transitions.create(["background"],{duration:P.transitions.duration.short})},"&:hover":{background:P.colors.background.secondary}}),imgBox:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",color:P.colors.text.primary,width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"}),name:(0,a.css)({paddingBottom:P.spacing(.5),marginTop:P.spacing(-1),fontSize:P.typography.bodySmall.fontSize,whiteSpace:"nowrap",overflow:"hidden",color:P.colors.text.secondary,fontWeight:P.typography.fontWeightMedium,textOverflow:"ellipsis"}),img:(0,a.css)({maxWidth:P.spacing(8),maxHeight:P.spacing(8)}),renderContainer:(0,a.css)({position:"absolute",transformOrigin:"left top",top:"6px",left:"6px"})});function b(P){const O=P,I=P*(1/1.6),j=350,W=j*(1/1.6),B=6,S=(O-B*2)/j,w=(I-B*2)/W;return{renderHeight:W,renderWidth:j,outerStyles:{width:O,height:I},innerStyles:{width:j,height:W,transform:`scale(${S}, ${w})`}}}function E({searchQuery:P,onChange:T,data:O,panel:I,trackSearch:j}){const W=(0,i.of)(C),{value:B}=(0,l.A)(()=>r(O,I),[O,I]),S=(0,s.useMemo)(()=>{const w=D(P,B);return j&&j(P,w.length),w},[P,B,j]);return(0,n.jsx)("div",{children:(0,n.jsx)(o.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:w})=>{if(!w)return null;w=w-1;const N=Math.floor(w/200),M=8*(N-1),L=Math.floor((w-M)/N);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:W.filterRow,children:(0,n.jsx)("div",{className:W.infoText,children:(0,n.jsx)(d.x6,{i18nKey:"panel.visualization-suggestions.based-on-current-data",children:"Based on current data"})})}),(0,n.jsxs)("div",{className:W.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${L}px)`},children:[S.map((A,U)=>(0,n.jsx)(f,{data:O,suggestion:A,onChange:T,width:L-1},U)),P&&S.length===0&&(0,n.jsx)("div",{className:W.infoText,children:(0,n.jsx)(d.x6,{i18nKey:"panel.visualization-suggestions.no-results-matched-your-query",children:"No results matched your query"})})]})]})}})})}function D(P,T){if(!P||!T)return T||[];const O=new RegExp(P,"i");return T.filter(I=>O.test(I.name)||O.test(I.pluginId))}const C=P=>({heading:(0,a.css)({...P.typography.h5,margin:P.spacing(0,.5,1)}),filterRow:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,a.css)({fontSize:P.typography.bodySmall.fontSize,color:P.colors.text.secondary,fontStyle:"italic"}),grid:(0,a.css)({display:"grid",gridGap:P.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:P.spacing(1),justifyContent:"space-evenly"})})},72165:(Z,R,e)=>{"use strict";e.d(R,{G:()=>p});var n=e(74848),a=e(22803),s=e(96540),l=e(92745),o=e(63142),d=e(74451),i=e(52193),c=e(54044);const m=({isCurrent:r,plugin:g,onClick:y,disabled:v})=>(0,n.jsx)(c.b,{title:g.name,plugin:g,description:g.info.description,onClick:y,isCurrent:r,disabled:v,showBadge:!0});m.displayName="VizTypePickerPlugin";function p({pluginId:r,searchQuery:g,onChange:y,trackSearch:v}){const x=(0,o.of)(h),f=(0,s.useMemo)(i.A4,[]),u=(0,s.useMemo)(()=>{const b=(0,i.CO)(f,g,r);return v&&v(g,b.length),b},[f,g,r,v]);return u.length===0?(0,n.jsx)(d.Z,{children:(0,n.jsx)(l.x6,{i18nKey:"panel.viz-type-picker.could-anything-matching-query",children:"Could not find anything matching your query"})}):(0,n.jsx)("div",{className:x.grid,children:u.map(b=>(0,n.jsx)(m,{disabled:!1,isCurrent:b.id===r,plugin:b,onClick:E=>y({pluginId:b.id,withModKey:E.metaKey||E.ctrlKey||E.altKey})},b.id))})}const h=r=>({grid:(0,a.css)({maxWidth:"100%",display:"grid",gridGap:r.spacing(.5)}),heading:(0,a.css)({...r.typography.h5,margin:r.spacing(0,.5,1)})})},302:(Z,R,e)=>{"use strict";e.d(R,{CH:()=>o,E7:()=>l});var n=e(1682),a=e(82345);const s=d=>{const i=d.field.links;if(!(!i||i.length===0))return{getLinks:c=>{const m={};if(d.view){const{dataFrame:h}=d.view;m.__series={value:{name:h.name,refId:h.refId},text:t("panel.get-field-links-supplier.text.series","Series")};const r=d.colIndex!==void 0?h.fields[d.colIndex]:void 0;if(r){if(m.__field={value:{name:r.name,labels:r.labels},text:t("panel.get-field-links-supplier.text.field","Field")},d.rowIndex!==void 0&&d.rowIndex>=0){const{timeField:g}=getTimeField(h);m.__value={value:{raw:r.values[d.rowIndex],numeric:d.display.numeric,text:formattedValueToString(d.display),time:g?g.values[d.rowIndex]:void 0},text:t("panel.get-field-links-supplier.text.value","Value")}}d.view&&(m.__data={value:{name:h.name,refId:h.refId,fields:getFieldDisplayValuesProxy({frame:h,rowIndex:d.rowIndex})},text:t("panel.get-field-links-supplier.text.data","Data")})}else m.__value={value:{raw:d.display.numeric,numeric:d.display.numeric,text:formattedValueToString(d.display),calc:d.name},text:t("panel.get-field-links-supplier.text.value","Value")}}else console.log("VALUE",d);const p=(h,r,g)=>{const y={...m,...r};return c(h,y,g)};return i.map(h=>getLinkSrv().getDataLinkUIModel(h,p,d))}}},l=(d,i)=>{const c=d.links;if(!(!c||c.length===0))return{getLinks:()=>c.map(m=>(0,a.mQ)().getDataLinkUIModel(m,i||d.replaceVariables,d))}},o=(d,i)=>{const c=n.b4.getPanelLinks(d)?.state.rawLinks;if(!(!c||c.length===0))return{getLinks:()=>c.map(m=>(0,a.mQ)().getDataLinkUIModel(m,i,d))}}},82345:(Z,R,e)=>{"use strict";e.d(R,{Fq:()=>b,Hf:()=>C,mQ:()=>j});var n=e(2543),a=e.n(n),s=e(38036),l=e(79609),o=e(16515),d=e(95004),i=e(92138),c=e(63704),m=e(83175),p=e(37615),h=e(92745),r=e(2863),g=e(739),y=e(65642);const v=[{value:`${s.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:l.$0.BuiltIn},{value:`${s.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:l.$0.BuiltIn},{value:`${s.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:l.$0.BuiltIn}],x=[{value:`${s.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:l.$0.Series}],f=[{value:`${s.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:l.$0.Value},{value:`${s.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:l.$0.Value},{value:`${s.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:l.$0.Value}],u=W=>W.includes(".")||W.trim().includes(" ")?`["${W}"]`:`.${W}`,b=()=>[...(0,r.w)().getVariables().map(W=>({value:W.name,label:W.name,origin:l.$0.Template})),{value:`${s.c.includeVars}`,label:(0,h.t)("panel.get-panel-links-variable-suggestions.label.all-variables","All variables"),documentation:"Adds current variables",origin:l.$0.Template},...v],E=W=>{const B=[];for(const w of W)for(const N of w.fields)if(N.labels)for(const M of Object.keys(N.labels))B.push(M);const S=(0,n.chain)(B).flatten().uniq().value();return[{value:`${s.c.fieldName}`,label:(0,h.t)("panel.get-field-vars.label.name","Name"),documentation:"Field name of the clicked datapoint (in ms epoch)",origin:l.$0.Field},...S.map(w=>({value:`__field.labels${u(w)}`,label:`labels.${w}`,documentation:`${w} label value`,origin:l.$0.Field}))]},D=W=>{let B,S;const w=[],N={};if(W.length!==1)return[];const M=W[0];for(const L of M.fields){const A=(0,o.Ct)(L,M,W);N[A]||(w.push({value:`__data.fields${u(A)}`,label:`${A}`,documentation:`Formatted value for ${A} on the same row`,origin:l.$0.Fields}),N[A]=!0,!B&&L.type===d.PU.number&&(B={...L,name:A}),!S&&L.config.displayName&&L.config.displayName!==L.name&&(S={...L,name:A}))}return w.length&&w.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:l.$0.Fields}),B&&(w.push({value:`__data.fields${u(B.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:l.$0.Fields}),w.push({value:`__data.fields${u(B.name)}.text`,label:"Show text value",documentation:"the text value",origin:l.$0.Fields})),S&&w.push({value:`__data.fields${u(S.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:l.$0.Fields}),w},C=(W,B)=>{const S={value:`${s.c.valueTime}`,label:(0,h.t)("panel.get-data-links-variable-suggestions.value-time-var.label.time","Time"),documentation:"Time value of the clicked datapoint (in ms epoch)",origin:l.$0.Value};return B===l.uP.Values?[...x,...E(W),...f,S,...D(W),...b()]:[...x,...E(W),...D(W),...b()]},P=W=>{const B=E(W),S={value:`${DataLinkBuiltInVars.valueCalc}`,label:t("panel.get-calculation-value-data-links-variable-suggestions.value-calc-var.label.calculation-name","Calculation name"),documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...x,...B,...f,S,...b()]};class T{constructor(){this.getDataLinkUIModel=(B,S,w)=>{let N=B.url;B.onBuildUrl&&(N=B.onBuildUrl({origin:w,replaceVariables:S}));const M={href:i.I.assureBaseUrl(N.replace(/\n/g,"")),title:B.title??"",target:B.targetBlank!==void 0?B.targetBlank?"_blank":"_self":void 0,origin:w};return S&&(M.href=S(M.href,void 0,g.$m.UriEncode),M.title=S(B.title)),B.onClick&&(M.onClick=L=>{B.onClick({origin:w,replaceVariables:S,e:L})}),M.href=(0,y.zj)().disableSanitizeHtml?M.href:c.sQ.sanitizeUrl(M.href),M}}getLinkUrl(B){let S=B.url??"";return B.keepTime&&(S=m.kM.appendQueryToUrl(S,`$${s.c.keepTime}`)),B.includeVars&&(S=m.kM.appendQueryToUrl(S,`$${s.c.includeVars}`)),S=(0,r.w)().replace(S),S=i.I.assureBaseUrl(S),(0,y.zj)().disableSanitizeHtml?S:c.sQ.sanitizeUrl(S)}getAnchorInfo(B){const S=(0,r.w)();return{href:this.getLinkUrl(B),title:S.replace(B.title||""),tooltip:S.replace(B.tooltip||"")}}getPanelLinkAnchorInfo(B,S){(0,p.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const w=(N,M,L)=>(0,r.w)().replace(N,{...S,...M},L);return this.getDataLinkUIModel(B,w,{})}}let O;function I(W){O=W}function j(){return O||(O=new T),O}},87390:(Z,R,e)=>{"use strict";e.d(R,{Ap:()=>i,O6:()=>c,Xk:()=>p,gW:()=>m});var n=e(69168),a=e(30124),s=e(41097),l=e(37256),o=e(87745),d=e(89224);function i(r){return async(g,y)=>{if(r.libraryPanel?.uid&&!("model"in r.libraryPanel)){g(h(r));return}r.maxDataPoints&&(r.maxDataPoints=Number(r.maxDataPoints));let v=r.type,x=y().plugins.panels[v];if(!x)try{x=await g((0,l.y7)(v))}catch{x=(0,s.$)(v,v==="row")}r.plugin||await r.pluginLoaded(x),g((0,d.XM)({key:r.key,plugin:x}))}}function c(r){return g=>{g((0,d.FC)({key:r}))}}function m({panel:r,pluginId:g,options:y,fieldConfig:v,transformations:x}){return async(f,u)=>{if(r.type===g&&!y&&!v&&!x)return;let E=u().plugins.panels[g];if(E||(E=await f((0,l.y7)(g))),r.type!==g&&r.changePlugin(E),y||v||x){const D=(0,n.F)({plugin:E,currentOptions:y||r.options,currentFieldConfig:v||r.fieldConfig,isAfterPluginChange:!1});r.options=D.options,r.fieldConfig=D.fieldConfig,r.transformations=x||r.transformations,r.configRev++}r.generateNewKey(),f((0,d.XM)({key:r.key,plugin:E}))}}function p(r,g){return async(y,v)=>{const x=g.model.type,f=r.type;if(r.restoreModel({...g.model,gridPos:r.gridPos,id:r.id,libraryPanel:g}),r.getQueryRunner().clearLastResult(),f!==x){let b=v().plugins.panels[x];b||(b=await y((0,l.y7)(x))),await r.pluginLoaded(b),r.generateNewKey(),await y((0,d.XM)({key:r.key,plugin:b}))}else{const u=r.key;r.generateNewKey(),y((0,d.io)({oldKey:u,newKey:r.key}))}r.configRev=0,r.hasSavedPanelEditChange=!0,r.refresh(),r.events.publish(o.zq),r.events.publish(o.PR)}}function h(r){return async(g,y)=>{const v=r.libraryPanel.uid;try{const x=await(0,a.Yr)(v,!0);r.initLibraryPanel(x);const f=y().dashboard.getModel();if(r.repeat&&f){const u=f.panels.findIndex(b=>b.id===r.id);f.repeatPanel(r,u),f.sortPanelsByGridPos(),f.events.publish(new o.Q$)}await g(i(r))}catch(x){console.log("ERROR: ",x),g((0,d.XM)({key:r.key,plugin:(0,s.$)("Unable to load library panel: "+v,!1)}))}}}},89224:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>p,FC:()=>i,XM:()=>l,io:()=>d,nF:()=>o,rG:()=>c});var n=e(65307);const a={},s=(0,n.Z0)({name:"panels",initialState:a,reducers:{panelModelAndPluginReady:(h,r)=>{h[r.payload.key]={plugin:r.payload.plugin}},changePanelKey:(h,r)=>{h[r.payload.newKey]=h[r.payload.oldKey],delete h[r.payload.oldKey]},removePanel:(h,r)=>{delete h[r.payload.key]},removeAllPanels:h=>{Object.keys(h).forEach(r=>delete h[r])},setPanelInstanceState:(h,r)=>{h[r.payload.key].instanceState=r.payload.value}}}),{panelModelAndPluginReady:l,setPanelInstanceState:o,changePanelKey:d,removePanel:i,removeAllPanels:c}=s.actions,p={panels:s.reducer}},52193:(Z,R,e)=>{"use strict";e.d(R,{A4:()=>l,CO:()=>i});var n=e(11594),a=e(8934),s=e(65642);function l(){const c=s.$W.panels;return Object.keys(c).filter(m=>c[m].hideFromList===!1).map(m=>c[m]).sort((m,p)=>m.sort-p.sort)}function o(){return l().filter(c=>!!c.skipDataQuery)}function d(){return l().filter(c=>!c.skipDataQuery)}function i(c,m,p){if(!m.length)return c.filter(v=>v.state===n.pn.deprecated?p===v.id:!0);const h=(0,a.xb)(m).toLowerCase(),r=[],g=[],y="graph".startsWith(h);for(const v of c){if(v.state===n.pn.deprecated&&p!==v.id)continue;const f=v.name.toLowerCase().indexOf(h);f===0?r.push(v):f>0?g.push(v):y&&v.id==="timeseries"&&r.push(v)}return r.concat(g)}},4590:(Z,R,e)=>{"use strict";e.d(R,{_o:()=>h});var n=e(2543),a=e.n(n),s=e(92138),l=e(83175),o=e(17548),d=e(36490),i=e(5114),c=e(18984);const m={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class p extends i.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this)}navigateToDashboard(g=!1){const y=this.urls[this.index],v=d.Ny.getSearchObject(),x=(0,n.pickBy)(v,(b,E)=>m[E]),f=s.I.stripBaseFromUrl(y);this.index++,this.validPlaylistUrl=f,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval);const u=f+"?"+l.kM.toUrlParams(x);g?d.Ny.getHistory().replace(u):d.Ny.push(u)}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}this.navigateToDashboard()}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(g){g.pathname!==this.validPlaylistUrl&&this.stop()}async start(g){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=d.Ny.getHistory().listen(this.locationUpdated);const y=[];if(!g.spec.items?.length)return;this.interval=o.intervalToMs(g.spec.interval);const v=await(0,c.qY)(g.spec.items);for(const x of v)if(x.dashboards)for(const f of x.dashboards)y.push(f.url);y.length&&(this.urls=y,this.setState({isPlaying:!0}),this.navigateToDashboard(!0))}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),d.Ny.getSearchObject().kiosk&&d.Ny.partial({kiosk:null}))}}const h=new p},18984:(Z,R,e)=>{"use strict";e.d(R,{GM:()=>m,aV:()=>c,qY:()=>i});var n=e(75505),a=e(88673),s=e(43173),l=e(16310),o=e(8095),d=e(55860);async function i(p){let h=0;if(!p?.length)return[];const r=[];for(const v of p){const x={query:"*",kind:["dashboard"],limit:1e3};switch(v.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":x.uid=[v.value];break;case"dashboard_by_tag":x.tags=[v.value];break}r.push({refId:`${h++}`,queryType:o.nj.Search,search:x})}if(!s.$.featureToggles.panelTitleSearch){const v=(0,d.S)(),x=[];for(let f=0;f<r.length;f++){const u=(await v.search(r[f].search)).view;x.push({...p[f],dashboards:u.map(b=>({...b}))})}return x}const g=await(0,l.o)(),y=await(0,n.s)(g.query({targets:r}));if(y.data.length!==p.length)throw new Error("unexpected result size");return p.map((v,x)=>{const f=new a.R(y.data[x]);return{...v,dashboards:f.map(u=>({...u}))}})}function c(){return{spec:{items:[],interval:"5m",title:""},metadata:{name:""},status:{}}}function m(p,h){return h?.length?(h=h.toLowerCase(),p.filter(r=>r.spec.title.toLowerCase().includes(h))):p}},59253:(Z,R,e)=>{"use strict";e.d(R,{Ap:()=>y,Bj:()=>c,CB:()=>d,Gd:()=>g,T_:()=>i,XP:()=>v,cu:()=>f,ij:()=>u,xZ:()=>x});var n=e(67458),a=e(68143),s=e(81871),l=e(95256),o=e(4476);async function d(E){const D=await m(E),C=!!D,[P,T,O,I]=await Promise.all([g(),p(E,C),h(E),r(E)]),j=P.find(B=>B.id===E),W=j?.dependencies||D?.json?.dependencies;return{grafanaDependency:W?.grafanaDependency??W?.grafanaVersion??"",pluginDependencies:W?.plugins||[],links:j?.info.links||D?.json?.info.links||[],readme:O||D?.readme,versions:T,statusContext:D?.statusContext??"",iam:D?.json?.iam,lastCommitDate:D?.lastCommitDate,changelog:D?.changelog||I,licenseUrl:D?.licenseUrl,documentationUrl:D?.documentationUrl,sponsorshipUrl:D?.sponsorshipUrl,repositoryUrl:D?.repositoryUrl,raiseAnIssueUrl:D?.raiseAnIssueUrl,signatureType:j?.signatureType||(D?.signatureType!==""?D?.signatureType:void 0),signature:j?.signature,screenshots:D?.json?.info.screenshots||j?.info.screenshots}}async function i(){try{const{items:E}=await(0,a.AI)().get(`${l.P5}/plugins`,{includeDeprecated:!0});return E.filter(o.hY)}catch(E){if((0,a.NF)(E))return E.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw E}}async function c(){try{return await(0,a.AI)().get(`${l.Sw}/errors`)}catch{return[]}}async function m(E){try{return await(0,a.AI)().get(`${l.P5}/plugins/${E}`,{})}catch(D){(0,a.NF)(D)&&(D.isHandled=!0);return}}async function p(E,D){try{return D?((await(0,a.AI)().get(`${l.P5}/plugins/${E}/versions`)).items||[]).map(P=>({version:P.version,createdAt:P.createdAt,updatedAt:P.updatedAt,isCompatible:P.isCompatible,grafanaDependency:P.grafanaDependency,angularDetected:P.angularDetected})):[]}catch(C){return(0,a.NF)(C)&&(C.isHandled=!0),[]}}async function h(E){try{const D=await(0,a.AI)().get(`${l.Sw}/${E}/markdown/README`);return D?(0,n.G)(D):""}catch(D){return(0,a.NF)(D)&&(D.isHandled=!0),""}}async function r(E){try{const D=await(0,a.AI)().get(`${l.Sw}/${E}/markdown/CHANGELOG`);return D?(0,n.G)(D):""}catch(D){return(0,a.NF)(D)&&(D.isHandled=!0),""}}async function g(){return(await(0,a.AI)().get(`${l.Sw}`,(0,s.F)({embedded:0}))).filter(o.Sq)}async function y(){const{items:E}=await(0,a.AI)().get(`${l.Mi}/plugins`);return E}async function v(){const{items:E}=await(0,a.AI)().get(`${l.Mi}/provisioned-plugins`);return E.map(D=>({slug:D.type}))}async function x(E,D){return await(0,a.AI)().post(`${l.Sw}/${E}/install`,{version:D},{showErrorAlert:!1})}async function f(E){return await(0,a.AI)().post(`${l.Sw}/${E}/uninstall`)}async function u(E,D){return(await(0,a.AI)().datasourceRequest({url:`/api/plugins/${E}/settings`,method:"POST",data:D}))?.data}const b={getRemotePlugins:i,getInstalledPlugins:g,installPlugin:x,uninstallPlugin:f}},40203:(Z,R,e)=>{"use strict";e.d(R,{G:()=>l});var n=e(74848),a=e(22803),s=e(63142);const l=({children:d,wrap:i,className:c})=>{const m=(0,s.$j)(),p=o(m,i);return(0,n.jsx)("div",{className:(0,a.cx)(p.container,c),children:d})},o=(d,i)=>({container:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:i?"wrap":"nowrap","& > *":{marginBottom:d.spacing(),marginRight:d.spacing()},"& > *:last-child":{marginRight:0}})})},55767:(Z,R,e)=>{"use strict";e.d(R,{S1:()=>T,QD:()=>P});var n=e(74848),a=e(22803),s=e(96540),l=e(43173),o=e(63142),d=e(34999),i=e(41654),c=e(11594),m=e(41607),p=e(92745),h=e(62061),r=e(45861),g=e(89640),y=e(73427),v=e(11257),x=e(4476),f=e(23691),u=e(13660);const b=({plugin:I,pluginStatus:j,latestCompatibleVersion:W})=>{const B=(0,o.of)(E),S=l.$.pluginAdminExternalManageEnabled,w=y.TP.hasPermission(v.w.PluginsInstall),N=(0,f.pw)(),M=!!W;if(I.type===c.QE.renderer)return(0,n.jsx)(d.F,{severity:"warning",title:(0,p.t)("plugins.install-controls-warning.title-renderer-plugins-cannot-managed-plugin-catalog","Renderer plugins cannot be managed by the Plugin Catalog."),className:B.alert});const L=l.$.buildInfo.edition===m.r.OpenSource,A=l.$.buildInfo.edition===m.r.Enterprise;if(I.isEnterprise&&!(0,h.a)("enterprise.plugins")){const U=L?"info":"warning";return(0,n.jsx)(d.F,{severity:U,title:"",className:B.alert,children:(0,n.jsxs)(i.B,{direction:"row",alignItems:"center",children:[(0,n.jsxs)("span",{children:[L&&(0,n.jsx)(p.x6,{i18nKey:"plugins.install-controls-warning.enterprise-plugin-info",children:"This plugin is only available in Grafana Cloud and Grafana Enterprise."}),A&&(0,n.jsx)(p.x6,{i18nKey:"plugins.install-controls-warning.no-valid-grafana-enterprise-license-detected",children:"No valid Grafana Enterprise license detected."})]}),(0,n.jsx)(r.z9,{href:`${(0,x.H2)(I.id)}?utm_source=grafana_catalog_learn_more`,target:"_blank",rel:"noopener noreferrer",size:"sm",fill:"text",icon:"external-link-alt",children:(0,n.jsx)(p.x6,{i18nKey:"plugins.install-controls-warning.learn-more",children:"Learn more"})})]})})}return I.isDev?(0,n.jsx)(d.F,{severity:"warning",title:(0,p.t)("plugins.install-controls-warning.title-dev-alert","This is a development build of the plugin and can't be uninstalled."),className:B.alert}):!w&&!S?(0,n.jsx)(d.F,{severity:"warning",title:D(j),className:B.alert}):I.isPublished?M?N?null:(0,n.jsx)(d.F,{severity:"warning",title:(0,p.t)("plugins.install-controls-warning.title-remote-plugins-unavailable","The install controls have been disabled because the Grafana server cannot access grafana.com."),className:B.alert}):(0,n.jsx)(d.F,{severity:"warning",title:(0,p.t)("plugins.install-controls-warning.title-plugin-doesnt-support-version-grafana","This plugin doesn't support your version of Grafana."),className:B.alert}):(0,n.jsx)(d.F,{severity:"warning",title:"",className:B.alert,children:(0,n.jsx)("div",{children:(0,n.jsxs)(p.x6,{i18nKey:"plugins.install-controls-warning.body-not-published",children:["This plugin is not published to"," ",(0,n.jsx)(g.Y,{href:"https://www.grafana.com/plugins",external:!0,children:"grafana.com/plugins"})," ","and can't be managed via the catalog."]})})})},E=I=>({alert:(0,a.css)({marginTop:`${I.spacing(2)}`})});function D(I){switch(I){case u.u8.INSTALL:case u.u8.REINSTALL:return"You do not have permission to install this plugin.";case u.u8.UNINSTALL:return"You do not have permission to uninstall this plugin.";case u.u8.UPDATE:return"You do not have permission to update this plugin.";default:return"You do not have permission to manage this plugin."}}const C=[],P=I=>{C.push(I)},T=({plugin:I})=>{const j=(0,f.pw)(),W=(0,o.of)(O),{error:B}=(0,f.XN)();if(!I)return null;const S=(0,x.Gl)(I.details?.versions),w=I.isInstalled?I.hasUpdate?u.u8.UPDATE:u.u8.UNINSTALL:u.u8.INSTALL;return(0,n.jsxs)("div",{className:W.subtitle,children:[B&&(0,n.jsx)(d.F,{title:"message"in B?B.message:"",children:typeof B=="string"?B:B.error}),(0,n.jsxs)(i.B,{direction:"row",justifyContent:"space-between",children:[(0,n.jsxs)("div",{children:[I?.description&&(0,n.jsx)("div",{children:I?.description}),!l.$.featureToggles.pluginsDetailsRightPanel&&!!I?.details?.links?.length&&(0,n.jsx)("span",{children:I.details.links.map((N,M)=>(0,n.jsxs)(s.Fragment,{children:[M>0&&" | ",(0,n.jsx)("a",{href:N.url,className:"external-link",children:N.name})]},M))}),(0,x.N6)(I,j,S)&&(0,n.jsx)(b,{plugin:I,pluginStatus:w,latestCompatibleVersion:S})]}),C.map(N=>(0,n.jsx)(s.Fragment,{children:N({plugin:I})},N.name))]})]})},O=I=>({subtitle:(0,a.css)({display:"flex",flexDirection:"column",gap:I.spacing(1)})})},95256:(Z,R,e)=>{"use strict";e.d(R,{Mi:()=>a,P5:()=>s,Sw:()=>n,fu:()=>l});const n="/api/plugins",a="/api/instance",s="/api/gnet",l="plugins"},4476:(Z,R,e)=>{"use strict";e.d(R,{Gl:()=>b,H2:()=>y,N6:()=>D,Qi:()=>A,Sq:()=>C,TD:()=>S,UI:()=>L,Xc:()=>x,bM:()=>I,by:()=>v,hY:()=>P,j_:()=>E,kH:()=>r,sP:()=>M,td:()=>m,wD:()=>N});var n=e(84139),a=e(11594),s=e(44922),l=e(43173),o=e(62061),d=e(73427),i=e(11257),c=e(13660);function m({local:U=[],remote:F=[],instance:V=[],provisioned:K=[],pluginErrors:G}){const H=[],_=f(G),k=V.reduce((z,Y)=>(z.set(Y.pluginSlug,Y),z),new Map),J=K.reduce((z,Y)=>(z.add(Y.slug),z),new Set);return U.forEach(z=>{const Y=F.find(Q=>Q.slug===z.id),X=_[z.id];Y||H.push(p(z,void 0,X))}),F.forEach(z=>{const Y=U.find(q=>q.id===z.slug),X=_[z.slug];if(!(z.status===c.Uy.Deprecated&&!Y)){const q=p(Y,z,X);if(l.$.pluginAdminExternalManageEnabled){q.isFullyInstalled=q.isCore?!0:(k.has(z.slug)||J.has(z.slug))&&q.isInstalled,q.isInstalled=k.has(z.slug)||q.isInstalled;const te=k.get(z.slug);q.isUpdatingFromInstance=k.has(z.slug)&&q.hasUpdate&&q.installedVersion!==te?.version,te?.version&&te?.version!==z.version&&(q.hasUpdate=!0),q.isUninstallingFromInstance=!!Y&&!k.has(z.slug),q.isProvisioned=J.has(z.slug)}H.push(q)}}),H}function p(U,F,V){return!U&&F?h(F,V):U&&!F?r(U,V):g(U,F,V)}function h(U,F){const{name:V,slug:K,description:G,version:H,orgName:_,popularity:k,downloads:J,typeCode:z,updatedAt:Y,createdAt:X,status:Q,angularDetected:q,keywords:te,signatureType:ne,versionSignatureType:se,versionSignedByOrgName:ue,url:de}=U,ie=!!F;return{description:G,downloads:J,id:K,info:{logos:{small:`${l.$.appSubUrl}/api/gnet/plugins/${K}/versions/${H}/logos/small`,large:`${l.$.appSubUrl}/api/gnet/plugins/${K}/versions/${H}/logos/large`},keywords:te},name:V,orgName:_,popularity:k,publishedAt:X,signature:u({remote:U,error:F}),signatureType:ne||se||void 0,signatureOrg:ue,updatedAt:Y,hasUpdate:!1,isPublished:!0,isInstalled:ie,isDisabled:ie,isManaged:O(K),isPreinstalled:I(K),isDeprecated:Q===c.Uy.Deprecated,isCore:U.internal,isDev:!1,isEnterprise:Q===c.Uy.Enterprise,type:z,error:F?.errorCode,angularDetected:q,isFullyInstalled:ie,latestVersion:U.version,url:de}}function r(U,F){const{name:V,info:{description:K,version:G,logos:H,updated:_,author:k,keywords:J},id:z,dev:Y,type:X,signature:Q,signatureOrg:q,signatureType:te,hasUpdate:ne,accessControl:se,angularDetected:ue}=U,de=!!F;return{description:K,downloads:0,id:z,info:{logos:H,keywords:J},name:V,orgName:k.name,popularity:0,publishedAt:"",signature:u({local:U,error:F}),signatureOrg:q,signatureType:te,updatedAt:_,installedVersion:G,hasUpdate:ne,isInstalled:!0,isDisabled:de,isCore:Q==="internal",isPublished:!1,isDeprecated:!1,isDev:!!Y,isEnterprise:!1,isManaged:O(z),isPreinstalled:I(z),type:X,error:F?.errorCode,accessControl:se,angularDetected:ue,isFullyInstalled:!0,iam:U.iam,latestVersion:U.latestVersion}}function g(U,F,V){const K=U?.info.version,G=F?.slug||U?.id||"",H=U?.type||F?.typeCode,_=!!V,k=F?.keywords||U?.info.keywords||[];let J={small:`/public/build/img/icn-${H}.svg`,large:`/public/build/img/icn-${H}.svg`};return F?J={small:`${l.$.appSubUrl}/api/gnet/plugins/${G}/versions/${F.version}/logos/small`,large:`${l.$.appSubUrl}/api/gnet/plugins/${G}/versions/${F.version}/logos/large`}:U&&U.info.logos&&(J=U.info.logos),{description:U?.info.description||F?.description||"",downloads:F?.downloads||0,hasUpdate:U?.hasUpdate||!1,id:G,info:{logos:J,keywords:k},isCore:!!(F?.internal||U?.signature===a.Ac.internal),isDev:!!U?.dev,isEnterprise:F?.status===c.Uy.Enterprise,isInstalled:!!U||_,isDisabled:_,isDeprecated:F?.status===c.Uy.Deprecated,isPublished:!0,isManaged:O(G),isPreinstalled:I(G),name:F?.name||U?.name||"",orgName:F?.orgName||U?.info.author.name||"",popularity:F?.popularity||0,publishedAt:F?.createdAt||"",type:H,signature:u({local:U,remote:F,error:V}),signatureOrg:U?.signatureOrg||F?.versionSignedByOrgName,signatureType:U?.signatureType||F?.versionSignatureType||F?.signatureType||void 0,updatedAt:F?.updatedAt||U?.info.updated||"",installedVersion:K,error:V?.errorCode,accessControl:U?.accessControl,angularDetected:U?.angularDetected??F?.angularDetected,isFullyInstalled:!!U||_,iam:U?.iam,latestVersion:U?.latestVersion||F?.version||"",url:F?.url||""}}const y=U=>`${l.$.pluginCatalogURL}${U}`;var v=(U=>(U.nameAsc="nameAsc",U.nameDesc="nameDesc",U.updated="updated",U.published="published",U.downloads="downloads",U))(v||{});const x=(U,F)=>{const V={nameAsc:(K,G)=>K.name.localeCompare(G.name),nameDesc:(K,G)=>G.name.localeCompare(K.name),updated:(K,G)=>(0,s.b)(G.updatedAt).valueOf()-(0,s.b)(K.updatedAt).valueOf(),published:(K,G)=>(0,s.b)(G.publishedAt).valueOf()-(0,s.b)(K.publishedAt).valueOf(),downloads:(K,G)=>G.downloads-K.downloads};return V[F]?U.sort(V[F]):U};function f(U=[]){return U.reduce((F,V)=>(F[V.pluginId]=V,F),{})}function u(U){const{error:F,local:V,remote:K}=U;if(F)switch(F.errorCode){case a.ZK.invalidSignature:return a.Ac.invalid;case a.ZK.missingSignature:return a.Ac.missing;case a.ZK.modifiedSignature:return a.Ac.modified}return V?.signature?V.signature:K?.signatureType&&K?.versionSignatureType?a.Ac.valid:a.Ac.missing}function b(U){if(!U)return;const[F]=U.filter(V=>!!V.isCompatible);return F}const E=()=>l.$.pluginAdminEnabled,D=(U,F,V)=>{const K=l.$.pluginAdminExternalManageEnabled,G=d.TP.hasPermission(i.w.PluginsInstall),H=!!V;return U.type===a.QE.renderer||U.isEnterprise&&!(0,o.a)("enterprise.plugins")||U.isDev||!G&&!K||!U.isPublished||!H||!F},C=U=>T(U.id),P=U=>T(U.slug);function T(U){const{pluginCatalogHiddenPlugins:F}=l.$;return!F.includes(U)}function O(U){const{pluginCatalogManagedPlugins:F}=l.$;return F?.includes(U)}function I(U){const{pluginCatalogPreinstalledPlugins:F}=l.$,V=F?.find(K=>K.id===U);return{found:!!V?.id,withVersion:!!V?.version}}function j(U){return U?.signature==="internal"}function W(U){return U.split(" - ")[0]}function B(U){return U.reduce((F,{id:V,name:K,type:G,orgName:H,info:_})=>{const k=_.keywords?.join(" ").toLowerCase(),J=`${V} - ${K} - ${G} - ${H} - ${k}`;return F.push(J),F},[])}function S(U,F){const V=B(U);let G=new n.A({intraMode:1,intraSub:0}).filter(V,F);return G===null?null:G.map(H=>W(V[H]))}function w(U){return!(U.isProvisioned||U.isCore||U.type===a.QE.renderer||U.isPreinstalled.withVersion||U.isManaged)}function N(U){return!(!w(U)||!U.hasUpdate||U.isUpdatingFromInstance)}function M(U){return!!(!w(U)||U.isEnterprise&&!(0,o.a)("enterprise.plugins")||!U.isPublished||U.isDisabled||!E())}function L(U){return U?U.angularDetected===!1:!1}function A(U){return U.isDisabled&&U.error===a.ZK.angular}},37256:(Z,R,e)=>{"use strict";e.d(R,{JC:()=>I,JJ:()=>u,LR:()=>f,NJ:()=>W,aU:()=>E,ai:()=>T,h9:()=>j,mj:()=>x,nT:()=>O,t5:()=>b,y7:()=>B});var n=e(65307),a=e(65474),s=e(62467),l=e(66847),o=e(45650),d=e(12974),i=e(75505),c=e(43173),m=e(68143),p=e(92391),h=e(19203),r=e(59253),g=e(95256),y=e(4476),v=e(13660);const x=(0,n.zD)(`${g.fu}/fetchAll`,async(w,N)=>{try{N.dispatch({type:`${g.fu}/fetchLocal/pending`}),N.dispatch({type:`${g.fu}/fetchRemote/pending`});const M=c.$.pluginAdminExternalManageEnabled?(0,a.H)((0,r.Ap)()):(0,s.of)(void 0),L=c.$.pluginAdminExternalManageEnabled?(0,a.H)((0,r.XP)()):(0,s.of)(void 0),A=500,U=(0,a.H)((0,r.Bj)()),F=(0,a.H)((0,r.Gd)()),V=(0,a.H)((0,r.T_)()).pipe((0,l.W)(K=>(N.dispatch({type:`${g.fu}/fetchRemote/rejected`}),console.error(K),(0,s.of)([]))));return(0,o.p)({local:F,remote:V,instance:M,provisioned:L,pluginErrors:U}).pipe((0,d.w)({each:A,with:()=>(V.subscribe(async K=>{if(N.dispatch({type:`${g.fu}/fetchRemote/fulfilled`}),K.length>0){const G=await(0,i.s)(F),H=await(0,i.s)(M),_=await(0,i.s)(L),k=await(0,i.s)(U);N.dispatch(E((0,y.td)({local:G,remote:K,instance:H,provisioned:_,pluginErrors:k})))}}),(0,o.p)({local:F,instance:M,provisioned:L,pluginErrors:U}))})).subscribe(({local:K,remote:G,instance:H,provisioned:_,pluginErrors:k})=>{K&&G?(N.dispatch({type:`${g.fu}/fetchLocal/fulfilled`}),N.dispatch({type:`${g.fu}/fetchRemote/fulfilled`}),N.dispatch(E((0,y.td)({local:K,remote:G,instance:H,provisioned:_,pluginErrors:k})))):K&&(N.dispatch({type:`${g.fu}/fetchLocal/fulfilled`}),N.dispatch(E((0,y.td)({local:K,pluginErrors:k}))))},K=>(console.log(K),N.dispatch({type:`${g.fu}/fetchLocal/rejected`}),N.dispatch({type:`${g.fu}/fetchRemote/rejected`}),N.rejectWithValue("Unknown error."))),null}catch{return N.rejectWithValue("Unknown error.")}}),f=(0,n.zD)(`${g.fu}/fetchAllLocal`,async(w,N)=>{try{return(await(0,r.Gd)()).map(L=>(0,y.kH)(L))}catch{return N.rejectWithValue("Unknown error.")}}),u=(0,n.zD)(`${g.fu}/fetchRemotePlugins`,async(w,N)=>{try{return await(0,r.T_)()}catch(M){return(0,m.NF)(M)&&(M.isHandled=!0),N.rejectWithValue([])}}),b=(0,n.zD)(`${g.fu}/fetchDetails`,async(w,N)=>{try{const M=await(0,r.CB)(w);return{id:w,changes:{details:M}}}catch{return N.rejectWithValue("Unknown error.")}}),E=(0,n.VP)(`${g.fu}/addPlugins`),D=(0,n.VP)(`${g.fu}/addLocalPlugins`),C=(0,n.VP)(`${g.fu}/addLocalPlugins`),P=(0,n.VP)(`${g.fu}/addLocalPlugins`),T=(0,n.zD)(`${g.fu}/install`,async({id:w,version:N,installType:M=v.u8.INSTALL},L)=>{const A={isInstalled:!0,installedVersion:N};M===v.u8.UPDATE&&(A.hasUpdate=!1),M===v.u8.DOWNGRADE&&(A.hasUpdate=!0);try{return await(0,r.xZ)(w,N),await S(),M!==v.u8.INSTALL&&(0,h.sk)(w),{id:w,changes:A}}catch(U){return console.error(U),(0,m.NF)(U)?(U.data.id=w,L.rejectWithValue(U.data)):L.rejectWithValue("Unknown error.")}}),O=(0,n.zD)(`${g.fu}/install`,async()=>({})),I=(0,n.zD)(`${g.fu}/uninstall`,async(w,N)=>{try{return await(0,r.cu)(w),await S(),(0,h.sk)(w),{id:w,changes:{isInstalled:!1,installedVersion:void 0,isFullyInstalled:!1}}}catch(M){return console.error(M),N.rejectWithValue("Unknown error.")}}),j=(0,n.zD)(`${g.fu}/loadPluginDashboards`,async(w,N)=>{const A=`api/plugins/${N.getState().dataSources.dataSource.type}/dashboards`;return(0,m.AI)().get(A)}),W=(0,n.VP)(`${g.fu}/panelPluginLoaded`),B=w=>async(N,M)=>{let L=M().plugins.panels[w];return L||(L=await(0,p.TV)(w),M().plugins.panels[w]||N(W(L))),L};function S(){return(0,m.AI)().get("/api/frontend/settings").then(w=>{c.$.panels=w.panels})}},23691:(Z,R,e)=>{"use strict";e.d(R,{A5:()=>K,wr:()=>M,m5:()=>N,PW:()=>C,F9:()=>I,ob:()=>T,sM:()=>P,xX:()=>j,XN:()=>L,pw:()=>S,Gp:()=>B,qG:()=>A,SQ:()=>W});var n=e(96540),a=e(52763),s=e(4476),l=e(37256),o=e(25508),d=e(2543),i=e(8934),c=e(27489),m=e(13660),p=e(54687);const h=G=>G.plugins,r=(0,o.Mz)(h,({items:G})=>G),{selectAll:g,selectById:y}=p.AI.getSelectors(r),v=(0,d.debounce)(G=>{(0,c.rR)("plugins_search",{resultsCount:G,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),x=G=>(0,o.Mz)(g,H=>{const _=G.keyword?(0,i.xb)(G.keyword.toLowerCase()):"",k=_!==""?(0,s.TD)(H,_):null,J=H.filter(z=>!(_&&k==null||_&&!k?.includes(z.id)||G.type&&z.type!==G.type||G.isInstalled!==void 0&&z.isInstalled!==G.isInstalled||G.isEnterprise!==void 0&&z.isEnterprise!==G.isEnterprise||G.hasUpdate!==void 0&&(z.hasUpdate!==G.hasUpdate||!(0,s.wD)(z))));return _&&v(J.length),J}),f=G=>(0,o.Mz)(g,H=>{const _=[];for(const k of H)k.error&&(!G||k.type===G)&&_.push({pluginId:k.id,errorCode:k.error,pluginType:k.type});return _}),u=G=>(0,o.Mz)(h,({requests:H={}})=>H[G]),b=G=>(0,o.Mz)(u(G),H=>H?.status===m.IZ.Pending),E=G=>(0,o.Mz)(u(G),H=>H?.status===m.IZ.Rejected?H?.error:null),D=G=>(0,o.Mz)(u(G),H=>H===void 0),C=(G,H=s.by.nameAsc)=>{U();const _=(0,n.useMemo)(()=>x(G),[G]),k=(0,a.d4)(_),{isLoading:J,error:z}=w(),Y=(0,s.Xc)(k,H);return{isLoading:J,error:z,plugins:Y}},P=()=>{const{isLoading:G}=N(),{plugins:H}=C({isInstalled:!0}),_=H.filter(s.wD);return{isLoading:G,updatablePlugins:_}},T=G=>(U(),V(G),(0,a.d4)(H=>y(H,G))),O=G=>(F(),useSelector(H=>selectById(H,G))),I=G=>(U(),(0,a.d4)(f(G))),j=()=>{const G=(0,a.wA)();return(H,_,k)=>G((0,l.ai)({id:H,version:_,installType:k}))},W=()=>{const G=(0,a.wA)();return()=>G((0,l.nT)())},B=()=>{const G=(0,a.wA)();return H=>G((0,l.JC)(H))},S=()=>(0,a.d4)(E(l.JJ.typePrefix))===null,w=()=>{const G=(0,a.d4)(b("plugins/fetchLocal")),H=(0,a.d4)(E("plugins/fetchLocal"));return{isLoading:G,error:H}},N=()=>{const G=(0,a.d4)(b(l.mj.typePrefix)),H=(0,a.d4)(b("plugins/fetchLocal")),_=(0,a.d4)(b("plugins/fetchRemote")),k=G||H||_,J=(0,a.d4)(E(l.mj.typePrefix));return{isLoading:k,error:J}},M=()=>{const G=(0,a.d4)(b(l.t5.typePrefix)),H=(0,a.d4)(E(l.t5.typePrefix));return{isLoading:G,error:H}},L=()=>{const G=(0,a.d4)(b(l.ai.typePrefix)),H=(0,a.d4)(E(l.ai.typePrefix));return{isInstalling:G,error:H}},A=()=>{const G=(0,a.d4)(b(l.JC.typePrefix)),H=(0,a.d4)(E(l.JC.typePrefix));return{isUninstalling:G,error:H}},U=()=>{const G=(0,a.wA)(),H=(0,a.d4)(D(l.mj.typePrefix));(0,n.useEffect)(()=>{H&&G((0,l.mj)())},[])},F=()=>{const G=useDispatch(),H=useSelector(selectIsRequestNotFetched(fetchAllLocal.typePrefix));useEffect(()=>{H&&G(fetchAllLocal())},[])},V=G=>{const H=(0,a.wA)(),_=(0,a.d4)(z=>y(z,G)),J=!(0,a.d4)(b(l.t5.typePrefix))&&_&&!_.details;(0,n.useEffect)(()=>{J&&H((0,l.t5)(G))},[_])},K=()=>{const G=(0,a.wA)();return H=>G((0,l.t5)(H))}},54687:(Z,R,e)=>{"use strict";e.d(R,{AI:()=>o,Ff:()=>r});var n=e(65307),a=e(95256),s=e(13660),l=e(37256);const o=(0,n.pU)(),d=g=>new RegExp(`${a.fu}/(.*)/pending`).test(g.type),i=g=>new RegExp(`${a.fu}/(.*)/fulfilled`).test(g.type),c=g=>new RegExp(`${a.fu}/(.*)/rejected`).test(g.type),m=g=>{const y=g.lastIndexOf("/");return g.substring(0,y)},p={items:o.getInitialState(),requests:{},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},r=(0,n.Z0)({name:"plugins",initialState:p,reducers:{},extraReducers:g=>g.addCase(l.aU,(y,v)=>{o.upsertMany(y.items,v.payload)}).addCase(l.LR.fulfilled,(y,v)=>{o.upsertMany(y.items,v.payload)}).addCase(l.t5.fulfilled,(y,v)=>{o.updateOne(y.items,v.payload)}).addCase(l.ai.fulfilled,(y,v)=>{o.updateOne(y.items,v.payload)}).addCase(l.JC.fulfilled,(y,v)=>{o.updateOne(y.items,v.payload)}).addCase(l.NJ,(y,v)=>{y.panels[v.payload.meta.id]=v.payload}).addCase(l.h9.pending,(y,v)=>{y.isLoadingPluginDashboards=!0,y.dashboards=[]}).addCase(l.h9.fulfilled,(y,v)=>{y.isLoadingPluginDashboards=!1,y.dashboards=v.payload}).addMatcher(d,(y,v)=>{y.requests[m(v.type)]={status:s.IZ.Pending}}).addMatcher(i,(y,v)=>{y.requests[m(v.type)]={status:s.IZ.Fulfilled}}).addMatcher(c,(y,v)=>{y.requests[m(v.type)]={status:s.IZ.Rejected,error:v.payload}})}).reducer},13660:(Z,R,e)=>{"use strict";e.d(R,{IZ:()=>i,Ip:()=>a,LZ:()=>d,Uy:()=>s,og:()=>o,u8:()=>l,vk:()=>n});var n=(c=>(c.Home="plugins-home",c.Browse="plugins-browse",c.Details="plugins-details",c))(n||{}),a=(c=>(c.app="apps",c.datasource="database",c.panel="credit-card",c.renderer="capture",c))(a||{}),s=(c=>(c.Deleted="deleted",c.Active="active",c.Pending="pending",c.Deprecated="deprecated",c.Enterprise="enterprise",c))(s||{}),l=(c=>(c.INSTALL="INSTALL",c.UNINSTALL="UNINSTALL",c.UPDATE="UPDATE",c.REINSTALL="REINSTALL",c.DOWNGRADE="DOWNGRADE",c))(l||{}),o=(c=>(c.OVERVIEW="Overview",c.VERSIONS="Version history",c.CONFIG="Config",c.DASHBOARDS="Dashboards",c.USAGE="Usage",c.IAM="IAM",c.CHANGELOG="Changelog",c.PLUGINDETAILS="Plugin details",c.DATASOURCE_CONNECTIONS="Data source connections",c.SCREENSHOTS="Screenshots",c))(o||{}),d=(c=>(c.OVERVIEW="overview",c.VERSIONS="version-history",c.CONFIG="config",c.DASHBOARDS="dashboards",c.USAGE="usage",c.IAM="iam",c.CHANGELOG="changelog",c.PLUGINDETAILS="right-panel",c.DATASOURCE_CONNECTIONS="datasource-connections",c.SCREENSHOTS="screenshots",c))(d||{}),i=(c=>(c.Pending="Pending",c.Fulfilled="Fulfilled",c.Rejected="Rejected",c))(i||{})},22465:(Z,R,e)=>{"use strict";e.d(R,{K:()=>l});var n=e(74848),a=e(96540),s=e(79450);class l extends a.Component{static{this.contextType=s.b}constructor(d){super(d),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(d){return{hasError:!0,error:d,errorInfo:null}}componentDidCatch(d,i){this.props.onError?this.props.onError(d,i):console.error(`Plugin "${this.context?.meta.id}" failed to load:`,d,i),this.setState({error:d,errorInfo:i})}render(){const d=this.props.fallback;return this.state.hasError?d?(0,n.jsx)(d,{error:this.state.error,errorInfo:this.state.errorInfo}):null:this.props.children}}},70715:(Z,R,e)=>{"use strict";e.d(R,{A:()=>a,S:()=>l});var n=e(96540);const a=(0,n.createContext)(s());a.displayName="PluginPageContext";function s(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function l(o){return{sectionNav:o??s().sectionNav}}},85622:(Z,R,e)=>{"use strict";e.d(R,{p:()=>o});var n=e(74848),a=e(11594),s=e(92745),l=e(99887);const o=i=>{const c=d(i.state);return c?(0,n.jsx)(l.E,{className:i.className,color:c.color,title:typeof c.tooltip=="string"?c.tooltip:void 0,tooltip:typeof c.tooltip!="string"?c.tooltip:void 0,text:c.text,icon:c.icon}):null};function d(i){switch(i){case a.pn.deprecated:return{text:(0,s.t)("plugins.get-feature-state-info.text.deprecated","Deprecated"),color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case a.pn.alpha:return{text:(0,s.t)("plugins.get-feature-state-info.text.alpha","Alpha"),color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case a.pn.beta:return{text:(0,s.t)("plugins.get-feature-state-info.text.beta","Beta"),color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},28998:(Z,R,e)=>{"use strict";e.d(R,{tR:()=>b,xq:()=>v});var n=e(94644),a=e(32899),s=e(8134),l=e(28105),o=e(2863),d=e(36580),i=e(68143),c=e(78282),m=e(55315),p=e(45229),h=e(65642),r=e(29328),g=e(4651),y=e(58666);class v{constructor(D=(0,o.w)()){this.templateSrv=D,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.runtimeDataSources={},this.defaultName=""}init(D,C){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=D,this.defaultName=C;for(const P of Object.values(D))P.uid||(P.uid=P.name),this.settingsMapByUid[P.uid]=P,this.settingsMapById[P.id]=P;for(const P of Object.values(this.runtimeDataSources))this.datasources[P.uid]=P,this.settingsMapByUid[P.uid]=P.instanceSettings;this.datasources[d.dR.type]=r.Ex,this.datasources[g.Uj]=r.Ex,this.settingsMapByUid[d.dR.uid]=r.$i,this.settingsMapByUid[g.Uj]=r.$i}registerRuntimeDataSource(D){if(this.runtimeDataSources[D.dataSource.uid])throw new Error(`A runtime data source with uid ${D.dataSource.uid} has already been registered`);if(this.settingsMapByUid[D.dataSource.uid])throw new Error(`A data source with uid ${D.dataSource.uid} has already been registered`);this.runtimeDataSources[D.dataSource.uid]=D.dataSource,this.datasources[D.dataSource.uid]=D.dataSource,this.settingsMapByUid[D.dataSource.uid]=D.dataSource.instanceSettings}getDataSourceSettingsByUid(D){return this.settingsMapByUid[D]}getInstanceSettings(D,C){let P=x(D);if((0,d.s9)(P))return r.$i;if(P==="default"||P==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(P[0]==="$"){const T=this.templateSrv.replace(P,C,f);let O;return T==="default"?O=this.settingsMapByName[this.defaultName]:O=this.settingsMapByUid[T]??this.settingsMapByName[T],O?{...O,isDefault:!1,name:P,uid:P,rawRef:{type:O.type,uid:O.uid}}:void 0}return this.settingsMapByUid[P]??this.settingsMapByName[P]??this.settingsMapById[P]}get(D,C){let P=x(D);if(!P){if(u(D)){const O=this.getList({type:D.type});if(!O?.length)return Promise.reject("no datasource of type");const I=O.find(j=>j.isDefault)??O[0];return this.get(I.uid)}return this.get(this.defaultName)}if((0,d.s9)(D))return Promise.resolve(this.datasources[g.Uj]);const T=this.settingsMapByName[P];return T&&(P=T.uid),this.datasources[P]?Promise.resolve(this.datasources[P]):(P=this.templateSrv.replace(P,C,f),P==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[P]?Promise.resolve(this.datasources[P]):this.loadDatasource(P))}async loadDatasource(D){if(this.datasources[D])return Promise.resolve(this.datasources[D]);const C=this.getInstanceSettings(D);if(!C)return Promise.reject({message:`Datasource ${D} was not found`});try{const P=await(0,y.cS)(C.meta);if(this.datasources[D])return this.datasources[D];const T=new P.DataSourceClass(C);if(T.components=P.components,T.userStorage||(T.userStorage=new m.X(C.type)),!(T instanceof n.mA)){const O=T;O.name=C.name,O.id=C.id,O.type=C.type,O.meta=C.meta,O.uid=C.uid,O.getRef=n.mA.prototype.getRef}return this.datasources[D]=T,this.datasources[T.uid]=T,T}catch(P){return P instanceof Error&&p.A.emit(a.r1.alertError,[C.name+" plugin failed",P.toString()]),Promise.reject({message:`Datasource: ${D} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(D={}){const C=Object.values(this.settingsMapByName).filter(T=>{if(T.meta.id==="grafana"||T.meta.id==="mixed"||T.meta.id==="dashboard"||D.metrics&&!T.meta.metrics||D.tracing&&!T.meta.tracing||D.logs&&T.meta.category!=="logging"&&!T.meta.logs||D.annotations&&!T.meta.annotations||D.alerting&&!T.meta.alerting||D.pluginId&&!(0,s._)(D.pluginId,T.meta)||D.filter&&!D.filter(T))return!1;if(D.type){if(Array.isArray(D.type)){if(!D.type.includes(T.type))return!1}else if(!(T.type===D.type||T.meta.aliasIDs?.includes(D.type)))return!1}return!(!D.all&&T.meta.metrics!==!0&&T.meta.annotations!==!0&&T.meta.tracing!==!0&&T.meta.logs!==!0&&T.meta.alerting!==!0)});if(D.variables)for(const T of this.templateSrv.getVariables()){if(T.type!=="datasource")continue;let O=T.current.value==="default"?this.defaultName:T.current.value;Array.isArray(O)&&(O=O[0]);const I=!Array.isArray(O)&&(this.settingsMapByName[O]||this.settingsMapByUid[O]);if(I){const j=`\${${T.name}}`;C.push({...I,isDefault:!1,name:j,uid:j})}}const P=C.sort((T,O)=>T.name.toLowerCase()>O.name.toLowerCase()?1:T.name.toLowerCase()<O.name.toLowerCase()?-1:0);if(!D.pluginId&&!D.alerting){if(D.mixed){const T=this.getInstanceSettings("-- Mixed --");T&&C.push(T)}if(D.dashboard){const T=this.getInstanceSettings("-- Dashboard --");T&&C.push(T)}if(!D.tracing){const T=this.getInstanceSettings("-- Grafana --");T&&D.filter?.(T)!==!1&&C.push(T)}}return P}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}getMetricSources(D){return this.getList({metrics:!0,variables:!D?.skipVariables}).map(C=>({name:C.name,value:C.name,meta:C.meta}))}async reload(){const D=await(0,i.AI)().get("/api/frontend/settings");h.Ay.datasources=D.datasources,h.Ay.defaultDatasource=D.defaultDatasource,this.init(D.datasources,D.defaultDatasource)}}function x(E){return(0,d.s9)(E)?d.dR.uid:typeof E=="string"?E:E?.uid}function f(E){return Array.isArray(E)?E[0]:E}const u=E=>!!(E&&(0,l.Gv)(E)&&"type"in E),b=()=>(0,c.l)()},28337:(Z,R,e)=>{"use strict";e.d(R,{AZ:()=>h,OG:()=>i,TX:()=>c,ZV:()=>p,ov:()=>m});var n=e(74848),a=e(96540);const s=(0,a.createContext)(void 0),l=(0,a.createContext)(void 0),o=(0,a.createContext)(void 0),d=(0,a.createContext)(void 0);function i(){const r=(0,a.useContext)(s);if(!r)throw new Error("No `AddedLinksRegistryContext` found.");return r}function c(){const r=(0,a.useContext)(l);if(!r)throw new Error("No `AddedComponentsRegistryContext` found.");return r}function m(){const r=(0,a.useContext)(o);if(!r)throw new Error("No `AddedFunctionsRegistry` found.");return r}function p(){const r=(0,a.useContext)(d);if(!r)throw new Error("No `ExposedComponentsRegistryContext` found.");return r}const h=({registries:r,children:g})=>(0,n.jsx)(s.Provider,{value:r.addedLinksRegistry,children:(0,n.jsx)(l.Provider,{value:r.addedComponentsRegistry,children:(0,n.jsx)(o.Provider,{value:r.addedFunctionsRegistry,children:(0,n.jsx)(d.Provider,{value:r.exposedComponentsRegistry,children:g})})})})},4745:(Z,R,e)=>{"use strict";e.d(R,{$$:()=>b,Bc:()=>u,Bs:()=>n,Cf:()=>c,E5:()=>x,FL:()=>g,H$:()=>i,O6:()=>d,Ri:()=>a,Td:()=>p,bw:()=>o,cu:()=>f,iS:()=>v,ij:()=>r,o2:()=>s,sm:()=>y,vT:()=>m,z5:()=>h});const n='Invalid usage of extension point. Reason: Extension point id should be prefixed with your plugin id, e.g "myorg-foo-app/toolbar/v1".',a='Invalid usage of extension point. Reason: The extension point is not recorded in the "plugin.json" file. Extension points must be listed in the section "extensions.extensionPoints[]". Returning an empty array of extensions.',s="Title is missing.",l="Description is missing.",o='The "fn" argument is invalid, it should be a function.',d='The "configure" function is invalid. It should be a function.',i='Either "path" or "onClick" is required.',c='The "path" is required and should start with "/a/<pluginId>".',m="The component id does not match the id naming convention. Id should be prefixed with plugin id. e.g 'myorg-basic-app/my-component-id/v1'.",p="An exposed component with the same id already exists.",h='The exposed component was not recorded in the plugin.json. Exposed component extensions must be listed in the section "extensions.exposedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',r='Invalid usage of extension point. Reason: The exposed component is not recorded in the "plugin.json" file. Exposed components must be listed in the dependencies[] section.',g='The extension was not recorded in the plugin.json. Added component extensions must be listed in the section "extensions.addedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',y=`The "title" doesn't match the title recorded in plugin.json.`,v='The extension was not recorded in the plugin.json. Added link extensions must be listed in the section "extensions.addedLinks[]". Currently, this is only required in development but will be enforced also in production builds in the future.',x='The extension was not recorded in the plugin.json. Added function extensions must be listed in the section "extensions.addedFunction[]". Currently, this is only required in development but will be enforced also in production builds in the future.',f=`The "description" doesn't match the description recorded in plugin.json.`,u='The "targets" for the registered extension does not match the targets recorded in plugin.json. Currently, this is only required in development but will be enforced also in production builds in the future.',b=E=>`The app plugin with plugin id "${E}" was not found.`},8001:(Z,R,e)=>{"use strict";e.d(R,{dp:()=>g,m5:()=>h,zN:()=>r});var n=e(2543),a=e.n(n),s=e(49510),l=e(16126),o=e(81160),d=e(54092),i=e(96016),c=e(63629),m=e(3260);const p=v=>(0,s.z)([c.qm.addedComponentsRegistry.asObservable(),c.qm.addedLinksRegistry.asObservable()]).pipe((0,l.p)(([x,f])=>!!x&&!!f),(0,o.T)(([x,f])=>y({...v,addedComponentsRegistry:x,addedLinksRegistry:f}))),h=v=>p(v).pipe((0,o.T)(x=>x.extensions.filter(f=>f.type===d.u.link))),r=v=>p(v).pipe((0,o.T)(x=>x.extensions.filter(f=>f.type===d.u.component)));function g(v){let x,f;return v.addedComponentsRegistry.asObservable().subscribe(u=>{x=u}),v.addedLinksRegistry.asObservable().subscribe(u=>{f=u}),u=>y({...u,addedComponentsRegistry:x,addedLinksRegistry:f})}const y=({context:v,extensionPointId:x,limitPerPlugin:f,addedLinksRegistry:u,addedComponentsRegistry:b})=>{const E=v?(0,m.$Y)(v):{},D=[],C={};for(const T of u?.[x]??[])try{const{pluginId:O}=T;if(f&&C[O]>=f)continue;C[O]===void 0&&(C[O]=0);const I=i.R.child({pluginId:O,extensionPointId:x,path:T.path??"",title:T.title,description:T.description??"",onClick:typeof T.onClick}),j=(0,m.hS)(O,T,I,E);if(T.configure&&j===void 0)continue;const W=j?.path||T.path,B={id:(0,m.yt)(O,x,T.title),type:d.u.link,pluginId:O,onClick:(0,m.dx)(O,x,T,I,E),icon:j?.icon||T.icon,title:j?.title||T.title,description:j?.description||T.description||"",path:(0,n.isString)(W)?(0,m.YS)(O,W,x):void 0,category:j?.category||T.category};D.push(B),C[O]+=1}catch(O){O instanceof Error&&i.R.error(O.message,{stack:O.stack??"",message:O.message})}const P=b?.[x]??[];for(const T of P){if(f&&C[T.pluginId]>=f)continue;C[T.pluginId]===void 0&&(C[T.pluginId]=0);const O=i.R.child({title:T.title,description:T.description??"",pluginId:T.pluginId}),I={id:(0,m.yt)(T.pluginId,x,T.title),type:d.u.component,pluginId:T.pluginId,title:T.title,description:T.description??"",component:(0,m.nv)({pluginId:T.pluginId,extensionTitle:T.title,Component:T.component,log:O})};D.push(I),C[T.pluginId]+=1}return{extensions:D}}},96016:(Z,R,e)=>{"use strict";e.d(R,{R:()=>g});var n=e(2543),a=e.n(n),s=e(43561),l=e(39741),o=e(67770),d=e(25992),i=e(43173);const c="ui-extension-logs",m=1e3,p=1e3*60*10,h=(0,d.DW)(c);class r{constructor(v,x,f){this.baseLabels=v,this.channel=f??new BroadcastChannel(c),this.subject=x??new l.m(m,p),f||(this.channel.onmessage=u=>this.subject.next(u.data))}info(v,x){this.log(o.$b.info,v,x)}warning(v,x){h.logWarning(v,{...this.baseLabels,...x}),i.$.buildInfo.env==="development"&&console.warn(v,{...this.baseLabels,...x}),this.log(o.$b.warning,v,x)}error(v,x){h.logError(new Error(v),{...this.baseLabels,...x}),console.error(v,{...this.baseLabels,...x}),this.log(o.$b.error,v,x)}debug(v,x){this.log(o.$b.debug,v,x)}trace(v,x){this.log(o.$b.trace,v,x)}fatal(v,x){this.log(o.$b.fatal,v,x)}log(v,x,f){const u={...f,...this.baseLabels},{pluginId:b,extensionPointId:E}=u,D={level:v,labels:u,timestamp:Date.now(),id:(0,s.Ak)(),message:x,pluginId:(0,n.isString)(b)?b:void 0,extensionPointId:(0,n.isString)(E)?E:void 0};this.subject.next(D),this.channel.postMessage(D)}asObservable(){return this.subject.asObservable()}child(v){return new r({...v,...this.baseLabels},this.subject,this.channel)}}const g=new r},63629:(Z,R,e)=>{"use strict";e.d(R,{a9:()=>M,rH:()=>U,lQ:()=>A,eY:()=>L,qm:()=>F});var n=e(74848),a=e(54092),s=e(73427),l=e(8535),o=e(11257),d=e(96016),i=e(3260),c=e(35231),m=e(19050),p=e(49987),h=e(39338);function r(){try{return[(0,i.xJ)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",targets:[a.S.ExploreToolbarAction],icon:"apps",category:"Dashboards",configure:()=>{if(s.TP.hasPermission(o.w.DashboardsCreate)||s.TP.hasPermission(o.w.DashboardsWrite))return{}},onClick:(V,{context:K,openModal:G})=>{G({title:(0,h.t)(),body:({onDismiss:H})=>(0,n.jsx)(p.H,{onClose:H,exploreId:K?.exploreId})})}}),(0,i.xJ)({title:"Add correlation",description:"Create a correlation from this query",targets:[a.S.ExploreToolbarAction],icon:"link",configure:V=>V?.shouldShowAddCorrelation?{}:void 0,onClick:(V,{context:K})=>{(0,l.JD)((0,c.am)({editorMode:!0})),(0,l.JD)((0,m.Od)({exploreId:K.exploreId}))}})]}catch(V){return d.R.warning(`Could not configure extensions for Explore due to: "${V}"`),[]}}function g(){return[...r()]}var y=e(4745),v=e(9453),x=e(13752),f=e(39741),u=e(29405),b=e(96222),E=e(81160),D=e(72985);const C="Cannot register to a read-only registry";class P{constructor(K){if(this.resultSubject=new x.B,this.logger=K.log??d.R,this.isReadOnly=!1,K.registrySubject){this.registrySubject=K.registrySubject,this.isReadOnly=!0;return}this.registrySubject=new f.m(1),this.resultSubject.pipe((0,u.S)(this.mapToRegistry.bind(this),K.initialState??{}),(0,b.Z)(K.initialState??{}),(0,E.T)(G=>(0,i.ol)(G))).subscribe(this.registrySubject)}register(K){if(this.isReadOnly)throw new Error(C);this.resultSubject.next(K)}asObservable(){return this.registrySubject.asObservable()}getState(){return(0,D._)(this.asObservable())}}const T="Could not register component extension. Reason:";class O extends P{constructor(K={}){super(K)}mapToRegistry(K,G){const{pluginId:H,configs:_}=G;for(const k of _){const J=this.logger.child({description:k.description,title:k.title,pluginId:H});if(!k.title){J.error(`${T} ${y.o2}`);continue}if(H!=="grafana"&&(0,i.V2)()&&(0,v.dt)(H,k,J))continue;const z=Array.isArray(k.targets)?k.targets:[k.targets];for(const Y of z){const X=J.child({extensionPointId:Y}),Q={pluginId:H,component:(0,i.nv)({pluginId:H,extensionTitle:k.title,Component:k.component,log:X}),description:k.description,title:k.title};X.debug("Added component extension successfully registered"),Y in K?K[Y].push(Q):K[Y]=[Q]}}return K}readOnly(){return new O({registrySubject:this.registrySubject})}}var I=e(2543);const j="Could not register function extension. Reason:";class W extends P{constructor(K={}){super(K)}mapToRegistry(K,G){const{pluginId:H,configs:_}=G;for(const k of _){const J=this.logger.child({title:k.title,pluginId:H});if(!k.title){J.error(`${j} ${y.o2}`);continue}if(!(0,I.isFunction)(k.fn)){J.error(`${j} ${y.bw}`);continue}if(H!=="grafana"&&(0,i.V2)()&&(0,v.SY)(H,k,J))continue;const z=Array.isArray(k.targets)?k.targets:[k.targets];for(const Y of z){const X=J.child({extensionPointId:Y}),Q={pluginId:H,fn:k.fn,description:k.description,title:k.title,extensionPointId:Y};X.debug("Added function extension successfully registered"),Y in K?K[Y].push(Q):K[Y]=[Q]}}return K}readOnly(){return new W({registrySubject:this.registrySubject})}}const B="Could not register link extension. Reason:";class S extends P{constructor(K={}){super(K)}mapToRegistry(K,G){const{pluginId:H,configs:_}=G;for(const k of _){const{path:J,title:z,description:Y,configure:X,onClick:Q,targets:q}=k,te=this.logger.child({path:J??"",description:Y??"",title:z,pluginId:H,onClick:typeof Q});if(!z){te.error(`${B} ${y.o2}`);continue}if(!(0,v.jk)(X)){te.error(`${B} ${y.O6}`);continue}if(!J&&!Q){te.error(`${B} ${y.H$}`);continue}if(J&&!(0,v.kl)(H,J)){te.error(`${B} ${y.Cf}`);continue}if(H!=="grafana"&&(0,i.V2)()&&(0,v.OO)(H,k,te))continue;const ne=Array.isArray(q)?q:[q];for(const se of ne){const ue=te.child({extensionPointId:se}),{targets:de,...ie}=k;se in K||(K[se]=[]),ue.debug("Added link extension successfully registered"),K[se].push({...ie,pluginId:H,extensionPointId:se})}}return K}readOnly(){return new S({registrySubject:this.registrySubject})}}const w="Could not register exposed component. Reason:";class N extends P{constructor(K={}){super(K)}mapToRegistry(K,{pluginId:G,configs:H}){if(!H)return K;for(const _ of H){const{id:k,description:J,title:z}=_,Y=this.logger.child({extensionPointId:k,description:J??"",title:z,pluginId:G});if(!k.startsWith(G)){Y.error(`${w} ${y.vT}`);continue}if(K[k]){Y.error(`${w} ${y.Td}`);continue}if(!z){Y.error(`${w} ${y.o2}`);continue}G!=="grafana"&&(0,i.V2)()&&(0,v.nl)(G,_,Y)||(Y.debug("Exposed component extension successfully registered"),K[k]={..._,pluginId:G})}return K}readOnly(){return new N({registrySubject:this.registrySubject})}}const M=new O,L=new N,A=new S,U=new W,F={addedComponentsRegistry:M,exposedComponentsRegistry:L,addedLinksRegistry:A,addedFunctionsRegistry:U};A.register({pluginId:"grafana",configs:g()})},3260:(Z,R,e)=>{"use strict";e.d(R,{xJ:()=>F,N9:()=>G,ol:()=>I,yt:()=>j,uS:()=>z,Xs:()=>ne,mi:()=>se,Uy:()=>q,Ce:()=>X,UX:()=>Q,dx:()=>_,hS:()=>H,YS:()=>k,$Y:()=>w,V2:()=>J,pL:()=>K,nv:()=>T,J7:()=>M});var n=e(74848),a=e(22803),s=e(2543),l=e(16817),o=e(20877),d=e(25229),i=e(83175),c=e(54092),m=e(27489),p=e(43173),h=e(22787),r=e(45229),g=e(95027),y=e(87745),v=e(22465),x=e(92745),f=e(34999);const u=({pluginId:ue,extensionTitle:de})=>(0,n.jsx)(f.F,{title:(0,x.t)("plugins.extensions.extension-error-alert-title",'Extension failed to load: "{{pluginId}}/{{extensionTitle}}"',{pluginId:ue,extensionTitle:de}),severity:"error",children:(0,x.t)("plugins.extensions.extension-error-alert-description","Check the console for more details on the error.")});var b=e(96016);const E=({children:ue,pluginId:de,extensionTitle:ie,log:he=b.R,fallbackAlwaysVisible:me=!1})=>(0,n.jsx)(v.K,{onError:(ce,Pe)=>{he.error(`Extension "${de}/${ie}" failed to load.`,{message:ce.message,componentStack:Pe.componentStack??"",digest:Pe.digest??""})},fallback:()=>J()||me?(0,n.jsx)(u,{pluginId:de,extensionTitle:ie}):null,children:ue});var D=e(9453);function C(ue,de=""){return(...ie)=>{try{return ue(...ie)}catch(he){he instanceof Error&&console.warn(`${de}${he.message}`)}}}function P(ue){return async de=>{const{title:ie,body:he,width:me,height:ce}=de;r.A.publish(new y.S8({component:T({pluginId:ue.pluginId,extensionTitle:ue.title,Component:O({title:ie,body:he,width:me,height:ce,config:ue}),log:b.R})}))}}const T=({pluginId:ue,extensionTitle:de,Component:ie,log:he})=>ce=>{const{error:Pe,loading:Ie,value:Se}=(0,l.A)(()=>(0,g.x)(ue,{showErrorAlert:!1}));return Ie?null:Pe?(he.error(`Could not fetch plugin meta information for "${ue}", aborting. (${Pe.message})`,{stack:Pe.stack??"",message:Pe.message}),null):Se?(0,n.jsx)(o.a,{meta:Se,children:(0,n.jsx)(E,{pluginId:ue,extensionTitle:de,log:he,children:(0,n.jsx)(ie,{...M(ce,{log:he,source:"extension",pluginId:ue})})})}):(he.error(`Fetched plugin meta information is empty for "${ue}", aborting.`),null)},O=({title:ue,body:de,width:ie,height:he,config:me})=>{const ce=(0,a.css)({width:ie,height:he});return({onDismiss:Ie})=>(0,n.jsx)(h.a,{title:ue,className:ce,isOpen:!0,onDismiss:Ie,onClickBackdrop:Ie,children:(0,n.jsx)(E,{pluginId:me.pluginId,extensionTitle:me.title,fallbackAlwaysVisible:!0,log:b.R,children:(0,n.jsx)("div",{"data-plugin-sandbox":me.pluginId,"data-testid":"plugin-sandbox-wrapper",children:(0,n.jsx)(de,{onDismiss:Ie})})})})};function I(ue,de=new Map){if(!ue||typeof ue!="object"||Object.isFrozen(ue))return ue;const ie=Array.isArray(ue)?[...ue]:{...ue};if(de.has(ue))return de.get(ue);de.set(ue,ie);const he=Reflect.ownKeys(ie);for(const me of he){const ce=Array.isArray(ie)?ie[Number(me)]:ie[me];ce&&(typeof ce=="object"||typeof ce=="function")&&(Array.isArray(ie)?ie[Number(me)]=I(ce,de):ie[me]=I(ce,de))}return Object.freeze(ie)}function j(ue,de,ie){const he=`${ue}${de}${ie}`;return Array.from(he).reduce((me,ce)=>Math.imul(31,me)+ce.charCodeAt(0)|0,0).toString()}const W=Symbol("isReadOnlyProxy"),B=Symbol("isMutationObserverProxy");class S extends Error{constructor(de){super(de??"Mutating a read-only proxy object"),this.name="ReadOnlyProxyError"}}function w(ue){if(!ue||typeof ue!="object"||A(ue))return ue;const de=new WeakMap;return new Proxy(ue,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(ie,he,me){if(he===W)return!0;const ce=Reflect.get(ie,he,me);return(0,d.Ar)(ce)?(0,d.KQ)(ce):(0,s.isObject)(ce)||(0,s.isArray)(ce)?(de.has(ce)||de.set(ce,w(ce)),de.get(ce)):ce}})}function N(ue,de){if(!ue||typeof ue!="object"||U(ue))return ue;const{log:ie=b.R,source:he="extension",pluginId:me="unknown"}=de??{},ce=new WeakMap,Pe=J()?ie.error.bind(ie):ie.warning.bind(ie);return new Proxy(ue,{deleteProperty(Ie,Se){return Pe(`Attempted to delete object property "${String(Se)}" from ${he} with id ${me}`,{stack:new Error().stack??""}),Reflect.deleteProperty(Ie,Se),!0},defineProperty(Ie,Se,Me){return ie.debug(`Attempted to define object property "${String(Se)}" from ${he} with id ${me}`,{stack:new Error().stack??""}),Reflect.defineProperty(Ie,Se,Me),!0},set(Ie,Se,Me){return Pe(`Attempted to mutate object property "${String(Se)}" from ${he} with id ${me}`,{stack:new Error().stack??""}),Reflect.set(Ie,Se,Me),!0},get(Ie,Se,Me){if(Se===B)return!0;const Te=Reflect.get(Ie,Se,Me),Ge=Reflect.getOwnPropertyDescriptor(Ie,Se);return Ge&&!Ge.configurable&&!Ge.writable?Te:(0,d.Ar)(Te)?(0,d.KQ)(Te):(0,s.isObject)(Te)||(0,s.isArray)(Te)?(ce.has(Te)||ce.set(Te,N(Te,{log:ie,source:he,pluginId:me})),ce.get(Te)):Te}})}function M(ue,de){if(!ue||typeof ue!="object")return ue;const{log:ie=b.R,source:he="extension",pluginId:me="unknown"}=de??{};return N((0,s.cloneDeep)(ue),{log:ie,pluginId:me,source:he})}function L(ue){return typeof ue=="object"&&ue!==null}function A(ue){return L(ue)&&ue[W]===!0}function U(ue){return L(ue)&&ue[B]===!0}function F(ue){const de={...ue};return de}function V(ue){}function K(ue,de){return ue.length<de?ue:`${ue.slice(0,de-3).trimEnd()}...`}function G(ue){const de={},ie=[];for(const me of ue){const ce=me.category;if(!ce){ie.push({text:K(me.title,25),href:me.path,onClick:me.onClick});continue}Array.isArray(de[ce])||(de[ce]=[]),de[ce].push({text:K(me.title,25),href:me.path,onClick:me.onClick})}const he=Object.keys(de).reduce((me,ce)=>(me.push({text:K(ce,25),type:"group",subMenu:de[ce]}),me),[]);return ie.length>0&&(he.length>0&&he.push({text:"divider",type:"divider"}),Array.prototype.push.apply(he,ie)),he}function H(ue,de,ie,he){try{const me=de.configure?.(he);if(me===void 0)return;let{title:ce=de.title,description:Pe=de.description,path:Ie=de.path,icon:Se=de.icon,category:Me=de.category,...Te}=me;return(0,D.lq)(me,`The configure() function for "${de.title}" returned a promise, skipping updates.`),Ie&&(0,D.wy)(ue,Ie),(0,D.aY)({title:ce,description:Pe},["title","description"]),Object.keys(Te).length>0&&ie.warning(`Extension "${de.title}", is trying to override restricted properties: ${Object.keys(Te).join(", ")} which will be ignored.`),{title:ce,description:Pe,path:Ie,icon:Se,category:Me}}catch(me){me instanceof Error&&ie.error(`Failed to configure link with title "${de.title}"`,{stack:me.stack??"",message:me.message});return}}function _(ue,de,ie,he,me){const{onClick:ce}=ie;if(ce)return function(Ie){try{(0,m.rR)("ui_extension_link_clicked",{pluginId:ue,extensionPointId:de,title:ie.title,category:ie.category});const Se={context:me,openModal:P(ie),openSidebar:(Te,Ge)=>{r.A.publish(new y.Am({props:Ge,pluginId:ue,componentTitle:Te}))}};he.debug(`onClick '${ie.title}' at '${de}'`);const Me=ce(Ie,Se);(0,D.yL)(Me)&&Me.catch(Te=>{Te instanceof Error&&he.error(Te.message,{message:Te.message,stack:Te.stack??""})})}catch(Se){Se instanceof Error&&he.error(Se.message,{message:Se.message,stack:Se.stack??""})}}}function k(ue,de,ie){return i.kM.appendQueryToUrl(de,i.kM.toUrlParams({uel_pid:ue,uel_epid:ie}))}const J=()=>p.$.buildInfo.env==="development",z=(ue=[])=>Object.values(p.$.apps).filter(de=>ue.includes(de.id)),Y=ue=>ue.split("/")[0],X=ue=>Object.values(p.$.apps).filter(de=>de.extensions.addedLinks.some(ie=>ie.targets.includes(ue))||de.extensions.addedComponents.some(ie=>ie.targets.includes(ue))).map(de=>de.id).reduce((de,ie)=>[...de,ie,...te(ie)],[]),Q=ue=>new Map(X(ue).map(de=>{const ie=p.$.apps[de];if(!(!ie||!ie.extensions.addedComponents.some(he=>he.targets.includes(ue))&&!ie.extensions.addedLinks.some(he=>he.targets.includes(ue))))return[de,{addedComponents:ie.extensions.addedComponents.filter(he=>he.targets.includes(ue)),addedLinks:ie.extensions.addedLinks.filter(he=>he.targets.includes(ue))}]}).filter(de=>de!==void 0)),q=ue=>[Y(ue)].reduce((ie,he)=>[...ie,he,...te(he)],[]),te=(ue,de=[])=>{if(!p.$.apps[ue])return[];if(de.includes(ue))return[];const ie=p.$.apps[ue].dependencies.extensions.exposedComponents.map(Y);return ie.reduce((he,me)=>[...he,...te(me,[...de,ue])],ie).filter(he=>he!==ue)},ne=()=>{const ue=["cloud-home-app"];return Object.values(p.$.apps).filter(de=>ue.includes(de.id))},se=()=>{const ue=X(c.S.DashboardPanelMenu),de=ne().map(he=>he.id),ie=he=>!de.includes(he.id);return Object.values(p.$.apps).filter(he=>ie(he)&&(he.preload||ue.includes(he.id)))}},9453:(Z,R,e)=>{"use strict";e.d(R,{Fe:()=>p,OO:()=>b,PW:()=>f,SY:()=>E,aY:()=>i,dt:()=>D,jk:()=>g,kl:()=>m,lq:()=>c,nl:()=>C,wy:()=>l,xM:()=>u,yL:()=>v});var n=e(43173),a=e(4745);function s(P,T="extension is not a link extension"){if(!isPluginExtensionLink(P))throw new Error(T)}function l(P,T){if(!m(P,T))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${P}/" (currently: "${T}"). Skipping the extension.`)}function o(P){if(!x(P))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function d(P){if(!g(P.configure))throw new Error(`Invalid extension "${P.title}". The "configure" property must be a function. Skipping the extension.`)}function i(P,T){for(const O of T)if(!y(P[O]))throw new Error(`Invalid extension "${P.title}". Property "${O}" must be a string and cannot be empty. Skipping the extension.`)}function c(P,T="The provided value is a Promise."){if(v(P))throw new Error(T)}function m(P,T){return!!(typeof T=="string"&&T.length>0&&T.startsWith(`/a/${P}/`))}function p({extensionPointId:P,pluginId:T}){return P.startsWith("grafana/")?!0:!!(P.startsWith(`plugins/${T}/`)||P.startsWith(`${T}/`))}function h(P){return P.match(/.*\/v\d+$/)}function r(P){return Object.values(PluginExtensionPoints).map(T=>T.toString()).includes(P)}function g(P){return P?typeof P=="function":!0}function y(P){return typeof P=="string"&&P.length>0}function v(P){return P instanceof Promise||typeof P=="object"&&P!==null&&"then"in P&&"catch"in P}function x(P){const T=I=>typeof I=="object"&&I!==null&&"$$typeof"in I;return typeof P=="function"||(I=>T(I)&&I.$$typeof===Symbol.for("react.memo"))(P)}const f=(P,T)=>{const O=T.meta?.extensions?.extensionPoints;return!O||!O.some(I=>I.id===P)},u=(P,T)=>{const O=T.meta?.dependencies?.extensions?.exposedComponents;return!O||!O.includes(P)},b=(P,T,O)=>{const I="Could not register link extension. Reason:",j=n.$.apps[P],W=j?j.extensions.addedLinks.find(({title:S})=>S===T.title):null;return j?W?(Array.isArray(T.targets)?T.targets:[T.targets]).every(S=>W.targets.includes(S))?(W.description!==T.description&&O.warning(a.cu),!1):(O.error(`${I} ${a.Bc}`),!0):(O.error(`${I} ${a.iS}`),!0):(O.error(`${I} ${a.$$(P)}`),!0)},E=(P,T,O)=>{const I="Could not register function extension. Reason:",j=n.$.apps[P],W=j?j.extensions.addedFunctions.find(({title:S})=>S===T.title):null;return j?W?(Array.isArray(T.targets)?T.targets:[T.targets]).every(S=>W.targets.includes(S))?(W.description!==T.description&&O.warning(a.cu),!1):(O.error(`${I} ${a.Bc}`),!0):(O.error(`${I} ${a.E5}`),!0):(O.error(`${I} ${a.$$(P)}`),!0)},D=(P,T,O)=>{const I="Could not register component extension. Reason:",j=n.$.apps[P],W=j?j.extensions.addedComponents.find(({title:S})=>S===T.title):null;return j?W?(Array.isArray(T.targets)?T.targets:[T.targets]).every(S=>W.targets.includes(S))?(W.description!==T.description&&O.warning(a.cu),!1):(O.error(`${I} ${a.Bc}`),!0):(O.error(`${I} ${a.FL}`),!0):(O.error(`${I} ${a.$$(P)}`),!0)},C=(P,T,O)=>{const I="Could not register exposed component extension. Reason:",j=n.$.apps[P],W=j?j.extensions.exposedComponents.find(({id:B})=>B===T.id):null;return j?W?W.title!==T.title?(O.error(`${I} ${a.sm}`),!0):(W.description!==T.description&&O.warning(a.cu),!1):(O.error(`${I} ${a.z5}`),!0):(O.error(`${I} ${a.$$(P)}`),!0)}},92391:(Z,R,e)=>{"use strict";e.d(R,{Kk:()=>h,PY:()=>r,TV:()=>c,d4:()=>p,oZ:()=>m});var n=e(78830),a=e(11594),s=e(65642),l=e(41097),o=e(58666);const d={},i={};function c(y){const v=d[y];if(v)return v;const x=p(y);if(!x)throw new Error(`Plugin ${y} not found`);return d[y]=g(x),y!==x.type&&(d[x.type]=d[y]),d[y]}function m(y){return!!p(y)}function p(y){const v=s.Ay.panels[y];if(!v){for(const x of Object.values(s.Ay.panels))if(x.aliasIDs?.includes(y))return x}return v}function h(y){return g(y)}function r(y){return i[y]}function g(y){(0,n.M)(y);const v=y.loadingStrategy??a.xf.fetch;return(0,o.j4)({path:y.module,version:y.info?.version,loadingStrategy:v,pluginId:y.id,moduleHash:y.moduleHash,translations:y.translations}).then(x=>{if(x.plugin)return x.plugin;throw(0,n.M)(x),new Error("missing export: plugin")}).then(x=>(x.meta=y,i[y.id]=x,x)).catch(x=>(console.warn("Error loading panel plugin: "+y.id,x),(0,l.W)(y,x)))}},19203:(Z,R,e)=>{"use strict";e.d(R,{GD:()=>l,QO:()=>i,ni:()=>d,sk:()=>o});var n=e(95027),a=e(98060);const s={};function l({path:p,version:h,loadingStrategy:r}){const g=c(p);g&&!s[g]&&(s[g]={version:encodeURI(h),loadingStrategy:r})}function o(p){const h=p;s[h]&&delete s[h],(0,n.o)(p)}function d(p,h=a.x8){const r=m(p);if(!r)return`${p}?_cache=${h}`;const y=s[r]?.version||h;return`${p}?_cache=${y}`}function i(p){const h=m(p);if(h)return s[h]}function c(p){const h=/\/?public\/plugins\/([^\/]+)\//,r=p.match(h);return r?r[1]:null}function m(p){const h=Object.keys(s).find(r=>p.includes(r));if(h)return h}},98060:(Z,R,e)=>{"use strict";e.d(R,{$b:()=>a,Bu:()=>s,XV:()=>n,x8:()=>l});const n="package",a=/^plugins.+\.css$/i,s=/^(text|application)\/(x-)?javascript(;|$)/,l=Date.now()},58666:(Z,R,e)=>{"use strict";e.d(R,{ui:()=>qf,cS:()=>Xf,j4:()=>cf});var n={};e.r(n),e.d(n,{AbstractLabelOperator:()=>Ja.D_,ActionType:()=>ha.X2,ActionVariableType:()=>ha.VR,AlertState:()=>ho.O,AnnotationChangeEvent:()=>yn.We,AnnotationEventFieldSource:()=>Hn.V,AppEvents:()=>Gr.r1,AppPlugin:()=>h.hX,ArrayDataFrame:()=>ot.f,ArrayVector:()=>wa,BinaryOperationID:()=>vn.k,BusEventBase:()=>un.a,BusEventWithPayload:()=>un.x,ByNamesMatcherMode:()=>ls.PP,CSVHeaderStyle:()=>St.F7,CSVReader:()=>St.i8,CircularDataFrame:()=>Yn.x,CircularVector:()=>Za.$,CoreApp:()=>h.Jk,CustomVariableSupport:()=>zr.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>wt.Pm,DEFAULT_SAML_NAME:()=>xs.En,DashboardCursorSync:()=>Ua.y,DashboardLoadedEvent:()=>yn.gc,DataFrameType:()=>Ba.m,DataFrameView:()=>le.R,DataHoverClearEvent:()=>yn.ql,DataHoverEvent:()=>yn.b_,DataLinkBuiltInVars:()=>za.c,DataLinkConfigOrigin:()=>Ha.x0,DataQueryErrorType:()=>p.v2,DataSelectEvent:()=>yn.LO,DataSourceApi:()=>p.mA,DataSourcePlugin:()=>p.tD,DataSourcePluginContextProvider:()=>Xo.p,DataSourceTestFailed:()=>yn.LL,DataSourceTestSucceeded:()=>yn.NI,DataSourceUpdatedSuccessfully:()=>yn.wE,DataSourceVariableSupport:()=>zr.ZV,DataTopic:()=>Tt.QR,DataTransformerID:()=>ia.F,DefaultTimeZone:()=>la.lE,DocsId:()=>Oa.f,EventBusSrv:()=>On.o,ExploreMode:()=>p.ZF,FALLBACK_COLOR:()=>Hr.F,FeatureState:()=>h.Ay,FieldCache:()=>ye.L,FieldColorModeId:()=>Hr.Y,FieldConfigEditorBuilder:()=>on.bk,FieldConfigOptionsRegistry:()=>Bn.K,FieldConfigProperty:()=>An.uo,FieldMatcherID:()=>kn.Ct,FieldNamePickerBaseNameMode:()=>Xt.X4,FieldType:()=>ya.PU,FrameGeometrySourceMode:()=>Tt.aG,FrameMatcherID:()=>kn.jR,GAUGE_DEFAULT_MAXIMUM:()=>xs.d1,GAUGE_DEFAULT_MINIMUM:()=>xs.tw,GrafanaPlugin:()=>c.Ud,GrafanaThemeType:()=>Bo.I,HttpRequestMethod:()=>ha.DO,ISO_8601:()=>rs.mt,InternalTimeZones:()=>Vs.g$,LanguageProvider:()=>p.Is,LayoutModes:()=>Ws.R,LegacyGraphHoverClearEvent:()=>Gr.Tq,LegacyGraphHoverEvent:()=>Gr.kb,LegacyMappingType:()=>Ka.An,LiveChannelConnectionState:()=>hs.ZF,LiveChannelEventType:()=>hs.o4,LiveChannelScope:()=>hs.qD,LiveChannelType:()=>hs.os,LoadingState:()=>pn.Gu,LocalStorageValueProvider:()=>Ln,LogLevel:()=>Vn.$b,LogRowContextQueryDirection:()=>Vn.ZF,LogSortOrderChangeEvent:()=>Vn.Df,LogsDedupDescription:()=>Vn._C,LogsDedupStrategy:()=>Tt.fY,LogsMetaKind:()=>Vn.tG,LogsSortOrder:()=>Tt.uH,LogsVolumeType:()=>Vn.Aj,MISSING_VALUE:()=>pe.p,MappingType:()=>zn.d,MatcherID:()=>kn.cV,MutableDataFrame:()=>pe.k,NodeGraphDataFrameFieldNames:()=>Rt.u,NullValueMode:()=>pn.UW,NumericLogLevel:()=>Vn.s5,OneClickMode:()=>Ha.yd,OrgRole:()=>fo.X,PageLayoutType:()=>Zn.k,PanelEvents:()=>Gr.ee,PanelOptionsEditorBuilder:()=>on.pv,PanelPlugin:()=>_e.m,PathValidationError:()=>an.DX,PluginContext:()=>uo.b,PluginContextProvider:()=>eo.a,PluginErrorCode:()=>c.ZK,PluginExtensionPoints:()=>qo.S,PluginExtensionTypes:()=>qo.u,PluginIncludeType:()=>c.ib,PluginLoadingStrategy:()=>c.xf,PluginSignatureStatus:()=>c.Ac,PluginSignatureType:()=>c.kv,PluginState:()=>c.pn,PluginType:()=>c.QE,ReducerID:()=>na.gy,Registry:()=>Fa.O,SetPanelAttentionEvent:()=>yn.Tp,SpecialValue:()=>pa.N,SpecialValueMatch:()=>zn.W,StandardVariableSupport:()=>zr.J$,Store:()=>Kt.i,StreamingDataFrame:()=>qe.k9,StreamingFrameAction:()=>qe.Kh,SupplementaryQueryType:()=>Vn.cF,SupportedTransformationType:()=>Ha.CC,SystemDateFormatsState:()=>Hs.JE,TIME_FORMAT:()=>la.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>ya.aI,TIME_SERIES_TIME_FIELD_NAME:()=>ya.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>ya.Bc,ThemeContext:()=>Xr.D,ThresholdsMode:()=>Uo.O,TransformationApplicabilityLevels:()=>pa.M,TransformerCategory:()=>Ps.m,UnaryOperationID:()=>wn._,VAR_CALC:()=>wt.k_,VAR_CELL_PREFIX:()=>wt.a_,VAR_FIELD_LABELS:()=>wt.nF,VAR_FIELD_NAME:()=>wt.py,VAR_SERIES_NAME:()=>wt.k3,ValueMatcherID:()=>kn.Js,VariableHide:()=>po.zL,VariableOrigin:()=>Ha.$0,VariableRefresh:()=>po.CO,VariableSort:()=>po.ZG,VariableSuggestionsScope:()=>Ha.uP,VariableSupportBase:()=>zr.xi,VariableSupportType:()=>zr.Qz,VisualizationSuggestionScore:()=>At.nQ,VisualizationSuggestionsBuilder:()=>At.v2,VisualizationSuggestionsListAppender:()=>At.NV,VizOrientation:()=>At.wV,addDurationToDate:()=>xr.Ri,addRow:()=>Ke.uY,amendTable:()=>Xe.c,anySeriesWithTimeField:()=>Ke.tP,anyToNumber:()=>La.t,applyFieldOverrides:()=>Fn.we,applyNullInsertThreshold:()=>Os.M,applyRawFieldOverrides:()=>Fn.K3,arrayToDataFrame:()=>ot.I,arrayUtils:()=>Vt,availableIconsIndex:()=>to.az,binaryOperators:()=>vn.b,booleanOverrideProcessor:()=>Xt.FM,booleanValueFormatter:()=>vs.Qc,buildHistogram:()=>aa.p3,cacheFieldDisplayNames:()=>gt.Fm,classicColors:()=>ln.t,closestIdx:()=>qe.Ls,colorManipulator:()=>ci.MV,compareArrayValues:()=>mt.J3,compareDataFrameStructures:()=>mt.bW,containsSearchFilter:()=>As.E,contentTypeOptions:()=>ha.Ur,convertOldAngularValueMappings:()=>Ka.bh,createDataFrame:()=>ve.EI,createDimension:()=>be,createFieldConfigRegistry:()=>Tr.O,createTheme:()=>Xs.a,dataFrameFromJSON:()=>lt.or,dataFrameToJSON:()=>lt.Nw,dataLinksOverrideProcessor:()=>Xt.Ch,dateMath:()=>ks,dateTime:()=>rs.KQ,dateTimeAsMoment:()=>rs.AN,dateTimeForTimeZone:()=>rs.oZ,dateTimeFormat:()=>yr.LE,dateTimeFormatISO:()=>yr.M7,dateTimeFormatTimeAgo:()=>yr.fq,dateTimeFormatWithAbbrevation:()=>yr._Q,dateTimeParse:()=>qr.b,decodeFieldValueEntities:()=>lt.t,decodeFieldValueEnums:()=>lt.EL,defaultActionConfig:()=>ha.mx,defaultCalcs:()=>na.C6,deprecationWarning:()=>dt.l,displayNameOverrideProcessor:()=>Xt.AM,doStandardCalcs:()=>na.H3,durationToMilliseconds:()=>xr.WT,ensureTimeField:()=>Gs.ks,escapeRegex:()=>It.$f,escapeStringForRegex:()=>It.jD,eventFactory:()=>cn.R,fieldColorModeRegistry:()=>En.uf,fieldMatchers:()=>Wn.sJ,fieldReducers:()=>na.AS,filterFieldConfigOverrides:()=>Br.aW,findCommonLabels:()=>jt.yO,findHighlightChunksInText:()=>Mt.Oq,findMatchesInText:()=>Mt.bs,findUniqueLabels:()=>jt.s6,fixCellTemplateExpressions:()=>wt.Zo,formatLabels:()=>jt.h6,formattedValueToString:()=>vs.cN,frameMatchers:()=>Wn.RE,fuzzySearch:()=>Qn.X,getActiveThreshold:()=>fa.yQ,getAllValuesFromDimension:()=>Ve,getBuiltInThemes:()=>jo.k,getColumnFromDimension:()=>we,getColumnsFromDimension:()=>Oe,getDataFrameRow:()=>ve.Yn,getDataSourceRef:()=>xt.p$,getDataSourceUID:()=>xt.Iz,getDefaultRelativeTimeRange:()=>la.Cn,getDefaultTimeRange:()=>la.E2,getDimensionByName:()=>ge,getDisplayProcessor:()=>Yt.J,getDisplayValueAlignmentFactors:()=>wt.XS,getFieldColorMode:()=>En.Hs,getFieldColorModeForField:()=>En.Qi,getFieldConfigWithMinMax:()=>Ht.xg,getFieldDataContextClone:()=>Fn.vd,getFieldDisplayName:()=>gt.Ct,getFieldDisplayValues:()=>wt.PI,getFieldDisplayValuesProxy:()=>Ea.F,getFieldMatcher:()=>Wn.NS,getFieldSeriesColor:()=>En.lz,getFieldTypeFromValue:()=>ve.oE,getFlotPairs:()=>Un,getFlotPairsConstant:()=>In,getFrameDisplayName:()=>gt.Ri,getFrameMatchers:()=>Wn.Dq,getHistogramFields:()=>aa.ix,getLinksSupplier:()=>Fn._M,getLocale:()=>rs.JK,getLocaleData:()=>rs.XN,getMinMaxAndDelta:()=>Ht.AP,getNextRefId:()=>Lt.M,getPanelOptionsWithDefaults:()=>Br.F,getProcessedDataFrames:()=>ve.Bt,getRawDisplayProcessor:()=>Yt.H,getRowUniqueId:()=>Ke.t9,getScaleCalculator:()=>Ht.jc,getSearchFilterScopedVar:()=>As.c,getSeriesTimeStep:()=>fn,getThemeById:()=>jo.g,getTimeField:()=>ve.KR,getTimeZone:()=>Lo.O,getTimeZoneGroups:()=>Vs.U3,getTimeZoneInfo:()=>Vs.QZ,getTimeZones:()=>Vs.P3,getUniqueFieldName:()=>gt.fk,getValueFormat:()=>vs.j_,getValueFormats:()=>vs.Ke,getValueFormatterIndex:()=>vs.uH,getValueFromDimension:()=>ze,getValueMatcher:()=>Wn.kK,getWeekdayIndex:()=>rs.xQ,getWeekdayIndexByEnglishName:()=>rs.pp,getZone:()=>Vs.HD,guessDecimals:()=>Qt.E,guessFieldTypeForField:()=>ve.dF,guessFieldTypeFromNameAndValue:()=>ve.by,guessFieldTypeFromValue:()=>ve.HW,guessFieldTypes:()=>ve.XQ,hasLinks:()=>wt.eG,hasLogsContextSupport:()=>Vn.Ol,hasLogsContextUiSupport:()=>Vn.wj,hasMsResolution:()=>gn,hasQueryExportSupport:()=>Ja.Ee,hasQueryImportSupport:()=>Ja.FL,hasQueryModificationSupport:()=>Vn._0,hasSupplementaryQuerySupport:()=>Vn.Nc,hasTimeField:()=>Ke.S1,hasToggleableQueryFiltersSupport:()=>Vn.FP,histogramBucketSizes:()=>aa.rW,histogramFieldInfo:()=>aa.Rt,histogramFieldsToFrame:()=>aa.cg,histogramFrameBucketMaxFieldName:()=>aa.dA,histogramFrameBucketMinFieldName:()=>aa.d$,histogramTransformer:()=>aa.OA,httpMethodOptions:()=>ha.ki,identityOverrideProcessor:()=>Xt.hS,incrRound:()=>aa.ZU,incrRoundDn:()=>aa.rs,incrRoundUp:()=>aa.Uh,intervalToAbbreviatedDurationString:()=>xr.dU,isBooleanUnit:()=>vs.j9,isCustomFieldProp:()=>Br.TQ,isDataFrame:()=>ve.ci,isDataFrameWithValue:()=>ve.LI,isDataSourcePluginContext:()=>or.S,isDataSourceRef:()=>xt.fN,isDateTime:()=>rs.Ar,isDateTimeInput:()=>rs.u8,isEmptyObject:()=>Jt.R,isEqualityOrMultiOperator:()=>ys.RU,isHistogramFrameBucketMaxFieldName:()=>aa.H1,isHistogramFrameBucketMinFieldName:()=>aa.NX,isIconName:()=>to.n6,isLikelyAscendingVector:()=>Ta.g2,isLiveChannelJoinEvent:()=>hs.Cz,isLiveChannelLeaveEvent:()=>hs.jQ,isLiveChannelMessageEvent:()=>hs.Z7,isLiveChannelStatusEvent:()=>hs.ew,isObject:()=>pn.Gv,isReducerID:()=>na.Em,isStandardFieldProp:()=>Br.nx,isSystemOverride:()=>An.Ow,isSystemOverrideWithRef:()=>An.ZW,isTableData:()=>ve.pH,isTimeSeriesField:()=>Ke.hF,isTimeSeriesFrame:()=>Ke.aH,isTimeSeriesFrames:()=>Ke.jq,isTruthy:()=>pn.zz,isUnsignedPluginSignature:()=>fr.x,isValidDate:()=>xr.vd,isValidDuration:()=>xr.di,isValidGoDuration:()=>xr.pp,isValidGrafanaDuration:()=>xr.V3,isValidLiveChannelAddress:()=>hs.aj,joinHistograms:()=>aa.EO,localTimeFormat:()=>Hs.Od,locale:()=>vs.Hg,locationUtil:()=>Gn.I,makeClassES5Compatible:()=>ss.Y,makeTimeRange:()=>la.HW,mapInternalLinkToExplore:()=>za.u,matchAllLabels:()=>jt._p,matchPluginId:()=>_s._,monacoLanguageRegistry:()=>lr.l,nullToValue:()=>Zs.C,numberOverrideProcessor:()=>Xt.m0,objRemoveUndefined:()=>Jt.w,onUpdateDatasourceJsonDataOption:()=>xt.PG,onUpdateDatasourceJsonDataOptionChecked:()=>xt.EX,onUpdateDatasourceJsonDataOptionSelect:()=>xt.BD,onUpdateDatasourceOption:()=>xt.zX,onUpdateDatasourceResetOption:()=>xt.yV,onUpdateDatasourceSecureJsonDataOption:()=>xt.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>xt.wY,outerJoinDataFrames:()=>Ta.Fd,parseDuration:()=>xr.E9,parseFlags:()=>Mt.bQ,parseLabels:()=>jt.Xy,parseLiveChannelAddress:()=>hs.DG,patchArrayVectorProrotypeMethods:()=>bn,preProcessPanelData:()=>ve.N$,preferredVisualizationTypes:()=>pn.Nx,rangeUtil:()=>Ys,readCSV:()=>St.Jh,reduceField:()=>na.Nw,renderLegendFormat:()=>Ia.j,renderMarkdown:()=>Ut.G,renderTextPanelMarkdown:()=>Ut.P,restoreCustomOverrideRules:()=>Br.H9,reverseDataFrame:()=>ve.q7,reverseParseDuration:()=>xr.Q7,reverseScopeFilterOperatorMap:()=>ys.Dv,roundDecimals:()=>Qt.h,scaledUnits:()=>vs.yP,scopeFilterOperatorMap:()=>ys.n9,selectOverrideProcessor:()=>Xt.hL,serializeStateToUrlParam:()=>Wa.Pp,setLocale:()=>rs.xS,setTimeZoneResolver:()=>Lo.G,setWeekStart:()=>rs.$D,shallowCompare:()=>mt.ab,simpleCountUnit:()=>vs.UR,sortDataFrame:()=>ve.ES,sortThresholds:()=>fa.RU,standardEditorsRegistry:()=>rn.D,standardFieldConfigEditorRegistry:()=>rn.G,standardTransformers:()=>va.c,standardTransformersRegistry:()=>Ps.h,store:()=>Kt.M,stringFormater:()=>vs.cH,stringOverrideProcessor:()=>Xt.OU,stringStartsAsRegEx:()=>It.AP,stringToJsRegex:()=>It.dO,stringToMs:()=>It.dc,systemDateFormats:()=>Hs.WC,textUtil:()=>an.sQ,thresholdsOverrideProcessor:()=>Xt.N7,throwIfAngular:()=>m.M,timeZoneAbbrevation:()=>yr.jw,timeZoneFormatUserFriendly:()=>Vs.le,toCSV:()=>St._O,toDataFrame:()=>ve.Vc,toDataFrameDTO:()=>ve.Kl,toDuration:()=>rs.Ah,toFilteredDataFrameDTO:()=>ve.By,toFixed:()=>vs.Mg,toFixedScaled:()=>vs.gZ,toFixedUnit:()=>vs.G8,toFloatOrUndefined:()=>It.$D,toIconName:()=>to.Uo,toIntegerOrUndefined:()=>It.vb,toLegacyResponseData:()=>ve.w3,toLiveChannelId:()=>hs.Qp,toNumberString:()=>It.kT,toOption:()=>bt.z,toPascalCase:()=>It.MX,toURLRange:()=>Wa.sQ,toUtc:()=>rs.yT,transformDataFrame:()=>Ga.m,trimTable:()=>Xe.F,unEscapeStringFromRegex:()=>It.xb,unaryOperators:()=>wn.j,unitOverrideProcessor:()=>Xt.lG,updateDatasourcePluginJsonDataOption:()=>xt.lO,updateDatasourcePluginOption:()=>xt.pN,updateDatasourcePluginResetOption:()=>xt.QP,updateDatasourcePluginSecureJsonDataOption:()=>xt.wp,urlUtil:()=>Wa.kM,useFieldOverrides:()=>Fn.rJ,usePluginContext:()=>Ur.Q,userHasAllPermissions:()=>Ra.Fj,userHasAnyPermission:()=>Ra.jW,userHasPermission:()=>Ra.ZU,userHasPermissionInMetadata:()=>Ra.T6,validateFieldConfig:()=>Fn.BF,validatePath:()=>an.iQ,valueMappingsOverrideProcessor:()=>Xt.xT,valueMatchers:()=>Wn.hI,vectorator:()=>os.E,withLoadingIndicator:()=>Ca.k});var a={};e.r(a),e.d(a,{CopyPanelEvent:()=>Xa.ah,DataSourcePicker:()=>Yi.s,DataSourceWithBackend:()=>Pr.iy,EchoEventType:()=>Va.on,EmbeddedDashboard:()=>wo.f,FakeEchoSrv:()=>Va.c_,FolderPicker:()=>mo.d,GrafanaBootConfig:()=>y.p,HealthCheckError:()=>Pr.b1,HealthStatus:()=>Pr.VQ,HistoryWrapper:()=>Aa.K9,LocationServiceProvider:()=>Aa._K,MetaAnalyticsEventName:()=>Wo.n_,PanelDataErrorView:()=>Ai.a,PanelRenderer:()=>_i.m,PluginPage:()=>ki.V,QueryEditorWithMigration:()=>Xi,RefreshEvent:()=>Xa._,RuntimeDataSource:()=>qs,ScopesContext:()=>Er.j,StreamingFrameAction:()=>nr.Kh,ThemeChangedEvent:()=>Xa.E8,TimeRangeUpdatedEvent:()=>Xa.sR,config:()=>y.$,createDataSourcePluginEventProperties:()=>Ko.y,createMonitoringLogger:()=>Qr.DW,createPluginEventProperties:()=>Ko.L,createQueryRunner:()=>kr.d,featureEnabled:()=>ui.a,frameToMetricFindValue:()=>Ri.$h,getAppEvents:()=>Xa.J7,getBackendSrv:()=>ns.AI,getCorrelationsService:()=>Vo.r,getDataSourceSrv:()=>ps.l,getEchoSrv:()=>Va.x$,getGrafanaLiveSrv:()=>nr.oF,getLimitedComponentsToRender:()=>bs.CP,getLocationSrv:()=>ga.X,getObservablePluginComponents:()=>qa.z,getObservablePluginLinks:()=>Qs.m,getPluginImportUtils:()=>di.o,getRunRequest:()=>kr.XJ,getTemplateSrv:()=>is.w,hasAllPermissions:()=>Ji,hasAnyPermission:()=>go,hasPermission:()=>Wr,hasPermissionInMetadata:()=>io,isExperimentViewEvent:()=>Wo.p6,isExpressionReference:()=>Pr.s9,isFetchError:()=>ns.NF,isInteractionEvent:()=>Wo.fX,isMigrationHandler:()=>pr.LZ,isPageviewEvent:()=>Wo.nB,isPluginExtensionComponent:()=>bs.aR,isPluginExtensionLink:()=>bs.DG,loadPluginCss:()=>di.PL,locationSearchToObject:()=>Aa.SE,locationService:()=>Aa.Ny,logDebug:()=>Qr.MD,logError:()=>Qr.vV,logInfo:()=>Qr.fH,logMeasurement:()=>Qr.l$,logWarning:()=>Qr.FF,migrateQuery:()=>pr.aX,migrateRequest:()=>pr.xt,navigationLogger:()=>Aa.Lc,registerEchoBackend:()=>Va.pl,renderLimitedComponents:()=>bs.RC,reportExperimentView:()=>No.Xp,reportInteraction:()=>No.rR,reportMetaAnalytics:()=>No.G$,reportPageview:()=>No.Jy,setAppEvents:()=>Xa.H8,setBackendSrv:()=>ns.u5,setChromeHeaderHeightHook:()=>ei._,setCorrelationsService:()=>Vo.l,setCurrentUser:()=>Es.l,setDataSourceSrv:()=>ps.h,setEchoSrv:()=>Va.H2,setEmbeddedDashboard:()=>wo.p,setFolderPicker:()=>mo.N,setGrafanaLiveSrv:()=>nr.S8,setLocationService:()=>Aa.vG,setLocationSrv:()=>ga.T,setPluginComponentHook:()=>qn.A,setPluginComponentsHook:()=>Ma.R,setPluginFunctionsHook:()=>cr.U,setPluginImportUtils:()=>di.se,setPluginLinksHook:()=>js.q,setQueryRunnerFactory:()=>kr.HC,setReturnToPreviousHook:()=>ji._,setRunRequest:()=>kr.pC,setTemplateSrv:()=>is.d,toDataQueryError:()=>_r.u,toDataQueryResponse:()=>Ri.bE,useChromeHeaderHeight:()=>ei.k,useLocationService:()=>Aa.at,usePluginComponent:()=>qn.S,usePluginComponents:()=>Ma.f,usePluginFunctions:()=>cr.W,usePluginInteractionReporter:()=>Fo.G,usePluginLinks:()=>js.U,usePluginUserStorage:()=>Co.D,useReturnToPrevious:()=>ji.i,useScopes:()=>Er.b});var s={};e.r(s),e.d(s,{ScaleDistributionEditor:()=>Kr.W1,StackingEditor:()=>yi.m,addAxisConfig:()=>Kr.rg,addAxisPlacement:()=>Kr.Wq,addAxisWidth:()=>Kr.T4,addHideFrom:()=>Fi.e,addLegendOptions:()=>ai.H,addStackingConfig:()=>yi.I,addTextSizeOptions:()=>Ro.I,addTooltipOptions:()=>wi.D});var l={};e.r(l),e.d(l,{getNextCharacter:()=>ft,getPreviousCousin:()=>ct});var o={};e.r(o),e.d(o,{ALERTING_COLOR:()=>oi.xj,Alert:()=>Go.F,AlertingSettings:()=>ac,AsyncMultiSelect:()=>Si.Iv,AsyncSelect:()=>Si.DW,AsyncVirtualizedSelect:()=>Si.gZ,AutoSaveField:()=>Pi,AutoSizeInput:()=>Fr.D,Avatar:()=>Gu.e,AxisPlacement:()=>Tt.vM,Badge:()=>dd.E,BarAlignment:()=>Tt.Nj,BarGauge:()=>ts.xE,BarGaugeDisplayMode:()=>Tt.eX,BarValueVisibility:()=>Tt.yL,BigValue:()=>da.yV,BigValueColorMode:()=>da.yp,BigValueGraphMode:()=>da.$p,BigValueJustifyMode:()=>da.F8,BigValueTextMode:()=>da.SV,Box:()=>qc.a,BracesPlugin:()=>Wh,BrowserLabel:()=>Hl.J,Button:()=>$s.$n,ButtonCascader:()=>as,ButtonGroup:()=>Xc.e,ButtonSelect:()=>fl.f,CallToActionCard:()=>kd.c,Card:()=>ur.Z,CardContainer:()=>Fs.Q,Carousel:()=>Qa.F,Cascader:()=>fs.v,CertificationKey:()=>su.K,Checkbox:()=>ic.S,ClearPlugin:()=>Nh.v,ClickOutsideWrapper:()=>_d.N,ClipboardButton:()=>cs.b,ClipboardPlugin:()=>Kh.s,CodeEditor:()=>Ee.B,CodeEditorSuggestionItemKind:()=>nt.q,CollapsableSection:()=>zc.M,Collapse:()=>Ml.S,ColorPicker:()=>Ks.sk,ColorPickerInput:()=>ir.i,Combobox:()=>Pu.G,CompletionItemKind:()=>Ch.I,ConfirmButton:()=>mn.Z,ConfirmModal:()=>Wl.u,Container:()=>oc.mc,ContextMenu:()=>Fl.t,ControlledCollapse:()=>Ml.a,Counter:()=>Tn.p,CustomHeadersSettings:()=>au.P,CustomScrollbar:()=>ba.E,DEFAULT_ANNOTATION_COLOR:()=>oi.Mk,DOMUtil:()=>l,DataLinkButton:()=>tr.R,DataLinkInput:()=>eu.l,DataLinksContextMenu:()=>tu.e,DataLinksInlineEditor:()=>Xd.e,DataLinksInlineEditorBase:()=>qd.J,DataSourceHttpSettings:()=>nc.t,DatePicker:()=>Ll.l,DatePickerWithInput:()=>zi.l,DateTimePicker:()=>Bl.K,DeleteButton:()=>Dn.e,Divider:()=>fd.c,DrawStyle:()=>Tt.GR,Drawer:()=>cu._,Dropdown:()=>Gl.m,ElementSelectionContext:()=>Bd._,EmptySearchResult:()=>yo.Z,EmptyState:()=>Cs.p,ErrorBoundary:()=>Sl.tH,ErrorBoundaryAlert:()=>Sl.Xw,ErrorWithStack:()=>ul.D,EventBusPlugin:()=>Xu.K,EventsCanvas:()=>Ju.a,EventsWithValidation:()=>uc.Pw,FIXED_UNIT:()=>vd.s,FadeTransition:()=>sc.A,FeatureBadge:()=>Qc.y,FeatureInfoBox:()=>dl,Field:()=>il.D,FieldArray:()=>nd,FieldLinkList:()=>xc,FieldSet:()=>$l.n,FieldValidationMessage:()=>mu.P,FileDropzone:()=>hd.gH,FileDropzoneDefaultChildren:()=>hd.wI,FileListItem:()=>Fu.I,FileUpload:()=>Ku.e,FilterInput:()=>Lr.Z,FilterPill:()=>Cl.m,Form:()=>Dc.l,FormattedValueDisplay:()=>Il.i,FullWidthButtonContainer:()=>Hd,Gauge:()=>gs._,GlobalStyles:()=>Nc.k,Graph:()=>jc,GraphContextMenu:()=>Rc,GraphContextMenuHeader:()=>yd,GraphGradientMode:()=>Tt.on,GraphNG:()=>Md,GraphSeriesToggler:()=>lh,GraphThresholdsStyleMode:()=>Tt.Ly,GraphWithLegend:()=>oh,Grid:()=>ed.x,HorizontalGroup:()=>oc.Gy,Icon:()=>Nr.I,IconButton:()=>tn.K,IndentationPlugin:()=>Fh.T,InfoBox:()=>Hc.w,InlineField:()=>kc.I,InlineFieldRow:()=>xu.C,InlineFormLabel:()=>Hu.I,InlineLabel:()=>yu.c,InlineSegmentGroup:()=>vu.e,InlineSwitch:()=>Ec.K,InlineToast:()=>Yr.r,Input:()=>wl.p,InputControl:()=>fu.e,InteractiveTable:()=>ol.j,JSONFormatter:()=>ec.B,JsonExplorer:()=>tc.O,KeyboardPlugin:()=>qu.Z,Label:()=>Tc.J,LegacyForms:()=>Fd,LegacyInputStatus:()=>Li.O,Legend:()=>ms.s,LegendDisplayMode:()=>Tt.lm,LineInterpolation:()=>Tt.dx,Link:()=>ea.N,LinkButton:()=>$s.z9,List:()=>Ul.B,LoadingBar:()=>jr.G,LoadingPlaceholder:()=>Dr._,Marker:()=>Yu.p,Menu:()=>Yd.W,MenuGroup:()=>Jd.r,MenuItem:()=>Gc.D,Modal:()=>vt.a,ModalHeader:()=>Pt.r,ModalRoot:()=>Le.EO,ModalTabContent:()=>ae,ModalTabsHeader:()=>fe.J,ModalsContext:()=>Le.wE,ModalsController:()=>Le.$s,ModalsProvider:()=>Le.YO,MultiCombobox:()=>ju,MultiSelect:()=>Si.KF,NO_DATA_COLOR:()=>oi.nO,NewlinePlugin:()=>wh.O,NodeGraphDataFrameFieldNames:()=>Wd,OK_COLOR:()=>oi.Xw,PENDING_COLOR:()=>oi.ct,PageToolbar:()=>Ze.d,Pagination:()=>ll.d,PanelChrome:()=>Di.NR,PanelChromeLoadingIndicator:()=>Ci.I,PanelContainer:()=>th._,PanelContextProvider:()=>Sr.XF,PanelContextRoot:()=>Sr.e4,PlotLegend:()=>Ic.$,PluginSignatureBadge:()=>Rl.B,PointVisibility:()=>Tt.yL,Popover:()=>Kn.A,PopoverController:()=>Rn.I,Portal:()=>ca.ZL,PortalContainer:()=>ca.qB,QueryField:()=>Nl.X,REGION_FILL_ALPHA:()=>oi.UJ,RadioButtonDot:()=>Uu.J,RadioButtonGroup:()=>Bu.z,RadioButtonList:()=>Wu.a,RangeSlider:()=>uu.F,ReactMonacoEditor:()=>et.m,ReactUtils:()=>Nt,RefreshPicker:()=>ao.cC,RelativeTimeRangePicker:()=>Vu.N,RenderUserContentAsHTML:()=>ds.I,RunnerPlugin:()=>Vh.U,SCHEMA:()=>hc.yx,ScaleDirection:()=>Tt.ON,ScaleDistribution:()=>Tt.L4,ScaleOrientation:()=>Tt.Lt,ScrollContainer:()=>So.P,SearchFunctionType:()=>Ih.T,SecretInput:()=>ud.L4,SecretTextArea:()=>Nu.lp,SecureSocksProxySettings:()=>hf.Y,Segment:()=>ru.Y,SegmentAsync:()=>bc.s,SegmentInput:()=>ou.o,SegmentSection:()=>lu.L,SegmentSelect:()=>iu.a,Select:()=>Si.l6,SelectContainer:()=>Si.KA,SelectMenuOptions:()=>ad.o5,SelectionShortcutsPlugin:()=>Kd.l,SeriesColorPicker:()=>Ks.Dp,SeriesColorPickerPopover:()=>ar.o,SeriesColorPickerPopoverWithTheme:()=>ar.t,SeriesIcon:()=>nu.p,SeriesTable:()=>gr.o,SeriesTableRow:()=>gr.g,SeriesVisibilityChangeBehavior:()=>ri.K,SeriesVisibilityChangeMode:()=>eh.B,SetInterval:()=>at.u,SlatePrism:()=>$h.D,SlideOutTransition:()=>hl.n,Slider:()=>Zc,Space:()=>td.$,Sparkline:()=>_a.O,Spinner:()=>Or.y,Stack:()=>Mi.B,StackingMode:()=>Tt.gs,StatsPicker:()=>dr.S,SuggestionsPlugin:()=>zh.Pz,Switch:()=>Ec.d,TLSAuthSettings:()=>Pc.j,Tab:()=>Nn.o,TabContent:()=>ja.J,TabbedContainer:()=>Sa.q,Table:()=>ut.X,TableCellDisplayMode:()=>Tt.ob,TableCellInspector:()=>Et.s,TableCellInspectorMode:()=>Et.B,TableInputCSV:()=>nn,TabsBar:()=>Pn.U,Tag:()=>cl.v,TagList:()=>Dl.L,TagsInput:()=>Ls.u,Text:()=>Cc.E,TextArea:()=>Wt.f,TextLink:()=>Ol.Y,ThemeContext:()=>Xr.D,TimeOfDayPicker:()=>jl.R,TimePickerTooltip:()=>lo.xS,TimeRangeInput:()=>wu.b,TimeRangeLabel:()=>$i.f,TimeRangePicker:()=>lo.$6,TimeRangeProvider:()=>rl.A,TimeSeries:()=>Rd,TimeZonePicker:()=>xi.U,ToggleAllState:()=>rc.X,Toggletip:()=>ra.G,ToolbarButton:()=>pu.I,ToolbarButtonRow:()=>gu.U,Tooltip:()=>$o.m,TooltipDisplayMode:()=>Tt.$N,TooltipPlugin:()=>Ph,TooltipPlugin2:()=>Zu.xl,UPLOT_AXIS_FONT_SIZE:()=>ku.pi,UPlotChart:()=>md.Z,UPlotConfigBuilder:()=>gd.e,UnitPicker:()=>no.p,UserIcon:()=>$u.n,UsersIndicator:()=>zu.q,ValuePicker:()=>Vl.i,VerticalGroup:()=>oc.gW,VerticalTab:()=>_n,VirtualizedSelect:()=>Si.ip,VizLayout:()=>so.KU,VizLegend:()=>Tl.t,VizLegendListItem:()=>sr.M,VizRepeater:()=>xo.S,VizTooltip:()=>si,VizTooltipContainer:()=>Mr.o,WeekStartPicker:()=>zo.l6,WithContextMenu:()=>Zd.n,XYCanvas:()=>lc._,ZoomPlugin:()=>xh,attachDebugger:()=>Ah.h,buildScaleKey:()=>Td,calculateFontSize:()=>zl.Vr,clearButtonStyles:()=>$s.my,colors:()=>oi.Tj,commonOptionsBuilder:()=>s,convertOldAngularValueMapping:()=>ql.I1,createLogger:()=>Rh.h,createPointerDistance:()=>Ud.b,defaultIntervals:()=>ao.cb,fieldMatchersUI:()=>rr.g,fuzzyMatch:()=>jh.I,getAvailableIcons:()=>dc.GO,getCanvasContext:()=>zl.Yc,getCardStyles:()=>ur.H,getCellLinks:()=>Sh.k,getDragStyles:()=>Qu.l,getFieldTypeIcon:()=>dc.SS,getFieldTypeIconName:()=>dc.lV,getGraphFieldOptions:()=>pd.P,getInputStyles:()=>wl.n,getPortalContainer:()=>ca.gF,getScrollbarWidth:()=>Mh,getSelectStyles:()=>sd.J,getTagColor:()=>Wc.yC,getTagColorIndexFromName:()=>Wc.JF,getTagColorsFromName:()=>Wc.MC,getTextColorForAlphaBackground:()=>oi.mZ,getTextColorForBackground:()=>oi.sg,getTheme:()=>Nd,getWeekStart:()=>zo.rL,graphFieldOptions:()=>pd.t,graphTickFormatter:()=>Oi,graphTimeFormat:()=>xd,hasValidationEvent:()=>uc.K,isIconSize:()=>dc.rJ,isWeekStart:()=>zo.rE,linkModelToContextMenuItems:()=>Th.J,logOptions:()=>Lh,makeFragment:()=>hc.dF,makeValue:()=>hc.mO,measureText:()=>zl.kD,mockTheme:()=>Bh,mockThemeContext:()=>es.fq,preparePlotFrame:()=>_l,regexValidation:()=>uc.RP,resetSelectStyles:()=>pi.A,sharedInputStyle:()=>hu.Xb,sharedSingleStatMigrationHandler:()=>ql._$,sharedSingleStatPanelChangedHandler:()=>ql.gl,sortedColors:()=>oi.Ih,styleMixins:()=>Vi,stylesFactory:()=>gi.N,toIconName:()=>to.Uo,useElementSelection:()=>Bd.y,useForceUpdate:()=>Oh.C,useGraphNGContext:()=>ff,usePanelContext:()=>Sr.d2,usePointerDistance:()=>Ud.C,useSplitter:()=>_u.h,useStyles:()=>es.IS,useStyles2:()=>es.of,useTheme:()=>es.DP,useTheme2:()=>es.$j,validate:()=>uc.tf,variableSuggestionToCodeEditorSuggestion:()=>Ct.O,withErrorBoundary:()=>Sl.Xc,withTheme:()=>es.SL,withTheme2:()=>es.cV});var d={};e.r(d),e.d(d,{default:()=>kh});var i={};e.r(i),e.d(i,{getPrecision:()=>$d,getScaledDecimals:()=>Zh,getStringPrecision:()=>zd,grafanaTimeFormat:()=>Xh,logp:()=>qh,tickStep:()=>Jh});var c=e(11594),m=e(78830),p=e(94644),h=e(1906),r=e(57002),g=e(92745),y=e(43173);const me={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,28947)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(5074),e.e(5610),e.e(3766)]).then(e.bind(e,65610)),"core:plugin/dashboard":async()=>await e.e(9473).then(e.bind(e,39473)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(5074),e.e(8393),e.e(6260),e.e(1717)]).then(e.bind(e,96260)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,90400)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,51309)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7445),e.e(590),e.e(9404)]).then(e.bind(e,40590)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,95637)),"core:plugin/prometheus":async()=>await Promise.all([e.e(5074),e.e(8393),e.e(9546)]).then(e.bind(e,38349)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(5074),e.e(4737)]).then(e.bind(e,30876)),"core:plugin/text":async()=>await e.e(404).then(e.bind(e,16373)),"core:plugin/timeseries":async()=>await Promise.all([e.e(362),e.e(428),e.e(5428),e.e(9170),e.e(563)]).then(e.bind(e,55569)),"core:plugin/trend":async()=>await Promise.all([e.e(5428),e.e(2666)]).then(e.bind(e,96827)),"core:plugin/state-timeline":async()=>await Promise.all([e.e(8706),e.e(428),e.e(5974),e.e(6199)]).then(e.bind(e,44372)),"core:plugin/status-history":async()=>await Promise.all([e.e(8706),e.e(428),e.e(5974),e.e(8259)]).then(e.bind(e,24181)),"core:plugin/candlestick":async()=>await Promise.all([e.e(362),e.e(428),e.e(5428),e.e(9170),e.e(3090)]).then(e.bind(e,80959)),"core:plugin/xychart":async()=>await Promise.all([e.e(348),e.e(5594)]).then(e.bind(e,87254)),"core:plugin/geomap":async()=>await Promise.all([e.e(362),e.e(8706),e.e(3474),e.e(6104),e.e(8550),e.e(190)]).then(e.bind(e,98550)),"core:plugin/canvas":async()=>await Promise.all([e.e(6104),e.e(7523)]).then(e.bind(e,51273)),"core:plugin/dashlist":async()=>await e.e(8995).then(e.bind(e,30783)),"core:plugin/alertlist":async()=>await e.e(3375).then(e.bind(e,12915)),"core:plugin/annolist":async()=>await e.e(4979).then(e.bind(e,80537)),"core:plugin/heatmap":async()=>await Promise.all([e.e(362),e.e(407),e.e(5995),e.e(428),e.e(348),e.e(5857)]).then(e.bind(e,17933)),"core:plugin/table":async()=>y.$.featureToggles.tableNextGen?await Promise.all([e.e(9227),e.e(7794)]).then(e.bind(e,14019)):await e.e(3525).then(e.bind(e,45730)),"core:plugin/news":async()=>await e.e(4940).then(e.bind(e,71786)),"core:plugin/live":async()=>await e.e(5413).then(e.bind(e,8149)),"core:plugin/stat":async()=>await Promise.resolve().then(e.bind(e,75663)),"core:plugin/datagrid":async()=>await Promise.all([e.e(7445),e.e(2218),e.e(5939)]).then(e.bind(e,42218)),"core:plugin/debug":async()=>await Promise.all([e.e(362),e.e(2770)]).then(e.bind(e,54952)),"core:plugin/flamegraph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(20),e.e(5686)]).then(e.bind(e,27281)),"core:plugin/gettingstarted":async()=>await e.e(9142).then(e.bind(e,38627)),"core:plugin/gauge":async()=>await Promise.resolve().then(e.bind(e,71843)),"core:plugin/piechart":async()=>await e.e(6105).then(e.bind(e,96894)),"core:plugin/bargauge":async()=>await e.e(3851).then(e.bind(e,62493)),"core:plugin/barchart":async()=>await Promise.all([e.e(8706),e.e(3124)]).then(e.bind(e,24131)),"core:plugin/logs":async()=>await Promise.all([e.e(2516),e.e(8368),e.e(7884)]).then(e.bind(e,2001)),"core:plugin/logs-new":async()=>await Promise.all([e.e(2516),e.e(8368),e.e(3976)]).then(e.bind(e,6567)),"core:plugin/traces":async()=>await Promise.all([e.e(407),e.e(5995),e.e(20),e.e(1213),e.e(4301)]).then(e.bind(e,3627)),"core:plugin/welcome":async()=>await e.e(8463).then(e.bind(e,21369)),"core:plugin/nodeGraph":async()=>await Promise.all([e.e(3474),e.e(9147),e.e(7317)]).then(e.bind(e,39053)),"core:plugin/histogram":async()=>await e.e(323).then(e.bind(e,65672))};var ce=e(63629),Pe=e(19203),Ie=e(59511),Se=e(65024),Me=e(82093);const Te=window.System;var Ge=e(34796),Qe=e.n(Ge),tt=e(54087),ke=e(80851),He=e(32176),Re=e(31221),Ne=e(91520),Ae=e(92275),Ue=e(82013),Be=e(2341),We=e(19538),_e=e(16207),Xe=e(15083),le=e(88673),ye=e(10279),pe=e(18700),ve=e(41119);const be=(Ce,Fe)=>({name:Ce,columns:Fe}),Oe=Ce=>Ce.columns,we=(Ce,Fe)=>Ce.columns[Fe],ze=(Ce,Fe,Je)=>Ce.columns[Fe].values[Je],Ve=(Ce,Fe,Je)=>Ce.columns.map(it=>it.values[Je]),ge=(Ce,Fe)=>Ce[Fe];var Ke=e(17503),qe=e(51388),ot=e(27359),lt=e(77154),mt=e(76732),Lt=e(39796),Tt=e(739),It=e(8934),Mt=e(38388),Ut=e(67458),an=e(63704),cn=e(36819),un=e(68388),On=e(19379),yn=e(57852),En=e(76637),Bn=e(76803),fa=e(36394),Fn=e(60519),Ea=e(7102),gt=e(16515),Ht=e(79118),wt=e(44232),Yt=e(11576),rn=e(53543),Xt=e(38809),on=e(52205),pn=e(28105);function Un({xField:Ce,yField:Fe,nullValueMode:Je}){const it=Ce.values,ht=Fe.values,pt=it.length;if(ht.length!==pt)throw new Error("Unexpected field length");const zt=Je===pn.UW.Ignore,Ft=Je===pn.UW.AsZero,qt=[];for(let sn=0;sn<pt;sn++){const hn=it[sn];let Sn=ht[sn];if(Sn===null){if(zt)continue;Ft&&(Sn=0)}hn!==null&&qt.push([hn,Sn])}return qt}function In(Ce,Fe){if(!Fe.from||!Fe.to||!Ce||Ce.length===0)return[];const Je=Fe.from.valueOf(),it=Fe.to.valueOf(),ht=Ce[0][1];return[[Je,ht],[it,ht]]}var Gn=e(92138),Wa=e(83175),za=e(38036),Oa=e(28882),ss=e(35814),La=e(13227),Ca=e(47520),Ka=e(35987),As=e(94452),Ia=e(428),_s=e(8134),Fa=e(42954),xt=e(48480),dt=e(37615),St=e(68125),jt=e(71642),Qt=e(79243),Jt=e(3594),ln=e(33985);const fn=Ce=>{let Fe,Je,it=Number.MAX_VALUE;for(let ht=0;ht<Ce.values.length;ht++){const pt=Ce.values[ht];if(Fe!==void 0){const zt=pt-Fe;Je===void 0&&(it=zt),zt<it&&(it=zt)}Fe=pt}return it},gn=Ce=>{for(let Fe=0;Fe<Ce.values.length;Fe++){const Je=Ce.values[Fe];if(Je!=null){const it=Je.toString();if(it.length===13&&it%1e3!==0)return!0}}return!1};var vn=e(12823),wn=e(48233),Rt=e(14613),bt=e(47184),Vt=e(46635),Kt=e(78012),Dt=e(74848),Zt=e(96540);const Ln=Ce=>{const{children:Fe,storageKey:Je,defaultValue:it}=Ce,[ht,pt]=(0,Zt.useState)({value:Kt.M.getObject(Ce.storageKey,Ce.defaultValue)});(0,Zt.useEffect)(()=>{const qt=sn=>{sn.key===Je&&pt({value:Kt.M.getObject(Ce.storageKey,Ce.defaultValue)})};return window.addEventListener("storage",qt),()=>{window.removeEventListener("storage",qt)}});const zt=qt=>{try{Kt.M.setObject(Je,qt)}catch(sn){console.error(sn)}pt({value:qt})},Ft=()=>{try{Kt.M.delete(Je)}catch(qt){console.log(qt)}pt({value:it})};return(0,Dt.jsx)(Dt.Fragment,{children:Fe(ht.value,zt,Ft)})};var Qn=e(99885),va=e(96702),Wn=e(36638),ia=e(64761),kn=e(57866),na=e(46644),Ga=e(2197),Ps=e(8642),ls=e(4575),Ta=e(8721),aa=e(74261),Gs=e(406),Os=e(63409),Zs=e(34455),lr=e(54734),Xs=e(69884),jo=e(47070),ci=e(6773),Xr=e(35555),vs=e(55386),ks=e(33239),Ys=e(17548),Lo=e(60188),rs=e(25229),Vs=e(62717),Hs=e(5421),yr=e(80011),qr=e(44922),xr=e(74529),Ws=e(78479),Br=e(69168),Tr=e(37297),uo=e(79450),eo=e(20877),Xo=e(62392),Ur=e(31595),or=e(17564),fr=e(29246),to=e(30360),ho=e(76190),zr=e(48592),Gr=e(32899),fo=e(90382),Bo=e(68492),Hr=e(64394),po=e(7389),Uo=e(33553),hs=e(38619),qo=e(54092),ys=e(27164),At=e(38919);function bn(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(Ce){return this[Ce]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(Ce,Fe){this[Ce]=Fe},writable:!0,enumerable:!1,configurable:!0},add:{value:function(Ce){this.push(Ce)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}bn();var An=e(83340),pa=e(79319),zn=e(18600),la=e(22592),Zn=e(75683),Vn=e(67770),Hn=e(88907),Ja=e(46933),Ua=e(84229),Ha=e(79609),ha=e(85891),Ba=e(39443),ya=e(95004),xs=e(48588),Za=e(94777),os=e(96453);const Xn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let Pa=!1;class wa extends Array{get buffer(){return this}set buffer(Fe){this.length=0;const Je=Fe?.length;if(Je){let it=65e3,ht=Math.ceil(Je/it);for(let pt=0;pt<ht;pt++)this.push.apply(this,Fe.slice(pt*it,(pt+1)*it))}}constructor(Fe){super(),this.buffer=Fe??[],Pa||(console.warn(Xn),Pa=!0)}toJSON(){return[...this]}}var Yn=e(35479),Ra=e(7918),ns=e(68143),ps=e(78282),ga=e(48072),Va=e(78646),is=e(2863),nr=e(33184),Aa=e(36490),Xa=e(75234),qn=e(33005),Ma=e(33604),js=e(46907),cr=e(33707),Qs=e(58873),qa=e(2874),bs=e(22099),Es=e(6201);class qs extends p.mA{constructor(Fe,Je){const it={name:"RuntimeDataSource-"+Fe,uid:Je,type:Fe,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:Fe,name:"RuntimeDataSource-"+Fe,type:c.QE.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}};super(it),this.instanceSettings=it}testDatasource(){return Promise.resolve({status:"success",message:""})}}var Er=e(69896),Wo=e(33749),di=e(39698),No=e(27489),ui=e(62061),Qr=e(25992),Pr=e(36580),Ri=e(38866),_i=e(60311),Ai=e(14477),_r=e(97534),kr=e(83734),ki=e(88806),Yi=e(80839),Ko=e(61190),Fo=e(77010),ji=e(41071),ei=e(92293),wo=e(43122);const Wr=Ce=>(0,Ra.ZU)(Ce,(0,Es.H)()),io=(Ce,Fe)=>(0,Ra.T6)(Ce,Fe),Ji=Ce=>(0,Ra.Fj)(Ce,(0,Es.H)()),go=Ce=>(0,Ra.jW)(Ce,(0,Es.H)());var Zi=e(70255),pr=e(38353);function Xi(Ce){return Je=>{const[it,ht]=(0,Zt.useState)(!1),[pt,zt]=(0,Zt.useState)(Je.query);return(0,Zt.useEffect)(()=>{Je.query&&(0,pr.LZ)(Je.datasource)?(0,pr.aX)(Je.datasource,Je.query).then(Ft=>{Je.onChange(Ft),zt(Ft),ht(!0)}):ht(!0)},[]),(0,Zt.useEffect)(()=>{zt(Je.query)},[Je.query]),it?(0,Dt.jsx)(Ce,{...Je,query:pt}):(0,Dt.jsx)(Zi.A,{containerTestId:"react-loading-skeleton-testid",height:75})}}var Co=e(55315),mo=e(47700),Vo=e(25076),To=e(94959),Li=e(32581),ti=e(73757),Nr=e(30703);const Bi=Ce=>{const Fe=Ce.selectProps.menuIsOpen;return(0,Dt.jsx)(ti.c.IndicatorsContainer,{...Ce,children:(0,Dt.jsx)(Nr.I,{name:Fe?"angle-up":"angle-down",style:{marginTop:"7px"}})})},Ui=Bi,hi=Ce=>{const{children:Fe}=Ce;return(0,Dt.jsx)(ti.c.NoOptionsMessage,{...Ce,children:(0,Dt.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,Dt.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:Fe})})})},qi=hi;var Mo=e(46942),Wi=e.n(Mo),Ni=e(46005),el=e(8539),tl=e(66963),So=e(92807),fi=e(89534),pi=e(57830),$o=e(45967);const Rr=Ce=>{const{children:Fe,isSelected:Je,data:it}=Ce;return(0,Dt.jsx)(ti.c.Option,{...Ce,children:(0,Dt.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[it.imgUrl&&(0,Dt.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:it.imgUrl,alt:""}),(0,Dt.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,Dt.jsx)("div",{children:Fe}),it.description&&(0,Dt.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:it.description})]}),Je&&(0,Dt.jsx)(Nr.I,{name:"check","aria-hidden":"true"})]})})},Ki=null;var sa=e(22803),es=e(63142),gi=e(65240);const ni=(0,gi.N)(Ce=>({header:(0,sa.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${Ce.colors.background.secondary}`,"&:hover":{color:Ce.colors.text.maxContrast}}),label:(0,sa.css)({flexGrow:1}),icon:(0,sa.css)({paddingRight:"2px"})}));class mi extends Zt.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(Fe=>({expanded:!Fe.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:Fe}=this.props.selectProps.value;Fe&&this.props.options.some(Je=>Je.value===Fe)&&this.setState({expanded:!0})}}componentDidUpdate(Fe){Fe.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:Fe,label:Je,theme:it}=this.props,{expanded:ht}=this.state,pt=ni(it);return(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:pt.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,Dt.jsx)("span",{className:pt.label,children:Je}),(0,Dt.jsx)(Nr.I,{className:pt.icon,name:ht?"angle-up":"angle-down"})]}),ht&&Fe]})}}const Oo=(0,es.cV)(mi),vo=Ce=>(0,Dt.jsx)(ti.c.MenuList,{...Ce,children:(0,Dt.jsx)(So.P,{showScrollIndicators:!0,overflowX:"hidden",maxHeight:"inherit",children:Ce.children})});class Io extends Zt.PureComponent{static{this.contextType=Xr.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:Rr,SingleValue:fi.K,IndicatorsContainer:Ui,MenuList:vo,Group:Oo}}}render(){const{defaultValue:Fe,getOptionLabel:Je,getOptionValue:it,onChange:ht,options:pt,placeholder:zt,width:Ft,value:qt,className:sn,isDisabled:hn,isLoading:Sn,isSearchable:Mn,isClearable:Jn,backspaceRemovesValue:$a,isMulti:Bs,autoFocus:Ya,openMenuOnFocus:Zr,onBlur:Ir,maxMenuHeight:ro,noOptionsMessage:hr,isOpen:Po,components:ua,tooltipContent:jn,tabSelectsValue:us,onCloseMenu:ta,onOpenMenu:Ts,allowCustomValue:Ms,formatCreateLabel:Rs,"aria-label":Ss}=this.props;let Js="";Ft&&(Js="width-"+Ft);let mr=Ni.Ay;const bo={};Ms&&(mr=tl.A,bo.formatCreateLabel=Rs??(wr=>wr));const oo=Wi()("gf-form-input","gf-form-input--form-dropdown",Js,sn),li={...Io.defaultProps.components,...ua};return(0,Dt.jsx)(br,{onCloseMenu:ta,onOpenMenu:Ts,tooltipContent:jn,isOpen:Po,children:(wr,yc)=>(0,Dt.jsx)(mr,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:oo,components:li,defaultValue:Fe,value:qt,getOptionLabel:Je,getOptionValue:it,menuShouldScrollIntoView:!1,isSearchable:Mn,onChange:ht,options:pt,placeholder:zt||"Choose",styles:(0,pi.A)(this.context),isDisabled:hn,isLoading:Sn,isClearable:Jn,autoFocus:Ya,onBlur:Ir,openMenuOnFocus:Zr,maxMenuHeight:ro,noOptionsMessage:hr,isMulti:Bs,backspaceRemovesValue:$a,menuIsOpen:Po,onMenuOpen:wr,onMenuClose:yc,tabSelectsValue:us,"aria-label":Ss,...bo})})}}class nl extends Zt.PureComponent{static{this.contextType=Xr.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:Fe,getOptionLabel:Je,getOptionValue:it,onChange:ht,placeholder:pt,width:zt,value:Ft,className:qt,loadOptions:sn,defaultOptions:hn,isLoading:Sn,loadingMessage:Mn,noOptionsMessage:Jn,isDisabled:$a,isSearchable:Bs,isClearable:Ya,backspaceRemovesValue:Zr,autoFocus:Ir,onBlur:ro,openMenuOnFocus:hr,maxMenuHeight:Po,isMulti:ua,tooltipContent:jn,onCloseMenu:us,onOpenMenu:ta,isOpen:Ts}=this.props;let Ms="";zt&&(Ms="width-"+zt);const Rs=Wi()("gf-form-input","gf-form-input--form-dropdown",Ms,qt);return(0,Dt.jsx)(br,{onCloseMenu:us,onOpenMenu:ta,tooltipContent:jn,isOpen:Ts,children:(Ss,Js)=>(0,Dt.jsx)(el.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Rs,components:{Option:Rr,SingleValue:fi.K,IndicatorsContainer:Ui,NoOptionsMessage:qi},defaultValue:Fe,value:Ft,getOptionLabel:Je,getOptionValue:it,menuShouldScrollIntoView:!1,onChange:ht,loadOptions:sn,isLoading:Sn,defaultOptions:hn,placeholder:pt||"Choose",styles:(0,pi.A)(this.context),loadingMessage:Mn,noOptionsMessage:Jn,isDisabled:$a,isSearchable:Bs,isClearable:Ya,autoFocus:Ir,onBlur:ro,openMenuOnFocus:hr,maxMenuHeight:Po,isMulti:ua,backspaceRemovesValue:Zr})})}}class br extends Zt.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:Fe}=this.props;Fe&&Fe(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:Fe}=this.props;Fe&&Fe(),this.setState({isOpenInternal:!1})}}render(){const{children:Fe,isOpen:Je,tooltipContent:it}=this.props,{isOpenInternal:ht}=this.state;let pt;return(ht||Je)&&(pt=!1),it?(0,Dt.jsx)($o.m,{show:pt,content:it,placement:"bottom",children:(0,Dt.jsx)("div",{children:Fe(this.onOpenMenu,this.onCloseMenu)})}):(0,Dt.jsx)("div",{children:Fe(this.onOpenMenu,this.onCloseMenu)})}}const vl=null;var ws=e(2543);class vi extends Zt.PureComponent{constructor(){super(...arguments),this.state={id:(0,ws.uniqueId)()},this.internalOnChange=Fe=>{Fe.stopPropagation(),this.props.onChange(Fe)}}render(){const{labelClass:Fe="",switchClass:Je="",label:it,checked:ht,disabled:pt,transparent:zt,className:Ft,theme:qt,tooltip:sn,tooltipPlacement:hn}=this.props,Sn=sl(qt),Mn=this.state.id,Jn=`gf-form-label ${Fe} ${zt?"gf-form-label--transparent":""} pointer`,$a=(0,sa.cx)(Sn.switch,Je,{[Sn.switchTransparent]:zt});return(0,Dt.jsx)("div",{className:Sn.container,children:(0,Dt.jsxs)("label",{htmlFor:Mn,className:(0,sa.cx)("gf-form",Sn.labelContainer,Ft),children:[it&&(0,Dt.jsxs)("div",{className:Jn,children:[it,sn&&(0,Dt.jsx)($o.m,{placement:hn||"auto",content:sn,theme:"info",children:(0,Dt.jsx)(Nr.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,Dt.jsxs)("div",{className:$a,children:[(0,Dt.jsx)("input",{disabled:pt,id:Mn,type:"checkbox",checked:ht,onChange:this.internalOnChange}),(0,Dt.jsx)("span",{className:Sn.slider})]})]})})}}const al=(0,es.cV)(vi),sl=Ce=>{const Fe=(0,sa.css)({background:Ce.v1.palette.gray1,borderRadius:Ce.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:Ce.components.input.background,transition:"0.4s",borderRadius:Ce.shape.radius.circle,boxShadow:Ce.shadows.z1}});return{container:(0,sa.css)({display:"flex",flexShrink:0}),labelContainer:(0,sa.css)({display:"flex",cursor:"pointer",marginRight:Ce.spacing(.5)}),switch:(0,sa.css)({display:"flex",position:"relative",width:"56px",height:Ce.spacing(4),background:Ce.components.input.background,border:`1px solid ${Ce.components.input.borderColor}`,borderRadius:Ce.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${Fe}`]:{background:Ce.colors.primary.main},[`input:checked + .${Fe}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,sa.css)({background:"transparent",border:0,width:"40px"}),slider:Fe}};var er=e(23659),Kr=e(44017),Fi=e(45013),ai=e(41069),wi=e(79277),Ro=e(14099),yi=e(81082),Vi=e(35484);typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(Ce){const Fe=(this.document||this.ownerDocument).querySelectorAll(Ce);let Je=this,it;do{for(it=Fe.length;--it>=0&&Fe.item(it)!==Je;);Je=Je.parentElement}while(it<0&&Je);return Je});function ct(Ce,Fe){let Je=Ce.parentElement?.previousSibling,it;for(;Je;){if(Je instanceof HTMLElement&&(it=Je.querySelector(Fe)),it)return it;Je=Je.previousSibling}}function ft(Ce){const Fe=(Ce||window).getSelection();if(!Fe||!Fe.anchorNode)return null;const Je=Fe.getRangeAt(0),it=Fe.anchorNode.textContent,ht=Je.startOffset;return it.slice(ht,ht+1)}var Nt=e(44019),tn=e(76319),mn=e(7075),Dn=e(44458),Rn=e(43533),Kn=e(2381),ra=e(59243),ca=e(15245),ba=e(52718),Sa=e(64467),cs=e(47931),fs=e(64913),Qa=e(56873),Ns=e(38092),$s=e(45861),zs=e(78121),Ds=e(21133);const as=Ce=>{const{onChange:Fe,className:Je,loadData:it,icon:ht,buttonProps:pt,hideDownIcon:zt,variant:Ft,disabled:qt,...sn}=Ce,hn=(0,es.of)(Ar),Sn=(0,es.of)(Ds.T);let Mn=Ce.children;return zt||(Mn=[Ce.children,(0,Dt.jsx)(Nr.I,{name:"angle-down",className:hn.icons.right},"down-icon")]),(0,Dt.jsx)(Ns.A,{onChange:(0,zs.k)(Fe),loadData:(0,zs.W)(it),dropdownClassName:(0,sa.cx)(Sn.dropdown,hn.popup),...sn,expandIcon:null,children:(0,Dt.jsx)($s.$n,{icon:ht,disabled:qt,variant:Ft,...pt??{},children:Mn})})};as.displayName="ButtonCascader";const Ar=Ce=>({popup:(0,sa.css)({label:"popup",zIndex:Ce.zIndex.dropdown}),icons:{right:(0,sa.css)({margin:"1px 0 0 4px"}),left:(0,sa.css)({margin:"-1px 4px 0 0"})}});var Yr=e(53371),Dr=e(6975),jr=e(47327),Ks=e(35427),ir=e(13615),ar=e(57339),yo=e(74451),Cs=e(50201),no=e(12965),dr=e(34107),ao=e(90811),lo=e(91867),rl=e(72296),$i=e(83692),jl=e(11527),xi=e(59310),zo=e(5857),Ll=e(96396),zi=e(43482),Bl=e(27282),Ul=e(5585),ol=e(27594),Ls=e(10928),il=e(37386);const Ei=(0,Zt.memo)(()=>{const Ce=(0,es.of)(yl);return(0,Dt.jsxs)("div",{className:Ce.ellipsis,children:[(0,Dt.jsx)("span",{className:Ce.firstDot,children:"."}),(0,Dt.jsx)("span",{className:Ce.secondDot,children:"."}),(0,Dt.jsx)("span",{className:Ce.thirdDot,children:"."})]})});Ei.displayName="EllipsisAnimated";const yl=Ce=>({ellipsis:(0,sa.css)({display:"inline"}),firstDot:(0,sa.css)({[Ce.transitions.handleMotion("no-preference","reduce")]:{animation:`${xl} 2s linear infinite`}}),secondDot:(0,sa.css)({[Ce.transitions.handleMotion("no-preference","reduce")]:{animation:`${El} 2s linear infinite`}}),thirdDot:(0,sa.css)({[Ce.transitions.handleMotion("no-preference","reduce")]:{animation:`${Pl} 2s linear infinite`}})}),xl=(0,sa.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,El=(0,sa.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Pl=(0,sa.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,bl=2*1e3;function Pi(Ce){const{invalid:Fe,loading:Je,onFinishChange:it,saveErrorMessage:ht="Error saving this value",error:pt,children:zt,disabled:Ft,...qt}=Ce,[sn,hn]=Zt.useState({isLoading:!1,showSuccess:!1,showError:Fe}),Sn=(0,Zt.useRef)(null);Zt.useEffect(()=>{let Ya;if(sn.showSuccess){const Zr=sn.showError?0:bl;Ya=setTimeout(()=>{hn({...sn,showSuccess:!1})},Zr)}return()=>{window.clearTimeout(Ya)}},[sn]);const Mn=(0,Zt.useCallback)(Ya=>{Fe||(hn({...sn,isLoading:!0,showSuccess:!1}),it(Ya).then(()=>{hn({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{hn({...sn,isLoading:!1,showError:!0})}))},[Fe,sn,it]),Jn=(0,Zt.useMemo)(()=>(0,ws.debounce)(Mn,600,{leading:!1}),[Mn]),$a=Fe||sn.showError||void 0,Bs=(0,es.of)(bi);return(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)(il.D,{...qt,loading:Je||void 0,invalid:$a,disabled:Ft,error:pt||sn.showError&&ht,ref:Sn,className:Bs.widthFitContent,children:Zt.cloneElement(zt(Ya=>{Jn(Ya)}))}),sn.isLoading&&(0,Dt.jsx)(Yr.r,{referenceElement:Sn.current,placement:"right",children:(0,Dt.jsxs)(g.x6,{i18nKey:"grafana-ui.auto-save-field.saving",children:["Saving ",(0,Dt.jsx)(Ei,{})]})}),sn.showSuccess&&(0,Dt.jsx)(Yr.r,{suffixIcon:"check",referenceElement:Sn.current,placement:"right",children:(0,Dt.jsx)(g.x6,{i18nKey:"grafana-ui.auto-save-field.saved",children:"Saved!"})})]})}Pi.displayName="AutoSaveField";const bi=()=>({widthFitContent:(0,sa.css)({width:"fit-content"})});var ll=e(34213),cl=e(94018),Dl=e(37658),Cl=e(34343),Wl=e(71599),Nl=e(92505),Ee=e(50992),et=e(65232),nt=e(78193),Ct=e(13477),vt=e(22787),Pt=e(53428),fe=e(52792);const ae=({children:Ce})=>{const Fe=(0,es.of)(xe);return(0,Dt.jsx)("div",{children:(0,Dt.jsx)("div",{className:Fe.header,children:(0,Dt.jsx)("div",{className:Fe.content,children:Ce})})})},xe=Ce=>({header:(0,sa.css)({display:"flex",margin:Ce.spacing(0,0,3,0)}),content:(0,sa.css)({flexGrow:1})});var Le=e(8515),Ze=e(84600),at=e(82143),ut=e(24343),Et=e(64780),Wt=e(87105);class _t extends Zt.PureComponent{constructor(Fe){super(Fe),this.readCSV=(0,ws.debounce)(()=>{const{config:ht}=this.props,{text:pt}=this.state;this.setState({data:(0,St.Jh)(pt,{config:ht})})},150),this.onTextChange=ht=>{this.setState({text:ht.target.value})};const{text:Je,config:it}=Fe;this.state={text:Je,data:(0,St.Jh)(Je,{config:it})}}componentDidUpdate(Fe,Je){const{text:it}=this.state;(it!==Je.text||this.props.config!==Fe.config)&&this.readCSV(),this.props.text!==Fe.text&&this.props.text!==it&&this.setState({text:this.props.text}),this.state.data!==Je.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:Fe,height:Je,theme:it}=this.props,{data:ht}=this.state,pt=dn(it);return(0,Dt.jsxs)("div",{className:pt.tableInputCsv,children:[(0,Dt.jsx)(Wt.f,{style:{width:Fe,height:Je},placeholder:(0,g.t)("grafana-ui.table.csv-placeholder","Enter CSV here..."),value:this.state.text,onChange:this.onTextChange,className:pt.textarea}),ht&&(0,Dt.jsx)("footer",{className:pt.footer,children:ht.map((zt,Ft)=>{const qt=zt.length,sn=zt.fields.length;return(0,Dt.jsx)("span",{children:(0,Dt.jsxs)(g.x6,{i18nKey:"grafana-ui.table.csv-counts",children:["Rows:",{rows:qt},", Columns:",{columns:sn}," \xA0",(0,Dt.jsx)(Nr.I,{name:"check-circle"})]})},Ft)})})]})}}const nn=(0,es.cV)(_t);nn.displayName="TableInputCSV";const dn=(0,gi.N)(Ce=>({tableInputCsv:(0,sa.css)({position:"relative"}),textarea:(0,sa.css)({height:"100%",width:"100%"}),footer:(0,sa.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:Ce.colors.success.main,padding:`1px ${Ce.spacing(.5)}`,fontSize:"80%"})}));var Pn=e(54314),Nn=e(60208),Cn=e(51898),Tn=e(72489);const _n=(0,Zt.forwardRef)(({label:Ce,active:Fe,icon:Je,counter:it,className:ht,suffix:pt,onChangeTab:zt,href:Ft,...qt},sn)=>{const hn=(0,es.of)(ka),Sn=()=>(0,Dt.jsxs)(Dt.Fragment,{children:[Je&&(0,Dt.jsx)(Nr.I,{name:Je}),Ce,typeof it=="number"&&(0,Dt.jsx)(Tn.p,{value:it}),pt&&(0,Dt.jsx)(pt,{className:hn.suffix})]}),Mn=(0,sa.cx)(hn.link,Fe&&hn.activeStyle);return(0,Dt.jsx)("a",{href:Ft,className:Mn,...qt,onClick:zt,"aria-label":qt["aria-label"]||Cn.Tp.components.Tab.title(Ce),role:"tab","aria-selected":Fe,ref:sn,children:Sn()})});_n.displayName="Tab";const ka=Ce=>({link:(0,sa.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:Ce.colors.text.primary,svg:{marginRight:Ce.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,sa.css)({label:"activeTabStyle",color:Ce.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:Ce.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,sa.css)({marginLeft:Ce.spacing(1)})});var ja=e(13941),ds=e(70663),da=e(97611),_a=e(53431),gs=e(18627),ts=e(98005),Mr=e(71076);const si=({content:Ce,position:Fe,offset:Je})=>{const it=(0,es.of)(Kl);return Fe?(0,Dt.jsx)(ca.ZL,{className:it.portal,children:(0,Dt.jsx)(Mr.o,{position:Fe,offset:Je||{x:0,y:0},children:Ce})}):null};si.displayName="VizTooltip";const Kl=()=>({portal:(0,sa.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})});var gr=e(63428),xo=e(33352),Di=e(67522),Ci=e(39884),Sr=e(64400),so=e(54735),ri=e(22940),Tl=e(4268),sr=e(89123),Go=e(34999),Ml=e(89599),zc=e(74475),tr=e(28134);function xc({links:Ce}){const Fe=(0,es.of)(Ti);if(Ce.length===1)return(0,Dt.jsx)(tr.R,{link:Ce[0]});const Je=Ce.filter(ht=>ht.target==="_blank"),it=Ce.filter(ht=>ht.target==="_self");return(0,Dt.jsxs)(Dt.Fragment,{children:[it.map((ht,pt)=>(0,Dt.jsx)(tr.R,{link:ht},pt)),(0,Dt.jsxs)("div",{className:Fe.wrapper,children:[(0,Dt.jsx)("p",{className:Fe.externalLinksHeading,children:(0,Dt.jsx)(g.x6,{i18nKey:"grafana-ui.field-link-list.external-links-heading",children:"External links"})}),Je.map((ht,pt)=>(0,Dt.jsxs)("a",{href:ht.href,target:ht.target,className:Fe.externalLink,children:[(0,Dt.jsx)(Nr.I,{name:"external-link-alt"}),ht.title]},pt))]})]})}const Ti=Ce=>({wrapper:(0,sa.css)({flexBasis:"150px",width:"100px",marginTop:Ce.spacing(1)}),externalLinksHeading:(0,sa.css)({color:Ce.colors.text.secondary,fontWeight:Ce.typography.fontWeightRegular,fontSize:Ce.typography.size.sm,margin:0}),externalLink:(0,sa.css)({color:Ce.colors.text.link,fontWeight:Ce.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:Ce.spacing(1)}})}),Hd=({className:Ce,children:Fe})=>{const Je=(0,es.of)(Qd);return(0,Dt.jsx)("div",{className:(0,sa.cx)(Je,Ce),children:Fe})},Qd=()=>(0,sa.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}});var _d=e(8135),ql=e(59795),kd=e(43951),Fl=e(97375),Yd=e(87063),Jd=e(30930),Gc=e(94535),Zd=e(41479),Xd=e(96822),qd=e(73628),eu=e(81917),tu=e(6399),nu=e(71479),Hc=e(79331),Qc=e(991);const dl=(0,Zt.memo)((0,Zt.forwardRef)(({title:Ce,featureState:Fe,...Je},it)=>{const ht=(0,es.of)(_c),pt=Fe?(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("div",{className:ht.badge,children:(0,Dt.jsx)(Qc.y,{featureState:Fe})}),(0,Dt.jsx)("h3",{children:Ce})]}):(0,Dt.jsx)("h3",{children:Ce});return(0,Dt.jsx)(Hc.w,{branded:!0,title:pt,urlTitle:"Read documentation",ref:it,...Je})}));dl.displayName="FeatureInfoBox";const _c=Ce=>({badge:(0,sa.css)({marginBottom:Ce.spacing(1)})});var ec=e(50275),tc=e(22658),Sl=e(36303),ul=e(56297),nc=e(96004),au=e(55803),Ec=e(21285),kc=e(18027);function ac({options:Ce,onOptionsChange:Fe}){return(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("h3",{className:"page-heading",children:(0,Dt.jsx)(g.x6,{i18nKey:"grafana-ui.data-source-settings.alerting-settings-heading",children:"Alerting"})}),(0,Dt.jsx)("div",{className:"gf-form-group",children:(0,Dt.jsx)("div",{className:"gf-form-inline",children:(0,Dt.jsx)("div",{className:"gf-form",children:(0,Dt.jsx)(kc.I,{labelWidth:29,label:(0,g.t)("grafana-ui.data-source-settings.alerting-settings-label","Manage alert rules in Alerting UI"),disabled:Ce.readOnly,tooltip:(0,g.t)("grafana-ui.data-source-settings.alerting-settings-tooltip","Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source."),children:(0,Dt.jsx)(Ec.K,{value:Ce.jsonData.manageAlerts!==!1,onChange:Je=>Fe({...Ce,jsonData:{...Ce.jsonData,manageAlerts:Je.currentTarget.checked}})})})})})})]})}var hf=e(3936),Pc=e(37235),su=e(45558),Or=e(68079),sc=e(19052),hl=e(4819),ru=e(61875),bc=e(76671),ou=e(3263),iu=e(89467),lu=e(52042),cu=e(8207),Yc=e(17437),du=e(69156),wl=e(63527),Jc=e(91302);const Zc=({min:Ce,max:Fe,onChange:Je,onAfterChange:it,orientation:ht="horizontal",reverse:pt,step:zt,value:Ft,ariaLabelForHandle:qt,marks:sn,included:hn})=>{const Sn=ht==="horizontal",Mn=(0,es.of)(Jc.$,Sn,!!sn),Jn=du.A,[$a,Bs]=(0,Zt.useState)(Ft??Ce),Ya=(0,Zt.useCallback)(ua=>{const jn=typeof ua=="number"?ua:ua[0];Bs(jn),Je?.(jn)},[Bs,Je]),Zr=(0,Zt.useCallback)(ua=>{let jn=+ua.target.value;Number.isNaN(jn)&&(jn=0),Bs(jn),Je&&Je(jn),it&&it(jn)},[Je,it]),Ir=(0,Zt.useCallback)(ua=>{const jn=+ua.target.value;jn>Fe?Bs(Fe):jn<Ce&&Bs(Ce)},[Fe,Ce]),ro=(0,Zt.useCallback)(ua=>{const jn=typeof ua=="number"?ua:ua[0];it?.(jn)},[it]),hr=Sn?[]:[Mn.sliderInputVertical],Po=Sn?[]:[Mn.sliderInputFieldVertical];return(0,Dt.jsxs)("div",{className:(0,sa.cx)(Mn.container,Mn.slider),children:[(0,Dt.jsx)(Yc.Global,{styles:Mn.tooltip}),(0,Dt.jsxs)("div",{className:(0,sa.cx)(Mn.sliderInput,...hr),children:[(0,Dt.jsx)(Jn,{min:Ce,max:Fe,step:zt,defaultValue:Ft,value:$a,onChange:Ya,onChangeComplete:ro,vertical:!Sn,reverse:pt,ariaLabelForHandle:qt,marks:sn,included:hn}),(0,Dt.jsx)(wl.p,{type:"text",width:7.5,className:(0,sa.cx)(Mn.sliderInputField,...Po),value:$a,onChange:Zr,onBlur:Ir,min:Ce,max:Fe})]})]})};Zc.displayName="Slider";var uu=e(21103),Dc=e(50426),hu=e(3343),fu=e(26987),Xc=e(93256),pu=e(7895),gu=e(36219),Vl=e(59695),rr=e(63152),ea=e(20941),Ol=e(89640),Cc=e(66404),qc=e(31286),Mi=e(41654),ed=e(13943),td=e(35137),Tc=e(72636),ms=e(53487),$l=e(16780),mu=e(12594),vu=e(83871),yu=e(79233),xu=e(97095),Eu=e(49785);const nd=({name:Ce,control:Fe,children:Je,...it})=>{const{fields:ht,append:pt,prepend:zt,remove:Ft,swap:qt,move:sn,insert:hn}=(0,Eu.jz)({control:Fe,name:Ce,...it});return Je({fields:ht,append:pt,prepend:zt,remove:Ft,swap:qt,move:sn,insert:hn})};var Si=e(18857),ad=e(72508),sd=e(69665),rc=e(29362),Pu=e(43243),Jr=e(31033),bu=e(70733),Du=e(92842);const Cu=(0,Zt.forwardRef)(({children:Ce,onRemove:Fe,disabled:Je,...it},ht)=>{const pt=(0,es.of)(Tu,Je),zt=(0,g.t)("grafana-ui.value-pill.remove-button","Remove {{children}}",{children:Ce});return(0,Dt.jsxs)("span",{className:pt.wrapper,...it,ref:ht,children:[(0,Dt.jsx)("span",{className:pt.text,children:Ce}),!Je&&(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("span",{className:pt.separator}),(0,Dt.jsx)(tn.K,{name:"times",size:"md","aria-label":zt,onClick:Ft=>{Ft.stopPropagation(),Fe()}})]})]})}),Tu=(Ce,Fe)=>({wrapper:(0,sa.css)({display:"inline-flex",borderRadius:Ce.shape.radius.default,color:Ce.colors.text.primary,background:Ce.colors.background.secondary,padding:Ce.spacing(.25),border:Fe?`1px solid ${Ce.colors.border.weak}`:"none",fontSize:Ce.typography.bodySmall.fontSize,flexShrink:0,minWidth:"50px",alignItems:"center","&:first-child:has(+ div)":{flexShrink:1}}),text:(0,sa.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Ce.spacing(0,1,0,.75)}),separator:(0,sa.css)({background:Ce.colors.border.weak,width:"2px",height:"100%",marginRight:Ce.spacing(.5)})});var Mc=e(74440),Mu=e(98869);const rd=(Ce,Fe,Je,it,ht,pt,zt,Ft)=>{const qt=(0,wl.n)({theme:Ce,invalid:Je}),sn=(0,Vi.getFocusStyles)(Ce),hn=ht&&ht!=="auto"?Ce.spacing(ht):"100%",Sn=pt?Ce.spacing(pt):"",Mn=zt?Ce.spacing(zt):"";return{container:(0,sa.css)({width:ht==="auto"?"auto":hn,minWidth:Sn,maxWidth:Mn,display:ht==="auto"?"inline-block":"block"}),wrapper:(0,sa.cx)(qt.input,(0,sa.css)({display:"flex",width:"100%",gap:Ce.spacing(.5),padding:Ce.spacing(.5),paddingRight:Ft?Ce.spacing(5):28,"&:focus-within":{...sn}})),input:(0,sa.css)({border:"none",outline:"none",background:"transparent",flexGrow:1,maxWidth:"100%",minWidth:40,"&::placeholder":{color:Ce.colors.text.disabled},"&:focus":{outline:"none",cursor:"text"},cursor:"pointer"}),pillWrapper:(0,sa.css)({display:"inline-flex",flexWrap:Fe?"wrap":"nowrap",flexGrow:1,minWidth:"50px",gap:Ce.spacing(.5)}),restNumber:(0,sa.css)({display:"inline-flex",alignItems:"center",justifyContent:"center",padding:Ce.spacing(0,1),border:it?`1px solid ${Ce.colors.border.weak}`:"none",borderRadius:Ce.shape.radius.default,backgroundColor:Ce.colors.background.secondary,cursor:"pointer","&:hover":{backgroundColor:Ce.colors.action.hover}}),suffix:qt.suffix,disabled:qt.inputDisabled}};var od=e(33605),id=e(75168),Sc=e(49185),zl=e(53568);const Su=12,Ou=50,ld=10,Oc=15;function Iu(Ce,Fe,Je){const[it,ht]=(0,Zt.useState)(Ce.length),[pt,{width:zt}]=(0,Sc.A)(),[Ft,{width:qt}]=(0,Sc.A)(),[sn,{width:hn}]=(0,Sc.A)(),Sn=Fe&&Fe!=="auto"?Fe:zt;return(0,Zt.useEffect)(()=>{const Mn=Sn-qt-hn;let Jn=0;for(let $a=0;$a<Ce.length;$a++){if(Jn+=(0,zl.kD)(Ce[$a].label||"",Su).width+(Je?ld:Ou),Jn>Mn){ht(Math.min($a,Oc)||1);break}$a===Ce.length-1&&ht(Ce.length)}},[Sn,qt,hn,Ce,ht,Je]),{measureRef:pt,counterMeasureRef:Ft,suffixMeasureRef:sn,shownItems:it}}function Ru(Ce){const Fe=(0,Zt.useRef)(null),Je=(0,Zt.useRef)(0),[it,ht]=(0,Zt.useState)("");return(0,Zt.useLayoutEffect)(()=>{if(Fe.current&&Ce==null&&Je.current===0&&(Je.current=Fe?.current.getBoundingClientRect().width),!Fe.current||Ce==null){ht("");return}const pt=window.getComputedStyle(Fe.current).fontSize,zt=(0,zl.kD)(Fe.current.value||"",parseInt(pt,10)).width;zt<Je.current?ht(""):ht(`${zt+5}px`)},[Ce]),{inputRef:Fe,inputWidth:it}}var Au=e(5320);const ju=Ce=>{const{placeholder:Fe,onChange:Je,value:it,width:ht,enableAllOption:pt,invalid:zt,disabled:Ft,minWidth:qt,maxWidth:sn,isClearable:hn,createCustomValue:Sn=!1}=Ce,Mn=(0,es.of)(Mu.C3),[Jn,$a]=(0,Zt.useState)(""),Bs=(0,Zt.useMemo)(()=>({label:Jn===""?(0,g.t)("multicombobox.all.title","All"):(0,g.t)("multicombobox.all.title-filtered","All (filtered)"),value:od.A}),[Jn]),{options:Ya,updateOptions:Zr,asyncLoading:Ir,asyncError:ro}=(0,Au.I)(Ce.options,Sn),hr=(0,Zt.useMemo)(()=>pt&&Ya.length>1?[Bs,...Ya]:Ya,[Ya,pt,Bs]),Po=Ce.loading||Ir,ua=(0,Zt.useMemo)(()=>it?Lu(it,typeof Ce.options!="function"?Ce.options:Ya):[],[it,Ce.options,Ya]),{measureRef:jn,counterMeasureRef:us,suffixMeasureRef:ta,shownItems:Ts}=Iu(ua,ht,Ft),Ms=(0,Zt.useCallback)(Us=>ua.some(vr=>vr.value===Us.value),[ua]),{getSelectedItemProps:Rs,getDropdownProps:Ss,setSelectedItems:Js,addSelectedItem:mr,removeSelectedItem:bo,reset:oo}=(0,Jr.mH)({selectedItems:ua,onStateChange:({type:Us,selectedItems:vr})=>{switch(Us){case Jr.mH.stateChangeTypes.SelectedItemKeyDownBackspace:case Jr.mH.stateChangeTypes.SelectedItemKeyDownDelete:case Jr.mH.stateChangeTypes.DropdownKeyDownBackspace:case Jr.mH.stateChangeTypes.FunctionRemoveSelectedItem:case Jr.mH.stateChangeTypes.FunctionAddSelectedItem:case Jr.mH.stateChangeTypes.FunctionSetSelectedItems:case Jr.mH.stateChangeTypes.FunctionReset:Je(vr??[]);break;default:break}},stateReducer:(Us,vr)=>{const{changes:Jo}=vr;return{...Jo,activeIndex:-999}}}),{getToggleButtonProps:li,isOpen:wr,highlightedIndex:yc,getMenuProps:Cr,getInputProps:ko,getItemProps:Ao}=(0,Jr.Bp)({items:hr,itemToString:Mc.y,inputValue:Jn,selectedItem:null,stateReducer:(Us,vr)=>{const{type:Jo}=vr;let{changes:Zo}=vr;switch(Us.isOpen===!1&&Zo.isOpen===!0&&Zo.inputValue===Us.inputValue&&(Zo={...Zo,inputValue:""}),Jo){case Jr.Bp.stateChangeTypes.InputKeyDownEnter:case Jr.Bp.stateChangeTypes.ItemClick:return{...Zo,isOpen:!0,highlightedIndex:Us.highlightedIndex};case Jr.Bp.stateChangeTypes.InputBlur:$a("");default:return Zo}},onIsOpenChange:({isOpen:Us,inputValue:vr})=>{Us&&vr===""&&Zr(vr)},onStateChange:({inputValue:Us,type:vr,selectedItem:Jo})=>{switch(vr){case Jr.Bp.stateChangeTypes.InputKeyDownEnter:case Jr.Bp.stateChangeTypes.ItemClick:if(Jo?.value===od.A){const Zo=ua.length===hr.length-1,Ii=hr.slice(1);let Qi=Zo&&Jn===""?[]:Ii;if(!Zo&&Jn!==""&&(Qi=[...new Set([...ua,...Ii])]),Zo&&Jn!==""){const np=new Set(Ii.map(uf=>uf.value));Qi=ua.filter(uf=>!np.has(uf.value))}Js(Qi)}else Jo&&Ms(Jo)?bo(Jo):Jo&&mr(Jo);break;case Jr.Bp.stateChangeTypes.InputChange:$a(Us??""),Zr(Us??"");break;default:break}}}),{inputRef:Vr,floatingRef:Do,floatStyles:co,scrollRef:Yo}=(0,id.l)(hr,wr),$r=(0,es.of)(rd,wr,zt,Ft,ht,qt,sn,hn),ml=wr?ua.slice(0,Oc):ua.slice(0,Ts),{inputRef:Al,inputWidth:$c}=Ru(Jn);return(0,Dt.jsxs)("div",{className:$r.container,ref:Vr,children:[(0,Dt.jsx)("div",{className:(0,sa.cx)($r.wrapper,{[$r.disabled]:Ft}),ref:jn,children:(0,Dt.jsxs)("span",{className:$r.pillWrapper,children:[ml.map((Us,vr)=>(0,Dt.jsx)(Cu,{disabled:Ft,onRemove:()=>{bo(Us)},...Rs({selectedItem:Us,index:vr}),children:(0,Mc.y)(Us)},`${Us.value}${vr}`)),ua.length>ml.length&&(0,Dt.jsxs)(qc.a,{display:"flex",direction:"row",marginLeft:.5,gap:1,ref:us,children:[(0,Dt.jsx)(Cc.E,{children:"..."}),(0,Dt.jsx)($o.m,{interactive:!0,content:(0,Dt.jsx)(Dt.Fragment,{children:ua.slice(ml.length).map(Us=>(0,Dt.jsx)("div",{children:(0,Mc.y)(Us)},Us.value))}),children:(0,Dt.jsx)("div",{className:$r.restNumber,children:ua.length-Ts})})]}),(0,Dt.jsx)("input",{className:$r.input,...ko(Ss({disabled:Ft,preventKeyAction:wr,placeholder:ml.length===0?Fe:"",ref:Al,style:{width:$c}}))}),(0,Dt.jsxs)("div",{className:$r.suffix,ref:ta,...li(),children:[hn&&ua.length>0&&(0,Dt.jsx)(Nr.I,{name:"times",className:Mn.clear,title:(0,g.t)("multicombobox.clear.title","Clear all"),tabIndex:0,role:"button",onClick:Us=>{Us.stopPropagation(),oo()},onKeyDown:Us=>{(Us.key==="Enter"||Us.key===" ")&&oo()}}),(0,Dt.jsx)(Du.f,{isLoading:Po||!1,isOpen:wr})]})]})}),(0,Dt.jsx)(ca.ZL,{children:(0,Dt.jsx)("div",{className:(0,sa.cx)(Mn.menu,!wr&&Mn.menuClosed),style:{...co,width:co.width+24},...Cr({ref:Do}),children:wr&&(0,Dt.jsx)(bu.e,{options:hr,highlightedIndex:yc,selectedItems:ua,scrollRef:Yo,getItemProps:Ao,enableAllOption:pt,isMultiSelect:!0,error:ro})})})]})};function Lu(Ce,Fe){if(cd(Ce))return Ce;const Je=new Map(Ce.map((ht,pt)=>[ht,pt])),it=[];for(const ht of Fe){const pt=Je.get(ht.value);if(pt!==void 0&&(it[pt]=ht,Je.delete(ht.value)),Je.size===0)break}for(const[ht,pt]of Je)it[pt]={value:ht};return it}function cd(Ce){return typeof Ce[0]=="object"}var oc=e(32881),dd=e(99887),Bu=e(77824),Uu=e(45450),Wu=e(16203),Fr=e(33033),Lr=e(12737),ud=e(48767),Nu=e(40601),ic=e(32635),Ku=e(57688),hd=e(40279),Fu=e(48431),wu=e(56265),Vu=e(90929),ur=e(8073),Fs=e(43856),Il=e(21539),fl=e(15356),Gl=e(88559),Rl=e(63509),$u=e(35942),zu=e(44815),Gu=e(71555),Hu=e(51115),fd=e(3271),Qu=e(45897),_u=e(93008),pd=e(99555),gd=e(47276),ku=e(23414),md=e(92790),Ic=e(61897),lc=e(16477),Yu=e(73858),Ju=e(7515),Zu=e(69234),Xu=e(18667),qu=e(93630),vd=e(62748),eh=e(49256),Hl=e(88977),th=e(3023);const Rc=({getContextMenuSource:Ce,timeZone:Fe,itemsGroup:Je,dimensions:it,contextDimensions:ht,...pt})=>{const zt=Ce(),Ft=Je?Je.map(hn=>({...hn,items:hn.items?.filter(Sn=>Sn.label)})):[],qt=()=>{if(!zt)return null;let hn;if(it?.yAxis&&ht?.yAxis?.[1]){const Mn=ze(it.yAxis,ht.yAxis[0],ht.yAxis[1]),Jn=zt.series.valueField.display;hn=Jn(Mn)}const Sn=(0,yr.LE)(zt.datapoint[0],{defaultWithMS:zt.series.hasMsResolution,timeZone:Fe});return(0,Dt.jsx)(yd,{timestamp:Sn,seriesColor:zt.series.color,displayName:zt.series.alias||zt.series.label,displayValue:hn})},sn=()=>Ft?.map((hn,Sn)=>(0,Dt.jsx)(Jd.r,{label:hn.label,children:(hn.items||[]).map(Mn=>(0,Dt.jsx)(Gc.D,{url:Mn.url,label:Mn.label,target:Mn.target,icon:Mn.icon,active:Mn.active,onClick:Mn.onClick},`${Mn.label}`))},`${hn.label}${Sn}`));return(0,Dt.jsx)(Fl.t,{...pt,renderMenuItems:sn,renderHeader:qt})},yd=({timestamp:Ce,seriesColor:Fe,displayName:Je,displayValue:it})=>{const ht=(0,es.of)(Ac);return(0,Dt.jsxs)("div",{className:ht.wrapper,children:[(0,Dt.jsx)("strong",{children:Ce}),(0,Dt.jsxs)(oc.Gy,{children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)(nu.p,{color:Fe}),(0,Dt.jsx)("span",{className:ht.displayName,children:Je})]}),it&&(0,Dt.jsx)(Il.i,{value:it})]})]})};function Ac(Ce){return{wrapper:(0,sa.css)({padding:Ce.spacing(.5,1),fontSize:Ce.typography.size.sm,zIndex:Ce.zIndex.tooltip}),displayName:(0,sa.css)({whiteSpace:"nowrap",paddingLeft:Ce.spacing(.5)})}}const nh=(Ce,Fe)=>{let Je=0,it=Ce.values.length-1,ht;for(;;){if(Je>it)return Math.max(it,0);ht=Math.floor((Je+it)/2);const pt=Ce.values[ht];if(pt===Fe)return ht;pt&&pt<Fe?Je=ht+1:it=ht-1}},ah=(Ce,Fe,Je,it)=>{let ht,pt,zt,Ft,qt;const sn=[];let hn,Sn;for(ht=0;ht<Ce.length;ht++){pt=Ce[ht];const Mn=Fe[ht];zt=nh(Mn,Je),Ft=Je-Mn.values[zt],qt=Mn.values[zt],(hn===void 0||Ft>=0&&(Ft<hn||hn<0)||Ft<0&&Ft>hn)&&(hn=Ft,Sn=Mn.display?(0,vs.cN)(Mn.display(qt)):qt);const Jn=pt.display(pt.values[zt]);sn.push({value:(0,vs.cN)(Jn),datapointIndex:zt,seriesIndex:ht,color:Jn.color,label:(0,gt.Ct)(pt),time:Mn.display?(0,vs.cN)(Mn.display(qt)):qt})}return{results:sn,time:Sn}},Oi=(Ce,Fe)=>(0,yr.LE)(Ce,{format:Fe?.options?.timeformat,timeZone:Fe?.options?.timezone}),xd=(Ce,Fe,Je)=>{if(Fe&&Je&&Ce){const it=Je-Fe,ht=it/Ce/1e3,pt=86400010,zt=31536e6;return ht<=10?Hs.WC.interval.millisecond:ht<=45?Hs.WC.interval.second:it<=pt?Hs.WC.interval.minute:ht<=8e4?Hs.WC.interval.hour:it<=zt?Hs.WC.interval.day:ht<=31536e3?Hs.WC.interval.month:Hs.WC.interval.year}return Hs.WC.interval.minute},Ed=({dimensions:Ce,activeDimensions:Fe,pos:Je,timeZone:it})=>{let ht=null;if(Fe.xAxis===null)return null;Fe.yAxis&&(ht=Fe.yAxis[0]);const pt=Fe.xAxis[1]?ze(Ce.xAxis,Fe.xAxis[0],Fe.xAxis[1]):Je.x,zt=ah(Ce.yAxis.columns,Ce.xAxis.columns,pt,it),Ft=zt.time,qt=zt.results.map((sn,hn)=>({color:sn.color,label:sn.label,value:sn.value,isActive:ht===hn}));return(0,Dt.jsx)(gr.o,{series:qt,timestamp:Ft})};Ed.displayName="MultiModeGraphTooltip";const Pd=({dimensions:Ce,activeDimensions:Fe,timeZone:Je})=>{if(Fe.yAxis===null||Fe.yAxis[1]===void 0||Fe.xAxis===null||Fe.xAxis[1]===void 0)return null;const it=ze(Ce.xAxis,Fe.xAxis[0],Fe.xAxis[1]),ht=we(Ce.xAxis,Fe.xAxis[0]),pt=ht.display?(0,vs.cN)(ht.display(it)):it,zt=we(Ce.yAxis,Fe.yAxis[0]),Ft=ze(Ce.yAxis,Fe.yAxis[0],Fe.yAxis[1]),qt=zt.display,sn=qt(Ft);return(0,Dt.jsx)(gr.o,{series:[{color:sn.color,label:(0,gt.Ct)(zt),value:(0,vs.cN)(sn)}],timestamp:pt})};Pd.displayName="SingleModeGraphTooltip";const bd=({mode:Ce=Tt.$N.Single,dimensions:Fe,activeDimensions:Je,pos:it,timeZone:ht})=>!Je||!Je.xAxis?null:Ce==="single"?(0,Dt.jsx)(Pd,{dimensions:Fe,activeDimensions:Je,timeZone:ht}):(0,Dt.jsx)(Ed,{dimensions:Fe,activeDimensions:Je,pos:it,timeZone:ht});bd.displayName="GraphTooltip";class jc extends Zt.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(Fe,Je)=>{const{onHorizontalRegionSelected:it}=this.props;it&&it(Je.xaxis.from,Je.xaxis.to)},this.onPlotHover=(Fe,Je,it)=>{this.setState({isTooltipVisible:!0,activeItem:it,pos:Je})},this.onPlotClick=(Fe,Je,it)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:it,contextPos:Je})},this.renderTooltip=()=>{const{children:Fe,series:Je,timeZone:it}=this.props,{pos:ht,activeItem:pt,isTooltipVisible:zt}=this.state;let Ft;if(!zt||!ht||Je.length===0||(Zt.Children.forEach(Fe,Ya=>{if(Ft)return;(Ya&&Ya.type&&(Ya.type.displayName||Ya.type.name))===si.displayName&&(Ft=Ya)}),!Ft))return null;const qt=Ft.props,sn=qt.mode||"single";if(!pt&&sn==="single")return null;const hn=qt.tooltipComponent||bd,Sn=pt?pt.series.seriesIndex:0,Mn=pt?pt.dataIndex:void 0,Jn={xAxis:[Sn,Mn],yAxis:pt?[pt.series.seriesIndex,pt.dataIndex]:null},$a={dimensions:{xAxis:be("xAxis",Je.map(Ya=>Ya.timeField)),yAxis:be("yAxis",Je.map(Ya=>Ya.valueField))},activeDimensions:Jn,pos:ht,mode:qt.mode||Tt.$N.Single,timeZone:it},Bs=Zt.createElement(hn,{...$a});return Zt.cloneElement(Ft,{content:Bs,position:{x:ht.pageX,y:ht.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:Fe}=this.props,{contextPos:Je,contextItem:it,isContextVisible:ht}=this.state;if(!ht||!Je||!it||Fe.length===0)return null;const pt=it?it.series.seriesIndex:0,zt=it?it.dataIndex:void 0,Ft={xAxis:[pt,zt],yAxis:it?[it.series.seriesIndex,it.dataIndex]:null},qt={xAxis:be("xAxis",Fe.map(Mn=>Mn.timeField)),yAxis:be("yAxis",Fe.map(Mn=>Mn.valueField))},sn=()=>this.setState({isContextVisible:!1}),hn=()=>({datapoint:it.datapoint,dataIndex:it.dataIndex,series:it.series,seriesIndex:it.series.seriesIndex,pageX:Je.pageX,pageY:Je.pageY}),Sn={x:Je.pageX,y:Je.pageY,onClose:sn,getContextMenuSource:hn,timeZone:this.props.timeZone,dimensions:qt,contextDimensions:Ft};return(0,Dt.jsx)(Rc,{...Sn})},this.getBarWidth=()=>{const{series:Fe}=this.props;return Math.min(...Fe.map(Je=>Je.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(Fe,Je){Fe!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=Qe()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(Fe){return Fe.length===0?[{show:!0,min:-1,max:1}]:(0,ws.uniqBy)(Fe.map(Je=>{const it=Je.yAxis?Je.yAxis.index:1,ht=Je.yAxis&&Je.yAxis.min&&!isNaN(Je.yAxis.min)?Je.yAxis.min:null,pt=Je.yAxis&&Je.yAxis.tickDecimals&&!isNaN(Je.yAxis.tickDecimals)?Je.yAxis.tickDecimals:null;return{show:!0,index:it,position:it===1?"left":"right",min:ht,tickDecimals:pt}}),Je=>Je.index)}draw(){if(this.element===null)return;const{width:Fe,series:Je,timeRange:it,showLines:ht,showBars:pt,showPoints:zt,isStacked:Ft,lineWidth:qt,timeZone:sn,onHorizontalRegionSelected:hn}=this.props;if(!Fe)return;const Sn=Fe/100,Mn=it.from.valueOf(),Jn=it.to.valueOf(),$a=this.getYAxes(Je),Bs={legend:{show:!1},series:{stack:Ft,lines:{show:ht,lineWidth:qt,zero:!1},points:{show:zt,fill:1,fillColor:!1,radius:2},bars:{show:pt,fill:1,barWidth:pt?this.getBarWidth()/1.5:1,zero:!1,lineWidth:qt},shadowSize:0},xaxis:{timezone:sn,show:!0,mode:"time",min:Mn,max:Jn,label:"Datetime",ticks:Sn,timeformat:xd(Sn,Mn,Jn),tickFormatter:Oi},yaxes:$a,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:hn?"x":null,color:"#666"},crosshair:{mode:"x"}};try{Qe().plot(this.element,Je.filter(Ya=>Ya.isVisible),Bs)}catch(Ya){throw console.error("Graph rendering error",Ya,Bs,Je),new Error("Error rendering panel")}}render(){const{ariaLabel:Fe,height:Je,width:it,series:ht}=this.props,pt=ht.length===0,zt=this.renderTooltip(),Ft=this.renderContextMenu();return(0,Dt.jsxs)("div",{className:"graph-panel","aria-label":Fe,children:[(0,Dt.jsx)("div",{className:"graph-panel__chart",ref:qt=>this.element=qt,style:{height:Je,width:it},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),pt&&(0,Dt.jsx)("div",{className:"datapoints-warning",children:"No data"}),zt,Ft]})}}const sh=null,rh=(Ce,Fe=!1,Je=!1)=>{const it=Ce.reduce((pt,zt)=>pt+(zt[1]||0),0)===0,ht=!Ce.reduce((pt,zt)=>pt&&zt[1]!==null,!0);return Fe&&ht||Je&&it},oh=Ce=>{const{series:Fe,timeRange:Je,width:it,height:ht,showBars:pt,showLines:zt,showPoints:Ft,sortLegendBy:qt,sortLegendDesc:sn,legendDisplayMode:hn,legendVisibility:Sn,placement:Mn,onSeriesToggle:Jn,onToggleSort:$a,hideEmpty:Bs,hideZero:Ya,isStacked:Zr,lineWidth:Ir,onHorizontalRegionSelected:ro,timeZone:hr,children:Po,ariaLabel:ua}=Ce,{graphContainer:jn,wrapper:us,legendContainer:ta}=(0,es.of)(ih,Ce.placement),Ts=Fe.reduce((Ms,Rs)=>rh(Rs.data,Bs,Ya)?Ms:Ms.concat([{label:Rs.label,color:Rs.color||"",disabled:!Rs.isVisible,yAxis:Rs.yAxis.index,getDisplayValues:()=>Rs.info||[]}]),[]);return(0,Dt.jsxs)("div",{className:us,"aria-label":ua,children:[(0,Dt.jsx)("div",{className:jn,children:(0,Dt.jsx)(jc,{series:Fe,timeRange:Je,timeZone:hr,showLines:zt,showPoints:Ft,showBars:pt,width:it,height:ht,isStacked:Zr,lineWidth:Ir,onHorizontalRegionSelected:ro,children:Po})}),Sn&&(0,Dt.jsx)("div",{className:ta,children:(0,Dt.jsx)(ba.E,{hideHorizontalTrack:!0,children:(0,Dt.jsx)(Tl.t,{items:Ts,displayMode:hn,placement:Mn,sortBy:qt,sortDesc:sn,onLabelClick:(Ms,Rs)=>{Jn&&Jn(Ms.label,Rs)},onToggleSort:$a})})})]})},ih=(Ce,Fe)=>({wrapper:(0,sa.css)({display:"flex",flexDirection:Fe==="bottom"?"column":"row"}),graphContainer:(0,sa.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,sa.css)({padding:"10px 0",maxHeight:Fe==="bottom"?"35%":"none"})});class lh extends Zt.Component{constructor(Fe){super(Fe),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:Fe.series}}componentDidUpdate(Fe){const{series:Je}=this.props;(0,ws.isEqual)(Fe.series,Je)||this.setState({hiddenSeries:[],toggledSeries:Je})}onSeriesToggle(Fe,Je){const{series:it,onHiddenSeriesChanged:ht}=this.props,{hiddenSeries:pt}=this.state;if(Je.ctrlKey||Je.metaKey||Je.shiftKey){const sn=pt.indexOf(Fe)>-1?pt.filter(Sn=>Sn!==Fe):pt.concat([Fe]),hn=it.map(Sn=>({...Sn,isVisible:sn.indexOf(Sn.label)===-1}));this.setState({hiddenSeries:sn,toggledSeries:hn},()=>ht?ht(sn):void 0);return}const zt=it.map(sn=>sn.label),Ft=pt.length+1===zt.length?[]:(0,ws.difference)(zt,[Fe]),qt=it.map(sn=>({...sn,isVisible:Ft.indexOf(sn.label)===-1}));this.setState({hiddenSeries:Ft,toggledSeries:qt},()=>ht?ht(Ft):void 0)}render(){const{children:Fe}=this.props,{toggledSeries:Je}=this.state;return Fe({onSeriesToggle:this.onSeriesToggle,toggledSeries:Je})}}var ch=e(64423),Ql=e(99165),Gi=e(36192);const dh={threshold:(Ce,Fe,Je)=>Ce+Je,midpoint:(Ce,Fe,Je)=>(Ce+Fe)/2,plusone:(Ce,Fe,Je)=>Ce+1};function Dd(Ce){if(Ce.frame.length===0)return Ce.frame;let Fe=!0,{frame:Je,refFieldName:it,refFieldPseudoMax:ht,refFieldPseudoMin:pt,insertMode:zt}=Ce;zt||(zt=dh.threshold);const Ft=Cd(Je,it);if(Ft==null)return Je;Ft.state={...Ft.state,nullThresholdApplied:!0};const qt=Je.fields.map(hn=>hn.config.custom?.insertNulls||Ft.config.interval||null),sn=new Set(qt);if(sn.delete(null),sn.size===0)return Je;if(sn.size===1){const hn=sn.values().next().value;if(!hn||hn<=0)return Je;const Sn=Ft.values,Mn=Je.fields.map($a=>$a.values),Jn=Hi(Sn,Mn,hn,pt,ht,zt,Fe);return Jn===Mn?Je:{...Je,length:Jn[0].length,fields:Je.fields.map(($a,Bs)=>({...$a,values:Jn[Bs]}))}}return Je}function Hi(Ce,Fe,Je,it=null,ht=null,pt,zt){const Ft=Ce.length,qt=[];if(it!=null&&it<Ce[0]){let Mn=Math.ceil((Ce[0]-it)/Je),Jn=Ce[0]-Mn*Je;for(;Jn<Ce[0];)qt.push(pt(Jn-Je,Jn,Je)),Jn+=Je}qt.push(Ce[0]);let sn=Ce[0];for(let Mn=1;Mn<Ft;Mn++){const Jn=Ce[Mn];for(;Jn-sn>Je&&(qt.push(pt(sn,Jn,Je)),sn+=Je,!!zt););qt.push(Jn),sn=Jn}if(ht!=null&&ht>sn)for(;sn+Je<ht;)qt.push(pt(sn,ht,Je)),sn+=Je;const hn=qt.length;if(hn===Ft)return Fe;const Sn=[];for(let Mn of Fe){let Jn;if(Mn!==Ce){Jn=Array(hn);for(let $a=0,Bs=0;$a<hn;$a++)Jn[$a]=Ce[Bs]===qt[$a]?Mn[Bs++]:null}else Jn=qt;Sn.push(Jn)}return Sn}function Ho(Ce,Fe,Je){let it,ht;for(let pt=0;pt<Fe.length;pt++)if(Fe[pt]==null)ht==null&&it!=null&&(ht=pt);else{if(ht!=null){if(Ce[pt]-it<Je)for(;ht<pt;)Fe[ht++]=void 0;ht=null}it=Ce[pt]}return Fe}function cc(Ce){return Ce.type===ya.PU.number&&Ce.config.custom?.drawStyle===Tt.GR.Bars&&!Ce.config.custom?.hideFrom?.viz}function Cd(Ce,Fe){return Ce.fields.find(Je=>Fe!=null?Je.name===Fe:Je.type===ya.PU.time)}function uh(Ce,Fe){const Je=Cd(Ce,Fe);let it=Je?.values;for(let ht=0;ht<Ce.fields.length;ht++){let pt=Ce.fields[ht];if(pt===Je||cc(pt))continue;let zt=pt.config.custom?.spanNulls;typeof zt=="number"&&zt!==-1&&it&&(pt.values=Ho(it,pt.values,zt))}return Ce}function _l(Ce,Fe,Je){let it;e:for(let Ft of Ce)for(let qt of Ft.fields)if(Fe.x(qt,Ft,Ce)){it=qt;break e}Ce=Ce.map(Ft=>it?.state?.nullThresholdApplied?Ft:Dd({frame:Ft,refFieldName:it.name,refFieldPseudoMin:Je?.from.valueOf(),refFieldPseudoMax:Je?.to.valueOf()}));let ht=0;Ce.forEach(Ft=>{Ft.fields.forEach(qt=>{cc(qt)&&(qt.config.custom={...qt.config.custom,spanNulls:-1},ht++)})});let pt=1/0;ht>1&&Ce.forEach(Ft=>{if(!Ft.fields.some(cc))return;const qt=it.values;for(let sn=0;sn<qt.length;sn++)sn>0&&(pt=Math.min(pt,qt[sn]-qt[sn-1]))});let zt=(0,Ta.Fd)({frames:Ce,joinBy:Fe.x,keep:Fe.y,keepOriginIndices:!0});return zt?(zt=uh(zt,it.name),pt!==1/0&&(zt.fields.forEach((Ft,qt)=>{let sn=Ft.values;if(qt===0){let hn=sn[sn.length-1];sn.push(hn+pt,hn+2*pt)}else cc(Ft)?sn.push(null,null):sn.push(void 0,void 0)}),zt.length+=2),zt):null}function Td(Ce,Fe){const Je="na",it=`${Ce.min!==void 0?Ce.min:Je}-${Ce.max!==void 0?Ce.max:Je}`,ht=`${Ce.custom?.axisSoftMin!==void 0?Ce.custom.axisSoftMin:Je}-${Ce.custom?.axisSoftMax!==void 0?Ce.custom.axisSoftMax:Je}`,pt=`${Ce.custom?.axisPlacement!==void 0?Ce.custom?.axisPlacement:Tt.vM.Auto}`,zt=Ce.unit??vd.s,Ft=Ce.custom?.scaleDistribution?Lc(Ce.custom.scaleDistribution):Tt.L4.Linear,qt=Ce.custom?.axisLabel?Ce.custom.axisLabel:Je;return`${zt}/${it}/${ht}/${pt}/${Ft}/${qt}/${Fe}`}function Lc(Ce){return Ce.type===Tt.L4.Log?`${Ce.type}${Ce.log}`:Ce.type}function hh(Ce,Fe,Je=[]){for(const it of Je)if(typeof it=="function"){if(!it(Ce,Fe))return!1}else if(Fe[it]!==Ce[it])return!1;return!0}class Md extends Zt.Component{constructor(Fe){super(Fe),this.panelContext={},this.subscription=new ch.yU,this.getTimeRange=()=>this.props.timeRange;let Je=this.prepState(Fe);Je.alignedData=Je.config.prepData([Je.alignedFrame]),this.state=Je,this.plotInstance=Zt.createRef()}static{this.contextType=Sr.e4}prepState(Fe,Je=!0){let it=null;const{frames:ht,fields:pt,preparePlotFrame:zt}=Fe,qt=(zt||_l)(ht,pt||{x:Wn.sJ.get(kn.Ct.firstTimeField).get({}),y:Wn.sJ.get(kn.Ct.byTypes).get(new Set([ya.PU.number,ya.PU.enum]))},Fe.timeRange);if((0,Gi.uY)("GraphNG",!1,"data aligned",qt),qt){let sn=this.state?.config;Je&&(sn=Fe.prepConfig(qt,this.props.frames,this.getTimeRange),(0,Gi.uY)("GraphNG",!1,"config prepared",sn)),it={alignedFrame:qt,config:sn},(0,Gi.uY)("GraphNG",!1,"data prepared",it.alignedData)}return it}handleCursorUpdate(Fe){const Je=Fe.payload?.point?.time,it=this.plotInstance.current;if(it&&Je){const ht=it.valToPos(Je,"x");let pt;if(ht&&(pt=(0,Gi.sw)(it,it.posToIdx(ht))),!pt||!ht)return;it.setCursor({left:ht,top:pt})}}componentDidMount(){this.panelContext=this.context;const{eventBus:Fe}=this.panelContext;this.subscription.add(Fe.getStream(yn.b_).pipe((0,Ql.c)(50)).subscribe({next:Je=>{Fe!==Je.origin&&this.handleCursorUpdate(Je)}})),this.subscription.add(Fe.getStream(Gr.kb).pipe((0,Ql.c)(50)).subscribe({next:Je=>this.handleCursorUpdate(Je)})),this.subscription.add(Fe.getStream(yn.ql).pipe((0,Ql.c)(50)).subscribe({next:()=>{const Je=this.plotInstance?.current;Je&&!Je.cursor._lock&&Je.setCursor({left:-10,top:-10})}}))}componentDidUpdate(Fe){const{frames:Je,structureRev:it,timeZone:ht,propsToDiff:pt}=this.props,zt=!hh(Fe,this.props,pt);if(Je!==Fe.frames||zt||ht!==Fe.timeZone){let Ft=this.prepState(this.props,!1);Ft&&((this.state.config===void 0||ht!==Fe.timeZone||it!==Fe.structureRev||!it||zt)&&(Ft.config=this.props.prepConfig(Ft.alignedFrame,this.props.frames,this.getTimeRange),(0,Gi.uY)("GraphNG",!1,"config recreated",Ft.config)),Ft.alignedData=Ft.config.prepData([Ft.alignedFrame]),this.setState(Ft))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:Fe,height:Je,children:it,renderLegend:ht}=this.props,{config:pt,alignedFrame:zt,alignedData:Ft}=this.state;return pt?(0,Dt.jsx)(so.KU,{width:Fe,height:Je,legend:ht(pt),children:(qt,sn)=>(0,Dt.jsx)(md.Z,{config:pt,data:Ft,width:qt,height:sn,plotRef:hn=>this.plotInstance.current=hn,children:it?it(pt,zt):null})}):null}}var Sd=e(36613),kl=e(66650);const fh=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),Bc=Array(53);for(let Ce=0;Ce<Bc.length;Ce++)Bc[Ce]=2**Ce;const ph=(Ce,Fe=1)=>Ce==null?"-":Ce.toFixed(Fe),gh={drawStyle:Tt.GR.Line,showPoints:Tt.yL.Auto,axisPlacement:Tt.vM.Auto},Od=({frame:Ce,theme:Fe,timeZones:Je,getTimeRange:it,sync:ht,allFrames:pt,renderers:zt,tweakScale:Ft=sn=>sn,tweakAxis:qt=sn=>sn})=>{const sn="__global_",hn=new gd.e(Je[0]);let Sn;hn.setPrepData(ua=>(Sn=ua[0],(0,Gi.bq)(ua[0],hn.getStackingGroups())));const Mn=Ce.fields[0];if(!Mn)return hn;const Jn="x";let $a="";const Bs=Mn.config.custom?.axisPlacement!==Tt.vM.Hidden?Tt.vM.Bottom:Tt.vM.Hidden,Ya=Mn.config.custom?.axisPlacement!==Tt.vM.Hidden;if(Mn.type===ya.PU.time){hn.addScale({scaleKey:Jn,orientation:Tt.Lt.Horizontal,direction:Tt.ON.Right,isTime:!0,range:()=>{const jn=it();return[jn.from.valueOf(),jn.to.valueOf()]}});const ua=Je.length>1?(jn,us)=>us.map((ta,Ts)=>Ts<2?null:ta):void 0;for(let jn=0;jn<Je.length;jn++){const us=Je[jn];hn.addAxis({scaleKey:Jn,isTime:!0,placement:Bs,show:Ya,label:Mn.config.custom?.axisLabel,timeZone:us,theme:Fe,grid:{show:jn===0&&Mn.config.custom?.axisGridShow},filter:ua})}Je.length>1&&hn.addHook("drawAxes",jn=>{jn.ctx.save(),jn.ctx.fillStyle=Fe.colors.text.primary,jn.ctx.textAlign="left",jn.ctx.textBaseline="bottom";let us=0;jn.axes.forEach(ta=>{if(ta.side===2){let Ts=ta._pos+ta._size;jn.ctx.fillText(Je[us],jn.bbox.left,Ts*Sd.A.pxRatio),us++}}),jn.ctx.restore()})}else hn.addScale({scaleKey:Jn,orientation:Tt.Lt.Horizontal,direction:Tt.ON.Right,range:(ua,jn,us)=>[Mn.config.min??jn,Mn.config.max??us]}),hn.addAxis({scaleKey:Jn,placement:Bs,show:Ya,label:Mn.config.custom?.axisLabel,theme:Fe,grid:{show:Mn.config.custom?.axisGridShow},formatValue:(ua,jn)=>(0,vs.cN)(Mn.display(ua,jn))});let Zr=zt?.flatMap(ua=>Object.values(ua.fieldMap).filter(jn=>ua.indicesOnly.indexOf(jn)===-1))??[],Ir;for(let ua=1;ua<Ce.fields.length;ua++){const jn=Ce.fields[ua],us={...jn.config,custom:{...gh,...jn.config.custom}},ta=us.custom;if(jn===Mn||jn.type!==ya.PU.number&&jn.type!==ya.PU.enum)continue;let Ts=jn.display??ph;jn.config.custom?.stacking?.mode===Tt.gs.Percent&&(Ts=(0,Yt.J)({field:{...jn,config:{...jn.config,unit:"percentunit"}},theme:Fe}));const Ms=Td(us,jn.type),Rs=(0,En.Qi)(jn),Js=(0,En.lz)(jn,Fe).color;if(hn.addScale(Ft({scaleKey:Ms,orientation:Tt.Lt.Vertical,direction:Tt.ON.Up,distribution:ta.scaleDistribution?.type,log:ta.scaleDistribution?.log,linearThreshold:ta.scaleDistribution?.linearThreshold,min:jn.config.min,max:jn.config.max,softMin:ta.axisSoftMin,softMax:ta.axisSoftMax,centeredZero:ta.axisCenteredZero,range:ta.stacking?.mode===Tt.gs.Percent?(Cr,ko,Ao)=>(ko=ko<0?-1:0,Ao=Ao>0?1:0,[ko,Ao]):jn.type===ya.PU.enum?(Cr,ko,Ao)=>[-1,jn.config.type.enum.text.length]:void 0,decimals:jn.config.decimals},jn)),$a||($a=Ms),ta.axisPlacement!==Tt.vM.Hidden){let Cr;ta.axisColorMode===Tt.Y$.Series&&(Rs.isByValue&&jn.config.custom?.gradientMode===Tt.on.Scheme&&Rs.id===Hr.Y.Thresholds?Cr=(0,kl.pl)(1,Fe,Rs,jn.config.thresholds):Cr=Js);const ko={border:{show:ta.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Cr||Fe.colors.text.primary},ticks:{show:ta.axisBorderShow||!1,stroke:Cr||Fe.colors.text.primary},color:Cr||Fe.colors.text.primary};let Ao,Vr,Do;if(fh.has(us.unit))Ao=Bc;else if(jn.type===ya.PU.enum){let co=jn.config.type.enum.text;Do=co.map((Yo,$r)=>$r),Vr=co}hn.addAxis(qt({scaleKey:Ms,label:ta.axisLabel,size:ta.axisWidth,placement:ta.axisPlacement??Tt.vM.Auto,formatValue:(co,Yo)=>(0,vs.cN)(Ts(co,Yo)),theme:Fe,grid:{show:ta.axisGridShow},decimals:jn.config.decimals,distr:ta.scaleDistribution?.type,splits:Do,values:Vr,incrs:Ao,...ko},jn))}const mr=ta.drawStyle===Tt.GR.Points?Tt.yL.Always:ta.showPoints;let bo=()=>null;ta.spanNulls!==!0&&(bo=(Cr,ko,Ao,Vr)=>{let Do=[],co=Cr.series[ko];if(!Ao&&Vr&&Vr.length){const[Yo,$r]=co.idxs,ml=Cr.data[0],Al=Cr.data[ko],$c=Math.round(Cr.valToPos(ml[Yo],"x",!0)),Us=Math.round(Cr.valToPos(ml[$r],"x",!0));Vr[0][0]===$c&&Do.push(Yo);for(let vr=0;vr<Vr.length;vr++){let Jo=Vr[vr],Zo=Vr[vr+1];if(Zo&&Jo[1]===Zo[0]){let Ii=Cr.posToIdx(Jo[1],!0);if(Al[Ii]==null)for(let Qi=1;Qi<100;Qi++){if(Al[Ii+Qi]!=null){Ii+=Qi;break}if(Al[Ii-Qi]!=null){Ii-=Qi;break}}Do.push(Ii)}}Vr[Vr.length-1][1]===Us&&Do.push($r)}return Do.length?Do:null});let{fillOpacity:oo}=ta,li=null,wr=null;if(jn.state?.origin){Ir||(Ir=Id(Ce,pt));const Cr=pt[jn.state.origin.frameIndex],ko=Cr?.fields[jn.state.origin.fieldIndex],Ao=(0,gt.Ct)(ko??jn,Cr,pt);if(Zr.indexOf(Ao)>=0)li=()=>null,wr=()=>{};else if(ta.transform===Tt.NU.Constant){const Vr=Sd.A.paths.linear();li=(Do,co)=>{const Yo=Do._data,$r=it();let ml=[$r.from.valueOf(),$r.to.valueOf()],Al=Yo[co].find(vr=>vr!=null),$c=[Al,Al],Us=Yo.slice();return Us[0]=ml,Us[co]=$c,Vr({...Do,_data:Us},co,0,1)}}if(ta.fillBelowTo){const Vr=Ce.fields.find($r=>ta.fillBelowTo===$r.name||ta.fillBelowTo===$r.config?.displayNameFromDS||ta.fillBelowTo===(0,gt.Ct)($r,Ce,pt)),Do=Vr?(0,gt.Ct)(Vr,Ce,pt):ta.fillBelowTo,co=Ir.get(Ao),Yo=Ir.get(Do);(0,ws.isNumber)(Yo)&&(0,ws.isNumber)(co)?(hn.addBand({series:[co,Yo],fill:void 0}),oo||(oo=35)):oo=0}}let yc;Rs.id===Hr.Y.Thresholds&&(yc=Cr=>(0,En.lz)(Sn.fields[Cr],Fe).color),hn.addSeries({pathBuilder:li,pointsBuilder:wr,scaleKey:Ms,showPoints:mr,pointsFilter:bo,colorMode:Rs,fillOpacity:oo,theme:Fe,dynamicSeriesColor:yc,drawStyle:ta.drawStyle,lineColor:ta.lineColor??Js,lineWidth:ta.lineWidth,lineInterpolation:ta.lineInterpolation,lineStyle:ta.lineStyle,barAlignment:ta.barAlignment,barWidthFactor:ta.barWidthFactor,barMaxWidth:ta.barMaxWidth,pointSize:ta.pointSize,spanNulls:ta.spanNulls||!1,show:!ta.hideFrom?.viz,gradientMode:ta.gradientMode,thresholds:us.thresholds,hardMin:jn.config.min,hardMax:jn.config.max,softMin:ta.axisSoftMin,softMax:ta.axisSoftMax,dataFrameFieldIndex:jn.state?.origin}),ta.thresholdsStyle&&us.thresholds&&(ta.thresholdsStyle.mode??Tt.Ly.Off)!==Tt.Ly.Off&&hn.addThresholds({config:ta.thresholdsStyle,thresholds:us.thresholds,scaleKey:Ms,theme:Fe,hardMin:jn.config.min,hardMax:jn.config.max,softMin:ta.axisSoftMin,softMax:ta.axisSoftMax})}let ro=(0,Gi.ro)(Ce);hn.setStackingGroups(ro),zt?.forEach(ua=>{Ir||(Ir=Id(Ce,pt));let jn={};for(let us in ua.fieldMap){let ta=ua.fieldMap[us];jn[us]=Ir.get(ta)}ua.init(hn,jn)}),hn.scaleKeys=[Jn,$a];const hr=15;let Po={dataIdx:(ua,jn,us,ta)=>{let Ts=ua.data[jn];if(Ts[us]==null){let Ms=null,Rs=null,Ss;for(Ss=us;Ms==null&&Ss-- >0;)Ts[Ss]!=null&&(Ms=Ss);for(Ss=us;Rs==null&&Ss++<Ts.length;)Ts[Ss]!=null&&(Rs=Ss);let Js=ua.data[0],mr=ua.valToPos(ta,"x"),bo=Rs==null?1/0:ua.valToPos(Js[Rs],"x"),oo=Ms==null?-1/0:ua.valToPos(Js[Ms],"x"),li=mr-oo,wr=bo-mr;li<=wr?li<=hr&&(us=Ms):wr<=hr&&(us=Rs)}return us}};return ht&&ht()!==Ua.y.Off&&(Po.sync={key:sn,scales:[Jn,null]}),hn.setCursor(Po),hn};function Id(Ce,Fe){const Je=new Map;return Ce.fields.forEach((it,ht)=>{const pt=it.state?.origin;if(pt){const zt=Fe[pt.frameIndex]?.fields[pt.fieldIndex];zt&&Je.set((0,gt.Ct)(zt,Fe[pt.frameIndex],Fe),ht)}}),Je}const mh=["legend","options","theme"];class vh extends Zt.Component{constructor(){super(...arguments),this.prepConfig=(Fe,Je,it)=>{const{sync:ht}=this.context,{theme:pt,timeZone:zt,renderers:Ft,tweakAxis:qt,tweakScale:sn}=this.props;return Od({frame:Fe,theme:pt,timeZones:Array.isArray(zt)?zt:[zt],getTimeRange:it,sync:ht,allFrames:Je,renderers:Ft,tweakScale:sn,tweakAxis:qt})},this.renderLegend=Fe=>{const{legend:Je,frames:it}=this.props;return!Fe||Je&&!Je.showLegend||!(0,Ic.t)(Fe,it)?null:(0,Dt.jsx)(Ic.$,{data:it,config:Fe,...Je})}}static{this.contextType=Sr.e4}render(){return(0,Dt.jsx)(Md,{...this.props,prepConfig:this.prepConfig,propsToDiff:mh,renderLegend:this.renderLegend})}}const Rd=(0,es.cV)(vh);Rd.displayName="TimeSeries";const yh=(0,Zt.createContext)({}),ff=()=>{const{data:Ce,dimFields:Fe,mapSeriesIndexToDataFrameFieldIndex:Je}=(0,Zt.useContext)(yh),it=(0,Zt.useCallback)(()=>{const ht=Fe.x;let pt=null;for(let zt=0;zt<Ce.fields.length;zt++)if(ht(Ce.fields[zt],Ce,[Ce])){pt=Ce.fields[zt];break}return pt},[Ce,Fe]);return{dimFields:Fe,mapSeriesIndexToDataFrameFieldIndex:Je,getXAxisField:it,alignedData:Ce}},Ad=5,Uc=Ce=>Ce!=null&&!Ce.ctrlKey&&!Ce.metaKey,xh=({onZoom:Ce,config:Fe,withZoomY:Je=!1})=>((0,Zt.useLayoutEffect)(()=>{let it=!1,ht=!1;Je&&Fe.addHook("init",pt=>{pt.over.addEventListener("mousedown",zt=>{if(Uc(zt)&&zt.button===0&&zt.shiftKey){ht=!0,pt.cursor.drag.x=!1,pt.cursor.drag.y=!0;let Ft=qt=>{pt.cursor.drag.x=!0,pt.cursor.drag.y=!1,document.removeEventListener("mouseup",Ft,!0)};document.addEventListener("mouseup",Ft,!0)}},!0)}),Fe.addHook("setSelect",pt=>{const zt=pt.scales.x.ori===0;if(Uc(pt.cursor.event)){if(Je&&ht){if(pt.select.height>=Ad){for(let Ft in pt.scales)if(Ft!=="x"){const qt=zt?pt.posToVal(pt.select.top,Ft):pt.posToVal(pt.select.left+pt.select.width,Ft),sn=zt?pt.posToVal(pt.select.top+pt.select.height,Ft):pt.posToVal(pt.select.left,Ft);pt.setScale(Ft,{min:sn,max:qt})}it=!0}ht=!1}else if(pt.select.width>=Ad){const Ft=zt?pt.posToVal(pt.select.left,"x"):pt.posToVal(pt.select.top+pt.select.height,"x"),qt=zt?pt.posToVal(pt.select.left+pt.select.width,"x"):pt.posToVal(pt.select.top,"x");Ce({from:Ft,to:qt}),it=!1}}pt.setSelect({left:0,width:0,top:0,height:0},!1)}),Fe.setCursor({bind:{dblclick:pt=>()=>{if(!Uc(pt.cursor.event))return null;if(Je&&it){for(let zt in pt.scales)zt!=="x"&&pt.setScale(zt,{min:null,max:null});it=!1}else{let zt=pt.scales.x;const Ft=zt.min,qt=zt.max,sn=(qt-Ft)/2;Ce({from:Ft-sn,to:qt+sn})}return null}}})},[Fe,Ce,Je]),null);var Eh=e(1604);const jd=10,Ph=({mode:Ce=Tt.$N.Single,sortOrder:Fe=Tt.xB.None,sync:Je,timeZone:it,config:ht,renderTooltip:pt,...zt})=>{const Ft=(0,Zt.useRef)(),qt=(0,es.$j)(),[sn,hn]=(0,Zt.useState)(null),[Sn,Mn]=(0,Zt.useState)(null),[Jn,$a]=(0,Zt.useState)([]),[Bs,Ya]=(0,Zt.useState)(null),[Zr,Ir]=(0,Zt.useState)(!1),ro=(0,Eh.A)();let hr=null;const Po=(0,es.of)(Dh);if((0,Zt.useLayoutEffect)(()=>{let Ts;const Ms=()=>{ro()&&(Ir(!0),Ft.current?.root.classList.add("plot-active"))},Rs=()=>{ro()&&(Ya(null),Ir(!1),Ft.current?.root.classList.remove("plot-active"))};return ht.addHook("syncRect",(Ss,Js)=>Ts=Js),ht.addHook("init",Ss=>{Ft.current=Ss,Ss.over.addEventListener("mouseenter",Ms),Ss.over.addEventListener("mouseleave",Rs),hr=Ss.root.closest("[tabindex]"),hr&&(hr.addEventListener("focus",Ms),hr.addEventListener("blur",Rs)),Je&&Je()===Ua.y.Crosshair&&Ss.root.classList.add("shared-crosshair")}),ht.addHook("setLegend",Ss=>{ro()&&(Mn(Ss.legend.idx),$a(Ss.legend.idxs.slice()))}),ht.addHook("setCursor",Ss=>{if(!Ts||!ro())return;const{x:Js,y:mr}=bh(Ss,Ts);Ya(Js!==void 0&&mr!==void 0?{x:Js,y:mr}:null)}),ht.addHook("setSeries",(Ss,Js)=>{ro()&&hn(Js)}),()=>{Ya(null),Ft.current&&(Ft.current.over.removeEventListener("mouseleave",Rs),Ft.current.over.removeEventListener("mouseenter",Ms),hr&&(hr.removeEventListener("focus",Ms),hr.removeEventListener("blur",Rs)))}},[ht,Ya,Ir,Mn,$a]),Sn===null||!Zr&&Je&&Je()===Ua.y.Crosshair)return null;let ua=zt.data.fields[0];if(!ua)return null;const jn=ua.display||(0,Yt.J)({field:ua,timeZone:it,theme:qt});let us=null,ta=jn(ua.values[Sn]).text;if(pt)us=pt(zt.data,sn,Sn);else{if(Ce===Tt.$N.Single&&sn!==null){const Ts=zt.data.fields[sn];if(!Ts)return null;const Ms=Jn?.[sn]??Sn;ta=jn(ua.values[Ms]).text;const Ss=(Ts.display||(0,Yt.J)({field:Ts,timeZone:it,theme:qt}))(Ts.values[Ms]);us=(0,Dt.jsx)(gr.o,{series:[{color:Ss.color||Hr.F,label:(0,gt.Ct)(Ts,zt.data,zt.frames),value:Ss?(0,vs.cN)(Ss):null}],timestamp:ta})}if(Ce===Tt.$N.Multi){let Ts=[];const Ms=zt.data,Rs=Ms.fields,Ss=[];for(let Js=0;Js<Rs.length;Js++){const mr=Ms.fields[Js];if(!mr||mr===ua||mr.type===ya.PU.time||mr.type!==ya.PU.number||mr.config.custom?.hideFrom?.tooltip||mr.config.custom?.hideFrom?.viz)continue;const bo=zt.data.fields[Js].values[Jn[Js]],oo=mr.display(bo);Ss.push(bo),Ts.push({color:oo.color||Hr.F,label:(0,gt.Ct)(mr,Ms,zt.frames),value:oo?(0,vs.cN)(oo):null,isActive:sn===Js})}if(Fe!==Tt.xB.None){const Js=[...Ts],mr=Vt.sortValues(Fe);Ts.sort((bo,oo)=>{const li=Js.indexOf(bo),wr=Js.indexOf(oo);return mr(Ss[li],Ss[wr])})}us=(0,Dt.jsx)(gr.o,{series:Ts,timestamp:ta})}}return(0,Dt.jsx)(ca.ZL,{className:Zr?Po.tooltipWrapper:void 0,children:us&&Bs&&(0,Dt.jsx)(Mr.o,{position:{x:Bs.x,y:Bs.y},offset:{x:jd,y:jd},children:us})})};function Ld({left:Ce,top:Fe},Je){return Ce===void 0||Fe===void 0?!1:Ce<0||Ce>Je.width||Fe<0||Fe>Je.height}function bh(Ce,Fe){let Je,it;const ht=Ce.cursor.left||0,pt=Ce.cursor.top||0;if(Ld(Ce.cursor,Fe)){const zt=Ce.posToIdx(ht);if(pt<0||pt>Fe.height){let Ft=(0,Gi.sw)(Ce,zt);Ft&&(it=Fe.top+Ft,ht>=0&&ht<=Fe.width&&(Je=Fe.left+Ce.valToPos(Ce.data[0][Ce.posToIdx(ht)],Ce.series[0].scale)))}}else Je=Fe.left+ht,it=Fe.top+pt;return{x:Je,y:it}}const Dh=Ce=>({tooltipWrapper:(0,sa.css)({"z-index":Ce.zIndex.portal+1+" !important"})});var Bd=e(56887),Ch=e(53926),dc=e(97958),oi=e(8255),uc=e(75745),hc=e(35458),Th=e(75254),Wc=e(48542);let Yl=null;function Mh(){if(Yl!==null)return Yl;if(typeof document<"u"){const Ce=document.createElement("div"),Fe={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(Fe).map(Je=>{Ce.style[Je]=Fe[Je]}),document.body.appendChild(Ce),Yl=Ce.offsetWidth-Ce.clientWidth,document.body.removeChild(Ce)}else Yl=0;return Yl||0}var Sh=e(86059),Ud=e(36324),Oh=e(79104),Ih=e(59258),Rh=e(60379),Ah=e(20720),Wd=(Ce=>(Ce.id="id",Ce.title="title",Ce.subTitle="subTitle",Ce.mainStat="mainStat",Ce.secondaryStat="secondaryStat",Ce.source="source",Ce.target="target",Ce.detail="detail__",Ce.arc="arc__",Ce.color="color",Ce))(Wd||{}),jh=e(63267);function Lh(Ce,Fe,Je,it){if(Ce>Fe){const ht=`[Combobox] Items exceed the recommended amount ${Fe}.`;console.warn(ht,{itemsCount:""+Ce,recommendedAmount:""+Fe,"aria-labelledby":it??"",id:Je??""})}}let fc;const Nd=(Ce="dark")=>fc?fc(Ce):(0,Xs.a)({colors:{mode:Ce}}).v1,Bh=Ce=>(fc=Ce,()=>{fc=null});var Nc=e(77345),Uh=e(24726);const pl={"[":"]","{":"}","(":")"},Kc="brace_match";function Wh(){return{onKeyDown(Ce,Fe,Je){const{value:it}=Fe;switch(Ce.key){case"(":case"{":case"[":{const{start:{offset:ht,key:pt},end:{offset:zt,key:Ft},focus:{offset:qt}}=it.selection,sn=it.focusText.text;if(it.selection.isExpanded)return Ce.preventDefault(),Fe.insertTextByKey(pt,ht,Ce.key).insertTextByKey(Ft,zt+1,pl[Ce.key]).moveEndBackward(1),!0;if(qt===sn.length||sn[qt]===" "||Object.values(pl).includes(sn[qt])){Ce.preventDefault();const hn=pl[Ce.key],Sn={key:`${Kc}-${(0,Uh.A)()}`,type:`${Kc}-${hn}`,anchor:{key:pt,offset:ht,object:"point"},focus:{key:Ft,offset:zt+1,object:"point"},object:"annotation"};return Fe.insertText(Ce.key).insertText(hn).addAnnotation(Sn).moveBackward(1),!0}break}case")":case"}":case"]":{const ht=it.anchorText.text,pt=it.selection.anchor.offset,zt=ht[pt],Ft=Ce.key,qt=`${Kc}-${Ft}`,sn=it.annotations.find(hn=>hn?.type===qt&&hn.anchor.key===it.anchorText.key);if(sn&&zt===Ft&&!it.selection.isExpanded)return Ce.preventDefault(),Fe.moveFocusForward(1).removeAnnotation(sn).moveAnchorForward(1),!0;break}case"Backspace":{const ht=it.anchorText.text,pt=it.selection.anchor.offset,zt=ht[pt-1],Ft=ht[pt];if(pl[zt]&&pl[zt]===Ft)return Ce.preventDefault(),Fe.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return Je()}}}var Nh=e(16123),Kh=e(54024),Fh=e(52513),wh=e(21266),Vh=e(59490),Kd=e(91272),$h=e(56103),zh=e(93427);const Fd={SecretFormField:er.L,FormField:To.z,Select:Io,AsyncSelect:nl,IndicatorsContainer:Bi,NoOptionsMessage:hi,Input:Li.p,Switch:al};var Gh=e(873),Hh=e(65642),Fc=e(73427),wd=e(83873),Qh=e(67020),Vd=e(58047),_h=e(49344);function kh(Ce,Fe){Fe=Fe||{};const Je=Fe.delimiter||".";let it=Fe.maxDepth||3,ht=1;const pt={};function zt(Ft,qt){Object.entries(Ft).forEach(([sn,hn])=>{const Sn=Fe?.safe&&Array.isArray(hn),Jn=Object.prototype.toString.call(hn)==="[object Object]",$a=qt?qt+Je+sn:sn;if(Fe?.maxDepth||(it=ht+1),!Sn&&Jn&&Object.keys(hn).length&&ht<it)return++ht,zt(hn,$a);pt[$a]=hn})}return zt(Ce,null),pt}var Yh=e(77197);function Jh(Ce,Fe,Je){const it=Math.sqrt(50),ht=Math.sqrt(10),pt=Math.sqrt(2),zt=Math.abs(Fe-Ce)/Math.max(0,Je);let Ft=Math.pow(10,Math.floor(Math.log(zt)/Math.LN10));const qt=zt/Ft;return qt>=it?Ft*=10:qt>=ht?Ft*=5:qt>=pt&&(Ft*=2),Fe<Ce?-Ft:Ft}function Zh(Ce,Fe){return Ce-Math.floor(Math.log(Fe)/Math.LN10)}function Xh(Ce,Fe,Je){if(Fe&&Je&&Ce){const it=Je-Fe,ht=it/Ce/1e3,pt=864e5,zt=31536e6;return ht<=45?"HH:mm:ss":ht<=7200||it<=pt?"HH:mm":ht<=8e4?"MM/DD HH:mm":ht<=2419200||it<=zt?"MM/DD":"YYYY-MM"}return"HH:mm"}function qh(Ce,Fe){return Math.log(Ce)/Math.log(Fe)}function $d(Ce){const Fe=Ce.toString();return zd(Fe)}function zd(Ce){if(isNaN(Ce))return 0;const Fe=Ce.indexOf(".");return Fe===-1?0:Ce.length-Fe-1}const Jl=o;Jl.PanelPlugin=_e.m,Jl.DataSourcePlugin=p.tD,Jl.AppPlugin=h.hX,Jl.DataSourceApi=p.mA;const ef=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((Ce,Fe)=>({...Ce,[Fe]:{fakeDep:1}}),{}),tf={"@emotion/css":()=>Promise.resolve().then(e.bind(e,22803)),"@emotion/react":()=>Promise.resolve().then(e.bind(e,17437)),"@grafana/data":n,"@grafana/data/unstable":()=>e.e(2223).then(e.bind(e,2223)),"@grafana/runtime":a,"@grafana/runtime/unstable":()=>e.e(3259).then(e.bind(e,83259)),"@grafana/slate-react":()=>Promise.resolve().then(e.bind(e,29317)),"@grafana/ui":Jl,"@grafana/ui/unstable":()=>Promise.all([e.e(9227),e.e(1492)]).then(e.bind(e,58045)),"@kusto/monaco-kusto":()=>Promise.all([e.e(630),e.e(7396),e.e(4350)]).then(e.bind(e,20582)),"app/core/app_events":{default:Fc.lE,__useDefault:!0},"app/core/config":{default:Hh.Ay,__useDefault:!0},"app/core/core":{appEvents:Fc.lE,contextSrv:Fc.TP},"app/core/services/backend_srv":{BackendSrv:wd.Mf,getBackendSrv:wd.AI},"app/core/table_model":{default:Gh.A,__useDefault:!0},"app/core/time_series":{default:Vd.A,__useDefault:!0},"app/core/time_series2":{default:Vd.A,__useDefault:!0},"app/core/utils/datemath":ks,"app/core/utils/flatten":d,"app/core/utils/kbn":{default:Yh.A,__useDefault:!0},"app/core/utils/ticks":i,"app/features/dashboard/impression_store":{impressions:Qh.A},d3:()=>Promise.all([e.e(407),e.e(5995)]).then(e.bind(e,55995)),emotion:()=>Promise.resolve().then(e.bind(e,22803)),i18next:()=>e.e(5757).then(e.bind(e,55757)).then(Ce=>Ce.getI18nInstance()),jquery:{default:Qe(),__useDefault:!0},...ef,lodash:()=>Promise.resolve().then(e.t.bind(e,2543,23)).then(Ce=>({...Ce,move:_h.b,__useDefault:!0})),moment:()=>Promise.resolve().then(e.t.bind(e,95093,23)).then(Ce=>({...Ce,__useDefault:!0})),prismjs:()=>Promise.resolve().then(e.t.bind(e,28848,23)),react:()=>Promise.resolve().then(e.t.bind(e,96540,19)),"react-dom":()=>Promise.resolve().then(e.t.bind(e,40961,19)),"react-inlinesvg":()=>Promise.resolve().then(e.bind(e,55494)),"react-redux":()=>Promise.resolve().then(e.bind(e,71468)),"react-router-dom":()=>Promise.resolve().then(e.bind(e,61417)),"react-router":()=>Promise.resolve().then(e.bind(e,35557)),redux:()=>Promise.resolve().then(e.bind(e,14644)),rxjs:()=>Promise.all([e.e(4251),e.e(5091)]).then(e.bind(e,75091)),"rxjs/operators":()=>Promise.all([e.e(4251),e.e(2975)]).then(e.bind(e,32975)),slate:()=>Promise.resolve().then(e.bind(e,82611)),"slate-plain-serializer":()=>Promise.resolve().then(e.bind(e,52845)),"slate-react":()=>Promise.resolve().then(e.bind(e,29317))};function Zl({url:Ce,source:Fe,transformSourceMapURL:Je=!1,transformAssets:it=!0}){const ht=Ce.split("/public/plugins/"),pt=ht[0],zt=ht[1].split("/")[0];let Ft=Fe;return it&&(Ft=Ft.replace(/(\/?)(public\/plugins)/g,`${pt}/$2`),Ft=Ft.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${pt}/public/$2$3`)),Je&&(Ft=Ft.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${pt}/public/plugins/${zt}/$2.map`)),Ft}var pc=e(98060);const wc=new Map([]);function gc(Ce){return Object.keys(Ce).reduce((Fe,Je)=>{const it=`${pc.XV}:${Je}`;return nf(it,Ce[Je]),wc.set(Je,Ce[Je]),Fe[Je]=it,Fe},{})}function nf(Ce,Fe){if(Te.has(Ce))return;let Je;try{Je=Te.resolve(Ce)}catch(ht){console.log(ht)}if(Je&&Te.has(Je))return;const it=Je||Ce;typeof Fe=="function"?Te.register(Ce,[],ht=>({execute:async function(){const pt=await Fe();ht(pt)}})):Te.set(it,Fe)}function mc(Ce){return!!y.$.pluginsCDNBaseURL&&Ce.startsWith(y.$.pluginsCDNBaseURL)}function Vc(Ce){return Ce.startsWith("http")||Ce.startsWith("/")?Ce:`${y.$.appSubUrl??""}/${Ce}`}async function af(Ce,Fe,Je){const it=await Ce(Fe,Je),ht=it.headers.get("content-type")||"";if(pc.Bu.test(ht)){let zt=await it.text();if(mc(it.url)){const Ft=Zl({url:it.url,source:zt});return new Response(new Blob([Ft],{type:"text/javascript"}))}return new Response(new Blob([zt],{type:"text/javascript"}))}return it}function Xl(Ce,Fe,Je){try{const it=Ce.apply(this,[Fe,Je]),ht=pf(it);return(ht.endsWith(".js")||ht.endsWith(".css"))&&!mc(ht)?(0,Pe.ni)(ht):ht}catch{if(pc.$b.test(Fe)){const ht=re(Fe),pt=Ce.apply(this,[ht,Je]);return(0,Pe.ni)(pt)}return console.warn(`SystemJS: failed to resolve '${Fe}'`),Fe}}function sf(Ce,Fe){if(new URL(Fe,window.location.origin).pathname.endsWith(".css")&&!Ce){const ht=Te.get(Fe)?.default;ht&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,ht])}}function pf(Ce){return Ce.startsWith(`${pc.XV}:`)?Ce:(Ce.endsWith("!")&&(Ce=Ce.slice(0,-1)),["css","js","json","wasm"].some(it=>Ce.endsWith(it))?Ce:Ce+".js")}function re(Ce){const Fe=Ce.split("/")[1];let Je="";for(const[pt]of Te.entries())if(pt.includes(Fe)){Je=pt;break}const it=Je.lastIndexOf("/plugins");return it===-1?`${y.$.appSubUrl??""}/public/${Ce}`:`${Je.substring(0,it)}/${Ce}`}var ee=e(44436),oe=e(48307);function De(Ce){const Fe=new URL(window.location.href),Je=new URL(Ce);return Fe.host===Je.host}async function je(Ce,Fe){let Je="";if(De(Ce)?(Je=await(await fetch(Ce)).text(),Je=Zl({url:Ce,source:Je,transformSourceMapURL:!0,transformAssets:!1})):mc(Ce)&&(Je=await(await fetch(Ce)).text(),Je=Zl({url:Ce,source:Je,transformSourceMapURL:!0,transformAssets:!0})),Je.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Je=st(Je),Fe.evaluate(Je)}async function $e(Ce){if(mc(Ce.module)){const Fe=Ce.module;let it=await(await fetch(Fe)).text();if(!Ye(it,Ce.moduleHash))throw new Error("Invalid SRI for plugin module file");return it=Zl({url:Fe,source:it,transformSourceMapURL:!0,transformAssets:!0}),it}else{let Fe=Vc(Ce.module);const Je=(0,Pe.ni)(Fe);let ht=await(await fetch(Je)).text();if(!Ye(ht,Ce.moduleHash))throw new Error("Invalid SRI for plugin module file");return ht=Zl({url:Je,source:ht,transformSourceMapURL:!0,transformAssets:!1}),ht=st(ht),ht}}async function Ye(Ce,Fe){if(!y.$.featureToggles.pluginsSriChecks||!Fe||Fe.length===0)return!0;const[Je,it]=Fe.split("-"),ht=Je.replace("sha","SHA-"),zt=new TextEncoder().encode(Ce),Ft=await crypto.subtle.digest(ht,zt),qt=btoa(String.fromCharCode(...new Uint8Array(Ft)));return`${Je}-${qt}`===Fe}function st(Ce){return Ce.replace(/window\.location/gi,"window.locationSandbox")}function rt(Ce){Ce.evaluate(`${bn.toString()};${bn.name}()`)}function yt(Ce){for(const Fe of Object.values(y.$.datasources))if(Fe.type===Ce)return Fe.meta;for(const Fe of Object.values(y.$.panels))if(Fe.id===Ce)return Fe;for(const Fe of Object.values(y.$.apps))if(Fe.id===Ce)return{id:Ce,type:c.QE.app,module:Fe.path,moduleHash:Fe.moduleHash};throw new Error(`Could not find plugin ${Ce}`)}var Ot=e(99418);const Bt=["iframe"];var kt=e(7077),$t=e(28848),Gt=e.n($t);function en(Ce){return!!Ce&&typeof Ce=="object"&&Ce?.hasOwnProperty("plugin")}function xn(Ce){throw new Error(`Unexpected object: ${Ce}. This should never happen.`)}const ma=(0,Qr.DW)("sandbox");function Da(Ce){return Ce instanceof Zt.Component}function xa(Ce,Fe){ma.logWarning(Ce,Fe)}function $n(Ce,Fe){ma.logError(Ce,Fe)}function oa(Ce,Fe){ma.logInfo(Ce,Fe)}function Na(Ce){return Ce?.constructor?.name==="RegExp"}function Is(Ce){return Ce&&(Na(Ce)&&(0,kt.U)(Ce)?new RegExp(Ce):Array.isArray(Ce)?Ce.map(Is):typeof Ce=="object"?Object.keys(Ce).reduce((Fe,Je)=>(Reflect.set(Fe,Je,Is(Reflect.get(Ce,Je))),Fe),{}):Ce)}function Qo(Ce){return Ce&&((0,kt.U)(Ce)?(0,ws.cloneDeep)(Ce):Array.isArray(Ce)?Ce.map(Qo):typeof Ce=="object"?Object.keys(Ce).reduce((Fe,Je)=>(Reflect.set(Fe,Je,Qo(Reflect.get(Ce,Je))),Fe),{}):Ce)}const _o=Symbol.for("@@SANDBOX_LIVE_VALUE");function Ef(Ce,Fe){const Je=Reflect.get(Ce,"nodeName");if(Je==="body"||Ce===document.body)return document.body;if(Je==="head"||Ce===document.head||Ce===document.documentElement)return Ce;if(Bt.includes(Je))throw xa("<"+Je+"> is not allowed in sandboxed plugins",{pluginId:Fe,param:Je}),new Error("<"+Je+"> is not allowed in sandboxed plugins");if(Tf(Ce,Fe)||Ce.parentNode===document.body||Ce.closest("#reactRoot")===null)return Ce;const it=document.createElement(Je);return it.dataset.grafanaPluginSandboxElement="true",it}function Pf(Ce){if(typeof Ce=="object"&&Ce instanceof Element)try{return Ce.nodeName!==void 0}catch{return!1}return!1}function bf(Ce){const Fe=Reflect.get(Ce,"style");Object.hasOwn(Fe,_o)||Reflect.defineProperty(Fe,_o,{})}function rf(Ce){Ce&&(Array.isArray(Ce)?(Ce.forEach(rf),gf(Ce)):typeof Ce=="object"&&(Object.values(Ce).forEach(rf),gf(Ce)))}function gf(Ce){if(Ce)return Object.hasOwn(Ce,_o)||Reflect.defineProperty(Ce,_o,{}),Ce}function Df(Ce){Ce&&(Object.hasOwn(Ce,_o)||((0,kt.U)(Ce)&&!(Ce instanceof Function)&&(Da(Ce)||Ce instanceof p.mA||Ce instanceof zr.f5)?Reflect.defineProperty(Ce,_o,{}):Ce===Gt().languages&&Object.defineProperty(Ce,_o,{})))}function Cf(Ce){return Object.hasOwn(Ce,_o)}function Tf(Ce,Fe){return!document.contains(Ce)||Ce.closest(`[data-plugin-sandbox=${Fe}]`)!==null}let ii;function ap(){return ii||(ii=document.createElement("div"),ii.setAttribute("id","grafana-plugin-sandbox-body"),ii.setAttribute("data-plugin-sandbox","true"),ii.dataset.pluginSandbox="sandboxed-plugin",ii.style.width="100%",ii.style.height="0%",ii.style.overflow="hidden",ii.style.top="0",ii.style.left="0",document.body.appendChild(ii)),ii}let mf=!1;function Mf(){mf||(mf=!0,Of(),Sf())}function Sf(){const Ce=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...Fe){return Ce.apply(this,Qo(Fe))}})}function Of(){const Ce=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...Fe){let Je=Fe;try{Je=(0,ws.cloneDeep)(Fe)}catch(it){xa("Error cloning args in window.history.replaceState",{error:String(it)})}return Reflect.apply(Ce,this,Je)},writable:!0,configurable:!0,enumerable:!1})}const Eo=new Map,vf=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function If(){return Eo.size===0&&(Rf(Eo),Af(Eo),jf(Eo),Wf(Eo),Uf(Eo),Lf(Eo),Bf(Eo),Nf(Eo),Kf(Eo),yf(Eo),Ff(Eo),Vf(Eo)),Eo}function Gd(Ce,Fe){return xa(`Plugin ${Fe.id} tried to set a sandboxed property`,{pluginId:Fe.id,attrOrMethod:String(Ce),entity:"window"}),()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Rf(Ce){const Fe=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const it of Fe){const ht=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,it);if(ht){let pt=function(zt,Ft){const qt=Ft.id;return xa(`Plugin ${qt} tried to access iframe.${it}`,{pluginId:qt,attrOrMethod:it,entity:"iframe"}),()=>{throw new Error("iframe."+it+" is not allowed in sandboxed plugins")}};var Je=pt;ht.value&&Ce.set(ht.value,pt),ht.set&&Ce.set(ht.set,pt),ht.get&&Ce.set(ht.get,pt)}}}function Af(Ce){const Fe=Object.getOwnPropertyDescriptor(window,"console");if(Fe?.value){let it=function(ht,pt){const zt=pt.id;function Ft(...qt){console.log(`[plugin ${zt}]`,...qt)}return{log:Ft,warn:Ft,error:Ft,info:Ft,debug:Ft,table:Ft}};var Je=it;Ce.set(Fe.value,it)}Fe?.set&&Ce.set(Fe.set,Gd)}function jf(Ce){function Fe(it,ht){const pt=ht.id;return xa(`Plugin ${pt} accessed window.alert`,{pluginId:pt,attrOrMethod:"alert",entity:"window"}),function(...zt){console.log(`[plugin ${pt}]`,...zt)}}const Je=Object.getOwnPropertyDescriptor(window,"alert");Je?.value&&Ce.set(Je.value,Fe),Je?.set&&Ce.set(Je.set,Gd)}function Lf(Ce){function Fe(it,ht){const pt=ht.id;return function(...Ft){for(let qt=0;qt<Ft.length;qt++){const sn=Ft[qt],hn=String(sn||"").toLowerCase();for(const Sn of Bt)if(hn.includes("<"+Sn))throw xa(`Plugin ${pt} tried to set ${Sn} in innerHTML`,{pluginId:pt,attrOrMethod:"innerHTML",param:Sn,entity:"HTMLElement"}),new Error("<"+Sn+"> is not allowed in sandboxed plugins");hn.match(/onerror|onload|onsuccess|onbeforeunload/)&&(xa(`Plugin ${pt} tried to set forbidden attribute in innerHTML`,{pluginId:pt,attrOrMethod:"innerHTML",param:sn,entity:"HTMLElement"}),Ft[qt]=Ot.A.sanitize(Ft[qt]))}if((0,ws.isFunction)(it))return it.apply(this,Ft)}}const Je=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const it of Je)it?.set&&Ce.set(it.set,Fe),it?.value&&Ce.set(it.value,Fe)}function Bf(Ce){function Fe(it,ht){const pt=ht.id;return function(Ft,qt){if(Ft&&Bt.includes(Ft))return xa(`Plugin ${pt} tried to create ${Ft}`,{pluginId:pt,attrOrMethod:"createElement",param:Ft,entity:"document"}),document.createDocumentFragment();if((0,ws.isFunction)(it))return it.apply(this,[Ft,qt])}}const Je=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Je?.value&&Ce.set(Je.value,Fe)}function Uf(Ce){function Fe(pt,zt){const Ft=zt.id;return function(sn,hn){const Sn=sn?.nodeName?.toLowerCase()||"";if(sn&&Bt.includes(Sn))return xa(`Plugin ${Ft} tried to insert ${Sn}`,{pluginId:Ft,attrOrMethod:"insertChild",param:Sn,entity:"HTMLElement"}),document.createDocumentFragment();if((0,ws.isFunction)(pt))return pt.call(this,sn,hn)}}function Je(pt,zt){const Ft=zt.id;return function(sn,hn){const Sn=hn?.nodeName?.toLowerCase()||"";if(hn&&Bt.includes(Sn))return xa(`Plugin ${Ft} tried to insert ${Sn}`,{pluginId:Ft,attrOrMethod:"insertAdjacentElement",param:Sn,entity:"HTMLElement"}),document.createDocumentFragment();if((0,ws.isFunction)(pt))return pt.call(this,sn,hn)}}const it=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const pt of it)pt?.value&&Ce.set(pt.set,Fe);const ht=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");ht?.value&&Ce.set(ht.set,Je)}function Wf(Ce){function Fe(pt,zt){const Ft=zt.id;return function(...sn){let hn=sn;const Sn=sn?.filter(Mn=>!Bt.includes(Mn.nodeName.toLowerCase()));hn=Sn,hn.length!==Sn.length&&xa(`Plugin ${Ft} tried to append fobiddenElements`,{pluginId:Ft,attrOrMethod:"append",param:sn?.filter(Mn=>Bt.includes(Mn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,ws.isFunction)(pt)&&pt.apply(this,hn)}}function Je(pt,zt,Ft){const qt=zt.id;return function(hn){const Sn=hn?.nodeName?.toLowerCase()||"";if(hn&&Bt.includes(Sn))return xa(`Plugin ${qt} tried to append ${Sn}`,{pluginId:qt,attrOrMethod:"appendChild",param:Sn,entity:"HTMLElement"}),document.createDocumentFragment();if(Ft&&hn&&Sn==="script"&&hn instanceof HTMLScriptElement){je(hn.src,Ft).then(()=>{hn.onload?.call(hn,new Event("load"))}).catch(Mn=>{hn.onerror?.call(hn,new ErrorEvent("error",{error:Mn}))});return}if((0,ws.isFunction)(pt))return pt.call(this,hn)}}const it=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const pt of it)pt?.value&&Ce.set(pt.value,Fe);const ht=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");ht?.value&&Ce.set(ht.value,Je)}function Nf(Ce){const Fe=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Je(it){return function(...pt){try{const zt=(0,ws.cloneDeep)(pt);(0,ws.isFunction)(it)&&it.apply(this,zt)}catch{throw new Error("postMessage arguments are invalid objects")}}}Fe?.value&&Ce.set(Fe.value,Je)}function Kf(Ce){const Fe=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");Fe?.get&&Ce.set(Fe.get,()=>()=>window);const Je=["write"];for(const it of Je){const ht=Object.getOwnPropertyDescriptor(Document.prototype,it);ht?.set&&Ce.set(ht.set,Gd),ht?.value&&Ce.set(ht.value,Gd)}}async function yf(Ce){const Fe=Reflect.get(window,"monaco");if(!Fe||Object.hasOwn(Fe,vf))return;const Je=Fe.languages.setMonarchTokensProvider;function it(){return function(...ht){return ht.length!==2?Je.apply(Fe,ht):Je.call(Fe,ht[0],Is(ht[1]))}}Ce.set(Fe.languages.setMonarchTokensProvider,it),Reflect.set(Fe,vf,{})}async function Ff(Ce){const Fe=Object.getOwnPropertyDescriptor(window,"postMessage");function Je(it){return function(...pt){try{const zt=(0,ws.cloneDeep)(pt);(0,ws.isFunction)(it)&&it.apply(this,zt)}catch{throw new Error("postMessage arguments are invalid objects")}}}Fe?.value&&Ce.set(Fe.value,Je)}function wf(Ce){yf(Eo)}function Vf(Ce){function Fe(Je){return(0,ws.isFunction)(Je)?function(...it){const ht=Je.apply(this,it);return rf(ht),ht}:Je}Ce.set(ws.cloneDeep,Fe)}async function $f(Ce,Fe){if(!en(Ce))return Ce;const Je=await Promise.resolve(Ce.plugin);if(Reflect.has(Je,"panel")&&Reflect.set(Je,"panel",vc(Reflect.get(Je,"panel"),Fe)),Reflect.has(Je,"components")){const it=Reflect.get(Je,"components");Object.entries(it).forEach(([ht,pt])=>{Reflect.set(it,ht,vc(pt,Fe))}),Reflect.set(Je,"components",it)}if(Reflect.has(Je,"root")&&Reflect.set(Je,"root",vc(Reflect.get(Je,"root"),Fe)),Reflect.has(Je,"addedComponentConfigs")){const it=Reflect.get(Je,"addedComponentConfigs");for(const ht of it)Reflect.has(ht,"component")&&Reflect.set(ht,"component",vc(Reflect.get(ht,"component"),Fe));Reflect.set(Je,"addedComponentConfigs",it)}if(Reflect.has(Je,"exposedComponentConfigs")){const it=Reflect.get(Je,"exposedComponentConfigs");for(const ht of it)Reflect.has(ht,"component")&&Reflect.set(ht,"component",vc(Reflect.get(ht,"component"),Fe));Reflect.set(Je,"exposedComponentConfigs",it)}if(Reflect.has(Je,"configPages")){const it=Reflect.get(Je,"configPages")??[];for(const[ht,pt]of Object.entries(it))!pt.body||!(0,ws.isFunction)(pt.body)||Reflect.set(it,ht,{...pt,body:vc(pt.body,Fe)});Reflect.set(Je,"configPages",it)}return Ce}const vc=(Ce,Fe)=>{const Je=Zt.memo(it=>(0,Dt.jsx)("div",{"data-plugin-sandbox":Fe.id,style:{height:Fe.type===c.QE.app||Fe.type===c.QE.panel?"100%":"auto"},children:(0,Dt.jsx)(Ce,{...it})}));return Je.displayName=`GrafanaSandbox(${Ce.displayName||Ce.name||"Component"})`,Je},lf=new Map,xf={};async function zf({pluginId:Ce}){Mf();try{const Fe=yt(Ce);return lf.has(Ce)||lf.set(Ce,Gf(Fe)),lf.get(Ce)}catch(Fe){const Je=new Error(`Could not import plugin ${Ce} inside sandbox: `+Fe);throw $n(Je,{pluginId:Ce,error:String(Fe)}),Je}}async function Gf(Ce){return oa("Loading with sandbox",{pluginId:Ce.id}),new Promise(async(Fe,Je)=>{const it=If();let ht;function pt(Ft){if(Pf(Ft)){const hn=Ef(Ft,Ce.id);return bf(hn),hn}else Df(Ft);const qt=it.get(Ft);if(qt)return qt(Ft,Ce,ht);const sn=wf(Ft);return sn||Ft}ht=(0,ee.A)(window,{distortionCallback:pt,defaultPolicy:oe.G,liveTargetCallback:Cf,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Ft,...qt){return setTimeout(Ft,0,...qt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(xf[Ce.id+"-grafanaBootData"]||(xf[Ce.id+"-grafanaBootData"]=!0,oa("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:Ce.id,guessedPluginName:Ce.id,parent:"window",packageName:"window",key:"grafanaBootData"})),y.$.buildInfo.env==="development")throw new Error(`Error in ${Ce.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${Ce.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),y.$.bootData},async define(Ft,qt,sn){let hn,Sn;Array.isArray(Ft)?(hn=Ft,Sn=qt):(hn=qt,Sn=sn);try{const Mn=await Hf(hn,Ce),Jn=Sn.apply(null,Mn),$a=await $f(Jn,Ce);Fe($a)}catch(Mn){const Jn=new Error(`Could not execute plugin's define ${Ce.id}: `+Mn);$n(Jn,{pluginId:Ce.id,error:String(Mn)}),Je(Jn)}}})}),rt(ht);let zt="";try{zt=await $e(Ce)}catch(Ft){const qt=new Error(`Could not load plugin code ${Ce.id}: `+Ft);$n(qt,{pluginId:Ce.id,error:String(Ft)}),Je(qt)}try{ht.evaluate(zt)}catch(Ft){const qt=new Error(`Could not run plugin ${Ce.id} inside sandbox: `+Ft);$n(qt,{pluginId:Ce.id,error:String(Ft)}),Je(qt)}})}async function Hf(Ce,Fe){const Je={},it={id:Fe.id,uri:Fe.module,exports:Je},ht=[];for(const pt of Ce){let zt=wc.get(pt);if(typeof zt=="function"&&(zt=await zt()),zt?.__useDefault&&(zt=zt.default),pt==="module"&&(zt=it),pt==="exports"&&(zt=Je),!zt){const Ft=new Error(`[sandbox] Could not resolve dependency ${pt}`);throw $n(Ft,{pluginId:Fe.id,dependency:pt,error:String(Ft)}),Ft}ht.push(zt)}return ht}var Qf=e(33109),_f=e(37640);const kf=gc(tf);Te.addImportMap({imports:kf});const gl=Te.constructor.prototype;gl.shouldFetch=function(Ce){const Fe=(0,Pe.QO)(Ce);return/^[^#?]+\.(js)([?#].*)?$/.test(Ce)?Fe?.loadingStrategy!==c.xf.script:!0};const Yf=gl.import;gl.import=function(...Ce){return Yf.apply(this,Ce).then(Fe=>Fe&&Fe.__useDefault?Fe.default:Fe)};const Jf=gl.fetch;gl.fetch=function(Ce,Fe){return af(Jf,Ce,Fe)};const Zf=gl.resolve;gl.resolve=Xl.bind(gl,Zf),gl.onload=sf;async function cf({path:Ce,pluginId:Fe,loadingStrategy:Je,version:it,moduleHash:ht,translations:pt}){it&&(0,Pe.GD)({path:Ce,version:it,loadingStrategy:Je}),y.$.featureToggles.localizationForPlugins&&pt&&await tp({resolvedLanguage:(0,g.Ph)(),fallbackLanguage:r.Nm,pluginId:Fe,translations:pt});const zt=me[Ce];if(zt)return typeof zt=="function"?await zt():zt;const Ft=Vc(Ce);if(y.$.featureToggles.pluginsSriChecks){const qt=System.resolve(Ft),sn=System.getImportMap().integrity;ht&&sn&&!sn[qt]&&Te.addImportMap({integrity:{[qt]:ht}})}return await(0,Qf.JW)({pluginId:Fe})?zf({pluginId:Fe}):Te.import(Ft).catch(qt=>{let sn=new Error("Could not load plugin: "+qt);throw console.error(sn),_f.z4.logError(sn,{path:Ce,pluginId:Fe,pluginVersion:it??"",expectedHash:ht??"",loadingStrategy:Je.toString(),sriChecksEnabled:(y.$.featureToggles.pluginsSriChecks??!1).toString()}),sn})}function Xf(Ce){(0,m.M)(Ce);const Fe=Ce.loadingStrategy??c.xf.fetch;return cf({path:Ce.module,version:Ce.info?.version,loadingStrategy:Fe,pluginId:Ce.id,moduleHash:Ce.moduleHash,translations:Ce.translations}).then(Je=>{if(Je.plugin){const it=Je.plugin;return it.meta=Ce,it}if(Je.Datasource){const it=new p.tD(Je.Datasource);return it.setComponentsFromLegacyExports(Je),it.meta=Ce,it}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}const df={};async function qf(Ce){const Fe=Ce.id;return df[Fe]===void 0&&(df[Fe]=ep(Ce)),df[Fe]}async function ep(Ce){(0,m.M)(Ce);const Fe=await cf({path:Ce.module,version:Ce.info?.version,pluginId:Ce.id,loadingStrategy:Ce.loadingStrategy??c.xf.fetch,moduleHash:Ce.moduleHash,translations:Ce.translations}),{plugin:Je=new h.hX}=Fe;return Je.init(Ce),Je.meta=Ce,Je.setComponentsFromLegacyExports(Fe),ce.eY.register({pluginId:Ce.id,configs:Je.exposedComponentConfigs||[]}),ce.a9.register({pluginId:Ce.id,configs:Je.addedComponentConfigs||[]}),ce.lQ.register({pluginId:Ce.id,configs:Je.addedLinkConfigs||[]}),ce.rH.register({pluginId:Ce.id,configs:Je.addedFunctionConfigs||[]}),Je}async function tp({resolvedLanguage:Ce,fallbackLanguage:Fe,pluginId:Je,translations:it}){const ht=it[Ce],pt=it[Fe],zt=ht??pt;if(!zt){console.warn(`Could not find any translation for plugin ${Je}`,{resolvedLanguage:Ce,fallbackLanguage:Fe});return}try{const Ft=await Te.import(Vc(zt));if(!Ft.default){console.warn(`Could not find default export for plugin ${Je}`,{resolvedLanguage:Ce,fallbackLanguage:Fe,path:zt});return}const qt=ht?Ce:Fe;(0,g.eI)(qt,Je,Ft.default)}catch(Ft){console.warn(`Could not load translation for plugin ${Je}`,{resolvedLanguage:Ce,fallbackLanguage:Fe,error:Ft,path:zt})}}},95027:(Z,R,e)=>{"use strict";e.d(R,{o:()=>l,x:()=>s});var n=e(68143);const a={};function s(o,d){const i=a[o];return i?Promise.resolve(i):(0,n.AI)().get(`/api/plugins/${o}/settings`,void 0,void 0,{...d,validatePath:!0}).then(c=>(a[o]=c,c)).catch(c=>typeof c=="object"&&c!==null&&"status"in c&&c.status===403?(c.isHandled=!0,Promise.reject(c)):Promise.reject(new Error("Unknown Plugin")))}const l=o=>o?delete a[o]:Object.keys(a).forEach(d=>delete a[d])},37168:(Z,R,e)=>{"use strict";e.d(R,{X:()=>G,v:()=>H});var n=e(74848),a=e(84057),s=e(65307),l=e(96540),o=e(54148),d=e(20877),i=e(90382),c=e(32899),m=e(11594),p=e(92745),h=e(43173),r=e(36490),g=e(56297),y=e(34999),v=e(13791),x=e(11098),f=e(1506),u=e(27963),b=e(73427);function E(_){return console.error(_),C("Exception thrown","See console for details")}function D(){return C("Page not found","404 Error")}function C(_,k){const J={text:_,subTitle:k,icon:"exclamation-triangle"};return{node:J,main:J}}var P=e(47797),T=e(28337),O=e(58666),I=e(95027),j=e(37640),W=e(22465),B=e(70715);const S={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function w({pluginId:_,pluginNavSection:k}){const{pluginId:J=""}=(0,o.g)();_=_||J;const z=(0,T.OG)(),Y=(0,T.TX)(),X=(0,T.ZV)(),Q=(0,T.ov)(),q=(0,o.zy)(),[te,ne]=(0,l.useReducer)(N.reducer,S),se=h.$.appSubUrl+q.pathname+q.search,{plugin:ue,loading:de,loadingError:ie,pluginNav:he}=te,me=(0,j.Wy)(se,k),ce=(0,l.useMemo)(()=>(0,r.SE)(q.search),[q.search]),Pe=(0,l.useMemo)(()=>(0,B.S)(me),[me]),Ie=(0,u.Il)();(0,l.useEffect)(()=>{M(_,ne)},[_]);const Se=(0,l.useCallback)(Qe=>ne(N.actions.changeNav(Qe)),[]);if(!ue||_!==ue.meta.id){const Qe=Ie.chrome.state.getValue().layout;return(0,n.jsxs)(v.Y,{navModel:me,pageNav:{text:""},layout:Qe,children:[de&&(0,n.jsx)(x.A,{}),!de&&ie&&(0,n.jsx)(f.L,{entity:"App"})]})}if(!ue.root)return(0,n.jsx)(v.Y,{navModel:me??C("Plugin load error"),children:(0,n.jsx)("div",{children:(0,n.jsx)(p.x6,{i18nKey:"plugins.app-root-page.no-root-app-page-component-found",children:"No root app page component found"})})});const Me=ue.root&&(0,n.jsx)(d.a,{meta:ue.meta,children:(0,n.jsx)(W.K,{fallback:({error:Qe,errorInfo:tt})=>(0,n.jsx)(g.D,{title:(0,p.t)("plugins.app-root-page.error-loading-plugin","Plugin failed to load"),error:Qe,errorInfo:tt}),children:(0,n.jsx)(T.AZ,{registries:{addedLinksRegistry:z.readOnly(),addedComponentsRegistry:Y.readOnly(),exposedComponentsRegistry:X.readOnly(),addedFunctionsRegistry:Q.readOnly()},children:(0,n.jsx)(ue.root,{meta:ue.meta,basename:q.pathname,onNavChanged:Se,query:ce,path:q.pathname})})})}),Te=()=>{if(!ue.meta?.includes)return!0;const Qe=ue.meta?.includes.find(ke=>ke.path===q.pathname);if(!Qe)return!0;if(Qe?.action)return b.TP.hasPermission(Qe.action);if(b.TP.isGrafanaAdmin||b.TP.user.orgRole===i.X.Admin)return!0;const tt=Qe?.role||"";return!tt||b.TP.isEditor&&tt===i.X.Viewer?!0:b.TP.hasRole(tt)},Ge=()=>(0,n.jsx)(y.F,{severity:"warning",title:(0,p.t)("plugins.app-root-page.access-denied.title-access-denied","Access denied"),children:(0,n.jsx)(p.x6,{i18nKey:"plugins.app-root-page.access-denied.permission",children:"You do not have permission to see this page."})});return Te()?he?(0,n.jsx)(n.Fragment,{children:me?(0,n.jsx)(v.Y,{navModel:me,pageNav:he?.node,children:(0,n.jsx)(v.Y.Contents,{isLoading:de,children:Me})}):(0,n.jsx)(v.Y,{children:Me})}):(0,n.jsx)(B.A.Provider,{value:Pe,children:Me}):(0,n.jsx)(Ge,{})}const N=(0,s.Z0)({name:"prom-builder-container",initialState:S,reducers:{setState:(_,k)=>{Object.assign(_,k.payload)},changeNav:(_,k)=>{let J=k.payload;J&&J.node.children&&(J={...J,node:{...J.main,hideFromBreadcrumbs:!0}}),_.pluginNav=J}}});async function M(_,k){try{const J=await(0,I.x)(_).then(z=>{const Y=L(z);return Y?(b.lE.emit(c.r1.alertError,[Y]),k(N.actions.setState({pluginNav:C(Y)})),null):(0,O.ui)(z)});k(N.actions.setState({plugin:J,loading:!1,loadingError:!1,pluginNav:null}))}catch(J){k(N.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:D()}));const z=J instanceof Error?J:new Error((0,P.q6)(J));j.z4.logError(z),console.error(z)}}function L(_){return _?_.type!==m.QE.app?"Plugin must be an app":_.enabled?null:"Application Not Enabled":"Unknown Plugin"}const A=w;var U=e(8535);const F=_=>"pluginId"in _&&"id"in _,V=_=>_.startsWith("standalone-plugin-page-/");function K(_){const k=(0,a.rH)(_),J=`/a/${_.pluginId}`,z=V(_.id)&&_.url||J,Y=V(_.id)&&!_.url?.startsWith("/a/");return{path:`${z}/*`,sensitive:Y,component:()=>(0,n.jsx)(A,{pluginId:_.pluginId,pluginNavSection:k})}}function G(){const _=(0,U.Gu)(),{navIndex:k}=_;return[...Object.values(k).filter(F).map(K),{path:"/a/:pluginId/*",component:()=>(0,n.jsx)(A,{pluginNavSection:k.home})}]}function H(_){const k=(0,U.Gu)(),{navIndex:J}=k,z=Object.values(J).filter(F).find(Y=>Y.pluginId===_);return z?K(z):{path:"/a/:pluginId/*",component:()=>(0,n.jsx)(A,{pluginNavSection:J.home})}}},33109:(Z,R,e)=>{"use strict";e.d(R,{Cz:()=>h,JW:()=>c,SQ:()=>m,vV:()=>i});var n=e(11594),a=e(43173),s=e(73427),l=e(59253),o=e(95027);let d=h;function i(r){d=r}async function c({pluginId:r}){return await m({pluginId:r})?d({pluginId:r}):!1}async function m({pluginId:r}){return!a.$.featureToggles.pluginsFrontendSandbox||window.location.search.includes("nosandbox")&&a.$.buildInfo.env==="development"||!s.TP.isSignedIn?!1:p({pluginId:r})}async function p({pluginId:r}){try{const g=await(0,o.x)(r,{showErrorAlert:!1});return g.signatureType!==n.kv.grafana&&g.signature!=="internal"}catch{try{const y=await(0,l.CB)(r);return y.signatureType!==n.kv.grafana&&y.signature!=="internal"}catch{return!1}}}async function h({pluginId:r}){return!!a.$.enableFrontendSandboxForPlugins?.includes(r)}},37640:(Z,R,e)=>{"use strict";e.d(R,{W3:()=>d,Wy:()=>i,z4:()=>c});var n=e(11594),a=e(25992),s=e(92391),l=e(58666),o=e(95027);async function d(m){const p=await(0,o.x)(m);let h;if(p.type===n.QE.app&&(h=await(0,l.ui)(p)),p.type===n.QE.datasource&&(h=await(0,l.cS)(p)),p.type===n.QE.panel&&(h=await(0,s.Kk)(p)),p.type===n.QE.renderer&&(h={meta:p}),!h)throw new Error("Unknown Plugin type: "+p.type);return h}function i(m,p){if(!p)return;const h=10;let r={...p},g;function y(x,f){return!f.startsWith(x.url??"")||g&&(g.url?.length??0)>(x.url?.length??0)?x:(g&&(g.active=!1),g={...x,active:!0},g)}function v(x,f=0){if(f>h)return x;if(x.children){const u=x.children.map(b=>v(b,f+1));return{...y(x,m),children:u}}return y(x,m)}return r.children=(r?.children??[]).map(v),{main:r,node:g??r}}const c=(0,a.DW)("features.plugins")},1492:(Z,R,e)=>{"use strict";e.d(R,{Pj:()=>c,o:()=>m,Aj:()=>h});var n=e(75816),a=e(73892);const l=(0,n.xP)({reducerPath:"userPreferencesAPI",baseQuery:(0,a.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:r=>({getUserPreferences:r.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:r.mutation({query:g=>({url:"/user/preferences",method:"PATCH",body:g.patchPrefsCmd})}),updateUserPreferences:r.mutation({query:g=>({url:"/user/preferences",method:"PUT",body:g.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:o,usePatchUserPreferencesMutation:d,useUpdateUserPreferencesMutation:i}=l,{useGetUserPreferencesQuery:c,usePatchUserPreferencesMutation:m,useUpdateUserPreferencesMutation:p}=l,h=l.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},69289:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>j,Cj:()=>r,HO:()=>b,Mj:()=>v,Nm:()=>y,Q9:()=>u,RS:()=>C,c1:()=>h,g$:()=>E,ny:()=>x,ri:()=>f,uh:()=>D,xu:()=>g});var n=e(65307),a=e(2543),s=e.n(a),l=e(80011),o=e(25229),d=e(5857),i=e(65642),c=e(73427);const m={orgId:i.Ay.bootData.user.orgId,timeZone:i.Ay.bootData.user.timezone,weekStart:i.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},p=(0,n.Z0)({name:"user/profile",initialState:m,reducers:{updateTimeZone:(W,B)=>{W.timeZone=B.payload.timeZone},updateWeekStart:(W,B)=>{W.weekStart=B.payload.weekStart},updateFiscalYearStartMonth:(W,B)=>{W.fiscalYearStartMonth=B.payload.fiscalYearStartMonth},setUpdating:(W,B)=>{W.isUpdating=B.payload.updating},userLoaded:(W,B)=>{W.user=B.payload.user},initLoadTeams:(W,B)=>{W.teamsAreLoading=!0},teamsLoaded:(W,B)=>{W.teams=B.payload.teams,W.teamsAreLoading=!1},initLoadOrgs:(W,B)=>{W.orgsAreLoading=!0},orgsLoaded:(W,B)=>{W.orgs=B.payload.orgs,W.orgsAreLoading=!1},initLoadSessions:(W,B)=>{W.sessionsAreLoading=!0},sessionsLoaded:(W,B)=>{const S=B.payload.sessions.sort((w,N)=>Number(N.isActive)-Number(w.isActive));W.sessions=S.map(w=>({id:w.id,isActive:w.isActive,seenAt:(0,l.fq)(w.seenAt),createdAt:w.createdAt,clientIp:w.clientIp,browser:w.browser,browserVersion:w.browserVersion,authModule:w.authModule,os:w.os,osVersion:w.osVersion,device:w.device})),W.sessionsAreLoading=!1},userSessionRevoked:(W,B)=>{W.sessions=W.sessions.filter(S=>S.id!==B.payload.tokenId),W.isUpdating=!1}}}),h=W=>async B=>{(0,a.set)(c.TP,"user.fiscalYearStartMonth",W),B(O({fiscalYearStartMonth:W}))},r=W=>async B=>{(!(0,a.isString)(W)||(0,a.isEmpty)(W))&&(W=i.Ay?.bootData?.user?.timezone),(0,a.set)(c.TP,"user.timezone",W),B(P({timeZone:W}))},g=W=>async B=>{W||(W=(0,d.rL)()),(0,a.set)(c.TP,"user.weekStart",W),B(T({weekStart:W})),(0,o.$D)(W)},{setUpdating:y,initLoadOrgs:v,orgsLoaded:x,initLoadTeams:f,teamsLoaded:u,userLoaded:b,userSessionRevoked:E,initLoadSessions:D,sessionsLoaded:C,updateTimeZone:P,updateWeekStart:T,updateFiscalYearStartMonth:O}=p.actions,I=p.reducer,j={user:p.reducer}},34984:(Z,R,e)=>{"use strict";e.d(R,{O:()=>n,q:()=>a});const n=s=>s.timeZone,a=s=>s.fiscalYearStartMonth},53247:(Z,R,e)=>{"use strict";e.d(R,{ED:()=>l,Hv:()=>s,NY:()=>d,hF:()=>o});var n=e(43173);const a=["provisioning","kubernetesDashboards","kubernetesClientDashboardsFolders"],s=()=>{const i=n.$.featureToggles||{};return a.every(c=>i[c])},l=()=>!!(n.$.appUrl&&n.$.appUrl.indexOf("://localhost")<0),o=()=>!!n.$.rendererAvailable,d=()=>{const i=s(),c=l(),m=o();return{hasRequiredFeatures:i,hasPublicAccess:c,hasImageRenderer:m,missingOnlyOptionalFeatures:i&&(!c||!m),missingRequiredFeatures:!i,everythingConfigured:i&&c&&m}}},91555:(Z,R,e)=>{"use strict";e.d(R,{mL:()=>n,pd:()=>a,zM:()=>s});const n="/admin/provisioning",a=`${n}/connect`,s=`${n}/getting-started`},55266:(Z,R,e)=>{"use strict";e.d(R,{T:()=>o});var n=e(10378),a=e(87161),s=e(33680),l=e(75735);const o=({name:d,folderName:i})=>{const{data:c,isLoading:m}=(0,s.F9)(),p=!i,{data:h,isLoading:r}=(0,a.k)(p?n.hT:{name:i});if(m||r)return{isLoading:!0,isInstanceManaged:!1};const g=c?.items??[];if(!g.length)return{folder:h,isInstanceManaged:!1};const y=g.find(x=>x.target==="instance"),v=!!y;if(d){const x=g.find(f=>f.name===d);if(x)return{repository:x,folder:h,isInstanceManaged:v}}if(i){let x=g.find(u=>u.name===i);if(x)return{repository:x,folder:h,isInstanceManaged:v};const f=h?.metadata?.annotations?.[l.Jw];if(f&&(x=g.find(u=>u.name===f),x))return{repository:x,folder:h,isInstanceManaged:v}}return{repository:y,folder:h,isInstanceManaged:v}}},27321:(Z,R,e)=>{"use strict";e.d(R,{F:()=>l});var n=e(10378),a=e(43173),s=e(33680);function l(o){const d=(0,s.F9)(o||!a.$.featureToggles.provisioning?n.hT:void 0);return o||(o=d.data),o?.items?.some(i=>i.target==="instance")}},92784:(Z,R,e)=>{"use strict";e.d(R,{a:()=>a,e:()=>n});function n(s){return s&&/^(?!\/|.*\/\/|.*\.\.|.*@{)(?!.*[~^:?*[\]\\]).+(?<!\/|\.|\s)$/.test(s)}const a=s=>{if(s?.url)return s.branch?`${s.url}/tree/${s.branch}`:s.url}},23117:(Z,R,e)=>{"use strict";e.d(R,{d:()=>s,m:()=>a});class n{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(o){this.extraRenderActions=this.extraRenderActions.concat(o)}addKeyedExtraRenderAction(o,d){this.keyedScopedExtraRenderActions.set(o,d)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(o){return Array.from(this.keyedScopedExtraRenderActions,i=>i[1]).filter(i=>i.scope===o).map(i=>i.queryActionComponent)}}const a=new n,s=new n},67042:(Z,R,e)=>{"use strict";e.d(R,{c:()=>F,E:()=>V});var n=e(74848),a=e(46942),s=e.n(a),l=e(2543),o=e(55127),d=e.n(o),i=e(96540),c=e(1906),m=e(62392),p=e(48480),h=e(28105),r=e(54092),g=e(51898),y=e(92745),v=e(78282),x=e(27489),f=e(33604),u=e(22099),b=e(5585),E=e(99887),D=e(36303),C=e(68805),P=e(43260),T=e(85348),O=e(98838),I=e(23117),j=e(22803),W=e(63142),B=e(30703),S=e(63527),w=e(12594),N=e(76792);const M=_=>{const{query:k,queries:J,onChange:z,collapsedText:Y,renderExtras:X,hidden:Q,hideRefId:q=!1}=_,te=(0,W.of)(A),[ne,se]=(0,i.useState)(!1),[ue,de]=(0,i.useState)(null),ie=Se=>{se(!0)},he=Se=>{if(se(!1),ue){de(null);return}k.refId!==Se&&z({...k,refId:Se})},me=Se=>{const Me=Se.currentTarget.value.trim();if(Me.length===0){de("An empty query name is not allowed");return}for(const Te of J)if(Te!==k&&Me===Te.refId){de("Query name already exists");return}ue&&de(null)},ce=Se=>{he(Se.currentTarget.value.trim())},Pe=Se=>{Se.key==="Enter"&&he(Se.currentTarget.value)},Ie=Se=>{Se.target.select()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:te.wrapper,children:[!q&&!ne&&(0,n.jsxs)("button",{className:te.queryNameWrapper,"aria-label":g.Tp.components.QueryEditorRow.title(k.refId),title:(0,y.t)("query.query-editor-row-header.query-name-div-title-edit-query-name","Edit query name"),onClick:ie,"data-testid":"query-name-div",type:"button",children:[(0,n.jsx)("span",{className:te.queryName,children:k.refId}),(0,n.jsx)(B.I,{name:"pen",className:te.queryEditIcon,size:"sm"})]}),!q&&ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.p,{type:"text",defaultValue:k.refId,onBlur:ce,autoFocus:!0,onKeyDown:Pe,onFocus:Ie,invalid:ue!==null,onChange:me,className:te.queryNameInput,"data-testid":"query-name-input"}),ue&&(0,n.jsx)(w.P,{horizontal:!0,children:ue})]}),L(_,te),X&&(0,n.jsx)("div",{className:te.itemWrapper,children:X()}),Q&&(0,n.jsx)("em",{className:te.contextInfo,children:(0,n.jsx)(y.x6,{i18nKey:"query.query-editor-row-header.hidden",children:"Hidden"})})]}),Y&&(0,n.jsx)("div",{className:te.collapsedText,children:Y})]})},L=(_,k)=>{const{alerting:J,dataSource:z,onChangeDataSource:Y}=_;return Y?(0,n.jsx)("div",{className:k.itemWrapper,children:(0,n.jsx)(N.s,{dashboard:!0,variables:!0,alerting:J,current:z.name,onChange:Y})}):(0,n.jsxs)("em",{className:k.contextInfo,children:["(",z.name,")"]})},A=_=>({wrapper:(0,j.css)({label:"Wrapper",display:"flex",alignItems:"center",marginLeft:_.spacing(.5),overflow:"hidden"}),queryNameWrapper:(0,j.css)({display:"flex",cursor:"pointer",border:"1px solid transparent",borderRadius:_.shape.radius.default,alignItems:"center",padding:_.spacing(0,0,0,.5),margin:0,background:"transparent",overflow:"hidden","&:hover":{background:_.colors.action.hover,border:`1px dashed ${_.colors.border.strong}`},"&:focus":{border:`2px solid ${_.colors.primary.border}`},"&:hover, &:focus":{".query-name-edit-icon":{visibility:"visible"}}}),queryName:(0,j.css)({fontWeight:_.typography.fontWeightMedium,color:_.colors.primary.text,cursor:"pointer",overflow:"hidden",marginLeft:_.spacing(.5)}),queryEditIcon:(0,j.cx)((0,j.css)({marginLeft:_.spacing(2),visibility:"hidden"}),"query-name-edit-icon"),queryNameInput:(0,j.css)({maxWidth:"300px",margin:"-4px 0"}),collapsedText:(0,j.css)({fontWeight:_.typography.fontWeightRegular,fontSize:_.typography.bodySmall.fontSize,color:_.colors.text.secondary,paddingLeft:_.spacing(1),alignItems:"center",overflow:"hidden",fontStyle:"italic",whiteSpace:"nowrap",textOverflow:"ellipsis"}),contextInfo:(0,j.css)({fontSize:_.typography.bodySmall.fontSize,fontStyle:"italic",color:_.colors.text.secondary,paddingLeft:"10px",paddingRight:"10px"}),itemWrapper:(0,j.css)({display:"flex",marginLeft:"4px"})});var U=e(76874);class F extends i.PureComponent{constructor(){super(...arguments),this.dataSourceSrv=(0,v.l)(),this.id="",this.state={datasource:null,data:void 0,isOpen:!0,showingHelp:!1},this.renderPluginEditor=()=>{const{query:k,onChange:J,queries:z,onRunQuery:Y,onAddQuery:X,range:Q,app:q=c.Jk.PanelEditor,history:te}=this.props,{datasource:ne,data:se}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(ne){let ue=this.getQueryEditor(ne);if(ue)return(0,n.jsx)(m.p,{instanceSettings:this.props.dataSource,children:(0,n.jsx)(ue,{query:k,datasource:ne,onChange:J,onRunQuery:Y,onAddQuery:X,data:se,range:Q,queries:z,app:q,history:te},ne?.name)})}return(0,n.jsx)("div",{children:(0,n.jsx)(y.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onRemoveQuery=()=>{const{onRemoveQuery:k,query:J,onQueryRemoved:z}=this.props;k(J),z&&z()},this.onCopyQuery=()=>{const{query:k,onAddQuery:J,onQueryCopied:z}=this.props,Y=(0,l.cloneDeep)(k);J(Y),z&&z()},this.onHideQuery=()=>{const{query:k,onChange:J,onRunQuery:z,onQueryToggled:Y}=this.props;J({...k,hide:!k.hide}),z(),Y&&Y(k.hide),(0,x.rR)("query_editor_row_hide_query_clicked",{hide:!k.hide})},this.onToggleHelp=()=>{this.setState(k=>({showingHelp:!k.showingHelp}))},this.onClickExample=k=>{k.datasource===void 0&&(k.datasource=(0,p.p$)(this.props.dataSource)),this.props.onChange({...k,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=k=>{const{data:J,query:z}=this.props,X=(V(J,z.refId)?.series??[]).reduce((ie,he)=>{if(!he.meta?.notices)return ie;const me=(0,l.filter)(he.meta.notices,ce=>ce.severity===k)??[];return ie.concat(me)},[]),Q=(0,l.uniqBy)(X,"text");if(!(Q.length>0))return null;const te="query-"+k+"s",ne=k==="warning"?"orange":"blue",se=k==="warning"?"exclamation-triangle":"file-landscape-alt",ue=Q.map(ie=>ie.text),de=(0,n.jsx)(b.B,{items:ue,renderItem:ie=>(0,n.jsx)(n.Fragment,{children:ie})});return(0,n.jsx)(E.E,{color:ne,icon:se,text:(0,n.jsxs)(n.Fragment,{children:[Q.length," ",d()(k,Q.length)]}),tooltip:de},te)},this.renderExtraActions=()=>{const{query:k,queries:J,data:z,onAddQuery:Y,dataSource:X,app:Q}=this.props,q=I.d.getAllExtraRenderAction();let te=[];Q!==void 0&&(te=I.d.getScopedExtraRenderAction(Q));const ne=[...q,...te].map((se,ue)=>se({query:k,queries:J,timeRange:z.timeRange,onAddQuery:Y,dataSource:X,key:ue})).filter(Boolean);return ne.push(this.renderWarnings("info")),ne.push(this.renderWarnings("warning")),ne.push((0,n.jsx)(H,{query:k},"adaptive-telemetry-actions")),ne},this.renderActions=k=>{const{query:J,hideHideQueryButton:z=!1,onReplace:Y,onQueryReplacedFromLibrary:X}=this.props,{datasource:Q,showingHelp:q}=this.state,te=!!J.hide,ne=Q?.components?.QueryEditorHelp;return(0,n.jsxs)(n.Fragment,{children:[ne&&(0,n.jsx)(P.A,{title:(0,y.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:q}),this.renderExtraActions(),(0,n.jsx)(K,{query:J}),(0,n.jsx)(P.q,{title:(0,y.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),(0,n.jsx)(G,{datasourceFilters:Q?.name?[Q.name]:[],onSelectQuery:se=>{X?.(),Y?.(se)}}),z?null:(0,n.jsx)(P.A,{dataTestId:g.Tp.components.QueryEditorRow.actionButton("Hide response"),title:J.hide?(0,y.t)("query-operation.header.show-response","Show response"):(0,y.t)("query-operation.header.hide-response","Hide response"),icon:te?"eye-slash":"eye",active:te,onClick:this.onHideQuery}),(0,n.jsx)(P.q,{title:(0,y.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=k=>{const{app:J,query:z,dataSource:Y,onChangeDataSource:X,onChange:Q,queries:q,renderHeaderExtras:te,hideRefId:ne}=this.props;return(0,n.jsx)(M,{query:z,queries:q,onChangeDataSource:X,dataSource:Y,hidden:z.hide,onChange:Q,collapsedText:k.isOpen?null:this.renderCollapsedText(),renderExtras:te,alerting:J===c.Jk.UnifiedAlerting,hideRefId:ne})}}componentDidMount(){const{data:k,query:J,id:z}=this.props,Y=V(k,J.refId);this.id=(0,l.uniqueId)(z+"_"),this.setState({data:Y}),this.loadDatasource()}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const k=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return k?.rawRef?.uid??k?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let k;const J=this.getInterpolatedDataSourceUID();try{k=await this.dataSourceSrv.get(J)}catch{k=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(k),this.setState({datasource:k,queriedDataSourceIdentifier:J})}componentDidUpdate(k){const{datasource:J,queriedDataSourceIdentifier:z}=this.state,{data:Y,query:X}=this.props;if(k.id!==this.props.id&&(this.id=(0,l.uniqueId)(this.props.id+"_")),Y!==k.data){const Q=V(Y,X.refId);this.setState({data:Q})}if(J&&z!==this.getInterpolatedDataSourceUID()){this.loadDatasource();return}}getQueryEditor(k){if(k)switch(this.props.app){case c.Jk.Explore:return k.components?.ExploreMetricsQueryField||k.components?.ExploreLogsQueryField||k.components?.ExploreQueryField||k.components?.QueryEditor;case c.Jk.PanelEditor:case c.Jk.Dashboard:default:return k.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:k}=this.state;return k?.getQueryDisplayText?k.getQueryDisplayText(this.props.query):null}render(){const{query:k,index:J,visualization:z,collapsable:Y,hideActionButtons:X}=this.props,{datasource:Q,showingHelp:q,data:te}=this.state,ne=k.hide,se=te?.error&&te.error.refId===k.refId?te.error:te?.errors?.find(he=>he.refId===k.refId),ue=s()("query-editor-row",{"query-editor-row--disabled":ne,"gf-form-disabled":ne});if(!Q)return null;const de=this.renderPluginEditor(),ie=Q.components?.QueryEditorHelp;return(0,n.jsx)("div",{"data-testid":"query-editor-row","aria-label":g.Tp.components.QueryEditorRows.rows,children:(0,n.jsx)(T.u,{id:this.id,draggable:!X,collapsable:Y,index:J,headerElement:this.renderHeader,actions:X?void 0:this.renderActions,children:(0,n.jsxs)("div",{className:ue,id:this.id,children:[(0,n.jsxs)(D.Xw,{children:[q&&ie&&(0,n.jsx)(C.j,{children:(0,n.jsx)(ie,{onClickExample:he=>this.onClickExample(he),query:this.props.query,datasource:Q})}),de]}),se&&(0,n.jsx)(U.x,{error:se}),z]})})})}}function V(_,k){const J=_.series.filter(Q=>Q.refId===k);if(_.state!==h.Gu.Loading&&(_.error||_.errors?.length)&&!_.series.length)return{..._,state:h.Gu.Error};let z=_.state,Y=_.errors?.find(Q=>Q.refId===k);!Y&&_.error&&(Y=_.error.refId===k?_.error:void 0),z!==h.Gu.Loading&&(Y?z=h.Gu.Error:_.state===h.Gu.Error&&(z=h.Gu.Done));const X=_.timeRange;return{..._,state:z,series:J,error:Y,errors:Y?[Y]:void 0,timeRange:X}}function K(_){const{renderSaveQueryButton:k}=(0,O.Y)();return k(_.query)}function G({datasourceFilters:_,onSelectQuery:k}){const{openDrawer:J,queryLibraryEnabled:z}=(0,O.Y)(),Y=()=>{J(_,k,{isReplacingQuery:!0})};return z?(0,n.jsx)(P.q,{title:(0,y.t)("query-operation.header.replace-query-from-library","Replace with query from library"),icon:"book",onClick:Y}):null}function H({query:_}){try{const{isLoading:k,components:J}=(0,f.f)({extensionPointId:r.S.QueryEditorRowAdaptiveTelemetryV1});return k||!J.length?null:(0,u.RC)({props:{query:_,contextHints:["queryeditorrow","header"]},components:J,limit:1,pluginId:/grafana-adaptive.*/})}catch{return null}}},65966:(Z,R,e)=>{"use strict";e.d(R,{L:()=>p});var n=e(74848),a=e(89332),s=e(96540),l=e(48480),o=e(27489),d=e(78282),i=e(75421),c=e(18615),m=e(67042);class p extends s.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=g=>{this.props.onQueriesChange(this.props.queries.filter(y=>y!==g))},this.onDragStart=g=>{const{queries:y,dsSettings:v}=this.props;(0,o.rR)("query_row_reorder_started",{startIndex:g.source.index,numberOfQueries:y.length,datasourceType:v.type})},this.onDragEnd=g=>{const{queries:y,onQueriesChange:v,dsSettings:x}=this.props;if(!g||!g.destination)return;const f=g.source.index,u=g.destination.index;if(f===u){(0,o.rR)("query_row_reorder_canceled",{startIndex:f,endIndex:u,numberOfQueries:y.length,datasourceType:x.type});return}const b=Array.from(y),[E]=b.splice(f,1);b.splice(u,0,E),v(b),(0,o.rR)("query_row_reorder_ended",{startIndex:f,endIndex:u,numberOfQueries:y.length,datasourceType:x.type})}}onChangeQuery(g,y){const{queries:v,onQueriesChange:x}=this.props;x(v.map((f,u)=>u===y?g:f))}onReplaceQuery(g,y){const{queries:v,onQueriesChange:x,onUpdateDatasources:f,dsSettings:u}=this.props,b=v.map((E,D)=>D===y?g:E);if(x(b),g.datasource?.uid){const C={uid:new Set(b.map(T=>T.datasource?.uid)).size>1?c.uv:g.datasource.uid};u.uid!==C.uid&&f?.(C)}}onDataSourceChange(g,y){const{queries:v,onQueriesChange:x}=this.props;x(v.map((f,u)=>{if(u!==y)return f;const b=(0,l.p$)(g);return f.datasource&&(0,d.l)().getInstanceSettings(f.datasource)?.type===g.type?{...f,datasource:b}:{refId:f.refId,hide:f.hide,datasource:b}}))}render(){const{dsSettings:g,data:y,queries:v,app:x,history:f,eventBus:u,onAddQuery:b,onRunQueries:E,onQueryCopied:D,onQueryRemoved:C,onQueryToggled:P,onQueryReplacedFromLibrary:T,queryRowWrapper:O}=this.props;return(0,n.jsx)(a.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,n.jsx)(a.gL,{droppableId:"transformations-list",direction:"vertical",children:I=>(0,n.jsxs)("div",{"data-testid":"query-editor-rows",ref:I.innerRef,...I.droppableProps,children:[v.map((j,W)=>{const B=h(j,g),S=g.meta.mixed?N=>this.onDataSourceChange(N,W):void 0,w=(0,n.jsx)(m.c,{id:j.refId,index:W,data:y,query:j,dataSource:B,onChangeDataSource:S,onChange:N=>this.onChangeQuery(N,W),onReplace:N=>this.onReplaceQuery(N,W),onRemoveQuery:this.onRemoveQuery,onAddQuery:b,onRunQuery:E,onQueryCopied:D,onQueryRemoved:C,onQueryToggled:P,onQueryReplacedFromLibrary:T,queries:v,app:x,range:(0,i.jG)().timeRange(),history:f,eventBus:u},j.refId);return O?O(w,j.refId):w}),I.placeholder]})})})}}const h=(r,g)=>r.datasource&&(0,d.l)().getInstanceSettings(r.datasource)||g},76874:(Z,R,e)=>{"use strict";e.d(R,{x:()=>d});var n=e(74848),a=e(22803),s=e(92745),l=e(63142),o=e(30703);function d({error:c}){const m=(0,l.of)(i),p=c?.message??c?.data?.message??"Query error";return(0,n.jsxs)("div",{className:m.wrapper,children:[(0,n.jsx)("div",{className:m.icon,children:(0,n.jsx)(o.I,{name:"exclamation-triangle"})}),(0,n.jsxs)("div",{className:m.message,children:[p,c.traceId!=null&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{})," ",(0,n.jsx)("span",{children:(0,n.jsxs)(s.x6,{i18nKey:"query.query-error-alert.trace-id",values:{traceId:c.traceId},children:["(Trace ID: ","{{traceId}}",")"]})})]})]})]})}const i=c=>({wrapper:(0,a.css)({marginTop:c.spacing(.5),background:c.colors.background.secondary,display:"flex"}),icon:(0,a.css)({background:c.colors.error.main,color:c.colors.error.contrastText,padding:c.spacing(1)}),message:(0,a.css)({fontSize:c.typography.bodySmall.fontSize,fontFamily:c.typography.fontFamilyMonospace,padding:c.spacing(1)})})},32154:(Z,R,e)=>{"use strict";e.d(R,{g:()=>k,K:()=>z});var n=e(74848),a=e(22803),s=e(96540),l=e(28105),o=e(22592),d=e(48480),i=e(1906),c=e(51898),m=e(92745),p=e(78282),h=e(36490),r=e(32881),g=e(45861),y=e(92807),v=e(22787),x=e(65240),f=e(51115),u=e(16817),b=e(67458),E=e(68143),D=e(6975);function C({pluginId:X}){const{value:Q,loading:q,error:te}=(0,u.A)(async()=>(0,E.AI)().get(`/api/plugins/${X}/markdown/query_help`),[]),ne=(0,b.G)(Q);return q?(0,n.jsx)(D._,{text:(0,m.t)("plugins.plugin-help.loading","Loading help...")}):te?(0,n.jsx)("h3",{children:(0,n.jsx)(m.x6,{i18nKey:"plugins.plugin-help.error",children:"An error occurred when loading help."})}):Q===""?(0,n.jsx)("h3",{children:(0,n.jsx)(m.x6,{i18nKey:"plugins.plugin-help.not-found",children:"No query help could be found."})}):(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:ne}})}var P=e(65642),T=e(83873),O=e(1404),I=e(41776),j=e(76792),W=e(29328),B=e(73601),S=e(57204),w=e(23117),N=e(65966),M=e(17548),L=e(63142),A=e(79233),U=e(63527),F=e(21285),V=e(85348);const K=s.memo(({options:X,dataSource:Q,data:q,onChange:te})=>{const[ne,se]=(0,s.useState)(X.timeRange?.from||""),[ue,de]=(0,s.useState)(X.timeRange?.shift||""),[ie,he]=(0,s.useState)(X.timeRange?.hide??!1),[me,ce]=(0,s.useState)(!1),[Pe,Ie]=(0,s.useState)(!0),[Se,Me]=(0,s.useState)(!0),Te=(0,L.of)(_),Ge=(0,s.useCallback)(ve=>{se(ve.target.value)},[]),Qe=(0,s.useCallback)(ve=>{de(ve.target.value)},[]),tt=(0,s.useCallback)(ve=>{const be=H(ve.target.value),Oe=G(be);Oe&&X.timeRange?.from!==be&&te({...X,timeRange:{...X.timeRange??{},from:be}}),Ie(Oe)},[te,X]),ke=(0,s.useCallback)(ve=>{const be=H(ve.target.value),Oe=G(be);Oe&&X.timeRange?.shift!==be&&te({...X,timeRange:{...X.timeRange??{},shift:be}}),Me(Oe)},[te,X]),He=(0,s.useCallback)(()=>{const ve=!ie;he(ve),te({...X,timeRange:{...X.timeRange??{},hide:ve}})},[te,X,ie]),Re=(0,s.useCallback)(ve=>{te({...X,cacheTimeout:H(ve.target.value)})},[te,X]),Ne=(0,s.useCallback)(ve=>{let be=parseInt(ve.target.value,10);(isNaN(be)||be===0)&&(be=null),te({...X,queryCachingTTL:be})},[te,X]),Ae=(0,s.useCallback)(ve=>{let be=parseInt(ve.currentTarget.value,10);(isNaN(be)||be===0)&&(be=null),be!==X.maxDataPoints&&te({...X,maxDataPoints:be})},[te,X]),Ue=(0,s.useCallback)(ve=>{const be=H(ve.target.value);be!==X.minInterval&&te({...X,minInterval:be})},[te,X]),Be=(0,s.useCallback)(()=>{ce(!0)},[]),We=(0,s.useCallback)(()=>{ce(!1)},[]),_e=()=>{const ve=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return Q.meta.queryOptions?.cacheTimeout?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{tooltip:ve,htmlFor:"cache-timeout-id",children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-cache-timeout-option.cache-timeout",children:"Cache timeout"})}),(0,n.jsx)(U.p,{id:"cache-timeout-id",type:"text",placeholder:"60",spellCheck:!1,onBlur:Re,defaultValue:X.cacheTimeout??""})]}):null},Xe=()=>{const ve="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return Q.cachingConfig?.enabled?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{tooltip:ve,children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-query-caching-ttloption.cache-ttl",children:"Cache TTL"})}),(0,n.jsx)(U.p,{type:"number",placeholder:`${Q.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:Ne,defaultValue:X.queryCachingTTL??void 0})]}):null},le=()=>{const ve=q.request?.maxDataPoints,be=X.maxDataPoints??"",Oe=be==="";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{htmlFor:"max-data-points-input",tooltip:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.max-data-points-tooltip",children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.max-data-points",children:"Max data points"})}),(0,n.jsx)(U.p,{id:"max-data-points-input",type:"number",placeholder:`${ve}`,spellCheck:!1,onBlur:Ae,defaultValue:be}),Oe&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.operator),children:"="}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.left),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.width-of-panel",children:"Width of panel"})})]})]})},ye=()=>{const ve=q.request?.interval,be=Q.interval??"No limit";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{className:Te.firstColumn,tooltip:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.min-interval-tooltip",children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,n.jsx)("code",{children:"1m"})," if your data is written every minute. Default value can be set in data source settings for most data sources."]}),htmlFor:"min-interval-input",children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.min-interval",children:"Min interval"})}),(0,n.jsx)(U.p,{id:"min-interval-input",type:"text",placeholder:`${be}`,spellCheck:!1,onBlur:Ue,defaultValue:X.minInterval??""}),(0,n.jsx)(A.c,{className:Te.firstColumn,tooltip:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.interval-tooltip",children:["The evaluated interval that is sent to data source and is used in ",(0,n.jsx)("code",{children:"$__interval"})," and"," ",(0,n.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to ",(0,n.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.interval",children:"Interval"})}),(0,n.jsx)("span",{className:Te.noSquish,children:ve}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.operator),children:"="}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.left),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.time-range-max-data-points",children:"Time range / max data points"})})]})},pe=()=>{if(me)return;let ve=X.maxDataPoints??"";ve===""&&q.request&&(ve=`auto = ${q.request.maxDataPoints}`);const be=q.request?.interval??X.minInterval;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:Te.collapsedText,children:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.collapsed-max-data-points",children:["MD = ",{mdDesc:ve}]})}),(0,n.jsx)("span",{className:Te.collapsedText,children:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.collapsed-interval",children:["Interval = ",{intervalDesc:be}]})})]})};return(0,n.jsx)(V.u,{id:"Query options",index:0,title:(0,m.t)("query.query-group-options-editor.Query options-title-query-options","Query options"),headerElement:pe(),isOpen:me,onOpen:Be,onClose:We,children:(0,n.jsxs)("div",{className:Te.grid,children:[le(),ye(),_e(),Xe(),(0,n.jsx)(A.c,{htmlFor:"relative-time-input",tooltip:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.relative-time-tooltip",values:{relativeFrom:"now-5m",relativeTo:"5m",variable:"$_relativeTime"},children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,n.jsx)("code",{children:"{{relativeFrom}}"})," and"," ",(0,n.jsx)("code",{children:"{{relativeTo}}"}),", or variables like ",(0,n.jsx)("code",{children:"{{variable}}"}),"."]}),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.relative-time",children:"Relative time"})}),(0,n.jsx)(U.p,{id:"relative-time-input",type:"text",placeholder:"1h",onChange:Ge,onBlur:tt,invalid:!Pe,value:ne}),(0,n.jsx)(A.c,{htmlFor:"time-shift-input",className:Te.firstColumn,tooltip:(0,n.jsxs)(m.x6,{i18nKey:"query.query-group-options-editor.time-shift-tooltip",values:{relativeFrom:"now-1h",relativeTo:"1h",variable:"$_timeShift"},children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,n.jsx)("code",{children:"{{relativeFrom}}"})," and"," ",(0,n.jsx)("code",{children:"{{relativeTo}}"}),", or variables like ",(0,n.jsx)("code",{children:"{{variable}}"}),"."]}),children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.time-shift",children:"Time shift"})}),(0,n.jsx)(U.p,{id:"time-shift-input",type:"text",placeholder:"1h",onChange:Qe,onBlur:ke,invalid:!Se,value:ue}),(ue||ne)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{htmlFor:"hide-time-info-switch",className:Te.firstColumn,children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-options-editor.hide-time-info",children:"Hide time info"})}),(0,n.jsx)(F.K,{id:"hide-time-info-switch",className:Te.left,value:ie,onChange:He})]})]})})});K.displayName="QueryGroupOptionsEditor";function G(X){return!X||M.isValidTimeSpan(X)}function H(X){return X===""?null:X}function _(X){return{grid:(0,a.css)({display:"grid",gridTemplateColumns:"auto minmax(5em, 1fr) auto 1fr",gap:X.spacing(.5),gridAutoRows:X.spacing(4),whiteSpace:"nowrap"}),firstColumn:(0,a.css)({gridColumn:1}),collapsedText:(0,a.css)({marginLeft:X.spacing(2),fontSize:X.typography.size.sm,color:X.colors.text.secondary}),noSquish:(0,a.css)({display:"flex",alignItems:"center",padding:X.spacing(0,1),fontWeight:X.typography.fontWeightMedium,fontSize:X.typography.size.sm,backgroundColor:X.colors.background.secondary,borderRadius:X.shape.radius.default}),left:(0,a.css)({justifySelf:"left"}),operator:(0,a.css)({color:X.v1.palette.orange})}}class k extends s.PureComponent{constructor(){super(...arguments),this.backendSrv=T.IB,this.dataSourceSrv=(0,p.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!h.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:l.Gu.NotStarted,series:[],timeRange:(0,o.E2)()}},this.onChangeDataSource=async(Q,q)=>{const{dsSettings:te}=this.state,ne=te?await(0,p.l)().get(te.uid):void 0,se=await(0,p.l)().get(Q.uid),ue=q||await(0,S.y)(se,Q.uid,this.state.queries,ne),de=await this.dataSourceSrv.get(Q.name);this.onChange({queries:ue,dataSource:{name:Q.name,uid:Q.uid,...(0,d.p$)(Q)}}),this.setState({queries:ue,dataSource:de,dsSettings:Q}),q&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:Q}=this.state;this.onQueriesChange((0,O.U7)(Q,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,O.U7)(this.state.queries,W.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=Q=>{this.props.onOptionsChange(Q),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=Q=>{const{dsSettings:q,queries:te}=this.state;this.onQueriesChange((0,O.U7)(te,Q,q?(0,d.p$)(q):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=Q=>{this.onChange({queries:Q}),this.setState({queries:Q})},this.setScrollRef=Q=>{this.setState({scrollElement:Q})}}async componentDidMount(){const{options:Q,queryRunner:q}=this.props;this.querySubscription=q.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:te=>this.onPanelDataUpdate(te)}),this.setNewQueriesAndDatasource(Q)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:Q}=this.props,q=await(0,p.l)().get(Q.dataSource);this.state.dataSource&&q.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(Q)}async setNewQueriesAndDatasource(Q){try{const q=await this.dataSourceSrv.get(Q.dataSource),te=this.dataSourceSrv.getInstanceSettings(Q.dataSource),ne=await this.dataSourceSrv.get(),se=q.getRef(),ue=Q.queries.map(de=>({...(0,O.Ih)(de)&&q?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:se,...de}));this.setState({queries:ue,dataSource:q,dsSettings:te,defaultDataSource:ne})}catch(q){console.error("failed to load data source",q)}}onPanelDataUpdate(Q){this.setState({data:Q})}newQuery(){const{dsSettings:Q,defaultDataSource:q}=this.state,te=Q&&!Q.meta.mixed?(0,d.p$)(Q):q?q.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:te}}onChange(Q){this.props.onOptionsChange({...this.props.options,...Q})}renderTopSection(Q){const{onOpenQueryInspector:q,options:te}=this.props,{dataSource:ne,data:se,dsSettings:ue}=this.state;return!ue||!ne?null:(0,n.jsx)(z,{data:se,dataSource:ne,options:te,dsSettings:ue,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:q})}renderQueries(Q){const{onRunQueries:q}=this.props,{data:te,queries:ne}=this.state;return(0,n.jsx)("div",{"aria-label":c.Tp.components.QueryTab.content,children:(0,n.jsx)(N.L,{queries:ne,dsSettings:Q,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:q,data:te})})}isExpressionsSupported(Q){return(Q.meta.backend||Q.meta.alerting||Q.meta.mixed)===!0}renderExtraActions(){return w.m.getAllExtraRenderAction().map((Q,q)=>Q({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:q})).filter(Boolean)}renderAddQueryRow(Q,q){const te=!(0,B.k)(Q.name);return(0,n.jsxs)(r.Gy,{spacing:"md",align:"flex-start",children:[te&&(0,n.jsx)(g.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":c.Tp.components.QueryTab.addQuery,children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group.add-query",children:"Add query"})}),P.Ay.expressionsEnabled&&this.isExpressionsSupported(Q)&&(0,n.jsx)(g.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:q.expressionButton,"data-testid":"query-tab-add-expression",children:(0,n.jsx)("span",{children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group.expression",children:"Expression"})})}),this.renderExtraActions()]})}render(){const{isHelpOpen:Q,dsSettings:q}=this.state,te=J();return(0,n.jsx)(y.P,{minHeight:"100%",ref:this.setScrollRef,children:(0,n.jsxs)("div",{className:te.innerWrapper,children:[this.renderTopSection(te),q&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:te.queriesWrapper,children:this.renderQueries(q)}),this.renderAddQueryRow(q,te),Q&&(0,n.jsx)(v.a,{title:(0,m.t)("query.query-group.title-data-source-help","Data source help"),isOpen:!0,onDismiss:this.onCloseHelp,children:(0,n.jsx)(C,{pluginId:q.meta.id})})]})]})})}}const J=(0,x.N)(()=>{const{theme:X}=P.Ay;return{innerWrapper:(0,a.css)({display:"flex",flexDirection:"column",padding:X.spacing.md}),dataSourceRow:(0,a.css)({display:"flex",marginBottom:X.spacing.md}),dataSourceRowItem:(0,a.css)({marginRight:X.spacing.inlineFormMargin}),dataSourceRowItemOptions:(0,a.css)({flexGrow:1,marginRight:X.spacing.inlineFormMargin}),queriesWrapper:(0,a.css)({paddingBottom:"16px"}),expressionWrapper:(0,a.css)({}),expressionButton:(0,a.css)({marginRight:X.spacing.sm})}});function z({dataSource:X,options:Q,data:q,dsSettings:te,onDataSourceChange:ne,onOptionsChange:se,onOpenQueryInspector:ue}){const de=J(),[ie,he]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{"data-testid":c.Tp.components.QueryTab.queryGroupTopSection,children:(0,n.jsxs)("div",{className:de.dataSourceRow,children:[(0,n.jsx)(f.I,{htmlFor:"data-source-picker",width:"auto",children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-top-section.data-source",children:"Data source"})}),(0,n.jsx)("div",{className:de.dataSourceRowItem,children:(0,n.jsx)(Y,{options:Q,onChange:async(me,ce)=>await ne?.(me,ce),isDataSourceModalOpen:!!h.Ny.getSearchObject().firstPanel})}),X&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:de.dataSourceRowItem,children:(0,n.jsx)(g.$n,{variant:"secondary",icon:"question-circle",title:(0,m.t)("query.query-group-top-section.query-tab-help-button-title-open-data-source-help","Open data source help"),onClick:()=>he(!0),"data-testid":"query-tab-help-button"})}),(0,n.jsx)("div",{className:de.dataSourceRowItemOptions,children:(0,n.jsx)(K,{options:Q,dataSource:X,data:q,onChange:me=>{se?.(me)}})}),ue&&(0,n.jsx)("div",{className:de.dataSourceRowItem,children:(0,n.jsx)(g.$n,{variant:"secondary",onClick:ue,"aria-label":c.Tp.components.QueryTab.queryInspectorButton,children:(0,n.jsx)(m.x6,{i18nKey:"query.query-group-top-section.query-inspector",children:"Query inspector"})})})]})]})}),ie&&(0,n.jsx)(v.a,{title:(0,m.t)("query.query-group-top-section.title-data-source-help","Data source help"),isOpen:!0,onDismiss:()=>he(!1),children:(0,n.jsx)(C,{pluginId:te.meta.id})})]})}function Y({options:X,onChange:Q,...q}){const[te,ne]=(0,s.useState)(!!q.isDataSourceModalOpen);(0,s.useEffect)(()=>{h.Ny.getSearchObject().firstPanel&&h.Ny.partial({firstPanel:null},!0)},[]);const se={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:X.dataSource,uploadFile:!0,onChange:async(ue,de)=>{await Q(ue,de),ne(!1)}};return(0,n.jsxs)(n.Fragment,{children:[te&&(0,n.jsx)(I.p,{...se,onDismiss:()=>ne(!1)}),(0,n.jsx)(j.s,{...se})]})}},32380:(Z,R,e)=>{"use strict";e.d(R,{nm:()=>ne,Dh:()=>Q});var n=e(39741),a=e(13752),s=e(64423),l=e(44240),o=e(39697),d=e(81160),i=e(67791),c=e(93031),m=e(71030),p=e(69850),h=e(1005),r=e(65961),g=e(75234),y=e(2543);function v(se){let ue=[];const de=(0,y.partition)(se,"id"),ie=(0,y.groupBy)(de[0],"id");return ue=(0,y.map)(ie,he=>he.length>1&&!(0,y.every)(he,x)?(0,y.find)(he,me=>me.eventType!=="panel-alert"):(0,y.head)(he)),ue=(0,y.concat)(ue,de[1]),ue}function x(se){return se.eventType==="panel-alert"}var f=e(75421),u=e(62467),b=e(65474),E=e(66847),D=e(69862),C=e(16126),P=e(43173),T=e(78282),O=e(42942),I=e(87745),j=e(87033),W=e(92511);class B{canRun(ue){return ue?!!(!ue.annotationQuery||ue.annotations):!1}run({annotation:ue,datasource:de,dashboard:ie,range:he}){if(!this.canRun(de))return(0,u.of)([]);const me={};return(0,j.b)({dashboard:ie,range:he,panel:me},de,ue).pipe((0,d.T)(ce=>ce.events??[]),(0,E.W)(W.SD))}}var S=e(90696);class w{canRun(ue){return ue?(0,S.E7)(ue)?!0:!!(ue.annotationQuery&&!ue.annotations):!1}run({annotation:ue,datasource:de,dashboard:ie,range:he}){if(!this.canRun(de))return(0,u.of)([]);if(de?.annotationQuery===void 0)return console.warn("datasource does not have an annotation query"),(0,u.of)([]);const me=de.annotationQuery({range:he,rangeRaw:he.raw,annotation:ue,dashboard:ie});return me===void 0?(console.warn("datasource does not have an annotation query"),(0,u.of)([])):(0,b.H)(me).pipe((0,E.W)(W.SD))}}class N{constructor(ue=[new w,new B]){this.runners=ue}canWork({dashboard:ue}){return!!ue.annotations.list.find(N.getAnnotationsToProcessFilter)}work(ue){if(!this.canWork(ue))return(0,W.$)();const{dashboard:de,range:ie}=ue;let he=de.annotations.list.filter(N.getAnnotationsToProcessFilter);P.$.publicDashboardAccessToken&&he.length>0&&(he=[he[0]]);const me=he.map(ce=>{let Pe;if(P.$.publicDashboardAccessToken){const Ie=new O.X;Pe=(0,u.of)(Ie).pipe((0,E.W)(W.H0))}else Pe=(0,b.H)((0,T.l)().get(ce.datasource)).pipe((0,E.W)(W.H0));return Pe.pipe((0,D.Z)(Ie=>{const Se=this.runners.find(Me=>Me.canRun(Ie));return Se?(de.events.publish(new I.xc(ce)),Se.run({annotation:ce,datasource:Ie,dashboard:de,range:ie}).pipe((0,i.Q)(Q().cancellations().pipe((0,C.p)(Me=>Me===ce))),(0,d.T)(Me=>(de.snapshot&&(ce.snapshotData=(0,y.cloneDeep)(Me)),P.$.publicDashboardAccessToken?Me:(0,W.G9)(ce,Me))),(0,p.j)(()=>{de.events.publish(new I.yj(ce))}))):(0,u.of)([])}))});return(0,l.h)(me).pipe((0,c.U)(),(0,m.T)((ce,Pe)=>ce.concat(Pe)),(0,d.T)(ce=>({annotations:ce,alertStates:[]})))}static getAnnotationsToProcessFilter(ue){return ue.enable&&!ue.snapshotData}}var M=e(18030),L=e(76190),A=e(15130),U=e(70327),F=e(78467),V=e(95443),K=e(52161),G=e(29609),H=e(7498),_=e(8535),k=e(11257);class J{constructor(){this.hasAlertRules={}}canWork({dashboard:ue,range:de}){return!(!ue.uid||P.$.publicDashboardAccessToken||de.raw.to!=="now"||this.hasAlertRules[ue.uid]===!1||!(A.TP.hasPermission(k.w.AlertingRuleRead)&&A.TP.hasPermission(k.w.AlertingRuleExternalRead)))}work(ue){if(!this.canWork(ue))return(0,W.$)();const{dashboard:de}=ue,ie=async()=>(await(0,_.JD)(U.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:K.hY,dashboardUid:de.uid},{forceRefetch:!0}))).data;return(0,b.H)(ie()).pipe((0,d.T)(me=>(0,F.Kw)(me))).pipe((0,d.T)(me=>{this.hasAlertRules[de.uid]=!1;const ce={};return me.forEach(Pe=>Pe.rules.forEach(Ie=>{if(G.R$.alertingRule(Ie)&&Ie.annotations&&Ie.annotations[V.YH.panelID]){this.hasAlertRules[de.uid]=!0;const Se=Number(Ie.annotations[V.YH.panelID]),Me=(0,H.S)(Ie.state);ce[Se]?Me===L.O.Alerting&&ce[Se].state!==L.O.Alerting?ce[Se].state=L.O.Alerting:Me===L.O.Pending&&ce[Se].state!==L.O.Alerting&&ce[Se].state!==L.O.Pending&&(ce[Se].state=L.O.Pending):ce[Se]={state:Me,id:Object.keys(ce).length,panelId:Se,dashboardId:de.id}}})),{alertStates:Object.values(ce),annotations:[]}}),(0,E.W)(W.Zr))}}class z{constructor(ue,de=(0,f.jG)(),ie=[new J,new M.F,new N]){this.dashboard=ue,this.timeSrv=de,this.workers=ie,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new n.m(1),this.runs=new a.B,this.cancellationStream=new a.B,this.runsSubscription=this.runs.subscribe(he=>this.executeRun(he)),this.eventsSubscription=ue.events.subscribe(g._,he=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(ue){this.runs.next(ue)}getResult(ue){return this.results.asObservable().pipe((0,d.T)(de=>{const ie=(0,W.FK)(de.annotations,ue),he=de.alertStates.find(me=>!!ue&&me.panelId===ue);return{annotations:v(ie),alertState:he}}))}executeRun(ue){const ie=this.workers.filter(Ie=>Ie.canWork(ue)).map(Ie=>Ie.work(ue)),he=new s.yU,me=(0,l.h)(ie).pipe((0,i.Q)(this.runs.asObservable()),(0,c.U)(),(0,m.T)((Ie,Se)=>(Ie.annotations=Ie.annotations.concat(Se.annotations),Ie.alertStates=Ie.alertStates.concat(Se.alertStates),Ie)),(0,p.j)(()=>{he.unsubscribe()}),(0,h.u)()),ce=new s.yU,Pe=(0,o.O)(200).pipe((0,r.u)({annotations:[],alertStates:[]}),(0,i.Q)(me),(0,p.j)(()=>{ce.unsubscribe()}));ce.add(Pe.subscribe(Ie=>{this.results.next(Ie)})),he.add(me.subscribe(Ie=>{this.results.next(Ie)}))}cancel(ue){this.cancellationStream.next(ue)}cancellations(){return this.cancellationStream.asObservable().pipe((0,h.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let Y;function X(se){Y&&Y.destroy(),Y=se}function Q(){if(!Y)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return Y}let q;function te(se){q=se}function ne(se){q||(q=({dashboard:de,timeSrv:ie,workers:he})=>new z(de,ie,he));const ue=q(se);return X(ue),ue}},42942:(Z,R,e)=>{"use strict";e.d(R,{X:()=>p});var n=e(62467),a=e(65474),s=e(94644),l=e(41119),o=e(68143),d=e(43173),i=e(52161),c=e(8095);const m="-- Public --";class p extends s.mA{constructor(){let r={};super({name:"public-ds",id:0,type:"public-ds",meta:r,uid:m,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(g){return{...g,queryType:c.nj.Annotations,refId:"anno"}}}}query(r){return r.targets.length?r.targets[0]?.datasource?.uid===i.vv?(0,a.H)(this.getAnnotations(r)):(0,n.of)({data:[]}):(0,n.of)({data:[]})}async getAnnotations(r){const{range:{to:g,from:y}}=r,v={from:y.valueOf(),to:g.valueOf()},x=await(0,o.AI)().get(`/api/public/dashboards/${d.$.publicDashboardAccessToken}/annotations`,v);return{data:[(0,l.Vc)(x)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},18030:(Z,R,e)=>{"use strict";e.d(R,{F:()=>s});var n=e(62467),a=e(92511);class s{canWork({dashboard:o}){return o?.annotations?.list?.some(d=>d.enable&&!!d.snapshotData)}work(o){if(!this.canWork(o))return(0,a.$)();const d=this.getAnnotationsFromSnapshot(o.dashboard);return(0,n.of)({annotations:d,alertStates:[]})}getAnnotationsFromSnapshot(o){return(o?.annotations?.list?.filter(m=>m.enable)).filter(m=>!!m.snapshotData).reduce((m,p)=>m.concat((0,a.G9)(p,p.snapshotData)),[])}getAnnotationsInSnapshot(o,d){const i=this.getAnnotationsFromSnapshot(o);return(0,a.FK)(i,d)}}},92511:(Z,R,e)=>{"use strict";e.d(R,{$:()=>h,FK:()=>y,G9:()=>v,H0:()=>p,SD:()=>m,Zr:()=>r});var n=e(2543),a=e.n(n),s=e(62467),l=e(97534),o=e(43173),d=e(8535),i=e(64762),c=e(12066);function m(f){return f.cancelled?(0,s.of)([]):(g("AnnotationQueryRunner failed",f),(0,s.of)([]))}function p(f){return g("Failed to retrieve datasource",f),(0,s.of)(void 0)}const h=()=>(0,s.of)({annotations:[],alertStates:[]});function r(f){return f.cancelled||g("DashboardQueryRunner failed",f),h()}function g(f,u){const b=(0,l.u)(u);console.error("handleAnnotationQueryRunnerError",b);const E=(0,i.gi)(f,b.message);(0,d.JD)((0,c.dx)(E))}function y(f,u){return u==null?f:f.filter(b=>{let E;if(E=b.source,!E)return!0;if(E.filter){const D=(E.filter.ids??[]).includes(u);if(E.filter.exclude){if(D)return!1}else if(!D)return!1}return b.panelId&&b.source.type==="dashboard"?b.panelId===u:!0})}function v(f,u){f.snapshotData&&(f=(0,n.cloneDeep)(f),delete f.snapshotData);for(const b of u)switch(b.source=f,b.color=o.$.theme2.visualization.getColorByName(f.iconColor),b.type=f.name,b.isRegion=!!(b.timeEnd&&b.time!==b.timeEnd),b.newState?.toLowerCase()){case"pending":b.color="yellow";break;case"alerting":b.color="red";break;case"ok":b.color="green";break;case"normal":b.color="green";break;case"no_data":b.color="gray";break;case"nodata":b.color="gray";break}return u}function x(f){if(!f||!f.length)return[];const u=[];for(const b of f){const E=new DataFrameView(b);for(let D=0;D<b.length;D++){const C=cloneDeep(E.get(D));u.push(C)}}return u}},96215:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>S,S:()=>B});var n=e(2543),a=e(39741),s=e(62467),l=e(69862),o=e(81160),d=e(66847),i=e(28105),c=e(41119),m=e(22592),p=e(60519),h=e(76732),r=e(739),g=e(2197),y=e(1906),v=e(17548),x=e(97534),f=e(36580),u=e(46383),b=e(28998),E=e(59373),D=e(73601),C=e(32380),P=e(49510),T=e(27359);function O(N=[]){N.forEach(M=>{M.meta={...M.meta,dataTopic:r.QR.Annotations}})}function I(N,M){return(0,P.z)([N,M]).pipe((0,l.Z)(L=>{const[A,U]=L;if(U.annotations?.length||U.alertState){A.annotations||(A.annotations=[]);const F=A.annotations.concat((0,T.I)(U.annotations));O(F);const V=U.alertState;return(0,s.of)({...A,annotations:F,alertState:V})}return O(A.annotations),(0,s.of)(A)}))}var j=e(71393);let W=100;function B(){return"Q"+W++}class S{constructor(M){this.templateSrv=(0,E.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new a.m(1),this.dataConfigSource=M}getData(M){const{withFieldConfig:L,withTransforms:A}=M;let U=1,F,V=[],K=[],G,H=!0,_=-1;if(this.dataConfigSource.snapshotData){const k={state:i.Gu.Done,series:this.dataConfigSource.snapshotData.map(J=>(0,c.Vc)(J)),timeRange:(0,m.E2)(),structureRev:U};return(0,s.of)(k)}return this.subject.pipe((0,l.Z)(k=>{let J=this.dataConfigSource.getFieldOverrideOptions(),z=this.dataConfigSource.getTransformations();if(k.series===K&&F?.fieldConfig===J?.fieldConfig&&G===z)return(0,s.of)({...k,structureRev:U,series:V});F=J,G=z,K=k.series;let Y=(0,s.of)(k);return A&&(Y=this.applyTransformations(k)),Y.pipe((0,o.T)(X=>{let Q=X,q=!1;if(L&&X.series?.length){if(_===this.dataConfigSource.configRev){let te;for(const ne of X.series)if((0,u.o$)(ne)){te=ne;break}te&&!te.packetInfo.schemaChanged&&V[0].fields.length===te.fields.length&&(Q={...Q,series:V.map((ne,se)=>({...ne,length:X.series[se].length,fields:ne.fields.map((ue,de)=>({...ue,values:X.series[se].fields[de].values,state:{...ue.state,calcs:void 0,range:void 0}}))}))},q=!0)}J!=null&&(H||!q)&&(_=this.dataConfigSource.configRev,Q={...Q,series:(0,p.we)({timeZone:X.request?.timezone??"browser",data:Q.series,...J})},Q.annotations&&(Q.annotations=(0,p.we)({data:Q.annotations,...J,fieldConfig:{defaults:{},overrides:[]}})),H=!1)}return!q&&!(0,h.J3)(V,Q.series,h.bW)&&U++,V=Q.series,{...Q,structureRev:U}}))}))}applyTransformations(M){const L=this.dataConfigSource.getTransformations();if(L&&L.every(H=>H.disabled)||!L||L.length===0)return(0,s.of)(M);const U={interpolate:H=>this.templateSrv.replace(H,M?.request?.scopedVars)};let F=L.filter(H=>H.topic==null||H.topic===r.QR.Series),V=L.filter(H=>H.topic===r.QR.Annotations),K=(0,g.m)(F,M.series,U),G=(0,g.m)(V,M.annotations??[],U);return(0,n.merge)(K,G).pipe((0,o.T)(H=>{let k=H.some(J=>J.meta?.dataTopic===r.QR.Annotations)?{annotations:H}:{series:H};return{...M,...k}}),(0,d.W)(H=>(console.warn("Error running transformation:",H),(0,s.of)({...M,state:i.Gu.Error,errors:[(0,x.u)(H)]}))))}async run(M){const{queries:L,timezone:A,datasource:U,panelId:F,panelName:V,panelPluginId:K,dashboardUID:G,dashboardTitle:H,timeRange:_,timeInfo:k,cacheTimeout:J,queryCachingTTL:z,maxDataPoints:Y,scopedVars:X,minInterval:Q,app:q}=M;if((0,D.k)(U)){this.pipeToSubject((0,D.m)(M,L[0]),F,!0);return}const te=this.shouldAddErrorWhenDatasourceVariableIsMultiple(U,X),ne={app:q??y.Jk.Dashboard,requestId:B(),timezone:A,panelId:F,panelName:V,panelPluginId:K,dashboardUID:G,dashboardTitle:H,range:_,timeInfo:k,interval:"",intervalMs:0,targets:(0,n.cloneDeep)(L),maxDataPoints:Y,scopedVars:X||{},cacheTimeout:J,queryCachingTTL:z,startTime:Date.now(),rangeRaw:_.raw};try{const se=await w(U,ne.scopedVars),ue=se.meta?.mixed;ne.targets=ne.targets.map(he=>{const me=he.datasource?.type===f.dR.type;return(!he.datasource||he.datasource.uid!==se.uid&&!ue&&!me)&&(he.datasource=se.getRef()),he});const de=Q?this.templateSrv.replace(Q,ne.scopedVars):se.interval,ie=v.calculateInterval(_,Y,de);ne.scopedVars=Object.assign({},ne.scopedVars,{__interval:{text:ie.interval,value:ie.interval},__interval_ms:{text:ie.intervalMs.toString(),value:ie.intervalMs}}),ne.interval=ie.interval,ne.intervalMs=ie.intervalMs,ne.filters=this.templateSrv.getAdhocFilters(se.name,!0),ne.panelId=F,ne.panelName=V,this.lastRequest=ne,this.pipeToSubject((0,j.BN)(se,ne),F,!1,te)}catch(se){this.pipeToSubject((0,s.of)({state:i.Gu.Error,error:(0,x.u)(se),series:[],timeRange:ne.range}),F)}}pipeToSubject(M,L,A=!1,U=!1){this.subscription&&this.subscription.unsubscribe();let F=M;const V=this.dataConfigSource.getDataSupport();if(V.alertStates||V.annotations){const K=this.dataConfigSource;F=I(M,(0,C.Dh)().getResult(K.id))}this.subscription=F.subscribe({next:K=>{const G=this.lastResult,H=A?K:(0,c.N$)(K,G);if(G!=null&&H.state!==i.Gu.Streaming){let _=(0,h.J3)(G.series??[],H.series??[],(Y,X)=>Y===X),k=(0,h.J3)(G.annotations??[],H.annotations??[],(Y,X)=>Y===X),J=G.state===H.state,z=(0,h.J3)(G.errors??[],H.errors??[],(Y,X)=>(0,n.isEqual)(Y,X));if(_&&(H.series=G.series),k&&(H.annotations=G.annotations),_&&k&&J&&z)return}this.lastResult=H,U&&(H.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],H.state=i.Gu.Error),this.subject.next(H)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===i.Gu.Loading||this.lastResult.state===i.Gu.Streaming)&&this.subject.next({...this.lastResult,state:i.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new a.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(M){this.lastResult=M.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(M){this.lastResult=M}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(M,L){let A=!1;return M?.uid?.startsWith("${")&&this.templateSrv.replace(M.uid,L,U=>(Array.isArray(U)&&U.length>1&&(A=!0),"")),A}}async function w(N,M){return N&&typeof N=="object"&&"query"in N?N:await(0,b.tR)().get(N,M)}},77526:(Z,R,e)=>{"use strict";e.d(R,{N:()=>a});var n=e(69850);function a(s,l){return(0,n.j)(()=>{l&&s.resolveCancelerIfExists(l)})}},39050:(Z,R,e)=>{"use strict";e.d(R,{B:()=>a});var n=e(76732);const a=(s,l)=>{let o=1;return l?.structureRev&&l.series&&(o=l.structureRev,(0,n.J3)(s.series,l.series,n.bW)||o++),s.structureRev=o,s}},71393:(Z,R,e)=>{"use strict";e.d(R,{BN:()=>A});var n=e(2543),a=e(62467),s=e(44240),l=e(39697),o=e(65474),d=e(81160),i=e(66847),c=e(59099),m=e(1005),p=e(65961),h=e(67791),r=e(69862),g=e(28105),y=e(739),v=e(33239),x=e(1906),f=e(97534),u=e(38353),b=e(43173),E=e(36580),D=e(83873),C=e(1404),P=e(29328),T=e(25992);const O=(0,T.DW)("features.query");var I=e(77526),j=e(83175),W=e(33749),B=e(27489),S=e(22429);function w(V){let K=!1;return H=>{if(!H.request||K||j.kM.getUrlSearchParams().editPanel!=null||H.state!==g.Gu.Done&&H.state!==g.Gu.Error)return;const k={eventName:W.n_.DataRequest,source:H.request.app,datasourceName:V.name,datasourceId:V.id,datasourceUid:V.uid,datasourceType:V.type,dataSize:0,panelId:0,panelPluginId:H.request?.panelPluginId,duration:H.request.endTime-H.request.startTime,...H?.request?.panelId&&Number.isInteger(H.request.panelId)&&{panelId:H.request.panelId},...H?.request?.panelName&&{panelName:H.request.panelName}};G(k,H),H.request.app!==x.Jk.Explore&&H.request.app!==x.Jk.Correlations&&N(k,H),H.series&&H.series.length>0&&(k.dataSize=H.series.length),(0,B.G$)(k),K=!0};function G(H,_){const k={};for(let z=0;z<_.series.length;z++){const Y=_.series[z].refId;Y&&!k[Y]&&(k[Y]=_.series[z].meta?.isCachedResponse??!1)}H.totalQueries=Object.keys(k).length,H.cachedQueries=Object.values(k).filter(z=>z===!0).length;const J=(0,S.UA)().getCurrent();J&&(H.dashboardId=J.id,H.dashboardName=J.title,H.dashboardUid=J.uid,H.folderName=J.meta.folderTitle)}}function N(V,K){K.errors?.length?V.error=K.errors.map(G=>G.message).join(", "):K.error&&(V.error=K.error.message)}function M(V,K){const G=K.panelData.request,H={...K.packets},_=V.key??V.data?.[0]?.refId??"A";H[_]=V;let k=V.state||g.Gu.Done,J,z;const Y=[],X=[];for(const ne in H){const se=H[ne];if((se.error||se.errors?.length)&&(k=g.Gu.Error,J=se.error,z=se.errors),se.data&&se.data.length)for(const ue of se.data){if(ue.meta?.dataTopic===y.QR.Annotations){X.push(ue);continue}Y.push(ue)}}const Q=L(G,k),q={state:k,series:Y,annotations:X,error:J,errors:z,request:G,timeRange:Q},te=new Set([...K.panelData.traceIds??[],...V.traceIds??[]]);return te.size>0&&(q.traceIds=Array.from(te)),{packets:H,panelData:q}}function L(V,K){const G=V.range;return!(0,n.isString)(G.raw.from)||K!==g.Gu.Streaming?G:{...G,from:v.parse(G.raw.from,!1),to:v.parse(G.raw.to,!0)}}function A(V,K,G){let H={panelData:{state:g.Gu.Loading,series:[],request:K,timeRange:K.range},packets:{}};if(!K.targets.length)return K.endTime=Date.now(),H.panelData.state=g.Gu.Done,(0,a.of)(H.panelData);const _=U(V,K,G).pipe((0,d.T)(k=>{if(!(0,n.map)(k.data))throw new Error(`Expected response data to be array, got ${typeof k.data}.`);const J=K.targets.filter(z=>z.hide);for(const z of J)k.data=k.data.filter(Y=>Y.refId!==z.refId);return K.endTime=Date.now(),H=M(k,H),H.panelData}),(0,i.W)(k=>(console.error("runRequest.catchError",k),O.logError(k),(0,a.of)({...H.panelData,state:g.Gu.Error,error:(0,f.u)(k)}))),(0,c.M)(w(V)),(0,I.N)(D.IB,K.requestId),(0,m.u)());return(0,s.h)((0,l.O)(200).pipe((0,p.u)(H.panelData),(0,h.Q)(_)),_)}function U(V,K,G){if((0,u.LZ)(V)){const H=(0,u.xt)(V,K);return(0,o.H)(H).pipe((0,r.Z)(_=>F(V,_,G)))}return F(V,K,G)}function F(V,K,G){if(K.targets=K.targets.map(_=>(0,C.Ih)(_)?{...V?.getDefaultQuery?.(x.Jk.PanelEditor),..._}:_),b.$.publicDashboardAccessToken)return(0,o.H)(V.query(K));for(const _ of K.targets)if((0,E.s9)(_.datasource))return P.Ex.query(K);if(G||(K.targets=K.targets.filter(_=>V.filterQuery?.(_)??!0)),K.targets.length===0)return(0,a.of)({data:[]});const H=G?G(K):V.query(K);return(0,o.H)(H)}},57204:(Z,R,e)=>{"use strict";e.d(R,{y:()=>d});var n=e(1906),a=e(46933),s=e(39796),l=e(2863),o=e(36580);async function d(i,c,m,p){let h=m;const r={...i.getRef(),uid:c},g={...i?.getDefaultQuery?.(n.Jk.PanelEditor),datasource:r,refId:"A"};if(p?.meta.id!==i.meta.id){if(i.meta.mixed)return m;if((0,a.Ee)(p)&&(0,a.FL)(i)){const y=await p.exportToAbstractQueries(m);h=await i.importFromAbstractQueries(y)}else if(p&&i.importQueries)h=await i.importQueries(m,p);else{if(p){const y=(0,l.w)(),v=[];let x=i.uid;const f=y.containsTemplate(c);f&&(x=y.replace(i.uid));const u=m.reduce((b,E)=>{if(E.datasource){let D=E.datasource.uid;const C=y.containsTemplate(D);if(C&&(D=y.replace(E.datasource.uid)),D===x&&C===f)return E.refId=(0,s.M)(b),b.concat([E])}return b},v);if(u.length>0)return u}return[g]}}return h.length===0?[g]:h.map(y=>(!(0,o.s9)(y.datasource)&&!i.meta.mixed&&(y.datasource=r),y))}},99090:(Z,R,e)=>{"use strict";e.d(R,{G3:()=>d,TF:()=>m,XJ:()=>y,YU:()=>r,d7:()=>h,if:()=>v,r4:()=>o,w7:()=>g});var n=e(83458);const a=null,s=58,l=8,o={label:"A\u2013Z",value:"alpha-asc"},d="search.sections",i="grafana.search.expanded-folder",c=0,m="general",p="Dashboards",h="grafana.search.include.panels",r="grafana.search.layout",g="grafana.search.sort",y={dashboard:n.G.DashDB,folder:n.G.DashFolder,home:n.G.DashHome},v=1e3},5478:(Z,R,e)=>{"use strict";e.d(R,{d:()=>o,n:()=>d});var n=e(96540),a=e(13752),s=e(92138),l=e(36490);function o(){const i=(0,n.useRef)(new a.B);return{keyboardEvents:i.current,onKeyDown:c=>{switch(c.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":case"Escape":i.current.next(c);default:}}}}function d(i,c,m){const p=(0,n.useRef)({x:0,y:-1}),[h,r]=(0,n.useState)({x:0,y:-1}),g=(0,n.useRef)();return(0,n.useEffect)(()=>{g.current=m.view.fields.url,p.current.x=0,p.current.y=-1,r({...p.current})},[m]),(0,n.useEffect)(()=>{const y=i.subscribe({next:v=>{switch(v?.code){case"ArrowDown":{p.current.y++,r({...p.current});break}case"ArrowUp":p.current.y=Math.max(0,p.current.y-1),r({...p.current});break;case"ArrowRight":{c>0&&(p.current.x=Math.min(c,p.current.x+1),r({...p.current}));break}case"ArrowLeft":{c>0&&(p.current.x=Math.max(0,p.current.x-1),r({...p.current}));break}case"Enter":if(!g.current)break;const x=p.current.x*c+p.current.y;if(x<0){p.current.x=0,p.current.y=0,r({...p.current});break}const f=g.current.values?.[x];typeof f=="string"&&l.Ny.push(s.I.stripBaseFromUrl(f))}}});return()=>y.unsubscribe()},[i,c]),h}},67497:(Z,R,e)=>{"use strict";e.d(R,{B9:()=>d,J$:()=>l,KZ:()=>o,MK:()=>s,Pf:()=>a});var n=e(27489);const a=(c,m)=>{(0,n.rR)(`${c}_viewed`,i(m))},s=(c,m)=>{(0,n.rR)(`${c}_result_clicked`,i(m))},l=(c,m)=>{(0,n.rR)(`${c}_query_submitted`,i(m))},o=(c,{error:m,...p})=>{(0,n.rR)(`${c}_query_failed`,{...i(p),error:m})},d=(c,m,p)=>{(0,n.rR)(`grafana_panel_inspect_${c}_${m}_clicked`,p)},i=c=>({layout:c.layout,starredFilter:c.starred??!1,sort:c.sortValue??"",tagCount:c.tagCount??0,queryLength:c.query?.length??0,includePanels:c.includePanels??!1,deleted:c.deleted??!1})},42361:(Z,R,e)=>{"use strict";e.d(R,{v:()=>o});var n=e(66402),a=e(13956),s=e(93854);class l{constructor(){this.cache=null,this.promise=null}async get(){if(this.cache!==null)return this.cache;if(this.promise!==null)return this.promise;this.promise=this.fetch();try{return this.cache=await this.promise,this.cache}catch(i){throw this.promise=null,i}}clear(){this.cache=null,this.promise=null}async fetch(){try{const c=await(0,a.n)().listDeletedDashboards({limit:1e3});return(0,n.F)(c)?(0,s.A5)(c):[]}catch(i){return console.error("Failed to fetch deleted dashboards:",i),[]}}}const o=new l},55860:(Z,R,e)=>{"use strict";e.d(R,{S:()=>_});var n=e(43173),a=e(88673),s=e(41119),l=e(11576),o=e(92745),d=e(68143),i=e(93854);const c="Loading",m="api/search-v2",p="name_sort";class h{constructor(J){this.fallbackSearcher=J}async search(J){if(J.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(J)}async starred(J){if(J.facet?.length)throw new Error("facets not supported!");const z=await(0,d.AI)().get("api/user/stars");return z?.length?this.doSearchQuery({uid:z,query:J.query??"*"}):{view:new a.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(Y,X)=>{},isItemLoaded:Y=>!0}}async tags(J){const z={...J,query:J.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},X=(await(0,d.AI)().post(m,z)).frames.map(Q=>(0,s.Vc)(Q));if(X[0]?.name===c)return this.fallbackSearcher.tags(J);for(const Q of X)if(Q.fields[0].name==="tag")return y(Q);return[]}getSortOptions(){const J=[{value:p,label:(0,o.t)("search.bluge-searcher.opts.label.alphabetically-az","Alphabetically (A-Z)")},{value:"-name_sort",label:(0,o.t)("search.bluge-searcher.opts.label.alphabetically-za","Alphabetically (Z-A)")}];if(n.$.licenseInfo.enabledFeatures.analytics){for(const z of v)J.push({value:`-${z.name}`,label:`${z.display} (most)`}),J.push({value:`${z.name}`,label:`${z.display} (least)`});for(const z of x)J.push({value:`-${z.name}`,label:`${z.display} (recent)`}),J.push({value:`${z.name}`,label:`${z.display} (oldest)`})}return Promise.resolve(J)}async doSearchQuery(J){J=await(0,i.u4)(J);const z={...J,query:J.query??"*",limit:J.limit??r},X=(await(0,d.AI)().post(m,z)).frames.map(de=>(0,s.Vc)(de)),Q=X.length?(0,s.Vc)(X[0]):{fields:[],length:0};if(Q.name===c)return this.fallbackSearcher.search(J);for(const de of Q.fields)de.display=(0,l.J)({field:de,theme:n.$.theme2});Q.meta?.custom||(Q.meta={...Q.meta,custom:{count:Q.length,max_score:1}});const q=Q.meta.custom;if(q.locationInfo||(q.locationInfo={}),q.sortBy?.length){const de=Q.fields.find(ie=>ie.name===q.sortBy);if(de){const ie=f(de.name);q.sortBy=ie,de.name=ie}}let te=0,ne;const se=async()=>{for(;te>ue.dataFrame.length;){const de=ue.dataFrame.length;if(de>=q.count)return;const ie=await(0,d.AI)().post(m,{...z??{},from:de,limit:g}),he=(0,s.Vc)(ie.frames[0]);if(!he){console.log("no results",he);return}if(he.fields.length!==ue.dataFrame.fields.length){console.log("invalid shape",he,ue.dataFrame);return}const me=he.length+ue.dataFrame.length;for(let Pe=0;Pe<he.fields.length;Pe++)ue.dataFrame.fields[Pe].values.push(...he.fields[Pe].values);ue.dataFrame.length=me;const ce=he.meta?.custom;if(ce?.locationInfo&&q)for(const[Pe,Ie]of Object.entries(ce.locationInfo))q.locationInfo[Pe]=Ie}ne=void 0},ue=new a.R(Q);return{totalRows:q.count??Q.length,view:ue,loadMoreItems:async(de,ie)=>(te=Math.max(te,ie),ne||(ne=se()),ne),isItemLoaded:de=>de<ue.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const r=50,g=100;function y(k){const J=k.fields[0].values,z=k.fields[1].values,Y=[];for(let X=0;X<k.length;X++)Y.push({term:J[X],count:z[X]});return Y}const v=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],x=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function f(k){for(const J of v)if(J.name===k)return J.display;for(const J of x)if(J.name===k)return J.display;return k}var u=e(84139);class b{constructor(J){this.parent=J,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(J){if(J.facet?.length)throw new Error("facets not supported!");if(J.sort!=null)throw new Error("custom sorting is not supported yet");if(J.tags?.length||J.ds_uid?.length)return this.parent.search(J);const Y=(await this.getCache(J.kind)).search(J.query);return{isItemLoaded:()=>!0,loadMoreItems:async(X,Q)=>{},totalRows:Y.length,view:Y}}async getCache(J){const z=J?J.sort().join(","):"*",Y=this.cache.get(z);if(Y)try{return await Y}catch{return this.cache.delete(z),new E(new a.R({name:"error",fields:[],length:0}))}const X=this.parent.search({kind:J,limit:5e3}).then(Q=>new E(Q.view));return this.cache.set(z,X),X}async starred(J){return this.parent.starred(J)}async getSortOptions(){return this.parent.getSortOptions()}async tags(J){return this.parent.tags(J)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class E{constructor(J){this.full=J,this.ufuzzy=new u.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new a.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(z=>({...z,values:[]})),length:0})}search(J){if(!J?.length||J==="*")return this.full;const z=this.full.dataFrame.fields,Y=this.names,X=z.map(ne=>[]);let[Q,q,te]=this.ufuzzy.search(Y,J,5);for(let ne=0;ne<z.length;ne++){let se=z[ne].values,ue=X[ne];if(q&&te)for(let de=0;de<te.length;de++){let ie=q.idx[te[de]];ue.push(se[ie])}else if(Q)for(let de=0;de<Q.length;de++){let ie=Q[de];ue.push(se[ie])}}return this.empty.dataFrame.fields.forEach((ne,se)=>{ne.values=X[se]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var D=e(95004),C=e(83873),P=e(99090),T=e(42361);class O{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(J,z){const Y=await(0,i.u4)(z);return Y.query?.length&&Y.query!=="*"&&(J.query=Y.query),Y.kind?.length===1&&P.XJ[Y.kind[0]]&&(J.type=P.XJ[Y.kind[0]]),Y.uid?J.dashboardUID=Y.uid:Y.location?.length&&(J.folderUIDs=[Y.location]),J}async search(J){if(J.facet?.length)throw new Error("facets not supported!");if(J.from!==void 0){if(!J.limit)throw new Error("Must specify non-zero limit parameter when using from");if(J.from/J.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const z=J.limit??(J.from!==void 0?1:P.if),Y=J.from!==void 0?J.from/z+1:void 0,X=await this.composeQuery({limit:z,tag:J.tags,sort:J.sort,permission:J.permission,page:Y,deleted:J.deleted},J);return this.doAPIQuery(X)}async starred(J){if(J.facet?.length)throw new Error("facets not supported!");const z=await this.composeQuery({limit:J.limit??P.if,tag:J.tags,sort:J.sort,starred:J.starred},J);return this.doAPIQuery(z)}async getSortOptions(){return(await C.IB.get("/api/search/sorting")).sortOptions.map(z=>({value:z.name,label:z.displayName}))}async tags(J){return(await C.IB.get("/api/dashboards/tags")).sort((Y,X)=>X.count-Y.count)}async doAPIQuery(J){let z;if(J.deleted){const ce=await T.v.get();z=(0,i.m6)((0,i.Tm)(ce,J))}else z=await C.IB.get("/api/search",J);const Y=[],X=[],Q=[],q=[],te=[],ne=[],se=[],ue=[],de=[];let ie;for(let ce of z){const Pe=ce.type==="dash-folder"?"folder":"dashboard";Y.push(Pe),X.push(ce.title),Q.push(ce.uid),q.push(ce.url),te.push(ce.tags),se.push(ce.sortMeta),ue.push(ce.isDeleted??!1),de.push(ce.permanentlyDeleteDate?new Date(ce.permanentlyDeleteDate):void 0);let Ie=ce.folderUid;!Ie&&Pe==="dashboard"&&(Ie=P.TF),ne.push(Ie),ce.sortMetaName?.length&&(ie=ce.sortMetaName),ce.folderUid&&ce.folderTitle?this.locationInfo[ce.folderUid]={kind:"folder",name:ce.folderTitle,url:ce.folderUrl,folderUid:ce.folderUid}:Pe==="folder"&&(this.locationInfo[ce.uid]={kind:Pe,name:ce.title,url:ce.url,folderUid:ce.folderUid})}const he={fields:[{name:"kind",type:D.PU.string,config:{},values:Y},{name:"name",type:D.PU.string,config:{},values:X},{name:"uid",type:D.PU.string,config:{},values:Q},{name:"url",type:D.PU.string,config:{},values:q},{name:"tags",type:D.PU.other,config:{},values:te},{name:"location",type:D.PU.string,config:{},values:ne},{name:"isDeleted",type:D.PU.boolean,config:{},values:ue},{name:"permanentlyDeleteDate",type:D.PU.time,config:{},values:de}],length:X.length,meta:{custom:{count:X.length,max_score:1,locationInfo:this.locationInfo}}};ie?.length&&se.length&&(he.meta.custom.sortBy=ie,he.fields.push({name:ie,type:D.PU.number,config:{},values:se}));for(const ce of he.fields)ce.display=(0,l.J)({field:ce,theme:n.$.theme2});const me=new a.R(he);return{totalRows:he.length,view:me,loadMoreItems:async(ce,Pe)=>{},isItemLoaded:ce=>!0}}}var I=e(2543),j=e(85618),W=e(77197);const B="Loading",w=`${(0,j.TP)("dashboard.grafana.app","v0alpha1")}/search`,N="name_sort";class M{constructor(J){this.fallbackSearcher=J,this.locationInfo=K()}async search(J){if(J.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(J)}async starred(J){if(J.facet?.length)throw new Error("facets not supported!");const z=await(0,d.AI)().get("api/user/stars");return z?.length?this.doSearchQuery({...J,name:z,query:J.query??"*"}):U()}async tags(J){const z=J.query??"*";let Y=`${w}?facet=tags&query=${z}&limit=1`;return(await(0,d.AI)().get(Y)).facets?.tags?.terms||[]}getSortOptions(){const J=[{value:N,label:(0,o.t)("search.unified-searcher.opts.label.alphabetically-az","Alphabetically (A-Z)")},{value:"-name_sort",label:(0,o.t)("search.unified-searcher.opts.label.alphabetically-za","Alphabetically (Z-A)")}];if(n.$.licenseInfo.enabledFeatures.analytics)for(const z of A)J.push({value:`-${z.name}`,label:`${z.display} (most)`}),J.push({value:`${z.name}`,label:`${z.display} (least)`});return Promise.resolve(J)}async doSearchQuery(J){const z=await this.newRequest(J);let Y;if(J.deleted){const de=await T.v.get(),ie=(0,i.Tm)(de,J);Y={hits:ie,totalHits:ie.length}}else Y=await this.fetchResponse(z);const X=V(Y,J.sort??"");if(X.name===B)return this.fallbackSearcher.search(J);const Q=X.meta?.custom,q={count:Q?.count??X.length,max_score:Q?.max_score??1,locationInfo:Q?.locationInfo??{},sortBy:Q?.sortBy};if(q.locationInfo=await this.locationInfo,X.meta&&(X.meta.custom=q),q.sortBy?.length){const de=X.fields.find(ie=>ie.name===q.sortBy);if(de){const ie=F(de.name);q.sortBy=ie,de.name=ie}}let te=0,ne;const se=async()=>{for(;te>ue.dataFrame.length;){const de=ue.dataFrame.length;if(de>=q.count)return;const ie=`${z}&offset=${de}`,he=await this.fetchResponse(ie),me=V(he,J.sort??"");if(!me){console.log("no results",me);return}if(me.fields.length!==ue.dataFrame.fields.length){console.log("invalid shape",me,ue.dataFrame);return}const ce=me.length+ue.dataFrame.length;me.fields.forEach(Ie=>{const Se=ue.dataFrame.fields.find(Me=>Me.name===Ie.name);Se&&Se.values.push(...Ie.values)}),ue.dataFrame.length=ce;const Pe=me.meta?.custom;if(Pe?.locationInfo&&q){const Ie=Pe.locationInfo;Ie&&typeof Ie=="object"&&Object.assign(q.locationInfo,Ie)}}ne=void 0},ue=new a.R(X);return{totalRows:q.count??X.length,view:ue,loadMoreItems:async(de,ie)=>(te=Math.max(te,ie),ne||(ne=se()),ne),isItemLoaded:de=>de<ue.dataFrame.length}}async fetchResponse(J){const z=await(0,d.AI)().get(J);if(!await this.isFolderCacheStale(z.hits)||(this.locationInfo=K(),!await this.isFolderCacheStale(z.hits)))return z;const Q=await this.locationInfo,q=z.hits.map(ne=>ne.folder===void 0?{...ne,location:"general",folder:"general"}:Q[ne.folder]===void 0?{...ne,location:"sharedwithme",folder:"sharedwithme"}:ne),te=z.totalHits-(z.hits.length-q.length);return{...z,hits:q,totalHits:te}}async isFolderCacheStale(J){const z=await this.locationInfo;return J.some(Y=>Y.folder!==void 0&&z[Y.folder]===void 0)}async newRequest(J){J=await(0,i.u4)(J);let z=w;if(z+=`?query=${encodeURIComponent(J.query??"*")}`,z+=`&limit=${J.limit??L}`,(0,I.isEmpty)(J.location)||(z+=`&folder=${J.location}`),J.kind&&(z+="&"+J.kind.map(Y=>`type=${Y}`).join("&")),J.tags?.length&&(z+="&"+J.tags.map(Y=>`tag=${encodeURIComponent(Y)}`).join("&")),J.sort){const Y=J.sort.replace("_sort","").replace("name","title");z+=`&sort=${Y}`;const X=Y.startsWith("-")?Y.substring(1):Y;z+=`&field=${X}`}return J.name?.length&&(z+="&"+J.name.map(Y=>`name=${encodeURIComponent(Y)}`).join("&")),J.uid?.length&&(z+="&"+J.uid.map(Y=>`name=${encodeURIComponent(Y)}`).join("&")),J.deleted&&(z=`${(0,j.TP)("dashboard.grafana.app","v1beta1")}/dashboards/?labelSelector=grafana.app/get-trash=true`),z}getFolderViewSort(){return"name_sort"}}const L=50,A=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}];function U(){return{view:new a.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(k,J)=>{},isItemLoaded:k=>!0}}function F(k){for(const J of A)if(J.name===k)return J.display;return k}function V(k,J){const z=k.hits;if(z.length<1)return{fields:[],length:0};const Y=z.map(Q=>{let q=Q.folder;Q.resource==="dashboards"&&(0,I.isEmpty)(q)&&(q="general");const te=Object.fromEntries(Object.entries(Q.field??{}).map(([ne,se])=>[ne,se??"-"]));return{...Q,uid:Q.name,url:G(Q.resource,Q.name,Q.title),tags:Q.tags||[],folder:Q.folder||"general",location:q,name:Q.title,kind:Q.resource.substring(0,Q.resource.length-1),...te}}),X=(0,s.Vc)(Y);X.meta={custom:{count:k.totalHits,max_score:1}},J&&X.meta.custom&&(X.meta.custom.sortBy=J.startsWith("-")?J.substring(1):J);for(const Q of X.fields)Q.display=(0,l.J)({field:Q,theme:n.$.theme2});return X}async function K(){const k=`${w}?type=folders`;return(0,d.AI)().get(k).then(z=>{const Y={general:{kind:"folder",name:"Dashboards",url:"/dashboards"},sharedwithme:{kind:"sharedwithme",name:"Shared with me",url:""}};for(const X of z.hits)Y[X.name]={name:X.title,kind:"folder",url:G("folders",X.name,X.title)};return Y})}function G(k,J,z){if(k==="folders")return`/dashboards/f/${J}`;const Y=W.A.slugifyForUrl(z);return`/d/${J}/${Y}`}let H;function _(){if(!H){const k=new O,J=n.$.featureToggles.panelTitleSearch;if(H=J?new h(k):k,J&&window.location.search.includes("do-frontend-query"))return new b(H);H=n.$.featureToggles.unifiedStorageSearchUI?new M(k):k}return H}},93854:(Z,R,e)=>{"use strict";e.d(R,{A5:()=>y,TM:()=>m,Tm:()=>x,cu:()=>p,hI:()=>g,m6:()=>v,u4:()=>d});var n=e(99885),a=e(62963),s=e(22429),l=e(75735),o=e(83458);async function d(f){return f.query&&f.query.indexOf("folder:current")>=0&&(f={...f,location:await i(),query:f.query.replace("folder:current","").trim()},f.query?.length||(f.query="*")),Promise.resolve(f)}async function i(){try{let f=(0,s.UA)().getCurrent();return f||(await c(500),f=(0,s.UA)().getCurrent()),Promise.resolve(f?.meta?.folderUid)}catch(f){console.error(f)}}function c(f){return new Promise(u=>setTimeout(u,f))}function m(f,u){return f==="dashboard"?"apps":f==="folder"?u?"folder-open":"folder":f==="sharedwithme"?"users-alt":"question-circle"}function p(f,u){return f&&(0,a.I2)(f.uid)?"users-alt":m(f.kind,u)}function h(f){switch(f){case"dashboard":case"folder":case"panel":return f;default:return"dashboard"}}function r(f){return f!==null&&typeof f=="object"&&"locationInfo"in f}function g(f,u){const b=u?.dataFrame.meta?.custom,E=r(b)?b:void 0,D={kind:h(f.kind),uid:f.uid,title:f.name,url:f.url,tags:f.tags??[],managedBy:f.managedBy},C=E?.sortBy;if(C){const P=f[C];(typeof P=="string"||typeof P=="number")&&(D.sortMetaName=C,D.sortMeta=P)}if(f.location){const P=f.location.split("/"),T=P[P.length-1],O=E?.locationInfo[T];O&&(D.parentTitle=O.name,D.parentKind=O.kind,D.parentUID=T)}return D}function y(f){return f.items.map(u=>{const b={resource:"dashboards",name:u.metadata.name,title:u.spec?.title,location:"general",folder:u?.metadata?.annotations?.[l.ew]??"general",tags:u.spec?.tags||[],field:{},url:""};return b.folder?b:{...b,location:"general",folder:"general"}})}function v(f){return f.map(u=>{const b={type:u.resource==="folders"?o.G.DashFolder:o.G.DashDB,title:u.title,uid:u.name,url:u.url,tags:u.tags||[],isDeleted:!0,sortMeta:0};return u.folder&&u.folder!=="general"&&(b.folderUid=u.folder),b})}function x(f,u){let b=f;if(u.query&&u.query.trim()!==""&&u.query!=="*"||u.tag&&u.tag.length>0){const E=u.query||u.tag?.join(",")||"",D=f.map(P=>`${P.title},${P.tags.join(",")}`);b=(0,n.X)(D,E).map(P=>f[P])}if(u.sort){const E=new Intl.Collator,D=u.sort==="alpha-desc"?-1:1;b.sort((C,P)=>D*E.compare(C.title,P.title))}return b}},83458:(Z,R,e)=>{"use strict";e.d(R,{G:()=>n,P:()=>a});var n=(s=>(s.DashDB="dash-db",s.DashHome="dash-home",s.DashFolder="dash-folder",s))(n||{}),a=(s=>(s.List="list",s.Folders="folders",s))(a||{})},35886:(Z,R,e)=>{"use strict";e.d(R,{N1:()=>o,W1:()=>s});var n=e(99090);const a=d=>d?!!(d.query||d.tag?.length>0||d.starred||d.sort):!1,s=()=>{const d=n.G3+".";for(let i=0;i<window.localStorage.length;i++){const c=window.localStorage.key(i);c?.startsWith(d)&&window.localStorage.removeItem(c)}},l=(d="General")=>`${SECTION_STORAGE_KEY}.${d.toLowerCase()}`,o=d=>{const i=Object.entries(d).reduce((c,[m,p])=>{if(p){if(m==="tag"&&!Array.isArray(p))return{...c,tag:[p]}}else return c;return{...c,[m]:p}},{});if(d.folder){const c=`folder:${d.folder}`;return{...i,query:`${c} ${(i.query??"").replace(c,"")}`}}return{...i}}},91259:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>C,EC:()=>b,FW:()=>v,G3:()=>c,L5:()=>D,QM:()=>d,Yh:()=>x,aD:()=>m,c3:()=>E,ch:()=>i,dJ:()=>p,ew:()=>u,jE:()=>h,zh:()=>f});var n=e(65307),a=e(92654);const s={serviceAccount:{},isLoading:!0,tokens:[]},l=(0,n.Z0)({name:"serviceaccount",initialState:s,reducers:{serviceAccountFetchBegin:P=>({...P,isLoading:!0}),serviceAccountFetchEnd:P=>({...P,isLoading:!1}),serviceAccountLoaded:(P,T)=>({...P,serviceAccount:T.payload,isLoading:!1}),serviceAccountTokensLoaded:(P,T)=>({...P,tokens:T.payload,isLoading:!1}),rolesFetchBegin:P=>({...P,rolesLoading:!0}),rolesFetchEnd:P=>({...P,rolesLoading:!1})}}),o=l.reducer,{serviceAccountLoaded:d,serviceAccountTokensLoaded:i,serviceAccountFetchBegin:c,serviceAccountFetchEnd:m,rolesFetchBegin:p,rolesFetchEnd:h}=l.actions,r={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:a.i.All},g=(0,n.Z0)({name:"serviceaccounts",initialState:r,reducers:{serviceAccountsFetched:(P,T)=>{const{totalCount:O,perPage:I,...j}=T.payload,W=Math.ceil(O/I);return{...P,...j,totalPages:W,perPage:I,showPaging:W>1,isLoading:!1}},serviceAccountsFetchBegin:P=>({...P,isLoading:!0}),serviceAccountsFetchEnd:P=>({...P,isLoading:!1}),acOptionsLoaded:(P,T)=>({...P,roleOptions:T.payload}),queryChanged:(P,T)=>({...P,query:T.payload,page:0}),pageChanged:(P,T)=>({...P,page:T.payload}),stateFilterChanged:(P,T)=>({...P,serviceAccountStateFilter:T.payload})}}),y=g.reducer,{serviceAccountsFetchBegin:v,serviceAccountsFetchEnd:x,serviceAccountsFetched:f,acOptionsLoaded:u,pageChanged:b,stateFilterChanged:E,queryChanged:D}=g.actions,C={serviceAccountProfile:o,serviceAccounts:y}},69807:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>g,NV:()=>h,Y1:()=>c,j7:()=>i,kH:()=>d,pB:()=>p,s7:()=>m,sF:()=>o,sJ:()=>l});var n=e(65307);const a={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},s=(0,n.Z0)({name:"supportBundles",initialState:a,reducers:{supportBundlesLoaded:(y,v)=>({...y,supportBundles:v.payload,isLoading:!1}),fetchBegin:y=>({...y,isLoading:!0}),fetchEnd:y=>({...y,isLoading:!1}),collectorsFetchBegin:y=>({...y,createBundlePageLoading:!0}),collectorsFetchEnd:y=>({...y,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(y,v)=>({...y,supportBundleCollectors:v.payload,createBundlePageLoading:!1}),setLoadBundleError:(y,v)=>({...y,loadBundlesError:v.payload,supportBundleCollectors:[]}),setCreateBundleError:(y,v)=>({...y,createBundleError:v.payload})}}),{supportBundlesLoaded:l,fetchBegin:o,fetchEnd:d,supportBundleCollectorsLoaded:i,collectorsFetchBegin:c,collectorsFetchEnd:m,setLoadBundleError:p,setCreateBundleError:h}=s.actions,g={supportBundles:s.reducer}},27104:(Z,R,e)=>{"use strict";e.d(R,{$T:()=>g,$u:()=>i,Ay:()=>u,EC:()=>d,L5:()=>o,Q9:()=>l,dJ:()=>c,jE:()=>m,tC:()=>y});var n=e(65307);const a={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},s=(0,n.Z0)({name:"teams",initialState:a,reducers:{teamsLoaded:(b,E)=>{const{totalCount:D,perPage:C,...P}=E.payload,T=Math.ceil(D/C);return{...b,...P,totalPages:T,perPage:C,hasFetched:!0}},queryChanged:(b,E)=>({...b,page:1,query:E.payload}),pageChanged:(b,E)=>({...b,page:E.payload}),sortChanged:(b,E)=>({...b,sort:E.payload,page:1}),rolesFetchBegin:b=>({...b,rolesLoading:!0}),rolesFetchEnd:b=>({...b,rolesLoading:!1})}}),{teamsLoaded:l,queryChanged:o,pageChanged:d,sortChanged:i,rolesFetchBegin:c,rolesFetchEnd:m}=s.actions,p=s.reducer,h={team:{},members:[],groups:[],searchMemberQuery:""},r=(0,n.Z0)({name:"team",initialState:h,reducers:{teamLoaded:(b,E)=>({...b,team:E.payload}),teamMembersLoaded:(b,E)=>({...b,members:E.payload}),setSearchMemberQuery:(b,E)=>({...b,searchMemberQuery:E.payload}),teamGroupsLoaded:(b,E)=>({...b,groups:E.payload})}}),{teamLoaded:g,teamGroupsLoaded:y,teamMembersLoaded:v,setSearchMemberQuery:x}=r.actions,f=r.reducer,u={teams:p,team:f}},59373:(Z,R,e)=>{"use strict";e.d(R,{w:()=>X});var n=e(2543),a=e(37615),s=e(78282),l=e(2863),o=e(36674),d=e(739),i=e(13241),c=e(54742),m=e(8921),p=e(67933),h=e(93612),r=e(99305);let g={};function y(Q){const q=g[Q];return q||(g[Q]=(0,n.property)(Q))}class v{constructor(q,te,ne){this.state={name:q.name,value:te,text:ne,type:q.type}}getValue(q){let{value:te}=this.state;return te==="string"||te==="number"||te==="boolean"?te:String(te)}getValueText(){const{value:q,text:te}=this.state;return typeof te=="string"?q===m.To?m.Zm:te:Array.isArray(te)?te.join(" + "):(console.log("value",te),String(te))}}let x;function f(Q,q,te){return x?(x.state.name=Q.name,x.state.type=Q.type,x.state.value=q,x.state.text=te):x=new v(Q,q,te),x}function u(Q,q,te,ne){if(te=te||{},Q==null||(0,p.EW)(te)&&q!==d.$m.QueryParam)return"";if(!Array.isArray(Q)&&typeof Q=="object"&&(Q=`${Q}`),typeof q=="function")return q(Q,te,u);q||(q=d.$m.Glob);let se=q.split(":");se.length>1?(q=se[0],se=se.slice(1)):se=[];let ue=o.vz.getIfExists(q);ue||(console.error(`Variable format ${q} not found. Using glob format as fallback.`),ue=o.vz.get(d.$m.Glob));const de=f(te,Q,ne??Q);return ue.formatter(Q,se,de)}var b=e(84743),E=e.n(b),D=e(38036),C=e(83175),P=e(60188),T=e(75421),O=e(66223),I=e(55386),j=e(95004),W=e(7102),B=e(11576),S=e(16515),w=e(71642);function N(Q,q,te){return new Proxy({},{get:(ne,se)=>{if(se==="name")return Q.name;if(se==="displayName")return(0,S.Ct)(Q,q,te);if(se==="labels"||se==="formattedLabels")return Q.labels?{...Q.labels,__values:Object.values(Q.labels).sort().join(", "),toString:()=>(0,w.h6)(Q.labels,"",!0)}:""}})}function M(Q,q,te,ne){const se=L(Q,q,te);return u(se,ne)}function L(Q,q,te){const ne=te?.__dataContext;if(!ne)return Q;const{frame:se,rowIndex:ue,field:de,calculatedValue:ie}=ne.value;if(ie)switch(q){case"numeric":return ie.numeric.toString();case"raw":return ie.numeric;case"time":return"";case"text":default:return(0,I.cN)(ie)}if(ue===void 0)return Q;if(q==="time"){const Pe=se.fields.find(Ie=>Ie.type===j.PU.time);return Pe?Pe.values[ue]:void 0}const he=de.values[ue];if(q==="raw")return he;const ce=(de.display??F())(he);switch(q){case"numeric":return ce.numeric;case"text":return ce.text;default:return(0,I.cN)(ce)}}function A(Q,q,te,ne){const se=te?.__dataContext;if(!se||!q)return Q;const{frame:ue,rowIndex:de}=se.value;if(de===void 0||q===void 0)return Q;const ie={name:ue.name,refId:ue.refId,fields:(0,W.F)({frame:ue,rowIndex:de})},he=y(q)(ie)??"";return u(he,ne)}let U;function F(){return U||(U=(0,B.J)()),U}function V(Q,q,te,ne){const se=te?.__dataContext;if(!se||q!=="name")return Q;const{frame:ue,frameIndex:de}=se.value,ie=(0,S.Ri)(ue,de);return u(ie,ne)}function K(Q,q,te,ne){const se=te?.__dataContext;if(!se||q===void 0||q==="")return Q;const{frame:ue,field:de,data:ie}=se.value,he=N(de,ue,ie),me=y(q)(he)??"";return u(me,ne)}const G={__value:M,__data:A,__series:V,__field:K,[D.c.includeVars]:H,[D.c.keepTime]:_,__timezone:k};function H(Q,q,te){const ne=(0,O.z)(te);return C.kM.toUrlParams(ne)}function _(){return C.kM.toUrlParams((0,T.jG)().timeRangeForUrl())}function k(){const Q=(0,P.O)({timeZone:(0,T.jG)().timeModel?.getTimezone()});return Q==="browser"?E().tz.guess():Q}const J={getFilteredVariables:h.bZ,getVariables:h.UN,getVariableWithName:h._2};class z{constructor(q=J){this.dependencies=q,this.regex=r.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(q,te){this._variables=q,this._timeRange=te,this.updateIndex()}get variables(){return(0,a.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,i.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?o.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const q=te=>te||te==="";if(this.index=this._variables.reduce((te,ne)=>(ne.current&&(ne.current.isNone||q(ne.current.value))&&(te[ne.name]=ne),te),{}),this.timeRange){const te=this.timeRange.from.valueOf().toString(),ne=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:te,text:te}},__to:{current:{value:ne,text:ne}}}}}updateTimeRange(q){this._timeRange=q,this.updateIndex()}variableInitialized(q){this.index[q.name]=q}getAdhocFilters(q,te){let ne=[],se=(0,s.l)().getInstanceSettings(q);if(!se)return[];!te&&!this._adhocFiltersDeprecationWarningLogged.get(se.type)&&((0,a.l)(`DataSource ${se.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(se.type,!0));for(const ue of this.getAdHocVariables()){const de=ue.datasource?.uid;(de===se.uid||de?.indexOf("$")===0&&this.replace(de)===se.uid)&&(ne=ne.concat(ue.filters))}return ne}setGrafanaVariable(q,te){this.grafanaVariables.set(q,te)}setGlobalVariable(q,te){(0,a.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[q]:{current:te}}}getVariableName(q){this.regex.lastIndex=0;const te=this.regex.exec(q);return te?te.slice(1).find(se=>se!==void 0):null}containsTemplate(q){if(!q)return!1;if(window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive)return this.regex.lastIndex=0,!!this.regex.exec(q);const te=this.getVariableName(q),ne=te&&this.getVariableAtIndex(te);return ne!=null}variableExists(q){return(0,a.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(q)}highlightVariablesAsHtml(q){return!q||!(0,n.isString)(q)?q:(q=(0,n.escape)(q),this._replaceWithVariableRegex(q,void 0,(te,ne)=>this.getVariableAtIndex(ne)?'<span class="template-variable">'+te+"</span>":te))}getAllValue(q){if(q.allValue)return q.allValue;const te=[];for(let ne=1;ne<q.options.length;ne++)te.push(q.options[ne].value);return te}getVariableValue(q,te){return te?y(te)(q.value):q.value}getVariableText(q,te){return q.value===te||typeof te!="string"?q.text:te}replace(q,te,ne,se){if(te&&te.__sceneObject){const ue=te.__sceneObject.value.valueOf();return o.jh.interpolate(ue,q,te,ne,se)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?o.jh.interpolate(window.__grafanaSceneContext,q,te,ne,se):q?(this.regex.lastIndex=0,this._replaceWithVariableRegex(q,ne,(ue,de,ie,he)=>{const me=this._evaluateVariableExpression(ue,de,ie,he,te);return se&&se.push({match:ue,variableName:de,fieldPath:ie,format:he,value:me,found:me!==ue}),me})):q??""}_evaluateVariableExpression(q,te,ne,se,ue){const de=this.getVariableAtIndex(te),ie=ue?.[te];if(ie){const Pe=this.getVariableValue(ie,ne),Ie=this.getVariableText(ie,Pe);if(Pe!=null)return u(Pe,se,de,Ie)}if(!de){const Pe=G[te];return Pe?Pe(q,ne,ue,se):q}if(se===d.$m.QueryParam||(0,p.EW)(de)){const Pe=c.B.get(de.type).getValueForUrl(de),Ie=(0,p.EW)(de)?de.id:de.current.text;return u(Pe,se,de,Ie)}const he=this.grafanaVariables.get(de.current.value);if(he)return u(he,se,de);let me=de.current.value,ce=de.current.text;if(this.isAllValue(me)&&(me=this.getAllValue(de),ce=m.Zm,de.allValue&&se!==d.$m.Text&&se!==d.$m.PercentEncode))return this.replace(me);if(ne){const Pe=this.getVariableValue({value:me,text:ce},ne);if(Pe!=null)return u(Pe,se,de,ce)}return u(me,se,de,ce)}_replaceWithVariableRegex(q,te,ne){return this.regex.lastIndex=0,q.replace(this.regex,(se,ue,de,ie,he,me,ce)=>ne(se,ue||de||he,me,ie||ce||te))}isAllValue(q){return q===m.To||Array.isArray(q)&&q[0]===m.To}replaceWithText(q,te){return(0,a.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(q,te,"text")}getVariableAtIndex(q){if(q)return this.index[q]?this.index[q]:this.dependencies.getVariableWithName(q)}getAdHocVariables(){return this.dependencies.getFilteredVariables(p.EW)}}const Y=new z;(0,l.d)(Y);const X=()=>Y},13572:(Z,R,e)=>{"use strict";e.d(R,{J:()=>y});var n=e(92745),a=e(739),s=e(44017),l=e(74848),o=e(96540),d=e(79609),i=e(2863),c=e(32881),m=e(77824),p=e(17200),h=e(72598),r=e(16553);const g=({value:v,onChange:x,item:f})=>{const[u,b]=(0,o.useState)(!1),E=(0,o.useRef)(0),D=[{label:(0,n.t)("transformers.axis-editor.mode-options.label.size","Size"),value:a.J1.Size,description:(0,n.t)("transformers.axis-editor.mode-options.description.split-the-buckets-based-on-size","Split the buckets based on size")},{label:(0,n.t)("transformers.axis-editor.mode-options.label.count","Count"),value:a.J1.Count,description:(0,n.t)("transformers.axis-editor.mode-options.description.split-the-buckets-based-on-count","Split the buckets based on count")}],C=[{label:(0,n.t)("transformers.axis-editor.log-mode-options.label.split","Split"),value:a.J1.Size,description:(0,n.t)("transformers.axis-editor.log-mode-options.description.split-the-buckets-based-on-size","Split the buckets based on size")}],P=f.settings?.allowInterval??!1,T=({mode:j,scale:W,value:B=""})=>{let S=!0;j!==a.J1.Count&&(P?B!==""&&(0,r.Fv)(B)===void 0&&(S=!1):S=(0,h.N_)(B)),b(!S),x({mode:j,scale:W,value:B})},I=(0,i.w)().getVariables().map(j=>({value:j.name,label:j.label||j.name,origin:d.$0.Template}));return(0,l.jsxs)(c.Gy,{children:[(0,l.jsx)(m.z,{value:v?.mode||a.J1.Size,options:v?.scale?.type===a.L4.Log?C:D,onChange:j=>{E.current++,T({...v,value:"",mode:j})}}),(0,l.jsx)(p.y,{invalid:u,error:"Value needs to be an integer or a variable",value:v?.value??"",placeholder:(0,n.t)("transformers.axis-editor.placeholder-auto","Auto"),onChange:j=>{T({...v,value:j})},suggestions:I},E.current)]})};function y(v,x,f,u){x.addCustomEditor({id:"xBuckets",path:`${v}xBuckets`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-x-bucket","X Bucket"),editor:g,category:u,defaultValue:{mode:a.J1.Size},settings:{allowInterval:!0}}),x.addCustomEditor({id:"yBuckets",path:`${v}yBuckets`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-y-bucket","Y Bucket"),editor:g,category:u,defaultValue:{mode:a.J1.Size}}),x.addCustomEditor({id:"yBuckets-scale",path:`${v}yBuckets.scale`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-y-bucket-scale","Y Bucket scale"),category:u,editor:s.W1,defaultValue:{type:a.L4.Linear}})}},48264:(Z,R,e)=>{"use strict";e.d(R,{Nb:()=>x,VQ:()=>b,eE:()=>v,wY:()=>r,yJ:()=>f});var n=e(81160),a=e(64761),s=e(79319),l=e(95004),o=e(16515),d=e(55386),i=e(39443),c=e(74261),m=e(8721),p=e(739),h=e(16553);const r={id:a.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:P=>{const{xField:T,yField:O,xs:I,ys:j}=E(P);return T||O||!I.length||!j.length?s.M.NotPossible:s.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(P,T)=>O=>O.pipe((0,n.T)(I=>r.transformer(P,T)(I))),transformer:P=>T=>{const O=b(T,P);return P.keepOriginalData?[O,...T]:[O]}};function g(P){return P==="+Inf"?1/0:P==="-Inf"?-1/0:+(P??0)}function y(P,T){return g(P)-g(T)}function v(P){return P?.meta?.custom??{}}function x(P){let T=!1;for(let O of P.fields)switch(O.name){case"y":case"yMin":case"yMax":if(T)return!1;T=!0}return T}function f(P){const T=P.frame.fields[0],O=T.values,I=P.frame.fields.filter((U,F)=>U.type===l.PU.number&&F>0),j=O.length*I.length,W=new Array(j),B=new Array(j),S=new Array(j),w=I.map(U=>U.values.slice());w.forEach((U,F)=>{for(let V=0;V<U.length;V++)S[w.length*V+F]=U[V]});const N=Array.from({length:I.length},(U,F)=>F);for(let U=0,F=0,V=0;U<j;F=++U%N.length)B[U]=N[F],F===0&&U>=N.length&&V++,W[U]=O[V];let M=I[0].labels?.le!=null?"yMax":"y";switch(P.layout){case p.D7.le:M="yMax";break;case p.D7.ge:M="yMin";break;case p.D7.unknown:M="y";break}const L={yOrdinalDisplay:I.map(U=>(0,o.Ct)(U,P.frame)),yMatchWithLabel:Object.keys(I[0].labels??{})[0]};if(L.yMatchWithLabel&&(L.yOrdinalLabel=I.map(U=>U.labels?.[L.yMatchWithLabel]??""),L.yMatchWithLabel==="le"&&(L.yMinDisplay="0.0")),P.unit?.length||P.decimals!=null){const U=(0,d.j_)(P.unit??"short");L.yMinDisplay&&(L.yMinDisplay=(0,d.cN)(U(0,P.decimals))),L.yOrdinalDisplay=L.yOrdinalDisplay.map(F=>{let V=+F;return Number.isNaN(V)?F:(0,d.cN)(U(V,P.decimals))})}const A={...I[0].config};return A.displayNameFromDS&&delete A.displayNameFromDS,{length:W.length,refId:P.frame.refId,meta:{type:i.m.HeatmapCells,custom:L},fields:[{name:T.type===l.PU.time?"xMax":"x",type:T.type,values:W,config:T.config},{name:M,type:l.PU.number,values:B,config:{unit:"short"}},{name:P.value?.length?P.value:"Value",type:l.PU.number,values:S,config:A,display:I[0].display}]}}function u(P){P=P.slice(),P.sort((O,I)=>y(O.name,I.name));const T=P.map(O=>O.fields[1].values.slice());return T.reverse(),T.forEach((O,I)=>{if(I<T.length-1)for(let j=0;j<O.length;j++)O[j]-=T[I+1][j]}),T.reverse(),P.map((O,I)=>({...O,fields:[O.fields[0],{...O.fields[1],values:T[I]}]}))}function b(P,T){const{xField:O,yField:I,xs:j,ys:W}=E(P);if(!O||!I)throw"no heatmap fields found";if(!j.length||!W.length)throw"no values found";const B=T.xBuckets??{},S=T.yBuckets??{};if(B.scale?.type===p.L4.Log)throw"X axis only supports linear buckets";const w=T.yBuckets?.scale??{type:p.L4.Linear},N=D(j,W,{xSorted:(0,m.g2)(j),xTime:O.type===l.PU.time,xMode:B.mode,xSize:B.mode===p.J1.Size?(0,h.Fv)(B.value??""):B.value?+B.value:void 0,yMode:S.mode,ySize:S.value?+S.value:void 0,yLog:w?.type===p.L4.Log?w?.log:void 0,xMin:T.timeRange?.from.valueOf(),xMax:T.timeRange?.to.valueOf()});return{length:N.x.length,name:(0,o.Ct)(I),meta:{type:i.m.HeatmapCells},fields:[{name:"xMin",type:O.type,values:N.x,config:O.config},{name:"yMin",type:l.PU.number,values:N.y,config:{...I.config,custom:{scaleDistribution:w}}},{name:"Count",type:l.PU.number,values:N.count,config:{unit:"short"}}]}}function E(P){let T,O,I=0;for(let S of P)S.fields.find(N=>N.type===l.PU.time)&&(I+=S.length);let j=Array(I),W=Array(I),B=0;for(let S of P){const w=S.fields.find(M=>M.type===l.PU.time);if(!w)continue;T||(T=w);const N=w.values;for(let M of S.fields)if(M!==w&&M.type===l.PU.number){const L=M.values;for(let A=0;A<N.length;A++,B++)j[B]=N[A],W[B]=L[A];O||(O=M)}}return{xField:T,yField:O,xs:j,ys:W}}function D(P,T,O){let I=P.length,j=O?.xSorted??!1,W=O?.ySorted??!1,B=O?.xMin??(j?P[0]:1/0),S=W?T[0]:1/0,w=O?.xMax??(j?P[I-1]:-1/0),N=W?T[I-1]:-1/0,M=O?.yLog,L=O?.xMin!=null&&O?.xMax!=null,A=O?.yMin!=null&&O?.yMax!=null;for(let ne=0;ne<I;ne++)!j&&!L&&(B=Math.min(B,P[ne]),w=Math.max(w,P[ne])),!W&&!A&&(!M||T[ne]>0)&&(S=Math.min(S,T[ne]),N=Math.max(N,T[ne]));let U=O?.xSize??0,F=O?.ySize??0,V=O?.xMode,K=O?.yMode;if((!Number.isFinite(U)||U<=0)&&(V=p.J1.Count,U=20),(!Number.isFinite(F)||F<=0)&&(K=p.J1.Count,F=10),V===p.J1.Count){let ne=(w-B)/Math.max(U-1,1),se=O?.xTime?h.q_:h.eO,ue=se.findIndex(de=>de>ne)-1;U=se[Math.max(ue,0)]}if(K===p.J1.Count){let ne=(N-S)/Math.max(F-1,1),se=O?.yTime?h.q_:h.eO,ue=se.findIndex(de=>de>ne)-1;F=se[Math.max(ue,0)]}let G=O?.xCeil?ne=>(0,c.Uh)(ne,U):ne=>(0,c.rs)(ne,U),H=O?.yCeil?ne=>(0,c.Uh)(ne,F):ne=>(0,c.rs)(ne,F);if(M){F=1/(O?.ySize??1);let ne=M===2?Math.log2:Math.log10;H=O?.yCeil?se=>(0,c.Uh)(ne(se),F):se=>(0,c.rs)(ne(se),F)}let _=G(B),k=G(w),J=H(S),z=H(N),Y=Math.round((k-_)/U)+1,X=Math.round((z-J)/F)+1,[Q,q,te]=C(Y,X,_,U,J,F,M);for(let ne=0;ne<I;ne++){if(M&&T[ne]<=0)continue;const se=(G(P[ne])-_)/U,ue=(H(T[ne])-J)/F,de=se*X+ue;te[de]++}return{x:Q,y:q,count:te}}function C(P,T,O,I,j,W,B){const S=P*T,w=new Array(S),N=new Array(S),M=new Array(S);for(let L=0,A=0,U=O;L<S;A=++L%T)M[L]=0,B?N[L]=B**(j+A*W):N[L]=j+A*W,A===0&&L>=T&&(U+=I),w[L]=U;return[w,N,M]}},16553:(Z,R,e)=>{"use strict";e.d(R,{Fv:()=>D,eO:()=>y,q_:()=>E});var n=e(79243),a=e(74529),s=e(72598);const{abs:l,pow:o}=Math,d=new Map;function i(C,P,T,O){let I=[],j=O.map(n.E);for(let W=P;W<T;W++){let B=l(W),S=(0,n.h)(o(C,W),B);for(let w=0;w<O.length;w++){let N=O[w]*S,M=(N>=0&&W>=0?0:B)+(W>=j[w]?0:j[w]),L=(0,n.h)(N,M);I.push(L),d.set(L,M)}}return I}const c=C=>C%1===0,m=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],p=i(10,-16,0,m),h=i(10,0,16,m),r=h.filter(c),g=p.concat(h),y=p.concat(r),v=1*1e3,x=60*v,f=60*x,u=24*f,b=365*u,E=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,v,2*v,4*v,5*v,10*v,15*v,20*v,30*v,x,2*x,4*x,5*x,10*x,15*x,20*x,30*x,f,2*f,4*f,6*f,8*f,12*f,18*f,u,2*u,3*u,4*u,5*u,6*u,7*u,10*u,15*u,30*u,45*u,60*u,90*u,180*u,b,2*b,3*b,4*b,5*b,6*b,7*b,8*b,9*b,10*b],D=C=>{if((0,s.N_)(C)){const T=Number.parseInt(C,10);return Number.isNaN(T)?void 0:T}else{if((0,a.di)(C))return(0,a.WT)((0,a.E9)(C));{const O=C.match(/(\d+)ms$/i);if(O){const I=Number.parseInt(O[1],10);return Number.isNaN(I)?void 0:I}else return}}}},84510:(Z,R,e)=>{"use strict";e.d(R,{$n:()=>s,g_:()=>n,uk:()=>a});var n=(o=>(o.ShortcodeFigure="shortcodeFigure",o.UIImage="uiImage",o))(n||{});const a={calculateField:{name:"Add field from calculation",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
  - **All number fields** - Set the left side of a **Binary operation** to apply the calculation to all number fields.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
> **Note:** If a variable is used in this transformation, the default alias will be interpolated with the value of the variable. If you want an alias to be unaffected by variable changes, explicitly define the alias.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${l("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",o,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.

> **Note:** When you use this transformation for thresholds, the visualization continues to use the panel's base threshold.

  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **RegExp** - Parse content using a regular expression with [named capturing group(s)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group) like \`/(?<NewField>.*)/\`.
  ${l("/media/docs/grafana/panels-visualizations/screenshot-regexp-detail-v11.3-2.png",o,"Example of a regular expression")}
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${l("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",o,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number and time fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included. A time field will pre-populate with variables to filter by selected time.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${l("/static/img/docs/transformations/filter-name-table-before-7-0.png",o,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${l("/static/img/docs/transformations/filter-name-table-after-7-0.png",o,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${l("/static/img/docs/transformations/filter-name-stat-after-7-0.png",o,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(o="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${l("/static/img/docs/transformations/nested-table-select-calculation.png",o,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${l("/static/img/docs/transformations/nested-table-select-stat.png",o,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${l("/static/img/docs/transformations/join-fields-before-7-0.png",o,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${l("/static/img/docs/transformations/join-fields-after-7-0.png",o,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

Using a negative number, you can keep values from the end of the set. Here is the result after adding a Limit transformation with a value of '-3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |


This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Set field order mode** - If the mode is **Manual**, you can change the field order by hovering the cursor over a field and dragging the field to its new position. If it's **Auto**, use the **OFF**, **ASC**, and **DESC** options to order by any labels on the field or by the field name. For any field that is sorted **ASC** or **DESC**, you can drag the option to set the priority of the sorting.
- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

A wide time series combines data into a single frame with one shared, ascending time field. Time fields do not repeat and multiple values extend in separate columns.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

##### Multi-frame time series

Multi-frame time series break data into multiple frames that all contain two fields: a time field and a numeric value field. Time is always ascending. String values are represented as field labels.

##### Long time series

A long time series combines data into one frame, with the first field being an ascending time field. The time field might have duplicates. String values are in separate fields, and there might be more than one. 

**Example: Converting to long format**

| Value1 | Value2 |  Timestamp          |
|--------|--------|---------------------|
| 10     | 20     | 2023-01-03 00:00:00 |
| 30     | 40     | 2023-01-02 00:00:00 |
| 50     | 60     | 2023-01-01 00:00:00 |
| 70     | 80     | 2023-01-01 00:00:00 |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 70     | 80     |
| 2023-01-01 01:00:00 | 50     | 60     |
| 2023-01-02 01:00:00 | 30     | 40     |
| 2023-01-03 01:00:00 | 10     | 20     |

  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${l("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",o,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${l("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",o,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${l("/static/img/docs/transformations/table-sparklines.png",o,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${l("/static/img/docs/transformations/timeseries-table-select-stat.png",o,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${l("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",o,"Before and after transpose transformation")}
  `}},regression:{name:"Trendline",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear** - Fits a linear function to the data.
${l("/static/img/docs/transformations/linear-regression.png",o,"A time series visualization with a straight line representing the linear function")}
- **Polynomial** - Fits a polynomial function to the data.
${l("/static/img/docs/transformations/polynomial-regression.png",o,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation was previously called regression analysis.
  `}}};function s(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function l(o,d,i){return d==="shortcodeFigure"?`{{< figure src="${o}" class="docs-image--no-shadow" max-width= "1100px" alt="${i}" >}}`:`![${i}](https://grafana.com${o})`}},90176:(Z,R,e)=>{"use strict";e.d(R,{YD:()=>l,dy:()=>a,kD:()=>s});var n=e(739),a=(d=>(d.Prepare="prepare",d.Calculate="calculate",d.Modify="modify",d))(a||{}),s=(d=>(d.Heading="heading",d.Distance="distance",d.Area="area",d))(s||{}),l=(d=>(d.AsLine="asLine",d.LineBuilder="lineBuilder",d))(l||{});const o={action:"prepare",source:{mode:n.aG.Auto}}},78089:(Z,R,e)=>{"use strict";e.d(R,{EX:()=>p,pp:()=>r,tt:()=>c});var n=e(70915),a=e(11217),s=e(44294),l=e(22796),o=e(52490),d=e(95004),i=e(90176);function c(g){const y=[];for(const v of g.values)v&&y.push(p(v));return new a.A(y)}function m(g){const y=new Array(g.length);if(g.length>1){let v=h(g[0]);for(let x=1;x<g.length;x++){let f=h(g[x]);if(v&&f){let u=Math.atan2(f[0]-v[0],f[1]-v[1])*180/Math.PI;u<0&&(u+=360),y[x-1]=y[x]=u}}}else y.fill(0);return y}function p(g){return g instanceof s.A?g.getCoordinates():(0,n.q1)(g.getExtent())}function h(g){if(g)return(0,l.WP)(p(g))}function r(g,y){const v=g.values,x=new Array(g.values.length),f=y.calc??i.kD.Heading,u=y.field??f;switch(f){case i.kD.Area:{for(let b=0;b<v.length;b++){const E=v[b];E&&(x[b]=(0,o.UG)(E))}return{name:u,type:d.PU.number,config:{unit:"areaM2"},values:x}}case i.kD.Distance:{for(let b=0;b<v.length;b++){const E=v[b];E&&(x[b]=(0,o.R3)(E))}return{name:u,type:d.PU.number,config:{unit:"lengthm"},values:x}}case i.kD.Heading:default:return{name:u,type:d.PU.number,config:{unit:"degree"},values:m(v)}}}},17200:(Z,R,e)=>{"use strict";e.d(R,{c:()=>x,y:()=>u});var n=e(74848),a=e(22803),s=e(34743),l=e(83505),o=e(46885),d=e(96540),i=e(63142),c=e(15245),m=e(92807),p=e(12594),h=e(63527),r=e(87105),g=e(81563);const y=(E,D)=>E-D*Math.floor(E/D),v=8;var x=(E=>(E.InputElement="input",E.TextAreaElement="textarea",E))(x||{});const f=(E,D)=>({suggestionsWrapper:(0,a.css)({boxShadow:E.shadows.z2}),errorTooltip:(0,a.css)({position:"absolute",top:D+v+"px",zIndex:E.zIndex.tooltip}),inputWrapper:(0,a.css)({position:"relative"})}),u=({value:E="",onChange:D,suggestions:C,placeholder:P,error:T,invalid:O,type:I="input",style:j,autoFocus:W=!1})=>{const[B,S]=(0,d.useState)(!1),[w,N]=(0,d.useState)(0),[M,L]=(0,d.useState)(E.toString()),A=(0,d.useRef)(null),[U,F]=(0,d.useState)(0),[V,K]=(0,d.useState)(0),[G,H]=(0,d.useState)(0),_=(0,i.$j)(),k=f(_,V),J=(0,d.useRef)();(0,d.useEffect)(()=>{A.current?.scrollTo(0,U)},[U]);const z=[(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:Y,floatingStyles:X}=(0,l.we)({open:B,placement:"bottom-start",onOpenChange:S,middleware:z,whileElementsMounted:o.ll,strategy:"fixed"}),Q=(0,d.useCallback)(ie=>{Y.setReference(ie),J.current=ie},[Y]),q=(0,d.useRef)(null);(0,d.useEffect)(()=>{F(b(q.current,w))},[w]);const te=d.useCallback((ie,he=J.current)=>{const me=he.selectionStart,ce=he.value;ce[G-1]==="$"?he.value=ce.slice(0,G)+ie.value+ce.slice(me):he.value=ce.slice(0,G)+`\${${ie.value}}`+ce.slice(me),L(he.value),S(!1),N(0),D(he.value)},[D,G]),ne=d.useCallback(ie=>{if(!B){if(ie.key==="$"||ie.key===" "&&ie.ctrlKey){H(J.current.selectionStart||0),S(!0);return}return}switch(ie.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return S(!1),N(0);case"Enter":return ie.preventDefault(),te(C[w]);case"ArrowDown":case"ArrowUp":ie.preventDefault();const he=ie.key==="ArrowDown"?1:-1;return N(me=>y(me+he,C.length));default:return}},[B,C,w,te]),se=d.useCallback(ie=>{L(ie.currentTarget.value)},[]),ue=d.useCallback(ie=>{D(ie.currentTarget.value)},[D]);(0,d.useEffect)(()=>{K(J.current.clientHeight)},[]);const de={placeholder:P,invalid:O,value:M,onChange:se,onBlur:ue,onKeyDown:ne};return(0,n.jsxs)("div",{className:k.inputWrapper,style:j??{},children:[B&&(0,n.jsx)(c.ZL,{children:(0,n.jsx)("div",{ref:Y.setFloating,style:X,className:k.suggestionsWrapper,children:(0,n.jsx)(m.P,{maxHeight:"300px",onScroll:ie=>F(ie.currentTarget.scrollTop??0),ref:A,children:(0,n.jsx)(g.k,{activeRef:q,suggestions:C,onSuggestionSelect:te,onClose:()=>S(!1),activeIndex:w})})})}),O&&T&&(0,n.jsx)("div",{className:k.errorTooltip,children:(0,n.jsx)(p.P,{children:T})}),I==="input"?(0,n.jsx)(h.p,{...de,ref:Q,autoFocus:W}):(0,n.jsx)(r.f,{...de,ref:Q,autoFocus:W,rows:5})]})};u.displayName="SuggestionsInput";function b(E,D){return(E?.clientHeight??0)*D}},72598:(Z,R,e)=>{"use strict";e.d(R,{I9:()=>y,N_:()=>r,ZI:()=>m,aG:()=>p,eJ:()=>h,gD:()=>c,qt:()=>g});var n=e(96540),a=e(16515),s=e(62717),l=e(79609),o=e(92745),d=e(2863),i=e(99305);const c=(v,x=!1)=>{let f=v.flatMap(u=>u.fields.map(b=>(0,a.Ct)(b,u,v)));if(x){let u=new Map;v.forEach(E=>E.fields.forEach(D=>{let C=u.get(D.name)??0;u.set(D.name,C+1)}));let b=[];u.forEach((E,D)=>{E>1&&b.push(D)}),f=[...new Set(b.concat(f))]}return f};function m(v,x=!1){return(0,n.useMemo)(()=>c(v,x),[v,x])}function p(v){const x=new Set;for(const f of v)for(const u of f.fields)if(u.labels)for(const b of Object.keys(u.labels))x.add(b);return x}const h={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},r=v=>{if(typeof v=="number"||!Number.isNaN(Number(v)))return!0;const x=i.SY.test(v);return i.SY.lastIndex=0,!!x};function g(v){const x=[];v&&(x.push({label:(0,o.t)("transformers.get-timezone-options.label.browser","Browser"),value:"browser"}),x.push({label:(0,o.t)("transformers.get-timezone-options.label.utc","UTC"),value:"utc"}));const f=(0,s.P3)();for(const u of f)x.push({label:u,value:u});return x}function y(){return(0,d.w)().getVariables().map(v=>({value:v.name,label:v.label||v.name,origin:l.$0.Template}))}},1302:(Z,R,e)=>{"use strict";e.d(R,{$u:()=>h,Ay:()=>v,Cj:()=>c,EC:()=>p,Y_:()=>i,dJ:()=>r,g4:()=>m,jE:()=>g,t_:()=>o});var n=e(65307),a=e(65642);const s={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:a.Ay.externalUserMngInfo,externalUserMngLinkName:a.Ay.externalUserMngLinkName,externalUserMngLinkUrl:a.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},l=(0,n.Z0)({name:"users",initialState:s,reducers:{usersLoaded:(x,f)=>{const{totalCount:u,perPage:b,page:E,orgUsers:D}=f.payload,C=Math.ceil(u/b);return{...x,isLoading:!0,users:D,perPage:b,page:E,totalPages:C}},searchQueryChanged:(x,f)=>({...x,searchQuery:f.payload,page:s.page}),setUsersSearchPage:(x,f)=>({...x,page:f.payload}),pageChanged:(x,f)=>({...x,page:f.payload}),sortChanged:(x,f)=>({...x,sort:f.payload}),usersFetchBegin:x=>({...x,isLoading:!0}),usersFetchEnd:x=>({...x,isLoading:!1}),rolesFetchBegin:x=>({...x,rolesLoading:!0}),rolesFetchEnd:x=>({...x,rolesLoading:!1})}}),{searchQueryChanged:o,setUsersSearchPage:d,usersLoaded:i,usersFetchBegin:c,usersFetchEnd:m,pageChanged:p,sortChanged:h,rolesFetchBegin:r,rolesFetchEnd:g}=l.actions,v={users:l.reducer}},79776:(Z,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(43173);function a(s){const l=new URL(n.$.externalUserMngLinkUrl);return n.$.externalUserMngAnalytics&&(n.$.externalUserMngAnalyticsParams&&n.$.externalUserMngAnalyticsParams.split("&").forEach(d=>{const[i,c]=d.split("=");l.searchParams.append(i,c)}),l.searchParams.append("cnt",s)),l.toString()}},54742:(Z,R,e)=>{"use strict";e.d(R,{B:()=>a});var n=e(42954);const a=new n.O},48421:(Z,R,e)=>{"use strict";e.d(R,{$u:()=>y,D4:()=>f,Iv:()=>u,U2:()=>x,VT:()=>v,z_:()=>g});var n=e(2543),a=e.n(n),s=e(28998),l=e(17752),o=e(67933),d=e(39167),i=e(74887),c=e(93612),m=e(88681),p=e(99305),h=e(25206);const r="Filters",g=D=>async(C,P)=>{let T=E(D,P());if(!T&&(C(b(D)),T=E(D,P()),!T))return;const O=T.filters.findIndex(j=>j.key===D.key&&j.value===D.value);if(O===-1){const{value:j,key:W,operator:B}=D,S={value:j,key:W,operator:B};return await C(x((0,p.jX)(T),S))}const I={...T.filters[O],operator:D.operator};return await C(y((0,p.jX)(T),{index:O,filter:I}))},y=(D,C)=>async(P,T)=>{const O=(0,c.dn)(D,T());P((0,i.kb)(D.rootStateKey,(0,h.E2)((0,p.qD)(O,C)))),await P((0,d.us)((0,p.jX)(O),!0))},v=(D,C)=>async(P,T)=>{const O=(0,c.dn)(D,T());P((0,i.kb)(D.rootStateKey,(0,h.D$)((0,p.qD)(O,C)))),await P((0,d.us)((0,p.jX)(O),!0))},x=(D,C)=>async(P,T)=>{const O=(0,c.dn)(D,T());P((0,i.kb)(D.rootStateKey,(0,h.xt)((0,p.qD)(O,C)))),await P((0,d.us)((0,p.jX)(O),!0))},f=(D,C)=>async(P,T)=>{const O=(0,c.dn)(D,T());P((0,i.kb)(D.rootStateKey,(0,h.qZ)((0,p.qD)(O,C)))),await P((0,d.us)((0,p.jX)(O),!0))},u=(D,C)=>async(P,T)=>{const O=(0,c.dn)(D,T());P((0,i.kb)(D.rootStateKey,(0,m.QP)((0,p.qD)(O,{propName:"datasource",propValue:C}))));const j=(await(0,s.tR)().get(C))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";P((0,i.kb)(D.rootStateKey,(0,l.BC)({infoText:j})))},b=D=>(C,P)=>{const T=(0,c.y7)(P()),O={...(0,n.cloneDeep)(h.MK),datasource:D.datasource,name:r,id:r,rootStateKey:T},I=!1,j=(0,c.hk)(T,P()),W={type:"adhoc",id:O.id,rootStateKey:T};C((0,i.kb)(T,(0,m.QV)((0,p.qD)(W,{global:I,model:O,index:j}))))},E=(D,C)=>{const P=(0,c.y7)(C),T=(0,c.nx)(P,C);let O;for(const I of Object.values(T.variables))if((0,o.EW)(I)&&I.datasource?.uid===D.datasource.uid){O=I;break}return O}},25206:(Z,R,e)=>{"use strict";e.d(R,{AA:()=>h,D$:()=>c,E2:()=>m,MK:()=>o,qZ:()=>p,xt:()=>i});var n=e(65307),a=e(88813),s=e(93612),l=e(96120);const o={...a.Vg,type:"adhoc",datasource:null,filters:[]},d=(0,n.Z0)({name:"templating/adhoc",initialState:l.j,reducers:{filterAdded:(r,g)=>{const y=(0,s.Fs)(r,g.payload.id);y.type==="adhoc"&&y.filters.push(g.payload.data)},filterRemoved:(r,g)=>{const y=(0,s.Fs)(r,g.payload.id);if(y.type!=="adhoc")return;const v=g.payload.data;y.filters.splice(v,1)},filterUpdated:(r,g)=>{const y=(0,s.Fs)(r,g.payload.id);if(y.type!=="adhoc")return;const{filter:v,index:x}=g.payload.data;y.filters[x]=v},filtersRestored:(r,g)=>{const y=(0,s.Fs)(r,g.payload.id);y.type==="adhoc"&&(y.filters=g.payload.data)}}}),{filterAdded:i,filterRemoved:c,filterUpdated:m,filtersRestored:p}=d.actions,h=d.reducer},8921:(Z,R,e)=>{"use strict";e.d(R,{Ek:()=>o,To:()=>s,Zm:()=>a,ou:()=>l,qF:()=>n,qz:()=>d});const n="00000000-0000-0000-0000-000000000000",a="All",s="$__all",l="None",o="",d="var-"},56404:(Z,R,e)=>{"use strict";e.d(R,{c:()=>m,z:()=>p});var n=e(74848),a=e(92145),s=e(96540),l=e(51898),o=e(92745),d=e(63142),i=e(87105),c=e(25379);const m="Grafana-LegacyVariableQueryEditor",p=({onChange:h,query:r})=>{const g=(0,d.of)(c.$),[y,v]=(0,s.useState)(r),x=b=>{v(b.currentTarget.value)},f=(0,s.useCallback)(b=>{h(b.currentTarget.value,b.currentTarget.value)},[h]),u=(0,a.Bi)();return(0,n.jsx)(i.f,{id:u,rows:2,value:y,onChange:x,onBlur:f,placeholder:(0,o.t)("variables.legacy-variable-query-editor.placeholder-metric-name-or-tags-query","Metric name or tags query"),required:!0,"data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:g.textarea})};p.displayName=m},38681:(Z,R,e)=>{"use strict";e.d(R,{y:()=>i});var n=e(74848),a=e(96540),s=e(2863),l=e(58666),o=e(67933),d=e(56404);async function i(m,p=l.cS){if((0,o.zs)(m))return m.variables.editor;if((0,o.X3)(m)){const h=await p(m.meta);if(!h.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return h.components.QueryEditor??null}return(0,o.Hf)(m)?c:(0,o.d5)(m)?(await p(m.meta)).components.VariableQueryEditor??d.z:null}function c({datasource:m,query:p,onChange:h}){const r=(0,a.useCallback)(g=>{h({refId:"StandardVariableQuery",query:g})},[h]);return(0,n.jsx)(d.z,{query:p.query,onChange:r,datasource:m,templateSrv:(0,s.w)()})}},17752:(Z,R,e)=>{"use strict";e.d(R,{BC:()=>m,DW:()=>d,Eo:()=>h,FN:()=>o,NY:()=>p,T7:()=>c,nS:()=>a,sJ:()=>i,wf:()=>l,y8:()=>r});var n=e(65307);const a={id:"",isValid:!0,errors:{},name:"",extended:null},s=(0,n.Z0)({name:"templating/editor",initialState:a,reducers:{variableEditorMounted:(g,y)=>{g.name=y.payload.name,g.id=y.payload.id},variableEditorUnMounted:(g,y)=>a,changeVariableNameSucceeded:(g,y)=>{g.name=y.payload.data.newName,delete g.errors.name,g.isValid=Object.keys(g.errors).length===0},changeVariableNameFailed:(g,y)=>{g.name=y.payload.newName,g.errors.name=y.payload.errorText,g.isValid=Object.keys(g.errors).length===0},addVariableEditorError:(g,y)=>{g.errors[y.payload.errorProp]=y.payload.errorText,g.isValid=Object.keys(g.errors).length===0},removeVariableEditorError:(g,y)=>{delete g.errors[y.payload.errorProp],g.isValid=Object.keys(g.errors).length===0},changeVariableEditorExtended:(g,y)=>{g.extended={...g.extended,...y.payload}},cleanEditorState:()=>a}}),l=s.reducer,{changeVariableNameSucceeded:o,changeVariableNameFailed:d,variableEditorMounted:i,variableEditorUnMounted:c,changeVariableEditorExtended:m,addVariableEditorError:p,removeVariableEditorError:h,cleanEditorState:r}=s.actions},73829:(Z,R,e)=>{"use strict";e.d(R,{M:()=>n});var n=(a=>(a[a.MaxSize=50]="MaxSize",a))(n||{})},66223:(Z,R,e)=>{"use strict";e.d(R,{z:()=>l});var n=e(2863),a=e(54742),s=e(8921);function l(o){const d={},i=(0,n.w)().getVariables();for(let c=0;c<i.length;c++){const m=i[c],p=o&&o[m.name];m.skipUrlSync||(p?d[s.qz+m.name]=p.value:d[s.qz+m.name]=a.B.get(m.type).getValueForUrl(m))}return d}},67933:(Z,R,e)=>{"use strict";e.d(R,{CH:()=>v,EW:()=>l,Hf:()=>h,P4:()=>s,SP:()=>i,VN:()=>y,VO:()=>o,X3:()=>g,d5:()=>p,iv:()=>d,m8:()=>c,zs:()=>r});var n=e(48592),a=e(56404);const s=x=>x.type==="query",l=x=>x.type==="adhoc",o=x=>x.type==="constant",d=x=>"multi"in x,i=x=>"options"in x,c=x=>"current"in x;function m(x){return x===null?!1:typeof x=="string"}const p=x=>!!x.metricFindQuery&&!x.variables,h=x=>{if(!x.variables||x.variables.getType()!==n.Qz.Standard)return!1;const f=x.variables;return"toDataQuery"in f&&!!f.toDataQuery},r=x=>{if(!x.variables||x.variables.getType()!==n.Qz.Custom)return!1;const f=x.variables;return"query"in f&&"editor"in f&&!!f.query&&!!f.editor},g=x=>x.variables?x.variables.getType()===n.Qz.Datasource:!1;function y(x,f){return x?x.displayName===a.c||p(f):!1}function v(x,f){return x?x.displayName!==a.c&&(g(f)||h(f)||r(f)):!1}},27690:(Z,R,e)=>{"use strict";e.d(R,{i:()=>i});var n=e(74848),a=e(96540),s=e(22787);const l=({nodes:c,edges:m,direction:p,width:h,height:r})=>{const g=(0,a.useRef)(null),y=(0,a.useRef)(null);return(0,a.useEffect)(()=>{(async()=>{const x=await e.e(502).then(e.t.bind(e,78993,23)),f=await e.e(9020).then(e.t.bind(e,373,23)),u={nodes:o(f,c),edges:d(f,m)},b={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:p??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};y.current&&(g.current=new x.Network(y.current,u,b))})()},[p,m,c]),(0,n.jsx)("div",{children:(0,n.jsx)("div",{ref:y,style:{width:h??"100%",height:r??"60vh"}})})};function o(c,m){const p=m.map(h=>({...h,shape:"box"}));return new c.DataSet(p)}function d(c,m){const p=m.map(h=>({...h,arrows:"to",dashes:!0}));return new c.DataSet(p)}function i({edges:c,nodes:m,show:p,title:h,children:r}){const[g,y]=(0,a.useState)(p),v=(0,a.useCallback)(()=>y(!0),[y]),x=(0,a.useCallback)(()=>y(!1),[y]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.a,{isOpen:g,title:h,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:x,onDismiss:x,children:(0,n.jsx)(l,{nodes:m,edges:c})}),r({showModal:v})]})}},99703:(Z,R,e)=>{"use strict";e.d(R,{WT:()=>a,bX:()=>o,t4:()=>l});var n=e(65307);const a={usages:[],usagesNetwork:[]},s=(0,n.Z0)({name:"templating/inspect",initialState:a,reducers:{initInspect:(d,i)=>{const{usages:c,usagesNetwork:m}=i.payload;d.usages=c,d.usagesNetwork=m}}}),l=s.reducer,{initInspect:o}=s.actions},47969:(Z,R,e)=>{"use strict";e.d(R,{qJ:()=>h,hI:()=>m,hM:()=>x,H7:()=>p,xU:()=>b,P5:()=>I,Jx:()=>v,g0:()=>f,PK:()=>T,Ow:()=>C});var n=e(38036),a=e(92745);function s(j,W){const B=new Set;for(const S of j)B.add(W(S));return B}var l=e(82612),o=e(62635),d=e(54742),i=e(67933),c=e(99305);const m=j=>{const W=[];for(const B of j)W.push({id:B.id,label:`${B.id}`});return W},p=(j,W)=>j.filter(B=>W.some(S=>S.from===B.id||S.to===B.id)),h=j=>{const W=[];for(const B of j)for(const S of j){if(B===S)continue;d.B.get(B.type).dependsOn(B,S)&&W.push({from:B.id,to:S.id})}return W};function r(j){const W=(0,c.t4)(j);if(!W)return;const B=W.slice(1).find(S=>S!==void 0);if(!(B in{}))return B}const g=(j,W)=>{c.SY.lastIndex=0;const B=[],w=(0,o.MA)(W,2).match(c.SY);if(!w)return B;for(const N of w){if(!N||N.indexOf("$__")!==-1||N.indexOf("${__")!==-1||N.indexOf("$hashKey")!==-1)continue;const M=r(N);j.some(L=>L.id===M)||B.find(L=>L===M)||M&&B.push(M)}return B},y={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},v=(j,W,B)=>{const S=Object.keys(W.value).reduce((N,M)=>{const L=W.value[M];if(!L||typeof L!="string")return N;const A=y[M]?y[M].find(F=>F.test(j)):void 0;let U=(0,c.wJ)(L,j);return M==="repeat"&&L===j&&(U=!0),!A&&U&&(N={...N,[M]:L}),N},{}),w=Object.keys(W.value).reduce((N,M)=>{const L=W.value[M];if(L&&typeof L=="object"&&Object.keys(L).length){let A=L.title||L.name||L.id||M;Array.isArray(W.value)&&W.key==="panels"&&(A=`${A}[${L.id}]`);const U=v(j,{key:M,value:L},{});Object.keys(U).length&&(N={...N,[A]:U})}return N},{});return(Object.keys(S).length||Object.keys(w).length)&&(B={...B,...S,...w}),B},x=(j,W)=>{if(!W)return{unUsed:[],usages:[]};const B=[];let S=[];const w=W.getSaveModelCloneOld();for(const N of j){const M=N.id,L=v(M,{key:"model",value:w},{});!Object.keys(L).length&&!(0,i.EW)(N)&&B.push(N),Object.keys(L).length&&S.push({variable:N,tree:L})}return{unUsed:B,usages:S}};async function f(j,W){return new Promise((B,S)=>{setTimeout(()=>{try{const w=u(j,W);B(C(w))}catch(w){S(w)}},200)})}function u(j,W){if(!W)return[];let B=[];const S=W.getSaveModelCloneOld(),w=g(j,S);for(const N of w){const M=v(N,{key:"model",value:S},{});if(Object.keys(M).length){const L={id:N,name:N};B.push({variable:L,tree:M})}}return B}function b(j,W,B){const S=s(W.descendants(j),N=>N.name);S.add(n.c.includeVars);for(const N of j)S.add(N);return E([...S],B)}function E(j,W){const B=[];for(const S of j)W[S]&&B.push(...W[S]);return new Set(B)}const D=(j,W)=>{const{id:B,value:S}=W,{nodes:w,edges:N}=j;if(S&&typeof S=="string"){const M=`${W.id}-${S}`;return w.push({id:M,label:S}),N.push({from:M,to:B}),j}if(S&&typeof S=="object"){const M=Object.keys(S);for(const L of M){const A=`${W.id}-${L}`;w.push({id:A,label:L}),N.push({from:A,to:B}),j=D(j,{id:A,value:S[L]})}return j}return j},C=j=>{const W=[];for(const B of j){const{variable:S,tree:w}=B,N={variable:S,nodes:[{id:"dashboard",label:(0,a.t)("variables.transform-usages-to-network.result.label.dashboard","dashboard")}],edges:[],showGraph:!1};W.push(D(N,{id:"dashboard",value:w}))}return W},P=j=>Object.values(j).reduce((B,S)=>typeof S=="object"?B+P(S):B+1,0),T=(j,W)=>{const B=W.find(S=>S.variable.id===j);return B?P(B.tree):0};function O(j){const W=[];for(const B of j)W.push(B),B.panels?.length&&W.push(...O(B.panels.map(S=>new PanelModel(S))));return W}function I(j){const W={};for(const B of j){const S=(0,l.tw)(B),w=[...S.matchAll(/"repeat":"([^"]+)"/g)].map(L=>L[1]),N=S.match(c.SY)?.map(L=>r(L))??[],M=[...w,...N];for(const L of M)L in W?W[L].add(B.id):W[L]=new Set([B.id])}return W}},98732:(Z,R,e)=>{"use strict";e.d(R,{E5:()=>p,Ez:()=>c,mn:()=>h});var n=e(65307),a=e(2543),s=e.n(a),l=e(7389),o=e(93612),d=e(96120),i=e(88813);const c={...i.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:l.CO.onTimeRangeChanged,current:{}},m=(0,n.Z0)({name:"templating/interval",initialState:d.j,reducers:{createIntervalOptions:(r,g)=>{const y=(0,o.Fs)(r,g.payload.id);if(y.type!=="interval")return;const v=(0,a.map)(y.query.match(/(["'])(.*?)\1|\w+/g),x=>(x=x.replace(/["']+/g,""),{text:x.trim(),value:x.trim(),selected:!1}));y.auto&&v.length&&v[0].text!=="auto"&&v.unshift({text:"auto",value:"$__auto_interval_"+y.name,selected:!1}),y.options=v}}}),p=m.reducer,{createIntervalOptions:h}=m.actions},99598:(Z,R,e)=>{"use strict";e.d(R,{jR:()=>j,Fu:()=>D,$z:()=>m,O$:()=>C,ho:()=>W,MO:()=>E,an:()=>P,U9:()=>b,fx:()=>O,qh:()=>I,S8:()=>T});var n=e(84139),a=e(65307),s=e(2543),l=e(94452);const o=(B,...S)=>S.reduce((w,N)=>N(w),B);var d=e(8921),i=e(67933);const c=/[^ -~]/m,m={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},p=1e3,h=new n.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),r=B=>Array.isArray(B)?B.reduce((S,w)=>((0,s.isString)(w.value)&&(S[w.value]=w),S),{}):{},g=B=>{if(!Array.isArray(B.options))return B.options=[],B;const S=r(B.selectedValues);return B.selectedValues=Object.values(S),B.options=B.options.map(w=>{if(!(0,s.isString)(w.value))return w;const N=!!S[w.value];return w.selected===N?w:{...w,selected:N}}),B.options=y(B.options),B},y=B=>Array.isArray(B)?B.length<=p?B:B.slice(0,p):[],v=B=>{const{options:S,selectedValues:w}=B;return S.length===0||w.length>0||!S[0]||S[0].value!==d.To||(B.selectedValues=[{...S[0],selected:!0}]),B},x=B=>{const{selectedValues:S}=B;return S.length>1&&(B.selectedValues=S.filter(w=>w.value!==d.To)),B},f=B=>B.filter(S=>S.value!==d.To).map(S=>({...S,selected:!0})),u=(0,a.Z0)({name:"templating/optionsPicker",initialState:m,reducers:{showOptions:(B,S)=>{const{query:w,options:N}=S.payload;if(B.highlightIndex=-1,B.options=(0,s.cloneDeep)(N),B.id=S.payload.id,B.queryValue="",B.multi=!1,(0,i.iv)(S.payload)&&(B.multi=S.payload.multi??!1),(0,i.P4)(S.payload)){const{queryValue:M}=S.payload,L=(0,l.E)(w);B.queryValue=L&&M?M:""}return B.selectedValues=B.options.filter(M=>M.selected),o(B,v,g)},hideOptions:(B,S)=>({...m}),toggleOption:(B,S)=>{const{option:w,clearOthers:N,forceSelect:M}=S.payload,{multi:L,selectedValues:A}=B;if(w){const U=!A.find(F=>F.value===w.value&&F.text===w.text);if(w.value===d.To||!L||N)return U||M?B.selectedValues=[{...w,selected:!0}]:B.selectedValues=[],o(B,v,x,g);if(M||U)return B.selectedValues.push({...w,selected:!0}),o(B,v,x,g);B.selectedValues=A.filter(F=>F.value!==w.value&&F.text!==w.text)}else B.selectedValues=[];return o(B,v,x,g)},moveOptionsHighlight:(B,S)=>{let w=B.highlightIndex+S.payload;return w<0?w=-1:w>=B.options.length&&(w=B.options.length-1),{...B,highlightIndex:w}},toggleAllOptions:(B,S)=>{const w=B.selectedValues.find(M=>M.value===d.To),N=B.options.find(M=>M.value===d.To);return B.selectedValues.length>0&&N&&!w?(B.selectedValues=[],B.selectedValues.push({text:N.text??"All",value:N.value,selected:!0}),o(B,g)):w&&B.selectedValues.length===1?(B.selectedValues=f(B.options),o(B,g)):B.selectedValues.length>0&&!N?(B.selectedValues=[],o(B,g)):(B.selectedValues=f(B.options),o(B,g))},updateSearchQuery:(B,S)=>(B.queryValue=S.payload,B),updateOptionsAndFilter:(B,S)=>{const w=B.queryValue.trim();let N=[];if(w==="")N=S.payload;else if(c.test(w))N=S.payload.filter(M=>M.text.includes(w));else{const M=S.payload.map(({text:F})=>Array.isArray(F)?F.toString():F),[L,A,U]=h.search(M,w,5);L?.length&&(A&&U?N=U.map(F=>S.payload[A.idx[F]]):N=L.map(F=>S.payload[F]),N.sort((F,V)=>(F.value===d.To?-1:0)-(V.value===d.To?-1:0)))}if(B.highlightIndex=0,w!==""){let M=N.findIndex(L=>L.value!==d.To);(M===-1||N[M].value!==w)&&(N.unshift({selected:!1,text:"> "+w,value:w}),B.highlightIndex=M===-1?0:M+1)}return B.options=N,o(B,v,g)},updateOptionsFromSearch:(B,S)=>(B.options=S.payload,B.highlightIndex=0,o(B,v,g)),cleanPickerState:()=>m}}),{toggleOption:b,showOptions:E,hideOptions:D,moveOptionsHighlight:C,toggleAllOptions:P,updateSearchQuery:T,updateOptionsAndFilter:O,updateOptionsFromSearch:I,cleanPickerState:j}=u.actions,W=u.reducer},56620:(Z,R,e)=>{"use strict";e.d(R,{U:()=>m});var n=e(74848),a=e(96540),s=e(7389),l=e(92745),o=e(37386),d=e(77824),i=e(51702);const c=[{label:"On dashboard load",value:s.CO.onDashboardLoad},{label:"On time range change",value:s.CO.onTimeRangeChanged}];function m({onChange:p,refresh:h,testId:r}){const g=!(0,i.i)("sm"),y=(0,a.useMemo)(()=>c.find(v=>v.value===h)?.value??c[0].value,[h]);return(0,n.jsx)(o.D,{label:(0,l.t)("variables.query-variable-refresh-select.label-refresh","Refresh"),description:(0,l.t)("variables.query-variable-refresh-select.description-update-values-variable","When to update the values of this variable"),"data-testid":r,children:(0,n.jsx)(d.z,{options:c,onChange:p,value:y,size:g?"sm":"md"})})}},83501:(Z,R,e)=>{"use strict";e.d(R,{z:()=>d});var n=e(74848),a=e(96540),s=e(7389),l=e(92745),o=e(68577);function d({onChange:i,sort:c,testId:m}){const p=(0,a.useMemo)(()=>[{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.disabled","Disabled"),value:s.ZG.disabled},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-asc","Alphabetical (asc)"),value:s.ZG.alphabeticalAsc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-desc","Alphabetical (desc)"),value:s.ZG.alphabeticalDesc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.numerical-asc","Numerical (asc)"),value:s.ZG.numericalAsc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.numerical-desc","Numerical (desc)"),value:s.ZG.numericalDesc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-caseinsensitive-asc","Alphabetical (case-insensitive, asc)"),value:s.ZG.alphabeticalCaseInsensitiveAsc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-caseinsensitive-desc","Alphabetical (case-insensitive, desc)"),value:s.ZG.alphabeticalCaseInsensitiveDesc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.natural-asc","Natural (asc)"),value:s.ZG.naturalAsc},{label:(0,l.t)("variables.query-variable-sort-select.sort_options.label.natural-desc","Natural (desc)"),value:s.ZG.naturalDesc}],[]),h=(0,a.useMemo)(()=>p.find(r=>r.value===c)??p[0],[c,p]);return(0,n.jsx)(o.v,{name:(0,l.t)("variables.query-variable-sort-select.name-sort","Sort"),description:(0,l.t)("variables.query-variable-sort-select.description-values-variable","How to sort the values of this variable"),value:h,options:p,onChange:i,testId:m,width:25})}},78763:(Z,R,e)=>{"use strict";e.d(R,{C:()=>n});const n=(l,o)=>l&&(o&&!Array.isArray(l.value)?{...l,value:s(l.value),text:s(l.text)}:!o&&Array.isArray(l.value)?{...l,value:a(l.value),text:a(l.text)}:l),a=l=>Array.isArray(l)?l.length>0?l[0]:"":l,s=l=>Array.isArray(l)?l:[l]},39167:(Z,R,e)=>{"use strict";e.d(R,{Y7:()=>Ae,TI:()=>Y,_m:()=>Ne,_q:()=>He,RK:()=>Te,t9:()=>he,x7:()=>ue,Hn:()=>Qe,mZ:()=>Ue,kl:()=>ie,us:()=>ce});var n=e(2543),a=e(7389),s=e(3594),l=e(28105),o=e(48480),d=e(36490),i=e(25992),c=e(43173),m=e(6890),p=e(15130),h=e(75421),r=e(8535),g=e(64762),y=e(73427),v=e(83873),x=e(68220),f=e(28998),u=e(59373),b=e(54742),E=e(8921),D=e(17752),C=e(67933),P=e(47969),T=e(99598),O=e(78763),I=e(88813),j=e(99305),W=e(21275),B=e(37918),S=e(74887),w=e(38221);const N=(le,ye=-1,pe=!1,ve=!1)=>{const be={};if(ve){const Oe={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},we={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},ze={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};be[Oe.id]=Oe,be[we.id]=we,be[ze.id]=ze}for(let Oe=0;Oe<le;Oe++)be[Oe]=createQueryVariable({id:Oe.toString(),name:`Name-${Oe}`,label:`Label-${Oe}`,index:Oe});return pe&&(be[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:le})),be},M=(le,ye={})=>{const pe={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...le.initialState,...pe},...ye}}}},L=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),A=()=>combineReducers({templating:keyedVariablesReducer});function U(le,ye){return{templating:{lastKey:le,keys:{[le]:{...getInitialTemplatingState(),...ye}}}}}function F(le,ye){return le.find(ve=>ve.name===ye)}function V(le){return(le.type==="query"||le.type==="datasource"||le.type==="interval")&&le.refresh===W.CO.onTimeRangeChanged}var K=e(93612),G=e(88681),H=e(74276),_=e(77839);const k=(le,ye)=>(pe,ve)=>{let be=0;const Oe=ye.templating.list;for(let ze=0;ze<Oe.length;ze++){const Ve=J(Oe[ze]);Ve.rootStateKey=le,b.B.getIfExists(Ve.type)&&pe((0,S.kb)(le,(0,G.QV)((0,j.qD)(Ve,{global:!1,index:be++,model:Ve}))))}(0,u.w)().updateTimeRange((0,h.jG)().timeRange());const we=(0,K.SS)(le,ve());for(const ze of we)pe((0,S.kb)(le,(0,G.wB)((0,j.qD)(ze))))};function J(le){if(!(0,C.SP)(le))return le;let ye=!1;for(const pe of le.options)if(pe.selected=!1,Array.isArray(le.current.value))for(const ve of le.current.value)pe.value===ve&&(pe.selected=ye=!0);else pe.value===le.current.value&&(pe.selected=ye=!0);return!ye&&le.options.length&&(le.options[0].selected=!0),le}const z=(le,ye)=>pe=>{const ve={...I.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:ye.title,uid:ye.uid,toString:()=>ye.title}}};pe((0,S.kb)(le,(0,G.QV)((0,j.qD)(ve,{global:ve.global,index:ve.index,model:ve}))));const be={...I.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:p.TP.user.orgName,id:p.TP.user.orgId,toString:()=>p.TP.user.orgId.toString()}}};pe((0,S.kb)(le,(0,G.QV)((0,j.qD)(be,{global:be.global,index:be.index,model:be}))));const Oe={...I.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{login:p.TP.user.login,id:p.TP.user.id,email:p.TP.user.email,toString:()=>p.TP.user.id.toString()}}};pe((0,S.kb)(le,(0,G.QV)((0,j.qD)(Oe,{global:Oe.global,index:Oe.index,model:Oe}))))},Y=(le,ye)=>(pe,ve)=>{const{rootStateKey:be}=le,Oe=(0,K.dn)(le,ve());if(!(0,C.iv)(Oe)||(0,s.R)(Oe.current))return;const we=(0,O.C)(Oe.current,ye);pe((0,S.kb)(be,(0,G.QP)((0,j.qD)(le,{propName:"multi",propValue:ye})))),pe((0,S.kb)(be,(0,G.QP)((0,j.qD)(le,{propName:"current",propValue:we}))))},X=async(le,ye)=>{if(!le.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${le.id}`);if(Q(le,ye))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const pe=q(le,ye);te(le.rootStateKey,pe,ye)&&await new Promise(ve=>{const be=r.M_.subscribe(()=>{if(!le.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${le.id}`);te(le.rootStateKey,pe,r.M_.getState())||(be(),ve())})})},Q=(le,ye,pe=new Set)=>pe.has(le.id)?!0:(pe=new Set([...pe,le.id]),q(le,ye).some(ve=>Q(ve,ye,pe))),q=(le,ye)=>{if(!le.rootStateKey)return[];const pe=[];for(const ve of(0,K.SS)(le.rootStateKey,ye))le!==ve&&b.B.getIfExists(le.type)&&b.B.get(le.type).dependsOn(le,ve)&&pe.push(ve);return pe},te=(le,ye,pe)=>{if(ye.length===0)return!1;const ve=(0,K.SS)(le,pe);return ye.filter(Oe=>ve.some(we=>we.id===Oe.id&&(we.state===l.Gu.NotStarted||we.state===l.Gu.Loading))).length>0},ne=(le,ye)=>async(pe,ve)=>{const be=(0,K.dn)(le,ve());await X(be,ve());const Oe=ye[E.qz+be.name];if(Oe!==void 0){const we=(0,j.QT)(Oe);await b.B.get(be.type).setValueFromUrl(be,we);return}if(be.hasOwnProperty("refresh")){const we=be;if(we.refresh===a.CO.onDashboardLoad||we.refresh===a.CO.onTimeRangeChanged){await pe(Ue((0,j.jX)(we)));return}}if(be.type==="custom"){await pe(Ue((0,j.jX)(be)));return}pe(We(le))},se=le=>async(ye,pe)=>{const ve=d.Ny.getSearchObject(),be=(0,K.SS)(le,pe()).map(async Oe=>await ye(ne((0,j.jX)(Oe),ve)));await Promise.all(be)},ue=(le,ye)=>async(pe,ve)=>{const be=(0,j.QT)(ye),Oe=(0,K.dn)(le,ve());(0,j.q$)(Oe)!==a.CO.never&&await pe(Ue((0,j.jX)(Oe)));const we=(0,K.dn)((0,j.jX)(Oe),ve());if(!(0,C.SP)(we))return;if(!we)throw new Error(`Couldn't find variable with name: ${Oe.name}`);let ze=we.options.find(Ve=>Ve.text===be||Ve.value===be);if(!ze&&(0,C.iv)(we)&&we.allValue&&be===we.allValue&&(ze={text:E.Zm,value:E.To,selected:!1}),!ze){let Ve=be;const ge=be;Array.isArray(be)&&(Ve=be.reduce((Ke,qe)=>{const ot=we.options.find(lt=>lt.value===qe);return ot?[].concat(Ke,[ot.text]):[].concat(Ke,[qe])},[])),ze={text:Ve,value:ge,selected:!1}}(0,C.iv)(we)&&(ze=(0,O.C)({text:(0,n.castArray)(ze.text),value:(0,n.castArray)(ze.value),selected:!1},we.multi)),await b.B.get(Oe.type).setValue(we,ze)},de=le=>{let ye,pe,ve,be;const Oe=[];for(ye=0;ye<le.options.length;ye++)if(be={...le.options[ye]},be.selected=!1,Array.isArray(le.current.value))for(pe=0;pe<le.current.value.length;pe++)ve=le.current.value[pe],be.value===ve&&(be.selected=!0,Oe.push(be));else be.value===le.current.value&&(be.selected=!0,Oe.push(be));return Oe},ie=(le,ye)=>(pe,ve)=>{const be=(0,K.dn)(le,ve());if(!(0,C.SP)(be))return Promise.resolve();const Oe=be.current||{},we=b.B.get(be.type).setValue;if(Array.isArray(Oe.value)){const Ke=de(be);if(Ke.length===0){const ot=be.options[0];return we(be,{value:typeof ot.value=="string"?[ot.value]:ot.value,text:typeof ot.text=="string"?[ot.text]:ot.text,selected:!0})}const qe={value:Ke.map(ot=>ot.value),text:Ke.map(ot=>ot.text),selected:!0};return we(be,qe)}let ze=null;const Ve=(0,j.Nz)(be),ge=(0,j.Lz)(be);if(ze=be.options?.find(Ke=>Ke.text===Ve||Ke.value===ge),ze||ye&&(ze=be.options?.find(Ke=>Ke.text===ye||Ke.value===ye),ze))return we(be,ze);if(be.options){const Ke=be.options[0];if(Ke)return we(be,Ke)}return Promise.resolve()},he=(le,ye,pe)=>async ve=>{const{rootStateKey:be}=le;return ve((0,S.kb)(be,(0,G.dE)((0,j.qD)(le,{option:ye})))),await ve(ce(le,pe))},me=le=>{const ye=new x.TS;return le.forEach(pe=>{ye.createNode(pe.name)}),le.forEach(pe=>{le.forEach(ve=>{if(pe!==ve&&b.B.get(pe.type).dependsOn(pe,ve))try{ye.link(pe.name,ve.name)}catch(be){const Oe=be instanceof Error?be.message:"Unknown error";(0,i.FF)("Error linking variables",{error:Oe})}})}),ye},ce=(le,ye,pe=y.lE)=>async(ve,be)=>{const Oe=be(),{rootStateKey:we}=le,ze=(0,K.dn)(le,Oe);if((0,K.nx)(we,Oe).transaction.status===I.x8.Fetching)return(0,j.q$)(ze)===a.CO.never&&(await ve(_e((0,j.jX)(ze))),ve(We(le))),Promise.resolve();const Ve=(0,K.SS)(we,Oe),ge=me(Ve),Ke=Oe.dashboard?.getModel()?.panels??[],qe=(0,P.P5)(Ke),ot=ze.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,P.xU)([ze.id],ge,qe)),variable:(0,K.dn)(le,Oe)},lt=ge.getNode(ze.name);let mt=[];return lt&&(mt=lt.getOptimizedInputEdges().map(Lt=>{const Tt=Ve.find(It=>It.name===Lt.inputNode?.name);return Tt?ve(Ue((0,j.jX)(Tt))):Promise.resolve()})),Promise.all(mt).then(()=>{ye&&(pe.publish(new I.og(ot)),d.Ny.partial(ke(we,be)))})},Pe=(le,ye,pe,ve)=>(ye.includes(le.name)||ye.push(le.name),le.outputEdges.forEach(be=>{const Oe=be.outputNode;if(Oe&&!ye.includes(Oe.name)){const we=pe.find(ze=>ze.name===Oe.name);we&&we.refresh===a.CO.onTimeRangeChanged&&ve.indexOf(we)===-1?(ve.push(we),ye.push(Oe.name)):Pe(Oe,ye,pe,ve)}}),ve),Ie=(le,ye)=>le.outputEdges.every(pe=>{const ve=pe.outputNode;if(ve){const be=F(ye,ve.name);if(be&&be.type==="query")return be.refresh!==a.CO.onTimeRangeChanged}return!0}),Se=(le,ye)=>{const pe=(0,K.SS)(le,ye),ve=me(pe),be=[],Oe=[];return pe.forEach(we=>{const ze=ve.getNode(we.name);if(!be.includes(we.name)&&ze){const Ve=F(pe,ze.name);if(!Ve)return;const ge=V(Ve);ge&&ze.outputEdges.length===0&&Oe.push(Ve),ge&&Oe.includes(Ve)&&ze.outputEdges.length>0&&(Oe.push(Ve),Pe(ze,be,pe,Oe)),ge&&ze.outputEdges.length>0&&Ie(ze,pe)&&(Oe.includes(Ve)||Oe.push(Ve)),!ge&&ze.outputEdges.length>0&&Pe(ze,be,pe,Oe)}}),Oe},Me=(le,ye)=>(0,K.SS)(le,ye).filter(be=>"refresh"in be&&"options"in be?be.refresh===a.CO.onTimeRangeChanged:!1),Te=(le,ye,pe={templateSrv:(0,u.w)(),events:y.lE})=>async(ve,be)=>{pe.templateSrv.updateTimeRange(ye);let Oe=[];c.$.featureToggles.refactorVariablesTimeRange?Oe=Se(le,be()):Oe=Me(le,be());const we=Oe.map(Ve=>Ve.id),ze=Oe.map(Ve=>ve(Ge((0,j.jX)(Ve))));try{await Promise.all(ze),pe.events.publish(new I.BS({variableIds:we}))}catch(Ve){console.error(Ve),ve((0,m.dx)(Be("Template variable service failed",Ve)))}},Ge=le=>async(ye,pe)=>{const ve=(0,K.dn)(le,pe());if(!(0,C.SP)(ve))return;const be=ve.options.slice();await ye(Ue((0,j.jX)(ve),!0));const Oe=(0,K.dn)(le,pe());if(!(0,C.SP)(Oe))return;const we=Oe.options;JSON.stringify(be)!==JSON.stringify(we)&&pe().dashboard.getModel()?.templateVariableValueUpdated()},Qe=(le,ye,pe=y.lE)=>async(ve,be)=>{const Oe=[],we=be().dashboard.getModel(),ze=(0,K.SS)(le,be());for(const ot of ze){const lt=E.qz+ot.name;if(!ye.hasOwnProperty(lt)||!tt(ot,ye[lt].value))continue;let mt=ye[lt].value;if(ye[lt].removed){const Tt=we?.templating.list.find(It=>It.name===ot.name);Tt&&(0,C.m8)(Tt)&&(mt=Tt.current.value),Tt&&Tt.type==="constant"&&(mt=Tt.query)}const Lt=b.B.get(ot.type).setValueFromUrl(ot,mt);Oe.push(Lt)}const Ve=ze.filter(ot=>{const lt=E.qz+ot.name;return ye.hasOwnProperty(lt)&&tt(ot,ye[lt].value)&&ot.type!=="adhoc"}),ge=me(ze),Ke=(0,P.P5)(we?.panels??[]),qe=(0,P.xU)(Ve.map(ot=>ot.id),ge,Ke);Oe.length&&(await Promise.all(Oe),pe.publish(new I.eF({refreshAll:qe.size===0,panelIds:Array.from(qe)})))};function tt(le,ye){const pe=b.B.get(le.type).getValueForUrl(le);let ve=(0,j.QT)(ye);return Array.isArray(pe)&&!Array.isArray(ve)&&(ve=[ve]),!(0,n.isEqual)(pe,ve)}const ke=(le,ye)=>{const pe=d.Ny.getSearchObject(),ve=Object.keys(pe).filter(be=>be.indexOf(E.qz)===-1).reduce((be,Oe)=>(be[Oe]=pe[Oe],be),{});for(const be of(0,K.SS)(le,ye())){if(be.skipUrlSync)continue;const Oe=b.B.get(be.type);ve[E.qz+be.name]=Oe.getValueForUrl(be)}return ve},He=(le,ye)=>async(pe,ve)=>{try{const be=(0,j.q4)(le),Oe=ve(),we=(0,K.Tk)(Oe);we&&(0,K.nx)(we,Oe).transaction.status===I.x8.Fetching&&pe(Ae(we)),pe((0,S.kb)(be,(0,H.kH)({uid:be}))),pe(z(be,ye)),pe(k(be,ye)),pe(Re(be)),await pe(se(be)),pe((0,S.kb)(be,(0,H.$O)({uid:be})))}catch(be){pe((0,m.dx)(Be("Templating init failed",be))),console.error(be)}};function Re(le,ye=f.tR){return(pe,ve)=>{const be=(0,K.SS)(le,ve());for(const Oe of be){if(Oe.type!=="adhoc"&&Oe.type!=="query")continue;const{datasource:we}=Oe;if((0,o.fN)(we))continue;const ze=ye().getInstanceSettings(we),Ve=ze?(0,o.p$)(ze):{uid:we};pe((0,S.kb)(le,(0,G.QP)((0,j.qD)(Oe,{propName:"datasource",propValue:Ve}))))}}}const Ne=le=>ye=>{ye((0,S.kb)(le,(0,_.v)())),ye((0,S.kb)(le,(0,D.y8)())),ye((0,S.kb)(le,(0,T.jR)())),ye((0,S.kb)(le,(0,H.pu)()))},Ae=(le,ye={getBackendSrv:v.AI})=>pe=>{ye.getBackendSrv().cancelAllInFlightRequests(),pe(Ne(le))},Ue=(le,ye=!1)=>async(pe,ve)=>{const{rootStateKey:be}=le;try{if(!(0,j.sN)(be,ve()))return;const Oe=(0,K.dn)(le,ve());pe((0,S.kb)(be,(0,G.a7)((0,j.qD)(Oe)))),await pe(_e((0,j.jX)(Oe))),await b.B.get(Oe.type).updateOptions(Oe),pe(We(le))}catch(Oe){if(pe((0,S.kb)(be,(0,G.Te)((0,j.qD)(le,{error:Oe})))),ye||(console.error(Oe),pe((0,m.dx)(Be("Error updating options:",Oe,le)))),ye)throw Oe}},Be=(le,ye,pe)=>(0,g.gi)(`${pe?`Templating [${pe.id}]`:"Templating"}`,ye instanceof Error?`${le} ${ye.message}`:`${le}`),We=le=>(ye,pe)=>{const{rootStateKey:ve}=le;if(!(0,j.sN)(ve,pe()))return;const be=(0,K.dn)(le,pe());be.state!==l.Gu.Done&&ye((0,S.kb)(le.rootStateKey,(0,G.Pu)((0,j.qD)(be))))};function _e(le,ye=f.tR){return async function(pe,ve){const{id:be,rootStateKey:Oe}=le;if(!(0,j.sN)(Oe,ve()))return;const we=(0,K.dn)(le,ve());if(we.type==="query")try{const ze=await ye().get(we.datasource??"");if((0,C.d5)(ze)||!(0,C.Hf)(ze)||Xe(we.query))return;const Ve={refId:`${ze.name}-${be}-Variable-Query`,query:we.query};pe((0,S.kb)(Oe,(0,G.QP)((0,j.qD)(le,{propName:"query",propValue:Ve}))))}catch(ze){pe((0,m.dx)(Be("Failed to upgrade legacy queries",ze))),console.error(ze)}}}function Xe(le){return(0,l.Gv)(le)&&"refId"in le&&typeof le.refId=="string"}},74887:(Z,R,e)=>{"use strict";e.d(R,{Ay:()=>m,L1:()=>l,kb:()=>d});var n=e(99305),a=e(38221),s=e(74276);const l={keys:{}},o=p=>({type:`templating/keyed/${p.action.type.replace(/^templating\//,"")}`,payload:p});function d(p,h){const r=(0,n.q4)(p);return o({key:r,action:h})}const i=p=>typeof p.type=="string"&&p.type.startsWith("templating/keyed")&&"payload"in p&&typeof p.payload.key=="string";function c(p=l,h){if(i(h)){const{key:r,action:g}=h.payload,y=(0,n.q4)(r),v=s.kH.match(g)?y:p.lastKey,x=(0,a.H)(),f=p.keys[y],u=x(f,g);return{...p,lastKey:v,keys:{...p.keys,[y]:u}}}return p}const m={templating:c}},38221:(Z,R,e)=>{"use strict";e.d(R,{H:()=>m,x:()=>p});var n=e(14644),a=e(17752),s=e(99703),l=e(99598),o=e(74276),d=e(96120),i=e(77839);let c;function m(){return c||(c=(0,n.combineReducers)({editor:a.wf,variables:i.Y,optionsPicker:l.ho,transaction:o.Dd,inspect:s.t4})),c}function p(){return{editor:a.nS,variables:d.j,optionsPicker:l.$z,transaction:o.i3,inspect:s.WT}}},93612:(Z,R,e)=>{"use strict";e.d(R,{Fs:()=>E,SS:()=>c,Tk:()=>v,UN:()=>u,_2:()=>b,bZ:()=>f,dn:()=>o,hk:()=>r,nS:()=>h,nx:()=>i,pi:()=>p,wk:()=>g,y7:()=>x});var n=e(41811),a=e(8535),s=e(99305),l=e(38221);function o(D,C=(0,a.Gu)(),P=!0){const{id:T,rootStateKey:O}=D,j=i(O,C).variables[T];if(!j){if(P)throw new Error(`Couldn't find variable with id:${T}`);return}return j}function d(D,C,P=(0,a.Gu)()){return Object.values(i(C,P).variables).filter(D).sort((T,O)=>T.index-O.index)}function i(D,C=(0,a.Gu)()){return C.templating.keys[(0,s.q4)(D)]??(0,l.x)()}function c(D,C=(0,a.Gu)()){return d(m,D,C)}function m(D){return D.type!=="system"}const p=(0,n.default)((D,C)=>c(D,(0,a.Gu)())),h=(D,C)=>c(D,C);function r(D,C=(0,a.Gu)()){return g(Object.values(i(D,C).variables))}function g(D){const C=D.filter(m).sort((P,T)=>P.index-T.index);return C.length>0?C[C.length-1].index+1:0}function y(D,C=getState()){return i(D,C).transaction.isDirty}function v(D=(0,a.Gu)()){return D.templating?.lastKey}function x(D=(0,a.Gu)()){if(!D.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return D.templating.lastKey}function f(D,C=(0,a.Gu)()){const P=v(C);return P?d(D,P,C):[]}function u(D=(0,a.Gu)()){const C=v(D);return C?c(C,D):[]}function b(D,C=(0,a.Gu)()){const P=v(C);if(P)return o({id:D,rootStateKey:P,type:"query"},C,!1)}function E(D,C){return D[C]}},88681:(Z,R,e)=>{"use strict";e.d(R,{Hr:()=>g,Pu:()=>C,QP:()=>v,QV:()=>y,Te:()=>P,a7:()=>D,dE:()=>u,hj:()=>x,l_:()=>b,qi:()=>r,ut:()=>f,wB:()=>E});var n=e(65307),a=e(2543),s=e.n(a),l=e(28105),o=e(54742),d=e(17752),i=e(67933),c=e(99305),m=e(93612),p=e(96120);const h=(0,n.Z0)({name:"templating/shared",initialState:p.j,reducers:{addVariable:(T,O)=>{const I=O.payload.id??O.payload.data.model.name,j=o.B.get(O.payload.type),W=(0,a.cloneDeep)(j.initialState),B=j.beforeAdding?j.beforeAdding(O.payload.data.model):(0,a.cloneDeep)(O.payload.data.model),S={...(0,a.defaults)({},B,W),id:I,index:O.payload.data.index,global:O.payload.data.global};T[I]=S},variableStateNotStarted:(T,O)=>{const I=(0,m.Fs)(T,O.payload.id);I.state=l.Gu.NotStarted,I.error=null},variableStateFetching:(T,O)=>{const I=(0,m.Fs)(T,O.payload.id);I.state=l.Gu.Loading,I.error=null},variableStateCompleted:(T,O)=>{const I=(0,m.Fs)(T,O.payload.id);I&&(I.state=l.Gu.Done,I.error=null)},variableStateFailed:(T,O)=>{const I=(0,m.Fs)(T,O.payload.id);I&&(I.state=l.Gu.Error,I.error=O.payload.data.error)},removeVariable:(T,O)=>{if(delete T[O.payload.id],!O.payload.data.reIndex)return;const I=Object.values(T).sort((j,W)=>j.index-W.index);for(let j=0;j<I.length;j++)I[j].index=j},duplicateVariable:(T,O)=>{function I(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const j=(0,a.cloneDeep)(T[O.payload.id]),W=new RegExp(`^copy_of_${I(j.name)}(_(\\d+))?$`),B=Object.values(T).map(({name:A})=>A.match(W)).filter(A=>A!=null),S=B.map(A=>A[2]).filter(A=>A!=null),w=B.length===0?null:S.length===0?1:S.map(A=>+A).sort((A,U)=>U-A)[0]+1,N=`copy_of_${j.name}${w?`_${w}`:""}`,M=O.payload.data?.newId??N,L=(0,m.wk)(Object.values(T));T[M]={...(0,a.cloneDeep)(o.B.get(O.payload.type).initialState),...j,id:M,name:N,index:L}},changeVariableOrder:(T,O)=>{const{toIndex:I,fromIndex:j}=O.payload.data,W=Object.values(T);for(let B=0;B<W.length;B++){const S=W[B];S.index===j?S.index=I:S.index>j&&S.index<=I?S.index--:S.index<j&&S.index>=I&&S.index++}},changeVariableType:(T,O)=>{const{id:I}=O.payload,{label:j,name:W,index:B,description:S,rootStateKey:w}=T[I];T[I]={...(0,a.cloneDeep)(o.B.get(O.payload.data.newType).initialState),id:I,rootStateKey:w,label:j,name:W,index:B,description:S}},setCurrentVariableValue:(T,O)=>{if(!O.payload.data.option)return;const I=(0,m.Fs)(T,O.payload.id);if(!(0,i.SP)(I))return;const{option:j}=O.payload.data,W={...j,text:(0,c.QT)(j?.text),value:(0,c.QT)(j?.value)};I.current=W,I.options=I.options.map(B=>{B.value=(0,c.QT)(B.value),B.text=(0,c.QT)(B.text);let S=!1;if(Array.isArray(W.value))for(let w=0;w<W.value.length;w++){const N=W.value[w];if(B.value===N){S=!0;break}}else B.value===W.value&&(S=!0);return B.selected=S,B})},changeVariableProp:(T,O)=>{const I=(0,m.Fs)(T,O.payload.id);I[O.payload.data.propName]=O.payload.data.propValue}},extraReducers:T=>T.addCase(d.FN,(O,I)=>{const j=(0,m.Fs)(O,I.payload.id);j.name=I.payload.data.newName})}),r=h.reducer,{removeVariable:g,addVariable:y,changeVariableProp:v,changeVariableOrder:x,duplicateVariable:f,setCurrentVariableValue:u,changeVariableType:b,variableStateNotStarted:E,variableStateFetching:D,variableStateCompleted:C,variableStateFailed:P}=h.actions},74276:(Z,R,e)=>{"use strict";e.d(R,{$O:()=>m,Dd:()=>p,i3:()=>l,kH:()=>i,pu:()=>c});var n=e(65307),a=e(88813),s=e(88681);const l={uid:null,status:a.x8.NotStarted,isDirty:!1},o=(0,n.Z0)({name:"templating/transaction",initialState:l,reducers:{variablesInitTransaction:(h,r)=>{h.uid=r.payload.uid,h.status=a.x8.Fetching},variablesCompleteTransaction:(h,r)=>{h.uid===r.payload.uid&&(h.status=a.x8.Completed)},variablesClearTransaction:(h,r)=>{h.uid=null,h.status=a.x8.NotStarted,h.isDirty=!1}},extraReducers:h=>h.addMatcher(d,(r,g)=>{r.status===a.x8.Completed&&(r.isDirty=!0)})});function d(h){return s.Hr.match(h)||s.QV.match(h)||s.QP.match(h)||s.hj.match(h)||s.ut.match(h)||s.l_.match(h)}const{variablesInitTransaction:i,variablesClearTransaction:c,variablesCompleteTransaction:m}=o.actions,p=o.reducer},96120:(Z,R,e)=>{"use strict";e.d(R,{j:()=>n});const n={}},77839:(Z,R,e)=>{"use strict";e.d(R,{Y:()=>d,v:()=>o});var n=e(65307),a=e(54742),s=e(88681),l=e(96120);const o=(0,n.VP)("templating/cleanVariables"),d=(i=l.j,c)=>{if(o.match(c)){const m=Object.values(i).filter(h=>h.global);return m?m.reduce((h,r)=>(h[r.id]=r,h),{}):l.j}return c?.payload?.type&&a.B.getIfExists(c?.payload?.type)?a.B.get(c.payload.type).reducer((0,s.qi)(i,c),c):i}},88813:(Z,R,e)=>{"use strict";e.d(R,{BS:()=>c,Vg:()=>d,eF:()=>m,og:()=>i,x8:()=>o});var n=e(7389),a=e(28105),s=e(68388),l=e(8921),o=(p=>(p.NotStarted="Not started",p.Fetching="Fetching",p.Completed="Completed",p))(o||{});const d={id:l.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:n.zL.dontHide,skipUrlSync:!1,state:a.Gu.NotStarted,error:null,description:null};class i extends s.x{static{this.type="variables-changed"}}class c extends s.x{static{this.type="variables-time-range-process-done"}}class m extends s.x{static{this.type="variables-changed-in-url"}}},99305:(Z,R,e)=>{"use strict";e.d(R,{AX:()=>D,Lz:()=>f,ML:()=>v,Nz:()=>x,QT:()=>T,SY:()=>r,Wz:()=>P,iP:()=>b,jX:()=>j,pY:()=>B,q$:()=>E,q4:()=>I,qD:()=>W,sN:()=>O,t4:()=>g,u7:()=>u,wJ:()=>y});var n=e(2543),a=e.n(n),s=e(7389),l=e(2863),o=e(36490),d=e(62635),i=e(8535),c=e(54742),m=e(8921),p=e(93612),h=e(88813);const r=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,g=S=>(r.lastIndex=0,r.exec(S));function y(...S){const w=S[S.length-1];S[0]=typeof S[0]=="string"?S[0]:(0,d.MA)(S[0]);const M=S.slice(0,-1).join(" ").match(r);return!!(M!==null?M.find(A=>{const U=g(A);return U!==null&&U.indexOf(w)>-1}):!1)}const v=S=>{if(!S||!S.current)return!1;if(S.current.value){const w=Array.isArray(S.current.value);if(w&&S.current.value.length&&S.current.value[0]===m.To||!w&&S.current.value===m.To)return!0}if(S.current.text){const w=Array.isArray(S.current.text);if(w&&S.current.text.length&&S.current.text[0]===m.Zm||!w&&S.current.text===m.Zm)return!0}return!1},x=S=>!S||!S.current||!S.current.text?"":Array.isArray(S.current.text)?S.current.text.toString():typeof S.current.text!="string"?"":S.current.text,f=S=>!S||!S.current||S.current.value===void 0||S.current.value===null?null:Array.isArray(S.current.value)?S.current.value.toString():typeof S.current.value!="string"?null:S.current.value;function u(S,w=(0,l.w)()){return!S||!S.regex?"":w.replace(S.regex,{},"regex")}function b(S,w,N,M){const L={range:void 0,variable:S,searchFilter:w,scopedVars:M};return(S.refresh===s.CO.onTimeRangeChanged||S.refresh===s.CO.onDashboardLoad)&&(L.range=N.timeRange()),L}function E(S){return S?.type==="custom"?s.CO.onDashboardLoad:!S||!("refresh"in S)||S.refresh!==s.CO.onTimeRangeChanged&&S.refresh!==s.CO.onDashboardLoad?s.CO.never:S.refresh}function D(){return c.B.list().filter(S=>S.id!=="system").map(({id:S,name:w,description:N})=>({label:w,value:S,description:N}))}function C(S){return(0,n.isArray)(S)&&(S.length===0?S=void 0:S.length===1&&(S=S[0])),S}function P(S,w){let N=0;const M={};for(const L in S){if(!L.startsWith(m.qz))continue;let A=C(w[L]),U=C(S[L]);(0,n.isEqual)(U,A)||(M[L]={value:S[L]},N++)}for(const L in w){if(!L.startsWith(m.qz))continue;const A=w[L];(0,n.isArray)(A)&&A.length===0||S.hasOwnProperty(L)||(M[L]={value:"",removed:!0},N++)}return N?M:void 0}function T(S){return Array.isArray(S)?S.map(String):S==null?"":typeof S=="number"?S.toString(10):typeof S=="string"?S:typeof S=="boolean"?S.toString():""}function O(S,w=(0,i.Gu)()){return(0,p.nx)(S,w).transaction.status!==h.x8.NotStarted}function I(S){return String(S)}const j=S=>{if(!S.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${S.id}`);return{type:S.type,id:S.id,rootStateKey:S.rootStateKey}};function W(S,w){return{type:S.type,id:S.id,data:w}}function B(){const S=(0,l.w)().getVariables(),w=o.Ny.getSearchObject();return Object.keys(w).filter(N=>N.indexOf(m.qz)!==-1&&S.some(M=>M.name===N.replace(m.qz,""))).reduce((N,M)=>{const L=M.replace(m.qz,"");return N[L]=w[M],N},{})}},10572:(Z,R,e)=>{"use strict";window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0;async function n(){await window.__grafana_boot_data_promise,await Promise.resolve().then(e.bind(e,87174))}n().catch(a=>{console.error("Error bootstrapping Grafana",a),window.__grafana_load_failed()})},87174:(Z,R,e)=>{"use strict";var n=e(48307),a=e(9423),s=e(7452),l=e(5086),o=e(78624),d=e(4213),i=e(34796),c=e(96540),m=e.t(c,2),p=e(5338),h=e(25229),r=e(60188),g=e(53543),y=e(8642),v=e(54734),x=e(92138),f=e(57002),u=e(92745),b=e(68143),E=e(47700),D=e(48072),C=e(36490),P=e(25076),T=e(43122),O=e(6201),I=e(75234),j=e(83734),W=e(39698),B=e(78282),S=e(46907),w=e(33005),N=e(33604),M=e(33707),L=e(41071),A=e(92293),U=e(78646),F=e(60311),V=e(88806),K=e(14477),G=e(58873),H=e(2874),_=e(36674),k=e(65642),J=e(43173),z=e(74848),Y=e(2543),X=e(95004),Q=e(36638),q=e(57866),te=e(16515),ne=e(64761),se=e(96702),ue=e(68779),de=e(18027),ie=e(77824),he=e(31286),me=e(45861),ce=e(84510);function Pe(re){if(re in ce.uk){const{name:ee,getHelperDocs:oe,links:De}=ce.uk[re],je=oe(ce.g_.UIImage),$e=Ie(je);if(De?.length){const Ye=De.map(st=>`
  Or visit <a href="${st.url}" target="_blank">${st.title}</a>

  `).join("");return{name:ee,helperDocs:`
        ${$e}
        ${(0,ce.$n)()}
  ${Ye}
        `}}return{name:ee,helperDocs:`
      ${$e}
      ${(0,ce.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,ce.$n)()}}const Ie=re=>re.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var Se=e(97095),Me=e(18857),Te=e(42954),Ge=e(17200),Qe=e(72598);function tt(re){return function({options:oe,onChange:De}){const{validator:je}=re,{value:$e}=oe,[Ye,st]=(0,c.useState)(!je($e)),rt=(0,c.useCallback)(yt=>{st(!je(yt)),De({...oe,value:yt})},[st,je,De,oe]);return(0,z.jsx)(Ge.y,{invalid:Ye,value:$e,error:"Value needs to be a number or a variable",onChange:rt,placeholder:(0,u.t)("transformers.basic-matcher-editor.placeholder-value-or-variable","Value or variable"),suggestions:(0,Qe.I9)()})}}const ke=()=>[{name:"Is greater",id:q.Js.greater,component:tt({validator:Qe.N_})},{name:"Is greater or equal",id:q.Js.greaterOrEqual,component:tt({validator:Qe.N_})},{name:"Is lower",id:q.Js.lower,component:tt({validator:Qe.N_})},{name:"Is lower or equal",id:q.Js.lowerOrEqual,component:tt({validator:Qe.N_})},{name:"Is equal",id:q.Js.equal,component:tt({validator:()=>!0})},{name:"Is not equal",id:q.Js.notEqual,component:tt({validator:()=>!0})},{name:"Is Substring",id:q.Js.substring,component:tt({validator:()=>!0})},{name:"Is not substring",id:q.Js.notSubstring,component:tt({validator:()=>!0})}],He=re=>null,Re=()=>[{name:"Is null",id:q.Js.isNull,component:He},{name:"Is not null",id:q.Js.isNotNull,component:He}];var Ne=e(79233);function Ae(re){return function({options:oe,onChange:De}){const{validator:je}=re,[$e,Ye]=(0,c.useState)({from:!je(oe.from),to:!je(oe.to)}),st=(0,c.useCallback)((yt,Ot)=>{const Bt=!je(yt);Ye({...$e,[Ot]:Bt}),!Bt&&De({...oe,[Ot]:yt})},[oe,De,$e,Ye,je]),rt=(0,Qe.I9)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ge.y,{value:String(oe.from),invalid:$e.from,error:"Value needs to be a number or a variable",placeholder:(0,u.t)("transformers.range-matcher-editor.placeholder-from","From"),onChange:yt=>st(yt,"from"),suggestions:rt}),(0,z.jsx)(Ne.c,{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.range-matcher-editor.and",children:"and"})}),(0,z.jsx)(Ge.y,{invalid:$e.to,error:"Value needs to be a number or a variable",value:String(oe.to),placeholder:(0,u.t)("transformers.range-matcher-editor.placeholder-to","To"),suggestions:rt,onChange:yt=>st(yt,"to")})]})}}const Ue=()=>[{name:"Is between",id:q.Js.between,component:Ae({validator:Qe.N_})}];function Be(re){return function({options:oe,onChange:De}){const{validator:je}=re,{value:$e}=oe,[Ye,st]=(0,c.useState)(!je($e)),rt=(0,Qe.I9)().reduce((Ot,Bt)=>(Ot.push(Bt),Ot.push({...Bt,documentation:(0,u.t)("transformers.regex-matcher-editor.variable-regex-documentation","Formats multi-value variable into a regex string"),label:Bt.label.concat(":regex"),value:Bt.value.concat(":regex")}),Ot),[]),yt=(0,c.useCallback)(Ot=>{st(!je(Ot)),De({...oe,value:Ot})},[st,je,De,oe]);return(0,z.jsx)(Ge.y,{invalid:Ye,value:$e,onChange:yt,placeholder:(0,u.t)("transformers.regex-matcher-editor.placeholder-value-or-variable","Value or variable"),suggestions:rt})}}const We=()=>[{name:"Regex",id:q.Js.regex,component:Be({validator:()=>!0})}],_e=new Te.O(()=>[...ke(),...Re(),...Ue(),...We()]),Xe=re=>{const{onDelete:ee,onChange:oe,filter:De,fieldsInfo:je}=re,{fieldsAsOptions:$e,fieldByDisplayName:Ye}=je,st=pe(De,$e)??"",rt=Ye[st],yt=rt?le(rt):[],Ot=ye(De,yt),Bt=_e.getIfExists(Ot),kt=(0,c.useCallback)(en=>{en?.value&&oe({...De,fieldName:en.value})},[oe,De]),$t=(0,c.useCallback)(en=>{if(!en?.value)return;const xn=en.value,ma=Q.hI.get(xn).getDefaultOptions(rt);oe({...De,config:{id:xn,options:ma}})},[oe,De,rt]),Gt=(0,c.useCallback)(en=>{oe({...De,config:{...De.config,options:en}})},[oe,De]);return!rt||!Bt||!Bt.component?null:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-value-filter-editor.label-field","Field"),labelWidth:14,children:(0,z.jsx)(Me.l6,{className:"min-width-15 max-width-24",placeholder:(0,u.t)("transformers.filter-by-value-filter-editor.placeholder-field-name","Field name"),options:$e,value:De.fieldName,onChange:kt})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-value-filter-editor.label-match","Match"),children:(0,z.jsx)(Me.l6,{className:"width-12",placeholder:(0,u.t)("transformers.filter-by-value-filter-editor.placeholder-select-test","Select test"),options:yt,value:Ot,onChange:$t})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-value-filter-editor.label-value","Value"),grow:!0,children:(0,z.jsx)(Bt.component,{field:rt,options:De.config.options??{},onChange:Gt})}),(0,z.jsx)(he.a,{marginBottom:.5,children:(0,z.jsx)(me.$n,{icon:"times",onClick:ee,variant:"secondary"})})]})},le=re=>{const ee=[];for(const oe of Q.hI.list())!oe.isApplicable(re)||!_e.getIfExists(oe.id)||ee.push({value:oe.id,label:oe.name,description:oe.description});return ee},ye=(re,ee)=>{const oe=ee.find(De=>De.value===re.config.id);if(oe&&oe.value)return oe.value;if(ee[0]?.value)return ee[0]?.value},pe=(re,ee)=>{const oe=ee.find(De=>De.value===re.fieldName);if(oe&&oe.value)return oe.value;if(ee[0]?.value)return ee[0]?.value},ve=re=>{const{input:ee,options:oe,onChange:De}=re,je=Oe(ee),$e=[{label:(0,u.t)("transformers.filter-by-value-transformer-editor.filter-types.label.include","Include"),value:ue.j4.include},{label:(0,u.t)("transformers.filter-by-value-transformer-editor.filter-types.label.exclude","Exclude"),value:ue.j4.exclude}],Ye=[{label:(0,u.t)("transformers.filter-by-value-transformer-editor.filter-match.label.match-all","Match all"),value:ue.Sm.all},{label:(0,u.t)("transformers.filter-by-value-transformer-editor.filter-match.label.match-any","Match any"),value:ue.Sm.any}],st=(0,c.useCallback)(()=>{const kt=ee[0],$t=kt.fields.find(xn=>xn.type!==X.PU.time);if(!$t)return;const Gt=(0,Y.cloneDeep)(oe.filters),en=Q.hI.get(q.Js.isNull);Gt.push({fieldName:(0,te.Ct)($t,kt,ee),config:{id:en.id,options:en.getDefaultOptions($t)}}),De({...oe,filters:Gt})},[De,oe,ee]),rt=(0,c.useCallback)(kt=>{let $t=(0,Y.cloneDeep)(oe.filters);$t.splice(kt,1),De({...oe,filters:$t})},[oe,De]),yt=(0,c.useCallback)((kt,$t)=>{let Gt=(0,Y.cloneDeep)(oe.filters);Gt[$t]=kt,De({...oe,filters:Gt})},[oe,De]),Ot=(0,c.useCallback)(kt=>{De({...oe,type:kt??ue.j4.include})},[oe,De]),Bt=(0,c.useCallback)(kt=>{De({...oe,match:kt??ue.Sm.all})},[oe,De]);return(0,z.jsxs)("div",{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-value-transformer-editor.label-filter-type","Filter type"),labelWidth:16,children:(0,z.jsx)("div",{className:"width-15",children:(0,z.jsx)(ie.z,{options:$e,value:oe.type,onChange:Ot,fullWidth:!0})})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-value-transformer-editor.label-conditions","Conditions"),labelWidth:16,children:(0,z.jsx)("div",{className:"width-15",children:(0,z.jsx)(ie.z,{options:Ye,value:oe.match,onChange:Bt,fullWidth:!0})})}),(0,z.jsxs)(he.a,{paddingLeft:2,children:[oe.filters.map((kt,$t)=>(0,z.jsx)(Xe,{filter:kt,fieldsInfo:je,onChange:Gt=>yt(Gt,$t),onDelete:()=>rt($t)},$t)),(0,z.jsx)(me.$n,{icon:"plus",size:"sm",onClick:st,variant:"secondary",children:(0,z.jsx)(u.x6,{i18nKey:"transformers.filter-by-value-transformer-editor.add-condition",children:"Add condition"})})]})]})},be={id:ne.F.filterByValue,editor:ve,transformation:se.c.filterByValueTransformer,name:se.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([y.m.Filter]),help:Pe(ne.F.filterByValue).helperDocs},Oe=re=>(0,c.useMemo)(()=>{const ee={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(re)?re.reduce((oe,De)=>De.fields.reduce((je,$e)=>{const Ye=(0,te.Ct)($e,De,re);return je.fieldByDisplayName[Ye]||(je.fieldsAsOptions.push({label:Ye,value:Ye,type:$e.type}),je.fieldByDisplayName[Ye]=$e),je},oe),ee):ee},[re]);var we=e(11594),ze=e(52205),Ve=e(25797),ge=e(56424),Ke=e(61215);function qe(re,ee){const oe={data:re.input,options:re.options},De=new Ve.C({id:"root",title:(0,u.t)("transformers.get-transformer-option-pane.root.title.root","root")}),je=Ye=>{if(Ye?.length){const st=Ye[0];let rt=De.categories.find(yt=>yt.props.id===st);return rt||(rt=new Ve.C({id:st,title:st}),De.categories.push(rt)),rt}return De},$e={getValue:Ye=>(0,Y.get)(re.options,Ye),onChange:(Ye,st)=>{re.onChange((0,Ke.Sf)(re.options,Ye,st))}};return(0,ge.g5)(ee,$e,je,oe),De}function ot(re){const ee={data:[],options:{}},oe={},De=new ze.pv;re(De,ee);for(const je of De.getItems())je.defaultValue!=null&&(0,Y.set)(oe,je.path,je.defaultValue);return oe}var lt=e(13572),mt=e(48264);const Lt=(re,ee)=>{const oe=ee.options??{};(0,lt.J)("",re,oe)},Tt=re=>{(0,c.useEffect)(()=>{if(!re.options.xBuckets?.mode){const oe=ot(Lt);re.onChange({...oe,...re.options})}});const ee=qe(re,Lt);return(0,z.jsx)("div",{children:(0,z.jsx)("div",{children:ee.items.map(oe=>oe.render())})})},It={id:mt.wY.id,editor:Tt,transformation:mt.wY,name:mt.wY.name,description:mt.wY.description,state:we.pn.alpha,categories:new Set([y.m.CreateNewVisualization]),help:Pe(mt.wY.id).helperDocs};var Mt=e(22803),Ut=e(63142),an=e(63152),cn=e(46644),un=e(34107),On=e(64394),yn=e(13227),En=e(33553),Bn=e(18600);function fa(re,ee,oe){const De={},je={};for(const $e of re.fields){const Ye=(0,te.Ct)($e,re),st=oe.index[Ye],rt=st.handler;if(!rt)continue;const yt=$e.values[ee];if(yt==null)continue;const Ot=rt.processor(yt,De,je,st.handlerArguments);Ot!=null&&(De[rt.targetProperty??rt.key]=Ot)}return je.mappingValues&&(De.mappings=gt(je)),De}var Fn=(re=>(re.Name="field.name",re.Value="field.value",re.Label="field.label",re.Ignore="__ignore",re))(Fn||{});const Ea=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Yt},{key:"min",processor:Yt},{key:"unit",processor:re=>re.toString()},{key:"decimals",processor:Yt},{key:"displayName",name:"Display name",processor:re=>re.toString()},{key:"color",processor:re=>({fixedColor:re,mode:On.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(re,ee,oe,De)=>{const je=(0,yn.t)(re);if(!isNaN(je))return ee.thresholds||(ee.thresholds={mode:En.O.Absolute,steps:[]}),ee.thresholds.steps.push({value:je,color:De.threshold?.color??"red"}),ee.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:cn.gy.allValues,processor:(re,ee,oe)=>{if((0,Y.isArray)(re))return oe.mappingValues=re,ee.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:cn.gy.allValues,processor:(re,ee,oe)=>{if((0,Y.isArray)(re))return oe.mappingColors=re,ee.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:cn.gy.allValues,processor:(re,ee,oe)=>{if((0,Y.isArray)(re))return oe.mappingTexts=re,ee.mappings}}];function gt(re){const ee={type:Bn.d.ValueToText,options:{}};if(!re.mappingValues)return[];for(let oe=0;oe<re.mappingValues.length;oe++){const De=re.mappingValues[oe];De!=null&&(ee.options[De.toString()]={color:re.mappingColors&&re.mappingColors[oe],text:re.mappingTexts&&re.mappingTexts[oe],index:oe})}return[ee]}let Ht=null;function wt(){if(Ht===null){Ht={};for(const re of Ea)Ht[re.key]=re}return Ht}function Yt(re){const ee=(0,yn.t)(re);if(!isNaN(ee))return ee}function rn(re,ee){for(const oe of ee)if(re===oe.fieldName)return oe.handlerKey;return re.toLowerCase()}function Xt(re){return re?wt()[re]:null}function on(re,ee,oe){const De={index:{}};let je=ee.find(Ye=>Ye.handlerKey==="field.name"),$e=ee.find(Ye=>Ye.handlerKey==="field.value");for(const Ye of re.fields){const st=(0,te.Ct)(Ye,re),rt=ee.find(Bt=>Bt.fieldName===st),yt=rt?rt.handlerKey:st.toLowerCase();let Ot=Xt(yt);oe&&(Ot?(Ot.key==="field.name"&&(De.nameField=Ye),Ot.key==="field.value"&&(De.valueField=Ye)):rt||(!De.nameField&&!je&&Ye.type===X.PU.string&&(De.nameField=Ye,Ot=Xt("field.name")),!De.valueField&&!$e&&Ye.type===X.PU.number&&(De.valueField=Ye,Ot=Xt("field.value")))),!Ot&&oe&&(Ot=Xt("field.label")),De.index[st]={automatic:!rt,handler:Ot,handlerArguments:rt?.handlerArguments??{},reducerId:rt?.reducerId??Ot?.defaultReducer??cn.gy.lastNotNull}}return De}var pn=e(63527),Un=e(35427);function In(re){switch(re){case"threshold1":return!0;default:return!1}}function Gn({handlerArguments:re,handlerKey:ee,onChange:oe}){const De=je=>{oe(je?{...re,threshold:{...re.threshold,color:je}}:{...re,threshold:void 0})};return(0,z.jsx)(z.Fragment,{children:ee==="threshold1"&&(0,z.jsx)(pn.p,{type:"text",value:"Threshold color","aria-label":(0,u.t)("transformers.field-config-mapping-handler-arguments-editor.aria-label-threshold-color","Threshold color"),disabled:!0,width:20,prefix:(0,z.jsx)(Un.sk,{color:re.threshold?.color??"red",onChange:De,enableNamedColors:!0})})})}function Wa({frame:re,mappings:ee,onChange:oe,withReducers:De,withNameAndValue:je}){const $e=(0,Ut.of)(ss),Ye=za(re,ee,je),st=Ea.map(kt=>Oa(kt,!1)),rt=ee.reduce((kt,$t)=>kt||In($t.handlerKey),!1),yt=(kt,$t)=>{const Gt=ee.findIndex(en=>en.fieldName===kt.fieldName);if($t)if(Gt!==-1){const en=[...ee];en.splice(Gt,1,{...ee[Gt],handlerKey:$t.value}),oe(en)}else oe([...ee,{fieldName:kt.fieldName,handlerKey:$t.value}]);else oe(Gt!==-1?ee.filter((en,xn)=>xn!==Gt):[...ee,{fieldName:kt.fieldName,handlerKey:"__ignore"}])},Ot=(kt,$t)=>{const Gt=ee.findIndex(en=>en.fieldName===kt.fieldName);if(Gt!==-1){const en=[...ee];en.splice(Gt,1,{...ee[Gt],reducerId:$t}),oe(en)}else oe([...ee,{fieldName:kt.fieldName,handlerKey:kt.handlerKey,reducerId:$t}])},Bt=(kt,$t)=>{const Gt=ee.findIndex(en=>en.fieldName===kt.fieldName);if(Gt!==-1){const en=[...ee];en.splice(Gt,1,{...ee[Gt],handlerArguments:$t}),oe(en)}else oe([...ee,{fieldName:kt.fieldName,handlerKey:kt.handlerKey,handlerArguments:$t}])};return(0,z.jsxs)("table",{className:$e.table,children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.field-to-config-mapping-editor.field",children:"Field"})}),(0,z.jsx)("th",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.field-to-config-mapping-editor.use-as",children:"Use as"})}),De&&(0,z.jsx)("th",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.field-to-config-mapping-editor.select",children:"Select"})}),rt&&(0,z.jsx)("th",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.field-to-config-mapping-editor.additional-settings",children:"Additional settings"})})]})}),(0,z.jsx)("tbody",{children:Ye.map(kt=>(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:$e.labelCell,children:kt.fieldName}),(0,z.jsx)("td",{className:$e.selectCell,"data-testid":`${kt.fieldName}-config-key`,children:(0,z.jsx)(Me.l6,{options:st,value:kt.configOption,placeholder:kt.placeholder,isClearable:!0,onChange:$t=>yt(kt,$t)})}),De&&(0,z.jsx)("td",{"data-testid":`${kt.fieldName}-reducer`,className:$e.selectCell,children:(0,z.jsx)(un.S,{stats:[kt.reducerId],defaultStat:kt.reducerId,onChange:$t=>Ot(kt,$t[0])})}),rt&&(0,z.jsx)("td",{"data-testid":`${kt.fieldName}-handler-arg`,className:$e.selectCell,children:(0,z.jsx)(Gn,{handlerKey:kt.handlerKey,handlerArguments:kt.handlerArguments,onChange:$t=>Bt(kt,$t)})})]},kt.fieldName))})]})}function za(re,ee,oe){const De=[],je=on(re,ee??[],oe);for(const $e of re.fields){const Ye=(0,te.Ct)($e,re),st=je.index[Ye],rt=Oa(st.handler,st.automatic);De.push({fieldName:Ye,configOption:st.automatic?null:rt,placeholder:st.automatic?rt?.label:"Choose",handlerKey:st.handler?.key??null,reducerId:st.reducerId,handlerArguments:st.handlerArguments})}for(const $e of ee)if(!De.find(Ye=>Ye.fieldName===$e.fieldName)){const Ye=Xt($e.handlerKey);De.push({fieldName:$e.fieldName,handlerKey:$e.handlerKey,configOption:Oa(Ye,!1),missingInFrame:!0,reducerId:$e.reducerId??cn.gy.lastNotNull,handlerArguments:{}})}return Object.values(De)}function Oa(re,ee){if(!re)return null;let oe=re.name??(0,Y.capitalize)(re.key);return ee&&(oe=`${oe} (auto)`),{label:oe,value:re.key}}const ss=re=>({table:(0,Mt.css)({marginTop:re.spacing(1),"td, th":{borderRight:`4px solid ${re.colors.background.primary}`,borderBottom:`4px solid ${re.colors.background.primary}`,whiteSpace:"nowrap"},th:{fontSize:re.typography.bodySmall.fontSize,lineHeight:re.spacing(4),padding:re.spacing(0,1)}}),labelCell:(0,Mt.css)({fontSize:re.typography.bodySmall.fontSize,background:re.colors.background.secondary,padding:re.spacing(0,1),maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",minWidth:"140px"}),selectCell:(0,Mt.css)({padding:0,minWidth:"161px"})});var La=e(81160);function Ca(re,ee){let oe=null;for(const st of ee)if(st.refId===re.configRefId){oe=st;break}if(!oe)return ee;const De={fields:[],length:1},je=on(oe,re.mappings??[],!1);for(const st of oe.fields){const rt={...st},yt=(0,te.Ct)(st,oe),Ot=je.index[yt],Bt=(0,cn.Nw)({field:st,reducers:[Ot.reducerId]});rt.values=[Bt[Ot.reducerId]],De.fields.push(rt)}const $e=[],Ye=(0,Q.NS)(re.applyTo||{id:q.Ct.numeric});for(const st of ee){if(st===oe&&ee.length>1)continue;const rt={fields:[],length:st.length,refId:st.refId};for(const yt of st.fields)if(Ye(yt,st,ee)){const Ot=fa(De,0,je);rt.fields.push({...yt,config:{...yt.config,...Ot}})}else rt.fields.push(yt);$e.push(rt)}return $e}const Ka={id:ne.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:re=>ee=>ee.pipe((0,La.T)(oe=>Ca(re,oe)))};function As({input:re,onChange:ee,options:oe}){const De=(0,Ut.of)(_s),je=re.map($t=>$t.refId).filter($t=>$t!=null).map($t=>({label:$t,value:$t})),$e=oe.configRefId||"config",Ye=oe.applyTo??{id:q.Ct.byType,options:"number"},st=an.g.get(Ye.id),rt=re.find($t=>$t.refId===$e),yt=$t=>{ee({...oe,configRefId:$t.value||"config"})},Ot=$t=>{ee({...oe,applyTo:{id:$t.value}})},Bt=$t=>{ee({...oe,applyTo:{id:Ye.id,options:$t}})},kt=an.g.list().filter($t=>!$t.excludeFromPicker).map($t=>({label:$t.name,value:$t.id,description:$t.description}));return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.config-from-query-transformer-editor.label-config-query","Config query"),labelWidth:20,children:(0,z.jsx)(Me.l6,{onChange:yt,options:je,value:$e,width:30})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.config-from-query-transformer-editor.label-apply-to","Apply to"),labelWidth:20,children:(0,z.jsx)(Me.l6,{onChange:Ot,options:kt,value:Ye.id,width:30})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.config-from-query-transformer-editor.label-apply-to-options","Apply to options"),labelWidth:20,className:De.matcherOptions,children:(0,z.jsx)(st.component,{matcher:st.matcher,data:re,options:Ye.options,onChange:Bt})})}),(0,z.jsx)(Se.C,{children:rt&&(0,z.jsx)(Wa,{frame:rt,mappings:oe.mappings,onChange:$t=>ee({...oe,mappings:$t}),withReducers:!0})})]})}const Ia={id:Ka.id,editor:As,transformation:Ka,name:Ka.name,description:Ka.description,state:we.pn.beta,categories:new Set([y.m.CalculateNewFields]),help:Pe(Ka.id).helperDocs},_s=re=>({matcherOptions:(0,Mt.css)({minWidth:"404px"})});var Fa=e(62467),xt=e(84691),dt=e(2863),St=e(21285),jt=e(12823),Qt=e(97958);const Jt=17,ln=re=>{const{options:ee,onChange:oe}=re,De=(0,xt.pR)(re.options.binary?.left??"",re.names),je=(0,xt.pR)(re.options.binary?.right??"",re.names);(De!==re.options.binary?.left||je!==re.options.binary?.right)&&oe({...ee,mode:xt.UY.BinaryOperation,binary:{operator:ee.binary?.operator,left:De,right:je}});const{binary:$e}=ee;let Ye=!$e?.left,st=!$e?.right;const rt=!$e?.left?.matcher,yt=!$e?.right?.matcher,Ot=$e?.left?.matcher?.options,Bt=$e?.right?.matcher?.options,kt=$e?.left?.matcher?.id===q.Ct.byName,$t=$e?.right?.matcher?.id===q.Ct.byName,Gt=re.names.map(Na=>(kt&&Na===Ot&&(Ye=!0),$t&&Na===Bt&&(st=!0),{label:Na,value:JSON.stringify({matcher:{id:q.Ct.byName,options:Na}})})),en=Ye?[...Gt]:kt?[...Gt,{label:Ot,value:JSON.stringify($e.left),icon:""}]:[...Gt],xn=st?[...Gt]:$t?[...Gt,{label:Bt,value:JSON.stringify($e.right),icon:""}]:[...Gt];en.push({label:`All ${X.PU.number} fields`,value:JSON.stringify({matcher:{id:q.Ct.byType,options:X.PU.number}}),icon:(0,Qt.lV)(X.PU.number)}),rt&&$e?.left?.fixed&&en.push({label:$e.left.fixed,value:JSON.stringify($e.left)??"",icon:""}),yt&&$e?.right?.fixed&&xn.push({label:$e.right.fixed,value:JSON.stringify($e.right)??"",icon:""});const ma=jt.b.list().map(Na=>({label:Na.binaryOperationID,value:Na.binaryOperationID})),Da=Na=>{oe({...ee,mode:xt.UY.BinaryOperation,binary:Na})},xa=Na=>{const Is=JSON.parse(Na.value??"");Is.matcher?Da({...$e,left:Is}):Da({...$e,left:{fixed:Is.fixed??Na.value?.toString()}})},$n=Na=>{const Is=JSON.parse(Na.value??"");Is.matcher?Da({...$e,right:Is}):Da({...$e,right:{fixed:Is.fixed??Na.value?.toString()}})},oa=Na=>{Da({...$e,operator:Na.value})};return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.binary-operation-options-editor.label-operation","Operation"),labelWidth:Jt,children:(0,z.jsx)(Me.l6,{allowCustomValue:!0,placeholder:(0,u.t)("transformers.binary-operation-options-editor.placeholder-fields-or-number","Field(s) or number"),options:en,className:"min-width-18",value:JSON.stringify($e?.left),onChange:xa})}),(0,z.jsx)(de.I,{children:(0,z.jsx)(Me.l6,{className:"width-4",options:ma,value:$e?.operator??ma[0].value,onChange:oa})}),(0,z.jsx)(de.I,{children:(0,z.jsx)(Me.l6,{allowCustomValue:!0,placeholder:(0,u.t)("transformers.binary-operation-options-editor.placeholder-field-or-number","Field or number"),className:"min-width-10",options:xn,value:JSON.stringify($e?.right),onChange:$n})})]})})},fn=re=>{const{names:ee,onChange:oe,options:De}=re,{cumulative:je}=De,$e=ee.map(yt=>({label:yt,value:yt})),Ye=yt=>{const Ot=yt.length?yt[0]:cn.gy.sum;st({...je,reducer:Ot})},st=yt=>{oe({...De,mode:xt.UY.CumulativeFunctions,cumulative:yt})},rt=yt=>{st({...je,field:yt.value})};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.cumulative-options-editor.label-field","Field"),labelWidth:Jt,children:(0,z.jsx)(Me.l6,{placeholder:(0,u.t)("transformers.cumulative-options-editor.placeholder-field","Field"),options:$e,className:"min-width-18",value:je?.field,onChange:rt})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.cumulative-options-editor.label-calculation","Calculation"),labelWidth:Jt,children:(0,z.jsx)(un.S,{allowMultiple:!1,className:"width-18",stats:[je?.reducer||cn.gy.sum],onChange:Ye,defaultStat:cn.gy.sum,filterOptions:yt=>yt.id===cn.gy.sum||yt.id===cn.gy.mean})})]})},gn=re=>{const{options:ee,onChange:oe}=re,{index:De}=ee,je=$e=>{oe({...ee,index:{asPercentile:$e.currentTarget.checked}})};return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(de.I,{labelWidth:Jt,label:(0,u.t)("transformers.index-options-editor.label-as-percentile","As percentile"),tooltip:(0,u.t)("transformers.index-options-editor.tooltip-transform-index-percentile","Transform the row index as a percentile."),children:(0,z.jsx)(St.K,{value:!!De?.asPercentile,onChange:je})})})};var vn=e(41654),wn=e(34343);const Rt=re=>{const{names:ee,selected:oe,onChange:De,options:je}=re,{reduce:$e}=je,Ye=Ot=>{De({...je,reduce:Ot})},st=Ot=>{oe.indexOf(Ot)>-1?rt(oe.filter(Bt=>Bt!==Ot)):rt([...oe,Ot])},rt=Ot=>{Ye({...$e,include:Ot})},yt=Ot=>{const Bt=Ot.length?Ot[0]:cn.gy.sum,{reduce:kt}=je;Ye({...kt,reducer:Bt})};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.reduce-row-options-editor.label-operation","Operation"),labelWidth:Jt,shrink:!0,children:(0,z.jsx)(vn.B,{gap:.5,direction:"row",alignItems:"flex-start",wrap:!0,children:ee.map((Ot,Bt)=>(0,z.jsx)(wn.m,{onClick:()=>{st(Ot)},label:Ot,selected:oe.indexOf(Ot)>-1},`${Ot}/${Bt}`))})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.reduce-row-options-editor.label-calculation","Calculation"),labelWidth:Jt,children:(0,z.jsx)(un.S,{allowMultiple:!1,className:"width-18",stats:[$e?.reducer||cn.gy.sum],onChange:yt,defaultStat:cn.gy.sum})})]})};var bt=e(48233);const Vt=re=>{const{options:ee,onChange:oe}=re,{unary:De}=ee,je=Bt=>{oe({...ee,mode:xt.UY.UnaryOperation,unary:Bt})},$e=Bt=>{je({...De,operator:Bt.value})},Ye=Bt=>{je({...De,fieldName:Bt.value})};let st=!De?.fieldName;const rt=re.names.map(Bt=>(Bt===De?.fieldName&&(st=!0),{label:Bt,value:Bt})),yt=bt.j.list().map(Bt=>({label:Bt.unaryOperationID,value:Bt.unaryOperationID})),Ot=st?rt:[...rt,{label:De?.fieldName,value:De?.fieldName}];return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.unary-operation-editor.label-operation","Operation"),labelWidth:Jt,children:(0,z.jsx)(Me.l6,{options:yt,value:De?.operator??yt[0].value,onChange:$e})}),(0,z.jsx)(de.I,{label:"(",labelWidth:2,children:(0,z.jsx)(Me.l6,{placeholder:(0,u.t)("transformers.unary-operation-editor.placeholder-field","Field"),className:"min-width-11",options:Ot,value:De?.fieldName,onChange:Ye})}),(0,z.jsx)(Ne.c,{width:2,children:")"})]})})};var Kt=e(19753);const Dt=re=>{const{options:ee,names:oe,onChange:De}=re,{window:je}=ee,$e=oe.map(Gt=>({label:Gt,value:Gt})),Ye=[{label:(0,u.t)("transformers.window-options-editor.type-options.label.trailing","Trailing"),value:xt.ip.Trailing},{label:(0,u.t)("transformers.window-options-editor.type-options.label.centered","Centered"),value:xt.ip.Centered}],st=[{label:(0,u.t)("transformers.window-options-editor.window-size-mode-options.label.percentage","Percentage"),value:xt.Bp.Percentage},{label:(0,u.t)("transformers.window-options-editor.window-size-mode-options.label.fixed","Fixed"),value:xt.Bp.Fixed}],rt=Gt=>{De({...ee,mode:xt.UY.WindowFunctions,window:Gt})},yt=Gt=>{rt({...je,field:Gt.value})},Ot=Gt=>{rt({...je,windowSize:Gt&&je?.windowSizeMode===xt.Bp.Percentage?Gt/100:Gt})},Bt=Gt=>{rt({...je,windowSize:je?.windowSize?Gt===xt.Bp.Percentage?je.windowSize/100:je.windowSize*100:void 0,windowSizeMode:Gt})},kt=Gt=>{const en=Gt.length?Gt[0]:cn.gy.sum;rt({...je,reducer:en})},$t=Gt=>{rt({...je,windowAlignment:Gt})};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.window-options-editor.label-field","Field"),labelWidth:Jt,children:(0,z.jsx)(Me.l6,{placeholder:(0,u.t)("transformers.window-options-editor.placeholder-field","Field"),options:$e,className:"min-width-18",value:je?.field,onChange:yt})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.window-options-editor.label-calculation","Calculation"),labelWidth:Jt,children:(0,z.jsx)(un.S,{allowMultiple:!1,className:"width-18",stats:[je?.reducer||cn.gy.mean],onChange:kt,defaultStat:cn.gy.mean,filterOptions:Gt=>Gt.id===cn.gy.mean||Gt.id===cn.gy.variance||Gt.id===cn.gy.stdDev})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.window-options-editor.label-type","Type"),labelWidth:Jt,children:(0,z.jsx)(ie.z,{value:je?.windowAlignment??xt.ip.Trailing,options:Ye,onChange:$t})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.window-options-editor.label-window-size-mode","Window size mode"),labelWidth:Jt,children:(0,z.jsx)(ie.z,{value:je?.windowSizeMode??xt.Bp.Percentage,options:st,onChange:Bt})}),(0,z.jsx)(de.I,{label:je?.windowSizeMode===xt.Bp.Percentage?(0,u.t)("transformers.window-options-editor.label-window-size-percent","Window size %"):(0,u.t)("transformers.window-options-editor.label-window-size","Window size"),labelWidth:Jt,tooltip:je?.windowSizeMode===xt.Bp.Percentage?(0,u.t)("transformers.window-options-editor.tooltip-window-size-percent","Set the window size as a percentage of the total data"):(0,u.t)("transformers.window-options-editor.tooltip-window-size","Window size"),children:(0,z.jsx)(Kt.Q,{placeholder:(0,u.t)("transformers.window-options-editor.placeholder-auto","Auto"),min:.1,value:je?.windowSize&&je.windowSizeMode===xt.Bp.Percentage?je.windowSize*100:je?.windowSize,onChange:Ot})})]})},Zt=[{value:xt.UY.BinaryOperation,label:"Binary operation"},{value:xt.UY.UnaryOperation,label:"Unary operation"},{value:xt.UY.ReduceRow,label:"Reduce row"},{value:xt.UY.Index,label:"Row index"}];J.$.featureToggles.addFieldFromCalculationStatFunctions&&Zt.push({value:xt.UY.CumulativeFunctions,label:"Cumulative functions"},{value:xt.UY.WindowFunctions,label:"Window functions"});const Ln=new Set([X.PU.time,X.PU.number,X.PU.string,X.PU.boolean]),Qn=re=>{const{options:ee,onChange:oe,input:De}=re,je=ee?.reduce?.include,[$e,Ye]=(0,c.useState)({names:[],selected:[]});(0,c.useEffect)(()=>{const en={interpolate:ma=>ma},xn=(0,Fa.of)(De).pipe(se.c.ensureColumnsTransformer.operator(null,en),rt(),st(),yt(je||[])).subscribe(({selected:ma,names:Da})=>{Ye({names:Da,selected:ma})});return()=>{xn.unsubscribe()}},[De,je]);const st=()=>{const en=(0,dt.w)();return xn=>xn.pipe((0,La.T)(ma=>(ma.push(...en.getVariables().map(Da=>"$"+Da.name)),ma)))},rt=()=>en=>en.pipe((0,La.T)(xn=>{const ma=[],Da={};for(const xa of xn)for(const $n of xa.fields){if(!Ln.has($n.type))continue;const oa=(0,te.Ct)($n,xa,xn);Da[oa]||(Da[oa]=!0,ma.push(oa))}return ma})),yt=en=>xn=>xn.pipe((0,La.T)(ma=>{if(!en.length)return{names:ma,selected:[]};const Da=[],xa=[];for(const $n of ma)en.includes($n)&&xa.push($n),Da.push($n);return{names:Da,selected:xa}})),Ot=en=>{oe({...ee,replaceFields:en.currentTarget.checked})},Bt=en=>{const xn=en.value??xt.UY.BinaryOperation;xn===xt.UY.WindowFunctions&&(ee.window=ee.window??xt.Uj),oe({...ee,mode:xn})},kt=en=>{oe({...ee,alias:en.target.value})},$t=ee.mode??xt.UY.BinaryOperation,Gt=$t===xt.UY.BinaryOperation&&ee.binary?.left.matcher?.id===q.Ct.byType;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{labelWidth:Jt,label:(0,u.t)("transformers.calculate-field-transformer-editor.label-mode","Mode"),children:(0,z.jsx)(Me.l6,{className:"width-18",options:Zt,value:Zt.find(en=>en.value===$t),onChange:Bt})}),$t===xt.UY.BinaryOperation&&(0,z.jsx)(ln,{options:ee,names:$e.names,onChange:re.onChange}),$t===xt.UY.UnaryOperation&&(0,z.jsx)(Vt,{names:$e.names,options:ee,onChange:re.onChange}),$t===xt.UY.ReduceRow&&(0,z.jsx)(Rt,{names:$e.names,selected:$e.selected,options:ee,onChange:re.onChange}),$t===xt.UY.CumulativeFunctions&&(0,z.jsx)(fn,{names:$e.names,options:ee,onChange:re.onChange}),$t===xt.UY.WindowFunctions&&(0,z.jsx)(Dt,{names:$e.names,options:ee,onChange:re.onChange}),$t===xt.UY.Index&&(0,z.jsx)(gn,{options:ee,onChange:re.onChange}),(0,z.jsx)(de.I,{labelWidth:Jt,label:(0,u.t)("transformers.calculate-field-transformer-editor.label-alias","Alias"),disabled:Gt,children:(0,z.jsx)(pn.p,{className:"width-18",value:ee.alias??"",placeholder:(0,xt.sw)(ee),onChange:kt})}),(0,z.jsx)(de.I,{labelWidth:Jt,label:(0,u.t)("transformers.calculate-field-transformer-editor.label-replace-all-fields","Replace all fields"),children:(0,z.jsx)(St.K,{value:!!ee.replaceFields,onChange:Ot})})]})},va={id:ne.F.calculateField,editor:Qn,transformation:se.c.calculateFieldTransformer,name:se.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([y.m.CalculateNewFields]),help:Pe(ne.F.calculateField).helperDocs};var Wn=e(9287);const ia=[{value:Wn.x1.FieldName,label:"Copy frame name to field name"},{value:Wn.x1.Label,label:"Add a label with the frame name"},{value:Wn.x1.Drop,label:"Ignore the frame name"}];class kn extends c.PureComponent{constructor(ee){super(ee),this.onModeChanged=oe=>{const{options:De,onChange:je}=this.props,$e=oe.value??Wn.x1.FieldName;je({...De,frameNameMode:$e})},this.onLabelChanged=oe=>{const{options:De}=this.props;this.props.onChange({...De,frameNameLabel:oe.target.value})}}render(){const{options:ee}=this.props,oe=ee.frameNameMode??Wn.x1.FieldName;return(0,z.jsxs)("div",{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.concatenate-transformer-editor.label-name","Name"),labelWidth:16,grow:!0,children:(0,z.jsx)(Me.l6,{width:36,options:ia,value:ia.find(De=>De.value===oe),onChange:this.onModeChanged})}),oe===Wn.x1.Label&&(0,z.jsx)(de.I,{label:(0,u.t)("transformers.concatenate-transformer-editor.label-label","Label"),labelWidth:16,grow:!0,children:(0,z.jsx)(pn.p,{width:36,value:ee.frameNameLabel??"",placeholder:(0,u.t)("transformers.concatenate-transformer-editor.placeholder-frame","Frame"),onChange:this.onLabelChanged})})]})}}const na={id:ne.F.concatenate,editor:kn,transformation:se.c.concatenateTransformer,name:se.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([y.m.Combine]),help:Pe(ne.F.concatenate).helperDocs};var Ga=e(62717),Ps=e(62693),ls=e(48457),Ta=e(32503),aa=e(89332),Gs=e(32881),Os=e(30703),Zs=e(12594),lr=e(76319);const Xs=({transformIndex:re,value:ee,index:oe,mappedIndex:De,onChangeEnumValue:je,onRemoveEnumRow:$e,checkIsEnumUniqueValue:Ye})=>{const st=(0,Ut.of)(jo),[rt,yt]=(0,c.useState)(ee),[Ot,Bt]=(0,c.useState)(rt===""),[kt,$t]=(0,c.useState)(null),Gt=(0,c.useRef)(null);(0,c.useEffect)(()=>{Gt.current&&Gt.current.focus()},[Gt]);const en=$n=>{$n.currentTarget.value!==""&&Ye($n.currentTarget.value)&&$n.currentTarget.value!==ee?$t("Enum value already exists"):$t(null),yt($n.currentTarget.value)},xn=()=>{if(Bt(!1),$t(null),rt===""||kt!==null){$e(De);return}je(De,rt)},ma=$n=>{$n.key==="Enter"&&($n.preventDefault(),xn())},Da=()=>{Bt(!0)},xa=()=>{$e(De)};return(0,z.jsx)(aa.sx,{draggableId:`${re}/${ee}`,index:oe,children:$n=>(0,z.jsxs)("tr",{ref:$n.innerRef,...$n.draggableProps,children:[(0,z.jsx)("td",{children:(0,z.jsx)("div",{className:st.dragHandle,...$n.dragHandleProps,children:(0,z.jsx)(Os.I,{name:"draggabledots",size:"lg"})})}),Ot?(0,z.jsxs)("td",{children:[(0,z.jsx)(pn.p,{ref:Gt,type:"text",value:rt,onChange:en,onBlur:xn,onKeyDown:ma}),kt&&(0,z.jsx)(Zs.P,{children:kt})]}):(0,z.jsx)("td",{onClick:Da,className:st.clickableTableCell,children:ee&&ee!==""?ee:(0,u.t)("transformers.enum-mapping-row.click-to-edit","Click to edit")}),(0,z.jsx)("td",{className:st.textAlignCenter,children:(0,z.jsx)(Gs.Gy,{spacing:"sm",children:(0,z.jsx)(lr.K,{name:"trash-alt",onClick:xa,"data-testid":"remove-enum-row","aria-label":(0,u.t)("transformers.enum-mapping-row.remove-enum-row-aria-label-delete-enum-row","Delete enum row"),tooltip:(0,u.t)("transformers.enum-mapping-row.remove-enum-row-tooltip-delete","Delete")})})})]},oe)},`${re}/${ee}`)},jo=re=>({dragHandle:(0,Mt.css)({cursor:"grab"}),textAlignCenter:(0,Mt.css)({textAlign:"center"}),clickableTableCell:(0,Mt.css)({cursor:"pointer",width:"100px","&:hover":{color:re.colors.text.maxContrast}})}),ci=Xs,Xr=({input:re,options:ee,transformIndex:oe,onChange:De})=>{const je=(0,Ut.of)(vs),[$e,Ye]=(0,c.useState)(ee.conversions[oe].enumConfig?.text??[]);(0,c.useEffect)(()=>{!ee.conversions[oe].enumConfig?.text?.length&&re.length&&st()},[re]),(0,c.useEffect)(()=>{(()=>{const en=$e.map(Da=>Da),xn=ee.conversions,ma={text:en};xn[oe]={...xn[oe],enumConfig:ma},De({...ee,conversions:xn})})()},[oe,$e]);const st=()=>{const Gt=re.flatMap(xn=>xn?.fields??[]).find(xn=>xn.name===ee.conversions[oe].targetField);if(!Gt)return;const en=new Set(Gt?.values);$e.length>0&&!(0,Y.isEqual)($e,Array.from(en))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||Ye([...en])},rt=(Gt,en)=>{const xn=[...$e];xn.splice(Gt,1,en),Ye(xn)},yt=Gt=>{const en=[...$e];en.splice(Gt,1),Ye(en)},Ot=()=>{Ye(["",...$e])},Bt=(Gt,en)=>{$e.includes(en)||rt(Gt,en)},kt=Gt=>$e.includes(Gt),$t=Gt=>{if(!Gt.destination)return;const en=$e.length-Gt.source.index-1,xn=$e.length-Gt.destination.index-1,ma=[...$e],Da=ma[en];ma.splice(en,1),ma.splice(xn,0,Da),Ye(ma)};return(0,z.jsxs)(Se.C,{children:[(0,z.jsxs)(Gs.Gy,{children:[(0,z.jsx)(me.$n,{size:"sm",icon:"plus",onClick:()=>st(),className:je.button,children:(0,z.jsx)(u.x6,{i18nKey:"transformers.enum-mapping-editor.generate-enum-values-from-data",children:"Generate enum values from data"})}),(0,z.jsx)(me.$n,{size:"sm",icon:"plus",onClick:()=>Ot(),className:je.button,children:(0,z.jsx)(u.x6,{i18nKey:"transformers.enum-mapping-editor.add-enum-value",children:"Add enum value"})})]}),(0,z.jsx)(Gs.gW,{children:(0,z.jsx)("table",{className:je.compactTable,children:(0,z.jsx)(aa.JY,{onDragEnd:$t,children:(0,z.jsx)(aa.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:Gt=>(0,z.jsxs)("tbody",{ref:Gt.innerRef,...Gt.droppableProps,children:[[...$e].reverse().map((en,xn)=>{const ma=$e.length-xn-1;return(0,z.jsx)(ci,{transformIndex:oe,value:en,index:xn,mappedIndex:ma,onChangeEnumValue:Bt,onRemoveEnumRow:yt,checkIsEnumUniqueValue:kt},`${oe}/${en}`)}),Gt.placeholder]})})})})})]})},vs=re=>({compactTable:(0,Mt.css)({"tbody td":{padding:re.spacing(.5)},marginTop:re.spacing(1),marginBottom:re.spacing(2)}),button:(0,Mt.css)({marginTop:re.spacing(1)})}),ks={settings:{width:24,isClearable:!1}},Ys=({input:re,options:ee,onChange:oe})=>{const De=Ps.bx.filter($t=>$t.value!==X.PU.trace),je=(0,Qe.qt)(!0),$e=(0,Ga.P3)();je.push({label:(0,u.t)("transformers.convert-field-type-transformer-editor.label.browser","Browser"),value:"browser"}),je.push({label:(0,u.t)("transformers.convert-field-type-transformer-editor.label.utc","UTC"),value:"utc"});for(const $t of $e)je.push({label:$t,value:$t});const Ye=(0,c.useCallback)($t=>Gt=>{const en=[...ee.conversions];en[$t]={...en[$t],targetField:Gt??"",dateFormat:void 0},oe({...ee,conversions:en})},[oe,ee]),st=(0,c.useCallback)($t=>Gt=>{const en=ee.conversions;en[$t]={...en[$t],destinationType:Gt.value},oe({...ee,conversions:en})},[oe,ee]),rt=(0,c.useCallback)($t=>Gt=>{const en=ee.conversions;en[$t]={...en[$t],dateFormat:Gt.currentTarget.value},oe({...ee,conversions:en})},[oe,ee]),yt=(0,c.useCallback)($t=>Gt=>{const en=ee.conversions;en[$t]={...en[$t],joinWith:Gt.currentTarget.value},oe({...ee,conversions:en})},[oe,ee]),Ot=(0,c.useCallback)(()=>{oe({...ee,conversions:[...ee.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[oe,ee]),Bt=(0,c.useCallback)($t=>{const Gt=ee.conversions;Gt.splice($t,1),oe({...ee,conversions:Gt})},[oe,ee]),kt=(0,c.useCallback)($t=>Gt=>{const en=ee.conversions;en[$t]={...en[$t],timezone:Gt?.value},oe({...ee,conversions:en})},[oe,ee]);return(0,z.jsxs)(z.Fragment,{children:[ee.conversions.map(($t,Gt)=>{const en=(0,Ta.UI)(re?.[0],$t.targetField),xn=$t.joinWith?.length||en?.type&&[X.PU.other,X.PU.string].includes(en.type);return(0,z.jsxs)("div",{children:[(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-field","Field"),children:(0,z.jsx)(ls.O,{context:{data:re},value:$t.targetField??"",onChange:Ye(Gt),item:ks})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-as","as"),children:(0,z.jsx)(Me.l6,{options:De,value:$t.destinationType,placeholder:(0,u.t)("transformers.convert-field-type-transformer-editor.placeholder-type","Type"),onChange:st(Gt),width:18})}),$t.destinationType===X.PU.time&&(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-input-format","Input format"),tooltip:(0,u.t)("transformers.convert-field-type-transformer-editor.tooltip-input-format","Specify the format of the input field so Grafana can parse the date string correctly."),children:(0,z.jsx)(pn.p,{value:$t.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:rt(Gt),width:24})}),$t.destinationType===X.PU.string&&(0,z.jsxs)(z.Fragment,{children:[xn&&(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-join-with","Join with"),tooltip:(0,u.t)("transformers.convert-field-type-transformer-editor.tooltip-explicit-separator-joining-array-values","Use an explicit separator when joining array values"),children:(0,z.jsx)(pn.p,{value:$t.joinWith,placeholder:"JSON",onChange:yt(Gt),width:16})}),en?.type===X.PU.time&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-date-format","Date format"),tooltip:(0,u.t)("transformers.convert-field-type-transformer-editor.tooltip-specify-the-output-format","Specify the output format."),children:(0,z.jsx)(pn.p,{value:$t.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:rt(Gt),width:24})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.convert-field-type-transformer-editor.label-set-timezone","Set timezone"),tooltip:(0,u.t)("transformers.convert-field-type-transformer-editor.tooltip-timezone-manually","Set the timezone of the date manually"),children:(0,z.jsx)(Me.l6,{options:je,value:$t.timezone,onChange:kt(Gt),isClearable:!0})})]})]}),(0,z.jsx)(me.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>Bt(Gt),"aria-label":(0,u.t)("transformers.convert-field-type-transformer-editor.aria-label-remove-convert-field-type-transformer","Remove convert field type transformer")})]}),$t.destinationType===X.PU.enum&&(0,z.jsx)(Xr,{input:re,options:ee,transformIndex:Gt,onChange:oe})]},`${$t.targetField}-${Gt}`)}),(0,z.jsx)(me.$n,{size:"sm",icon:"plus",onClick:Ot,variant:"secondary","aria-label":(0,u.t)("transformers.convert-field-type-transformer-editor.aria-label-add-a-convert-field-type-transformer","Add a convert field type transformer"),children:(0,z.jsx)(u.x6,{i18nKey:"transformers.convert-field-type-transformer-editor.convert-field-type",children:"Convert field type"})})]})},Lo={id:ne.F.convertFieldType,editor:Ys,transformation:se.c.convertFieldTypeTransformer,name:se.c.convertFieldTypeTransformer.name,description:se.c.convertFieldTypeTransformer.description,categories:new Set([y.m.Reformat]),help:Pe(ne.F.convertFieldType).helperDocs};var rs=e(8934);class Vs extends c.PureComponent{constructor(ee){super(ee),this.onFieldToggle=oe=>{const{selected:De}=this.state;De.indexOf(oe)>-1?this.onChange(De.filter(je=>je!==oe)):this.onChange([...De,oe])},this.onChange=oe=>{const{regex:De,isRegexValid:je}=this.state,$e={...this.props.options,include:{names:oe}};De&&je&&($e.include=$e.include??{},$e.include.pattern=De),this.setState({selected:oe},()=>{this.props.onChange($e)})},this.onInputBlur=oe=>{const{selected:De,regex:je}=this.state;let $e=!0;try{je&&(0,rs.dO)(je)}catch{$e=!1}$e?this.props.onChange({...this.props.options,include:{pattern:je}}):this.props.onChange({...this.props.options,include:{names:De}}),this.setState({isRegexValid:$e})},this.onVariableChange=oe=>{this.props.onChange({...this.props.options,include:{variable:oe.value}}),this.setState({variable:oe.value})},this.onFromVariableChange=oe=>{const De=oe.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:De}),this.setState({byVariable:De})},this.state={include:ee.options.include?.names||[],regex:ee.options.include?.pattern,variable:ee.options.include?.variable,byVariable:ee.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(ee){this.props.input!==ee.input&&this.initOptions()}initOptions(){const{input:ee,options:oe}=this.props,De=Array.from(oe.include?.names??[]),je=(0,dt.w)().getVariables().map(st=>({label:"$"+st.name,value:"$"+st.name})),$e=[],Ye={};for(const st of ee)for(const rt of st.fields){const yt=(0,te.Ct)(rt,st,ee);let Ot=Ye[yt];Ot||(Ot=Ye[yt]={name:yt,count:0},$e.push(Ot)),Ot.count++}if(oe.include?.pattern)try{const st=(0,rs.dO)(oe.include.pattern);for(const rt of $e)st.test(rt.name)&&De.push(rt.name)}catch(st){console.error(st)}if(De.length){const st=$e.filter(rt=>De.includes(rt.name));this.setState({options:$e,selected:st.map(rt=>rt.name),variables:je,byVariable:oe.byVariable||!1,variable:oe.include?.variable,regex:oe.include?.pattern})}else this.setState({options:$e,selected:$e.map(st=>st.name),variables:je,byVariable:oe.byVariable||!1,variable:oe.include?.variable,regex:oe.include?.pattern})}render(){const{options:ee,selected:oe,isRegexValid:De}=this.state;return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{label:(0,u.t)("transformers.filter-by-name-transformer-editor.label-use-variable","Use variable"),children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-name-transformer-editor.label-from-variable","From variable"),children:(0,z.jsx)(St.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-name-transformer-editor.label-variable","Variable"),children:(0,z.jsx)(Me.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,z.jsxs)(Se.C,{label:(0,u.t)("transformers.filter-by-name-transformer-editor.label-identifier","Identifier"),children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.filter-by-name-transformer-editor.label-identifier","Identifier"),invalid:!De,error:De?void 0:"Invalid pattern",children:(0,z.jsx)(pn.p,{placeholder:(0,u.t)("transformers.filter-by-name-transformer-editor.placeholder-regular-expression-pattern","Regular expression pattern"),value:this.state.regex||"",onChange:je=>this.setState({regex:je.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),ee.map((je,$e)=>{const Ye=`${je.name}${je.count>1?" ("+je.count+")":""}`,st=oe.indexOf(je.name)>-1;return(0,z.jsx)(wn.m,{onClick:()=>{this.onFieldToggle(je.name)},label:Ye,selected:st},`${je.name}/${$e}`)})]})]})}}const Hs={id:ne.F.filterFieldsByName,editor:Vs,transformation:se.c.filterFieldsByNameTransformer,name:se.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([y.m.Filter]),help:Pe(ne.F.filterFieldsByName).helperDocs};var yr=e(42240);const qr=re=>(0,z.jsx)(yr.M,{value:{id:q.jR.byRefId,options:re.options.include||""},onChange:ee=>{re.onChange({...re.options,include:ee?.options||""})},context:{data:re.input}}),xr={id:ne.F.filterByRefId,editor:qr,transformation:se.c.filterFramesByRefIdTransformer,name:se.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([y.m.Filter]),help:Pe(ne.F.filterByRefId).helperDocs};var Ws=e(40041);function Br({input:re,options:ee,onChange:oe}){const De={settings:{width:30,filter:yt=>yt.type===X.PU.string,placeholderText:(0,u.t)("transformers.format-string-transfomer-editor.field-name-picker-settings.placeholderText.select-text-field","Select text field"),noFieldsMessage:(0,u.t)("transformers.format-string-transfomer-editor.field-name-picker-settings.noFieldsMessage.no-text-fields-found","No text fields found")},name:"",id:"",editor:()=>null},je=(0,c.useCallback)(yt=>{oe({...ee,stringField:yt??""})},[oe,ee]),$e=(0,c.useCallback)(yt=>{const Ot=yt.value??Ws.gs.UpperCase;oe({...ee,outputFormat:Ot})},[oe,ee]),Ye=(0,c.useCallback)(yt=>{oe({...ee,substringStart:yt??0})},[oe,ee]),st=(0,c.useCallback)(yt=>{oe({...ee,substringEnd:yt??0})},[oe,ee]),rt=Object.values(Ws.gs).map(yt=>({label:yt,value:yt}));return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-string-transfomer-editor.label-field","Field"),labelWidth:10,children:(0,z.jsx)(ls.O,{context:{data:re},value:ee.stringField??"",onChange:je,item:De})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-string-transfomer-editor.label-format","Format"),labelWidth:10,children:(0,z.jsx)(Me.l6,{options:rt,value:ee.outputFormat,onChange:$e,width:20})})]}),ee.outputFormat===Ws.gs.Substring&&(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-string-transfomer-editor.label-substring-range","Substring range"),labelWidth:15,children:(0,z.jsx)(Kt.Q,{min:0,value:ee.substringStart??0,onChange:Ye,width:7})}),(0,z.jsx)(de.I,{children:(0,z.jsx)(Kt.Q,{min:0,value:ee.substringEnd??0,onChange:st,width:7})})]})]})}const Tr={id:ne.F.formatString,editor:Br,transformation:se.c.formatStringTransformer,name:se.c.formatStringTransformer.name,state:we.pn.beta,description:se.c.formatStringTransformer.description,categories:new Set([y.m.Reformat])};var uo=e(89640);function eo({input:re,options:ee,onChange:oe}){const De=[],je=(0,Qe.qt)(!0);for(const rt of re)for(const yt of rt.fields)if(yt.type==="time"){const Ot=(0,te.Ct)(yt,rt,re);De.push({label:Ot,value:Ot})}const $e=(0,c.useCallback)(rt=>{const yt=rt?.value!==void 0?rt.value:"";oe({...ee,timeField:yt})},[oe,ee]),Ye=(0,c.useCallback)(rt=>{const yt=rt.target.value;oe({...ee,outputFormat:yt})},[oe,ee]),st=(0,c.useCallback)(rt=>{const yt=rt?.value!==void 0?rt.value:"";oe({...ee,timezone:yt})},[oe,ee]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-time-transfomer-editor.label-time-field","Time field"),labelWidth:15,grow:!0,children:(0,z.jsx)(Me.l6,{options:De,value:ee.timeField,onChange:$e,placeholder:"time",isClearable:!0})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-time-transfomer-editor.label-format","Format"),labelWidth:10,tooltip:(0,z.jsxs)(u.x6,{i18nKey:"transformers.format-time-transfomer-editor.tooltip-format",children:["The output format for the field specified as a"," ",(0,z.jsx)(uo.Y,{href:"https://momentjs.com/docs/#/displaying/",external:!0,children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,z.jsx)(pn.p,{onChange:Ye,value:ee.outputFormat})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.format-time-transfomer-editor.label-set-timezone","Set timezone"),tooltip:(0,u.t)("transformers.format-time-transfomer-editor.tooltip-timezone-manually","Set the timezone of the date manually"),labelWidth:20,children:(0,z.jsx)(Me.l6,{options:je,value:ee.timezone,onChange:st,isClearable:!0})})]})})}const Xo={id:ne.F.formatTime,editor:eo,transformation:se.c.formatTimeTransformer,name:se.c.formatTimeTransformer.name,state:we.pn.alpha,description:se.c.formatTimeTransformer.description,help:Pe(ne.F.formatTime).helperDocs};var Ur=e(47433),or=e(34999);const fr=({input:re,options:ee,onChange:oe})=>{const De=(0,Qe.ZI)(re,!0),je=(0,c.useCallback)(rt=>yt=>{oe({...ee,fields:{...ee.fields,[rt]:yt}})},[oe]);let $e,Ye=!1;for(const rt of Object.values(ee.fields))rt.aggregations.length>0&&rt.operation!==null&&(Ye=!0),rt.operation===Ur.R3.groupBy&&($e=!0);const st=Ye&&!$e;return(0,z.jsxs)(vn.B,{direction:"column",children:[st&&(0,z.jsx)(or.F,{title:(0,u.t)("transformers.group-by-transformer-editor.title-calc-alert","Calculations will not have an effect if no fields are being grouped on"),severity:"warning"}),De.map(rt=>(0,z.jsx)(ho,{onConfigChange:je(rt),fieldName:rt,config:ee.fields[rt]},rt))]})},to=[{label:"Group by",value:Ur.R3.groupBy},{label:"Calculate",value:Ur.R3.aggregate}],ho=({fieldName:re,config:ee,onConfigChange:oe})=>{const De=(0,Ut.$j)(),je=zr(De),$e=(0,c.useCallback)(Ye=>{oe({aggregations:ee?.aggregations??[],operation:Ye?.value??null})},[ee,oe]);return(0,z.jsx)(de.I,{className:je.label,label:re,grow:!0,shrink:!0,children:(0,z.jsxs)(vn.B,{gap:.5,direction:"row",children:[(0,z.jsx)("div",{className:je.operation,children:(0,z.jsx)(Me.l6,{options:to,value:ee?.operation,placeholder:(0,u.t)("transformers.group-by-field-configuration.placeholder-ignored","Ignored"),onChange:$e,isClearable:!0})}),ee?.operation===Ur.R3.aggregate&&(0,z.jsx)(un.S,{className:je.aggregations,placeholder:(0,u.t)("transformers.group-by-field-configuration.placeholder-select-stats","Select stats"),allowMultiple:!0,stats:ee.aggregations,onChange:Ye=>{oe({...ee,aggregations:Ye})}})]})})},zr=re=>({label:(0,Mt.css)({label:{minWidth:re.spacing(32)}}),operation:(0,Mt.css)({flexShrink:0,height:"100%",width:re.spacing(24)}),aggregations:(0,Mt.css)({flexGrow:1})}),Gr={id:ne.F.groupBy,editor:fr,transformation:se.c.groupByTransformer,name:se.c.groupByTransformer.name,description:se.c.groupByTransformer.description,categories:new Set([y.m.Combine,y.m.CalculateNewFields,y.m.Reformat]),help:Pe(ne.F.groupBy).helperDocs};var fo=e(25260),Bo=e(37386);const Hr=({input:re,options:ee,onChange:oe})=>{const De=(0,Qe.ZI)(re),je=ee.showSubframeHeaders===void 0?fo.l:ee.showSubframeHeaders,$e=(0,c.useCallback)(Ot=>Bt=>{oe({...ee,fields:{...ee.fields,[Ot]:Bt}})},[oe]),Ye=(0,c.useCallback)(()=>{const Ot=ee.showSubframeHeaders===void 0?!fo.l:!ee.showSubframeHeaders;oe({showSubframeHeaders:Ot,fields:{...ee.fields}})},[oe]);let st,rt=!1;for(const Ot of Object.values(ee.fields))Ot.aggregations.length>0&&Ot.operation!==null&&(rt=!0),Ot.operation===Ur.R3.groupBy&&(st=!0);const yt=rt&&!st;return(0,z.jsxs)(vn.B,{direction:"column",children:[yt&&(0,z.jsx)(or.F,{title:(0,u.t)("transformers.group-to-nested-table-transformer-editor.title-calc-alert","Calculations will not have an effect if no fields are being grouped on."),severity:"warning"}),(0,z.jsx)("div",{children:De.map(Ot=>(0,z.jsx)(Uo,{onConfigChange:$e(Ot),fieldName:Ot,config:ee.fields[Ot]},Ot))}),(0,z.jsx)(Bo.D,{label:(0,u.t)("transformers.group-to-nested-table-transformer-editor.label-show-field-names-in-nested-tables","Show field names in nested tables"),description:(0,u.t)("transformers.group-to-nested-table-transformer-editor.description-show-field-names","If enabled nested tables will show field names as a table header"),children:(0,z.jsx)(St.d,{value:je,onChange:Ye})})]})},po=[{label:"Group by",value:Ur.R3.groupBy},{label:"Calculate",value:Ur.R3.aggregate}],Uo=({fieldName:re,config:ee,onConfigChange:oe})=>{const De=(0,Ut.$j)(),je=hs(De),$e=(0,c.useCallback)(Ye=>{oe({aggregations:ee?.aggregations??[],operation:Ye?.value??null})},[ee,oe]);return(0,z.jsx)(de.I,{className:je.label,label:re,grow:!0,shrink:!0,children:(0,z.jsxs)(vn.B,{gap:.5,direction:"row",wrap:!1,children:[(0,z.jsx)("div",{className:je.operation,children:(0,z.jsx)(Me.l6,{options:po,value:ee?.operation,placeholder:(0,u.t)("transformers.group-by-field-configuration.placeholder-ignored","Ignored"),onChange:$e,isClearable:!0})}),ee?.operation===Ur.R3.aggregate&&(0,z.jsx)(un.S,{className:je.aggregations,placeholder:(0,u.t)("transformers.group-by-field-configuration.placeholder-select-stats","Select stats"),allowMultiple:!0,stats:ee.aggregations,onChange:Ye=>{oe({...ee,aggregations:Ye})}})]})})},hs=re=>({label:(0,Mt.css)({minWidth:re.spacing(32)}),operation:(0,Mt.css)({flexShrink:0,height:"100%",width:re.spacing(24)}),aggregations:(0,Mt.css)({flexGrow:1})}),qo={id:ne.F.groupToNestedTable,editor:Hr,transformation:se.c.groupToNestedTable,name:se.c.groupToNestedTable.name,description:se.c.groupToNestedTable.description,categories:new Set([y.m.Combine,y.m.CalculateNewFields,y.m.Reformat]),state:we.pn.beta};var ys=e(79319);const At=({input:re,options:ee,onChange:oe})=>{const De=(0,Qe.ZI)(re).map(Ot=>({label:Ot,value:Ot})),je=(0,dt.w)().getVariables().map(Ot=>({value:"$"+Ot.name,label:"$"+Ot.name})),$e=(0,c.useCallback)(Ot=>{oe({...ee,columnField:Ot?.value})},[oe,ee]),Ye=(0,c.useCallback)(Ot=>{oe({...ee,rowField:Ot?.value})},[oe,ee]),st=(0,c.useCallback)(Ot=>{oe({...ee,valueField:Ot?.value})},[oe,ee]),rt=[{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.null","Null"),value:ys.N.Null,description:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.null-value","Null value")},{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.true","True"),value:ys.N.True,description:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.boolean-true-value","Boolean true value")},{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.false","False"),value:ys.N.False,description:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.boolean-false-value","Boolean false value")},{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.zero","Zero"),value:ys.N.Zero,description:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.number-value","Number 0 value")},{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.empty","Empty"),value:ys.N.Empty,description:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.empty-string","Empty string")}],yt=(0,c.useCallback)(Ot=>{oe({...ee,emptyValue:Ot?.value})},[oe,ee]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.label-column","Column"),labelWidth:8,children:(0,z.jsx)(Me.l6,{options:[...De,...je],value:ee.columnField,onChange:$e,isClearable:!0})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.label-row","Row"),labelWidth:8,children:(0,z.jsx)(Me.l6,{options:[...De,...je],value:ee.rowField,onChange:Ye,isClearable:!0})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.label-cell-value","Cell value"),labelWidth:10,children:(0,z.jsx)(Me.l6,{options:[...De,...je],value:ee.valueField,onChange:st,isClearable:!0})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.grouping-to-matrix-transformer-editor.label-empty-value","Empty value"),children:(0,z.jsx)(Me.l6,{options:rt,value:ee.emptyValue,onChange:yt,isClearable:!0})})]})})},bn={id:ne.F.groupingToMatrix,editor:At,transformation:se.c.groupingToMatrixTransformer,name:se.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([y.m.Combine,y.m.Reformat]),help:Pe(ne.F.groupingToMatrix).helperDocs};var An=e(74261);const pa=({input:re,options:ee,onChange:oe})=>{const[je,$e]=(0,c.useState)({bucketCount:!(0,Qe.N_)(ee.bucketCount||""),bucketSize:!(0,Qe.N_)(ee.bucketSize||""),bucketOffset:!(0,Qe.N_)(ee.bucketOffset||"")}),Ye=(0,c.useCallback)(Bt=>{$e({...je,bucketCount:!(0,Qe.N_)(Bt)}),oe({...ee,bucketCount:Number(Bt)===0?void 0:Number(Bt)})},[oe,ee,je]),st=(0,c.useCallback)(Bt=>{$e({...je,bucketSize:!(0,Qe.N_)(Bt)}),oe({...ee,bucketSize:Bt})},[oe,ee,je,$e]),rt=(0,c.useCallback)(Bt=>{$e({...je,bucketOffset:!(0,Qe.N_)(Bt)}),oe({...ee,bucketOffset:Bt})},[oe,ee,je,$e]),yt=(0,c.useCallback)(()=>{oe({...ee,combine:!ee.combine})},[oe,ee]),Ot=(0,Qe.I9)();return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{invalid:je.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:An.Rt.bucketCount.name,tooltip:An.Rt.bucketCount.description,children:(0,z.jsx)(Ge.y,{suggestions:Ot,value:ee.bucketCount,placeholder:(0,u.t)("transformers.histogram-transformer-editor.placeholder-default","Default: 30"),onChange:Ye})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{invalid:je.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:An.Rt.bucketSize.name,tooltip:An.Rt.bucketSize.description,children:(0,z.jsx)(Ge.y,{suggestions:Ot,value:ee.bucketSize,placeholder:(0,u.t)("transformers.histogram-transformer-editor.placeholder-auto","Auto"),onChange:st})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{labelWidth:18,label:An.Rt.bucketOffset.name,tooltip:An.Rt.bucketOffset.description,invalid:je.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,z.jsx)(Ge.y,{suggestions:Ot,value:ee.bucketOffset,placeholder:(0,u.t)("transformers.histogram-transformer-editor.placeholder-none","None"),onChange:rt})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{labelWidth:18,label:An.Rt.combine.name,tooltip:An.Rt.combine.description,children:(0,z.jsx)(St.K,{value:ee.combine??!1,onChange:yt})})})]})},zn={id:ne.F.histogram,editor:pa,transformation:se.c.histogramTransformer,name:se.c.histogramTransformer.name,description:se.c.histogramTransformer.description,categories:new Set([y.m.CreateNewVisualization]),help:Pe(ne.F.histogram).helperDocs};var la=e(6684),Zn=e(56755);const Vn=[{value:la.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:la.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:la.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function Hn({input:re,options:ee,onChange:oe}){const De=(0,Zn.sE)(re),je=(0,Zn.m3)(De),$e=(0,dt.w)().getVariables().map(rt=>({value:"$"+rt.name,label:"$"+rt.name})),Ye=(0,c.useCallback)(rt=>{oe({...ee,byField:rt?.value})},[oe,ee]),st=(0,c.useCallback)(rt=>{oe({...ee,mode:rt?.value})},[oe,ee]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.series-to-fields-transformer-editor.label-mode","Mode"),labelWidth:8,grow:!0,children:(0,z.jsx)(Me.l6,{options:Vn,value:ee.mode??la.W.outer,onChange:st})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.series-to-fields-transformer-editor.label-field","Field"),labelWidth:8,grow:!0,children:(0,z.jsx)(Me.l6,{options:[...je,...$e],value:ee.byField,onChange:Ye,placeholder:"time",isClearable:!0})})})]})}const Ja={id:ne.F.joinByField,aliasIds:[ne.F.seriesToColumns],editor:Hn,transformation:se.c.joinByFieldTransformer,name:se.c.joinByFieldTransformer.name,description:se.c.joinByFieldTransformer.description,categories:new Set([y.m.Combine]),help:Pe(ne.F.joinByField).helperDocs};var Ua=e(79184);const Ha=[{value:Ua.n.Columns,label:"Columns"},{value:Ua.n.Rows,label:"Rows"}],ha=({input:re,options:ee,onChange:oe})=>{const{labelNames:je,selected:$e}=(0,c.useMemo)(()=>{let rt=[],yt={};for(const Bt of re)for(const kt of Bt.fields)if(kt.labels)for(const $t of Object.keys(kt.labels))yt[$t]||(rt.push({value:$t,label:$t}),yt[$t]=!0);const Ot=new Set(ee.keepLabels?.length?ee.keepLabels:Object.keys(yt));return{labelNames:rt,selected:Ot}},[ee.keepLabels,re]),Ye=rt=>{oe({...ee,valueLabel:rt?.value})},st=rt=>{if($e.has(rt)?$e.delete(rt):$e.add(rt),$e.size===je.length||!$e.size){const{keepLabels:yt,...Ot}=ee;oe(Ot)}else oe({...ee,keepLabels:[...$e]})};return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.labels-as-fields-transformer-editor.label-mode","Mode"),labelWidth:20,children:(0,z.jsx)(ie.z,{options:Ha,value:ee.mode??Ua.n.Columns,onChange:rt=>oe({...ee,mode:rt})})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.labels-as-fields-transformer-editor.label-labels","Labels"),labelWidth:20,shrink:!0,children:(0,z.jsx)(vn.B,{gap:.5,wrap:"wrap",children:je.map((rt,yt)=>{const Ot=rt.label;return(0,z.jsx)(wn.m,{onClick:()=>st(Ot),label:Ot,selected:$e.has(Ot)},`${Ot}/${yt}`)})})})}),ee.mode!==Ua.n.Rows&&(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.labels-as-fields-transformer-editor.label-value-field-name","Value field name"),labelWidth:20,tooltip:(0,u.t)("transformers.labels-as-fields-transformer-editor.tooltip-replace-value-field-label","Replace the value field name with a label"),htmlFor:"labels-to-fields-as-name",children:(0,z.jsx)(Me.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:(0,u.t)("transformers.labels-as-fields-transformer-editor.placeholder-optional-select-label","(Optional) Select label"),options:je,value:ee?.valueLabel,onChange:Ye,className:"min-width-16"})})})]})},Ba={id:ne.F.labelsToFields,editor:ha,transformation:se.c.labelsToFieldsTransformer,name:se.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([y.m.Reformat]),help:Pe(ne.F.labelsToFields).helperDocs},ya=({options:re,onChange:ee})=>{const[oe,De]=(0,c.useState)(!1),je=(0,c.useCallback)($e=>{De(!(0,Qe.N_)($e)),ee({...re,limitField:$e})},[ee,re]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Se.C,{children:(0,z.jsx)(Ge.y,{invalid:oe,error:"Value needs to be an integer or a variable",value:String(re.limitField),onChange:je,placeholder:(0,u.t)("transformers.limit-transformer-editor.placeholder-value-or-variable","Value or variable"),suggestions:(0,Qe.I9)()})})})},xs={id:ne.F.limit,editor:ya,transformation:se.c.limitTransformer,name:se.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([y.m.Filter]),help:Pe(ne.F.limit).helperDocs},Za=({input:re,options:ee,onChange:oe})=>re.length<=1?(0,z.jsx)(Zs.P,{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.merge-transformer-editor.merge-effect-applied-single-frame",children:"Merge has no effect when applied on a single frame."})}):null,os={id:ne.F.merge,editor:Za,transformation:se.c.mergeTransformer,name:se.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([y.m.Combine]),help:Pe(ne.F.merge).helperDocs};var Xn=e(95575),Pa=e(66404);function wa(re,ee,oe){re.splice(oe,0,re.splice(ee,1)[0])}const Yn=({options:re,input:ee,onChange:oe})=>{const{indexByName:De,excludeByName:je,renameByName:$e,includeByName:Ye,orderBy:st,orderByMode:rt}=re,yt=(0,Qe.ZI)(ee),Ot=(0,c.useMemo)(()=>{if(ee.length>0&&rt===Xn.NU.Auto){const $n=(0,Xn.wx)(st??[]);return(0,Qe.gD)([{...ee[0],fields:$n(ee[0].fields)}],!1)}return is(yt,De)},[ee,yt,De,rt,st]),Bt=(0,c.useMemo)(()=>{const $n=[];if(rt===Xn.NU.Auto){const oa=(0,Qe.aG)(ee);let Na=!1;st?.forEach((Is,Qo)=>{let _o=Is.desc?Xn.pH.Desc:Xn.pH.Asc;Is.type===Xn.Mq.Name?($n.push({type:Xn.Mq.Name,order:_o}),Na=!0):oa.has(Is.name)&&($n.push({type:Xn.Mq.Label,name:Is.name,order:_o}),oa.delete(Is.name))}),Na||$n.push({type:Xn.Mq.Name,order:Xn.pH.Off}),oa.forEach(Is=>{$n.push({type:Xn.Mq.Label,name:Is,order:Xn.pH.Off})})}return $n},[ee,rt,st]),kt=Ye&&Object.keys(Ye).length>0?"include":"exclude",$t=(0,c.useCallback)(($n,oa)=>{oe({...re,excludeByName:{...je,[$n]:oa}})},[oe,re,je]),Gt=(0,c.useCallback)(($n,oa)=>{const Na={...re,includeByName:{...Ye,[$n]:!oa}};oe(Na)},[oe,re,Ye]),en=(0,c.useCallback)($n=>{if(!$n||!$n.destination)return;const oa=$n.source.index,Na=$n.destination.index;oa!==Na&&oe({...re,indexByName:Va(yt,oa,Na)})},[oe,re,yt]),xn=(0,c.useCallback)(($n,oa)=>{oe({...re,renameByName:{...re.renameByName,[$n]:oa}})},[oe,re]),ma=(0,c.useCallback)(($n,oa)=>{$n.order=oa;const Na=[];Bt.forEach(Is=>{Is.order!==Xn.pH.Off&&Na.push({type:Is.type,name:Is.name,desc:Is.order===Xn.pH.Desc})}),oe({...re,orderBy:Na})},[re,Bt,oe]),Da=(0,c.useCallback)($n=>{if($n.destination==null)return;const oa=$n.source.index,Na=$n.destination.index;if(oa===Na)return;wa(Bt,oa,Na);const Is=[];Bt.forEach(Qo=>{Qo.order!==Xn.pH.Off&&Is.push({type:Qo.type,name:Qo.name,desc:Qo.order===Xn.pH.Desc})}),oe({...re,orderBy:Is})},[re,oe,Bt]);if(ee.length>1)return(0,z.jsx)(Zs.P,{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.organize-fields-transformer-editor.first-frame-warning",children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."})});const xa=(0,Ut.of)(Ra);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se.C,{className:xa.fieldOrderRadio,children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.organize-fields-transformer-editor.field-order","Field order"),children:(0,z.jsx)(ie.z,{options:[{label:(0,u.t)("transformers.organize-fields-transformer-editor.field-order-manual","Manual"),value:Xn.NU.Manual},{label:(0,u.t)("transformers.organize-fields-transformer-editor.field-order-auto","Auto"),value:Xn.NU.Auto}],value:re.orderByMode??Xn.NU.Manual,onChange:$n=>oe({...re,orderByMode:$n})})})}),(0,z.jsx)(aa.JY,{onDragEnd:Da,children:re.orderByMode===Xn.NU.Auto&&(0,z.jsx)(aa.gL,{droppableId:"sortable-labels-transformer",direction:"vertical",children:$n=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{ref:$n.innerRef,className:xa.labelsDraggable,...$n.droppableProps,children:Bt.map((oa,Na)=>(0,z.jsx)(ps,{item:oa,index:Na,onChangeSort:ma}))}),$n.placeholder]})})}),(0,z.jsx)(aa.JY,{onDragEnd:en,children:(0,z.jsx)(aa.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:$n=>(0,z.jsxs)("div",{ref:$n.innerRef,...$n.droppableProps,children:[Ot.map((oa,Na)=>{const Is=Ye&&oa in Ye?Ye[oa]:!1,Qo=kt==="include"?Is:!je[oa],_o=kt==="include"?Gt:$t;return(0,z.jsx)(ns,{fieldName:oa,renamedFieldName:$e[oa],index:Na,onToggleVisibility:_o,onRenameField:xn,visible:Qo,isDragDisabled:re.orderByMode===Xn.NU.Auto},oa)}),$n.placeholder]})})})]})},Ra=re=>({fieldOrderRadio:(0,Mt.css)({marginBottom:re.spacing(1)}),labelsDraggable:(0,Mt.css)({marginBottom:re.spacing(3)})});Yn.displayName="OrganizeFieldsTransformerEditor";const ns=({fieldName:re,renamedFieldName:ee,index:oe,visible:De,onToggleVisibility:je,onRenameField:$e,isDragDisabled:Ye})=>{const st=(0,Ut.of)(ga);return(0,z.jsx)(aa.sx,{draggableId:re,index:oe,isDragDisabled:Ye,children:rt=>(0,z.jsxs)(he.a,{display:"flex",gap:0,ref:rt.innerRef,...rt.draggableProps,children:[(0,z.jsx)(Ne.c,{width:60,as:"div",children:(0,z.jsxs)(vn.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[!Ye&&(0,z.jsx)("span",{...rt.dragHandleProps,children:(0,z.jsx)(Os.I,{name:"draggabledots",title:(0,u.t)("transformers.draggable-field-name.title-drag-and-drop-to-reorder","Drag and drop to reorder"),size:"lg",className:st.draggable})}),(0,z.jsx)(lr.K,{className:st.toggle,size:"md",name:De?"eye":"eye-slash",onClick:()=>je(re,De),tooltip:De?(0,u.t)("transformers.draggable-field-name.tooltip-disable","Disable"):(0,u.t)("transformers.draggable-field-name.tooltip-enable","Enable")}),(0,z.jsx)(Pa.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:re})]})}),(0,z.jsx)(pn.p,{defaultValue:ee||"",placeholder:(0,u.t)("transformers.draggable-field-name.rename-placeholder","Rename {{fieldName}}",{fieldName:re,interpolation:{escapeValue:!1}}),onBlur:yt=>$e(re,yt.currentTarget.value)})]})})};ns.displayName="DraggableFieldName";const ps=({index:re,item:ee,onChangeSort:oe})=>{const De=(0,Ut.of)(ga),je=(0,c.useId)();return(0,z.jsx)(aa.sx,{draggableId:je,index:re,isDragDisabled:ee.order===Xn.pH.Off,children:$e=>(0,z.jsxs)(he.a,{marginBottom:.5,display:"flex",gap:0,ref:$e.innerRef,...$e.draggableProps,children:[(0,z.jsx)(Ne.c,{width:60,as:"div",children:(0,z.jsxs)(vn.B,{gap:3,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,z.jsx)("span",{...$e.dragHandleProps,children:(0,z.jsx)(Os.I,{name:"draggabledots",title:(0,u.t)("transformers.draggable-field-name.title-drag-and-drop-to-reorder","Drag and drop to reorder"),size:"lg",className:(0,Mt.cx)(De.draggable,{[De.disabled]:ee.order===Xn.pH.Off})})}),(0,z.jsx)(Pa.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:ee.type===Xn.Mq.Label?`Label: ${ee.name}`:"Field name"})]})}),(0,z.jsx)(ie.z,{options:[{label:(0,u.t)("transformers.draggable-sort-order.off","Off"),value:Xn.pH.Off},{label:(0,u.t)("transformers.draggable-sort-order.asc","ASC"),value:Xn.pH.Asc},{label:(0,u.t)("transformers.draggable-sort-order.desc","DESC"),value:Xn.pH.Desc}],value:ee.order,onChange:Ye=>{oe(ee,Ye)}})]})})};ps.displayName="DraggableUIOrderByItem";const ga=re=>({toggle:(0,Mt.css)({margin:re.spacing(0,1),color:re.colors.text.secondary}),draggable:(0,Mt.css)({opacity:.4,"&:hover":{color:re.colors.text.maxContrast}}),disabled:(0,Mt.css)({color:re.colors.text.disabled,pointerEvents:"none"})}),Va=(re,ee,oe)=>{const De=Array.from(re),[je]=De.splice(ee,1);return De.splice(oe,0,je),De.reduce(($e,Ye,st)=>($e[Ye]=st,$e),{})},is=(re,ee={})=>{if(!ee||Object.keys(ee).length===0)return re;const oe=(0,Xn.Xz)(ee);return re.sort(oe)},nr={id:ne.F.organize,editor:Yn,transformation:se.c.organizeFieldsTransformer,name:se.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([y.m.ReorderAndRename]),help:Pe(ne.F.organize).helperDocs};var Aa=e(32157),Xa=e(51898);const qn=({options:re,onChange:ee})=>{const oe=[{label:(0,u.t)("transformers.reduce-transformer-editor.modes.label.series-to-rows","Series to rows"),value:Aa.rV.SeriesToRows,description:(0,u.t)("transformers.reduce-transformer-editor.modes.description.create-table-series-value","Create a table with one row for each series value")},{label:(0,u.t)("transformers.reduce-transformer-editor.modes.label.reduce-fields","Reduce fields"),value:Aa.rV.ReduceFields,description:(0,u.t)("transformers.reduce-transformer-editor.modes.description.collapse-field-single-value","Collapse each field into a single value")}],De=(0,c.useCallback)(Ye=>{const st=Ye.value;ee({...re,mode:st,includeTimeField:st===Aa.rV.ReduceFields?!!re.includeTimeField:!1})},[ee,re]),je=(0,c.useCallback)(()=>{ee({...re,includeTimeField:!re.includeTimeField})},[ee,re]),$e=(0,c.useCallback)(()=>{ee({...re,labelsToFields:!re.labelsToFields})},[ee,re]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.reduce-transformer-editor.label-mode","Mode"),"data-testid":Xa.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,z.jsx)(Me.l6,{options:oe,value:oe.find(Ye=>Ye.value===re.mode)||oe[0],onChange:De})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.reduce-transformer-editor.label-calculations","Calculations"),"data-testid":Xa.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,z.jsx)(un.S,{placeholder:(0,u.t)("transformers.reduce-transformer-editor.placeholder-choose-stat","Choose stat"),allowMultiple:!0,stats:re.reducers||[],onChange:Ye=>{ee({...re,reducers:Ye})}})}),re.mode===Aa.rV.ReduceFields&&(0,z.jsx)(de.I,{htmlFor:"include-time-field",labelWidth:16,label:(0,u.t)("transformers.reduce-transformer-editor.label-include-time","Include time"),children:(0,z.jsx)(St.K,{id:"include-time-field",value:!!re.includeTimeField,onChange:je})}),re.mode!==Aa.rV.ReduceFields&&(0,z.jsx)(de.I,{htmlFor:"labels-to-fields",labelWidth:16,label:(0,u.t)("transformers.reduce-transformer-editor.label-labels-to-fields","Labels to fields"),children:(0,z.jsx)(St.K,{id:"labels-to-fields",value:!!re.labelsToFields,onChange:$e})})]})},Ma={id:ne.F.reduce,editor:qn,transformation:se.c.reduceTransformer,name:se.c.reduceTransformer.name,description:se.c.reduceTransformer.description,categories:new Set([y.m.CalculateNewFields]),help:Pe(ne.F.reduce).helperDocs};class js extends c.PureComponent{constructor(ee){super(ee),this.handleRegexChange=oe=>{const De=oe.currentTarget.value;let je=!0;if(De)try{De&&(0,rs.dO)(De)}catch{je=!1}this.setState($e=>({...$e,regex:De,isRegexValid:je}))},this.handleRenameChange=oe=>{const De=oe.currentTarget.value;this.setState(je=>({...je,renamePattern:De}))},this.handleRegexBlur=oe=>{const De=oe.currentTarget.value;let je=!0;try{De&&(0,rs.dO)(De)}catch{je=!1}this.setState({isRegexValid:je},()=>{je&&this.props.onChange({...this.props.options,regex:De})})},this.handleRenameBlur=oe=>{const De=oe.currentTarget.value;this.setState({renamePattern:De},()=>this.props.onChange({...this.props.options,renamePattern:De}))},this.state={regex:ee.options.regex,renamePattern:ee.options.renamePattern,isRegexValid:!0}}render(){const{regex:ee,renamePattern:oe,isRegexValid:De}=this.state;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.rename-by-regex-transformer-editor.label-match","Match"),labelWidth:16,invalid:!De,error:De?void 0:"Invalid pattern",children:(0,z.jsx)(pn.p,{placeholder:(0,u.t)("transformers.rename-by-regex-transformer-editor.placeholder-regular-expression-pattern","Regular expression pattern"),value:ee||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.rename-by-regex-transformer-editor.label-replace","Replace"),labelWidth:16,children:(0,z.jsx)(pn.p,{placeholder:(0,u.t)("transformers.rename-by-regex-transformer-editor.placeholder-replacement-pattern","Replacement pattern"),value:oe||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const cr={id:ne.F.renameByRegex,editor:js,transformation:se.c.renameByRegexTransformer,name:se.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([y.m.ReorderAndRename]),help:Pe(ne.F.renameByRegex).helperDocs},Qs=({input:re,options:ee,onChange:oe})=>null,qa={id:ne.F.seriesToRows,editor:Qs,transformation:se.c.seriesToRowsTransformer,name:se.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([y.m.Combine,y.m.Reformat]),help:Pe(ne.F.seriesToRows).helperDocs},bs=({input:re,options:ee,onChange:oe})=>{const De=(0,Qe.ZI)(re).map(rt=>({label:rt,value:rt})),$e=(0,dt.w)().getVariables().map(rt=>({label:"$"+rt.name,value:"$"+rt.name})),Ye=(0,c.useCallback)((rt,yt)=>{oe({...ee,sort:[yt]})},[oe,ee]),st=ee.sort?.length?ee.sort:[{}];return(0,z.jsx)("div",{children:st.map((rt,yt)=>(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.sort-by-transformer-editor.label-field","Field"),labelWidth:10,grow:!0,children:(0,z.jsx)(Me.l6,{options:[...De,...$e],value:rt.field,placeholder:(0,u.t)("transformers.sort-by-transformer-editor.placeholder-select-field","Select field"),onChange:Ot=>{Ye(yt,{...rt,field:Ot.value})}})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.sort-by-transformer-editor.label-reverse","Reverse"),children:(0,z.jsx)(St.K,{value:!!rt.desc,onChange:()=>{Ye(yt,{...rt,desc:!rt.desc})}})})]},`${rt.field}/${yt}`))})},Es={id:ne.F.sortBy,editor:bs,transformation:se.c.sortByTransformer,name:se.c.sortByTransformer.name,description:se.c.sortByTransformer.description,categories:new Set([y.m.ReorderAndRename]),help:Pe(ne.F.sortBy).helperDocs},qs=({options:re,onChange:ee})=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.transpose-transfomer-editor.label-first-field-name","First field name"),labelWidth:24,children:(0,z.jsx)(pn.p,{placeholder:(0,u.t)("transformers.transpose-transfomer-editor.placeholder-field","Field"),value:re.firstFieldName,onChange:oe=>ee({...re,firstFieldName:oe.currentTarget.value}),width:25})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.transpose-transfomer-editor.label-remaining-fields-name","Remaining fields name"),tooltip:(0,u.t)("transformers.transpose-transfomer-editor.tooltip-name-for-value-fields","Name for value fields"),labelWidth:24,children:(0,z.jsx)(pn.p,{placeholder:(0,u.t)("transformers.transpose-transfomer-editor.placeholder-value","Value"),value:re.restFieldsName,onChange:oe=>ee({...re,restFieldsName:oe.currentTarget.value}),width:25})})})]}),Er={id:ne.F.transpose,editor:qs,transformation:se.c.transposeTransformer,name:se.c.transposeTransformer.name,description:se.c.transposeTransformer.description,categories:new Set([y.m.Reformat])};var Wo=e(43243);function di({options:re,onChange:ee}){const[oe,De]=(0,c.useState)(re),je=No(),$e=ui(),Ye=()=>{oe.push({path:""}),De([...oe]),yt()},st=Ot=>{oe&&(oe.splice(Ot,1),De([...oe]),yt())},rt=(Ot,Bt,kt)=>{oe&&(kt==="alias"?oe[Bt].alias=Ot.currentTarget.value??"":oe[Bt].path=Ot.currentTarget.value??"",De([...oe]))},yt=()=>{ee(oe)};return(0,z.jsxs)("ol",{className:(0,Mt.cx)($e.list),children:[oe&&oe.map((Ot,Bt)=>(0,z.jsx)("li",{children:(0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{label:(0,u.t)("transformers.jsonpath-editor.label-field","Field"),tooltip:je.field,grow:!0,children:(0,z.jsx)(pn.p,{onBlur:yt,onChange:kt=>rt(kt,Bt,"path"),value:Ot.path,placeholder:(0,u.t)("transformers.jsonpath-editor.placeholder-valid-objectvalue",'A valid json path, e.g. "object.value1" or "object.value2[0]"')})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.jsonpath-editor.label-alias","Alias"),tooltip:je.alias,children:(0,z.jsx)(pn.p,{width:12,value:Ot.alias,onBlur:yt,onChange:kt=>rt(kt,Bt,"alias")})}),(0,z.jsx)(de.I,{className:(0,Mt.cx)($e.removeIcon),children:(0,z.jsx)(lr.K,{onClick:()=>st(Bt),name:"trash-alt",tooltip:(0,u.t)("transformers.jsonpath-editor.tooltip-remove-path","Remove path")})})]})},Bt)),(0,z.jsx)(de.I,{children:(0,z.jsx)(me.$n,{icon:"plus",onClick:()=>Ye(),variant:"secondary",children:(0,z.jsx)(u.x6,{i18nKey:"transformers.jsonpath-editor.add-path",children:"Add path"})})})]})}const No=()=>{const re=[{path:"object",description:(0,u.t)("transformers.get-tooltips.map-valid-paths.description.extract-fields-from-object","=> extract fields from object")},{path:"object.value1",description:(0,z.jsxs)(u.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value",values:{value:"value1"},children:["=> extract ",(0,z.jsx)("code",{children:"{{ value }}"})]})},{path:"object.value2",description:(0,z.jsxs)(u.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value",values:{value:"value2"},children:["=> extract ",(0,z.jsx)("code",{children:"{{ value }}"})]})},{path:"object.value2[0]",description:(0,z.jsxs)(u.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value-first-element",values:{value:"value2"},children:["=> extract ",(0,z.jsx)("code",{children:"{{ value }}"})," first element"]})},{path:"object.value2[1]",description:(0,z.jsxs)(u.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value-second-element",values:{value:"value2"},children:["=> extract ",(0,z.jsx)("code",{children:"{{ value }}"})," second element"]})}];return{field:(0,z.jsxs)("div",{children:[(0,z.jsx)(u.x6,{i18nKey:"transformers.get-tooltips.description",children:"A valid path of an json object."}),(0,z.jsx)("div",{children:(0,z.jsx)("strong",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.get-tooltips.json-value",children:"JSON Value:"})})}),(0,z.jsx)("pre",{children:(0,z.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,z.jsx)("strong",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.get-tooltips.valid-paths",children:"Valid Paths:"})}),re.map((ee,oe)=>(0,z.jsxs)("p",{children:[(0,z.jsx)("code",{children:ee.path}),(0,z.jsx)("i",{children:ee.description})]},oe))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function ui(){return{list:(0,Mt.css)({marginLeft:"20px"}),removeIcon:(0,Mt.css)({margin:"0 0 0 4px",alignItems:"center"})}}var Qr=e(41119),Pr=(re=>(re.JSON="json",re.KeyValues="kvp",re.Auto="auto",re.RegExp="regexp",re.Delimiter="delimiter",re))(Pr||{});const Ri={id:Pr.JSON,name:"JSON",description:"Parse JSON string",getParser:re=>ee=>JSON.parse(ee)},_i={id:Pr.RegExp,name:"RegExp",description:"Parse with RegExp",getParser:re=>{let ee=/(?<NewField>.*)/;if((0,rs.AP)(re.regExp))try{ee=(0,rs.dO)(re.regExp)}catch(oe){oe instanceof Error&&console.warn(oe.message)}return oe=>oe.match(ee)?.groups}};function Ai(re){const ee=[];let oe="",De="";const je={};for(let $e=0;$e<re.length;$e++){let Ye=re[$e];Ye===oe&&(oe="",Ye=re[++$e]);const st=Ye==="\\";if(st&&(Ye=re[++$e]),st||oe.length){ee.push(Ye);continue}switch((Ye==='"'||Ye==="'")&&(oe=Ye),Ye){case":":case"=":ee.length&&(De&&(je[De]=""),De=ee.join(""),ee.length=0);break;case'"':case"'":case" ":case"	":case"\r":case`
`:ee.length&&De===""&&(je[ee.join("")]="",ee.length=0);case",":case";":case"&":case"{":case"}":if(ee.length){const rt=ee.join("");De.length?(je[De]=rt,De=""):De=rt,ee.length=0}break;default:ee.push(Ye),$e===re.length-1&&De===""&&ee.length&&(je[ee.join("")]="",ee.length=0)}}return De.length&&(je[De]=ee.join("")),je}const _r={id:Pr.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",getParser:re=>Ai},kr={id:Pr.Delimiter,name:"Split by delimiter",description:"Splits at delimited values, such as commas",getParser:({delimiter:re=","})=>{const ee=new RegExp(`\\s*${(0,rs.jD)(re)}\\s*`,"g");return oe=>{const De=oe.trim().split(ee),je={};for(const $e of De)je[$e]=1;return je}}},ki=[Ri,_r,kr,_i],Yi={id:Pr.Auto,name:"Auto",description:"parse new fields automatically",getParser:re=>{const ee=ki.map(oe=>oe.getParser(re));return oe=>{for(const De of ee)try{const je=De(oe);if(je!=null)return je}catch{}}}},Ko=new Te.O(()=>[...ki,Yi]),Fo={id:ne.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{delimiter:","},operator:(re,ee)=>oe=>oe.pipe((0,La.T)(De=>Fo.transformer(re,ee)(De))),transformer:re=>ee=>ee.map(oe=>ji(oe,re))};function ji(re,ee){if(!ee.source)return re;const oe=(0,Ta.UI)(re,ee.source);if(!oe)return re;const De=Ko.getIfExists(ee.format??Pr.Auto);if(!De)throw new Error("unkonwn extractor");const je=re.length,$e=[],Ye=new Map,st=De.getParser(ee);for(let yt=0;yt<je;yt++){let Ot=oe.values[yt];if((0,Y.isString)(Ot))try{Ot=st(Ot)}catch{Ot={}}if(Ot!=null){if(ee.format===Pr.JSON&&ee.jsonPaths&&ee.jsonPaths?.length>0){const Bt={},kt=ee.jsonPaths.filter($t=>$t.path);kt.length>0&&(kt.forEach($t=>{const Gt=$t.alias&&$t.alias.length>0?$t.alias:$t.path;Bt[Gt]=(0,Y.get)(Ot,$t.path)??"Not Found"}),Ot=Bt)}for(const[Bt,kt]of Object.entries(Ot)){let $t=Ye.get(Bt);$t==null&&($t=new Array(je).fill(void 0),Ye.set(Bt,$t),$e.push(Bt)),$t[yt]=kt}}}const rt=$e.map(yt=>{const Ot=Ye.get(yt);if(!Ot)throw new Error(`Could not find field with name: ${yt}`);const Bt={name:yt,values:Ot,type:Ot?(0,Qr.oE)(Ot.find(kt=>kt!=null)):X.PU.other,config:{}};return J.$.featureToggles.extractFieldsNameDeduplication&&(Bt.name=(0,te.fk)(Bt,re)),Bt});if(ee.keepTime){const yt=(0,Ta.UI)(re,"Time")||(0,Ta.UI)(re,"time");yt&&rt.unshift(yt)}return ee.replace||rt.unshift(...re.fields),{...re,fields:rt}}const ei=({input:re,options:ee={delimiter:","},onChange:oe})=>{const De={settings:{width:30,placeholderText:(0,u.t)("transformers.extract-fields-transformer-editor.field-name-picker-settings.placeholderText.select-field","Select field")},name:"",id:"",editor:()=>null},je=kt=>{oe({...ee,source:kt})},$e=kt=>{oe({...ee,format:kt?.value})},Ye=kt=>{oe({...ee,jsonPaths:kt})},st=kt=>{oe({...ee,regExp:kt.target.value})},rt=kt=>{oe({...ee,delimiter:kt.value})},yt=()=>{ee.replace&&(ee.keepTime=!1),oe({...ee,replace:!ee.replace})},Ot=()=>{oe({...ee,keepTime:!ee.keepTime})},Bt=Ko.selectOptions(ee.format?[ee.format]:void 0);return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.extract-fields-transformer-editor.label-source","Source"),labelWidth:16,children:(0,z.jsx)(ls.O,{context:{data:re},value:ee.source??"",onChange:je,item:De})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.extract-fields-transformer-editor.label-format","Format"),labelWidth:16,children:(0,z.jsx)(Me.l6,{value:Bt.current[0],options:Bt.options,onChange:$e,width:24,placeholder:(0,u.t)("transformers.extract-fields-transformer-editor.placeholder-auto","Auto")})})}),ee.format===Pr.RegExp&&(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:"RegExp",labelWidth:16,interactive:!0,tooltip:(0,u.t)("transformers.extract-fields-transformer-editor.tooltip-regexp","Example: {{regexExample}}",{regexExample:"/(?<NewField>.*)/"}),children:(0,z.jsx)(pn.p,{placeholder:"/(?<NewField>.*)/",value:ee.regExp,onChange:st})})}),ee.format===Pr.JSON&&(0,z.jsx)(di,{options:ee.jsonPaths??[],onChange:Ye}),ee.format===Pr.Delimiter&&(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.extract-fields-transformer-editor.label-delimiter","Delimiter"),labelWidth:16,children:(0,z.jsx)(Wo.G,{value:ee.delimiter,options:[{value:","},{value:";"},{value:"|"}],onChange:rt,placeholder:(0,u.t)("transformers.extract-fields-transformer-editor.placeholder-select-delimiter","Select delimiter..."),width:24})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.extract-fields-transformer-editor.label-replace-all-fields","Replace all fields"),labelWidth:16,children:(0,z.jsx)(St.K,{value:ee.replace??!1,onChange:yt})})}),ee.replace&&(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.extract-fields-transformer-editor.label-keep-time","Keep time"),labelWidth:16,children:(0,z.jsx)(St.K,{value:ee.keepTime??!1,onChange:Ot})})})]})},wo={id:ne.F.extractFields,editor:ei,transformation:Fo,name:Fo.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([y.m.Reformat]),help:Pe(ne.F.extractFields).helperDocs};var Wr=e(59695);const io={id:ne.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(re,ee)=>oe=>oe.pipe((0,La.T)(De=>io.transformer(re,ee)(De))),transformer:re=>ee=>!ee||!ee.length?ee:[Ji(re,ee)]};function Ji(re,ee){if(!re.value?.length)return go("No value label configured");const oe=(0,Qe.aG)(ee);if(oe.size<1)return go("No labels in result");if(!oe.has(re.value))return go("Value label not found");let De=re.join?.length?re.join:Array.from(oe);De=De.filter(Bt=>Bt!==re.value);const je=new Set,$e=new Map,Ye={};for(const Bt of ee)for(const kt of Bt.fields)if(kt.labels&&kt.type!==X.PU.time){const $t=De.map(xa=>kt.labels[xa]),Gt=$t.join(",");let en=$e.get(Gt);en||(en={keys:$t,values:{}},$e.set(Gt,en));const xn=kt.labels[re.value],ma=kt.values,Da=en.values[xn];Da?en.values[xn]=Da.concat(ma):en.values[xn]=ma,Ye[xn]||(Ye[xn]=kt),je.add(xn)}const st=Array.from(je),rt=De.map(()=>[]),yt=st.map(()=>[]);for(const Bt of $e.values()){let kt=-1,$t=!1;for(;!$t;){kt++,$t=!0;for(let Gt=0;Gt<De.length;Gt++)rt[Gt].push(Bt.keys[Gt]);for(let Gt=0;Gt<st.length;Gt++){const en=st[Gt],xn=Bt.values[en]??[];yt[Gt].push(xn[kt]),xn.length>kt+1&&($t=!1)}}}const Ot={fields:[],length:yt[0].length,refId:`${ne.F.joinByLabels}-${ee.map(Bt=>Bt.refId).join("-")}`};for(let Bt=0;Bt<De.length;Bt++)Ot.fields.push({name:De[Bt],config:{},type:X.PU.string,values:rt[Bt]});for(let Bt=0;Bt<st.length;Bt++){const kt=Ye[st[Bt]];Ot.fields.push({name:st[Bt],config:{},type:kt.type??X.PU.number,values:yt[Bt]})}return Ot}function go(re){return{meta:{notices:[{severity:"error",text:re}]},fields:[{name:"Error",type:X.PU.string,config:{},values:[re]}],length:0}}function Zi({input:re,options:ee,onChange:oe}){const De=(0,c.useMemo)(()=>{let rt;const yt=(0,Qe.aG)(re),Ot=Array.from(yt).map(xn=>({label:xn,value:xn}));let Bt=Ot.find(xn=>xn.value===ee.value);!Bt&&ee.value&&(Bt={label:`${ee.value} (not found)`,value:ee.value},Ot.push(Bt)),re.length?yt.size===0&&(rt=(0,z.jsx)(or.F,{title:(0,u.t)("transformers.join-by-labels-transformer-editor.info.title-no-labels-found","No labels found"),children:(0,z.jsx)(u.x6,{i18nKey:"transformers.join-by-labels-transformer-editor.info.input-contain-labels",children:"The input does not contain any labels"})})):rt=(0,z.jsx)(or.F,{title:(0,u.t)("transformers.join-by-labels-transformer-editor.info.title-no-input-found","No input found"),children:(0,z.jsx)(u.x6,{i18nKey:"transformers.join-by-labels-transformer-editor.info.no-input-or-labels-found",children:"No input (or labels) found"})}),yt.delete(ee.value);const kt=Array.from(yt).map(xn=>({label:xn,value:xn}));let $t=kt;const Gt=!!ee.join?.length;let en="Join";return Gt?$t=kt.filter(xn=>!ee.join.includes(xn.value)):en=kt.map(xn=>xn.value).join(", "),{warn:rt,valueOptions:Ot,valueOption:Bt,joinOptions:kt,addOptions:$t,addText:en,hasJoin:Gt,key:Date.now()}},[ee,re]),je=(rt,yt)=>{if(!ee.join)return;const Ot=ee.join.slice();if(yt)Ot[rt]=yt;else if(Ot.splice(rt,1),!Ot.length){oe({...ee,join:void 0});return}const Bt=new Set(Ot);ee.value&&Bt.delete(ee.value),oe({...ee,join:Array.from(Bt)})},$e=rt=>{const yt=rt?.value;if(!yt)return;const Ot=ee.join?ee.join.slice():[];Ot.push(yt),oe({...ee,join:Ot})},Ye=10,st="No labels found";return(0,z.jsxs)("div",{children:[De.warn,(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{error:"required",invalid:!ee.value?.length,label:(0,u.t)("transformers.join-by-labels-transformer-editor.label-value","Value"),labelWidth:Ye,tooltip:(0,u.t)("transformers.join-by-labels-transformer-editor.tooltip-select-label-indicating-values","Select the label indicating the values name"),children:(0,z.jsx)(Me.l6,{options:De.valueOptions,value:De.valueOption,onChange:rt=>oe({...ee,value:rt.value}),noOptionsMessage:st})})}),De.hasJoin?ee.join.map((rt,yt)=>(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.join-by-labels-transformer-editor.label-join","Join"),labelWidth:Ye,error:"Unable to join by the value label",invalid:rt===ee.value,children:(0,z.jsxs)(Gs.Gy,{children:[(0,z.jsx)(Me.l6,{options:De.joinOptions,value:De.joinOptions.find(Ot=>Ot.value===rt),isClearable:!0,onChange:Ot=>je(yt,Ot?.value),noOptionsMessage:st}),!!(De.addOptions.length&&yt===ee.join.length-1)&&(0,z.jsx)(Wr.i,{icon:"plus",label:"",options:De.addOptions,onChange:$e,variant:"secondary"})]})})},rt+yt)):(0,z.jsx)(z.Fragment,{children:!!De.addOptions.length&&(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.join-by-labels-transformer-editor.label-join","Join"),labelWidth:Ye,children:(0,z.jsx)(Me.l6,{options:De.addOptions,placeholder:De.addText,onChange:$e,noOptionsMessage:st})})})})]})}const pr={id:io.id,editor:Zi,transformation:io,name:io.name,description:io.description,state:we.pn.beta,categories:new Set([y.m.Combine]),help:Pe(io.id).helperDocs};var Xi=e(93139),Co=e(69862),mo=e(65474),Vo=e(46189);const To={id:ne.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:re=>ee=>ee.pipe((0,Co.Z)(oe=>(0,mo.H)(Li(oe,re))))};async function Li(re,ee){const oe=Q.sJ.get(q.Ct.byName).get(ee?.lookupField),De=await(0,Vo.q3)(ee?.gazetteer??Vo.fx);return De.frame?ti(re,De,oe):Promise.reject("missing frame in gazetteer")}function ti(re,ee,oe){const De=ee.frame()?.fields;return De?re.map(je=>{const $e=je.length,Ye=[];for(const st of je.fields)if(Ye.push(st),oe(st,je,re)){const rt=st.values,yt=[];for(const Ot of De){const Bt=new Array($e);yt.push(Bt),Ye.push({...Ot,values:Bt})}for(let Ot=0;Ot<ee.count;Ot++){const Bt=ee.find(rt[Ot]);if(Bt?.index!=null)for(let kt=0;kt<De.length;kt++)yt[kt][Ot]=De[kt].values[Bt.index]}}return{...je,fields:Ye}}):re}const Nr={settings:{}},Bi=({input:re,options:ee,onChange:oe})=>{const De={settings:{width:30,filter:Ye=>Ye.type===X.PU.string,placeholderText:(0,u.t)("transformers.field-lookup-transformer-editor.field-name-picker-settings.placeholderText.select-text-field","Select text field"),noFieldsMessage:(0,u.t)("transformers.field-lookup-transformer-editor.field-name-picker-settings.noFieldsMessage.no-text-fields-found","No text fields found")},name:"",id:"",editor:()=>null},je=(0,c.useCallback)(Ye=>{oe({...ee,lookupField:Ye})},[oe,ee]),$e=(0,c.useCallback)(Ye=>{oe({...ee,gazetteer:Ye})},[oe,ee]);return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.field-lookup-transformer-editor.label-field","Field"),labelWidth:12,children:(0,z.jsx)(ls.O,{context:{data:re},value:ee?.lookupField??"",onChange:je,item:De})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.field-lookup-transformer-editor.label-lookup","Lookup"),labelWidth:12,children:(0,z.jsx)(Xi.G,{value:ee?.gazetteer??"",context:{data:re},item:Nr,onChange:$e})})})]})},Ui={id:ne.F.fieldLookup,editor:Bi,transformation:To,name:To.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:we.pn.alpha,categories:new Set([y.m.PerformSpatialOperations]),help:Pe(ne.F.fieldLookup).helperDocs};var hi=e(359),qi=e(1027);const Mo=(re,ee,oe=[])=>(ee===0?oe.push(re):re.forEach(De=>{Mo(De,ee-1,oe)}),oe);function Wi(re){const ee=re[0].length,oe=re.length,De=new Map;for(let je=0;je<ee;je++){let $e=De;for(let Ye=0;Ye<oe;Ye++){let st=re[Ye][je],rt=$e.get(st);rt==null&&(rt=Ye===oe-1?[]:new Map,$e.set(st,rt)),$e=rt}$e.push(je)}return Mo(De,oe)}const Ni={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function el(re,ee,oe){return ee.map((De,je)=>re.withNames?`${De}${re.separator1}${oe[je]}`:oe[je]).join(re.separator2)}function tl(re,ee){const oe={};return re.forEach((De,je)=>{oe[De]=String(ee[je])}),oe}const So={id:ne.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(re,ee)=>oe=>oe.pipe((0,La.T)(De=>So.transformer(re,ee)(De))),transformer:(re,ee)=>{const oe=(0,hi.R)({names:re.fields});if(!oe)return qi.W.transformer({},ee);const De=(0,Q.NS)(oe);return je=>je.length?fi(je[0],De,re):je}};function fi(re,ee,oe){const De=re.fields.filter(st=>ee(st,re,[re]));if(!De.length)return[re];const je=De.map(st=>st.values),$e=De.map(st=>st.name),Ye={...Ni,...oe?.naming};return Wi(je).map(st=>{let rt=re.name,yt={};if(Ye.asLabels)yt=tl($e,De.map((Bt,kt)=>je[kt][st[0]]));else{let Bt=el(Ye,$e,De.map((kt,$t)=>je[$t][st[0]]));Ye?.append&&re.name&&(Bt=`${re.name} ${Bt}`),rt=Bt}let Ot=re.fields;if(!oe?.keepFields){const Bt=new Set($e);Ot=re.fields.filter(kt=>!Bt.has(kt.name))}return{name:rt,meta:re.meta,length:st.length,fields:Ot.map(Bt=>{const kt=Bt.values,$t=Array(st.length);for(let Gt=0;Gt<st.length;Gt++)$t[Gt]=kt[st[Gt]];return{name:Bt.name,type:Bt.type,config:Bt.config,labels:{...Bt.labels,...yt},values:$t}})}})}function pi({input:re,options:ee,onChange:oe}){const De=(0,Zn.sE)(re),je=(0,Zn.m3)(De),$e=(0,c.useMemo)(()=>{const kt=new Set(ee.fields);return kt.size<1?je:je.filter($t=>!kt.has($t.value))},[je,ee]),Ye=(0,c.useCallback)(kt=>{if(!kt.value)return;const $t=new Set(ee.fields);$t.add(kt.value),oe({...ee,fields:[...$t]})},[oe,ee]);let st;(kt=>{kt[kt.asLabels=0]="asLabels",kt[kt.frameName=1]="frameName"})(st||(st={}));const rt=[{label:(0,u.t)("transformers.partition-by-values-editor.naming-modes-options.label.as-label","As label"),value:0},{label:(0,u.t)("transformers.partition-by-values-editor.naming-modes-options.label.as-frame-name","As frame name"),value:1}],yt=[{label:(0,u.t)("transformers.partition-by-values-editor.keep-fields-options.label.yes","Yes"),value:!0},{label:(0,u.t)("transformers.partition-by-values-editor.keep-fields-options.label.no","No"),value:!1}],Ot=(0,c.useCallback)(kt=>{if(!kt)return;const $t=new Set(ee.fields);$t.delete(kt),oe({...ee,fields:[...$t]})},[oe,ee]);if(re.length>1)return(0,z.jsx)(Zs.P,{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.partition-by-values-editor.partition-values-works-single-frame",children:"Partition by values only works with a single frame."})});const Bt=[...new Set(ee.fields)];return(0,z.jsxs)("div",{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.partition-by-values-editor.label-field","Field"),labelWidth:10,grow:!0,children:(0,z.jsxs)(Gs.Gy,{children:[Bt.map(kt=>(0,z.jsx)(me.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>Ot(kt),children:kt},kt)),$e.length&&(0,z.jsx)(Wr.i,{variant:"secondary",size:"md",options:$e,onChange:Ye,label:(0,u.t)("transformers.partition-by-values-editor.label-select-field","Select field"),icon:"plus"})]})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{tooltip:(0,u.t)("transformers.partion-by-values-editor.tooltip-naming","Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data"),label:(0,u.t)("transformers.partition-by-values-editor.label-naming","Naming"),labelWidth:10,children:(0,z.jsx)(ie.z,{options:rt,value:ee.naming?.asLabels===void 0||ee.naming.asLabels?0:1,onChange:kt=>oe({...ee,naming:{...ee.naming,asLabels:kt===0}})})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{tooltip:(0,u.t)("transformers.partition-by-values-editor.tooltip-keeps-partition-fields-frames","Keeps the partition fields in the frames"),label:(0,u.t)("transformers.partition-by-values-editor.label-keep-fields","Keep fields"),labelWidth:16,children:(0,z.jsx)(ie.z,{options:yt,value:ee.keepFields,onChange:kt=>oe({...ee,keepFields:kt})})})})]})}const $o={id:ne.F.partitionByValues,editor:pi,transformation:So,name:So.name,description:So.description,state:we.pn.alpha,categories:new Set([y.m.Reformat]),help:Pe(ne.F.partitionByValues).helperDocs};var Rr=e(39443),Ki=e(18700),sa=e(8721),es=(re=>(re.TimeSeriesWide="wide",re.TimeSeriesLong="long",re.TimeSeriesMulti="multi",re.TimeSeriesMany="many",re))(es||{});function gi(re){if(!Array.isArray(re)||re.length===0)return re;const ee=[];for(const oe of ni(re)){const De=oe.fields[0];if(!De||De.type!==X.PU.time)continue;const je=[],$e=[];for(const Ye of oe.fields)switch(Ye.type){case X.PU.number:case X.PU.boolean:je.push(Ye);break;case X.PU.string:$e.push(Ye);break}for(const Ye of je)if($e.length){const st=new Map;for(let rt=0;rt<oe.length;rt++){const yt=De.values[rt],Ot=Ye.values[rt];if(Ot===void 0||yt==null)continue;const Bt=$e.map($t=>$t.values[rt]).join("/");let kt=st.get(Bt);if(!kt){kt={key:Bt,time:[],value:[],labels:{}};for(const $t of $e)kt.labels[$t.name]=$t.values[rt];st.set(Bt,kt)}kt.time.push(yt),kt.value.push(Ot)}for(const rt of st.values())ee.push({name:oe.name,refId:oe.refId,meta:{...oe.meta,type:Rr.m.TimeSeriesMulti},fields:[{...De,values:rt.time},{...Ye,values:rt.value,labels:rt.labels}],length:rt.time.length})}else ee.push({name:oe.name,refId:oe.refId,meta:{...oe.meta,type:Rr.m.TimeSeriesMulti},fields:[De,Ye],length:oe.length})}return ee}function ni(re){if(!Array.isArray(re)||re.length===0)return re;const ee=[];for(const oe of re){let De;const je=[],$e={},Ye={},st={},rt={};for(let Gt=0;Gt<oe.fields.length;Gt++){const en=oe.fields[Gt];switch(en.type){case X.PU.string:case X.PU.boolean:en.name in rt||(rt[en.name]=Gt,Ye[en.name]=!0);break;case X.PU.time:if(!De){De=en;break}default:if(en.name in $e){const Da=$e[en.name];if(en.type!==Da)continue}else $e[en.name]=en.type,je.push(en.name);const xn=JSON.stringify(en.labels),ma=st[xn];if(ma!==void 0?ma.push(Gt):st[xn]=[Gt],en.labels!=null)for(const Da in en.labels)Ye[Da]=!0}}if(!De)continue;const yt=[],Ot=[],Bt=[],kt=[];for(let Gt=0;Gt<oe.length;Gt++)yt.push({time:De.values[Gt],wideRowIndex:Gt});for(const Gt in st)Ot.push(Gt);for(const Gt in Ye)Bt.push(Gt);for(const Gt in rt)kt.push(Gt);yt.sort((Gt,en)=>Gt.time-en.time),Ot.sort(),Bt.sort(),je.sort();const $t=new Ki.k({...oe,meta:{...oe.meta,type:Rr.m.TimeSeriesLong},fields:[{name:De.name,type:De.type}]});for(const Gt of je)$t.addField({name:Gt,type:$e[Gt]});for(const Gt of Bt)$t.addField({name:Gt,type:X.PU.string});for(const Gt of yt){const{time:en,wideRowIndex:xn}=Gt;for(const ma of Ot){const Da={};for(const $n of kt)Da[$n]=oe.fields[rt[$n]].values[xn];let xa=0;for(const $n of st[ma]){const oa=oe.fields[$n];if(xa++===0&&oa.labels!=null)for(const Na in oa.labels)Da[Na]=oa.labels[Na];Da[oa.name]=oa.values[xn]}Da[De.name]=en,$t.add(Da)}}ee.push($t)}return ee}function mi(re){return fi(re,oe=>oe.type===X.PU.string).map(oe=>(oe.meta||(oe.meta={}),oe.meta.type=Rr.m.TimeSeriesMulti,oe))}const Oo={id:ne.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(re,ee)=>oe=>oe.pipe((0,La.T)(De=>Oo.transformer(re,ee)(De))),transformer:re=>{const ee=re?.format??"wide";if(ee==="many"||ee==="multi")return gi;if(ee==="long")return ni;const oe=Q.sJ.get(q.Ct.firstTimeField).get({});return De=>{if(!De.length)return[];const je=[];for(const Ye of De)Ye.meta?.type===Rr.m.TimeSeriesLong?mi(Ye).forEach(st=>je.push(st)):je.push(Ye);const $e=(0,sa.Fd)({frames:je,joinBy:oe,keepOriginIndices:!0});return $e?($e.meta||($e.meta={}),$e.meta.type=Rr.m.TimeSeriesWide,[$e]):[]}}},vo={label:"Wide time series",value:es.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.wide-info.single-frame",children:"Single frame"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.wide-info.st-field-is-shared-time",children:"1st field is shared time field"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.wide-info.time-in-ascending-order",children:"Time in ascending order"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.wide-info.multiple-value-fields-of-any-type",children:"Multiple value fields of any type"})})]})},Io={label:"Multi-frame time series",value:es.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.multi-info.multiple-frames",children:"Multiple frames"})}),(0,z.jsx)("li",{children:(0,z.jsxs)(u.x6,{i18nKey:"transformers.multi-info.frame-fields-value",values:{field1:"time",field2:"value"},children:["Each frame has two fields: ","{{field1}}",", ","{{field2}}"]})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.multi-info.time-in-ascending-order",children:"Time in ascending order"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.multi-info.string-values-are-represented-as-labels",children:"String values are represented as labels"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.multi-info.all-values-are-numeric",children:"All values are numeric"})})]})},nl={label:"Long time series",value:es.TimeSeriesLong,description:"Convert each frame to long format",info:(0,z.jsxs)("ul",{children:[(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.long-info.single-frame",children:"Single frame"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.long-info.st-field-is-time",children:"1st field is time field"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.long-info.ascending-order-duplicates",children:"Time in ascending order, but may have duplicates"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.long-info.string-values-separate",children:"String values are represented as separate fields rather than as labels"})}),(0,z.jsx)("li",{children:(0,z.jsx)(u.x6,{i18nKey:"transformers.long-info.multiple-value-fields-may-exist",children:"Multiple value fields may exist"})})]})},br=[vo,Io,nl];function vl(re){const{options:ee,onChange:oe}=re,De=(0,Ut.of)(ws),je=(0,c.useCallback)($e=>{oe({...ee,format:$e.value})},[oe,ee]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.prepare-time-series-editor.label-format","Format"),labelWidth:12,children:(0,z.jsx)(Me.l6,{width:35,options:br,value:br.find($e=>$e.value===es.TimeSeriesMulti&&ee.format===es.TimeSeriesMany?!0:$e.value===ee.format)||br[0],onChange:je,className:"flex-grow-1"})})}),(0,z.jsx)(Se.C,{children:(0,z.jsx)(de.I,{label:(0,u.t)("transformers.prepare-time-series-editor.label-info","Info"),labelWidth:12,children:(0,z.jsx)("div",{className:De.info,children:(br.find($e=>$e.value===ee.format)||br[0]).info})})})]})}const ws=re=>({info:(0,Mt.css)({marginLeft:"20px"})}),vi={id:Oo.id,editor:vl,transformation:Oo,name:Oo.name,description:Oo.description,categories:new Set([y.m.Reformat]),help:Pe(Oo.id).helperDocs};var al=e(66648),sl=e(48817),er=(re=>(re.linear="linear",re.polynomial="polynomial",re))(er||{});const Kr={predictionCount:100,modelType:"linear",degree:2},Fi=[{label:()=>(0,u.t)("transformers.regression-transformer-editor.label.quadratic","Quadratic"),value:2},{label:()=>(0,u.t)("transformers.regression-transformer-editor.label.cubic","Cubic"),value:3},{label:()=>(0,u.t)("transformers.regression-transformer-editor.label.quartic","Quartic"),value:4},{label:()=>(0,u.t)("transformers.regression-transformer-editor.label.quintic","Quintic"),value:5}],ai={id:ne.F.regression,name:"Trendline",description:"Create a new data frame containing values predicted by a statistical model.",operator:(re,ee)=>oe=>oe.pipe((0,La.T)(De=>ai.transformer(re,ee)(De))),transformer:(re,ee)=>oe=>{const{predictionCount:De,modelType:je,degree:$e}={...Kr,...re};if(oe.length===0)return oe;const Ye=Q.sJ.get(q.Ct.byName).get(re.yFieldName),st=Q.sJ.get(q.Ct.byName).get(re.xFieldName);let rt,yt,Ot;for(const oa of oe){const Na=oa.fields.find(Is=>Ye(Is,oa,oe));if(Na){yt=Na;const Is=oa.fields.find(Qo=>st(Qo,oa,oe));if(Is){rt=Is,Ot=oa;break}else throw"X and Y fields must be part of the same frame"}}if(!rt||!yt)return oe;let Bt=rt.values[0],kt=rt.values[0];for(let oa=1;oa<rt.values.length;oa++)rt.values[oa]<Bt&&(Bt=rt.values[oa]),rt.values[oa]>kt&&(kt=rt.values[oa]);const $t=(kt-Bt)/(De-1),Gt=[...[...Array(De-1).keys()].map((oa,Na)=>Na*$t+Bt),kt],en=rt.type===X.PU.time?Bt:0,xn=[],ma=[];for(let oa=0;oa<rt.values.length;oa++)yt.values[oa]!==null&&!isNaN(yt.values[oa])&&(ma.push(rt.values[oa]-en),xn.push(yt.values[oa]));let Da;switch(je){case"linear":Da=new sl.X(ma,xn);break;case"polynomial":Da=new al.Y(ma,xn,$e);break;default:return oe}let xa=`${(0,u.t)("transformers.regression-transformer-editor.model-type-options.label.linear","Linear")} ${(0,u.t)("transformers.regression-transformer-editor.regression","regression")}`;je==="polynomial"&&(xa=`${Fi.find(Na=>Na.value===$e)?.label()} ${(0,u.t)("transformers.regression-transformer-editor.model-type-options.label.polynomial","Polynomial").toLocaleLowerCase()} ${(0,u.t)("transformers.regression-transformer-editor.regression","regression")}`);const $n={name:`${xa}`,length:Gt.length,fields:[{name:rt.name,type:rt.type,values:Gt,config:{}},{name:`${(0,te.Ct)(yt,Ot,oe)}`,type:yt.type,values:Gt.map(oa=>Da.predict(oa-en)),config:{}}]};return[...oe,$n]}},wi={editor:ls.O,id:"",name:"",settings:{width:24,isClearable:!1}},Ro=20,yi=({input:re,options:ee,onChange:oe})=>{const De=[{label:(0,u.t)("transformers.regression-transformer-editor.model-type-options.label.linear","Linear"),value:er.linear},{label:(0,u.t)("transformers.regression-transformer-editor.model-type-options.label.polynomial","Polynomial"),value:er.polynomial}];return(0,c.useEffect)(()=>{let je,$e;if(!ee.xFieldName){const Ye=Q.sJ.get(q.Ct.firstTimeField).get({});for(const st of re)if(je=st.fields.find(rt=>Ye(rt,st,re)),je)break;if(!je){const st=Q.sJ.get(q.Ct.numeric).get({});for(const rt of re)if(je=rt.fields.find(yt=>st(yt,rt,re)),je)break}}if(!ee.yFieldName){const Ye=Q.sJ.get(q.Ct.numeric).get({});for(const st of re)if($e=st.fields.find(rt=>Ye(rt,st,re)&&rt!==je),$e)break}je&&$e&&oe({...ee,xFieldName:je.name,yFieldName:$e.name})}),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(de.I,{labelWidth:Ro,label:(0,u.t)("transformers.regression-transformer-editor.label-x-field","X field"),children:(0,z.jsx)(ls.O,{context:{data:re},value:ee.xFieldName??"",item:wi,onChange:je=>{oe({...ee,xFieldName:je})}})}),(0,z.jsx)(de.I,{labelWidth:Ro,label:(0,u.t)("transformers.regression-transformer-editor.label-y-field","Y field"),children:(0,z.jsx)(ls.O,{context:{data:re},value:ee.yFieldName??"",item:wi,onChange:je=>{oe({...ee,yFieldName:je})}})}),(0,z.jsx)(de.I,{labelWidth:Ro,label:(0,u.t)("transformers.regression-transformer-editor.label-model-type","Model type"),children:(0,z.jsx)(Me.l6,{value:ee.modelType??Kr.modelType,onChange:je=>{oe({...ee,modelType:je.value??Kr.modelType})},options:De})}),(0,z.jsx)(de.I,{labelWidth:Ro,label:(0,u.t)("transformers.regression-transformer-editor.label-predicted-points","Predicted points"),tooltip:(0,u.t)("transformers.regression-transformer-editor.tooltip-number-of-xy-points-to-predict","Number of X,Y points to predict"),children:(0,z.jsx)(Kt.Q,{value:ee.predictionCount??Kr.predictionCount,onChange:je=>{oe({...ee,predictionCount:je})}})}),ee.modelType===er.polynomial&&(0,z.jsx)(de.I,{labelWidth:Ro,label:(0,u.t)("transformers.regression-transformer-editor.label-degree","Degree"),children:(0,z.jsx)(Me.l6,{value:ee.degree??Kr.degree,options:Fi.map(je=>({label:je.label(),value:je.value})),onChange:je=>{oe({...ee,degree:je.value})}})})]})},Vi={id:ne.F.regression,editor:yi,transformation:ai,name:ai.name,description:ai.description,categories:new Set([y.m.CalculateNewFields]),help:Pe(ne.F.regression).helperDocs},ct={id:ne.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:re=>ee=>ee.pipe((0,La.T)(oe=>oe.map(De=>ft(re,De))))};function ft(re,ee){const oe=on(ee,re.mappings??[],!0),{nameField:De,valueField:je}=oe;if(!De||!je)return ee;const $e=[];for(let Ye=0;Ye<De.values.length;Ye++){const st=De.values[Ye],rt=je.values[Ye],yt=fa(ee,Ye,oe),Ot=Nt(ee,Ye,oe),Bt={name:`${st}`,type:je.type,values:[rt],config:yt,labels:Ot};$e.push(Bt)}return{fields:$e,length:1,refId:`${ne.F.rowsToFields}-${ee.refId}`}}function Nt(re,ee,oe){const De={...oe.nameField.labels};for(let je=0;je<re.fields.length;je++){const $e=re.fields[je],Ye=(0,te.Ct)($e,re),st=oe.index[Ye];if(st.handler&&st.handler.key!==Fn.Label)continue;const rt=$e.values[ee];rt!=null&&(De[Ye]=rt)}return De}function tn({input:re,options:ee,onChange:oe}){return re.length===0?null:(0,z.jsx)("div",{children:(0,z.jsx)(Wa,{frame:re[0],mappings:ee.mappings??[],onChange:De=>oe({...ee,mappings:De}),withNameAndValue:!0})})}const mn={id:ct.id,editor:tn,transformation:ct,name:ct.name,description:ct.description,state:we.pn.beta,categories:new Set([y.m.Reformat]),help:Pe(ct.id).helperDocs};var Dn=e(739),Rn=e(90267),Kn=e(90176),ra=e(98643),ca=e(87039),ba=e(78089);const Sa={id:ne.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:re=>ee=>ee.pipe((0,Co.Z)(oe=>(0,mo.H)(fs(oe,re))))};function cs(re){return re.action===Kn.dy.Modify&&re.modify?.op===Kn.YD.LineBuilder}async function fs(re,ee){const oe=await(0,ca.nE)(ee.source);if(cs(ee)){const De=await(0,ca.nE)(ee.modify?.target);return re.map(je=>{const $e=(0,ca.FM)(je,oe),Ye=(0,ca.FM)(je,De);if($e.field&&Ye.field){const st=[...je.fields],rt=(0,ra.XR)($e.field,Ye.field),yt=st[0];return yt.type===X.PU.geo&&yt!==$e.field&&yt!==Ye.field?st[0]=(0,ra.RA)(yt,rt):st.unshift(rt),{...je,fields:st}}return je})}return re.map(De=>{let je=(0,ca.FM)(De,oe);if(je.field){if(ee.action===Kn.dy.Modify){switch(ee.modify?.op){case Kn.YD.AsLine:let Ye=je.field.name;return(!Ye||Ye==="Point")&&(Ye="Line"),{...De,length:1,fields:[{...je.field,name:Ye,type:X.PU.geo,values:[(0,ba.tt)(je.field)]}]}}return De}const $e=je.derived?[je.field,...De.fields]:De.fields.slice(0);if(ee.action===Kn.dy.Calculate&&($e.push((0,ba.pp)(je.field,ee.calculate??{})),je.derived=!0),je.derived)return{...De,fields:$e}}return De})}const Qa=(re,ee)=>{const oe=ee.options??{};re.addSelect({path:"action",name:"Action",description:"",defaultValue:Kn.dy.Prepare,settings:{options:[{value:Kn.dy.Prepare,label:(0,u.t)("transformers.supplier.label.prepare-spatial-field","Prepare spatial field"),description:"Set a geometry field based on the results of other fields"},{value:Kn.dy.Calculate,label:(0,u.t)("transformers.supplier.label.calculate-value","Calculate value"),description:(0,u.t)("transformers.supplier.description.geometry-define-field-headingdistancearea","Use the geometry to define a new field (heading/distance/area)")},{value:Kn.dy.Modify,label:(0,u.t)("transformers.supplier.label.transform","Transform"),description:(0,u.t)("transformers.supplier.description.apply-spatial-operations-to-the-geometry","Apply spatial operations to the geometry")}]}}),oe.action===Kn.dy.Calculate?re.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:Kn.kD.Heading,settings:{options:[{value:Kn.kD.Heading,label:(0,u.t)("transformers.supplier.label.heading","Heading")},{value:Kn.kD.Area,label:(0,u.t)("transformers.supplier.label.area","Area")},{value:Kn.kD.Distance,label:(0,u.t)("transformers.supplier.label.distance","Distance")}]}}):oe.action===Kn.dy.Modify&&re.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:Kn.YD.AsLine,settings:{options:[{value:Kn.YD.AsLine,label:(0,u.t)("transformers.supplier.label.as-line","As line"),description:"Create a single line feature with a vertex at each row"},{value:Kn.YD.LineBuilder,label:(0,u.t)("transformers.supplier.label.line-builder","Line builder"),description:(0,u.t)("transformers.supplier.description.create-a-line-between-two-points","Create a line between two points")}]}}),cs(oe)?(re.addNestedOptions({category:["Source"],path:"source",build:(De,je)=>{const $e=oe.source??{mode:Dn.aG.Auto};(0,Rn.G)("Point","",De,$e)}}),re.addNestedOptions({category:["Target"],path:"modify",build:(De,je)=>{const $e=oe.modify?.target??{mode:Dn.aG.Auto};(0,Rn.G)("Point","target.",De,$e)}})):(0,Rn.G)("Location","source.",re,oe.source)},Ns=re=>{(0,c.useEffect)(()=>{if(!re.options.source?.mode){const De=ot(Qa);re.onChange({...De,...re.options}),console.log("geometry useEffect",De)}},[]);const ee=$s((0,Ut.$j)()),oe=qe(re,Qa);return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{children:oe.items.map(De=>De.render())}),(0,z.jsx)("div",{children:oe.categories.map(De=>(0,z.jsxs)("div",{className:ee.wrap,children:[(0,z.jsx)("h5",{children:De.props.title}),(0,z.jsx)("div",{className:ee.item,children:De.items.map(je=>je.render())})]},De.props.id))})]})},$s=re=>({wrap:(0,Mt.css)({marginBottom:"20px"}),item:(0,Mt.css)({borderLeft:`4px solid ${re.colors.border.strong}`,paddingLeft:"10px"})}),zs={id:ne.F.spatial,editor:Ns,transformation:Sa,name:Sa.name,description:Sa.description,state:we.pn.alpha,categories:new Set([y.m.PerformSpatialOperations]),help:Pe(ne.F.spatial).helperDocs};var Ds=e(17503);const as={id:ne.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:re=>{for(const ee of re)if((0,Ds.aH)(ee))return ys.M.Applicable;return ys.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:re=>ee=>ee.pipe((0,La.T)(oe=>Ar(re,oe)))};function Ar(re,ee){const oe={},De={},je=[];let $e=Dr(ee);for(const Ye of Object.keys($e)){const st=ee.filter(yt=>yt.refId===Ye);oe[Ye]={},De[Ye]={};const rt=[];st.forEach(yt=>{yt.fields.forEach(Ot=>{Ot.type===X.PU.number&&Ot.labels&&Object.keys(Ot.labels).forEach(Bt=>{rt.includes(Bt)||(De[Ye][Bt]=Yr(Bt,X.PU.string),rt.push(Bt))})})});for(let yt=0;yt<st.length;yt++){const Ot=st[yt];let Bt=null,kt=re[Ye]?.timeField;if(kt&&kt.length>0?Bt=Ot.fields.find($t=>$t.name===kt):Bt=Ot.fields.find($t=>(0,Ds.hF)($t)),!(0,Ds.aH)(Ot)){je.push(Ot);continue}for(const $t of Ot.fields){if($t.type!==X.PU.number)continue;const Gt=re[Ye]?.stat??cn.gy.lastNotNull,en=(0,cn.Nw)({field:$t,reducers:[Gt]})[Gt]??null,xn=new Ki.k;Bt!==void 0&&(xn.addField(Bt),xn.addField($t),oe[Ye][`Trend #${Ye}`]===void 0&&(oe[Ye][`Trend #${Ye}`]=Yr(`Trend #${Ye}`,X.PU.frame)),oe[Ye][`Trend #${Ye}`].values.push({...xn,value:en,length:$t.values.length})),rt.forEach(ma=>{De[Ye][ma].values.push($t.labels?.[ma]??"")})}}}for(const Ye of Object.keys($e)){const st={},rt=new Ki.k;rt.refId=Ye;const yt=De[Ye];if(yt!==void 0)for(const[Bt,kt]of Object.entries(yt))st[Bt]===void 0&&(st[Bt]=kt);for(const Bt of Object.values(st))rt.addField(Bt);const Ot=oe[Ye];for(const Bt of Object.values(Ot))rt.addField(Bt);rt.fields.length>0&&je.push(rt)}return je}function Yr(re,ee){return{name:re,type:ee,config:{},values:[]}}function Dr(re){let ee={};for(const oe of re)oe.refId!==void 0&&(ee[oe.refId]===void 0?ee[oe.refId]=1:ee[oe.refId]++);return ee}function jr({input:re,options:ee,onChange:oe}){const De=Dr(re),je=(0,c.useCallback)((st,rt)=>{const yt=rt?.value!==void 0?rt.value:"";oe({...ee,[st]:{...ee[st],timeField:yt}})},[oe,ee]),$e=(0,c.useCallback)((st,rt)=>{const yt=rt[0];yt&&(0,cn.Em)(yt)&&oe({...ee,[st]:{...ee[st],stat:yt}})},[oe,ee]);let Ye=[];for(const st of Object.keys(De)){const rt={},yt=[];for(const Ot of re)if(Ot.refId===st)for(const Bt of Ot.fields)(0,Ds.hF)(Bt)&&(rt[Bt.name]=Bt);for(const Ot of Object.values(rt)){const{name:Bt}=Ot;yt.push({label:Bt,value:Bt})}Ye.push((0,z.jsxs)(Se.C,{children:[(0,z.jsx)(de.I,{children:(0,z.jsx)(Ne.c,{children:`Trend #${st}`})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.time-series-table-transform-editor.label-time-field","Time field"),tooltip:(0,u.t)("transformers.time-series-table-transform-editor.tooltip-time-field","The time field that will be used for the time series. If not selected the first found will be used."),children:(0,z.jsx)(Me.l6,{onChange:je.bind(null,st),options:yt,value:ee[st]?.timeField,isClearable:!0})}),(0,z.jsx)(de.I,{label:(0,u.t)("transformers.time-series-table-transform-editor.label-stat","Stat"),tooltip:(0,u.t)("transformers.time-series-table-transform-editor.tooltip-statistic-should-calculated-series","The statistic that should be calculated for this time series."),children:(0,z.jsx)(un.S,{stats:[ee[st]?.stat??cn.gy.lastNotNull],onChange:$e.bind(null,st),filterOptions:Ot=>Ot.id!==cn.gy.allValues&&Ot.id!==cn.gy.uniqueValues})})]},st))}return(0,z.jsx)(z.Fragment,{children:Ye})}const Ks={id:as.id,editor:jr,transformation:as,name:as.name,description:as.description,state:we.pn.beta,help:Pe(as.id).helperDocs},ir=()=>[Ma,Hs,cr,xr,be,nr,Ja,qa,na,va,Ba,Gr,Es,os,zn,mn,Ia,vi,Lo,zs,Ui,wo,It,bn,xs,pr,Vi,$o,...J.$.featureToggles.formatString?[Tr]:[],...J.$.featureToggles.groupToNestedTableTransformation?[qo]:[],Xo,Ks,Er];var ar=e(26305),yo=e(88486),Cs=e(45229),no=e(24596),dr=e(31937),ao=e(35222);const lo=(0,c.lazy)(()=>Promise.resolve().then(e.bind(e,3208)).then(re=>({default:re.NestedFolderPicker}))),rl=re=>(0,z.jsx)(c.Suspense,{fallback:(0,z.jsx)(ao.A,{}),children:(0,z.jsx)(lo,{...re})});var $i=e(83162),jl=e(70715),xi=e(13791);function zo({actions:re,children:ee,info:oe,pageNav:De,layout:je,renderTitle:$e,subTitle:Ye}){const st=(0,c.useContext)(jl.A);return(0,z.jsx)(xi.Y,{navModel:st.sectionNav,pageNav:De,layout:je,actions:re,renderTitle:$e,info:oe,subTitle:Ye,children:(0,z.jsx)(xi.Y.Contents,{children:ee})})}var Ll=e(27963),zi=e(45928),Bl=e(43561),Ul=e(25992),ol=e(81041),Ls=e(15130);function il(){return typeof window.SharedWorker<"u"}class Ei{constructor(ee,oe){if(!il())throw new Error("SharedWorker is not supported");const De=ee.toString(),je=new URL(".",ee).toString(),$e=`importScripts('${De}');`,Ye=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${je}'; ${$e}`],{type:"application/javascript"})),st=new SharedWorker(Ye,oe);return URL.revokeObjectURL(Ye),st}}function yl(re){return!re||typeof re!="object"?!1:"totalJSHeapSize"in re&&"usedJSHeapSize"in re&&"jsHeapSizeLimit"in re}function xl(re){return!re||typeof re!="object"?!1:"memory"in re&&yl(re.memory)}function El(re){const ee={};function oe(De,je){if(typeof De=="object"&&De!==null){if(Array.isArray(De))throw new Error("Array values are not supported.");for(const $e in De)De.hasOwnProperty($e)&&oe(De[$e],je?`${je}_${$e}`:$e)}else typeof De=="string"?ee[je]=De:typeof De=="number"&&(Number.isInteger(De)?ee[je]=De.toString():ee[je]=De.toFixed(4))}return oe(re,"crash"),ee}const Pl=(0,Ul.DW)("core.crash-detection");function bl(){if(!il())return;let re=Date.now();document.body.addEventListener("click",()=>re=Date.now(),!0),document.body.addEventListener("keypress",()=>re=Date.now(),!0),(0,zi.initCrashDetection)({id:(0,Bl.Ak)(5),dbName:"grafana.crashes",createClientWorker(){return new ol.c(new URL(e.p+e.u(7235),e.b))},createDetectorWorker(){return new Ei(new URL(e.p+e.u(8220),e.b))},reportCrash:async ee=>{const oe=El(ee);return Pl.logWarning("browser crash detected",oe),!0},reportStaleTab:async ee=>{const oe=El(ee);return Pl.logWarning("stale browser tab detected",oe),!0},updateInfo:ee=>{ee.app={version:J.$.buildInfo.version,url:window.location.href},ee.user={email:Ls.TP.user.email,login:Ls.TP.user.login,name:Ls.TP.user.name,lastInteraction:re},xl(performance)&&(ee.memory={heapUtilization:performance.memory.usedJSHeapSize/performance.memory.totalJSHeapSize,limitUtilization:performance.memory.totalJSHeapSize/performance.memory.jsHeapSizeLimit,usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit})}})}var Pi=e(29662);const bi=re=>re.split("-")[0].toLowerCase(),ll={type:"backend",init(){},async read(re,ee,oe){let De=Pi.Yj.find(Ye=>Ye.code===re);if(De||(De=Pi.Yj.find(Ye=>bi(Ye.code)===bi(re))),!De)return oe(new Error(`No message loader available for ${re}`),null);const je=De.loader[ee];if(!je)return oe(new Error(`No message loader available for ${re} with namespace ${ee}`),null);const $e=await je();oe(null,$e)}};var cl=e(68555);async function Dl(){if(window.location.search.indexOf("why-render")!==-1){const{default:re}=await e.e(3718).then(e.t.bind(e,13718,23));re(m,{trackAllPureComponents:!0})}await(0,cl.TO)()}async function Cl(){await Dl()}async function Wl(){(0,cl.cd)()}var Nl=e(17016),Ee=e(83175);function et(re){const ee=re.target instanceof Element&&nt(re.target);if(!(re.ctrlKey||re.metaKey||re.defaultPrevented)&&ee){let oe=ee.getAttribute("href");const De=ee.getAttribute("target");if(oe&&!De){const je=Ee.kM.parseKeyValue(oe.split("?")[1]),$e=je.orgId&&Number(je.orgId)!==k.$W.bootData.user.orgId;if((0,C.Lc)("utils",!1,"intercepting link click",re),re.preventDefault(),oe=x.I.stripBaseFromUrl(oe),oe[0]!=="/"||$e)if(oe.indexOf("://")>0||oe.indexOf("mailto:")===0||$e){window.location.href=oe;return}else if(oe.indexOf("#")===0){window.location.hash=oe;return}else oe=`/${oe}`;C.Ny.push(oe)}}}function nt(re){for(;re!==null&&re.tagName;){if(re.tagName.toUpperCase()==="A")return re;re=re.parentElement}return null}var Ct=e(6219),vt=e(78529);class Pt{attachCorrelationsToDataFrames(ee,oe,De){return(0,Ct.cA)(ee,oe,De)}correlationsDataLinkPostProcessorFactory(ee){return(0,vt.YV)(void 0,ee)}getCorrelationsBySourceUIDs(ee){return(0,Ct.J6)(ee)}}var fe=e(33184),ae=e(27489),xe=e(4590);class Le{constructor(ee){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=ee??1e3*60*5}start(){const ee=(0,fe.oF)();ee&&ee.getConnectionState().subscribe(oe=>{oe&&this._checkForUpdates()}),C.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=C.Ny.getLocation().pathname}locationUpdated(ee){if(this.prevLocationPath===ee.pathname)return;const oe=ee.pathname.split("/");oe[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():oe[1]==="d"&&!xe._o.state.isPlaying?this.reloadIfUpdateDetected():this.hasUpdates&&(0,ae.rR)("new_frontend_assets_reload_ignored",{newLocation:ee.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=ee.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const ee=this.previous,oe=await(0,b.AI)().get("/api/frontend/assets");ee&&!(0,Y.isEqual)(ee,oe)&&(this.hasUpdates=!0,(0,ae.rR)("new_frontend_assets_detected",{assets:ee.assets!==oe.assets,plugins:ee.plugins!==oe.plugins,version:ee.version!==oe.version,flags:ee.flags!==oe.flags})),this.previous=oe}reloadIfUpdateDetected(){this.hasUpdates&&((0,ae.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var Ze=e(83873),at=e(25240);class ut{constructor(ee){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const oe of this.backends)oe.flush()},this.addBackend=oe=>{(0,at.S5)("Adding backend",!1,oe),this.backends.push(oe)},this.addEvent=(oe,De)=>{const je=this.getMeta(),$e={...oe,meta:{...je,...De}};for(const Ye of this.backends)(Ye.supportedEvents.length===0||Ye.supportedEvents.indexOf($e.type)>-1)&&Ye.addEvent($e);(0,at.S5)(`${oe.type} event`,!1,{...oe.payload,meta:$e.meta})},this.getMeta=()=>({sessionId:"",userId:Ls.TP.user.id,userLogin:Ls.TP.user.login,userSignedIn:Ls.TP.user.isSignedIn,orgRole:Ls.TP.user.orgRole,orgId:Ls.TP.user.orgId,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...ee},setInterval(this.flush,this.config.flushInterval)}}var Et=e(78731),Wt=e(57852),_t=e(32899),nn=e(62635),dn=e(37010),Pn=e(23753),Nn=e(75421),Cn=e(87745),Tn=e(47981),_n=e(73427),ka=e(12469),ja=e(44410);class ds{constructor(ee,oe){this.locationService=ee,this.chromeService=oe,this.panelId=null,Cs.A.subscribe(Wt.Tp,De=>{this.panelId=De.payload.panelId})}clearAndInitGlobalBindings(ee){ka.R.reset(),ee.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,ja.O)(!1)),this.bind("c r",()=>(0,ja.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const oe=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(oe&&oe instanceof HTMLElement&&(oe.nodeName==="INPUT"||oe.nodeName==="TEXTAREA"||oe.hasAttribute("data-slate-editor"))){oe.blur();return}this.exit()}}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Cs.A.publish(new Cn.S8({component:Tn.N}))}exit(){const ee=this.locationService.getSearchObject();if(ee.editview){this.locationService.partial({editview:null,editIndex:null});return}if(ee.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(ee.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(ee.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:oe}=this.chromeService.state.getValue();oe&&this.chromeService.exitKioskMode()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(ee,oe){ka.R.bind(ee,De=>{De.preventDefault(),De.stopPropagation(),De.returnValue=!1,oe.call(this)},"keydown")}bindGlobal(ee,oe){ka.R.bindGlobal(ee,De=>{De.preventDefault(),De.stopPropagation(),De.returnValue=!1,oe.call(this)},"keydown")}unbind(ee,oe){ka.R.unbind(ee,oe)}bindWithPanelId(ee,oe){this.bind(ee,this.withFocusedPanel(oe))}withFocusedPanel(ee){return()=>{if(typeof this.panelId=="number"){ee(this.panelId);return}}}setupTimeRangeBindings(ee=!0){this.bind("t a",()=>{Cs.A.publish(new Cn.Rh({updateUrl:ee}))}),this.bind("t z",()=>{Cs.A.publish(new Cn.U0({scale:2,updateUrl:ee}))}),this.bind("ctrl+z",()=>{Cs.A.publish(new Cn.U0({scale:2,updateUrl:ee}))}),this.bind("t left",()=>{Cs.A.publish(new Cn.Io({direction:Cn.xL.Left,updateUrl:ee}))}),this.bind("t right",()=>{Cs.A.publish(new Cn.Io({direction:Cn.xL.Right,updateUrl:ee}))}),this.bind("t c",()=>{Cs.A.publish(new Cn.Bt)}),this.bind("t v",()=>{Cs.A.publish(new Cn.VZ({updateUrl:ee}))})}setupDashboardBindings(ee){this.bind("mod+o",()=>{ee.graphTooltip=(ee.graphTooltip+1)%3,ee.events.publish(new _t.Tq),ee.startRefresh()}),this.bind("mod+s",()=>{ee.meta.canSave&&Cs.A.publish(new Cn.S8({component:dn.$,props:{dashboard:ee}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",oe=>{if(ee.canEditPanelById(oe)){const De=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:De?null:oe})}}),this.bindWithPanelId("v",oe=>{const De=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:De?null:oe})}),this.bindWithPanelId("p l",oe=>{const De=ee.getPanelById(oe),je={...De.options};je.legend.showLegend?je.legend.showLegend=!1:je.legend.showLegend=!0,De.updateOptions(je)}),this.bindWithPanelId("i",oe=>{this.locationService.partial({inspect:oe})}),_n.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async oe=>{const De=ee.getPanelById(oe),je=await(0,nn.Xe)({queries:De.targets,dsRef:De.datasource,scopedVars:De.scopedVars,timeRange:(0,Nn.jG)().timeRange()});if(je){const $e=x.I.stripBaseFromUrl(je);$e&&this.locationService.push($e)}}),this.bindWithPanelId("p r",oe=>{ee.canEditPanelById(oe)&&!(ee.panelInView||ee.panelInEdit)&&Cs.A.publish(new Cn.Vz(oe))}),this.bindWithPanelId("p d",oe=>{if(ee.canEditPanelById(oe)){const De=ee.getPanelInfoById(oe).index;ee.duplicatePanel(ee.panels[De])}}),this.bindWithPanelId("p s",oe=>{const De=ee.getPanelInfoById(oe);Cs.A.publish(new Cn.S8({component:Pn.Zy,props:{dashboard:ee,panel:De?.panel}}))}),this.bind("d l",()=>{ee.toggleLegendsForAll()}),this.bind("d x",()=>{ee.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{ee.collapseRows()}),this.bind("d shift+e",()=>{ee.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{ee.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const De=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+De})}}var da=e(60017),_a=e(25157),gs=e(54),ts=e(52161);const Mr=(0,c.lazy)(()=>e.e(192).then(e.bind(e,48278)));function si(){const re=(0,gs.Wd)(ts.hY),ee=J.$.unifiedAlertingEnabled;Ls.TP.hasPermission(re.read)&&(0,_a.fP)({show:()=>ee,component:({dashboard:oe})=>ee?(0,z.jsx)(c.Suspense,{fallback:null,children:oe&&(0,z.jsx)(Mr,{dashboardUid:oe.uid})},"alert-rules-button"):null,index:-2})}var Kl=e(69874);function gr(re){return(0,z.jsx)(xo,{...re})}const xo=(0,c.lazy)(async()=>{const{EmbeddedDashboard:re}=await e.e(2859).then(e.bind(e,72340));return{default:re}});var Di=e(4405),Ci=e(65556),Sr=e(35392),so=e(1005),ri=e(96222),Tl=e(49426),sr=e(38619),Go=e(51388),Ml=e(88483),zc=e(39741),tr=e(28105),xc=e(97534),Ti=e(46383);const Hd=re=>ee=>new Ml.c(oe=>{let De=[],je=!0;const $e=()=>{oe.next(De),De=[]},Ye=re.subscribe({next:rt=>{je=rt,je&&De.length&&$e()}}),st=ee.subscribe({next(rt){je?De.length?$e():oe.next([rt]):De.push(rt)},error(rt){oe.error(rt)},complete(){oe.complete()}});return()=>{st.unsubscribe(),Ye.unsubscribe()}});var Qd=(re=>(re[re.Error=0]="Error",re[re.NewValuesSameSchema=1]="NewValuesSameSchema",re[re.ChangedSchema=2]="ChangedSchema",re))(Qd||{});const _d=re=>({values:re.reduce((ee,{values:oe})=>{for(let De=0;De<oe.length;De++){ee[De]||(ee[De]=[]);for(let je=0;je<oe[De].length;je++)ee[De].push(oe[De][je])}return ee},[]),type:1}),ql=(re,ee)=>re.filter(oe=>oe.type===ee);class kd{constructor(ee){this.deps=ee,this.stream=new zc.m(1),this.shutdown=()=>{this.stream.complete(),this.liveEventsSubscription.unsubscribe(),this.deps.onShutdown()},this.shutdownIfNoSubscribers=()=>{this.stream.observed||this.shutdown()},this.onError=oe=>{console.log("LiveQuery [error]",{err:oe},this.deps.channelId),this.stream.next({type:0,error:(0,xc.u)(oe)}),this.shutdown()},this.onComplete=()=>{console.log("LiveQuery [complete]",this.deps.channelId),this.shutdown()},this.onNext=oe=>{if((0,sr.Z7)(oe)){this.process(oe.message);return}const De=(0,sr.ew)(oe);if(De&&oe.error){const je=(0,xc.u)(oe.error);this.stream.next({type:0,error:{...je,message:`Streaming channel error: ${je.message}`}})}De&&(oe.state===sr.ZF.Connected||oe.state===sr.ZF.Pending)&&oe.message&&this.process(oe.message)},this.process=oe=>{this.frameBuffer.push(oe).schemaChanged?this.stream.next({type:2}):this.stream.next({type:1,values:this.frameBuffer.getValuesFromLastPacket()})},this.resizeBuffer=oe=>{oe&&this.frameBuffer.needsResizing(oe)&&this.frameBuffer.resize(oe)},this.prepareInternalStreamForNewSubscription=oe=>{!this.frameBuffer.hasAtLeastOnePacket()&&oe.frame&&this.process(oe.frame)},this.clearShutdownTimeout=()=>{this.shutdownTimeoutId&&(clearTimeout(this.shutdownTimeoutId),this.shutdownTimeoutId=void 0)},this.get=(oe,De)=>{this.clearShutdownTimeout();const je=(0,Go.m8)(oe.buffer);this.resizeBuffer(je),this.prepareInternalStreamForNewSubscription(oe);const $e=oe?.buffer?.action===Go.Kh.Replace,Ye=oe.filter?.fields,rt=Ye?.length?({name:Gt})=>Ye.includes(Gt):void 0;let yt;const Ot=(Gt,en)=>(yt=rt?this.frameBuffer.getMatchingFieldIndexes(rt):void 0,$e?en?{key:De,state:tr.Gu.Error,data:[{type:Ti._w.FullFrame,frame:this.frameBuffer.serialize(rt,je,{maxLength:0})}],error:en}:Gt.length?{key:De,state:tr.Gu.Streaming,data:[{type:Ti._w.FullFrame,frame:this.frameBuffer.serialize(rt,je,{maxLength:this.frameBuffer.packetInfo.length})}],error:en}:(console.warn(`expected to find at least one non error message ${Gt.map(({type:xn})=>xn)}`),{key:De,state:tr.Gu.Streaming,data:[{type:Ti._w.FullFrame,frame:this.frameBuffer.serialize(rt,je,{maxLength:0})}],error:en}):{key:De,state:en?tr.Gu.Error:tr.Gu.Streaming,data:[{type:Ti._w.FullFrame,frame:this.frameBuffer.serialize(rt,je)}],error:en}),Bt=Gt=>{const en=Gt.length?Gt[Gt.length-1]:void 0,xn=$e&&en?en.values:_d(Gt).values,ma=yt?xn.filter((Da,xa)=>yt?.includes(xa)):xn;return{key:De,state:tr.Gu.Streaming,data:[{type:Ti._w.NewValuesSameSchema,values:ma}]}};let kt=!0;const $t=this.stream.pipe(Hd(this.deps.subscriberReadiness),(0,La.T)((Gt,en)=>{const xn=ql(Gt,0),ma=xn.length?xn[xn.length-1].error:void 0;if(kt)return kt=!1,Ot(Gt,ma);if(xn.length)return Ot(Gt,ma);if(Gt.some($n=>$n.type===2))return Ot(Gt,void 0);const xa=ql(Gt,1);return xa.length!==Gt.length&&console.warn(`unsupported message type ${Gt.map(({type:$n})=>$n)}`),Bt(xa)}));return new Ml.c(Gt=>{const en=$t.subscribe({next:xn=>{Gt.next(xn)},error:xn=>{Gt.error(xn)},complete:()=>{Gt.complete()}});return()=>{en.unsubscribe(),this.stream.observed||(this.clearShutdownTimeout(),this.shutdownTimeoutId=setTimeout(this.shutdownIfNoSubscribers,this.deps.shutdownDelayInMs))}})},this.frameBuffer=Go.k9.empty(ee.defaultStreamingFrameOptions),this.liveEventsSubscription=ee.liveEventsObservable.subscribe({error:this.onError,complete:this.onComplete,next:this.onNext})}}var Fl=e(13752);class Yd{constructor(ee,oe){this.opened=Date.now(),this.stream=new Fl.B,this.disconnectIfNoListeners=()=>{this.stream.observers.length===0&&this.disconnect()},this.publish=De=>this.subscription?.publish(De),this.id=ee,this.addr=oe,this.currentStatus={type:sr.o4.Status,id:ee,timestamp:this.opened,state:sr.ZF.Pending},(0,sr.aj)(oe)||(this.currentStatus.state=sr.ZF.Invalid,this.currentStatus.error="invalid channel address")}initalize(){if(this.initalized)throw new Error("Channel already initalized: "+this.id);this.initalized=!0,this.subscription.on("publication",ee=>{try{ee.data&&(ee.data.schema&&(this.lastMessageWithSchema=ee.data),this.stream.next({type:sr.o4.Message,message:ee.data})),this.currentStatus.error&&(this.currentStatus.timestamp=Date.now(),delete this.currentStatus.error,this.sendStatus())}catch(oe){console.log("publish error",this.addr,oe),this.currentStatus.error=oe,this.currentStatus.timestamp=Date.now(),this.sendStatus()}}).on("error",ee=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.error=ee.error.message,this.sendStatus()}).on("subscribed",ee=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=sr.ZF.Connected,delete this.currentStatus.error,ee.data?.schema&&(this.lastMessageWithSchema=ee.data),this.sendStatus(ee.data)}).on("unsubscribed",()=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=sr.ZF.Disconnected,this.sendStatus()}).on("subscribing",()=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=sr.ZF.Connecting,this.sendStatus()}).on("join",ee=>{this.stream.next({type:sr.o4.Join,user:ee.info.user})}).on("leave",ee=>{this.stream.next({type:sr.o4.Leave,user:ee.info.user})})}sendStatus(ee){const oe={...this.currentStatus};ee&&(oe.message=ee),this.stream.next(oe)}getStream(){return new Ml.c(ee=>{const oe={...this.currentStatus};this.lastMessageWithSchema?.schema&&(oe.message={schema:this.lastMessageWithSchema?.schema}),ee.next({...this.currentStatus,message:this.lastMessageWithSchema});const De=this.stream.subscribe(ee);return()=>{De.unsubscribe(),this.stream.observers.length===0&&setTimeout(this.disconnectIfNoListeners,250)}})}async getPresence(){return this.subscription?this.subscription.presence().then(ee=>({users:Object.keys(ee.clients)})):Promise.reject("not subscribed")}disconnect(){this.currentStatus.state=sr.ZF.Shutdown,this.currentStatus.timestamp=Date.now(),this.subscription&&(this.subscription.unsubscribe(),this.subscription.removeAllListeners(),this.subscription=void 0),this.stream.complete(),this.stream.next({...this.currentStatus}),this.stream.complete(),this.shutdownCallback&&this.shutdownCallback()}shutdownWithError(ee){this.currentStatus.error=ee,this.sendStatus(),this.disconnect()}}function Jd(re,ee,oe){return{id:ee,opened:Date.now(),addr:oe,getStream:()=>of({type:LiveChannelEventType.Status,id:ee,timestamp:Date.now(),state:LiveChannelConnectionState.Invalid,error:re}),disconnect:()=>{}}}const Gc={maxLength:100,maxDelta:1/0,action:Go.Kh.Append},Zd=5e3;class Xd{constructor(ee){this.deps=ee,this.open=new Map,this.liveDataStreamByChannelId={},this.onConnect=je=>{this.connectionState.next(!0)},this.onDisconnect=je=>{this.connectionState.next(!1)},this.onServerSideMessage=je=>{console.log("Publication from server-side channel",je)},this.getConnectionState=()=>this.connectionState.asObservable(),this.getStream=je=>this.getChannel(je).getStream(),this.createSubscriptionKey=je=>je.key??`xstr/${qd++}`,this.getLiveDataStream=je=>{const $e=(0,sr.Qp)(je.addr),Ye=this.liveDataStreamByChannelId[$e];if(Ye)return Ye;const st=this.getChannel(je.addr);return this.liveDataStreamByChannelId[$e]=new kd({channelId:$e,onShutdown:()=>{delete this.liveDataStreamByChannelId[$e]},liveEventsObservable:st.getStream(),subscriberReadiness:this.dataStreamSubscriberReadiness,defaultStreamingFrameOptions:Gc,shutdownDelayInMs:Zd}),this.liveDataStreamByChannelId[$e]},this.getDataStream=je=>{const $e=this.createSubscriptionKey(je);return this.getLiveDataStream(je).get(je,$e)},this.getQueryData=async je=>(this.centrifuge.state!==Sr.Uw.Connected&&await this.connectionBlocker,this.centrifuge.rpc("grafana.query",je.body)),this.getPresence=je=>this.getChannel(je).getPresence(),this.publish=async(je,$e,Ye)=>this.getChannel(je).publish($e),this.dataStreamSubscriberReadiness=ee.dataStreamSubscriberReadiness.pipe((0,so.u)(),(0,ri.Z)(!0));let oe=`${ee.appUrl.replace(/^http/,"ws")}/api/live/ws`;const De=ee.grafanaAuthToken;De!==null&&De!==""&&(oe+="?auth_token="+De),this.centrifuge=new Sr.Ft(oe,{timeout:3e4}),ee.liveEnabled&&ee.orgRole!==""&&this.centrifuge.connect(),this.connectionState=new Tl.t(this.centrifuge.state===Sr.Uw.Connected),this.connectionBlocker=new Promise(je=>{if(this.centrifuge.state===Sr.Uw.Connected)return je();const $e=()=>{je(),this.centrifuge.removeListener("connected",$e)};this.centrifuge.addListener("connected",$e)}),this.centrifuge.on("connected",this.onConnect),this.centrifuge.on("connecting",this.onDisconnect),this.centrifuge.on("disconnected",this.onDisconnect),this.centrifuge.on("publication",this.onServerSideMessage)}getChannel(ee){const oe=`${this.deps.orgId}/${ee.scope}/${ee.namespace}/${ee.path}`;let De=this.open.get(oe);return De!=null||(De=new Yd(oe,ee),De.currentStatus.state===sr.ZF.Invalid)||(De.shutdownCallback=()=>{this.open.delete(oe),this.centrifuge.removeSubscription(this.centrifuge.getSubscription(oe))},this.open.set(oe,De),this.initChannel(De).catch(je=>{De&&(De.currentStatus.state=sr.ZF.Invalid,De.shutdownWithError(je)),this.open.delete(oe)})),De}async initChannel(ee){this.centrifuge.state!==Sr.Uw.Connected&&await this.connectionBlocker;const oe=this.centrifuge.newSubscription(ee.id,{data:ee.addr.data});ee.subscription=oe,ee.initalize(),oe.subscribe()}}let qd=0;class eu{constructor(ee){this.deps=ee,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=oe=>{let De;const je=$e=>{const Ye=$e.data[0];if(!De&&!(0,Ti.ot)(Ye,Ti._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${Ye?.type}`);return}switch(Ye.type){case Ti._w.FullFrame:{De=Go.k9.deserialize(Ye.frame);return}case Ti._w.NewValuesSameSchema:{De.pushNewValues(Ye.values);return}}};return this.deps.centrifugeSrv.getDataStream(oe).pipe((0,La.T)($e=>(je($e),{...$e,data:[De??Go.k9.empty()]})))},this.getStream=oe=>this.deps.centrifugeSrv.getStream(oe),this.publish=async(oe,De,je)=>je?.useSocket?this.deps.centrifugeSrv.publish(oe,De):this.deps.backendSrv.post("api/live/publish",{channel:(0,sr.Qp)(oe),data:De}),this.getPresence=oe=>this.deps.centrifugeSrv.getPresence(oe)}}function tu(){const re={appUrl:`${window.location.origin}${J.$.appSubUrl}`,orgId:Ls.TP.user.orgId,orgRole:Ls.TP.user.orgRole,liveEnabled:J.$.liveEnabled,dataStreamSubscriberReadiness:Di.a.ok.asObservable(),grafanaAuthToken:(0,Ci.r)()},ee=new Xd(re);(0,fe.S8)(new eu({centrifugeSrv:ee,backendSrv:(0,b.AI)()}))}function nu(){return getGrafanaLiveSrv()}var Hc=e(88642),Qc=e(35307),dl=e(28998),_c=e(8001),ec=e(24120),tc=e(31595),Sl=e(28337),ul=e(4745),nc=e(96016),au=e(16817),Ec=e(95027),kc=e(58666);const ac=new Map,hf=()=>{ac.clear()};async function Pc(re=[]){const ee=re.map(oe=>(ac.has(oe.id)||ac.set(oe.id,su(oe)),ac.get(oe.id)));await Promise.all(ee)}async function su(re){try{const ee=await(0,Ec.x)(re.id,{showErrorAlert:Ls.TP.user.orgRole!==""});await(0,kc.ui)(ee)}catch(ee){console.error(`[Plugins] Failed to preload plugin: ${re.path} (version: ${re.version})`,ee)}}var Or=e(3260);function sc(re=[]){const{loading:ee}=(0,au.A)(async()=>{const oe=(0,Or.uS)(re);oe.length&&await Pc(oe)});return{isLoading:ee}}var hl=e(9453);function ru(re){const ee=(0,Sl.ZV)(),oe=(0,ec.A)(ee.asObservable()),De=(0,tc.Q)(),{isLoading:je}=sc((0,Or.Uy)(re));return(0,c.useMemo)(()=>{const $e=(0,Or.V2)()&&De;if(je)return{isLoading:!0,component:null};if(!oe?.[re])return{isLoading:!1,component:null};const Ye=oe[re],st=nc.R.child({title:Ye.title,description:Ye.description??"",pluginId:Ye.pluginId});return $e&&(0,hl.xM)(re,De)?(st.error(ul.ij),{isLoading:!1,component:null}):{isLoading:!1,component:(0,Or.nv)({pluginId:Ye.pluginId,extensionTitle:Ye.title,Component:Ye.component,log:st})}},[re,De,oe,je])}var bc=e(54092);function ou({limitPerPlugin:re,extensionPointId:ee}){const oe=(0,Sl.TX)(),De=(0,ec.A)(oe.asObservable()),je=(0,tc.Q)(),{isLoading:$e}=sc((0,Or.Ce)(ee));return(0,c.useMemo)(()=>{const Ye=(0,Or.V2)()&&je,st=[],rt={},yt=je?.meta.id??"",Ot=nc.R.child({pluginId:yt,extensionPointId:ee});if(Ye&&!(0,hl.Fe)({extensionPointId:ee,pluginId:yt})&&Ot.error(ul.Bs),Ye&&(0,hl.PW)(ee,je))return Ot.error(ul.Ri),{isLoading:!1,components:[]};if($e)return{isLoading:!0,components:[]};for(const Bt of De?.[ee]??[]){const{pluginId:kt}=Bt;if(re&&rt[kt]>=re)continue;rt[kt]===void 0&&(rt[kt]=0);const $t=iu(Bt,ee);st.push($t),rt[kt]+=1}return{isLoading:!1,components:st}},[ee,re,je,De,$e])}function iu(re,ee){const{component:oe,...De}=re;function je($e){return(0,z.jsx)(oe,{...$e})}return je.displayName=oe.displayName,je.defaultProps=oe.defaultProps,je.propTypes=oe.propTypes,je.contextTypes=oe.contextTypes,je.meta={pluginId:De.pluginId,title:De.title??"",description:De.description??"",id:(0,Or.yt)(De.pluginId,ee,De.title),type:bc.u.component},je}function lu({limitPerPlugin:re,extensionPointId:ee}){const oe=(0,Sl.ov)(),De=(0,ec.A)(oe.asObservable()),je=(0,tc.Q)(),$e=(0,Or.Ce)(ee),{isLoading:Ye}=sc($e);return(0,c.useMemo)(()=>{const st=(0,Or.V2)()&&je,rt=[],yt={},Ot=je?.meta.id??"",Bt=nc.R.child({pluginId:Ot,extensionPointId:ee});if(st&&!(0,hl.Fe)({extensionPointId:ee,pluginId:Ot})&&Bt.error(ul.Bs),st&&(0,hl.PW)(ee,je))return Bt.error(ul.Ri),{isLoading:!1,functions:[]};if(Ye)return{isLoading:!0,functions:[]};for(const kt of De?.[ee]??[]){const{pluginId:$t}=kt;re&&yt[$t]>=re||(yt[$t]===void 0&&(yt[$t]=0),rt.push({id:(0,Or.yt)($t,ee,kt.title),type:bc.u.function,title:kt.title,description:kt.description??"",pluginId:$t,fn:kt.fn}),yt[$t]+=1)}return{isLoading:!1,functions:rt}},[ee,re,je,De,Ye])}function cu({limitPerPlugin:re,extensionPointId:ee,context:oe}){const De=(0,Sl.OG)(),je=(0,tc.Q)(),$e=(0,ec.A)(De.asObservable()),{isLoading:Ye}=sc((0,Or.Ce)(ee));return(0,c.useMemo)(()=>{const st=(0,Or.V2)()&&je!==null,rt=je?.meta.id??"",yt=nc.R.child({pluginId:rt,extensionPointId:ee});if(st&&!(0,hl.Fe)({extensionPointId:ee,pluginId:rt}))return yt.error(ul.Bs),{isLoading:!1,links:[]};if(st&&(0,hl.PW)(ee,je))return yt.error(ul.Ri),{isLoading:!1,links:[]};if(Ye)return{isLoading:!0,links:[]};if(!$e||!$e[ee])return{isLoading:!1,links:[]};const Ot=oe?(0,Or.$Y)(oe):{},Bt=[],kt={};for(const $t of $e[ee]??[]){const{pluginId:Gt}=$t,en=yt.child({path:$t.path??"",title:$t.title,description:$t.description??"",onClick:typeof $t.onClick});if(re&&kt[Gt]>=re){en.debug(`Skipping link extension from plugin "${Gt}". Reason: Limit reached.`);continue}kt[Gt]===void 0&&(kt[Gt]=0);const xn=(0,Or.hS)(Gt,$t,en,Ot);if($t.configure&&xn===void 0)continue;const ma=xn?.path||$t.path,Da={id:(0,Or.yt)(Gt,ee,$t.title),type:bc.u.link,pluginId:Gt,onClick:(0,Or.dx)(Gt,ee,$t,en,Ot),icon:xn?.icon||$t.icon,title:xn?.title||$t.title,description:xn?.description||$t.description||"",path:(0,Y.isString)(ma)?(0,Or.YS)(Gt,ma,ee):void 0,category:xn?.category||$t.category};Bt.push(Da),kt[Gt]+=1}return{isLoading:!1,links:Bt}},[oe,ee,re,$e,je,Ye])}var Yc=e(92391),du=e(57532),wl=e(1906),Jc=e(17548),Zc=e(96215),uu=e(39050),Dc=e(71393);class hu{constructor(){this.subject=new zc.m(1)}get(){return this.subject.asObservable()}run(ee){const{queries:oe,timezone:De,datasource:je,panelId:$e,app:Ye,dashboardUID:st,timeRange:rt,timeInfo:yt,cacheTimeout:Ot,queryCachingTTL:Bt,maxDataPoints:kt,scopedVars:$t,minInterval:Gt}=ee;this.subscription&&this.subscription.unsubscribe();const en={app:Ye??wl.Jk.Unknown,requestId:(0,Zc.S)(),timezone:De,panelId:$e,dashboardUID:st,range:rt,timeInfo:yt,interval:"",intervalMs:0,targets:(0,Y.cloneDeep)(oe),maxDataPoints:kt,scopedVars:$t||{},cacheTimeout:Ot,queryCachingTTL:Bt,startTime:Date.now()};en.rangeRaw=rt.raw,(0,mo.H)(fu(je,en.scopedVars)).pipe((0,du.$)()).subscribe({next:xn=>{en.targets=en.targets.map(xa=>(xa.datasource||(xa.datasource=xn.getRef()),xa));const ma=Gt?(0,dt.w)().replace(Gt,en.scopedVars):xn.interval,Da=Jc.calculateInterval(rt,kt,ma);en.scopedVars=Object.assign({},en.scopedVars,{__interval:{text:Da.interval,value:Da.interval},__interval_ms:{text:Da.intervalMs.toString(),value:Da.intervalMs}}),en.interval=Da.interval,en.intervalMs=Da.intervalMs,this.subscription=(0,Dc.BN)(xn,en).subscribe({next:xa=>{const $n=(0,Qr.N$)(xa,this.lastResult);this.lastResult=(0,uu.B)($n,this.lastResult),this.subject.next(this.lastResult)}})},error:xn=>console.error("PanelQueryRunner Error",xn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===tr.Gu.Loading&&this.subject.next({...this.lastResult,state:tr.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function fu(re,ee){return re&&"query"in re?re:(0,dl.tR)().get(re,ee)}var Xc=e(22429);function pu(){window.grafanaRuntime={getDashboardSaveModel:()=>{const re=(0,Xc.UA)().getCurrent();if(re)return re.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const re=(0,Nn.jG)().timeRange();return{from:re.from.valueOf(),to:re.to.valueOf(),raw:re.raw}},getPanelData:()=>{const re=(0,Xc.UA)().getCurrent();if(re)return re.panels.reduce((ee,oe)=>(ee[oe.id]=oe.getQueryRunner().getLastResult(),ee),{})}}}var gu=e(35886),Vl=e(54742),rr=e(8535),ea=e(99305),Ol=e(71468),Cc=e(48480),qc=e(99584),Mi=e(17752);function ed(re){return re.extended&&"infoText"in re.extended?re.extended:null}function td(re){return re.extended&&"dataSourceTypes"in re.extended?re.extended:null}function Tc(re){return re.extended&&"dataSource"in re.extended?re.extended:null}var ms=e(93612),$l=e(48421);const mu=(re,ee)=>{const{rootStateKey:oe}=ee.variable;if(!oe)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:ed(Mi.nS)};const{editor:De}=(0,ms.nx)(oe,re);return{extended:ed(De)}},vu={changeVariableDatasource:$l.Iv},yu=(0,Ol.connect)(mu,vu);class xu extends c.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=ee=>{this.props.changeVariableDatasource((0,ea.jX)(this.props.variable),(0,Cc.p$)(ee))}}componentDidMount(){const{rootStateKey:ee}=this.props.variable;if(!ee){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:ee,extended:oe}=this.props;return(0,z.jsx)(qc.Q,{datasource:ee.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:oe?.infoText,datasourceSupported:ee.datasource!==void 0})}}const Eu=yu(xu);var nd=e(61875),Si=e(76671);const ad=90,sd=({datasource:re,onChange:ee,disabled:oe,filterKey:De,allFilters:je})=>{const $e=()=>Jr(re,De,je),Ye=()=>bu(re,De,je),st=(0,z.jsx)("span",{className:"gf-form-label query-part","aria-label":(0,u.t)("variables.ad-hoc-filter-key.plus-segment.aria-label-add-filter","Add Filter"),children:(0,z.jsx)(Os.I,{name:"plus"})});return De===null?(0,z.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,z.jsx)(Si.s,{disabled:oe,className:"query-segment-key",Component:st,value:De,onChange:ee,loadOptions:$e,inputMinWidth:ad})}):(0,z.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,z.jsx)(Si.s,{disabled:oe,className:"query-segment-key",value:De,onChange:ee,loadOptions:Ye,inputMinWidth:ad})})},rc="-- remove filter --",Pu={label:rc,value:rc},Jr=async(re,ee,oe)=>{const De=await(0,dl.tR)().get(re);if(!De||!De.getTagKeys)return[];const je=oe.filter(st=>st.key!==ee),$e=await De.getTagKeys({filters:je});return(Array.isArray($e)?$e:$e.data).map(st=>({label:st.text,value:st.text}))},bu=async(re,ee,oe)=>{const De=await Jr(re,ee,oe);return[Pu,...De]},Du=({datasource:re,disabled:ee,onChange:oe,filterKey:De,filterValue:je,placeHolder:$e,allFilters:Ye})=>{const st=(0,Ut.of)(Tu),rt=()=>Cu(re,De,Ye);return(0,z.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,z.jsx)(Si.s,{className:st.segment,disabled:ee,placeholder:$e,value:je,onChange:oe,loadOptions:rt})})},Cu=async(re,ee,oe)=>{const De=await(0,dl.tR)().get(re);if(!De||!De.getTagValues)return[];const je=(0,Nn.jG)().timeRange(),$e=oe.filter(rt=>rt.key!==ee),Ye=await De.getTagValues({key:ee,filters:$e,timeRange:je});return(Array.isArray(Ye)?Ye:Ye.data).map(rt=>({label:rt.text,value:rt.text}))};function Tu(){return{segment:(0,Mt.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Mc=["=","!=","<",">","=~","!~"].map(re=>({label:re,value:re})),Mu=({value:re,disabled:ee,onChange:oe})=>(0,z.jsx)(nd.Y,{className:"query-segment-operator",value:re,disabled:ee,options:Mc,onChange:oe}),rd=({datasource:re,filter:{key:ee,operator:oe,value:De},onKeyChange:je,onOperatorChange:$e,onValueChange:Ye,placeHolder:st,allFilters:rt,disabled:yt})=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(sd,{disabled:yt,datasource:re,filterKey:ee,onChange:je,allFilters:rt}),(0,z.jsx)("div",{className:"gf-form",children:(0,z.jsx)(Mu,{disabled:yt,value:oe,onChange:$e})}),(0,z.jsx)(Du,{disabled:yt,datasource:re,filterKey:ee,filterValue:De,allFilters:rt,onChange:Ye,placeHolder:st})]}),od=({datasource:re,appendBefore:ee,onCompleted:oe,allFilters:De})=>{const[je,$e]=(0,c.useState)(null),[Ye,st]=(0,c.useState)("="),rt=(0,c.useCallback)(Bt=>{if(Bt.value!==rc){$e(Bt.value??"");return}$e(null)},[$e]),yt=(0,c.useCallback)(Bt=>st(Bt.value??""),[st]),Ot=(0,c.useCallback)(Bt=>{oe({value:Bt.value??"",operator:Ye,key:je}),$e(null),st("=")},[oe,Ye,je]);return je===null?(0,z.jsx)(sd,{datasource:re,filterKey:je,onChange:rt,allFilters:De}):(0,z.jsxs)(c.Fragment,{children:[ee,(0,z.jsx)(rd,{datasource:re,filter:{key:je,value:"",operator:Ye},placeHolder:(0,u.t)("variable.adhoc.placeholder","Select value"),onKeyChange:rt,onOperatorChange:yt,onValueChange:Ot,allFilters:De})]},"filter-builder")},id=({label:re})=>(0,z.jsx)("div",{className:"gf-form",children:(0,z.jsx)("span",{className:"gf-form-label query-keyword",children:re})});class Sc extends c.PureComponent{constructor(){super(...arguments),this.connectorLabel=(0,u.t)("variables.ad-hoc-filter.label-and","AND"),this.onChange=(ee,oe)=>De=>{const{filters:je}=this.props,{value:$e}=De;return De.value===rc?this.props.removeFilter(ee):this.props.changeFilter(ee,{...je[ee],[oe]:$e})},this.appendFilterToVariable=ee=>{this.props.addFilter(ee)}}render(){const{filters:ee,disabled:oe}=this.props;return(0,z.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(ee,oe),!oe&&(0,z.jsx)(od,{datasource:this.props.datasource,appendBefore:ee.length>0?(0,z.jsx)(id,{label:this.connectorLabel}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(ee,oe){return ee.length===0&&oe?(0,z.jsx)(nd.Y,{disabled:oe,value:"No filters",options:[],onChange:()=>{}}):ee.reduce((De,je,$e)=>(De.length>0&&De.push((0,z.jsx)(id,{label:this.connectorLabel},`condition-${$e}`)),De.push(this.renderFilterSegments(je,$e,oe)),De),[])}renderFilterSegments(ee,oe,De){return(0,z.jsx)(c.Fragment,{children:(0,z.jsx)(rd,{disabled:De,datasource:this.props.datasource,filter:ee,onKeyChange:this.onChange(oe,"key"),onOperatorChange:this.onChange(oe,"operator"),onValueChange:this.onChange(oe,"value"),allFilters:this.getAllFilters()})},`filter-${oe}`)}}const zl={addFilter:$l.U2,removeFilter:$l.VT,changeFilter:$l.$u},Su=(0,Ol.connect)(null,zl);class Ou extends c.PureComponent{constructor(){super(...arguments),this.addFilter=ee=>{this.props.addFilter((0,ea.jX)(this.props.variable),ee)},this.removeFilter=ee=>{this.props.removeFilter((0,ea.jX)(this.props.variable),ee)},this.changeFilter=(ee,oe)=>{this.props.changeFilter((0,ea.jX)(this.props.variable),{index:ee,filter:oe})}}render(){const{filters:ee,datasource:oe,baseFilters:De}=this.props.variable;return(0,z.jsx)(Sc,{datasource:oe,filters:ee,baseFilters:De,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const ld=Su(Ou);ld.displayName="AdHocPicker";var Oc=e(25206);const Iu=re=>re.map(ee=>Lu(ee).map(Au).join("|")),Ru=re=>{if((0,Y.isArray)(re))return re.map(cd).filter(oc);const ee=cd(re);return ee===null?[]:[ee]};function Au(re){return re==null?"":/\|/g[Symbol.replace](re,"__gfp__")}function ju(re){return re==null?"":/__gfp__/g[Symbol.replace](re,"|")}function Lu(re){return[re.key,re.operator,re.value]}function cd(re){if(!(0,Y.isString)(re)||re.length===0)return null;const ee=re.split("|").map(ju);return{key:ee[0],operator:ee[1],value:ee[2]}}function oc(re){return re!==null&&(0,Y.isString)(re.value)}const dd=async()=>{},Bu=()=>({id:"adhoc",description:(0,u.t)("variables.create-ad-hoc-variable-adapter.description.add-keyvalue-filters-on-the-fly","Add key/value filters on the fly."),name:"Ad hoc filters",initialState:Oc.MK,reducer:Oc.AA,picker:ld,editor:Eu,dependsOn:()=>!1,setValue:dd,setValueFromUrl:async(re,ee)=>{const oe=Ru(ee);await(0,rr.JD)((0,$l.D4)((0,ea.jX)(re),oe))},updateOptions:dd,getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,rootStateKey:$e,...Ye}=(0,Y.cloneDeep)(re);return Ye},getValueForUrl:re=>{const ee=re?.filters??[];return Iu(ee)}});var Uu=e(14644),Wu=e(8135),Fr=e(8921),Lr=e(67933),ud=e(13288),Nu=e(44240),ic=e(16126),Ku=e(38975),hd=e(67791),Fu=e(66847),wu=e(69850),Vu=e(24726),ur=e(39167),Fs=e(74887),Il=e(65307),fl=e(7389),Gl=e(96120),Rl=e(88813);const $u={...Rl.Vg,type:"query",datasource:null,query:"",regex:"",sort:fl.ZG.disabled,refresh:fl.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},zu=(re,ee)=>{if(ee===fl.ZG.disabled)return re;const oe=Math.ceil(ee/2),De=ee%2===0;return oe===1?re=(0,Y.sortBy)(re,"text"):oe===2?re=(0,Y.sortBy)(re,je=>{if(!je.text)return-1;const $e=je.text.match(/.*?(\d+).*/);return!$e||$e.length<2?-1:parseInt($e[1],10)}):oe===3?re=(0,Y.sortBy)(re,je=>(0,Y.toLower)(je.text)):oe===4&&re.sort((je,$e)=>je.text?$e.text?je.text.localeCompare($e.text,void 0,{numeric:!0}):1:-1),De&&(re=re.reverse()),re},Gu=(re,ee)=>{const oe=[];let De=null;ee.lastIndex=0;do De=ee.exec(re),De&&oe.push(De);while(ee.global&&De&&De[0]!==""&&De[0]!==void 0);return oe},Hu=(re,ee,oe)=>{let De,je=[];re&&(De=(0,rs.dO)(re));for(let $e=0;$e<oe.length;$e++){const Ye=oe[$e];let st=Ye.text===void 0||Ye.text===null?Ye.value:Ye.text,rt=Ye.value===void 0||Ye.value===null?Ye.text:Ye.value;if((0,Y.isNumber)(rt)&&(rt=rt.toString()),(0,Y.isNumber)(st)&&(st=st.toString()),De){const yt=Gu(rt,De);if(!yt.length)continue;const Ot=yt.find(Gt=>Gt.groups&&Gt.groups.value),Bt=yt.find(Gt=>Gt.groups&&Gt.groups.text),kt=yt.find(Gt=>Gt.length>1),$t=yt.length>1&&kt;if(Ot||Bt)rt=Ot?.groups?.value??Bt?.groups?.text,st=Bt?.groups?.text??Ot?.groups?.value;else if($t){for(let Gt=0;Gt<yt.length;Gt++){const en=yt[Gt];je.push({text:en[1],value:en[1],selected:!1})}continue}else kt&&(st=kt[1],rt=kt[1])}je.push({text:st,value:rt,selected:!1})}return je=(0,Y.uniqBy)(je,"value"),zu(je,ee)},fd=(0,Il.Z0)({name:"templating/query",initialState:Gl.j,reducers:{updateVariableOptions:(re,ee)=>{const{results:oe,templatedRegex:De}=ee.payload.data,je=(0,ms.Fs)(re,ee.payload.id);if(je.type!=="query")return;const{includeAll:$e,sort:Ye}=je,st=Hu(De,Ye,oe);$e&&st.unshift({text:Fr.Zm,value:Fr.To,selected:!1}),st.length||st.push({text:Fr.ou,value:Fr.Ek,isNone:!0,selected:!1}),je.options=st}}}),Qu=fd.reducer,{updateVariableOptions:_u}=fd.actions;function pd(){return re=>re.pipe((0,La.T)(gd))}function gd(re){const ee=re.series;if(!ee||!ee.length)return[];if(Ic(ee))return ee;const oe=(0,Qr.Bt)(ee),De=[];let je=-1,$e=-1,Ye=-1,st=-1;for(const rt of oe)for(let yt=0;yt<rt.fields.length;yt++){const Ot=rt.fields[yt],Bt=(0,te.Ct)(Ot,rt,ee).toLowerCase();Ot.type===X.PU.string&&Ye===-1&&(Ye=yt),Bt==="text"&&Ot.type===X.PU.string&&$e===-1&&($e=yt),Bt==="value"&&Ot.type===X.PU.string&&je===-1&&(je=yt),Bt==="expandable"&&(Ot.type===X.PU.boolean||Ot.type===X.PU.number)&&st===-1&&(st=yt)}if(Ye===-1)throw new Error("Couldn't find any field of type string in the results.");for(const rt of oe)for(let yt=0;yt<rt.length;yt++){const Ot=st!==-1?rt.fields[st].values[yt]:void 0,Bt=rt.fields[Ye].values[yt],kt=$e!==-1?rt.fields[$e].values[yt]:null,$t=je!==-1?rt.fields[je].values[yt]:null;if(je===-1&&$e===-1){De.push({text:Bt,value:Bt,expandable:Ot});continue}if(je===-1&&$e!==-1){De.push({text:kt,value:kt,expandable:Ot});continue}if(je!==-1&&$e===-1){De.push({text:$t,value:$t,expandable:Ot});continue}De.push({text:kt,value:$t,expandable:Ot})}return De}function ku(re){return ee=>ee.pipe((0,La.T)(oe=>{const{variable:De,dispatch:je,getTemplatedRegexFunc:$e}=re;if(!De.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const Ye=$e(De),st=(0,ea.qD)(De,{results:oe,templatedRegex:Ye});je((0,Fs.kb)(De.rootStateKey,_u(st)))}))}function md(re){return ee=>ee.pipe((0,Co.Z)(()=>{const{dispatch:oe,variable:De,searchFilter:je}=re;return je?(0,Fa.of)():(0,mo.H)(oe((0,ur.kl)((0,ea.jX)(De))))}))}function Ic(re){if(!re)return!1;if(!re.length)return!0;const ee=re[0];if((0,Qr.ci)(ee))return!1;for(const oe in ee){if(!ee.hasOwnProperty(oe)||ee[oe]!==null&&typeof ee[oe]!="string"&&typeof ee[oe]!="number")continue;const De=oe.toLowerCase();if(De==="text"||De==="value")return!0}return!1}var lc=e(48592),Yu=e(22592);class Ju{constructor(){this.runners=[new Zu,new Xu,new qu,new eh]}getRunnerForDatasource(ee){const oe=this.runners.find(De=>De.canRun(ee));if(oe)return oe;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(ee){return this.runners.some(oe=>oe.canRun(ee))}}class Zu{constructor(){this.type=lc.Qz.Legacy}canRun(ee){return(0,Lr.d5)(ee)}getTarget({datasource:ee,variable:oe}){if((0,Lr.d5)(ee))return oe.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ee,variable:oe,searchFilter:De,timeSrv:je},$e){if(!(0,Lr.d5)(ee))return Hl();const Ye=(0,ea.iP)(oe,De,je,$e.scopedVars);return(0,mo.H)(ee.metricFindQuery(oe.query,Ye)).pipe((0,Co.Z)(st=>{if(!st||!st.length)return Hl();const rt=st;return(0,Fa.of)({series:rt,state:tr.Gu.Done,timeRange:Ye.range})}))}}class Xu{constructor(){this.type=lc.Qz.Standard}canRun(ee){return(0,Lr.Hf)(ee)}getTarget({datasource:ee,variable:oe}){if((0,Lr.Hf)(ee))return ee.variables.toDataQuery(oe.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ee,runRequest:oe},De){return(0,Lr.Hf)(ee)?ee.variables.query?oe(ee,De,ee.variables.query.bind(ee.variables)):oe(ee,De):Hl()}}class qu{constructor(){this.type=lc.Qz.Custom}canRun(ee){return(0,Lr.zs)(ee)}getTarget({datasource:ee,variable:oe}){if((0,Lr.zs)(ee))return oe.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ee,runRequest:oe},De){return(0,Lr.zs)(ee)?oe(ee,De,ee.variables.query.bind(ee.variables)):Hl()}}const vd="variable-query";class eh{constructor(){this.type=lc.Qz.Datasource}canRun(ee){return(0,Lr.X3)(ee)}getTarget({datasource:ee,variable:oe}){if((0,Lr.X3)(ee))return{...oe.query,refId:oe.query.refId??vd};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ee,runRequest:oe},De){return(0,Lr.X3)(ee)?oe(ee,De):Hl()}}function Hl(){return(0,Fa.of)({state:tr.Gu.Done,series:[],timeRange:(0,Yu.E2)()})}class th{constructor(ee={dispatch:rr.JD,getState:rr.Gu,getVariable:ms.dn,getTemplatedRegex:ea.u7,getTimeSrv:Nn.jG,queryRunners:new Ju,runRequest:Dc.BN}){this.dependencies=ee,this.updateOptionsRequests=new Fl.B,this.updateOptionsResults=new Fl.B,this.cancelRequests=new Fl.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(ee){this.updateOptionsRequests.next(ee)}getResponse(ee){return this.updateOptionsResults.asObservable().pipe((0,ic.p)(oe=>oe.identifier===ee))}cancelRequest(ee){this.cancelRequests.next({identifier:ee})}destroy(){this.subscription.unsubscribe()}onNewRequest(ee){const{datasource:oe,identifier:De,searchFilter:je}=ee;try{const{dispatch:$e,runRequest:Ye,getTemplatedRegex:st,getVariable:rt,queryRunners:yt,getTimeSrv:Ot,getState:Bt}=this.dependencies,kt=(0,ms.y7)(Bt());this.updateOptionsResults.next({identifier:De,state:tr.Gu.Loading});const $t=rt(De,Bt());if($t.type!=="query")return;const Gt=Ot(),en={variable:$t,datasource:oe,searchFilter:je,timeSrv:Gt,runRequest:Ye};if(!yt.isQueryRunnerAvailableForDatasource(oe)){const xa=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:De,state:tr.Gu.Error,error:xa});return}const xn=yt.getRunnerForDatasource(oe),ma=xn.getTarget({datasource:oe,variable:$t}),Da=this.getRequest($t,ee,ma);xn.runRequest(en,Da).pipe((0,ic.p)(()=>{const xa=(0,ms.y7)(Bt());return kt===xa}),(0,ic.p)(xa=>xa.state===tr.Gu.Done||xa.state===tr.Gu.Error),(0,Ku.s)(1),(0,Co.Z)(xa=>xa.state===tr.Gu.Error?(0,ud.$)(()=>xa.error):(0,Fa.of)(xa)),pd(),ku({variable:$t,dispatch:$e,getTemplatedRegexFunc:st}),md({variable:$t,dispatch:$e,searchFilter:je}),(0,hd.Q)((0,Nu.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,ic.p)(xa=>{let $n=!1;return xa.identifier.id===De.id&&($n=!0,this.updateOptionsResults.next({identifier:De,state:tr.Gu.Loading,cancelled:$n})),$n}))),(0,Fu.W)(xa=>xa.cancelled?(0,Fa.of)({}):(this.updateOptionsResults.next({identifier:De,state:tr.Gu.Error,error:xa}),(0,ud.$)(()=>xa))),(0,wu.j)(()=>{this.updateOptionsResults.next({identifier:De,state:tr.Gu.Done})})).subscribe()}catch($e){this.updateOptionsResults.next({identifier:De,state:tr.Gu.Error,error:$e})}}getRequest(ee,oe,De){const{searchFilter:je}=oe,$e={variable:{text:ee.current.text,value:ee.current.value}},rt={...je?{searchFilter:{text:je,value:je}}:{},...$e},yt=this.dependencies.getTimeSrv().timeRange();return{app:wl.Jk.Dashboard,requestId:(0,Vu.A)(),timezone:"",range:yt,interval:"",intervalMs:0,targets:[De],scopedVars:rt,startTime:Date.now()}}}let Rc;function yd(re){Rc=re}function Ac(){return Rc}const nh=re=>{if(!ah(re))return re.name;const{current:ee}=re;return Array.isArray(ee.text)?ee.text.join(" + "):ee.text},ah=re=>Array.isArray(re?.options)||typeof re?.current=="object";var Oi=(re=>(re[re.moveUp=38]="moveUp",re[re.moveDown=40]="moveDown",re[re.select=32]="select",re[re.cancel=27]="cancel",re[re.selectAndClose=13]="selectAndClose",re))(Oi||{});class xd extends c.PureComponent{constructor(){super(...arguments),this.onKeyDown=ee=>{if(Oi[ee.keyCode]&&ee.keyCode!==Oi.select){const oe=ee.ctrlKey||ee.metaKey||ee.shiftKey;this.props.onNavigate(ee.keyCode,oe),ee.preventDefault()}},this.onChange=ee=>{this.props.onChange(ee.target.value)}}render(){const{value:ee,id:oe,onNavigate:De,...je}=this.props;return(0,z.jsx)("input",{...je,ref:$e=>{$e&&($e.focus(),$e.setAttribute("style",`width:${Math.max($e.width,150)}px`))},id:oe,type:"text",className:"gf-form-input",value:ee??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,u.t)("variable.dropdown.placeholder","Enter variable value")})}}var Ed=e(39884),Pd=e(11297);const bd=({loading:re,disabled:ee,onClick:oe,text:De,onCancel:je,id:$e})=>{const Ye=(0,Ut.of)(sh),st=(0,c.useCallback)(rt=>{rt.stopPropagation(),rt.preventDefault(),oe()},[oe]);return re?(0,z.jsxs)("div",{className:Ye.container,"data-testid":Xa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${De}`),title:De,id:$e,children:[(0,z.jsx)(jc,{text:De}),(0,z.jsx)(Ed.I,{loading:!0,onCancel:je})]}):(0,z.jsxs)("button",{onClick:st,className:Ye.container,"data-testid":Xa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${De}`),"aria-expanded":!1,"aria-controls":`options-${$e}`,id:$e,title:De,disabled:ee,children:[(0,z.jsx)(jc,{text:De}),(0,z.jsx)(Os.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},jc=({text:re})=>{const ee=(0,Ut.of)(sh);return(0,z.jsx)("span",{className:ee.textAndTags,children:re===Fr.Zm?(0,u.t)("variable.picker.link-all","All"):re})},sh=re=>{const ee=(0,Pd.$)(re);return{container:(0,Mt.css)({maxWidth:"500px",paddingRight:"10px",padding:re.spacing(0,1),backgroundColor:re.components.input.background,border:`1px solid ${re.components.input.borderColor}`,borderRadius:re.shape.radius.default,display:"flex",alignItems:"center",color:re.colors.text.primary,height:re.spacing(re.components.height.md),[`.${ee.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:re.colors.action.disabledBackground,color:re.colors.action.disabledText,border:`1px solid ${re.colors.action.disabledBackground}`}}),textAndTags:(0,Mt.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:re.spacing(.25),userSelect:"none"})}};var rh=e(45967),oh=e(65240),ih=e(45893),lh=e(70427);class ch extends c.PureComponent{constructor(){super(...arguments),this.onToggle=ee=>oe=>{const De=oe.shiftKey||oe.ctrlKey||oe.metaKey;this.handleEvent(oe),this.props.onToggle(ee,De)},this.onToggleAll=ee=>{this.handleEvent(ee),this.props.onToggleAll()}}handleEvent(ee){ee.preventDefault(),ee.stopPropagation()}render(){const{multi:ee,values:oe,highlightIndex:De,selectedValues:je,onToggle:$e,onToggleAll:Ye,theme:st,...rt}=this.props,yt=Ql(st);return(0,z.jsx)("div",{className:yt.variableValueDropdown,children:(0,z.jsx)("div",{className:yt.variableOptionsWrapper,children:(0,z.jsxs)("ul",{className:yt.variableOptionsColumn,"aria-label":Xa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...rt,children:[this.renderMultiToggle(),oe.map((Ot,Bt)=>this.renderOption(Ot,Bt))]})})})}renderOption(ee,oe){const{highlightIndex:De,multi:je,theme:$e}=this.props,Ye=Ql($e),st=ee.value===Fr.To;return(0,z.jsx)("li",{children:(0,z.jsxs)("button",{"data-testid":Xa.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":ee.selected,className:(0,Mt.cx)((0,me.my)($e),Ye.variableOption,{[Ye.highlighted]:oe===De,[Ye.variableAllOption]:st},Ye.noStyledButton),onClick:this.onToggle(ee),children:[(0,z.jsx)("span",{className:(0,Mt.cx)(Ye.variableOptionIcon,{[Ye.variableOptionIconSelected]:ee.selected,[Ye.hideVariableOptionIcon]:!je})}),(0,z.jsx)("span",{"data-testid":Xa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${ee.text}`),children:st?(0,u.t)("variable.picker.option-all","All"):ee.text})]})},`${ee.value}`)}renderMultiToggle(){const{multi:ee,selectedValues:oe,theme:De,values:je}=this.props,$e=Ql(De),Ye=je.some(rt=>rt.value===Fr.To);if(!ee)return null;const st=()=>(0,z.jsx)(u.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,z.jsx)(rh.m,{content:st,placement:"top",children:(0,z.jsxs)("button",{className:(0,Mt.cx)((0,me.my)(De),$e.variableOption,$e.variableOptionColumnHeader,$e.noStyledButton,{[$e.noPaddingBotton]:Ye}),role:"checkbox","aria-checked":oe.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":(0,u.t)("variables.variable-options.aria-label-toggle-all-values","Toggle all values"),"data-placement":"top",children:[(0,z.jsx)("span",{className:(0,Mt.cx)($e.variableOptionIcon,{[$e.variableOptionIconManySelected]:oe.length>1})}),(0,z.jsxs)(u.x6,{i18nKey:"variable.picker.option-selected-values",values:{numSelected:oe.length},children:["Selected (","{{numSelected}}",")"]})]})})}}const Ql=(0,oh.N)(re=>{const ee=re.isDark?ih:lh;return{hideVariableOptionIcon:(0,Mt.css)({display:"none"}),highlighted:(0,Mt.css)({backgroundColor:re.colors.action.hover}),noStyledButton:(0,Mt.css)({width:"100%",textAlign:"left"}),variableOption:(0,Mt.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:re.colors.action.hover}}),variableOptionColumnHeader:(0,Mt.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Mt.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${ee}) left top no-repeat`}),variableOptionIconManySelected:(0,Mt.css)({background:`url(${ee}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Mt.css)({background:`url(${ee}) 0px -18px no-repeat`}),variableValueDropdown:(0,Mt.css)({backgroundColor:re.colors.background.primary,border:`1px solid ${re.colors.border.weak}`,borderRadius:re.shape.borderRadius(2),boxShadow:re.shadows.z2,position:"absolute",top:re.spacing(re.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:re.zIndex.typeahead}),variableOptionsColumn:(0,Mt.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Mt.css)({display:"table",width:"100%"}),variableAllOption:(0,Mt.css)({borderBottom:`1px solid ${re.colors.border.weak}`,paddingBottom:re.spacing(1)}),noPaddingBotton:(0,Mt.css)({paddingBottom:0})}}),Gi=(0,Ut.cV)(ch);var dh=e(94452),Dd=e(3594),Hi=e(88681),Ho=e(99598);const cc=(re,ee,oe)=>async(De,je)=>{if(ee===Oi.cancel)return await De(_l(re));if(ee===Oi.select)return De(Lc(re,oe));if(ee===Oi.selectAndClose)return(0,ms.nx)(re,je()).optionsPicker.multi?De(Lc(re,oe)):(De(Lc(re,oe,!0)),De(_l(re)));if(ee===Oi.moveDown)return De((0,Fs.kb)(re,(0,Ho.O$)(1)));if(ee===Oi.moveUp)return De((0,Fs.kb)(re,(0,Ho.O$)(-1)))},Cd=(re,ee="")=>async(oe,De)=>{const{rootStateKey:je}=re,{id:$e,queryValue:Ye}=(0,ms.nx)(je,De()).optionsPicker,st={id:$e,rootStateKey:je,type:"query"},rt=(0,ms.dn)(st,De());if(!("options"in rt)||(oe((0,Fs.kb)(je,(0,Ho.S8)(ee))),(0,Y.trim)(Ye)===(0,Y.trim)(ee)))return;const{query:yt,options:Ot}=rt,Bt=typeof yt=="string"?yt:yt.target;return(0,dh.E)(Bt)?Md(oe,De,ee,je):oe((0,Fs.kb)(je,(0,Ho.fx)(Ot)))},uh=async re=>{if((0,Dd.R)(re.current))return;await Vl.B.get(re.type).setValue(re,re.current,!0)},_l=(re,ee)=>async(oe,De)=>{const je=(0,ms.nx)(re,De()).optionsPicker,$e={id:je.id,rootStateKey:re,type:"query"},Ye=(0,ms.dn)($e,De());if(!(0,Lr.SP)(Ye))return;const st={option:Sd(je)},rt={propName:"queryValue",propValue:je.queryValue};oe((0,Fs.kb)(re,(0,Hi.dE)((0,ea.qD)(Ye,st)))),oe((0,Fs.kb)(re,(0,Hi.QP)((0,ea.qD)(Ye,rt))));const yt=(0,ms.dn)($e,De());if((0,Lr.SP)(yt)&&(oe((0,Fs.kb)(re,(0,Ho.Fu)())),(0,ea.Lz)(Ye)!==(0,ea.Lz)(yt)))return ee?ee(yt):await uh(yt)},Td=(re,ee)=>async(oe,De)=>{const{id:je,rootStateKey:$e}=re,Ye=(0,ms.nx)($e,De()).optionsPicker;Ye.id&&Ye.id!==je&&await oe(_l($e,ee));const st=(0,ms.dn)(re,De());(0,Lr.SP)(st)&&oe((0,Fs.kb)($e,(0,Ho.MO)(st)))},Lc=(re,ee,oe=!1)=>(De,je)=>{const{highlightIndex:$e,options:Ye}=(0,ms.nx)(re,je()).optionsPicker,st=Ye[$e];De((0,Fs.kb)(re,(0,Ho.U9)({option:st,forceSelect:oe,clearOthers:ee})))},hh=async(re,ee,oe,De)=>{try{const{id:je}=(0,ms.nx)(De,ee()).optionsPicker,$e={id:je,rootStateKey:De,type:"query"},Ye=(0,ms.dn)($e,ee());if(!(0,Lr.SP)(Ye))return;await Vl.B.get(Ye.type).updateOptions(Ye,oe);const rt=(0,ms.dn)($e,ee());if(!(0,Lr.SP)(rt))return;re((0,Fs.kb)(De,(0,Ho.qh)(rt.options)))}catch(je){console.error(je)}},Md=(0,Y.debounce)(hh,500);function Sd(re){const{options:ee,selectedValues:oe,queryValue:De,multi:je}=re;if(ee.length===0&&De&&De.length>0)return{text:De,value:De,selected:!1};if(!je)return oe.find(st=>st.selected);const $e=[],Ye=[];for(const st of oe)st.selected&&($e.push(st.text.toString()),Ye.push(st.value.toString()));return{value:Ye,text:$e,selected:!0}}const kl=()=>{const re=$e=>({...(0,Uu.bindActionCreators)({openOptions:Td,commitChangesToVariable:_l,navigateOptions:cc},$e),filterOrSearchOptions:(Ye,st="")=>{$e(Cd(Ye,st))},toggleAllOptions:Ye=>$e((0,Fs.kb)(Ye.rootStateKey,(0,Ho.an)())),toggleOption:(Ye,st,rt,yt)=>$e((0,Fs.kb)(Ye.rootStateKey,(0,Ho.U9)({option:st,clearOthers:rt,forceSelect:yt})))}),ee=($e,Ye)=>{const{rootStateKey:st}=Ye.variable;return st?{picker:(0,ms.nx)(st,$e).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:Ho.$z})},oe=(0,Ol.connect)(ee,re);class De extends c.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,ea.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(Ye,st)=>{((0,Lr.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(Ye,st)},this.onToggleSingleValueVariable=(Ye,st)=>{this.props.toggleOption((0,ea.jX)(this.props.variable),Ye,st,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(Ye,st)=>{this.props.toggleOption((0,ea.jX)(this.props.variable),Ye,st,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,ea.jX)(this.props.variable))},this.onFilterOrSearchOptions=Ye=>{this.props.filterOrSearchOptions((0,ea.jX)(this.props.variable),Ye)},this.onNavigate=(Ye,st)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,Ye,st)},this.onCancel=()=>{Ac().cancelRequest((0,ea.jX)(this.props.variable))}}render(){const{variable:Ye,picker:st}=this.props,rt=st.id===Ye.id,yt=fh();return(0,z.jsx)("div",{className:yt.variableLinkWrapper,"data-testid":Xa.Tp.components.Variables.variableLinkWrapper,children:rt?this.renderOptions(st):this.renderLink(Ye)})}renderLink(Ye){const st=nh(Ye),rt=Ye.state===tr.Gu.Loading;return(0,z.jsx)(bd,{id:Fr.qz+Ye.id,text:st,onClick:this.onShowOptions,loading:rt,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(Ye){const{id:st}=this.props.variable;return(0,z.jsxs)(Wu.N,{onClick:this.onHideOptions,children:[(0,z.jsx)(xd,{id:Fr.qz+st,value:Ye.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${st}`}),(0,z.jsx)(Gi,{values:Ye.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:Ye.highlightIndex,multi:Ye.multi,selectedValues:Ye.selectedValues,id:`options-${st}`})]})}}const je=oe(De);return je.displayName="OptionsPicker",je},fh=()=>({variableLinkWrapper:(0,Mt.css)({display:"inline-block",position:"relative"})});var Bc=e(23675);class ph extends c.PureComponent{constructor(){super(...arguments),this.onChange=ee=>{this.props.onPropChange({propName:"query",propValue:ee.currentTarget.value,updateOptions:!0})}}render(){return(0,z.jsx)(Bc.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const gh={...Rl.Vg,type:"constant",hide:fl.zL.hideVariable,query:"",current:{},options:[]},Od=(0,Il.Z0)({name:"templating/constant",initialState:Gl.j,reducers:{createConstantOptionsFromQuery:(re,ee)=>{const oe=(0,ms.Fs)(re,ee.payload.id);oe.type==="constant"&&(oe.options=[{text:oe.query.trim(),value:oe.query.trim(),selected:!1}])}}}),Id=Od.reducer,{createConstantOptionsFromQuery:mh}=Od.actions,vh=re=>async ee=>{const{rootStateKey:oe}=re;await ee((0,Fs.kb)(oe,mh((0,ea.qD)(re)))),await ee((0,ur.kl)(re))},Rd=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:gh,reducer:Id,picker:kl(),editor:ph,dependsOn:()=>!1,setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)((0,ur.x7)((0,ea.jX)(re),ee))},updateOptions:async re=>{await(0,rr.JD)(vh((0,ea.jX)(re)))},getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,current:$e,options:Ye,rootStateKey:st,...rt}=(0,Y.cloneDeep)(re);return rt},getValueForUrl:re=>re.current.value,beforeAdding:re=>{const{current:ee,options:oe,query:De,...je}=(0,Y.cloneDeep)(re),$e={selected:!0,text:De,value:De};return{...je,current:$e,options:[$e],query:De}}});function yh(re,...ee){const oe=(0,Ol.connect)(...ee)(re);return De=>(0,z.jsx)(oe,{...De,store:rr.M_})}function ff(re,...ee){const oe=connect(...ee)(re);return De=>jsx(Provider,{store,children:jsx(oe,{...De,store})})}var Ad=e(70430);class Uc extends c.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:ee,propValue:oe})=>{this.props.onPropChange({propName:ee,propValue:oe,updateOptions:!0})},this.onQueryChange=ee=>{this.props.onPropChange({propName:"query",propValue:ee.currentTarget.value,updateOptions:!0})}}render(){return(0,z.jsx)(Ad.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:ee=>this.onSelectionOptionsChange({propName:"multi",propValue:ee.currentTarget.checked}),onIncludeAllChange:ee=>this.onSelectionOptionsChange({propName:"includeAll",propValue:ee.currentTarget.checked}),onAllValueChange:ee=>this.onSelectionOptionsChange({propName:"allValue",propValue:ee.currentTarget.value})})}}const xh=(re,ee)=>({}),Eh={changeVariableMultiValue:ur.TI},jd=yh(Uc,xh,Eh),Ph={...Rl.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Ld=(0,Il.Z0)({name:"templating/custom",initialState:Gl.j,reducers:{createCustomOptionsFromQuery:(re,ee)=>{const oe=(0,ms.Fs)(re,ee.payload.id);if(oe.type!=="custom")return;const{includeAll:De}=oe,Ye=(ee.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(st=>{st=st.replace(/\\,/g,",");const rt=/^(.+)\s:\s(.+)$/g.exec(st)??[];if(rt.length===3){const[,yt,Ot]=rt;return{text:yt.trim(),value:Ot.trim(),selected:!1}}else return{text:st.trim(),value:st.trim(),selected:!1}});De&&Ye.unshift({text:Fr.Zm,value:Fr.To,selected:!1}),oe.options=Ye}}}),bh=Ld.reducer,{createCustomOptionsFromQuery:Dh}=Ld.actions,Bd=re=>async(ee,oe)=>{const{rootStateKey:De}=re,je=(0,ms.dn)(re,oe());if(je.type!=="custom")return;const $e=(0,dt.w)().replace(je.query);await ee((0,Fs.kb)(De,Dh((0,ea.qD)(re,$e)))),await ee((0,ur.kl)(re))},Ch=()=>({id:"custom",description:(0,u.t)("variables.create-custom-variable-adapter.description.define-variable-values-manually","Define variable values manually"),name:"Custom",initialState:Ph,reducer:bh,picker:kl(),editor:jd,dependsOn:(re,ee)=>(0,ea.wJ)(re.query,ee.name),setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)((0,ur.x7)((0,ea.jX)(re),ee))},updateOptions:async re=>{await(0,rr.JD)(Bd((0,ea.jX)(re)))},getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,rootStateKey:$e,...Ye}=(0,Y.cloneDeep)(re);return Ye},getValueForUrl:re=>(0,ea.ML)(re)?Fr.Zm:re.current.value});var dc=e(42272),oi=e(8134);const uc={...Rl.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:fl.CO.onDashboardLoad},hc=(0,Il.Z0)({name:"templating/datasource",initialState:Gl.j,reducers:{createDataSourceOptions:(re,ee)=>{const{sources:oe,regex:De}=ee.payload.data,je=[],$e=(0,ms.Fs)(re,ee.payload.id);if($e.type==="datasource"){for(let Ye=0;Ye<oe.length;Ye++){const st=oe[Ye];(0,oi._)($e.query,st.meta)&&(Th(st,De)&&je.push({text:st.name,value:st.uid,selected:!1}),Wc(st,De)&&je.push({text:(0,u.t)("variables.data-source-variable-slice.text.default","default"),value:"default",selected:!1}))}je.length===0&&je.push({text:(0,u.t)("variables.data-source-variable-slice.text.no-data-sources-found","No data sources found"),value:"",selected:!1}),$e.includeAll&&je.unshift({text:Fr.Zm,value:Fr.To,selected:!1}),$e.options=je}}}});function Th(re,ee){return ee?ee.exec(re.name):!0}function Wc(re,ee){return re.isDefault?ee?ee.exec("default"):!0:!1}const Yl=hc.reducer,{createDataSourceOptions:Mh}=hc.actions,Sh=(re,ee={getDatasourceSrv:dl.tR})=>async(oe,De)=>{const{rootStateKey:je}=re,$e=ee.getDatasourceSrv().getList({metrics:!0,variables:!1}),Ye=(0,ms.dn)(re,De());if(Ye.type!=="datasource")return;let st;Ye.regex&&(st=(0,dt.w)().replace(Ye.regex,void 0,"regex"),st=(0,rs.dO)(st)),oe((0,Fs.kb)(je,Mh((0,ea.qD)(re,{sources:$e,regex:st})))),await oe((0,ur.kl)(re))},Ud=(re,ee={getDatasourceSrv:dl.tR})=>oe=>{const De=ee.getDatasourceSrv().getList({metrics:!0,variables:!0}),je=(0,Y.chain)(De).uniqBy("meta.id").map($e=>({text:$e.meta.name,value:$e.meta.id})).value();je.unshift({text:"",value:""}),oe((0,Fs.kb)(re,(0,Mi.BC)({dataSourceTypes:je})))},Oh=(re,ee)=>{const{variable:{rootStateKey:oe}}=ee;if(!oe)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:td(Mi.nS)};const{editor:De}=(0,ms.nx)(oe,re);return{extended:td(De)}},Ih={initDataSourceVariableEditor:Ud,changeVariableMultiValue:ur.TI},Rh=(0,Ol.connect)(Oh,Ih);class Ah extends c.PureComponent{constructor(){super(...arguments),this.onRegExBlur=ee=>{this.props.onPropChange({propName:"regex",propValue:ee.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:ee,propName:oe})=>{this.props.onPropChange({propName:oe,propValue:ee,updateOptions:!0})},this.onMultiChanged=ee=>{this.props.changeVariableMultiValue((0,ea.jX)(this.props.variable),ee.currentTarget.checked)},this.onIncludeAllChanged=ee=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:ee.currentTarget.checked})},this.onAllValueChanged=ee=>{this.onSelectionOptionsChange({propName:"allValue",propValue:ee.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:ee}=this.props;if(!ee?.dataSourceTypes.length)return"";const oe=ee.dataSourceTypes.find(je=>je.value===this.props.variable.query);return(oe?oe.value:ee.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=ee=>{this.props.onPropChange({propName:"query",propValue:ee.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:ee}=this.props.variable;if(!ee){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(ee)}render(){const{variable:ee,extended:oe}=this.props,De=oe?.dataSourceTypes?.length?oe.dataSourceTypes?.map(je=>({value:je.value??"",label:je.text})):[];return(0,z.jsx)(dc.y,{query:ee.query,regex:ee.regex,multi:ee.multi,includeAll:ee.includeAll,optionTypes:De,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const Wd=Rh(Ah),jh=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:uc,reducer:Yl,picker:kl(),editor:Wd,dependsOn:(re,ee)=>re.regex?(0,ea.wJ)(re.regex,ee.name):!1,setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)((0,ur.x7)((0,ea.jX)(re),ee))},updateOptions:async re=>{await(0,rr.JD)(Sh((0,ea.jX)(re)))},getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,rootStateKey:$e,...Ye}=(0,Y.cloneDeep)(re);return{...Ye,options:[]}},getValueForUrl:re=>(0,ea.ML)(re)?Fr.Zm:re.current.value});var Lh=e(66223),fc=e(1096);const Nd=(0,c.memo)(({onPropChange:re,variable:ee})=>{const oe=Ye=>{re({propName:"auto",propValue:Ye.target.checked,updateOptions:!0})},De=Ye=>{re({propName:"query",propValue:Ye.currentTarget.value,updateOptions:!0})},je=Ye=>{re({propName:"auto_count",propValue:Ye.value,updateOptions:!0})},$e=Ye=>{re({propName:"auto_min",propValue:Ye.currentTarget.value,updateOptions:!0})};return(0,z.jsx)(fc.s,{intervals:ee.query,autoStepCount:ee.auto_count,autoEnabled:ee.auto,onAutoCountChanged:je,onIntervalsChange:De,onAutoEnabledChange:oe,onAutoMinIntervalChanged:$e,autoMinInterval:ee.auto_min})});Nd.displayName="IntervalVariableEditor";var Bh=e(59373),Nc=e(98732);const Uh=re=>async ee=>{const{rootStateKey:oe}=re;await ee((0,Fs.kb)(oe,(0,Nc.mn)((0,ea.qD)(re)))),await ee(pl(re)),await ee((0,ur.kl)(re))},pl=(re,ee={calculateInterval:Jc.calculateInterval,getTimeSrv:Nn.jG,templateSrv:(0,Bh.w)()})=>(oe,De)=>{const je=(0,ms.dn)(re,De());if(je.type==="interval"&&je.auto){const $e=ee.calculateInterval(ee.getTimeSrv().timeRange(),je.auto_count,je.auto_min);ee.templateSrv.setGrafanaVariable("$__auto_interval_"+je.name,$e.interval),ee.templateSrv.setGrafanaVariable("$__auto_interval",$e.interval)}},Kc=()=>({id:"interval",description:(0,u.t)("variables.create-interval-variable-adapter.description.define-timespan-interval","Define a timespan interval (for example: {{timeIntervals}})",{timeIntervals:"1m, 1h, 1d"}),name:"Interval",initialState:Nc.Ez,reducer:Nc.E5,picker:kl(),editor:Nd,dependsOn:()=>!1,setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)(pl((0,ea.jX)(re))),await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)(pl((0,ea.jX)(re))),await(0,rr.JD)((0,ur.x7)((0,ea.jX)(re),ee))},updateOptions:async re=>{await(0,rr.JD)(Uh((0,ea.jX)(re)))},getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,rootStateKey:$e,...Ye}=(0,Y.cloneDeep)(re);return Ye},getValueForUrl:re=>re.current.value});var Wh=e(28799),Nh=e(64423),Kh=e(38681);function Fh(re,ee,oe){return{next:je=>{if(je.state===tr.Gu.Error){oe.unsubscribe(),ee(je.error);return}if(je.state===tr.Gu.Done){oe.unsubscribe(),re();return}},error:je=>{oe.unsubscribe(),ee(je)},complete:()=>{oe.unsubscribe(),re()}}}const wh=(re,ee)=>async(oe,De)=>{try{const{rootStateKey:je}=re;if(!(0,ea.sN)(je,De()))return;const $e=(0,ms.dn)(re,De());if($e.type!=="query")return;(0,ms.nx)(je,De()).editor.id===$e.id&&oe((0,Fs.kb)(je,(0,Mi.Eo)({errorProp:"update"})));const Ye=await(0,B.l)().get($e.datasource??"");await new Promise((st,rt)=>{const yt=new Nh.yU,Ot=Fh(st,rt,yt),Bt=Ac().getResponse(re).subscribe(Ot);yt.add(Bt),Ac().queueRequest({identifier:re,datasource:Ye,searchFilter:ee})})}catch(je){if(je instanceof Error){const $e=(0,xc.u)(je),{rootStateKey:Ye}=re;throw(0,ms.nx)(Ye,De()).editor.id===re.id&&oe((0,Fs.kb)(Ye,(0,Mi.NY)({errorProp:"update",errorText:$e.message??""}))),$e}}},Vh=re=>async(ee,oe)=>{const De=(0,ms.dn)(re,oe());De.type==="query"&&await ee(Kd((0,ea.jX)(De),De.datasource))},Kd=(re,ee)=>async(oe,De)=>{try{const{rootStateKey:je}=re,{editor:$e}=(0,ms.nx)(je,De()),st=Tc($e)?.dataSource,rt=await(0,B.l)().get(ee??"");st&&st.type!==rt?.type&&oe((0,Fs.kb)(je,(0,Hi.QP)((0,ea.qD)(re,{propName:"query",propValue:""}))));const yt=await(0,Kh.y)(rt);oe((0,Fs.kb)(je,(0,Mi.BC)({dataSource:rt,VariableQueryEditor:yt})))}catch(je){console.error(je)}},$h=(re,ee,oe)=>async(De,je)=>{const{rootStateKey:$e}=re,Ye=(0,ms.dn)(re,je());if(Ye.type==="query"){if(zh(Ye.name,ee)){const st="Query cannot contain a reference to itself. Variable: $"+Ye.name;De((0,Fs.kb)($e,(0,Mi.NY)({errorProp:"query",errorText:st})));return}De((0,Fs.kb)($e,(0,Mi.Eo)({errorProp:"query"}))),De((0,Fs.kb)($e,(0,Hi.QP)((0,ea.qD)(re,{propName:"query",propValue:ee})))),oe!==void 0?De((0,Fs.kb)($e,(0,Hi.QP)((0,ea.qD)(re,{propName:"definition",propValue:oe})))):typeof ee=="string"&&De((0,Fs.kb)($e,(0,Hi.QP)((0,ea.qD)(re,{propName:"definition",propValue:ee})))),await De((0,ur.mZ)(re))}};function zh(re,ee){if(typeof ee=="string"&&ee.match(new RegExp("\\$"+re+"(/| |$)")))return!0;const oe=Fd(ee);for(let De in oe)if(oe.hasOwnProperty(De)){const je=oe[De];if(typeof je=="string"&&je.match(new RegExp("\\$"+re+"(/| |$)")))return!0}return!1}function Fd(re){return typeof re!="object"||re===null?{query:re}:Object.keys(re).reduce((De,je)=>{const $e=re[je];if(typeof $e!="object"||$e===null)return De[je]=$e,De;const Ye=Fd($e);for(let st in Ye)Ye.hasOwnProperty(st)&&(De[`${je}_${st}`]=Ye[st]);return De},{})}const Gh=(re,ee)=>{const{rootStateKey:oe}=ee.variable;if(!oe)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Tc(Mi.nS)};const{editor:De}=(0,ms.nx)(oe,re);return{extended:Tc(De)}},Hh={initQueryVariableEditor:Vh,changeQueryVariableDataSource:Kd,changeQueryVariableQuery:$h,changeVariableMultiValue:ur.TI},Fc=(0,Ol.connect)(Gh,Hh);class wd extends c.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=ee=>{this.props.onPropChange({propName:"datasource",propValue:ee.isDefault?null:(0,Cc.p$)(ee)})},this.onLegacyQueryChange=async(ee,oe)=>{this.props.variable.query!==ee&&this.props.changeQueryVariableQuery((0,ea.jX)(this.props.variable),ee,oe)},this.onQueryChange=async ee=>{if(this.props.variable.query!==ee){let oe="";ee&&ee.hasOwnProperty("query")&&typeof ee.query=="string"&&(oe=ee.query),this.props.changeQueryVariableQuery((0,ea.jX)(this.props.variable),ee,oe)}},this.onRegExBlur=async ee=>{const oe=ee.currentTarget.value;this.props.variable.regex!==oe&&this.props.onPropChange({propName:"regex",propValue:oe,updateOptions:!0})},this.onRefreshChange=ee=>{this.props.onPropChange({propName:"refresh",propValue:ee})},this.onSortChange=async ee=>{this.props.onPropChange({propName:"sort",propValue:ee.value,updateOptions:!0})},this.onMultiChange=ee=>{this.props.onPropChange({propName:"multi",propValue:ee.currentTarget.checked})},this.onIncludeAllChange=ee=>{this.props.onPropChange({propName:"includeAll",propValue:ee.currentTarget.checked})},this.onAllValueChange=ee=>{this.props.onPropChange({propName:"allValue",propValue:ee.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,ea.jX)(this.props.variable))}componentDidUpdate(ee){ee.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,ea.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:ee,variable:oe}=this.props;if(!ee||!ee.dataSource)return null;const De=(0,Nn.jG)().timeRange();return(0,z.jsx)(Wh.u,{datasource:oe.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:oe.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:De,regex:oe.regex,onRegExChange:this.onRegExBlur,sort:oe.sort,onSortChange:this.onSortChange,refresh:oe.refresh,onRefreshChange:this.onRefreshChange,isMulti:oe.multi,includeAll:oe.includeAll,allValue:oe.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const Qh=Fc(wd),Vd=()=>({id:"query",description:(0,u.t)("variables.create-query-variable-adapter.description.variable-values-fetched-datasource-query","Variable values are fetched from a datasource query"),name:"Query",initialState:$u,reducer:Qu,picker:kl(),editor:Qh,dependsOn:(re,ee)=>(0,ea.wJ)(re.query,re.datasource?.uid,re.regex,ee.name),setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)((0,ur.x7)((0,ea.jX)(re),ee))},updateOptions:async(re,ee)=>{await(0,rr.JD)(wh((0,ea.jX)(re),ee))},getSaveModel:re=>{const{index:ee,id:oe,state:De,global:je,queryValue:$e,rootStateKey:Ye,...st}=(0,Y.cloneDeep)(re);return re.refresh!==fl.CO.never?{...st,options:[]}:st},getValueForUrl:re=>(0,ea.ML)(re)?Fr.Zm:re.current.value}),_h=()=>({id:"system",description:"",name:"system",initialState:{...Rl.Vg,type:"system",hide:fl.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:tr.Gu.Done},reducer:re=>re,picker:null,editor:null,dependsOn:()=>!1,setValue:async(re,ee,oe=!1)=>{},setValueFromUrl:async(re,ee)=>{},updateOptions:async re=>{},getSaveModel:re=>({}),getValueForUrl:re=>""});var kh=e(32442),Yh=e(49602);function Jh({onPropChange:re,variable:{query:ee}}){const oe=(0,c.useCallback)(($e,Ye)=>{$e.preventDefault(),re({propName:"originalQuery",propValue:$e.currentTarget.value,updateOptions:!1}),re({propName:"query",propValue:$e.currentTarget.value,updateOptions:Ye})},[re]),De=(0,c.useCallback)($e=>oe($e,!1),[oe]),je=(0,c.useCallback)($e=>oe($e,!0),[oe]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(kh.Y,{children:(0,z.jsx)(u.x6,{i18nKey:"variables.text-box-variable-editor.text-options",children:"Text options"})}),(0,z.jsx)(Yh._,{value:ee,name:(0,u.t)("variables.text-box-variable-editor.name-default-value","Default value"),placeholder:(0,u.t)("variables.text-box-variable-editor.placeholder-default-value-if-any","default value, if any"),onChange:De,onBlur:je,width:30,testId:Xa.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}var Zh=e(52763);function Xh({variable:re,onVariableChange:ee,readOnly:oe}){const De=(0,Zh.wA)(),[je,$e]=(0,c.useState)(re.current.value);(0,c.useEffect)(()=>{$e(re.current.value)},[re]);const Ye=(0,c.useCallback)(()=>{if(!re.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(re.current.value!==je){if(De((0,Fs.kb)(re.rootStateKey,(0,Hi.QP)((0,ea.qD)({id:re.id,type:re.type},{propName:"query",propValue:je})))),ee){ee({...re,current:(0,Dd.R)(re.current)?{}:{...re.current,value:je}});return}Vl.B.get(re.type).updateOptions(re)}},[re,je,De,ee]),st=(0,c.useCallback)(Ot=>$e(Ot.target.value),[$e]),rt=Ot=>Ye(),yt=Ot=>{Ot.keyCode===13&&(Ot.preventDefault(),Ye())};return(0,z.jsx)(pn.p,{type:"text",value:je,onChange:st,onBlur:rt,disabled:oe,onKeyDown:yt,placeholder:(0,u.t)("variable.textbox.placeholder","Enter variable value"),id:Fr.qz+re.id})}const qh={...Rl.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},$d=(0,Il.Z0)({name:"templating/textbox",initialState:Gl.j,reducers:{createTextBoxOptions:(re,ee)=>{const oe=(0,ms.Fs)(re,ee.payload.id);if(oe.type!=="textbox")return;const De={text:oe.query.trim(),value:oe.query.trim(),selected:!1};oe.options=[De],oe.current=De}}}),zd=$d.reducer,{createTextBoxOptions:Jl}=$d.actions,ef=re=>async(ee,oe)=>{const{rootStateKey:De,type:je}=re;ee((0,Fs.kb)(De,Jl((0,ea.qD)(re))));const $e=(0,ms.dn)(re,oe());$e.type==="textbox"&&await Vl.B.get(je).setValue($e,$e.options[0],!0)},tf=(re,ee)=>async(oe,De)=>{const{rootStateKey:je}=re,$e=(0,ms.dn)(re,De());if($e.type!=="textbox")return;const Ye=(0,ea.QT)(ee);oe((0,Fs.kb)(je,(0,Hi.QP)((0,ea.qD)($e,{propName:"query",propValue:Ye})))),await oe((0,ur.x7)((0,ea.jX)($e),Ye))},Zl=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:qh,reducer:zd,picker:Xh,editor:Jh,dependsOn:(re,ee)=>!1,setValue:async(re,ee,oe=!1)=>{await(0,rr.JD)((0,ur.t9)((0,ea.jX)(re),ee,oe))},setValueFromUrl:async(re,ee)=>{await(0,rr.JD)(tf((0,ea.jX)(re),ee))},updateOptions:async re=>{await(0,rr.JD)(ef((0,ea.jX)(re)))},getSaveModel:(re,ee)=>{const{index:oe,id:De,state:je,global:$e,originalQuery:Ye,rootStateKey:st,...rt}=(0,Y.cloneDeep)(re);if(re.query!==Ye&&!ee){const yt=Ye??"",Ot={selected:!1,text:yt,value:yt};return{...rt,query:yt,current:Ot,options:[Ot]}}return rt},getValueForUrl:re=>re.current.value,beforeAdding:re=>({...(0,Y.cloneDeep)(re),originalQuery:re.query})});var pc=e(67203);const wc=e(39572),gc=wc.keys().map(re=>wc(re));class nf{async init(){try{await Cl(),window.parent.postMessage("GrafanaAppInit","*");const ee=k.Ay.featureToggles.localeFormatPreference?k.Ay.regionalFormat:k.Ay.bootData.user.language,oe=(0,u.JL)({language:k.Ay.bootData.user.language,ns:Pi.dK,module:ll},ee);oe.then(async({language:Ot})=>((0,k._R)({language:Ot}),(0,u.fl)(Pi.VV,Ot??f.Nm,[_._H]))),(0,b.u5)(Ze.IB),await af(),(0,da.j)("frontend_app_init"),(0,h.xS)(k.Ay.regionalFormat),(0,h.$D)(k.Ay.bootData.user.weekStart),(0,F.Y)(Qc.m),(0,V.l)(zo),(0,E.N)(rl),(0,K.e)(Hc.a),(0,D.T)(C.Ny),(0,P.l)(new Pt),(0,T.p)(gr),(0,r.G)(()=>k.Ay.bootData.user.timezone),tu(),(0,O.l)(Ls.TP.user),(0,Kl.initAuthConfig)(),(0,I.H8)(Cs.A),await oe,mc(),(0,pc.U1)(),Vc(),si(),g.D.setInit($i.H),g.G.setInit($i.u),y.h.setInit(ir),Vl.B.setInit(()=>[Vd(),Ch(),Zl(),Rd(),jh(),Kc(),Bu(),_h()]),v.l.setInit(ar.A),(0,Nl.f)(),(0,j.HC)(()=>new hu),yd(new th),(0,j.pC)(Dc.BN),(0,W.se)({importPanelPlugin:Yc.TV,getPanelPluginFromCache:Yc.PY}),k.Ay.featureToggles.useSessionStorageForRedirection&&sf(),x.I.initialize({config:k.Ay,getTimeRangeForUrl:(0,Nn.jG)().timeRangeForUrl,getVariablesUrlParams:Lh.z}),document.addEventListener("click",et);const De=new dl.xq;De.init(k.Ay.datasources,k.Ay.defaultDatasource),(0,B.h)(De),pu();const je=k.Ay.featureToggles.rendererDisableAppPluginsPreload&&Ls.TP.user.authenticatedBy==="render";if(Ls.TP.user.orgRole!==""&&!je){const Ot=(0,Or.Xs)(),Bt=(0,Or.mi)();Pc(Bt),await Pc(Ot)}(0,S.q)(cu),(0,w.A)(ru),(0,N.R)(ou),(0,M.U)(lu),(0,G.C)(_c.m5),(0,H.h)(_c.zN);const $e=C.Ny.getSearchObject(),Ye=new no.dk,st=new ds(C.Ny,Ye),rt=new Le;rt.start(),Ye.setKioskModeFromUrl($e.kiosk);try{(0,gu.W1)()}catch(Ot){console.warn("Failed to clean up old expanded folders",Ot)}this.context={backend:Ze.IB,location:C.Ny,chrome:Ye,keybindings:st,newAssetsChecker:rt,config:k.Ay},(0,L._)(Ll.ni),(0,A._)(dr.k9),k.Ay.featureToggles.crashDetection&&bl(),(0,p.H)(document.getElementById("reactRoot")).render((0,c.createElement)(yo.Nz,{app:this})),await Wl()}catch(ee){console.error("Failed to start Grafana",ee),window.__grafana_load_failed()}finally{(0,da.z)("frontend_app_init")}}}function mc(){gc.length>0&&gc[0].addExtensionReducers()}function Vc(){gc.length>0&&gc[0].init()}async function af(){if((0,U.H2)(new ut({debug:!1})),window.addEventListener("load",re=>{const ee="frontend_boot_load_time_seconds";performance&&(performance.mark(ee),Xl("first-paint","frontend_boot_","_time_seconds"),Xl("first-contentful-paint","frontend_boot_","_time_seconds"),Xl(ee),Xl("frontend_boot_js_done_time_seconds"),Xl("frontend_boot_css_time_seconds"))}),Ls.TP.user.orgRole!==""){const{PerformanceBackend:re}=await e.e(4857).then(e.bind(e,4857));(0,U.pl)(new re({}))}if(k.Ay.grafanaJavascriptAgent.enabled){const re=[k.Ay.rudderstackConfigUrl,k.Ay.rudderstackDataPlaneUrl,k.Ay.rudderstackIntegrationsUrl].filter(Boolean).map(oe=>new RegExp(`${oe}.*.`)),{GrafanaJavascriptAgentBackend:ee}=await e.e(8826).then(e.bind(e,18826));(0,U.pl)(new ee({...k.Ay.grafanaJavascriptAgent,app:{version:k.Ay.buildInfo.version,environment:k.Ay.buildInfo.env},buildInfo:k.Ay.buildInfo,user:{id:String(k.Ay.bootData.user?.id),email:k.Ay.bootData.user?.email},ignoreUrls:re}))}if(k.Ay.googleAnalyticsId){const{GAEchoBackend:re}=await e.e(9820).then(e.bind(e,59820));(0,U.pl)(new re({googleAnalyticsId:k.Ay.googleAnalyticsId}))}if(k.Ay.googleAnalytics4Id){const{GA4EchoBackend:re}=await e.e(7018).then(e.bind(e,47018));(0,U.pl)(new re({googleAnalyticsId:k.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:k.Ay.googleAnalytics4SendManualPageViews}))}if(k.Ay.rudderstackWriteKey&&k.Ay.rudderstackDataPlaneUrl){const{RudderstackBackend:re}=await e.e(4564).then(e.bind(e,34564));(0,U.pl)(new re({writeKey:k.Ay.rudderstackWriteKey,dataPlaneUrl:k.Ay.rudderstackDataPlaneUrl,user:k.Ay.bootData.user,sdkUrl:k.Ay.rudderstackSdkUrl,configUrl:k.Ay.rudderstackConfigUrl,integrationsUrl:k.Ay.rudderstackIntegrationsUrl,buildInfo:k.Ay.buildInfo}))}if(k.Ay.applicationInsightsConnectionString){const{ApplicationInsightsBackend:re}=await e.e(2699).then(e.bind(e,2699));(0,U.pl)(new re({connectionString:k.Ay.applicationInsightsConnectionString,endpointUrl:k.Ay.applicationInsightsEndpointUrl}))}if(k.Ay.analyticsConsoleReporting){const{BrowserConsoleBackend:re}=await e.e(5747).then(e.bind(e,75747));(0,U.pl)(new re)}}function Xl(re,ee="",oe=""){const De=performance.getEntriesByName(re).at(0);if(De){const je=De.name.replace(/-/g,"_");(0,Et.n)(`${ee}${je}${oe}`,Math.round(De.startTime)/1e3)}}function sf(){const re=C.Ny.getSearch(),ee="redirectTo";if(re.has("auth_token")){window.sessionStorage.removeItem(Ls.OG);return}if(re.has(ee)&&window.location.pathname!=="/"){const je=re.get(ee);window.sessionStorage.setItem(Ls.OG,encodeURIComponent(je)),re.delete(ee),window.history.replaceState({},"",`${window.location.pathname}${re.size>0?`?${re}`:""}`);return}if(!Ls.TP.user.isSignedIn)return;const oe=window.sessionStorage.getItem(Ls.OG);if(!oe)return;window.sessionStorage.removeItem(Ls.OG);const De=decodeURIComponent(oe);De.startsWith("/goto/")?window.location.replace(De):C.Ny.replace(De)}new nf().init()},84266:(Z,R,e)=>{"use strict";e.d(R,{Or:()=>s,Oz:()=>d,RC:()=>a,ho:()=>l,nA:()=>o,uz:()=>n});const n=Symbol("routes_metadata");var a=(i=>(i.Active="active",i.Expired="expired",i.Pending="pending",i))(a||{}),s=(i=>(i.Unprocessed="unprocessed",i.Active="active",i.Suppressed="suppressed",i))(s||{}),l=(i=>(i.equal="=",i.notEqual="!=",i.regex="=~",i.notRegex="!~",i))(l||{}),o=(i=>(i.Internal="internal",i.External="external",i.All="all",i))(o||{}),d=(i=>(i.cortex="cortex",i.mimir="mimir",i.prometheus="prometheus",i))(d||{})},38242:(Z,R,e)=>{"use strict";e.d(R,{Dw:()=>d,Rx:()=>s,_M:()=>i,_W:()=>o,d$:()=>a});const n={statistics:[]};var a=(m=>(m[m.Insights=1]="Insights",m[m.Search=0]="Search",m))(a||{}),s=(m=>(m[m.Builder=0]="Builder",m[m.Code=1]="Code",m))(s||{});const l={parameters:[]};var o=(m=>(m.And="and",m.Function="function",m.FunctionParameter="functionParameter",m.GroupBy="groupBy",m.Operator="operator",m.Or="or",m.Property="property",m))(o||{}),d=(m=>(m.String="string",m))(d||{}),i=(m=>(m.CWLI="CWLI",m.PPL="PPL",m.SQL="SQL",m))(i||{});const c={logGroupNames:[],logGroups:[],statsGroups:[]}},51515:(Z,R,e)=>{"use strict";e.d(R,{Rx:()=>n.Rx,YZ:()=>a,_M:()=>n._M,b4:()=>s,d$:()=>n.d$});var n=e(38242),a=(l=>(l.Scheduled="Scheduled",l.Running="Running",l.Complete="Complete",l.Failed="Failed",l.Cancelled="Cancelled",l.Timeout="Timeout",l))(a||{}),s=(l=>(l.Regions="regions",l.Namespaces="namespaces",l.Metrics="metrics",l.DimensionKeys="dimensionKeys",l.DimensionValues="dimensionValues",l.EBSVolumeIDs="ebsVolumeIDs",l.EC2InstanceAttributes="ec2InstanceAttributes",l.ResourceArns="resourceARNs",l.Statistics="statistics",l.LogGroups="logGroups",l.Accounts="accounts",l))(s||{})},9931:(Z,R,e)=>{"use strict";e.d(R,{K:()=>n});const n="-- Dashboard --",a="dashboard"},73601:(Z,R,e)=>{"use strict";e.d(R,{k:()=>c,m:()=>m});var n=e(88483),a=e(739),s=e(28105),l=e(22592),o=e(22429),d=e(82612),i=e(9931);function c(r){return r?typeof r=="string"?r===i.K:"meta"in r&&r.meta.name===i.K||r.uid===i.K:!1}function m(r,g){return new n.c(y=>{const v=(0,o.UA)().getCurrent(),x=p(r.queries);if(!x){y.next(h("Missing panel reference ID"));return}let f=v?.getPanelById(x,!0);if(f instanceof d.a9||(f=new d.a9(f)),!f){y.next(h("Unknown Panel: "+x));return}const u=f.getQueryRunner(),b=u.getData({withTransforms:!!g?.withTransforms,withFieldConfig:!1}).subscribe({next:E=>{g?.topic===a.QR.Annotations&&(E={...E,series:E.annotations??[],annotations:void 0}),y.next(E)}});if(!f.isInView&&f.refreshWhenInView||v?.otherPanelInFullscreen(f)){const{datasource:E,targets:D}=f,C={...r,datasource:E,panelId:x,queries:D};f.refreshWhenInView=!1,u.run(C)}return()=>{b.unsubscribe()}})}function p(r){if(!(!r||!r.length))return r[0].panelId}function h(r){return{state:s.Gu.Error,series:[],request:{},error:{message:r},timeRange:(0,l.E2)()}}},16310:(Z,R,e)=>{"use strict";e.d(R,{i:()=>Se,o:()=>Me});var n=e(2543),a=e(65474),s=e(62467),l=e(44240),o=e(81160),d=e(77154),i=e(28105),c=e(38619),m=e(18700),p=e(88673),h=e(41119),r=e(36580),g=e(2863),y=e(33184),v=e(68143),x=e(78282),f=e(65635),u=e(22429),b=e(74848),E=e(22803),D=e(96540),C=e(63142),P=e(16780),T=e(37386),O=e(18857),I=e(21285),j=e(93732),W=e(78767),B=e(8095),S=e(95093),w=e.n(S),N=e(62717),M=e(25229),L=e(92745),A=e(59310),U=e(45861),F=e(41654),V=e(11527),K=e(63527),G=e(27228),H=e(44229);const _=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Te,Ge)=>({label:Te,value:Ge+1})),k=({value:Te,onChange:Ge})=>{const Qe=(0,C.of)(J),tt=Date.now(),ke=(0,N.QZ)(Te.timezone??"utc",tt),He=(0,u.UA)().getCurrent()?.getTimezone()===Te.timezone,[Re,Ne]=(0,D.useState)(!1),Ae=()=>{Ne(!Re)},Ue=Ve=>{if(!Ve)return;const ge=w()();if(Ve){const Ke=Ve.split(":");ge.set("hour",parseInt(Ke[0],10)),ge.set("minute",parseInt(Ke[1],10))}return ge},Be=()=>{let Ve="Everyday";return Te.fromDayOfWeek&&!Te.toDayOfWeek&&(Ve=_[Te.fromDayOfWeek-1].label),Ve},We=()=>{const Ve=(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(G.U,{title:ke?.name}),(0,b.jsx)(H.X,{timeZone:Te.timezone,timestamp:tt})]});return He?(0,b.jsxs)(b.Fragment,{children:["Dashboard timezone (",Ve,")"]}):Ve},_e=(Ve,ge)=>{const Ke=Ve?Ve.format("HH:mm"):void 0;Ge(ge==="from"?{...Te,from:Ke}:{...Te,to:Ke})},Xe=Ve=>{Ge({...Te,timezone:Ve})},le=Ve=>{Ge({...Te,mode:Ve})},ye=Ve=>{Ge({...Te,cronExpr:Ve})},pe=Ve=>{Ge({...Te,duration:Ve})},ve=Ve=>{const ge=Ve?Ve.value:void 0,Ke=Ve?Te.toDayOfWeek:void 0;Ge({...Te,fromDayOfWeek:ge,toDayOfWeek:Ke})},be=Ve=>{Ge({...Te,toDayOfWeek:Ve?Ve.value:void 0})},Oe=()=>Re?(0,b.jsx)(A.U,{value:Te.timezone,includeInternal:!0,onChange:Ve=>Xe(Ve),onBlur:()=>Ne(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,b.jsxs)("div",{className:Qe.timezoneContainer,children:[(0,b.jsx)("div",{className:Qe.timezone,children:We()}),(0,b.jsx)(U.$n,{variant:"secondary",onClick:Ae,size:"sm",children:"Change timezone"})]}),we=Ue(Te.from),ze=Ue(Te.to);return(0,b.jsxs)(P.n,{className:Qe.wrapper,children:[(0,b.jsx)(T.D,{label:(0,L.t)("dashboard-settings.time-regions.advanced-label","Advanced"),description:(0,b.jsxs)(b.Fragment,{children:[(0,L.t)("dashboard-settings.time-regions.advanced-description-use","Use "),(0,b.jsx)("a",{href:"https://crontab.run/",target:"_blank",children:(0,L.t)("dashboard-settings.time-regions.advanced-description-cron","Cron syntax")}),(0,L.t)("dashboard-settings.time-regions.advanced-description-rest"," to define a recurrence schedule and duration")]}),children:(0,b.jsx)(I.d,{id:"time-regions-adanced-mode-toggle",value:Te.mode==="cron",onChange:Ve=>le(Ve.currentTarget.checked?"cron":null)})}),Te.mode==null&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.D,{label:"From",children:(0,b.jsxs)(F.B,{gap:.5,children:[(0,b.jsx)(O.l6,{options:_,isClearable:!0,placeholder:"Everyday",value:Te.fromDayOfWeek??null,onChange:Ve=>ve(Ve),width:20}),(0,b.jsx)(V.R,{value:(0,M.Ar)(we)?we:void 0,onChange:Ve=>_e(Ve&&(0,M.AN)(Ve),"from"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})}),(0,b.jsx)(T.D,{label:"To",children:(0,b.jsxs)(F.B,{gap:.5,children:[(Te.fromDayOfWeek||Te.toDayOfWeek)&&(0,b.jsx)(O.l6,{options:_,isClearable:!0,placeholder:Be(),value:Te.toDayOfWeek??null,onChange:Ve=>be(Ve),width:20}),(0,b.jsx)(V.R,{value:(0,M.Ar)(ze)?ze:void 0,onChange:Ve=>_e(Ve&&(0,M.AN)(Ve),"to"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})})]}),Te.mode==="cron"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.D,{label:"Cron expression",children:(0,b.jsx)(K.p,{onChange:Ve=>ye(Ve.target.value),value:Te.cronExpr,placeholder:"0 9 * * 1-5",width:40})}),(0,b.jsx)(T.D,{label:"Duration",children:(0,b.jsx)(K.p,{onChange:Ve=>pe(Ve.target.value),value:Te.duration,placeholder:"8h",width:40})})]}),(0,b.jsx)(T.D,{label:"Timezone",children:Oe()})]})},J=Te=>({wrapper:(0,E.css)({maxWidth:Te.spacing(60),marginBottom:Te.spacing(2)}),timezoneContainer:(0,E.css)({padding:"5px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:"12px"}),timezone:(0,E.css)({marginRight:"5px"})}),z="Enabling this returns annotations that match any of the tags specified below",Y=(0,b.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),X=[{label:"Dashboard",value:B.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:B.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],Q=[{label:"Annotations & Alerts",value:B.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:B.nj.TimeRegions,description:"Configure a repeating time region"}],q=[10,50,100,200,300,500,1e3,2e3].map(Te=>({label:String(Te),value:Te}));function te({query:Te,onChange:Ge}){const Qe=Te,{limit:tt,matchAny:ke,tags:He,type:Re,queryType:Ne}=Qe;let Ae=Ne??B.nj.Annotations;const Ue=(0,D.useMemo)(()=>(0,u.UA)().dashboard?.getTimezone(),[]),Be=(0,C.of)(ne),We=ve=>Ge({...Qe,type:ve.value}),_e=ve=>Ge({...Qe,limit:ve.value}),Xe=ve=>Ge({...Qe,matchAny:ve.target.checked}),le=ve=>Ge({...Qe,tags:ve}),ye=ve=>{const be={...Qe,queryType:ve.value};be.queryType===B.nj.TimeRegions?be.timeRegion||(be.timeRegion={timezone:Ue}):delete be.timeRegion,Ge(be)},pe=ve=>{Ge({...Qe,timeRegion:ve})};return(0,b.jsxs)(P.n,{className:Be.container,children:[(0,b.jsx)(T.D,{label:"Query type",children:(0,b.jsx)(O.l6,{inputId:"grafana-annotations__query-type",options:Q,value:Ae,onChange:ye})}),Ae===B.nj.Annotations&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.D,{label:"Filter by",children:(0,b.jsx)(O.l6,{inputId:"grafana-annotations__filter-by",options:X,value:Re,onChange:We})}),(0,b.jsx)(T.D,{label:"Max limit",children:(0,b.jsx)(O.l6,{inputId:"grafana-annotations__limit",width:16,options:q,value:tt,onChange:_e})}),Re===B.St.Tags&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.D,{label:"Match any",description:z,children:(0,b.jsx)(I.d,{id:"grafana-annotations__match-any",value:ke,onChange:Xe})}),(0,b.jsx)(T.D,{label:"Tags",description:Y,children:(0,b.jsx)(j.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:le,tagOptions:W.vy,tags:He??[]})})]})]}),Ae===B.nj.TimeRegions&&Qe.timeRegion&&(0,b.jsx)(k,{value:Qe.timeRegion,onChange:pe})]})}const ne=Te=>({container:(0,E.css)({maxWidth:Te.spacing(60),marginBottom:Te.spacing(2)})});var se=e(95004),ue=e(14465),de=e(74529);const ie=24*3600;function he(Te,Ge,Qe,tt,ke,He){let Re=tt-Te;Re<0&&(Re+=7);let Ne=Ge*3600+Qe*60,Ae=ke*3600+He*60,Ue=0;return Re===0&&Ae<Ne?Ue=7*ie-(Ne-Ae):Ue=Re*ie-Ne+Ae,Ue}function me(Te,Ge,Qe,tt){if(Te==null&&Ge==null)return;const ke={cronExpr:"",duration:0},He=Te==null&&Qe==null,Re=Te!=null&&Ge==null&&tt==null;Ge??="00:00";let[Ne,Ae]=Ge.split(":").map(Xe=>+Xe);ke.cronExpr=`${Ae} ${Ne} * * ${Te??"*"}`,Te??=1,Qe??=Te,Re&&(tt="00:00",Qe+=Qe===7?-6:1),tt??=Ge;let[Ue,Be]=tt.split(":").map(Xe=>+Xe),We=Ne*3600+Ae*60,_e=Ue*3600+Be*60;return He&&_e<We&&(Qe+=Qe===7?-6:1),ke.duration=he(Te,Ne,Ae,Qe,Ue,Be),ke}function ce(Te,Ge){const Qe=[];let tt="",ke=0,{fromDayOfWeek:He,from:Re,toDayOfWeek:Ne,to:Ae,duration:Ue=""}=Te;if(Te.mode==="cron")tt=Te.cronExpr??"",ke=(0,de.WT)((0,de.E9)(Ue));else{Re=Re===""?void 0:Re,Ae=Ae===""?void 0:Ae;const Be=me(He,Re,Ne,Ae);Be!=null&&(tt=Be.cronExpr,ke=Be.duration*1e3)}if(tt==="")return[];try{let Be=Te.timezone==="browser"?void 0:Te.timezone==="utc"?"Etc/UTC":Te.timezone,We=new ue.l4(tt,{timezone:Be}),_e=new Date(Ge.from.valueOf()-ke),Xe=Ge.to.valueOf(),le=We.nextRun(_e);for(;le!=null;){let ye=+le;if(ye>Xe)break;Qe.push({from:ye,to:ye+ke}),le=We.nextRun(le)}}catch(Be){console.error(Be)}return Qe}function Pe(Te,Ge,Qe){const{mode:tt,duration:ke,cronExpr:He,from:Re,fromDayOfWeek:Ne}=Ge,Ae=tt==null&&(Ne!=null||Re!=null),Ue=tt==="cron"&&He!=null&&ke!=null;if(Ae||Ue){const Be=ce(Ge,Qe);if(Be.length>0)return{fields:[{name:"time",type:se.PU.time,values:Be.map(_e=>_e.from),config:{}},{name:"timeEnd",type:se.PU.time,values:Be.map(_e=>_e.to),config:{}},{name:"text",type:se.PU.string,values:Array(Be.length).fill(Te),config:{}}],length:Be.length}}}let Ie=100;class Se extends r.iy{constructor(Ge){super(Ge),this.annotations={QueryEditor:te,prepareAnnotation(Qe){return Qe.target=Qe.target??{type:Qe.type??B.St.Dashboard,limit:Qe.limit??100,tags:Qe.tags??[],matchAny:Qe.matchAny??!1},Qe},prepareQuery(Qe){let tt;if((0,n.isString)(Qe.datasource)){const Re=(0,f.og)(Qe.datasource,{returnDefaultAsNull:!1});Re&&(tt=Re)}else tt=Qe.datasource;const{filter:ke,...He}=Qe;return{...He,refId:Qe.name,queryType:B.nj.Annotations,datasource:tt}}}}getDefaultQuery(){return{queryType:B.nj.RandomWalk}}query(Ge){const Qe=[],tt=[],ke=(0,g.w)();for(const He of Ge.targets){if(He.queryType===B.nj.Annotations)return(0,a.H)(this.getAnnotations({range:Ge.range,rangeRaw:Ge.range.raw,annotation:He,dashboard:(0,u.UA)().getCurrent()}));if(!He.hide){if(He.queryType===B.nj.Snapshot){Qe.push((0,s.of)({data:(He.snapshot??[]).map(Re=>(0,d.or)(Re)),state:i.Gu.Done}));continue}if(He.queryType===B.nj.TimeRegions){const Re=Pe("",He.timeRegion,Ge.range);Qe.push((0,s.of)({data:Re?[Re]:[],state:i.Gu.Done}));continue}if(He.queryType===B.nj.LiveMeasurements){let Re=ke.replace(He.channel,Ge.scopedVars);const{filter:Ne}=He,Ae=(0,c.DG)(Re);if(!(0,c.aj)(Ae))continue;const Ue={maxLength:Ge.maxDataPoints??500};He.buffer?(Ue.maxDelta=He.buffer,Ue.maxLength=Ue.maxLength*2):Ge.rangeRaw?.to==="now"&&(Ue.maxDelta=Ge.range.to.valueOf()-Ge.range.from.valueOf()),Qe.push((0,y.oF)().getDataStream({key:`${Ge.requestId}.${Ie++}`,addr:Ae,filter:Ne,buffer:Ue}))}else He.queryType||(He.queryType=B.nj.RandomWalk),tt.push(He)}}return tt.length&&Qe.push(super.query({...Ge,targets:tt})),Qe.length?Qe.length===1?Qe[0]:(0,l.h)(...Qe):(0,s.of)()}listFiles(Ge,Qe){return this.query({targets:[{refId:"A",queryType:B.nj.List,path:Ge}],maxDataPoints:Qe}).pipe((0,o.T)(tt=>{const ke=tt.data[0]??new m.k;return new p.R(ke)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Ge){const Qe=Ge.annotation.target;if(Qe?.queryType===B.nj.TimeRegions){const Ne=Pe(Ge.annotation.name,Qe.timeRegion,Ge.range);return Promise.resolve({data:Ne?[Ne]:[]})}const tt=Ge.annotation,ke=tt.target,He={from:Ge.range.from.valueOf(),to:Ge.range.to.valueOf(),limit:ke.limit,tags:ke.tags,matchAny:ke.matchAny};if(ke.type===B.St.Dashboard){if(!Ge.dashboard?.uid)return Promise.resolve({data:[]});He.dashboardUID=Ge.dashboard.uid,delete He.tags}else{if(!Array.isArray(ke.tags)||ke.tags.length===0)return Promise.resolve({data:[]});const Ne=(0,g.w)(),Ae="__delimiter__",Ue=[];for(const Be of He.tags){const We=Ne.replace(Be,{},_e=>typeof _e=="string"?_e:_e.join(Ae));for(const _e of We.split(Ae))Ue.push(_e)}He.tags=Ue}const Re=await(0,v.AI)().get("/api/annotations",He,`grafana-data-source-annotations-${tt.name}-${Ge.dashboard?.uid}`);return{data:[(0,h.Vc)(Re)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Me(){return await(0,x.l)().get("-- Grafana --")}},8095:(Z,R,e)=>{"use strict";e.d(R,{St:()=>l,dx:()=>s,nj:()=>n,uJ:()=>a});var n=(o=>(o.LiveMeasurements="measurements",o.Annotations="annotations",o.Snapshot="snapshot",o.TimeRegions="timeRegions",o.RandomWalk="randomWalk",o.List="list",o.Read="read",o.Search="search",o.SearchNext="searchNext",o))(n||{});const a={refId:"A",queryType:"randomWalk"},s={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var l=(o=>(o.Dashboard="dashboard",o.Tags="tags",o))(l||{})},22747:(Z,R,e)=>{"use strict";e.d(R,{H:()=>i,j:()=>m});var n=e(77154),a=e(45229),s=e(52161),l=e(4735),o=e(87745),d=e(8095);function i(p,h){return new Promise(r=>{if(p.datasource?.uid===s.vv){c(h,p),r(!0);return}a.A.publish(new o.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{c(h,p),r(!0)},onDismiss:()=>{r(!1)}}))})}function c(p,h){const r=p.map(y=>(0,n.Nw)(y)),g={refId:"A",queryType:d.nj.Snapshot,snapshot:r,datasource:{uid:s.vv}};h.updateQueries({dataSource:{uid:s.vv},queries:[g]}),h.refresh()}function m(p){return(h,r,g)=>{(0,l.v)(h).subscribe(async y=>{const v=[];y.dataFrames.forEach(x=>{const f=(0,n.Nw)(x);v.push(f)}),p({...d.dx,snapshot:v,file:y.file},r)})}}},7795:(Z,R,e)=>{"use strict";e.d(R,{Q$:()=>s,U3:()=>a,ti:()=>l});var n=(o=>(o.Builder="builder",o.Code="code",o))(n||{}),a=(o=>(o.Instant="instant",o.Range="range",o.Stream="stream",o))(a||{}),s=(o=>(o.DataSample="dataSample",o.InfiniteScroll="infiniteScroll",o.LogsSample="logsSample",o.LogsVolume="logsVolume",o))(s||{}),l=(o=>(o.Backward="backward",o.Forward="forward",o.Scan="scan",o))(l||{})},77236:(Z,R,e)=>{"use strict";e.d(R,{AW:()=>d,Ay:()=>c,RQ:()=>l,dZ:()=>n,fV:()=>o,vB:()=>i});const n=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],a=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],s=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],l=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],o=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],d=[...n,...l,...o],i={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...a,...s].map(m=>m.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${d.map(m=>m.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},c=i},12282:(Z,R,e)=>{"use strict";e.d(R,{HD:()=>s,Q$:()=>n.Q$,U3:()=>n.U3,ie:()=>l,ti:()=>n.ti});var n=e(7795),a=(o=>(o.Stream="streams",o.Vector="vector",o.Matrix="matrix",o))(a||{}),s=(o=>(o.Indexed="I",o.StructuredMetadata="S",o.Parsed="P",o))(s||{}),l=(o=>(o[o.LabelNames=0]="LabelNames",o[o.LabelValues=1]="LabelValues",o))(l||{})},18615:(Z,R,e)=>{"use strict";e.d(R,{N8:()=>D,bG:()=>b,qM:()=>E,uv:()=>u});var n=e(2543),a=e.n(n),s=e(62467),l=e(65474),o=e(45650),d=e(69862),i=e(81160),c=e(9084),m=e(66847),p=e(93031),h=e(71030),r=e(94644),g=e(28105),y=e(2863),v=e(78282),x=e(97534),f=e(9931);const u="-- Mixed --",b="mixed-",E=(P,T)=>`${b}${P}-${T||""}`;class D extends r.mA{constructor(T){super(T)}query(T){const O=T.targets.filter(W=>W.datasource?.uid!==u);if(!O.length)return(0,s.of)({data:[]});const I=(0,n.groupBy)(O,"datasource.uid"),j=[];for(const W in I)W===f.K?I[W].forEach(B=>{j.push(...this.getBatchesForQueries([B],T))}):j.push(...this.getBatchesForQueries(I[W],T));return j.length?this.batchQueries(j,T):(0,s.of)({data:[]})}getBatchesForQueries(T,O){const I=T[0].datasource,j=[],W=(0,y.w)().replace(I?.uid,O.scopedVars,(B,S)=>{if(!Array.isArray(B))return B;for(const w of B){if(w==="default")continue;const N=(0,v.l)().getInstanceSettings(w);j.push({datasource:(0,v.l)().get(w),queries:(0,n.cloneDeep)(T),scopedVars:{...O.scopedVars,[S.name]:{value:w,text:N?.name}}})}return""});return W!==""&&j.push({datasource:(0,v.l)().get(W),queries:(0,n.cloneDeep)(T),scopedVars:{...O.scopedVars}}),j}batchQueries(T,O){const I=T.filter(this.isQueryable).map((j,W)=>(0,l.H)(j.datasource).pipe((0,d.Z)(B=>{const S=(0,n.cloneDeep)(O);return S.requestId=E(W,S.requestId),S.targets=j.queries,S.scopedVars=j.scopedVars,(0,l.H)(B.query(S)).pipe((0,i.T)(w=>({...w,data:w.data||[],state:g.Gu.Loading,key:E(W,w.key)})),(0,c.$)(),(0,m.W)(w=>(w=(0,x.u)(w),w.message=`${B.name}: ${w.message}`,(0,s.of)([{data:[],state:g.Gu.Error,error:w,key:E(W,S.requestId)}]))))})));return(0,o.p)(I).pipe(C(),(0,i.T)(this.finalizeResponses),(0,p.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(T){return T&&Array.isArray(T.queries)&&T.queries.length>0}finalizeResponses(T){const{length:O}=T;if(O===0)return T;const I=T.find(j=>j.state===g.Gu.Error);return I?T.push(I):T[O-1].state=g.Gu.Done,T}}function C(){return(0,h.T)((P,T)=>T.reduce((O,I)=>(O.push.apply(O,I),O),P),[])}},25192:(Z,R,e)=>{"use strict";e.d(R,{cd:()=>C,xw:()=>v});var n=e(18700),a=e(95004);const s={filters:[],groupBy:[]};var l=(A=>(A.Instant="instant",A.Range="range",A))(l||{}),o=(A=>(A.Done="done",A.Error="error",A.Pending="pending",A.Streaming="streaming",A))(o||{}),d=(A=>(A.Raw="raw",A.Spans="spans",A.Traces="traces",A))(d||{}),i=(A=>(A.Event="event",A.Instrumentation="instrumentation",A.Intrinsic="intrinsic",A.Link="link",A.Resource="resource",A.Span="span",A.Unscoped="unscoped",A))(i||{});function c(A){if(A.stringValue)return A.stringValue;if(A.boolValue!==void 0)return!!A.boolValue;if(A.intValue!==void 0)return Number.parseInt(String(A.intValue),10);if(A.doubleValue)return Number.parseFloat(String(A.doubleValue));if(A.arrayValue){const U=[];for(const F of A.arrayValue.values)U.push(c(F));return U}return""}function m(A){const U=[];let F="OTLPResourceNoServiceName";if(!A)return{serviceName:F,serviceTags:U};for(const V of A.attributes)V.key===SemanticResourceAttributes.SERVICE_NAME&&(F=V.value.stringValue||F),U.push({key:V.key,value:c(V.value)});return{serviceName:F,serviceTags:U}}function p(A){const U=[];if(A.attributes)for(const F of A.attributes)U.push({key:F.key,value:c(F.value)});return U}function h(A){let U;if(A.kind){const F=A.kind.toString().toLowerCase().split("_");U=F.length?F[F.length-1]:A.kind.toString()}return U}function r(A){const U=[];if(A.links)for(const F of A.links){const{traceId:V,spanId:K}=F,G=[];if(F.attributes)for(const H of F.attributes)G.push({key:H.key,value:c(H.value)});U.push({traceID:V,spanID:K,tags:G})}return U}function g(A){const U=[];if(A.events)for(const F of A.events){const V=[];if(F.attributes)for(const K of F.attributes)V.push({key:K.key,value:c(K.value)});U.push({fields:V,timestamp:F.timeUnixNano/1e6,name:F.name})}return U}function y(A,U=!1){const F=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const K of A){const{serviceName:G,serviceTags:H}=m(K.resource);for(const _ of K.instrumentationLibrarySpans)for(const k of _.spans)F.add({traceID:k.traceId,spanID:k.spanId,parentSpanID:k.parentSpanId||"",operationName:k.name||"",serviceName:G,kind:h(k),statusCode:k.status?.code,statusMessage:k.status?.message,instrumentationLibraryName:_.instrumentationLibrary?.name,instrumentationLibraryVersion:_.instrumentationLibrary?.version,traceState:k.traceState,serviceTags:H,startTime:k.startTimeUnixNano/1e6,duration:(k.endTimeUnixNano-k.startTimeUnixNano)/1e6,tags:p(k),logs:g(k),references:r(k)})}}catch(K){return console.error(K),{error:{message:"JSON is not valid OpenTelemetry format: "+K},data:[]}}let V=[F];return U&&V.push(...createNodeGraphFrames(F)),{data:V}}function v(A){let U={batches:[]},F={};for(let V=0;V<A.length;V++){const K=A.get(V);F[K.serviceName]||(F[K.serviceName]=U.batches.length,U.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let G=F[K.serviceName];U.batches[G].resource.attributes.length===0&&(U.batches[G].resource.attributes=f(K.serviceTags)),U.batches[G].instrumentationLibrarySpans[0].instrumentationLibrary||K.instrumentationLibraryName&&(U.batches[G].instrumentationLibrarySpans[0].instrumentationLibrary={name:K.instrumentationLibraryName,version:K.instrumentationLibraryVersion?K.instrumentationLibraryVersion:""}),U.batches[G].instrumentationLibrarySpans[0].spans.push({traceId:K.traceID.padStart(32,"0"),spanId:K.spanID,parentSpanId:K.parentSpanID||"",traceState:K.traceState||"",name:K.operationName,kind:x(K.kind),startTimeUnixNano:K.startTime*1e6,endTimeUnixNano:(K.startTime+K.duration)*1e6,attributes:K.tags?f(K.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:b(K),events:E(K.logs),links:D(K.references)})}return U}function x(A){let U;if(A)switch(A){case"server":U="SPAN_KIND_SERVER";break;case"client":U="SPAN_KIND_CLIENT";break;case"producer":U="SPAN_KIND_PRODUCER";break;case"consumer":U="SPAN_KIND_CONSUMER";break;case"internal":U="SPAN_KIND_INTERNAL";break}return U}function f(A){return A.reduce((U,F)=>[...U,{key:F.key,value:u(F)}],[])}function u(A){if(typeof A.value=="string")return{stringValue:A.value};if(typeof A.value=="boolean")return{boolValue:A.value};if(typeof A.value=="number")return A.value%1===0?{intValue:A.value}:{doubleValue:A.value};if(typeof A.value=="object"&&Array.isArray(A.value)){const U=[];for(const F of A.value)U.push(u(F));return{arrayValue:{values:U}}}return{stringValue:A.value}}function b(A){let U;return A.statusCode!==void 0&&(U={code:A.statusCode,message:A.statusMessage?A.statusMessage:""}),U}function E(A){if(!A||!A.length)return;let U=[];for(const F of A){let V={timeUnixNano:F.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:F.name||""};for(const K of F.fields)V.attributes.push({key:K.key,value:u(K)});U.push(V)}return U}function D(A){if(!A||!A.length)return;let U=[];for(const F of A){let V={traceId:F.traceID,spanId:F.spanID,attributes:[],droppedAttributesCount:0};if(F.tags?.length)for(const K of F.tags)V.attributes?.push({key:K.key,value:u(K)});U.push(V)}return U}const C="Related profiles";function P(A,U,F=!1){const V=A.data[0];if(!V)return L;const G=U?.jsonData?.tracesToProfiles;let H;if(G?.datasourceUid&&(H=getDataSourceSrv().getInstanceSettings(G.datasourceUid)),G&&H){const k=G.customQuery?G.query:void 0,J={title:C,url:"",internal:{datasourceUid:H.uid,datasourceName:H.name,query:{labelSelector:k||"{${__tags}}",groupBy:[],profileTypeId:G.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};V.fields.forEach(z=>{z.name==="tags"&&(z.config.links=[J])})}let _=[...A.data];return F&&_.push(...createNodeGraphFrames(toDataFrame(V))),{...A,data:_}}function T(A){return{traceID:A.traceID,startTime:parseInt(A.startTimeUnixNano,10)/1e6,traceDuration:A.durationMs,traceService:A.rootServiceName||"",traceName:A.rootTraceName||""}}function O(A,U){return A.data?.filter(F=>F.name==="exemplar"&&F.meta?.dataTopic==="annotations").map(F=>{const V=F.fields.find(K=>K.name==="traceId");if(V){const K=I(U);V.config.links=V.config.links?.length?[...V.config.links,...K]:K}return F}),A}function I(A){const U=[];return A.uid&&U.push({title:"View trace",url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:A.uid,datasourceName:A?.name??"Data source not found"}}),U}function j(A,U,F){switch(F){case SearchTableType.Spans:return S(A,U);case SearchTableType.Raw:return W(A);default:return B(A,U)}}function W(A){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(A,null,2)]}]})]}function B(A,U){const F=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return A?.length?(F.length=A.length,A.sort((V,K)=>parseInt(K?.startTimeUnixNano,10)/1e6-parseInt(V?.startTimeUnixNano,10)/1e6).forEach(V=>{const K=T(V);F.fields[0].values.push(K.traceID),F.fields[1].values.push(K.startTime),F.fields[2].values.push(K.traceService),F.fields[3].values.push(K.traceName),F.fields[4].values.push(K.traceDuration?K.traceDuration:"<1ms"),V.spanSets?F.fields[5].values.push(V.spanSets.map(G=>N(V,G,U))):V.spanSet&&F.fields[5].values.push([N(V,V.spanSet,U)])}),[F]):[F]}function S(A,U){const F={};let V=!1;A?.forEach(G=>w(G).forEach(H=>{H.attributes?.forEach(_=>{F[_.key]={name:_.key,type:FieldType.string,config:{displayNameFromDS:_.key}}}),H.spans.forEach(_=>{_.name&&(V=!0),_.attributes?.forEach(k=>{F[k.key]={name:k.key,type:FieldType.string,config:{displayNameFromDS:k.key}}})})}));const K=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!V}}},...Object.values(F).sort((G,H)=>G.name.localeCompare(H.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!A||!A.length?[K]:(A.sort((G,H)=>parseInt(H?.startTimeUnixNano,10)/1e6-parseInt(G?.startTimeUnixNano,10)/1e6).forEach(G=>{w(G).forEach(H=>{H.spans.forEach(_=>{K.add(M(_,H,G))})})}),[K])}const w=A=>A.spanSets||(A.spanSet?[A.spanSet]:[]),N=(A,U,F)=>{const V={};let K=!1;U.attributes?.map(_=>{V[_.key]={name:_.key,type:FieldType.string,config:{displayNameFromDS:_.key},values:[]}}),U.spans.forEach(_=>{_.name&&(K=!0),_.attributes?.forEach(k=>{V[k.key]={name:k.key,type:FieldType.string,config:{displayNameFromDS:k.key},values:[]}})});const G=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:F.uid,datasourceName:F.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!K}}},...Object.values(V).sort((_,k)=>_.name.localeCompare(k.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),H=createTheme();for(const _ of G.fields)_.display=getDisplayProcessor({field:_,theme:H});return U.spans.forEach(_=>{G.add(M(_,U,A))}),G};function M(A,U,F){const V=parseInt(A.startTimeUnixNano,10)/1e6,K={traceIdHidden:F.traceID,traceService:F.rootServiceName||"",traceName:F.rootTraceName||"",spanID:A.spanID,time:V,duration:parseInt(A.durationNanos,10),name:A.name};let G=[];return U.attributes&&(G=G.concat(U.attributes)),A.attributes&&(G=G.concat(A.attributes)),G.forEach(H=>{(H.value.boolValue||H.value.Value?.bool_value)&&(K[H.key]=H.value.boolValue||H.value.Value?.bool_value),(H.value.doubleValue||H.value.Value?.double_value)&&(K[H.key]=H.value.doubleValue||H.value.Value?.double_value),(H.value.intValue||H.value.Value?.int_value)&&(K[H.key]=H.value.intValue||H.value.Value?.int_value),(H.value.stringValue||H.value.Value?.string_value)&&(K[H.key]=H.value.stringValue||H.value.Value?.string_value)}),K}const L={data:[new n.k({fields:[{name:"trace",type:a.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},21834:(Z,R,e)=>{"use strict";e.d(R,{nE:()=>s,r6:()=>a,xB:()=>n});var n=(l=>(l[l.AlphaAsc=1]="AlphaAsc",l[l.AlphaDesc=2]="AlphaDesc",l[l.Importance=3]="Importance",l[l.TimeAsc=4]="TimeAsc",l[l.TimeDesc=5]="TimeDesc",l))(n||{}),a=(l=>(l.Default="default",l.Custom="custom",l))(a||{}),s=(l=>(l.List="list",l.Stat="stat",l))(s||{})},4598:(Z,R,e)=>{"use strict";e.d(R,{d:()=>E,l:()=>D});var n=e(74848),a=e(2543),s=e(96540),l=e(38919),o=e(44232),d=e(739),i=e(98005),c=e(6399),m=e(54735),p=e(33352),h=e(65642),r=e(16515),g=e(95004),y=e(76637),v=e(63142),x=e(4268),f=e(36192);const u=(0,s.memo)(({data:C,placement:P,calcs:T,displayMode:O,...I})=>{const j=(0,v.$j)();let W=[];return(0,r.Fm)(C),C.forEach((B,S)=>{B.fields.forEach((w,N)=>{const M=N+1;if(w.type===g.PU.time||w.config.custom?.hideFrom?.legend)return;const L=w.state?.displayName??w.name,A=(0,y.lz)(w,j).color,U={label:L.toString(),color:A,yAxis:w.config.custom?.axisPlacement===d.vM.Right?2:1,disabled:w.state?.hideFrom?.viz,getDisplayValues:()=>(0,f.UO)(T,w,j),getItemKey:()=>`${L}-${S}-${M}`};W.push(U)})}),(0,n.jsx)(m.KU.Legend,{placement:P,...I,children:(0,n.jsx)(x.t,{placement:P,items:W,displayMode:O,sortBy:I.sortBy,sortDesc:I.sortDesc,isSortable:!0})})});u.displayName="BarGaugeLegend";var b=e(88879);class E extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(P,T)=>{const{options:O,fieldConfig:I}=this.props,{value:j,alignmentFactors:W,orientation:B,width:S,height:w,count:N}=P,{field:M,display:L,view:A,colIndex:U}=j,{openMenu:F,targetClassName:V}=T,K=this.getItemSpacing(),G=(w+K)*N-K>this.props.height;let H;return A&&(0,a.isNumber)(U)&&(H=A.getFieldDisplayProcessor(U)),(0,n.jsx)(i.xE,{value:D(N,I.defaults,L),width:S,height:w,orientation:B,field:M,text:O.text,display:H,theme:h.$W.theme2,itemSpacing:K,displayMode:O.displayMode,onClick:F,className:V,alignmentFactors:N>1?W:void 0,showUnfilled:O.showUnfilled,valueDisplayMode:O.valueMode,namePlacement:O.namePlacement,isOverflow:G})},this.renderValue=P=>{const{value:T,orientation:O}=P,{hasLinks:I,getLinks:j}=T;return I&&j?(0,n.jsx)("div",{style:{width:"100%",display:O===l.wV.Vertical?"flex":"initial"},children:(0,n.jsx)(c.e,{style:{height:"100%"},links:j,children:W=>this.renderComponent(P,W)})}):this.renderComponent(P,{})},this.getValues=()=>{const{data:P,options:T,replaceVariables:O,fieldConfig:I,timeZone:j}=this.props;return(0,o.PI)({fieldConfig:I,reduceOptions:T.reduceOptions,replaceVariables:O,theme:h.$W.theme2,data:P.series,timeZone:j})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:P,width:T,height:O}=this.props,{orientation:I}=P;return I===l.wV.Auto?T>O?l.wV.Vertical:l.wV.Horizontal:I}calcBarSize(){const{options:P}=this.props,T=this.getOrientation(),O=P.sizing===d.T6.Manual,I=T===l.wV.Vertical,j=T===l.wV.Horizontal,W=O&&I?P.minVizWidth:b.K.minVizWidth,B=O&&j?P.minVizHeight:b.K.minVizHeight,S=O&&j?P.maxVizHeight:b.K.maxVizHeight;return{minVizWidth:W,minVizHeight:B,maxVizHeight:S}}getLegend(){const{options:P,data:T}=this.props,{legend:O}=P;return O.showLegend&&T&&T.series.length>0?(0,n.jsx)(u,{data:T.series,...O}):null}render(){const{height:P,width:T,options:O,data:I,renderCounter:j}=this.props,{minVizWidth:W,minVizHeight:B,maxVizHeight:S}=this.calcBarSize();return(0,n.jsx)(m.KU,{width:T,height:P,legend:this.getLegend(),children:(w,N)=>(0,n.jsx)(p.S,{source:I,getAlignmentFactors:o.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:j,width:w,height:N,maxVizHeight:S,minVizWidth:W,minVizHeight:B,itemSpacing:this.getItemSpacing(),orientation:O.orientation})})}}function D(C,P,T){return C===1&&!P.displayName?{...T,title:void 0}:T}},88879:(Z,R,e)=>{"use strict";e.d(R,{K:()=>a});var n=e(739);const a={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},71843:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var n=e(16207),a=e(92745),s=e(739),l=e(14099),o=e(87252),d=e(59795);const i=T=>(0,d._$)(T),c=(T,O,I)=>{const j=(0,d.gl)(T,O,I);if(O==="singlestat"&&I.angular){const W=I.angular.gauge;W&&(j.showThresholdMarkers=W.thresholdMarkers,j.showThresholdLabels=W.thresholdLabels)}return j};var m=e(74848),p=e(96540),h=e(11576),r=e(44232),g=e(18627),y=e(6399),v=e(33352),x=e(65642),f=e(4598);const u={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:s.T6.Auto};class b extends p.PureComponent{constructor(){super(...arguments),this.renderComponent=(O,I)=>{const{options:j,fieldConfig:W}=this.props,{width:B,height:S,count:w,value:N}=O,{field:M,display:L}=N,{openMenu:A,targetClassName:U}=I;return(0,m.jsx)(g._,{value:(0,f.l)(w,W.defaults,L),width:B,height:S,field:M,text:j.text,showThresholdLabels:j.showThresholdLabels,showThresholdMarkers:j.showThresholdMarkers,theme:x.$W.theme2,onClick:A,className:U,orientation:j.orientation})},this.renderValue=O=>{const{value:I}=O,{getLinks:j,hasLinks:W}=I;return W&&j?(0,m.jsx)(y.e,{links:j,style:{flexGrow:1},children:B=>this.renderComponent(O,B)}):this.renderComponent(O,{})},this.getValues=()=>{const{data:O,options:I,replaceVariables:j,fieldConfig:W,timeZone:B}=this.props;for(let S of O.series)for(let w of S.fields)if(w.config.unit==="percent"||w.config.unit==="percentunit"){const N=w.config.min??0,M=w.config.max??(w.config.unit==="percent"?100:1);w.state=w.state??{},w.state.range={min:N,max:M,delta:M-N},w.display=(0,h.J)({field:w,theme:x.$W.theme2})}return(0,r.PI)({fieldConfig:W,reduceOptions:I.reduceOptions,replaceVariables:j,theme:x.$W.theme2,data:O.series,timeZone:B})},this.calculateGaugeSize=()=>{const{options:O}=this.props,I=O.orientation,j=O.sizing===s.T6.Manual,W=I===s.wV.Vertical,B=I===s.wV.Horizontal,S=j&&W?O.minVizWidth:u.minVizWidth,w=j&&B?O.minVizHeight:u.minVizHeight;return{minVizWidth:S,minVizHeight:w}}}render(){const{height:O,width:I,data:j,renderCounter:W,options:B}=this.props,{minVizHeight:S,minVizWidth:w}=this.calculateGaugeSize();return(0,m.jsx)(v.S,{getValues:this.getValues,renderValue:this.renderValue,width:I,height:O,source:j,autoGrid:!0,renderCounter:W,orientation:B.orientation,minVizHeight:S,minVizWidth:w})}}var E=e(33553),D=e(73495);class C{getSuggestionsForData(O){const{dataSummary:I}=O;if(!I.hasData||!I.hasNumberField||I.numberFieldCount>=50)return;const j=O.getListAppender({name:D.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:E.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:W=>{W.options.reduceOptions.values&&(W.options.reduceOptions.limit=2)}}});I.hasStringField&&I.frameCount===1&&I.rowCountTotal<10?(j.append({name:D.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),j.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(j.append({name:D.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),j.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const P=new n.m(b).useFieldConfig({useCustomConfig:T=>{T.addNumberInput({path:"neutral",name:(0,a.t)("gauge.name-neutral","Neutral"),description:(0,a.t)("gauge.description-neutral","Leave empty to use Min as neutral point"),category:[(0,a.t)("gauge.category-gauge","Gauge")],settings:{placeholder:(0,a.t)("gauge.placeholder-neutral","auto")}})}}).setPanelOptions(T=>{const O=[(0,a.t)("gauge.category-gauge","Gauge")];(0,o.L)(T),(0,o.h)(T,O),T.addBooleanSwitch({path:"showThresholdLabels",name:(0,a.t)("gauge.name-show-threshold-labels","Show threshold labels"),description:(0,a.t)("gauge.description-show-threshold-labels","Render the threshold values around the gauge bar"),category:O,defaultValue:u.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:(0,a.t)("gauge.name-show-threshold-markers","Show threshold markers"),description:(0,a.t)("gauge.description-show-threshold-markers","Renders the thresholds as an outer bar"),category:O,defaultValue:u.showThresholdMarkers}).addRadio({path:"sizing",name:(0,a.t)("gauge.name-gauge-size","Gauge size"),settings:{options:[{value:s.T6.Auto,label:(0,a.t)("gauge.gauge-size-options.label-auto","Auto")},{value:s.T6.Manual,label:(0,a.t)("gauge.gauge-size-options.label-manual","Manual")}]},category:O,defaultValue:u.sizing,showIf:I=>I.orientation!==s.wV.Auto}).addSliderInput({path:"minVizWidth",name:(0,a.t)("gauge.name-min-width","Min width"),description:(0,a.t)("gauge.description-min-width","Minimum column width (vertical orientation)"),defaultValue:u.minVizWidth,settings:{min:0,max:600,step:1},category:O,showIf:I=>I.sizing===s.T6.Manual&&I.orientation===s.wV.Vertical}).addSliderInput({path:"minVizHeight",name:(0,a.t)("gauge.name-min-height","Min height"),description:(0,a.t)("gauge.description-min-height","Minimum row height (horizontal orientation)"),defaultValue:u.minVizHeight,category:O,settings:{min:0,max:600,step:1},showIf:I=>I.sizing===s.T6.Manual&&I.orientation===s.wV.Horizontal}),l.I(T)}).setPanelChangeHandler(c).setSuggestionsSupplier(new C).setMigrationHandler(i)},42240:(Z,R,e)=>{"use strict";e.d(R,{M:()=>i,x:()=>d});var n=e(74848),a=e(96540),s=e(57866),l=e(92745),o=e(88531);const d=({value:c,context:m,onChange:p})=>{const h=(0,a.useCallback)(r=>{p(r?.length?{id:s.jR.byRefId,options:r}:void 0)},[p]);return(0,n.jsx)(o.XL,{value:c?.options,onChange:h,data:m.data,placeholder:(0,l.t)("geomap.frame-selection-editor.placeholder-change-filter","Change filter")})},i=({value:c,context:m,onChange:p})=>{const h=(0,a.useCallback)(r=>{p(r?.length?{id:s.jR.byRefId,options:(0,o.h)(r)}:void 0)},[p]);return(0,n.jsx)(o.gK,{value:c?.options,onChange:h,data:m.data,placeholder:(0,l.t)("geomap.frame-multi-selection-editor.placeholder-change-filter","Change filter")})}},46831:(Z,R,e)=>{"use strict";e.d(R,{K:()=>p});var n=e(74848),a=e(22803),s=e(70255),l=e(63704),o=e(80011),d=e(63142),i=e(21348);function c({width:r,showImage:g,data:y,index:v}){const x=(0,d.of)(h),f=r>600,u=y.get(v),b=encodeURI(u.title);return(0,n.jsxs)("article",{"aria-labelledby":b,className:(0,a.cx)(x.item,f&&x.itemWide),children:[g&&u.ogImage&&(0,n.jsx)("a",{tabIndex:-1,href:l.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",className:(0,a.cx)(x.socialImage,f&&x.socialImageWide),"aria-hidden":!0,children:(0,n.jsx)("img",{src:u.ogImage,alt:u.title})}),(0,n.jsxs)("div",{className:x.body,children:[(0,n.jsxs)("time",{className:x.date,dateTime:(0,o.LE)(u.date,{format:"MMM DD"}),children:[(0,o.LE)(u.date,{format:"MMM DD"})," "]}),(0,n.jsx)("a",{className:x.link,href:l.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)("h3",{className:x.title,id:b,children:u.title})}),(0,n.jsx)("div",{className:x.content,dangerouslySetInnerHTML:{__html:l.sQ.sanitize(u.content)}})]})]})}const m=({width:r,showImage:g,rootProps:y})=>{const v=(0,d.of)(h),x=r>600;return(0,n.jsxs)("div",{className:(0,a.cx)(v.item,x&&v.itemWide),...y,children:[g&&(0,n.jsx)(s.A,{containerClassName:(0,a.cx)(v.socialImage,x&&v.socialImageWide),width:x?"250px":"100%",height:x?"150px":r*.5}),(0,n.jsxs)("div",{className:v.body,children:[(0,n.jsx)(s.A,{containerClassName:v.date,width:60}),(0,n.jsx)(s.A,{containerClassName:v.title,width:250}),(0,n.jsx)(s.A,{containerClassName:v.content,width:"100%",count:6})]})]})},p=(0,i.j)(c,m),h=r=>({container:(0,a.css)({height:"100%"}),item:(0,a.css)({display:"flex",padding:r.spacing(1),position:"relative",marginBottom:r.spacing(.5),marginRight:r.spacing(1),borderBottom:`2px solid ${r.colors.border.weak}`,background:r.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,a.css)({flexDirection:"row"}),body:(0,a.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,a.css)({display:"flex",alignItems:"center",marginBottom:r.spacing(1),"> img":{width:"100%",borderRadius:`${r.shape.radius.default} ${r.shape.radius.default} 0 0`}}),socialImageWide:(0,a.css)({marginRight:r.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:r.shape.radius.default}}),link:(0,a.css)({color:r.colors.text.link,display:"inline-block","&:hover":{color:r.colors.text.link,textDecoration:"underline"}}),title:(0,a.css)({fontSize:"16px",marginBottom:r.spacing(.5)}),content:(0,a.css)({p:{marginBottom:r.spacing(.5),color:r.colors.text.primary}}),date:(0,a.css)({marginBottom:r.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${r.shape.radius.default}`,color:r.colors.text.secondary})})},73745:(Z,R,e)=>{"use strict";e.d(R,{$:()=>n});const n="https://grafana.com/blog/news.xml"},30054:(Z,R,e)=>{"use strict";e.d(R,{n:()=>r});var n=e(41053),a=e(88673);function s(g){const v=new DOMParser().parseFromString(g,"text/xml");return{items:Array.from(v.querySelectorAll("entry")).map(f=>({title:i(f,"title"),link:f.querySelector("link")?.getAttribute("href")??"",content:i(f,"content"),pubDate:i(f,"published"),ogImage:f.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function l(g){const v=new DOMParser().parseFromString(g,"text/xml");return{items:Array.from(v.querySelectorAll("item")).map(f=>({title:i(f,"title"),link:i(f,"link"),content:i(f,"description"),pubDate:i(f,"pubDate"),ogImage:f.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function o(g){return await(await fetch(g)).text()}function d(g){return new DOMParser().parseFromString(g,"text/xml").querySelector("feed")!==null}function i(g,y){return g.querySelector(y)?.textContent??""}async function c(g){const y=await o(g);return d(y)?s(y):l(y)}var m=e(25229),p=e(95004);function h(g){const y=[],v=[],x=[],f=[],u=[];for(const b of g.items){const E=(0,m.KQ)(b.pubDate);try{if(y.push(E.valueOf()),v.push(b.title),x.push(b.link),u.push(b.ogImage),b.content){const D=b.content.replace(/<\/?[^>]+(>|$)/g,"");f.push(D)}}catch(D){console.warn("Error reading news item:",D,b)}}return{fields:[{name:"date",type:p.PU.time,config:{displayName:"Date"},values:y},{name:"title",type:p.PU.string,config:{},values:v},{name:"link",type:p.PU.string,config:{},values:x},{name:"content",type:p.PU.string,config:{},values:f},{name:"ogImage",type:p.PU.string,config:{},values:u}],length:y.length}}function r(g){const[y,v]=(0,n.A)(async()=>{const x=await c(g),f=h(x);return new a.R(f)},[g],{loading:!0});return{state:y,getNews:v}}},87252:(Z,R,e)=>{"use strict";e.d(R,{L:()=>i,h:()=>c});var n=e(53543),a=e(46644),s=e(16515),l=e(8934),o=e(92745),d=e(739);function i(m,p=!0){const h=[(0,o.t)("stat.add-standard-data-reduce-options.category-value-options","Value options")];m.addRadio({path:"reduceOptions.values",name:(0,o.t)("stat.add-standard-data-reduce-options.name-show","Show"),description:(0,o.t)("stat.add-standard-data-reduce-options.description-show","Calculate a single value per column or series or show each row"),settings:{options:[{value:!1,label:(0,o.t)("stat.add-standard-data-reduce-options.show-options.label-calculate","Calculate")},{value:!0,label:(0,o.t)("stat.add-standard-data-reduce-options.show-options.label-all-values","All values")}]},category:h,defaultValue:!1}),m.addNumberInput({path:"reduceOptions.limit",name:(0,o.t)("stat.add-standard-data-reduce-options.name-limit","Limit"),description:(0,o.t)("stat.add-standard-data-reduce-options.description-limit","Max number of rows to display"),category:h,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:r=>r.reduceOptions.values===!0}),m.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:(0,o.t)("stat.add-standard-data-reduce-options.name-calculation","Calculation"),description:(0,o.t)("stat.add-standard-data-reduce-options.description-calculation","Choose a reducer function / calculation"),category:h,editor:n.D.get("stats-picker").editor,defaultValue:[a.gy.lastNotNull],showIf:r=>r.reduceOptions.values===!1}),p&&m.addSelect({path:"reduceOptions.fields",name:(0,o.t)("stat.add-standard-data-reduce-options.name-fields","Fields"),description:(0,o.t)("stat.add-standard-data-reduce-options.description-fields","Select the fields that should be included in the panel"),category:h,settings:{allowCustomValue:!0,options:[],getOptions:async r=>{const g=[{value:"",label:(0,o.t)("stat.add-standard-data-reduce-options.fields-options.label-numeric-fields","Numeric Fields")},{value:"/.*/",label:(0,o.t)("stat.add-standard-data-reduce-options.fields-options.label-all-fields","All Fields")}];if(r&&r.data)for(const y of r.data)for(const v of y.fields){const x=(0,s.Ct)(v,y,r.data),f=`/^${(0,l.jD)(x)}$/`;g.push({value:f,label:x})}return Promise.resolve(g)}},defaultValue:""})}function c(m,p){m.addRadio({path:"orientation",name:(0,o.t)("stat.add-orientation-option.name-orientation","Orientation"),description:(0,o.t)("stat.add-orientation-option.description-orientation","Layout orientation"),category:p,settings:{options:[{value:d.wV.Auto,label:(0,o.t)("stat.add-orientation-option.orientation-options.label-auto","Auto")},{value:d.wV.Horizontal,label:(0,o.t)("stat.add-orientation-option.orientation-options.label-horizontal","Horizontal")},{value:d.wV.Vertical,label:(0,o.t)("stat.add-orientation-option.orientation-options.label-vertical","Vertical")}]},defaultValue:d.wV.Auto})}},75663:(Z,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var n=e(16207),a=e(92745),s=e(739),l=e(14099),o=e(59795),d=e(64394);const i=(T,O,I)=>{const j=(0,o.gl)(T,O,I);if(I.angular&&(O==="singlestat"||O==="grafana-singlestat-panel")){const W=I.angular;if(j.graphMode=s.$p.None,W.sparkline&&W.sparkline.show&&(j.graphMode=s.$p.Area),W.colorBackground)j.colorMode=s.yp.Background;else if(W.colorValue)j.colorMode=s.yp.Value;else if(j.colorMode=s.yp.None,W.sparkline?.lineColor&&j.graphMode===s.$p.Area){const B=T.fieldConfig??{};B.defaults.color={mode:d.Y.Fixed,fixedColor:W.sparkline.lineColor},T.fieldConfig=B}W.valueName==="name"&&(j.textMode=s.SV.Name)}return j};var c=e(74848),m=e(2543),p=e(96540),h=e(95004),r=e(44232),g=e(60519),y=e(97611),v=e(6399),x=e(33352),f=e(65642);class u extends p.PureComponent{constructor(){super(...arguments),this.renderComponent=(O,I)=>{const{timeRange:j,options:W}=this.props,{value:B,alignmentFactors:S,width:w,height:N,count:M}=O,{openMenu:L,targetClassName:A}=I;let U=B.sparkline;return U&&(U.timeRange=j),(0,c.jsx)(y.yV,{value:B.display,count:M,sparkline:U,colorMode:W.colorMode,graphMode:W.graphMode,justifyMode:W.justifyMode,textMode:this.getTextMode(),alignmentFactors:S,text:W.text,width:w,height:N,theme:f.$W.theme2,onClick:L,className:A,disableWideLayout:!W.wideLayout,percentChangeColorMode:W.percentChangeColorMode})},this.renderValue=O=>{const{value:I}=O,{getLinks:j,hasLinks:W}=I;return W&&j?(0,c.jsx)(v.e,{links:j,children:B=>this.renderComponent(O,B)}):this.renderComponent(O,{})},this.getValues=()=>{const{data:O,options:I,replaceVariables:j,fieldConfig:W,timeZone:B}=this.props;let S;for(let w of O.series)for(let N of w.fields){let{config:M}=N;if(N.type===h.PU.number){if(N.state?.range)continue;!S&&(!(0,m.isNumber)(M.min)||!(0,m.isNumber)(M.max))&&(S=(0,g.nJ)(O.series));const L=M.min??S.min,A=M.max??S.max;N.state=N.state??{},N.state.range={min:L,max:A,delta:A-L}}}return(0,r.PI)({fieldConfig:W,reduceOptions:I.reduceOptions,replaceVariables:j,theme:f.$W.theme2,data:O.series,sparkline:I.graphMode!==s.$p.None,percentChange:I.showPercentChange,timeZone:B})}}getTextMode(){const{options:O,fieldConfig:I,title:j}=this.props;return O.textMode===s.SV.Auto&&(I.defaults.displayName||!j)?s.SV.ValueAndName:O.textMode}render(){const{height:O,options:I,width:j,data:W,renderCounter:B}=this.props;return(0,c.jsx)(x.S,{getValues:this.getValues,getAlignmentFactors:r.XS,renderValue:this.renderValue,width:j,height:O,source:W,itemSpacing:3,renderCounter:B,autoGrid:!0,orientation:I.orientation})}}var b=e(87252);const E={colorMode:s.yp.Value,graphMode:s.$p.Area,justifyMode:s.F8.Auto,percentChangeColorMode:s.CD.Standard,showPercentChange:!1,textMode:s.SV.Auto,wideLayout:!0};var D=e(73495);class C{getSuggestionsForData(O){const{dataSummary:I}=O;if(!I.hasData)return;const j=O.getListAppender({name:D.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:W=>{W.options.reduceOptions.values&&(W.options.reduceOptions.limit=1)}}});I.hasStringField&&I.hasNumberField&&I.frameCount===1&&I.rowCountTotal<10&&(j.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),j.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.Background}})),I.stringFieldCount===1&&I.frameCount===1&&I.rowCountTotal<10&&I.fieldCount===1&&j.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.None}}),I.hasNumberField&&I.hasTimeField&&(j.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),j.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:s.$p.None,colorMode:s.yp.Background}}))}}const P=new n.m(u).useFieldConfig().setPanelOptions(T=>{const O=[(0,a.t)("stat.category-stat-styles","Stat styles")];(0,b.L)(T),(0,b.h)(T,O),l.I(T),T.addSelect({path:"textMode",name:(0,a.t)("stat.name-text-mode","Text mode"),description:(0,a.t)("stat.description-text-mode","Control if name and value is displayed or just name"),category:O,settings:{options:[{value:s.SV.Auto,label:(0,a.t)("stat.text-mode-options.label-auto","Auto")},{value:s.SV.Value,label:(0,a.t)("stat.text-mode-options.label-value","Value")},{value:s.SV.ValueAndName,label:(0,a.t)("stat.text-mode-options.label-value-and-name","Value and name")},{value:s.SV.Name,label:(0,a.t)("stat.text-mode-options.label-name","Name")},{value:s.SV.None,label:(0,a.t)("stat.text-mode-options.label-none","None")}]},defaultValue:E.textMode}).addRadio({path:"wideLayout",name:(0,a.t)("stat.name-wide-layout","Wide layout"),category:O,settings:{options:[{value:!0,label:(0,a.t)("stat.wide-layout-options.label-on","On")},{value:!1,label:(0,a.t)("stat.wide-layout-options.label-off","Off")}]},defaultValue:E.wideLayout,showIf:I=>I.textMode===s.SV.ValueAndName}),T.addSelect({path:"colorMode",name:(0,a.t)("stat.name-color-modcolor-mode-options.label","Color mode"),defaultValue:s.yp.Value,category:O,settings:{options:[{value:s.yp.None,label:(0,a.t)("stat.color-mode-options.label-none","None")},{value:s.yp.Value,label:(0,a.t)("stat.color-mode-options.label-value","Value")},{value:s.yp.Background,label:(0,a.t)("stat.color-mode-options.label-background-gradient","Background Gradient")},{value:s.yp.BackgroundSolid,label:(0,a.t)("stat.color-mode-options.label-background-solid","Background Solid")}]}}).addRadio({path:"graphMode",name:(0,a.t)("stat.name-graph-mode","Graph mode"),description:(0,a.t)("stat.description-graph-mode","Stat panel graph / sparkline mode"),category:O,defaultValue:E.graphMode,settings:{options:[{value:s.$p.None,label:(0,a.t)("stat.graph-mode.options.label-none","None")},{value:s.$p.Area,label:(0,a.t)("stat.graph-mode.options.label-area","Area")}]}}).addRadio({path:"justifyMode",name:(0,a.t)("stat.name-text-alignment","Text alignment"),defaultValue:E.justifyMode,category:O,settings:{options:[{value:s.F8.Auto,label:(0,a.t)("stat.text-alignment-options.label-auto","Auto")},{value:s.F8.Center,label:(0,a.t)("stat.text-alignment-options.label-center","Center")}]}}).addBooleanSwitch({path:"showPercentChange",name:(0,a.t)("stat.name-show-percent-change","Show percent change"),defaultValue:E.showPercentChange,category:O,showIf:I=>!I.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:(0,a.t)("stat.percent-change-color-mode","Percent change color mode"),defaultValue:E.percentChangeColorMode,category:O,settings:{options:[{value:s.CD.Standard,label:(0,a.t)("stat.percent-change-color-mode-options.label-standard","Standard")},{value:s.CD.Inverted,label:(0,a.t)("stat.percent-change-color-mode-options.label-inverted","Inverted")},{value:s.CD.SameAsValue,label:(0,a.t)("stat.percent-change-color-mode-options.label-same-as-value","Same as Value")}]},showIf:I=>I.showPercentChange})}).setNoPadding().setPanelChangeHandler(i).setSuggestionsSupplier(new C).setMigrationHandler(o._$)},17914:(Z,R,e)=>{"use strict";e.d(R,{Z:()=>d});var n=e(74848),a=e(92745),s=e(32881),l=e(77824),o=e(44580);const d=({value:i,onChange:c,item:m})=>{const p=[{label:(0,a.t)("timeseries.insert-nulls-editor.disconnect-options.label-never","Never"),value:!1},{label:(0,a.t)("timeseries.insert-nulls-editor.disconnect-options.label-threshold","Threshold"),value:36e5}],h=typeof i=="number";return p[1].value=h?i:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(l.z,{value:i,options:p,onChange:c}),h&&(0,n.jsx)(o.g,{value:i,onChange:c,inputPrefix:o.F.GreaterThan,isTime:m.settings?.isTime??!1})]})}},32471:(Z,R,e)=>{"use strict";e.d(R,{F:()=>p});var n=e(74848),a=e(96540),s=e(92745),l=e(32881),o=e(77824),d=e(18857),i=e(76319);const c=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(r=>({label:r,value:r})),m=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(r=>({label:r,value:r})),p=({value:r,onChange:g})=>{const y=[{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-solid","Solid"),value:"solid"},{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-dash","Dash"),value:"dash"},{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-dots","Dots"),value:"dot"}],v=(0,a.useMemo)(()=>r?.fill==="dash"?c:m,[r]),x=(0,a.useMemo)(()=>{if(!r?.dash?.length)return v[0];const f=r.dash?.join(", "),u=v.find(b=>b.value===f);return u||{label:f,value:f}},[r,v]);return(0,n.jsxs)(l.Gy,{children:[(0,n.jsx)(o.z,{value:r?.fill||"solid",options:y,onChange:f=>{let u;f==="dot"?u=h(m[0].value):f==="dash"&&(u=h(c[0].value)),g({...r,fill:f,dash:u})}}),r?.fill&&r?.fill!=="solid"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.l6,{allowCustomValue:!0,options:v,value:x,width:20,onChange:f=>{g({...r,dash:h(f.value??"")})},formatCreateLabel:f=>`Segments: ${h(f).join(", ")}`}),(0,n.jsxs)("div",{children:["\xA0",(0,n.jsx)("a",{title:(0,s.t)("timeseries.line-style-editor.title-the-input-expects-a-segment-list","The input expects a segment list"),href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,n.jsx)(i.K,{name:"question-circle",tooltip:(0,s.t)("timeseries.line-style-editor.tooltip-help","Help")})})]})]})]})};function h(r){const g=[];for(const y of r.split(/(?:,| )+/)){const v=Number.parseInt(y,10);isNaN(v)||g.push(v)}return g}},44580:(Z,R,e)=>{"use strict";e.d(R,{F:()=>o,g:()=>d});var n=e(74848),a=e(17548),s=e(92745),l=e(63527),o=(i=>(i.LessThan="lessthan",i.GreaterThan="greaterthan",i))(o||{});const d=({value:i,onChange:c,inputPrefix:m,isTime:p})=>{let h=a.secondsToHms(i/1e3);p||(h="10");const r=x=>{let f=!1;if(x)try{p&&a.isValidTimeSpan(x)?f=a.intervalToMs(x):f=Number(x)}catch(u){console.warn("ERROR",u)}c(f)},g=x=>{x.key==="Enter"&&r(x.currentTarget.value)},y=x=>{r(x.currentTarget.value)},v=m==="greaterthan"?(0,n.jsx)("div",{children:">"}):m==="lessthan"?(0,n.jsx)("div",{children:"<"}):null;return(0,n.jsx)(l.p,{autoFocus:!1,placeholder:(0,s.t)("timeseries.nulls-threshold-input.placeholder-never","Never"),width:10,defaultValue:h,onKeyDown:g,onBlur:y,prefix:v,spellCheck:!1})}},76548:(Z,R,e)=>{"use strict";e.d(R,{e:()=>d});var n=e(74848),a=e(92745),s=e(32881),l=e(77824),o=e(44580);const d=({value:i,onChange:c,item:m})=>{const p=[{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-never","Never"),value:!1},{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-always","Always"),value:!0},{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-threshold","Threshold"),value:36e5}],h=typeof i=="number";return p[2].value=h?i:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(l.z,{value:i,options:p,onChange:c}),h&&(0,n.jsx)(o.g,{value:i,onChange:c,inputPrefix:o.F.LessThan,isTime:m.settings?.isTime??!1})]})}},99709:(Z,R,e)=>{"use strict";e.d(R,{D:()=>l});var n=e(74848),a=e(96540),s=e(18857);const l=({item:o,value:d,onChange:i,id:c})=>{const m=(0,a.useCallback)(p=>{i({mode:p.value})},[i]);return(0,n.jsx)(s.l6,{inputId:c,value:d.mode,options:o.settings?.options??[],onChange:m})}},12241:(Z,R,e)=>{"use strict";e.d(R,{S:()=>v,V:()=>x});var n=e(83340),a=e(64394),s=e(95004),l=e(38809),o=e(92745),d=e(739),i=e(99555),c=e(81082),m=e(44017),p=e(45013),h=e(17914),r=e(32471),g=e(76548),y=e(99709);const v={drawStyle:d.GR.Line,lineInterpolation:d.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:d.on.None,barAlignment:d.Nj.Center,barWidthFactor:.6,stacking:{mode:d.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1};function x(f,u=!0){const b=(0,i.P)(),E=[(0,o.t)("timeseries.config.get-graph-field-config.category-graph-styles","Graph styles")];return{standardOptions:{[n.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:a.Y.PaletteClassic}},[n.uo.Links]:{settings:{showOneClick:!0}},[n.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:D=>{D.addRadio({path:"drawStyle",name:(0,o.t)("timeseries.config.get-graph-field-config.name-style","Style"),category:E,defaultValue:f.drawStyle,settings:{options:b.drawStyle}}).addRadio({path:"lineInterpolation",name:(0,o.t)("timeseries.config.get-graph-field-config.name-line-interpolation","Line interpolation"),category:E,defaultValue:f.lineInterpolation,settings:{options:b.lineInterpolation},showIf:C=>C.drawStyle===d.GR.Line}).addRadio({path:"barAlignment",name:(0,o.t)("timeseries.config.get-graph-field-config.name-bar-alignment","Bar alignment"),category:E,defaultValue:f.barAlignment,settings:{options:b.barAlignment},showIf:C=>C.drawStyle===d.GR.Bars}).addSliderInput({path:"barWidthFactor",name:(0,o.t)("timeseries.config.get-graph-field-config.name-bar-width-factor","Bar width factor"),category:E,defaultValue:f.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:(0,o.t)("timeseries.config.get-graph-field-config.aria-label-bar-width-factor","Bar width factor")},showIf:C=>C.drawStyle===d.GR.Bars}).addSliderInput({path:"lineWidth",name:(0,o.t)("timeseries.config.get-graph-field-config.name-line-width","Line width"),category:E,defaultValue:f.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:(0,o.t)("timeseries.config.get-graph-field-config.aria-label-line-width","Line width")},showIf:C=>C.drawStyle!==d.GR.Points}).addSliderInput({path:"fillOpacity",name:(0,o.t)("timeseries.config.get-graph-field-config.name-fill-opacity","Fill opacity"),category:E,defaultValue:f.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:(0,o.t)("timeseries.config.get-graph-field-config.aria-label-fill-opacity","Fill opacity")},showIf:C=>C.drawStyle!==d.GR.Points}).addRadio({path:"gradientMode",name:(0,o.t)("timeseries.config.get-graph-field-config.name-gradient-mode","Gradient mode"),category:E,defaultValue:b.fillGradient[0].value,settings:{options:b.fillGradient},showIf:C=>C.drawStyle!==d.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:(0,o.t)("timeseries.config.get-graph-field-config.name-fill-below-to","Fill below to"),category:E,hideFromDefaults:!0,settings:{filter:C=>C.type===s.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:(0,o.t)("timeseries.config.get-graph-field-config.name-line-style","Line style"),category:E,showIf:C=>C.drawStyle===d.GR.Line,editor:r.F,override:r.F,process:l.hS,shouldApply:C=>C.type===s.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:(0,o.t)("timeseries.config.get-graph-field-config.name-connect-nulls","Connect null values"),category:E,defaultValue:!1,editor:g.e,override:g.e,showIf:C=>C.drawStyle===d.GR.Line,shouldApply:C=>C.type!==s.PU.time,process:l.hS,settings:{isTime:u}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:(0,o.t)("timeseries.config.get-graph-field-config.name-disconnect-values","Disconnect values"),category:E,defaultValue:!1,editor:h.Z,override:h.Z,showIf:C=>C.drawStyle===d.GR.Line,shouldApply:C=>C.type!==s.PU.time,process:l.hS,settings:{isTime:u}}).addRadio({path:"showPoints",name:(0,o.t)("timeseries.config.get-graph-field-config.name-show-points","Show points"),category:E,defaultValue:b.showPoints[0].value,settings:{options:b.showPoints},showIf:C=>C.drawStyle!==d.GR.Points}).addSliderInput({path:"pointSize",name:(0,o.t)("timeseries.config.get-graph-field-config.name-point-size","Point size"),category:E,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:(0,o.t)("timeseries.config.get-graph-field-config.aria-label-point-size","Point size")},showIf:C=>C.showPoints!==d.yL.Never||C.drawStyle===d.GR.Points}),c.I(D,f.stacking,E),D.addSelect({category:E,name:(0,o.t)("timeseries.config.get-graph-field-config.name-transform","Transform"),path:"transform",settings:{options:[{label:(0,o.t)("timeseries.config.get-graph-field-config.transform-options.label-constant","Constant"),value:d.NU.Constant,description:(0,o.t)("timeseries.config.get-graph-field-config.transform-options.description-constant","The first value will be shown as a constant line")},{label:(0,o.t)("timeseries.config.get-graph-field-config.transform-options.label-style","Negative Y"),value:d.NU.NegativeY,description:(0,o.t)("timeseries.config.get-graph-field-config.transform-options.description-style","Flip the results to negative values on the y axis")}],isClearable:!0},hideFromDefaults:!0}),m.rg(D,f),p.e(D),D.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:(0,o.t)("timeseries.config.get-graph-field-config.name-show-thresholds","Show thresholds"),category:[(0,o.t)("timeseries.config.get-graph-field-config.category-thresholds","Thresholds")],defaultValue:{mode:d.Ly.Off},settings:{options:b.thresholdsDisplayModes},editor:y.D,override:y.D,process:l.hS,shouldApply:()=>!0})}}}},39799:(Z,R,e)=>{"use strict";e.d(R,{jK:()=>Jt,kz:()=>ln});var n=e(74848),a=e(96540),s=e(54148),l=e(28105),o=e(22803),d=e(63142),i=e(13791),c=e(45776),m=e(21234);function p({navId:Rt,header:bt}){const{node:Vt}=(0,c.C)(Rt),Kt=(0,d.of)(h),Dt=Vt.children?.filter(Zt=>!Zt.hideFromTabs);return(0,n.jsx)(i.Y,{navId:Vt.id,children:(0,n.jsx)(i.Y.Contents,{children:(0,n.jsxs)("div",{className:Kt.content,children:[bt,Dt&&Dt.length>0&&(0,n.jsx)("section",{className:Kt.grid,children:Dt?.map(Zt=>(0,n.jsx)(m.I,{description:Zt.subTitle,text:Zt.text,url:Zt.url??""},Zt.id))})]})})})}const h=Rt=>({content:(0,o.css)({display:"flex",flexDirection:"column",gap:Rt.spacing(2)}),grid:(0,o.css)({display:"grid",gap:Rt.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:Rt.spacing(2,0)})});var r=e(86678),g=e(65642),y=e(15130),v=e(49785),x=e(71468),f=e(92745),u=e(62061),b=e(41654),E=e(34999),D=e(37386),C=e(63527),P=e(45861),T=e(73427),O=e(11257),I=e(96221),j=e(74267),W=e(45967),B=e(30703),S=e(66404),w=e(27594);const N=({ldapConnectionInfo:Rt})=>{const bt=(0,a.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:Kt=>Kt.cell.value?(0,n.jsx)(b.B,{justifyContent:"end",children:(0,n.jsx)(W.m,{content:(0,f.t)("admin.ldap-connection-status.columns.content-connection-is-available","Connection is available"),children:(0,n.jsx)(B.I,{name:"check"})})}):(0,n.jsx)(b.B,{justifyContent:"end",children:(0,n.jsx)(W.m,{content:(0,f.t)("admin.ldap-connection-status.columns.content-connection-is-not-available","Connection is not available"),children:(0,n.jsx)(B.I,{name:"exclamation-triangle"})})})}],[]),Vt=(0,a.useMemo)(()=>Rt,[Rt]);return(0,n.jsx)("section",{children:(0,n.jsxs)(b.B,{direction:"column",gap:2,children:[(0,n.jsx)(S.E,{color:"primary",element:"h3",children:(0,n.jsx)(f.x6,{i18nKey:"admin.ldap-status.title",children:"LDAP Connection"})}),(0,n.jsx)(w.j,{data:Vt,columns:bt,getRowId:Kt=>Kt.host+Kt.port}),(0,n.jsx)(M,{ldapConnectionInfo:Rt})]})})},M=({ldapConnectionInfo:Rt})=>{if(!Rt.some(Dt=>Dt.error))return null;const Vt=[];Rt.forEach(Dt=>{Dt.error&&Vt.push(Dt)});const Kt=Vt.map((Dt,Zt)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{style:{fontWeight:500},children:[`${Dt.host}:${Dt.port}`,(0,n.jsx)("br",{})]}),(0,n.jsx)("span",{children:Dt.error}),Zt!==Vt.length-1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})]},Zt));return(0,n.jsx)(E.F,{title:(0,f.t)("admin.ldap-error-box.title-connection-error","Connection error"),severity:I.Qd.Error,children:Kt})};var L=e(80011);const A="dddd YYYY-MM-DD HH:mm zz",U=({ldapSyncInfo:Rt})=>{const bt=(0,L.LE)(Rt.nextSync,{format:A}),Vt=[{id:"syncAttribute"},{id:"syncValue"}],Kt=[{syncAttribute:"Active synchronization",syncValue:Rt.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:Rt.schedule},{syncAttribute:"Next synchronization",syncValue:bt}];return(0,n.jsxs)("section",{children:[(0,n.jsx)(S.E,{element:"h3",children:(0,n.jsx)(f.x6,{i18nKey:"admin.ldap-sync-info.title",children:"LDAP Synchronization"})}),(0,n.jsx)(w.j,{data:Kt,columns:Vt,getRowId:Dt=>Dt.syncAttribute})]})};var F=e(31286);const V=({groups:Rt})=>{const bt=(0,a.useMemo)(()=>Rt,[Rt]),Vt=(0,a.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:Kt=>Kt.value&&Kt.row.original.orgRole?Kt.value:""},{id:"orgRole",header:"Role",cell:Kt=>Kt.value||(0,n.jsxs)(b.B,{alignItems:"center",wrap:!0,children:[(0,n.jsx)(f.x6,{i18nKey:"admin.ldap-user-groups.no-org-found",children:"No match"}),(0,n.jsx)(W.m,{content:(0,f.t)("admin.ldap-user-groups.columns.content-no-matching-organizations-found","No matching organizations found"),children:(0,n.jsx)(B.I,{name:"info-circle"})})]})}],[]);return(0,n.jsx)(w.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:Vt,data:bt,getRowId:Kt=>Kt.orgId+Kt.orgRole+Kt.groupDN})},K=({info:Rt})=>{const bt=(0,a.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),Vt=(0,a.useMemo)(()=>[{userInfo:"First name",ldapValue:Rt.name.ldapValue,cfgAttrValue:Rt.name.cfgAttrValue},{userInfo:"Surname",ldapValue:Rt.surname.ldapValue,cfgAttrValue:Rt.surname.cfgAttrValue},{userInfo:"Username",ldapValue:Rt.login.ldapValue,cfgAttrValue:Rt.login.cfgAttrValue},{userInfo:"Email",ldapValue:Rt.email.ldapValue,cfgAttrValue:Rt.email.cfgAttrValue}],[Rt]);return(0,n.jsx)(w.j,{columns:bt,data:Vt,getRowId:Kt=>Kt.userInfo})},G=({permissions:Rt})=>{const bt=(0,a.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),Vt=(0,a.useMemo)(()=>[{permission:"Grafana admin",value:Rt.isGrafanaAdmin?(0,n.jsxs)(f.x6,{i18nKey:"admin.ldap-permissions.admin",children:[(0,n.jsx)(B.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:Rt.isDisabled?(0,n.jsxs)(f.x6,{i18nKey:"admin.ldap-permissions.inactive",children:[(0,n.jsx)(B.I,{name:"times"})," Inactive"]}):(0,n.jsxs)(f.x6,{i18nKey:"admin.ldap-permissions.active",children:[(0,n.jsx)(B.I,{name:"check"})," Active"]})}],[Rt]);return(0,n.jsx)(w.j,{data:Vt,columns:bt,getRowId:Kt=>Kt.permission})},H=({teams:Rt})=>{const bt=(0,a.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:Vt}}})=>(0,n.jsx)(n.Fragment,{children:Vt||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:Vt,orgName:Kt}}})=>Vt&&Kt?Vt:""}],[]);return(0,n.jsx)(w.j,{data:Rt,columns:bt,getRowId:Vt=>Vt.teamName})},_=({ldapUser:Rt})=>(0,n.jsxs)(b.B,{direction:"column",gap:4,children:[(0,n.jsx)(K,{info:Rt.info}),(0,n.jsx)(G,{permissions:Rt.permissions}),Rt.roles&&Rt.roles.length>0&&(0,n.jsx)(V,{groups:Rt.roles}),Rt.teams&&Rt.teams.length>0?(0,n.jsx)(H,{teams:Rt.teams}):(0,n.jsx)(F.a,{children:(0,n.jsx)(S.E,{children:(0,n.jsx)(f.x6,{i18nKey:"admin.ldap-user-info.no-team",children:"No teams found via LDAP"})})})]}),k={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},J=({clearUserMappingInfo:Rt,queryParams:bt,loadLdapState:Vt,loadLdapSyncStatus:Kt,loadUserMapping:Dt,clearUserError:Zt,ldapUser:Ln,userError:Qn,ldapError:va,ldapSyncInfo:Wn,ldapConnectionInfo:ia})=>{const[kn,na]=(0,a.useState)(!0),{register:Ga,handleSubmit:Ps}=(0,v.mN)(),ls=(0,a.useCallback)(async Os=>Dt(Os),[Dt]);(0,a.useEffect)(()=>{const Os=async()=>Promise.all([Vt(),Kt()]);async function Zs(){await Rt(),await Os(),bt.username&&await ls(bt.username),na(!1)}Zs()},[Rt,ls,Vt,Kt,bt]);const Ta=({username:Os})=>{Os&&ls(Os)},aa=()=>{Zt()},Gs=T.TP.hasPermission(O.w.LDAPUsersRead);return(0,n.jsx)(i.Y,{navId:"authentication",pageNav:k,children:(0,n.jsx)(i.Y.Contents,{isLoading:kn,children:(0,n.jsxs)(b.B,{direction:"column",gap:4,children:[va&&va.title&&(0,n.jsx)(E.F,{title:va.title,severity:I.Qd.Error,children:va.body}),(0,n.jsx)(N,{ldapConnectionInfo:ia}),(0,u.a)("ldapsync")&&Wn&&(0,n.jsx)(U,{ldapSyncInfo:Wn}),Gs&&(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{children:(0,n.jsx)(f.x6,{i18nKey:"admin.ldap.test-mapping-heading",children:"Test user mapping"})}),(0,n.jsx)("form",{onSubmit:Ps(Ta),children:(0,n.jsx)(D.D,{label:(0,f.t)("admin.ldap-page.label-username","Username"),children:(0,n.jsx)(C.p,{...Ga("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:bt.username,addonAfter:(0,n.jsx)(P.$n,{variant:"primary",type:"submit",children:(0,n.jsx)(f.x6,{i18nKey:"admin.ldap.test-mapping-run-button",children:"Run"})})})})}),Qn&&Qn.title&&(0,n.jsx)(E.F,{title:Qn.title,severity:I.Qd.Error,onRemove:aa,children:Qn.body}),Ln&&(0,n.jsx)(_,{ldapUser:Ln})]})]})})})},z=Rt=>({ldapConnectionInfo:Rt.ldap.connectionInfo,ldapUser:Rt.ldap.user,ldapSyncInfo:Rt.ldap.syncInfo,userError:Rt.ldap.userError,ldapError:Rt.ldap.ldapError}),Y={loadLdapState:j.JI,loadLdapSyncStatus:j.pm,loadUserMapping:j.Kg,clearUserError:j.DX,clearUserMappingInfo:j.Jc},Q=(0,x.connect)(z,Y)(J),q=Rt=>(0,a.lazy)(Rt);var te=e(76070),ne=e(66513),se=e(88114),ue=e(17349),de=e(74869),ie=e(54);function he(Rt=g.$W){return[{path:"/alerting",component:me(()=>Promise.all([e.e(7848),e.e(3236)]).then(e.bind(e,27848)))},{path:"/alerting/home",component:me(()=>Promise.all([e.e(7848),e.e(3236)]).then(e.bind(e,27848)))},{path:"/alerting/list",roles:(0,ie.C0)([O.w.AlertingRuleRead,O.w.AlertingRuleExternalRead]),component:me(()=>Promise.all([e.e(1851),e.e(3511)]).then(e.bind(e,91851)))},{path:"/alerting/routes",roles:(0,ie.C0)([O.w.AlertingNotificationsRead,O.w.AlertingNotificationsExternalRead,...se.rw,...se.nv,...ne.xK,...ne.Zr]),component:me(()=>Promise.all([e.e(9360),e.e(1909)]).then(e.bind(e,19726)))},{path:"/alerting/routes/mute-timing/new",roles:(0,ie.C0)([O.w.AlertingNotificationsWrite,O.w.AlertingNotificationsExternalWrite,...ne.Zr]),component:me(()=>Promise.all([e.e(3192),e.e(8302)]).then(e.bind(e,35388)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,ie.C0)([O.w.AlertingNotificationsWrite,O.w.AlertingNotificationsExternalWrite,...ne.xK,...ne.Zr]),component:me(()=>Promise.all([e.e(3192),e.e(558)]).then(e.bind(e,9334)))},{path:"/alerting/silences",roles:(0,ie.C0)([O.w.AlertingInstanceRead,O.w.AlertingInstancesExternalRead,O.w.AlertingSilenceRead]),component:me(()=>e.e(1668).then(e.bind(e,46627)))},{path:"/alerting/silence/new",roles:(0,ie.C0)([O.w.AlertingInstanceCreate,O.w.AlertingInstancesExternalWrite,O.w.AlertingSilenceCreate,O.w.AlertingSilenceUpdate]),component:me(()=>e.e(1649).then(e.bind(e,29668)))},{path:"/alerting/silence/:id/edit",component:me(()=>Promise.resolve().then(e.bind(e,24158)))},{path:"/alerting/notifications",roles:(0,ie.C0)([O.w.AlertingNotificationsRead,O.w.AlertingNotificationsExternalRead,...te.w6,...ue.X]),component:me(()=>e.e(4312).then(e.bind(e,46787)))},{path:"/alerting/notifications/receivers/new",roles:(0,ie.C0)([O.w.AlertingNotificationsRead,O.w.AlertingNotificationsExternalRead,...te.w6]),component:me(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8622),e.e(3167)]).then(e.bind(e,15274)))},{path:"/alerting/notifications/receivers/:name/edit",roles:(0,ie.C0)([O.w.AlertingNotificationsWrite,O.w.AlertingNotificationsExternalWrite,O.w.AlertingNotificationsRead,O.w.AlertingNotificationsExternalRead,...te.w6]),component:me(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8622),e.e(6877)]).then(e.bind(e,29617)))},{path:"/alerting/notifications/templates/*",roles:(0,ie.C0)([O.w.AlertingNotificationsRead,O.w.AlertingNotificationsExternalRead,...ue.X]),component:me(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(9224)]).then(e.bind(e,7070)))},{path:"/alerting/notifications/global-config",roles:(0,ie.C0)([O.w.AlertingNotificationsWrite,O.w.AlertingNotificationsExternalWrite]),component:me(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8504)]).then(e.bind(e,19644)))},{path:"/alerting/groups/",roles:(0,ie.C0)([O.w.AlertingInstanceRead,O.w.AlertingInstancesExternalRead]),component:me(()=>e.e(8427).then(e.bind(e,13549)))},{path:"/alerting/history/",roles:(0,ie.C0)([O.w.AlertingRuleRead]),component:me(()=>Promise.all([e.e(8706),e.e(4302),e.e(44)]).then(e.bind(e,56102)))},{path:"/alerting/recently-deleted/",roles:()=>["Admin"],component:(0,de.f2)()?me(()=>e.e(3734).then(e.bind(e,75174))):()=>(0,n.jsx)(s.C5,{replace:!0,to:"/alerting/list"})},{path:"/alerting/import-datasource-managed-rules",roles:()=>["Admin"],component:g.$W.featureToggles.alertingMigrationUI?me(()=>e.e(9886).then(e.bind(e,45097))):()=>(0,n.jsx)(s.C5,{replace:!0,to:"/alerting/list"})},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleCreate,O.w.AlertingRuleExternalWrite]),component:me(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,23878)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleUpdate,O.w.AlertingRuleExternalWrite]),component:me(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,23878)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead]),component:me(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,28124)))},{path:"/alerting/export-new-rule",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead]),component:me(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,87144)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead,O.w.AlertingRuleExternalRead]),component:me(()=>Promise.resolve().then(e.bind(e,28390)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead,O.w.AlertingRuleExternalRead]),component:me(()=>e.e(5516).then(e.bind(e,15102)))},{path:"/alerting/:dataSourceUid/namespaces/:namespaceId/groups/:groupName/view",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead,O.w.AlertingRuleExternalRead]),component:me(()=>Promise.all([e.e(4162),e.e(3196)]).then(e.bind(e,12003)))},{path:"/alerting/:dataSourceUid/namespaces/:namespaceId/groups/:groupName/edit",pageClass:"page-alerting",roles:(0,ie.C0)([O.w.AlertingRuleRead,O.w.AlertingRuleExternalRead]),component:me(()=>Promise.all([e.e(4656),e.e(6102)]).then(e.bind(e,56638)))},{path:"/alerting/admin",roles:()=>["Admin"],component:()=>(0,n.jsx)(s.C5,{replace:!0,to:"/alerting/admin/alertmanager"})},{path:"/alerting/admin/alertmanager",roles:()=>["Admin"],component:me(()=>e.e(9438).then(e.bind(e,95627)))}]}function me(Rt){const bt=()=>e.e(9029).then(e.bind(e,31642));return q(g.$W.unifiedAlertingEnabled?Rt:bt)}var ce=e(77256),Pe=e(26437);const Ie=Rt=>({alertContent:(0,o.css)({display:"flex",flexDirection:"row",padding:0,justifyContent:"space-between",alignItems:"center"}),alertParagraph:(0,o.css)({margin:Rt.spacing(0,1,0,0),lineHeight:Rt.spacing(Rt.components.height.sm)})});function Se(){const Rt=(0,d.of)(Ie),bt=T.TP.hasPermission(O.w.DataSourcesCreate)||T.TP.hasPermission(O.w.DataSourcesWrite),[Vt,Kt]=(0,a.useState)(bt);return Vt?(0,n.jsx)(E.F,{severity:"info",title:"",onRemove:()=>Kt(!1),children:(0,n.jsxs)("div",{className:Rt.alertContent,children:[(0,n.jsx)("p",{className:Rt.alertParagraph,children:(0,n.jsx)(f.x6,{i18nKey:"connections.connections-redirect-notice.body",children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."})}),(0,n.jsx)(P.z9,{"aria-label":(0,f.t)("connections.connections-redirect-notice.aria-label-link-to-connections","Link to Connections"),icon:"arrow-right",href:Pe.b.DataSources,fill:"text",children:(0,n.jsx)(f.x6,{i18nKey:"connections.connections-redirect-notice.go-to-connections",children:"Go to connections"})})]})}):(0,n.jsx)(n.Fragment,{})}function Me(){return[{path:`/${Pe.q}/*`,component:q(()=>Promise.all([e.e(8354),e.e(362),e.e(6436),e.e(1308),e.e(906),e.e(2154)]).then(e.bind(e,8525)))}]}var Te=e(37946),Ge=e(20962),Qe=e(52161),tt=e(27489),ke=(Rt=>(Rt.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",Rt.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",Rt.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",Rt.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",Rt))(ke||{});function He(Rt,bt){(0,tt.rR)(Rt,{...bt})}var Re=e(36490),Ne=e(97507),Ae=e(46202),Ue=e(182),Be=e(92367),We=e(70327),_e=e(6135),Xe=e(44109);function le(){const[Rt,{data:bt,isLoading:Vt}]=We.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:Kt,isLoadingDsFeatures:Dt}=(0,Xe.O3)(Qe.hY),Zt=Kt?.rulerConfig;return(0,a.useEffect)(()=>{Zt&&Rt({rulerConfig:Zt})},[Zt,Rt]),{isDone:(bt?Object.entries(bt).flatMap(([va,Wn])=>Wn.flatMap(ia=>ia.rules)):[]).length>0,isLoading:Vt||Dt}}function ye(Rt){return Rt.some(bt=>bt.grafana_managed_receiver_configs?.some(Vt=>Vt.type===_e.J4.OnCall))}const pe="<example@email.com>";function ve(Rt,bt){const Vt=bt.find(Kt=>Kt.name===Rt);return Vt?Vt.grafana_managed_receiver_configs?.some(Kt=>Kt.type==="email"?Kt.settings?.addresses!==pe:!0):!1}var be=e(5709);const Oe=Rt=>`/api/plugins/${(0,Ue.Wx)()}/resources${Rt}`,we=be.H.injectEndpoints({endpoints:Rt=>({getIncidentsPluginConfig:Rt.query({query:()=>({url:Oe("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var ze=e(3986);function Ve(){const{installed:Rt,loading:bt}=(0,ze._)((0,Ue.Wx)()),{data:Vt,isLoading:Kt}=we.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:Rt??!1,isChatOpsInstalled:Vt?.isChatOpsInstalled??!1,isIncidentCreated:Vt?.isIncidentCreated??!1,isLoading:bt||Kt}}var ge=e(77788);function Ke(){const{installed:Rt}=(0,ze._)((0,Ue.BO)()),{data:bt}=ge.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!Rt,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return bt??[]}function qe(){const{data:Rt,isLoading:bt}=ge.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:bt,onCallConfigChecks:Rt??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function ot(){return Ke().map(bt=>({label:bt.display_name,value:bt.value}))}function lt(){const{onCallConfigChecks:{is_chatops_connected:Rt,is_integration_chatops_connected:bt},isLoading:Vt}=qe();return{is_chatops_connected:Rt,is_integration_chatops_connected:bt,isLoading:Vt}}var mt=e(2869);const Lt=`/api/plugins/${mt.W.Slo}/resources/v1`,Tt=be.H.injectEndpoints({endpoints:Rt=>({getSlos:Rt.query({query:()=>({url:`${Lt}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function It(){const{installed:Rt}=(0,ze._)(mt.W.Slo),{data:bt,isLoading:Vt}=Tt.endpoints.getSlos.useQuery(void 0,{skip:!Rt,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:Vt,hasSlo:!!bt?.slos.length,hasSloWithAlert:!!bt?.slos?.some(Kt=>Kt.alerting)}}function Mt(){const{contactPoints:Rt,isLoading:bt}=(0,Ne.Z3)(),{data:Vt,isLoading:Kt}=(0,Ae.yV)({alertmanager:Qe.hY}),Dt=Vt?.[0].receiver||"",{isDone:Zt,isLoading:Ln}=le(),{isChatOpsInstalled:Qn,isInstalled:va,isLoading:Wn}=Ve(),ia=ot(),{is_chatops_connected:kn,is_integration_chatops_connected:na,isLoading:Ga}=lt(),{hasSlo:Ps,hasSloWithAlert:ls,isLoading:Ta}=It();return{alerting:{contactPoints:Rt,defaultContactpoint:Dt,isCreateAlertRuleDone:Zt},incidents:{isChatOpsInstalled:Qn,isIncidentsInstalled:va},onCall:{onCallOptions:ia,is_chatops_connected:kn,is_integration_chatops_connected:na},slo:{hasSlo:Ps,hasSloWithAlert:ls},isLoading:bt||Kt||Ln||Wn||Ga||Ta}}function Ut(){const{alerting:{contactPoints:Rt,defaultContactpoint:bt,isCreateAlertRuleDone:Vt},incidents:{isChatOpsInstalled:Kt,isIncidentsInstalled:Dt},onCall:{onCallOptions:Zt,is_chatops_connected:Ln,is_integration_chatops_connected:Qn},slo:{hasSlo:va,hasSloWithAlert:Wn},isLoading:ia}=Mt();function kn(Ta,aa){const Gs=(0,Be.G)(`${aa} + ${Ta}`,{returnTo:window.location.pathname+window.location.search});Re.Ny.push(Gs)}function na(){let Ta=[{title:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.steps.title.update-default-contact-point","Update default contact point"),description:"Update the default contact point to a method other than the example email address.",button:{type:"openLink",urlLink:{url:"/alerting/notifications",queryParams:{search:bt,alertmanager:"grafana"}},label:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.steps.label.edit","Edit"),labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:ve(bt,Rt)}];return(0,Ue.ZP)()||(Ta=[...Ta,{title:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.connect-alerting-to-on-call","Connect alerting to OnCall"),description:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-on-call-integration-alerting-contact-point","Create an OnCall integration for an alerting contact point."),button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.connect","Connect"),urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:ye(Rt)}]),Ta=[...Ta,{title:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.create-alert-rule","Create alert rule"),description:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-alert-monitor-system","Create an alert rule to monitor your system."),button:{type:"openLink",urlLink:{url:"/alerting/new"},label:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.create","Create"),urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:Vt},{title:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.create-slo","Create SLO"),description:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-slos-to-monitor-your-service","Create SLOs to monitor your service."),button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.create","Create"),urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:va},{title:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.enable-slo-alerting","Enable SLO alerting"),description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:(0,f.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.enable","Enable"),urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:Wn}],Ta}const Ga={sections:[{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.detect","Detect"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.configure-grafana-alerting","Configure Grafana Alerting"),steps:na()},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.respond","Respond"),description:(0,Ue.ZP)()?"Configure IRM":"Configure OnCall and Incident",steps:(0,Ue.ZP)()?[{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.connect-alerting-to-irm","Connect alerting to IRM"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.create-integration-alerting-contact-point","Create an IRM integration for an alerting contact point."),button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:ye(Rt)},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.connect-irm-to-your-slack-workspace","Connect IRM to your Slack workspace"),description:"Receive alerts and oncall notifications, or automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.Wx)()}/integrations/apps/grate.irm.slack`},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Ue.Wx)()}/integrations`}},done:Kt},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.add-slack-notifications-to-irm-integrations","Add Slack notifications to IRM integrations"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.select-chat-ops-channels-to-route-notifications","Select ChatOps channels to route notifications"),button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.BO)()}/integrations/`},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.add","Add"),urlLinkOnDone:{url:`/a/${(0,Ue.BO)()}/integrations/`},labelOnDone:"View"},done:Qn}]:[{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.initialize-incident-plugin","Initialize Incident plugin"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.initialize-incident-plugin-declare-manage-incidents","Initialize the Incident plugin to declare and manage incidents."),button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.Wx)()}/walkthrough/generate-key`},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.initialize","Initialize"),urlLinkOnDone:{url:`/a/${(0,Ue.Wx)()}`},labelOnDone:"View"},done:Dt},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.connect-your-messaging-workspace-to-on-call","Connect your Messaging workspace to OnCall"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.receive-alerts-oncall-notifications-within-environment","Receive alerts and oncall notifications within your chat environment."),button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.BO)()}/settings`,queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Ue.BO)()}/settings`,queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Ln},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.connect-your-messaging-workspace-to-incident","Connect your Messaging workspace to Incident"),description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.Wx)()}/integrations/grate.slack`},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Ue.Wx)()}/integrations`}},done:Kt},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.messaging-workspace-channel-on-call-integration","Add Messaging workspace channel to OnCall Integration"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.select-chat-ops-channels-to-route-notifications","Select ChatOps channels to route notifications"),button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.BO)()}/integrations/`},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.add","Add"),urlLinkOnDone:{url:`/a/${(0,Ue.BO)()}/integrations/`},labelOnDone:"View"},done:Qn}]},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.test-your-configuration","Test your configuration"),description:"",steps:[{title:(0,Ue.ZP)()?"Send test alert":"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.select-integration","Select integration"),options:Zt,onClickOption:Ta=>kn(Ta,`/a/${(0,Ue.BO)()}/integrations/`),stepNotAvailableText:"No integrations available"}},{title:(0,f.t)("gops.use-get-essentials-configuration.essential-content.title.create-incident-drill","Create Incident drill"),description:(0,f.t)("gops.use-get-essentials-configuration.essential-content.description.practice-solving-an-incident","Practice solving an Incident"),button:{type:"openLink",urlLink:{url:`/a/${(0,Ue.Wx)()}`,queryParams:{declare:"new",drill:"1"}},label:(0,f.t)("gops.use-get-essentials-configuration.essential-content.label.start-drill","Start drill")}}]}]},{stepsDone:Ps,totalStepsToDo:ls}=Ga.sections.reduce((Ta,aa)=>{const Gs=aa.steps.filter(Zs=>Zs.done).length,Os=aa.steps.reduce((Zs,lr)=>lr.done!==void 0?Zs+1:Zs,0);return{stepsDone:Ta.stepsDone+Gs,totalStepsToDo:Ta.totalStepsToDo+Os}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Ga,stepsDone:Ps,totalStepsToDo:ls,isLoading:ia}}const an=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:Rt},essentialsConfigurationData:{stepsDone:bt,totalStepsToDo:Vt}})=>(0,a.useMemo)(()=>{function Kt(){const Dt=Rt?"You have connected a datasource.":"Connect at least one data source to start receiving data",Zt=Rt?"View":"Connect";return{id:In.CONNECT_DATASOURCE,title:(0,f.t)("gops.use-get-configuration-for-ui.get-connect-data-source-configuration.title.connect-data-source","Connect data source"),description:Dt,actionButtonTitle:Zt,isDone:Rt}}return[Kt(),{id:In.ESSENTIALS,title:(0,f.t)("gops.use-get-configuration-for-ui.title.essentials","Essentials"),titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:bt===Vt?"View":"Configure",stepsDone:bt,totalStepsToDo:Vt}]},[Rt,bt,Vt]);var cn=e(6975);function un({stepsDone:Rt,totalStepsToDo:bt}){const Vt=(0,d.of)(yn);return bt===0?null:(0,n.jsx)("div",{className:Vt.containerStyles,role:"progressbar","aria-valuenow":Rt,"aria-valuemax":bt,children:(0,n.jsx)("div",{className:Vt.fillerStyles(Rt/bt*100)})})}function On({stepsDone:Rt,totalStepsToDo:bt}){return(0,n.jsx)("span",{children:(0,n.jsxs)(f.x6,{i18nKey:"gops.progress-bar.steps-status",values:{stepsDone:Rt},children:[(0,n.jsx)(S.E,{color:"success",children:"{{stepsDone}}"})," of ",{totalStepsToDo:bt}]})})}function yn(Rt){return{containerStyles:(0,o.css)({height:Rt.spacing(2),borderRadius:Rt.shape.radius.pill,backgroundColor:Rt.colors.border.weak,flex:"auto"}),fillerStyles:bt=>(0,o.css)({height:"100%",width:`${bt}%`,backgroundColor:Rt.colors.success.main,borderRadius:Rt.shape.radius.pill,textAlign:"right"})}}function En({config:Rt,handleActionClick:bt,isLoading:Vt=!1}){const Kt=(0,d.of)(Bn);return(0,n.jsx)(b.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,n.jsxs)("div",{className:Kt.cardContent,children:[(0,n.jsxs)(b.B,{direction:"column",gap:1,children:[(0,n.jsxs)(b.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,n.jsx)("div",{className:"fs-unmask",children:(0,n.jsxs)(b.B,{direction:"row",gap:1,alignItems:"center",children:[Rt.title,Rt.titleIcon&&(0,n.jsx)(B.I,{name:Rt.titleIcon}),Rt.isDone&&!Vt&&(0,n.jsx)(B.I,{name:"check-circle",color:"green",size:"lg"})]})}),Rt.stepsDone&&Rt.totalStepsToDo&&!Vt&&(0,n.jsx)("div",{className:"fs-unmask",children:(0,n.jsxs)(b.B,{direction:"row",gap:.5,children:[(0,n.jsx)(On,{stepsDone:Rt.stepsDone,totalStepsToDo:Rt.totalStepsToDo}),(0,n.jsx)(f.x6,{i18nKey:"configuration-tracker.config-card.complete",children:"complete"})]})})]}),(0,n.jsxs)(b.B,{direction:"column",children:[Vt?(0,n.jsx)(cn._,{text:(0,f.t)("gops.config-card.text-loading-configuration","Loading configuration....")}):Rt.description,!Vt&&Rt.stepsDone&&Rt.totalStepsToDo&&(0,n.jsx)(un,{stepsDone:Rt.stepsDone,totalStepsToDo:Rt.totalStepsToDo})]})]}),(0,n.jsx)(b.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,n.jsx)(P.$n,{variant:"secondary",onClick:()=>bt(Rt.id,Rt.isDone),className:"fs-unmask",children:Rt.actionButtonTitle})})]})})}const Bn=Rt=>({cardTitle:(0,o.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,o.css)({background:Rt.colors.background.secondary,padding:Rt.spacing(2),borderRadius:Rt.shape.radius.default,height:"100%",gap:Rt.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var fa=e(8207),Fn=e(88559),Ea=e(87063);function gt({onClose:Rt,essentialsConfig:bt,stepsDone:Vt,totalStepsToDo:Kt}){return(0,n.jsx)(fa._,{title:(0,f.t)("gops.essentials.title-essentials","Essentials"),subtitle:"Complete the following configuration tasks",onClose:Rt,children:(0,n.jsx)(Ht,{essentialContent:bt,stepsDone:Vt,totalStepsToDo:Kt})})}function Ht({essentialContent:Rt,stepsDone:bt,totalStepsToDo:Vt}){return(0,n.jsxs)(b.B,{direction:"column",gap:1,children:[(0,n.jsx)(pn,{stepsDone:bt,totalStepsToDo:Vt}),Rt.sections.map(Kt=>(0,n.jsx)(wt,{section:Kt},Kt.title))]})}function wt({section:Rt}){const bt=(0,d.of)(Un);return(0,n.jsxs)("div",{className:bt.wrapper,children:[(0,n.jsx)(S.E,{element:"h4",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.title})}),(0,n.jsx)(S.E,{color:"secondary",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.description})}),(0,n.jsx)(b.B,{direction:"column",gap:2,children:Rt.steps.map((Vt,Kt)=>(0,n.jsx)(rn,{step:Vt},Kt))})]})}function Yt({done:Rt}){return Rt?(0,n.jsx)(B.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,n.jsx)(B.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function rn({step:Rt}){return(0,n.jsxs)(b.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,n.jsxs)(b.B,{direction:"row",alignItems:"center",children:[Rt.done!==void 0&&(0,n.jsx)(Yt,{done:Rt.done}),(0,n.jsx)(S.E,{variant:"body",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.title})}),(0,n.jsx)(W.m,{content:Rt.description,placement:"right",children:(0,n.jsx)(B.I,{name:"question-circle"})})]}),(0,n.jsx)(on,{...Rt.button,done:Rt.done,"data-testid":"step-button"})]})}function Xt(Rt){const{urlLink:bt,label:Vt,urlLinkOnDone:Kt,labelOnDone:Dt,done:Zt}=Rt,Ln=bt?.url?(0,Be.G)(bt.url,{returnTo:window.location.pathname+window.location.search,...bt.queryParams}):"",Qn=Kt?.url?(0,Be.G)(Kt.url,{returnTo:window.location.pathname+window.location.search,...Kt.queryParams}):"",va=Zt?Qn:Ln;return(0,n.jsx)(P.z9,{href:va,variant:"secondary",className:"fs-unmask",children:Zt?Dt??Vt:Vt})}function on({type:Rt,urlLink:bt,urlLinkOnDone:Vt,label:Kt,labelOnDone:Dt,options:Zt,onClickOption:Ln,done:Qn,stepNotAvailableText:va}){switch(Rt){case"openLink":return(0,n.jsx)(Xt,{urlLink:bt,label:Kt,urlLinkOnDone:Vt,labelOnDone:Dt,done:Qn});case"dropDown":return Zt?.length?(0,n.jsx)(Fn.m,{overlay:(0,n.jsx)(Ea.W,{className:"fs-unmask",children:Zt?.map(Wn=>(0,n.jsx)(Ea.W.Item,{label:Wn.label,className:"fs-unmask",onClick:()=>{Ln?.(Wn.value)}},Wn.value))}),children:(0,n.jsxs)(P.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[Kt,(0,n.jsx)(B.I,{name:"angle-down"})]})}):(0,n.jsxs)(S.E,{children:[va??"No options available"," "]})}}function pn({stepsDone:Rt,totalStepsToDo:bt}){return(0,n.jsxs)(b.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(f.x6,{i18nKey:"gops.progress-status.your-progress",children:"Your progress"}),(0,n.jsx)(un,{stepsDone:Rt,totalStepsToDo:bt}),(0,n.jsx)(On,{stepsDone:Rt,totalStepsToDo:bt})]})}const Un=Rt=>({wrapper:(0,o.css)({margin:Rt.spacing(2,0),padding:Rt.spacing(2),border:`1px solid ${Rt.colors.border.medium}`,borderRadius:Rt.shape.radius.default,display:"flex",flexDirection:"column",gap:Rt.spacing(2)})});var In=(Rt=>(Rt[Rt.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",Rt[Rt.ESSENTIALS=1]="ESSENTIALS",Rt))(In||{});function Gn(){return{dataSourceCompatibleWithAlerting:!!(0,Qe.k5)()}}function Wa(){const Rt=(0,d.of)(za),bt=(0,s.Zp)(),Vt=Gn(),Kt=Ut(),Dt=an({dataSourceConfigurationData:Vt,essentialsConfigurationData:Kt});(0,a.useEffect)(()=>{He(ke.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:Vt.dataSourceCompatibleWithAlerting})},[Vt.dataSourceCompatibleWithAlerting]);const[Zt,Ln]=(0,Ge.l)(),Qn=Zt.get("essentials")==="open",va=(ia,kn)=>{switch(He(ke.ClickDataSources,{essentialStepsDone:Kt.stepsDone,essentialStepsToDo:Kt.totalStepsToDo,dataSourceCompatibleWithAlerting:Vt.dataSourceCompatibleWithAlerting}),ia){case 0:bt(kn?Te.I.List:Te.I.New);break;case 1:Ln({essentials:"open"}),He(ke.OpenEssentials,{essentialStepsDone:Kt.stepsDone,essentialStepsToDo:Kt.totalStepsToDo,dataSourceCompatibleWithAlerting:Vt.dataSourceCompatibleWithAlerting});break;default:return}};function Wn(){Ln({essentials:void 0}),He(ke.CloseEssentials,{essentialStepsDone:Kt.stepsDone,essentialStepsToDo:Kt.totalStepsToDo,dataSourceCompatibleWithAlerting:Vt.dataSourceCompatibleWithAlerting})}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.E,{element:"h4",variant:"h4",children:(0,n.jsx)(f.x6,{i18nKey:"gops.configure-irm.configure",children:"Configure"})}),(0,n.jsxs)("section",{className:Rt.container,children:[Dt.map(ia=>(0,n.jsx)(En,{config:ia,handleActionClick:va,isLoading:Kt.isLoading},ia.id)),Qn&&(0,n.jsx)(gt,{onClose:Wn,essentialsConfig:Kt.essentialContent,stepsDone:Kt.stepsDone,totalStepsToDo:Kt.totalStepsToDo})]}),(0,n.jsx)(S.E,{element:"h4",variant:"h4",children:(0,n.jsx)(f.x6,{i18nKey:"gops.configure-irm.irm-apps",children:"IRM apps"})})]})}const za=Rt=>({container:(0,o.css)({marginBottom:0,display:"grid",gap:Rt.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Oa=e(13660);const ss=[{path:"/plugins",navId:"plugins",roles:La([O.w.PluginsInstall,O.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Oa.vk.Home,component:q(()=>e.e(4519).then(e.bind(e,37761)))},{path:"/plugins/browse",navId:"plugins",roles:La([O.w.PluginsInstall,O.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Oa.vk.Browse,component:q(()=>e.e(4519).then(e.bind(e,37761)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:La([O.w.PluginsInstall,O.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Oa.vk.Details,component:q(()=>Promise.all([e.e(8354),e.e(362),e.e(6436),e.e(1308),e.e(7891)]).then(e.bind(e,31879)))}];function La(Rt,bt){return()=>Rt.some(Vt=>T.TP.hasPermission(Vt))?[]:bt}function Ca(){return ss}var Ka=e(37168),As=e(2543);const Ia=[{path:"/profile",component:q(()=>Promise.all([e.e(3126),e.e(2472)]).then(e.bind(e,67521)))},{path:"/profile/password",component:q(()=>e.e(9996).then(e.bind(e,9996)))},{path:"/profile/select-org",component:q(()=>e.e(7430).then(e.bind(e,31830)))},{path:"/profile/notifications",component:q(()=>e.e(4140).then(e.bind(e,30946)))}];function _s(Rt=g.$W){return Rt.profileEnabled?Ia:(0,As.uniq)(Ia.map(Vt=>Vt.path)).map(Vt=>({path:Vt,component:q(()=>e.e(5173).then(e.bind(e,77267)))}))}var Fa=e(6262);const xt=()=>g.$W.publicDashboardsEnabled?[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:Fa.Z4.Public,component:q(()=>e.e(5761).then(e.bind(e,69579)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:Fa.Z4.Public,chromeless:!0,component:q(()=>Promise.all([e.e(6088),e.e(9609),e.e(7197)]).then(e.bind(e,38449)))}]:[];var dt=e(53247),St=e(91555);function jt(){return(0,dt.Hv)()?[{path:St.mL,component:q(()=>Promise.all([e.e(886),e.e(2182)]).then(e.bind(e,15134)))},{path:St.zM,component:q(()=>Promise.all([e.e(886),e.e(1037)]).then(e.bind(e,90886)))},{path:`${St.pd}/:type`,component:q(()=>e.e(252).then(e.bind(e,13833)))},{path:St.mL+"/:name",component:q(()=>e.e(6092).then(e.bind(e,6299)))},{path:St.mL+"/:name/edit",component:q(()=>e.e(8758).then(e.bind(e,33580)))},{path:St.mL+"/:name/file/*",component:q(()=>e.e(1954).then(e.bind(e,28682)))},{path:St.mL+"/:name/history/*",component:q(()=>e.e(9898).then(e.bind(e,22192)))},{path:St.mL+"/:slug/dashboard/preview/*",pageClass:"page-dashboard",routeName:Fa.Z4.Provisioning,component:q(()=>e.e(8638).then(e.bind(e,21819)))}]:[{path:St.mL,component:q(()=>Promise.all([e.e(886),e.e(1037)]).then(e.bind(e,90886)))}]}const Qt=g.Ay.buildInfo.env==="development",Jt=[];function ln(){return[...(0,Ka.X)(),{path:"/",pageClass:"page-dashboard",routeName:Fa.Z4.Home,component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(9136)]).then(e.bind(e,92603)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:Fa.Z4.Normal,component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(9136)]).then(e.bind(e,92603)))},{path:"/dashboard/new",roles:()=>y.TP.evaluatePermission([O.w.DashboardsCreate]),pageClass:"page-dashboard",routeName:Fa.Z4.New,component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,92603)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>y.TP.evaluatePermission([O.w.DashboardsCreate]),component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,22754)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:Fa.Z4.Normal,component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,92603)))},{path:"/dashboards/embedding-test",component:q(()=>Promise.all([e.e(6088),e.e(4520),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,77437)))},{path:"/d-solo/:uid/:slug?",routeName:Fa.Z4.Normal,chromeless:!0,component:q(()=>g.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,35463)):Promise.all([e.e(6088),e.e(4492)]).then(e.bind(e,49286)))},{path:"/dashboard-solo/:type/:slug",routeName:Fa.Z4.Normal,chromeless:!0,component:q(()=>g.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,35463)):Promise.all([e.e(6088),e.e(4492)]).then(e.bind(e,49286)))},{path:"/dashboard/import",component:q(()=>e.e(2550).then(e.bind(e,25650)))},{path:Te.I.List,component:()=>(0,n.jsx)(s.C5,{replace:!0,to:Pe.b.DataSources})},{path:Te.I.Edit,component:vn},{path:Te.I.Dashboards,component:gn},{path:Te.I.New,component:()=>(0,n.jsx)(s.C5,{replace:!0,to:Pe.b.DataSourcesNew})},{path:"/datasources/correlations",component:q(()=>g.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,45185)):e.e(8014).then(e.bind(e,29181)))},{path:"/dashboards",component:q(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/dashboards/f/:uid/:slug",component:q(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/dashboards/f/:uid",component:q(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/explore",pageClass:"page-explore",roles:()=>y.TP.evaluatePermission([O.w.DataSourcesExplore]),component:q(()=>g.Ay.exploreEnabled?Promise.all([e.e(407),e.e(5995),e.e(2516),e.e(20),e.e(4520),e.e(3474),e.e(1213),e.e(9147),e.e(2792),e.e(9604)]).then(e.bind(e,30411)):e.e(4422).then(e.bind(e,89153)))},{path:"/drilldown",component:()=>(0,n.jsx)(p,{navId:"drilldown"})},{path:"/apps",component:()=>(0,n.jsx)(p,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,n.jsx)(p,{navId:"alerts-and-incidents",header:!(0,ce.y$)()&&(0,ce.qc)()||(0,ce.ES)()?(0,n.jsx)(Wa,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,n.jsx)(p,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,n.jsx)(s.C5,{replace:!0,to:"/observability"})},{path:"/observability",component:()=>(0,n.jsx)(p,{navId:"observability"})},{path:"/infrastructure",component:()=>(0,n.jsx)(p,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,n.jsx)(p,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,n.jsx)(p,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,n.jsx)(p,{navId:"cfg/plugins"})},{path:"/admin/extensions",navId:"extensions",roles:()=>y.TP.evaluatePermission([O.w.PluginsInstall,O.w.PluginsWrite]),component:Qt||g.Ay.featureToggles.enableExtensionsAdminPage?q(()=>e.e(5902).then(e.bind(e,79682))):()=>(0,n.jsx)(s.C5,{replace:!0,to:"/admin"})},{path:"/admin/access",component:()=>(0,n.jsx)(p,{navId:"cfg/access"})},{path:"/org",component:q(()=>Promise.all([e.e(3126),e.e(1510)]).then(e.bind(e,73318)))},{path:"/org/new",component:q(()=>e.e(7930).then(e.bind(e,45408)))},{path:"/org/users",component:()=>(0,n.jsx)(s.C5,{replace:!0,to:"/admin/users"})},{path:"/org/users/invite",component:q(()=>e.e(7720).then(e.bind(e,65914)))},{path:"/org/serviceaccounts",roles:()=>y.TP.evaluatePermission([O.w.ServiceAccountsRead,O.w.ServiceAccountsCreate]),component:q(()=>Promise.all([e.e(265),e.e(6777)]).then(e.bind(e,75955)))},{path:"/org/serviceaccounts/create",component:q(()=>Promise.all([e.e(265),e.e(4176)]).then(e.bind(e,41150)))},{path:"/org/serviceaccounts/:id",component:q(()=>Promise.all([e.e(265),e.e(6576)]).then(e.bind(e,88468)))},{path:"/org/teams",roles:()=>y.TP.evaluatePermission([O.w.ActionTeamsRead,O.w.ActionTeamsCreate]),component:q(()=>Promise.all([e.e(265),e.e(1036)]).then(e.bind(e,34314)))},{path:"/org/teams/new",roles:()=>y.TP.evaluatePermission([O.w.ActionTeamsCreate]),component:q(()=>Promise.all([e.e(265),e.e(5436)]).then(e.bind(e,84974)))},{path:"/org/teams/edit/:uid/:page?",roles:()=>y.TP.evaluatePermission([O.w.ActionTeamsRead,O.w.ActionTeamsCreate]),component:q(()=>Promise.all([e.e(265),e.e(3126),e.e(2212)]).then(e.bind(e,81395)))},{path:"/admin",component:()=>(0,n.jsx)(p,{navId:"cfg",header:(0,n.jsx)(Se,{})})},{path:"/admin/authentication",roles:()=>y.TP.evaluatePermission([O.w.SettingsWrite]),component:q(()=>e.e(5592).then(e.bind(e,53953)))},{path:"/admin/authentication/ldap",component:g.Ay.featureToggles.ssoSettingsLDAP?q(()=>e.e(4582).then(e.bind(e,43124))):Q},{path:"/admin/authentication/:provider",roles:()=>y.TP.evaluatePermission([O.w.SettingsWrite]),component:q(()=>e.e(5592).then(e.bind(e,81172)))},{path:"/admin/settings",component:q(()=>e.e(7659).then(e.bind(e,29154)))},{path:"/admin/upgrading",component:q(()=>e.e(564).then(e.bind(e,50564)))},{path:"/admin/users",component:q(()=>Promise.all([e.e(265),e.e(1743)]).then(e.bind(e,596)))},{path:"/admin/users/create",component:q(()=>e.e(9239).then(e.bind(e,62648)))},{path:"/admin/users/edit/:id",component:q(()=>Promise.all([e.e(265),e.e(8054)]).then(e.bind(e,698)))},{path:"/admin/orgs",component:q(()=>e.e(9736).then(e.bind(e,55026)))},{path:"/admin/orgs/edit/:id",component:q(()=>Promise.all([e.e(265),e.e(9119)]).then(e.bind(e,88947)))},{path:"/admin/featuretoggles",component:g.Ay.featureToggles.featureToggleAdminPage?q(()=>e.e(7024).then(e.bind(e,75180))):()=>(0,n.jsx)(s.C5,{replace:!0,to:"/admin"})},{path:"/admin/stats",component:q(()=>e.e(9299).then(e.bind(e,32882)))},g.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>y.TP.evaluatePermission([O.w.MigrationAssistantMigrate]),component:q(()=>e.e(3704).then(e.bind(e,2681)))},{path:"/login",component:q(()=>Promise.all([e.e(7651),e.e(3883)]).then(e.bind(e,798))),pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:q(()=>e.e(8576).then(e.bind(e,68620))),chromeless:!0},{path:"/verify",component:g.Ay.verifyEmailEnabled?q(()=>e.e(2018).then(e.bind(e,62018))):()=>(0,n.jsx)(s.C5,{replace:!0,to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:g.Ay.disableUserSignUp?()=>(0,n.jsx)(s.C5,{replace:!0,to:"/login"}):q(()=>e.e(8347).then(e.bind(e,98347))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:q(()=>e.e(3818).then(e.bind(e,81545)))},{path:"/user/password/reset",component:q(()=>Promise.all([e.e(7651),e.e(641)]).then(e.bind(e,1711))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",roles:()=>y.TP.evaluatePermission([O.w.SnapshotsRead]),component:q(()=>e.e(6590).then(e.bind(e,3839)))},{path:"/playlists",component:q(()=>e.e(1168).then(e.bind(e,22129)))},{path:"/playlists/play/:uid",component:q(()=>e.e(1374).then(e.bind(e,57304)))},{path:"/playlists/new",component:q(()=>e.e(7616).then(e.bind(e,95594)))},{path:"/playlists/edit/:uid",component:q(()=>e.e(7620).then(e.bind(e,33876)))},{path:"/sandbox/benchmarks",component:q(()=>e.e(9354).then(e.bind(e,13591)))},{path:"/sandbox/test",component:q(()=>e.e(5354).then(e.bind(e,12057)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:q(()=>e.e(5804).then(e.bind(e,95576)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>y.TP.evaluatePermission([O.w.AlertingRuleRead]),component:q(()=>e.e(4333).then(e.bind(e,85185)))},{path:"/library-panels",component:q(()=>e.e(8516).then(e.bind(e,21155)))},{path:"/notifications",component:q(()=>e.e(4140).then(e.bind(e,30946)))},{path:"/explore/metrics/*",roles:()=>y.TP.evaluatePermission([O.w.DataSourcesExplore]),component:q(()=>e.e(8513).then(e.bind(e,24227)))},{path:"/bookmarks",component:q(()=>e.e(7759).then(e.bind(e,27906)))},g.Ay.featureToggles.restoreDashboards&&{path:"/dashboard/recently-deleted",roles:()=>["Admin","ServerAdmin"],component:q(()=>Promise.all([e.e(362),e.e(6436),e.e(6299)]).then(e.bind(e,3853)))},{path:"/femt",component:()=>(0,n.jsx)(s.C5,{replace:!0,to:"/"})},...Ca(),...fn(),...he(),..._s(),...Jt,...xt(),...Me(),...jt(),{path:"/goto/*",component:wn},{path:"/*",component:r.H}].filter(l.zz)}function fn(Rt=g.Ay){return Rt.supportBundlesEnabled?[{path:"/support-bundles",component:q(()=>e.e(123).then(e.bind(e,236)))},{path:"/support-bundles/create",component:q(()=>e.e(1515).then(e.bind(e,26484)))}]:[]}function gn(){const{uid:Rt=""}=(0,s.g)();return(0,n.jsx)(s.C5,{replace:!0,to:Pe.b.DataSourcesDashboards.replace(":uid",Rt)})}function vn(){const{uid:Rt=""}=(0,s.g)();return(0,n.jsx)(s.C5,{replace:!0,to:Pe.b.DataSourcesEdit.replace(":uid",Rt)})}function wn(){const{pathname:Rt}=(0,s.zy)();return(0,a.useEffect)(()=>{window.location.href=Rt},[Rt]),null}},67203:(Z,R,e)=>{"use strict";e.d(R,{C3:()=>we,Co:()=>ve,U1:()=>ze});var n=e(65307),a=e(10378),s=e(1749),l=e(18346),o=e(62905),d=e(2495),i=e(1492),c=e(75816),m=e(73892),p=e(85618);const h=(0,p.TP)("advisor.grafana.app","v0alpha1"),r=(0,c.xP)({reducerPath:"advisorAPIv0alpha1",baseQuery:(0,m.W)({baseURL:h}),endpoints:()=>({})}),g=["API Discovery","Check","CheckType"],v=r.enhanceEndpoints({addTagTypes:g}).injectEndpoints({endpoints:Ve=>({getApiResources:Ve.query({query:()=>({url:"/apis/advisor.grafana.app/v0alpha1/"}),providesTags:["API Discovery"]}),listCheck:Ve.query({query:ge=>({url:"/checks",params:{pretty:ge.pretty,allowWatchBookmarks:ge.allowWatchBookmarks,continue:ge.continue,fieldSelector:ge.fieldSelector,labelSelector:ge.labelSelector,limit:ge.limit,resourceVersion:ge.resourceVersion,resourceVersionMatch:ge.resourceVersionMatch,sendInitialEvents:ge.sendInitialEvents,timeoutSeconds:ge.timeoutSeconds,watch:ge.watch}}),providesTags:["Check"]}),createCheck:Ve.mutation({query:ge=>({url:"/checks",method:"POST",body:ge.check,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation}}),invalidatesTags:["Check"]}),deletecollectionCheck:Ve.mutation({query:ge=>({url:"/checks",method:"DELETE",params:{pretty:ge.pretty,continue:ge.continue,dryRun:ge.dryRun,fieldSelector:ge.fieldSelector,gracePeriodSeconds:ge.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:ge.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:ge.labelSelector,limit:ge.limit,orphanDependents:ge.orphanDependents,propagationPolicy:ge.propagationPolicy,resourceVersion:ge.resourceVersion,resourceVersionMatch:ge.resourceVersionMatch,sendInitialEvents:ge.sendInitialEvents,timeoutSeconds:ge.timeoutSeconds}}),invalidatesTags:["Check"]}),getCheck:Ve.query({query:ge=>({url:`/checks/${ge.name}`,params:{pretty:ge.pretty}}),providesTags:["Check"]}),replaceCheck:Ve.mutation({query:ge=>({url:`/checks/${ge.name}`,method:"PUT",body:ge.check,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation}}),invalidatesTags:["Check"]}),deleteCheck:Ve.mutation({query:ge=>({url:`/checks/${ge.name}`,method:"DELETE",params:{pretty:ge.pretty,dryRun:ge.dryRun,gracePeriodSeconds:ge.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:ge.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:ge.orphanDependents,propagationPolicy:ge.propagationPolicy}}),invalidatesTags:["Check"]}),updateCheck:Ve.mutation({query:ge=>({url:`/checks/${ge.name}`,method:"PATCH",body:ge.patch,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation,force:ge.force}}),invalidatesTags:["Check"]}),listCheckType:Ve.query({query:ge=>({url:"/checktypes",params:{pretty:ge.pretty,allowWatchBookmarks:ge.allowWatchBookmarks,continue:ge.continue,fieldSelector:ge.fieldSelector,labelSelector:ge.labelSelector,limit:ge.limit,resourceVersion:ge.resourceVersion,resourceVersionMatch:ge.resourceVersionMatch,sendInitialEvents:ge.sendInitialEvents,timeoutSeconds:ge.timeoutSeconds,watch:ge.watch}}),providesTags:["CheckType"]}),createCheckType:Ve.mutation({query:ge=>({url:"/checktypes",method:"POST",body:ge.checkType,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation}}),invalidatesTags:["CheckType"]}),deletecollectionCheckType:Ve.mutation({query:ge=>({url:"/checktypes",method:"DELETE",params:{pretty:ge.pretty,continue:ge.continue,dryRun:ge.dryRun,fieldSelector:ge.fieldSelector,gracePeriodSeconds:ge.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:ge.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:ge.labelSelector,limit:ge.limit,orphanDependents:ge.orphanDependents,propagationPolicy:ge.propagationPolicy,resourceVersion:ge.resourceVersion,resourceVersionMatch:ge.resourceVersionMatch,sendInitialEvents:ge.sendInitialEvents,timeoutSeconds:ge.timeoutSeconds}}),invalidatesTags:["CheckType"]}),getCheckType:Ve.query({query:ge=>({url:`/checktypes/${ge.name}`,params:{pretty:ge.pretty}}),providesTags:["CheckType"]}),replaceCheckType:Ve.mutation({query:ge=>({url:`/checktypes/${ge.name}`,method:"PUT",body:ge.checkType,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation}}),invalidatesTags:["CheckType"]}),deleteCheckType:Ve.mutation({query:ge=>({url:`/checktypes/${ge.name}`,method:"DELETE",params:{pretty:ge.pretty,dryRun:ge.dryRun,gracePeriodSeconds:ge.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:ge.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:ge.orphanDependents,propagationPolicy:ge.propagationPolicy}}),invalidatesTags:["CheckType"]}),updateCheckType:Ve.mutation({query:ge=>({url:`/checktypes/${ge.name}`,method:"PATCH",body:ge.patch,params:{pretty:ge.pretty,dryRun:ge.dryRun,fieldManager:ge.fieldManager,fieldValidation:ge.fieldValidation,force:ge.force}}),invalidatesTags:["CheckType"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{updateCheck:Ve=>{const ge=Ve.query;ge&&(Ve.query=Ke=>({...ge(Ke),headers:{"Content-Type":"application/json-patch+json"},body:JSON.stringify(Ke.patch)}))},updateCheckType:Ve=>{const ge=Ve.query;ge&&(Ve.query=Ke=>({...ge(Ke),headers:{"Content-Type":"application/json-patch+json"},body:JSON.stringify(Ke.patch)}))}}}),{useGetCheckQuery:x,useListCheckQuery:f,useCreateCheckMutation:u,useDeleteCheckMutation:b,useUpdateCheckMutation:E,useListCheckTypeQuery:D,useUpdateCheckTypeMutation:C}=v;var P=e(87161),T=e(94659),O=e(58614),I=e(33680),j=e(43550),W=e(14644),B=e(12066),S=e(38206);const w={navBarTree:S.I_,navIndex:j._h,appNotifications:B.g5};var N=e(52695),M=e(25229),L=e(36200),A=e(11018);const F=(0,W.combineReducers)({promRules:(0,L.Xw)("promRules",A.mB,({rulesSourceName:Ve})=>Ve).reducer,rulerRules:(0,L.Xw)("rulerRules",A.eB,({rulesSourceName:Ve})=>Ve).reducer,saveAMConfig:(0,L.J7)("saveAMConfig",A.RW).reducer,deleteAMConfig:(0,L.J7)("deleteAMConfig",A.nO).reducer,amAlertGroups:(0,L.Xw)("amAlertGroups",A.D3,Ve=>Ve).reducer,testReceivers:(0,L.J7)("testReceivers",A.bO).reducer,managedAlertStateHistory:(0,L.J7)("managedAlertStateHistory",A.JH).reducer});var V=e(2954);const K={items:[],searchQuery:"",isLoading:!1},G={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function H(Ve,ge){const Ke=V.A.getStateDisplayModel(ge),qe={...Ve,stateText:Ke.text,stateIcon:Ke.iconClass,stateClass:Ke.stateClass,stateAge:(0,M.KQ)(Ve.newStateDate).fromNow(!0)};return qe.state!=="paused"&&(qe.executionError&&(qe.info="Execution Error: "+qe.executionError),qe.evalData&&qe.evalData.noData&&(qe.info="Query returned no data")),qe}const _=(0,n.Z0)({name:"alertRules",initialState:K,reducers:{loadAlertRules:Ve=>({...Ve,isLoading:!0}),loadedAlertRules:(Ve,ge)=>{const qe=ge.payload.map(ot=>H(ot,ot.state));return{...Ve,items:qe,isLoading:!1}},setSearchQuery:(Ve,ge)=>({...Ve,searchQuery:ge.payload})}}),k=(0,n.Z0)({name:"notificationChannel",initialState:G,reducers:{setNotificationChannels:(Ve,ge)=>({...Ve,notificationChannelTypes:de(ge.payload),notifiers:ge.payload}),notificationChannelLoaded:(Ve,ge)=>{const Ke=ge.payload,ot=Ve.notifiers.find(lt=>lt.type===Ke.type).options.filter(lt=>lt.secure);return ot.length>0&&ot.some(lt=>Ke.settings[lt.propertyName]!=="")?ue(Ve,ge.payload,ot):{...Ve,notificationChannel:Ke}},resetSecureField:(Ve,ge)=>({...Ve,notificationChannel:{...Ve.notificationChannel,secureFields:{...Ve.notificationChannel.secureFields,[ge.payload]:!1}}})}}),{loadAlertRules:J,loadedAlertRules:z,setSearchQuery:Y}=_.actions,{setNotificationChannels:X,notificationChannelLoaded:Q,resetSecureField:q}=k.actions,te=_.reducer,ne=k.reducer,se={alertRules:te,notificationChannel:ne,unifiedAlerting:F};function ue(Ve,ge,Ke){const qe={},ot={};return Ke.forEach(lt=>{ot[lt.propertyName]=ge.settings[lt.propertyName],qe[lt.propertyName]=""}),{...Ve,notificationChannel:{...ge,settings:{...ge.settings,...qe},secureSettings:{...ot}}}}function de(Ve){return Ve.map(ge=>({value:ge.type,label:ge.name,...ge,typeName:ge.type})).sort((ge,Ke)=>ge.name>Ke.name?1:-1)}var ie=e(21875),he=e(87186),me=e(42795),ce=e(37918),Pe=e(18548),Ie=e(35231),Se=e(17621),Me=e(38748),Te=e(2559),Ge=e(74396),Qe=e(89224),tt=e(54687),ke=e(69289),He=e(91259),Re=e(69807),Ne=e(27104),Ae=e(1302),Ue=e(74887),Be=e(5709),We=e(20018);const _e={...w,...se,...Ne.Ay,...Se.Ay,...ce.Ay,...Ie.Ay,...Pe.Ay,...Ae.Ay,...He.Ay,...ke.Ay,...Me.Ay,...Ge.Ay,...he.Ay,...N.Ay,...Te.Ay,...me.Ay,...Qe.Ay,...Ue.Ay,...Re.Ay,...ie.Ay,plugins:tt.Ff,[Be.H.reducerPath]:Be.H.reducer,[s.P.reducerPath]:s.P.reducer,[o.Sm.reducerPath]:o.Sm.reducer,[l.cU.reducerPath]:l.cU.reducer,[d.O5.reducerPath]:d.O5.reducer,[T.v.reducerPath]:T.v.reducer,[O.o3.reducerPath]:O.o3.reducer,[i.Aj.reducerPath]:i.Aj.reducer,[I.PP.reducerPath]:I.PP.reducer,[P.Z.reducerPath]:P.Z.reducer,[v.reducerPath]:v.reducer},Xe={},le=Ve=>{Object.assign(Xe,Ve)},ye=()=>{const Ve=(0,W.combineReducers)({..._e,...Xe});return(ge,Ke)=>{if(Ke.type!==We.N.type)return Ve(ge,Ke);const{cleanupAction:qe}=Ke.payload;return qe(ge),Ve(ge,Ke)}};var pe=e(8535);function ve(Ve){le(Ve)}const be=(0,n.Nc)(),Oe=[];function we(Ve){Oe.push(Ve)}function ze(Ve){const ge=(0,n.U1)({reducer:ye(),middleware:Ke=>Ke({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(be.middleware,Be.H.middleware,s.P.middleware,o.Sm.middleware,l.cU.middleware,d.O5.middleware,i.Aj.middleware,T.v.middleware,O.o3.middleware,I.PP.middleware,P.Z.middleware,v.middleware,...Oe),devTools:!1,preloadedState:{navIndex:(0,j.s2)(),...Ve}});return(0,a.$k)(ge.dispatch),(0,pe.k3)(ge),ge}},8535:(Z,R,e)=>{"use strict";e.d(R,{Gu:()=>l,JD:()=>o,M_:()=>a,k3:()=>s});var n=e(74887);let a;function s(d){a=d}function l(){return!a||!a.getState?{templating:{...n.L1,lastKey:"key"}}:a.getState()}function o(d){if(!(!a||!a.getState))return a.dispatch(d)}},70590:(Z,R,e)=>{"use strict";e.d(R,{RG:()=>a,Xe:()=>n});var n=(l=>(l[l.Admin=4]="Admin",l[l.Member=0]="Member",l))(n||{}),a=(l=>(l.View="View",l.Edit="Edit",l.Admin="Admin",l))(a||{}),s=(l=>(l.Folder="dash-folder",l.Dashboard="dash-db",l))(s||{})},96221:(Z,R,e)=>{"use strict";e.d(R,{Qd:()=>n,g2:()=>s});var n=(l=>(l.Success="success",l.Warning="warning",l.Error="error",l.Info="info",l))(n||{}),a=(l=>(l[l.Success=3e3]="Success",l[l.Warning=5e3]="Warning",l[l.Error=7e3]="Error",l))(a||{});const s={success:3e3,warning:5e3,error:7e3,info:3e3}},6262:(Z,R,e)=>{"use strict";e.d(R,{U:()=>o,Z4:()=>n,_g:()=>a,d9:()=>s,us:()=>l});var n=(d=>(d.Home="home-dashboard",d.New="new-dashboard",d.Normal="normal-dashboard",d.Provisioning="provisioning-dashboard",d.Scripted="scripted-dashboard",d.Public="public-dashboard",d.Embedded="embedded-dashboard",d.Report="report-dashboard",d))(n||{}),a=(d=>(d.NotStarted="Not started",d.Fetching="Fetching",d.Services="Services",d.Failed="Failed",d.Completed="Completed",d))(a||{}),s=(d=>(d.Full="full",d))(s||{});const l="DASHBOARD_FROM_LS_KEY";function o(d){return"redirectUri"in d}},87745:(Z,R,e)=>{"use strict";e.d(R,{Am:()=>P,Bt:()=>x,Cf:()=>p,Eu:()=>O,Io:()=>v,JI:()=>i,PR:()=>c,Q$:()=>m,Rh:()=>u,S8:()=>C,U0:()=>g,VZ:()=>f,Vz:()=>b,XM:()=>r,bG:()=>s,bY:()=>D,i0:()=>B,sL:()=>W,sj:()=>S,xL:()=>y,xc:()=>I,yj:()=>j,zq:()=>d});var n=e(36819),a=e(68388);const s=(0,n.R)("template-variable-value-updated"),l=(0,n.R)("graph-click"),o=(0,n.R)("threshold-changed");class d extends a.a{static{this.type="panel-queries-changed"}}class i extends a.a{static{this.type="panel-transformations-changed"}}class c extends a.a{static{this.type="panels-options-changed"}}class m extends a.a{static{this.type="dashboard-panels-changed"}}class p extends a.a{static{this.type="dashboard-meta-changed"}}class h extends a.a{static{this.type="panel-directive-ready"}}class r extends a.a{static{this.type="render"}}class g extends a.x{static{this.type="zoom-out"}}var y=(w=>(w[w.Left=-1]="Left",w[w.Right=1]="Right",w))(y||{});class v extends a.x{static{this.type="shift-time"}}class x extends a.a{static{this.type="copy-time"}}class f extends a.x{static{this.type="paste-time"}}class u extends a.x{static{this.type="absolute-time"}}class b extends a.x{static{this.type="remove-panel"}}class E extends a.x{static{this.type="show-modal"}}class D extends a.x{static{this.type="show-confirm-modal"}}class C extends a.x{static{this.type="show-react-modal"}}class P extends a.x{static{this.type="open-extension-sidebar"}}class T extends a.a{static{this.type="hide-modal"}}class O extends a.a{static{this.type="dashboard-saved"}}class I extends a.x{static{this.type="annotation-query-started"}}class j extends a.x{static{this.type="annotation-query-finished"}}class W extends a.x{static{this.type="panel-edit-started"}}class B extends a.x{static{this.type="panel-edit-finished"}}class S extends a.x{static{this.type="record-history-entry"}}},72265:(Z,R,e)=>{"use strict";e.d(R,{IW:()=>n,aA:()=>s,jH:()=>l,sG:()=>a});var n=(o=>(o[o.CLOSE_PANE=0]="CLOSE_PANE",o[o.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",o[o.CLOSE_EDITOR=2]="CLOSE_EDITOR",o))(n||{});const a=["lines","bars","points","stacked_lines","stacked_bars"];var s=(o=>(o.table="table",o.raw="raw",o))(s||{});const l=["table","raw"]},92654:(Z,R,e)=>{"use strict";e.d(R,{i:()=>n});var n=(a=>(a.All="All",a.WithExpiredTokens="WithExpiredTokens",a.External="External",a.Disabled="Disabled",a))(n||{})},52763:(Z,R,e)=>{"use strict";e.d(R,{ch:()=>d,d4:()=>l,wA:()=>s,zD:()=>o});var n=e(65307),a=e(71468);const s=a.useDispatch,l=a.useSelector,o=(i,c,m)=>(0,n.zD)(i,c,m),d=n.ch},73495:(Z,R,e)=>{"use strict";e.d(R,{m:()=>n});var n=(a=>(a.LineChart="Line chart",a.LineChartSmooth="Line chart smooth",a.LineChartGradientColorScheme="Line chart with gradient color scheme",a.AreaChart="Area chart",a.AreaChartStacked="Area chart stacked",a.AreaChartStackedPercent="Area chart 100% stacked",a.BarChart="Bar chart",a.BarChartGradientColorScheme="Bar chart with gradient color scheme",a.BarChartStacked="Bar chart stacked",a.BarChartStackedPercent="Bar chart 100% stacked",a.BarChartHorizontal="Bar chart horizontal",a.BarChartHorizontalStacked="Bar chart horizontal stacked",a.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",a.Candlestick="Candlestick",a.PieChart="Pie chart",a.PieChartDonut="Pie chart donut",a.Stat="Stat",a.StatColoredBackground="Stat colored background",a.Gauge="Gauge",a.GaugeNoThresholds="Gauge no thresholds",a.BarGaugeBasic="Bar gauge basic",a.BarGaugeLCD="Bar gauge LCD",a.Table="Table",a.StateTimeline="State timeline",a.StatusHistory="Status history",a.TextPanel="Text",a.DashboardList="Dashboard list",a.Logs="Logs",a.FlameGraph="Flame graph",a.Trace="Trace",a.NodeGraph="Node graph",a))(n||{})},24619:(Z,R,e)=>{"use strict";e.d(R,{$k:()=>d,Gi:()=>a,JS:()=>c,N1:()=>m,Q8:()=>p,Si:()=>s,cF:()=>n,lh:()=>i,qr:()=>o,s1:()=>l});var n=(h=>(h.Firing="firing",h.Inactive="inactive",h.Pending="pending",h.Recovering="recovering",h.Unknown="unknown",h))(n||{}),a=(h=>(h.Normal="Normal",h.Alerting="Alerting",h.Pending="Pending",h.Recovering="Recovering",h.NoData="NoData",h.Error="Error",h))(a||{});function s(h){return Object.values(n).includes(h)}function l(h){return Object.values(a).some(r=>r===h)}function o(h){const r=Object.values(n);return h!=null&&!r.includes(h)}function d(h){const r=h.match(/\((.*?)\)/);return r?r[1]:""}function i(h){return o(h)?h.split(" ")[0]:h}var c=(h=>(h.Alerting="alerting",h.Recording="recording",h))(c||{}),m=(h=>(h.Cortex="Cortex",h.Mimir="Mimir",h.Prometheus="Prometheus",h.Thanos="Thanos",h))(m||{}),p=(h=>(h.Alerting="Alerting",h.NoData="NoData",h.KeepLast="KeepLast",h.OK="OK",h.Error="Error",h))(p||{})},86791:(Z,R,e)=>{"use strict";e.d(R,{$7:()=>l,SA:()=>a,l$:()=>o});var n=e(24619);function a(d,i){return(0,n.lh)(d.state)===i}var s=(d=>(d.Firing="firing",d))(s||{}),l=(d=>(d.Alerting="alerting",d.Pending="pending",d.Recovering="recovering",d.Normal="inactive",d.NoData="nodata",d.Error="error",d))(l||{});const o=Symbol("grafana")},82013:()=>{(function(Z){var R={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(n){var a={x:-1,y:-1,locked:!1};n.setCrosshair=function(d){if(!d)a.x=-1;else{var i=n.p2c(d);a.x=Math.max(0,Math.min(i.left,n.width())),a.y=Math.max(0,Math.min(i.top,n.height()))}n.triggerRedrawOverlay()},n.clearCrosshair=n.setCrosshair,n.lockCrosshair=function(d){d&&n.setCrosshair(d),a.locked=!0},n.unlockCrosshair=function(){a.locked=!1};function s(o){a.locked||a.x!=-1&&(a.x=-1,n.triggerRedrawOverlay())}function l(o){if(!a.locked){if(n.getSelection&&n.getSelection()){a.x=-1;return}var d=n.offset();a.x=Math.max(0,Math.min(o.pageX-d.left,n.width())),a.y=Math.max(0,Math.min(o.pageY-d.top,n.height())),n.triggerRedrawOverlay()}}n.hooks.bindEvents.push(function(o,d){o.getOptions().crosshair.mode&&(d.mouseout(s),d.mousemove(l))}),n.hooks.drawOverlay.push(function(o,d){var i=o.getOptions().crosshair;if(i.mode){var c=o.getPlotOffset();if(d.save(),d.translate(c.left,c.top),a.x!=-1){var m=o.getOptions().crosshair.lineWidth%2?.5:0;if(d.strokeStyle=i.color,d.lineWidth=i.lineWidth,d.lineJoin="round",d.beginPath(),i.mode.indexOf("x")!=-1){var p=Math.floor(a.x)+m;d.moveTo(p,0),d.lineTo(p,o.height())}if(i.mode.indexOf("y")!=-1){var h=Math.floor(a.y)+m;d.moveTo(0,h),d.lineTo(o.width(),h)}d.stroke()}d.restore()}}),n.hooks.shutdown.push(function(o,d){d.unbind("mouseout",s),d.unbind("mousemove",l)})}Z.plot.plugins.push({init:e,options:R,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(Z){function R(e){e.hooks.processDatapoints.push(function(n,a,s){a.dashes.show&&n.hooks.draw.push(function(l,o){var d=l.getPlotOffset(),i=a.xaxis,c=a.yaxis;function m(g,y){var v=s.points,x=s.pointsize,f=null,u=null,b=0,E=!0,D,C;a.dashes.dashLength[0]?(D=a.dashes.dashLength[0],a.dashes.dashLength[1]?C=a.dashes.dashLength[1]:C=D):C=D=a.dashes.dashLength,o.beginPath();for(var P=x;P<v.length;P+=x){let L=function(A){var U=Math.sqrt(Math.pow(S-W,2)+Math.pow(w-B,2));if(U<=A)return{deltaX:S-W,deltaY:w-B,distance:U,remainder:A-U};var F=S>W?1:-1,V=w>B?1:-1;return{deltaX:F*Math.sqrt(Math.pow(A,2)/(1+Math.pow((w-B)/(S-W),2))),deltaY:V*Math.sqrt(Math.pow(A,2)-Math.pow(A,2)/(1+Math.pow((w-B)/(S-W),2))),distance:A,remainder:0}};var M=L,T=v[P-x],O=v[P-x+1],I=v[P],j=v[P+1];if(!(T==null||I==null)){if(O<=j&&O<c.min){if(j<c.min)continue;T=(c.min-O)/(j-O)*(I-T)+T,O=c.min}else if(j<=O&&j<c.min){if(O<c.min)continue;I=(c.min-O)/(j-O)*(I-T)+T,j=c.min}if(O>=j&&O>c.max){if(j>c.max)continue;T=(c.max-O)/(j-O)*(I-T)+T,O=c.max}else if(j>=O&&j>c.max){if(O>c.max)continue;I=(c.max-O)/(j-O)*(I-T)+T,j=c.max}if(T<=I&&T<i.min){if(I<i.min)continue;O=(i.min-T)/(I-T)*(j-O)+O,T=i.min}else if(I<=T&&I<i.min){if(T<i.min)continue;j=(i.min-T)/(I-T)*(j-O)+O,I=i.min}if(T>=I&&T>i.max){if(I>i.max)continue;O=(i.max-T)/(I-T)*(j-O)+O,T=i.max}else if(I>=T&&I>i.max){if(T>i.max)continue;j=(i.max-T)/(I-T)*(j-O)+O,I=i.max}(T!=f||O!=u)&&o.moveTo(i.p2c(T)+g,c.p2c(O)+y);var W=i.p2c(T)+g,B=c.p2c(O)+y,S=i.p2c(I)+g,w=c.p2c(j)+y,N;do N=L(b>0?b:E?D:C),(N.deltaX!=0||N.deltaY!=0)&&(E?o.lineTo(W+N.deltaX,B+N.deltaY):o.moveTo(W+N.deltaX,B+N.deltaY)),E=!E,b=N.remainder,W+=N.deltaX,B+=N.deltaY;while(N.distance>0);f=I,u=j}}o.stroke()}o.save(),o.translate(d.left,d.top),o.lineJoin="round";var p=a.dashes.lineWidth,h=a.shadowSize;if(p>0&&h>0){o.lineWidth=h,o.strokeStyle="rgba(0,0,0,0.1)";var r=Math.PI/18;m(Math.sin(r)*(p/2+h/2),Math.cos(r)*(p/2+h/2)),o.lineWidth=h/2,m(Math.sin(r)*(p/2+h/4),Math.cos(r)*(p/2+h/4))}o.lineWidth=p,o.strokeStyle=a.color,p>0&&m(0,0),o.restore()})})}Z.plot.plugins.push({init:R,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(Z){"use strict";var R={series:{fillBelowTo:null}};function e(n){function a(o,d){var i;for(i=0;i<d.length;++i)if(d[i].id===o.fillBelowTo)return d[i];return null}function s(o,d,i,c,m,p,h,r){var g,y,v,x,f,u;return g=i-o,y=c-d,v=h-m,x=r-p,f=(-y*(o-m)+g*(d-p))/(-v*y+g*x),u=(v*(d-p)-x*(o-m))/(-v*y+g*x),f>=0&&f<=1&&u>=0&&u<=1?[o+u*g,d+u*y]:null}function l(o,d,i){if(i.fillBelowTo===null)return;var c,m,p,h,r,g,y;function v(C,P){d.beginPath(),d.moveTo(i.xaxis.p2c(C)+g.left,i.yaxis.p2c(P)+g.top)}function x(){d.closePath(),d.fill()}function f(){if(p.length/m!==r.length/h)return console.error("Refusing to graph inconsistent number of points"),!1;var C;for(C=0;C<p.length/m;C++)if(p[C*m]!==null&&r[C*h]!==null&&p[C*m]!==r[C*h])return console.error("Refusing to graph points without matching value"),!1;return!0}function u(C,P){console.assert(P>C,"expects the end index to be greater than the start index");var T=C===0||p[C-1]===null||r[C-1]===null,O=!1,I,j;for(I=C;I<P;I++)if(p[I*m+1]===null||r[I*m+1]===null)O=!1,T=!0;else if(p[I*m+1]===r[I*h+1])O=!0,T=!1;else if(p[I*m+1]>r[I*h+1]){T?v(p[I*m],p[I*m+1]):O?v(p[(I-1)*m],p[(I-1)*m+1]):(j=b(I),v(j[0],j[1])),D(I,P);return}else T=!1,O=!1}function b(C){console.assert(C>0,"expects the second point in the series line segment");var P,T;for(P=1;P<r.length/h;P++)if(T=s(p[(C-1)*m],p[(C-1)*m+1],p[C*m],p[C*m+1],r[(P-1)*h],r[(P-1)*h+1],r[P*h],r[P*h+1]),T!==null)return T;console.error("intersectionPoint() should only be called when an intersection happens")}function E(C,P){console.assert(C>=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var T;for(T=C;T>=P;T--)d.lineTo(c.xaxis.p2c(r[T*h])+g.left,c.yaxis.p2c(r[T*h+1])+g.top);x()}function D(C,P){console.assert(C<=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var T,O;for(T=C;T<P;T++)if(p[T*m+1]===null&&T>C){E(T-1,C),u(T,P);return}else if(p[T*m+1]===r[T*h+1]){E(T,C),u(T,P);return}else if(p[T*m+1]<r[T*h+1]){O=b(T),d.lineTo(i.xaxis.p2c(O[0])+g.left,i.yaxis.p2c(O[1])+g.top),E(T,C),u(T,P);return}else d.lineTo(i.xaxis.p2c(p[T*m])+g.left,i.yaxis.p2c(p[T*m+1])+g.top);E(P,C)}c=a(i,o.getData()),c&&(m=i.datapoints.pointsize,p=i.datapoints.points,h=c.datapoints.pointsize,r=c.datapoints.points,g=o.getPlotOffset(),f()&&(y=Z.color.parse(i.color),y.a=.4,y.normalize(),d.fillStyle=y.toString(),u(0,p.length/m)))}n.hooks.drawSeries.push(l)}Z.plot.plugins.push({init:e,options:R,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(Z){var R=function(){var i,c,m,p,h,r,g=function(C,P){i=P,c=C.getPlaceholder(),m=C.getOptions(),p=m.series.gauges,h=C.getData(),r=e(p.debug)};g.prototype.calculateLayout=function(){var C=c.width(),P=c.height(),T=Math.min(h.length,p.layout.columns),O=Math.ceil(h.length/T),I=p.layout.margin,j=p.layout.hMargin,W=p.layout.vMargin,B=(C-I*2-j*(T-1))/T,S=(P-I*2-W*(O-1))/O;if(p.layout.square){var w=Math.min(B,S);B=w,S=w}y(p,B);var N=p.cell.margin,M=0,L=0;p.label.show&&(M=p.label.margin,L=p.label.font.size);var A=0,U=0;p.value.show&&(A=p.value.margin,U=p.value.font.size);var F=0;p.threshold.show&&(F=p.threshold.width);var V=0,K=0;p.threshold.label.show&&(V=p.threshold.label.margin,K=p.threshold.label.font.size);for(var G=B/2-N-F-V*2-K,H=p.gauge.startAngle,_=p.gauge.endAngle,k=(_-H)/100,J=-1,z=H;z<_;z+=k)J=Math.max(J,Math.sin(s(z)));J=Math.max(J,Math.sin(s(_)));var Y=(S-N*2-M*2-L)/(1+J);Y*J<A+U/2&&(Y=S-N*2-M*2-L-A-U/2);var X=Y-V*2-K-F,Q=Math.min(G,X),q=p.gauge.width;q>=Q&&(q=Math.max(3,Q/3));var te=V*2+K+F+Q,ne=Math.max(te*(1+J),te+A+U/2);return{canvasWidth:C,canvasHeight:P,margin:I,hMargin:j,vMargin:W,columns:T,rows:O,cellWidth:B,cellHeight:S,cellMargin:N,labelMargin:M,labelFontSize:L,valueMargin:A,valueFontSize:U,width:q,radius:Q,thresholdWidth:F,thresholdLabelMargin:V,thresholdLabelFontSize:K,gaugeOuterHeight:ne}};function y(C,P){C.gauge.width==="auto"&&(C.gauge.width=Math.max(5,P/8)),C.label.margin==="auto"&&(C.label.margin=Math.max(1,P/20)),C.label.font.size==="auto"&&(C.label.font.size=Math.max(5,P/8)),C.value.margin==="auto"&&(C.value.margin=Math.max(1,P/30)),C.value.font.size==="auto"&&(C.value.font.size=Math.max(5,P/9)),C.threshold.width==="auto"&&(C.threshold.width=Math.max(3,P/100)),C.threshold.label.margin==="auto"&&(C.threshold.label.margin=Math.max(3,P/40)),C.threshold.label.font.size==="auto"&&(C.threshold.label.font.size=Math.max(5,P/15))}g.prototype.calculateAutoValues=y,g.prototype.calculateCellLayout=function(C,P,T){var O=n(P.columns,T),I=a(P.columns,T),j=P.margin+(P.cellWidth+P.hMargin)*O,W=P.margin+(P.cellHeight+P.vMargin)*I,B=j+P.cellWidth/2,S=W+P.cellMargin+P.labelMargin*2+P.labelFontSize+P.thresholdWidth+P.thresholdLabelFontSize+P.thresholdLabelMargin*2+P.radius,w=P.cellHeight-P.cellMargin*2-P.labelMargin*2-P.labelFontSize-P.gaugeOuterHeight,N=0;return C.cell.vAlign==="middle"?N=w/2:C.cell.vAlign==="bottom"&&(N=w),S+=N,{col:O,row:I,x:j,y:W,offsetY:N,cellWidth:P.cellWidth,cellHeight:P.cellHeight,cellMargin:P.cellMargin,cx:B,cy:S}},g.prototype.drawBackground=function(C){p.frame.show&&(i.save(),i.strokeStyle=m.grid.borderColor,i.lineWidth=m.grid.borderWidth,i.strokeRect(0,0,C.canvasWidth,C.canvasHeight),m.grid.backgroundColor&&(i.fillStyle=m.grid.backgroundColor,i.fillRect(0,0,C.canvasWidth,C.canvasHeight)),i.restore())},g.prototype.drawCellBackground=function(C,P){i.save(),C.cell.border&&C.cell.border.show&&C.cell.border.color&&C.cell.border.width&&(i.strokeStyle=C.cell.border.color,i.lineWidth=C.cell.border.width,i.strokeRect(P.x,P.y,P.cellWidth,P.cellHeight)),C.cell.background&&C.cell.background.color&&(i.fillStyle=C.cell.background.color,i.fillRect(P.x,P.y,P.cellWidth,P.cellHeight)),i.restore()},g.prototype.drawGauge=function(C,P,T,O,I){var j=C.gauge.shadow.show?C.gauge.shadow.blur:0,W=f(C,I),B=v(C,P,I);b(T.cx,T.cy,P.radius,P.width,s(C.gauge.startAngle),s(C.gauge.endAngle),C.gauge.border.color,C.gauge.border.width,C.gauge.background.color,j),b(T.cx,T.cy,P.radius-1,P.width-2,s(B.a1),s(B.a2),W,1,W,j),C.gauge.neutralValue!=null&&x(C,P,T,W)};function v(C,P,T){let O={};var I=C.gauge.neutralValue;return I!=null?T<I?(O.a1=u(C,P,T),O.a2=u(C,P,I)):(O.a1=u(C,P,I),O.a2=u(C,P,T)):(O.a1=C.gauge.startAngle,O.a2=u(C,P,T)),O}function x(C,P,T,O){var I=(C.gauge.max-C.gauge.min)/600;l(i,T.cx,T.cy,P.radius-2,P.width-4,s(u(C,P,C.gauge.neutralValue-I)),s(u(C,P,C.gauge.neutralValue+I)),O,2,C.gauge.background.color)}function f(C,P){for(var T,O=0;O<C.threshold.values.length;O++){var I=C.threshold.values[O];if(T=I.color,P<I.value)break}return T}function u(C,P,T){var O=C.gauge.startAngle+(C.gauge.endAngle-C.gauge.startAngle)*((T-C.gauge.min)/(C.gauge.max-C.gauge.min));return O<C.gauge.startAngle?O=C.gauge.startAngle:O>C.gauge.endAngle&&(O=C.gauge.endAngle),O}g.prototype.drawThreshold=function(C,P,T){for(var O=C.gauge.startAngle,I=0;I<C.threshold.values.length;I++){var j=C.threshold.values[I];c1=j.color,a2=u(C,P,j.value),l(i,T.cx,T.cy,P.radius+P.thresholdWidth,P.thresholdWidth-2,s(O),s(a2),c1,1,c1),O=a2}};function b(C,P,T,O,I,j,W,B,S,w){I!==j&&(i.save(),l(i,C,P,T,O,I,j,W,B,S),w&&(l(i,C,P,T,O,I,j),i.clip(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=10,i.shadowColor="gray",l(i,C,P,T+1,O+2,I,j,W,1)),i.restore())}g.prototype.drawLable=function(C,P,T,O,I){D(T.cx,T.y+T.cellMargin+P.labelMargin+T.offsetY,"flotGaugeLabel"+O,C.label.formatter?C.label.formatter(I.label,I.data[0][1]):text,C.label)},g.prototype.drawValue=function(C,P,T,O,I){D(T.cx,T.cy-C.value.font.size/2,"flotGaugeValue"+O,C.value.formatter?C.value.formatter(I.label,I.data[0][1]):text,C.value)},g.prototype.drawThresholdValues=function(C,P,T,O){E(C,P,T,"Min"+O,C.gauge.min,C.gauge.startAngle),E(C,P,T,"Max"+O,C.gauge.max,C.gauge.endAngle);for(var I=0;I<C.threshold.values.length;I++){var j=C.threshold.values[I];if(j.value>C.gauge.min&&j.value<C.gauge.max){var W=u(C,P,j.value);E(C,P,T,O+"_"+I,j.value,W)}}var B=C.gauge.neutralValue;B!=null&&B>C.gauge.min&&B<C.gauge.max&&E(C,P,T,"Neutral"+O,B,u(C,P,B))};function E(C,P,T,O,I,j){D(T.cx+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.cos(s(j)),T.cy+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.sin(s(j)),"flotGaugeThresholdValue"+O,C.threshold.label.formatter?C.threshold.label.formatter(I):I,C.threshold.label,j)}function D(C,P,T,O,I,j){var W=Z(c).find("#"+T),B=W.length;B||(W=Z("<span></span>"),W.attr("id",T),W.attr("class","flot-temp-elem"),c.append(W)),W.css("position","absolute"),W.css("top",P+"px"),W.css("white-space","nowrap"),I.font.size&&W.css("font-size",I.font.size+"px"),I.font.family&&W.css("font-family",I.font.family),I.color&&W.css("color",I.color),I.background.color&&W.css("background-color",I.background.color),I.background.opacity&&W.css("opacity",I.background.opacity),W.text(O),W.css("left",C+"px"),W.css("left",parseInt(W.css("left"))-W.width()/2+"px"),!B&&j&&(W.css("top",parseInt(W.css("top"))-W.height()/2+"px"),W.css("transform","rotate("+(180*j+90)+"deg)"))}return g}();function e(i){return typeof Logger<"u"?new Logger(i):null}function n(i,c){return c%i}function a(i,c){return Math.floor(c/i)}function s(i){return i*Math.PI}function l(i,c,m,p,h,r,g,y,v,x){if(r!==g){var f=!1;i.save(),i.beginPath(),i.arc(c,m,p,r,g,f),i.lineTo(c+(p-h)*Math.cos(g),m+(p-h)*Math.sin(g)),i.arc(c,m,p-h,g,r,!f),i.closePath(),v&&(i.lineWidth=v),y&&(i.strokeStyle=y,i.stroke()),x&&(i.fillStyle=x,i.fill()),i.restore()}}function o(i){i.hooks.processOptions.push(function(c,m){var p=e(m.series.gauges.debug);m.series.gauges.show&&(m.grid.show=!1,m.legend.show=!1);var h=m.series.gauges.threshold.values;h.sort(function(r,g){return r.value<g.value?-1:r.value>g.value?1:0})}),i.hooks.draw.push(function(c,m){var p=c.getOptions(),h=p.series.gauges,r=e(h.debug);if(h.show){var g=c.getData();if(!(!g||!g.length)){var y=new R(c,m),v=y.calculateLayout();h.debug.layout,y.drawBackground(v);for(var x=0;x<g.length;x++){var f=g[x],u=Z.extend({},h,f.gauges);f.gauges&&y.calculateAutoValues(u,v.cellWidth);var b=y.calculateCellLayout(u,v,x);y.drawCellBackground(u,b),u.debug.layout,u.label.show&&y.drawLable(u,v,b,x,f),y.drawGauge(u,v,b,f.label,f.data[0][1]),u.threshold.show&&y.drawThreshold(u,v,b),u.threshold.label.show&&y.drawThresholdValues(u,v,b,x),u.value.show&&y.drawValue(u,v,b,x,f)}}}})}var d={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,c){return i}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,c){return parseInt(c)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(i){return i}},values:[]}}}};Z.plot.plugins.push({init:o,options:d,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(Z){Z.color={},Z.color.make=function(e,n,a,s){var l={};return l.r=e||0,l.g=n||0,l.b=a||0,l.a=s??1,l.add=function(o,d){for(var i=0;i<o.length;++i)l[o.charAt(i)]+=d;return l.normalize()},l.scale=function(o,d){for(var i=0;i<o.length;++i)l[o.charAt(i)]*=d;return l.normalize()},l.toString=function(){return l.a>=1?"rgb("+[l.r,l.g,l.b].join(",")+")":"rgba("+[l.r,l.g,l.b,l.a].join(",")+")"},l.normalize=function(){function o(d,i,c){return i<d?d:i>c?c:i}return l.r=o(0,parseInt(l.r),255),l.g=o(0,parseInt(l.g),255),l.b=o(0,parseInt(l.b),255),l.a=o(0,l.a,1),l},l.clone=function(){return Z.color.make(l.r,l.b,l.g,l.a)},l.normalize()},Z.color.extract=function(e,n){var a;do{if(a=e.css(n).toLowerCase(),a!=""&&a!="transparent")break;e=e.parent()}while(e.length&&!Z.nodeName(e.get(0),"body"));return a=="rgba(0, 0, 0, 0)"&&(a="transparent"),Z.color.parse(a)},Z.color.parse=function(e){var n,a=Z.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55);if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55,parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return a(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return a(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var s=Z.trim(e).toLowerCase();return s=="transparent"?a(255,255,255,0):(n=R[s]||[0,0,0],a(n[0],n[1],n[2]))};var R={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(Z){var R=Object.prototype.hasOwnProperty;Z.fn.detach||(Z.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(s,l){var o=l.children("."+s)[0];if(o==null&&(o=document.createElement("canvas"),o.className=s,Z(o).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(l),!o.getContext))if(window.G_vmlCanvasManager)o=window.G_vmlCanvasManager.initElement(o);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=o;var d=this.context=o.getContext("2d"),i=window.devicePixelRatio||1,c=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;this.pixelRatio=i/c,this.resize(l.width(),l.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(s,l){if(s<=0||l<=0)throw new Error("Invalid dimensions for plot, width = "+s+", height = "+l);var o=this.element,d=this.context,i=this.pixelRatio;this.width!=s&&(o.width=s*i,o.style.width=s+"px",this.width=s),this.height!=l&&(o.height=l*i,o.style.height=l+"px",this.height=l),d.restore(),d.save(),d.scale(i,i)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var s=this._textCache;for(var l in s)if(R.call(s,l)){var o=this.getTextLayer(l),d=s[l];o.hide();for(var i in d)if(R.call(d,i)){var c=d[i];for(var m in c)if(R.call(c,m)){for(var p=c[m].positions,h=0,r;r=p[h];h++)r.active?r.rendered||(o.append(r.element),r.rendered=!0):(p.splice(h--,1),r.rendered&&r.element.detach());p.length==0&&delete c[m]}}o.show()}},e.prototype.getTextLayer=function(s){var l=this.text[s];return l==null&&(this.textContainer==null&&(this.textContainer=Z("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),l=this.text[s]=Z("<div></div>").addClass(s).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),l},e.prototype.getTextInfo=function(s,l,o,d,i){var c,m,p,h;if(l=""+l,typeof o=="object"?c=o.style+" "+o.variant+" "+o.weight+" "+o.size+"px/"+o.lineHeight+"px "+o.family:c=o,m=this._textCache[s],m==null&&(m=this._textCache[s]={}),p=m[c],p==null&&(p=m[c]={}),h=p[l],h==null){var r=Z("<div></div>").html(l).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(s));typeof o=="object"?r.css({font:c,color:o.color}):typeof o=="string"&&r.addClass(o),h=p[l]={element:r,positions:[]};var g=this._textSizeCache[l];g?(h.width=g.width,h.height=g.height):(h.width=r.outerWidth(!0),h.height=r.outerHeight(!0),this._textSizeCache[l]={width:h.width,height:h.height}),r.detach()}return h},e.prototype.addText=function(s,l,o,d,i,c,m,p,h){var r=this.getTextInfo(s,d,i,c,m),g=r.positions;p=="center"?l-=r.width/2:p=="right"&&(l-=r.width),h=="middle"?o-=r.height/2:h=="bottom"&&(o-=r.height);for(var y=0,v;v=g[y];y++)if(v.x==l&&v.y==o){v.active=!0;return}v={active:!0,rendered:!1,element:g.length?r.element.clone():r.element,x:l,y:o},g.push(v),v.element.css({top:Math.round(o),left:Math.round(l),"text-align":p})},e.prototype.removeText=function(s,l,o,d,i,c){if(d==null){var m=this._textCache[s];if(m!=null){for(var p in m)if(R.call(m,p)){var h=m[p];for(var r in h)if(R.call(h,r))for(var g=h[r].positions,y=0,v;v=g[y];y++)v.active=!1}}}else for(var g=this.getTextInfo(s,d,i,c).positions,y=0,v;v=g[y];y++)v.x==l&&v.y==o&&(v.active=!1)};function n(s,l,o,d){var i=[],c={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},m=null,p=null,h=null,r=null,g=null,y=[],v=[],x={left:0,right:0,top:0,bottom:0},f=0,u=0,b={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},E=this;E.setData=T,E.setupGrid=H,E.draw=X,E.getPlaceholder=function(){return s},E.getCanvas=function(){return m.element},E.getPlotOffset=function(){return x},E.width=function(){return f},E.height=function(){return u},E.offset=function(){var le=h.offset();return le.left+=x.left,le.top+=x.top,le},E.getData=function(){return i},E.getAxes=function(){var le={},ye;return Z.each(y.concat(v),function(pe,ve){ve&&(le[ve.direction+(ve.n!=1?ve.n:"")+"axis"]=ve)}),le},E.getXAxes=function(){return y},E.getYAxes=function(){return v},E.c2p=W,E.p2c=B,E.getOptions=function(){return c},E.highlight=Ae,E.unhighlight=Ue,E.triggerRedrawOverlay=Re,E.pointOffset=function(le){return{left:parseInt(y[I(le,"x")-1].p2c(+le.x)+x.left,10),top:parseInt(v[I(le,"y")-1].p2c(+le.y)+x.top,10)}},E.shutdown=A,E.destroy=function(){A(),s.removeData("plot").empty(),i=[],c=null,m=null,p=null,h=null,r=null,g=null,y=[],v=[],b=null,Ie=[],E=null},E.resize=function(){var le=s.width(),ye=s.height();m.resize(le,ye),p.resize(le,ye)},E.hooks=b,C(E),P(o),M(),T(l),H(),X(),L();function D(le,ye){ye=[E].concat(ye);for(var pe=0;pe<le.length;++pe)le[pe].apply(this,ye)}function C(){for(var le={Canvas:e},ye=0;ye<d.length;++ye){var pe=d[ye];pe.init(E,le),pe.options&&Z.extend(!0,c,pe.options)}}function P(le){Z.extend(!0,c,le),le&&le.colors&&(c.colors=le.colors),c.xaxis.color==null&&(c.xaxis.color=Z.color.parse(c.grid.color).scale("a",.22).toString()),c.yaxis.color==null&&(c.yaxis.color=Z.color.parse(c.grid.color).scale("a",.22).toString()),c.xaxis.tickColor==null&&(c.xaxis.tickColor=c.grid.tickColor||c.xaxis.color),c.yaxis.tickColor==null&&(c.yaxis.tickColor=c.grid.tickColor||c.yaxis.color),c.grid.borderColor==null&&(c.grid.borderColor=c.grid.color),c.grid.tickColor==null&&(c.grid.tickColor=Z.color.parse(c.grid.color).scale("a",.22).toString());var ye,pe,ve,be=s.css("font-size"),Oe=be?+be.replace("px",""):13,we={style:s.css("font-style"),size:Math.round(.8*Oe),variant:s.css("font-variant"),weight:s.css("font-weight"),family:s.css("font-family")};for(ve=c.xaxes.length||1,ye=0;ye<ve;++ye)pe=c.xaxes[ye],pe&&!pe.tickColor&&(pe.tickColor=pe.color),pe=Z.extend(!0,{},c.xaxis,pe),c.xaxes[ye]=pe,pe.font&&(pe.font=Z.extend({},we,pe.font),pe.font.color||(pe.font.color=pe.color),pe.font.lineHeight||(pe.font.lineHeight=Math.round(pe.font.size*1.15)));for(ve=c.yaxes.length||1,ye=0;ye<ve;++ye)pe=c.yaxes[ye],pe&&!pe.tickColor&&(pe.tickColor=pe.color),pe=Z.extend(!0,{},c.yaxis,pe),c.yaxes[ye]=pe,pe.font&&(pe.font=Z.extend({},we,pe.font),pe.font.color||(pe.font.color=pe.color),pe.font.lineHeight||(pe.font.lineHeight=Math.round(pe.font.size*1.15)));for(c.xaxis.noTicks&&c.xaxis.ticks==null&&(c.xaxis.ticks=c.xaxis.noTicks),c.yaxis.noTicks&&c.yaxis.ticks==null&&(c.yaxis.ticks=c.yaxis.noTicks),c.x2axis&&(c.xaxes[1]=Z.extend(!0,{},c.xaxis,c.x2axis),c.xaxes[1].position="top",c.x2axis.min==null&&(c.xaxes[1].min=null),c.x2axis.max==null&&(c.xaxes[1].max=null)),c.y2axis&&(c.yaxes[1]=Z.extend(!0,{},c.yaxis,c.y2axis),c.yaxes[1].position="right",c.y2axis.min==null&&(c.yaxes[1].min=null),c.y2axis.max==null&&(c.yaxes[1].max=null)),c.grid.coloredAreas&&(c.grid.markings=c.grid.coloredAreas),c.grid.coloredAreasColor&&(c.grid.markingsColor=c.grid.coloredAreasColor),c.lines&&Z.extend(!0,c.series.lines,c.lines),c.points&&Z.extend(!0,c.series.points,c.points),c.bars&&Z.extend(!0,c.series.bars,c.bars),c.shadowSize!=null&&(c.series.shadowSize=c.shadowSize),c.highlightColor!=null&&(c.series.highlightColor=c.highlightColor),ye=0;ye<c.xaxes.length;++ye)S(y,ye+1).options=c.xaxes[ye];for(ye=0;ye<c.yaxes.length;++ye)S(v,ye+1).options=c.yaxes[ye];for(var ze in b)c.hooks[ze]&&c.hooks[ze].length&&(b[ze]=b[ze].concat(c.hooks[ze]));D(b.processOptions,[c])}function T(le){i=O(le),w(),N()}function O(le){for(var ye=[],pe=0;pe<le.length;++pe){var ve=Z.extend(!0,{},c.series);le[pe].data!=null?(ve.data=le[pe].data,delete le[pe].data,Z.extend(!0,ve,le[pe]),le[pe].data=ve.data):ve.data=le[pe],ye.push(ve)}return ye}function I(le,ye){var pe=le[ye+"axis"];return typeof pe=="object"&&(pe=pe.n),typeof pe!="number"&&(pe=1),pe}function j(){return Z.grep(y.concat(v),function(le){return le})}function W(le){var ye={},pe,ve;for(pe=0;pe<y.length;++pe)ve=y[pe],ve&&(ye["x"+ve.n]=ve.c2p(le.left));for(pe=0;pe<v.length;++pe)ve=v[pe],ve&&(ye["y"+ve.n]=ve.c2p(le.top));return ye.x1!==void 0&&(ye.x=ye.x1),ye.y1!==void 0&&(ye.y=ye.y1),ye}function B(le){var ye={},pe,ve,be;for(pe=0;pe<y.length;++pe)if(ve=y[pe],ve&&ve.used&&(be="x"+ve.n,le[be]==null&&ve.n==1&&(be="x"),le[be]!=null)){ye.left=ve.p2c(le[be]);break}for(pe=0;pe<v.length;++pe)if(ve=v[pe],ve&&ve.used&&(be="y"+ve.n,le[be]==null&&ve.n==1&&(be="y"),le[be]!=null)){ye.top=ve.p2c(le[be]);break}return ye}function S(le,ye){return le[ye-1]||(le[ye-1]={n:ye,direction:le==y?"x":"y",options:Z.extend(!0,{},le==y?c.xaxis:c.yaxis)}),le[ye-1]}function w(){var le=i.length,ye=-1,pe;for(pe=0;pe<i.length;++pe){var ve=i[pe].color;ve!=null&&(le--,typeof ve=="number"&&ve>ye&&(ye=ve))}le<=ye&&(le=ye+1);var be,Oe=[],we=c.colors,ze=we.length,Ve=0;for(pe=0;pe<le;pe++)be=Z.color.parse(we[pe%ze]||"#666"),pe%ze==0&&pe&&(Ve>=0?Ve<.5?Ve=-Ve-.2:Ve=0:Ve=-Ve),Oe[pe]=be.scale("rgb",1+Ve);var ge=0,Ke;for(pe=0;pe<i.length;++pe){if(Ke=i[pe],Ke.color==null?(Ke.color=Oe[ge].toString(),++ge):typeof Ke.color=="number"&&(Ke.color=Oe[Ke.color].toString()),Ke.lines.show==null){var qe,ot=!0;for(qe in Ke)if(Ke[qe]&&Ke[qe].show){ot=!1;break}ot&&(Ke.lines.show=!0)}Ke.lines.zero==null&&(Ke.lines.zero=!!Ke.lines.fill),Ke.xaxis=S(y,I(Ke,"x")),Ke.yaxis=S(v,I(Ke,"y"))}}function N(){var le=Number.POSITIVE_INFINITY,ye=Number.NEGATIVE_INFINITY,pe=Number.MAX_VALUE,ve,be,Oe,we,ze,Ve,ge,Ke,qe,ot,lt,mt,Lt,Tt,It,Mt;function Ut(Fn,Ea,gt){Ea<Fn.datamin&&Ea!=-pe&&(Fn.datamin=Ea),gt>Fn.datamax&&gt!=pe&&(Fn.datamax=gt)}for(Z.each(j(),function(Fn,Ea){Ea.datamin=le,Ea.datamax=ye,Ea.used=!1}),ve=0;ve<i.length;++ve)Ve=i[ve],Ve.datapoints={points:[]},D(b.processRawData,[Ve,Ve.data,Ve.datapoints]);for(ve=0;ve<i.length;++ve){if(Ve=i[ve],It=Ve.data,Mt=Ve.datapoints.format,!Mt){if(Mt=[],Mt.push({x:!0,number:!0,required:!0}),Mt.push({y:!0,number:!0,required:!0}),Ve.stack||Ve.bars.show||Ve.lines.show&&Ve.lines.fill){var an=!!(Ve.bars.show&&Ve.bars.zero||Ve.lines.show&&Ve.lines.zero);Mt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:an}),Ve.bars.horizontal&&(delete Mt[Mt.length-1].y,Mt[Mt.length-1].x=!0)}Ve.datapoints.format=Mt}if(Ve.datapoints.pointsize==null){Ve.datapoints.pointsize=Mt.length,Ke=Ve.datapoints.pointsize,ge=Ve.datapoints.points;var cn=Ve.lines.show&&Ve.lines.steps;for(Ve.xaxis.used=Ve.yaxis.used=!0,be=Oe=0;be<It.length;++be,Oe+=Ke){Tt=It[be];var un=Tt==null;if(!un)for(we=0;we<Ke;++we)mt=Tt[we],Lt=Mt[we],Lt&&(Lt.number&&mt!=null&&(mt=+mt,isNaN(mt)?mt=null:mt==1/0?mt=pe:mt==-1/0&&(mt=-pe)),mt==null&&(Lt.required&&(un=!0),Lt.defaultValue!=null&&(mt=Lt.defaultValue))),ge[Oe+we]=mt;if(un)for(we=0;we<Ke;++we)mt=ge[Oe+we],mt!=null&&(Lt=Mt[we],Lt.autoscale!==!1&&(Lt.x&&Ut(Ve.xaxis,mt,mt),Lt.y&&Ut(Ve.yaxis,mt,mt))),ge[Oe+we]=null;if(cn&&Oe>0&&(!un||ge[Oe-Ke]!=null)){for(we=0;we<Ke;++we)ge[Oe+Ke+we]=ge[Oe+we];ge[Oe+1]=ge[Oe-Ke+1]||0,un&&(ge[Oe]=Tt[0]),Oe+=Ke}}}}for(ve=0;ve<i.length;++ve){if(Ve=i[ve],ge=Ve.datapoints.points,Ke=Ve.datapoints.pointsize,Ve.transform==="negative-Y")for(be=0;be<ge.length;be+=Ke)ge[be]!=null&&(mt=ge[be+1],ge[be+1]=-mt);D(b.processDatapoints,[Ve,Ve.datapoints])}for(ve=0;ve<i.length;++ve){Ve=i[ve],ge=Ve.datapoints.points,Ke=Ve.datapoints.pointsize,Mt=Ve.datapoints.format;var On=le,yn=le,En=ye,Bn=ye;for(be=0;be<ge.length;be+=Ke)if(ge[be]!=null)for(we=0;we<Ke;++we)mt=ge[be+we],Lt=Mt[we],!(!Lt||Lt.autoscale===!1||mt==pe||mt==-pe)&&(Lt.x&&(mt<On&&(On=mt),mt>En&&(En=mt)),Lt.y&&(mt<yn&&(yn=mt),mt>Bn&&(Bn=mt)));if(Ve.bars.show){var fa;switch(Ve.bars.align){case"left":fa=0;break;case"right":fa=-Ve.bars.barWidth;break;default:fa=-Ve.bars.barWidth/2}Ve.bars.horizontal?(yn+=fa,Bn+=fa+Ve.bars.barWidth):(On+=fa,En+=fa+Ve.bars.barWidth)}Ut(Ve.xaxis,On,En),Ut(Ve.yaxis,yn,Bn)}Z.each(j(),function(Fn,Ea){Ea.datamin==le&&(Ea.datamin=null),Ea.datamax==ye&&(Ea.datamax=null)})}function M(){s.find(".flot-temp-elem").remove(),s.css("position")=="static"&&s.css("position","relative"),m=new e("flot-base",s),p=new e("flot-overlay",s),r=m.context,g=p.context,h=Z(p.element).unbind();var le=s.data("plot");le&&(le.shutdown(),p.clear()),s.data("plot",E)}function L(){c.grid.hoverable&&(h.mousemove(Te),h.bind("mouseleave",Ge),Z(document).bind("touchend",tt)),c.grid.clickable&&h.click(Qe),D(b.bindEvents,[h])}function A(){Se&&clearTimeout(Se),h.unbind("mousemove",Te),h.unbind("mouseleave",Ge),h.unbind("click",Qe),Z(document).unbind("touchend",tt),D(b.shutdown,[h])}function U(le){function ye(we){return we}var pe,ve,be=le.options.transform||ye,Oe=le.options.inverseTransform;le.direction=="x"?(pe=le.scale=f/Math.abs(be(le.max)-be(le.min)),ve=Math.min(be(le.max),be(le.min))):(pe=le.scale=u/Math.abs(be(le.max)-be(le.min)),pe=-pe,ve=Math.max(be(le.max),be(le.min))),be==ye?le.p2c=function(we){return(we-ve)*pe}:le.p2c=function(we){return(be(we)-ve)*pe},Oe?le.c2p=function(we){return Oe(ve+we/pe)}:le.c2p=function(we){return ve+we/pe}}function F(le){for(var ye=le.options,pe=le.ticks||[],ve=ye.labelWidth||0,be=ye.labelHeight||0,Oe=ve||(le.direction=="x"?Math.floor(m.width/(pe.length||1)):null),we=le.direction+"Axis "+le.direction+le.n+"Axis",ze="flot-"+le.direction+"-axis flot-"+le.direction+le.n+"-axis "+we,Ve=ye.font||"flot-tick-label tickLabel",ge=0;ge<pe.length;++ge){var Ke=pe[ge];if(Ke.label){var qe=m.getTextInfo(ze,Ke.label,Ve,null,Oe);ve=Math.max(ve,qe.width+1),be=Math.max(be,qe.height)}}le.labelWidth=ye.labelWidth||ve,le.labelHeight=ye.labelHeight||be}function V(le){var ye=le.labelWidth,pe=le.labelHeight,ve=le.options.position,be=le.direction==="x",Oe=le.options.tickLength,we=c.grid.axisMargin,ze=c.grid.labelMargin,Ve=c.grid.eventSectionHeight,ge=!0,Ke=!0,qe=!0,ot=!1;Z.each(be?y:v,function(lt,mt){mt&&(mt.show||mt.reserveSpace)&&(mt===le?ot=!0:mt.options.position===ve&&(ot?Ke=!1:ge=!1),ot||(qe=!1))}),Ke&&(we=0),Oe==null&&(Oe=qe?"full":5),isNaN(+Oe)||(ze+=+Oe),be?(pe+=ze,pe+=Ve,ve=="bottom"?(x.bottom+=pe+we,le.box={top:m.height-x.bottom,height:pe}):(le.box={top:x.top+we,height:pe},x.top+=pe+we)):(ye+=ze,ve=="left"?(le.box={left:x.left+we,width:ye},x.left+=ye+we):(x.right+=ye+we,le.box={left:m.width-x.right,width:ye})),le.position=ve,le.tickLength=Oe,le.box.padding=ze,le.box.eventSectionPadding=Ve,le.innermost=ge}function K(le){le.direction=="x"?(le.box.left=x.left-le.labelWidth/2,le.box.width=m.width-x.left-x.right+le.labelWidth):(le.box.top=x.top-le.labelHeight/2,le.box.height=m.height-x.bottom-x.top+le.labelHeight)}function G(){var le=c.grid.minBorderMargin,ye,pe;if(le==null)for(le=0,pe=0;pe<i.length;++pe)le=Math.max(le,2*(i[pe].points.radius+i[pe].points.lineWidth/2));var ve={left:le,right:le,top:le,bottom:le};Z.each(j(),function(be,Oe){Oe.reserveSpace&&Oe.ticks&&Oe.ticks.length&&(Oe.direction==="x"?(ve.left=Math.max(ve.left,Oe.labelWidth/2),ve.right=Math.max(ve.right,Oe.labelWidth/2)):(ve.bottom=Math.max(ve.bottom,Oe.labelHeight/2),ve.top=Math.max(ve.top,Oe.labelHeight/2)))}),x.left=Math.ceil(Math.max(ve.left,x.left)),x.right=Math.ceil(Math.max(ve.right,x.right)),x.top=Math.ceil(Math.max(ve.top,x.top)),x.bottom=Math.ceil(Math.max(ve.bottom,x.bottom))}function H(){var le,ye=j(),pe=c.grid.show;for(var ve in x){var be=c.grid.margin||0;x[ve]=typeof be=="number"?be:be[ve]||0}D(b.processOffset,[x]);for(var ve in x)typeof c.grid.borderWidth=="object"?x[ve]+=pe?c.grid.borderWidth[ve]:0:x[ve]+=pe?c.grid.borderWidth:0;if(Z.each(ye,function(ze,Ve){var ge=Ve.options;Ve.show=ge.show==null?Ve.used:ge.show,Ve.reserveSpace=ge.reserveSpace==null?Ve.show:ge.reserveSpace,_(Ve)}),D(b.processRange,[]),pe){for(var Oe=Z.grep(ye,function(ze){return ze.show||ze.reserveSpace}),we=!1,le=0;le<2&&(Z.each(Oe,function(Ve,ge){J(ge),z(ge),we=Y(ge,ge.ticks)||we,F(ge)}),we&&b.processRange.length>0);le++)D(b.processRange,[]),we=!1;for(le=Oe.length-1;le>=0;--le)V(Oe[le]);G(),Z.each(Oe,function(ze,Ve){K(Ve)})}f=m.width-x.left-x.right,u=m.height-x.bottom-x.top,Z.each(ye,function(ze,Ve){U(Ve)}),pe&&ne(),Pe()}function _(le){var ye=le.options,pe=+(ye.min!=null?ye.min:le.datamin),ve=+(ye.max!=null?ye.max:le.datamax),be=ve-pe;if(be==0){var Oe=.25,we=Math.abs(ve==0?1:ve*Oe);ye.min==null&&(pe-=we),(ye.max==null||ye.min!=null)&&(ve+=we)}else{var ze=ye.autoscaleMargin;ze!=null&&(ye.min==null&&(pe-=be*ze,pe<0&&le.datamin!=null&&le.datamin>=0&&(pe=0)),ye.max==null&&(ve+=be*ze,ve>0&&le.datamax!=null&&le.datamax<=0&&(ve=0)))}le.min=pe,le.max=ve}function k(le){if(le=Math.abs(String(le).replace(".","")),le==0)return 0;for(;le!=0&&le%10==0;)le/=10;return Math.floor(Math.log(le)/Math.LN10)+1}function J(le){var ye=le.options,pe;typeof ye.ticks=="number"&&ye.ticks>0?pe=ye.ticks:pe=.3*Math.sqrt(le.direction=="x"?m.width:m.height);var ve=(le.max-le.min)/pe,be=-Math.floor(Math.log(ve)/Math.LN10),Oe=ye.tickDecimals;Oe!=null&&be>Oe&&(be=Oe);var we=Math.pow(10,-be),ze=ve/we,Ve;if(ze<1.5?Ve=1:ze<3?(Ve=2,ze>2.25&&(Oe==null||be+1<=Oe)&&(Ve=2.5,++be)):ze<7.5?Ve=5:Ve=10,Ve*=we,ye.minTickSize!=null&&Ve<ye.minTickSize&&(Ve=ye.minTickSize),le.delta=ve,le.tickDecimals=Math.max(0,Oe??be),le.tickSize=ye.tickSize||Ve,ye.mode=="time"&&!le.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(le.tickGenerator||(le.tickGenerator=function(lt){var mt=[],Lt=a(lt.min,lt.tickSize),Tt=0,It=Number.NaN,Mt;do Mt=It,It=Lt+Tt*lt.tickSize,mt.push(It),++Tt;while(It<lt.max&&It!=Mt);return mt},le.tickFormatter=function(lt,mt){var Lt=mt.tickDecimals?Math.pow(10,mt.tickDecimals):1,Tt=""+Math.round(lt*Lt)/Lt;if(mt.tickDecimals!=null){var It=Tt.indexOf("."),Mt=It==-1?0:Tt.length-It-1;if(Mt<mt.tickDecimals)return(Mt?Tt:Tt+".")+(""+Lt).substr(1,mt.tickDecimals-Mt)}return Tt}),Z.isFunction(ye.tickFormatter)&&(le.tickFormatter=function(lt,mt){return""+ye.tickFormatter(lt,mt)}),ye.alignTicksWithAxis!=null){var ge=(le.direction=="x"?y:v)[ye.alignTicksWithAxis-1];if(ge&&ge.used&&ge!=le){var Ke=le.tickGenerator(le);if(Ke.length>0&&(ye.min==null&&(le.min=Math.min(le.min,Ke[0])),ye.max==null&&Ke.length>1&&(le.max=Math.max(le.max,Ke[Ke.length-1]))),le.tickGenerator=function(lt){var mt=[],Lt,Tt;for(Tt=0;Tt<ge.ticks.length;++Tt)Lt=(ge.ticks[Tt].v-ge.min)/(ge.max-ge.min),Lt=lt.min+Lt*(lt.max-lt.min),mt.push(Lt);return mt},!le.mode&&ye.tickDecimals==null){var qe=Math.max(0,-Math.floor(Math.log(le.delta)/Math.LN10)+1),ot=le.tickGenerator(le);ot.length>1&&/\..*0$/.test((ot[1]-ot[0]).toFixed(qe))||(le.tickDecimals=qe)}}}}function z(le){var ye=le.options.ticks,pe=[];ye==null||typeof ye=="number"&&ye>0?pe=le.tickGenerator(le):ye&&(Z.isFunction(ye)?pe=ye(le):pe=ye);var ve,be;for(le.ticks=[],ve=0;ve<pe.length;++ve){var Oe=null,we=pe[ve];typeof we=="object"?(be=+we[0],we.length>1&&(Oe=we[1])):be=+we,Oe==null&&(Oe=le.tickFormatter(be,le)),isNaN(be)||le.ticks.push({v:be,label:Oe})}}function Y(le,ye){var pe=!1;return le.options.autoscaleMargin&&ye.length>0&&(le.options.min==null&&(le.min=Math.min(le.min,ye[0].v),pe=!0),le.options.max==null&&ye.length>1&&(le.max=Math.max(le.max,ye[ye.length-1].v),pe=!0)),pe}function X(){m.clear(),D(b.drawBackground,[r]);var le=c.grid;le.show&&le.backgroundColor&&q(),le.show&&!le.aboveData&&te();for(var ye=0;ye<i.length;++ye)D(b.drawSeries,[r,i[ye]]),ue(i[ye]);D(b.draw,[r]),le.show&&le.aboveData&&te(),m.render(),Re()}function Q(le,ye){for(var pe,ve,be,Oe,we=j(),ze=0;ze<we.length;++ze)if(pe=we[ze],pe.direction==ye&&(Oe=ye+pe.n+"axis",!le[Oe]&&pe.n==1&&(Oe=ye+"axis"),le[Oe])){ve=le[Oe].from,be=le[Oe].to;break}if(le[Oe]||(pe=ye=="x"?y[0]:v[0],ve=le[ye+"1"],be=le[ye+"2"]),ve!=null&&be!=null&&ve>be){var Ve=ve;ve=be,be=Ve}return{from:ve,to:be,axis:pe}}function q(){r.save(),r.translate(x.left,x.top),r.fillStyle=Xe(c.grid.backgroundColor,u,0,"rgba(255, 255, 255, 0)"),r.fillRect(0,0,f,u),r.restore()}function te(){var le,ye,pe,ve;r.save(),r.translate(x.left,x.top);var be=c.grid.markings;if(be)for(Z.isFunction(be)&&(ye=E.getAxes(),ye.xmin=ye.xaxis.min,ye.xmax=ye.xaxis.max,ye.ymin=ye.yaxis.min,ye.ymax=ye.yaxis.max,be=be(ye)),le=0;le<be.length;++le){var Oe=be[le],we=Q(Oe,"x"),ze=Q(Oe,"y");if(we.from==null&&(we.from=we.axis.min),we.to==null&&(we.to=we.axis.max),ze.from==null&&(ze.from=ze.axis.min),ze.to==null&&(ze.to=ze.axis.max),!(we.to<we.axis.min||we.from>we.axis.max||ze.to<ze.axis.min||ze.from>ze.axis.max)){we.from=Math.max(we.from,we.axis.min),we.to=Math.min(we.to,we.axis.max),ze.from=Math.max(ze.from,ze.axis.min),ze.to=Math.min(ze.to,ze.axis.max);var Ve=we.from===we.to,ge=ze.from===ze.to;if(!(Ve&&ge))if(we.from=Math.floor(we.axis.p2c(we.from)),we.to=Math.floor(we.axis.p2c(we.to)),ze.from=Math.floor(ze.axis.p2c(ze.from)),ze.to=Math.floor(ze.axis.p2c(ze.to)),Ve||ge){var Ke=Oe.lineWidth||c.grid.markingsLineWidth,qe=Ke%2?.5:0;r.beginPath(),r.strokeStyle=Oe.color||c.grid.markingsColor,r.lineWidth=Ke,Ve?(r.moveTo(we.to+qe,ze.from),r.lineTo(we.to+qe,ze.to)):(r.moveTo(we.from,ze.to+qe),r.lineTo(we.to,ze.to+qe)),r.stroke()}else r.fillStyle=Oe.color||c.grid.markingsColor,r.fillRect(we.from,ze.to,we.to-we.from,ze.from-ze.to)}}ye=j(),pe=c.grid.borderWidth;for(var ot=0;ot<ye.length;++ot){var lt=ye[ot],mt=lt.box,Lt=lt.tickLength,Tt,It,Mt,Ut;if(!(!lt.show||lt.ticks.length==0)){for(r.lineWidth=1,lt.direction=="x"?(Tt=0,Lt=="full"?It=lt.position=="top"?0:u:It=mt.top-x.top+(lt.position=="top"?mt.height:0)):(It=0,Lt=="full"?Tt=lt.position=="left"?0:f:Tt=mt.left-x.left+(lt.position=="left"?mt.width:0)),lt.innermost||(r.strokeStyle=lt.options.color,r.beginPath(),Mt=Ut=0,lt.direction=="x"?Mt=f+1:Ut=u+1,r.lineWidth==1&&(lt.direction=="x"?It=Math.floor(It)+.5:Tt=Math.floor(Tt)+.5),r.moveTo(Tt,It),r.lineTo(Tt+Mt,It+Ut),r.stroke()),r.strokeStyle=lt.options.tickColor,r.beginPath(),le=0;le<lt.ticks.length;++le){var an=lt.ticks[le].v;Mt=Ut=0,!(isNaN(an)||an<lt.min||an>lt.max||Lt=="full"&&(typeof pe=="object"&&pe[lt.position]>0||pe>0)&&(an==lt.min||an==lt.max))&&(lt.direction=="x"?(Tt=lt.p2c(an),Ut=Lt=="full"?-u:Lt,lt.position=="top"&&(Ut=-Ut)):(It=lt.p2c(an),Mt=Lt=="full"?-f:Lt,lt.position=="left"&&(Mt=-Mt)),r.lineWidth==1&&(lt.direction=="x"?Tt=Math.floor(Tt)+.5:It=Math.floor(It)+.5),r.moveTo(Tt,It),r.lineTo(Tt+Mt,It+Ut))}r.stroke()}}pe&&(ve=c.grid.borderColor,typeof pe=="object"||typeof ve=="object"?(typeof pe!="object"&&(pe={top:pe,right:pe,bottom:pe,left:pe}),typeof ve!="object"&&(ve={top:ve,right:ve,bottom:ve,left:ve}),pe.top>0&&(r.strokeStyle=ve.top,r.lineWidth=pe.top,r.beginPath(),r.moveTo(0-pe.left,0-pe.top/2),r.lineTo(f,0-pe.top/2),r.stroke()),pe.right>0&&(r.strokeStyle=ve.right,r.lineWidth=pe.right,r.beginPath(),r.moveTo(f+pe.right/2,0-pe.top),r.lineTo(f+pe.right/2,u),r.stroke()),pe.bottom>0&&(r.strokeStyle=ve.bottom,r.lineWidth=pe.bottom,r.beginPath(),r.moveTo(f+pe.right,u+pe.bottom/2),r.lineTo(0,u+pe.bottom/2),r.stroke()),pe.left>0&&(r.strokeStyle=ve.left,r.lineWidth=pe.left,r.beginPath(),r.moveTo(0-pe.left/2,u+pe.bottom),r.lineTo(0-pe.left/2,0),r.stroke())):(r.lineWidth=pe,r.strokeStyle=c.grid.borderColor,r.strokeRect(-pe/2,-pe/2,f+pe,u+pe))),r.restore()}function ne(){Z.each(j(),function(le,ye){var pe=ye.box,ve=ye.direction+"Axis "+ye.direction+ye.n+"Axis",be="flot-"+ye.direction+"-axis flot-"+ye.direction+ye.n+"-axis "+ve,Oe=ye.options.font||"flot-tick-label tickLabel",we,ze,Ve,ge,Ke;if(m.removeText(be),!(!ye.show||ye.ticks.length==0))for(var qe=0;qe<ye.ticks.length;++qe)we=ye.ticks[qe],!(!we.label||we.v<ye.min||we.v>ye.max)&&(ye.direction=="x"?(ge="center",ze=x.left+ye.p2c(we.v),ye.position=="bottom"?Ve=pe.top+pe.padding+pe.eventSectionPadding:(Ve=pe.top+pe.height-pe.padding,Ke="bottom")):(Ke="middle",Ve=x.top+ye.p2c(we.v),ye.position=="left"?(ze=pe.left+pe.width-pe.padding,ge="right"):ze=pe.left+pe.padding),m.addText(be,ze,Ve,we.label,Oe,null,null,ge,Ke))})}function se(le){for(var ye=[],pe=null,ve=null,be=le.datapoints,Oe=[],we=0;we<be.pointsize-2;we++)Oe.push(0);for(var ze=0;ze<be.points.length;ze+=be.pointsize){var Ve=be.points[ze],ge=be.points[ze+1];ze===be.points.length-be.pointsize?ve=null:ve=be.points[ze+be.pointsize],Ve!==null&&ge!==null&&pe===null&&ve===null&&(ye.push(Ve),ye.push(ge),ye.push.apply(ye,Oe)),pe=Ve}var Ke=be.points;be.points=ye,le.points.radius=le.lines.lineWidth/2,ie(le),be.points=Ke}function ue(le){le.lines.show&&(de(le),!le.points.show&&!le.bars.show&&se(le)),le.bars.show&&me(le),le.points.show&&ie(le)}function de(le){function ye(ze,Ve,ge,Ke,qe){var ot=ze.points,lt=ze.pointsize,mt=null,Lt=null;r.beginPath();for(var Tt=lt;Tt<ot.length;Tt+=lt){var It=ot[Tt-lt],Mt=ot[Tt-lt+1],Ut=ot[Tt],an=ot[Tt+1];if(!(It==null||Ut==null)){if(Mt<=an&&Mt<qe.min){if(an<qe.min)continue;It=(qe.min-Mt)/(an-Mt)*(Ut-It)+It,Mt=qe.min}else if(an<=Mt&&an<qe.min){if(Mt<qe.min)continue;Ut=(qe.min-Mt)/(an-Mt)*(Ut-It)+It,an=qe.min}if(Mt>=an&&Mt>qe.max){if(an>qe.max)continue;It=(qe.max-Mt)/(an-Mt)*(Ut-It)+It,Mt=qe.max}else if(an>=Mt&&an>qe.max){if(Mt>qe.max)continue;Ut=(qe.max-Mt)/(an-Mt)*(Ut-It)+It,an=qe.max}if(It<=Ut&&It<Ke.min){if(Ut<Ke.min)continue;Mt=(Ke.min-It)/(Ut-It)*(an-Mt)+Mt,It=Ke.min}else if(Ut<=It&&Ut<Ke.min){if(It<Ke.min)continue;an=(Ke.min-It)/(Ut-It)*(an-Mt)+Mt,Ut=Ke.min}if(It>=Ut&&It>Ke.max){if(Ut>Ke.max)continue;Mt=(Ke.max-It)/(Ut-It)*(an-Mt)+Mt,It=Ke.max}else if(Ut>=It&&Ut>Ke.max){if(It>Ke.max)continue;an=(Ke.max-It)/(Ut-It)*(an-Mt)+Mt,Ut=Ke.max}(It!=mt||Mt!=Lt)&&r.moveTo(Ke.p2c(It)+Ve,qe.p2c(Mt)+ge),mt=Ut,Lt=an,r.lineTo(Ke.p2c(Ut)+Ve,qe.p2c(an)+ge)}}r.stroke()}function pe(ze,Ve,ge){for(var Ke=ze.points,qe=ze.pointsize,ot=Math.min(Math.max(0,ge.min),ge.max),lt=0,mt,Lt=!1,Tt=1,It=0,Mt=0;!(qe>0&&lt>Ke.length+qe);){lt+=qe;var Ut=Ke[lt-qe],an=Ke[lt-qe+Tt],cn=Ke[lt],un=Ke[lt+Tt];if(Lt){if(qe>0&&Ut!=null&&cn==null){Mt=lt,qe=-qe,Tt=2;continue}if(qe<0&&lt==It+qe){r.fill(),Lt=!1,qe=-qe,Tt=1,lt=It=Mt+qe;continue}}if(!(Ut==null||cn==null)){if(Ut<=cn&&Ut<Ve.min){if(cn<Ve.min)continue;an=(Ve.min-Ut)/(cn-Ut)*(un-an)+an,Ut=Ve.min}else if(cn<=Ut&&cn<Ve.min){if(Ut<Ve.min)continue;un=(Ve.min-Ut)/(cn-Ut)*(un-an)+an,cn=Ve.min}if(Ut>=cn&&Ut>Ve.max){if(cn>Ve.max)continue;an=(Ve.max-Ut)/(cn-Ut)*(un-an)+an,Ut=Ve.max}else if(cn>=Ut&&cn>Ve.max){if(Ut>Ve.max)continue;un=(Ve.max-Ut)/(cn-Ut)*(un-an)+an,cn=Ve.max}if(Lt||(r.beginPath(),r.moveTo(Ve.p2c(Ut),ge.p2c(ot)),Lt=!0),an>=ge.max&&un>=ge.max){r.lineTo(Ve.p2c(Ut),ge.p2c(ge.max)),r.lineTo(Ve.p2c(cn),ge.p2c(ge.max));continue}else if(an<=ge.min&&un<=ge.min){r.lineTo(Ve.p2c(Ut),ge.p2c(ge.min)),r.lineTo(Ve.p2c(cn),ge.p2c(ge.min));continue}var On=Ut,yn=cn;an<=un&&an<ge.min&&un>=ge.min?(Ut=(ge.min-an)/(un-an)*(cn-Ut)+Ut,an=ge.min):un<=an&&un<ge.min&&an>=ge.min&&(cn=(ge.min-an)/(un-an)*(cn-Ut)+Ut,un=ge.min),an>=un&&an>ge.max&&un<=ge.max?(Ut=(ge.max-an)/(un-an)*(cn-Ut)+Ut,an=ge.max):un>=an&&un>ge.max&&an<=ge.max&&(cn=(ge.max-an)/(un-an)*(cn-Ut)+Ut,un=ge.max),Ut!=On&&r.lineTo(Ve.p2c(On),ge.p2c(an)),r.lineTo(Ve.p2c(Ut),ge.p2c(an)),r.lineTo(Ve.p2c(cn),ge.p2c(un)),cn!=yn&&(r.lineTo(Ve.p2c(cn),ge.p2c(un)),r.lineTo(Ve.p2c(yn),ge.p2c(un)))}}}r.save(),r.translate(x.left,x.top),r.lineJoin="round";var ve=le.lines.lineWidth,be=le.shadowSize;if(ve>0&&be>0){r.lineWidth=be,r.strokeStyle="rgba(0,0,0,0.1)";var Oe=Math.PI/18;ye(le.datapoints,Math.sin(Oe)*(ve/2+be/2),Math.cos(Oe)*(ve/2+be/2),le.xaxis,le.yaxis),r.lineWidth=be/2,ye(le.datapoints,Math.sin(Oe)*(ve/2+be/4),Math.cos(Oe)*(ve/2+be/4),le.xaxis,le.yaxis)}r.lineWidth=ve,r.strokeStyle=le.color;var we=ce(le.lines,le.color,0,u);we&&(r.fillStyle=we,pe(le.datapoints,le.xaxis,le.yaxis)),ve>0&&ye(le.datapoints,0,0,le.xaxis,le.yaxis),r.restore()}function ie(le){function ye(ze,Ve,ge,Ke,qe,ot,lt,mt){for(var Lt=ze.points,Tt=ze.pointsize,It=0;It<Lt.length;It+=Tt){var Mt=Lt[It],Ut=Lt[It+1];Mt==null||Mt<ot.min||Mt>ot.max||Ut<lt.min||Ut>lt.max||(r.beginPath(),Mt=ot.p2c(Mt),Ut=lt.p2c(Ut)+Ke,mt=="circle"?r.arc(Mt,Ut,Ve,0,qe?Math.PI:Math.PI*2,!1):mt(r,Mt,Ut,Ve,qe),r.closePath(),ge&&(r.fillStyle=ge,r.fill()),r.stroke())}}r.save(),r.translate(x.left,x.top);var pe=le.points.lineWidth,ve=le.shadowSize,be=le.points.radius,Oe=le.points.symbol;if(pe==0&&(pe=1e-4),pe>0&&ve>0){var we=ve/2;r.lineWidth=we,r.strokeStyle="rgba(0,0,0,0.1)",ye(le.datapoints,be,null,we+we/2,!0,le.xaxis,le.yaxis,Oe),r.strokeStyle="rgba(0,0,0,0.2)",ye(le.datapoints,be,null,we/2,!0,le.xaxis,le.yaxis,Oe)}r.lineWidth=pe,r.strokeStyle=le.color,ye(le.datapoints,be,ce(le.points,le.color),0,!1,le.xaxis,le.yaxis,Oe),r.restore()}function he(le,ye,pe,ve,be,Oe,we,ze,Ve,ge,Ke){var qe,ot,lt,mt,Lt,Tt,It,Mt,Ut;ge?(Mt=Tt=It=!0,Lt=!1,qe=pe,ot=le,mt=ye+ve,lt=ye+be,ot<qe&&(Ut=ot,ot=qe,qe=Ut,Lt=!0,Tt=!1)):(Lt=Tt=It=!0,Mt=!1,qe=le+ve,ot=le+be,lt=pe,mt=ye,mt<lt&&(Ut=mt,mt=lt,lt=Ut,Mt=!0,It=!1)),!(ot<we.min||qe>we.max||mt<ze.min||lt>ze.max)&&(qe<we.min&&(qe=we.min,Lt=!1),ot>we.max&&(ot=we.max,Tt=!1),lt<ze.min&&(lt=ze.min,Mt=!1),mt>ze.max&&(mt=ze.max,It=!1),qe=we.p2c(qe),lt=ze.p2c(lt),ot=we.p2c(ot),mt=ze.p2c(mt),Oe&&(Ve.fillStyle=Oe(lt,mt),Ve.fillRect(qe,mt,ot-qe,lt-mt)),Ke>0&&(Lt||Tt||It||Mt)&&(Ve.beginPath(),Ve.moveTo(qe,lt),Lt?Ve.lineTo(qe,mt):Ve.moveTo(qe,mt),It?Ve.lineTo(ot,mt):Ve.moveTo(ot,mt),Tt?Ve.lineTo(ot,lt):Ve.moveTo(ot,lt),Mt?Ve.lineTo(qe,lt):Ve.moveTo(qe,lt),Ve.stroke()))}function me(le){function ye(be,Oe,we,ze,Ve,ge){for(var Ke=be.points,qe=be.pointsize,ot=0;ot<Ke.length;ot+=qe)Ke[ot]!=null&&he(Ke[ot],Ke[ot+1],Ke[ot+2],Oe,we,ze,Ve,ge,r,le.bars.horizontal,le.bars.lineWidth)}r.save(),r.translate(x.left,x.top),r.lineWidth=le.bars.lineWidth,r.strokeStyle=le.color;var pe;switch(le.bars.align){case"left":pe=0;break;case"right":pe=-le.bars.barWidth;break;default:pe=-le.bars.barWidth/2}var ve=le.bars.fill?function(be,Oe){return ce(le.bars,le.color,be,Oe)}:null;ye(le.datapoints,pe,pe+le.bars.barWidth,ve,le.xaxis,le.yaxis),r.restore()}function ce(le,ye,pe,ve){var be=le.fill;if(!be)return null;if(le.fillColor)return Xe(le.fillColor,pe,ve,ye);var Oe=Z.color.parse(ye);return Oe.a=typeof be=="number"?be:.4,Oe.normalize(),Oe.toString()}function Pe(){if(c.legend.container!=null?Z.find(c.legend.container).html(""):s.find(".legend").remove(),!!c.legend.show){for(var le=[],ye=[],pe=!1,ve=c.legend.labelFormatter,be,Oe,we=0;we<i.length;++we)be=i[we],be.label&&(Oe=ve?ve(be.label,be):be.label,Oe&&ye.push({label:Oe,color:be.color}));if(c.legend.sorted)if(Z.isFunction(c.legend.sorted))ye.sort(c.legend.sorted);else if(c.legend.sorted=="reverse")ye.reverse();else{var ze=c.legend.sorted!="descending";ye.sort(function(Tt,It){return Tt.label==It.label?0:Tt.label<It.label!=ze?1:-1})}for(var we=0;we<ye.length;++we){var Ve=ye[we];we%c.legend.noColumns==0&&(pe&&le.push("</tr>"),le.push("<tr>"),pe=!0),le.push('<td class="legendColorBox"><div style="border:1px solid '+c.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Ve.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Ve.label+"</td>")}if(pe&&le.push("</tr>"),le.length!=0){var ge='<table style="font-size:smaller;color:'+c.grid.color+'">'+le.join("")+"</table>";if(c.legend.container!=null)Z(c.legend.container).html(ge);else{var Ke="",qe=c.legend.position,ot=c.legend.margin;ot[0]==null&&(ot=[ot,ot]),qe.charAt(0)=="n"?Ke+="top:"+(ot[1]+x.top)+"px;":qe.charAt(0)=="s"&&(Ke+="bottom:"+(ot[1]+x.bottom)+"px;"),qe.charAt(1)=="e"?Ke+="right:"+(ot[0]+x.right)+"px;":qe.charAt(1)=="w"&&(Ke+="left:"+(ot[0]+x.left)+"px;");var lt=Z('<div class="legend">'+ge.replace('style="','style="position:absolute;'+Ke+";")+"</div>").appendTo(s);if(c.legend.backgroundOpacity!=0){var mt=c.legend.backgroundColor;mt==null&&(mt=c.grid.backgroundColor,mt&&typeof mt=="string"?mt=Z.color.parse(mt):mt=Z.color.extract(lt,"background-color"),mt.a=1,mt=mt.toString());var Lt=lt.children();Z('<div style="position:absolute;width:'+Lt.width()+"px;height:"+Lt.height()+"px;"+Ke+"background-color:"+mt+';"> </div>').prependTo(lt).css("opacity",c.legend.backgroundOpacity)}}}}}var Ie=[],Se=null;function Me(le,ye,pe){var ve=c.grid.mouseActiveRadius,be=ve*ve+1,Oe=null,we=!1,ze,Ve,ge;for(ze=i.length-1;ze>=0;--ze)if(pe(i[ze])){var Ke=i[ze],qe=Ke.xaxis,ot=Ke.yaxis,lt=Ke.datapoints.points,mt=qe.c2p(le),Lt=ot.c2p(ye),Tt=ve/qe.scale,It=ve/ot.scale;if(ge=Ke.datapoints.pointsize,qe.options.inverseTransform&&(Tt=Number.MAX_VALUE),ot.options.inverseTransform&&(It=Number.MAX_VALUE),Ke.lines.show||Ke.points.show)for(Ve=0;Ve<lt.length;Ve+=ge){var Mt=lt[Ve],Ut=lt[Ve+1];if(Mt!=null&&!(Mt-mt>Tt||Mt-mt<-Tt||Ut-Lt>It||Ut-Lt<-It)){var an=Math.abs(qe.p2c(Mt)-le),cn=Math.abs(ot.p2c(Ut)-ye),un=an*an+cn*cn;un<be&&(be=un,Oe=[ze,Ve/ge])}}if(Ke.bars.show&&!Oe){var On,yn;switch(Ke.bars.align){case"left":On=0;break;case"right":On=-Ke.bars.barWidth;break;default:On=-Ke.bars.barWidth/2}for(yn=On+Ke.bars.barWidth,Ve=0;Ve<lt.length;Ve+=ge){var Mt=lt[Ve],Ut=lt[Ve+1],En=lt[Ve+2];Mt!=null&&(i[ze].bars.horizontal?mt<=Math.max(En,Mt)&&mt>=Math.min(En,Mt)&&Lt>=Ut+On&&Lt<=Ut+yn:mt>=Mt+On&&mt<=Mt+yn&&Lt>=Math.min(En,Ut)&&Lt<=Math.max(En,Ut))&&(Oe=[ze,Ve/ge])}}}return Oe?(ze=Oe[0],Ve=Oe[1],ge=i[ze].datapoints.pointsize,{datapoint:i[ze].datapoints.points.slice(Ve*ge,(Ve+1)*ge),dataIndex:Ve,series:i[ze],seriesIndex:ze}):null}function Te(le){c.grid.hoverable&&He("plothover",le,function(ye){return ye.hoverable!=!1})}function Ge(le){c.grid.hoverable&&He("plothover",le,function(ye){return!1})}function Qe(le){E.isSelecting||He("plotclick",le,function(ye){return ye.clickable!=!1})}function tt(le){if(le.cancelable){if(!h.is(le.target)&&h.has(le.target).length===0){He("plotleave",le,function(ye){});return}Te(ke(le)),le.preventDefault()}}function ke(le){if(!le||!le.originalEvent||le.pageX&&le.pageY)return le;var ye=le.originalEvent;if(ye.changedTouches.length===0)return le;var pe=ye.changedTouches[0];return le.pageX=pe.pageX,le.pageY=pe.pageY,le}function He(le,ye,pe){var ve=h.offset(),be=ye.pageX-ve.left-x.left,Oe=ye.pageY-ve.top-x.top,we=W({left:be,top:Oe});we.pageX=ye.pageX,we.pageY=ye.pageY,we.ctrlKey=ye.ctrlKey,we.metaKey=ye.metaKey;var ze=Me(be,Oe,pe);if(ze&&(ze.pageX=parseInt(ze.series.xaxis.p2c(ze.datapoint[0])+ve.left+x.left,10),ze.pageY=parseInt(ze.series.yaxis.p2c(ze.datapoint[1])+ve.top+x.top,10)),c.grid.autoHighlight){for(var Ve=0;Ve<Ie.length;++Ve){var ge=Ie[Ve];ge.auto==le&&!(ze&&ge.series==ze.series&&ge.point[0]==ze.datapoint[0]&&ge.point[1]==ze.datapoint[1])&&Ue(ge.series,ge.point)}ze&&Ae(ze.series,ze.datapoint,le)}s.trigger(le,[we,ze])}function Re(){var le=c.interaction.redrawOverlayInterval;if(le==-1){Ne();return}Se||(Se=setTimeout(Ne,le))}function Ne(){Se=null,g.save(),p.clear(),g.translate(x.left,x.top);var le,ye;for(le=0;le<Ie.length;++le)ye=Ie[le],ye.series.bars.show?_e(ye.series,ye.point):We(ye.series,ye.point);g.restore(),D(b.drawOverlay,[g])}function Ae(le,ye,pe){if(typeof le=="number"&&(le=i[le]),typeof ye=="number"){var ve=le.datapoints.pointsize;ye=le.datapoints.points.slice(ve*ye,ve*(ye+1))}var be=Be(le,ye);be==-1?(Ie.push({series:le,point:ye,auto:pe}),Re()):pe||(Ie[be].auto=!1)}function Ue(le,ye){if(le==null&&ye==null){Ie=[],Re();return}if(typeof le=="number"&&(le=i[le]),typeof ye=="number"){var pe=le.datapoints.pointsize;ye=le.datapoints.points.slice(pe*ye,pe*(ye+1))}var ve=Be(le,ye);ve!=-1&&(Ie.splice(ve,1),Re())}function Be(le,ye){for(var pe=0;pe<Ie.length;++pe){var ve=Ie[pe];if(ve.series==le&&ve.point[0]==ye[0]&&ve.point[1]==ye[1])return pe}return-1}function We(le,ye){var pe=ye[0],ve=ye[1],be=le.xaxis,Oe=le.yaxis,we=typeof le.highlightColor=="string"?le.highlightColor:Z.color.parse(le.color).scale("a",.5).toString();if(!(pe<be.min||pe>be.max||ve<Oe.min||ve>Oe.max)){var ze=le.points.radius+le.points.lineWidth/2;g.lineWidth=ze,g.strokeStyle=we;var Ve=1.5*ze;pe=be.p2c(pe),ve=Oe.p2c(ve),g.beginPath(),le.points.symbol=="circle"?g.arc(pe,ve,Ve,0,2*Math.PI,!1):le.points.symbol(g,pe,ve,Ve,!1),g.closePath(),g.stroke()}}function _e(le,ye){var pe=typeof le.highlightColor=="string"?le.highlightColor:Z.color.parse(le.color).scale("a",.5).toString(),ve=pe,be;switch(le.bars.align){case"left":be=0;break;case"right":be=-le.bars.barWidth;break;default:be=-le.bars.barWidth/2}g.lineWidth=le.bars.lineWidth,g.strokeStyle=pe,he(ye[0],ye[1],ye[2]||0,be,be+le.bars.barWidth,function(){return ve},le.xaxis,le.yaxis,g,le.bars.horizontal,le.bars.lineWidth)}function Xe(le,ye,pe,ve){if(typeof le=="string")return le;for(var be=r.createLinearGradient(0,pe,0,ye),Oe=0,we=le.colors.length;Oe<we;++Oe){var ze=le.colors[Oe];if(typeof ze!="string"){var Ve=Z.color.parse(ve);ze.brightness!=null&&(Ve=Ve.scale("rgb",ze.brightness)),ze.opacity!=null&&(Ve.a*=ze.opacity),ze=Ve.toString()}be.addColorStop(Oe/(we-1),ze)}return be}}Z.plot=function(s,l,o){var d=new n(Z(s),l,o,Z.plot.plugins);return d},Z.plot.version="0.8.3",Z.plot.plugins=[],Z.fn.plot=function(s,l){return this.each(function(){Z.plot(this,s,l)})};function a(s,l){return l*Math.floor(s/l)}}(jQuery)},80851:()=>{(function(Z){function R(e){var n={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},a={},s=null;function l(x){n.active&&(h(x),e.getPlaceholder().trigger("plotselecting",[i()]))}function o(x){x.which==1&&(document.body.focus(),document.onselectstart!==void 0&&a.onselectstart==null&&(a.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&a.ondrag==null&&(a.ondrag=document.ondrag,document.ondrag=function(){return!1}),p(n.first,x),n.active=!0,s=function(f){d(f)},Z(document).one("mouseup",s))}function d(x){return s=null,document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag),n.active=!1,h(x),v()?c(x):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function i(){if(!v()||!n.show)return null;var x={},f=n.first,u=n.second,b=e.getAxes(),E=!0;return Z.each(b,function(D,C){C.used&&(anyUsed=!1)}),Z.each(b,function(D,C){if(C.used||E){var P=C.c2p(f[C.direction]),T=C.c2p(u[C.direction]);x[D]={from:Math.min(P,T),to:Math.max(P,T)}}}),x}function c(x){var f=i();f.ctrlKey=x.ctrlKey,f.metaKey=x.metaKey,e.getPlaceholder().trigger("plotselected",[f]),f.xaxis&&f.yaxis&&e.getPlaceholder().trigger("selected",[{x1:f.xaxis.from,y1:f.yaxis.from,x2:f.xaxis.to,y2:f.yaxis.to}])}function m(x,f,u){return f<x?x:f>u?u:f}function p(x,f){var u=e.getOptions(),b=e.getPlaceholder().offset(),E=e.getPlotOffset();x.x=m(0,f.pageX-b.left-E.left,e.width()),x.y=m(0,f.pageY-b.top-E.top,e.height()),u.selection.mode=="y"&&(x.x=x==n.first?0:e.width()),u.selection.mode=="x"&&(x.y=x==n.first?0:e.height())}function h(x){x.pageX!=null&&(p(n.second,x),v()?(e.isSelecting=!0,n.show=!0,e.triggerRedrawOverlay()):r(!0))}function r(x){n.show&&(n.show=!1,e.triggerRedrawOverlay(),x||e.getPlaceholder().trigger("plotunselected",[]))}function g(x,f){var u,b,E,D,C=e.getAxes();for(var P in C)if(u=C[P],u.direction==f&&(D=f+u.n+"axis",!x[D]&&u.n==1&&(D=f+"axis"),x[D])){b=x[D].from,E=x[D].to;break}if(x[D]||(u=f=="x"?e.getXAxes()[0]:e.getYAxes()[0],b=x[f+"1"],E=x[f+"2"]),b!=null&&E!=null&&b>E){var T=b;b=E,E=T}return{from:b,to:E,axis:u}}function y(x,f){var u,b,E=e.getOptions();E.selection.mode=="y"?(n.first.x=0,n.second.x=e.width()):(b=g(x,"x"),n.first.x=b.axis.p2c(b.from),n.second.x=b.axis.p2c(b.to)),E.selection.mode=="x"?(n.first.y=0,n.second.y=e.height()):(b=g(x,"y"),n.first.y=b.axis.p2c(b.from),n.second.y=b.axis.p2c(b.to)),n.show=!0,e.triggerRedrawOverlay(),!f&&v()&&c()}function v(){var x=e.getOptions().selection.minSize;return Math.abs(n.second.x-n.first.x)>=x&&Math.abs(n.second.y-n.first.y)>=x}e.clearSelection=r,e.setSelection=y,e.getSelection=i,e.hooks.bindEvents.push(function(x,f){var u=x.getOptions();u.selection.mode!=null&&(f.mousemove(l),f.mousedown(o))}),e.hooks.drawOverlay.push(function(x,f){if(n.show&&v()){var u=x.getPlotOffset(),b=x.getOptions();f.save(),f.translate(u.left,u.top);var E=Z.color.parse(b.selection.color);f.strokeStyle=E.scale("a",.8).toString(),f.lineWidth=1,f.lineJoin=b.selection.shape,f.fillStyle=E.scale("a",.4).toString();var D=Math.min(n.first.x,n.second.x)+.5,C=Math.min(n.first.y,n.second.y)+.5,P=Math.abs(n.second.x-n.first.x)-1,T=Math.abs(n.second.y-n.first.y)-1;f.fillRect(D,C,P,T),f.strokeRect(D,C,P,T),f.restore()}}),e.hooks.shutdown.push(function(x,f){f.unbind("mousemove",l),f.unbind("mousedown",o),s&&(Z(document).unbind("mouseup",s),document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag))})}Z.plot.plugins.push({init:R,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(Z){var R={series:{stack:null}};function e(n){function a(l,o){for(var d=null,i=0;i<o.length&&l!=o[i];++i)o[i].stack==l.stack&&(d=o[i]);return d}function s(l,o,d){if(!(o.stack==null||o.stack===!1)){var i=a(o,l.getData());if(i){for(var c=d.pointsize,m=d.points,p=i.datapoints.pointsize,h=i.datapoints.points,r=[],g,y,v,x,f,u,b=o.lines.show,E=o.bars.horizontal,D=c>2&&(E?d.format[2].x:d.format[2].y),C=b&&o.lines.steps,P=E?1:0,T=E?0:1,O=0,I=0,j,W;!(O>=m.length&&I>=h.length);){if(j=r.length,O<m.length&&m[O]==null){for(W=0;W<c;++W)r.push(m[O+W]);O+=c}else if(O>=m.length){for(W=0;W<c;++W)r.push(h[I+W]);D&&(r[j+2]=h[I+T]),I+=p}else if(I>=h.length){for(W=0;W<c;++W)r.push(m[O+W]);O+=c}else if(I<h.length&&h[I]==null)I+=p;else{if(g=m[O+P],y=m[O+T],x=h[I+P],f=h[I+T],u=0,g==x){for(W=0;W<c;++W)r.push(m[O+W]);r[j+T]+=f,u=f,O+=c,I+=p}else if(g>x){if(O==0){for(W=0;W<c;++W)r.push(h[I+W]);u=f}if(O>0&&m[O-c]!=null){for(v=0,r.push(x),r.push(v+f),W=2;W<c;++W)r.push(m[O+W]);u=f}I+=p}else{for(W=0;W<c;++W)r.push(m[O+W]);I>0&&h[I-p]!=null&&(u=0),r[j+T]+=u,O+=c}fromgap=!1,j!=r.length&&D&&(r[j+2]=u)}if(C&&j!=r.length&&j>0&&r[j]!=null&&r[j]!=r[j-c]&&r[j+1]!=r[j-c+1]){for(W=0;W<c;++W)r[j+c+W]=r[j+W];r[j+1]=r[j-c+1]}}d.points=r}}}n.hooks.processDatapoints.push(s)}Z.plot.plugins.push({init:e,options:R,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(Z){var R={series:{stackpercent:null}};function e(n){var a={},s=!1,l={};function o(c,m,p,h){if(s||(s=!0,l=d(c.getData())),m.stackpercent==!0){var r=p.length;m.percents=[];var g=0,y=1;m.bars&&m.bars.horizontal&&m.bars.horizontal===!0&&(g=1,y=0);for(var v=0;v<r;v++){var x=l[p[v][g]+""];x>0?m.percents.push(p[v][y]*100/x):m.percents.push(0)}}}function d(c){var m=c.length,p={};if(m>0){for(var h=0;h<m;h++)if(c[h].stackpercent){var r=0,g=1;c[h].bars&&c[h].bars.horizontal&&c[h].bars.horizontal===!0&&(r=1,g=0);for(var y=c[h].data.length,v=0;v<y;v++){var x=0;c[h].data[v][1]!=null&&(x=c[h].data[v][g]),p[c[h].data[v][r]+""]?p[c[h].data[v][r]+""]+=x:p[c[h].data[v][r]+""]=x}}}return p}function i(c,m,p){if(m.stackpercent){s||(l=d(c.getData()));var h=[],r=0,g=1;m.bars&&m.bars.horizontal&&m.bars.horizontal===!0&&(r=1,g=0);for(var y=0;y<p.points.length;y+=3)a[p.points[y+r]]||(a[p.points[y+r]]=0),h[y+r]=p.points[y+r],h[y+g]=p.points[y+g]+a[p.points[y+r]],h[y+2]=a[p.points[y+r]],a[p.points[y+r]]+=p.points[y+g],l[h[y+r]+""]>0?(h[y+g]=h[y+g]*100/l[h[y+r]+""],h[y+2]=h[y+2]*100/l[h[y+r]+""]):(h[y+g]=0,h[y+2]=0);p.points=h}}n.hooks.processRawData.push(o),n.hooks.processDatapoints.push(i)}Z.plot.plugins.push({init:e,options:R,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(Z){var R={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(m,p){return p*Math.floor(m/p)}function n(m,p,h,r){if(typeof m.strftime=="function")return m.strftime(p);var g=function(D,C){return D=""+D,C=""+(C??"0"),D.length==1?C+D:D},y=[],v=!1,x=m.getHours(),f=x<12;h==null&&(h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),r==null&&(r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var u;x>12?u=x-12:x==0?u=12:u=x;for(var b=0;b<p.length;++b){var E=p.charAt(b);if(v){switch(E){case"a":E=""+r[m.getDay()];break;case"b":E=""+h[m.getMonth()];break;case"d":E=g(m.getDate(),"");break;case"e":E=g(m.getDate()," ");break;case"h":case"H":E=g(x);break;case"I":E=g(u);break;case"l":E=g(u," ");break;case"m":E=g(m.getMonth()+1,"");break;case"M":E=g(m.getMinutes());break;case"q":E=""+(Math.floor(m.getMonth()/3)+1);break;case"S":E=g(m.getSeconds());break;case"y":E=g(m.getFullYear()%100);break;case"Y":E=""+m.getFullYear();break;case"p":E=f?"am":"pm";break;case"P":E=f?"AM":"PM";break;case"w":E=""+m.getDay();break}y.push(E),v=!1}else E=="%"?v=!0:y.push(E)}return y.join("")}function a(m){function p(y,v,x,f){y[v]=function(){return x[f].apply(x,arguments)}}var h={date:m};m.strftime!=null&&p(h,"strftime",m,"strftime"),p(h,"getTime",m,"getTime"),p(h,"setTime",m,"setTime");for(var r=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],g=0;g<r.length;g++)p(h,"get"+r[g],m,"getUTC"+r[g]),p(h,"set"+r[g],m,"setUTC"+r[g]);return h}function s(m,p){if(p.timezone=="browser")return new Date(m);if(!p.timezone||p.timezone=="utc")return a(new Date(m));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var h=new timezoneJS.Date;return h.setTimezone(p.timezone),h.setTime(m),h}else return a(new Date(m))}var l={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},o=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],d=o.concat([[3,"month"],[6,"month"],[1,"year"]]),i=o.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function c(m){m.hooks.processOptions.push(function(p,h){Z.each(p.getAxes(),function(r,g){var y=g.options;y.mode=="time"&&(g.tickGenerator=function(v){var x=[],f=s(v.min,y),u=0,b=y.tickSize&&y.tickSize[1]==="quarter"||y.minTickSize&&y.minTickSize[1]==="quarter"?i:d;y.minTickSize!=null&&(typeof y.tickSize=="number"?u=y.tickSize:u=y.minTickSize[0]*l[y.minTickSize[1]]);for(var E=0;E<b.length-1&&!(v.delta<(b[E][0]*l[b[E][1]]+b[E+1][0]*l[b[E+1][1]])/2&&b[E][0]*l[b[E][1]]>=u);++E);var D=b[E][0],C=b[E][1];if(C=="year"){if(y.minTickSize!=null&&y.minTickSize[1]=="year")D=Math.floor(y.minTickSize[0]);else{var P=Math.pow(10,Math.floor(Math.log(v.delta/l.year)/Math.LN10)),T=v.delta/l.year/P;T<1.5?D=1:T<3?D=2:T<7.5?D=5:D=10,D*=P}D<1&&(D=1)}v.tickSize=y.tickSize||[D,C];var O=v.tickSize[0];C=v.tickSize[1];var I=O*l[C];C=="second"?f.setSeconds(e(f.getSeconds(),O)):C=="minute"?f.setMinutes(e(f.getMinutes(),O)):C=="hour"?f.setHours(e(f.getHours(),O)):C=="month"?f.setMonth(e(f.getMonth(),O)):C=="quarter"?f.setMonth(3*e(f.getMonth()/3,O)):C=="year"&&f.setFullYear(e(f.getFullYear(),O)),f.setMilliseconds(0),I>=l.minute&&f.setSeconds(0),I>=l.hour&&f.setMinutes(0),I>=l.day&&f.setHours(0),I>=l.day*4&&f.setDate(1),I>=l.month*2&&f.setMonth(e(f.getMonth(),3)),I>=l.quarter*2&&f.setMonth(e(f.getMonth(),6)),I>=l.year&&f.setMonth(0);var j=0,W=Number.NaN,B;do if(B=W,W=f.getTime(),x.push(W),C=="month"||C=="quarter")if(O<1){f.setDate(1);var S=f.getTime();f.setMonth(f.getMonth()+(C=="quarter"?3:1));var w=f.getTime();f.setTime(W+j*l.hour+(w-S)*O),j=f.getHours(),f.setHours(0)}else f.setMonth(f.getMonth()+O*(C=="quarter"?3:1));else C=="year"?f.setFullYear(f.getFullYear()+O):f.setTime(W+I);while(W<v.max&&W!=B);return x},g.tickFormatter=function(v,x){var f=s(v,x.options);if(y.timeformat!=null)return n(f,y.timeformat,y.monthNames,y.dayNames);var u=x.options.tickSize&&x.options.tickSize[1]=="quarter"||x.options.minTickSize&&x.options.minTickSize[1]=="quarter",b=x.tickSize[0]*l[x.tickSize[1]],E=x.max-x.min,D=y.twelveHourClock?" %p":"",C=y.twelveHourClock?"%I":"%H",P;b<l.minute?P=C+":%M:%S"+D:b<l.day?E<2*l.day?P=C+":%M"+D:P="%b %d "+C+":%M"+D:b<l.month?P="%b %d":u&&b<l.quarter||!u&&b<l.year?E<l.year?P="%b":P="%b %Y":u&&b<l.year?E<l.year?P="Q%q":P="Q%q %Y":P="%Y";var T=n(f,P,y.monthNames,y.dayNames);return T})})})}Z.plot.plugins.push({init:c,options:R,name:"time",version:"1.0"}),Z.plot.formatDate=n})(jQuery)}}]);

//# sourceMappingURL=6044.1886628406e0046414a4.js.map