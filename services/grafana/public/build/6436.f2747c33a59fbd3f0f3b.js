"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6436],{75044:(fe,Z,l)=>{l.d(Z,{A:()=>e});function e(L){L.getRowProps.push(S=>[S,C()]),L.getHeaderGroupProps.push(S=>[S,C()]),L.getFooterGroupProps.push(S=>[S,C()]),L.getHeaderProps.push((S,{column:F})=>[S,r(F)]),L.getCellProps.push((S,{cell:F})=>[S,r(F.column)]),L.getFooterProps.push((S,{column:F})=>[S,r(F)])}e.pluginName="useCustomFlexLayout";function r(L){return{style:{flex:L.totalWidth===0?"0 0 auto":`${L.totalWidth} 0 0`}}}function C(){return{style:{display:"flex",flex:"1 0 auto"}}}},86436:(fe,Z,l)=>{l.d(Z,{P:()=>ge});var e=l(74848),r=l(22803),C=l(96540),L=l(32885),S=l(97222),F=l(10022),I=l(92745),oe=l(739),q=l(63142),re=l(59692),ie=l(28533),ce=l(75044),de=l(5478),ue=l(67676),g=l(70255),H=l(95004),Y=l(11576),G=l(16515),_=l(55386),T=l(43173),Q=l(78282),U=l(32635),O=l(30703),k=l(66404),$=l(45967),K=l(37658),R=l(45229),d=l(12810),W=l(13660),le=l(87745),ee=l(93854),te=l(52792),je=l(22787),Ce=l(13941),xe=l(50992),De=l(13326);const ae=[{label:"Score",value:"score"},{label:"Fields",value:"fields"},{label:"Allowed actions",value:"allowed_actions"}];function Pe({name:s,explain:t,frame:u,row:i}){const[c,n]=(0,C.useState)(!0),[f,j]=(0,C.useState)("score"),p=(0,e.jsx)(te.J,{title:s,icon:"info",tabs:ae,activeTab:f,onChangeTab:o=>{j(o.value)}});return(0,e.jsx)(je.a,{title:p,isOpen:c,onDismiss:()=>n(!1),closeOnBackdropClick:!0,closeOnEscape:!0,children:(0,e.jsxs)(Ce.J,{children:[f===ae[0].value&&(0,e.jsx)(xe.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!0,value:JSON.stringify(t,null,2),readOnly:!1}),f===ae[1].value&&(0,e.jsx)("div",{children:(0,e.jsx)(De.e,{data:u,rowIndex:i})}),f===ae[2].value&&(0,e.jsx)(xe.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!1,value:(()=>{const o=u.fields.find(w=>w.name==="allowed_actions")?.values?.[i],a=u.fields.find(w=>w.name==="ds_uid")?.values?.[i];return JSON.stringify({dsUids:a??[],allowedActions:o??[]},null,2)})(),readOnly:!1})]})})}const we=175,Se=200,Ie=200,Ee=(s,t,u,i,c,n,f,j,p)=>{const o=[],a=s.view.fields,w=a.uid,E=a.kind;let D=0;const M=a[s.view.dataFrame.meta?.custom?.sortBy];M&&(D=175,M.type===H.PU.time&&(D+=25),t-=D),a.explain&&a.score&&(t-=100);let x=50;u&&i&&(x=0,o.push({id:"column-checkbox",width:x,Header:()=>{const{view:h}=s,y=u("*","*"),m=h.every(N=>u(N.kind,N.uid));return(0,e.jsx)(U.S,{indeterminate:!m&&y,checked:m,disabled:!s,onChange:N=>{if(y)c();else for(let v=0;v<h.length;v++){const P=h.get(v);i(P.kind,P.uid)}}})},Cell:h=>{const y=w.values[h.row.index],m=E?E.values[h.row.index]:"dashboard",N=u(m,y),v=y!=null,{key:P,...z}=h.cellProps;return(0,e.jsx)("div",{...z,className:n.cell,children:(0,e.jsx)(U.S,{disabled:!v,value:N&&v,onChange:pe=>{i(m,y)}})},P)},field:w}),t-=x),x=Math.max(t*.2,300),o.push({Cell:h=>{let y=(0,r.cx)(n.nameCellStyle),m=a.name.values[h.row.index];const N=a.isDeleted?.values[h.row.index];m?.length||(m=h.row.index>=s.view.dataFrame.length?"Loading...":"Missing title",y+=" "+n.missingTitleText);const{key:v,...P}=h.cellProps;return(0,e.jsx)("div",{className:n.cell,...P,children:s.isItemLoaded(h.row.index)?N?(0,e.jsx)("span",{className:y,children:m}):(0,e.jsx)("a",{href:h.userProps.href,onClick:h.userProps.onClick,className:y,title:m,children:m}):(0,e.jsx)(g.A,{width:200})},v)},id:"column-name",field:a.name,Header:()=>(0,e.jsx)("div",{children:(0,I.t)("search.results-table.name-header","Name")}),width:x}),t-=x,s.view.fields.permanentlyDeleteDate&&ve(s.view.fields.permanentlyDeleteDate)&&a.permanentlyDeleteDate?(x=Se,o.push(Ne(s,a.permanentlyDeleteDate,x,n)),t-=x):(x=we,o.push(Le(s,a.kind,a.panel_type,x,n)),t-=x),a.ds_uid&&j&&(x=Math.min(t/2.5,Ie),o.push(Me(a.ds_uid,x,n.typeIcon,n.datasourceItem,n.invalidDatasourceItem,j)),t-=x);const X=!p||ve(s.view.fields.tags),se=s.view.dataFrame.meta?.custom;if(se?.locationInfo&&t>0&&(x=X?Math.max(t/1.75,300):t,t-=x,o.push({Cell:h=>{const y=(a.location?.values[h.row.index]??"").split("/"),{key:m,...N}=h.cellProps;return(0,e.jsx)("div",{...N,className:n.cell,children:s.isItemLoaded(h.row.index)?(0,e.jsx)("div",{className:n.locationContainer,children:y.map(v=>{let P=se.locationInfo[v];if(!P&&v==="general"&&(P={kind:"folder",url:"/dashboards",name:"Dashboards"}),P){const z=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.I,{name:(0,ee.TM)(P.kind)}),(0,e.jsx)(k.E,{variant:"body",truncate:!0,children:P.name})]});return P.url?(0,e.jsx)("a",{href:P.url,className:n.locationItem,children:z},v):(0,e.jsx)("div",{className:n.locationItem,children:z},v)}return(0,e.jsx)("span",{children:v},v)})}):(0,e.jsx)(g.A,{width:150})},m)},id:"column-location",field:a.location??a.url,Header:(0,I.t)("search.results-table.location-header","Location"),width:x})),t>0&&X&&o.push(Te(s,a.tags,t,n,f)),M&&D){const h=M.display??(0,Y.J)({field:M,theme:T.$.theme2});o.push({Header:(0,G.Ct)(M),Cell:y=>{const{key:m,...N}=y.cellProps;return(0,e.jsx)("div",{...N,className:n.cell,children:Oe({sortField:M,getDisplay:h,index:y.row.index,kind:a.kind})},m)},id:"column-sort-field",field:M,width:D})}if(a.explain&&a.score){const h=a.score.values,y=m=>{R.A.publish(new le.S8({component:Pe,props:{name:a.name.values[m],explain:a.explain.values[m],frame:s.view.dataFrame,row:m}}))};o.push({Header:()=>(0,e.jsx)("div",{className:n.sortedHeader,children:(0,e.jsx)(I.x6,{i18nKey:"search.generate-columns.score",children:"Score"})}),Cell:m=>{const{key:N,...v}=m.cellProps;return(0,e.jsx)("div",{...v,className:(0,r.cx)(n.cell,n.explainItem),onClick:()=>y(m.row.index),children:h[m.row.index]},N)},id:"column-score-field",field:a.score,width:100})}return o};function ve(s){for(let t=0;t<s.values.length;t++)if(s.values[t]!=null)return!0;return!1}function Me(s,t,u,i,c,n){const f=(0,Q.l)();return{id:"column-datasource",field:s,Header:(0,I.t)("search.results-table.datasource-header","Data source"),Cell:j=>{const p=s.values[j.row.index];if(!p?.length)return null;const{key:o,...a}=j.cellProps;return(0,e.jsx)("div",{...a,className:(0,r.cx)(i),children:p.map((w,E)=>{const D=f.getInstanceSettings(w),M=D?.meta?.info?.logos?.small;return M?(0,e.jsxs)("span",{onClick:x=>{x.stopPropagation(),x.preventDefault(),n(D.uid)},children:[(0,e.jsx)("img",{src:M,alt:"",width:14,height:14,title:D.type,className:u}),D.name]},E):(0,e.jsx)("span",{className:c,children:w},E)})},o)},width:t}}function Ne(s,t,u,i){return{id:"column-delete-age",field:t,width:u,Header:(0,I.t)("search.results-table.deleted-remaining-header","Time remaining"),Cell:c=>{const n=c.row.index,f=t.values[n],{key:j,...p}=c.cellProps;if(!f||!s.isItemLoaded(c.row.index))return(0,e.jsx)("div",{...p,className:(0,r.cx)(i.cell,i.typeCell),children:(0,e.jsx)(g.A,{width:100})},j);const o=Re(new Date,f),w=!Object.values(o).some(E=>E>0)?(0,I.t)("search.results-table.deleted-less-than-1-min","< 1 min"):(0,d.a)(o,{style:"long"});return(0,e.jsx)("div",{...p,className:(0,r.cx)(i.cell,i.typeCell),children:(0,e.jsx)($.m,{content:(0,d.Y)(f,{dateStyle:"medium",timeStyle:"short"}),children:(0,e.jsx)("span",{children:w})})},j)}}}function Le(s,t,u,i,c){return{id:"column-type",field:t??u,Header:(0,I.t)("search.results-table.type-header","Type"),Cell:n=>{const f=n.row.index,j=t?.values[f]??"dashboard";let p="apps",o="Dashboard";if(j)switch(o=j,o){case"dashboard":o=(0,I.t)("search.results-table.type-dashboard","Dashboard");break;case"folder":p="folder",o=(0,I.t)("search.results-table.type-folder","Folder");break;case"panel":p=`${W.Ip.panel}`;const E=u.values[f];if(E){o=E;const D=T.$.panels[o];if(D?.name)o=D.name;else switch(E){case"row":o="Row",p="bars";break;case"singlestat":o="Singlestat";break;default:p="question-circle"}}break}const{key:a,...w}=n.cellProps;return(0,e.jsx)("div",{...w,className:(0,r.cx)(c.cell,c.typeCell),children:s.isItemLoaded(n.row.index)?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.I,{name:p,size:"sm",title:o,className:c.typeIcon}),o]}):(0,e.jsx)(g.A,{width:100})},a)},width:i}}function Te(s,t,u,i,c){return{Cell:n=>{const f=t.values[n.row.index],{key:j,...p}=n.cellProps;return(0,e.jsx)("div",{...p,className:i.cell,children:s.isItemLoaded(n.row.index)?(0,e.jsx)(e.Fragment,{children:f?(0,e.jsx)(K.L,{className:i.tagList,tags:f,onClick:c}):null}):(0,e.jsx)(K.L.Skeleton,{})},j)},id:"column-tags",field:t,Header:(0,I.t)("search.results-table.tags-header","Tags"),width:u}}function Oe({kind:s,sortField:t,index:u,getDisplay:i}){const c=t.values[u];return["folder","panel"].includes(s.values[u])&&c===0?"-":(0,_.cN)(i(c))}function Re(s,t){let{years:u=0,months:i=0,days:c=0,hours:n=0,minutes:f=0}=(0,ue.F)({start:s,end:t});return u>0?{years:u}:i>0?{months:i}:c>0?{days:c}:n>0?{hours:n}:{minutes:f}}const he=36,ge=C.memo(({response:s,width:t,height:u,selection:i,selectionToggle:c,clearSelection:n,onTagSelected:f,onDatasourceChange:j,onClickItem:p,keyboardEvents:o})=>{const a=(0,q.of)(Ae),w=(0,q.of)(be),E=(0,re.k)((0,q.$j)(),oe.qM.Sm),D=(0,C.useRef)(null),[M,x]=(0,C.useState)(null),me=(0,de.n)(o,0,s),X=(0,C.useMemo)(()=>s?.view?.dataFrame.fields.length?Array(s.totalRows).fill(0):[],[s]);(0,C.useEffect)(()=>{D.current&&D.current.resetloadMoreItemsCache(),M&&M.scrollTo(0)},[X,M]);const se=(0,C.useMemo)(()=>Ee(s,t,i,c,n,w,f,j,s.view?.length>=s.totalRows),[s,t,w,i,c,n,f,j]),h=(0,C.useMemo)(()=>({columns:se,data:X}),[se,X]),{getTableProps:y,getTableBodyProps:m,headerGroups:N,rows:v,prepareRow:P}=(0,L.useTable)(h,ce.A),z=(0,C.useCallback)(async(A,J)=>{await s.loadMoreItems(A,J);const b=i?.("*","*");if(!(!c||!i||!b))for(let V=A;V<s.view.length;V++){const B=s.view.get(V);i(B.kind,B.uid)||c(B.kind,B.uid)}},[s,i,c]),pe=(0,C.useCallback)(({index:A,style:J})=>{const b=v[A];P(b);const V=s.view.fields.url?.values[A];let B=a.rowContainer;A===me.y&&(B+=" "+a.selectedRow);const{key:ne,...He}=b.getRowProps({style:J});return(0,e.jsx)("div",{...He,className:B,children:b.cells.map((Fe,ye)=>(0,e.jsx)(ie.n,{tableStyles:E,cell:Fe,columnIndex:ye,columnCount:b.cells.length,userProps:{href:V,onClick:p},frame:s.view.dataFrame},ye))},ne)},[v,P,s.view.fields.url?.values,me,a,E,p,s.view.dataFrame]);return v.length?(0,e.jsxs)("div",{...y(),"aria-label":(0,I.t)("search.search-results-table.aria-label-search-results-table","Search results table"),role:"table",children:[N.map(A=>{const{key:J,...b}=A.getHeaderGroupProps({style:{width:t}});return(0,e.jsx)("div",{...b,className:a.headerRow,children:A.headers.map(V=>{const{key:B,...ne}=V.getHeaderProps();return(0,e.jsx)("div",{...ne,role:"columnheader",className:a.headerCell,children:V.render("Header")},B)})},J)}),(0,e.jsx)("div",{...m(),children:(0,e.jsx)(F.A,{ref:D,isItemLoaded:s.isItemLoaded,itemCount:v.length,loadMoreItems:z,children:({onItemsRendered:A,ref:J})=>(0,e.jsx)(S.Y1,{ref:b=>{J(b),x(b)},onItemsRendered:A,height:u-he,itemCount:v.length,itemSize:E.rowHeight,width:t,style:{overflow:"hidden auto"},children:pe})})})]}):(0,e.jsx)("div",{className:a.noData,children:(0,e.jsx)(I.x6,{i18nKey:"search.search-results-table.no-data",children:"No values"})})});ge.displayName="SearchResultsTable";const Ae=s=>{const t=s.colors.action.hover;return{noData:(0,r.css)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}),headerCell:(0,r.css)({alignItems:"center",display:"flex",overflo:"hidden",padding:s.spacing(1)}),headerRow:(0,r.css)({backgroundColor:s.colors.background.secondary,display:"flex",gap:s.spacing(1),height:`${he}px`}),selectedRow:(0,r.css)({backgroundColor:t,boxShadow:`inset 3px 0px ${s.colors.primary.border}`}),rowContainer:(0,r.css)({display:"flex",gap:s.spacing(1),height:`${he}px`,label:"row","&:hover":{backgroundColor:t},"&:not(:hover) div[role='cell']":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})}},be=s=>({cell:(0,r.css)({padding:s.spacing(1),overflow:"hidden",display:"flex",alignItems:"center"}),nameCellStyle:(0,r.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),typeCell:(0,r.css)({gap:s.spacing(.5)}),typeIcon:(0,r.css)({fill:s.colors.text.secondary}),datasourceItem:(0,r.css)({span:{"&:hover":{color:s.colors.text.link}}}),missingTitleText:(0,r.css)({color:s.colors.text.disabled,fontStyle:"italic"}),invalidDatasourceItem:(0,r.css)({color:s.colors.error.main,textDecoration:"line-through"}),locationContainer:(0,r.css)({display:"flex",flexWrap:"nowrap",gap:s.spacing(1),overflow:"hidden"}),locationItem:(0,r.css)({alignItems:"center",color:s.colors.text.secondary,display:"flex",flexWrap:"nowrap",gap:"4px",overflow:"hidden"}),explainItem:(0,r.css)({cursor:"pointer"}),tagList:(0,r.css)({justifyContent:"flex-start",flexWrap:"nowrap"})})},13326:(fe,Z,l)=>{l.d(Z,{e:()=>de});var e=l(74848),r=l(22803),C=l(16515),L=l(55386),S=l(46635),F=l(92745),I=l(739),oe=l(63142),q=l(89640),re=l(53049),ie=l(70362);function ce(g,H,Y,G,_){const T=g.fields,Q=Y!=null?T[Y]:null,U=T.filter(d=>!d.config.custom?.hideFrom?.tooltip),O=U.find(d=>d.name==="traceID")||T[0],k=[];if(U.filter(d=>O===d).length>0&&k.push(O),k.push(...U.filter(d=>O!==d)),k.length===0)return null;const $=[],K=[],R=new Set;for(const d of k){if(_===I.$N.Single&&d!==Q)continue;const W=d.values[H],le=d.display?d.display(W):{text:`${W}`,numeric:+W};d.getLinks&&d.getLinks({calculatedValue:le,valueRowIndex:H}).forEach(ee=>{const te=`${ee.title}/${ee.href}`;R.has(te)||(K.push(ee),R.add(te))}),$.push({name:(0,C.Ct)(d,g),value:W,valueString:(0,L.cN)(le),highlight:d===Q})}return G&&G!==I.xB.None&&$.sort((d,W)=>S.sortValues(G)(d.value,W.value)),{displayValues:$,links:K}}const de=({data:g,rowIndex:H,columnIndex:Y,sortOrder:G,mode:_,header:T,padding:Q=0,maxHeight:U})=>{const O=(0,oe.of)(ue,Q);if(!g||H==null)return null;const k=ce(g,H,Y,G,_);if(k==null)return null;const{displayValues:$,links:K}=k;return T==="Exemplar"?(0,e.jsx)(ie.i,{displayValues:$,links:K,header:T,maxHeight:U}):(0,e.jsxs)("div",{className:O.wrapper,children:[T&&(0,e.jsx)("div",{className:O.header,children:(0,e.jsx)("span",{className:O.title,children:T})}),(0,e.jsx)("table",{className:O.infoWrap,children:(0,e.jsxs)("tbody",{children:[$.map((R,d)=>(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:R.name}),(0,e.jsx)("td",{children:(0,re.A)(R.valueString)})]},`${d}/${H}`)),K.map((R,d)=>(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:(0,e.jsx)(F.x6,{i18nKey:"visualization.data-hover-view.link",children:"Link"})}),(0,e.jsx)("td",{colSpan:2,children:(0,e.jsx)(q.Y,{href:R.href,external:R.target==="_blank",weight:"medium",inline:!1,children:R.title})})]},d))]})})]})},ue=(g,H=0)=>({wrapper:(0,r.css)({padding:`${H}px`,background:g.components.tooltip.background,borderRadius:g.shape.borderRadius(2)}),header:(0,r.css)({background:g.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:g.spacing(1)}),title:(0,r.css)({fontWeight:g.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,r.css)({padding:g.spacing(1),background:"transparent",border:"none",th:{fontWeight:g.typography.fontWeightMedium,padding:g.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${g.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,r.css)({color:g.colors.text.link})})}}]);

//# sourceMappingURL=6436.f2747c33a59fbd3f0f3b.js.map