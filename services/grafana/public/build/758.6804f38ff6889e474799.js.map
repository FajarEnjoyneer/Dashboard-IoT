{"version":3,"file":"758.6804f38ff6889e474799.js","mappings":"+MAsBA,MAAMA,KAAW,OAAI,CACnB,UAAW,QACb,CAAC,EAEKC,KAAgB,OAAI,CACxB,SAAU,QACV,OAAQ,QACV,CAAC,EAmED,EAjEqB,CAAC,CACpB,MAAAC,EACA,WAAAC,EACA,WAAAC,EACA,YAAAC,EACA,eAAAC,EACA,QAAAC,EACA,OAAAC,EACA,WAAAC,EACA,gBAAAC,EACA,aAAAC,EACA,QAAAC,EACA,aAAAC,CACF,IAAa,CACX,MAAMC,EAAS,OAEX,oBACG,UAAAN,KACC,QAAC,QACC,oBAAC,IAAI,CAAC,KAAK,QAAS,MACpB,QAAC,KAAK,CAAC,QAAQ,yBAAyB,qBAAS,CAAE,OAAAA,CAAO,GAAE,EAC3DC,MACC,OAAC,KAAE,KAAMA,EAAY,OAAQE,EAAc,UAAU,YAClD,SAAAD,CAAA,CACH,IANM,cAQV,EAEA,GAEDE,KACC,OAAC,IAAK,CAAC,SAAS,OAAO,MAAOC,GAAgB,GAAI,UAAWZ,EAC3D,mBAAC,OAAI,wBAAyBW,CAAA,CAAS,EACzC,EAEA,IAEJ,EAIEG,EAAuBD,EAAO,EAIhC,MAHA,OAAI,CACF,aAAc,MAChB,CAAC,EAGCE,EAAWZ,EAAa,KAAa,KACrCa,KACJ,OAACD,EAAA,CACC,KAAK,KACL,QAAAT,EACA,KAAMH,EACN,KAAMD,EACN,UAAWY,EACX,cAAa,KAAU,WAAW,iBAAiB,SAASV,CAAW,EACvE,SAAUC,EAET,SAAAD,CAAA,CACH,EAGF,SAAO,OAAC,IAAgB,CAAC,UAAWL,EAAU,QAASE,EAAO,OAAQY,EAAO,EAAG,oBAAqBG,CAAA,CAAY,CACnH,C,mLCtFO,MAAMC,EAAYC,GAAiB,CACxC,KAAM,CAAE,sBAAAC,EAAuB,WAAAC,EAAY,OAAAC,CAAO,EAAIH,EAChDI,EACJ,KAAW,wBAAwB,sBAAoB,wBAAyBF,CAAU,GAC1FA,EAAW,WAAa,GAE1B,OAAOA,EAAW,UAAU,uBAC1B,OAACG,EAAA,GACC,SAAO,KACL,wDACA,iDACF,EACA,eAAa,KAAE,wCAAyC,QAAQ,EAChE,WAAW,WACX,UAAQ,KACN,yDACA,yEACF,EACA,eAAgB,GAClB,KAEA,OAACA,EAAA,GACC,SAAO,KAAE,8CAA+C,8CAA8C,EACtG,eAAa,KAAE,yCAA0C,QAAQ,EACjE,WAAW,WACX,QAAS,IAAM,CACbJ,EAAsBE,CAAM,CAC9B,EACA,UAAQ,KACN,+CACA,uFACF,EACA,WAAW,oEACX,mBAAiB,KAAE,oDAAqD,YAAY,EACpF,eAAgB,CAACC,CAAA,CACnB,CAEJ,E,0BCnCO,MAAME,EAAcN,GAAiB,CAC1C,KAAM,CAAE,WAAAO,EAAY,WAAAL,EAAY,OAAAC,CAAO,EAAIH,EACrC,CAACQ,EAAgBC,CAAiB,KAAI,YAAS,EAAK,EAEpDC,EAAyBC,GAAkB,IAAM,CACrDF,EAAkBE,CAAI,CACxB,EAEMC,EAAmB,IAAM,CAC7BL,EAAWJ,CAAM,EACjBM,EAAkB,EAAK,CACzB,EAEML,EACJ,KAAW,wBAAwB,sBAAoB,wBAAyBF,CAAU,GAC1FA,EAAW,WAAa,GAE1B,SACE,QAAC,OACC,oBAACW,EAAA,GAAM,CAAC,QAAQ,cAAc,QAASH,EAAsB,EAAI,EAAG,SAAU,CAACN,EAC7E,mBAAC,KAAK,CAAC,QAAQ,kCAAkC,uBAAW,EAC9D,KACA,OAACU,EAAA,GACC,OAAQN,EACR,SAAO,KAAE,wCAAyC,aAAa,EAC/D,QAAM,KACJ,uCACA,2KACF,EACA,eAAa,KAAE,+CAAgD,aAAa,EAC5E,UAAWI,EACX,UAAWF,EAAsB,EAAK,EACxC,GACF,CAEJ,E,sECrCO,MAAMK,EAAwBf,GAAiB,CACpD,KAAM,CAAE,uBAAAgB,EAAwB,WAAAd,EAAY,OAAAC,CAAO,EAAIH,EAEjDI,EACJ,KAAW,wBAAwB,sBAAoB,wBAAyBF,CAAU,GAC1FA,EAAW,WAAa,GAE1B,SACE,OAACW,EAAA,GAAM,CAAC,QAAQ,cAAc,QAAS,IAAMG,EAAuBb,CAAM,EAAG,SAAU,CAACC,EACtF,mBAAC,KAAK,CAAC,QAAQ,yCAAyC,mBAAO,EACjE,CAEJ,ECJaa,EAAqBjB,GAAsC,CACtE,KAAM,CACJ,sBAAAkB,EACA,OAAAf,EACA,cAAAgB,EACA,iBAAAC,EACA,aAAAC,EACA,aAAAC,EACA,gBAAAC,EACA,eAAAC,EACA,kBAAAC,EACA,QAAAC,EACA,QAAAC,EACA,WAAAzB,EACA,aAAA0B,EACA,cAAAC,CACF,EAAI7B,EAEEI,EACJ,KAAW,wBAAwB,sBAAoB,wBAAyBF,CAAU,GAC1FA,EAAW,WAAa,GAE1B,SACE,QAAC4B,EAAA,EAAK,CAAC,UAAW,SAAU,WAAY,aACtC,oBAACC,EAAA,GACC,eAAa,KACX,0DACA,0FACA,CAAE,aAAAV,CAAa,CACjB,EACA,SAAO,KAAE,oDAAqD,iBAAiB,EAC/E,SAAUK,GAAW,CAACtB,EAEtB,mBAAC4B,EAAA,GACC,MAAOb,EACP,SAAU,IAAM,CACdC,EAAiB,CAACD,CAAa,CACjC,EACF,EACF,KACA,OAACY,EAAA,GACC,eAAa,KACX,oDACA,wEACF,EACA,SAAO,KAAE,8CAA+C,WAAW,EACnE,SAAUL,GAAWP,GAAiB,CAACf,EAEvC,mBAAC6B,EAAA,GACC,KAAK,SACL,UAAU,eAEV,YAAY,OACZ,IAAK,EACL,OAAQd,EAAgBE,EAAeC,IAAiB,EACxD,SAAWY,GAAO,CAChBX,EAAgBW,EAAG,cAAc,aAAa,CAChD,EACF,EACF,KACA,OAACH,EAAA,GACC,eAAa,KACX,gGACA,2EACF,EACA,SACE,QAACI,EAAA,EAAK,CACJ,oBAAC,QACC,mBAAC,KAAK,CAAC,QAAQ,2CAA2C,wBAAY,EACxE,KACA,OAACC,EAAA,GACC,WACE,OAAC,OACC,oBAAC,KAAK,CAAC,QAAQ,uDAAuD,qUAInD,OACjB,OAAC,KAAE,KAAK,oEAAoE,gBAAI,EAAI,mBACtF,EACF,EAGF,mBAACC,EAAA,EAAI,CAAC,KAAK,iBAAkB,GAC/B,GACF,EAEF,SAAUX,GAAWP,GAAiB,CAACf,EAEvC,mBAAC6B,EAAA,GACC,KAAK,SACL,UAAU,eAEV,YAAY,OACZ,IAAK,EACL,OAAQd,EAAgBE,EAAeG,IAAmB,EAC1D,SAAWU,GAAO,CAChBT,EAAkBS,EAAG,cAAc,aAAa,CAClD,EACF,EACF,KACA,QAACJ,EAAA,EAAK,CAAC,IAAK,EAAG,WAAW,aAAa,eAAe,aACpD,oBAACf,EAAoB,CAAE,GAAGf,CAAA,CAAO,KACjC,OAACa,EAAA,IACC,SAAUa,GAAW,CAACtB,EACtB,QAAS,IACPc,EAAsBf,EAAQ,CAC5B,aAAAyB,EACA,cAAAC,EACA,QAAAF,EACA,aAAAN,EACA,aAAAC,EACA,eAAAE,EACA,cAAAL,CACF,CAAC,EAGH,mBAAC,KAAK,CAAC,QAAQ,mCAAmC,gBAAI,EACxD,GACF,GACF,CAEJ,E,eCvIO,SAASmB,GAAiC,CAC/C,SACE,OAACC,EAAA,EAAK,CAAC,SAAS,OAAO,SAAO,KAAE,+BAAgC,yBAAyB,EACtF,iBACC,iCACA,gJACF,EACF,CAEJ,C,cCgBA,SAASC,EAAgBC,EAA6BzC,EAAsB,CAC1E,MAAO,CACL,GAAGyC,EAAM,gBACT,OAAQzC,EAAM,IACd,WAAYyC,EAAM,YAAY,UAChC,CACF,CAEA,MAAMC,EAAqB,CACzB,uBAAsB,KACtB,sBAAqB,KACrB,sBAAqB,KACrB,oBAAmB,KACnB,eAAc,KACd,WAAU,KACV,mBAAkB,IACpB,EAEaC,KAAY,WAAQH,EAAiBE,CAAkB,EAIvDE,EAAW5C,GAAiB,CACvC,KAAM,CAAC2B,EAASkB,CAAU,KAAI,YAAS7C,EAAM,OAAO,EAC9C,CAAC0B,EAASoB,CAAU,KAAI,YAAS,EAAI,EACrC,CAAC3B,EAAeC,CAAgB,KAAI,YAASpB,EAAM,aAAa,EAChE,CAACsB,EAAcC,CAAe,KAAI,YAASvB,EAAM,YAAY,EAC7D,CAACwB,EAAgBC,CAAiB,KAAI,YAASzB,EAAM,cAAc,EAEnE,CAAE,OAAAG,EAAQ,WAAAD,EAAY,eAAA6C,EAAgB,oBAAAC,EAAqB,mBAAAC,EAAoB,sBAAAhD,CAAsB,EAAID,KAE/G,aAAU,IAAM,CACd6C,EAAW3C,EAAW,UAAU,oBAAsB,GAAQF,EAAM,OAAO,EAC3EoB,EAAiBpB,EAAM,aAAa,EACpCuB,EAAgBvB,EAAM,YAAY,EAClCyB,EAAkBzB,EAAM,cAAc,EACtC8C,EAAW,EAAK,CAClB,EAAG,CACD9C,EAAM,cACNA,EAAM,aACNA,EAAM,eACNA,EAAM,QACNE,EAAW,UAAU,mBACvB,CAAC,KAED,aAAU,IAAM,CACd6C,EAAe5C,CAAM,EAAE,KAAK8C,CAAkB,EAC9CD,EAAoB7C,CAAM,CAC5B,EAAG,CAAC6C,EAAqBD,EAAgBE,EAAoB9C,CAAM,CAAC,EAEpE,MAAM+C,EAAWhD,EAAW,WAAa,GACnCE,GACJ,KAAW,wBAAwB,sBAAoB,wBAAyBF,CAAU,GAAK,CAACgD,EAE5FC,GAAUxB,EACdV,EAAkB,CAChB,GAAGjB,EACH,QAAA0B,EACA,cAAAP,EACA,iBAAAC,EACA,aAAAE,EACA,gBAAAC,EACA,eAAAC,EACA,kBAAAC,CACF,CAAC,KACC,MAAe,KACjB,OAAC2B,EAAA,CACC,OACEhD,GACI,CACE,QAAM,KAAE,8CAA+C,gBAAgB,EACvE,QAAS,IAAM,CACbH,EAAsBE,CAAM,CAC9B,CACF,EACA,OAER,EAEAJ,EAASC,CAAK,EAGhB,SACE,oBACG,mBAAe,MACd,OAACqD,EAAA,IACC,UAAW,gBACX,aAAc,QACd,YAAa,gBACb,QAAM,KACJ,2CACA,iEACF,EACF,EAEDH,MAAY,OAACZ,EAA8B,EAAC,KAC7C,QAAC,OAAI,UAAU,kBACZ,UAAAX,GAAW,IAAC,MAAe,MAC1B,OAAC,MAAG,UAAU,mBACZ,mBAAC,KAAK,CAAC,QAAQ,4CAA4C,mBAAO,EACpE,KAEF,OAAC,OAAI,UAAU,yBAA0B,MACzC,OAACG,EAAA,EAAK,CAAC,IAAK,EAAG,WAAW,WAAW,eAAe,WACjD,SAAAH,MAAW,OAACrB,EAAU,CAAE,GAAGN,CAAA,CAAO,EACrC,GACF,EACCmD,EAAA,EACH,CAEJ,EAKaC,EAAgC,CAAC,CAAE,OAAAE,CAAO,IAA0C,CAC/F,MAAMC,KAAQ,MAAU,EAElBC,EAAsB,IAC1B,KACE,4DACA,gIACF,KACA,KACE,uDACA,oIACF,KACA,KACE,8DACA,4IACF,CACF,EACA,SACE,OAAC,MACC,OAAAF,EACA,UAAWE,EACX,MAAO,iBAAiBD,EAAM,QAAU,QAAU,MAAM,OACxD,WAAY,mEACZ,YAAa,gBACb,eAAa,KACX,wDACA,mKACF,EACF,CAEJ,EAEA,EAAeZ,EAAUC,CAAO,C,kFCtKzB,MAAMa,EAAyB,CAAC,CAAE,IAAAC,CAAI,QAC3C,MAA0BA,CAAG,KAG3B,oBACE,oBAAC,KAAU,CAAC,YAAa,gBAAiB,UAAW,gBAAiB,KACtE,OAAC,KAA6B,EAAC,GACjC,E,yRCYG,MAAMC,EAA6BD,GAAgB,CACxD,MAAME,KAAW,MAAY,KAE7B,aAAU,KACRA,KAAS,MAAuBF,CAAG,CAAC,EAE7B,UAAmB,CACxBE,KACE,KAAc,CACZ,cAAgBnB,GAAWA,EAAM,mBAAqB,IACxD,CAAC,CACH,CACF,GACC,CAACiB,EAAKE,CAAQ,CAAC,CACpB,EAEaC,EAAqBH,GAAgB,CAChD,MAAME,KAAW,MAAY,EAE7B,MAAO,IAAMA,KAAS,MAAeF,EAAK,IAAO,eAAe,CAAC,CACnE,EAEaI,EAAqB,IAAM,CACtC,MAAMF,KAAW,MAAY,EACvBG,KAAY,MAAatB,GAAUA,EAAM,YAAY,oBAAoB,EACzEuB,KAAc,MAAavB,GAAUA,EAAM,YAAY,WAAW,EAExE,sBAAU,IAAM,CACdmB,KAAS,MAAgB,CAAC,CAC5B,EAAG,CAACA,CAAQ,CAAC,EAEN,CAAE,UAAAG,EAAW,YAAAC,CAAY,CAClC,EAEaC,EAAqBP,GAAgB,CAChD,MAAME,EAAW,YAAY,EAE7B,UAAU,IAAM,CACdA,EAAS,eAAeF,CAAG,CAAC,CAC9B,EAAG,CAACE,EAAUF,CAAG,CAAC,CACpB,EAEaQ,EAA2B,IAAM,CAC5C,MAAMN,KAAW,MAAY,KAE7B,aAAU,IAAM,CACdA,KAAS,MAAsB,CAAC,CAClC,EAAG,CAACA,CAAQ,CAAC,CACf,EAEaO,EAAmB,IAAM,CACpC,MAAMP,KAAW,MAAY,EAE7B,OAAQQ,GAAiC,CACvCR,KAAS,MAAcQ,EAAQ,IAAO,eAAe,CAAC,CACxD,CACF,EAEaC,EAAsB,IAAM,CACvC,MAAMT,KAAW,MAAY,EAE7B,MAAO,OAAO1D,GAAmC0D,KAAS,MAAiB1D,CAAU,CAAC,CACxF,EAEaoE,EAA4B,IAAM,CAC7C,MAAMV,KAAW,MAAY,EACvB,CAAE,KAAAW,CAAK,KAAI,MAAa9B,GAAUA,EAAM,YAAY,UAAU,EAEpE,MAAO,IAAM,CACX,IAAU,QACR,IAAI,KAAsB,CACxB,SAAO,KAAE,yDAA0D,QAAQ,EAC3E,KAAM,wCAAwC8B,CAAI,iBAClD,QAAS,SACT,KAAM,YACN,UAAW,IAAMX,KAAS,MAAuB,CAAC,CACpD,CAAC,CACH,CACF,CACF,EAEaY,EAAiBd,MACrB,MAAajB,MAAU,MAAcA,EAAM,YAAaiB,CAAG,CAAC,EAGxDe,EAA2Bf,GAAgB,CACtD,MAAMxD,EAAasE,EAAcd,CAAG,EACpC,SAAO,KAA8BxD,CAAU,CACjD,EAEawE,EAAqBC,MACzB,MAAalC,MAAU,MAAkBA,EAAM,YAAakC,CAAU,CAAC,EAGnEC,EAAwB,OAC5B,MAAanC,GAAUA,EAAM,kBAAkB,EAG3CoC,EAAuBnB,GAAkC,CACpE,MAAMxD,EAAasE,EAAcd,CAAG,EAC9BR,EAAWhD,EAAW,WAAa,GACnC4E,EAAiB,KAAW,wBAAwB,IAAoB,iBAAkB5E,CAAU,EACpG6E,EAAkB,KAAW,wBAAwB,IAAoB,kBAAmB7E,CAAU,EAE5G,MAAO,CACL,SAAAgD,EACA,eAAA4B,EACA,gBAAAC,CACF,CACF,C,6DCvIO,MAAMC,EAAiC9E,GAA2D,CACvG,MAAM+E,EAAe,KAAK,UAAU,CAAE,WAAY/E,EAAW,KAAM,QAAS,SAAU,CAAC,EAGvF,OAFmB,KAAQ,UAAU,IAAa,cAAc,UAAU,EAAG,CAAE,KAAM+E,CAAa,CAAC,CAGrG,C","sources":["webpack://grafana/./public/app/core/components/EmptyListCTA/EmptyListCTA.tsx","webpack://grafana/./public/app/extensions/caching/CacheCTA.tsx","webpack://grafana/./public/app/extensions/caching/CacheClean.tsx","webpack://grafana/./public/app/extensions/caching/CacheSettingsDisable.tsx","webpack://grafana/./public/app/extensions/caching/CacheSettingsForm.tsx","webpack://grafana/./public/app/extensions/caching/DataSourceCacheReadOnlyMessage.tsx","webpack://grafana/./public/app/extensions/caching/DataSourceCache.tsx","webpack://grafana/./public/app/extensions/caching/DataSourceCacheUpgrade.tsx","webpack://grafana/./public/app/features/datasources/state/hooks.ts","webpack://grafana/./public/app/features/datasources/utils.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport { MouseEvent } from 'react';\n\nimport { selectors } from '@grafana/e2e-selectors';\nimport { Trans } from '@grafana/i18n';\nimport { Alert, Button, CallToActionCard, Icon, IconName, LinkButton } from '@grafana/ui';\n\nexport interface Props {\n  title: string;\n  buttonIcon: IconName;\n  buttonLink?: string;\n  buttonTitle: string;\n  buttonDisabled?: boolean;\n  onClick?: (event: MouseEvent) => void;\n  proTip?: string;\n  proTipLink?: string;\n  proTipLinkTitle?: string;\n  proTipTarget?: string;\n  infoBox?: { __html: string };\n  infoBoxTitle?: string;\n}\n\nconst ctaStyle = css({\n  textAlign: 'center',\n});\n\nconst infoBoxStyles = css({\n  maxWidth: '700px',\n  margin: '0 auto',\n});\n\nconst EmptyListCTA = ({\n  title,\n  buttonIcon,\n  buttonLink,\n  buttonTitle,\n  buttonDisabled,\n  onClick,\n  proTip,\n  proTipLink,\n  proTipLinkTitle,\n  proTipTarget,\n  infoBox,\n  infoBoxTitle,\n}: Props) => {\n  const footer = () => {\n    return (\n      <>\n        {proTip ? (\n          <span key=\"proTipFooter\">\n            <Icon name=\"rocket\" />\n            <Trans i18nKey=\"empty-list-cta.pro-tip\">ProTip: {{ proTip }}</Trans>\n            {proTipLink && (\n              <a href={proTipLink} target={proTipTarget} className=\"text-link\">\n                {proTipLinkTitle}\n              </a>\n            )}\n          </span>\n        ) : (\n          ''\n        )}\n        {infoBox ? (\n          <Alert severity=\"info\" title={infoBoxTitle ?? ''} className={infoBoxStyles}>\n            <div dangerouslySetInnerHTML={infoBox} />\n          </Alert>\n        ) : (\n          ''\n        )}\n      </>\n    );\n  };\n\n  const ctaElementClassName = !footer()\n    ? css({\n        marginBottom: '20px',\n      })\n    : '';\n\n  const ButtonEl = buttonLink ? LinkButton : Button;\n  const ctaElement = (\n    <ButtonEl\n      size=\"lg\"\n      onClick={onClick}\n      href={buttonLink}\n      icon={buttonIcon}\n      className={ctaElementClassName}\n      data-testid={selectors.components.CallToActionCard.buttonV2(buttonTitle)}\n      disabled={buttonDisabled}\n    >\n      {buttonTitle}\n    </ButtonEl>\n  );\n\n  return <CallToActionCard className={ctaStyle} message={title} footer={footer()} callToActionElement={ctaElement} />;\n};\n\nexport default EmptyListCTA;\n","import { t } from '@grafana/i18n';\nimport EmptyListCTA from 'app/core/components/EmptyListCTA/EmptyListCTA';\nimport { contextSrv } from 'app/core/core';\n\nimport { AccessControlAction } from '../types';\n\nimport { Props } from './DataSourceCache';\n\nexport const CacheCTA = (props: Props) => {\n  const { enableDataSourceCache, dataSource, pageId } = props;\n  const canWriteCache =\n    contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesCachingWrite, dataSource) &&\n    dataSource.readOnly === false;\n\n  return dataSource.jsonData?.disableGrafanaCache ? (\n    <EmptyListCTA\n      title={t(\n        'caching.cache-cta.title-caching-cannot-enabled-source',\n        'Caching cannot be enabled for this data source.'\n      )}\n      buttonTitle={t('caching.cache-cta.enable-button-title', 'Enable')}\n      buttonIcon=\"database\"\n      proTip={t(\n        'caching.cache-cta.protip-caching-cannot-enabled-source',\n        \"This data source's configuration does not permit caching to be enabled.\"\n      )}\n      buttonDisabled={true}\n    />\n  ) : (\n    <EmptyListCTA\n      title={t('caching.cache-cta.title-caching-not-enabled', 'Caching is not enabled for this data source.')}\n      buttonTitle={t('caching.cache-cta.enable-button-tittle', 'Enable')}\n      buttonIcon=\"database\"\n      onClick={() => {\n        enableDataSourceCache(pageId);\n      }}\n      proTip={t(\n        'caching.cache-cta.protip-caching-not-enabled',\n        'Enabling caching can reduce the amount of redundant requests sent to the data source.'\n      )}\n      proTipLink=\"https://grafana.com/docs/grafana/latest/enterprise/query-caching/\"\n      proTipLinkTitle={t('caching.cache-cta.protip-link-caching-not-enabled', 'Learn more')}\n      buttonDisabled={!canWriteCache}\n    />\n  );\n};\n","import { useState } from 'react';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, ConfirmModal } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\n\nimport { AccessControlAction } from '../types';\n\nimport { Props } from './DataSourceCache';\n\nexport const CacheClean = (props: Props) => {\n  const { cleanCache, dataSource, pageId } = props;\n  const [showCleanModal, setShowCleanModal] = useState(false);\n\n  const showConfirmCleanModal = (show: boolean) => () => {\n    setShowCleanModal(show);\n  };\n\n  const handleCleanCache = () => {\n    cleanCache(pageId);\n    setShowCleanModal(false);\n  };\n\n  const canWriteCache =\n    contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesCachingWrite, dataSource) &&\n    dataSource.readOnly === false;\n\n  return (\n    <div>\n      <Button variant=\"destructive\" onClick={showConfirmCleanModal(true)} disabled={!canWriteCache}>\n        <Trans i18nKey=\"caching.cache-clean.clear-cache\">Clear cache</Trans>\n      </Button>\n      <ConfirmModal\n        isOpen={showCleanModal}\n        title={t('caching.cache-clean.title-clear-cache', 'Clear cache')}\n        body={t(\n          'caching.cache-clean.body-clear-cache',\n          'Warning: This action impacts all cache-enabled data sources. If you are using Memcached, the system clears all data from the Memcached instance. Do you want to continue?'\n        )}\n        confirmText={t('caching.cache-clean.confirm-text-clear-cache', 'Clear cache')}\n        onConfirm={handleCleanCache}\n        onDismiss={showConfirmCleanModal(false)}\n      />\n    </div>\n  );\n};\n","import { Trans } from '@grafana/i18n';\nimport { Button } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\n\nimport { AccessControlAction } from '../types';\n\nimport { Props } from './DataSourceCache';\n\nexport const CacheSettingsDisable = (props: Props) => {\n  const { disableDataSourceCache, dataSource, pageId } = props;\n\n  const canWriteCache =\n    contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesCachingWrite, dataSource) &&\n    dataSource.readOnly === false;\n\n  return (\n    <Button variant=\"destructive\" onClick={() => disableDataSourceCache(pageId)} disabled={!canWriteCache}>\n      <Trans i18nKey=\"caching.cache-settings-disable.disable\">Disable</Trans>\n    </Button>\n  );\n};\n","import { Trans, t } from '@grafana/i18n';\nimport { Field, Switch, Input, Button, Stack, Tooltip, Icon, Label } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\n\nimport { AccessControlAction } from '../types';\n\nimport { CacheSettingsDisable } from './CacheSettingsDisable';\nimport { Props } from './DataSourceCache';\n\ninterface CacheSettingsProps {\n  loading: boolean;\n  setUseDefaultTTL: (useDefaultTTL: boolean) => void;\n  setTtlQueriesMs: (ttl: number) => void;\n  setTtlResourcesMs: (ttl: number) => void;\n}\n\nexport const CacheSettingsForm = (props: Props & CacheSettingsProps) => {\n  const {\n    updateDataSourceCache,\n    pageId,\n    useDefaultTTL,\n    setUseDefaultTTL,\n    defaultTTLMs,\n    ttlQueriesMs,\n    setTtlQueriesMs,\n    ttlResourcesMs,\n    setTtlResourcesMs,\n    loading,\n    enabled,\n    dataSource,\n    dataSourceID,\n    dataSourceUID,\n  } = props;\n\n  const canWriteCache =\n    contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesCachingWrite, dataSource) &&\n    dataSource.readOnly === false;\n\n  return (\n    <Stack direction={'column'} alignItems={'flex-start'}>\n      <Field\n        description={t(\n          'caching.cache-settings-form.description-use-default-ttl',\n          \"Enable this to use the default TTL set in Grafana's configuration ({{defaultTTLMs}} ms)\",\n          { defaultTTLMs }\n        )}\n        label={t('caching.cache-settings-form.label-use-default-ttl', 'Use default TTL')}\n        disabled={loading || !canWriteCache}\n      >\n        <Switch\n          value={useDefaultTTL}\n          onChange={() => {\n            setUseDefaultTTL(!useDefaultTTL);\n          }}\n        />\n      </Field>\n      <Field\n        description={t(\n          'caching.cache-settings-form.description-query-ttl',\n          'The time-to-live for a query cache item in milliseconds. Example: 5000'\n        )}\n        label={t('caching.cache-settings-form.label-query-ttl', 'Query TTL')}\n        disabled={loading || useDefaultTTL || !canWriteCache}\n      >\n        <Input\n          type=\"number\"\n          className=\"max-width-10\"\n          // eslint-disable-next-line @grafana/i18n/no-untranslated-strings\n          placeholder=\"1000\"\n          min={0}\n          value={(useDefaultTTL ? defaultTTLMs : ttlQueriesMs) || 0}\n          onChange={(el) => {\n            setTtlQueriesMs(el.currentTarget.valueAsNumber);\n          }}\n        />\n      </Field>\n      <Field\n        description={t(\n          'caching.cache-settings-form.description-timetolive-resources-cache-items-milliseconds-example',\n          'The time-to-live for resources cache items in milliseconds. Example: 5000'\n        )}\n        label={\n          <Label>\n            <span>\n              <Trans i18nKey=\"caching.cache-settings-form.resource-ttl\">Resource TTL</Trans>\n            </span>\n            <Tooltip\n              content={\n                <div>\n                  <Trans i18nKey=\"caching.cache-settings-form.description-resource-ttl\">\n                    Resources are dynamic values that Grafana data source plugins retrieve from data sources for use in\n                    the query editor. Examples are Splunk namespaces, Prometheus labels, and CloudWatch metric names.\n                    Since these values update less frequently, you might prefer a longer cache TTL for Resources than\n                    queries. See the{' '}\n                    <a href=\"https://grafana.com/docs/grafana/latest/enterprise/query-caching/\">docs</a> for more info.\n                  </Trans>\n                </div>\n              }\n            >\n              <Icon name=\"question-circle\" />\n            </Tooltip>\n          </Label>\n        }\n        disabled={loading || useDefaultTTL || !canWriteCache}\n      >\n        <Input\n          type=\"number\"\n          className=\"max-width-10\"\n          // eslint-disable-next-line @grafana/i18n/no-untranslated-strings\n          placeholder=\"1000\"\n          min={0}\n          value={(useDefaultTTL ? defaultTTLMs : ttlResourcesMs) || 0}\n          onChange={(el) => {\n            setTtlResourcesMs(el.currentTarget.valueAsNumber);\n          }}\n        />\n      </Field>\n      <Stack gap={2} alignItems=\"flex-start\" justifyContent=\"flex-start\">\n        <CacheSettingsDisable {...props} />\n        <Button\n          disabled={loading || !canWriteCache}\n          onClick={() =>\n            updateDataSourceCache(pageId, {\n              dataSourceID,\n              dataSourceUID,\n              enabled,\n              defaultTTLMs,\n              ttlQueriesMs,\n              ttlResourcesMs,\n              useDefaultTTL,\n            })\n          }\n        >\n          <Trans i18nKey=\"caching.cache-settings-form.save\">Save</Trans>\n        </Button>\n      </Stack>\n    </Stack>\n  );\n};\n","import { t } from '@grafana/i18n';\nimport { Alert } from '@grafana/ui';\n\nexport function DataSourceCacheReadOnlyMessage() {\n  return (\n    <Alert severity=\"info\" title={t('caching.alert.readonly.title', 'Provisioned data source')}>\n      {t(\n        'caching.alert.readonly.message',\n        'This data source was added by config and caching cannot be modified using the UI. Please contact your server admin to update this data source.'\n      )}\n    </Alert>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { Trans, t } from '@grafana/i18n';\nimport { Stack, useTheme2 } from '@grafana/ui';\nimport { UpgradeBox, UpgradeContent, UpgradeContentProps } from 'app/core/components/Upgrade/UpgradeBox';\nimport { contextSrv } from 'app/core/core';\nimport { highlightTrial } from 'app/features/admin/utils';\nimport { loadDataSource, loadDataSourceMeta } from 'app/features/datasources/state/actions';\n\nimport { AccessControlAction, EnterpriseStoreState } from '../types';\n\nimport { CacheCTA } from './CacheCTA';\nimport { CacheClean } from './CacheClean';\nimport { CacheSettingsForm } from './CacheSettingsForm';\nimport { DataSourceCacheReadOnlyMessage } from './DataSourceCacheReadOnlyMessage';\nimport {\n  loadDataSourceCache,\n  enableDataSourceCache,\n  disableDataSourceCache,\n  updateDataSourceCache,\n  cleanCache,\n} from './state/actions';\n\nexport type ExternalProps = {\n  uid: string;\n};\n\nfunction mapStateToProps(state: EnterpriseStoreState, props: ExternalProps) {\n  return {\n    ...state.dataSourceCache,\n    pageId: props.uid,\n    dataSource: state.dataSources.dataSource,\n  };\n}\n\nconst mapDispatchToProps = {\n  disableDataSourceCache,\n  updateDataSourceCache,\n  enableDataSourceCache,\n  loadDataSourceCache,\n  loadDataSource,\n  cleanCache,\n  loadDataSourceMeta,\n};\n\nexport const connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport type Props = ConnectedProps<typeof connector>;\n\nexport const Caching = (props: Props) => {\n  const [enabled, setEnabled] = useState(props.enabled);\n  const [loading, setLoading] = useState(true);\n  const [useDefaultTTL, setUseDefaultTTL] = useState(props.useDefaultTTL);\n  const [ttlQueriesMs, setTtlQueriesMs] = useState(props.ttlQueriesMs);\n  const [ttlResourcesMs, setTtlResourcesMs] = useState(props.ttlResourcesMs);\n\n  const { pageId, dataSource, loadDataSource, loadDataSourceCache, loadDataSourceMeta, enableDataSourceCache } = props;\n\n  useEffect(() => {\n    setEnabled(dataSource.jsonData?.disableGrafanaCache ? false : props.enabled);\n    setUseDefaultTTL(props.useDefaultTTL);\n    setTtlQueriesMs(props.ttlQueriesMs);\n    setTtlResourcesMs(props.ttlResourcesMs);\n    setLoading(false);\n  }, [\n    props.useDefaultTTL,\n    props.ttlQueriesMs,\n    props.ttlResourcesMs,\n    props.enabled,\n    dataSource.jsonData?.disableGrafanaCache,\n  ]);\n\n  useEffect(() => {\n    loadDataSource(pageId).then(loadDataSourceMeta);\n    loadDataSourceCache(pageId);\n  }, [loadDataSourceCache, loadDataSource, loadDataSourceMeta, pageId]);\n\n  const readOnly = dataSource.readOnly === true;\n  const canWriteCache =\n    contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesCachingWrite, dataSource) && !readOnly;\n\n  const content = enabled ? (\n    CacheSettingsForm({\n      ...props,\n      loading,\n      useDefaultTTL,\n      setUseDefaultTTL,\n      ttlQueriesMs,\n      setTtlQueriesMs,\n      ttlResourcesMs,\n      setTtlResourcesMs,\n    })\n  ) : highlightTrial() ? (\n    <DataSourceCacheUpgradeContent\n      action={\n        canWriteCache\n          ? {\n              text: t('caching.caching.content.text.enable-caching', 'Enable caching'),\n              onClick: () => {\n                enableDataSourceCache(pageId);\n              },\n            }\n          : undefined\n      }\n    />\n  ) : (\n    CacheCTA(props)\n  );\n\n  return (\n    <>\n      {highlightTrial() && (\n        <UpgradeBox\n          featureId={'query-caching'}\n          eventVariant={'trial'}\n          featureName={'query caching'}\n          text={t(\n            'caching.data-source-cache.query-catching',\n            'Enable query caching for free during your trial of Grafana Pro.'\n          )}\n        />\n      )}\n      {readOnly && <DataSourceCacheReadOnlyMessage />}\n      <div className=\"page-action-bar\">\n        {enabled && !highlightTrial() && (\n          <h3 className=\"page-sub-heading\">\n            <Trans i18nKey=\"caching.data-source-cache.caching-heading\">Caching</Trans>\n          </h3>\n        )}\n        <div className=\"page-action-bar__spacer\" />\n        <Stack gap={2} alignItems=\"flex-end\" justifyContent=\"flex-end\">\n          {enabled && <CacheClean {...props} />}\n        </Stack>\n      </div>\n      {content}\n    </>\n  );\n};\n\nexport interface DataSourceCacheUpgradeContentProps {\n  action?: UpgradeContentProps['action'];\n}\nexport const DataSourceCacheUpgradeContent = ({ action }: DataSourceCacheUpgradeContentProps) => {\n  const theme = useTheme2();\n\n  const listItemsTranslated = [\n    t(\n      'caching.data-source-cache.upgrade-content-load-dashboards',\n      'Load dashboards in less than a second from the cache, even when they include big queries and lots of users are looking at once'\n    ),\n    t(\n      'caching.data-source-cache.upgrade-content-save-money',\n      'Save money and avoid rate limiting by reducing the number of API calls you make to data sources like Splunk, CloudWatch and Github'\n    ),\n    t(\n      'caching.data-source-cache.upgrade-content-author-dashboards',\n      'Author dashboards more smoothly by caching the data used to construct queries, like fields in ServiceNow or metrics available from Datadog'\n    ),\n  ];\n  return (\n    <UpgradeContent\n      action={action}\n      listItems={listItemsTranslated}\n      image={`query-caching-${theme.isLight ? 'light' : 'dark'}.png`}\n      featureUrl={'https://grafana.com/docs/grafana/latest/enterprise/query-caching'}\n      featureName={'query caching'}\n      description={t(\n        'caching.data-source-cache.upgrade-content-description',\n        'With query caching, you can load dashboards faster and reduce costly queries to data sources by temporarily storing query results in memory, Redis, or Memcached.'\n      )}\n    />\n  );\n};\n\nexport default connector(Caching);\n","import { UpgradeBox } from 'app/core/components/Upgrade/UpgradeBox';\nimport { useInitDataSourceSettings } from 'app/features/datasources/state/hooks';\n\nimport { DataSourceCacheUpgradeContent } from './DataSourceCache';\n\nexport type Props = {\n  uid: string;\n};\n\nexport const DataSourceCacheUpgrade = ({ uid }: Props) => {\n  useInitDataSourceSettings(uid);\n\n  return (\n    <>\n      <UpgradeBox featureName={'query caching'} featureId={'query-caching'} />\n      <DataSourceCacheUpgradeContent />\n    </>\n  );\n};\n","import { useEffect } from 'react';\n\nimport { DataSourcePluginMeta, DataSourceSettings } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { cleanUpAction } from 'app/core/actions/cleanUp';\nimport appEvents from 'app/core/app_events';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types/accessControl';\nimport { ShowConfirmModalEvent } from 'app/types/events';\nimport { useDispatch, useSelector } from 'app/types/store';\n\nimport { ROUTES } from '../../connections/constants';\nimport { DataSourceRights } from '../types';\nimport { constructDataSourceExploreUrl } from '../utils';\n\nimport {\n  initDataSourceSettings,\n  testDataSource,\n  loadDataSource,\n  loadDataSources,\n  loadDataSourcePlugins,\n  addDataSource,\n  updateDataSource,\n  deleteLoadedDataSource,\n} from './actions';\nimport { initialDataSourceSettingsState } from './reducers';\nimport { getDataSource, getDataSourceMeta } from './selectors';\n\nexport const useInitDataSourceSettings = (uid: string) => {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(initDataSourceSettings(uid));\n\n    return function cleanUp() {\n      dispatch(\n        cleanUpAction({\n          cleanupAction: (state) => (state.dataSourceSettings = initialDataSourceSettingsState),\n        })\n      );\n    };\n  }, [uid, dispatch]);\n};\n\nexport const useTestDataSource = (uid: string) => {\n  const dispatch = useDispatch();\n\n  return () => dispatch(testDataSource(uid, ROUTES.DataSourcesEdit));\n};\n\nexport const useLoadDataSources = () => {\n  const dispatch = useDispatch();\n  const isLoading = useSelector((state) => state.dataSources.isLoadingDataSources);\n  const dataSources = useSelector((state) => state.dataSources.dataSources);\n\n  useEffect(() => {\n    dispatch(loadDataSources());\n  }, [dispatch]);\n\n  return { isLoading, dataSources };\n};\n\nexport const useLoadDataSource = (uid: string) => {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(loadDataSource(uid));\n  }, [dispatch, uid]);\n};\n\nexport const useLoadDataSourcePlugins = () => {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(loadDataSourcePlugins());\n  }, [dispatch]);\n};\n\nexport const useAddDatasource = () => {\n  const dispatch = useDispatch();\n\n  return (plugin: DataSourcePluginMeta) => {\n    dispatch(addDataSource(plugin, ROUTES.DataSourcesEdit));\n  };\n};\n\nexport const useUpdateDatasource = () => {\n  const dispatch = useDispatch();\n\n  return async (dataSource: DataSourceSettings) => dispatch(updateDataSource(dataSource));\n};\n\nexport const useDeleteLoadedDataSource = () => {\n  const dispatch = useDispatch();\n  const { name } = useSelector((state) => state.dataSources.dataSource);\n\n  return () => {\n    appEvents.publish(\n      new ShowConfirmModalEvent({\n        title: t('datasources.use-delete-loaded-data-source.title.delete', 'Delete'),\n        text: `Are you sure you want to delete the \"${name}\" data source?`,\n        yesText: 'Delete',\n        icon: 'trash-alt',\n        onConfirm: () => dispatch(deleteLoadedDataSource()),\n      })\n    );\n  };\n};\n\nexport const useDataSource = (uid: string) => {\n  return useSelector((state) => getDataSource(state.dataSources, uid));\n};\n\nexport const useDataSourceExploreUrl = (uid: string) => {\n  const dataSource = useDataSource(uid);\n  return constructDataSourceExploreUrl(dataSource);\n};\n\nexport const useDataSourceMeta = (pluginType: string): DataSourcePluginMeta => {\n  return useSelector((state) => getDataSourceMeta(state.dataSources, pluginType));\n};\n\nexport const useDataSourceSettings = () => {\n  return useSelector((state) => state.dataSourceSettings);\n};\n\nexport const useDataSourceRights = (uid: string): DataSourceRights => {\n  const dataSource = useDataSource(uid);\n  const readOnly = dataSource.readOnly === true;\n  const hasWriteRights = contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesWrite, dataSource);\n  const hasDeleteRights = contextSrv.hasPermissionInMetadata(AccessControlAction.DataSourcesDelete, dataSource);\n\n  return {\n    readOnly,\n    hasWriteRights,\n    hasDeleteRights,\n  };\n};\n","import { DataSourceJsonData, DataSourceSettings, urlUtil, locationUtil } from '@grafana/data';\n\nexport const constructDataSourceExploreUrl = (dataSource: DataSourceSettings<DataSourceJsonData, {}>) => {\n  const exploreState = JSON.stringify({ datasource: dataSource.name, context: 'explore' });\n  const exploreUrl = urlUtil.renderUrl(locationUtil.assureBaseUrl('/explore'), { left: exploreState });\n\n  return exploreUrl;\n};\n"],"names":["ctaStyle","infoBoxStyles","title","buttonIcon","buttonLink","buttonTitle","buttonDisabled","onClick","proTip","proTipLink","proTipLinkTitle","proTipTarget","infoBox","infoBoxTitle","footer","ctaElementClassName","ButtonEl","ctaElement","CacheCTA","props","enableDataSourceCache","dataSource","pageId","canWriteCache","EmptyListCTA","CacheClean","cleanCache","showCleanModal","setShowCleanModal","showConfirmCleanModal","show","handleCleanCache","Button","ConfirmModal","CacheSettingsDisable","disableDataSourceCache","CacheSettingsForm","updateDataSourceCache","useDefaultTTL","setUseDefaultTTL","defaultTTLMs","ttlQueriesMs","setTtlQueriesMs","ttlResourcesMs","setTtlResourcesMs","loading","enabled","dataSourceID","dataSourceUID","Stack","Field","Switch","Input","el","Label","Tooltip","Icon","DataSourceCacheReadOnlyMessage","Alert","mapStateToProps","state","mapDispatchToProps","connector","Caching","setEnabled","setLoading","loadDataSource","loadDataSourceCache","loadDataSourceMeta","readOnly","content","DataSourceCacheUpgradeContent","UpgradeBox","action","theme","listItemsTranslated","DataSourceCacheUpgrade","uid","useInitDataSourceSettings","dispatch","useTestDataSource","useLoadDataSources","isLoading","dataSources","useLoadDataSource","useLoadDataSourcePlugins","useAddDatasource","plugin","useUpdateDatasource","useDeleteLoadedDataSource","name","useDataSource","useDataSourceExploreUrl","useDataSourceMeta","pluginType","useDataSourceSettings","useDataSourceRights","hasWriteRights","hasDeleteRights","constructDataSourceExploreUrl","exploreState"],"sourceRoot":""}