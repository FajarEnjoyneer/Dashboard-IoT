"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3196,3511],{12003:(B,f,e)=>{e.r(f),e.d(f,{default:()=>S});var n=e(74848),x=e(10378),_=e(96540),C=e(54148),a=e(92745),D=e(89640),m=e(34999),r=e(45861),T=e(88559),O=e(87063),I=e(30703),A=e(36303),c=e(1506),v=e(86791),h=e(70327),G=e(55143),j=e(36826),z=e(6975),L=e(77880),y=e(25149),J=e(78102);function $({folderUid:u,groupName:s,onClose:l}){const[i,E]=(0,_.useState)("yaml");return(0,n.jsx)(y.m,{title:(0,a.t)("alerting.grafana-rule-group-exporter.title-drawer","Export {{groupName}} rules",{groupName:s}),activeTab:i,onTabChange:E,onClose:l,formatProviders:Object.values(J.sl),children:(0,n.jsx)(nn,{folderUid:u,groupName:s,exportFormat:i,onClose:l})})}function nn({folderUid:u,groupName:s,exportFormat:l,onClose:i}){const{currentData:E="",isFetching:N}=h.hK.endpoints.exportRules.useQuery({folderUid:u,group:s,format:l});return N?(0,n.jsx)(z._,{text:(0,a.t)("alerting.grafana-rule-group-export-preview.text-loading","Loading....")}):(0,n.jsx)(L.J,{format:l,textDefinition:E,downloadFileName:s,onClose:i})}var K=e(18404),k=e(84523),Z=e(93167),U=e(48760),F=e(88721),M=e(52161),tn=e(77256),X=e(29442),rn=e(29609),dn=e(15629),un=e(41654),en=e(66404),sn=e(39187);const o=({name:u})=>{const{returnTo:s}=(0,sn.h)("/alerting/list");return(0,n.jsxs)(un.B,{direction:"row",gap:1,minWidth:0,alignItems:"center",children:[(0,n.jsx)(r.z9,{variant:"secondary",icon:"angle-left",href:s}),(0,n.jsx)(en.E,{element:"h1",truncate:!0,children:u})]})},{useDiscoverDsFeaturesQuery:d}=G.L,{usePrometheusRuleNamespacesQuery:p,useGetRuleGroupForNamespaceQuery:g}=h.hK;function R(){const{dataSourceUid:u="",namespaceId:s="",groupName:l=""}=(0,C.g)(),i=u===M.hY,{folder:E,loading:N}=(0,K.a)(i?s:""),{data:P,isLoading:q,error:Q}=d({uid:i?v.l$:u}),{data:Y,isLoading:w,error:V}=p(P&&!P.rulerConfig?{ruleSourceName:P?.name??"",namespace:s,groupName:l}:x.hT,{selectFromResult:cn=>({...cn,data:cn.data?.[0]?.groups.find(hn=>hn.name===l)})}),{data:b,isLoading:gn,error:on}=g(P?.rulerConfig?{rulerConfig:P?.rulerConfig,namespace:s,group:l}:x.hT),an=i?M.hY:(0,M.$e)(u)?.name,H=N||q||w||gn,mn=Y?.interval?(0,dn.an)(Y.interval*1e3):b?.interval??k.T6,ln=E?.title??s,En=(0,X.tx)([["namespace",ln]]),xn=i?(0,a.t)("alerting.group-details.folder","Folder"):(0,a.t)("alerting.group-details.namespace","Namespace"),vn=E?(0,n.jsx)(D.Y,{href:(0,tn.NH)(E.uid),inline:!1,children:E.title}):s;return(0,n.jsx)(j.d,{pageNav:{text:l,parentItem:{text:ln,url:En}},renderTitle:cn=>(0,n.jsx)(o,{name:cn}),subTitle:(0,a.t)("alerting.titles.group-view.subtitle","Manage alert rules, recording rules and evaluation interval"),info:[{label:xn,value:vn},{label:(0,a.t)("alerting.group-details.interval","Interval"),value:mn}],navId:"alert-list",isLoading:H,actions:(0,n.jsx)(n.Fragment,{children:P&&(0,n.jsx)(W,{dsFeatures:P,namespaceId:s,groupName:l,folder:E,rulerGroup:b})}),children:(0,n.jsxs)(n.Fragment,{children:[!!Q&&(0,n.jsx)(m.F,{title:(0,a.t)("alerting.group-details.ds-features-error","Error loading data source details"),bottomSpacing:0,topSpacing:2,children:(0,n.jsx)("div",{children:(0,tn.JZ)(Q)})}),!!(V||on)&&(0,n.jsx)(m.F,{title:(0,a.t)("alerting.group-details.group-loading-error","Error loading the group"),bottomSpacing:0,topSpacing:2,children:(0,n.jsx)("div",{children:(0,tn.JZ)(V||on)})}),!Y&&!b&&(0,n.jsx)(c.L,{entity:`${s}/${l}`}),an&&(0,n.jsx)("ul",{role:"tree",children:i?(0,n.jsx)(U.$,{groupIdentifier:{groupName:l,groupOrigin:"grafana",namespace:{uid:s}},namespaceName:ln}):(0,n.jsx)(Z.e,{groupIdentifier:{groupName:l,groupOrigin:"datasource",namespace:{name:ln},rulesSource:{name:an,uid:u,ruleSourceType:"datasource"}}})})]})})}function W({dsFeatures:u,namespaceId:s,groupName:l,folder:i,rulerGroup:E}){const{canEditRules:N}=(0,F.V)(),[P,q]=(0,_.useState)(!1),Q=u.uid===M.hY,Y=Q?!!i?.canSave:!0,w=E?(0,rn.YN)(E):!1,V=E?(0,rn.oI)(E):!1,b=!!u.rulerConfig&&N(u.name)&&Y&&!w&&!V;return(0,n.jsxs)(n.Fragment,{children:[Q&&(0,n.jsx)(r.$n,{onClick:()=>q(!0),icon:"file-download",variant:"secondary",children:(0,n.jsx)(a.x6,{i18nKey:"alerting.group-details.export",children:"Export"})}),b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.z9,{icon:"pen",href:X.TN.editPageLink(u.uid,s,l,{includeReturnTo:!0}),variant:"secondary",children:(0,n.jsx)(a.x6,{i18nKey:"alerting.group-details.edit",children:"Edit"})}),Q&&(0,n.jsx)(T.m,{overlay:(0,n.jsxs)(O.W,{children:[(0,n.jsx)(O.W.Item,{icon:"bell",url:X.TN.newAlertRuleLink(i?.title,i?.uid,l),label:(0,a.t)("alerting.alert-rule.term","Alert rule")}),(0,n.jsx)(O.W.Item,{icon:"record-audio",url:X.TN.newRecordingRuleLink(i?.title,i?.uid,l),label:(0,a.t)("alerting.recording-rule.term","Recording rule")})]}),children:(0,n.jsxs)(r.$n,{variant:"primary",children:[(0,a.t)("alerting.group-details.new","New"),(0,n.jsx)(I.I,{name:"angle-down"})]})})]}),i&&P&&(0,n.jsx)($,{folderUid:i.uid,groupName:l,onClose:()=>q(!1)})]})}const S=(0,A.Xc)(R,{style:"page"})},4956:(B,f,e)=>{e.d(f,{B3:()=>tn,Om:()=>un,WG:()=>F,nh:()=>M});var n=e(74848),x=e(22803),_=e(55127),C=e.n(_),a=e(96540),D=e(92745),m=e(66404),r=e(89640),T=e(41654),O=e(63142),I=e(45967),A=e(34999),c=e(30703),v=e(24619),h=e(74268),G=e(7840),j=e(1625),z=e(1972),L=e(17305),y=e(52161),J=e(67598),$=e(39659),nn=e(77256),K=e(51592),k=e(1148),Z=e(87672),U=e(76267);const F=o=>{const{name:d,summary:p,state:g,health:R,error:W,href:S,isProvisioned:u,lastEvaluation:s,evaluationInterval:l,isPaused:i=!1,instancesCount:E=0,namespace:N,group:P,rulesSource:q,application:Q,contactPoint:Y,labels:w,origin:V,actions:b=null,operation:gn,showLocation:on=!0}=o,an=(0,a.useId)(),H=[];return N&&P&&on&&H.push((0,n.jsx)(m.E,{color:"secondary",variant:"bodySmall",children:(0,n.jsx)(en,{namespace:N,group:P,rulesSource:q,application:Q})})),i||(s&&l&&H.push((0,n.jsx)(dn,{lastEvaluation:s,evaluationInterval:l,state:g})),E&&H.push((0,n.jsx)(j.P,{icon:"layers-alt",children:(0,n.jsx)(r.Y,{href:S+"?tab=instances",variant:"bodySmall",color:"primary",inline:!1,children:C()("instance",E,!0)})}))),w&&(0,$.rm)(w)>0&&H.push((0,n.jsx)(j.P,{icon:"tag-alt",children:(0,n.jsx)(rn,{labels:w})})),!i&&Y&&H.push((0,n.jsxs)(j.P,{icon:"at",children:[(0,n.jsx)(D.x6,{i18nKey:"alerting.contact-points.delivered-to",children:"Delivered to"})," ",(0,n.jsx)(r.Y,{href:(0,nn.bI)(Y,y.hY),variant:"bodySmall",color:"primary",inline:!1,children:Y})]})),(0,n.jsx)(K.c,{"aria-labelledby":an,title:(0,n.jsxs)(T.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)(r.Y,{href:S,color:"primary",inline:!1,id:an,children:d}),V&&(0,n.jsx)(L.T,{pluginId:V.pluginId,size:"sm"}),u&&!V&&(0,n.jsx)(z.rS,{})]}),description:(0,n.jsx)(X,{content:p,error:W}),icon:(0,n.jsx)(Z.c,{state:g,health:R,isPaused:i,operation:gn}),actions:b,meta:H})};function M({name:o,namespace:d,group:p,rulesSource:g,application:R,href:W,health:S,isProvisioned:u,error:s,isPaused:l,origin:i,actions:E,showLocation:N=!0}){const P=[];return d&&p&&N&&P.push((0,n.jsx)(m.E,{color:"secondary",variant:"bodySmall",children:(0,n.jsx)(en,{namespace:d,group:p,rulesSource:g,application:R})})),(0,n.jsx)(K.c,{title:(0,n.jsxs)(T.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)(r.Y,{color:"primary",href:W,inline:!1,children:o}),i&&(0,n.jsx)(L.T,{pluginId:i.pluginId,size:"sm"}),u&&!i&&(0,n.jsx)(z.rS,{})]}),description:(0,n.jsx)(X,{error:s}),icon:(0,n.jsx)(Z.c,{recording:!0,health:S,isPaused:l}),actions:E,meta:P})}function tn({name:o,namespace:d,group:p,rulesSource:g,application:R,operation:W,showLocation:S=!0}){const u=(0,a.useId)(),s=[];return d&&p&&S&&s.push((0,n.jsx)(m.E,{color:"secondary",variant:"bodySmall",children:(0,n.jsx)(en,{namespace:d,group:p,rulesSource:g,application:R})})),(0,n.jsx)(K.c,{"aria-labelledby":u,title:(0,n.jsx)(T.B,{direction:"row",alignItems:"center",children:(0,n.jsx)(m.E,{id:u,children:o})}),icon:(0,n.jsx)(Z.c,{operation:W}),meta:s})}function X({content:o,error:d}){return d?(0,n.jsx)(m.E,{variant:"bodySmall",color:"error",weight:"light",truncate:!0,element:"p",children:d}):o?(0,n.jsx)(m.E,{variant:"bodySmall",color:"secondary",truncate:!0,children:o}):null}function rn({labels:o}){const d=(0,O.of)(sn);return(0,n.jsx)(I.m,{content:(0,n.jsx)("div",{className:d.ruleLabels.tooltip,children:(0,n.jsx)(G.m,{labels:o,size:"sm"})}),placement:"right",interactive:!0,children:(0,n.jsx)("div",{children:(0,n.jsx)(m.E,{variant:"bodySmall",color:"primary",children:C()("label",(0,$.rm)(o),!0)})})})}function dn({lastEvaluation:o,evaluationInterval:d,state:p}){const g=(0,U.C)(o,d);return p===v.cF.Firing&&g?(0,n.jsxs)(j.P,{icon:"clock-nine",children:[(0,n.jsx)(D.x6,{i18nKey:"alerting.alert-rules.firing-for",children:"Firing for"})," ",(0,n.jsx)(m.E,{color:"primary",children:"2m 34s"}),g&&(0,n.jsxs)(n.Fragment,{children:["\xB7 ",(0,n.jsx)(D.x6,{i18nKey:"alerting.alert-rules.next-evaluation-in",children:"next evaluation in"})," ",g.humanized]})]}):g?(0,n.jsxs)(j.P,{icon:"clock-nine",children:[(0,n.jsx)(D.x6,{i18nKey:"alerting.alert-rules.next-evaluation",children:"Next evaluation"})," ",g.humanized]}):null}const un=({ruleName:o,groupIdentifier:d,ruleDefinition:p})=>{const g=(0,O.of)(sn);return(0,a.useEffect)(()=>{const{namespace:R,groupName:W}=d,S={name:o,groupName:W,namespace:JSON.stringify(R),rulesSource:(0,J.rO)(d)};(0,h.vV)(new Error("unknown rule type"),S)},[o,d]),(0,n.jsx)(A.F,{title:(0,D.t)("alerting.unknown-rule-list-item.title-unknown-rule-type","Unknown rule type"),className:g.resetMargin,children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:(0,n.jsx)(D.x6,{i18nKey:"alerting.alert-rules.rule-definition",children:"Rule definition"})}),(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:JSON.stringify(p,null,2)})})]})})},en=({namespace:o,group:d,rulesSource:p,application:g})=>{const R=g==="grafana",W=!!p&&!!g&&!R;return(0,n.jsxs)(T.B,{direction:"row",alignItems:"center",gap:.5,children:[R&&(0,n.jsx)(c.I,{size:"xs",name:"folder"}),W&&(0,n.jsx)(I.m,{content:p.name,children:(0,n.jsx)("span",{children:(0,n.jsx)(k.H,{application:g,size:14})})}),(0,n.jsxs)(T.B,{direction:"row",alignItems:"center",gap:0,children:[o,(0,n.jsx)(c.I,{size:"sm",name:"angle-right"}),d]})]})},sn=o=>({alertListItemContainer:(0,x.css)({position:"relative",listStyle:"none",background:o.colors.background.primary,borderBottom:`solid 1px ${o.colors.border.weak}`,padding:o.spacing(1,1,1,1.5)}),resetMargin:(0,x.css)({margin:0}),ruleLabels:{tooltip:(0,x.css)({padding:o.spacing(1)}),text:(0,x.css)({cursor:"pointer"})}})},51592:(B,f,e)=>{e.d(f,{c:()=>m});var n=e(74848),x=e(22803),_=e(96540),C=e(63142),a=e(41654),D=e(66404);const m=I=>{const A=(0,C.of)(O),{icon:c=null,title:v,description:h,meta:G,metaRight:j,actions:z,"data-testid":L,...y}=I;return(0,n.jsx)("li",{className:A.alertListItemContainer,role:"treeitem","aria-selected":"false","data-testid":L,...y,children:(0,n.jsxs)(a.B,{direction:"row",alignItems:"start",gap:1,wrap:!1,children:[(0,n.jsx)("span",{className:A.statusIcon,children:c}),(0,n.jsxs)(a.B,{direction:"column",gap:0,flex:"1",minWidth:0,children:[(0,n.jsxs)(a.B,{direction:"column",gap:0,children:[(0,n.jsx)("div",{className:A.textOverflow,children:v}),(0,n.jsx)("div",{className:A.textOverflow,children:h})]}),(0,n.jsx)(a.B,{direction:"row",gap:.5,alignItems:"center",children:G?.map((J,$)=>(0,n.jsxs)(_.Fragment,{children:[$>0&&(0,n.jsx)(T,{}),J]},$))})]}),(0,n.jsxs)(a.B,{direction:"row",alignItems:"center",gap:1,wrap:!1,children:[j,z]})]})})},r=()=>jsx(m,{icon:jsx(Skeleton,{width:16,height:16,circle:!0}),title:jsx(Skeleton,{height:16,width:350}),actions:jsx(Skeleton,{height:10,width:200})}),T=()=>(0,n.jsx)(D.E,{color:"secondary",variant:"bodySmall",children:"\xB7"}),O=I=>({alertListItemContainer:(0,x.css)({position:"relative",listStyle:"none",padding:I.spacing(1),"&:hover":{background:I.colors.action.hover}}),textOverflow:(0,x.css)({overflow:"hidden",textOverflow:"ellipsis",color:"inherit"}),statusIcon:(0,x.css)({marginTop:I.spacing(.5)})})},1148:(B,f,e)=>{e.d(f,{H:()=>O});var n=e(74848),x=e(22803),_=e(30703),C=e(86559),a=e(27323),D=e(33611),m=e(24619),r=e(2401);const T=({children:c,name:v,href:h,application:G})=>{const j=useStyles2(I);return jsxs("li",{className:j.namespaceWrapper,role:"treeitem","aria-selected":"false",children:[jsx("div",{className:j.namespaceTitle,children:jsxs(Stack,{alignItems:"center",gap:1,children:[jsx(O,{application:G}),h?jsx(WithReturnButton,{title:t("alerting.namespace.title-alert-rules","Alert rules"),component:jsx(TextLink,{href:h,inline:!1,children:v})}):v]})}),c&&jsx("ul",{role:"group",className:j.groupItemsWrapper,children:c})]})},O=({application:c,size:v=16})=>{switch(c){case m.N1.Prometheus:return(0,n.jsx)("img",{width:v,height:v,src:D,alt:"Prometheus"});case m.N1.Mimir:return(0,n.jsx)("img",{width:v,height:v,src:a,alt:"Mimir"});case"Loki":return(0,n.jsx)("img",{width:v,height:v,src:C,alt:"Loki"});case"grafana":default:return(0,n.jsx)(_.I,{name:"grafana"})}},I=c=>({groupItemsWrapper:css({position:"relative",borderRadius:c.shape.radius.default,border:`solid 1px ${c.colors.border.weak}`,borderBottom:"none",marginLeft:c.spacing(3),"&:before":{content:"''",position:"absolute",height:"100%",borderLeft:`solid 1px ${c.colors.border.weak}`,marginTop:0,marginLeft:`-${c.spacing(2.5)}`}}),namespaceWrapper:css({display:"flex",flexDirection:"column",gap:c.spacing(1)}),namespaceTitle:css({padding:`${c.spacing(1)} ${c.spacing(1.5)}`})});var A=null},87672:(B,f,e)=>{e.d(f,{c:()=>G,s:()=>O});var n=e(74848),x=e(22803),_=e(96540),C=e(63142),a=e(45967),D=e(66404),m=e(30703),r=e(24619),T=e(22973),O=(L=>(L.Creating="Creating",L.Deleting="Deleting",L))(O||{});const I={[r.cF.Inactive]:"check-circle",[r.cF.Pending]:"circle",[r.cF.Recovering]:"exclamation-circle",[r.cF.Firing]:"exclamation-circle",[r.cF.Unknown]:"question-circle"},A={[r.cF.Inactive]:"success",[r.cF.Pending]:"warning",[r.cF.Recovering]:"warning",[r.cF.Firing]:"error",[r.cF.Unknown]:"info"},c={[r.cF.Inactive]:"Normal",[r.cF.Pending]:"Pending",[r.cF.Firing]:"Firing",[r.cF.Recovering]:"Recovering",[r.cF.Unknown]:"Unknown"},v={Creating:"plus-circle",Deleting:"minus-circle"},h=15,G=(0,_.memo)(function({state:y,health:J,recording:$=!1,isPaused:nn=!1,operation:K}){const k=(0,C.of)(z),Z=(0,C.$j)();let U=y?I[y]:"circle",F=y?A[y]:"secondary",M=y?c[y]:"unknown";return $&&(U="record-audio",F="success",M="Recording"),J==="nodata"&&(U="exclamation-triangle",F="warning",M="Insufficient data"),(0,T.lf)(J)&&(U="times-circle",F="error",M="Failed to evaluate rule"),nn&&(U="pause-circle",F="warning",M="Paused"),K&&(U=v[K],F="secondary",M=K),(0,n.jsx)(a.m,{content:M,placement:"right",children:(0,n.jsx)("div",{children:(0,n.jsx)(D.E,{color:F,children:(0,n.jsxs)("div",{className:k.iconsContainer,children:[(0,n.jsx)(m.I,{name:U,width:h,height:h,title:M}),K&&(0,n.jsx)("svg",{width:h,height:h,viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:k.spinning,children:(0,n.jsx)("circle",{r:h/2,cx:"10",cy:"10",stroke:Z.colors.background.primary,strokeWidth:"2",strokeLinecap:"round",fill:"transparent",strokeOpacity:.85,strokeDasharray:"20px"})})]})})})})}),j=(0,x.keyframes)({"0%":{transform:"rotate(0deg)"},"50%":{transform:"rotate(180deg)"},"100%":{transform:"rotate(360deg)"}}),z=L=>({iconsContainer:(0,x.css)({position:"relative",width:h,height:h,"> *":{position:"absolute"}}),spinning:(0,x.css)({[L.transitions.handleMotion("no-preference")]:{animationName:j,animationIterationCount:"infinite",animationDuration:"1s",animationTimingFunction:"linear"}})})},88721:(B,f,e)=>{e.d(f,{V:()=>_});var n=e(96540),x=e(54);function _(){return(0,n.useMemo)(()=>(0,x.Q9)(),[])}},86559:(B,f,e)=>{B.exports=e.p+"static/img/loki_icon.abc01135.svg"},27323:(B,f,e)=>{B.exports=e.p+"static/img/mimir_logo.ac01ecbc.svg"},33611:(B,f,e)=>{B.exports=e.p+"static/img/prometheus_logo.3e9d4662.svg"}}]);

//# sourceMappingURL=AlertingGroupDetails.667f824769cb75c2a4c4.js.map