{"version":3,"file":"ConnectionsDataSourcePermissionsPage.3e1cdcdf13ab6ed59657.js","mappings":"iOAQO,MAAMA,EAA4B,IAAM,CAC7C,KAAM,CAAE,IAAAC,EAAM,EAAG,KAAI,KAA2B,EAC1C,CAAE,MAAAC,EAAO,QAAAC,CAAQ,KAAI,KAAyB,aAAa,EAEjE,SACE,OAAC,IAAI,CAAC,MAAAD,EAAc,QAAAC,EAClB,mBAAC,IAAK,SAAL,CACC,mBAAC,IAAqB,CAAC,IAAAF,CAAA,CAAU,EACnC,EACF,CAEJ,EAEA,EAAeD,C,+HCVR,SAASI,EAAyBC,EAAsB,CAC7D,KAAM,CAAE,IAAAJ,EAAM,EAAG,KAAI,KAA2B,EAC1CK,KAAW,MAAY,EACvBC,KAAa,MAAcN,CAAG,EAC9BO,KAAiB,MAAkBD,EAAW,IAAI,EAClDE,KAAmB,MAAaF,EAAW,IAAI,EAC/CG,EAAS,IAAI,gBAAgBJ,EAAS,MAAM,EAC5CK,EAASN,GAAeK,EAAO,IAAI,MAAM,EAEzC,CAAE,OAAAE,EAAQ,UAAAC,EAAW,QAAAC,CAAQ,KAAI,MAAsB,EACvDC,KAAM,KAAiB,GAAG,oBAAoBd,CAAG,EACjDe,EAAqB,GAAQD,GAAK,MAAM,UAAY,IACpDE,EAA2BF,GAAK,OAAS,eACzCG,EAAoBF,GAAsBC,EAE1CE,KAAW,MAAaC,GAAUA,EAAM,QAAQ,EAChDC,EAAaV,EAAS,cAAcA,CAAM,IAAIV,CAAG,GAAK,uBAAuBA,CAAG,GACtF,IAAIE,EAAoB,CACtB,KAAM,CACJ,QAAM,KAAE,8EAA+E,sBAAsB,CAC/G,EACA,KAAM,CACJ,QAAM,KAAE,8EAA+E,sBAAsB,CAC/G,CACF,EAEA,GAAIU,EAAW,CACb,MAAMS,EAAqB,CACzB,KAAMT,EACN,YAAU,KAAE,2EAA4E,mBAAmB,EAC3G,KAAM,sBACR,EAEAV,EAAU,CACR,KAAAmB,EACA,KAAMA,CACR,CACF,CAEA,OAAIR,GAAW,CAACF,KACdT,KAAU,MAAYgB,EAAUE,KAAY,MAAwB,UAAU,CAAC,GAG7ET,IACFT,KAAU,MACRgB,EACAE,KACA,SAAiB,MAAcd,EAAYK,CAAM,EAAGD,GAAU,UAAU,CAC1E,GAeK,CACL,MAAO,0BACP,QAdyB,CACzB,GAAGR,EAAQ,KACX,qBAAsBM,GAAkB,MAAQG,GAAQ,KAAK,MAAQ,GACrE,OAAQ,GACR,KAAML,EAAW,KACjB,SAAU,SAASC,EAAe,IAAI,GACtC,UAAWL,EAAQ,KAAK,UAAY,CAAC,GAAG,IAAKoB,IAAkB,CAC7D,GAAGA,EACH,IAAKA,EAAa,KAAK,QAAQ,oBAAqB,gCAAgC,CACtF,EAAE,CACJ,EAKE,iBAAkB,CAChB,kBAAAL,CACF,CACF,CACF,C","sources":["webpack://grafana/./public/app/extensions/connections/DataSourcePermissionsPage.tsx","webpack://grafana/./public/app/features/connections/hooks/useDataSourceSettingsNav.ts"],"sourcesContent":["import { useParams } from 'react-router-dom-v5-compat';\n\nimport { Page } from 'app/core/components/Page/Page';\nimport { useDataSourceSettingsNav } from 'app/features/connections/hooks/useDataSourceSettingsNav';\n\nimport DataSourcePermissions from '../permissions/DataSourcePermissions';\n\n// The RBAC version of the data source permissions page\nexport const DataSourcePermissionsPage = () => {\n  const { uid = '' } = useParams<{ uid: string }>();\n  const { navId, pageNav } = useDataSourceSettingsNav('permissions');\n\n  return (\n    <Page navId={navId} pageNav={pageNav}>\n      <Page.Contents>\n        <DataSourcePermissions uid={uid} />\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default DataSourcePermissionsPage;\n","import { useLocation, useParams } from 'react-router-dom-v5-compat';\n\nimport { NavModel, NavModelItem } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { getDataSourceSrv } from '@grafana/runtime';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { useDataSource, useDataSourceMeta, useDataSourceSettings } from 'app/features/datasources/state/hooks';\nimport { getDataSourceLoadingNav, buildNavModel, getDataSourceNav } from 'app/features/datasources/state/navModel';\nimport { useGetSingle } from 'app/features/plugins/admin/state/hooks';\nimport { useSelector } from 'app/types/store';\n\nexport function useDataSourceSettingsNav(pageIdParam?: string) {\n  const { uid = '' } = useParams<{ uid: string }>();\n  const location = useLocation();\n  const datasource = useDataSource(uid);\n  const dataSourceMeta = useDataSourceMeta(datasource.type);\n  const datasourcePlugin = useGetSingle(datasource.type);\n  const params = new URLSearchParams(location.search);\n  const pageId = pageIdParam || params.get('page');\n\n  const { plugin, loadError, loading } = useDataSourceSettings();\n  const dsi = getDataSourceSrv()?.getInstanceSettings(uid);\n  const hasAlertingEnabled = Boolean(dsi?.meta?.alerting ?? false);\n  const isAlertManagerDatasource = dsi?.type === 'alertmanager';\n  const alertingSupported = hasAlertingEnabled || isAlertManagerDatasource;\n\n  const navIndex = useSelector((state) => state.navIndex);\n  const navIndexId = pageId ? `datasource-${pageId}-${uid}` : `datasource-settings-${uid}`;\n  let pageNav: NavModel = {\n    node: {\n      text: t('connections.use-data-source-settings-nav.page-nav.text.data-source-nav-node', 'Data Source Nav Node'),\n    },\n    main: {\n      text: t('connections.use-data-source-settings-nav.page-nav.text.data-source-nav-node', 'Data Source Nav Node'),\n    },\n  };\n\n  if (loadError) {\n    const node: NavModelItem = {\n      text: loadError,\n      subTitle: t('connections.use-data-source-settings-nav.node.subTitle.data-source-error', 'Data Source Error'),\n      icon: 'exclamation-triangle',\n    };\n\n    pageNav = {\n      node: node,\n      main: node,\n    };\n  }\n\n  if (loading || !plugin) {\n    pageNav = getNavModel(navIndex, navIndexId, getDataSourceLoadingNav('settings'));\n  }\n\n  if (plugin) {\n    pageNav = getNavModel(\n      navIndex,\n      navIndexId,\n      getDataSourceNav(buildNavModel(datasource, plugin), pageId || 'settings')\n    );\n  }\n\n  const connectionsPageNav = {\n    ...pageNav.main,\n    dataSourcePluginName: datasourcePlugin?.name || plugin?.meta.name || '',\n    active: true,\n    text: datasource.name,\n    subTitle: `Type: ${dataSourceMeta.name}`,\n    children: (pageNav.main.children || []).map((navModelItem) => ({\n      ...navModelItem,\n      url: navModelItem.url?.replace('datasources/edit/', '/connections/datasources/edit/'),\n    })),\n  };\n\n  return {\n    navId: 'connections-datasources',\n    pageNav: connectionsPageNav,\n    dataSourceHeader: {\n      alertingSupported,\n    },\n  };\n}\n"],"names":["DataSourcePermissionsPage","uid","navId","pageNav","useDataSourceSettingsNav","pageIdParam","location","datasource","dataSourceMeta","datasourcePlugin","params","pageId","plugin","loadError","loading","dsi","hasAlertingEnabled","isAlertManagerDatasource","alertingSupported","navIndex","state","navIndexId","node","navModelItem"],"sourceRoot":""}