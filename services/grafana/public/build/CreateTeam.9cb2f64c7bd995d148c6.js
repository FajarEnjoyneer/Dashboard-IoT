"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5436],{99929:(f,O,e)=>{e.d(O,{Y:()=>E});var a=e(74848),A=e(96540),d=e(41053),o=e(73427),c=e(11257),l=e(59812),m=e(34418);const E=({teamId:r,roleOptions:R,disabled:_,roles:s,onApplyRoles:P,pendingRoles:i,apply:n=!1,maxWidth:t,width:T,isLoading:C})=>{const[{loading:u,value:I=s||[]},D]=(0,d.A)(async()=>{try{if(s)return s;if(n&&i?.length)return i;if(o.TP.hasPermission(c.w.ActionTeamsRolesList)&&r>0)return await(0,m.xN)(r)}catch(M){console.error("Error loading options",M)}return[]},[r,i,s]);(0,A.useEffect)(()=>{D()},[D]);const L=async M=>{n?P&&P(M):(await(0,m.G3)(M,r),await D())},U=o.TP.hasPermission(c.w.ActionTeamsRolesAdd)&&o.TP.hasPermission(c.w.ActionTeamsRolesRemove);return(0,a.jsx)(l.n,{apply:n,onRolesChange:L,roleOptions:R,appliedRoles:I,isLoading:u||C,disabled:_,basicRoleDisabled:!0,canUpdateRoles:U,maxWidth:t,width:T})}},99686:(f,O,e)=>{e.d(O,{P:()=>R,o:()=>r});var a=e(2543),A=e.n(a),d=e(96540),o=e(45214),c=e(24705),l=e(73427),m=e(11257),E=e(34418);const r=_=>{const[s,P]=(0,d.useState)(_),{value:i=[]}=(0,c.A)(async()=>l.TP.licensedAccessControlEnabled()&&l.TP.hasPermission(m.w.ActionRolesList)?(0,E.RL)(s):Promise.resolve([]),[s]);return[{roleOptions:i},P]},R=_=>{const[s,P]=(0,d.useState)({});return(0,o.A)(()=>{if(!l.TP.licensedAccessControlEnabled()||!l.TP.hasPermission(m.w.ActionRolesList))return;const i=Object.keys(s).map(t=>typeof t=="number"?t:parseInt(t,10)),n=(0,a.difference)(_,i);Promise.all(n.map(t=>(0,E.RL)(t).then(T=>[t,T]))).then(t=>{P({...s,...Object.fromEntries(t)})})},[_]),s}},84974:(f,O,e)=>{e.r(O),e.d(O,{CreateTeam:()=>C,default:()=>u});var a=e(74848),A=e(96540),d=e(49785),o=e(92745),c=e(68143),l=e(36490),m=e(16780),E=e(37386),r=e(63527),R=e(45861),_=e(13791),s=e(99929),P=e(34418),i=e(99686),n=e(73427),t=e(11257);const T={icon:"users-alt",id:"team-new",text:"New team",subTitle:"Create a new team. Teams let you grant permissions to a group of users."},C=()=>{const I=n.TP.user.orgId,[D,L]=(0,A.useState)([]),[{roleOptions:U}]=(0,i.o)(I),{handleSubmit:M,register:h,formState:{errors:W}}=(0,d.mN)(),B=n.TP.hasPermission(t.w.ActionUserRolesAdd)&&n.TP.hasPermission(t.w.ActionUserRolesRemove),K=async g=>{const v=await(0,c.AI)().post("/api/teams",g);if(v.teamId){try{await n.TP.fetchUserPermissions(),n.TP.licensedAccessControlEnabled()&&B&&await(0,P.G3)(D,v.teamId,v.orgId)}catch(p){console.error(p)}l.Ny.push(`/org/teams/edit/${v.uid}`)}};return(0,a.jsx)(_.Y,{navId:"teams",pageNav:T,children:(0,a.jsx)(_.Y.Contents,{children:(0,a.jsxs)("form",{onSubmit:M(K),style:{maxWidth:"600px"},children:[(0,a.jsxs)(m.n,{children:[(0,a.jsx)(E.D,{label:(0,o.t)("teams.create-team.label-name","Name"),required:!0,invalid:!!W.name,error:"Team name is required",children:(0,a.jsx)(r.p,{...h("name",{required:!0}),id:"team-name"})}),n.TP.licensedAccessControlEnabled()&&(0,a.jsx)(E.D,{label:(0,o.t)("teams.create-team.label-role","Role"),children:(0,a.jsx)(s.Y,{teamId:0,roleOptions:U,disabled:!1,apply:!0,onApplyRoles:L,pendingRoles:D,maxWidth:"100%"})}),(0,a.jsx)(E.D,{label:(0,o.t)("teams.create-team.label-email","Email"),description:(0,o.t)("teams.create-team.description-email","This is optional and is primarily used for allowing custom team avatars"),children:(0,a.jsx)(r.p,{...h("email"),type:"email",id:"team-email",placeholder:"email@test.com"})})]}),(0,a.jsx)(R.$n,{type:"submit",variant:"primary",children:(0,a.jsx)(o.x6,{i18nKey:"teams.create-team.create",children:"Create"})})]})})})},u=C}}]);

//# sourceMappingURL=CreateTeam.9cb2f64c7bd995d148c6.js.map