"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1037,2182],{15134:(I,m,e)=>{e.r(m),e.d(m,{default:()=>J});var t=e(74848),d=e(96540),n=e(92745),a=e(34999),E=e(71599),s=e(41654),f=e(54314),c=e(60208),l=e(13941),i=e(33680),j=e(13791),D=e(83673),L=e(90886),x=e(12737),C=e(74451),y=e(89640),T=e(30703),B=e(66404),M=e(8073),S=e(45861),b=e(34145),U=e(91555),W=e(52524),$=e(31660);function Z({repository:o}){const{metadata:g,spec:r,status:p}=o,v=g?.name??"",u=()=>{const h=[];if(r?.type==="github"){const{url:P="",branch:A}=r.github??{},K=A?`${P}/tree/${A}`:P;if(h.push((0,t.jsx)(y.Y,{external:!0,href:K,children:K},"link")),p?.webhook?.id){const O=`${P}/settings/hooks/${p.webhook.id}`;h.push((0,t.jsxs)(s.B,{gap:1,direction:"row",alignItems:"center",children:[(0,t.jsx)(y.Y,{href:O,children:(0,t.jsx)(n.x6,{i18nKey:"provisioning.repository-card.get-repository-meta.webhook",children:"Webhook"})},"webhook"),(0,t.jsx)(T.I,{name:"check",className:"text-success"})]}))}}else r?.type==="local"&&h.push((0,t.jsx)(B.E,{variant:"bodySmall",children:r.local?.path??""},"path"));return h},R=()=>r?.type==="github"?"github":"database";return(0,t.jsxs)(M.Z,{children:[(0,t.jsx)(M.Z.Figure,{children:(0,t.jsx)(T.I,{name:R(),size:"xxl"})}),(0,t.jsx)(M.Z.Heading,{children:(0,t.jsxs)(s.B,{gap:2,direction:"row",alignItems:"center",children:[r?.title&&(0,t.jsx)(B.E,{variant:"h3",children:r.title}),(0,t.jsx)(b.W,{repo:o})]})}),(0,t.jsx)(M.Z.Description,{children:(0,t.jsxs)(s.B,{gap:2,direction:"column",children:[r?.description&&(0,t.jsx)(B.E,{children:r.description}),p?.stats?.length&&(0,t.jsx)(s.B,{gap:1,direction:"row",wrap:!0,children:p.stats.map((h,P)=>(0,t.jsxs)(S.z9,{fill:"outline",size:"md",variant:"secondary",href:z(o,h),children:[h.count," ",h.resource]},P))})]})}),(0,t.jsx)(M.Z.Meta,{children:(0,t.jsx)(s.B,{gap:2,direction:"row",wrap:!0,children:u()})}),(0,t.jsx)(M.Z.Actions,{children:(0,t.jsxs)(s.B,{gap:1,direction:"row",children:[(0,t.jsx)(S.z9,{icon:"eye",href:`${U.mL}/${v}`,variant:"primary",size:"md",children:(0,t.jsx)(n.x6,{i18nKey:"provisioning.repository-card.view",children:"View"})}),(0,t.jsx)($.w,{repository:o}),(0,t.jsx)(S.z9,{variant:"secondary",icon:"cog",href:`${U.mL}/${v}/edit`,size:"md",children:(0,t.jsx)(n.x6,{i18nKey:"provisioning.repository-card.settings",children:"Settings"})})]})}),(0,t.jsx)(M.Z.SecondaryActions,{children:(0,t.jsx)(W.q,{name:v})})]},v)}function z(o,g){return g.resource==="playlists"?"/playlists":o.spec?.sync.target==="folder"?`/dashboards/f/${o.metadata?.name}`:"/dashboards"}var F=e(93838),G=e(3064);function N({items:o}){const[g,r]=(0,d.useState)(""),p=o.filter(u=>u.metadata?.name?.includes(g)),{instanceConnected:v}=(0,F.X)(o);return(0,t.jsxs)(s.B,{direction:"column",gap:3,children:[!v&&(0,t.jsxs)(s.B,{gap:2,children:[(0,t.jsx)(x.Z,{placeholder:(0,n.t)("provisioning.folder-repository-list.placeholder-search","Search"),value:g,onChange:r}),(0,t.jsx)(G.N,{items:o,showDropdown:!0})]}),(0,t.jsx)(s.B,{direction:"column",children:p.length?p.map(u=>(0,t.jsx)(Z,{repository:u},u.metadata?.name)):(0,t.jsx)(C.Z,{children:(0,t.jsx)(n.x6,{i18nKey:"provisioning.folder-repository-list.no-results-matching-your-query",children:"No results matching your query"})})})]})}function Y(o={}){const g=(0,i.Ih)(o),r=new Intl.Collator(void 0,{numeric:!0});return[g.data?.items?.slice().sort((v,u)=>{const R=v.spec?.title??"",h=u.spec?.title??"";return r.compare(R,h)}),g.isLoading]}var H=(o=>(o.Repositories="repositories",o.GettingStarted="getting-started",o))(H||{});function J(){const[o,g]=Y({watch:!0}),r=(0,i.F9)(),[p]=(0,i.KA)(),[v,u]=(0,d.useState)(!1),[R,h]=(0,d.useState)("repositories"),P=(0,d.useMemo)(()=>[{value:"repositories",label:(0,n.t)("provisioning.home-page.tab-repositories","Repositories"),title:(0,n.t)("provisioning.home-page.tab-repositories-title","List of repositories")},{value:"getting-started",label:(0,n.t)("provisioning.home-page.tab-getting-started","Getting started"),title:(0,n.t)("provisioning.home-page.tab-getting-started-title","Getting started")}],[]);if(!o?.length&&!g)return(0,t.jsx)(L.default,{items:o??[]});const A=()=>{p({}),u(!1)},K=()=>{switch(R){case"repositories":return(0,t.jsx)(N,{items:o??[]});case"getting-started":return(0,t.jsx)(D.A,{items:o??[]});default:return null}};return(0,t.jsx)(j.Y,{navId:"provisioning",subTitle:(0,n.t)("provisioning.home-page.subtitle","View and manage your configured repositories"),children:(0,t.jsxs)(j.Y.Contents,{isLoading:g,children:[r.data?.legacyStorage&&(0,t.jsx)(a.F,{title:(0,n.t)("provisioning.home-page.title-legacy-storage-detected","Legacy storage detected"),severity:"error",buttonContent:(0,t.jsx)(n.x6,{i18nKey:"provisioning.home-page.remove-all-configured-repositories",children:"Remove all configured repositories"}),onRemove:()=>{u(!0)},children:(0,t.jsx)(n.x6,{i18nKey:"provisioning.home-page.configured-repositories-while-running-legacy-storage",children:"Configured repositories will not work while running legacy storage."})}),(0,t.jsx)(E.u,{isOpen:v,title:(0,n.t)("provisioning.home-page.title-delete-all-configured-repositories","Delete all configured repositories"),body:(0,n.t)("provisioning.home-page.confirm-delete-repositories","Are you sure you want to delete all configured repositories? This action cannot be undone."),confirmText:(0,n.t)("provisioning.home-page.button-delete-repositories","Delete repositories"),onConfirm:A,onDismiss:()=>u(!1)}),(0,t.jsxs)(s.B,{direction:"column",gap:2,children:[(0,t.jsx)(f.U,{children:P.map(O=>(0,t.jsx)(c.o,{label:O.label,active:R===O.value,onChangeTab:()=>h(O.value),title:O.title},O.value))}),(0,t.jsx)(l.J,{children:K()})]})]})})}},52524:(I,m,e)=>{e.d(m,{q:()=>c});var t=e(74848),d=e(96540),n=e(54148),a=e(92745),E=e(76319),s=e(71599),f=e(33680);function c({name:l,redirectTo:i}){const[j,D]=(0,f.So)(),[L,x]=(0,d.useState)(!1),C=(0,n.Zp)();(0,d.useEffect)(()=>{D.isSuccess&&(x(!1),i&&C(i))},[D.isSuccess,i,C]);const y=(0,d.useCallback)(()=>{j({name:l})},[j,l]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.K,{name:"trash-alt",tooltip:(0,a.t)("provisioning.delete-repository-button.tooltip-delete-this-repository","Delete this repository"),disabled:D.isLoading,onClick:()=>{x(!0)}}),(0,t.jsx)(s.u,{isOpen:L,title:(0,a.t)("provisioning.delete-repository-button.title-delete-repository","Delete repository config"),body:(0,a.t)("provisioning.delete-repository-button.confirm-delete-repository","Are you sure you want to delete the repository config?"),confirmText:(0,a.t)("provisioning.delete-repository-button.button-delete","Delete"),onConfirm:y,onDismiss:()=>x(!1)})]})}},31660:(I,m,e)=>{e.d(m,{w:()=>l});var t=e(74848),d=e(96540),n=e(54148),a=e(92745),E=e(45861),s=e(71599),f=e(33680),c=e(91555);function l({repository:i}){const[j,D]=(0,f.bS)(),[L,x]=(0,d.useState)(!1),C=(0,n.Zp)(),y=i.metadata?.name,T=()=>{y&&(j({name:y,jobSpec:{pull:{incremental:!1}}}),x(!1))},B=!!i.status?.health.healthy;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.$n,{icon:"cloud-download",variant:"secondary",tooltip:B?void 0:(0,a.t)("provisioning.sync-repository.tooltip-unhealthy-repository","Unable to pull an unhealthy repository"),disabled:D.isLoading||!y||!B,onClick:T,children:(0,t.jsx)(a.x6,{i18nKey:"provisioning.sync-repository.pull",children:"Pull"})}),!i.spec?.sync.enabled&&(0,t.jsx)(s.u,{isOpen:L,title:(0,a.t)("provisioning.sync-repository.title-pull-not-enabled","Pull is not enabled"),body:(0,a.t)("provisioning.sync-repository.body-edit-configuration","Edit the configuration"),confirmText:(0,a.t)("provisioning.sync-repository.button-edit","Edit"),onConfirm:()=>C(`${c.mL}/${y}/edit`),onDismiss:()=>x(!1)})]})}},34145:(I,m,e)=>{e.d(m,{W:()=>E});var t=e(74848),d=e(36490),n=e(99887),a=e(91555);function E({repo:s}){if(!s)return null;let f,c="purple",l="Unknown",i="exclamation-triangle";if(s.metadata?.deletionTimestamp)c="red",l="Deleting",i="spinner";else if(!s.spec?.sync?.enabled)c="red",l="Automatic pulling disabled",i="info-circle";else if(!s.status?.sync?.state?.length)c="orange",l="Pending",i="spinner",f="Waiting for health check to run";else switch(s.status?.sync?.state){case"success":i="check",l="Up-to-date",c="green";break;case"working":case"pending":c="orange",l="Pulling",i="spinner";break;case"error":c="red",l="Error",i="exclamation-triangle";break;default:break}return(0,t.jsx)(n.E,{color:c,icon:i,text:l,style:{cursor:"pointer"},tooltip:f,onClick:()=>{d.Ny.push(`${a.mL}/${s.metadata?.name}/?tab=overview`)}})}},94726:(I,m,e)=>{I.exports=e.p+"static/img/provisioning.d25529e1.svg"}}]);

//# sourceMappingURL=RepositoryListPage.930f0848a4691cdf6d90.js.map