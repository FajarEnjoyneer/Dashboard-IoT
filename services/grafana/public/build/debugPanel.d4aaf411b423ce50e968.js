"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2770],{13326:(A,R,s)=>{s.d(R,{e:()=>L});var d=s(74848),t=s(22803),C=s(16515),I=s(55386),v=s(46635),O=s(92745),l=s(739),w=s(63142),M=s(89640),V=s(53049),K=s(70362);function E(o,h,y,x,S){const u=o.fields,b=y!=null?u[y]:null,f=u.filter(e=>!e.config.custom?.hideFrom?.tooltip),p=f.find(e=>e.name==="traceID")||u[0],a=[];if(f.filter(e=>p===e).length>0&&a.push(p),a.push(...f.filter(e=>p!==e)),a.length===0)return null;const g=[],m=[],r=new Set;for(const e of a){if(S===l.$N.Single&&e!==b)continue;const n=e.values[h],i=e.display?e.display(n):{text:`${n}`,numeric:+n};e.getLinks&&e.getLinks({calculatedValue:i,valueRowIndex:h}).forEach(c=>{const j=`${c.title}/${c.href}`;r.has(j)||(m.push(c),r.add(j))}),g.push({name:(0,C.Ct)(e,o),value:n,valueString:(0,I.cN)(i),highlight:e===b})}return x&&x!==l.xB.None&&g.sort((e,n)=>v.sortValues(x)(e.value,n.value)),{displayValues:g,links:m}}const L=({data:o,rowIndex:h,columnIndex:y,sortOrder:x,mode:S,header:u,padding:b=0,maxHeight:f})=>{const p=(0,w.of)(B,b);if(!o||h==null)return null;const a=E(o,h,y,x,S);if(a==null)return null;const{displayValues:g,links:m}=a;return u==="Exemplar"?(0,d.jsx)(K.i,{displayValues:g,links:m,header:u,maxHeight:f}):(0,d.jsxs)("div",{className:p.wrapper,children:[u&&(0,d.jsx)("div",{className:p.header,children:(0,d.jsx)("span",{className:p.title,children:u})}),(0,d.jsx)("table",{className:p.infoWrap,children:(0,d.jsxs)("tbody",{children:[g.map((r,e)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:r.name}),(0,d.jsx)("td",{children:(0,V.A)(r.valueString)})]},`${e}/${h}`)),m.map((r,e)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:(0,d.jsx)(O.x6,{i18nKey:"visualization.data-hover-view.link",children:"Link"})}),(0,d.jsx)("td",{colSpan:2,children:(0,d.jsx)(M.Y,{href:r.href,external:r.target==="_blank",weight:"medium",inline:!1,children:r.title})})]},e))]})})]})},B=(o,h=0)=>({wrapper:(0,t.css)({padding:`${h}px`,background:o.components.tooltip.background,borderRadius:o.shape.borderRadius(2)}),header:(0,t.css)({background:o.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:o.spacing(1)}),title:(0,t.css)({fontWeight:o.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,t.css)({padding:o.spacing(1),background:"transparent",border:"none",th:{fontWeight:o.typography.fontWeightMedium,padding:o.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${o.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,t.css)({color:o.colors.text.link})})},54952:(A,R,s)=>{s.r(R),s.d(R,{plugin:()=>m});var d=s(16207),t=s(74848),C=s(96540),I=s(64423),v=s(57852),O=s(32899),l=s(92745),w=s(52718),M=s(13326);class V extends C.Component{constructor(){super(...arguments),this.subscription=new I.yU,this.state={}}componentDidMount(){const{eventBus:e}=this.props;this.subscription.add(e.subscribe(v.b_,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(v.ql,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(O.kb,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(O.Tq,n=>{this.setState({event:n})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:e}=this.state;if(!e)return(0,t.jsx)("div",{children:(0,t.jsx)(l.x6,{i18nKey:"debug.cursor-view.no-events-yet",children:"No events yet"})});const{type:n,payload:i,origin:c}=e;return(0,t.jsxs)(w.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,t.jsxs)("h3",{children:["event.origin: ",c?.path]}),(0,t.jsxs)("span",{children:["event.type: ",n]}),!!i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("pre",{children:JSON.stringify(i.point,null,"  ")}),i.data&&(0,t.jsx)(M.e,{data:i.data,rowIndex:i.rowIndex,columnIndex:i.columnIndex})]})]})}}var K=s(94777);let E=100;class L extends C.PureComponent{constructor(e){super(e),this.history=new K.$({capacity:40,append:"head"}),this.eventObserver={next:i=>{const c=i.origin;this.history.add({key:E++,type:i.type,path:c?.path,payload:i.payload}),this.setState({counter:E})}},this.state={counter:E};const n=[];n.push(e.eventBus.getStream(v.b_).subscribe(this.eventObserver)),n.push(e.eventBus.getStream(v.ql).subscribe(this.eventObserver)),n.push(e.eventBus.getStream(v.LO).subscribe(this.eventObserver)),this.subs=n}componentWillUnmount(){for(const e of this.subs)e.unsubscribe()}render(){return(0,t.jsx)(w.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((e,n)=>(0,t.jsxs)("div",{children:[JSON.stringify(e.path)," ",e.type," / X:",JSON.stringify(e.payload.x)," / Y:",JSON.stringify(e.payload.y)]},e.key))})}}var B=s(76732),o=s(46644),h=s(16515),y=s(76319);class x extends C.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(e){const{data:n,options:i}=this.props;if(e.data!==n&&(this.counters.dataChanged++,i.counters?.schemaChanged)){const c=e.data?.series,j=n.series;j&&c&&((0,B.J3)(j,c,B.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:e,options:n}=this.props,i=n.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const c=Date.now(),j=c-this.lastRender;this.lastRender=c;const T=o.AS.get(o.gy.lastNotNull);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(y.K,{name:"step-backward",title:(0,l.t)("debug.render-info-viewer.title-reset-counters","Reset counters"),onClick:this.resetCounters,tooltip:(0,l.t)("debug.render-info-viewer.tooltip-step-back","Step back")}),(0,t.jsxs)("span",{children:[i.render&&(0,t.jsx)("span",{children:(0,t.jsxs)(l.x6,{i18nKey:"debug.render-info-viewer.render-counter",values:{numRenders:this.counters.render},children:["Render: ","{{numRenders}}","\xA0"]})}),i.dataChanged&&(0,t.jsx)("span",{children:(0,t.jsxs)(l.x6,{i18nKey:"debug.render-info-viewer.data-counter",values:{numDataChanges:this.counters.dataChanged},children:["Data: ","{{numDataChanges}}","\xA0"]})}),i.schemaChanged&&(0,t.jsx)("span",{children:(0,t.jsxs)(l.x6,{i18nKey:"debug.render-info-viewer.schema-counter",values:{numSchemaChanges:this.counters.schemaChanged},children:["Schema: ","{{numSchemaChanges}}","\xA0"]})}),(0,t.jsx)("span",{children:(0,t.jsxs)(l.x6,{i18nKey:"debug.render-info-viewer.elapsed-time",children:["Time: ",{elapsed:j},"ms"]})})]})]}),e.series&&e.series.map((D,W)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{children:[(0,h.Ri)(D,W)," (",D.length,")"]}),(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(l.x6,{i18nKey:"debug.render-info-viewer.field",children:"Field"})}),(0,t.jsx)("td",{children:(0,t.jsx)(l.x6,{i18nKey:"debug.render-info-viewer.type",children:"Type"})}),(0,t.jsx)("td",{children:(0,t.jsx)(l.x6,{i18nKey:"debug.render-info-viewer.last",children:"Last"})})]})}),(0,t.jsx)("tbody",{children:D.fields.map((P,U)=>{const N=T.reduce(P,!1,!1)[T.id];return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,h.Ct)(P,D,e.series)}),(0,t.jsx)("td",{children:P.type}),(0,t.jsx)("td",{children:`${N}`})]},`${U}/${P.name}`)})})]})]},`${W}/${D.refId}`))]})}}var S=s(64400),u=s(37386),b=s(63527);function f(r){const e=(0,S.d2)(),n=i=>{e.onInstanceStateChange({name:i.currentTarget.value})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(u.D,{label:(0,l.t)("debug.state-view.label-state-name","State name"),children:(0,t.jsx)(b.p,{value:e.instanceState?.name??"",onChange:n})})})}function p({value:r,context:e,onChange:n,item:i}){return(0,t.jsx)("div",{children:(0,t.jsxs)(l.x6,{i18nKey:"debug.state-view.current-value",values:{currentValue:e.instanceState?.name},children:["Current value: ","{{currentValue}}"," "]})})}var a=(r=>(r.Cursor="cursor",r.Events="events",r.Render="render",r.State="State",r.ThrowError="ThrowError",r))(a||{});class g extends C.Component{render(){const{options:e}=this.props;switch(e.mode){case a.Events:return(0,t.jsx)(L,{eventBus:this.props.eventBus});case a.Cursor:return(0,t.jsx)(V,{eventBus:this.props.eventBus});case a.State:return(0,t.jsx)(f,{...this.props});case a.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,t.jsx)(x,{...this.props})}}}const m=new d.m(g).useFieldConfig().setPanelOptions(r=>{r.addSelect({path:"mode",name:"Mode",defaultValue:a.Render,settings:{options:[{label:"Render",value:a.Render},{label:"Events",value:a.Events},{label:"Cursor",value:a.Cursor},{label:"Cursor",value:a.Cursor},{label:"Share state",value:a.State},{label:"Throw error",value:a.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:e})=>e===a.State,editor:p}).addBooleanSwitch({path:"counters.render",name:"Render count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data changed count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema changed count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})})}}]);

//# sourceMappingURL=debugPanel.d4aaf411b423ce50e968.js.map