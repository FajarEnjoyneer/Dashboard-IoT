"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6199],{44372:(Nt,j,t)=>{t.r(j),t.d(j,{plugin:()=>gt});var G=t(16207),T=t(83340),J=t(64394),F=t(95004),H=t(38809),o=t(92745),m=t(739),X=t(45013),L=t(44017),w=t(41069),b=t(79277),D=t(17914),I=t(76548),d=t(74848),c=t(96540),W=t(84229),k=t(14477),q=t(63142),_=t(64400),tt=t(18667),V=t(69234),et=t(16608),A=t(68706),nt=t(36327),st=t(13507),at=t(76234),lt=t(44391),E=t(28343);const ot=({data:a,timeRange:s,timeZone:e,options:n,width:l,height:i,fieldConfig:P,replaceVariables:f,onChangeTimeRange:u,id:g})=>{const r=(0,q.$j)(),[v,N]=(0,c.useState)(null),{sync:mt,eventsScope:ft,canAddAnnotations:B,dataLinkPostProcessor:vt,eventBus:pt}=(0,_.d2)(),R=mt?.()??W.y.Off,{frames:ct,warn:$}=(0,c.useMemo)(()=>(0,A.Qe)(a.series,n.mergeValues??!0,s,r),[a.series,n.mergeValues,s,r]),{paginatedFrames:x,paginationRev:ht,paginationElement:xt,paginationHeight:yt}=(0,E.W)(ct,n.perPage),St=(0,c.useMemo)(()=>(0,A.Or)(x,n.legend,r),[x,n.legend,r]),Ct=(0,c.useMemo)(()=>(0,at.Fg)(n.timezone,e),[n.timezone,e]);if(!x||typeof $=="string")return(0,d.jsx)(k.a,{panelId:g,fieldConfig:P,data:a,message:$,needsTimeField:!0});const Q=!!(B&&B());return(0,d.jsxs)("div",{className:E.i.container,children:[(0,d.jsx)(et.I,{theme:r,frames:x,structureRev:a.structureRev,paginationRev:ht,timeRange:s,timeZone:Ct,width:l,height:i-yt,legendItems:St,...n,mode:A.pm.Changes,replaceVariables:f,dataLinkPostProcessor:vt,cursorSync:R,children:(y,S)=>(0,d.jsxs)(d.Fragment,{children:[R!==W.y.Off&&(0,d.jsx)(tt.K,{config:y,eventBus:pt,frame:S}),n.tooltip.mode!==m.$N.None&&(0,d.jsx)(V.xl,{config:y,hoverMode:n.tooltip.mode===m.$N.Multi?V.b3.xAll:V.b3.xOne,queryZoom:u,syncMode:R,syncScope:ft,getDataLinks:(C,O)=>S.fields[C].getLinks?.({valueRowIndex:O})??[],render:(C,O,Tt,Vt,U,Y,At,Mt)=>{if(Q&&Y!=null){N(Y),U();return}const Pt=()=>{let Z=C.posToVal(C.cursor.left,"x");N({from:Z,to:Z}),U()};return(0,d.jsx)(lt.K,{series:S,dataIdxs:O,seriesIdx:Tt,mode:At?m.$N.Multi:n.tooltip.mode,sortOrder:n.tooltip.sort,isPinned:Vt,timeRange:s,annotate:Q?Pt:void 0,withDuration:!0,maxHeight:n.tooltip.maxHeight,replaceVariables:f,dataLinks:Mt})},maxWidth:n.tooltip.maxWidth}),S.fields[0].config.custom?.axisPlacement!==m.vM.Hidden&&(0,d.jsx)(nt.W,{annotations:a.annotations??[],config:y,timeZone:e,newRange:v,setNewRange:N,canvasRegionRendering:!1}),(0,d.jsx)(st.U,{config:y,onChangeTimeRange:u})]})}),xt]})};var M=t(2543),h=t(18600);const it=(a,s,e)=>{let n=a.options??{};if(s==="natel-discrete-panel"&&e.angular){const l=e.angular,i=a.fieldConfig??{defaults:{},overrides:[]};l.units&&(i.defaults.unit=l.units);const P={fillOpacity:100,lineWidth:0};i.defaults.custom=P,n.mergeValues=!0;const f={type:h.d.ValueToText,options:{}};if(i.defaults.mappings=[f],(0,M.isArray)(l.colorMaps))for(const u of l.colorMaps){const g=u.color;g&&(f.options[u.text]={color:g})}if((0,M.isArray)(l.valueMaps))for(const u of l.valueMaps){const g=u.text,r=u.value;if(g&&r){let v=f.options[r];v?v.text=g:f.options[r]={text:g}}}if((0,M.isArray)(l.rangeMaps))for(const u of l.rangeMaps){let g=+u.from,r=+u.to;const v=u.text;v&&i.defaults.mappings.push({type:h.d.RangeToText,options:{from:g,to:r,result:{text:v}}})}i.defaults.mappings?.length&&(i.defaults.mappings=ut(i.defaults.mappings)),a.fieldConfig=i}return n};function ut(a){let s={};for(const e of a)if(K(e))for(const n in e.options){const l=e.options[n];l.color?.length&&(s[n]=l.color)}else if(z(e)){const{text:n,color:l}=e.options.result;n?.length&&l?.length&&!s[n]&&(s[n]=l)}return a.map(e=>{if(K(e))for(const n in e.options){const l=e.options[n];if(!l.color?.length){let i=s[n];!i&&l.text&&(i=s[l.text]),i&&(l.color=i)}}else if(z(e)){const{text:n,color:l}=e.options.result;!l&&n&&s[n]&&(e.options.result.color=s[n])}return e})}function K(a){return a.type===h.d.ValueToText}function z(a){return a.type===h.d.RangeToText}var p=t(11686),rt=t(73495);class dt{getSuggestionsForData(s){const{dataSummary:e}=s;if(!e.hasData||!e.hasTimeField||!e.hasStringField&&!e.hasNumberField||e.numberFieldCount>=30||e.preferredVisualisationType==="logs")return;s.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:rt.m.StateTimeline})}}const gt=new G.m(ot).setPanelChangeHandler(it).useFieldConfig({standardOptions:{[T.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:J.Y.ContinuousGrYlRd}},[T.uo.Links]:{settings:{showOneClick:!0}},[T.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:a=>{const s=[(0,o.t)("state-timeline.category-state-timeline","State timeline")];a.addSliderInput({path:"lineWidth",name:(0,o.t)("state-timeline.name-line-width","Line width"),category:s,defaultValue:p.Q.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:(0,o.t)("state-timeline.name-fill-opacity","Fill opacity"),category:s,defaultValue:p.Q.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:(0,o.t)("state-timeline.name-connect-null-values","Connect null values"),category:s,defaultValue:!1,editor:I.e,override:I.e,shouldApply:e=>e.type!==F.PU.time,process:H.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:(0,o.t)("state-timeline.name-disconnect-values","Disconnect values"),category:s,defaultValue:!1,editor:D.Z,override:D.Z,shouldApply:e=>e.type!==F.PU.time,process:H.hS,settings:{isTime:!0}}),X.e(a),L.Wq(a,e=>e===m.vM.Auto||e===m.vM.Hidden),L.T4(a)}}).setPanelOptions(a=>{const s=[(0,o.t)("state-timeline.category-state-timeline","State timeline")];a.addBooleanSwitch({path:"mergeValues",name:(0,o.t)("state-timeline.name-merge-equal-consecutive-values","Merge equal consecutive values"),category:s,defaultValue:p.K.mergeValues}).addRadio({path:"showValue",name:(0,o.t)("state-timeline.name-show-values","Show values"),category:s,settings:{options:[{value:m.yL.Auto,label:(0,o.t)("state-timeline.show-values-options.label-auto","Auto")},{value:m.yL.Always,label:(0,o.t)("state-timeline.show-values-options.label-always","Always")},{value:m.yL.Never,label:(0,o.t)("state-timeline.show-values-options.label-never","Never")}]},defaultValue:p.K.showValue}).addRadio({path:"alignValue",name:(0,o.t)("state-timeline.name-align-values","Align values"),category:s,settings:{options:[{value:"left",label:(0,o.t)("state-timeline.align-values-options.label-left","Left")},{value:"center",label:(0,o.t)("state-timeline.align-values-options.label-center","Center")},{value:"right",label:(0,o.t)("state-timeline.align-values-options.label-right","Right")}]},defaultValue:p.K.alignValue}).addSliderInput({path:"rowHeight",name:(0,o.t)("state-timeline.name-row-height","Row height"),category:s,settings:{min:0,max:1,step:.01},defaultValue:p.K.rowHeight}).addNumberInput({path:"perPage",name:(0,o.t)("state-timeline.name-page-size","Page size (enable pagination)"),category:s,settings:{min:1,step:1,integer:!0}}),w.H(a,!1),b.D(a)}).setSuggestionsSupplier(new dt).setDataSupport({annotations:!0})}}]);

//# sourceMappingURL=stateTimelinePanel.512b3263c429e03151ae.js.map