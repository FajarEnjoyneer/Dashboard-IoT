"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3525],{73163:(z,R,t)=>{t.d(R,{Xx:()=>V,ko:()=>s});var v=t(60519),D=t(32899),A=t(95004),B=t(63704),w=t(68143),K=t(43173),S=t(73427),o=t(86967),r=t(92367);const l=(f,b,e)=>(i,d,m)=>(b.variables&&e&&(i=i.replace(/\$\w+/g,c=>{const n=c.slice(1);return b.variables.some(x=>x.key===n)&&e[n]!=null?e[n]:c})),f(i,d,m)),s=(f,b,e,i,d,m)=>!d||d.length===0?[]:d.map(n=>{const x=(0,v.vd)(f,b,e),T={...e,__dataContext:x},p=(P,I,y)=>i(P,{...T,...I},y);return m.valueRowIndex!==void 0&&!isNaN(m.valueRowIndex)?x.value.rowIndex=m.valueRowIndex:x.value.calculatedValue=m.calculatedValue,{title:i(n.title,T),confirmation:P=>l(p,n,P)(n.confirmation||`Are you sure you want to ${n.title}?`),onClick:(P,I,y)=>{let U=W(n,l(p,n,y));try{(0,w.AI)().fetch(U).subscribe({error:F=>{S.lE.emit(D.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(F)},complete:()=>{S.lE.emit(D.r1.alertSuccess,["API call was successful"])}})}catch(F){S.lE.emit(D.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(F);return}},oneClick:n.oneClick??!1,style:{backgroundColor:n.style?.backgroundColor??K.$.theme2.colors.secondary.main},variables:n.variables}}).filter(n=>!!n),W=(f,b)=>{const e=new URL(N(b(f.fetch.url))),i={};let d={url:e.toString(),method:f.fetch.method,data:G(f,b),headers:i};return f.fetch.headers&&f.fetch.headers.forEach(([m,c])=>{i[b(m)]=b(c)}),f.fetch.queryParams&&(f.fetch.queryParams?.forEach(([m,c])=>{e.searchParams.append(b(m),b(c))}),d.url=e.toString()),i["X-Grafana-Action"]="1",d.headers=i,d},V=(f=[],b=[])=>({name:"Default field",type:A.PU.string,config:{links:f,actions:b},values:[]}),N=f=>{if(f.startsWith("/")){const e=B.sQ.sanitizeUrl(f);f=(0,r.z)(e,[])}return f},G=(f,b)=>{let e=f.fetch.body?b(f.fetch.body):"{}";return f.fetch.method===o.DO.GET&&(e=void 0),e}},86967:(z,R,t)=>{t.d(R,{DO:()=>B,en:()=>v,gR:()=>D,xp:()=>A});var v=(r=>(r.Center="center",r.Left="left",r.LeftRight="leftright",r.Right="right",r.Scale="scale",r))(v||{}),D=(r=>(r.Bottom="bottom",r.Center="center",r.Scale="scale",r.Top="top",r.TopBottom="topbottom",r))(D||{}),A=(r=>(r.Contain="contain",r.Cover="cover",r.Fill="fill",r.Original="original",r.Tile="tile",r))(A||{}),B=(r=>(r.GET="GET",r.POST="POST",r.PUT="PUT",r))(B||{}),w=(r=>(r.Straight="straight",r))(w||{});const K={vertices:[]},S={connections:[]},o={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},25205:(z,R,t)=>{t.d(R,{L:()=>N});var v=t(74848),D=t(22803),A=t(84229),B=t(16515),w=t(57866),K=t(14477),S=t(43173),o=t(63142),r=t(64400),l=t(24343),s=t(18857),W=t(73163),V=t(32776);function N(c){const{data:n,height:x,width:T,options:p,fieldConfig:j,id:P,timeRange:I,replaceVariables:y}=c,U=(0,o.$j)(),F=(0,r.d2)(),$=(0,V.gy)(n.series)?(0,V.S5)(n.series):n.series,J=$?.length,ee=$.some(O=>O.fields.length>0),Y=G($,p),te=$[Y];let k=x;if(!J||!ee)return(0,v.jsx)(K.a,{panelId:P,fieldConfig:j,data:n});if(J>1){const O=U.spacing.gridSize*U.components.height.md,X=U.spacing.gridSize;k=x-O-X}const ae=F.sync&&F.sync()!==A.y.Off,_=(0,v.jsx)(l.X,{height:k,width:T,data:te,noHeader:!p.showHeader,showTypeIcons:p.showTypeIcons,resizable:!0,initialSortBy:p.sortBy,onSortByChange:O=>b(O,c),onColumnResize:(O,X)=>f(O,X,c),onCellFilterAdded:F.onAddAdHocFilter,footerOptions:p.footer,enablePagination:p.footer?.enablePagination,cellHeight:p.cellHeight,timeRange:I,enableSharedCrosshair:S.$.featureToggles.tableSharedCrosshair&&ae,fieldConfig:j,getActions:d,replaceVariables:y});if(J===1)return _;const Q=$.map((O,X)=>({label:(0,B.Ri)(O),value:X}));return(0,v.jsxs)("div",{className:m.wrapper,children:[_,(0,v.jsx)("div",{className:m.selectWrapper,children:(0,v.jsx)(s.l6,{options:Q,value:Q[Y],onChange:O=>e(O,c)})})]})}function G(c,n){return n.frameIndex>0&&n.frameIndex<c.length?n.frameIndex:0}function f(c,n,x){const{fieldConfig:T}=x,{overrides:p}=T,j=w.Ct.byName,P="custom.width",I=p.find(y=>y.matcher.id===j&&y.matcher.options===c);if(I){const y=I.properties.find(U=>U.id===P);y?y.value=n:I.properties.push({id:P,value:n})}else p.push({matcher:{id:j,options:c},properties:[{id:P,value:n}]});x.onFieldConfigChange({...T,overrides:p})}function b(c,n){n.onOptionsChange({...n.options,sortBy:c})}function e(c,n){n.onOptionsChange({...n.options,frameIndex:c.value||0})}const i=c=>c,d=(c,n,x,T)=>{const p=[],j=new Set;return(0,W.ko)(c,n,n.state.scopedVars,T??i,n.config.actions??[],{valueRowIndex:x}).forEach(I=>{const y=`${I.title}`;j.has(y)||(p.push(I),j.add(y))}),p},m={wrapper:(0,D.css)({display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}),selectWrapper:(0,D.css)({padding:"8px 8px 0px 8px"})}},32776:(z,R,t)=>{t.d(R,{S5:()=>f,fq:()=>K,gy:()=>b,l1:()=>N});var v=t(2543),D=t.n(v),A=t(57866),B=t(33553),w=t(95004);const K=e=>(!e.pluginVersion&&"columns"in e&&console.log("Was angular table",e),e.options),S={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},o={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},r={cell:"color-background",row:"color-background",value:"color-text"},l=(e,i)=>[-1/0,...e].map((d,m)=>({color:i[m],value:(0,v.isNumber)(d)?d:parseInt(d,10)})),s=(e,i)=>{const d=e.transformations??[];if(Object.keys(S).includes(i.transform)){const m={reducers:[]};i.transform==="timeseries_aggregations"&&(m.includeTimeField=!1,m.reducers=i.columns.map(c=>o[c.value])),d.push({id:S[i.transform],options:m})}return d},W=e=>{const d={matcher:{id:/^\/.*\/$/.test(e.pattern)?A.Ct.byRegexp:A.Ct.byName,options:e.pattern},properties:[]};return e.alias&&d.properties.push({id:"displayName",value:e.alias}),e.unit&&d.properties.push({id:"unit",value:e.unit}),e.decimals&&d.properties.push({id:"decimals",value:e.decimals}),e.type==="date"&&d.properties.push({id:"unit",value:`time: ${e.dateFormat}`}),e.type==="hidden"&&d.properties.push({id:"custom.hidden",value:!0}),e.link&&d.properties.push({id:"links",value:[{title:(0,v.defaultTo)(e.linkTooltip,""),url:(0,v.defaultTo)(e.linkUrl,""),targetBlank:(0,v.defaultTo)(e.linkTargetBlank,!1)}]}),e.colorMode&&d.properties.push({id:"custom.cellOptions",value:{type:r[e.colorMode]}}),e.align&&d.properties.push({id:"custom.align",value:e.align==="auto"?null:e.align}),e.thresholds?.length&&d.properties.push({id:"thresholds",value:{mode:B.O.Absolute,steps:l(e.thresholds,e.colors)}}),d},V=e=>{let i={custom:{}};if(e){if(i=(0,v.omitBy)({unit:e.unit,decimals:e.decimals,displayName:e.alias,custom:{align:e.align==="auto"?null:e.align}},v.isNil),e.thresholds.length){const d={mode:B.O.Absolute,steps:l(e.thresholds,e.colors)};i.thresholds=d}e.colorMode&&(i.custom.cellOptions={type:r[e.colorMode]})}return i},N=(e,i,d)=>{if(i==="table-old"&&d.angular){const m=d.angular,c=s(e,m),n=m.styles.find(p=>p.pattern==="/.*/"),x=V(n),T=m.styles.filter(p=>p.pattern!=="/.*/").map(W);e.transformations=c,e.fieldConfig={defaults:x,overrides:T}}return{}},G=e=>e?.filter(i=>i.meta?.custom?.parentRowIndex===void 0)||[e?.[0]],f=e=>{const i=[];return G(e).filter(m=>!!m&&m.length!==0)?.forEach(m=>{const c=e?.filter(p=>m.refId===p.refId&&p.meta?.custom?.parentRowIndex!==void 0),n=(0,v.groupBy)(c,p=>p.meta?.custom?.parentRowIndex),x=Object.keys(n).map(p=>n[p]),T={...m};c&&c.length>0&&T.fields.push({name:"nested",type:w.PU.nestedFrames,config:{},values:x}),i.push(T)}),i},b=e=>e?.some(i=>i.meta?.custom?.parentRowIndex!==void 0)},45730:(z,R,t)=>{t.r(R),t.d(R,{plugin:()=>ie});var v=t(16207),D=t(83340),A=t(38809),B=t(53543),w=t(46644),K=t(95004),S=t(16515),o=t(92745),r=t(31114),l=t(739),s=t(74848),W=t(21285);function V({onChange:a,value:u,context:g}){const h=E=>{E?.currentTarget.checked&&(g.options.footer.show=!1),a(E?.currentTarget.checked)};return(0,s.jsx)(W.d,{value:!!u,onChange:h})}var N=t(22803),G=t(2543),f=t(96540),b=t(63142),e=t(37386),i=t(18857);const d=({cellOptions:a,onChange:u})=>{const g=()=>{a.wrapText=!a.wrapText,u(a)};return(0,s.jsx)(e.D,{label:(0,o.t)("table.auto-cell-options-editor.label-wrap-text","Wrap text"),description:(0,o.t)("table.auto-cell-options-editor.description-wrap-text","If selected text will be wrapped to the width of text in the configured column"),children:(0,s.jsx)(W.d,{value:a.wrapText,onChange:g})})};var m=t(41654),c=t(77824);function n({cellOptions:a,onChange:u}){const g=E=>{a.mode=E,u(a)},h=E=>{a.valueDisplayMode=E,u(a)};return(0,s.jsxs)(m.B,{direction:"column",gap:0,children:[(0,s.jsx)(e.D,{label:(0,o.t)("table.bar-gauge-cell-options-editor.label-gauge-display-mode","Gauge display mode"),children:(0,s.jsx)(c.z,{value:a?.mode??l.eX.Gradient,onChange:g,options:x})}),(0,s.jsx)(e.D,{label:(0,o.t)("table.bar-gauge-cell-options-editor.label-value-display","Value display"),children:(0,s.jsx)(c.z,{value:a?.valueDisplayMode??l.$l.Text,onChange:h,options:T})})]})}const x=[{value:l.eX.Basic,label:"Basic"},{value:l.eX.Gradient,label:"Gradient"},{value:l.eX.Lcd,label:"Retro LCD"}],T=[{value:l.$l.Color,label:"Value color"},{value:l.$l.Text,label:"Text color"},{value:l.$l.Hidden,label:"Hidden"}];var p=t(72636),j=t(99887);const P=[{value:l.Wq.Basic,label:"Basic"},{value:l.Wq.Gradient,label:"Gradient"}],I=({cellOptions:a,onChange:u})=>{const g=C=>{a.mode=C,u(a)},h=()=>{a.applyToRow=!a.applyToRow,u(a)},E=()=>{a.wrapText=!a.wrapText,u(a)},M=(0,s.jsxs)(p.J,{description:(0,o.t)("table.color-background-cell-options-editor.description-wrap-text","If selected text will be wrapped to the width of text in the configured column"),children:[(0,s.jsx)(o.x6,{i18nKey:"table.color-background-cell-options-editor.wrap-text",children:"Wrap text"})," ",(0,s.jsx)(j.E,{text:(0,o.t)("table.color-background-cell-options-editor.label.text-alpha","Alpha"),color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.D,{label:(0,o.t)("table.color-background-cell-options-editor.label-background-display-mode","Background display mode"),children:(0,s.jsx)(c.z,{value:a?.mode??l.Wq.Gradient,onChange:g,options:P})}),(0,s.jsx)(e.D,{label:(0,o.t)("table.color-background-cell-options-editor.label-apply-to-entire-row","Apply to entire row"),description:(0,o.t)("table.color-background-cell-options-editor.description-apply-to-entire-row","If selected the entire row will be colored as this cell would be."),children:(0,s.jsx)(W.d,{value:a.applyToRow,onChange:h})}),(0,s.jsx)(e.D,{label:M,children:(0,s.jsx)(W.d,{value:a.wrapText,onChange:E})})]})};var y=t(63527);const U=({cellOptions:a,onChange:u})=>{const g=E=>{a.alt=E.currentTarget.value,u(a)},h=E=>{a.title=E.currentTarget.value,u(a)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.D,{label:(0,o.t)("table.image-cell-options-editor.label-alt-text","Alt text"),description:(0,o.t)("table.image-cell-options-editor.description-alt-text","Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader"),children:(0,s.jsx)(y.p,{onChange:g,defaultValue:a.alt})}),(0,s.jsx)(e.D,{label:(0,o.t)("table.image-cell-options-editor.label-title-text","Title text"),description:(0,o.t)("table.image-cell-options-editor.description-title-text","Text that will be displayed when the image is hovered by a cursor"),children:(0,s.jsx)(y.p,{onChange:h,defaultValue:a.title})})]})};var F=t(37297),$=t(32881),J=t(93948),ee=t(12241);const Y=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function te(a){const u=(0,ee.V)(a);return{...u,useCustomConfig:g=>{u.useCustomConfig?.(g),g.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const k=a=>{const{cellOptions:u,onChange:g}=a,h=(0,f.useMemo)(()=>{const C=te(J.t);return(0,F.O)(C,"ChartCell")},[]),E=(0,b.of)(_),M={...J.t,...u};return(0,s.jsx)($.gW,{children:h.list(Y.map(C=>`custom.${C}`)).map(C=>{if(C.showIf&&!C.showIf(M))return null;const Z=C.editor,L=C.path;return(0,s.jsx)(e.D,{label:C.name,className:E.field,children:(0,s.jsx)(Z,{onChange:H=>g({...u,[L]:H}),value:(ae(L,M)?M[L]:void 0)??C.defaultValue,item:C,context:{data:[]}})},C.id)})})};function ae(a,u){return a in u}const _=()=>({field:(0,N.css)({width:"100%","[title='Use color scheme to define gradient']":{display:"none"}})}),Q=({value:a,onChange:u})=>{const g=a.type,h=(0,b.of)(X),E=O.find(H=>H.value.type===g);let[M,C]=(0,f.useState)({});const Z=H=>{H.value!==void 0&&(a=H.value,M[a.type]!==void 0&&Object.keys(M[a.type]).length>1&&(a=(0,G.merge)({},a,M[a.type])),u(a))},L=H=>{M[a.type]=(0,G.merge)({},a,H),C(M),u(M[a.type])};return(0,s.jsxs)("div",{className:h.fixBottomMargin,children:[(0,s.jsx)(e.D,{children:(0,s.jsx)(i.l6,{options:O,value:E,onChange:Z})}),(g===l.ob.Auto||g===l.ob.ColorText)&&(0,s.jsx)(d,{cellOptions:a,onChange:L}),g===l.ob.Gauge&&(0,s.jsx)(n,{cellOptions:a,onChange:L}),g===l.ob.ColorBackground&&(0,s.jsx)(I,{cellOptions:a,onChange:L}),g===l.ob.Sparkline&&(0,s.jsx)(k,{cellOptions:a,onChange:L}),g===l.ob.Image&&(0,s.jsx)(U,{cellOptions:a,onChange:L})]})};let O=[{value:{type:l.ob.Auto},label:"Auto"},{value:{type:l.ob.Sparkline},label:"Sparkline"},{value:{type:l.ob.ColorText},label:"Colored text"},{value:{type:l.ob.ColorBackground},label:"Colored background"},{value:{type:l.ob.Gauge},label:"Gauge"},{value:{type:l.ob.DataLinks},label:"Data links"},{value:{type:l.ob.JSONView},label:"JSON View"},{value:{type:l.ob.Image},label:"Image"},{value:{type:l.ob.Actions},label:"Actions"}];const X=a=>({fixBottomMargin:(0,N.css)({marginBottom:a.spacing(-2)})});var ne=t(25205),oe=t(32776);const q={cellHeight:l.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var le=t(8612),se=t(73495);class re{getSuggestionsForData(u){const g=u.getListAppender({name:se.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:h=>{h.fieldConfig.defaults.custom.minWidth=50}}});u.dataSummary.fieldCount===0?g.append({cardOptions:{imgSrc:le}}):g.append({})}}const ie=new v.m(ne.L).setPanelChangeHandler(oe.l1).setMigrationHandler(oe.fq).useFieldConfig({standardOptions:{[D.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:a=>{const u=[(0,o.t)("table.category-table","Table")],g=[(0,o.t)("table.category-cell-options","Cell options")];a.addNumberInput({path:"minWidth",name:(0,o.t)("table.name-min-column-width","Minimum column width"),category:u,description:(0,o.t)("table.description-min-column-width","The minimum width for column auto resizing"),settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:r.gB.minWidth}).addNumberInput({path:"width",name:(0,o.t)("table.name-column-width","Column width"),category:u,settings:{placeholder:(0,o.t)("table.placeholder-column-width","auto"),min:20},shouldApply:()=>!0,defaultValue:r.gB.width}).addRadio({path:"align",name:(0,o.t)("table.name-column-alignment","Column alignment"),category:u,settings:{options:[{label:(0,o.t)("table.column-alignment-options.label-auto","Auto"),value:"auto"},{label:(0,o.t)("table.column-alignment-options.label-left","Left"),value:"left"},{label:(0,o.t)("table.column-alignment-options.label-center","Center"),value:"center"},{label:(0,o.t)("table.column-alignment-options.label-right","Right"),value:"right"}]},defaultValue:r.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:(0,o.t)("table.name-cell-type","Cell type"),editor:Q,override:Q,defaultValue:r.gB.cellOptions,process:A.hS,category:g,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:(0,o.t)("table.name-cell-value-inspect","Cell value inspect"),description:(0,o.t)("table.description-cell-value-inspect","Enable cell value inspection in a modal window"),defaultValue:!1,category:g,showIf:h=>h.cellOptions.type===l.ob.Auto||h.cellOptions.type===l.ob.JSONView||h.cellOptions.type===l.ob.ColorText||h.cellOptions.type===l.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:(0,o.t)("table.name-column-filter","Column filter"),category:u,description:(0,o.t)("table.description-column-filter","Enables/disables field filters in table"),defaultValue:r.gB.filterable}).addBooleanSwitch({path:"hidden",name:(0,o.t)("table.name-hide-in-table","Hide in table"),category:u,defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(a=>{const u=[(0,o.t)("table.category-table","Table")],g=[(0,o.t)("table.category-table-footer","Table footer")];a.addBooleanSwitch({path:"showHeader",name:(0,o.t)("table.name-show-table-header","Show table header"),category:u,defaultValue:q.showHeader}).addRadio({path:"cellHeight",name:(0,o.t)("table.name-cell-height","Cell height"),category:u,defaultValue:q.cellHeight,settings:{options:[{value:l.qM.Sm,label:(0,o.t)("table.cell-height-options.label-small","Small")},{value:l.qM.Md,label:(0,o.t)("table.cell-height-options.label-medium","Medium")},{value:l.qM.Lg,label:(0,o.t)("table.cell-height-options.label-large","Large")}]}}).addBooleanSwitch({path:"footer.show",category:g,name:(0,o.t)("table.name-show-table-footer","Show table footer"),defaultValue:q.footer?.show}).addCustomEditor({id:"footer.reducer",category:g,path:"footer.reducer",name:(0,o.t)("table.name-calculation","Calculation"),description:(0,o.t)("table.description-calculation","Choose a reducer function / calculation"),editor:B.D.get("stats-picker").editor,defaultValue:[w.gy.sum],showIf:h=>h.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:g,name:(0,o.t)("table.name-count-rows","Count rows"),description:(0,o.t)("table.description-count-rows","Display a single count for all data rows"),defaultValue:q.footer?.countRows,showIf:h=>h.footer?.reducer?.length===1&&h.footer?.reducer[0]===w.gy.count}).addMultiSelect({path:"footer.fields",category:g,name:(0,o.t)("table.name-fields","Fields"),description:(0,o.t)("table.description-fields","Select the fields that should be calculated"),settings:{allowCustomValue:!1,options:[],placeholder:(0,o.t)("table.placeholder-fields","All Numeric Fields"),getOptions:async h=>{const E=[];if(h&&h.data&&h.data.length>0){const M=h.data[0];for(const C of M.fields)if(C.type===K.PU.number){const Z=(0,S.Ct)(C,M,h.data),L=C.name;E.push({value:L,label:Z})}}return E}},defaultValue:"",showIf:h=>h.footer?.show&&!(h.footer?.countRows&&h.footer?.reducer.includes(w.gy.count))}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:(0,o.t)("table.name-enable-paginations","Enable pagination"),category:u,editor:V})}).setSuggestionsSupplier(new re)},8612:(z,R,t)=>{z.exports=t.p+"static/img/icn-table-panel.3ee1d0cc.svg"}}]);

//# sourceMappingURL=tablePanel.e8ce89a3c2746b62026f.js.map