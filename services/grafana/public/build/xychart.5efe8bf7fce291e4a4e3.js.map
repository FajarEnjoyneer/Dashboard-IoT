{"version":3,"file":"xychart.5efe8bf7fce291e4a4e3.js","mappings":"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","sources":["webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipContent.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipHeader.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipColorIndicator.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipRow.tsx","webpack://grafana/./public/app/core/components/Layers/LayerName.tsx","webpack://grafana/./public/app/features/actions/utils.ts","webpack://grafana/./public/app/plugins/panel/canvas/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/status-history/utils.ts","webpack://grafana/./public/app/plugins/panel/xychart/SeriesEditor.tsx","webpack://grafana/./public/app/plugins/panel/xychart/XYChartTooltip.tsx","webpack://grafana/./public/app/plugins/panel/xychart/scatter.ts","webpack://grafana/./public/app/plugins/panel/xychart/XYChartPanel.tsx","webpack://grafana/./public/app/plugins/panel/xychart/config.ts","webpack://grafana/./public/app/plugins/panel/xychart/panelcfgold.gen.ts","webpack://grafana/./public/app/plugins/panel/xychart/migrations.ts","webpack://grafana/./public/app/plugins/panel/xychart/module.tsx","webpack://grafana/./public/app/plugins/panel/xychart/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/xychart/utils.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport { CSSProperties, ReactNode } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface VizTooltipContentProps {\n  items: VizTooltipItem[];\n  children?: ReactNode;\n  scrollable?: boolean;\n  isPinned: boolean;\n  maxHeight?: number;\n}\n\nexport const VizTooltipContent = ({\n  items,\n  children,\n  isPinned,\n  scrollable = false,\n  maxHeight,\n}: VizTooltipContentProps) => {\n  const styles = useStyles2(getStyles);\n\n  const scrollableStyle: CSSProperties = scrollable\n    ? {\n        maxHeight: maxHeight,\n        overflowY: 'auto',\n      }\n    : {};\n\n  return (\n    <div className={styles.wrapper} style={scrollableStyle}>\n      {items.map(({ label, value, color, colorIndicator, colorPlacement, isActive, lineStyle }, i) => (\n        <VizTooltipRow\n          key={i}\n          label={label}\n          value={value}\n          color={color}\n          colorIndicator={colorIndicator}\n          colorPlacement={colorPlacement}\n          isActive={isActive}\n          justify={'space-between'}\n          isPinned={isPinned}\n          lineStyle={lineStyle}\n          showValueScroll={!scrollable}\n        />\n      ))}\n      {children}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    gap: 2,\n    borderTop: `1px solid ${theme.colors.border.weak}`,\n    padding: theme.spacing(1),\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface Props {\n  item: VizTooltipItem;\n  isPinned: boolean;\n}\nexport const VizTooltipHeader = ({ item, isPinned }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const { label, value, color, colorIndicator } = item;\n\n  return (\n    <div className={styles.wrapper}>\n      <VizTooltipRow\n        label={label}\n        value={value}\n        color={color}\n        colorIndicator={colorIndicator}\n        marginRight={'22px'}\n        isPinned={isPinned}\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: theme.spacing(1),\n    lineHeight: 1,\n  }),\n});\n","import { css, cx } from '@emotion/css';\n\nimport { FALLBACK_COLOR, GrafanaTheme2 } from '@grafana/data';\nimport { LineStyle } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { SeriesIcon } from '../VizLegend/SeriesIcon';\n\nimport { ColorIndicator, DEFAULT_COLOR_INDICATOR } from './types';\nimport { getColorIndicatorClass } from './utils';\n\nexport enum ColorIndicatorPosition {\n  Leading,\n  Trailing,\n}\n\ninterface Props {\n  color?: string;\n  colorIndicator?: ColorIndicator;\n  position?: ColorIndicatorPosition;\n  lineStyle?: LineStyle;\n}\n\nexport type ColorIndicatorStyles = ReturnType<typeof getStyles>;\n\nexport const VizTooltipColorIndicator = ({\n  color = FALLBACK_COLOR,\n  colorIndicator = DEFAULT_COLOR_INDICATOR,\n  position = ColorIndicatorPosition.Leading,\n  lineStyle,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  if (colorIndicator === ColorIndicator.series) {\n    return (\n      <SeriesIcon\n        color={color}\n        lineStyle={lineStyle}\n        className={position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing}\n      />\n    );\n  }\n\n  return (\n    <span\n      style={{ backgroundColor: color }}\n      className={cx(\n        position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n        getColorIndicatorClass(colorIndicator, styles)\n      )}\n    />\n  );\n};\n\n// @TODO Update classes/add svgs\nconst getStyles = (theme: GrafanaTheme2) => ({\n  leading: css({\n    marginRight: theme.spacing(0.5),\n  }),\n  trailing: css({\n    marginLeft: theme.spacing(0.5),\n  }),\n  value: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.default,\n    fontWeight: 500,\n    minWidth: '12px',\n  }),\n  hexagon: css({}),\n  pie_1_4: css({}),\n  pie_2_4: css({}),\n  pie_3_4: css({}),\n  marker_sm: css({\n    width: '4px',\n    height: '4px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '4px',\n  }),\n  marker_md: css({\n    width: '8px',\n    height: '8px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '8px',\n  }),\n  marker_lg: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '12px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { CSSProperties, ReactNode, useEffect, useRef, useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { InlineToast } from '../InlineToast/InlineToast';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { ColorIndicatorPosition, VizTooltipColorIndicator } from './VizTooltipColorIndicator';\nimport { ColorPlacement, VizTooltipItem } from './types';\n\ninterface VizTooltipRowProps extends Omit<VizTooltipItem, 'value'> {\n  value: string | number | null | ReactNode;\n  justify?: string;\n  isActive?: boolean; // for series list\n  marginRight?: string;\n  isPinned: boolean;\n  showValueScroll?: boolean;\n}\n\nenum LabelValueTypes {\n  label = 'label',\n  value = 'value',\n}\n\nconst SUCCESSFULLY_COPIED_TEXT = 'Copied to clipboard';\nconst SHOW_SUCCESS_DURATION = 2 * 1000;\nconst HORIZONTAL_PX_PER_CHAR = 7;\n\nexport const VizTooltipRow = ({\n  label,\n  value,\n  color,\n  colorIndicator,\n  colorPlacement = ColorPlacement.first,\n  justify = 'flex-start',\n  isActive = false,\n  marginRight = '0px',\n  isPinned,\n  lineStyle,\n  showValueScroll,\n}: VizTooltipRowProps) => {\n  const styles = useStyles2(getStyles, justify, marginRight);\n\n  const innerValueScrollStyle: CSSProperties = showValueScroll\n    ? {\n        maxHeight: 55,\n        whiteSpace: 'wrap',\n        wordBreak: 'break-word',\n        overflowY: 'auto',\n      }\n    : {\n        whiteSpace: 'pre-line',\n        wordBreak: 'break-word',\n        lineHeight: 1.2,\n      };\n\n  const [showLabelTooltip, setShowLabelTooltip] = useState(false);\n\n  const [copiedText, setCopiedText] = useState<Record<string, string> | null>(null);\n  const [showCopySuccess, setShowCopySuccess] = useState(false);\n\n  const labelRef = useRef<null | HTMLDivElement>(null);\n  const valueRef = useRef<null | HTMLDivElement>(null);\n\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (showCopySuccess) {\n      timeoutId = setTimeout(() => {\n        setShowCopySuccess(false);\n      }, SHOW_SUCCESS_DURATION);\n    }\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [showCopySuccess]);\n\n  const copyToClipboard = async (text: string, type: LabelValueTypes) => {\n    if (!(navigator?.clipboard && window.isSecureContext)) {\n      fallbackCopyToClipboard(text, type);\n      return;\n    }\n\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedText({ [`${type}`]: text });\n      setShowCopySuccess(true);\n    } catch (error) {\n      setCopiedText(null);\n    }\n  };\n\n  const fallbackCopyToClipboard = (text: string, type: LabelValueTypes) => {\n    // Use a fallback method for browsers/contexts that don't support the Clipboard API.\n    const textarea = document.createElement('textarea');\n    labelRef.current?.appendChild(textarea);\n    textarea.value = text;\n    textarea.focus();\n    textarea.select();\n    try {\n      const successful = document.execCommand('copy');\n      if (successful) {\n        setCopiedText({ [`${type}`]: text });\n        setShowCopySuccess(true);\n      }\n    } catch (err) {\n      console.error('Unable to copy to clipboard', err);\n    }\n\n    textarea.remove();\n  };\n\n  const onMouseEnterLabel = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.offsetWidth < event.currentTarget.scrollWidth) {\n      setShowLabelTooltip(true);\n    }\n  };\n\n  const onMouseLeaveLabel = () => setShowLabelTooltip(false);\n\n  // if label is > 50% window width, try to put label/value pairs on new lines\n  if (label.length * HORIZONTAL_PX_PER_CHAR > window.innerWidth / 2) {\n    label = label.replaceAll('{', '{\\n  ').replaceAll('}', '\\n}').replaceAll(', ', ',\\n  ');\n  }\n\n  return (\n    <div className={styles.contentWrapper}>\n      {(color || label) && (\n        <div className={styles.valueWrapper}>\n          {color && colorPlacement === ColorPlacement.first && (\n            <VizTooltipColorIndicator color={color} colorIndicator={colorIndicator} lineStyle={lineStyle} />\n          )}\n          {!isPinned ? (\n            <div className={cx(styles.label, isActive && styles.activeSeries)}>{label}</div>\n          ) : (\n            <>\n              <Tooltip content={label} interactive={false} show={showLabelTooltip}>\n                <>\n                  {showCopySuccess && copiedText?.label && (\n                    <InlineToast placement=\"top\" referenceElement={labelRef.current}>\n                      {SUCCESSFULLY_COPIED_TEXT}\n                    </InlineToast>\n                  )}\n                  {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n                  <div\n                    className={cx(styles.label, isActive && styles.activeSeries, navigator?.clipboard && styles.copy)}\n                    onMouseEnter={onMouseEnterLabel}\n                    onMouseLeave={onMouseLeaveLabel}\n                    onClick={() => copyToClipboard(label, LabelValueTypes.label)}\n                    ref={labelRef}\n                  >\n                    {label}\n                  </div>\n                </>\n              </Tooltip>\n            </>\n          )}\n        </div>\n      )}\n\n      <div className={styles.valueWrapper}>\n        {color && colorPlacement === ColorPlacement.leading && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Leading}\n            lineStyle={lineStyle}\n          />\n        )}\n\n        {!isPinned ? (\n          <div className={cx(styles.value, isActive)} style={innerValueScrollStyle}>\n            {value}\n          </div>\n        ) : (\n          <>\n            {showCopySuccess && copiedText?.value && (\n              <InlineToast placement=\"top\" referenceElement={valueRef.current}>\n                {SUCCESSFULLY_COPIED_TEXT}\n              </InlineToast>\n            )}\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n            <div\n              className={cx(styles.value, isActive, navigator?.clipboard && styles.copy)}\n              style={innerValueScrollStyle}\n              onClick={() => copyToClipboard(value ? value.toString() : '', LabelValueTypes.value)}\n              ref={valueRef}\n            >\n              {value}\n            </div>\n          </>\n        )}\n\n        {color && colorPlacement === ColorPlacement.trailing && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Trailing}\n            lineStyle={lineStyle}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, justify: string, marginRight: string) => ({\n  contentWrapper: css({\n    display: 'flex',\n    alignItems: 'start',\n    justifyContent: justify,\n    marginRight: marginRight,\n  }),\n  label: css({\n    color: theme.colors.text.secondary,\n    fontWeight: 400,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    marginRight: theme.spacing(2),\n  }),\n  value: css({\n    fontWeight: 500,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  }),\n  valueWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  activeSeries: css({\n    fontWeight: theme.typography.fontWeightBold,\n    color: theme.colors.text.maxContrast,\n  }),\n  copy: css({\n    cursor: 'pointer',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { Icon, Input, FieldValidationMessage, useStyles2 } from '@grafana/ui';\n\nexport interface LayerNameProps {\n  name: string;\n  onChange: (v: string) => void;\n  verifyLayerNameUniqueness?: (nameToCheck: string) => boolean;\n  overrideStyles?: boolean;\n}\n\nexport const LayerName = ({ name, onChange, verifyLayerNameUniqueness, overrideStyles }: LayerNameProps) => {\n  const styles = useStyles2(getStyles);\n\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n  const [validationError, setValidationError] = useState<string | null>(null);\n\n  const onEditLayer = (event: React.SyntheticEvent) => {\n    setIsEditing(true);\n  };\n\n  const onEndEditName = (newName: string) => {\n    setIsEditing(false);\n\n    if (validationError) {\n      setValidationError(null);\n      return;\n    }\n\n    if (name !== newName) {\n      onChange(newName);\n    }\n  };\n\n  const onInputChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    const newName = event.currentTarget.value.trim();\n\n    if (newName.length === 0) {\n      setValidationError('An empty layer name is not allowed');\n      return;\n    }\n\n    if (verifyLayerNameUniqueness && !verifyLayerNameUniqueness(newName) && newName !== name) {\n      setValidationError('Layer name already exists');\n      return;\n    }\n\n    if (validationError) {\n      setValidationError(null);\n    }\n  };\n\n  const onEditLayerBlur = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    onEndEditName(event.currentTarget.value.trim());\n  };\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter') {\n      onEndEditName(event.currentTarget.value);\n    }\n  };\n\n  const onFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    event.target.select();\n  };\n\n  return (\n    <>\n      <div className={styles.wrapper}>\n        {!isEditing && (\n          <button\n            className={styles.layerNameWrapper}\n            title={t('layers.layer-name.edit-layer-title', 'Edit layer name')}\n            onClick={onEditLayer}\n            data-testid=\"layer-name-div\"\n          >\n            <span className={overrideStyles ? '' : styles.layerName}>{name}</span>\n            <Icon name=\"pen\" className={styles.layerEditIcon} size=\"sm\" />\n          </button>\n        )}\n\n        {isEditing && (\n          <>\n            <Input\n              type=\"text\"\n              defaultValue={name}\n              onBlur={onEditLayerBlur}\n              autoFocus\n              onKeyDown={onKeyDown}\n              onFocus={onFocus}\n              invalid={validationError !== null}\n              onChange={onInputChange}\n              className={styles.layerNameInput}\n              data-testid=\"layer-name-input\"\n            />\n            {validationError && <FieldValidationMessage horizontal>{validationError}</FieldValidationMessage>}\n          </>\n        )}\n      </div>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    wrapper: css({\n      label: 'Wrapper',\n      display: 'flex',\n      alignItems: 'center',\n      marginLeft: theme.spacing(0.5),\n    }),\n    layerNameWrapper: css({\n      display: 'flex',\n      cursor: 'pointer',\n      border: '1px solid transparent',\n      borderRadius: theme.shape.radius.default,\n      alignItems: 'center',\n      padding: `0 0 0 ${theme.spacing(0.5)}`,\n      margin: 0,\n      background: 'transparent',\n\n      '&:hover': {\n        background: theme.colors.action.hover,\n        border: `1px dashed ${theme.colors.border.strong}`,\n      },\n\n      '&:focus': {\n        border: `2px solid ${theme.colors.primary.border}`,\n      },\n\n      '&:hover, &:focus': {\n        '.query-name-edit-icon': {\n          visibility: 'visible',\n        },\n      },\n    }),\n    layerName: css({\n      fontWeight: theme.typography.fontWeightMedium,\n      color: theme.colors.primary.text,\n      cursor: 'pointer',\n      overflow: 'hidden',\n      marginLeft: theme.spacing(0.5),\n    }),\n    layerEditIcon: cx(\n      css({\n        marginLeft: theme.spacing(2),\n        visibility: 'hidden',\n      }),\n      'query-name-edit-icon'\n    ),\n    layerNameInput: css({\n      maxWidth: '300px',\n      margin: '-4px 0',\n    }),\n  };\n};\n","import {\n  Action,\n  ActionModel,\n  ActionVariableInput,\n  AppEvents,\n  DataContextScopedVar,\n  DataFrame,\n  DataLink,\n  Field,\n  FieldType,\n  getFieldDataContextClone,\n  InterpolateFunction,\n  ScopedVars,\n  textUtil,\n  ValueLinkConfig,\n} from '@grafana/data';\nimport { BackendSrvRequest, config as grafanaConfig, getBackendSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\n\nimport { HttpRequestMethod } from '../../plugins/panel/canvas/panelcfg.gen';\nimport { createAbsoluteUrl, RelativeUrl } from '../alerting/unified/utils/url';\n\n/** @internal */\nexport const genReplaceActionVars = (\n  boundReplaceVariables: InterpolateFunction,\n  action: Action,\n  actionVars?: ActionVariableInput\n): InterpolateFunction => {\n  return (value, scopedVars, format) => {\n    if (action.variables && actionVars) {\n      value = value.replace(/\\$\\w+/g, (matched) => {\n        const name = matched.slice(1);\n\n        if (action.variables!.some((action) => action.key === name) && actionVars[name] != null) {\n          return actionVars[name];\n        }\n\n        return matched;\n      });\n    }\n\n    return boundReplaceVariables(value, scopedVars, format);\n  };\n};\n\n/** @internal */\nexport const getActions = (\n  frame: DataFrame,\n  field: Field,\n  fieldScopedVars: ScopedVars,\n  replaceVariables: InterpolateFunction,\n  actions: Action[],\n  config: ValueLinkConfig\n): Array<ActionModel<Field>> => {\n  if (!actions || actions.length === 0) {\n    return [];\n  }\n\n  const actionModels = actions.map((action: Action) => {\n    const dataContext: DataContextScopedVar = getFieldDataContextClone(frame, field, fieldScopedVars);\n    const actionScopedVars = {\n      ...fieldScopedVars,\n      __dataContext: dataContext,\n    };\n\n    const boundReplaceVariables: InterpolateFunction = (value, scopedVars, format) => {\n      return replaceVariables(value, { ...actionScopedVars, ...scopedVars }, format);\n    };\n\n    // We are not displaying reduction result\n    if (config.valueRowIndex !== undefined && !isNaN(config.valueRowIndex)) {\n      dataContext.value.rowIndex = config.valueRowIndex;\n    } else {\n      dataContext.value.calculatedValue = config.calculatedValue;\n    }\n\n    const actionModel: ActionModel<Field> = {\n      title: replaceVariables(action.title, actionScopedVars),\n      confirmation: (actionVars?: ActionVariableInput) =>\n        genReplaceActionVars(\n          boundReplaceVariables,\n          action,\n          actionVars\n        )(action.confirmation || `Are you sure you want to ${action.title}?`),\n      onClick: (evt: MouseEvent, origin: Field, actionVars?: ActionVariableInput) => {\n        let request = buildActionRequest(action, genReplaceActionVars(boundReplaceVariables, action, actionVars));\n\n        try {\n          getBackendSrv()\n            .fetch(request)\n            .subscribe({\n              error: (error) => {\n                appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n                console.error(error);\n              },\n              complete: () => {\n                appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n              },\n            });\n        } catch (error) {\n          appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n          console.error(error);\n          return;\n        }\n      },\n      oneClick: action.oneClick ?? false,\n      style: {\n        backgroundColor: action.style?.backgroundColor ?? grafanaConfig.theme2.colors.secondary.main,\n      },\n      variables: action.variables,\n    };\n\n    return actionModel;\n  });\n\n  return actionModels.filter((action): action is ActionModel => !!action);\n};\n\n/** @internal */\nexport const buildActionRequest = (action: Action, replaceVariables: InterpolateFunction) => {\n  const url = new URL(getUrl(replaceVariables(action.fetch.url)));\n\n  const requestHeaders: Record<string, string> = {};\n\n  let request: BackendSrvRequest = {\n    url: url.toString(),\n    method: action.fetch.method,\n    data: getData(action, replaceVariables),\n    headers: requestHeaders,\n  };\n\n  if (action.fetch.headers) {\n    action.fetch.headers.forEach(([name, value]) => {\n      requestHeaders[replaceVariables(name)] = replaceVariables(value);\n    });\n  }\n\n  if (action.fetch.queryParams) {\n    action.fetch.queryParams?.forEach(([name, value]) => {\n      url.searchParams.append(replaceVariables(name), replaceVariables(value));\n    });\n\n    request.url = url.toString();\n  }\n\n  requestHeaders['X-Grafana-Action'] = '1';\n  request.headers = requestHeaders;\n\n  return request;\n};\n\n/** @internal */\n// @TODO update return type\nexport const getActionsDefaultField = (dataLinks: DataLink[] = [], actions: Action[] = []) => {\n  return {\n    name: 'Default field',\n    type: FieldType.string,\n    config: { links: dataLinks, actions: actions },\n    values: [],\n  };\n};\n\n/** @internal */\nconst getUrl = (endpoint: string) => {\n  const isRelativeUrl = endpoint.startsWith('/');\n  if (isRelativeUrl) {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const sanitizedRelativeURL = textUtil.sanitizeUrl(endpoint) as RelativeUrl;\n    endpoint = createAbsoluteUrl(sanitizedRelativeURL, []);\n  }\n\n  return endpoint;\n};\n\n/** @internal */\nconst getData = (action: Action, replaceVariables: InterpolateFunction) => {\n  let data: string | undefined = action.fetch.body ? replaceVariables(action.fetch.body) : '{}';\n  if (action.fetch.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as ui from '@grafana/schema';\n\nexport enum HorizontalConstraint {\n  Center = 'center',\n  Left = 'left',\n  LeftRight = 'leftright',\n  Right = 'right',\n  Scale = 'scale',\n}\n\nexport enum VerticalConstraint {\n  Bottom = 'bottom',\n  Center = 'center',\n  Scale = 'scale',\n  Top = 'top',\n  TopBottom = 'topbottom',\n}\n\nexport interface Constraint {\n  horizontal?: HorizontalConstraint;\n  vertical?: VerticalConstraint;\n}\n\nexport interface Placement {\n  bottom?: number;\n  height?: number;\n  left?: number;\n  right?: number;\n  rotation?: number;\n  top?: number;\n  width?: number;\n}\n\nexport enum BackgroundImageSize {\n  Contain = 'contain',\n  Cover = 'cover',\n  Fill = 'fill',\n  Original = 'original',\n  Tile = 'tile',\n}\n\nexport interface BackgroundConfig {\n  color?: ui.ColorDimensionConfig;\n  image?: ui.ResourceDimensionConfig;\n  size?: BackgroundImageSize;\n}\n\nexport interface LineConfig {\n  color?: ui.ColorDimensionConfig;\n  radius?: number;\n  width?: number;\n}\n\nexport enum HttpRequestMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n}\n\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport interface CanvasConnection {\n  color?: ui.ColorDimensionConfig;\n  path: ConnectionPath;\n  size?: ui.ScaleDimensionConfig;\n  source: ConnectionCoordinates;\n  sourceOriginal?: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  targetOriginal?: ConnectionCoordinates;\n  vertices?: Array<ConnectionCoordinates>;\n}\n\nexport const defaultCanvasConnection: Partial<CanvasConnection> = {\n  vertices: [],\n};\n\nexport interface CanvasElementOptions {\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  /**\n   * TODO: figure out how to define this (element config(s))\n   */\n  config?: unknown;\n  connections?: Array<CanvasConnection>;\n  constraint?: Constraint;\n  name: string;\n  placement?: Placement;\n  type: string;\n}\n\nexport const defaultCanvasElementOptions: Partial<CanvasElementOptions> = {\n  connections: [],\n};\n\nexport interface Options {\n  /**\n   * Enable infinite pan\n   */\n  infinitePan: boolean;\n  /**\n   * Enable inline editing\n   */\n  inlineEditing: boolean;\n  /**\n   * Enable pan and zoom\n   */\n  panZoom: boolean;\n  /**\n   * The root element of canvas (frame), where all canvas elements are nested\n   * TODO: Figure out how to define a default value for this\n   */\n  root: {\n    /**\n     * Name of the root element\n     */\n    name: string;\n    /**\n     * Type of root element (frame)\n     */\n    type: 'frame';\n    /**\n     * The list of canvas elements attached to the root element\n     */\n    elements: Array<CanvasElementOptions>;\n  };\n  /**\n   * Show all available element types\n   */\n  showAdvancedTypes: boolean;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  infinitePan: true,\n  inlineEditing: true,\n  panZoom: true,\n  showAdvancedTypes: true,\n};\n","import { DataFrame, ActionModel, Field, InterpolateFunction, LinkModel } from '@grafana/data';\nimport { getActions } from 'app/features/actions/utils';\n\nexport const getDataLinks = (field: Field, rowIdx: number) => {\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((field.config.links?.length ?? 0) > 0 && field.getLinks != null) {\n    const v = field.values[rowIdx];\n    const disp = field.display ? field.display(v) : { text: `${v}`, numeric: +v };\n\n    const linkLookup = new Set<string>();\n\n    field.getLinks({ calculatedValue: disp, valueRowIndex: rowIdx }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  return links;\n};\n\nexport const getAllFrameActions = (dataFrame: DataFrame) => {};\n\nexport const getFieldActions = (\n  dataFrame: DataFrame,\n  field: Field,\n  replaceVars: InterpolateFunction,\n  rowIndex: number\n) => {\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const actionsModel = getActions(dataFrame, field, field.state!.scopedVars!, replaceVars, field.config.actions ?? [], {\n    valueRowIndex: rowIndex,\n  });\n\n  actionsModel.forEach((action) => {\n    const key = `${action.title}`;\n    if (!actionLookup.has(key)) {\n      actions.push(action);\n      actionLookup.add(key);\n    }\n  });\n\n  return actions;\n};\n","import { css, cx } from '@emotion/css';\nimport { Fragment, useState } from 'react';\nimport { usePrevious } from 'react-use';\n\nimport {\n  getFrameDisplayName,\n  StandardEditorProps,\n  // getFieldDisplayName,\n  FrameMatcherID,\n  FieldMatcherID,\n  FieldNamePickerBaseNameMode,\n  FieldType,\n  GrafanaTheme2,\n} from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, Field, IconButton, Select, useStyles2 } from '@grafana/ui';\nimport { FieldNamePicker } from '@grafana/ui/internal';\nimport { LayerName } from 'app/core/components/Layers/LayerName';\n\nimport { Options, SeriesMapping, XYSeriesConfig } from './panelcfg.gen';\n\nexport const SeriesEditor = ({\n  value: seriesCfg,\n  onChange,\n  context,\n}: StandardEditorProps<XYSeriesConfig[], unknown, Options>) => {\n  const style = useStyles2(getStyles);\n\n  // reset opts when mapping changes (no way to do this in panel opts builder?)\n  const mapping = context.options?.mapping;\n  const prevMapping = usePrevious(mapping);\n  const mappingChanged = prevMapping != null && mapping !== prevMapping;\n\n  const defaultFrame = { frame: { matcher: { id: FrameMatcherID.byIndex, options: 0 } } };\n  const [selectedIdx, setSelectedIdx] = useState(0);\n\n  if (mappingChanged || seriesCfg == null) {\n    seriesCfg = [{ ...defaultFrame }];\n    onChange([...seriesCfg]);\n\n    if (selectedIdx > 0) {\n      setSelectedIdx(0);\n    }\n  }\n\n  const addSeries = () => {\n    seriesCfg = seriesCfg.concat({ ...defaultFrame });\n    setSelectedIdx(seriesCfg.length - 1);\n    onChange([...seriesCfg]);\n  };\n\n  const deleteSeries = (index: number) => {\n    seriesCfg = seriesCfg.filter((s, i) => i !== index);\n    setSelectedIdx(0);\n    onChange([...seriesCfg]);\n  };\n\n  const series = seriesCfg[selectedIdx];\n  const formKey = `${mapping}${selectedIdx}`;\n\n  const baseNameMode =\n    mapping === SeriesMapping.Manual\n      ? FieldNamePickerBaseNameMode.ExcludeBaseNames\n      : context.data.length === 1\n        ? FieldNamePickerBaseNameMode.IncludeAll\n        : FieldNamePickerBaseNameMode.OnlyBaseNames;\n\n  context.data.forEach((frame, frameIndex) => {\n    frame.fields.forEach((field, fieldIndex) => {\n      field.state = {\n        ...field.state,\n        origin: {\n          frameIndex,\n          fieldIndex,\n        },\n      };\n    });\n  });\n\n  return (\n    <>\n      {mapping === SeriesMapping.Manual && (\n        <>\n          <Button icon=\"plus\" size=\"sm\" variant=\"secondary\" onClick={addSeries} className={style.marginBot}>\n            <Trans i18nKey=\"xychart.series-editor.add-series\">Add series</Trans>\n          </Button>\n\n          <div className={style.marginBot}>\n            {seriesCfg.map((series, index) => {\n              return (\n                <div\n                  key={`series/${index}`}\n                  className={index === selectedIdx ? `${style.row} ${style.sel}` : style.row}\n                  onClick={() => setSelectedIdx(index)}\n                  role=\"button\"\n                  aria-label={t('xychart.series-editor.aria-label-select-series', 'Select series {{seriesNum}}', {\n                    seriesNum: index + 1,\n                  })}\n                  tabIndex={0}\n                  onKeyPress={(e) => {\n                    if (e.key === 'Enter') {\n                      setSelectedIdx(index);\n                    }\n                  }}\n                >\n                  <LayerName\n                    name={series.name?.fixed ?? `Series ${index + 1}`}\n                    onChange={(v) => {\n                      series.name = {\n                        fixed: v === '' || v === `Series ${index + 1}` ? undefined : v,\n                      };\n                      onChange([...seriesCfg]);\n                    }}\n                  />\n                  <IconButton\n                    name=\"trash-alt\"\n                    className={cx(style.actionIcon)}\n                    onClick={() => deleteSeries(index)}\n                    tooltip={t('xychart.series-editor.tooltip-delete-series', 'Delete series')}\n                  />\n                </div>\n              );\n            })}\n          </div>\n        </>\n      )}\n\n      {selectedIdx >= 0 && series != null && (\n        <Fragment key={formKey}>\n          <Field label={t('xychart.series-editor.label-frame', 'Frame')}>\n            <Select\n              placeholder={\n                mapping === SeriesMapping.Auto\n                  ? t('xychart.series-editor.placeholder-all-frames', 'All frames')\n                  : t('xychart.series-editor.placeholder-select-frame', 'Select frame')\n              }\n              isClearable={true}\n              options={context.data.map((frame, index) => ({\n                value: index,\n                label: `${getFrameDisplayName(frame, index)} (index: ${index}, rows: ${frame.length})`,\n              }))}\n              value={series.frame?.matcher.options}\n              onChange={(opt) => {\n                if (opt == null) {\n                  delete series.frame;\n                } else {\n                  series.frame = {\n                    matcher: {\n                      id: FrameMatcherID.byIndex,\n                      options: Number(opt.value),\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-x-field', 'X field')}>\n            <FieldNamePicker\n              value={series.x?.matcher.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.x;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.x = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'x',\n                name: 'x',\n                settings: {\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    (field.type === FieldType.number || field.type === FieldType.time) &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText:\n                    mapping === SeriesMapping.Auto\n                      ? t('xychart.series-editor.placeholder-x-field', 'First number or time field in each frame')\n                      : undefined,\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-y-field', 'Y field')}>\n            <FieldNamePicker\n              value={series.y?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.y;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.y = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'y',\n                name: 'y',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText:\n                    mapping === SeriesMapping.Auto\n                      ? t('xychart.series-editor.placeholder-y-field', 'Remaining number fields in each frame')\n                      : undefined,\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-size-field', 'Size field')}>\n            <FieldNamePicker\n              value={series.size?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.size;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.size = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'size',\n                name: 'size',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    field.name !== series.x?.matcher.options &&\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText: '',\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-color-field', 'Color field')}>\n            <FieldNamePicker\n              value={series.color?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.color;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.color = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'color',\n                name: 'color',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    field.name !== series.x?.matcher.options &&\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText: '',\n                },\n              }}\n            />\n          </Field>\n        </Fragment>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  marginBot: css({\n    marginBottom: '20px',\n  }),\n  row: css({\n    padding: `${theme.spacing(0.5, 1)}`,\n    borderRadius: `${theme.shape.radius.default}`,\n    background: `${theme.colors.background.secondary}`,\n    minHeight: `${theme.spacing(4)}`,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    marginBottom: '3px',\n    cursor: 'pointer',\n\n    border: `1px solid ${theme.components.input.borderColor}`,\n    '&:hover': {\n      border: `1px solid ${theme.components.input.borderHover}`,\n    },\n  }),\n  sel: css({\n    border: `1px solid ${theme.colors.primary.border}`,\n    '&:hover': {\n      border: `1px solid ${theme.colors.primary.border}`,\n    },\n  }),\n  actionIcon: css({\n    color: `${theme.colors.text.secondary}`,\n    '&:hover': {\n      color: `${theme.colors.text}`,\n    },\n  }),\n});\n","import { ReactNode } from 'react';\n\nimport { colorManipulator, DataFrame, InterpolateFunction, LinkModel } from '@grafana/data';\nimport {\n  VizTooltipContent,\n  VizTooltipFooter,\n  VizTooltipHeader,\n  VizTooltipWrapper,\n  ColorIndicator,\n  VizTooltipItem,\n} from '@grafana/ui/internal';\n\nimport { getFieldActions } from '../status-history/utils';\n\nimport { XYSeries } from './types2';\nimport { fmt } from './utils';\n\nexport interface Props {\n  dataIdxs: Array<number | null>;\n  seriesIdx: number | null | undefined;\n  isPinned: boolean;\n  dismiss: () => void;\n  data: DataFrame[];\n  xySeries: XYSeries[];\n  replaceVariables: InterpolateFunction;\n  dataLinks: LinkModel[];\n}\n\nfunction stripSeriesName(fieldName: string, seriesName: string) {\n  if (fieldName !== seriesName && fieldName.includes(' ')) {\n    fieldName = fieldName.replace(seriesName, '').trim();\n  }\n\n  return fieldName;\n}\n\nexport const XYChartTooltip = ({\n  dataIdxs,\n  seriesIdx,\n  data,\n  xySeries,\n  dismiss,\n  isPinned,\n  replaceVariables,\n  dataLinks,\n}: Props) => {\n  const rowIndex = dataIdxs.find((idx) => idx !== null)!;\n\n  const series = xySeries[seriesIdx! - 1];\n  const xField = series.x.field;\n  const yField = series.y.field;\n\n  const sizeField = series.size.field;\n  const colorField = series.color.field;\n\n  let label = series.name.value;\n\n  let seriesColor = series.color.fixed;\n  // let colorField = series.color.field;\n  // let pointColor: string;\n\n  // if (colorField != null) {\n  //   pointColor = colorField.display?.(colorField.values[rowIndex]).color!;\n  // }\n\n  const headerItem: VizTooltipItem = {\n    label,\n    value: '',\n    color: colorManipulator.alpha(seriesColor ?? '#fff', 0.5),\n    colorIndicator: ColorIndicator.marker_md,\n  };\n\n  const contentItems: VizTooltipItem[] = [\n    {\n      label: stripSeriesName(xField.state?.displayName ?? xField.name, label),\n      value: fmt(xField, xField.values[rowIndex]),\n    },\n    {\n      label: stripSeriesName(yField.state?.displayName ?? yField.name, label),\n      value: fmt(yField, yField.values[rowIndex]),\n    },\n  ];\n\n  // mapped fields for size/color\n  if (sizeField != null && sizeField !== yField) {\n    contentItems.push({\n      label: stripSeriesName(sizeField.state?.displayName ?? sizeField.name, label),\n      value: fmt(sizeField, sizeField.values[rowIndex]),\n    });\n  }\n\n  if (colorField != null && colorField !== yField) {\n    contentItems.push({\n      label: stripSeriesName(colorField.state?.displayName ?? colorField.name, label),\n      value: fmt(colorField, colorField.values[rowIndex]),\n    });\n  }\n\n  series._rest.forEach((field) => {\n    contentItems.push({\n      label: stripSeriesName(field.state?.displayName ?? field.name, label),\n      value: fmt(field, field.values[rowIndex]),\n    });\n  });\n\n  let footer: ReactNode;\n\n  if (seriesIdx != null) {\n    const hasOneClickLink = dataLinks?.some((dataLink) => dataLink.oneClick === true);\n\n    if (isPinned || hasOneClickLink) {\n      const yFieldFrame = data.find((frame) => frame.fields.includes(yField))!;\n      const actions = getFieldActions(yFieldFrame, yField, replaceVariables, rowIndex);\n\n      footer = <VizTooltipFooter dataLinks={dataLinks} actions={actions} />;\n    }\n  }\n\n  return (\n    <VizTooltipWrapper>\n      <VizTooltipHeader item={headerItem} isPinned={isPinned} />\n      <VizTooltipContent items={contentItems} isPinned={isPinned} />\n      {footer}\n    </VizTooltipWrapper>\n  );\n};\n","import tinycolor from 'tinycolor2';\nimport uPlot from 'uplot';\n\nimport {\n  FALLBACK_COLOR,\n  Field,\n  FieldType,\n  formattedValueToString,\n  getFieldColorModeForField,\n  GrafanaTheme2,\n  MappingType,\n  SpecialValueMatch,\n  ThresholdsMode,\n  colorManipulator,\n} from '@grafana/data';\nimport { AxisPlacement, FieldColorModeId, ScaleDirection, ScaleOrientation, VisibilityMode } from '@grafana/schema';\nimport { UPlotConfigBuilder } from '@grafana/ui';\nimport { FacetedData, FacetSeries } from '@grafana/ui/internal';\n\nimport { pointWithin, Quadtree, Rect } from '../barchart/quadtree';\nimport { valuesToFills } from '../heatmap/utils';\n\nimport { PointShape } from './panelcfg.gen';\nimport { XYSeries } from './types2';\nimport { getCommonPrefixSuffix } from './utils';\n\ninterface DrawBubblesOpts {\n  each: (u: uPlot, seriesIdx: number, dataIdx: number, lft: number, top: number, wid: number, hgt: number) => void;\n  disp: {\n    //unit: 3,\n    size: {\n      values: (u: uPlot, seriesIdx: number) => number[];\n    };\n    color: {\n      values: (u: uPlot, seriesIdx: number) => string[];\n    };\n  };\n}\n\nexport const prepConfig = (xySeries: XYSeries[], theme: GrafanaTheme2) => {\n  if (xySeries.length === 0) {\n    return { builder: null, prepData: () => [] };\n  }\n\n  let qt: Quadtree;\n  let hRect: Rect | null;\n\n  function drawBubblesFactory(opts: DrawBubblesOpts) {\n    const drawBubbles: uPlot.Series.PathBuilder = (u, seriesIdx, idx0, idx1) => {\n      uPlot.orient(\n        u,\n        seriesIdx,\n        (\n          series,\n          dataX,\n          dataY,\n          scaleX,\n          scaleY,\n          valToPosX,\n          valToPosY,\n          xOff,\n          yOff,\n          xDim,\n          yDim,\n          moveTo,\n          lineTo,\n          rect,\n          arc\n        ) => {\n          const pxRatio = uPlot.pxRatio;\n          const scatterInfo = xySeries[seriesIdx - 1];\n          let d = u.data[seriesIdx] as unknown as FacetSeries;\n\n          // showLine: boolean;\n          // lineStyle: common.LineStyle;\n          // showPoints: common.VisibilityMode;\n\n          let showLine = scatterInfo.showLine;\n          let showPoints = scatterInfo.showPoints === VisibilityMode.Always;\n          let strokeWidth = scatterInfo.pointStrokeWidth ?? 0;\n\n          u.ctx.save();\n\n          u.ctx.rect(u.bbox.left, u.bbox.top, u.bbox.width, u.bbox.height);\n          u.ctx.clip();\n\n          let pointAlpha = scatterInfo.fillOpacity / 100;\n\n          u.ctx.fillStyle = colorManipulator.alpha((series.fill as any)(), pointAlpha);\n          u.ctx.strokeStyle = colorManipulator.alpha((series.stroke as any)(), 1);\n          u.ctx.lineWidth = strokeWidth;\n\n          let deg360 = 2 * Math.PI;\n\n          let xKey = scaleX.key!;\n          let yKey = scaleY.key!;\n\n          //const colorMode = getFieldColorModeForField(field); // isByValue\n          const pointSize = scatterInfo.y.field.config.custom.pointSize;\n          const colorByValue = scatterInfo.color.field != null; // && colorMode.isByValue;\n\n          let maxSize = (pointSize.max ?? pointSize.fixed) * pxRatio;\n\n          // todo: this depends on direction & orientation\n          // todo: calc once per redraw, not per path\n          let filtLft = u.posToVal(-maxSize / 2, xKey);\n          let filtRgt = u.posToVal(u.bbox.width / pxRatio + maxSize / 2, xKey);\n          let filtBtm = u.posToVal(u.bbox.height / pxRatio + maxSize / 2, yKey);\n          let filtTop = u.posToVal(-maxSize / 2, yKey);\n\n          let sizes = opts.disp.size.values(u, seriesIdx);\n          // let pointColors = opts.disp.color.values(u, seriesIdx);\n          let pointColors = dispColors[seriesIdx - 1].values; // idxs\n          let pointPalette = dispColors[seriesIdx - 1].index as Array<CanvasRenderingContext2D['fillStyle']>;\n          let paletteHasAlpha = dispColors[seriesIdx - 1].hasAlpha;\n\n          let isSquare = scatterInfo.pointShape === PointShape.Square;\n\n          let linePath: Path2D | null = showLine ? new Path2D() : null;\n\n          let curColorIdx = -1;\n\n          for (let i = 0; i < d[0].length; i++) {\n            let xVal = d[0][i];\n            let yVal = d[1][i];\n\n            if (xVal >= filtLft && xVal <= filtRgt && yVal >= filtBtm && yVal <= filtTop) {\n              let size = Math.round(sizes[i] * pxRatio);\n              let cx = valToPosX(xVal, scaleX, xDim, xOff);\n              let cy = valToPosY(yVal, scaleY, yDim, yOff);\n\n              if (showLine) {\n                linePath!.lineTo(cx, cy);\n              }\n\n              if (showPoints) {\n                if (colorByValue) {\n                  if (pointColors[i] !== curColorIdx) {\n                    curColorIdx = pointColors[i];\n                    let c = curColorIdx === -1 ? FALLBACK_COLOR : pointPalette[curColorIdx];\n                    u.ctx.fillStyle = paletteHasAlpha ? c : colorManipulator.alpha(c as string, pointAlpha);\n                    u.ctx.strokeStyle = colorManipulator.alpha(c as string, 1);\n                  }\n                }\n\n                if (isSquare) {\n                  let x = Math.round(cx - size / 2);\n                  let y = Math.round(cy - size / 2);\n\n                  if (colorByValue || pointAlpha > 0) {\n                    u.ctx.fillRect(x, y, size, size);\n                  }\n\n                  if (strokeWidth > 0) {\n                    u.ctx.strokeRect(x, y, size, size);\n                  }\n                } else {\n                  u.ctx.beginPath();\n                  u.ctx.arc(cx, cy, size / 2, 0, deg360);\n\n                  if (colorByValue || pointAlpha > 0) {\n                    u.ctx.fill();\n                  }\n\n                  if (strokeWidth > 0) {\n                    u.ctx.stroke();\n                  }\n                }\n\n                opts.each(\n                  u,\n                  seriesIdx,\n                  i,\n                  cx - size / 2 - strokeWidth / 2,\n                  cy - size / 2 - strokeWidth / 2,\n                  size + strokeWidth,\n                  size + strokeWidth\n                );\n              }\n            }\n          }\n\n          if (showLine) {\n            u.ctx.strokeStyle = scatterInfo.color.fixed!;\n            u.ctx.lineWidth = scatterInfo.lineWidth * pxRatio;\n\n            const { lineStyle } = scatterInfo;\n            if (lineStyle && lineStyle.fill !== 'solid') {\n              if (lineStyle.fill === 'dot') {\n                u.ctx.lineCap = 'round';\n              }\n              u.ctx.setLineDash(lineStyle.dash ?? [10, 10]);\n            }\n\n            u.ctx.stroke(linePath!);\n          }\n\n          u.ctx.restore();\n        }\n      );\n\n      return null;\n    };\n\n    return drawBubbles;\n  }\n\n  let drawBubbles = drawBubblesFactory({\n    disp: {\n      size: {\n        //unit: 3, // raw CSS pixels\n        values: (u, seriesIdx) => {\n          return u.data[seriesIdx][2] as any; // already contains final pixel geometry\n          //let [minValue, maxValue] = getSizeMinMax(u);\n          //return u.data[seriesIdx][2].map(v => getSize(v, minValue, maxValue));\n        },\n      },\n      color: {\n        // string values\n        values: (u, seriesIdx) => {\n          return u.data[seriesIdx][3] as any;\n        },\n      },\n    },\n    each: (u, seriesIdx, dataIdx, lft, top, wid, hgt) => {\n      // we get back raw canvas coords (included axes & padding). translate to the plotting area origin\n      lft -= u.bbox.left;\n      top -= u.bbox.top;\n      qt.add({ x: lft, y: top, w: wid, h: hgt, sidx: seriesIdx, didx: dataIdx });\n    },\n  });\n\n  const builder = new UPlotConfigBuilder();\n\n  builder.setCursor({\n    drag: { setScale: true },\n    dataIdx: (u, seriesIdx) => {\n      if (seriesIdx === 1) {\n        const pxRatio = uPlot.pxRatio;\n\n        hRect = null;\n\n        let dist = Infinity;\n        let cx = u.cursor.left! * pxRatio;\n        let cy = u.cursor.top! * pxRatio;\n\n        qt.get(cx, cy, 1, 1, (o) => {\n          if (pointWithin(cx, cy, o.x, o.y, o.x + o.w, o.y + o.h)) {\n            let ocx = o.x + o.w / 2;\n            let ocy = o.y + o.h / 2;\n\n            let dx = ocx - cx;\n            let dy = ocy - cy;\n\n            let d = Math.sqrt(dx ** 2 + dy ** 2);\n\n            // test against radius for actual hover\n            if (d <= o.w / 2) {\n              // only hover bbox with closest distance\n              if (d <= dist) {\n                dist = d;\n                hRect = o;\n              }\n            }\n          }\n        });\n      }\n\n      return hRect && seriesIdx === hRect.sidx ? hRect.didx : null;\n    },\n    points: {\n      size: (u, seriesIdx) => {\n        return hRect && seriesIdx === hRect.sidx ? hRect.w / uPlot.pxRatio : 0;\n      },\n      fill: (u, seriesIdx) => 'rgba(255,255,255,0.4)',\n    },\n  });\n\n  // clip hover points/bubbles to plotting area\n  builder.addHook('init', (u, r) => {\n    u.over.style.overflow = 'hidden';\n  });\n\n  builder.addHook('drawClear', (u) => {\n    qt = qt || new Quadtree(0, 0, u.bbox.width, u.bbox.height);\n\n    qt.clear();\n\n    // force-clear the path cache to cause drawBars() to rebuild new quadtree\n    u.series.forEach((s, i) => {\n      if (i > 0) {\n        // @ts-ignore\n        s._paths = null;\n      }\n    });\n  });\n\n  builder.setMode(2);\n\n  let xField = xySeries[0].x.field;\n  let xIsTime = xField.type === FieldType.time;\n\n  let fieldConfig = xField.config;\n  let customConfig = fieldConfig.custom;\n  let scaleDistr = customConfig?.scaleDistribution;\n\n  builder.addScale({\n    scaleKey: 'x',\n    isTime: xIsTime,\n    auto: true,\n    orientation: ScaleOrientation.Horizontal,\n    direction: ScaleDirection.Right,\n    distribution: scaleDistr?.type,\n    log: scaleDistr?.log,\n    linearThreshold: scaleDistr?.linearThreshold,\n    min: fieldConfig.min,\n    max: fieldConfig.max,\n    softMin: customConfig?.axisSoftMin,\n    softMax: customConfig?.axisSoftMax,\n    centeredZero: customConfig?.axisCenteredZero,\n    decimals: fieldConfig.decimals,\n    range: xIsTime ? (u, min, max) => [min, max] : undefined,\n  });\n\n  // why does this fall back to '' instead of null or undef?\n  let xAxisLabel = customConfig.axisLabel;\n\n  if (xAxisLabel == null || xAxisLabel === '') {\n    let dispNames = xySeries.map((s) => s.x.field.state?.displayName ?? '');\n\n    let xAxisAutoLabel =\n      xySeries.length === 1\n        ? (xField.state?.displayName ?? xField.name)\n        : new Set(dispNames).size === 1\n          ? dispNames[0]\n          : getCommonPrefixSuffix(dispNames);\n\n    if (xAxisAutoLabel !== '') {\n      xAxisLabel = xAxisAutoLabel;\n    }\n  }\n\n  builder.addAxis({\n    scaleKey: 'x',\n    isTime: xIsTime,\n    placement: customConfig?.axisPlacement !== AxisPlacement.Hidden ? AxisPlacement.Bottom : AxisPlacement.Hidden,\n    show: customConfig?.axisPlacement !== AxisPlacement.Hidden,\n    grid: { show: customConfig?.axisGridShow },\n    border: { show: customConfig?.axisBorderShow },\n    theme,\n    label: xAxisLabel,\n    formatValue: xIsTime ? undefined : (v, decimals) => formattedValueToString(xField.display!(v, decimals)),\n  });\n\n  xySeries.forEach((s, si) => {\n    let field = s.y.field;\n\n    const lineColor = s.color.fixed;\n    const pointColor = s.color.fixed;\n    //const lineColor = s.lineColor(frame);\n    //const lineWidth = s.lineWidth;\n\n    let scaleKey = field.config.unit ?? 'y';\n    let config = field.config;\n    let customConfig = config.custom;\n    let scaleDistr = customConfig?.scaleDistribution;\n\n    builder.addScale({\n      scaleKey,\n      orientation: ScaleOrientation.Vertical,\n      direction: ScaleDirection.Up,\n      distribution: scaleDistr?.type,\n      log: scaleDistr?.log,\n      linearThreshold: scaleDistr?.linearThreshold,\n      min: config.min,\n      max: config.max,\n      softMin: customConfig?.axisSoftMin,\n      softMax: customConfig?.axisSoftMax,\n      centeredZero: customConfig?.axisCenteredZero,\n      decimals: config.decimals,\n    });\n\n    // why does this fall back to '' instead of null or undef?\n    let yAxisLabel = customConfig.axisLabel;\n\n    if (yAxisLabel == null || yAxisLabel === '') {\n      let dispNames = xySeries.map((s) => s.y.field.state?.displayName ?? '');\n\n      let yAxisAutoLabel =\n        xySeries.length === 1\n          ? (field.state?.displayName ?? field.name)\n          : new Set(dispNames).size === 1\n            ? dispNames[0]\n            : getCommonPrefixSuffix(dispNames);\n\n      if (yAxisAutoLabel !== '') {\n        yAxisLabel = yAxisAutoLabel;\n      }\n    }\n\n    builder.addAxis({\n      scaleKey,\n      theme,\n      placement: customConfig?.axisPlacement === AxisPlacement.Auto ? AxisPlacement.Left : customConfig?.axisPlacement,\n      show: customConfig?.axisPlacement !== AxisPlacement.Hidden,\n      grid: { show: customConfig?.axisGridShow },\n      border: { show: customConfig?.axisBorderShow },\n      size: customConfig?.axisWidth,\n      // label: yAxisLabel == null || yAxisLabel === '' ? fieldDisplayName : yAxisLabel,\n      label: yAxisLabel,\n      formatValue: (v, decimals) => formattedValueToString(field.display!(v, decimals)),\n    });\n\n    builder.addSeries({\n      facets: [\n        {\n          scale: 'x',\n          auto: true,\n        },\n        {\n          scale: scaleKey,\n          auto: true,\n        },\n      ],\n      pathBuilder: drawBubbles, // drawBubbles({disp: {size: {values: () => }}})\n      theme,\n      scaleKey: '', // facets' scales used (above)\n      lineColor: colorManipulator.alpha(lineColor ?? '#ffff', 1),\n      fillColor: colorManipulator.alpha(pointColor ?? '#ffff', 0.5),\n      show: !field.state?.hideFrom?.viz,\n    });\n  });\n\n  const dispColors = xySeries.map((s): FieldColorValuesWithCache => {\n    const cfg: FieldColorValuesWithCache = {\n      index: [],\n      getAll: () => [],\n      getOne: () => -1,\n      // cache for renderer, refreshed in prepData()\n      values: [],\n      hasAlpha: false,\n    };\n\n    const f = s.color.field;\n\n    if (f != null) {\n      Object.assign(cfg, fieldValueColors(f, theme));\n      cfg.hasAlpha = cfg.index.some((v) => !(v as string).endsWith('ff'));\n    }\n\n    return cfg;\n  });\n\n  function prepData(xySeries: XYSeries[]): FacetedData {\n    // if (info.error || !data.length) {\n    //   return [null];\n    // }\n\n    const { size: sizeRange, color: colorRange } = getGlobalRanges(xySeries);\n\n    xySeries.forEach((s, i) => {\n      dispColors[i].values = dispColors[i].getAll(s.color.field?.values ?? [], colorRange.min, colorRange.max);\n    });\n\n    return [\n      null,\n      ...xySeries.map((s, idx) => {\n        let len = s.x.field.values.length;\n\n        let diams: number[];\n\n        if (s.size.field != null) {\n          let { min, max } = s.size;\n\n          // todo: this scaling should be in renderer from raw values (not by passing css pixel diams via data)\n          let minPx = min! ** 2;\n          let maxPx = max! ** 2;\n          // use quadratic size scaling in byValue modes\n          let pxRange = maxPx - minPx;\n\n          let vals = s.size.field.values;\n          let minVal = sizeRange.min;\n          let maxVal = sizeRange.max;\n          let valRange = maxVal - minVal;\n\n          diams = Array(len);\n\n          for (let i = 0; i < vals.length; i++) {\n            let val = vals[i];\n\n            let valPct = (val - minVal) / valRange;\n            let pxArea = minPx + valPct * pxRange;\n            diams[i] = pxArea ** 0.5;\n          }\n        } else {\n          diams = Array(len).fill(s.size.fixed!);\n        }\n\n        return [\n          s.x.field.values, // X\n          s.y.field.values, // Y\n          diams,\n          Array(len).fill(s.color.fixed!), // TODO: fails for by value\n        ];\n      }),\n    ];\n  }\n\n  return { builder, prepData };\n};\n\nexport type PrepData = (xySeries: XYSeries[]) => FacetedData;\n\nconst getGlobalRanges = (xySeries: XYSeries[]) => {\n  const ranges = {\n    size: {\n      min: Infinity,\n      max: -Infinity,\n    },\n    color: {\n      min: Infinity,\n      max: -Infinity,\n    },\n  };\n\n  xySeries.forEach((series) => {\n    [series.size, series.color].forEach((facet, fi) => {\n      if (facet.field != null) {\n        let range = fi === 0 ? ranges.size : ranges.color;\n\n        const vals = facet.field.values;\n\n        for (let i = 0; i < vals.length; i++) {\n          const v = vals[i];\n\n          if (v != null) {\n            if (v < range.min) {\n              range.min = v;\n            }\n\n            if (v > range.max) {\n              range.max = v;\n            }\n          }\n        }\n      }\n    });\n  });\n\n  return ranges;\n};\n\nfunction getHex8Color(color: string, theme: GrafanaTheme2) {\n  return tinycolor(theme.visualization.getColorByName(color)).toHex8String();\n}\n\ninterface FieldColorValues {\n  index: unknown[];\n  getOne: GetOneValue;\n  getAll: GetAllValues;\n}\ninterface FieldColorValuesWithCache extends FieldColorValues {\n  values: number[];\n  hasAlpha: boolean;\n}\ntype GetAllValues = (values: unknown[], min?: number, max?: number) => number[];\ntype GetOneValue = (value: unknown, min?: number, max?: number) => number;\n\n/** compiler for values to palette color idxs (from thresholds, mappings, by-value gradients) */\nfunction fieldValueColors(f: Field, theme: GrafanaTheme2): FieldColorValues {\n  let index: unknown[] = [];\n  let getAll: GetAllValues = () => [];\n  let getOne: GetOneValue = () => -1;\n\n  let conds = '';\n\n  // if any mappings exist, use them regardless of other settings\n  if (f.config.mappings?.length ?? 0 > 0) {\n    let mappings = f.config.mappings!;\n\n    for (let i = 0; i < mappings.length; i++) {\n      let m = mappings[i];\n\n      if (m.type === MappingType.ValueToText) {\n        for (let k in m.options) {\n          let { color } = m.options[k];\n\n          if (color != null) {\n            let rhs = f.type === FieldType.string ? JSON.stringify(k) : Number(k);\n            conds += `v === ${rhs} ? ${index.length} : `;\n            index.push(getHex8Color(color, theme));\n          }\n        }\n      } else if (m.options.result.color != null) {\n        let { color } = m.options.result;\n\n        if (m.type === MappingType.RangeToText) {\n          let range = [];\n\n          if (m.options.from != null) {\n            range.push(`v >= ${Number(m.options.from)}`);\n          }\n\n          if (m.options.to != null) {\n            range.push(`v <= ${Number(m.options.to)}`);\n          }\n\n          if (range.length > 0) {\n            conds += `${range.join(' && ')} ? ${index.length} : `;\n            index.push(getHex8Color(color, theme));\n          }\n        } else if (m.type === MappingType.SpecialValue) {\n          let spl = m.options.match;\n\n          if (spl === SpecialValueMatch.NaN) {\n            conds += `isNaN(v)`;\n          } else if (spl === SpecialValueMatch.NullAndNaN) {\n            conds += `v == null || isNaN(v)`;\n          } else {\n            conds += `v ${\n              spl === SpecialValueMatch.True\n                ? '=== true'\n                : spl === SpecialValueMatch.False\n                  ? '=== false'\n                  : spl === SpecialValueMatch.Null\n                    ? '== null'\n                    : spl === SpecialValueMatch.Empty\n                      ? '=== \"\"'\n                      : '== null'\n            }`;\n          }\n\n          conds += ` ? ${index.length} : `;\n          index.push(getHex8Color(color, theme));\n        } else if (m.type === MappingType.RegexToText) {\n          // TODO\n        }\n      }\n    }\n\n    conds += '-1'; // ?? what default here? null? FALLBACK_COLOR?\n  } else if (f.config.color?.mode === FieldColorModeId.Thresholds) {\n    if (f.config.thresholds?.mode === ThresholdsMode.Absolute) {\n      let steps = f.config.thresholds.steps;\n      let lasti = steps.length - 1;\n\n      for (let i = lasti; i > 0; i--) {\n        let rhs = Number(steps[i].value);\n        conds += `v >= ${rhs} ? ${i} : `;\n      }\n\n      conds += '0';\n\n      index = steps.map((s) => getHex8Color(s.color, theme));\n    } else {\n      // TODO: percent thresholds?\n    }\n  } else if (f.config.color?.mode?.startsWith('continuous')) {\n    let calc = getFieldColorModeForField(f).getCalculator(f, theme);\n\n    index = Array(32);\n\n    for (let i = 0; i < index.length; i++) {\n      let pct = i / (index.length - 1);\n      index[i] = getHex8Color(calc(pct, pct), theme);\n    }\n\n    getAll = (vals, min, max) => valuesToFills(vals as number[], index as string[], min!, max!);\n  }\n\n  if (conds !== '') {\n    getOne = new Function('v', `return ${conds};`) as GetOneValue;\n\n    getAll = new Function(\n      'vals',\n      `\n      let idxs = Array(vals.length);\n\n      for (let i = 0; i < vals.length; i++) {\n        let v = vals[i];\n        idxs[i] = ${conds};\n      }\n\n      return idxs;\n    `\n    ) as GetAllValues;\n  }\n\n  return {\n    index,\n    getOne,\n    getAll,\n  };\n}\n","import { css } from '@emotion/css';\nimport { useMemo } from 'react';\n\nimport { colorManipulator, FALLBACK_COLOR, PanelProps } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport {\n  TooltipDisplayMode,\n  TooltipPlugin2,\n  UPlotChart,\n  VizLayout,\n  VizLegend,\n  VizLegendItem,\n  useStyles2,\n  useTheme2,\n} from '@grafana/ui';\nimport { getDisplayValuesForCalcs, TooltipHoverMode } from '@grafana/ui/internal';\n\nimport { getDataLinks } from '../status-history/utils';\n\nimport { XYChartTooltip } from './XYChartTooltip';\nimport { Options } from './panelcfg.gen';\nimport { prepConfig } from './scatter';\nimport { prepSeries } from './utils';\n\ntype Props2 = PanelProps<Options>;\n\nexport const XYChartPanel2 = (props: Props2) => {\n  const styles = useStyles2(getStyles);\n  const theme = useTheme2();\n\n  let { mapping, series: mappedSeries } = props.options;\n\n  // regenerate series schema when mappings or data changes\n  let series = useMemo(\n    () => prepSeries(mapping, mappedSeries, props.data.series, props.fieldConfig),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [mapping, mappedSeries, props.data.series, props.fieldConfig]\n  );\n\n  // if series changed due to mappings or data structure, re-init config & renderers\n  let { builder, prepData } = useMemo(\n    () => prepConfig(series, config.theme2),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [mapping, mappedSeries, props.data.structureRev, props.fieldConfig, props.options.tooltip]\n  );\n\n  // generate data struct for uPlot mode: 2\n  let data = useMemo(\n    () => prepData(series),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [series]\n  );\n\n  // todo: handle errors\n  let error = builder == null || data.length === 0 ? 'Err' : '';\n\n  // TODO: React.memo()\n  const renderLegend = () => {\n    if (!props.options.legend.showLegend) {\n      return null;\n    }\n\n    const items: VizLegendItem[] = [];\n\n    series.forEach((s, idx) => {\n      let yField = s.y.field;\n      let config = yField.config;\n      let custom = config.custom;\n\n      if (!custom.hideFrom?.legend) {\n        items.push({\n          yAxis: 1, // TODO: pull from y field\n          label: s.name.value,\n          color: colorManipulator.alpha(s.color.fixed ?? FALLBACK_COLOR, 1),\n          getItemKey: () => `${idx}-${s.name.value}`,\n          fieldName: yField.state?.displayName ?? yField.name,\n          disabled: yField.state?.hideFrom?.viz ?? false,\n          getDisplayValues: () => getDisplayValuesForCalcs(props.options.legend.calcs, yField, theme),\n        });\n      }\n    });\n\n    const { placement, displayMode, width, sortBy, sortDesc } = props.options.legend;\n\n    return (\n      <VizLayout.Legend placement={placement} width={width}>\n        <VizLegend\n          className={styles.legend}\n          placement={placement}\n          items={items}\n          displayMode={displayMode}\n          sortBy={sortBy}\n          sortDesc={sortDesc}\n          isSortable={true}\n        />\n      </VizLayout.Legend>\n    );\n  };\n\n  if (error) {\n    return (\n      <div className=\"panel-empty\">\n        <p>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <VizLayout width={props.width} height={props.height} legend={renderLegend()}>\n      {(vizWidth: number, vizHeight: number) => (\n        <UPlotChart config={builder!} data={data} width={vizWidth} height={vizHeight}>\n          {props.options.tooltip.mode !== TooltipDisplayMode.None && (\n            <TooltipPlugin2\n              config={builder!}\n              hoverMode={TooltipHoverMode.xyOne}\n              getDataLinks={(seriesIdx, dataIdx) => {\n                const xySeries = series[seriesIdx - 1];\n                return getDataLinks(xySeries.y.field, dataIdx);\n              }}\n              render={(u, dataIdxs, seriesIdx, isPinned, dismiss, timeRange2, viaSync, dataLinks) => {\n                return (\n                  <XYChartTooltip\n                    data={props.data.series}\n                    dataIdxs={dataIdxs}\n                    xySeries={series}\n                    dismiss={dismiss}\n                    isPinned={isPinned}\n                    seriesIdx={seriesIdx!}\n                    replaceVariables={props.replaceVariables}\n                    dataLinks={dataLinks}\n                  />\n                );\n              }}\n              maxWidth={props.options.tooltip.maxWidth}\n            />\n          )}\n        </UPlotChart>\n      )}\n    </VizLayout>\n  );\n};\n\nconst getStyles = () => ({\n  legend: css({\n    div: {\n      justifyContent: 'flex-start',\n    },\n  }),\n});\n","import {\n  FieldColorModeId,\n  FieldConfigProperty,\n  FieldType,\n  identityOverrideProcessor,\n  SetFieldConfigOptionsArgs,\n} from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { LineStyle } from '@grafana/schema';\nimport { commonOptionsBuilder } from '@grafana/ui';\n\nimport { LineStyleEditor } from '../timeseries/LineStyleEditor';\n\nimport { FieldConfig, XYShowMode, PointShape } from './panelcfg.gen';\n\nexport const DEFAULT_POINT_SIZE = 5;\n\nexport function getScatterFieldConfig(cfg: FieldConfig): SetFieldConfigOptionsArgs<FieldConfig> {\n  return {\n    standardOptions: {\n      [FieldConfigProperty.Min]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Max]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Unit]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Decimals]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.NoValue]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.DisplayName]: {\n        hideFromDefaults: true,\n      },\n      // TODO: this still leaves Color series by: [ Last | Min | Max ]\n      // because item.settings?.bySeriesSupport && colorMode.isByValue\n      [FieldConfigProperty.Color]: {\n        settings: {\n          byValueSupport: true,\n          bySeriesSupport: true,\n          preferThresholdsMode: false,\n        },\n        defaultValue: {\n          mode: FieldColorModeId.PaletteClassic,\n        },\n      },\n      [FieldConfigProperty.Links]: {\n        settings: {\n          showOneClick: true,\n        },\n      },\n      [FieldConfigProperty.Actions]: {\n        hideFromDefaults: false,\n      },\n    },\n\n    useCustomConfig: (builder) => {\n      const category = [t('xychart.category-xychart', 'XY Chart')];\n      builder\n        .addRadio({\n          path: 'show',\n          name: t('xychart.name-show', 'Show'),\n          category,\n          defaultValue: cfg.show,\n          settings: {\n            options: [\n              { label: t('xychart.show-options.label-points', 'Points'), value: XYShowMode.Points },\n              { label: t('xychart.show-options.label-lines', 'Lines'), value: XYShowMode.Lines },\n              { label: t('xychart.show-options.label-both', 'Both'), value: XYShowMode.PointsAndLines },\n            ],\n          },\n        })\n        // .addGenericEditor(\n        //   {\n        //     path: 'pointSymbol',\n        //     name: 'Point symbol',\n        //     defaultValue: defaultFieldConfig.pointSymbol ?? {\n        //       mode: 'fixed',\n        //       fixed: 'img/icons/marker/circle.svg',\n        //     },\n        //     settings: {\n        //       resourceType: MediaType.Icon,\n        //       folderName: ResourceFolderName.Marker,\n        //       placeholderText: 'Select a symbol',\n        //       placeholderValue: 'img/icons/marker/circle.svg',\n        //       showSourceRadio: false,\n        //     },\n        //     showIf: (c) => c.show !== ScatterShow.Lines,\n        //   },\n        //   SymbolEditor // ResourceDimensionEditor\n        // )\n        .addSliderInput({\n          path: 'pointSize.fixed',\n          name: t('xychart.name-point-size', 'Point size'),\n          category,\n          defaultValue: cfg.pointSize?.fixed ?? DEFAULT_POINT_SIZE,\n          settings: {\n            min: 1,\n            max: 100,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addNumberInput({\n          path: 'pointSize.min',\n          name: t('xychart.name-min-point-size', 'Min point size'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addNumberInput({\n          path: 'pointSize.max',\n          name: t('xychart.name-max-point-size', 'Max point size'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addRadio({\n          path: 'pointShape',\n          name: t('xychart.name-point-shape', 'Point shape'),\n          category,\n          defaultValue: PointShape.Circle,\n          settings: {\n            options: [\n              { value: PointShape.Circle, label: t('xychart.point-shape-options.label-circle', 'Circle') },\n              { value: PointShape.Square, label: t('xychart.point-shape-options.label-square', 'Square') },\n            ],\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addSliderInput({\n          path: 'pointStrokeWidth',\n          name: t('xychart.name-point-stroke-width', 'Point stroke width'),\n          category,\n          defaultValue: 1,\n          settings: {\n            min: 0,\n            max: 10,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addSliderInput({\n          path: 'fillOpacity',\n          name: t('xychart.name-fill-opacity', 'Fill opacity'),\n          category,\n          defaultValue: 50,\n          settings: {\n            min: 0,\n            max: 100,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addCustomEditor<void, LineStyle>({\n          id: 'lineStyle',\n          path: 'lineStyle',\n          name: t('xychart.name-line-style', 'Line style'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Points,\n          editor: LineStyleEditor,\n          override: LineStyleEditor,\n          process: identityOverrideProcessor,\n          shouldApply: (f) => f.type === FieldType.number,\n        })\n        .addSliderInput({\n          path: 'lineWidth',\n          name: t('xychart.name-line-width', 'Line width'),\n          category,\n          defaultValue: cfg.lineWidth,\n          settings: {\n            min: 0,\n            max: 10,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Points,\n        });\n\n      commonOptionsBuilder.addAxisConfig(builder, cfg);\n      commonOptionsBuilder.addHideFrom(builder);\n    },\n  };\n}\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\n/**\n * Auto is \"table\" in the UI\n */\nexport enum SeriesMapping {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\nexport enum ScatterShow {\n  Lines = 'lines',\n  Points = 'points',\n  PointsAndLines = 'points+lines',\n}\n\n/**\n * Configuration for the Table/Auto mode\n */\nexport interface XYDimensionConfig {\n  exclude?: Array<string>;\n  frame: number;\n  x?: string;\n}\n\nexport const defaultXYDimensionConfig: Partial<XYDimensionConfig> = {\n  exclude: [],\n};\n\nexport interface FieldConfig extends common.HideableFieldConfig, common.AxisConfig {\n  label?: common.VisibilityMode;\n  labelValue?: common.TextDimensionConfig;\n  lineColor?: common.ColorDimensionConfig;\n  lineStyle?: common.LineStyle;\n  lineWidth?: number;\n  pointColor?: common.ColorDimensionConfig;\n  pointSize?: common.ScaleDimensionConfig;\n  show?: ScatterShow;\n}\n\nexport const defaultFieldConfig: Partial<FieldConfig> = {\n  label: common.VisibilityMode.Auto,\n  show: ScatterShow.Points,\n};\n\nexport interface ScatterSeriesConfig extends FieldConfig {\n  frame?: number;\n  name?: string;\n  x?: string;\n  y?: string;\n}\n\nexport interface Options extends common.OptionsWithLegend, common.OptionsWithTooltip {\n  /**\n   * Table Mode (auto)\n   */\n  dims: XYDimensionConfig;\n  /**\n   * Manual Mode\n   */\n  series: Array<ScatterSeriesConfig>;\n  seriesMapping?: SeriesMapping;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  series: [],\n};\n","import { FieldMatcherID, FrameMatcherID, MatcherConfig, PanelModel } from '@grafana/data';\n\nimport { XYSeriesConfig, Options } from './panelcfg.gen';\nimport { ScatterSeriesConfig, SeriesMapping, XYDimensionConfig, Options as PrevOptions } from './panelcfgold.gen';\n\nexport const xyChartMigrationHandler = (panel: PanelModel): Options => {\n  const pluginVersion = panel?.pluginVersion ?? '';\n\n  if (pluginVersion === '' || parseFloat(pluginVersion) < 11.1) {\n    return migrateOptions(panel);\n  }\n\n  return panel.options;\n};\n\nfunction migrateOptions(panel: PanelModel): Options {\n  const { dims, seriesMapping, series: oldSeries, ...cleanedOpts } = panel.options as PrevOptions;\n  const { exclude = [], frame: frameShared, x: xShared }: XYDimensionConfig = dims ?? {};\n\n  const custDefaults = panel.fieldConfig.defaults.custom;\n\n  let oldSeries2 = oldSeries;\n\n  if (seriesMapping === SeriesMapping.Auto) {\n    oldSeries2 = [\n      {\n        x: undefined,\n        y: undefined,\n      },\n    ];\n  }\n\n  /*\n  // old manual mode example\n  \"series\": [\n    {\n      \"pointColor\": {\n        \"fixed\": \"purple\"       // this becomes override for y field.config.custom.pointColor.fixed, (or config.color?)\n        \"field\": \"BMI Male\",    // ...unless another field is mapped, then ignore\n      },\n      \"pointSize\": {\n        \"field\": \"Weight Male\",\n        \"max\": 40,              // this becomes override for y field.config.custom.pointSize.max\n        \"min\": 1,               // ...and .min\n        \"fixed\": 50.5\n      },\n      \"frame\": 0,               // byIndex frame matcher\n      \"x\": \"Height Male\",       // byName field matcher, falls back to byType/number field matcher\n      \"y\": \"Weight Male\"        // byName field matcher, falls back to byType/number field matcher\n    }\n  ],\n*/\n  let i = 0;\n\n  const newSeries: XYSeriesConfig[] = oldSeries2.map(({ x, y, pointColor, pointSize, frame }: ScatterSeriesConfig) => {\n    const { fixed: colorFixed, field: colorField } = pointColor ?? {};\n    const { fixed: sizeFixed, field: sizeField, min: sizeMin, max: sizeMax } = pointSize ?? {};\n\n    let xMatcherConfig: MatcherConfig;\n    let yMatcherConfig: MatcherConfig;\n\n    // old auto mode did not require x field defined\n    if (x == null && xShared == null) {\n      // TODO: this should just be the internal default. no need to store on save model\n      xMatcherConfig = {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      };\n    } else {\n      xMatcherConfig = {\n        id: FieldMatcherID.byName,\n        options: x ?? xShared,\n      };\n    }\n\n    if (y == null) {\n      // TODO: this should just be the internal default. no need to store on save model\n      yMatcherConfig = {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      };\n    } else {\n      yMatcherConfig = {\n        id: FieldMatcherID.byName,\n        options: y,\n      };\n    }\n\n    if (colorField == null && colorFixed && custDefaults.pointColor?.fixed !== colorFixed) {\n      // NOTE: intentionally not using custom.pointColor.fixed\n      let hasOverride = panel.fieldConfig.overrides.some(\n        (o) =>\n          o.matcher.id === yMatcherConfig.id &&\n          o.matcher.options === yMatcherConfig.options &&\n          o.properties.some((p) => p.id === 'color')\n      );\n\n      if (!hasOverride) {\n        panel.fieldConfig.overrides.push({\n          matcher: yMatcherConfig,\n          properties: [\n            {\n              id: 'color',\n              value: {\n                mode: 'fixed',\n                fixedColor: colorFixed,\n              },\n            },\n          ],\n        });\n      }\n    }\n\n    // add field overrides for custom pointSize.fixed\n    if (sizeField == null && sizeFixed && custDefaults.pointSize?.fixed !== sizeFixed) {\n      let hasOverride = panel.fieldConfig.overrides.some(\n        (o) =>\n          o.matcher.id === yMatcherConfig.id &&\n          o.matcher.options === yMatcherConfig.options &&\n          o.properties.some((p) => p.id === 'custom.pointSize.fixed')\n      );\n\n      if (!hasOverride) {\n        panel.fieldConfig.overrides.push({\n          matcher: yMatcherConfig,\n          properties: [\n            {\n              id: 'custom.pointSize.fixed',\n              value: sizeFixed,\n            },\n          ],\n        });\n      }\n    }\n\n    if (sizeField != null) {\n      // add field overrides for custom pointSize.min\n      if (sizeMin && custDefaults.pointSize?.min !== sizeMin) {\n        let hasOverride = panel.fieldConfig.overrides.some(\n          (o) =>\n            o.matcher.id === yMatcherConfig.id &&\n            o.matcher.options === yMatcherConfig.options &&\n            o.properties.some((p) => p.id === 'custom.pointSize.min')\n        );\n\n        if (!hasOverride) {\n          panel.fieldConfig.overrides.push({\n            matcher: {\n              id: FieldMatcherID.byName,\n              options: sizeField,\n            },\n            properties: [\n              {\n                id: 'custom.pointSize.min',\n                value: sizeMin,\n              },\n            ],\n          });\n        }\n      }\n      // add field overrides for custom pointSize.min\n      if (sizeMax && custDefaults.pointSize?.max !== sizeMax) {\n        let hasOverride = panel.fieldConfig.overrides.some(\n          (o) =>\n            o.matcher.id === yMatcherConfig.id &&\n            o.matcher.options === yMatcherConfig.options &&\n            o.properties.some((p) => p.id === 'custom.pointSize.max')\n        );\n\n        if (!hasOverride) {\n          panel.fieldConfig.overrides.push({\n            matcher: {\n              id: FieldMatcherID.byName,\n              options: sizeField,\n            },\n            properties: [\n              {\n                id: 'custom.pointSize.max',\n                value: sizeMax,\n              },\n            ],\n          });\n        }\n      }\n    }\n\n    return {\n      frame: {\n        matcher: {\n          id: FrameMatcherID.byIndex,\n          options: frame ?? (seriesMapping === SeriesMapping.Manual ? i++ : (frameShared ?? 0)),\n        },\n      },\n      x: {\n        matcher: xMatcherConfig,\n      },\n      y: {\n        matcher: yMatcherConfig,\n        ...(exclude.length && {\n          exclude: {\n            id: FieldMatcherID.byNames,\n            options: exclude,\n          },\n        }),\n      },\n      ...(colorField && {\n        color: {\n          matcher: {\n            id: FieldMatcherID.byName,\n            options: colorField,\n          },\n        },\n      }),\n      ...(sizeField && {\n        size: {\n          matcher: {\n            id: FieldMatcherID.byName,\n            options: sizeField,\n          },\n        },\n      }),\n    };\n  });\n\n  const newOptions: Options = {\n    ...cleanedOpts,\n    mapping: seriesMapping === SeriesMapping.Auto ? SeriesMapping.Auto : SeriesMapping.Manual,\n    series: newSeries,\n  };\n\n  return newOptions;\n}\n","import { PanelPlugin } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { commonOptionsBuilder } from '@grafana/ui';\n\nimport { SeriesEditor } from './SeriesEditor';\nimport { XYChartPanel2 } from './XYChartPanel';\nimport { getScatterFieldConfig } from './config';\nimport { xyChartMigrationHandler } from './migrations';\nimport { FieldConfig, defaultFieldConfig, Options } from './panelcfg.gen';\n\nexport const plugin = new PanelPlugin<Options, FieldConfig>(XYChartPanel2)\n  // .setPanelChangeHandler(xyChartChangeHandler)\n  .setMigrationHandler(xyChartMigrationHandler)\n  .useFieldConfig(getScatterFieldConfig(defaultFieldConfig))\n  .setPanelOptions((builder) => {\n    const category = [t('xychart.category-xychart', 'XY Chart')];\n    builder\n      .addRadio({\n        path: 'mapping',\n        name: t('xychart.name-series-mapping', 'Series mapping'),\n        category,\n        defaultValue: 'auto',\n        settings: {\n          options: [\n            { value: 'auto', label: t('xychart.series-mapping-options.label-auto', 'Auto') },\n            { value: 'manual', label: t('xychart.series-mapping-options.label-manual', 'Manual') },\n          ],\n        },\n      })\n      .addCustomEditor({\n        id: 'series',\n        path: 'series',\n        name: '',\n        category,\n        editor: SeriesEditor,\n        defaultValue: [{}],\n      });\n\n    commonOptionsBuilder.addTooltipOptions(builder, true);\n    commonOptionsBuilder.addLegendOptions(builder);\n  });\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport enum PointShape {\n  Circle = 'circle',\n  Square = 'square',\n}\n\nexport enum SeriesMapping {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\nexport enum XYShowMode {\n  Lines = 'lines',\n  Points = 'points',\n  PointsAndLines = 'points+lines',\n}\n\n/**\n * NOTE: (copied from dashboard_kind.cue, since not exported)\n * Matcher is a predicate configuration. Based on the config a set of field(s) or values is filtered in order to apply override / transformation.\n * It comes with in id ( to resolve implementation from registry) and a configuration thats specific to a particular matcher type.\n */\nexport interface MatcherConfig {\n  /**\n   * The matcher id. This is used to find the matcher implementation from registry.\n   */\n  id: string;\n  /**\n   * The matcher options. This is specific to the matcher implementation.\n   */\n  options?: unknown;\n}\n\nexport const defaultMatcherConfig: Partial<MatcherConfig> = {\n  id: '',\n};\n\nexport interface FieldConfig extends common.HideableFieldConfig, common.AxisConfig {\n  fillOpacity?: number;\n  lineStyle?: common.LineStyle;\n  lineWidth?: number;\n  pointShape?: PointShape;\n  pointSize?: {\n    fixed?: number;\n    min?: number;\n    max?: number;\n  };\n  pointStrokeWidth?: number;\n  show?: XYShowMode;\n}\n\nexport const defaultFieldConfig: Partial<FieldConfig> = {\n  fillOpacity: 50,\n  show: XYShowMode.Points,\n};\n\nexport interface XYSeriesConfig {\n  color?: {\n    matcher: MatcherConfig;\n  };\n  frame?: {\n    matcher: MatcherConfig;\n  };\n  name?: {\n    fixed?: string;\n  };\n  size?: {\n    matcher: MatcherConfig;\n  };\n  x?: {\n    matcher: MatcherConfig;\n  };\n  y?: {\n    matcher: MatcherConfig;\n  };\n}\n\nexport interface Options extends common.OptionsWithLegend, common.OptionsWithTooltip {\n  mapping: SeriesMapping;\n  series: Array<XYSeriesConfig>;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  series: [],\n};\n","import {\n  Field,\n  formattedValueToString,\n  getFieldMatcher,\n  FieldType,\n  getFieldDisplayName,\n  DataFrame,\n  FrameMatcherID,\n  MatcherConfig,\n  FieldColorModeId,\n  cacheFieldDisplayNames,\n  FieldMatcherID,\n  FieldConfigSource,\n} from '@grafana/data';\nimport { decoupleHideFromState } from '@grafana/data/internal';\nimport { config } from '@grafana/runtime';\nimport { VisibilityMode } from '@grafana/schema';\n\nimport { XYShowMode, SeriesMapping, XYSeriesConfig } from './panelcfg.gen';\nimport { XYSeries } from './types2';\n\nexport function fmt(field: Field, val: number): string {\n  if (field.display) {\n    return formattedValueToString(field.display(val));\n  }\n\n  return `${val}`;\n}\n\n// cause we dont have a proper matcher for this currently\nfunction getFrameMatcher2(config: MatcherConfig) {\n  if (config.id === FrameMatcherID.byIndex) {\n    return (frame: DataFrame, index: number) => index === config.options;\n  }\n\n  return () => false;\n}\n\nexport function prepSeries(\n  mapping: SeriesMapping,\n  mappedSeries: XYSeriesConfig[],\n  frames: DataFrame[],\n  fieldConfig: FieldConfigSource\n) {\n  cacheFieldDisplayNames(frames);\n  decoupleHideFromState(frames, fieldConfig);\n\n  let series: XYSeries[] = [];\n\n  if (mappedSeries.length === 0) {\n    mappedSeries = [{}];\n  }\n\n  const { palette, getColorByName } = config.theme2.visualization;\n\n  mappedSeries.forEach((seriesCfg, seriesIdx) => {\n    if (mapping === SeriesMapping.Manual) {\n      if (seriesCfg.frame?.matcher == null || seriesCfg.x?.matcher == null || seriesCfg.y?.matcher == null) {\n        return;\n      }\n    }\n\n    let xMatcher = getFieldMatcher(\n      seriesCfg.x?.matcher ?? {\n        id: FieldMatcherID.byTypes,\n        options: new Set(['number', 'time']),\n      }\n    );\n    let yMatcher = getFieldMatcher(\n      seriesCfg.y?.matcher ?? {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      }\n    );\n    let colorMatcher = seriesCfg.color ? getFieldMatcher(seriesCfg.color.matcher) : null;\n    let sizeMatcher = seriesCfg.size ? getFieldMatcher(seriesCfg.size.matcher) : null;\n    // let frameMatcher = seriesCfg.frame ? getFrameMatchers(seriesCfg.frame) : null;\n    let frameMatcher = seriesCfg.frame ? getFrameMatcher2(seriesCfg.frame.matcher) : null;\n\n    // loop over all frames and fields, adding a new series for each y dim\n    frames.forEach((frame, frameIdx) => {\n      // must match frame in manual mode\n      if (frameMatcher != null && !frameMatcher(frame, frameIdx)) {\n        return;\n      }\n\n      // shared across each series in this frame\n      let restFields: Field[] = [];\n\n      let frameSeries: XYSeries[] = [];\n\n      let onlyNumTimeFields = frame.fields.filter(\n        (field) => field.type === FieldType.number || field.type === FieldType.time\n      );\n\n      // only one of these per frame\n      let x = onlyNumTimeFields.find((field) => xMatcher(field, frame, frames));\n\n      // only grabbing number fields (exclude time, string, enum, other)\n      let onlyNumFields = onlyNumTimeFields.filter((field) => field.type === FieldType.number);\n\n      let color =\n        colorMatcher != null\n          ? onlyNumFields.find((field) => field !== x && colorMatcher!(field, frame, frames))\n          : undefined;\n      let size =\n        sizeMatcher != null\n          ? onlyNumFields.find((field) => field !== x && field !== color && sizeMatcher!(field, frame, frames))\n          : undefined;\n\n      // x field is required\n      if (x != null) {\n        // match y fields and create series\n        onlyNumFields.forEach((field) => {\n          if (field === x) {\n            return;\n          }\n\n          // in auto mode don't reuse already-mapped fields\n          if (mapping === SeriesMapping.Auto && (field === color || field === size)) {\n            return;\n          }\n\n          // in manual mode only add single series for this config\n          if (mapping === SeriesMapping.Manual && frameSeries.length > 0) {\n            return;\n          }\n\n          // if we match non-excluded y, create series\n          if (yMatcher(field, frame, frames) && !field.config.custom?.hideFrom?.viz) {\n            let y = field;\n\n            let name = seriesCfg.name?.fixed;\n\n            if (name == null) {\n              // if the displayed field name is likely to have a common prefix or suffix\n              // (such as those from Partition by values transformation)\n              const likelyHasCommonParts =\n                frames.length > 1 && (frame.name != null || Object.keys(y.labels ?? {}).length > 0);\n\n              // if the field was explictly (re)named using config.displayName or config.displayNameFromDS\n              // we still want to retain any frame name prefix or suffix so that autoNameSeries() can\n              // properly detect + strip common parts across all series...\n              const { displayName, displayNameFromDS } = y.config;\n              const hasExplicitName = displayName != null || displayNameFromDS != null;\n\n              if (likelyHasCommonParts && hasExplicitName) {\n                // ...and a hacky way to do this is to temp remove the explicit name, get the auto name, then revert\n                const stateDisplayName = y.state!.displayName;\n\n                // clear config and cache\n                y.config.displayName = y.config.displayNameFromDS = y.state!.displayName = undefined;\n                // get default/calculated display name (maybe use calculateFieldDisplayName() here instead?)\n                name = getFieldDisplayName(y, frame, frames);\n                // replace original field name with explicit one\n                name = name.replace(y.name, (displayNameFromDS ?? displayName)!);\n\n                // revert\n                y.config.displayName = displayName;\n                y.config.displayNameFromDS = displayNameFromDS;\n                y.state!.displayName = stateDisplayName;\n              } else {\n                name = getFieldDisplayName(y, frame, frames);\n              }\n            }\n\n            let ser: XYSeries = {\n              // these typically come from y field\n              name: {\n                value: name,\n              },\n\n              showPoints: y.config.custom.show === XYShowMode.Lines ? VisibilityMode.Never : VisibilityMode.Always,\n              pointShape: y.config.custom.pointShape,\n              pointStrokeWidth: y.config.custom.pointStrokeWidth,\n              fillOpacity: y.config.custom.fillOpacity,\n\n              showLine: y.config.custom.show !== XYShowMode.Points,\n              lineWidth: y.config.custom.lineWidth ?? 2,\n              lineStyle: y.config.custom.lineStyle,\n\n              x: {\n                field: x!,\n              },\n              y: {\n                field: y,\n              },\n              color: {},\n              size: {},\n              _rest: restFields,\n            };\n\n            if (color != null) {\n              ser.color.field = color;\n            }\n\n            if (size != null) {\n              ser.size.field = size;\n              ser.size.min = size.config.custom.pointSize?.min ?? 5;\n              ser.size.max = size.config.custom.pointSize?.max ?? 100;\n              // ser.size.mode =\n            }\n\n            frameSeries.push(ser);\n          }\n        });\n\n        if (frameSeries.length === 0) {\n          // TODO: could not create series, skip & show error?\n        }\n\n        // populate rest fields\n        frame.fields.forEach((field) => {\n          let isUsedField = frameSeries.some(\n            ({ x, y, color, size }) =>\n              x.field === field || y.field === field || color.field === field || size.field === field\n          );\n\n          if (!isUsedField) {\n            restFields.push(field);\n          }\n        });\n\n        series.push(...frameSeries);\n      } else {\n        // x is missing in this frame!\n      }\n    });\n  });\n\n  if (series.length === 0) {\n    // TODO: could not create series, skip & show error?\n  } else {\n    // assign classic palette colors by index, as fallbacks for all series\n\n    let paletteIdx = 0;\n\n    // todo: populate min, max, mode from field + hints\n    series.forEach((s, i) => {\n      if (s.color.field == null) {\n        // derive fixed color from y field config\n        let colorCfg = s.y.field.config.color ?? { mode: FieldColorModeId.PaletteClassic };\n\n        let value = '';\n\n        if (colorCfg.mode === FieldColorModeId.PaletteClassic) {\n          value = getColorByName(palette[paletteIdx++ % palette.length]); // todo: do this via state.seriesIdx and re-init displayProcessor\n        } else if (colorCfg.mode === FieldColorModeId.Fixed) {\n          value = getColorByName(colorCfg.fixedColor!);\n        }\n\n        s.color.fixed = value;\n      }\n\n      if (s.size.field == null) {\n        // derive fixed size from y field config\n        s.size.fixed = s.y.field.config.custom.pointSize?.fixed ?? 5;\n        // ser.size.mode =\n      }\n    });\n\n    autoNameSeries(series);\n\n    // TODO: re-assign y display names?\n    // y.state = {\n    //   ...y.state,\n    //   seriesIndex: series.length + ,\n    // };\n    // y.display = getDisplayProcessor({ field, theme });\n  }\n\n  return series;\n}\n\n// strip common prefixes and suffixes from y field names\nfunction autoNameSeries(series: XYSeries[]) {\n  let names = series.map((s) => s.name.value.split(/\\s+/g));\n\n  const { prefix, suffix } = findCommonPrefixSuffixLengths(names);\n\n  if (prefix < Infinity || suffix < Infinity) {\n    series.forEach((s, i) => {\n      s.name.value = names[i].slice(prefix, names[i].length - suffix).join(' ');\n    });\n  }\n}\n\nexport function getCommonPrefixSuffix(strs: string[]) {\n  let names = strs.map((s) => s.split(/\\s+/g));\n\n  let { prefix, suffix } = findCommonPrefixSuffixLengths(names);\n\n  let n = names[0];\n\n  if (n.length === 1 && prefix === 1 && suffix === 1) {\n    return '';\n  }\n\n  let parts = [];\n\n  if (prefix > 0) {\n    parts.push(...n.slice(0, prefix));\n  }\n\n  if (suffix > 0) {\n    parts.push(...n.slice(-suffix));\n  }\n\n  return parts.join(' ');\n}\n\n// lengths are in number of tokens (segments) in a phrase\nfunction findCommonPrefixSuffixLengths(names: string[][]) {\n  let commonPrefixLen = Infinity;\n  let commonSuffixLen = Infinity;\n\n  // if auto naming strategy, rename fields by stripping common prefixes and suffixes\n  let segs0: string[] = names[0];\n\n  for (let i = 1; i < names.length; i++) {\n    if (names[i].length < segs0.length) {\n      segs0 = names[i];\n    }\n  }\n\n  for (let i = 1; i < names.length; i++) {\n    let segs = names[i];\n\n    if (segs !== segs0) {\n      // prefixes\n      let preLen = 0;\n      for (let j = 0; j < segs0.length; j++) {\n        if (segs[j] === segs0[j]) {\n          preLen++;\n        } else {\n          break;\n        }\n      }\n\n      if (preLen < commonPrefixLen) {\n        commonPrefixLen = preLen;\n      }\n\n      // suffixes\n      let sufLen = 0;\n      for (let j = segs0.length - 1; j >= 0; j--) {\n        if (segs[j] === segs0[j]) {\n          sufLen++;\n        } else {\n          break;\n        }\n      }\n\n      if (sufLen < commonSuffixLen) {\n        commonSuffixLen = sufLen;\n      }\n    }\n  }\n\n  return {\n    prefix: commonPrefixLen,\n    suffix: commonSuffixLen,\n  };\n}\n"],"names":["VizTooltipContent","items","children","isPinned","scrollable","maxHeight","styles","getStyles","scrollableStyle","label","value","color","colorIndicator","colorPlacement","isActive","lineStyle","i","theme","VizTooltipHeader","item","ColorIndicatorPosition","VizTooltipColorIndicator","position","SeriesIcon","LabelValueTypes","SUCCESSFULLY_COPIED_TEXT","SHOW_SUCCESS_DURATION","HORIZONTAL_PX_PER_CHAR","VizTooltipRow","justify","marginRight","showValueScroll","innerValueScrollStyle","showLabelTooltip","setShowLabelTooltip","copiedText","setCopiedText","showCopySuccess","setShowCopySuccess","labelRef","valueRef","timeoutId","copyToClipboard","text","type","fallbackCopyToClipboard","textarea","err","onMouseEnterLabel","event","onMouseLeaveLabel","Tooltip","InlineToast","LayerName","name","onChange","verifyLayerNameUniqueness","overrideStyles","isEditing","setIsEditing","validationError","setValidationError","onEditLayer","onEndEditName","newName","onInputChange","onEditLayerBlur","onKeyDown","onFocus","genReplaceActionVars","boundReplaceVariables","action","actionVars","scopedVars","format","matched","getActions","frame","field","fieldScopedVars","replaceVariables","actions","config","dataContext","actionScopedVars","evt","origin","request","buildActionRequest","error","url","getUrl","requestHeaders","getData","getActionsDefaultField","dataLinks","endpoint","sanitizedRelativeURL","data","HorizontalConstraint","VerticalConstraint","BackgroundImageSize","HttpRequestMethod","ConnectionPath","defaultCanvasConnection","defaultCanvasElementOptions","defaultOptions","getDataLinks","rowIdx","links","v","disp","linkLookup","link","key","getAllFrameActions","dataFrame","getFieldActions","replaceVars","rowIndex","actionLookup","SeriesEditor","seriesCfg","context","style","mapping","prevMapping","usePrevious","mappingChanged","defaultFrame","selectedIdx","setSelectedIdx","addSeries","deleteSeries","index","s","series","formKey","baseNameMode","frameIndex","fieldIndex","Button","e","IconButton","Fragment","Field","Select","opt","FieldNamePicker","fieldName","stripSeriesName","seriesName","XYChartTooltip","dataIdxs","seriesIdx","xySeries","dismiss","idx","xField","yField","sizeField","colorField","seriesColor","headerItem","colorManipulator","contentItems","footer","hasOneClickLink","dataLink","yFieldFrame","VizTooltipFooter","VizTooltipWrapper","prepConfig","qt","hRect","drawBubblesFactory","opts","u","idx0","idx1","dataX","dataY","scaleX","scaleY","valToPosX","valToPosY","xOff","yOff","xDim","yDim","moveTo","lineTo","rect","arc","pxRatio","scatterInfo","d","showLine","showPoints","strokeWidth","pointAlpha","deg360","xKey","yKey","pointSize","colorByValue","maxSize","filtLft","filtRgt","filtBtm","filtTop","sizes","pointColors","dispColors","pointPalette","paletteHasAlpha","isSquare","linePath","curColorIdx","xVal","yVal","size","cx","cy","c","x","y","drawBubbles","dataIdx","lft","top","wid","hgt","builder","UPlotConfigBuilder","dist","o","ocx","ocy","dx","dy","r","xIsTime","fieldConfig","customConfig","scaleDistr","min","max","xAxisLabel","dispNames","xAxisAutoLabel","decimals","si","lineColor","pointColor","scaleKey","yAxisLabel","yAxisAutoLabel","cfg","f","fieldValueColors","prepData","sizeRange","colorRange","getGlobalRanges","len","diams","minPx","pxRange","vals","minVal","valRange","valPct","pxArea","ranges","facet","fi","range","getHex8Color","tinycolor","getAll","getOne","conds","mappings","m","k","rhs","spl","steps","lasti","calc","pct","XYChartPanel2","props","mappedSeries","renderLegend","placement","displayMode","width","sortBy","sortDesc","VizLayout","VizLegend","vizWidth","vizHeight","TooltipPlugin2","timeRange2","viaSync","DEFAULT_POINT_SIZE","getScatterFieldConfig","category","LineStyleEditor","SeriesMapping","ScatterShow","defaultXYDimensionConfig","defaultFieldConfig","xyChartMigrationHandler","panel","pluginVersion","migrateOptions","dims","seriesMapping","oldSeries","cleanedOpts","exclude","frameShared","xShared","custDefaults","oldSeries2","newSeries","colorFixed","sizeFixed","sizeMin","sizeMax","xMatcherConfig","yMatcherConfig","p","PanelPlugin","PointShape","XYShowMode","defaultMatcherConfig","fmt","val","getFrameMatcher2","prepSeries","frames","palette","getColorByName","xMatcher","yMatcher","colorMatcher","sizeMatcher","frameMatcher","frameIdx","restFields","frameSeries","onlyNumTimeFields","onlyNumFields","likelyHasCommonParts","displayName","displayNameFromDS","hasExplicitName","stateDisplayName","ser","paletteIdx","colorCfg","autoNameSeries","names","prefix","suffix","findCommonPrefixSuffixLengths","getCommonPrefixSuffix","strs","n","parts","commonPrefixLen","commonSuffixLen","segs0","segs","preLen","j","sufLen"],"sourceRoot":""}